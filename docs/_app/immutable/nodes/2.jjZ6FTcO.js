var nE=Object.defineProperty;var rE=(e,t,n)=>t in e?nE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var kr=(e,t,n)=>(rE(e,typeof t!="symbol"?t+"":t,n),n);import{y as Cu,s as Va,c as Hl,z as _r,A as Io,j as Eu,u as jl,g as Zl,a as Ql,r as Nh,B as Ao,C as xc,D as du,o as bc,E as wm,F as ic,e as ua,G as t0,n as Oa,H as sE,b as Bu,I as om,J as U2,l as aE,K as tp}from"../chunks/scheduler.I9_GjKIr.js";import{S as fo,i as po,s as Sr,e as Rn,h as Ir,c as Fn,d as _n,g as yi,y as sl,j as Un,z as Gl,t as Wi,a as tn,A as i0,u as Jr,v as vs,w as es,x as ts,r as ef,m as xs,q as Eo,n as Co,B as Ra,C as Fa,D as A_,E as f_,o as Ti,k as qi,b as ba,f as wa,l as ql,F as oE,G as Qu,H as G2,I as G0,J as lE,K as uE,L as em,p as Ly}from"../chunks/index.uFRP6icT.js";import{w as r0}from"../chunks/index.OKv3WG0v.js";const cE=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function yc(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function ma(e,t){const n={},c={},g={$$scope:1};let x=e.length;for(;x--;){const S=e[x],a=t[x];if(a){for(const U in S)U in a||(c[U]=1);for(const U in a)g[U]||(n[U]=a[U],g[U]=1);e[x]=a}else for(const U in S)g[U]=1}for(const S in c)S in n||(n[S]=void 0);return n}function Os(e){return typeof e=="object"&&e!==null?e:{}}var By=function(e,t){return By=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,c){n.__proto__=c}||function(n,c){for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&(n[g]=c[g])},By(e,t)};function l0(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");By(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var ou=function(){return ou=Object.assign||function(t){for(var n,c=1,g=arguments.length;c<g;c++){n=arguments[c];for(var x in n)Object.prototype.hasOwnProperty.call(n,x)&&(t[x]=n[x])}return t},ou.apply(this,arguments)};function ng(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],c=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&c>=e.length&&(e=void 0),{value:e&&e[c++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function q2(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var c=n.call(e),g,x=[],S;try{for(;(t===void 0||t-- >0)&&!(g=c.next()).done;)x.push(g.value)}catch(a){S={error:a}}finally{try{g&&!g.done&&(n=c.return)&&n.call(c)}finally{if(S)throw S.error}}return x}function hE(e,t,n){if(n||arguments.length===2)for(var c=0,g=t.length,x;c<g;c++)(x||!(c in t))&&(x||(x=Array.prototype.slice.call(t,0,c)),x[c]=t[c]);return e.concat(x||Array.prototype.slice.call(t))}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var u0=function(){function e(t){t===void 0&&(t={}),this.adapter=t}return Object.defineProperty(e,"cssClasses",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{}},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.destroy=function(){},e}();/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function AE(e,t){if(e.closest)return e.closest(t);for(var n=e;n;){if(A3(n,t))return n;n=n.parentElement}return null}function A3(e,t){var n=e.matches||e.webkitMatchesSelector||e.msMatchesSelector;return n.call(e,t)}function fE(e){var t=e;if(t.offsetParent!==null)return t.scrollWidth;var n=t.cloneNode(!0);n.style.setProperty("position","absolute"),n.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(n);var c=n.scrollWidth;return document.documentElement.removeChild(n),c}const Bv=Object.freeze(Object.defineProperty({__proto__:null,closest:AE,estimateScrollWidth:fE,matches:A3},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var dE={LABEL_FLOAT_ABOVE:"mdc-floating-label--float-above",LABEL_REQUIRED:"mdc-floating-label--required",LABEL_SHAKE:"mdc-floating-label--shake",ROOT:"mdc-floating-label"};/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var pE=function(e){l0(t,e);function t(n){var c=e.call(this,ou(ou({},t.defaultAdapter),n))||this;return c.shakeAnimationEndHandler=function(){c.handleShakeAnimationEnd()},c}return Object.defineProperty(t,"cssClasses",{get:function(){return dE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},getWidth:function(){return 0},registerInteractionHandler:function(){},deregisterInteractionHandler:function(){}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.adapter.registerInteractionHandler("animationend",this.shakeAnimationEndHandler)},t.prototype.destroy=function(){this.adapter.deregisterInteractionHandler("animationend",this.shakeAnimationEndHandler)},t.prototype.getWidth=function(){return this.adapter.getWidth()},t.prototype.shake=function(n){var c=t.cssClasses.LABEL_SHAKE;n?this.adapter.addClass(c):this.adapter.removeClass(c)},t.prototype.float=function(n){var c=t.cssClasses,g=c.LABEL_FLOAT_ABOVE,x=c.LABEL_SHAKE;n?this.adapter.addClass(g):(this.adapter.removeClass(g),this.adapter.removeClass(x))},t.prototype.setRequired=function(n){var c=t.cssClasses.LABEL_REQUIRED;n?this.adapter.addClass(c):this.adapter.removeClass(c)},t.prototype.handleShakeAnimationEnd=function(){var n=t.cssClasses.LABEL_SHAKE;this.adapter.removeClass(n)},t}(u0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Ud={LINE_RIPPLE_ACTIVE:"mdc-line-ripple--active",LINE_RIPPLE_DEACTIVATING:"mdc-line-ripple--deactivating"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var mE=function(e){l0(t,e);function t(n){var c=e.call(this,ou(ou({},t.defaultAdapter),n))||this;return c.transitionEndHandler=function(g){c.handleTransitionEnd(g)},c}return Object.defineProperty(t,"cssClasses",{get:function(){return Ud},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setStyle:function(){},registerEventHandler:function(){},deregisterEventHandler:function(){}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.adapter.registerEventHandler("transitionend",this.transitionEndHandler)},t.prototype.destroy=function(){this.adapter.deregisterEventHandler("transitionend",this.transitionEndHandler)},t.prototype.activate=function(){this.adapter.removeClass(Ud.LINE_RIPPLE_DEACTIVATING),this.adapter.addClass(Ud.LINE_RIPPLE_ACTIVE)},t.prototype.setRippleCenter=function(n){this.adapter.setStyle("transform-origin",n+"px center")},t.prototype.deactivate=function(){this.adapter.addClass(Ud.LINE_RIPPLE_DEACTIVATING)},t.prototype.handleTransitionEnd=function(n){var c=this.adapter.hasClass(Ud.LINE_RIPPLE_DEACTIVATING);n.propertyName==="opacity"&&c&&(this.adapter.removeClass(Ud.LINE_RIPPLE_ACTIVE),this.adapter.removeClass(Ud.LINE_RIPPLE_DEACTIVATING))},t}(u0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var gE={ANCHOR:"mdc-menu-surface--anchor",ANIMATING_CLOSED:"mdc-menu-surface--animating-closed",ANIMATING_OPEN:"mdc-menu-surface--animating-open",FIXED:"mdc-menu-surface--fixed",IS_OPEN_BELOW:"mdc-menu-surface--is-open-below",OPEN:"mdc-menu-surface--open",ROOT:"mdc-menu-surface"},_E={CLOSED_EVENT:"MDCMenuSurface:closed",CLOSING_EVENT:"MDCMenuSurface:closing",OPENED_EVENT:"MDCMenuSurface:opened",OPENING_EVENT:"MDCMenuSurface:opening",FOCUSABLE_ELEMENTS:["button:not(:disabled)",'[href]:not([aria-disabled="true"])',"input:not(:disabled)","select:not(:disabled)","textarea:not(:disabled)",'[tabindex]:not([tabindex="-1"]):not([aria-disabled="true"])'].join(", ")},Zm={TRANSITION_OPEN_DURATION:120,TRANSITION_CLOSE_DURATION:75,MARGIN_TO_EDGE:32,ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO:.67,TOUCH_EVENT_WAIT_MS:30},su;(function(e){e[e.BOTTOM=1]="BOTTOM",e[e.CENTER=2]="CENTER",e[e.RIGHT=4]="RIGHT",e[e.FLIP_RTL=8]="FLIP_RTL"})(su||(su={}));var $d;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=4]="TOP_RIGHT",e[e.BOTTOM_LEFT=1]="BOTTOM_LEFT",e[e.BOTTOM_RIGHT=5]="BOTTOM_RIGHT",e[e.TOP_START=8]="TOP_START",e[e.TOP_END=12]="TOP_END",e[e.BOTTOM_START=9]="BOTTOM_START",e[e.BOTTOM_END=13]="BOTTOM_END"})($d||($d={}));/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var F0,jf,la={LIST_ITEM_ACTIVATED_CLASS:"mdc-list-item--activated",LIST_ITEM_CLASS:"mdc-list-item",LIST_ITEM_DISABLED_CLASS:"mdc-list-item--disabled",LIST_ITEM_SELECTED_CLASS:"mdc-list-item--selected",LIST_ITEM_TEXT_CLASS:"mdc-list-item__text",LIST_ITEM_PRIMARY_TEXT_CLASS:"mdc-list-item__primary-text",ROOT:"mdc-list"};F0={},F0[""+la.LIST_ITEM_ACTIVATED_CLASS]="mdc-list-item--activated",F0[""+la.LIST_ITEM_CLASS]="mdc-list-item",F0[""+la.LIST_ITEM_DISABLED_CLASS]="mdc-list-item--disabled",F0[""+la.LIST_ITEM_SELECTED_CLASS]="mdc-list-item--selected",F0[""+la.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-list-item__primary-text",F0[""+la.ROOT]="mdc-list";var Zp=(jf={},jf[""+la.LIST_ITEM_ACTIVATED_CLASS]="mdc-deprecated-list-item--activated",jf[""+la.LIST_ITEM_CLASS]="mdc-deprecated-list-item",jf[""+la.LIST_ITEM_DISABLED_CLASS]="mdc-deprecated-list-item--disabled",jf[""+la.LIST_ITEM_SELECTED_CLASS]="mdc-deprecated-list-item--selected",jf[""+la.LIST_ITEM_TEXT_CLASS]="mdc-deprecated-list-item__text",jf[""+la.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-deprecated-list-item__primary-text",jf[""+la.ROOT]="mdc-deprecated-list",jf),O0={ACTION_EVENT:"MDCList:action",SELECTION_CHANGE_EVENT:"MDCList:selectionChange",ARIA_CHECKED:"aria-checked",ARIA_CHECKED_CHECKBOX_SELECTOR:'[role="checkbox"][aria-checked="true"]',ARIA_CHECKED_RADIO_SELECTOR:'[role="radio"][aria-checked="true"]',ARIA_CURRENT:"aria-current",ARIA_DISABLED:"aria-disabled",ARIA_ORIENTATION:"aria-orientation",ARIA_ORIENTATION_HORIZONTAL:"horizontal",ARIA_ROLE_CHECKBOX_SELECTOR:'[role="checkbox"]',ARIA_SELECTED:"aria-selected",ARIA_INTERACTIVE_ROLES_SELECTOR:'[role="listbox"], [role="menu"]',ARIA_MULTI_SELECTABLE_SELECTOR:'[aria-multiselectable="true"]',CHECKBOX_RADIO_SELECTOR:'input[type="checkbox"], input[type="radio"]',CHECKBOX_SELECTOR:'input[type="checkbox"]',CHILD_ELEMENTS_TO_TOGGLE_TABINDEX:`
    .`+la.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+la.LIST_ITEM_CLASS+` a,
    .`+Zp[la.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+Zp[la.LIST_ITEM_CLASS]+` a
  `,DEPRECATED_SELECTOR:".mdc-deprecated-list",FOCUSABLE_CHILD_ELEMENTS:`
    .`+la.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+la.LIST_ITEM_CLASS+` a,
    .`+la.LIST_ITEM_CLASS+` input[type="radio"]:not(:disabled),
    .`+la.LIST_ITEM_CLASS+` input[type="checkbox"]:not(:disabled),
    .`+Zp[la.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+Zp[la.LIST_ITEM_CLASS]+` a,
    .`+Zp[la.LIST_ITEM_CLASS]+` input[type="radio"]:not(:disabled),
    .`+Zp[la.LIST_ITEM_CLASS]+` input[type="checkbox"]:not(:disabled)
  `,RADIO_SELECTOR:'input[type="radio"]',SELECTED_ITEM_SELECTOR:'[aria-selected="true"], [aria-current="true"]'},ru={UNSET_INDEX:-1,TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS:300};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Ns={UNKNOWN:"Unknown",BACKSPACE:"Backspace",ENTER:"Enter",SPACEBAR:"Spacebar",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",END:"End",HOME:"Home",ARROW_LEFT:"ArrowLeft",ARROW_UP:"ArrowUp",ARROW_RIGHT:"ArrowRight",ARROW_DOWN:"ArrowDown",DELETE:"Delete",ESCAPE:"Escape",TAB:"Tab"},wc=new Set;wc.add(Ns.BACKSPACE);wc.add(Ns.ENTER);wc.add(Ns.SPACEBAR);wc.add(Ns.PAGE_UP);wc.add(Ns.PAGE_DOWN);wc.add(Ns.END);wc.add(Ns.HOME);wc.add(Ns.ARROW_LEFT);wc.add(Ns.ARROW_UP);wc.add(Ns.ARROW_RIGHT);wc.add(Ns.ARROW_DOWN);wc.add(Ns.DELETE);wc.add(Ns.ESCAPE);wc.add(Ns.TAB);var Wc={BACKSPACE:8,ENTER:13,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46,ESCAPE:27,TAB:9},Sc=new Map;Sc.set(Wc.BACKSPACE,Ns.BACKSPACE);Sc.set(Wc.ENTER,Ns.ENTER);Sc.set(Wc.SPACEBAR,Ns.SPACEBAR);Sc.set(Wc.PAGE_UP,Ns.PAGE_UP);Sc.set(Wc.PAGE_DOWN,Ns.PAGE_DOWN);Sc.set(Wc.END,Ns.END);Sc.set(Wc.HOME,Ns.HOME);Sc.set(Wc.ARROW_LEFT,Ns.ARROW_LEFT);Sc.set(Wc.ARROW_UP,Ns.ARROW_UP);Sc.set(Wc.ARROW_RIGHT,Ns.ARROW_RIGHT);Sc.set(Wc.ARROW_DOWN,Ns.ARROW_DOWN);Sc.set(Wc.DELETE,Ns.DELETE);Sc.set(Wc.ESCAPE,Ns.ESCAPE);Sc.set(Wc.TAB,Ns.TAB);var q0=new Set;q0.add(Ns.PAGE_UP);q0.add(Ns.PAGE_DOWN);q0.add(Ns.END);q0.add(Ns.HOME);q0.add(Ns.ARROW_LEFT);q0.add(Ns.ARROW_UP);q0.add(Ns.ARROW_RIGHT);q0.add(Ns.ARROW_DOWN);function fu(e){var t=e.key;if(wc.has(t))return t;var n=Sc.get(e.keyCode);return n||Ns.UNKNOWN}/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var yE=["input","button","textarea","select"],Rh=function(e){var t=e.target;if(t){var n=(""+t.tagName).toLowerCase();yE.indexOf(n)===-1&&e.preventDefault()}};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function vE(){var e={bufferClearTimeout:0,currentFirstChar:"",sortedIndexCursor:0,typeaheadBuffer:""};return e}function xE(e,t){for(var n=new Map,c=0;c<e;c++){var g=t(c).trim();if(g){var x=g[0].toLowerCase();n.has(x)||n.set(x,[]),n.get(x).push({text:g.toLowerCase(),index:c})}}return n.forEach(function(S){S.sort(function(a,U){return a.index-U.index})}),n}function zy(e,t){var n=e.nextChar,c=e.focusItemAtIndex,g=e.sortedIndexByFirstChar,x=e.focusedItemIndex,S=e.skipFocus,a=e.isItemAtIndexDisabled;clearTimeout(t.bufferClearTimeout),t.bufferClearTimeout=setTimeout(function(){d3(t)},ru.TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS),t.typeaheadBuffer=t.typeaheadBuffer+n;var U;return t.typeaheadBuffer.length===1?U=bE(g,x,a,t):U=wE(g,a,t),U!==-1&&!S&&c(U),U}function bE(e,t,n,c){var g=c.typeaheadBuffer[0],x=e.get(g);if(!x)return-1;if(g===c.currentFirstChar&&x[c.sortedIndexCursor].index===t){c.sortedIndexCursor=(c.sortedIndexCursor+1)%x.length;var S=x[c.sortedIndexCursor].index;if(!n(S))return S}c.currentFirstChar=g;var a=-1,U;for(U=0;U<x.length;U++)if(!n(x[U].index)){a=U;break}for(;U<x.length;U++)if(x[U].index>t&&!n(x[U].index)){a=U;break}return a!==-1?(c.sortedIndexCursor=a,x[c.sortedIndexCursor].index):-1}function wE(e,t,n){var c=n.typeaheadBuffer[0],g=e.get(c);if(!g)return-1;var x=g[n.sortedIndexCursor];if(x.text.lastIndexOf(n.typeaheadBuffer,0)===0&&!t(x.index))return x.index;for(var S=(n.sortedIndexCursor+1)%g.length,a=-1;S!==n.sortedIndexCursor;){var U=g[S],W=U.text.lastIndexOf(n.typeaheadBuffer,0)===0,he=!t(U.index);if(W&&he){a=S;break}S=(S+1)%g.length}return a!==-1?(n.sortedIndexCursor=a,g[n.sortedIndexCursor].index):-1}function f3(e){return e.typeaheadBuffer.length>0}function d3(e){e.typeaheadBuffer=""}function H2(e,t){var n=e.event,c=e.isTargetListItem,g=e.focusedItemIndex,x=e.focusItemAtIndex,S=e.sortedIndexByFirstChar,a=e.isItemAtIndexDisabled,U=fu(n)==="ArrowLeft",W=fu(n)==="ArrowUp",he=fu(n)==="ArrowRight",ae=fu(n)==="ArrowDown",ce=fu(n)==="Home",be=fu(n)==="End",Je=fu(n)==="Enter",st=fu(n)==="Spacebar";if(n.altKey||n.ctrlKey||n.metaKey||U||W||he||ae||ce||be||Je)return-1;var Ye=!st&&n.key.length===1;if(Ye){Rh(n);var it={focusItemAtIndex:x,focusedItemIndex:g,nextChar:n.key.toLowerCase(),sortedIndexByFirstChar:S,skipFocus:!1,isItemAtIndexDisabled:a};return zy(it,t)}if(!st)return-1;c&&Rh(n);var ct=c&&f3(t);if(ct){var it={focusItemAtIndex:x,focusedItemIndex:g,nextChar:" ",sortedIndexByFirstChar:S,skipFocus:!1,isItemAtIndexDisabled:a};return zy(it,t)}return-1}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function SE(e){return e instanceof Array}var IE=["Alt","Control","Meta","Shift"];function j2(e){var t=new Set(e?IE.filter(function(n){return e.getModifierState(n)}):[]);return function(n){return n.every(function(c){return t.has(c)})&&n.length===t.size}}var EE=function(e){l0(t,e);function t(n){var c=e.call(this,ou(ou({},t.defaultAdapter),n))||this;return c.wrapFocus=!1,c.isVertical=!0,c.isSingleSelectionList=!1,c.areDisabledItemsFocusable=!0,c.selectedIndex=ru.UNSET_INDEX,c.focusedItemIndex=ru.UNSET_INDEX,c.useActivatedClass=!1,c.useSelectedAttr=!1,c.ariaCurrentAttrValue=null,c.isCheckboxList=!1,c.isRadioList=!1,c.lastSelectedIndex=null,c.hasTypeahead=!1,c.typeaheadState=vE(),c.sortedIndexByFirstChar=new Map,c}return Object.defineProperty(t,"strings",{get:function(){return O0},enumerable:!1,configurable:!0}),Object.defineProperty(t,"cssClasses",{get:function(){return la},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return ru},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClassForElementIndex:function(){},focusItemAtIndex:function(){},getAttributeForElementIndex:function(){return null},getFocusedElementIndex:function(){return 0},getListItemCount:function(){return 0},hasCheckboxAtIndex:function(){return!1},hasRadioAtIndex:function(){return!1},isCheckboxCheckedAtIndex:function(){return!1},isFocusInsideList:function(){return!1},isRootFocused:function(){return!1},listItemAtIndexHasClass:function(){return!1},notifyAction:function(){},notifySelectionChange:function(){},removeClassForElementIndex:function(){},setAttributeForElementIndex:function(){},setCheckedCheckboxOrRadioAtIndex:function(){},setTabIndexForListItemChildren:function(){},getPrimaryTextAtIndex:function(){return""}}},enumerable:!1,configurable:!0}),t.prototype.layout=function(){this.adapter.getListItemCount()!==0&&(this.adapter.hasCheckboxAtIndex(0)?this.isCheckboxList=!0:this.adapter.hasRadioAtIndex(0)?this.isRadioList=!0:this.maybeInitializeSingleSelection(),this.hasTypeahead&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex()))},t.prototype.getFocusedItemIndex=function(){return this.focusedItemIndex},t.prototype.setWrapFocus=function(n){this.wrapFocus=n},t.prototype.setVerticalOrientation=function(n){this.isVertical=n},t.prototype.setSingleSelection=function(n){this.isSingleSelectionList=n,n&&(this.maybeInitializeSingleSelection(),this.selectedIndex=this.getSelectedIndexFromDOM())},t.prototype.setDisabledItemsFocusable=function(n){this.areDisabledItemsFocusable=n},t.prototype.maybeInitializeSingleSelection=function(){var n=this.getSelectedIndexFromDOM();if(n!==ru.UNSET_INDEX){var c=this.adapter.listItemAtIndexHasClass(n,la.LIST_ITEM_ACTIVATED_CLASS);c&&this.setUseActivatedClass(!0),this.isSingleSelectionList=!0,this.selectedIndex=n}},t.prototype.getSelectedIndexFromDOM=function(){for(var n=ru.UNSET_INDEX,c=this.adapter.getListItemCount(),g=0;g<c;g++){var x=this.adapter.listItemAtIndexHasClass(g,la.LIST_ITEM_SELECTED_CLASS),S=this.adapter.listItemAtIndexHasClass(g,la.LIST_ITEM_ACTIVATED_CLASS);if(x||S){n=g;break}}return n},t.prototype.setHasTypeahead=function(n){this.hasTypeahead=n,n&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex())},t.prototype.isTypeaheadInProgress=function(){return this.hasTypeahead&&f3(this.typeaheadState)},t.prototype.setUseActivatedClass=function(n){this.useActivatedClass=n},t.prototype.setUseSelectedAttribute=function(n){this.useSelectedAttr=n},t.prototype.getSelectedIndex=function(){return this.selectedIndex},t.prototype.setSelectedIndex=function(n,c){c===void 0&&(c={}),this.isIndexValid(n)&&(this.isCheckboxList?this.setCheckboxAtIndex(n,c):this.isRadioList?this.setRadioAtIndex(n,c):this.setSingleSelectionAtIndex(n,c))},t.prototype.handleFocusIn=function(n){n>=0&&(this.focusedItemIndex=n,this.adapter.setAttributeForElementIndex(n,"tabindex","0"),this.adapter.setTabIndexForListItemChildren(n,"0"))},t.prototype.handleFocusOut=function(n){var c=this;n>=0&&(this.adapter.setAttributeForElementIndex(n,"tabindex","-1"),this.adapter.setTabIndexForListItemChildren(n,"-1")),setTimeout(function(){c.adapter.isFocusInsideList()||c.setTabindexToFirstSelectedOrFocusedItem()},0)},t.prototype.isIndexDisabled=function(n){return this.adapter.listItemAtIndexHasClass(n,la.LIST_ITEM_DISABLED_CLASS)},t.prototype.handleKeydown=function(n,c,g){var x=this,S,a=fu(n)==="ArrowLeft",U=fu(n)==="ArrowUp",W=fu(n)==="ArrowRight",he=fu(n)==="ArrowDown",ae=fu(n)==="Home",ce=fu(n)==="End",be=fu(n)==="Enter",Je=fu(n)==="Spacebar",st=this.isVertical&&he||!this.isVertical&&W,Ye=this.isVertical&&U||!this.isVertical&&a,it=n.key==="A"||n.key==="a",ct=j2(n);if(this.adapter.isRootFocused()){if((Ye||ce)&&ct([]))n.preventDefault(),this.focusLastElement();else if((st||ae)&&ct([]))n.preventDefault(),this.focusFirstElement();else if(Ye&&ct(["Shift"])&&this.isCheckboxList){n.preventDefault();var Tt=this.focusLastElement();Tt!==-1&&this.setSelectedIndexOnAction(Tt,!1)}else if(st&&ct(["Shift"])&&this.isCheckboxList){n.preventDefault();var Tt=this.focusFirstElement();Tt!==-1&&this.setSelectedIndexOnAction(Tt,!1)}if(this.hasTypeahead){var zt={event:n,focusItemAtIndex:function(jt){x.focusItemAtIndex(jt)},focusedItemIndex:-1,isTargetListItem:c,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(jt){return x.isIndexDisabled(jt)}};H2(zt,this.typeaheadState)}return}var Rt=this.adapter.getFocusedElementIndex();if(!(Rt===-1&&(Rt=g,Rt<0))){if(st&&ct([]))Rh(n),this.focusNextElement(Rt);else if(Ye&&ct([]))Rh(n),this.focusPrevElement(Rt);else if(st&&ct(["Shift"])&&this.isCheckboxList){Rh(n);var Tt=this.focusNextElement(Rt);Tt!==-1&&this.setSelectedIndexOnAction(Tt,!1)}else if(Ye&&ct(["Shift"])&&this.isCheckboxList){Rh(n);var Tt=this.focusPrevElement(Rt);Tt!==-1&&this.setSelectedIndexOnAction(Tt,!1)}else if(ae&&ct([]))Rh(n),this.focusFirstElement();else if(ce&&ct([]))Rh(n),this.focusLastElement();else if(ae&&ct(["Control","Shift"])&&this.isCheckboxList){if(Rh(n),this.isIndexDisabled(Rt))return;this.focusFirstElement(),this.toggleCheckboxRange(0,Rt,Rt)}else if(ce&&ct(["Control","Shift"])&&this.isCheckboxList){if(Rh(n),this.isIndexDisabled(Rt))return;this.focusLastElement(),this.toggleCheckboxRange(Rt,this.adapter.getListItemCount()-1,Rt)}else if(it&&ct(["Control"])&&this.isCheckboxList)n.preventDefault(),this.checkboxListToggleAll(this.selectedIndex===ru.UNSET_INDEX?[]:this.selectedIndex,!0);else if((be||Je)&&ct([])){if(c){var Oe=n.target;if(Oe&&Oe.tagName==="A"&&be||(Rh(n),this.isIndexDisabled(Rt)))return;this.isTypeaheadInProgress()||(this.isSelectableList()&&this.setSelectedIndexOnAction(Rt,!1),this.adapter.notifyAction(Rt))}}else if((be||Je)&&ct(["Shift"])&&this.isCheckboxList){var Oe=n.target;if(Oe&&Oe.tagName==="A"&&be||(Rh(n),this.isIndexDisabled(Rt)))return;this.isTypeaheadInProgress()||(this.toggleCheckboxRange((S=this.lastSelectedIndex)!==null&&S!==void 0?S:Rt,Rt,Rt),this.adapter.notifyAction(Rt))}if(this.hasTypeahead){var zt={event:n,focusItemAtIndex:function(at){x.focusItemAtIndex(at)},focusedItemIndex:this.focusedItemIndex,isTargetListItem:c,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(at){return x.isIndexDisabled(at)}};H2(zt,this.typeaheadState)}}},t.prototype.handleClick=function(n,c,g){var x,S=j2(g);n!==ru.UNSET_INDEX&&(this.isIndexDisabled(n)||(S([])?(this.isSelectableList()&&this.setSelectedIndexOnAction(n,c),this.adapter.notifyAction(n)):this.isCheckboxList&&S(["Shift"])&&(this.toggleCheckboxRange((x=this.lastSelectedIndex)!==null&&x!==void 0?x:n,n,n),this.adapter.notifyAction(n))))},t.prototype.focusNextElement=function(n){var c=this.adapter.getListItemCount(),g=n,x=null;do{if(g++,g>=c)if(this.wrapFocus)g=0;else return n;if(g===x)return-1;x=x??g}while(!this.areDisabledItemsFocusable&&this.isIndexDisabled(g));return this.focusItemAtIndex(g),g},t.prototype.focusPrevElement=function(n){var c=this.adapter.getListItemCount(),g=n,x=null;do{if(g--,g<0)if(this.wrapFocus)g=c-1;else return n;if(g===x)return-1;x=x??g}while(!this.areDisabledItemsFocusable&&this.isIndexDisabled(g));return this.focusItemAtIndex(g),g},t.prototype.focusFirstElement=function(){return this.focusNextElement(-1)},t.prototype.focusLastElement=function(){return this.focusPrevElement(this.adapter.getListItemCount())},t.prototype.focusInitialElement=function(){var n=this.getFirstSelectedOrFocusedItemIndex();return this.focusItemAtIndex(n),n},t.prototype.setEnabled=function(n,c){this.isIndexValid(n,!1)&&(c?(this.adapter.removeClassForElementIndex(n,la.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(n,O0.ARIA_DISABLED,"false")):(this.adapter.addClassForElementIndex(n,la.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(n,O0.ARIA_DISABLED,"true")))},t.prototype.setSingleSelectionAtIndex=function(n,c){if(c===void 0&&(c={}),!(this.selectedIndex===n&&!c.forceUpdate)){var g=la.LIST_ITEM_SELECTED_CLASS;this.useActivatedClass&&(g=la.LIST_ITEM_ACTIVATED_CLASS),this.selectedIndex!==ru.UNSET_INDEX&&this.adapter.removeClassForElementIndex(this.selectedIndex,g),this.setAriaForSingleSelectionAtIndex(n),this.setTabindexAtIndex(n),n!==ru.UNSET_INDEX&&this.adapter.addClassForElementIndex(n,g),this.selectedIndex=n,c.isUserInteraction&&!c.forceUpdate&&this.adapter.notifySelectionChange([n])}},t.prototype.setAriaForSingleSelectionAtIndex=function(n){this.selectedIndex===ru.UNSET_INDEX&&(this.ariaCurrentAttrValue=this.adapter.getAttributeForElementIndex(n,O0.ARIA_CURRENT));var c=this.ariaCurrentAttrValue!==null,g=c?O0.ARIA_CURRENT:O0.ARIA_SELECTED;if(this.selectedIndex!==ru.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,g,"false"),n!==ru.UNSET_INDEX){var x=c?this.ariaCurrentAttrValue:"true";this.adapter.setAttributeForElementIndex(n,g,x)}},t.prototype.getSelectionAttribute=function(){return this.useSelectedAttr?O0.ARIA_SELECTED:O0.ARIA_CHECKED},t.prototype.setRadioAtIndex=function(n,c){c===void 0&&(c={});var g=this.getSelectionAttribute();this.adapter.setCheckedCheckboxOrRadioAtIndex(n,!0),!(this.selectedIndex===n&&!c.forceUpdate)&&(this.selectedIndex!==ru.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,g,"false"),this.adapter.setAttributeForElementIndex(n,g,"true"),this.selectedIndex=n,c.isUserInteraction&&!c.forceUpdate&&this.adapter.notifySelectionChange([n]))},t.prototype.setCheckboxAtIndex=function(n,c){c===void 0&&(c={});for(var g=this.selectedIndex,x=c.isUserInteraction?new Set(g===ru.UNSET_INDEX?[]:g):null,S=this.getSelectionAttribute(),a=[],U=0;U<this.adapter.getListItemCount();U++){var W=x==null?void 0:x.has(U),he=n.indexOf(U)>=0;he!==W&&a.push(U),this.adapter.setCheckedCheckboxOrRadioAtIndex(U,he),this.adapter.setAttributeForElementIndex(U,S,he?"true":"false")}this.selectedIndex=n,c.isUserInteraction&&a.length&&this.adapter.notifySelectionChange(a)},t.prototype.toggleCheckboxRange=function(n,c,g){this.lastSelectedIndex=g;for(var x=new Set(this.selectedIndex===ru.UNSET_INDEX?[]:this.selectedIndex),S=!(x!=null&&x.has(g)),a=q2([n,c].sort(),2),U=a[0],W=a[1],he=this.getSelectionAttribute(),ae=[],ce=U;ce<=W;ce++)if(!this.isIndexDisabled(ce)){var be=x.has(ce);S!==be&&(ae.push(ce),this.adapter.setCheckedCheckboxOrRadioAtIndex(ce,S),this.adapter.setAttributeForElementIndex(ce,he,""+S),S?x.add(ce):x.delete(ce))}ae.length&&(this.selectedIndex=hE([],q2(x)),this.adapter.notifySelectionChange(ae))},t.prototype.setTabindexAtIndex=function(n){this.focusedItemIndex===ru.UNSET_INDEX&&n!==0?this.adapter.setAttributeForElementIndex(0,"tabindex","-1"):this.focusedItemIndex>=0&&this.focusedItemIndex!==n&&this.adapter.setAttributeForElementIndex(this.focusedItemIndex,"tabindex","-1"),!(this.selectedIndex instanceof Array)&&this.selectedIndex!==n&&this.adapter.setAttributeForElementIndex(this.selectedIndex,"tabindex","-1"),n!==ru.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(n,"tabindex","0")},t.prototype.isSelectableList=function(){return this.isSingleSelectionList||this.isCheckboxList||this.isRadioList},t.prototype.setTabindexToFirstSelectedOrFocusedItem=function(){var n=this.getFirstSelectedOrFocusedItemIndex();this.setTabindexAtIndex(n)},t.prototype.getFirstSelectedOrFocusedItemIndex=function(){return this.isSelectableList()?typeof this.selectedIndex=="number"&&this.selectedIndex!==ru.UNSET_INDEX?this.selectedIndex:SE(this.selectedIndex)&&this.selectedIndex.length>0?this.selectedIndex.reduce(function(n,c){return Math.min(n,c)}):0:Math.max(this.focusedItemIndex,0)},t.prototype.isIndexValid=function(n,c){var g=this;if(c===void 0&&(c=!0),n instanceof Array){if(!this.isCheckboxList&&c)throw new Error("MDCListFoundation: Array of index is only supported for checkbox based list");return n.length===0?!0:n.some(function(x){return g.isIndexInRange(x)})}else if(typeof n=="number"){if(this.isCheckboxList&&c)throw new Error("MDCListFoundation: Expected array of index for checkbox based list but got number: "+n);return this.isIndexInRange(n)||this.isSingleSelectionList&&n===ru.UNSET_INDEX}else return!1},t.prototype.isIndexInRange=function(n){var c=this.adapter.getListItemCount();return n>=0&&n<c},t.prototype.setSelectedIndexOnAction=function(n,c){this.lastSelectedIndex=n,this.isCheckboxList?(this.toggleCheckboxAtIndex(n,c),this.adapter.notifySelectionChange([n])):this.setSelectedIndex(n,{isUserInteraction:!0})},t.prototype.toggleCheckboxAtIndex=function(n,c){var g=this.getSelectionAttribute(),x=this.adapter.isCheckboxCheckedAtIndex(n),S;c?S=x:(S=!x,this.adapter.setCheckedCheckboxOrRadioAtIndex(n,S)),this.adapter.setAttributeForElementIndex(n,g,S?"true":"false");var a=this.selectedIndex===ru.UNSET_INDEX?[]:this.selectedIndex.slice();S?a.push(n):a=a.filter(function(U){return U!==n}),this.selectedIndex=a},t.prototype.focusItemAtIndex=function(n){this.adapter.focusItemAtIndex(n),this.focusedItemIndex=n},t.prototype.checkboxListToggleAll=function(n,c){var g=this.adapter.getListItemCount();if(n.length===g)this.setCheckboxAtIndex([],{isUserInteraction:c});else{for(var x=[],S=0;S<g;S++)(!this.isIndexDisabled(S)||n.indexOf(S)>-1)&&x.push(S);this.setCheckboxAtIndex(x,{isUserInteraction:c})}},t.prototype.typeaheadMatchItem=function(n,c,g){var x=this;g===void 0&&(g=!1);var S={focusItemAtIndex:function(a){x.focusItemAtIndex(a)},focusedItemIndex:c||this.focusedItemIndex,nextChar:n,sortedIndexByFirstChar:this.sortedIndexByFirstChar,skipFocus:g,isItemAtIndexDisabled:function(a){return x.isIndexDisabled(a)}};return zy(S,this.typeaheadState)},t.prototype.typeaheadInitSortedIndex=function(){return xE(this.adapter.getListItemCount(),this.adapter.getPrimaryTextAtIndex)},t.prototype.clearTypeaheadBuffer=function(){d3(this.typeaheadState)},t}(u0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var p3=function(e){l0(t,e);function t(n){var c=e.call(this,ou(ou({},t.defaultAdapter),n))||this;return c.isSurfaceOpen=!1,c.isQuickOpen=!1,c.isHoistedElement=!1,c.isFixedPosition=!1,c.isHorizontallyCenteredOnViewport=!1,c.maxHeight=0,c.openBottomBias=0,c.openAnimationEndTimerId=0,c.closeAnimationEndTimerId=0,c.animationRequestId=0,c.anchorCorner=$d.TOP_START,c.originCorner=$d.TOP_START,c.anchorMargin={top:0,right:0,bottom:0,left:0},c.position={x:0,y:0},c}return Object.defineProperty(t,"cssClasses",{get:function(){return gE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return _E},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return Zm},enumerable:!1,configurable:!0}),Object.defineProperty(t,"Corner",{get:function(){return $d},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},hasAnchor:function(){return!1},isElementInContainer:function(){return!1},isFocused:function(){return!1},isRtl:function(){return!1},getInnerDimensions:function(){return{height:0,width:0}},getAnchorDimensions:function(){return null},getWindowDimensions:function(){return{height:0,width:0}},getBodyDimensions:function(){return{height:0,width:0}},getWindowScroll:function(){return{x:0,y:0}},setPosition:function(){},setMaxHeight:function(){},setTransformOrigin:function(){},saveFocus:function(){},restoreFocus:function(){},notifyClose:function(){},notifyClosing:function(){},notifyOpen:function(){},notifyOpening:function(){}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){var n=t.cssClasses,c=n.ROOT,g=n.OPEN;if(!this.adapter.hasClass(c))throw new Error(c+" class required in root element.");this.adapter.hasClass(g)&&(this.isSurfaceOpen=!0)},t.prototype.destroy=function(){clearTimeout(this.openAnimationEndTimerId),clearTimeout(this.closeAnimationEndTimerId),cancelAnimationFrame(this.animationRequestId)},t.prototype.setAnchorCorner=function(n){this.anchorCorner=n},t.prototype.flipCornerHorizontally=function(){this.originCorner=this.originCorner^su.RIGHT},t.prototype.setAnchorMargin=function(n){this.anchorMargin.top=n.top||0,this.anchorMargin.right=n.right||0,this.anchorMargin.bottom=n.bottom||0,this.anchorMargin.left=n.left||0},t.prototype.setIsHoisted=function(n){this.isHoistedElement=n},t.prototype.setFixedPosition=function(n){this.isFixedPosition=n},t.prototype.isFixed=function(){return this.isFixedPosition},t.prototype.setAbsolutePosition=function(n,c){this.position.x=this.isFinite(n)?n:0,this.position.y=this.isFinite(c)?c:0},t.prototype.setIsHorizontallyCenteredOnViewport=function(n){this.isHorizontallyCenteredOnViewport=n},t.prototype.setQuickOpen=function(n){this.isQuickOpen=n},t.prototype.setMaxHeight=function(n){this.maxHeight=n},t.prototype.setOpenBottomBias=function(n){this.openBottomBias=n},t.prototype.isOpen=function(){return this.isSurfaceOpen},t.prototype.open=function(){var n=this;this.isSurfaceOpen||(this.adapter.notifyOpening(),this.adapter.saveFocus(),this.isQuickOpen?(this.isSurfaceOpen=!0,this.adapter.addClass(t.cssClasses.OPEN),this.dimensions=this.adapter.getInnerDimensions(),this.autoposition(),this.adapter.notifyOpen()):(this.adapter.addClass(t.cssClasses.ANIMATING_OPEN),this.animationRequestId=requestAnimationFrame(function(){n.dimensions=n.adapter.getInnerDimensions(),n.autoposition(),n.adapter.addClass(t.cssClasses.OPEN),n.openAnimationEndTimerId=setTimeout(function(){n.openAnimationEndTimerId=0,n.adapter.removeClass(t.cssClasses.ANIMATING_OPEN),n.adapter.notifyOpen()},Zm.TRANSITION_OPEN_DURATION)}),this.isSurfaceOpen=!0))},t.prototype.close=function(n){var c=this;if(n===void 0&&(n=!1),!!this.isSurfaceOpen){if(this.adapter.notifyClosing(),this.isQuickOpen){this.isSurfaceOpen=!1,n||this.maybeRestoreFocus(),this.adapter.removeClass(t.cssClasses.OPEN),this.adapter.removeClass(t.cssClasses.IS_OPEN_BELOW),this.adapter.notifyClose();return}this.adapter.addClass(t.cssClasses.ANIMATING_CLOSED),requestAnimationFrame(function(){c.adapter.removeClass(t.cssClasses.OPEN),c.adapter.removeClass(t.cssClasses.IS_OPEN_BELOW),c.closeAnimationEndTimerId=setTimeout(function(){c.closeAnimationEndTimerId=0,c.adapter.removeClass(t.cssClasses.ANIMATING_CLOSED),c.adapter.notifyClose()},Zm.TRANSITION_CLOSE_DURATION)}),this.isSurfaceOpen=!1,n||this.maybeRestoreFocus()}},t.prototype.handleBodyClick=function(n){var c=n.target;this.adapter.isElementInContainer(c)||this.close()},t.prototype.handleKeydown=function(n){var c=n.keyCode,g=n.key,x=g==="Escape"||c===27;x&&this.close()},t.prototype.autoposition=function(){var n;this.measurements=this.getAutoLayoutmeasurements();var c=this.getoriginCorner(),g=this.getMenuSurfaceMaxHeight(c),x=this.hasBit(c,su.BOTTOM)?"bottom":"top",S=this.hasBit(c,su.RIGHT)?"right":"left",a=this.getHorizontalOriginOffset(c),U=this.getVerticalOriginOffset(c),W=this.measurements,he=W.anchorSize,ae=W.surfaceSize,ce=(n={},n[S]=a,n[x]=U,n);he.width/ae.width>Zm.ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO&&(S="center"),(this.isHoistedElement||this.isFixedPosition)&&this.adjustPositionForHoistedElement(ce),this.adapter.setTransformOrigin(S+" "+x),this.adapter.setPosition(ce),this.adapter.setMaxHeight(g?g+"px":""),this.hasBit(c,su.BOTTOM)||this.adapter.addClass(t.cssClasses.IS_OPEN_BELOW)},t.prototype.getAutoLayoutmeasurements=function(){var n=this.adapter.getAnchorDimensions(),c=this.adapter.getBodyDimensions(),g=this.adapter.getWindowDimensions(),x=this.adapter.getWindowScroll();return n||(n={top:this.position.y,right:this.position.x,bottom:this.position.y,left:this.position.x,width:0,height:0}),{anchorSize:n,bodySize:c,surfaceSize:this.dimensions,viewportDistance:{top:n.top,right:g.width-n.right,bottom:g.height-n.bottom,left:n.left},viewportSize:g,windowScroll:x}},t.prototype.getoriginCorner=function(){var n=this.originCorner,c=this.measurements,g=c.viewportDistance,x=c.anchorSize,S=c.surfaceSize,a=t.numbers.MARGIN_TO_EDGE,U=this.hasBit(this.anchorCorner,su.BOTTOM),W,he;U?(W=g.top-a+this.anchorMargin.bottom,he=g.bottom-a-this.anchorMargin.bottom):(W=g.top-a+this.anchorMargin.top,he=g.bottom-a+x.height-this.anchorMargin.top);var ae=he-S.height>0;!ae&&W>he+this.openBottomBias&&(n=this.setBit(n,su.BOTTOM));var ce=this.adapter.isRtl(),be=this.hasBit(this.anchorCorner,su.FLIP_RTL),Je=this.hasBit(this.anchorCorner,su.RIGHT)||this.hasBit(n,su.RIGHT),st=!1;ce&&be?st=!Je:st=Je;var Ye,it;st?(Ye=g.left+x.width+this.anchorMargin.right,it=g.right-this.anchorMargin.right):(Ye=g.left+this.anchorMargin.left,it=g.right+x.width-this.anchorMargin.left);var ct=Ye-S.width>0,Tt=it-S.width>0,zt=this.hasBit(n,su.FLIP_RTL)&&this.hasBit(n,su.RIGHT);return Tt&&zt&&ce||!ct&&zt?n=this.unsetBit(n,su.RIGHT):(ct&&st&&ce||ct&&!st&&Je||!Tt&&Ye>=it)&&(n=this.setBit(n,su.RIGHT)),n},t.prototype.getMenuSurfaceMaxHeight=function(n){if(this.maxHeight>0)return this.maxHeight;var c=this.measurements.viewportDistance,g=0,x=this.hasBit(n,su.BOTTOM),S=this.hasBit(this.anchorCorner,su.BOTTOM),a=t.numbers.MARGIN_TO_EDGE;return x?(g=c.top+this.anchorMargin.top-a,S||(g+=this.measurements.anchorSize.height)):(g=c.bottom-this.anchorMargin.bottom+this.measurements.anchorSize.height-a,S&&(g-=this.measurements.anchorSize.height)),g},t.prototype.getHorizontalOriginOffset=function(n){var c=this.measurements.anchorSize,g=this.hasBit(n,su.RIGHT),x=this.hasBit(this.anchorCorner,su.RIGHT);if(g){var S=x?c.width-this.anchorMargin.left:this.anchorMargin.right;return this.isHoistedElement||this.isFixedPosition?S-(this.measurements.viewportSize.width-this.measurements.bodySize.width):S}return x?c.width-this.anchorMargin.right:this.anchorMargin.left},t.prototype.getVerticalOriginOffset=function(n){var c=this.measurements.anchorSize,g=this.hasBit(n,su.BOTTOM),x=this.hasBit(this.anchorCorner,su.BOTTOM),S=0;return g?S=x?c.height-this.anchorMargin.top:-this.anchorMargin.bottom:S=x?c.height+this.anchorMargin.bottom:this.anchorMargin.top,S},t.prototype.adjustPositionForHoistedElement=function(n){var c,g,x=this.measurements,S=x.windowScroll,a=x.viewportDistance,U=x.surfaceSize,W=x.viewportSize,he=Object.keys(n);try{for(var ae=ng(he),ce=ae.next();!ce.done;ce=ae.next()){var be=ce.value,Je=n[be]||0;if(this.isHorizontallyCenteredOnViewport&&(be==="left"||be==="right")){n[be]=(W.width-U.width)/2;continue}Je+=a[be],this.isFixedPosition||(be==="top"?Je+=S.y:be==="bottom"?Je-=S.y:be==="left"?Je+=S.x:Je-=S.x),n[be]=Je}}catch(st){c={error:st}}finally{try{ce&&!ce.done&&(g=ae.return)&&g.call(ae)}finally{if(c)throw c.error}}},t.prototype.maybeRestoreFocus=function(){var n=this,c=this.adapter.isFocused(),g=this.adapter.getOwnerDocument?this.adapter.getOwnerDocument():document,x=g.activeElement&&this.adapter.isElementInContainer(g.activeElement);(c||x)&&setTimeout(function(){n.adapter.restoreFocus()},Zm.TOUCH_EVENT_WAIT_MS)},t.prototype.hasBit=function(n,c){return!!(n&c)},t.prototype.setBit=function(n,c){return n|c},t.prototype.unsetBit=function(n,c){return n^c},t.prototype.isFinite=function(n){return typeof n=="number"&&isFinite(n)},t}(u0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var lm={MENU_SELECTED_LIST_ITEM:"mdc-menu-item--selected",MENU_SELECTION_GROUP:"mdc-menu__selection-group",ROOT:"mdc-menu"},Qp={ARIA_CHECKED_ATTR:"aria-checked",ARIA_DISABLED_ATTR:"aria-disabled",CHECKBOX_SELECTOR:'input[type="checkbox"]',LIST_SELECTOR:".mdc-list,.mdc-deprecated-list",SELECTED_EVENT:"MDCMenu:selected",SKIP_RESTORE_FOCUS:"data-menu-item-skip-restore-focus"},CE={FOCUS_ROOT_INDEX:-1},tm;(function(e){e[e.NONE=0]="NONE",e[e.LIST_ROOT=1]="LIST_ROOT",e[e.FIRST_ITEM=2]="FIRST_ITEM",e[e.LAST_ITEM=3]="LAST_ITEM"})(tm||(tm={}));/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var TE=function(e){l0(t,e);function t(n){var c=e.call(this,ou(ou({},t.defaultAdapter),n))||this;return c.closeAnimationEndTimerId=0,c.defaultFocusState=tm.LIST_ROOT,c.selectedIndex=-1,c}return Object.defineProperty(t,"cssClasses",{get:function(){return lm},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return Qp},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return CE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClassToElementAtIndex:function(){},removeClassFromElementAtIndex:function(){},addAttributeToElementAtIndex:function(){},removeAttributeFromElementAtIndex:function(){},getAttributeFromElementAtIndex:function(){return null},elementContainsClass:function(){return!1},closeSurface:function(){},getElementIndex:function(){return-1},notifySelected:function(){},getMenuItemCount:function(){return 0},focusItemAtIndex:function(){},focusListRoot:function(){},getSelectedSiblingOfItemAtIndex:function(){return-1},isSelectableItemAtIndex:function(){return!1}}},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){this.closeAnimationEndTimerId&&clearTimeout(this.closeAnimationEndTimerId),this.adapter.closeSurface()},t.prototype.handleKeydown=function(n){var c=n.key,g=n.keyCode,x=c==="Tab"||g===9;x&&this.adapter.closeSurface(!0)},t.prototype.handleItemAction=function(n){var c=this,g=this.adapter.getElementIndex(n);if(!(g<0)){this.adapter.notifySelected({index:g});var x=this.adapter.getAttributeFromElementAtIndex(g,Qp.SKIP_RESTORE_FOCUS)==="true";this.adapter.closeSurface(x),this.closeAnimationEndTimerId=setTimeout(function(){var S=c.adapter.getElementIndex(n);S>=0&&c.adapter.isSelectableItemAtIndex(S)&&c.setSelectedIndex(S)},p3.numbers.TRANSITION_CLOSE_DURATION)}},t.prototype.handleMenuSurfaceOpened=function(){switch(this.defaultFocusState){case tm.FIRST_ITEM:this.adapter.focusItemAtIndex(0);break;case tm.LAST_ITEM:this.adapter.focusItemAtIndex(this.adapter.getMenuItemCount()-1);break;case tm.NONE:break;default:this.adapter.focusListRoot();break}},t.prototype.setDefaultFocusState=function(n){this.defaultFocusState=n},t.prototype.getSelectedIndex=function(){return this.selectedIndex},t.prototype.setSelectedIndex=function(n){if(this.validatedIndex(n),!this.adapter.isSelectableItemAtIndex(n))throw new Error("MDCMenuFoundation: No selection group at specified index.");var c=this.adapter.getSelectedSiblingOfItemAtIndex(n);c>=0&&(this.adapter.removeAttributeFromElementAtIndex(c,Qp.ARIA_CHECKED_ATTR),this.adapter.removeClassFromElementAtIndex(c,lm.MENU_SELECTED_LIST_ITEM)),this.adapter.addClassToElementAtIndex(n,lm.MENU_SELECTED_LIST_ITEM),this.adapter.addAttributeToElementAtIndex(n,Qp.ARIA_CHECKED_ATTR,"true"),this.selectedIndex=n},t.prototype.setEnabled=function(n,c){this.validatedIndex(n),c?(this.adapter.removeClassFromElementAtIndex(n,la.LIST_ITEM_DISABLED_CLASS),this.adapter.addAttributeToElementAtIndex(n,Qp.ARIA_DISABLED_ATTR,"false")):(this.adapter.addClassToElementAtIndex(n,la.LIST_ITEM_DISABLED_CLASS),this.adapter.addAttributeToElementAtIndex(n,Qp.ARIA_DISABLED_ATTR,"true"))},t.prototype.validatedIndex=function(n){var c=this.adapter.getMenuItemCount(),g=n>=0&&n<c;if(!g)throw new Error("MDCMenuFoundation: No list item at specified index.")},t}(u0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var kE={NOTCH_ELEMENT_SELECTOR:".mdc-notched-outline__notch"},Z2={NOTCH_ELEMENT_PADDING:8},ME={NO_LABEL:"mdc-notched-outline--no-label",OUTLINE_NOTCHED:"mdc-notched-outline--notched",OUTLINE_UPGRADED:"mdc-notched-outline--upgraded"};/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var PE=function(e){l0(t,e);function t(n){return e.call(this,ou(ou({},t.defaultAdapter),n))||this}return Object.defineProperty(t,"strings",{get:function(){return kE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"cssClasses",{get:function(){return ME},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return Z2},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},setNotchWidthProperty:function(){},removeNotchWidthProperty:function(){}}},enumerable:!1,configurable:!0}),t.prototype.notch=function(n){var c=t.cssClasses.OUTLINE_NOTCHED;n>0&&(n+=Z2.NOTCH_ELEMENT_PADDING),this.adapter.setNotchWidthProperty(n),this.adapter.addClass(c)},t.prototype.closeNotch=function(){var n=t.cssClasses.OUTLINE_NOTCHED;this.adapter.removeClass(n),this.adapter.removeNotchWidthProperty()},t}(u0);/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function DE(e){return e===void 0&&(e=window),LE(e)?{passive:!0}:!1}function LE(e){e===void 0&&(e=window);var t=!1;try{var n={get passive(){return t=!0,!1}},c=function(){};e.document.addEventListener("test",c,n),e.document.removeEventListener("test",c,n)}catch{t=!1}return t}const BE=Object.freeze(Object.defineProperty({__proto__:null,applyPassive:DE},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var zE={BG_FOCUSED:"mdc-ripple-upgraded--background-focused",FG_ACTIVATION:"mdc-ripple-upgraded--foreground-activation",FG_DEACTIVATION:"mdc-ripple-upgraded--foreground-deactivation",ROOT:"mdc-ripple-upgraded",UNBOUNDED:"mdc-ripple-upgraded--unbounded"},RE={VAR_FG_SCALE:"--mdc-ripple-fg-scale",VAR_FG_SIZE:"--mdc-ripple-fg-size",VAR_FG_TRANSLATE_END:"--mdc-ripple-fg-translate-end",VAR_FG_TRANSLATE_START:"--mdc-ripple-fg-translate-start",VAR_LEFT:"--mdc-ripple-left",VAR_TOP:"--mdc-ripple-top"},Q2={DEACTIVATION_TIMEOUT_MS:225,FG_DEACTIVATION_MS:150,INITIAL_ORIGIN_SCALE:.6,PADDING:10,TAP_DELAY_MS:300},Og;function FE(e,t){t===void 0&&(t=!1);var n=e.CSS,c=Og;if(typeof Og=="boolean"&&!t)return Og;var g=n&&typeof n.supports=="function";if(!g)return!1;var x=n.supports("--css-vars","yes"),S=n.supports("(--css-vars: yes)")&&n.supports("color","#00000000");return c=x||S,t||(Og=c),c}function OE(e,t,n){if(!e)return{x:0,y:0};var c=t.x,g=t.y,x=c+n.left,S=g+n.top,a,U;if(e.type==="touchstart"){var W=e;a=W.changedTouches[0].pageX-x,U=W.changedTouches[0].pageY-S}else{var he=e;a=he.pageX-x,U=he.pageY-S}return{x:a,y:U}}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var W2=["touchstart","pointerdown","mousedown","keydown"],$2=["touchend","pointerup","mouseup","contextmenu"],Ng=[],NE=function(e){l0(t,e);function t(n){var c=e.call(this,ou(ou({},t.defaultAdapter),n))||this;return c.activationAnimationHasEnded=!1,c.activationTimer=0,c.fgDeactivationRemovalTimer=0,c.fgScale="0",c.frame={width:0,height:0},c.initialSize=0,c.layoutFrame=0,c.maxRadius=0,c.unboundedCoords={left:0,top:0},c.activationState=c.defaultActivationState(),c.activationTimerCallback=function(){c.activationAnimationHasEnded=!0,c.runDeactivationUXLogicIfReady()},c.activateHandler=function(g){c.activateImpl(g)},c.deactivateHandler=function(){c.deactivateImpl()},c.focusHandler=function(){c.handleFocus()},c.blurHandler=function(){c.handleBlur()},c.resizeHandler=function(){c.layout()},c}return Object.defineProperty(t,"cssClasses",{get:function(){return zE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return RE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return Q2},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},browserSupportsCssVars:function(){return!0},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},containsEventTarget:function(){return!0},deregisterDocumentInteractionHandler:function(){},deregisterInteractionHandler:function(){},deregisterResizeHandler:function(){},getWindowPageOffset:function(){return{x:0,y:0}},isSurfaceActive:function(){return!0},isSurfaceDisabled:function(){return!0},isUnbounded:function(){return!0},registerDocumentInteractionHandler:function(){},registerInteractionHandler:function(){},registerResizeHandler:function(){},removeClass:function(){},updateCssVariable:function(){}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){var n=this,c=this.supportsPressRipple();if(this.registerRootHandlers(c),c){var g=t.cssClasses,x=g.ROOT,S=g.UNBOUNDED;requestAnimationFrame(function(){n.adapter.addClass(x),n.adapter.isUnbounded()&&(n.adapter.addClass(S),n.layoutInternal())})}},t.prototype.destroy=function(){var n=this;if(this.supportsPressRipple()){this.activationTimer&&(clearTimeout(this.activationTimer),this.activationTimer=0,this.adapter.removeClass(t.cssClasses.FG_ACTIVATION)),this.fgDeactivationRemovalTimer&&(clearTimeout(this.fgDeactivationRemovalTimer),this.fgDeactivationRemovalTimer=0,this.adapter.removeClass(t.cssClasses.FG_DEACTIVATION));var c=t.cssClasses,g=c.ROOT,x=c.UNBOUNDED;requestAnimationFrame(function(){n.adapter.removeClass(g),n.adapter.removeClass(x),n.removeCssVars()})}this.deregisterRootHandlers(),this.deregisterDeactivationHandlers()},t.prototype.activate=function(n){this.activateImpl(n)},t.prototype.deactivate=function(){this.deactivateImpl()},t.prototype.layout=function(){var n=this;this.layoutFrame&&cancelAnimationFrame(this.layoutFrame),this.layoutFrame=requestAnimationFrame(function(){n.layoutInternal(),n.layoutFrame=0})},t.prototype.setUnbounded=function(n){var c=t.cssClasses.UNBOUNDED;n?this.adapter.addClass(c):this.adapter.removeClass(c)},t.prototype.handleFocus=function(){var n=this;requestAnimationFrame(function(){return n.adapter.addClass(t.cssClasses.BG_FOCUSED)})},t.prototype.handleBlur=function(){var n=this;requestAnimationFrame(function(){return n.adapter.removeClass(t.cssClasses.BG_FOCUSED)})},t.prototype.supportsPressRipple=function(){return this.adapter.browserSupportsCssVars()},t.prototype.defaultActivationState=function(){return{activationEvent:void 0,hasDeactivationUXRun:!1,isActivated:!1,isProgrammatic:!1,wasActivatedByPointer:!1,wasElementMadeActive:!1}},t.prototype.registerRootHandlers=function(n){var c,g;if(n){try{for(var x=ng(W2),S=x.next();!S.done;S=x.next()){var a=S.value;this.adapter.registerInteractionHandler(a,this.activateHandler)}}catch(U){c={error:U}}finally{try{S&&!S.done&&(g=x.return)&&g.call(x)}finally{if(c)throw c.error}}this.adapter.isUnbounded()&&this.adapter.registerResizeHandler(this.resizeHandler)}this.adapter.registerInteractionHandler("focus",this.focusHandler),this.adapter.registerInteractionHandler("blur",this.blurHandler)},t.prototype.registerDeactivationHandlers=function(n){var c,g;if(n.type==="keydown")this.adapter.registerInteractionHandler("keyup",this.deactivateHandler);else try{for(var x=ng($2),S=x.next();!S.done;S=x.next()){var a=S.value;this.adapter.registerDocumentInteractionHandler(a,this.deactivateHandler)}}catch(U){c={error:U}}finally{try{S&&!S.done&&(g=x.return)&&g.call(x)}finally{if(c)throw c.error}}},t.prototype.deregisterRootHandlers=function(){var n,c;try{for(var g=ng(W2),x=g.next();!x.done;x=g.next()){var S=x.value;this.adapter.deregisterInteractionHandler(S,this.activateHandler)}}catch(a){n={error:a}}finally{try{x&&!x.done&&(c=g.return)&&c.call(g)}finally{if(n)throw n.error}}this.adapter.deregisterInteractionHandler("focus",this.focusHandler),this.adapter.deregisterInteractionHandler("blur",this.blurHandler),this.adapter.isUnbounded()&&this.adapter.deregisterResizeHandler(this.resizeHandler)},t.prototype.deregisterDeactivationHandlers=function(){var n,c;this.adapter.deregisterInteractionHandler("keyup",this.deactivateHandler);try{for(var g=ng($2),x=g.next();!x.done;x=g.next()){var S=x.value;this.adapter.deregisterDocumentInteractionHandler(S,this.deactivateHandler)}}catch(a){n={error:a}}finally{try{x&&!x.done&&(c=g.return)&&c.call(g)}finally{if(n)throw n.error}}},t.prototype.removeCssVars=function(){var n=this,c=t.strings,g=Object.keys(c);g.forEach(function(x){x.indexOf("VAR_")===0&&n.adapter.updateCssVariable(c[x],null)})},t.prototype.activateImpl=function(n){var c=this;if(!this.adapter.isSurfaceDisabled()){var g=this.activationState;if(!g.isActivated){var x=this.previousActivationEvent,S=x&&n!==void 0&&x.type!==n.type;if(!S){g.isActivated=!0,g.isProgrammatic=n===void 0,g.activationEvent=n,g.wasActivatedByPointer=g.isProgrammatic?!1:n!==void 0&&(n.type==="mousedown"||n.type==="touchstart"||n.type==="pointerdown");var a=n!==void 0&&Ng.length>0&&Ng.some(function(U){return c.adapter.containsEventTarget(U)});if(a){this.resetActivationState();return}n!==void 0&&(Ng.push(n.target),this.registerDeactivationHandlers(n)),g.wasElementMadeActive=this.checkElementMadeActive(n),g.wasElementMadeActive&&this.animateActivation(),requestAnimationFrame(function(){Ng=[],!g.wasElementMadeActive&&n!==void 0&&(n.key===" "||n.keyCode===32)&&(g.wasElementMadeActive=c.checkElementMadeActive(n),g.wasElementMadeActive&&c.animateActivation()),g.wasElementMadeActive||(c.activationState=c.defaultActivationState())})}}}},t.prototype.checkElementMadeActive=function(n){return n!==void 0&&n.type==="keydown"?this.adapter.isSurfaceActive():!0},t.prototype.animateActivation=function(){var n=this,c=t.strings,g=c.VAR_FG_TRANSLATE_START,x=c.VAR_FG_TRANSLATE_END,S=t.cssClasses,a=S.FG_DEACTIVATION,U=S.FG_ACTIVATION,W=t.numbers.DEACTIVATION_TIMEOUT_MS;this.layoutInternal();var he="",ae="";if(!this.adapter.isUnbounded()){var ce=this.getFgTranslationCoordinates(),be=ce.startPoint,Je=ce.endPoint;he=be.x+"px, "+be.y+"px",ae=Je.x+"px, "+Je.y+"px"}this.adapter.updateCssVariable(g,he),this.adapter.updateCssVariable(x,ae),clearTimeout(this.activationTimer),clearTimeout(this.fgDeactivationRemovalTimer),this.rmBoundedActivationClasses(),this.adapter.removeClass(a),this.adapter.computeBoundingRect(),this.adapter.addClass(U),this.activationTimer=setTimeout(function(){n.activationTimerCallback()},W)},t.prototype.getFgTranslationCoordinates=function(){var n=this.activationState,c=n.activationEvent,g=n.wasActivatedByPointer,x;g?x=OE(c,this.adapter.getWindowPageOffset(),this.adapter.computeBoundingRect()):x={x:this.frame.width/2,y:this.frame.height/2},x={x:x.x-this.initialSize/2,y:x.y-this.initialSize/2};var S={x:this.frame.width/2-this.initialSize/2,y:this.frame.height/2-this.initialSize/2};return{startPoint:x,endPoint:S}},t.prototype.runDeactivationUXLogicIfReady=function(){var n=this,c=t.cssClasses.FG_DEACTIVATION,g=this.activationState,x=g.hasDeactivationUXRun,S=g.isActivated,a=x||!S;a&&this.activationAnimationHasEnded&&(this.rmBoundedActivationClasses(),this.adapter.addClass(c),this.fgDeactivationRemovalTimer=setTimeout(function(){n.adapter.removeClass(c)},Q2.FG_DEACTIVATION_MS))},t.prototype.rmBoundedActivationClasses=function(){var n=t.cssClasses.FG_ACTIVATION;this.adapter.removeClass(n),this.activationAnimationHasEnded=!1,this.adapter.computeBoundingRect()},t.prototype.resetActivationState=function(){var n=this;this.previousActivationEvent=this.activationState.activationEvent,this.activationState=this.defaultActivationState(),setTimeout(function(){return n.previousActivationEvent=void 0},t.numbers.TAP_DELAY_MS)},t.prototype.deactivateImpl=function(){var n=this,c=this.activationState;if(c.isActivated){var g=ou({},c);c.isProgrammatic?(requestAnimationFrame(function(){n.animateDeactivation(g)}),this.resetActivationState()):(this.deregisterDeactivationHandlers(),requestAnimationFrame(function(){n.activationState.hasDeactivationUXRun=!0,n.animateDeactivation(g),n.resetActivationState()}))}},t.prototype.animateDeactivation=function(n){var c=n.wasActivatedByPointer,g=n.wasElementMadeActive;(c||g)&&this.runDeactivationUXLogicIfReady()},t.prototype.layoutInternal=function(){var n=this;this.frame=this.adapter.computeBoundingRect();var c=Math.max(this.frame.height,this.frame.width),g=function(){var S=Math.sqrt(Math.pow(n.frame.width,2)+Math.pow(n.frame.height,2));return S+t.numbers.PADDING};this.maxRadius=this.adapter.isUnbounded()?c:g();var x=Math.floor(c*t.numbers.INITIAL_ORIGIN_SCALE);this.adapter.isUnbounded()&&x%2!==0?this.initialSize=x-1:this.initialSize=x,this.fgScale=""+this.maxRadius/this.initialSize,this.updateLayoutCssVars()},t.prototype.updateLayoutCssVars=function(){var n=t.strings,c=n.VAR_FG_SIZE,g=n.VAR_LEFT,x=n.VAR_TOP,S=n.VAR_FG_SCALE;this.adapter.updateCssVariable(c,this.initialSize+"px"),this.adapter.updateCssVariable(S,this.fgScale),this.adapter.isUnbounded()&&(this.unboundedCoords={left:Math.round(this.frame.width/2-this.initialSize/2),top:Math.round(this.frame.height/2-this.initialSize/2)},this.adapter.updateCssVariable(g,this.unboundedCoords.left+"px"),this.adapter.updateCssVariable(x,this.unboundedCoords.top+"px"))},t}(u0);/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Rl={ACTIVATED:"mdc-select--activated",DISABLED:"mdc-select--disabled",FOCUSED:"mdc-select--focused",INVALID:"mdc-select--invalid",MENU_INVALID:"mdc-select__menu--invalid",OUTLINED:"mdc-select--outlined",REQUIRED:"mdc-select--required",ROOT:"mdc-select",WITH_LEADING_ICON:"mdc-select--with-leading-icon"},k1={ARIA_CONTROLS:"aria-controls",ARIA_DESCRIBEDBY:"aria-describedby",ARIA_SELECTED_ATTR:"aria-selected",CHANGE_EVENT:"MDCSelect:change",HIDDEN_INPUT_SELECTOR:'input[type="hidden"]',LABEL_SELECTOR:".mdc-floating-label",LEADING_ICON_SELECTOR:".mdc-select__icon",LINE_RIPPLE_SELECTOR:".mdc-line-ripple",MENU_SELECTOR:".mdc-select__menu",OUTLINE_SELECTOR:".mdc-notched-outline",SELECTED_TEXT_SELECTOR:".mdc-select__selected-text",SELECT_ANCHOR_SELECTOR:".mdc-select__anchor",VALUE_ATTR:"data-value"},Gd={LABEL_SCALE:.75,UNSET_INDEX:-1,CLICK_DEBOUNCE_TIMEOUT_MS:330};/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var VE=function(e){l0(t,e);function t(n,c){c===void 0&&(c={});var g=e.call(this,ou(ou({},t.defaultAdapter),n))||this;return g.disabled=!1,g.isMenuOpen=!1,g.useDefaultValidation=!0,g.customValidity=!0,g.lastSelectedIndex=Gd.UNSET_INDEX,g.clickDebounceTimeout=0,g.recentlyClicked=!1,g.leadingIcon=c.leadingIcon,g.helperText=c.helperText,g}return Object.defineProperty(t,"cssClasses",{get:function(){return Rl},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return Gd},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return k1},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},activateBottomLine:function(){},deactivateBottomLine:function(){},getSelectedIndex:function(){return-1},setSelectedIndex:function(){},hasLabel:function(){return!1},floatLabel:function(){},getLabelWidth:function(){return 0},setLabelRequired:function(){},hasOutline:function(){return!1},notchOutline:function(){},closeOutline:function(){},setRippleCenter:function(){},notifyChange:function(){},setSelectedText:function(){},isSelectAnchorFocused:function(){return!1},getSelectAnchorAttr:function(){return""},setSelectAnchorAttr:function(){},removeSelectAnchorAttr:function(){},addMenuClass:function(){},removeMenuClass:function(){},openMenu:function(){},closeMenu:function(){},getAnchorElement:function(){return null},setMenuAnchorElement:function(){},setMenuAnchorCorner:function(){},setMenuWrapFocus:function(){},focusMenuItemAtIndex:function(){},getMenuItemCount:function(){return 0},getMenuItemValues:function(){return[]},getMenuItemTextAtIndex:function(){return""},isTypeaheadInProgress:function(){return!1},typeaheadMatchItem:function(){return-1}}},enumerable:!1,configurable:!0}),t.prototype.getSelectedIndex=function(){return this.adapter.getSelectedIndex()},t.prototype.setSelectedIndex=function(n,c,g){c===void 0&&(c=!1),g===void 0&&(g=!1),!(n>=this.adapter.getMenuItemCount())&&(n===Gd.UNSET_INDEX?this.adapter.setSelectedText(""):this.adapter.setSelectedText(this.adapter.getMenuItemTextAtIndex(n).trim()),this.adapter.setSelectedIndex(n),c&&this.adapter.closeMenu(),!g&&this.lastSelectedIndex!==n&&this.handleChange(),this.lastSelectedIndex=n)},t.prototype.setValue=function(n,c){c===void 0&&(c=!1);var g=this.adapter.getMenuItemValues().indexOf(n);this.setSelectedIndex(g,!1,c)},t.prototype.getValue=function(){var n=this.adapter.getSelectedIndex(),c=this.adapter.getMenuItemValues();return n!==Gd.UNSET_INDEX?c[n]:""},t.prototype.getDisabled=function(){return this.disabled},t.prototype.setDisabled=function(n){this.disabled=n,this.disabled?(this.adapter.addClass(Rl.DISABLED),this.adapter.closeMenu()):this.adapter.removeClass(Rl.DISABLED),this.leadingIcon&&this.leadingIcon.setDisabled(this.disabled),this.disabled?this.adapter.removeSelectAnchorAttr("tabindex"):this.adapter.setSelectAnchorAttr("tabindex","0"),this.adapter.setSelectAnchorAttr("aria-disabled",this.disabled.toString())},t.prototype.openMenu=function(){this.adapter.addClass(Rl.ACTIVATED),this.adapter.openMenu(),this.isMenuOpen=!0,this.adapter.setSelectAnchorAttr("aria-expanded","true")},t.prototype.setHelperTextContent=function(n){this.helperText&&this.helperText.setContent(n)},t.prototype.layout=function(){if(this.adapter.hasLabel()){var n=this.getValue().length>0,c=this.adapter.hasClass(Rl.FOCUSED),g=n||c,x=this.adapter.hasClass(Rl.REQUIRED);this.notchOutline(g),this.adapter.floatLabel(g),this.adapter.setLabelRequired(x)}},t.prototype.layoutOptions=function(){var n=this.adapter.getMenuItemValues(),c=n.indexOf(this.getValue());this.setSelectedIndex(c,!1,!0)},t.prototype.handleMenuOpened=function(){if(this.adapter.getMenuItemValues().length!==0){var n=this.getSelectedIndex(),c=n>=0?n:0;this.adapter.focusMenuItemAtIndex(c)}},t.prototype.handleMenuClosing=function(){this.adapter.setSelectAnchorAttr("aria-expanded","false")},t.prototype.handleMenuClosed=function(){this.adapter.removeClass(Rl.ACTIVATED),this.isMenuOpen=!1,this.adapter.isSelectAnchorFocused()||this.blur()},t.prototype.handleChange=function(){this.layout(),this.adapter.notifyChange(this.getValue());var n=this.adapter.hasClass(Rl.REQUIRED);n&&this.useDefaultValidation&&this.setValid(this.isValid())},t.prototype.handleMenuItemAction=function(n){this.setSelectedIndex(n,!0)},t.prototype.handleFocus=function(){this.adapter.addClass(Rl.FOCUSED),this.layout(),this.adapter.activateBottomLine()},t.prototype.handleBlur=function(){this.isMenuOpen||this.blur()},t.prototype.handleClick=function(n){if(!(this.disabled||this.recentlyClicked)){if(this.setClickDebounceTimeout(),this.isMenuOpen){this.adapter.closeMenu();return}this.adapter.setRippleCenter(n),this.openMenu()}},t.prototype.handleKeydown=function(n){if(!(this.isMenuOpen||!this.adapter.hasClass(Rl.FOCUSED))){var c=fu(n)===Ns.ENTER,g=fu(n)===Ns.SPACEBAR,x=fu(n)===Ns.ARROW_UP,S=fu(n)===Ns.ARROW_DOWN,a=n.ctrlKey||n.metaKey;if(!a&&(!g&&n.key&&n.key.length===1||g&&this.adapter.isTypeaheadInProgress())){var U=g?" ":n.key,W=this.adapter.typeaheadMatchItem(U,this.getSelectedIndex());W>=0&&this.setSelectedIndex(W),n.preventDefault();return}!c&&!g&&!x&&!S||(this.openMenu(),n.preventDefault())}},t.prototype.notchOutline=function(n){if(this.adapter.hasOutline()){var c=this.adapter.hasClass(Rl.FOCUSED);if(n){var g=Gd.LABEL_SCALE,x=this.adapter.getLabelWidth()*g;this.adapter.notchOutline(x)}else c||this.adapter.closeOutline()}},t.prototype.setLeadingIconAriaLabel=function(n){this.leadingIcon&&this.leadingIcon.setAriaLabel(n)},t.prototype.setLeadingIconContent=function(n){this.leadingIcon&&this.leadingIcon.setContent(n)},t.prototype.getUseDefaultValidation=function(){return this.useDefaultValidation},t.prototype.setUseDefaultValidation=function(n){this.useDefaultValidation=n},t.prototype.setValid=function(n){this.useDefaultValidation||(this.customValidity=n),this.adapter.setSelectAnchorAttr("aria-invalid",(!n).toString()),n?(this.adapter.removeClass(Rl.INVALID),this.adapter.removeMenuClass(Rl.MENU_INVALID)):(this.adapter.addClass(Rl.INVALID),this.adapter.addMenuClass(Rl.MENU_INVALID)),this.syncHelperTextValidity(n)},t.prototype.isValid=function(){return this.useDefaultValidation&&this.adapter.hasClass(Rl.REQUIRED)&&!this.adapter.hasClass(Rl.DISABLED)?this.getSelectedIndex()!==Gd.UNSET_INDEX&&(this.getSelectedIndex()!==0||!!this.getValue()):this.customValidity},t.prototype.setRequired=function(n){n?this.adapter.addClass(Rl.REQUIRED):this.adapter.removeClass(Rl.REQUIRED),this.adapter.setSelectAnchorAttr("aria-required",n.toString()),this.adapter.setLabelRequired(n)},t.prototype.getRequired=function(){return this.adapter.getSelectAnchorAttr("aria-required")==="true"},t.prototype.init=function(){var n=this.adapter.getAnchorElement();n&&(this.adapter.setMenuAnchorElement(n),this.adapter.setMenuAnchorCorner($d.BOTTOM_START)),this.adapter.setMenuWrapFocus(!1),this.setDisabled(this.adapter.hasClass(Rl.DISABLED)),this.syncHelperTextValidity(!this.adapter.hasClass(Rl.INVALID)),this.layout(),this.layoutOptions()},t.prototype.blur=function(){this.adapter.removeClass(Rl.FOCUSED),this.layout(),this.adapter.deactivateBottomLine();var n=this.adapter.hasClass(Rl.REQUIRED);n&&this.useDefaultValidation&&this.setValid(this.isValid())},t.prototype.syncHelperTextValidity=function(n){if(this.helperText){this.helperText.setValidity(n);var c=this.helperText.isVisible(),g=this.helperText.getId();c&&g?this.adapter.setSelectAnchorAttr(k1.ARIA_DESCRIBEDBY,g):this.adapter.removeSelectAnchorAttr(k1.ARIA_DESCRIBEDBY)}},t.prototype.setClickDebounceTimeout=function(){var n=this;clearTimeout(this.clickDebounceTimeout),this.clickDebounceTimeout=setTimeout(function(){n.recentlyClicked=!1},Gd.CLICK_DEBOUNCE_TIMEOUT_MS),this.recentlyClicked=!0},t}(u0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var qd={ARIA_HIDDEN:"aria-hidden",ROLE:"role"},Zf={HELPER_TEXT_VALIDATION_MSG:"mdc-select-helper-text--validation-msg",HELPER_TEXT_VALIDATION_MSG_PERSISTENT:"mdc-select-helper-text--validation-msg-persistent"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var UE=function(e){l0(t,e);function t(n){return e.call(this,ou(ou({},t.defaultAdapter),n))||this}return Object.defineProperty(t,"cssClasses",{get:function(){return Zf},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return qd},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setAttr:function(){},getAttr:function(){return null},removeAttr:function(){},setContent:function(){}}},enumerable:!1,configurable:!0}),t.prototype.getId=function(){return this.adapter.getAttr("id")},t.prototype.isVisible=function(){return this.adapter.getAttr(qd.ARIA_HIDDEN)!=="true"},t.prototype.setContent=function(n){this.adapter.setContent(n)},t.prototype.setValidation=function(n){n?this.adapter.addClass(Zf.HELPER_TEXT_VALIDATION_MSG):this.adapter.removeClass(Zf.HELPER_TEXT_VALIDATION_MSG)},t.prototype.setValidationMsgPersistent=function(n){n?this.adapter.addClass(Zf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT):this.adapter.removeClass(Zf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT)},t.prototype.getIsValidation=function(){return this.adapter.hasClass(Zf.HELPER_TEXT_VALIDATION_MSG)},t.prototype.getIsValidationMsgPersistent=function(){return this.adapter.hasClass(Zf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT)},t.prototype.setValidity=function(n){var c=this.adapter.hasClass(Zf.HELPER_TEXT_VALIDATION_MSG);if(c){var g=this.adapter.hasClass(Zf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT),x=!n||g;if(x){this.showToScreenReader(),n?this.adapter.removeAttr(qd.ROLE):this.adapter.setAttr(qd.ROLE,"alert");return}this.adapter.removeAttr(qd.ROLE),this.hide()}},t.prototype.showToScreenReader=function(){this.adapter.removeAttr(qd.ARIA_HIDDEN)},t.prototype.hide=function(){this.adapter.setAttr(qd.ARIA_HIDDEN,"true")},t}(u0);function Ts(e){return Object.entries(e).filter(([t,n])=>t!==""&&n).map(([t])=>t).join(" ")}function au(e,t,n,c={bubbles:!0},g=!1){if(typeof Event>"u")throw new Error("Event not defined.");if(!e)throw new Error("Tried to dipatch event without element.");const x=new CustomEvent(t,Object.assign(Object.assign({},c),{detail:n}));if(e==null||e.dispatchEvent(x),g&&t.startsWith("SMUI")){const S=new CustomEvent(t.replace(/^SMUI/g,()=>"MDC"),Object.assign(Object.assign({},c),{detail:n}));e==null||e.dispatchEvent(S),S.defaultPrevented&&x.preventDefault()}return x}function X2(e,t){let n=Object.getOwnPropertyNames(e);const c={};for(let g=0;g<n.length;g++){const x=n[g],S=x.indexOf("$");S!==-1&&t.indexOf(x.substring(0,S+1))!==-1||t.indexOf(x)===-1&&(c[x]=e[x])}return c}const Y2=/^[a-z]+(?::(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/,GE=/^[^$]+(?:\$(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/;function Ic(e){let t,n=[];e.$on=(g,x)=>{let S=g,a=()=>{};return t?a=t(S,x):n.push([S,x]),S.match(Y2)&&console&&console.warn('Event modifiers in SMUI now use "$" instead of ":", so that all events can be bound with modifiers. Please update your event binding: ',S),()=>{a()}};function c(g){const x=e.$$.callbacks[g.type];x&&x.slice().forEach(S=>S.call(this,g))}return g=>{const x=[],S={};t=(a,U)=>{let W=a,he=U,ae=!1;const ce=W.match(Y2),be=W.match(GE),Je=ce||be;if(W.match(/^SMUI:\w+:/)){const it=W.split(":");let ct="";for(let Tt=0;Tt<it.length;Tt++)ct+=Tt===it.length-1?":"+it[Tt]:it[Tt].split("-").map(zt=>zt.slice(0,1).toUpperCase()+zt.slice(1)).join("");console.warn(`The event ${W.split("$")[0]} has been renamed to ${ct.split("$")[0]}.`),W=ct}if(Je){const it=W.split(ce?":":"$");W=it[0];const ct=it.slice(1).reduce((Tt,zt)=>(Tt[zt]=!0,Tt),{});ct.passive&&(ae=ae||{},ae.passive=!0),ct.nonpassive&&(ae=ae||{},ae.passive=!1),ct.capture&&(ae=ae||{},ae.capture=!0),ct.once&&(ae=ae||{},ae.once=!0),ct.preventDefault&&(he=qE(he)),ct.stopPropagation&&(he=HE(he)),ct.stopImmediatePropagation&&(he=jE(he)),ct.self&&(he=ZE(g,he)),ct.trusted&&(he=QE(he))}const st=K2(g,W,he,ae),Ye=()=>{st();const it=x.indexOf(Ye);it>-1&&x.splice(it,1)};return x.push(Ye),W in S||(S[W]=K2(g,W,c)),Ye};for(let a=0;a<n.length;a++)t(n[a][0],n[a][1]);return{destroy:()=>{for(let a=0;a<x.length;a++)x[a]();for(let a of Object.entries(S))a[1]()}}}}function K2(e,t,n,c){return e.addEventListener(t,n,c),()=>e.removeEventListener(t,n,c)}function qE(e){return function(t){return t.preventDefault(),e.call(this,t)}}function HE(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function jE(e){return function(t){return t.stopImmediatePropagation(),e.call(this,t)}}function ZE(e,t){return function(n){if(n.target===e)return t.call(this,n)}}function QE(e){return function(t){if(t.isTrusted)return e.call(this,t)}}function wl(e,t){let n=Object.getOwnPropertyNames(e);const c={};for(let g=0;g<n.length;g++){const x=n[g];x.substring(0,t.length)===t&&(c[x.substring(t.length)]=e[x])}return c}function mc(e,t){let n=[];if(t)for(let c=0;c<t.length;c++){const g=t[c],x=Array.isArray(g)?g[0]:g;Array.isArray(g)&&g.length>1?n.push(x(e,g[1])):n.push(x(e))}return{update(c){if((c&&c.length||0)!=n.length)throw new Error("You must not change the length of an actions array.");if(c)for(let g=0;g<c.length;g++){const x=n[g];if(x&&x.update){const S=c[g];Array.isArray(S)&&S.length>1?x.update(S[1]):x.update()}}},destroy(){for(let c=0;c<n.length;c++){const g=n[c];g&&g.destroy&&g.destroy()}}}}const{applyPassive:Vg}=BE,{matches:WE}=Bv;function Xd(e,{ripple:t=!0,surface:n=!1,unbounded:c=!1,disabled:g=!1,color:x,active:S,rippleElement:a,eventTarget:U,activeTarget:W,addClass:he=Je=>e.classList.add(Je),removeClass:ae=Je=>e.classList.remove(Je),addStyle:ce=(Je,st)=>e.style.setProperty(Je,st),initPromise:be=Promise.resolve()}={}){let Je,st=Cu("SMUI:addLayoutListener"),Ye,it=S,ct=U,Tt=W;function zt(){n?(he("mdc-ripple-surface"),x==="primary"?(he("smui-ripple-surface--primary"),ae("smui-ripple-surface--secondary")):x==="secondary"?(ae("smui-ripple-surface--primary"),he("smui-ripple-surface--secondary")):(ae("smui-ripple-surface--primary"),ae("smui-ripple-surface--secondary"))):(ae("mdc-ripple-surface"),ae("smui-ripple-surface--primary"),ae("smui-ripple-surface--secondary")),Je&&it!==S&&(it=S,S?Je.activate():S===!1&&Je.deactivate()),t&&!Je?(Je=new NE({addClass:he,browserSupportsCssVars:()=>FE(window),computeBoundingRect:()=>(a||e).getBoundingClientRect(),containsEventTarget:Oe=>e.contains(Oe),deregisterDocumentInteractionHandler:(Oe,jt)=>document.documentElement.removeEventListener(Oe,jt,Vg()),deregisterInteractionHandler:(Oe,jt)=>(U||e).removeEventListener(Oe,jt,Vg()),deregisterResizeHandler:Oe=>window.removeEventListener("resize",Oe),getWindowPageOffset:()=>({x:window.pageXOffset,y:window.pageYOffset}),isSurfaceActive:()=>S??WE(W||e,":active"),isSurfaceDisabled:()=>!!g,isUnbounded:()=>!!c,registerDocumentInteractionHandler:(Oe,jt)=>document.documentElement.addEventListener(Oe,jt,Vg()),registerInteractionHandler:(Oe,jt)=>(U||e).addEventListener(Oe,jt,Vg()),registerResizeHandler:Oe=>window.addEventListener("resize",Oe),removeClass:ae,updateCssVariable:ce}),be.then(()=>{Je&&(Je.init(),Je.setUnbounded(c))})):Je&&!t&&be.then(()=>{Je&&(Je.destroy(),Je=void 0)}),Je&&(ct!==U||Tt!==W)&&(ct=U,Tt=W,Je.destroy(),requestAnimationFrame(()=>{Je&&(Je.init(),Je.setUnbounded(c))})),!t&&c&&he("mdc-ripple-upgraded--unbounded")}zt(),st&&(Ye=st(Rt));function Rt(){Je&&Je.layout()}return{update(Oe){({ripple:t,surface:n,unbounded:c,disabled:g,color:x,active:S,rippleElement:a,eventTarget:U,activeTarget:W,addClass:he,removeClass:ae,addStyle:ce,initPromise:be}=Object.assign({ripple:!0,surface:!1,unbounded:!1,disabled:!1,color:void 0,active:void 0,rippleElement:void 0,eventTarget:void 0,activeTarget:void 0,addClass:jt=>e.classList.add(jt),removeClass:jt=>e.classList.remove(jt),addStyle:(jt,at)=>e.style.setProperty(jt,at),initPromise:Promise.resolve()},Oe)),zt()},destroy(){Je&&(Je.destroy(),Je=void 0,ae("mdc-ripple-surface"),ae("smui-ripple-surface--primary"),ae("smui-ripple-surface--secondary")),Ye&&Ye()}}}const{document:$E}=cE;function XE(e){let t,n,c,g,x,S,a,U;const W=e[34].default,he=Hl(W,e,e[33],null);let ae=[{class:c=Ts({[e[1]]:!0,"mdc-menu-surface":!0,"mdc-menu-surface--fixed":e[4],"mdc-menu-surface--open":e[3],"smui-menu-surface--static":e[3],"mdc-menu-surface--fullwidth":e[5],...e[8]})},{style:g=Object.entries(e[9]).map(J2).concat([e[2]]).join(" ")},{role:"dialog"},e[12]],ce={};for(let be=0;be<ae.length;be+=1)ce=_r(ce,ae[be]);return{c(){t=Sr(),n=Rn("div"),he&&he.c(),this.h()},l(be){t=Ir(be),n=Fn(be,"DIV",{class:!0,style:!0,role:!0});var Je=_n(n);he&&he.l(Je),Je.forEach(yi),this.h()},h(){sl(n,ce)},m(be,Je){Un(be,t,Je),Un(be,n,Je),he&&he.m(n,null),e[35](n),S=!0,a||(U=[Gl($E.body,"click",e[11],!0),Io(x=mc.call(null,n,e[0])),Io(e[10].call(null,n)),Gl(n,"keydown",function(){Eu(e[7]&&e[7].handleKeydown.bind(e[7]))&&(e[7]&&e[7].handleKeydown.bind(e[7])).apply(this,arguments)})],a=!0)},p(be,Je){e=be,he&&he.p&&(!S||Je[1]&4)&&jl(he,W,e,e[33],S?Ql(W,e[33],Je,null):Zl(e[33]),null),sl(n,ce=ma(ae,[(!S||Je[0]&314&&c!==(c=Ts({[e[1]]:!0,"mdc-menu-surface":!0,"mdc-menu-surface--fixed":e[4],"mdc-menu-surface--open":e[3],"smui-menu-surface--static":e[3],"mdc-menu-surface--fullwidth":e[5],...e[8]})))&&{class:c},(!S||Je[0]&516&&g!==(g=Object.entries(e[9]).map(J2).concat([e[2]]).join(" ")))&&{style:g},{role:"dialog"},Je[0]&4096&&e[12]])),x&&Eu(x.update)&&Je[0]&1&&x.update.call(null,e[0])},i(be){S||(Wi(he,be),S=!0)},o(be){tn(he,be),S=!1},d(be){be&&(yi(t),yi(n)),he&&he.d(be),e[35](null),a=!1,Nh(U)}}}const J2=([e,t])=>`${e}: ${t};`;function YE(e,t,n){const c=["use","class","style","static","anchor","fixed","open","managed","fullWidth","quickOpen","anchorElement","anchorCorner","anchorMargin","maxHeight","horizontallyCenteredOnViewport","openBottomBias","neverRestoreFocus","isOpen","setOpen","setAbsolutePosition","setIsHoisted","isFixed","getElement"];let g=Ao(t,c),{$$slots:x={},$$scope:S}=t;var a,U,W;const he=Ic(xc());let{use:ae=[]}=t,{class:ce=""}=t,{style:be=""}=t,{static:Je=!1}=t,{anchor:st=!0}=t,{fixed:Ye=!1}=t,{open:it=Je}=t,{managed:ct=!1}=t,{fullWidth:Tt=!1}=t,{quickOpen:zt=!1}=t,{anchorElement:Rt=void 0}=t,{anchorCorner:Oe=void 0}=t,{anchorMargin:jt={top:0,right:0,bottom:0,left:0}}=t,{maxHeight:at=0}=t,{horizontallyCenteredOnViewport:_t=!1}=t,{openBottomBias:mt=0}=t,{neverRestoreFocus:xt=!1}=t,bt,lt,$e={},pt={},ut;du("SMUI:list:role","menu"),du("SMUI:list:item:role","menuitem");const Nt=$d;bc(()=>(n(7,lt=new p3({addClass:Ot,removeClass:gi,hasClass:Bt,hasAnchor:()=>!!Rt,notifyClose:()=>{ct||n(13,it=Je),it||au(bt,"SMUIMenuSurface:closed",void 0,void 0,!0)},notifyClosing:()=>{ct||n(13,it=Je),it||au(bt,"SMUIMenuSurface:closing",void 0,void 0,!0)},notifyOpen:()=>{ct||n(13,it=!0),it&&au(bt,"SMUIMenuSurface:opened",void 0,void 0,!0)},notifyOpening:()=>{it||au(bt,"SMUIMenuSurface:opening",void 0,void 0,!0)},isElementInContainer:zi=>bt.contains(zi),isRtl:()=>getComputedStyle(bt).getPropertyValue("direction")==="rtl",setTransformOrigin:zi=>{n(9,pt["transform-origin"]=zi,pt)},isFocused:()=>document.activeElement===bt,saveFocus:()=>{var zi;ut=(zi=document.activeElement)!==null&&zi!==void 0?zi:void 0},restoreFocus:()=>{!xt&&(!bt||bt.contains(document.activeElement))&&ut&&document.contains(ut)&&"focus"in ut&&ut.focus()},getInnerDimensions:()=>({width:bt.offsetWidth,height:bt.offsetHeight}),getAnchorDimensions:()=>Rt?Rt.getBoundingClientRect():null,getWindowDimensions:()=>({width:window.innerWidth,height:window.innerHeight}),getBodyDimensions:()=>({width:document.body.clientWidth,height:document.body.clientHeight}),getWindowScroll:()=>({x:window.pageXOffset,y:window.pageYOffset}),setPosition:zi=>{n(9,pt.left="left"in zi?`${zi.left}px`:"",pt),n(9,pt.right="right"in zi?`${zi.right}px`:"",pt),n(9,pt.top="top"in zi?`${zi.top}px`:"",pt),n(9,pt.bottom="bottom"in zi?`${zi.bottom}px`:"",pt)},setMaxHeight:zi=>{n(9,pt["max-height"]=zi,pt)}})),au(bt,"SMUIMenuSurface:mount",{get open(){return it},set open(zi){n(13,it=zi)},closeProgrammatic:Ii}),lt.init(),()=>{var zi;const Oi=lt.isHoistedElement;lt.destroy(),Oi&&((zi=bt.parentNode)===null||zi===void 0||zi.removeChild(bt))})),wm(()=>{var mi;st&&bt&&((mi=bt.parentElement)===null||mi===void 0||mi.classList.remove("mdc-menu-surface--anchor"))});function Bt(mi){return mi in $e?$e[mi]:vn().classList.contains(mi)}function Ot(mi){$e[mi]||n(8,$e[mi]=!0,$e)}function gi(mi){(!(mi in $e)||$e[mi])&&n(8,$e[mi]=!1,$e)}function Ii(mi){lt.close(mi),n(13,it=!1)}function Ci(mi){lt&&it&&!ct&&lt.handleBodyClick(mi)}function Ri(){return it}function Ki(mi){n(13,it=mi)}function Hi(mi,zi){return lt.setAbsolutePosition(mi,zi)}function Ni(mi){return lt.setIsHoisted(mi)}function nn(){return lt.isFixed()}function vn(){return bt}function Ei(mi){ua[mi?"unshift":"push"](()=>{bt=mi,n(6,bt)})}return e.$$set=mi=>{t=_r(_r({},t),ic(mi)),n(12,g=Ao(t,c)),"use"in mi&&n(0,ae=mi.use),"class"in mi&&n(1,ce=mi.class),"style"in mi&&n(2,be=mi.style),"static"in mi&&n(3,Je=mi.static),"anchor"in mi&&n(15,st=mi.anchor),"fixed"in mi&&n(4,Ye=mi.fixed),"open"in mi&&n(13,it=mi.open),"managed"in mi&&n(16,ct=mi.managed),"fullWidth"in mi&&n(5,Tt=mi.fullWidth),"quickOpen"in mi&&n(17,zt=mi.quickOpen),"anchorElement"in mi&&n(14,Rt=mi.anchorElement),"anchorCorner"in mi&&n(18,Oe=mi.anchorCorner),"anchorMargin"in mi&&n(19,jt=mi.anchorMargin),"maxHeight"in mi&&n(20,at=mi.maxHeight),"horizontallyCenteredOnViewport"in mi&&n(21,_t=mi.horizontallyCenteredOnViewport),"openBottomBias"in mi&&n(22,mt=mi.openBottomBias),"neverRestoreFocus"in mi&&n(23,xt=mi.neverRestoreFocus),"$$scope"in mi&&n(33,S=mi.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&1073774656|e.$$.dirty[1]&3&&bt&&st&&!(!(n(30,a=bt.parentElement)===null||a===void 0)&&a.classList.contains("mdc-menu-surface--anchor"))&&(n(31,U=bt.parentElement)===null||U===void 0||U.classList.add("mdc-menu-surface--anchor"),n(14,Rt=n(32,W=bt.parentElement)!==null&&W!==void 0?W:void 0)),e.$$.dirty[0]&8320&&lt&&lt.isOpen()!==it&&(it?lt.open():lt.close()),e.$$.dirty[0]&131200&&lt&&lt.setQuickOpen(zt),e.$$.dirty[0]&144&&lt&&lt.setFixedPosition(Ye),e.$$.dirty[0]&1048704&&lt&&lt.setMaxHeight(at),e.$$.dirty[0]&2097280&&lt&&lt.setIsHorizontallyCenteredOnViewport(_t),e.$$.dirty[0]&262272&&lt&&Oe!=null&&(typeof Oe=="string"?lt.setAnchorCorner(Nt[Oe]):lt.setAnchorCorner(Oe)),e.$$.dirty[0]&524416&&lt&&lt.setAnchorMargin(jt),e.$$.dirty[0]&4194432&&lt&&lt.setOpenBottomBias(mt)},[ae,ce,be,Je,Ye,Tt,bt,lt,$e,pt,he,Ci,g,it,Rt,st,ct,zt,Oe,jt,at,_t,mt,xt,Ri,Ki,Hi,Ni,nn,vn,a,U,W,S,x,Ei]}class KE extends fo{constructor(t){super(),po(this,t,YE,XE,Va,{use:0,class:1,style:2,static:3,anchor:15,fixed:4,open:13,managed:16,fullWidth:5,quickOpen:17,anchorElement:14,anchorCorner:18,anchorMargin:19,maxHeight:20,horizontallyCenteredOnViewport:21,openBottomBias:22,neverRestoreFocus:23,isOpen:24,setOpen:25,setAbsolutePosition:26,setIsHoisted:27,isFixed:28,getElement:29},null,[-1,-1])}get isOpen(){return this.$$.ctx[24]}get setOpen(){return this.$$.ctx[25]}get setAbsolutePosition(){return this.$$.ctx[26]}get setIsHoisted(){return this.$$.ctx[27]}get isFixed(){return this.$$.ctx[28]}get getElement(){return this.$$.ctx[29]}}function JE(e,{addClass:t=c=>e.classList.add(c),removeClass:n=c=>e.classList.remove(c)}={}){return t("mdc-menu-surface--anchor"),{destroy(){n("mdc-menu-surface--anchor")}}}function eC(e){let t;const n=e[17].default,c=Hl(n,e,e[22],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,x){c&&c.m(g,x),t=!0},p(g,x){c&&c.p&&(!t||x&4194304)&&jl(c,n,g,g[22],t?Ql(n,g[22],x,null):Zl(g[22]),null)},i(g){t||(Wi(c,g),t=!0)},o(g){tn(c,g),t=!1},d(g){c&&c.d(g)}}}function tC(e){let t,n,c;const g=[{use:e[5]},{class:Ts({[e[1]]:!0,"mdc-menu":!0})},e[9]];function x(a){e[19](a)}let S={$$slots:{default:[eC]},$$scope:{ctx:e}};for(let a=0;a<g.length;a+=1)S=_r(S,g[a]);return e[0]!==void 0&&(S.open=e[0]),t=new KE({props:S}),e[18](t),ua.push(()=>i0(t,"open",x)),t.$on("SMUIMenuSurface:mount",e[7]),t.$on("SMUIList:mount",e[8]),t.$on("SMUIMenuSurface:opened",e[20]),t.$on("keydown",e[6]),t.$on("SMUIList:action",e[21]),{c(){Jr(t.$$.fragment)},l(a){vs(t.$$.fragment,a)},m(a,U){es(t,a,U),c=!0},p(a,[U]){const W=U&546?ma(g,[U&32&&{use:a[5]},U&2&&{class:Ts({[a[1]]:!0,"mdc-menu":!0})},U&512&&Os(a[9])]):{};U&4194304&&(W.$$scope={dirty:U,ctx:a}),!n&&U&1&&(n=!0,W.open=a[0],t0(()=>n=!1)),t.$set(W)},i(a){c||(Wi(t.$$.fragment,a),c=!0)},o(a){tn(t.$$.fragment,a),c=!1},d(a){e[18](null),ts(t,a)}}}function iC(e,t,n){let c;const g=["use","class","open","isOpen","setOpen","setDefaultFocusState","getSelectedIndex","getMenuSurface","getElement"];let x=Ao(t,g),{$$slots:S={},$$scope:a}=t;const{closest:U}=Bv,W=Ic(xc());let{use:he=[]}=t,{class:ae=""}=t,{open:ce=!1}=t,be,Je,st,Ye;bc(()=>(n(3,Je=new TE({addClassToElementAtIndex:($e,pt)=>{Ye.addClassForElementIndex($e,pt)},removeClassFromElementAtIndex:($e,pt)=>{Ye.removeClassForElementIndex($e,pt)},addAttributeToElementAtIndex:($e,pt,ut)=>{Ye.setAttributeForElementIndex($e,pt,ut)},removeAttributeFromElementAtIndex:($e,pt)=>{Ye.removeAttributeForElementIndex($e,pt)},getAttributeFromElementAtIndex:($e,pt)=>Ye.getAttributeFromElementIndex($e,pt),elementContainsClass:($e,pt)=>$e.classList.contains(pt),closeSurface:$e=>{st.closeProgrammatic($e),au(_t(),"SMUIMenu:closedProgrammatically")},getElementIndex:$e=>Ye.getOrderedList().map(pt=>pt.element).indexOf($e),notifySelected:$e=>au(_t(),"SMUIMenu:selected",{index:$e.index,item:Ye.getOrderedList()[$e.index].element},void 0,!0),getMenuItemCount:()=>Ye.items.length,focusItemAtIndex:$e=>Ye.focusItemAtIndex($e),focusListRoot:()=>"focus"in Ye.element&&Ye.element.focus(),isSelectableItemAtIndex:$e=>!!U(Ye.getOrderedList()[$e].element,`.${lm.MENU_SELECTION_GROUP}`),getSelectedSiblingOfItemAtIndex:$e=>{const pt=Ye.getOrderedList(),ut=U(pt[$e].element,`.${lm.MENU_SELECTION_GROUP}`),Nt=ut==null?void 0:ut.querySelector(`.${lm.MENU_SELECTED_LIST_ITEM}`);return Nt?pt.map(Bt=>Bt.element).indexOf(Nt):-1}})),au(_t(),"SMUIMenu:mount",Je),Je.init(),()=>{Je.destroy()}));function it($e){Je&&Je.handleKeydown($e)}function ct($e){st||(st=$e.detail)}function Tt($e){Ye||n(4,Ye=$e.detail)}function zt(){return ce}function Rt($e){n(0,ce=$e)}function Oe($e){Je.setDefaultFocusState($e)}function jt(){return Je.getSelectedIndex()}function at(){return be}function _t(){return be.getElement()}function mt($e){ua[$e?"unshift":"push"](()=>{be=$e,n(2,be)})}function xt($e){ce=$e,n(0,ce)}const bt=()=>Je&&Je.handleMenuSurfaceOpened(),lt=$e=>Je&&Je.handleItemAction(Ye.getOrderedList()[$e.detail.index].element);return e.$$set=$e=>{t=_r(_r({},t),ic($e)),n(9,x=Ao(t,g)),"use"in $e&&n(10,he=$e.use),"class"in $e&&n(1,ae=$e.class),"open"in $e&&n(0,ce=$e.open),"$$scope"in $e&&n(22,a=$e.$$scope)},e.$$.update=()=>{e.$$.dirty&1024&&n(5,c=[W,...he])},[ce,ae,be,Je,Ye,c,it,ct,Tt,x,he,zt,Rt,Oe,jt,at,_t,S,mt,xt,bt,lt,a]}class nC extends fo{constructor(t){super(),po(this,t,iC,tC,Va,{use:10,class:1,open:0,isOpen:11,setOpen:12,setDefaultFocusState:13,getSelectedIndex:14,getMenuSurface:15,getElement:16})}get isOpen(){return this.$$.ctx[11]}get setOpen(){return this.$$.ctx[12]}get setDefaultFocusState(){return this.$$.ctx[13]}get getSelectedIndex(){return this.$$.ctx[14]}get getMenuSurface(){return this.$$.ctx[15]}get getElement(){return this.$$.ctx[16]}}function rC(e){let t;const n=e[10].default,c=Hl(n,e,e[12],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,x){c&&c.m(g,x),t=!0},p(g,x){c&&c.p&&(!t||x&4096)&&jl(c,n,g,g[12],t?Ql(n,g[12],x,null):Zl(g[12]),null)},i(g){t||(Wi(c,g),t=!0)},o(g){tn(c,g),t=!1},d(g){c&&c.d(g)}}}function sC(e){let t,n,c;const g=[{tag:e[3]},{use:[e[5],...e[0]]},{class:Ts({[e[1]]:!0,"mdc-button__label":e[6]==="button","mdc-fab__label":e[6]==="fab","mdc-tab__text-label":e[6]==="tab","mdc-image-list__label":e[6]==="image-list","mdc-snackbar__label":e[6]==="snackbar","mdc-banner__text":e[6]==="banner","mdc-segmented-button__label":e[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":e[6]==="data-table:pagination","mdc-data-table__header-cell-label":e[6]==="data-table:sortable-header-cell"})},e[6]==="snackbar"?{"aria-atomic":"false"}:{},{tabindex:e[7]},e[8]];var x=e[2];function S(a,U){let W={$$slots:{default:[rC]},$$scope:{ctx:a}};if(U!==void 0&&U&491)W=ma(g,[U&8&&{tag:a[3]},U&33&&{use:[a[5],...a[0]]},U&66&&{class:Ts({[a[1]]:!0,"mdc-button__label":a[6]==="button","mdc-fab__label":a[6]==="fab","mdc-tab__text-label":a[6]==="tab","mdc-image-list__label":a[6]==="image-list","mdc-snackbar__label":a[6]==="snackbar","mdc-banner__text":a[6]==="banner","mdc-segmented-button__label":a[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":a[6]==="data-table:pagination","mdc-data-table__header-cell-label":a[6]==="data-table:sortable-header-cell"})},U&64&&Os(a[6]==="snackbar"?{"aria-atomic":"false"}:{}),U&128&&{tabindex:a[7]},U&256&&Os(a[8])]);else for(let he=0;he<g.length;he+=1)W=_r(W,g[he]);return{props:W}}return x&&(t=ef(x,S(e)),e[11](t)),{c(){t&&Jr(t.$$.fragment),n=xs()},l(a){t&&vs(t.$$.fragment,a),n=xs()},m(a,U){t&&es(t,a,U),Un(a,n,U),c=!0},p(a,[U]){if(U&4&&x!==(x=a[2])){if(t){Eo();const W=t;tn(W.$$.fragment,1,0,()=>{ts(W,1)}),Co()}x?(t=ef(x,S(a,U)),a[11](t),Jr(t.$$.fragment),Wi(t.$$.fragment,1),es(t,n.parentNode,n)):t=null}else if(x){const W=U&491?ma(g,[U&8&&{tag:a[3]},U&33&&{use:[a[5],...a[0]]},U&66&&{class:Ts({[a[1]]:!0,"mdc-button__label":a[6]==="button","mdc-fab__label":a[6]==="fab","mdc-tab__text-label":a[6]==="tab","mdc-image-list__label":a[6]==="image-list","mdc-snackbar__label":a[6]==="snackbar","mdc-banner__text":a[6]==="banner","mdc-segmented-button__label":a[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":a[6]==="data-table:pagination","mdc-data-table__header-cell-label":a[6]==="data-table:sortable-header-cell"})},U&64&&Os(a[6]==="snackbar"?{"aria-atomic":"false"}:{}),U&128&&{tabindex:a[7]},U&256&&Os(a[8])]):{};U&4096&&(W.$$scope={dirty:U,ctx:a}),t.$set(W)}},i(a){c||(t&&Wi(t.$$.fragment,a),c=!0)},o(a){t&&tn(t.$$.fragment,a),c=!1},d(a){a&&yi(n),e[11](null),t&&ts(t,a)}}}function aC(e,t,n){const c=["use","class","component","tag","getElement"];let g=Ao(t,c),{$$slots:x={},$$scope:S}=t;const a=Ic(xc());let{use:U=[]}=t,{class:W=""}=t,he,{component:ae=tf}=t,{tag:ce=ae===tf?"span":void 0}=t;const be=Cu("SMUI:label:context"),Je=Cu("SMUI:label:tabindex");function st(){return he.getElement()}function Ye(it){ua[it?"unshift":"push"](()=>{he=it,n(4,he)})}return e.$$set=it=>{t=_r(_r({},t),ic(it)),n(8,g=Ao(t,c)),"use"in it&&n(0,U=it.use),"class"in it&&n(1,W=it.class),"component"in it&&n(2,ae=it.component),"tag"in it&&n(3,ce=it.tag),"$$scope"in it&&n(12,S=it.$$scope)},[U,W,ae,ce,he,a,be,Je,g,st,x,Ye,S]}class oC extends fo{constructor(t){super(),po(this,t,aC,sC,Va,{use:0,class:1,component:2,tag:3,getElement:9})}get getElement(){return this.$$.ctx[9]}}function lC(e){let t=e[1],n,c,g=e[1]&&M1(e);return{c(){g&&g.c(),n=xs()},l(x){g&&g.l(x),n=xs()},m(x,S){g&&g.m(x,S),Un(x,n,S),c=!0},p(x,S){x[1]?t?Va(t,x[1])?(g.d(1),g=M1(x),t=x[1],g.c(),g.m(n.parentNode,n)):g.p(x,S):(g=M1(x),t=x[1],g.c(),g.m(n.parentNode,n)):t&&(g.d(1),g=null,t=x[1])},i(x){c||(Wi(g,x),c=!0)},o(x){tn(g,x),c=!1},d(x){x&&yi(n),g&&g.d(x)}}}function uC(e){let t=e[1],n,c=e[1]&&P1(e);return{c(){c&&c.c(),n=xs()},l(g){c&&c.l(g),n=xs()},m(g,x){c&&c.m(g,x),Un(g,n,x)},p(g,x){g[1]?t?Va(t,g[1])?(c.d(1),c=P1(g),t=g[1],c.c(),c.m(n.parentNode,n)):c.p(g,x):(c=P1(g),t=g[1],c.c(),c.m(n.parentNode,n)):t&&(c.d(1),c=null,t=g[1])},i:Oa,o:Oa,d(g){g&&yi(n),c&&c.d(g)}}}function cC(e){let t,n,c,g,x;const S=e[8].default,a=Hl(S,e,e[7],null);let U=[e[5]],W={};for(let he=0;he<U.length;he+=1)W=_r(W,U[he]);return{c(){t=Ra("svg"),a&&a.c(),this.h()},l(he){t=Fa(he,"svg",{});var ae=_n(t);a&&a.l(ae),ae.forEach(yi),this.h()},h(){A_(t,W)},m(he,ae){Un(he,t,ae),a&&a.m(t,null),e[9](t),c=!0,g||(x=[Io(n=mc.call(null,t,e[0])),Io(e[4].call(null,t))],g=!0)},p(he,ae){a&&a.p&&(!c||ae&128)&&jl(a,S,he,he[7],c?Ql(S,he[7],ae,null):Zl(he[7]),null),A_(t,W=ma(U,[ae&32&&he[5]])),n&&Eu(n.update)&&ae&1&&n.update.call(null,he[0])},i(he){c||(Wi(a,he),c=!0)},o(he){tn(a,he),c=!1},d(he){he&&yi(t),a&&a.d(he),e[9](null),g=!1,Nh(x)}}}function M1(e){let t,n,c,g,x;const S=e[8].default,a=Hl(S,e,e[7],null);let U=[e[5]],W={};for(let he=0;he<U.length;he+=1)W=_r(W,U[he]);return{c(){t=Rn(e[1]),a&&a.c(),this.h()},l(he){t=Fn(he,(e[1]||"null").toUpperCase(),{});var ae=_n(t);a&&a.l(ae),ae.forEach(yi),this.h()},h(){f_(e[1])(t,W)},m(he,ae){Un(he,t,ae),a&&a.m(t,null),e[11](t),c=!0,g||(x=[Io(n=mc.call(null,t,e[0])),Io(e[4].call(null,t))],g=!0)},p(he,ae){a&&a.p&&(!c||ae&128)&&jl(a,S,he,he[7],c?Ql(S,he[7],ae,null):Zl(he[7]),null),f_(he[1])(t,W=ma(U,[ae&32&&he[5]])),n&&Eu(n.update)&&ae&1&&n.update.call(null,he[0])},i(he){c||(Wi(a,he),c=!0)},o(he){tn(a,he),c=!1},d(he){he&&yi(t),a&&a.d(he),e[11](null),g=!1,Nh(x)}}}function P1(e){let t,n,c,g,x=[e[5]],S={};for(let a=0;a<x.length;a+=1)S=_r(S,x[a]);return{c(){t=Rn(e[1]),this.h()},l(a){t=Fn(a,(e[1]||"null").toUpperCase(),{}),_n(t).forEach(yi),this.h()},h(){f_(e[1])(t,S)},m(a,U){Un(a,t,U),e[10](t),c||(g=[Io(n=mc.call(null,t,e[0])),Io(e[4].call(null,t))],c=!0)},p(a,U){f_(a[1])(t,S=ma(x,[U&32&&a[5]])),n&&Eu(n.update)&&U&1&&n.update.call(null,a[0])},d(a){a&&yi(t),e[10](null),c=!1,Nh(g)}}}function hC(e){let t,n,c,g;const x=[cC,uC,lC],S=[];function a(U,W){return U[1]==="svg"?0:U[3]?1:2}return t=a(e),n=S[t]=x[t](e),{c(){n.c(),c=xs()},l(U){n.l(U),c=xs()},m(U,W){S[t].m(U,W),Un(U,c,W),g=!0},p(U,[W]){let he=t;t=a(U),t===he?S[t].p(U,W):(Eo(),tn(S[he],1,1,()=>{S[he]=null}),Co(),n=S[t],n?n.p(U,W):(n=S[t]=x[t](U),n.c()),Wi(n,1),n.m(c.parentNode,c))},i(U){g||(Wi(n),g=!0)},o(U){tn(n),g=!1},d(U){U&&yi(c),S[t].d(U)}}}function AC(e,t,n){let c;const g=["use","tag","getElement"];let x=Ao(t,g),{$$slots:S={},$$scope:a}=t,{use:U=[]}=t,{tag:W}=t;const he=Ic(xc());let ae;function ce(){return ae}function be(Ye){ua[Ye?"unshift":"push"](()=>{ae=Ye,n(2,ae)})}function Je(Ye){ua[Ye?"unshift":"push"](()=>{ae=Ye,n(2,ae)})}function st(Ye){ua[Ye?"unshift":"push"](()=>{ae=Ye,n(2,ae)})}return e.$$set=Ye=>{t=_r(_r({},t),ic(Ye)),n(5,x=Ao(t,g)),"use"in Ye&&n(0,U=Ye.use),"tag"in Ye&&n(1,W=Ye.tag),"$$scope"in Ye&&n(7,a=Ye.$$scope)},e.$$.update=()=>{e.$$.dirty&2&&n(3,c=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"].indexOf(W)>-1)},[U,W,ae,c,he,x,ce,a,S,be,Je,st]}class tf extends fo{constructor(t){super(),po(this,t,AC,hC,Va,{use:0,tag:1,getElement:6})}get getElement(){return this.$$.ctx[6]}}function fC(e){let t;const n=e[11].default,c=Hl(n,e,e[13],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,x){c&&c.m(g,x),t=!0},p(g,x){c&&c.p&&(!t||x&8192)&&jl(c,n,g,g[13],t?Ql(n,g[13],x,null):Zl(g[13]),null)},i(g){t||(Wi(c,g),t=!0)},o(g){tn(c,g),t=!1},d(g){c&&c.d(g)}}}function dC(e){let t,n,c;const g=[{tag:e[3]},{use:[e[8],...e[0]]},{class:Ts({[e[1]]:!0,[e[6]]:!0,...e[5]})},e[7],e[9]];var x=e[2];function S(a,U){let W={$$slots:{default:[fC]},$$scope:{ctx:a}};if(U!==void 0&&U&1003)W=ma(g,[U&8&&{tag:a[3]},U&257&&{use:[a[8],...a[0]]},U&98&&{class:Ts({[a[1]]:!0,[a[6]]:!0,...a[5]})},U&128&&Os(a[7]),U&512&&Os(a[9])]);else for(let he=0;he<g.length;he+=1)W=_r(W,g[he]);return{props:W}}return x&&(t=ef(x,S(e)),e[12](t)),{c(){t&&Jr(t.$$.fragment),n=xs()},l(a){t&&vs(t.$$.fragment,a),n=xs()},m(a,U){t&&es(t,a,U),Un(a,n,U),c=!0},p(a,[U]){if(U&4&&x!==(x=a[2])){if(t){Eo();const W=t;tn(W.$$.fragment,1,0,()=>{ts(W,1)}),Co()}x?(t=ef(x,S(a,U)),a[12](t),Jr(t.$$.fragment),Wi(t.$$.fragment,1),es(t,n.parentNode,n)):t=null}else if(x){const W=U&1003?ma(g,[U&8&&{tag:a[3]},U&257&&{use:[a[8],...a[0]]},U&98&&{class:Ts({[a[1]]:!0,[a[6]]:!0,...a[5]})},U&128&&Os(a[7]),U&512&&Os(a[9])]):{};U&8192&&(W.$$scope={dirty:U,ctx:a}),t.$set(W)}},i(a){c||(t&&Wi(t.$$.fragment,a),c=!0)},o(a){t&&tn(t.$$.fragment,a),c=!1},d(a){a&&yi(n),e[12](null),t&&ts(t,a)}}}const Kf={component:tf,tag:"div",class:"",classMap:{},contexts:{},props:{}};function pC(e,t,n){const c=["use","class","component","tag","getElement"];let g=Ao(t,c),{$$slots:x={},$$scope:S}=t,{use:a=[]}=t,{class:U=""}=t,W;const he=Kf.class,ae={},ce=[],be=Kf.contexts,Je=Kf.props;let{component:st=Kf.component}=t,{tag:Ye=st===tf?Kf.tag:void 0}=t;Object.entries(Kf.classMap).forEach(([zt,Rt])=>{const Oe=Cu(Rt);Oe&&"subscribe"in Oe&&ce.push(Oe.subscribe(jt=>{n(5,ae[zt]=jt,ae)}))});const it=Ic(xc());for(let zt in be)be.hasOwnProperty(zt)&&du(zt,be[zt]);wm(()=>{for(const zt of ce)zt()});function ct(){return W.getElement()}function Tt(zt){ua[zt?"unshift":"push"](()=>{W=zt,n(4,W)})}return e.$$set=zt=>{t=_r(_r({},t),ic(zt)),n(9,g=Ao(t,c)),"use"in zt&&n(0,a=zt.use),"class"in zt&&n(1,U=zt.class),"component"in zt&&n(2,st=zt.component),"tag"in zt&&n(3,Ye=zt.tag),"$$scope"in zt&&n(13,S=zt.$$scope)},[a,U,st,Ye,W,ae,he,Je,it,g,ct,x,Tt,S]}class mC extends fo{constructor(t){super(),po(this,t,pC,dC,Va,{use:0,class:1,component:2,tag:3,getElement:10})}get getElement(){return this.$$.ctx[10]}}const ex=Object.assign({},Kf);function cp(e){return new Proxy(mC,{construct:function(t,n){return Object.assign(Kf,ex,e),new t(...n)},get:function(t,n){return Object.assign(Kf,ex,e),t[n]}})}function gC(e){let t;const n=e[42].default,c=Hl(n,e,e[44],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,x){c&&c.m(g,x),t=!0},p(g,x){c&&c.p&&(!t||x[1]&8192)&&jl(c,n,g,g[44],t?Ql(n,g[44],x,null):Zl(g[44]),null)},i(g){t||(Wi(c,g),t=!0)},o(g){tn(c,g),t=!1},d(g){c&&c.d(g)}}}function _C(e){let t,n,c;const g=[{tag:e[13]},{use:[e[16],...e[0]]},{class:Ts({[e[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":e[2],"mdc-deprecated-list--dense":e[3],"mdc-deprecated-list--textual-list":e[4],"mdc-deprecated-list--avatar-list":e[5]||e[17],"mdc-deprecated-list--icon-list":e[6],"mdc-deprecated-list--image-list":e[7],"mdc-deprecated-list--thumbnail-list":e[8],"mdc-deprecated-list--video-list":e[9],"mdc-deprecated-list--two-line":e[10],"smui-list--three-line":e[11]&&!e[10]})},{role:e[15]},e[25]];var x=e[12];function S(a,U){let W={$$slots:{default:[gC]},$$scope:{ctx:a}};if(U!==void 0&&U[0]&33796095)W=ma(g,[U[0]&8192&&{tag:a[13]},U[0]&65537&&{use:[a[16],...a[0]]},U[0]&135166&&{class:Ts({[a[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":a[2],"mdc-deprecated-list--dense":a[3],"mdc-deprecated-list--textual-list":a[4],"mdc-deprecated-list--avatar-list":a[5]||a[17],"mdc-deprecated-list--icon-list":a[6],"mdc-deprecated-list--image-list":a[7],"mdc-deprecated-list--thumbnail-list":a[8],"mdc-deprecated-list--video-list":a[9],"mdc-deprecated-list--two-line":a[10],"smui-list--three-line":a[11]&&!a[10]})},U[0]&32768&&{role:a[15]},U[0]&33554432&&Os(a[25])]);else for(let he=0;he<g.length;he+=1)W=_r(W,g[he]);return{props:W}}return x&&(t=ef(x,S(e)),e[43](t),t.$on("keydown",e[20]),t.$on("focusin",e[21]),t.$on("focusout",e[22]),t.$on("click",e[23]),t.$on("SMUIListItem:mount",e[18]),t.$on("SMUIListItem:unmount",e[19]),t.$on("SMUI:action",e[24])),{c(){t&&Jr(t.$$.fragment),n=xs()},l(a){t&&vs(t.$$.fragment,a),n=xs()},m(a,U){t&&es(t,a,U),Un(a,n,U),c=!0},p(a,U){if(U[0]&4096&&x!==(x=a[12])){if(t){Eo();const W=t;tn(W.$$.fragment,1,0,()=>{ts(W,1)}),Co()}x?(t=ef(x,S(a,U)),a[43](t),t.$on("keydown",a[20]),t.$on("focusin",a[21]),t.$on("focusout",a[22]),t.$on("click",a[23]),t.$on("SMUIListItem:mount",a[18]),t.$on("SMUIListItem:unmount",a[19]),t.$on("SMUI:action",a[24]),Jr(t.$$.fragment),Wi(t.$$.fragment,1),es(t,n.parentNode,n)):t=null}else if(x){const W=U[0]&33796095?ma(g,[U[0]&8192&&{tag:a[13]},U[0]&65537&&{use:[a[16],...a[0]]},U[0]&135166&&{class:Ts({[a[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":a[2],"mdc-deprecated-list--dense":a[3],"mdc-deprecated-list--textual-list":a[4],"mdc-deprecated-list--avatar-list":a[5]||a[17],"mdc-deprecated-list--icon-list":a[6],"mdc-deprecated-list--image-list":a[7],"mdc-deprecated-list--thumbnail-list":a[8],"mdc-deprecated-list--video-list":a[9],"mdc-deprecated-list--two-line":a[10],"smui-list--three-line":a[11]&&!a[10]})},U[0]&32768&&{role:a[15]},U[0]&33554432&&Os(a[25])]):{};U[1]&8192&&(W.$$scope={dirty:U,ctx:a}),t.$set(W)}},i(a){c||(t&&Wi(t.$$.fragment,a),c=!0)},o(a){t&&tn(t.$$.fragment,a),c=!1},d(a){a&&yi(n),e[43](null),t&&ts(t,a)}}}function yC(e,t,n){const c=["use","class","nonInteractive","dense","textualList","avatarList","iconList","imageList","thumbnailList","videoList","twoLine","threeLine","vertical","wrapFocus","singleSelection","disabledItemsFocusable","selectedIndex","radioList","checkList","hasTypeahead","component","tag","layout","setEnabled","getTypeaheadInProgress","getSelectedIndex","getFocusedItemIndex","focusItemAtIndex","getElement"];let g=Ao(t,c),{$$slots:x={},$$scope:S}=t;var a;const{closest:U,matches:W}=Bv,he=Ic(xc());let{use:ae=[]}=t,{class:ce=""}=t,{nonInteractive:be=!1}=t,{dense:Je=!1}=t,{textualList:st=!1}=t,{avatarList:Ye=!1}=t,{iconList:it=!1}=t,{imageList:ct=!1}=t,{thumbnailList:Tt=!1}=t,{videoList:zt=!1}=t,{twoLine:Rt=!1}=t,{threeLine:Oe=!1}=t,{vertical:jt=!0}=t,{wrapFocus:at=(a=Cu("SMUI:list:wrapFocus"))!==null&&a!==void 0?a:!1}=t,{singleSelection:_t=!1}=t,{disabledItemsFocusable:mt=!1}=t,{selectedIndex:xt=-1}=t,{radioList:bt=!1}=t,{checkList:lt=!1}=t,{hasTypeahead:$e=!1}=t,pt,ut,Nt=[],Bt=Cu("SMUI:list:role"),Ot=Cu("SMUI:list:nav");const gi=new WeakMap;let Ii=Cu("SMUI:dialog:selection"),Ci=Cu("SMUI:addLayoutListener"),Ri,{component:Ki=tf}=t,{tag:Hi=Ki===tf?Ot?"nav":"ul":void 0}=t;du("SMUI:list:nonInteractive",be),du("SMUI:separator:context","list"),Bt||(_t?(Bt="listbox",du("SMUI:list:item:role","option")):bt?(Bt="radiogroup",du("SMUI:list:item:role","radio")):lt?(Bt="group",du("SMUI:list:item:role","checkbox")):(Bt="list",du("SMUI:list:item:role",void 0))),Ci&&(Ri=Ci(lr)),bc(()=>{n(41,ut=new EE({addClassForElementIndex:Yt,focusItemAtIndex:k,getAttributeForElementIndex:(fe,ve)=>{var Ie,Ee;return(Ee=(Ie=xn()[fe])===null||Ie===void 0?void 0:Ie.getAttr(ve))!==null&&Ee!==void 0?Ee:null},getFocusedElementIndex:()=>document.activeElement?xn().map(fe=>fe.element).indexOf(document.activeElement):-1,getListItemCount:()=>Nt.length,getPrimaryTextAtIndex:ci,hasCheckboxAtIndex:fe=>{var ve,Ie;return(Ie=(ve=xn()[fe])===null||ve===void 0?void 0:ve.hasCheckbox)!==null&&Ie!==void 0?Ie:!1},hasRadioAtIndex:fe=>{var ve,Ie;return(Ie=(ve=xn()[fe])===null||ve===void 0?void 0:ve.hasRadio)!==null&&Ie!==void 0?Ie:!1},isCheckboxCheckedAtIndex:fe=>{var ve;const Ie=xn()[fe];return(ve=(Ie==null?void 0:Ie.hasCheckbox)&&Ie.checked)!==null&&ve!==void 0?ve:!1},isFocusInsideList:()=>pt!=null&&V()!==document.activeElement&&V().contains(document.activeElement),isRootFocused:()=>pt!=null&&document.activeElement===V(),listItemAtIndexHasClass:bn,notifyAction:fe=>{n(26,xt=fe),pt!=null&&au(V(),"SMUIList:action",{index:fe},void 0,!0)},notifySelectionChange:fe=>{pt!=null&&au(V(),"SMUIList:selectionChange",{changedIndices:fe})},removeClassForElementIndex:rn,setAttributeForElementIndex:Xt,setCheckedCheckboxOrRadioAtIndex:(fe,ve)=>{xn()[fe].checked=ve},setTabIndexForListItemChildren:(fe,ve)=>{const Ie=xn()[fe];Array.prototype.forEach.call(Ie.element.querySelectorAll("button:not(:disabled), a"),ze=>{ze.setAttribute("tabindex",ve)})}}));const te={get element(){return V()},get items(){return Nt},get typeaheadInProgress(){return ut.isTypeaheadInProgress()},typeaheadMatchItem(fe,ve){return ut.typeaheadMatchItem(fe,ve,!0)},getOrderedList:xn,focusItemAtIndex:k,addClassForElementIndex:Yt,removeClassForElementIndex:rn,setAttributeForElementIndex:Xt,removeAttributeForElementIndex:Ji,getAttributeFromElementIndex:mr,getPrimaryTextAtIndex:ci};return au(V(),"SMUIList:mount",te),ut.init(),ut.layout(),()=>{ut.destroy()}}),wm(()=>{Ri&&Ri()});function Ni(te){Nt.push(te.detail),gi.set(te.detail.element,te.detail),_t&&te.detail.selected&&n(26,xt=sn(te.detail.element)),te.stopPropagation()}function nn(te){var fe;const ve=(fe=te.detail&&Nt.indexOf(te.detail))!==null&&fe!==void 0?fe:-1;ve!==-1&&(Nt.splice(ve,1),Nt=Nt,gi.delete(te.detail.element)),te.stopPropagation()}function vn(te){ut&&te.target&&ut.handleKeydown(te,te.target.classList.contains("mdc-deprecated-list-item"),sn(te.target))}function Ei(te){ut&&te.target&&ut.handleFocusIn(sn(te.target))}function mi(te){ut&&te.target&&ut.handleFocusOut(sn(te.target))}function zi(te){ut&&te.target&&ut.handleClick(sn(te.target),!W(te.target,'input[type="checkbox"], input[type="radio"]'),te)}function Oi(te){if(bt||lt){const fe=sn(te.target);if(fe!==-1){const ve=xn()[fe];ve&&(bt&&!ve.checked||lt)&&(W(te.detail.target,'input[type="checkbox"], input[type="radio"]')||(ve.checked=!ve.checked),ve.activateRipple(),window.requestAnimationFrame(()=>{ve.deactivateRipple()}))}}}function xn(){return pt==null?[]:[...V().children].map(te=>gi.get(te)).filter(te=>te&&te._smui_list_item_accessor)}function bn(te,fe){var ve;const Ie=xn()[te];return(ve=Ie&&Ie.hasClass(fe))!==null&&ve!==void 0?ve:!1}function Yt(te,fe){const ve=xn()[te];ve&&ve.addClass(fe)}function rn(te,fe){const ve=xn()[te];ve&&ve.removeClass(fe)}function Xt(te,fe,ve){const Ie=xn()[te];Ie&&Ie.addAttr(fe,ve)}function Ji(te,fe){const ve=xn()[te];ve&&ve.removeAttr(fe)}function mr(te,fe){const ve=xn()[te];return ve?ve.getAttr(fe):null}function ci(te){var fe;const ve=xn()[te];return(fe=ve&&ve.getPrimaryText())!==null&&fe!==void 0?fe:""}function sn(te){const fe=U(te,".mdc-deprecated-list-item, .mdc-deprecated-list");return fe&&W(fe,".mdc-deprecated-list-item")?xn().map(ve=>ve==null?void 0:ve.element).indexOf(fe):-1}function lr(){return ut.layout()}function On(te,fe){return ut.setEnabled(te,fe)}function Gn(){return ut.isTypeaheadInProgress()}function pn(){return ut.getSelectedIndex()}function v(){return ut.getFocusedItemIndex()}function k(te){const fe=xn()[te];fe&&"focus"in fe.element&&fe.element.focus()}function V(){return pt.getElement()}function Y(te){ua[te?"unshift":"push"](()=>{pt=te,n(14,pt)})}return e.$$set=te=>{t=_r(_r({},t),ic(te)),n(25,g=Ao(t,c)),"use"in te&&n(0,ae=te.use),"class"in te&&n(1,ce=te.class),"nonInteractive"in te&&n(2,be=te.nonInteractive),"dense"in te&&n(3,Je=te.dense),"textualList"in te&&n(4,st=te.textualList),"avatarList"in te&&n(5,Ye=te.avatarList),"iconList"in te&&n(6,it=te.iconList),"imageList"in te&&n(7,ct=te.imageList),"thumbnailList"in te&&n(8,Tt=te.thumbnailList),"videoList"in te&&n(9,zt=te.videoList),"twoLine"in te&&n(10,Rt=te.twoLine),"threeLine"in te&&n(11,Oe=te.threeLine),"vertical"in te&&n(27,jt=te.vertical),"wrapFocus"in te&&n(28,at=te.wrapFocus),"singleSelection"in te&&n(29,_t=te.singleSelection),"disabledItemsFocusable"in te&&n(30,mt=te.disabledItemsFocusable),"selectedIndex"in te&&n(26,xt=te.selectedIndex),"radioList"in te&&n(31,bt=te.radioList),"checkList"in te&&n(32,lt=te.checkList),"hasTypeahead"in te&&n(33,$e=te.hasTypeahead),"component"in te&&n(12,Ki=te.component),"tag"in te&&n(13,Hi=te.tag),"$$scope"in te&&n(44,S=te.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&134217728|e.$$.dirty[1]&1024&&ut&&ut.setVerticalOrientation(jt),e.$$.dirty[0]&268435456|e.$$.dirty[1]&1024&&ut&&ut.setWrapFocus(at),e.$$.dirty[1]&1028&&ut&&ut.setHasTypeahead($e),e.$$.dirty[0]&536870912|e.$$.dirty[1]&1024&&ut&&ut.setSingleSelection(_t),e.$$.dirty[0]&1073741824|e.$$.dirty[1]&1024&&ut&&ut.setDisabledItemsFocusable(mt),e.$$.dirty[0]&603979776|e.$$.dirty[1]&1024&&ut&&_t&&pn()!==xt&&ut.setSelectedIndex(xt)},[ae,ce,be,Je,st,Ye,it,ct,Tt,zt,Rt,Oe,Ki,Hi,pt,Bt,he,Ii,Ni,nn,vn,Ei,mi,zi,Oi,g,xt,jt,at,_t,mt,bt,lt,$e,lr,On,Gn,pn,v,k,V,ut,x,Y,S]}class vC extends fo{constructor(t){super(),po(this,t,yC,_C,Va,{use:0,class:1,nonInteractive:2,dense:3,textualList:4,avatarList:5,iconList:6,imageList:7,thumbnailList:8,videoList:9,twoLine:10,threeLine:11,vertical:27,wrapFocus:28,singleSelection:29,disabledItemsFocusable:30,selectedIndex:26,radioList:31,checkList:32,hasTypeahead:33,component:12,tag:13,layout:34,setEnabled:35,getTypeaheadInProgress:36,getSelectedIndex:37,getFocusedItemIndex:38,focusItemAtIndex:39,getElement:40},null,[-1,-1])}get layout(){return this.$$.ctx[34]}get setEnabled(){return this.$$.ctx[35]}get getTypeaheadInProgress(){return this.$$.ctx[36]}get getSelectedIndex(){return this.$$.ctx[37]}get getFocusedItemIndex(){return this.$$.ctx[38]}get focusItemAtIndex(){return this.$$.ctx[39]}get getElement(){return this.$$.ctx[40]}}function tx(e){let t;return{c(){t=Rn("span"),this.h()},l(n){t=Fn(n,"SPAN",{class:!0}),_n(t).forEach(yi),this.h()},h(){Ti(t,"class","mdc-deprecated-list-item__ripple")},m(n,c){Un(n,t,c)},d(n){n&&yi(t)}}}function xC(e){let t,n,c=e[7]&&tx();const g=e[34].default,x=Hl(g,e,e[37],null);return{c(){c&&c.c(),t=xs(),x&&x.c()},l(S){c&&c.l(S),t=xs(),x&&x.l(S)},m(S,a){c&&c.m(S,a),Un(S,t,a),x&&x.m(S,a),n=!0},p(S,a){S[7]?c||(c=tx(),c.c(),c.m(t.parentNode,t)):c&&(c.d(1),c=null),x&&x.p&&(!n||a[1]&64)&&jl(x,g,S,S[37],n?Ql(g,S[37],a,null):Zl(S[37]),null)},i(S){n||(Wi(x,S),n=!0)},o(S){tn(x,S),n=!1},d(S){S&&yi(t),c&&c.d(S),x&&x.d(S)}}}function bC(e){let t,n,c;const g=[{tag:e[14]},{use:[...e[6]?[]:[[Xd,{ripple:!e[16],unbounded:!1,color:(e[1]||e[0])&&e[5]==null?"primary":e[5],disabled:e[10],addClass:e[24],removeClass:e[25],addStyle:e[26]}]],e[22],...e[2]]},{class:Ts({[e[3]]:!0,"mdc-deprecated-list-item":!e[8],"mdc-deprecated-list-item__wrapper":e[8],"mdc-deprecated-list-item--activated":e[1],"mdc-deprecated-list-item--selected":e[0],"mdc-deprecated-list-item--disabled":e[10],"mdc-menu-item--selected":!e[23]&&e[9]==="menuitem"&&e[0],"smui-menu-item--non-interactive":e[6],...e[18]})},{style:Object.entries(e[19]).map(D1).concat([e[4]]).join(" ")},e[23]&&e[1]?{"aria-current":"page"}:{},!e[23]||e[8]?{role:e[9]}:{},!e[23]&&e[9]==="option"?{"aria-selected":e[0]?"true":"false"}:{},!e[23]&&(e[9]==="radio"||e[9]==="checkbox")?{"aria-checked":e[16]&&e[16].checked?"true":"false"}:{},e[23]?{}:{"aria-disabled":e[10]?"true":"false"},{"data-menu-item-skip-restore-focus":e[11]||void 0},{tabindex:e[21]},{href:e[12]},e[20],e[29]];var x=e[13];function S(a,U){let W={$$slots:{default:[xC]},$$scope:{ctx:a}};if(U!==void 0&&U[0]&670916479)W=ma(g,[U[0]&16384&&{tag:a[14]},U[0]&121701479&&{use:[...a[6]?[]:[[Xd,{ripple:!a[16],unbounded:!1,color:(a[1]||a[0])&&a[5]==null?"primary":a[5],disabled:a[10],addClass:a[24],removeClass:a[25],addStyle:a[26]}]],a[22],...a[2]]},U[0]&8652619&&{class:Ts({[a[3]]:!0,"mdc-deprecated-list-item":!a[8],"mdc-deprecated-list-item__wrapper":a[8],"mdc-deprecated-list-item--activated":a[1],"mdc-deprecated-list-item--selected":a[0],"mdc-deprecated-list-item--disabled":a[10],"mdc-menu-item--selected":!a[23]&&a[9]==="menuitem"&&a[0],"smui-menu-item--non-interactive":a[6],...a[18]})},U[0]&524304&&{style:Object.entries(a[19]).map(D1).concat([a[4]]).join(" ")},U[0]&8388610&&Os(a[23]&&a[1]?{"aria-current":"page"}:{}),U[0]&8389376&&Os(!a[23]||a[8]?{role:a[9]}:{}),U[0]&8389121&&Os(!a[23]&&a[9]==="option"?{"aria-selected":a[0]?"true":"false"}:{}),U[0]&8454656&&Os(!a[23]&&(a[9]==="radio"||a[9]==="checkbox")?{"aria-checked":a[16]&&a[16].checked?"true":"false"}:{}),U[0]&8389632&&Os(a[23]?{}:{"aria-disabled":a[10]?"true":"false"}),U[0]&2048&&{"data-menu-item-skip-restore-focus":a[11]||void 0},U[0]&2097152&&{tabindex:a[21]},U[0]&4096&&{href:a[12]},U[0]&1048576&&Os(a[20]),U[0]&536870912&&Os(a[29])]);else for(let he=0;he<g.length;he+=1)W=_r(W,g[he]);return{props:W}}return x&&(t=ef(x,S(e)),e[35](t),t.$on("click",e[15]),t.$on("keydown",e[27]),t.$on("SMUIGenericInput:mount",e[28]),t.$on("SMUIGenericInput:unmount",e[36])),{c(){t&&Jr(t.$$.fragment),n=xs()},l(a){t&&vs(t.$$.fragment,a),n=xs()},m(a,U){t&&es(t,a,U),Un(a,n,U),c=!0},p(a,U){if(U[0]&8192&&x!==(x=a[13])){if(t){Eo();const W=t;tn(W.$$.fragment,1,0,()=>{ts(W,1)}),Co()}x?(t=ef(x,S(a,U)),a[35](t),t.$on("click",a[15]),t.$on("keydown",a[27]),t.$on("SMUIGenericInput:mount",a[28]),t.$on("SMUIGenericInput:unmount",a[36]),Jr(t.$$.fragment),Wi(t.$$.fragment,1),es(t,n.parentNode,n)):t=null}else if(x){const W=U[0]&670916479?ma(g,[U[0]&16384&&{tag:a[14]},U[0]&121701479&&{use:[...a[6]?[]:[[Xd,{ripple:!a[16],unbounded:!1,color:(a[1]||a[0])&&a[5]==null?"primary":a[5],disabled:a[10],addClass:a[24],removeClass:a[25],addStyle:a[26]}]],a[22],...a[2]]},U[0]&8652619&&{class:Ts({[a[3]]:!0,"mdc-deprecated-list-item":!a[8],"mdc-deprecated-list-item__wrapper":a[8],"mdc-deprecated-list-item--activated":a[1],"mdc-deprecated-list-item--selected":a[0],"mdc-deprecated-list-item--disabled":a[10],"mdc-menu-item--selected":!a[23]&&a[9]==="menuitem"&&a[0],"smui-menu-item--non-interactive":a[6],...a[18]})},U[0]&524304&&{style:Object.entries(a[19]).map(D1).concat([a[4]]).join(" ")},U[0]&8388610&&Os(a[23]&&a[1]?{"aria-current":"page"}:{}),U[0]&8389376&&Os(!a[23]||a[8]?{role:a[9]}:{}),U[0]&8389121&&Os(!a[23]&&a[9]==="option"?{"aria-selected":a[0]?"true":"false"}:{}),U[0]&8454656&&Os(!a[23]&&(a[9]==="radio"||a[9]==="checkbox")?{"aria-checked":a[16]&&a[16].checked?"true":"false"}:{}),U[0]&8389632&&Os(a[23]?{}:{"aria-disabled":a[10]?"true":"false"}),U[0]&2048&&{"data-menu-item-skip-restore-focus":a[11]||void 0},U[0]&2097152&&{tabindex:a[21]},U[0]&4096&&{href:a[12]},U[0]&1048576&&Os(a[20]),U[0]&536870912&&Os(a[29])]):{};U[0]&128|U[1]&64&&(W.$$scope={dirty:U,ctx:a}),t.$set(W)}},i(a){c||(t&&Wi(t.$$.fragment,a),c=!0)},o(a){t&&tn(t.$$.fragment,a),c=!1},d(a){a&&yi(n),e[35](null),t&&ts(t,a)}}}let wC=0;const D1=([e,t])=>`${e}: ${t};`;function SC(e,t,n){let c;const g=["use","class","style","color","nonInteractive","ripple","wrapper","activated","role","selected","disabled","skipRestoreFocus","tabindex","inputId","href","component","tag","action","getPrimaryText","getElement"];let x=Ao(t,g),{$$slots:S={},$$scope:a}=t;var U;const W=Ic(xc());let he=()=>{};function ae(Yt){return Yt===he}let{use:ce=[]}=t,{class:be=""}=t,{style:Je=""}=t,{color:st=void 0}=t,{nonInteractive:Ye=(U=Cu("SMUI:list:nonInteractive"))!==null&&U!==void 0?U:!1}=t;du("SMUI:list:nonInteractive",void 0);let{ripple:it=!Ye}=t,{wrapper:ct=!1}=t,{activated:Tt=!1}=t,{role:zt=ct?"presentation":Cu("SMUI:list:item:role")}=t;du("SMUI:list:item:role",void 0);let{selected:Rt=!1}=t,{disabled:Oe=!1}=t,{skipRestoreFocus:jt=!1}=t,{tabindex:at=he}=t,{inputId:_t="SMUI-form-field-list-"+wC++}=t,{href:mt=void 0}=t,xt,bt={},lt={},$e={},pt,ut,Nt=Cu("SMUI:list:item:nav"),{component:Bt=tf}=t,{tag:Ot=Bt===tf?Nt?mt?"a":"span":"li":void 0}=t;du("SMUI:generic:input:props",{id:_t}),du("SMUI:separator:context",void 0),bc(()=>{if(!Rt&&!Ye){let rn=!0,Xt=xt.getElement();for(;Xt.previousSibling;)if(Xt=Xt.previousSibling,Xt.nodeType===1&&Xt.classList.contains("mdc-deprecated-list-item")&&!Xt.classList.contains("mdc-deprecated-list-item--disabled")){rn=!1;break}rn&&(ut=window.requestAnimationFrame(()=>nn(Xt)))}const Yt={_smui_list_item_accessor:!0,get element(){return Oi()},get selected(){return Rt},set selected(rn){n(0,Rt=rn)},hasClass:gi,addClass:Ii,removeClass:Ci,getAttr:Ki,addAttr:Hi,removeAttr:Ni,getPrimaryText:zi,get checked(){var rn;return(rn=pt&&pt.checked)!==null&&rn!==void 0?rn:!1},set checked(rn){pt&&n(16,pt.checked=!!rn,pt)},get hasCheckbox(){return!!(pt&&"_smui_checkbox_accessor"in pt)},get hasRadio(){return!!(pt&&"_smui_radio_accessor"in pt)},activateRipple(){pt&&pt.activateRipple()},deactivateRipple(){pt&&pt.deactivateRipple()},getValue(){return x.value},action:mi,get tabindex(){return c},set tabindex(rn){n(30,at=rn)},get disabled(){return Oe},get activated(){return Tt},set activated(rn){n(1,Tt=rn)}};return au(Oi(),"SMUIListItem:mount",Yt),()=>{au(Oi(),"SMUIListItem:unmount",Yt)}}),wm(()=>{ut&&window.cancelAnimationFrame(ut)});function gi(Yt){return Yt in bt?bt[Yt]:Oi().classList.contains(Yt)}function Ii(Yt){bt[Yt]||n(18,bt[Yt]=!0,bt)}function Ci(Yt){(!(Yt in bt)||bt[Yt])&&n(18,bt[Yt]=!1,bt)}function Ri(Yt,rn){lt[Yt]!=rn&&(rn===""||rn==null?(delete lt[Yt],n(19,lt)):n(19,lt[Yt]=rn,lt))}function Ki(Yt){var rn;return Yt in $e?(rn=$e[Yt])!==null&&rn!==void 0?rn:null:Oi().getAttribute(Yt)}function Hi(Yt,rn){$e[Yt]!==rn&&n(20,$e[Yt]=rn,$e)}function Ni(Yt){(!(Yt in $e)||$e[Yt]!=null)&&n(20,$e[Yt]=void 0,$e)}function nn(Yt){let rn=!0;for(;Yt.nextElementSibling;)if(Yt=Yt.nextElementSibling,Yt.nodeType===1&&Yt.classList.contains("mdc-deprecated-list-item")){const Xt=Yt.attributes.getNamedItem("tabindex");if(Xt&&Xt.value==="0"){rn=!1;break}}rn&&n(21,c=0)}function vn(Yt){const rn=Yt.key==="Enter",Xt=Yt.key==="Space";(rn||Xt)&&mi(Yt)}function Ei(Yt){("_smui_checkbox_accessor"in Yt.detail||"_smui_radio_accessor"in Yt.detail)&&n(16,pt=Yt.detail)}function mi(Yt){Oe||au(Oi(),"SMUI:action",Yt)}function zi(){var Yt,rn,Xt;const Ji=Oi(),mr=Ji.querySelector(".mdc-deprecated-list-item__primary-text");if(mr)return(Yt=mr.textContent)!==null&&Yt!==void 0?Yt:"";const ci=Ji.querySelector(".mdc-deprecated-list-item__text");return ci?(rn=ci.textContent)!==null&&rn!==void 0?rn:"":(Xt=Ji.textContent)!==null&&Xt!==void 0?Xt:""}function Oi(){return xt.getElement()}function xn(Yt){ua[Yt?"unshift":"push"](()=>{xt=Yt,n(17,xt)})}const bn=()=>n(16,pt=void 0);return e.$$set=Yt=>{t=_r(_r({},t),ic(Yt)),n(29,x=Ao(t,g)),"use"in Yt&&n(2,ce=Yt.use),"class"in Yt&&n(3,be=Yt.class),"style"in Yt&&n(4,Je=Yt.style),"color"in Yt&&n(5,st=Yt.color),"nonInteractive"in Yt&&n(6,Ye=Yt.nonInteractive),"ripple"in Yt&&n(7,it=Yt.ripple),"wrapper"in Yt&&n(8,ct=Yt.wrapper),"activated"in Yt&&n(1,Tt=Yt.activated),"role"in Yt&&n(9,zt=Yt.role),"selected"in Yt&&n(0,Rt=Yt.selected),"disabled"in Yt&&n(10,Oe=Yt.disabled),"skipRestoreFocus"in Yt&&n(11,jt=Yt.skipRestoreFocus),"tabindex"in Yt&&n(30,at=Yt.tabindex),"inputId"in Yt&&n(31,_t=Yt.inputId),"href"in Yt&&n(12,mt=Yt.href),"component"in Yt&&n(13,Bt=Yt.component),"tag"in Yt&&n(14,Ot=Yt.tag),"$$scope"in Yt&&n(37,a=Yt.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&1073808449&&n(21,c=ae(at)?!Ye&&!Oe&&(Rt||pt&&pt.checked)?0:-1:at)},[Rt,Tt,ce,be,Je,st,Ye,it,ct,zt,Oe,jt,mt,Bt,Ot,mi,pt,xt,bt,lt,$e,c,W,Nt,Ii,Ci,Ri,vn,Ei,x,at,_t,zi,Oi,S,xn,bn,a]}class IC extends fo{constructor(t){super(),po(this,t,SC,bC,Va,{use:2,class:3,style:4,color:5,nonInteractive:6,ripple:7,wrapper:8,activated:1,role:9,selected:0,disabled:10,skipRestoreFocus:11,tabindex:30,inputId:31,href:12,component:13,tag:14,action:15,getPrimaryText:32,getElement:33},null,[-1,-1])}get action(){return this.$$.ctx[15]}get getPrimaryText(){return this.$$.ctx[32]}get getElement(){return this.$$.ctx[33]}}cp({class:"mdc-deprecated-list-item__text",tag:"span"});cp({class:"mdc-deprecated-list-item__primary-text",tag:"span"});cp({class:"mdc-deprecated-list-item__secondary-text",tag:"span"});function EC(e){let t,n,c,g,x,S;const a=e[8].default,U=Hl(a,e,e[7],null);let W=[{class:n=Ts({[e[1]]:!0,"mdc-deprecated-list-item__graphic":!0,"mdc-menu__selection-group-icon":e[4]})},e[5]],he={};for(let ae=0;ae<W.length;ae+=1)he=_r(he,W[ae]);return{c(){t=Rn("span"),U&&U.c(),this.h()},l(ae){t=Fn(ae,"SPAN",{class:!0});var ce=_n(t);U&&U.l(ce),ce.forEach(yi),this.h()},h(){sl(t,he)},m(ae,ce){Un(ae,t,ce),U&&U.m(t,null),e[9](t),g=!0,x||(S=[Io(c=mc.call(null,t,e[0])),Io(e[3].call(null,t))],x=!0)},p(ae,[ce]){U&&U.p&&(!g||ce&128)&&jl(U,a,ae,ae[7],g?Ql(a,ae[7],ce,null):Zl(ae[7]),null),sl(t,he=ma(W,[(!g||ce&2&&n!==(n=Ts({[ae[1]]:!0,"mdc-deprecated-list-item__graphic":!0,"mdc-menu__selection-group-icon":ae[4]})))&&{class:n},ce&32&&ae[5]])),c&&Eu(c.update)&&ce&1&&c.update.call(null,ae[0])},i(ae){g||(Wi(U,ae),g=!0)},o(ae){tn(U,ae),g=!1},d(ae){ae&&yi(t),U&&U.d(ae),e[9](null),x=!1,Nh(S)}}}function CC(e,t,n){const c=["use","class","getElement"];let g=Ao(t,c),{$$slots:x={},$$scope:S}=t;const a=Ic(xc());let{use:U=[]}=t,{class:W=""}=t,he,ae=Cu("SMUI:list:graphic:menu-selection-group");function ce(){return he}function be(Je){ua[Je?"unshift":"push"](()=>{he=Je,n(2,he)})}return e.$$set=Je=>{t=_r(_r({},t),ic(Je)),n(5,g=Ao(t,c)),"use"in Je&&n(0,U=Je.use),"class"in Je&&n(1,W=Je.class),"$$scope"in Je&&n(7,S=Je.$$scope)},[U,W,he,a,ae,g,ce,S,x,be]}class TC extends fo{constructor(t){super(),po(this,t,CC,EC,Va,{use:0,class:1,getElement:6})}get getElement(){return this.$$.ctx[6]}}cp({class:"mdc-deprecated-list-item__meta",tag:"span"});cp({class:"mdc-deprecated-list-group",tag:"div"});cp({class:"mdc-deprecated-list-group__subheader",tag:"h3"});cp({class:"mdc-menu__selection-group-icon",component:TC});function kC(e){let t,n,c,g,x,S,a,U;const W=e[22].default,he=Hl(W,e,e[21],null);let ae=[{class:n=Ts({[e[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":e[0],"mdc-floating-label--required":e[1],...e[8]})},{style:c=Object.entries(e[9]).map(nx).concat([e[4]]).join(" ")},{for:g=e[5]||(e[11]?e[11].id:void 0)},e[12]],ce={};for(let be=0;be<ae.length;be+=1)ce=_r(ce,ae[be]);return{c(){t=Rn("label"),he&&he.c(),this.h()},l(be){t=Fn(be,"LABEL",{class:!0,style:!0,for:!0});var Je=_n(t);he&&he.l(Je),Je.forEach(yi),this.h()},h(){sl(t,ce)},m(be,Je){Un(be,t,Je),he&&he.m(t,null),e[24](t),S=!0,a||(U=[Io(x=mc.call(null,t,e[2])),Io(e[10].call(null,t))],a=!0)},p(be,Je){he&&he.p&&(!S||Je&2097152)&&jl(he,W,be,be[21],S?Ql(W,be[21],Je,null):Zl(be[21]),null),sl(t,ce=ma(ae,[(!S||Je&267&&n!==(n=Ts({[be[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":be[0],"mdc-floating-label--required":be[1],...be[8]})))&&{class:n},(!S||Je&528&&c!==(c=Object.entries(be[9]).map(nx).concat([be[4]]).join(" ")))&&{style:c},(!S||Je&32&&g!==(g=be[5]||(be[11]?be[11].id:void 0)))&&{for:g},Je&4096&&be[12]])),x&&Eu(x.update)&&Je&4&&x.update.call(null,be[2])},i(be){S||(Wi(he,be),S=!0)},o(be){tn(he,be),S=!1},d(be){be&&yi(t),he&&he.d(be),e[24](null),a=!1,Nh(U)}}}function MC(e){let t,n,c,g,x,S,a;const U=e[22].default,W=Hl(U,e,e[21],null);let he=[{class:n=Ts({[e[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":e[0],"mdc-floating-label--required":e[1],...e[8]})},{style:c=Object.entries(e[9]).map(ix).concat([e[4]]).join(" ")},e[12]],ae={};for(let ce=0;ce<he.length;ce+=1)ae=_r(ae,he[ce]);return{c(){t=Rn("span"),W&&W.c(),this.h()},l(ce){t=Fn(ce,"SPAN",{class:!0,style:!0});var be=_n(t);W&&W.l(be),be.forEach(yi),this.h()},h(){sl(t,ae)},m(ce,be){Un(ce,t,be),W&&W.m(t,null),e[23](t),x=!0,S||(a=[Io(g=mc.call(null,t,e[2])),Io(e[10].call(null,t))],S=!0)},p(ce,be){W&&W.p&&(!x||be&2097152)&&jl(W,U,ce,ce[21],x?Ql(U,ce[21],be,null):Zl(ce[21]),null),sl(t,ae=ma(he,[(!x||be&267&&n!==(n=Ts({[ce[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":ce[0],"mdc-floating-label--required":ce[1],...ce[8]})))&&{class:n},(!x||be&528&&c!==(c=Object.entries(ce[9]).map(ix).concat([ce[4]]).join(" ")))&&{style:c},be&4096&&ce[12]])),g&&Eu(g.update)&&be&4&&g.update.call(null,ce[2])},i(ce){x||(Wi(W,ce),x=!0)},o(ce){tn(W,ce),x=!1},d(ce){ce&&yi(t),W&&W.d(ce),e[23](null),S=!1,Nh(a)}}}function PC(e){let t,n,c,g;const x=[MC,kC],S=[];function a(U,W){return U[6]?0:1}return t=a(e),n=S[t]=x[t](e),{c(){n.c(),c=xs()},l(U){n.l(U),c=xs()},m(U,W){S[t].m(U,W),Un(U,c,W),g=!0},p(U,[W]){let he=t;t=a(U),t===he?S[t].p(U,W):(Eo(),tn(S[he],1,1,()=>{S[he]=null}),Co(),n=S[t],n?n.p(U,W):(n=S[t]=x[t](U),n.c()),Wi(n,1),n.m(c.parentNode,c))},i(U){g||(Wi(n),g=!0)},o(U){tn(n),g=!1},d(U){U&&yi(c),S[t].d(U)}}}const ix=([e,t])=>`${e}: ${t};`,nx=([e,t])=>`${e}: ${t};`;function DC(e,t,n){const c=["use","class","style","for","floatAbove","required","wrapped","shake","float","setRequired","getWidth","getElement"];let g=Ao(t,c),{$$slots:x={},$$scope:S}=t;var a;const U=Ic(xc());let{use:W=[]}=t,{class:he=""}=t,{style:ae=""}=t,{for:ce=void 0}=t,{floatAbove:be=!1}=t,{required:Je=!1}=t,{wrapped:st=!1}=t,Ye,it,ct={},Tt={},zt=(a=Cu("SMUI:generic:input:props"))!==null&&a!==void 0?a:{},Rt=be,Oe=Je;bc(()=>{n(18,it=new pE({addClass:jt,removeClass:at,getWidth:()=>{var Ot,gi;const Ii=pt(),Ci=Ii.cloneNode(!0);(Ot=Ii.parentNode)===null||Ot===void 0||Ot.appendChild(Ci),Ci.classList.add("smui-floating-label--remove-transition"),Ci.classList.add("smui-floating-label--force-size"),Ci.classList.remove("mdc-floating-label--float-above");const Ri=Ci.scrollWidth;return(gi=Ii.parentNode)===null||gi===void 0||gi.removeChild(Ci),Ri},registerInteractionHandler:(Ot,gi)=>pt().addEventListener(Ot,gi),deregisterInteractionHandler:(Ot,gi)=>pt().removeEventListener(Ot,gi)}));const Bt={get element(){return pt()},addStyle:_t,removeStyle:mt};return au(Ye,"SMUIFloatingLabel:mount",Bt),it.init(),()=>{au(Ye,"SMUIFloatingLabel:unmount",Bt),it.destroy()}});function jt(Bt){ct[Bt]||n(8,ct[Bt]=!0,ct)}function at(Bt){(!(Bt in ct)||ct[Bt])&&n(8,ct[Bt]=!1,ct)}function _t(Bt,Ot){Tt[Bt]!=Ot&&(Ot===""||Ot==null?(delete Tt[Bt],n(9,Tt)):n(9,Tt[Bt]=Ot,Tt))}function mt(Bt){Bt in Tt&&(delete Tt[Bt],n(9,Tt))}function xt(Bt){it.shake(Bt)}function bt(Bt){n(0,be=Bt)}function lt(Bt){n(1,Je=Bt)}function $e(){return it.getWidth()}function pt(){return Ye}function ut(Bt){ua[Bt?"unshift":"push"](()=>{Ye=Bt,n(7,Ye)})}function Nt(Bt){ua[Bt?"unshift":"push"](()=>{Ye=Bt,n(7,Ye)})}return e.$$set=Bt=>{t=_r(_r({},t),ic(Bt)),n(12,g=Ao(t,c)),"use"in Bt&&n(2,W=Bt.use),"class"in Bt&&n(3,he=Bt.class),"style"in Bt&&n(4,ae=Bt.style),"for"in Bt&&n(5,ce=Bt.for),"floatAbove"in Bt&&n(0,be=Bt.floatAbove),"required"in Bt&&n(1,Je=Bt.required),"wrapped"in Bt&&n(6,st=Bt.wrapped),"$$scope"in Bt&&n(21,S=Bt.$$scope)},e.$$.update=()=>{e.$$.dirty&786433&&it&&Rt!==be&&(n(19,Rt=be),it.float(be)),e.$$.dirty&1310722&&it&&Oe!==Je&&(n(20,Oe=Je),it.setRequired(Je))},[be,Je,W,he,ae,ce,st,Ye,ct,Tt,U,zt,g,xt,bt,lt,$e,pt,it,Rt,Oe,S,x,ut,Nt]}class m3 extends fo{constructor(t){super(),po(this,t,DC,PC,Va,{use:2,class:3,style:4,for:5,floatAbove:0,required:1,wrapped:6,shake:13,float:14,setRequired:15,getWidth:16,getElement:17})}get shake(){return this.$$.ctx[13]}get float(){return this.$$.ctx[14]}get setRequired(){return this.$$.ctx[15]}get getWidth(){return this.$$.ctx[16]}get getElement(){return this.$$.ctx[17]}}function LC(e){let t,n,c,g,x,S,a=[{class:n=Ts({[e[1]]:!0,"mdc-line-ripple":!0,"mdc-line-ripple--active":e[3],...e[5]})},{style:c=Object.entries(e[6]).map(rx).concat([e[2]]).join(" ")},e[8]],U={};for(let W=0;W<a.length;W+=1)U=_r(U,a[W]);return{c(){t=Rn("div"),this.h()},l(W){t=Fn(W,"DIV",{class:!0,style:!0}),_n(t).forEach(yi),this.h()},h(){sl(t,U)},m(W,he){Un(W,t,he),e[13](t),x||(S=[Io(g=mc.call(null,t,e[0])),Io(e[7].call(null,t))],x=!0)},p(W,[he]){sl(t,U=ma(a,[he&42&&n!==(n=Ts({[W[1]]:!0,"mdc-line-ripple":!0,"mdc-line-ripple--active":W[3],...W[5]}))&&{class:n},he&68&&c!==(c=Object.entries(W[6]).map(rx).concat([W[2]]).join(" "))&&{style:c},he&256&&W[8]])),g&&Eu(g.update)&&he&1&&g.update.call(null,W[0])},i:Oa,o:Oa,d(W){W&&yi(t),e[13](null),x=!1,Nh(S)}}}const rx=([e,t])=>`${e}: ${t};`;function BC(e,t,n){const c=["use","class","style","active","activate","deactivate","setRippleCenter","getElement"];let g=Ao(t,c);const x=Ic(xc());let{use:S=[]}=t,{class:a=""}=t,{style:U=""}=t,{active:W=!1}=t,he,ae,ce={},be={};bc(()=>(ae=new mE({addClass:st,removeClass:Ye,hasClass:Je,setStyle:it,registerEventHandler:(jt,at)=>Rt().addEventListener(jt,at),deregisterEventHandler:(jt,at)=>Rt().removeEventListener(jt,at)}),ae.init(),()=>{ae.destroy()}));function Je(jt){return jt in ce?ce[jt]:Rt().classList.contains(jt)}function st(jt){ce[jt]||n(5,ce[jt]=!0,ce)}function Ye(jt){(!(jt in ce)||ce[jt])&&n(5,ce[jt]=!1,ce)}function it(jt,at){be[jt]!=at&&(at===""||at==null?(delete be[jt],n(6,be)):n(6,be[jt]=at,be))}function ct(){ae.activate()}function Tt(){ae.deactivate()}function zt(jt){ae.setRippleCenter(jt)}function Rt(){return he}function Oe(jt){ua[jt?"unshift":"push"](()=>{he=jt,n(4,he)})}return e.$$set=jt=>{t=_r(_r({},t),ic(jt)),n(8,g=Ao(t,c)),"use"in jt&&n(0,S=jt.use),"class"in jt&&n(1,a=jt.class),"style"in jt&&n(2,U=jt.style),"active"in jt&&n(3,W=jt.active)},[S,a,U,W,he,ce,be,x,g,ct,Tt,zt,Rt,Oe]}class zC extends fo{constructor(t){super(),po(this,t,BC,LC,Va,{use:0,class:1,style:2,active:3,activate:9,deactivate:10,setRippleCenter:11,getElement:12})}get activate(){return this.$$.ctx[9]}get deactivate(){return this.$$.ctx[10]}get setRippleCenter(){return this.$$.ctx[11]}get getElement(){return this.$$.ctx[12]}}function sx(e){let t,n,c;const g=e[15].default,x=Hl(g,e,e[14],null);return{c(){t=Rn("div"),x&&x.c(),this.h()},l(S){t=Fn(S,"DIV",{class:!0,style:!0});var a=_n(t);x&&x.l(a),a.forEach(yi),this.h()},h(){Ti(t,"class","mdc-notched-outline__notch"),Ti(t,"style",n=Object.entries(e[7]).map(ax).join(" "))},m(S,a){Un(S,t,a),x&&x.m(t,null),c=!0},p(S,a){x&&x.p&&(!c||a&16384)&&jl(x,g,S,S[14],c?Ql(g,S[14],a,null):Zl(S[14]),null),(!c||a&128&&n!==(n=Object.entries(S[7]).map(ax).join(" ")))&&Ti(t,"style",n)},i(S){c||(Wi(x,S),c=!0)},o(S){tn(x,S),c=!1},d(S){S&&yi(t),x&&x.d(S)}}}function RC(e){let t,n,c,g,x,S,a,U,W,he,ae=!e[3]&&sx(e),ce=[{class:S=Ts({[e[1]]:!0,"mdc-notched-outline":!0,"mdc-notched-outline--notched":e[2],"mdc-notched-outline--no-label":e[3],...e[6]})},e[10]],be={};for(let Je=0;Je<ce.length;Je+=1)be=_r(be,ce[Je]);return{c(){t=Rn("div"),n=Rn("div"),c=Sr(),ae&&ae.c(),g=Sr(),x=Rn("div"),this.h()},l(Je){t=Fn(Je,"DIV",{class:!0});var st=_n(t);n=Fn(st,"DIV",{class:!0}),_n(n).forEach(yi),c=Ir(st),ae&&ae.l(st),g=Ir(st),x=Fn(st,"DIV",{class:!0}),_n(x).forEach(yi),st.forEach(yi),this.h()},h(){Ti(n,"class","mdc-notched-outline__leading"),Ti(x,"class","mdc-notched-outline__trailing"),sl(t,be)},m(Je,st){Un(Je,t,st),qi(t,n),qi(t,c),ae&&ae.m(t,null),qi(t,g),qi(t,x),e[16](t),U=!0,W||(he=[Io(a=mc.call(null,t,e[0])),Io(e[8].call(null,t)),Gl(t,"SMUIFloatingLabel:mount",e[9]),Gl(t,"SMUIFloatingLabel:unmount",e[17])],W=!0)},p(Je,[st]){Je[3]?ae&&(Eo(),tn(ae,1,1,()=>{ae=null}),Co()):ae?(ae.p(Je,st),st&8&&Wi(ae,1)):(ae=sx(Je),ae.c(),Wi(ae,1),ae.m(t,g)),sl(t,be=ma(ce,[(!U||st&78&&S!==(S=Ts({[Je[1]]:!0,"mdc-notched-outline":!0,"mdc-notched-outline--notched":Je[2],"mdc-notched-outline--no-label":Je[3],...Je[6]})))&&{class:S},st&1024&&Je[10]])),a&&Eu(a.update)&&st&1&&a.update.call(null,Je[0])},i(Je){U||(Wi(ae),U=!0)},o(Je){tn(ae),U=!1},d(Je){Je&&yi(t),ae&&ae.d(),e[16](null),W=!1,Nh(he)}}}const ax=([e,t])=>`${e}: ${t};`;function FC(e,t,n){const c=["use","class","notched","noLabel","notch","closeNotch","getElement"];let g=Ao(t,c),{$$slots:x={},$$scope:S}=t;const a=Ic(xc());let{use:U=[]}=t,{class:W=""}=t,{notched:he=!1}=t,{noLabel:ae=!1}=t,ce,be,Je,st={},Ye={};bc(()=>(be=new PE({addClass:ct,removeClass:Tt,setNotchWidthProperty:xt=>zt("width",xt+"px"),removeNotchWidthProperty:()=>Rt("width")}),be.init(),()=>{be.destroy()}));function it(xt){n(4,Je=xt.detail)}function ct(xt){st[xt]||n(6,st[xt]=!0,st)}function Tt(xt){(!(xt in st)||st[xt])&&n(6,st[xt]=!1,st)}function zt(xt,bt){Ye[xt]!=bt&&(bt===""||bt==null?(delete Ye[xt],n(7,Ye)):n(7,Ye[xt]=bt,Ye))}function Rt(xt){xt in Ye&&(delete Ye[xt],n(7,Ye))}function Oe(xt){be.notch(xt)}function jt(){be.closeNotch()}function at(){return ce}function _t(xt){ua[xt?"unshift":"push"](()=>{ce=xt,n(5,ce)})}const mt=()=>n(4,Je=void 0);return e.$$set=xt=>{t=_r(_r({},t),ic(xt)),n(10,g=Ao(t,c)),"use"in xt&&n(0,U=xt.use),"class"in xt&&n(1,W=xt.class),"notched"in xt&&n(2,he=xt.notched),"noLabel"in xt&&n(3,ae=xt.noLabel),"$$scope"in xt&&n(14,S=xt.$$scope)},e.$$.update=()=>{e.$$.dirty&16&&(Je?(Je.addStyle("transition-duration","0s"),ct("mdc-notched-outline--upgraded"),requestAnimationFrame(()=>{Je&&Je.removeStyle("transition-duration")})):Tt("mdc-notched-outline--upgraded"))},[U,W,he,ae,Je,ce,st,Ye,a,it,g,Oe,jt,at,S,x,_t,mt]}class OC extends fo{constructor(t){super(),po(this,t,FC,RC,Va,{use:0,class:1,notched:2,noLabel:3,notch:11,closeNotch:12,getElement:13})}get notch(){return this.$$.ctx[11]}get closeNotch(){return this.$$.ctx[12]}get getElement(){return this.$$.ctx[13]}}function NC(e){let t;return{c(){t=ba(e[8])},l(n){t=wa(n,e[8])},m(n,c){Un(n,t,c)},p(n,c){c&256&&ql(t,n[8])},i:Oa,o:Oa,d(n){n&&yi(t)}}}function VC(e){let t;const n=e[13].default,c=Hl(n,e,e[12],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,x){c&&c.m(g,x),t=!0},p(g,x){c&&c.p&&(!t||x&4096)&&jl(c,n,g,g[12],t?Ql(n,g[12],x,null):Zl(g[12]),null)},i(g){t||(Wi(c,g),t=!0)},o(g){tn(c,g),t=!1},d(g){c&&c.d(g)}}}function UC(e){let t,n,c,g,x,S,a,U,W;const he=[VC,NC],ae=[];function ce(st,Ye){return st[8]==null?0:1}n=ce(e),c=ae[n]=he[n](e);let be=[{class:g=Ts({[e[1]]:!0,"mdc-select-helper-text":!0,"mdc-select-helper-text--validation-msg":e[4],"mdc-select-helper-text--validation-msg-persistent":e[3],...e[6]})},{"aria-hidden":x=e[3]?void 0:"true"},{id:e[2]},e[7],e[10]],Je={};for(let st=0;st<be.length;st+=1)Je=_r(Je,be[st]);return{c(){t=Rn("div"),c.c(),this.h()},l(st){t=Fn(st,"DIV",{class:!0,"aria-hidden":!0,id:!0});var Ye=_n(t);c.l(Ye),Ye.forEach(yi),this.h()},h(){sl(t,Je)},m(st,Ye){Un(st,t,Ye),ae[n].m(t,null),e[14](t),a=!0,U||(W=[Io(S=mc.call(null,t,e[0])),Io(e[9].call(null,t))],U=!0)},p(st,[Ye]){let it=n;n=ce(st),n===it?ae[n].p(st,Ye):(Eo(),tn(ae[it],1,1,()=>{ae[it]=null}),Co(),c=ae[n],c?c.p(st,Ye):(c=ae[n]=he[n](st),c.c()),Wi(c,1),c.m(t,null)),sl(t,Je=ma(be,[(!a||Ye&90&&g!==(g=Ts({[st[1]]:!0,"mdc-select-helper-text":!0,"mdc-select-helper-text--validation-msg":st[4],"mdc-select-helper-text--validation-msg-persistent":st[3],...st[6]})))&&{class:g},(!a||Ye&8&&x!==(x=st[3]?void 0:"true"))&&{"aria-hidden":x},(!a||Ye&4)&&{id:st[2]},Ye&128&&st[7],Ye&1024&&st[10]])),S&&Eu(S.update)&&Ye&1&&S.update.call(null,st[0])},i(st){a||(Wi(c),a=!0)},o(st){tn(c),a=!1},d(st){st&&yi(t),ae[n].d(),e[14](null),U=!1,Nh(W)}}}let GC=0;function qC(e,t,n){const c=["use","class","id","persistent","validationMsg","getElement"];let g=Ao(t,c),{$$slots:x={},$$scope:S}=t;const a=Ic(xc());let{use:U=[]}=t,{class:W=""}=t,{id:he="SMUI-select-helper-text-"+GC++}=t,{persistent:ae=!1}=t,{validationMsg:ce=!1}=t,be,Je,st={},Ye={},it;bc(()=>(Je=new UE({addClass:Tt,removeClass:zt,hasClass:ct,getAttr:Rt,setAttr:Oe,removeAttr:jt,setContent:mt=>{n(8,it=mt)}}),he.startsWith("SMUI-select-helper-text-")&&au(at(),"SMUISelectHelperText:id",he),au(at(),"SMUISelectHelperText:mount",Je),Je.init(),()=>{au(at(),"SMUISelectHelperText:unmount",Je),Je.destroy()}));function ct(mt){return mt in st?st[mt]:at().classList.contains(mt)}function Tt(mt){st[mt]||n(6,st[mt]=!0,st)}function zt(mt){(!(mt in st)||st[mt])&&n(6,st[mt]=!1,st)}function Rt(mt){var xt;return mt in Ye?(xt=Ye[mt])!==null&&xt!==void 0?xt:null:at().getAttribute(mt)}function Oe(mt,xt){Ye[mt]!==xt&&n(7,Ye[mt]=xt,Ye)}function jt(mt){(!(mt in Ye)||Ye[mt]!=null)&&n(7,Ye[mt]=void 0,Ye)}function at(){return be}function _t(mt){ua[mt?"unshift":"push"](()=>{be=mt,n(5,be)})}return e.$$set=mt=>{t=_r(_r({},t),ic(mt)),n(10,g=Ao(t,c)),"use"in mt&&n(0,U=mt.use),"class"in mt&&n(1,W=mt.class),"id"in mt&&n(2,he=mt.id),"persistent"in mt&&n(3,ae=mt.persistent),"validationMsg"in mt&&n(4,ce=mt.validationMsg),"$$scope"in mt&&n(12,S=mt.$$scope)},[U,W,he,ae,ce,be,st,Ye,it,a,g,at,S,x,_t]}class HC extends fo{constructor(t){super(),po(this,t,qC,UC,Va,{use:0,class:1,id:2,persistent:3,validationMsg:4,getElement:11})}get getElement(){return this.$$.ctx[11]}}const jC=e=>({}),ox=e=>({}),ZC=e=>({}),lx=e=>({}),QC=e=>({}),ux=e=>({}),WC=e=>({}),cx=e=>({});function hx(e){let t,n=[{type:"hidden"},{required:e[10]},{disabled:e[6]},{value:e[0]},wl(e[53],"input$")],c={};for(let g=0;g<n.length;g+=1)c=_r(c,n[g]);return{c(){t=Rn("input"),this.h()},l(g){t=Fn(g,"INPUT",{type:!0}),this.h()},h(){sl(t,c)},m(g,x){Un(g,t,x),t.autofocus&&t.focus()},p(g,x){sl(t,c=ma(n,[{type:"hidden"},x[0]&1024&&{required:g[10]},x[0]&64&&{disabled:g[6]},x[0]&1&&{value:g[0]},x[1]&4194304&&wl(g[53],"input$")]))},d(g){g&&yi(t)}}}function Ax(e){let t;return{c(){t=Rn("span"),this.h()},l(n){t=Fn(n,"SPAN",{class:!0}),_n(t).forEach(yi),this.h()},h(){Ti(t,"class","mdc-select__ripple")},m(n,c){Un(n,t,c)},d(n){n&&yi(t)}}}function fx(e){let t,n;const c=[{id:e[11]+"-smui-label"},{floatAbove:e[42]!==""},{required:e[10]},wl(e[53],"label$")];let g={$$slots:{default:[$C]},$$scope:{ctx:e}};for(let x=0;x<c.length;x+=1)g=_r(g,c[x]);return t=new m3({props:g}),e[67](t),{c(){Jr(t.$$.fragment)},l(x){vs(t.$$.fragment,x)},m(x,S){es(t,x,S),n=!0},p(x,S){const a=S[0]&3072|S[1]&4196352?ma(c,[S[0]&2048&&{id:x[11]+"-smui-label"},S[1]&2048&&{floatAbove:x[42]!==""},S[0]&1024&&{required:x[10]},S[1]&4194304&&Os(wl(x[53],"label$"))]):{};S[0]&512|S[2]&33554432&&(a.$$scope={dirty:S,ctx:x}),t.$set(a)},i(x){n||(Wi(t.$$.fragment,x),n=!0)},o(x){tn(t.$$.fragment,x),n=!1},d(x){e[67](null),ts(t,x)}}}function $C(e){let t=(e[9]==null?"":e[9])+"",n,c;const g=e[64].label,x=Hl(g,e,e[87],cx);return{c(){n=ba(t),x&&x.c()},l(S){n=wa(S,t),x&&x.l(S)},m(S,a){Un(S,n,a),x&&x.m(S,a),c=!0},p(S,a){(!c||a[0]&512)&&t!==(t=(S[9]==null?"":S[9])+"")&&ql(n,t),x&&x.p&&(!c||a[2]&33554432)&&jl(x,g,S,S[87],c?Ql(g,S[87],a,WC):Zl(S[87]),cx)},i(S){c||(Wi(x,S),c=!0)},o(S){tn(x,S),c=!1},d(S){S&&yi(n),x&&x.d(S)}}}function dx(e){let t,n;const c=[{noLabel:e[8]||e[9]==null&&!e[54].label},wl(e[53],"outline$")];let g={$$slots:{default:[YC]},$$scope:{ctx:e}};for(let x=0;x<c.length;x+=1)g=_r(g,c[x]);return t=new OC({props:g}),e[69](t),{c(){Jr(t.$$.fragment)},l(x){vs(t.$$.fragment,x)},m(x,S){es(t,x,S),n=!0},p(x,S){const a=S[0]&768|S[1]&12582912?ma(c,[S[0]&768|S[1]&8388608&&{noLabel:x[8]||x[9]==null&&!x[54].label},S[1]&4194304&&Os(wl(x[53],"outline$"))]):{};S[0]&3840|S[1]&12585216|S[2]&33554432&&(a.$$scope={dirty:S,ctx:x}),t.$set(a)},i(x){n||(Wi(t.$$.fragment,x),n=!0)},o(x){tn(t.$$.fragment,x),n=!1},d(x){e[69](null),ts(t,x)}}}function px(e){let t,n;const c=[{id:e[11]+"-smui-label"},{floatAbove:e[42]!==""},{required:e[10]},wl(e[53],"label$")];let g={$$slots:{default:[XC]},$$scope:{ctx:e}};for(let x=0;x<c.length;x+=1)g=_r(g,c[x]);return t=new m3({props:g}),e[68](t),{c(){Jr(t.$$.fragment)},l(x){vs(t.$$.fragment,x)},m(x,S){es(t,x,S),n=!0},p(x,S){const a=S[0]&3072|S[1]&4196352?ma(c,[S[0]&2048&&{id:x[11]+"-smui-label"},S[1]&2048&&{floatAbove:x[42]!==""},S[0]&1024&&{required:x[10]},S[1]&4194304&&Os(wl(x[53],"label$"))]):{};S[0]&512|S[2]&33554432&&(a.$$scope={dirty:S,ctx:x}),t.$set(a)},i(x){n||(Wi(t.$$.fragment,x),n=!0)},o(x){tn(t.$$.fragment,x),n=!1},d(x){e[68](null),ts(t,x)}}}function XC(e){let t=(e[9]==null?"":e[9])+"",n,c;const g=e[64].label,x=Hl(g,e,e[87],ux);return{c(){n=ba(t),x&&x.c()},l(S){n=wa(S,t),x&&x.l(S)},m(S,a){Un(S,n,a),x&&x.m(S,a),c=!0},p(S,a){(!c||a[0]&512)&&t!==(t=(S[9]==null?"":S[9])+"")&&ql(n,t),x&&x.p&&(!c||a[2]&33554432)&&jl(x,g,S,S[87],c?Ql(g,S[87],a,QC):Zl(S[87]),ux)},i(S){c||(Wi(x,S),c=!0)},o(S){tn(x,S),c=!1},d(S){S&&yi(n),x&&x.d(S)}}}function YC(e){let t,n,c=!e[8]&&(e[9]!=null||e[54].label)&&px(e);return{c(){c&&c.c(),t=xs()},l(g){c&&c.l(g),t=xs()},m(g,x){c&&c.m(g,x),Un(g,t,x),n=!0},p(g,x){!g[8]&&(g[9]!=null||g[54].label)?c?(c.p(g,x),x[0]&768|x[1]&8388608&&Wi(c,1)):(c=px(g),c.c(),Wi(c,1),c.m(t.parentNode,t)):c&&(Eo(),tn(c,1,1,()=>{c=null}),Co())},i(g){n||(Wi(c),n=!0)},o(g){tn(c),n=!1},d(g){g&&yi(t),c&&c.d(g)}}}function mx(e){let t,n;const c=[wl(e[53],"ripple$")];let g={};for(let x=0;x<c.length;x+=1)g=_r(g,c[x]);return t=new zC({props:g}),e[70](t),{c(){Jr(t.$$.fragment)},l(x){vs(t.$$.fragment,x)},m(x,S){es(t,x,S),n=!0},p(x,S){const a=S[1]&4194304?ma(c,[Os(wl(x[53],"ripple$"))]):{};t.$set(a)},i(x){n||(Wi(t.$$.fragment,x),n=!0)},o(x){tn(t.$$.fragment,x),n=!1},d(x){e[70](null),ts(t,x)}}}function KC(e){let t;const n=e[64].default,c=Hl(n,e,e[87],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,x){c&&c.m(g,x),t=!0},p(g,x){c&&c.p&&(!t||x[2]&33554432)&&jl(c,n,g,g[87],t?Ql(n,g[87],x,null):Zl(g[87]),null)},i(g){t||(Wi(c,g),t=!0)},o(g){tn(c,g),t=!1},d(g){c&&c.d(g)}}}function JC(e){let t,n,c;const g=[{role:"listbox"},{wrapFocus:e[35]},wl(e[53],"list$")];function x(a){e[75](a)}let S={$$slots:{default:[KC]},$$scope:{ctx:e}};for(let a=0;a<g.length;a+=1)S=_r(S,g[a]);return e[24]!==void 0&&(S.selectedIndex=e[24]),t=new vC({props:S}),ua.push(()=>i0(t,"selectedIndex",x)),t.$on("SMUIList:mount",e[76]),{c(){Jr(t.$$.fragment)},l(a){vs(t.$$.fragment,a)},m(a,U){es(t,a,U),c=!0},p(a,U){const W=U[1]&4194320?ma(g,[g[0],U[1]&16&&{wrapFocus:a[35]},U[1]&4194304&&Os(wl(a[53],"list$"))]):{};U[2]&33554432&&(W.$$scope={dirty:U,ctx:a}),!n&&U[0]&16777216&&(n=!0,W.selectedIndex=a[24],t0(()=>n=!1)),t.$set(W)},i(a){c||(Wi(t.$$.fragment,a),c=!0)},o(a){tn(t.$$.fragment,a),c=!1},d(a){ts(t,a)}}}function gx(e){let t,n;const c=[wl(e[53],"helperText$")];let g={$$slots:{default:[eT]},$$scope:{ctx:e}};for(let x=0;x<c.length;x+=1)g=_r(g,c[x]);return t=new HC({props:g}),t.$on("SMUISelectHelperText:id",e[84]),t.$on("SMUISelectHelperText:mount",e[85]),t.$on("SMUISelectHelperText:unmount",e[86]),{c(){Jr(t.$$.fragment)},l(x){vs(t.$$.fragment,x)},m(x,S){es(t,x,S),n=!0},p(x,S){const a=S[1]&4194304?ma(c,[Os(wl(x[53],"helperText$"))]):{};S[2]&33554432&&(a.$$scope={dirty:S,ctx:x}),t.$set(a)},i(x){n||(Wi(t.$$.fragment,x),n=!0)},o(x){tn(t.$$.fragment,x),n=!1},d(x){ts(t,x)}}}function eT(e){let t;const n=e[64].helperText,c=Hl(n,e,e[87],ox);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,x){c&&c.m(g,x),t=!0},p(g,x){c&&c.p&&(!t||x[2]&33554432)&&jl(c,n,g,g[87],t?Ql(n,g[87],x,jC):Zl(g[87]),ox)},i(g){t||(Wi(c,g),t=!0)},o(g){tn(c,g),t=!1},d(g){c&&c.d(g)}}}function tT(e){let t,n,c,g,x,S,a,U,W,he,ae,ce,be,Je,st,Ye,it,ct,Tt,zt,Rt,Oe,jt,at,_t,mt,xt,bt,lt,$e,pt,ut,Nt,Bt,Ot,gi,Ii,Ci,Ri,Ki,Hi,Ni=e[12]&&hx(e),nn=e[7]==="filled"&&Ax(),vn=e[7]!=="outlined"&&!e[8]&&(e[9]!=null||e[54].label)&&fx(e),Ei=e[7]==="outlined"&&dx(e);const mi=e[64].leadingIcon,zi=Hl(mi,e,e[87],lx);let Oi=[{id:ae=e[11]+"-smui-selected-text"},{class:ce=Ts({[e[19]]:!0,"mdc-select__selected-text":!0})},{role:"button"},{"aria-haspopup":"listbox"},{"aria-labelledby":be=e[11]+"-smui-label"},wl(e[53],"selectedText$")],xn={};for(let k=0;k<Oi.length;k+=1)xn=_r(xn,Oi[k]);let bn=[{class:st=Ts({[e[17]]:!0,"mdc-select__selected-text-container":!0})},wl(e[53],"selectedTextContainer$")],Yt={};for(let k=0;k<bn.length;k+=1)Yt=_r(Yt,bn[k]);let rn=[{class:Oe=Ts({[e[21]]:!0,"mdc-select__dropdown-icon":!0})},wl(e[53],"dropdownIcon$")],Xt={};for(let k=0;k<rn.length;k+=1)Xt=_r(Xt,rn[k]);let Ji=e[7]!=="outlined"&&e[5]&&mx(e),mr=[{class:_t=Ts({[e[15]]:!0,"mdc-select__anchor":!0})},{"aria-required":mt=e[10]?"true":void 0},{"aria-disabled":xt=e[6]?"true":void 0},{"aria-controls":e[45]},{"aria-expanded":bt=e[31]?"true":"false"},{"aria-describedby":e[30]},{role:"combobox"},{tabindex:"0"},e[29],wl(e[53],"anchor$")],ci={};for(let k=0;k<mr.length;k+=1)ci=_r(ci,mr[k]);const sn=[{class:Ts({[e[22]]:!0,"mdc-select__menu":!0,...e[32]})},{id:e[45]},{fullWidth:!0},{anchor:!1},{anchorElement:e[33]},{anchorCorner:e[34]},wl(e[53],"menu$")];function lr(k){e[77](k)}let On={$$slots:{default:[JC]},$$scope:{ctx:e}};for(let k=0;k<sn.length;k+=1)On=_r(On,sn[k]);e[31]!==void 0&&(On.open=e[31]),pt=new nC({props:On}),ua.push(()=>i0(pt,"open",lr)),pt.$on("SMUIMenu:selected",e[78]),pt.$on("SMUIMenuSurface:closing",e[79]),pt.$on("SMUIMenuSurface:closed",e[80]),pt.$on("SMUIMenuSurface:opened",e[81]);let Gn=[{class:Nt=Ts({[e[3]]:!0,"mdc-select":!0,"mdc-select--required":e[10],"mdc-select--disabled":e[6],"mdc-select--filled":e[7]==="filled","mdc-select--outlined":e[7]==="outlined","smui-select--standard":e[7]==="standard","mdc-select--with-leading-icon":e[44](e[13])?e[54].leadingIcon:e[13],"mdc-select--no-label":e[8]||e[9]==null&&!e[54].label,"mdc-select--invalid":e[1],"mdc-select--activated":e[31],"mdc-data-table__pagination-rows-per-page-select":e[46]==="data-table:pagination",...e[26]})},{style:Bt=Object.entries(e[27]).map(_x).concat([e[4]]).join(" ")},X2(e[53],["input$","anchor$","label$","outline$","selectedTextContainer$","selectedText$","dropdownIcon$","ripple$","menu$","list$","helperText$"])],pn={};for(let k=0;k<Gn.length;k+=1)pn=_r(pn,Gn[k]);let v=e[54].helperText&&gx(e);return{c(){t=Rn("div"),Ni&&Ni.c(),n=Sr(),c=Rn("div"),nn&&nn.c(),g=Sr(),vn&&vn.c(),x=Sr(),Ei&&Ei.c(),S=Sr(),zi&&zi.c(),a=Sr(),U=Rn("span"),W=Rn("span"),he=ba(e[42]),it=Sr(),ct=Rn("span"),Tt=Ra("svg"),zt=Ra("polygon"),Rt=Ra("polygon"),at=Sr(),Ji&&Ji.c(),$e=Sr(),Jr(pt.$$.fragment),Ii=Sr(),v&&v.c(),Ci=xs(),this.h()},l(k){t=Fn(k,"DIV",{class:!0,style:!0});var V=_n(t);Ni&&Ni.l(V),n=Ir(V),c=Fn(V,"DIV",{class:!0,"aria-required":!0,"aria-disabled":!0,"aria-controls":!0,"aria-expanded":!0,"aria-describedby":!0,role:!0,tabindex:!0});var Y=_n(c);nn&&nn.l(Y),g=Ir(Y),vn&&vn.l(Y),x=Ir(Y),Ei&&Ei.l(Y),S=Ir(Y),zi&&zi.l(Y),a=Ir(Y),U=Fn(Y,"SPAN",{class:!0});var te=_n(U);W=Fn(te,"SPAN",{id:!0,class:!0,role:!0,"aria-haspopup":!0,"aria-labelledby":!0});var fe=_n(W);he=wa(fe,e[42]),fe.forEach(yi),te.forEach(yi),it=Ir(Y),ct=Fn(Y,"SPAN",{class:!0});var ve=_n(ct);Tt=Fa(ve,"svg",{class:!0,viewBox:!0,focusable:!0});var Ie=_n(Tt);zt=Fa(Ie,"polygon",{class:!0,stroke:!0,"fill-rule":!0,points:!0}),_n(zt).forEach(yi),Rt=Fa(Ie,"polygon",{class:!0,stroke:!0,"fill-rule":!0,points:!0}),_n(Rt).forEach(yi),Ie.forEach(yi),ve.forEach(yi),at=Ir(Y),Ji&&Ji.l(Y),Y.forEach(yi),$e=Ir(V),vs(pt.$$.fragment,V),V.forEach(yi),Ii=Ir(k),v&&v.l(k),Ci=xs(),this.h()},h(){sl(W,xn),sl(U,Yt),Ti(zt,"class","mdc-select__dropdown-icon-inactive"),Ti(zt,"stroke","none"),Ti(zt,"fill-rule","evenodd"),Ti(zt,"points","7 10 12 15 17 10"),Ti(Rt,"class","mdc-select__dropdown-icon-active"),Ti(Rt,"stroke","none"),Ti(Rt,"fill-rule","evenodd"),Ti(Rt,"points","7 15 12 10 17 15"),Ti(Tt,"class","mdc-select__dropdown-icon-graphic"),Ti(Tt,"viewBox","7 10 10 5"),Ti(Tt,"focusable","false"),sl(ct,Xt),sl(c,ci),sl(t,pn)},m(k,V){Un(k,t,V),Ni&&Ni.m(t,null),qi(t,n),qi(t,c),nn&&nn.m(c,null),qi(c,g),vn&&vn.m(c,null),qi(c,x),Ei&&Ei.m(c,null),qi(c,S),zi&&zi.m(c,null),qi(c,a),qi(c,U),qi(U,W),qi(W,he),qi(c,it),qi(c,ct),qi(ct,Tt),qi(Tt,zt),qi(Tt,Rt),qi(c,at),Ji&&Ji.m(c,null),e[71](c),qi(t,$e),es(pt,t,null),e[82](t),Un(k,Ii,V),v&&v.m(k,V),Un(k,Ci,V),Ri=!0,Ki||(Hi=[Io(Je=mc.call(null,W,e[18])),Io(Ye=mc.call(null,U,e[16])),Io(jt=mc.call(null,ct,e[20])),Io(lt=mc.call(null,c,e[14])),Gl(c,"focus",e[72]),Gl(c,"blur",e[73]),Gl(c,"click",e[74]),Gl(c,"keydown",function(){Eu(e[23]&&e[23].handleKeydown.bind(e[23]))&&(e[23]&&e[23].handleKeydown.bind(e[23])).apply(this,arguments)}),Gl(c,"focus",e[65]),Gl(c,"blur",e[66]),Io(Ot=Xd.call(null,t,{ripple:e[7]==="filled",unbounded:!1,addClass:e[50],removeClass:e[51],addStyle:e[52]})),Io(JE.call(null,t,{addClass:e[50],removeClass:e[51]})),Io(gi=mc.call(null,t,e[2])),Io(e[43].call(null,t)),Gl(t,"SMUISelectLeadingIcon:mount",e[49]),Gl(t,"SMUISelectLeadingIcon:unmount",e[83])],Ki=!0)},p(k,V){e=k,e[12]?Ni?Ni.p(e,V):(Ni=hx(e),Ni.c(),Ni.m(t,n)):Ni&&(Ni.d(1),Ni=null),e[7]==="filled"?nn||(nn=Ax(),nn.c(),nn.m(c,g)):nn&&(nn.d(1),nn=null),e[7]!=="outlined"&&!e[8]&&(e[9]!=null||e[54].label)?vn?(vn.p(e,V),V[0]&896|V[1]&8388608&&Wi(vn,1)):(vn=fx(e),vn.c(),Wi(vn,1),vn.m(c,x)):vn&&(Eo(),tn(vn,1,1,()=>{vn=null}),Co()),e[7]==="outlined"?Ei?(Ei.p(e,V),V[0]&128&&Wi(Ei,1)):(Ei=dx(e),Ei.c(),Wi(Ei,1),Ei.m(c,S)):Ei&&(Eo(),tn(Ei,1,1,()=>{Ei=null}),Co()),zi&&zi.p&&(!Ri||V[2]&33554432)&&jl(zi,mi,e,e[87],Ri?Ql(mi,e[87],V,ZC):Zl(e[87]),lx),(!Ri||V[1]&2048)&&oE(he,e[42],xn.contenteditable),sl(W,xn=ma(Oi,[(!Ri||V[0]&2048&&ae!==(ae=e[11]+"-smui-selected-text"))&&{id:ae},(!Ri||V[0]&524288&&ce!==(ce=Ts({[e[19]]:!0,"mdc-select__selected-text":!0})))&&{class:ce},{role:"button"},{"aria-haspopup":"listbox"},(!Ri||V[0]&2048&&be!==(be=e[11]+"-smui-label"))&&{"aria-labelledby":be},V[1]&4194304&&wl(e[53],"selectedText$")])),Je&&Eu(Je.update)&&V[0]&262144&&Je.update.call(null,e[18]),sl(U,Yt=ma(bn,[(!Ri||V[0]&131072&&st!==(st=Ts({[e[17]]:!0,"mdc-select__selected-text-container":!0})))&&{class:st},V[1]&4194304&&wl(e[53],"selectedTextContainer$")])),Ye&&Eu(Ye.update)&&V[0]&65536&&Ye.update.call(null,e[16]),sl(ct,Xt=ma(rn,[(!Ri||V[0]&2097152&&Oe!==(Oe=Ts({[e[21]]:!0,"mdc-select__dropdown-icon":!0})))&&{class:Oe},V[1]&4194304&&wl(e[53],"dropdownIcon$")])),jt&&Eu(jt.update)&&V[0]&1048576&&jt.update.call(null,e[20]),e[7]!=="outlined"&&e[5]?Ji?(Ji.p(e,V),V[0]&160&&Wi(Ji,1)):(Ji=mx(e),Ji.c(),Wi(Ji,1),Ji.m(c,null)):Ji&&(Eo(),tn(Ji,1,1,()=>{Ji=null}),Co()),sl(c,ci=ma(mr,[(!Ri||V[0]&32768&&_t!==(_t=Ts({[e[15]]:!0,"mdc-select__anchor":!0})))&&{class:_t},(!Ri||V[0]&1024&&mt!==(mt=e[10]?"true":void 0))&&{"aria-required":mt},(!Ri||V[0]&64&&xt!==(xt=e[6]?"true":void 0))&&{"aria-disabled":xt},{"aria-controls":e[45]},(!Ri||V[1]&1&&bt!==(bt=e[31]?"true":"false"))&&{"aria-expanded":bt},(!Ri||V[0]&1073741824)&&{"aria-describedby":e[30]},{role:"combobox"},{tabindex:"0"},V[0]&536870912&&e[29],V[1]&4194304&&wl(e[53],"anchor$")])),lt&&Eu(lt.update)&&V[0]&16384&&lt.update.call(null,e[14]);const Y=V[0]&4194304|V[1]&4210702?ma(sn,[V[0]&4194304|V[1]&2&&{class:Ts({[e[22]]:!0,"mdc-select__menu":!0,...e[32]})},V[1]&16384&&{id:e[45]},sn[2],sn[3],V[1]&4&&{anchorElement:e[33]},V[1]&8&&{anchorCorner:e[34]},V[1]&4194304&&Os(wl(e[53],"menu$"))]):{};V[0]&16777216|V[1]&4194352|V[2]&33554432&&(Y.$$scope={dirty:V,ctx:e}),!ut&&V[1]&1&&(ut=!0,Y.open=e[31],t0(()=>ut=!1)),pt.$set(Y),sl(t,pn=ma(Gn,[(!Ri||V[0]&67119050|V[1]&8388609&&Nt!==(Nt=Ts({[e[3]]:!0,"mdc-select":!0,"mdc-select--required":e[10],"mdc-select--disabled":e[6],"mdc-select--filled":e[7]==="filled","mdc-select--outlined":e[7]==="outlined","smui-select--standard":e[7]==="standard","mdc-select--with-leading-icon":e[44](e[13])?e[54].leadingIcon:e[13],"mdc-select--no-label":e[8]||e[9]==null&&!e[54].label,"mdc-select--invalid":e[1],"mdc-select--activated":e[31],"mdc-data-table__pagination-rows-per-page-select":e[46]==="data-table:pagination",...e[26]})))&&{class:Nt},(!Ri||V[0]&134217744&&Bt!==(Bt=Object.entries(e[27]).map(_x).concat([e[4]]).join(" ")))&&{style:Bt},V[1]&4194304&&X2(e[53],["input$","anchor$","label$","outline$","selectedTextContainer$","selectedText$","dropdownIcon$","ripple$","menu$","list$","helperText$"])])),Ot&&Eu(Ot.update)&&V[0]&128&&Ot.update.call(null,{ripple:e[7]==="filled",unbounded:!1,addClass:e[50],removeClass:e[51],addStyle:e[52]}),gi&&Eu(gi.update)&&V[0]&4&&gi.update.call(null,e[2]),e[54].helperText?v?(v.p(e,V),V[1]&8388608&&Wi(v,1)):(v=gx(e),v.c(),Wi(v,1),v.m(Ci.parentNode,Ci)):v&&(Eo(),tn(v,1,1,()=>{v=null}),Co())},i(k){Ri||(Wi(vn),Wi(Ei),Wi(zi,k),Wi(Ji),Wi(pt.$$.fragment,k),Wi(v),Ri=!0)},o(k){tn(vn),tn(Ei),tn(zi,k),tn(Ji),tn(pt.$$.fragment,k),tn(v),Ri=!1},d(k){k&&(yi(t),yi(Ii),yi(Ci)),Ni&&Ni.d(),nn&&nn.d(),vn&&vn.d(),Ei&&Ei.d(),zi&&zi.d(k),Ji&&Ji.d(),e[71](null),ts(pt),e[82](null),v&&v.d(k),Ki=!1,Nh(Hi)}}}let iT=0;function nT(e){const t=e.currentTarget.getBoundingClientRect();return(rT(e)?e.touches[0].clientX:e.clientX)-t.left}function rT(e){return"touches"in e}const _x=([e,t])=>`${e}: ${t};`;function sT(e,t,n){const c=["use","class","style","ripple","disabled","variant","noLabel","label","value","key","dirty","invalid","updateInvalid","required","inputId","hiddenInput","withLeadingIcon","anchor$use","anchor$class","selectedTextContainer$use","selectedTextContainer$class","selectedText$use","selectedText$class","dropdownIcon$use","dropdownIcon$class","menu$class","getUseDefaultValidation","setUseDefaultValidation","focus","layout","getElement"];let g=Ao(t,c),x,S,{$$slots:a={},$$scope:U}=t;const W=sE(a);var he;const ae=Ic(xc());let ce=()=>{};function be(Jt){return Jt===ce}let{use:Je=[]}=t,{class:st=""}=t,{style:Ye=""}=t,{ripple:it=!0}=t,{disabled:ct=!1}=t,{variant:Tt="standard"}=t,{noLabel:zt=!1}=t,{label:Rt=void 0}=t,{value:Oe=""}=t,{key:jt=Jt=>Jt}=t,{dirty:at=!1}=t,{invalid:_t=ce}=t,{updateInvalid:mt=be(_t)}=t;const xt=be(_t);be(_t)&&(_t=!1);let{required:bt=!1}=t,{inputId:lt="SMUI-select-"+iT++}=t,{hiddenInput:$e=!1}=t,{withLeadingIcon:pt=ce}=t,{anchor$use:ut=[]}=t,{anchor$class:Nt=""}=t,{selectedTextContainer$use:Bt=[]}=t,{selectedTextContainer$class:Ot=""}=t,{selectedText$use:gi=[]}=t,{selectedText$class:Ii=""}=t,{dropdownIcon$use:Ci=[]}=t,{dropdownIcon$class:Ri=""}=t,{menu$class:Ki=""}=t,Hi,Ni,nn={},vn={},Ei,mi={},zi=-1,Oi=(he=g.menu$id)!==null&&he!==void 0?he:lt+"-menu",xn,bn=Cu("SMUI:addLayoutListener"),Yt,rn=!1,Xt={},Ji,mr,ci=!1,sn,lr=Cu("SMUI:select:context"),On,Gn,pn,v,k;du("SMUI:list:role",""),du("SMUI:list:nav",!1);const V=r0("");Bu(e,V,Jt=>n(42,x=Jt)),du("SMUI:select:selectedText",V);const Y=r0(Oe);Bu(e,Y,Jt=>n(90,S=Jt)),du("SMUI:select:value",Y);let te=zi;bn&&(Yt=bn($)),bc(()=>(n(23,Ni=new VE({setSelectedText:Jt=>{om(V,x=Jt,x)},isSelectAnchorFocused:()=>document.activeElement===Ei,getSelectAnchorAttr:Ze,setSelectAnchorAttr:Ue,removeSelectAnchorAttr:dt,addMenuClass:Qe,removeMenuClass:He,openMenu:()=>{n(31,rn=!0)},closeMenu:()=>{n(31,rn=!1)},getAnchorElement:()=>Ei,setMenuAnchorElement:Jt=>{n(33,Ji=Jt)},setMenuAnchorCorner:Jt=>{n(34,mr=Jt)},setMenuWrapFocus:Jt=>{n(35,ci=Jt)},getSelectedIndex:()=>zi,setSelectedIndex:Jt=>{n(63,te=Jt),n(24,zi=Jt),n(0,Oe=rt()[zi])},focusMenuItemAtIndex:Jt=>{sn.focusItemAtIndex(Jt)},getMenuItemCount:()=>sn.items.length,getMenuItemValues:()=>rt().map(jt),getMenuItemTextAtIndex:Jt=>sn.getPrimaryTextAtIndex(Jt),isTypeaheadInProgress:()=>sn.typeaheadInProgress,typeaheadMatchItem:(Jt,wn)=>sn.typeaheadMatchItem(Jt,wn),addClass:Ie,removeClass:Ee,hasClass:ve,setRippleCenter:Jt=>v&&v.setRippleCenter(Jt),activateBottomLine:()=>v&&v.activate(),deactivateBottomLine:()=>v&&v.deactivate(),notifyChange:Jt=>{n(55,at=!0),mt&&n(1,_t=!Ni.isValid()),au(ie(),"SMUISelect:change",{value:Oe,index:zi},void 0,!0)},hasOutline:()=>!!k,notchOutline:Jt=>k&&k.notch(Jt),closeOutline:()=>k&&k.closeNotch(),hasLabel:()=>!!pn,floatLabel:Jt=>pn&&pn.float(Jt),getLabelWidth:()=>pn?pn.getWidth():0,setLabelRequired:Jt=>pn&&pn.setRequired(Jt)},{get helperText(){return Gn},get leadingIcon(){return On}})),n(24,zi=rt().indexOf(Oe)),Ni.init(),se(xt),()=>{Ni.destroy()})),wm(()=>{Yt&&Yt()});function fe(Jt){n(37,On=Jt.detail)}function ve(Jt){return Jt in nn?nn[Jt]:ie().classList.contains(Jt)}function Ie(Jt){nn[Jt]||n(26,nn[Jt]=!0,nn)}function Ee(Jt){(!(Jt in nn)||nn[Jt])&&n(26,nn[Jt]=!1,nn)}function ze(Jt,wn){vn[Jt]!=wn&&(wn===""||wn==null?(delete vn[Jt],n(27,vn)):n(27,vn[Jt]=wn,vn))}function Qe(Jt){Xt[Jt]||n(32,Xt[Jt]=!0,Xt)}function He(Jt){(!(Jt in Xt)||Xt[Jt])&&n(32,Xt[Jt]=!1,Xt)}function Ze(Jt){var wn;return Jt in mi?(wn=mi[Jt])!==null&&wn!==void 0?wn:null:ie().getAttribute(Jt)}function Ue(Jt,wn){mi[Jt]!==wn&&n(29,mi[Jt]=wn,mi)}function dt(Jt){(!(Jt in mi)||mi[Jt]!=null)&&n(29,mi[Jt]=void 0,mi)}function rt(){return sn.getOrderedList().map(Jt=>Jt.getValue())}function Me(){return Ni.getUseDefaultValidation()}function se(Jt){Ni.setUseDefaultValidation(Jt)}function ne(){Ei.focus()}function $(){Ni.layout()}function ie(){return Hi}function de(Jt){U2.call(this,e,Jt)}function ye(Jt){U2.call(this,e,Jt)}function ge(Jt){ua[Jt?"unshift":"push"](()=>{pn=Jt,n(39,pn)})}function Pe(Jt){ua[Jt?"unshift":"push"](()=>{pn=Jt,n(39,pn)})}function Fe(Jt){ua[Jt?"unshift":"push"](()=>{k=Jt,n(41,k)})}function Ve(Jt){ua[Jt?"unshift":"push"](()=>{v=Jt,n(40,v)})}function Xe(Jt){ua[Jt?"unshift":"push"](()=>{Ei=Jt,n(28,Ei)})}const Ke=()=>Ni&&Ni.handleFocus(),De=()=>Ni&&Ni.handleBlur(),Ge=Jt=>{Ei.focus(),Ni&&Ni.handleClick(nT(Jt))};function At(Jt){zi=Jt,n(24,zi)}const kt=Jt=>n(36,sn=Jt.detail);function o(Jt){rn=Jt,n(31,rn)}const ke=Jt=>Ni&&Ni.handleMenuItemAction(Jt.detail.index),oi=()=>Ni&&Ni.handleMenuClosing(),fi=()=>Ni&&Ni.handleMenuClosed(),Ai=()=>Ni&&Ni.handleMenuOpened();function ti(Jt){ua[Jt?"unshift":"push"](()=>{Hi=Jt,n(25,Hi)})}const li=()=>n(37,On=void 0),Bi=Jt=>n(30,xn=Jt.detail),vi=Jt=>n(38,Gn=Jt.detail),bi=()=>{n(30,xn=void 0),n(38,Gn=void 0)};return e.$$set=Jt=>{t=_r(_r({},t),ic(Jt)),n(53,g=Ao(t,c)),"use"in Jt&&n(2,Je=Jt.use),"class"in Jt&&n(3,st=Jt.class),"style"in Jt&&n(4,Ye=Jt.style),"ripple"in Jt&&n(5,it=Jt.ripple),"disabled"in Jt&&n(6,ct=Jt.disabled),"variant"in Jt&&n(7,Tt=Jt.variant),"noLabel"in Jt&&n(8,zt=Jt.noLabel),"label"in Jt&&n(9,Rt=Jt.label),"value"in Jt&&n(0,Oe=Jt.value),"key"in Jt&&n(56,jt=Jt.key),"dirty"in Jt&&n(55,at=Jt.dirty),"invalid"in Jt&&n(1,_t=Jt.invalid),"updateInvalid"in Jt&&n(57,mt=Jt.updateInvalid),"required"in Jt&&n(10,bt=Jt.required),"inputId"in Jt&&n(11,lt=Jt.inputId),"hiddenInput"in Jt&&n(12,$e=Jt.hiddenInput),"withLeadingIcon"in Jt&&n(13,pt=Jt.withLeadingIcon),"anchor$use"in Jt&&n(14,ut=Jt.anchor$use),"anchor$class"in Jt&&n(15,Nt=Jt.anchor$class),"selectedTextContainer$use"in Jt&&n(16,Bt=Jt.selectedTextContainer$use),"selectedTextContainer$class"in Jt&&n(17,Ot=Jt.selectedTextContainer$class),"selectedText$use"in Jt&&n(18,gi=Jt.selectedText$use),"selectedText$class"in Jt&&n(19,Ii=Jt.selectedText$class),"dropdownIcon$use"in Jt&&n(20,Ci=Jt.dropdownIcon$use),"dropdownIcon$class"in Jt&&n(21,Ri=Jt.dropdownIcon$class),"menu$class"in Jt&&n(22,Ki=Jt.menu$class),"$$scope"in Jt&&n(87,U=Jt.$$scope)},e.$$.update=()=>{if(e.$$.dirty[0]&25165825|e.$$.dirty[2]&2&&te!==zi)if(n(63,te=zi),Ni)Ni.setSelectedIndex(zi,!1,!0);else{const Jt=rt();Oe!==Jt[zi]&&n(0,Oe=Jt[zi])}e.$$.dirty[0]&1&&om(Y,S=Oe,S),e.$$.dirty[0]&8388609|e.$$.dirty[1]&33554432&&Ni&&Ni.getValue()!==jt(Oe)&&Ni.setValue(jt(Oe)),e.$$.dirty[0]&8388672&&Ni&&Ni.getDisabled()!==ct&&Ni.setDisabled(ct),e.$$.dirty[0]&8388610|e.$$.dirty[1]&83886080&&Ni&&at&&Ni.isValid()!==!_t&&(mt?n(1,_t=!Ni.isValid()):Ni.setValid(!_t)),e.$$.dirty[0]&8389632&&Ni&&Ni.getRequired()!==bt&&Ni.setRequired(bt)},[Oe,_t,Je,st,Ye,it,ct,Tt,zt,Rt,bt,lt,$e,pt,ut,Nt,Bt,Ot,gi,Ii,Ci,Ri,Ki,Ni,zi,Hi,nn,vn,Ei,mi,xn,rn,Xt,Ji,mr,ci,sn,On,Gn,pn,v,k,x,ae,be,Oi,lr,V,Y,fe,Ie,Ee,ze,g,W,at,jt,mt,Me,se,ne,$,ie,te,a,de,ye,ge,Pe,Fe,Ve,Xe,Ke,De,Ge,At,kt,o,ke,oi,fi,Ai,ti,li,Bi,vi,bi,U]}class um extends fo{constructor(t){super(),po(this,t,sT,tT,Va,{use:2,class:3,style:4,ripple:5,disabled:6,variant:7,noLabel:8,label:9,value:0,key:56,dirty:55,invalid:1,updateInvalid:57,required:10,inputId:11,hiddenInput:12,withLeadingIcon:13,anchor$use:14,anchor$class:15,selectedTextContainer$use:16,selectedTextContainer$class:17,selectedText$use:18,selectedText$class:19,dropdownIcon$use:20,dropdownIcon$class:21,menu$class:22,getUseDefaultValidation:58,setUseDefaultValidation:59,focus:60,layout:61,getElement:62},null,[-1,-1,-1,-1])}get getUseDefaultValidation(){return this.$$.ctx[58]}get setUseDefaultValidation(){return this.$$.ctx[59]}get focus(){return this.$$.ctx[60]}get layout(){return this.$$.ctx[61]}get getElement(){return this.$$.ctx[62]}}function aT(e){let t;const n=e[11].default,c=Hl(n,e,e[13],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,x){c&&c.m(g,x),t=!0},p(g,x){c&&c.p&&(!t||x&8192)&&jl(c,n,g,g[13],t?Ql(n,g[13],x,null):Zl(g[13]),null)},i(g){t||(Wi(c,g),t=!0)},o(g){tn(c,g),t=!1},d(g){c&&c.d(g)}}}function oT(e){let t,n;const c=[{use:e[3]},{"data-value":e[0]},{value:e[0]},{selected:e[2]},e[6]];let g={$$slots:{default:[aT]},$$scope:{ctx:e}};for(let x=0;x<c.length;x+=1)g=_r(g,c[x]);return t=new IC({props:g}),e[12](t),{c(){Jr(t.$$.fragment)},l(x){vs(t.$$.fragment,x)},m(x,S){es(t,x,S),n=!0},p(x,[S]){const a=S&77?ma(c,[S&8&&{use:x[3]},S&1&&{"data-value":x[0]},S&1&&{value:x[0]},S&4&&{selected:x[2]},S&64&&Os(x[6])]):{};S&8192&&(a.$$scope={dirty:S,ctx:x}),t.$set(a)},i(x){n||(Wi(t.$$.fragment,x),n=!0)},o(x){tn(t.$$.fragment,x),n=!1},d(x){e[12](null),ts(t,x)}}}function lT(e,t,n){let c,g;const x=["use","class","value","getElement"];let S=Ao(t,x),a,U,{$$slots:W={},$$scope:he}=t;const ae=Ic(xc());let{use:ce=[]}=t;const be="";let{value:Je=""}=t,st;const Ye=Cu("SMUI:select:selectedText");Bu(e,Ye,Rt=>n(14,a=Rt));const it=Cu("SMUI:select:value");Bu(e,it,Rt=>n(10,U=Rt)),du("SMUI:list:item:role","option"),bc(ct),wm(ct);function ct(){g&&st&&om(Ye,a=st.getPrimaryText(),a)}function Tt(){return st.getElement()}function zt(Rt){ua[Rt?"unshift":"push"](()=>{st=Rt,n(1,st)})}return e.$$set=Rt=>{t=_r(_r({},t),ic(Rt)),n(6,S=Ao(t,x)),"use"in Rt&&n(7,ce=Rt.use),"value"in Rt&&n(0,Je=Rt.value),"$$scope"in Rt&&n(13,he=Rt.$$scope)},e.$$.update=()=>{e.$$.dirty&128&&n(3,c=[ae,...ce]),e.$$.dirty&1025&&n(2,g=Je!=null&&Je!==""&&U===Je)},[Je,st,g,c,Ye,it,S,ce,be,Tt,U,W,zt,he]}class Sm extends fo{constructor(t){super(),po(this,t,lT,oT,Va,{use:7,class:8,value:0,getElement:9})}get class(){return this.$$.ctx[8]}get getElement(){return this.$$.ctx[9]}}function d_(e,t,n="*ibm"){return zv[n](e,t)}function uT(e="*ibm_flip"){return[[-1,"#dddddd"],[.5,"#648FFFcc"],[1,"#7580ed"],[1.5,"#8671db"],[2,"#9762c9"],[2.5,"#a853b7"],[5,"#b944a5"],[10,"#ca3593"],[25,"#DC267Fcc"],[75,"#FFB000cc"],[90,"#e64c5a"],[97.5,"#eb6048"],[98,"#f07436"],[98.5,"#f58824"],[99,"#fa9c12"],[99.5,"#FFB000cc"]]}function cT(e="*ibm_flip"){let t=zv[e](0,1),n=[];for(let c of t)n.push(c[1]);return n}function Ho(e,t,n){return n*(t-e)+e}const zv={"*ibm":function(t,n){return[[-1,"#dddddd"],[t,"#648FFF","Very low"],[Ho(t,n,.25),"#785EF0"],[Ho(t,n,.5),"#DC267F","Expected"],[Ho(t,n,.75),"#FE6100"],[n,"#FFB000","Very high"]]},"*ibm_flip":function(t,n){return[[-1,"#dddddd"],[t,"#FFB000","Very low"],[Ho(t,n,.25),"#FE6100"],[Ho(t,n,.5),"#DC267F","Expected"],[Ho(t,n,.75),"#785EF0"],[n,"#648FFF","Very high"]]},orGrBlu:function(t,n){return[[-1,"#dddddd"],[t,"#F9A825","Very low"],[Ho(t,n,.35),"#e8f4c4"],[Ho(t,n,.5),"#00E676","Expected"],[Ho(t,n,.75),"#3d9ab8"],[Ho(t,n,.85),"#318ab5"],[n,"#2a4e9b","Very high"]]},blGr:function(t,n){return[[-1,"#dddddd"],[t,"#000000","Very low"],[n,"#00ff00","Very high"]]},blBluCyWt:function(t,n){return[[-1,"#dddddd","Missing"],[t,"#000000","Very low"],[Ho(t,n,.5),"#0000ff","Expected"],[Ho(t,n,.75),"#00ffff"],[n,"#ffffff","Very high"]]},rdYlGr:function(t,n){return[[-1,"#dddddd","Missing"],[t,"#fd5533","Very low"],[Ho(t,n,.5),"#f8f611","Normal"],[n,"#4eb87b","Very high"]]},"*mgYlGr":function(t,n){return[[-1,"#dddddd","Missing"],[t,"#F15C8E","Very low"],[Ho(t,n,.5),"#f8f611","Normal"],[n,"#4eb87b","Very high"]]},grYlRd:function(t,n){return[[-1,"#dddddd","Missing"],[t,"#00ff33","Very low biodiversity"],[Ho(t,n,.5),"#ffff33","Normal biodiversity"],[n,"#ff3300","Very high biodiversity"]]},"*census":function(t,n){return[[-1,"#dddddd","Missing"],[t,"#efd100","Very low biodiversity"],[Ho(t,n,.5),"#4eb87b","Normal biodiversity"],[n,"#007fc4","Very high biodiversity"]]},seqseq:function(t,n){return[[-1,"#dddddd","Missing"],[t,"#de4fa6","Very low biodiversity"],[Ho(t,n,.5),"#4fadd0","Normal biodiversity"],[n,"#2a1a8a","Very high biodiversity"]]},"*parula":function(t,n){return[[-1,"#dddddd"],[t,"#352a87","Very low"],[Ho(t,n,.167),"#0469df"],[Ho(t,n,.33),"#06a0cb"],[Ho(t,n,.5),"#1fb2ac","Expected"],[Ho(t,n,.667),"#a3bd6a"],[Ho(t,n,.833),"#fcc336"],[n,"#f8f611","Very high"]]},"*parula_flip":function(t,n){return[[-1,"#dddddd"],[t,"#f8f611","Very low"],[Ho(t,n,.167),"#fcc336"],[Ho(t,n,.33),"#a3bd6a"],[Ho(t,n,.5),"#1fb2ac","Expected"],[Ho(t,n,.667),"#06a0cb"],[Ho(t,n,.833),"#0469df"],[n,"#352a87","Very high"]]}};function p_(){return{100:"#e9f6fc",200:"#b9e4f7",300:"#89d1f0",400:"#59bee9",500:"#29abe2",600:"#2186af",700:"#175f7c",800:"#0d3849",900:"#031116"}}var Jf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Rv(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function c(){return this instanceof c?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(c){var g=Object.getOwnPropertyDescriptor(e,c);Object.defineProperty(n,c,g.get?g:{enumerable:!0,get:function(){return e[c]}})}),n}var g3={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.1.0/LICENSE.txt
 */(function(e,t){(function(n,c){e.exports=c()})(Jf,function(){var n={},c={};function g(S,a,U){if(c[S]=U,S==="index"){var W="var sharedModule = {}; ("+c.shared+")(sharedModule); ("+c.worker+")(sharedModule);",he={};return c.shared(he),c.index(n,he),typeof window<"u"&&n.setWorkerUrl(window.URL.createObjectURL(new Blob([W],{type:"text/javascript"}))),n}}g("shared",["exports"],function(S){function a(m,h,b,M){return new(b||(b=Promise))(function(q,K){function J(Ne){try{Ce(M.next(Ne))}catch(f){K(f)}}function me(Ne){try{Ce(M.throw(Ne))}catch(f){K(f)}}function Ce(Ne){var f;Ne.done?q(Ne.value):(f=Ne.value,f instanceof b?f:new b(function(u){u(f)})).then(J,me)}Ce((M=M.apply(m,h||[])).next())})}function U(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}typeof SuppressedError=="function"&&SuppressedError;var W=he;function he(m,h){this.x=m,this.y=h}he.prototype={clone:function(){return new he(this.x,this.y)},add:function(m){return this.clone()._add(m)},sub:function(m){return this.clone()._sub(m)},multByPoint:function(m){return this.clone()._multByPoint(m)},divByPoint:function(m){return this.clone()._divByPoint(m)},mult:function(m){return this.clone()._mult(m)},div:function(m){return this.clone()._div(m)},rotate:function(m){return this.clone()._rotate(m)},rotateAround:function(m,h){return this.clone()._rotateAround(m,h)},matMult:function(m){return this.clone()._matMult(m)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(m){return this.x===m.x&&this.y===m.y},dist:function(m){return Math.sqrt(this.distSqr(m))},distSqr:function(m){var h=m.x-this.x,b=m.y-this.y;return h*h+b*b},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(m){return Math.atan2(this.y-m.y,this.x-m.x)},angleWith:function(m){return this.angleWithSep(m.x,m.y)},angleWithSep:function(m,h){return Math.atan2(this.x*h-this.y*m,this.x*m+this.y*h)},_matMult:function(m){var h=m[2]*this.x+m[3]*this.y;return this.x=m[0]*this.x+m[1]*this.y,this.y=h,this},_add:function(m){return this.x+=m.x,this.y+=m.y,this},_sub:function(m){return this.x-=m.x,this.y-=m.y,this},_mult:function(m){return this.x*=m,this.y*=m,this},_div:function(m){return this.x/=m,this.y/=m,this},_multByPoint:function(m){return this.x*=m.x,this.y*=m.y,this},_divByPoint:function(m){return this.x/=m.x,this.y/=m.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var m=this.y;return this.y=this.x,this.x=-m,this},_rotate:function(m){var h=Math.cos(m),b=Math.sin(m),M=b*this.x+h*this.y;return this.x=h*this.x-b*this.y,this.y=M,this},_rotateAround:function(m,h){var b=Math.cos(m),M=Math.sin(m),q=h.y+M*(this.x-h.x)+b*(this.y-h.y);return this.x=h.x+b*(this.x-h.x)-M*(this.y-h.y),this.y=q,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},he.convert=function(m){return m instanceof he?m:Array.isArray(m)?new he(m[0],m[1]):m};var ae=U(W),ce=be;function be(m,h,b,M){this.cx=3*m,this.bx=3*(b-m)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(M-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=m,this.p1y=h,this.p2x=b,this.p2y=M}be.prototype={sampleCurveX:function(m){return((this.ax*m+this.bx)*m+this.cx)*m},sampleCurveY:function(m){return((this.ay*m+this.by)*m+this.cy)*m},sampleCurveDerivativeX:function(m){return(3*this.ax*m+2*this.bx)*m+this.cx},solveCurveX:function(m,h){if(h===void 0&&(h=1e-6),m<0)return 0;if(m>1)return 1;for(var b=m,M=0;M<8;M++){var q=this.sampleCurveX(b)-m;if(Math.abs(q)<h)return b;var K=this.sampleCurveDerivativeX(b);if(Math.abs(K)<1e-6)break;b-=q/K}var J=0,me=1;for(b=m,M=0;M<20&&(q=this.sampleCurveX(b),!(Math.abs(q-m)<h));M++)m>q?J=b:me=b,b=.5*(me-J)+J;return b},solve:function(m,h){return this.sampleCurveY(this.solveCurveX(m,h))}};var Je=U(ce);let st,Ye;function it(){return st==null&&(st=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),st}function ct(){if(Ye==null&&(Ye=!1,it())){const h=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(h){for(let M=0;M<5*5;M++){const q=4*M;h.fillStyle=`rgb(${q},${q+1},${q+2})`,h.fillRect(M%5,Math.floor(M/5),1,1)}const b=h.getImageData(0,0,5,5).data;for(let M=0;M<5*5*4;M++)if(M%4!=3&&b[M]!==M){Ye=!0;break}}}return Ye||!1}function Tt(m,h,b,M){const q=new Je(m,h,b,M);return function(K){return q.solve(K)}}const zt=Tt(.25,.1,.25,1);function Rt(m,h,b){return Math.min(b,Math.max(h,m))}function Oe(m,h,b){const M=b-h,q=((m-h)%M+M)%M+h;return q===h?b:q}function jt(m,...h){for(const b of h)for(const M in b)m[M]=b[M];return m}let at=1;function _t(m,h,b){const M={};for(const q in m)M[q]=h.call(b||this,m[q],q,m);return M}function mt(m,h,b){const M={};for(const q in m)h.call(b||this,m[q],q,m)&&(M[q]=m[q]);return M}function xt(m){return Array.isArray(m)?m.map(xt):typeof m=="object"&&m?_t(m,xt):m}const bt={};function lt(m){bt[m]||(typeof console<"u"&&console.warn(m),bt[m]=!0)}function $e(m,h,b){return(b.y-m.y)*(h.x-m.x)>(h.y-m.y)*(b.x-m.x)}function pt(m){let h=0;for(let b,M,q=0,K=m.length,J=K-1;q<K;J=q++)b=m[q],M=m[J],h+=(M.x-b.x)*(b.y+M.y);return h}function ut(m){return typeof WorkerGlobalScope<"u"&&m!==void 0&&m instanceof WorkerGlobalScope}let Nt=null;function Bt(m){return typeof ImageBitmap<"u"&&m instanceof ImageBitmap}const Ot="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function gi(m,h,b,M,q){return a(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const K=new VideoFrame(m,{timestamp:0});try{const J=K==null?void 0:K.format;if(!J||!J.startsWith("BGR")&&!J.startsWith("RGB"))throw new Error(`Unrecognized format ${J}`);const me=J.startsWith("BGR"),Ce=new Uint8ClampedArray(M*q*4);if(yield K.copyTo(Ce,function(Ne,f,u,p,I){const L=4*Math.max(-f,0),G=(Math.max(0,u)-u)*p*4+L,Q=4*p,re=Math.max(0,f),Ae=Math.max(0,u);return{rect:{x:re,y:Ae,width:Math.min(Ne.width,f+p)-re,height:Math.min(Ne.height,u+I)-Ae},layout:[{offset:G,stride:Q}]}}(m,h,b,M,q)),me)for(let Ne=0;Ne<Ce.length;Ne+=4){const f=Ce[Ne];Ce[Ne]=Ce[Ne+2],Ce[Ne+2]=f}return Ce}finally{K.close()}})}let Ii,Ci;const Ri="AbortError";function Ki(){return new Error(Ri)}const Hi={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Ni(m){return Hi.REGISTERED_PROTOCOLS[m.substring(0,m.indexOf("://"))]}const nn="global-dispatcher";class vn extends Error{constructor(h,b,M,q){super(`AJAXError: ${b} (${h}): ${M}`),this.status=h,this.statusText=b,this.url=M,this.body=q}}const Ei=()=>ut(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,mi=function(m,h){if(/:\/\//.test(m.url)&&!/^https?:|^file:/.test(m.url)){const M=Ni(m.url);if(M)return M(m,h);if(ut(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:m,targetMapId:nn},h)}if(!(/^file:/.test(b=m.url)||/^file:/.test(Ei())&&!/^\w+:/.test(b))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(M,q){return a(this,void 0,void 0,function*(){const K=new Request(M.url,{method:M.method||"GET",body:M.body,credentials:M.credentials,headers:M.headers,cache:M.cache,referrer:Ei(),signal:q.signal});M.type==="json"&&K.headers.set("Accept","application/json");const J=yield fetch(K);if(!J.ok){const Ne=yield J.blob();throw new vn(J.status,J.statusText,M.url,Ne)}const me=M.type==="arrayBuffer"||M.type==="image"?J.arrayBuffer():M.type==="json"?J.json():J.text(),Ce=yield me;if(q.signal.aborted)throw Ki();return{data:Ce,cacheControl:J.headers.get("Cache-Control"),expires:J.headers.get("Expires")}})}(m,h);if(ut(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:m,mustQueue:!0,targetMapId:nn},h)}var b;return function(M,q){return new Promise((K,J)=>{const me=new XMLHttpRequest;me.open(M.method||"GET",M.url,!0),M.type!=="arrayBuffer"&&M.type!=="image"||(me.responseType="arraybuffer");for(const Ce in M.headers)me.setRequestHeader(Ce,M.headers[Ce]);M.type==="json"&&(me.responseType="text",me.setRequestHeader("Accept","application/json")),me.withCredentials=M.credentials==="include",me.onerror=()=>{J(new Error(me.statusText))},me.onload=()=>{if(!q.signal.aborted)if((me.status>=200&&me.status<300||me.status===0)&&me.response!==null){let Ce=me.response;if(M.type==="json")try{Ce=JSON.parse(me.response)}catch(Ne){return void J(Ne)}K({data:Ce,cacheControl:me.getResponseHeader("Cache-Control"),expires:me.getResponseHeader("Expires")})}else{const Ce=new Blob([me.response],{type:me.getResponseHeader("Content-Type")});J(new vn(me.status,me.statusText,M.url,Ce))}},q.signal.addEventListener("abort",()=>{me.abort(),J(Ki())}),me.send(M.body)})}(m,h)};function zi(m){if(!m||m.indexOf("://")<=0||m.indexOf("data:image/")===0||m.indexOf("blob:")===0)return!0;const h=new URL(m),b=window.location;return h.protocol===b.protocol&&h.host===b.host}function Oi(m,h,b){b[m]&&b[m].indexOf(h)!==-1||(b[m]=b[m]||[],b[m].push(h))}function xn(m,h,b){if(b&&b[m]){const M=b[m].indexOf(h);M!==-1&&b[m].splice(M,1)}}class bn{constructor(h,b={}){jt(this,b),this.type=h}}class Yt extends bn{constructor(h,b={}){super("error",jt({error:h},b))}}class rn{on(h,b){return this._listeners=this._listeners||{},Oi(h,b,this._listeners),this}off(h,b){return xn(h,b,this._listeners),xn(h,b,this._oneTimeListeners),this}once(h,b){return b?(this._oneTimeListeners=this._oneTimeListeners||{},Oi(h,b,this._oneTimeListeners),this):new Promise(M=>this.once(h,M))}fire(h,b){typeof h=="string"&&(h=new bn(h,b||{}));const M=h.type;if(this.listens(M)){h.target=this;const q=this._listeners&&this._listeners[M]?this._listeners[M].slice():[];for(const me of q)me.call(this,h);const K=this._oneTimeListeners&&this._oneTimeListeners[M]?this._oneTimeListeners[M].slice():[];for(const me of K)xn(M,me,this._oneTimeListeners),me.call(this,h);const J=this._eventedParent;J&&(jt(h,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),J.fire(h))}else h instanceof Yt&&console.error(h.error);return this}listens(h){return this._listeners&&this._listeners[h]&&this._listeners[h].length>0||this._oneTimeListeners&&this._oneTimeListeners[h]&&this._oneTimeListeners[h].length>0||this._eventedParent&&this._eventedParent.listens(h)}setEventedParent(h,b){return this._eventedParent=h,this._eventedParentData=b,this}}var Xt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Ji=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function mr(m,h){const b={};for(const M in m)M!=="ref"&&(b[M]=m[M]);return Ji.forEach(M=>{M in h&&(b[M]=h[M])}),b}function ci(m,h){if(Array.isArray(m)){if(!Array.isArray(h)||m.length!==h.length)return!1;for(let b=0;b<m.length;b++)if(!ci(m[b],h[b]))return!1;return!0}if(typeof m=="object"&&m!==null&&h!==null){if(typeof h!="object"||Object.keys(m).length!==Object.keys(h).length)return!1;for(const b in m)if(!ci(m[b],h[b]))return!1;return!0}return m===h}function sn(m,h){m.push(h)}function lr(m,h,b){sn(b,{command:"addSource",args:[m,h[m]]})}function On(m,h,b){sn(h,{command:"removeSource",args:[m]}),b[m]=!0}function Gn(m,h,b,M){On(m,b,M),lr(m,h,b)}function pn(m,h,b){let M;for(M in m[b])if(Object.prototype.hasOwnProperty.call(m[b],M)&&M!=="data"&&!ci(m[b][M],h[b][M]))return!1;for(M in h[b])if(Object.prototype.hasOwnProperty.call(h[b],M)&&M!=="data"&&!ci(m[b][M],h[b][M]))return!1;return!0}function v(m,h,b,M,q,K){m=m||{},h=h||{};for(const J in m)Object.prototype.hasOwnProperty.call(m,J)&&(ci(m[J],h[J])||b.push({command:K,args:[M,J,h[J],q]}));for(const J in h)Object.prototype.hasOwnProperty.call(h,J)&&!Object.prototype.hasOwnProperty.call(m,J)&&(ci(m[J],h[J])||b.push({command:K,args:[M,J,h[J],q]}))}function k(m){return m.id}function V(m,h){return m[h.id]=h,m}class Y{constructor(h,b,M,q){this.message=(h?`${h}: `:"")+M,q&&(this.identifier=q),b!=null&&b.__line__&&(this.line=b.__line__)}}function te(m,...h){for(const b of h)for(const M in b)m[M]=b[M];return m}class fe extends Error{constructor(h,b){super(b),this.message=b,this.key=h}}class ve{constructor(h,b=[]){this.parent=h,this.bindings={};for(const[M,q]of b)this.bindings[M]=q}concat(h){return new ve(this,h)}get(h){if(this.bindings[h])return this.bindings[h];if(this.parent)return this.parent.get(h);throw new Error(`${h} not found in scope.`)}has(h){return!!this.bindings[h]||!!this.parent&&this.parent.has(h)}}const Ie={kind:"null"},Ee={kind:"number"},ze={kind:"string"},Qe={kind:"boolean"},He={kind:"color"},Ze={kind:"object"},Ue={kind:"value"},dt={kind:"collator"},rt={kind:"formatted"},Me={kind:"padding"},se={kind:"resolvedImage"},ne={kind:"variableAnchorOffsetCollection"};function $(m,h){return{kind:"array",itemType:m,N:h}}function ie(m){if(m.kind==="array"){const h=ie(m.itemType);return typeof m.N=="number"?`array<${h}, ${m.N}>`:m.itemType.kind==="value"?"array":`array<${h}>`}return m.kind}const de=[Ie,Ee,ze,Qe,He,rt,Ze,$(Ue),Me,se,ne];function ye(m,h){if(h.kind==="error")return null;if(m.kind==="array"){if(h.kind==="array"&&(h.N===0&&h.itemType.kind==="value"||!ye(m.itemType,h.itemType))&&(typeof m.N!="number"||m.N===h.N))return null}else{if(m.kind===h.kind)return null;if(m.kind==="value"){for(const b of de)if(!ye(b,h))return null}}return`Expected ${ie(m)} but found ${ie(h)} instead.`}function ge(m,h){return h.some(b=>b.kind===m.kind)}function Pe(m,h){return h.some(b=>b==="null"?m===null:b==="array"?Array.isArray(m):b==="object"?m&&!Array.isArray(m)&&typeof m=="object":b===typeof m)}function Fe(m,h){return m.kind==="array"&&h.kind==="array"?m.itemType.kind===h.itemType.kind&&typeof m.N=="number":m.kind===h.kind}const Ve=.96422,Xe=.82521,Ke=4/29,De=6/29,Ge=3*De*De,At=De*De*De,kt=Math.PI/180,o=180/Math.PI;function ke(m){return(m%=360)<0&&(m+=360),m}function oi([m,h,b,M]){let q,K;const J=Ai((.2225045*(m=fi(m))+.7168786*(h=fi(h))+.0606169*(b=fi(b)))/1);m===h&&h===b?q=K=J:(q=Ai((.4360747*m+.3850649*h+.1430804*b)/Ve),K=Ai((.0139322*m+.0971045*h+.7141733*b)/Xe));const me=116*J-16;return[me<0?0:me,500*(q-J),200*(J-K),M]}function fi(m){return m<=.04045?m/12.92:Math.pow((m+.055)/1.055,2.4)}function Ai(m){return m>At?Math.pow(m,1/3):m/Ge+Ke}function ti([m,h,b,M]){let q=(m+16)/116,K=isNaN(h)?q:q+h/500,J=isNaN(b)?q:q-b/200;return q=1*Bi(q),K=Ve*Bi(K),J=Xe*Bi(J),[li(3.1338561*K-1.6168667*q-.4906146*J),li(-.9787684*K+1.9161415*q+.033454*J),li(.0719453*K-.2289914*q+1.4052427*J),M]}function li(m){return(m=m<=.00304?12.92*m:1.055*Math.pow(m,1/2.4)-.055)<0?0:m>1?1:m}function Bi(m){return m>De?m*m*m:Ge*(m-Ke)}function vi(m){return parseInt(m.padEnd(2,m),16)/255}function bi(m,h){return Jt(h?m/100:m,0,1)}function Jt(m,h,b){return Math.min(Math.max(h,m),b)}function wn(m){return!m.some(Number.isNaN)}const ar={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class mn{constructor(h,b,M,q=1,K=!0){this.r=h,this.g=b,this.b=M,this.a=q,K||(this.r*=q,this.g*=q,this.b*=q,q||this.overwriteGetter("rgb",[h,b,M,q]))}static parse(h){if(h instanceof mn)return h;if(typeof h!="string")return;const b=function(M){if((M=M.toLowerCase().trim())==="transparent")return[0,0,0,0];const q=ar[M];if(q){const[J,me,Ce]=q;return[J/255,me/255,Ce/255,1]}if(M.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(M)){const J=M.length<6?1:2;let me=1;return[vi(M.slice(me,me+=J)),vi(M.slice(me,me+=J)),vi(M.slice(me,me+=J)),vi(M.slice(me,me+J)||"ff")]}if(M.startsWith("rgb")){const J=M.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(J){const[me,Ce,Ne,f,u,p,I,L,G,Q,re,Ae]=J,_e=[f||" ",I||" ",Q].join("");if(_e==="  "||_e==="  /"||_e===",,"||_e===",,,"){const Le=[Ne,p,G].join(""),qe=Le==="%%%"?100:Le===""?255:0;if(qe){const tt=[Jt(+Ce/qe,0,1),Jt(+u/qe,0,1),Jt(+L/qe,0,1),re?bi(+re,Ae):1];if(wn(tt))return tt}}return}}const K=M.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(K){const[J,me,Ce,Ne,f,u,p,I,L]=K,G=[Ce||" ",f||" ",p].join("");if(G==="  "||G==="  /"||G===",,"||G===",,,"){const Q=[+me,Jt(+Ne,0,100),Jt(+u,0,100),I?bi(+I,L):1];if(wn(Q))return function([re,Ae,_e,Le]){function qe(tt){const ft=(tt+re/30)%12,gt=Ae*Math.min(_e,1-_e);return _e-gt*Math.max(-1,Math.min(ft-3,9-ft,1))}return re=ke(re),Ae/=100,_e/=100,[qe(0),qe(8),qe(4),Le]}(Q)}}}(h);return b?new mn(...b,!1):void 0}get rgb(){const{r:h,g:b,b:M,a:q}=this,K=q||1/0;return this.overwriteGetter("rgb",[h/K,b/K,M/K,q])}get hcl(){return this.overwriteGetter("hcl",function(h){const[b,M,q,K]=oi(h),J=Math.sqrt(M*M+q*q);return[Math.round(1e4*J)?ke(Math.atan2(q,M)*o):NaN,J,b,K]}(this.rgb))}get lab(){return this.overwriteGetter("lab",oi(this.rgb))}overwriteGetter(h,b){return Object.defineProperty(this,h,{value:b}),b}toString(){const[h,b,M,q]=this.rgb;return`rgba(${[h,b,M].map(K=>Math.round(255*K)).join(",")},${q})`}}mn.black=new mn(0,0,0,1),mn.white=new mn(1,1,1,1),mn.transparent=new mn(0,0,0,0),mn.red=new mn(1,0,0,1);class Hn{constructor(h,b,M){this.sensitivity=h?b?"variant":"case":b?"accent":"base",this.locale=M,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(h,b){return this.collator.compare(h,b)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class jr{constructor(h,b,M,q,K){this.text=h,this.image=b,this.scale=M,this.fontStack=q,this.textColor=K}}class ji{constructor(h){this.sections=h}static fromString(h){return new ji([new jr(h,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(h=>h.text.length!==0||h.image&&h.image.name.length!==0)}static factory(h){return h instanceof ji?h:ji.fromString(h)}toString(){return this.sections.length===0?"":this.sections.map(h=>h.text).join("")}}class ur{constructor(h){this.values=h.slice()}static parse(h){if(h instanceof ur)return h;if(typeof h=="number")return new ur([h,h,h,h]);if(Array.isArray(h)&&!(h.length<1||h.length>4)){for(const b of h)if(typeof b!="number")return;switch(h.length){case 1:h=[h[0],h[0],h[0],h[0]];break;case 2:h=[h[0],h[1],h[0],h[1]];break;case 3:h=[h[0],h[1],h[2],h[1]]}return new ur(h)}}toString(){return JSON.stringify(this.values)}}const Vn=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Wt{constructor(h){this.values=h.slice()}static parse(h){if(h instanceof Wt)return h;if(Array.isArray(h)&&!(h.length<1)&&h.length%2==0){for(let b=0;b<h.length;b+=2){const M=h[b],q=h[b+1];if(typeof M!="string"||!Vn.has(M)||!Array.isArray(q)||q.length!==2||typeof q[0]!="number"||typeof q[1]!="number")return}return new Wt(h)}}toString(){return JSON.stringify(this.values)}}class Yi{constructor(h){this.name=h.name,this.available=h.available}toString(){return this.name}static fromString(h){return h?new Yi({name:h,available:!1}):null}}function Ut(m,h,b,M){return typeof m=="number"&&m>=0&&m<=255&&typeof h=="number"&&h>=0&&h<=255&&typeof b=="number"&&b>=0&&b<=255?M===void 0||typeof M=="number"&&M>=0&&M<=1?null:`Invalid rgba value [${[m,h,b,M].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof M=="number"?[m,h,b,M]:[m,h,b]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Tn(m){if(m===null||typeof m=="string"||typeof m=="boolean"||typeof m=="number"||m instanceof mn||m instanceof Hn||m instanceof ji||m instanceof ur||m instanceof Wt||m instanceof Yi)return!0;if(Array.isArray(m)){for(const h of m)if(!Tn(h))return!1;return!0}if(typeof m=="object"){for(const h in m)if(!Tn(m[h]))return!1;return!0}return!1}function cr(m){if(m===null)return Ie;if(typeof m=="string")return ze;if(typeof m=="boolean")return Qe;if(typeof m=="number")return Ee;if(m instanceof mn)return He;if(m instanceof Hn)return dt;if(m instanceof ji)return rt;if(m instanceof ur)return Me;if(m instanceof Wt)return ne;if(m instanceof Yi)return se;if(Array.isArray(m)){const h=m.length;let b;for(const M of m){const q=cr(M);if(b){if(b===q)continue;b=Ue;break}b=q}return $(b||Ue,h)}return Ze}function Vs(m){const h=typeof m;return m===null?"":h==="string"||h==="number"||h==="boolean"?String(m):m instanceof mn||m instanceof ji||m instanceof ur||m instanceof Wt||m instanceof Yi?m.toString():JSON.stringify(m)}class Ur{constructor(h,b){this.type=h,this.value=b}static parse(h,b){if(h.length!==2)return b.error(`'literal' expression requires exactly one argument, but found ${h.length-1} instead.`);if(!Tn(h[1]))return b.error("invalid value");const M=h[1];let q=cr(M);const K=b.expectedType;return q.kind!=="array"||q.N!==0||!K||K.kind!=="array"||typeof K.N=="number"&&K.N!==0||(q=K),new Ur(q,M)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Vt{constructor(h){this.name="ExpressionEvaluationError",this.message=h}toJSON(){return this.message}}const hr={string:ze,number:Ee,boolean:Qe,object:Ze};class Dt{constructor(h,b){this.type=h,this.args=b}static parse(h,b){if(h.length<2)return b.error("Expected at least one argument.");let M,q=1;const K=h[0];if(K==="array"){let me,Ce;if(h.length>2){const Ne=h[1];if(typeof Ne!="string"||!(Ne in hr)||Ne==="object")return b.error('The item type argument of "array" must be one of string, number, boolean',1);me=hr[Ne],q++}else me=Ue;if(h.length>3){if(h[2]!==null&&(typeof h[2]!="number"||h[2]<0||h[2]!==Math.floor(h[2])))return b.error('The length argument to "array" must be a positive integer literal',2);Ce=h[2],q++}M=$(me,Ce)}else{if(!hr[K])throw new Error(`Types doesn't contain name = ${K}`);M=hr[K]}const J=[];for(;q<h.length;q++){const me=b.parse(h[q],q,Ue);if(!me)return null;J.push(me)}return new Dt(M,J)}evaluate(h){for(let b=0;b<this.args.length;b++){const M=this.args[b].evaluate(h);if(!ye(this.type,cr(M)))return M;if(b===this.args.length-1)throw new Vt(`Expected value to be of type ${ie(this.type)}, but found ${ie(cr(M))} instead.`)}throw new Error}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}}const Fr={"to-boolean":Qe,"to-color":He,"to-number":Ee,"to-string":ze};class Us{constructor(h,b){this.type=h,this.args=b}static parse(h,b){if(h.length<2)return b.error("Expected at least one argument.");const M=h[0];if(!Fr[M])throw new Error(`Can't parse ${M} as it is not part of the known types`);if((M==="to-boolean"||M==="to-string")&&h.length!==2)return b.error("Expected one argument.");const q=Fr[M],K=[];for(let J=1;J<h.length;J++){const me=b.parse(h[J],J,Ue);if(!me)return null;K.push(me)}return new Us(q,K)}evaluate(h){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(h);case"color":{let b,M;for(const q of this.args){if(b=q.evaluate(h),M=null,b instanceof mn)return b;if(typeof b=="string"){const K=h.parseColor(b);if(K)return K}else if(Array.isArray(b)&&(M=b.length<3||b.length>4?`Invalid rbga value ${JSON.stringify(b)}: expected an array containing either three or four numeric values.`:Ut(b[0],b[1],b[2],b[3]),!M))return new mn(b[0]/255,b[1]/255,b[2]/255,b[3])}throw new Vt(M||`Could not parse color from value '${typeof b=="string"?b:JSON.stringify(b)}'`)}case"padding":{let b;for(const M of this.args){b=M.evaluate(h);const q=ur.parse(b);if(q)return q}throw new Vt(`Could not parse padding from value '${typeof b=="string"?b:JSON.stringify(b)}'`)}case"variableAnchorOffsetCollection":{let b;for(const M of this.args){b=M.evaluate(h);const q=Wt.parse(b);if(q)return q}throw new Vt(`Could not parse variableAnchorOffsetCollection from value '${typeof b=="string"?b:JSON.stringify(b)}'`)}case"number":{let b=null;for(const M of this.args){if(b=M.evaluate(h),b===null)return 0;const q=Number(b);if(!isNaN(q))return q}throw new Vt(`Could not convert ${JSON.stringify(b)} to number.`)}case"formatted":return ji.fromString(Vs(this.args[0].evaluate(h)));case"resolvedImage":return Yi.fromString(Vs(this.args[0].evaluate(h)));default:return Vs(this.args[0].evaluate(h))}}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}}const ca=["Unknown","Point","LineString","Polygon"];class Dr{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ca[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(h){let b=this._parseColorCache[h];return b||(b=this._parseColorCache[h]=mn.parse(h)),b}}class Ua{constructor(h,b,M=[],q,K=new ve,J=[]){this.registry=h,this.path=M,this.key=M.map(me=>`[${me}]`).join(""),this.scope=K,this.errors=J,this.expectedType=q,this._isConstant=b}parse(h,b,M,q,K={}){return b?this.concat(b,M,q)._parse(h,K):this._parse(h,K)}_parse(h,b){function M(q,K,J){return J==="assert"?new Dt(K,[q]):J==="coerce"?new Us(K,[q]):q}if(h!==null&&typeof h!="string"&&typeof h!="boolean"&&typeof h!="number"||(h=["literal",h]),Array.isArray(h)){if(h.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const q=h[0];if(typeof q!="string")return this.error(`Expression name must be a string, but found ${typeof q} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const K=this.registry[q];if(K){let J=K.parse(h,this);if(!J)return null;if(this.expectedType){const me=this.expectedType,Ce=J.type;if(me.kind!=="string"&&me.kind!=="number"&&me.kind!=="boolean"&&me.kind!=="object"&&me.kind!=="array"||Ce.kind!=="value")if(me.kind!=="color"&&me.kind!=="formatted"&&me.kind!=="resolvedImage"||Ce.kind!=="value"&&Ce.kind!=="string")if(me.kind!=="padding"||Ce.kind!=="value"&&Ce.kind!=="number"&&Ce.kind!=="array")if(me.kind!=="variableAnchorOffsetCollection"||Ce.kind!=="value"&&Ce.kind!=="array"){if(this.checkSubtype(me,Ce))return null}else J=M(J,me,b.typeAnnotation||"coerce");else J=M(J,me,b.typeAnnotation||"coerce");else J=M(J,me,b.typeAnnotation||"coerce");else J=M(J,me,b.typeAnnotation||"assert")}if(!(J instanceof Ur)&&J.type.kind!=="resolvedImage"&&this._isConstant(J)){const me=new Dr;try{J=new Ur(J.type,J.evaluate(me))}catch(Ce){return this.error(Ce.message),null}}return J}return this.error(`Unknown expression "${q}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(h===void 0?"'undefined' value invalid. Use null instead.":typeof h=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof h} instead.`)}concat(h,b,M){const q=typeof h=="number"?this.path.concat(h):this.path,K=M?this.scope.concat(M):this.scope;return new Ua(this.registry,this._isConstant,q,b||null,K,this.errors)}error(h,...b){const M=`${this.key}${b.map(q=>`[${q}]`).join("")}`;this.errors.push(new fe(M,h))}checkSubtype(h,b){const M=ye(h,b);return M&&this.error(M),M}}class Fo{constructor(h,b,M){this.type=dt,this.locale=M,this.caseSensitive=h,this.diacriticSensitive=b}static parse(h,b){if(h.length!==2)return b.error("Expected one argument.");const M=h[1];if(typeof M!="object"||Array.isArray(M))return b.error("Collator options argument must be an object.");const q=b.parse(M["case-sensitive"]!==void 0&&M["case-sensitive"],1,Qe);if(!q)return null;const K=b.parse(M["diacritic-sensitive"]!==void 0&&M["diacritic-sensitive"],1,Qe);if(!K)return null;let J=null;return M.locale&&(J=b.parse(M.locale,1,ze),!J)?null:new Fo(q,K,J)}evaluate(h){return new Hn(this.caseSensitive.evaluate(h),this.diacriticSensitive.evaluate(h),this.locale?this.locale.evaluate(h):null)}eachChild(h){h(this.caseSensitive),h(this.diacriticSensitive),this.locale&&h(this.locale)}outputDefined(){return!1}}const Ga=8192;function Xs(m,h){m[0]=Math.min(m[0],h[0]),m[1]=Math.min(m[1],h[1]),m[2]=Math.max(m[2],h[0]),m[3]=Math.max(m[3],h[1])}function Qn(m,h){return!(m[0]<=h[0]||m[2]>=h[2]||m[1]<=h[1]||m[3]>=h[3])}function aa(m,h){const b=(180+m[0])/360,M=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+m[1]*Math.PI/360)))/360,q=Math.pow(2,h.z);return[Math.round(b*q*Ga),Math.round(M*q*Ga)]}function hs(m,h,b){const M=m[0]-h[0],q=m[1]-h[1],K=m[0]-b[0],J=m[1]-b[1];return M*J-K*q==0&&M*K<=0&&q*J<=0}function qa(m,h){let b=!1;for(let J=0,me=h.length;J<me;J++){const Ce=h[J];for(let Ne=0,f=Ce.length;Ne<f-1;Ne++){if(hs(m,Ce[Ne],Ce[Ne+1]))return!1;(q=Ce[Ne])[1]>(M=m)[1]!=(K=Ce[Ne+1])[1]>M[1]&&M[0]<(K[0]-q[0])*(M[1]-q[1])/(K[1]-q[1])+q[0]&&(b=!b)}}var M,q,K;return b}function al(m,h){for(let b=0;b<h.length;b++)if(qa(m,h[b]))return!0;return!1}function ol(m,h,b,M){const q=M[0]-b[0],K=M[1]-b[1],J=(m[0]-b[0])*K-q*(m[1]-b[1]),me=(h[0]-b[0])*K-q*(h[1]-b[1]);return J>0&&me<0||J<0&&me>0}function no(m,h,b){for(const Ne of b)for(let f=0;f<Ne.length-1;++f)if((me=[(J=Ne[f+1])[0]-(K=Ne[f])[0],J[1]-K[1]])[0]*(Ce=[(q=h)[0]-(M=m)[0],q[1]-M[1]])[1]-me[1]*Ce[0]!=0&&ol(M,q,K,J)&&ol(K,J,M,q))return!0;var M,q,K,J,me,Ce;return!1}function Ha(m,h){for(let b=0;b<m.length;++b)if(!qa(m[b],h))return!1;for(let b=0;b<m.length-1;++b)if(no(m[b],m[b+1],h))return!1;return!0}function N(m,h){for(let b=0;b<h.length;b++)if(Ha(m,h[b]))return!0;return!1}function xe(m,h,b){const M=[];for(let q=0;q<m.length;q++){const K=[];for(let J=0;J<m[q].length;J++){const me=aa(m[q][J],b);Xs(h,me),K.push(me)}M.push(K)}return M}function nt(m,h,b){const M=[];for(let q=0;q<m.length;q++){const K=xe(m[q],h,b);M.push(K)}return M}function It(m,h,b,M){if(m[0]<b[0]||m[0]>b[2]){const q=.5*M;let K=m[0]-b[0]>q?-M:b[0]-m[0]>q?M:0;K===0&&(K=m[0]-b[2]>q?-M:b[2]-m[0]>q?M:0),m[0]+=K}Xs(h,m)}function $t(m,h,b,M){const q=Math.pow(2,M.z)*Ga,K=[M.x*Ga,M.y*Ga],J=[];for(const me of m)for(const Ce of me){const Ne=[Ce.x+K[0],Ce.y+K[1]];It(Ne,h,b,q),J.push(Ne)}return J}function wi(m,h,b,M){const q=Math.pow(2,M.z)*Ga,K=[M.x*Ga,M.y*Ga],J=[];for(const Ce of m){const Ne=[];for(const f of Ce){const u=[f.x+K[0],f.y+K[1]];Xs(h,u),Ne.push(u)}J.push(Ne)}if(h[2]-h[0]<=q/2){(me=h)[0]=me[1]=1/0,me[2]=me[3]=-1/0;for(const Ce of J)for(const Ne of Ce)It(Ne,h,b,q)}var me;return J}class Di{constructor(h,b){this.type=Qe,this.geojson=h,this.geometries=b}static parse(h,b){if(h.length!==2)return b.error(`'within' expression requires exactly one argument, but found ${h.length-1} instead.`);if(Tn(h[1])){const M=h[1];if(M.type==="FeatureCollection"){const q=[];for(const K of M.features){const{type:J,coordinates:me}=K.geometry;J==="Polygon"&&q.push(me),J==="MultiPolygon"&&q.push(...me)}if(q.length)return new Di(M,{type:"MultiPolygon",coordinates:q})}else if(M.type==="Feature"){const q=M.geometry.type;if(q==="Polygon"||q==="MultiPolygon")return new Di(M,M.geometry)}else if(M.type==="Polygon"||M.type==="MultiPolygon")return new Di(M,M)}return b.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(h){if(h.geometry()!=null&&h.canonicalID()!=null){if(h.geometryType()==="Point")return function(b,M){const q=[1/0,1/0,-1/0,-1/0],K=[1/0,1/0,-1/0,-1/0],J=b.canonicalID();if(M.type==="Polygon"){const me=xe(M.coordinates,K,J),Ce=$t(b.geometry(),q,K,J);if(!Qn(q,K))return!1;for(const Ne of Ce)if(!qa(Ne,me))return!1}if(M.type==="MultiPolygon"){const me=nt(M.coordinates,K,J),Ce=$t(b.geometry(),q,K,J);if(!Qn(q,K))return!1;for(const Ne of Ce)if(!al(Ne,me))return!1}return!0}(h,this.geometries);if(h.geometryType()==="LineString")return function(b,M){const q=[1/0,1/0,-1/0,-1/0],K=[1/0,1/0,-1/0,-1/0],J=b.canonicalID();if(M.type==="Polygon"){const me=xe(M.coordinates,K,J),Ce=wi(b.geometry(),q,K,J);if(!Qn(q,K))return!1;for(const Ne of Ce)if(!Ha(Ne,me))return!1}if(M.type==="MultiPolygon"){const me=nt(M.coordinates,K,J),Ce=wi(b.geometry(),q,K,J);if(!Qn(q,K))return!1;for(const Ne of Ce)if(!N(Ne,me))return!1}return!0}(h,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class hn{constructor(h,b){this.type=b.type,this.name=h,this.boundExpression=b}static parse(h,b){if(h.length!==2||typeof h[1]!="string")return b.error("'var' expression requires exactly one string literal argument.");const M=h[1];return b.scope.has(M)?new hn(M,b.scope.get(M)):b.error(`Unknown variable "${M}". Make sure "${M}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(h){return this.boundExpression.evaluate(h)}eachChild(){}outputDefined(){return!1}}class dn{constructor(h,b,M,q){this.name=h,this.type=b,this._evaluate=M,this.args=q}evaluate(h){return this._evaluate(h,this.args)}eachChild(h){this.args.forEach(h)}outputDefined(){return!1}static parse(h,b){const M=h[0],q=dn.definitions[M];if(!q)return b.error(`Unknown expression "${M}". If you wanted a literal array, use ["literal", [...]].`,0);const K=Array.isArray(q)?q[0]:q.type,J=Array.isArray(q)?[[q[1],q[2]]]:q.overloads,me=J.filter(([Ne])=>!Array.isArray(Ne)||Ne.length===h.length-1);let Ce=null;for(const[Ne,f]of me){Ce=new Ua(b.registry,rr,b.path,null,b.scope);const u=[];let p=!1;for(let I=1;I<h.length;I++){const L=h[I],G=Array.isArray(Ne)?Ne[I-1]:Ne.type,Q=Ce.parse(L,1+u.length,G);if(!Q){p=!0;break}u.push(Q)}if(!p)if(Array.isArray(Ne)&&Ne.length!==u.length)Ce.error(`Expected ${Ne.length} arguments, but found ${u.length} instead.`);else{for(let I=0;I<u.length;I++){const L=Array.isArray(Ne)?Ne[I]:Ne.type,G=u[I];Ce.concat(I+1).checkSubtype(L,G.type)}if(Ce.errors.length===0)return new dn(M,K,f,u)}}if(me.length===1)b.errors.push(...Ce.errors);else{const Ne=(me.length?me:J).map(([u])=>{return p=u,Array.isArray(p)?`(${p.map(ie).join(", ")})`:`(${ie(p.type)}...)`;var p}).join(" | "),f=[];for(let u=1;u<h.length;u++){const p=b.parse(h[u],1+f.length);if(!p)return null;f.push(ie(p.type))}b.error(`Expected arguments of type ${Ne}, but found (${f.join(", ")}) instead.`)}return null}static register(h,b){dn.definitions=b;for(const M in b)h[M]=dn}}function rr(m){if(m instanceof hn)return rr(m.boundExpression);if(m instanceof dn&&m.name==="error"||m instanceof Fo||m instanceof Di)return!1;const h=m instanceof Us||m instanceof Dt;let b=!0;return m.eachChild(M=>{b=h?b&&rr(M):b&&M instanceof Ur}),!!b&&Ar(m)&&ja(m,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ar(m){if(m instanceof dn&&(m.name==="get"&&m.args.length===1||m.name==="feature-state"||m.name==="has"&&m.args.length===1||m.name==="properties"||m.name==="geometry-type"||m.name==="id"||/^filter-/.test(m.name))||m instanceof Di)return!1;let h=!0;return m.eachChild(b=>{h&&!Ar(b)&&(h=!1)}),h}function Or(m){if(m instanceof dn&&m.name==="feature-state")return!1;let h=!0;return m.eachChild(b=>{h&&!Or(b)&&(h=!1)}),h}function ja(m,h){if(m instanceof dn&&h.indexOf(m.name)>=0)return!1;let b=!0;return m.eachChild(M=>{b&&!ja(M,h)&&(b=!1)}),b}function Za(m,h){const b=m.length-1;let M,q,K=0,J=b,me=0;for(;K<=J;)if(me=Math.floor((K+J)/2),M=m[me],q=m[me+1],M<=h){if(me===b||h<q)return me;K=me+1}else{if(!(M>h))throw new Vt("Input is not a number.");J=me-1}return 0}class Qa{constructor(h,b,M){this.type=h,this.input=b,this.labels=[],this.outputs=[];for(const[q,K]of M)this.labels.push(q),this.outputs.push(K)}static parse(h,b){if(h.length-1<4)return b.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if((h.length-1)%2!=0)return b.error("Expected an even number of arguments.");const M=b.parse(h[1],1,Ee);if(!M)return null;const q=[];let K=null;b.expectedType&&b.expectedType.kind!=="value"&&(K=b.expectedType);for(let J=1;J<h.length;J+=2){const me=J===1?-1/0:h[J],Ce=h[J+1],Ne=J,f=J+1;if(typeof me!="number")return b.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Ne);if(q.length&&q[q.length-1][0]>=me)return b.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Ne);const u=b.parse(Ce,f,K);if(!u)return null;K=K||u.type,q.push([me,u])}return new Qa(K,M,q)}evaluate(h){const b=this.labels,M=this.outputs;if(b.length===1)return M[0].evaluate(h);const q=this.input.evaluate(h);if(q<=b[0])return M[0].evaluate(h);const K=b.length;return q>=b[K-1]?M[K-1].evaluate(h):M[Za(b,q)].evaluate(h)}eachChild(h){h(this.input);for(const b of this.outputs)h(b)}outputDefined(){return this.outputs.every(h=>h.outputDefined())}}function pl(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}var Gr=ir;function ir(m,h,b,M){this.cx=3*m,this.bx=3*(b-m)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(M-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=m,this.p1y=h,this.p2x=b,this.p2y=M}ir.prototype={sampleCurveX:function(m){return((this.ax*m+this.bx)*m+this.cx)*m},sampleCurveY:function(m){return((this.ay*m+this.by)*m+this.cy)*m},sampleCurveDerivativeX:function(m){return(3*this.ax*m+2*this.bx)*m+this.cx},solveCurveX:function(m,h){if(h===void 0&&(h=1e-6),m<0)return 0;if(m>1)return 1;for(var b=m,M=0;M<8;M++){var q=this.sampleCurveX(b)-m;if(Math.abs(q)<h)return b;var K=this.sampleCurveDerivativeX(b);if(Math.abs(K)<1e-6)break;b-=q/K}var J=0,me=1;for(b=m,M=0;M<20&&(q=this.sampleCurveX(b),!(Math.abs(q-m)<h));M++)m>q?J=b:me=b,b=.5*(me-J)+J;return b},solve:function(m,h){return this.sampleCurveY(this.solveCurveX(m,h))}};var Er=pl(Gr);function Lr(m,h,b){return m+b*(h-m)}function Zs(m,h,b){return m.map((M,q)=>Lr(M,h[q],b))}const xr={number:Lr,color:function(m,h,b,M="rgb"){switch(M){case"rgb":{const[q,K,J,me]=Zs(m.rgb,h.rgb,b);return new mn(q,K,J,me,!1)}case"hcl":{const[q,K,J,me]=m.hcl,[Ce,Ne,f,u]=h.hcl;let p,I;if(isNaN(q)||isNaN(Ce))isNaN(q)?isNaN(Ce)?p=NaN:(p=Ce,J!==1&&J!==0||(I=Ne)):(p=q,f!==1&&f!==0||(I=K));else{let Ae=Ce-q;Ce>q&&Ae>180?Ae-=360:Ce<q&&q-Ce>180&&(Ae+=360),p=q+b*Ae}const[L,G,Q,re]=function([Ae,_e,Le,qe]){return Ae=isNaN(Ae)?0:Ae*kt,ti([Le,Math.cos(Ae)*_e,Math.sin(Ae)*_e,qe])}([p,I??Lr(K,Ne,b),Lr(J,f,b),Lr(me,u,b)]);return new mn(L,G,Q,re,!1)}case"lab":{const[q,K,J,me]=ti(Zs(m.lab,h.lab,b));return new mn(q,K,J,me,!1)}}},array:Zs,padding:function(m,h,b){return new ur(Zs(m.values,h.values,b))},variableAnchorOffsetCollection:function(m,h,b){const M=m.values,q=h.values;if(M.length!==q.length)throw new Vt(`Cannot interpolate values of different length. from: ${m.toString()}, to: ${h.toString()}`);const K=[];for(let J=0;J<M.length;J+=2){if(M[J]!==q[J])throw new Vt(`Cannot interpolate values containing mismatched anchors. from[${J}]: ${M[J]}, to[${J}]: ${q[J]}`);K.push(M[J]);const[me,Ce]=M[J+1],[Ne,f]=q[J+1];K.push([Lr(me,Ne,b),Lr(Ce,f,b)])}return new Wt(K)}};class Ks{constructor(h,b,M,q,K){this.type=h,this.operator=b,this.interpolation=M,this.input=q,this.labels=[],this.outputs=[];for(const[J,me]of K)this.labels.push(J),this.outputs.push(me)}static interpolationFactor(h,b,M,q){let K=0;if(h.name==="exponential")K=Br(b,h.base,M,q);else if(h.name==="linear")K=Br(b,1,M,q);else if(h.name==="cubic-bezier"){const J=h.controlPoints;K=new Er(J[0],J[1],J[2],J[3]).solve(Br(b,1,M,q))}return K}static parse(h,b){let[M,q,K,...J]=h;if(!Array.isArray(q)||q.length===0)return b.error("Expected an interpolation type expression.",1);if(q[0]==="linear")q={name:"linear"};else if(q[0]==="exponential"){const Ne=q[1];if(typeof Ne!="number")return b.error("Exponential interpolation requires a numeric base.",1,1);q={name:"exponential",base:Ne}}else{if(q[0]!=="cubic-bezier")return b.error(`Unknown interpolation type ${String(q[0])}`,1,0);{const Ne=q.slice(1);if(Ne.length!==4||Ne.some(f=>typeof f!="number"||f<0||f>1))return b.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);q={name:"cubic-bezier",controlPoints:Ne}}}if(h.length-1<4)return b.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if((h.length-1)%2!=0)return b.error("Expected an even number of arguments.");if(K=b.parse(K,2,Ee),!K)return null;const me=[];let Ce=null;M==="interpolate-hcl"||M==="interpolate-lab"?Ce=He:b.expectedType&&b.expectedType.kind!=="value"&&(Ce=b.expectedType);for(let Ne=0;Ne<J.length;Ne+=2){const f=J[Ne],u=J[Ne+1],p=Ne+3,I=Ne+4;if(typeof f!="number")return b.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(me.length&&me[me.length-1][0]>=f)return b.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',p);const L=b.parse(u,I,Ce);if(!L)return null;Ce=Ce||L.type,me.push([f,L])}return Fe(Ce,Ee)||Fe(Ce,He)||Fe(Ce,Me)||Fe(Ce,ne)||Fe(Ce,$(Ee))?new Ks(Ce,M,q,K,me):b.error(`Type ${ie(Ce)} is not interpolatable.`)}evaluate(h){const b=this.labels,M=this.outputs;if(b.length===1)return M[0].evaluate(h);const q=this.input.evaluate(h);if(q<=b[0])return M[0].evaluate(h);const K=b.length;if(q>=b[K-1])return M[K-1].evaluate(h);const J=Za(b,q),me=Ks.interpolationFactor(this.interpolation,q,b[J],b[J+1]),Ce=M[J].evaluate(h),Ne=M[J+1].evaluate(h);switch(this.operator){case"interpolate":return xr[this.type.kind](Ce,Ne,me);case"interpolate-hcl":return xr.color(Ce,Ne,me,"hcl");case"interpolate-lab":return xr.color(Ce,Ne,me,"lab")}}eachChild(h){h(this.input);for(const b of this.outputs)h(b)}outputDefined(){return this.outputs.every(h=>h.outputDefined())}}function Br(m,h,b,M){const q=M-b,K=m-b;return q===0?0:h===1?K/q:(Math.pow(h,K)-1)/(Math.pow(h,q)-1)}class To{constructor(h,b){this.type=h,this.args=b}static parse(h,b){if(h.length<2)return b.error("Expectected at least one argument.");let M=null;const q=b.expectedType;q&&q.kind!=="value"&&(M=q);const K=[];for(const me of h.slice(1)){const Ce=b.parse(me,1+K.length,M,void 0,{typeAnnotation:"omit"});if(!Ce)return null;M=M||Ce.type,K.push(Ce)}if(!M)throw new Error("No output type");const J=q&&K.some(me=>ye(q,me.type));return new To(J?Ue:M,K)}evaluate(h){let b,M=null,q=0;for(const K of this.args)if(q++,M=K.evaluate(h),M&&M instanceof Yi&&!M.available&&(b||(b=M.name),M=null,q===this.args.length&&(M=b)),M!==null)break;return M}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}}class Zo{constructor(h,b){this.type=b.type,this.bindings=[].concat(h),this.result=b}evaluate(h){return this.result.evaluate(h)}eachChild(h){for(const b of this.bindings)h(b[1]);h(this.result)}static parse(h,b){if(h.length<4)return b.error(`Expected at least 3 arguments, but found ${h.length-1} instead.`);const M=[];for(let K=1;K<h.length-1;K+=2){const J=h[K];if(typeof J!="string")return b.error(`Expected string, but found ${typeof J} instead.`,K);if(/[^a-zA-Z0-9_]/.test(J))return b.error("Variable names must contain only alphanumeric characters or '_'.",K);const me=b.parse(h[K+1],K+1);if(!me)return null;M.push([J,me])}const q=b.parse(h[h.length-1],h.length-1,b.expectedType,M);return q?new Zo(M,q):null}outputDefined(){return this.result.outputDefined()}}class Bs{constructor(h,b,M){this.type=h,this.index=b,this.input=M}static parse(h,b){if(h.length!==3)return b.error(`Expected 2 arguments, but found ${h.length-1} instead.`);const M=b.parse(h[1],1,Ee),q=b.parse(h[2],2,$(b.expectedType||Ue));return M&&q?new Bs(q.type.itemType,M,q):null}evaluate(h){const b=this.index.evaluate(h),M=this.input.evaluate(h);if(b<0)throw new Vt(`Array index out of bounds: ${b} < 0.`);if(b>=M.length)throw new Vt(`Array index out of bounds: ${b} > ${M.length-1}.`);if(b!==Math.floor(b))throw new Vt(`Array index must be an integer, but found ${b} instead.`);return M[b]}eachChild(h){h(this.index),h(this.input)}outputDefined(){return!1}}class Il{constructor(h,b){this.type=Qe,this.needle=h,this.haystack=b}static parse(h,b){if(h.length!==3)return b.error(`Expected 2 arguments, but found ${h.length-1} instead.`);const M=b.parse(h[1],1,Ue),q=b.parse(h[2],2,Ue);return M&&q?ge(M.type,[Qe,ze,Ee,Ie,Ue])?new Il(M,q):b.error(`Expected first argument to be of type boolean, string, number or null, but found ${ie(M.type)} instead`):null}evaluate(h){const b=this.needle.evaluate(h),M=this.haystack.evaluate(h);if(!M)return!1;if(!Pe(b,["boolean","string","number","null"]))throw new Vt(`Expected first argument to be of type boolean, string, number or null, but found ${ie(cr(b))} instead.`);if(!Pe(M,["string","array"]))throw new Vt(`Expected second argument to be of type array or string, but found ${ie(cr(M))} instead.`);return M.indexOf(b)>=0}eachChild(h){h(this.needle),h(this.haystack)}outputDefined(){return!0}}class mo{constructor(h,b,M){this.type=Ee,this.needle=h,this.haystack=b,this.fromIndex=M}static parse(h,b){if(h.length<=2||h.length>=5)return b.error(`Expected 3 or 4 arguments, but found ${h.length-1} instead.`);const M=b.parse(h[1],1,Ue),q=b.parse(h[2],2,Ue);if(!M||!q)return null;if(!ge(M.type,[Qe,ze,Ee,Ie,Ue]))return b.error(`Expected first argument to be of type boolean, string, number or null, but found ${ie(M.type)} instead`);if(h.length===4){const K=b.parse(h[3],3,Ee);return K?new mo(M,q,K):null}return new mo(M,q)}evaluate(h){const b=this.needle.evaluate(h),M=this.haystack.evaluate(h);if(!Pe(b,["boolean","string","number","null"]))throw new Vt(`Expected first argument to be of type boolean, string, number or null, but found ${ie(cr(b))} instead.`);if(!Pe(M,["string","array"]))throw new Vt(`Expected second argument to be of type array or string, but found ${ie(cr(M))} instead.`);if(this.fromIndex){const q=this.fromIndex.evaluate(h);return M.indexOf(b,q)}return M.indexOf(b)}eachChild(h){h(this.needle),h(this.haystack),this.fromIndex&&h(this.fromIndex)}outputDefined(){return!1}}class Qo{constructor(h,b,M,q,K,J){this.inputType=h,this.type=b,this.input=M,this.cases=q,this.outputs=K,this.otherwise=J}static parse(h,b){if(h.length<5)return b.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if(h.length%2!=1)return b.error("Expected an even number of arguments.");let M,q;b.expectedType&&b.expectedType.kind!=="value"&&(q=b.expectedType);const K={},J=[];for(let Ne=2;Ne<h.length-1;Ne+=2){let f=h[Ne];const u=h[Ne+1];Array.isArray(f)||(f=[f]);const p=b.concat(Ne);if(f.length===0)return p.error("Expected at least one branch label.");for(const L of f){if(typeof L!="number"&&typeof L!="string")return p.error("Branch labels must be numbers or strings.");if(typeof L=="number"&&Math.abs(L)>Number.MAX_SAFE_INTEGER)return p.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof L=="number"&&Math.floor(L)!==L)return p.error("Numeric branch labels must be integer values.");if(M){if(p.checkSubtype(M,cr(L)))return null}else M=cr(L);if(K[String(L)]!==void 0)return p.error("Branch labels must be unique.");K[String(L)]=J.length}const I=b.parse(u,Ne,q);if(!I)return null;q=q||I.type,J.push(I)}const me=b.parse(h[1],1,Ue);if(!me)return null;const Ce=b.parse(h[h.length-1],h.length-1,q);return Ce?me.type.kind!=="value"&&b.concat(1).checkSubtype(M,me.type)?null:new Qo(M,q,me,K,J,Ce):null}evaluate(h){const b=this.input.evaluate(h);return(cr(b)===this.inputType&&this.outputs[this.cases[b]]||this.otherwise).evaluate(h)}eachChild(h){h(this.input),this.outputs.forEach(h),h(this.otherwise)}outputDefined(){return this.outputs.every(h=>h.outputDefined())&&this.otherwise.outputDefined()}}class ha{constructor(h,b,M){this.type=h,this.branches=b,this.otherwise=M}static parse(h,b){if(h.length<4)return b.error(`Expected at least 3 arguments, but found only ${h.length-1}.`);if(h.length%2!=0)return b.error("Expected an odd number of arguments.");let M;b.expectedType&&b.expectedType.kind!=="value"&&(M=b.expectedType);const q=[];for(let J=1;J<h.length-1;J+=2){const me=b.parse(h[J],J,Qe);if(!me)return null;const Ce=b.parse(h[J+1],J+1,M);if(!Ce)return null;q.push([me,Ce]),M=M||Ce.type}const K=b.parse(h[h.length-1],h.length-1,M);if(!K)return null;if(!M)throw new Error("Can't infer output type");return new ha(M,q,K)}evaluate(h){for(const[b,M]of this.branches)if(b.evaluate(h))return M.evaluate(h);return this.otherwise.evaluate(h)}eachChild(h){for(const[b,M]of this.branches)h(b),h(M);h(this.otherwise)}outputDefined(){return this.branches.every(([h,b])=>b.outputDefined())&&this.otherwise.outputDefined()}}class Ys{constructor(h,b,M,q){this.type=h,this.input=b,this.beginIndex=M,this.endIndex=q}static parse(h,b){if(h.length<=2||h.length>=5)return b.error(`Expected 3 or 4 arguments, but found ${h.length-1} instead.`);const M=b.parse(h[1],1,Ue),q=b.parse(h[2],2,Ee);if(!M||!q)return null;if(!ge(M.type,[$(Ue),ze,Ue]))return b.error(`Expected first argument to be of type array or string, but found ${ie(M.type)} instead`);if(h.length===4){const K=b.parse(h[3],3,Ee);return K?new Ys(M.type,M,q,K):null}return new Ys(M.type,M,q)}evaluate(h){const b=this.input.evaluate(h),M=this.beginIndex.evaluate(h);if(!Pe(b,["string","array"]))throw new Vt(`Expected first argument to be of type array or string, but found ${ie(cr(b))} instead.`);if(this.endIndex){const q=this.endIndex.evaluate(h);return b.slice(M,q)}return b.slice(M)}eachChild(h){h(this.input),h(this.beginIndex),this.endIndex&&h(this.endIndex)}outputDefined(){return!1}}function El(m,h){return m==="=="||m==="!="?h.kind==="boolean"||h.kind==="string"||h.kind==="number"||h.kind==="null"||h.kind==="value":h.kind==="string"||h.kind==="number"||h.kind==="value"}function Wa(m,h,b,M){return M.compare(h,b)===0}function Ma(m,h,b){const M=m!=="=="&&m!=="!=";return class _3{constructor(K,J,me){this.type=Qe,this.lhs=K,this.rhs=J,this.collator=me,this.hasUntypedArgument=K.type.kind==="value"||J.type.kind==="value"}static parse(K,J){if(K.length!==3&&K.length!==4)return J.error("Expected two or three arguments.");const me=K[0];let Ce=J.parse(K[1],1,Ue);if(!Ce)return null;if(!El(me,Ce.type))return J.concat(1).error(`"${me}" comparisons are not supported for type '${ie(Ce.type)}'.`);let Ne=J.parse(K[2],2,Ue);if(!Ne)return null;if(!El(me,Ne.type))return J.concat(2).error(`"${me}" comparisons are not supported for type '${ie(Ne.type)}'.`);if(Ce.type.kind!==Ne.type.kind&&Ce.type.kind!=="value"&&Ne.type.kind!=="value")return J.error(`Cannot compare types '${ie(Ce.type)}' and '${ie(Ne.type)}'.`);M&&(Ce.type.kind==="value"&&Ne.type.kind!=="value"?Ce=new Dt(Ne.type,[Ce]):Ce.type.kind!=="value"&&Ne.type.kind==="value"&&(Ne=new Dt(Ce.type,[Ne])));let f=null;if(K.length===4){if(Ce.type.kind!=="string"&&Ne.type.kind!=="string"&&Ce.type.kind!=="value"&&Ne.type.kind!=="value")return J.error("Cannot use collator to compare non-string types.");if(f=J.parse(K[3],3,dt),!f)return null}return new _3(Ce,Ne,f)}evaluate(K){const J=this.lhs.evaluate(K),me=this.rhs.evaluate(K);if(M&&this.hasUntypedArgument){const Ce=cr(J),Ne=cr(me);if(Ce.kind!==Ne.kind||Ce.kind!=="string"&&Ce.kind!=="number")throw new Vt(`Expected arguments for "${m}" to be (string, string) or (number, number), but found (${Ce.kind}, ${Ne.kind}) instead.`)}if(this.collator&&!M&&this.hasUntypedArgument){const Ce=cr(J),Ne=cr(me);if(Ce.kind!=="string"||Ne.kind!=="string")return h(K,J,me)}return this.collator?b(K,J,me,this.collator.evaluate(K)):h(K,J,me)}eachChild(K){K(this.lhs),K(this.rhs),this.collator&&K(this.collator)}outputDefined(){return!0}}}const ml=Ma("==",function(m,h,b){return h===b},Wa),Cl=Ma("!=",function(m,h,b){return h!==b},function(m,h,b,M){return!Wa(0,h,b,M)}),mu=Ma("<",function(m,h,b){return h<b},function(m,h,b,M){return M.compare(h,b)<0}),As=Ma(">",function(m,h,b){return h>b},function(m,h,b,M){return M.compare(h,b)>0}),ac=Ma("<=",function(m,h,b){return h<=b},function(m,h,b,M){return M.compare(h,b)<=0}),ro=Ma(">=",function(m,h,b){return h>=b},function(m,h,b,M){return M.compare(h,b)>=0});class so{constructor(h,b,M,q,K){this.type=ze,this.number=h,this.locale=b,this.currency=M,this.minFractionDigits=q,this.maxFractionDigits=K}static parse(h,b){if(h.length!==3)return b.error("Expected two arguments.");const M=b.parse(h[1],1,Ee);if(!M)return null;const q=h[2];if(typeof q!="object"||Array.isArray(q))return b.error("NumberFormat options argument must be an object.");let K=null;if(q.locale&&(K=b.parse(q.locale,1,ze),!K))return null;let J=null;if(q.currency&&(J=b.parse(q.currency,1,ze),!J))return null;let me=null;if(q["min-fraction-digits"]&&(me=b.parse(q["min-fraction-digits"],1,Ee),!me))return null;let Ce=null;return q["max-fraction-digits"]&&(Ce=b.parse(q["max-fraction-digits"],1,Ee),!Ce)?null:new so(M,K,J,me,Ce)}evaluate(h){return new Intl.NumberFormat(this.locale?this.locale.evaluate(h):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(h):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(h):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(h):void 0}).format(this.number.evaluate(h))}eachChild(h){h(this.number),this.locale&&h(this.locale),this.currency&&h(this.currency),this.minFractionDigits&&h(this.minFractionDigits),this.maxFractionDigits&&h(this.maxFractionDigits)}outputDefined(){return!1}}class Wl{constructor(h){this.type=rt,this.sections=h}static parse(h,b){if(h.length<2)return b.error("Expected at least one argument.");const M=h[1];if(!Array.isArray(M)&&typeof M=="object")return b.error("First argument must be an image or text section.");const q=[];let K=!1;for(let J=1;J<=h.length-1;++J){const me=h[J];if(K&&typeof me=="object"&&!Array.isArray(me)){K=!1;let Ce=null;if(me["font-scale"]&&(Ce=b.parse(me["font-scale"],1,Ee),!Ce))return null;let Ne=null;if(me["text-font"]&&(Ne=b.parse(me["text-font"],1,$(ze)),!Ne))return null;let f=null;if(me["text-color"]&&(f=b.parse(me["text-color"],1,He),!f))return null;const u=q[q.length-1];u.scale=Ce,u.font=Ne,u.textColor=f}else{const Ce=b.parse(h[J],1,Ue);if(!Ce)return null;const Ne=Ce.type.kind;if(Ne!=="string"&&Ne!=="value"&&Ne!=="null"&&Ne!=="resolvedImage")return b.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");K=!0,q.push({content:Ce,scale:null,font:null,textColor:null})}}return new Wl(q)}evaluate(h){return new ji(this.sections.map(b=>{const M=b.content.evaluate(h);return cr(M)===se?new jr("",M,null,null,null):new jr(Vs(M),null,b.scale?b.scale.evaluate(h):null,b.font?b.font.evaluate(h).join(","):null,b.textColor?b.textColor.evaluate(h):null)}))}eachChild(h){for(const b of this.sections)h(b.content),b.scale&&h(b.scale),b.font&&h(b.font),b.textColor&&h(b.textColor)}outputDefined(){return!1}}class Oo{constructor(h){this.type=se,this.input=h}static parse(h,b){if(h.length!==2)return b.error("Expected two arguments.");const M=b.parse(h[1],1,ze);return M?new Oo(M):b.error("No image name provided.")}evaluate(h){const b=this.input.evaluate(h),M=Yi.fromString(b);return M&&h.availableImages&&(M.available=h.availableImages.indexOf(b)>-1),M}eachChild(h){h(this.input)}outputDefined(){return!1}}class Wo{constructor(h){this.type=Ee,this.input=h}static parse(h,b){if(h.length!==2)return b.error(`Expected 1 argument, but found ${h.length-1} instead.`);const M=b.parse(h[1],1);return M?M.type.kind!=="array"&&M.type.kind!=="string"&&M.type.kind!=="value"?b.error(`Expected argument of type string or array, but found ${ie(M.type)} instead.`):new Wo(M):null}evaluate(h){const b=this.input.evaluate(h);if(typeof b=="string"||Array.isArray(b))return b.length;throw new Vt(`Expected value to be of type string or array, but found ${ie(cr(b))} instead.`)}eachChild(h){h(this.input)}outputDefined(){return!1}}const ko={"==":ml,"!=":Cl,">":As,"<":mu,">=":ro,"<=":ac,array:Dt,at:Bs,boolean:Dt,case:ha,coalesce:To,collator:Fo,format:Wl,image:Oo,in:Il,"index-of":mo,interpolate:Ks,"interpolate-hcl":Ks,"interpolate-lab":Ks,length:Wo,let:Zo,literal:Ur,match:Qo,number:Dt,"number-format":so,object:Dt,slice:Ys,step:Qa,string:Dt,"to-boolean":Us,"to-color":Us,"to-number":Us,"to-string":Us,var:hn,within:Di};function Gs(m,[h,b,M,q]){h=h.evaluate(m),b=b.evaluate(m),M=M.evaluate(m);const K=q?q.evaluate(m):1,J=Ut(h,b,M,K);if(J)throw new Vt(J);return new mn(h/255,b/255,M/255,K,!1)}function $o(m,h){return m in h}function Xo(m,h){const b=h[m];return b===void 0?null:b}function Yo(m){return{type:m}}function Sa(m){return{result:"success",value:m}}function $a(m){return{result:"error",value:m}}function ks(m){return m["property-type"]==="data-driven"||m["property-type"]==="cross-faded-data-driven"}function gu(m){return!!m.expression&&m.expression.parameters.indexOf("zoom")>-1}function Cr(m){return!!m.expression&&m.expression.interpolated}function $n(m){return m instanceof Number?"number":m instanceof String?"string":m instanceof Boolean?"boolean":Array.isArray(m)?"array":m===null?"null":typeof m}function Ko(m){return typeof m=="object"&&m!==null&&!Array.isArray(m)}function zr(m){return m}function Xa(m,h){const b=h.type==="color",M=m.stops&&typeof m.stops[0][0]=="object",q=M||!(M||m.property!==void 0),K=m.type||(Cr(h)?"exponential":"interval");if(b||h.type==="padding"){const f=b?mn.parse:ur.parse;(m=te({},m)).stops&&(m.stops=m.stops.map(u=>[u[0],f(u[1])])),m.default=f(m.default?m.default:h.default)}if(m.colorSpace&&(J=m.colorSpace)!=="rgb"&&J!=="hcl"&&J!=="lab")throw new Error(`Unknown color space: "${m.colorSpace}"`);var J;let me,Ce,Ne;if(K==="exponential")me=qn;else if(K==="interval")me=Mo;else if(K==="categorical"){me=fr,Ce=Object.create(null);for(const f of m.stops)Ce[f[0]]=f[1];Ne=typeof m.stops[0][0]}else{if(K!=="identity")throw new Error(`Unknown function type "${K}"`);me=Ol}if(M){const f={},u=[];for(let L=0;L<m.stops.length;L++){const G=m.stops[L],Q=G[0].zoom;f[Q]===void 0&&(f[Q]={zoom:Q,type:m.type,property:m.property,default:m.default,stops:[]},u.push(Q)),f[Q].stops.push([G[0].value,G[1]])}const p=[];for(const L of u)p.push([f[L].zoom,Xa(f[L],h)]);const I={name:"linear"};return{kind:"composite",interpolationType:I,interpolationFactor:Ks.interpolationFactor.bind(void 0,I),zoomStops:p.map(L=>L[0]),evaluate:({zoom:L},G)=>qn({stops:p,base:m.base},h,L).evaluate(L,G)}}if(q){const f=K==="exponential"?{name:"exponential",base:m.base!==void 0?m.base:1}:null;return{kind:"camera",interpolationType:f,interpolationFactor:Ks.interpolationFactor.bind(void 0,f),zoomStops:m.stops.map(u=>u[0]),evaluate:({zoom:u})=>me(m,h,u,Ce,Ne)}}return{kind:"source",evaluate(f,u){const p=u&&u.properties?u.properties[m.property]:void 0;return p===void 0?is(m.default,h.default):me(m,h,p,Ce,Ne)}}}function is(m,h,b){return m!==void 0?m:h!==void 0?h:b!==void 0?b:void 0}function fr(m,h,b,M,q){return is(typeof b===q?M[b]:void 0,m.default,h.default)}function Mo(m,h,b){if($n(b)!=="number")return is(m.default,h.default);const M=m.stops.length;if(M===1||b<=m.stops[0][0])return m.stops[0][1];if(b>=m.stops[M-1][0])return m.stops[M-1][1];const q=Za(m.stops.map(K=>K[0]),b);return m.stops[q][1]}function qn(m,h,b){const M=m.base!==void 0?m.base:1;if($n(b)!=="number")return is(m.default,h.default);const q=m.stops.length;if(q===1||b<=m.stops[0][0])return m.stops[0][1];if(b>=m.stops[q-1][0])return m.stops[q-1][1];const K=Za(m.stops.map(f=>f[0]),b),J=function(f,u,p,I){const L=I-p,G=f-p;return L===0?0:u===1?G/L:(Math.pow(u,G)-1)/(Math.pow(u,L)-1)}(b,M,m.stops[K][0],m.stops[K+1][0]),me=m.stops[K][1],Ce=m.stops[K+1][1],Ne=xr[h.type]||zr;return typeof me.evaluate=="function"?{evaluate(...f){const u=me.evaluate.apply(void 0,f),p=Ce.evaluate.apply(void 0,f);if(u!==void 0&&p!==void 0)return Ne(u,p,J,m.colorSpace)}}:Ne(me,Ce,J,m.colorSpace)}function Ol(m,h,b){switch(h.type){case"color":b=mn.parse(b);break;case"formatted":b=ji.fromString(b.toString());break;case"resolvedImage":b=Yi.fromString(b.toString());break;case"padding":b=ur.parse(b);break;default:$n(b)===h.type||h.type==="enum"&&h.values[b]||(b=void 0)}return is(b,m.default,h.default)}dn.register(ko,{error:[{kind:"error"},[ze],(m,[h])=>{throw new Vt(h.evaluate(m))}],typeof:[ze,[Ue],(m,[h])=>ie(cr(h.evaluate(m)))],"to-rgba":[$(Ee,4),[He],(m,[h])=>{const[b,M,q,K]=h.evaluate(m).rgb;return[255*b,255*M,255*q,K]}],rgb:[He,[Ee,Ee,Ee],Gs],rgba:[He,[Ee,Ee,Ee,Ee],Gs],has:{type:Qe,overloads:[[[ze],(m,[h])=>$o(h.evaluate(m),m.properties())],[[ze,Ze],(m,[h,b])=>$o(h.evaluate(m),b.evaluate(m))]]},get:{type:Ue,overloads:[[[ze],(m,[h])=>Xo(h.evaluate(m),m.properties())],[[ze,Ze],(m,[h,b])=>Xo(h.evaluate(m),b.evaluate(m))]]},"feature-state":[Ue,[ze],(m,[h])=>Xo(h.evaluate(m),m.featureState||{})],properties:[Ze,[],m=>m.properties()],"geometry-type":[ze,[],m=>m.geometryType()],id:[Ue,[],m=>m.id()],zoom:[Ee,[],m=>m.globals.zoom],"heatmap-density":[Ee,[],m=>m.globals.heatmapDensity||0],"line-progress":[Ee,[],m=>m.globals.lineProgress||0],accumulated:[Ue,[],m=>m.globals.accumulated===void 0?null:m.globals.accumulated],"+":[Ee,Yo(Ee),(m,h)=>{let b=0;for(const M of h)b+=M.evaluate(m);return b}],"*":[Ee,Yo(Ee),(m,h)=>{let b=1;for(const M of h)b*=M.evaluate(m);return b}],"-":{type:Ee,overloads:[[[Ee,Ee],(m,[h,b])=>h.evaluate(m)-b.evaluate(m)],[[Ee],(m,[h])=>-h.evaluate(m)]]},"/":[Ee,[Ee,Ee],(m,[h,b])=>h.evaluate(m)/b.evaluate(m)],"%":[Ee,[Ee,Ee],(m,[h,b])=>h.evaluate(m)%b.evaluate(m)],ln2:[Ee,[],()=>Math.LN2],pi:[Ee,[],()=>Math.PI],e:[Ee,[],()=>Math.E],"^":[Ee,[Ee,Ee],(m,[h,b])=>Math.pow(h.evaluate(m),b.evaluate(m))],sqrt:[Ee,[Ee],(m,[h])=>Math.sqrt(h.evaluate(m))],log10:[Ee,[Ee],(m,[h])=>Math.log(h.evaluate(m))/Math.LN10],ln:[Ee,[Ee],(m,[h])=>Math.log(h.evaluate(m))],log2:[Ee,[Ee],(m,[h])=>Math.log(h.evaluate(m))/Math.LN2],sin:[Ee,[Ee],(m,[h])=>Math.sin(h.evaluate(m))],cos:[Ee,[Ee],(m,[h])=>Math.cos(h.evaluate(m))],tan:[Ee,[Ee],(m,[h])=>Math.tan(h.evaluate(m))],asin:[Ee,[Ee],(m,[h])=>Math.asin(h.evaluate(m))],acos:[Ee,[Ee],(m,[h])=>Math.acos(h.evaluate(m))],atan:[Ee,[Ee],(m,[h])=>Math.atan(h.evaluate(m))],min:[Ee,Yo(Ee),(m,h)=>Math.min(...h.map(b=>b.evaluate(m)))],max:[Ee,Yo(Ee),(m,h)=>Math.max(...h.map(b=>b.evaluate(m)))],abs:[Ee,[Ee],(m,[h])=>Math.abs(h.evaluate(m))],round:[Ee,[Ee],(m,[h])=>{const b=h.evaluate(m);return b<0?-Math.round(-b):Math.round(b)}],floor:[Ee,[Ee],(m,[h])=>Math.floor(h.evaluate(m))],ceil:[Ee,[Ee],(m,[h])=>Math.ceil(h.evaluate(m))],"filter-==":[Qe,[ze,Ue],(m,[h,b])=>m.properties()[h.value]===b.value],"filter-id-==":[Qe,[Ue],(m,[h])=>m.id()===h.value],"filter-type-==":[Qe,[ze],(m,[h])=>m.geometryType()===h.value],"filter-<":[Qe,[ze,Ue],(m,[h,b])=>{const M=m.properties()[h.value],q=b.value;return typeof M==typeof q&&M<q}],"filter-id-<":[Qe,[Ue],(m,[h])=>{const b=m.id(),M=h.value;return typeof b==typeof M&&b<M}],"filter->":[Qe,[ze,Ue],(m,[h,b])=>{const M=m.properties()[h.value],q=b.value;return typeof M==typeof q&&M>q}],"filter-id->":[Qe,[Ue],(m,[h])=>{const b=m.id(),M=h.value;return typeof b==typeof M&&b>M}],"filter-<=":[Qe,[ze,Ue],(m,[h,b])=>{const M=m.properties()[h.value],q=b.value;return typeof M==typeof q&&M<=q}],"filter-id-<=":[Qe,[Ue],(m,[h])=>{const b=m.id(),M=h.value;return typeof b==typeof M&&b<=M}],"filter->=":[Qe,[ze,Ue],(m,[h,b])=>{const M=m.properties()[h.value],q=b.value;return typeof M==typeof q&&M>=q}],"filter-id->=":[Qe,[Ue],(m,[h])=>{const b=m.id(),M=h.value;return typeof b==typeof M&&b>=M}],"filter-has":[Qe,[Ue],(m,[h])=>h.value in m.properties()],"filter-has-id":[Qe,[],m=>m.id()!==null&&m.id()!==void 0],"filter-type-in":[Qe,[$(ze)],(m,[h])=>h.value.indexOf(m.geometryType())>=0],"filter-id-in":[Qe,[$(Ue)],(m,[h])=>h.value.indexOf(m.id())>=0],"filter-in-small":[Qe,[ze,$(Ue)],(m,[h,b])=>b.value.indexOf(m.properties()[h.value])>=0],"filter-in-large":[Qe,[ze,$(Ue)],(m,[h,b])=>function(M,q,K,J){for(;K<=J;){const me=K+J>>1;if(q[me]===M)return!0;q[me]>M?J=me-1:K=me+1}return!1}(m.properties()[h.value],b.value,0,b.value.length-1)],all:{type:Qe,overloads:[[[Qe,Qe],(m,[h,b])=>h.evaluate(m)&&b.evaluate(m)],[Yo(Qe),(m,h)=>{for(const b of h)if(!b.evaluate(m))return!1;return!0}]]},any:{type:Qe,overloads:[[[Qe,Qe],(m,[h,b])=>h.evaluate(m)||b.evaluate(m)],[Yo(Qe),(m,h)=>{for(const b of h)if(b.evaluate(m))return!0;return!1}]]},"!":[Qe,[Qe],(m,[h])=>!h.evaluate(m)],"is-supported-script":[Qe,[ze],(m,[h])=>{const b=m.globals&&m.globals.isSupportedScript;return!b||b(h.evaluate(m))}],upcase:[ze,[ze],(m,[h])=>h.evaluate(m).toUpperCase()],downcase:[ze,[ze],(m,[h])=>h.evaluate(m).toLowerCase()],concat:[ze,Yo(Ue),(m,h)=>h.map(b=>Vs(b.evaluate(m))).join("")],"resolved-locale":[ze,[dt],(m,[h])=>h.evaluate(m).resolvedLocale()]});class ns{constructor(h,b){var M;this.expression=h,this._warningHistory={},this._evaluator=new Dr,this._defaultValue=b?(M=b).type==="color"&&Ko(M.default)?new mn(0,0,0,0):M.type==="color"?mn.parse(M.default)||null:M.type==="padding"?ur.parse(M.default)||null:M.type==="variableAnchorOffsetCollection"?Wt.parse(M.default)||null:M.default===void 0?null:M.default:null,this._enumValues=b&&b.type==="enum"?b.values:null}evaluateWithoutErrorHandling(h,b,M,q,K,J){return this._evaluator.globals=h,this._evaluator.feature=b,this._evaluator.featureState=M,this._evaluator.canonical=q,this._evaluator.availableImages=K||null,this._evaluator.formattedSection=J,this.expression.evaluate(this._evaluator)}evaluate(h,b,M,q,K,J){this._evaluator.globals=h,this._evaluator.feature=b||null,this._evaluator.featureState=M||null,this._evaluator.canonical=q,this._evaluator.availableImages=K||null,this._evaluator.formattedSection=J||null;try{const me=this.expression.evaluate(this._evaluator);if(me==null||typeof me=="number"&&me!=me)return this._defaultValue;if(this._enumValues&&!(me in this._enumValues))throw new Vt(`Expected value to be one of ${Object.keys(this._enumValues).map(Ce=>JSON.stringify(Ce)).join(", ")}, but found ${JSON.stringify(me)} instead.`);return me}catch(me){return this._warningHistory[me.message]||(this._warningHistory[me.message]=!0,typeof console<"u"&&console.warn(me.message)),this._defaultValue}}}function Zr(m){return Array.isArray(m)&&m.length>0&&typeof m[0]=="string"&&m[0]in ko}function Ms(m,h){const b=new Ua(ko,rr,[],h?function(q){const K={color:He,string:ze,number:Ee,enum:ze,boolean:Qe,formatted:rt,padding:Me,resolvedImage:se,variableAnchorOffsetCollection:ne};return q.type==="array"?$(K[q.value]||Ue,q.length):K[q.type]}(h):void 0),M=b.parse(m,void 0,void 0,void 0,h&&h.type==="string"?{typeAnnotation:"coerce"}:void 0);return M?Sa(new ns(M,h)):$a(b.errors)}class Mr{constructor(h,b){this.kind=h,this._styleExpression=b,this.isStateDependent=h!=="constant"&&!Or(b.expression)}evaluateWithoutErrorHandling(h,b,M,q,K,J){return this._styleExpression.evaluateWithoutErrorHandling(h,b,M,q,K,J)}evaluate(h,b,M,q,K,J){return this._styleExpression.evaluate(h,b,M,q,K,J)}}class nr{constructor(h,b,M,q){this.kind=h,this.zoomStops=M,this._styleExpression=b,this.isStateDependent=h!=="camera"&&!Or(b.expression),this.interpolationType=q}evaluateWithoutErrorHandling(h,b,M,q,K,J){return this._styleExpression.evaluateWithoutErrorHandling(h,b,M,q,K,J)}evaluate(h,b,M,q,K,J){return this._styleExpression.evaluate(h,b,M,q,K,J)}interpolationFactor(h,b,M){return this.interpolationType?Ks.interpolationFactor(this.interpolationType,h,b,M):0}}function ll(m,h){const b=Ms(m,h);if(b.result==="error")return b;const M=b.value.expression,q=Ar(M);if(!q&&!ks(h))return $a([new fe("","data expressions not supported")]);const K=ja(M,["zoom"]);if(!K&&!gu(h))return $a([new fe("","zoom expressions not supported")]);const J=Po(M);return J||K?J instanceof fe?$a([J]):J instanceof Ks&&!Cr(h)?$a([new fe("",'"interpolate" expressions cannot be used with this property')]):Sa(J?new nr(q?"camera":"composite",b.value,J.labels,J instanceof Ks?J.interpolation:void 0):new Mr(q?"constant":"source",b.value)):$a([new fe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Xr{constructor(h,b){this._parameters=h,this._specification=b,te(this,Xa(this._parameters,this._specification))}static deserialize(h){return new Xr(h._parameters,h._specification)}static serialize(h){return{_parameters:h._parameters,_specification:h._specification}}}function Po(m){let h=null;if(m instanceof Zo)h=Po(m.result);else if(m instanceof To){for(const b of m.args)if(h=Po(b),h)break}else(m instanceof Qa||m instanceof Ks)&&m.input instanceof dn&&m.input.name==="zoom"&&(h=m);return h instanceof fe||m.eachChild(b=>{const M=Po(b);M instanceof fe?h=M:!h&&M?h=new fe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):h&&M&&h!==M&&(h=new fe("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),h}function ul(m){if(m===!0||m===!1)return!0;if(!Array.isArray(m)||m.length===0)return!1;switch(m[0]){case"has":return m.length>=2&&m[1]!=="$id"&&m[1]!=="$type";case"in":return m.length>=3&&(typeof m[1]!="string"||Array.isArray(m[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return m.length!==3||Array.isArray(m[1])||Array.isArray(m[2]);case"any":case"all":for(const h of m.slice(1))if(!ul(h)&&typeof h!="boolean")return!1;return!0;default:return!0}}const Qr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ds(m){if(m==null)return{filter:()=>!0,needGeometry:!1};ul(m)||(m=Do(m));const h=Ms(m,Qr);if(h.result==="error")throw new Error(h.value.map(b=>`${b.key}: ${b.message}`).join(", "));return{filter:(b,M,q)=>h.value.evaluate(b,M,{},q),needGeometry:Tl(m)}}function Ia(m,h){return m<h?-1:m>h?1:0}function Tl(m){if(!Array.isArray(m))return!1;if(m[0]==="within")return!0;for(let h=1;h<m.length;h++)if(Tl(m[h]))return!0;return!1}function Do(m){if(!m)return!0;const h=m[0];return m.length<=1?h!=="any":h==="=="?kl(m[1],m[2],"=="):h==="!="?qs(kl(m[1],m[2],"==")):h==="<"||h===">"||h==="<="||h===">="?kl(m[1],m[2],h):h==="any"?(b=m.slice(1),["any"].concat(b.map(Do))):h==="all"?["all"].concat(m.slice(1).map(Do)):h==="none"?["all"].concat(m.slice(1).map(Do).map(qs)):h==="in"?go(m[1],m.slice(2)):h==="!in"?qs(go(m[1],m.slice(2))):h==="has"?Js(m[1]):h==="!has"?qs(Js(m[1])):h!=="within"||m;var b}function kl(m,h,b){switch(m){case"$type":return[`filter-type-${b}`,h];case"$id":return[`filter-id-${b}`,h];default:return[`filter-${b}`,m,h]}}function go(m,h){if(h.length===0)return!1;switch(m){case"$type":return["filter-type-in",["literal",h]];case"$id":return["filter-id-in",["literal",h]];default:return h.length>200&&!h.some(b=>typeof b!=typeof h[0])?["filter-in-large",m,["literal",h.sort(Ia)]]:["filter-in-small",m,["literal",h]]}}function Js(m){switch(m){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",m]}}function qs(m){return["!",m]}function Ya(m){const h=typeof m;if(h==="number"||h==="boolean"||h==="string"||m==null)return JSON.stringify(m);if(Array.isArray(m)){let q="[";for(const K of m)q+=`${Ya(K)},`;return`${q}]`}const b=Object.keys(m).sort();let M="{";for(let q=0;q<b.length;q++)M+=`${JSON.stringify(b[q])}:${Ya(m[b[q]])},`;return`${M}}`}function Jo(m){let h="";for(const b of Ji)h+=`/${Ya(m[b])}`;return h}function Yr(m){const h=m.value;return h?[new Y(m.key,h,"constants have been deprecated as of v8")]:[]}function gr(m){return m instanceof Number||m instanceof String||m instanceof Boolean?m.valueOf():m}function Nr(m){if(Array.isArray(m))return m.map(Nr);if(m instanceof Object&&!(m instanceof Number||m instanceof String||m instanceof Boolean)){const h={};for(const b in m)h[b]=Nr(m[b]);return h}return gr(m)}function Aa(m){const h=m.key,b=m.value,M=m.valueSpec||{},q=m.objectElementValidators||{},K=m.style,J=m.styleSpec,me=m.validateSpec;let Ce=[];const Ne=$n(b);if(Ne!=="object")return[new Y(h,b,`object expected, ${Ne} found`)];for(const f in b){const u=f.split(".")[0],p=M[u]||M["*"];let I;if(q[u])I=q[u];else if(M[u])I=me;else if(q["*"])I=q["*"];else{if(!M["*"]){Ce.push(new Y(h,b[f],`unknown property "${f}"`));continue}I=me}Ce=Ce.concat(I({key:(h&&`${h}.`)+f,value:b[f],valueSpec:p,style:K,styleSpec:J,object:b,objectKey:f,validateSpec:me},b))}for(const f in M)q[f]||M[f].required&&M[f].default===void 0&&b[f]===void 0&&Ce.push(new Y(h,b,`missing required property "${f}"`));return Ce}function _o(m){const h=m.value,b=m.valueSpec,M=m.style,q=m.styleSpec,K=m.key,J=m.arrayElementValidator||m.validateSpec;if($n(h)!=="array")return[new Y(K,h,`array expected, ${$n(h)} found`)];if(b.length&&h.length!==b.length)return[new Y(K,h,`array length ${b.length} expected, length ${h.length} found`)];if(b["min-length"]&&h.length<b["min-length"])return[new Y(K,h,`array length at least ${b["min-length"]} expected, length ${h.length} found`)];let me={type:b.value,values:b.values};q.$version<7&&(me.function=b.function),$n(b.value)==="object"&&(me=b.value);let Ce=[];for(let Ne=0;Ne<h.length;Ne++)Ce=Ce.concat(J({array:h,arrayIndex:Ne,value:h[Ne],valueSpec:me,validateSpec:m.validateSpec,style:M,styleSpec:q,key:`${K}[${Ne}]`}));return Ce}function ea(m){const h=m.key,b=m.value,M=m.valueSpec;let q=$n(b);return q==="number"&&b!=b&&(q="NaN"),q!=="number"?[new Y(h,b,`number expected, ${q} found`)]:"minimum"in M&&b<M.minimum?[new Y(h,b,`${b} is less than the minimum value ${M.minimum}`)]:"maximum"in M&&b>M.maximum?[new Y(h,b,`${b} is greater than the maximum value ${M.maximum}`)]:[]}function Ea(m){const h=m.valueSpec,b=gr(m.value.type);let M,q,K,J={};const me=b!=="categorical"&&m.value.property===void 0,Ce=!me,Ne=$n(m.value.stops)==="array"&&$n(m.value.stops[0])==="array"&&$n(m.value.stops[0][0])==="object",f=Aa({key:m.key,value:m.value,valueSpec:m.styleSpec.function,validateSpec:m.validateSpec,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{stops:function(I){if(b==="identity")return[new Y(I.key,I.value,'identity function may not have a "stops" property')];let L=[];const G=I.value;return L=L.concat(_o({key:I.key,value:G,valueSpec:I.valueSpec,validateSpec:I.validateSpec,style:I.style,styleSpec:I.styleSpec,arrayElementValidator:u})),$n(G)==="array"&&G.length===0&&L.push(new Y(I.key,G,"array must have at least one stop")),L},default:function(I){return I.validateSpec({key:I.key,value:I.value,valueSpec:h,validateSpec:I.validateSpec,style:I.style,styleSpec:I.styleSpec})}}});return b==="identity"&&me&&f.push(new Y(m.key,m.value,'missing required property "property"')),b==="identity"||m.value.stops||f.push(new Y(m.key,m.value,'missing required property "stops"')),b==="exponential"&&m.valueSpec.expression&&!Cr(m.valueSpec)&&f.push(new Y(m.key,m.value,"exponential functions not supported")),m.styleSpec.$version>=8&&(Ce&&!ks(m.valueSpec)?f.push(new Y(m.key,m.value,"property functions not supported")):me&&!gu(m.valueSpec)&&f.push(new Y(m.key,m.value,"zoom functions not supported"))),b!=="categorical"&&!Ne||m.value.property!==void 0||f.push(new Y(m.key,m.value,'"property" property is required')),f;function u(I){let L=[];const G=I.value,Q=I.key;if($n(G)!=="array")return[new Y(Q,G,`array expected, ${$n(G)} found`)];if(G.length!==2)return[new Y(Q,G,`array length 2 expected, length ${G.length} found`)];if(Ne){if($n(G[0])!=="object")return[new Y(Q,G,`object expected, ${$n(G[0])} found`)];if(G[0].zoom===void 0)return[new Y(Q,G,"object stop key must have zoom")];if(G[0].value===void 0)return[new Y(Q,G,"object stop key must have value")];if(K&&K>gr(G[0].zoom))return[new Y(Q,G[0].zoom,"stop zoom values must appear in ascending order")];gr(G[0].zoom)!==K&&(K=gr(G[0].zoom),q=void 0,J={}),L=L.concat(Aa({key:`${Q}[0]`,value:G[0],valueSpec:{zoom:{}},validateSpec:I.validateSpec,style:I.style,styleSpec:I.styleSpec,objectElementValidators:{zoom:ea,value:p}}))}else L=L.concat(p({key:`${Q}[0]`,value:G[0],valueSpec:{},validateSpec:I.validateSpec,style:I.style,styleSpec:I.styleSpec},G));return Zr(Nr(G[1]))?L.concat([new Y(`${Q}[1]`,G[1],"expressions are not allowed in function stops.")]):L.concat(I.validateSpec({key:`${Q}[1]`,value:G[1],valueSpec:h,validateSpec:I.validateSpec,style:I.style,styleSpec:I.styleSpec}))}function p(I,L){const G=$n(I.value),Q=gr(I.value),re=I.value!==null?I.value:L;if(M){if(G!==M)return[new Y(I.key,re,`${G} stop domain type must match previous stop domain type ${M}`)]}else M=G;if(G!=="number"&&G!=="string"&&G!=="boolean")return[new Y(I.key,re,"stop domain value must be a number, string, or boolean")];if(G!=="number"&&b!=="categorical"){let Ae=`number expected, ${G} found`;return ks(h)&&b===void 0&&(Ae+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Y(I.key,re,Ae)]}return b!=="categorical"||G!=="number"||isFinite(Q)&&Math.floor(Q)===Q?b!=="categorical"&&G==="number"&&q!==void 0&&Q<q?[new Y(I.key,re,"stop domain values must appear in ascending order")]:(q=Q,b==="categorical"&&Q in J?[new Y(I.key,re,"stop domain values must be unique")]:(J[Q]=!0,[])):[new Y(I.key,re,`integer expected, found ${Q}`)]}}function Pa(m){const h=(m.expressionContext==="property"?ll:Ms)(Nr(m.value),m.valueSpec);if(h.result==="error")return h.value.map(M=>new Y(`${m.key}${M.key}`,m.value,M.message));const b=h.value.expression||h.value._styleExpression.expression;if(m.expressionContext==="property"&&m.propertyKey==="text-font"&&!b.outputDefined())return[new Y(m.key,m.value,`Invalid data expression for "${m.propertyKey}". Output values must be contained as literals within the expression.`)];if(m.expressionContext==="property"&&m.propertyType==="layout"&&!Or(b))return[new Y(m.key,m.value,'"feature-state" data expressions are not supported with layout properties.')];if(m.expressionContext==="filter"&&!Or(b))return[new Y(m.key,m.value,'"feature-state" data expressions are not supported with filters.')];if(m.expressionContext&&m.expressionContext.indexOf("cluster")===0){if(!ja(b,["zoom","feature-state"]))return[new Y(m.key,m.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(m.expressionContext==="cluster-initial"&&!Ar(b))return[new Y(m.key,m.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ka(m){const h=m.key,b=m.value,M=m.valueSpec,q=[];return Array.isArray(M.values)?M.values.indexOf(gr(b))===-1&&q.push(new Y(h,b,`expected one of [${M.values.join(", ")}], ${JSON.stringify(b)} found`)):Object.keys(M.values).indexOf(gr(b))===-1&&q.push(new Y(h,b,`expected one of [${Object.keys(M.values).join(", ")}], ${JSON.stringify(b)} found`)),q}function cl(m){return ul(Nr(m.value))?Pa(te({},m,{expressionContext:"filter",valueSpec:{value:"boolean"}})):lu(m)}function lu(m){const h=m.value,b=m.key;if($n(h)!=="array")return[new Y(b,h,`array expected, ${$n(h)} found`)];const M=m.styleSpec;let q,K=[];if(h.length<1)return[new Y(b,h,"filter array must have at least 1 element")];switch(K=K.concat(Ka({key:`${b}[0]`,value:h[0],valueSpec:M.filter_operator,style:m.style,styleSpec:m.styleSpec})),gr(h[0])){case"<":case"<=":case">":case">=":h.length>=2&&gr(h[1])==="$type"&&K.push(new Y(b,h,`"$type" cannot be use with operator "${h[0]}"`));case"==":case"!=":h.length!==3&&K.push(new Y(b,h,`filter array for operator "${h[0]}" must have 3 elements`));case"in":case"!in":h.length>=2&&(q=$n(h[1]),q!=="string"&&K.push(new Y(`${b}[1]`,h[1],`string expected, ${q} found`)));for(let J=2;J<h.length;J++)q=$n(h[J]),gr(h[1])==="$type"?K=K.concat(Ka({key:`${b}[${J}]`,value:h[J],valueSpec:M.geometry_type,style:m.style,styleSpec:m.styleSpec})):q!=="string"&&q!=="number"&&q!=="boolean"&&K.push(new Y(`${b}[${J}]`,h[J],`string, number, or boolean expected, ${q} found`));break;case"any":case"all":case"none":for(let J=1;J<h.length;J++)K=K.concat(lu({key:`${b}[${J}]`,value:h[J],style:m.style,styleSpec:m.styleSpec}));break;case"has":case"!has":q=$n(h[1]),h.length!==2?K.push(new Y(b,h,`filter array for "${h[0]}" operator must have 2 elements`)):q!=="string"&&K.push(new Y(`${b}[1]`,h[1],`string expected, ${q} found`));break;case"within":q=$n(h[1]),h.length!==2?K.push(new Y(b,h,`filter array for "${h[0]}" operator must have 2 elements`)):q!=="object"&&K.push(new Y(`${b}[1]`,h[1],`object expected, ${q} found`))}return K}function gl(m,h){const b=m.key,M=m.validateSpec,q=m.style,K=m.styleSpec,J=m.value,me=m.objectKey,Ce=K[`${h}_${m.layerType}`];if(!Ce)return[];const Ne=me.match(/^(.*)-transition$/);if(h==="paint"&&Ne&&Ce[Ne[1]]&&Ce[Ne[1]].transition)return M({key:b,value:J,valueSpec:K.transition,style:q,styleSpec:K});const f=m.valueSpec||Ce[me];if(!f)return[new Y(b,J,`unknown property "${me}"`)];let u;if($n(J)==="string"&&ks(f)&&!f.tokens&&(u=/^{([^}]+)}$/.exec(J)))return[new Y(b,J,`"${me}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(u[1])} }\`.`)];const p=[];return m.layerType==="symbol"&&(me==="text-field"&&q&&!q.glyphs&&p.push(new Y(b,J,'use of "text-field" requires a style "glyphs" property')),me==="text-font"&&Ko(Nr(J))&&gr(J.type)==="identity"&&p.push(new Y(b,J,'"text-font" does not support identity functions'))),p.concat(M({key:m.key,value:J,valueSpec:f,style:q,styleSpec:K,expressionContext:"property",propertyType:h,propertyKey:me}))}function ao(m){return gl(m,"paint")}function pi(m){return gl(m,"layout")}function Vi(m){let h=[];const b=m.value,M=m.key,q=m.style,K=m.styleSpec;b.type||b.ref||h.push(new Y(M,b,'either "type" or "ref" is required'));let J=gr(b.type);const me=gr(b.ref);if(b.id){const Ce=gr(b.id);for(let Ne=0;Ne<m.arrayIndex;Ne++){const f=q.layers[Ne];gr(f.id)===Ce&&h.push(new Y(M,b.id,`duplicate layer id "${b.id}", previously used at line ${f.id.__line__}`))}}if("ref"in b){let Ce;["type","source","source-layer","filter","layout"].forEach(Ne=>{Ne in b&&h.push(new Y(M,b[Ne],`"${Ne}" is prohibited for ref layers`))}),q.layers.forEach(Ne=>{gr(Ne.id)===me&&(Ce=Ne)}),Ce?Ce.ref?h.push(new Y(M,b.ref,"ref cannot reference another ref layer")):J=gr(Ce.type):h.push(new Y(M,b.ref,`ref layer "${me}" not found`))}else if(J!=="background")if(b.source){const Ce=q.sources&&q.sources[b.source],Ne=Ce&&gr(Ce.type);Ce?Ne==="vector"&&J==="raster"?h.push(new Y(M,b.source,`layer "${b.id}" requires a raster source`)):Ne!=="raster-dem"&&J==="hillshade"?h.push(new Y(M,b.source,`layer "${b.id}" requires a raster-dem source`)):Ne==="raster"&&J!=="raster"?h.push(new Y(M,b.source,`layer "${b.id}" requires a vector source`)):Ne!=="vector"||b["source-layer"]?Ne==="raster-dem"&&J!=="hillshade"?h.push(new Y(M,b.source,"raster-dem source can only be used with layer type 'hillshade'.")):J!=="line"||!b.paint||!b.paint["line-gradient"]||Ne==="geojson"&&Ce.lineMetrics||h.push(new Y(M,b,`layer "${b.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):h.push(new Y(M,b,`layer "${b.id}" must specify a "source-layer"`)):h.push(new Y(M,b.source,`source "${b.source}" not found`))}else h.push(new Y(M,b,'missing required property "source"'));return h=h.concat(Aa({key:M,value:b,valueSpec:K.layer,style:m.style,styleSpec:m.styleSpec,validateSpec:m.validateSpec,objectElementValidators:{"*":()=>[],type:()=>m.validateSpec({key:`${M}.type`,value:b.type,valueSpec:K.layer.type,style:m.style,styleSpec:m.styleSpec,validateSpec:m.validateSpec,object:b,objectKey:"type"}),filter:cl,layout:Ce=>Aa({layer:b,key:Ce.key,value:Ce.value,style:Ce.style,styleSpec:Ce.styleSpec,validateSpec:Ce.validateSpec,objectElementValidators:{"*":Ne=>pi(te({layerType:J},Ne))}}),paint:Ce=>Aa({layer:b,key:Ce.key,value:Ce.value,style:Ce.style,styleSpec:Ce.styleSpec,validateSpec:Ce.validateSpec,objectElementValidators:{"*":Ne=>ao(te({layerType:J},Ne))}})}})),h}function Pi(m){const h=m.value,b=m.key,M=$n(h);return M!=="string"?[new Y(b,h,`string expected, ${M} found`)]:[]}const Ft={promoteId:function({key:m,value:h}){if($n(h)==="string")return Pi({key:m,value:h});{const b=[];for(const M in h)b.push(...Pi({key:`${m}.${M}`,value:h[M]}));return b}}};function ni(m){const h=m.value,b=m.key,M=m.styleSpec,q=m.style,K=m.validateSpec;if(!h.type)return[new Y(b,h,'"type" is required')];const J=gr(h.type);let me;switch(J){case"vector":case"raster":return me=Aa({key:b,value:h,valueSpec:M[`source_${J.replace("-","_")}`],style:m.style,styleSpec:M,objectElementValidators:Ft,validateSpec:K}),me;case"raster-dem":return me=function(Ce){var Ne;const f=(Ne=Ce.sourceName)!==null&&Ne!==void 0?Ne:"",u=Ce.value,p=Ce.styleSpec,I=p.source_raster_dem,L=Ce.style;let G=[];const Q=$n(u);if(u===void 0)return G;if(Q!=="object")return G.push(new Y("source_raster_dem",u,`object expected, ${Q} found`)),G;const re=gr(u.encoding)==="custom",Ae=["redFactor","greenFactor","blueFactor","baseShift"],_e=Ce.value.encoding?`"${Ce.value.encoding}"`:"Default";for(const Le in u)!re&&Ae.includes(Le)?G.push(new Y(Le,u[Le],`In "${f}": "${Le}" is only valid when "encoding" is set to "custom". ${_e} encoding found`)):I[Le]?G=G.concat(Ce.validateSpec({key:Le,value:u[Le],valueSpec:I[Le],validateSpec:Ce.validateSpec,style:L,styleSpec:p})):G.push(new Y(Le,u[Le],`unknown property "${Le}"`));return G}({sourceName:b,value:h,style:m.style,styleSpec:M,validateSpec:K}),me;case"geojson":if(me=Aa({key:b,value:h,valueSpec:M.source_geojson,style:q,styleSpec:M,validateSpec:K,objectElementValidators:Ft}),h.cluster)for(const Ce in h.clusterProperties){const[Ne,f]=h.clusterProperties[Ce],u=typeof Ne=="string"?[Ne,["accumulated"],["get",Ce]]:Ne;me.push(...Pa({key:`${b}.${Ce}.map`,value:f,validateSpec:K,expressionContext:"cluster-map"})),me.push(...Pa({key:`${b}.${Ce}.reduce`,value:u,validateSpec:K,expressionContext:"cluster-reduce"}))}return me;case"video":return Aa({key:b,value:h,valueSpec:M.source_video,style:q,validateSpec:K,styleSpec:M});case"image":return Aa({key:b,value:h,valueSpec:M.source_image,style:q,validateSpec:K,styleSpec:M});case"canvas":return[new Y(b,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ka({key:`${b}.type`,value:h.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:q,validateSpec:K,styleSpec:M})}}function xi(m){const h=m.value,b=m.styleSpec,M=b.light,q=m.style;let K=[];const J=$n(h);if(h===void 0)return K;if(J!=="object")return K=K.concat([new Y("light",h,`object expected, ${J} found`)]),K;for(const me in h){const Ce=me.match(/^(.*)-transition$/);K=K.concat(Ce&&M[Ce[1]]&&M[Ce[1]].transition?m.validateSpec({key:me,value:h[me],valueSpec:b.transition,validateSpec:m.validateSpec,style:q,styleSpec:b}):M[me]?m.validateSpec({key:me,value:h[me],valueSpec:M[me],validateSpec:m.validateSpec,style:q,styleSpec:b}):[new Y(me,h[me],`unknown property "${me}"`)])}return K}function Fi(m){const h=m.value,b=m.styleSpec,M=b.sky,q=m.style,K=$n(h);if(h===void 0)return[];if(K!=="object")return[new Y("sky",h,`object expected, ${K} found`)];let J=[];for(const me in h)J=J.concat(M[me]?Xn({key:me,value:h[me],valueSpec:M[me],style:q,styleSpec:b}):[new Y(me,h[me],`unknown property "${me}"`)]);return J}function Ln(m){const h=m.value,b=m.styleSpec,M=b.terrain,q=m.style;let K=[];const J=$n(h);if(h===void 0)return K;if(J!=="object")return K=K.concat([new Y("terrain",h,`object expected, ${J} found`)]),K;for(const me in h)K=K.concat(M[me]?m.validateSpec({key:me,value:h[me],valueSpec:M[me],validateSpec:m.validateSpec,style:q,styleSpec:b}):[new Y(me,h[me],`unknown property "${me}"`)]);return K}function jn(m){let h=[];const b=m.value,M=m.key;if(Array.isArray(b)){const q=[],K=[];for(const J in b)b[J].id&&q.includes(b[J].id)&&h.push(new Y(M,b,`all the sprites' ids must be unique, but ${b[J].id} is duplicated`)),q.push(b[J].id),b[J].url&&K.includes(b[J].url)&&h.push(new Y(M,b,`all the sprites' URLs must be unique, but ${b[J].url} is duplicated`)),K.push(b[J].url),h=h.concat(Aa({key:`${M}[${J}]`,value:b[J],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:m.validateSpec}));return h}return Pi({key:M,value:b})}const or={"*":()=>[],array:_o,boolean:function(m){const h=m.value,b=m.key,M=$n(h);return M!=="boolean"?[new Y(b,h,`boolean expected, ${M} found`)]:[]},number:ea,color:function(m){const h=m.key,b=m.value,M=$n(b);return M!=="string"?[new Y(h,b,`color expected, ${M} found`)]:mn.parse(String(b))?[]:[new Y(h,b,`color expected, "${b}" found`)]},constants:Yr,enum:Ka,filter:cl,function:Ea,layer:Vi,object:Aa,source:ni,light:xi,sky:Fi,terrain:Ln,string:Pi,formatted:function(m){return Pi(m).length===0?[]:Pa(m)},resolvedImage:function(m){return Pi(m).length===0?[]:Pa(m)},padding:function(m){const h=m.key,b=m.value;if($n(b)==="array"){if(b.length<1||b.length>4)return[new Y(h,b,`padding requires 1 to 4 values; ${b.length} values found`)];const M={type:"number"};let q=[];for(let K=0;K<b.length;K++)q=q.concat(m.validateSpec({key:`${h}[${K}]`,value:b[K],validateSpec:m.validateSpec,valueSpec:M}));return q}return ea({key:h,value:b,valueSpec:{}})},variableAnchorOffsetCollection:function(m){const h=m.key,b=m.value,M=$n(b),q=m.styleSpec;if(M!=="array"||b.length<1||b.length%2!=0)return[new Y(h,b,"variableAnchorOffsetCollection requires a non-empty array of even length")];let K=[];for(let J=0;J<b.length;J+=2)K=K.concat(Ka({key:`${h}[${J}]`,value:b[J],valueSpec:q.layout_symbol["text-anchor"]})),K=K.concat(_o({key:`${h}[${J+1}]`,value:b[J+1],valueSpec:{length:2,value:"number"},validateSpec:m.validateSpec,style:m.style,styleSpec:q}));return K},sprite:jn};function Xn(m){const h=m.value,b=m.valueSpec,M=m.styleSpec;return m.validateSpec=Xn,b.expression&&Ko(gr(h))?Ea(m):b.expression&&Zr(Nr(h))?Pa(m):b.type&&or[b.type]?or[b.type](m):Aa(te({},m,{valueSpec:b.type?M[b.type]:b}))}function Hs(m){const h=m.value,b=m.key,M=Pi(m);return M.length||(h.indexOf("{fontstack}")===-1&&M.push(new Y(b,h,'"glyphs" url must include a "{fontstack}" token')),h.indexOf("{range}")===-1&&M.push(new Y(b,h,'"glyphs" url must include a "{range}" token'))),M}function Ps(m,h=Xt){let b=[];return b=b.concat(Xn({key:"",value:m,valueSpec:h.$root,styleSpec:h,style:m,validateSpec:Xn,objectElementValidators:{glyphs:Hs,"*":()=>[]}})),m.constants&&(b=b.concat(Yr({key:"constants",value:m.constants,style:m,styleSpec:h,validateSpec:Xn}))),Ja(b)}function ps(m){return function(h){return m({...h,validateSpec:Xn})}}function Ja(m){return[].concat(m).sort((h,b)=>h.line-b.line)}function yo(m){return function(...h){return Ja(m.apply(this,h))}}Ps.source=yo(ps(ni)),Ps.sprite=yo(ps(jn)),Ps.glyphs=yo(ps(Hs)),Ps.light=yo(ps(xi)),Ps.sky=yo(ps(Fi)),Ps.terrain=yo(ps(Ln)),Ps.layer=yo(ps(Vi)),Ps.filter=yo(ps(cl)),Ps.paintProperty=yo(ps(ao)),Ps.layoutProperty=yo(ps(pi));const os=Ps,$u=os.light,Fu=os.paintProperty,vo=os.layoutProperty;function Ml(m,h){let b=!1;if(h&&h.length)for(const M of h)m.fire(new Yt(new Error(M.message))),b=!0;return b}class Pn{constructor(h,b,M){const q=this.cells=[];if(h instanceof ArrayBuffer){this.arrayBuffer=h;const J=new Int32Array(this.arrayBuffer);h=J[0],this.d=(b=J[1])+2*(M=J[2]);for(let Ce=0;Ce<this.d*this.d;Ce++){const Ne=J[3+Ce],f=J[3+Ce+1];q.push(Ne===f?null:J.subarray(Ne,f))}const me=J[3+q.length+1];this.keys=J.subarray(J[3+q.length],me),this.bboxes=J.subarray(me),this.insert=this._insertReadonly}else{this.d=b+2*M;for(let J=0;J<this.d*this.d;J++)q.push([]);this.keys=[],this.bboxes=[]}this.n=b,this.extent=h,this.padding=M,this.scale=b/h,this.uid=0;const K=M/b*h;this.min=-K,this.max=h+K}insert(h,b,M,q,K){this._forEachCell(b,M,q,K,this._insertCell,this.uid++,void 0,void 0),this.keys.push(h),this.bboxes.push(b),this.bboxes.push(M),this.bboxes.push(q),this.bboxes.push(K)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(h,b,M,q,K,J){this.cells[K].push(J)}query(h,b,M,q,K){const J=this.min,me=this.max;if(h<=J&&b<=J&&me<=M&&me<=q&&!K)return Array.prototype.slice.call(this.keys);{const Ce=[];return this._forEachCell(h,b,M,q,this._queryCell,Ce,{},K),Ce}}_queryCell(h,b,M,q,K,J,me,Ce){const Ne=this.cells[K];if(Ne!==null){const f=this.keys,u=this.bboxes;for(let p=0;p<Ne.length;p++){const I=Ne[p];if(me[I]===void 0){const L=4*I;(Ce?Ce(u[L+0],u[L+1],u[L+2],u[L+3]):h<=u[L+2]&&b<=u[L+3]&&M>=u[L+0]&&q>=u[L+1])?(me[I]=!0,J.push(f[I])):me[I]=!1}}}}_forEachCell(h,b,M,q,K,J,me,Ce){const Ne=this._convertToCellCoord(h),f=this._convertToCellCoord(b),u=this._convertToCellCoord(M),p=this._convertToCellCoord(q);for(let I=Ne;I<=u;I++)for(let L=f;L<=p;L++){const G=this.d*L+I;if((!Ce||Ce(this._convertFromCellCoord(I),this._convertFromCellCoord(L),this._convertFromCellCoord(I+1),this._convertFromCellCoord(L+1)))&&K.call(this,h,b,M,q,G,J,me,Ce))return}}_convertFromCellCoord(h){return(h-this.padding)/this.scale}_convertToCellCoord(h){return Math.max(0,Math.min(this.d-1,Math.floor(h*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const h=this.cells,b=3+this.cells.length+1+1;let M=0;for(let J=0;J<this.cells.length;J++)M+=this.cells[J].length;const q=new Int32Array(b+M+this.keys.length+this.bboxes.length);q[0]=this.extent,q[1]=this.n,q[2]=this.padding;let K=b;for(let J=0;J<h.length;J++){const me=h[J];q[3+J]=K,q.set(me,K),K+=me.length}return q[3+h.length]=K,q.set(this.keys,K),K+=this.keys.length,q[3+h.length+1]=K,q.set(this.bboxes,K),K+=this.bboxes.length,q.buffer}static serialize(h,b){const M=h.toArrayBuffer();return b&&b.push(M),{buffer:M}}static deserialize(h){return new Pn(h.buffer)}}const Da={};function In(m,h,b={}){if(Da[m])throw new Error(`${m} is already registered.`);Object.defineProperty(h,"_classRegistryKey",{value:m,writeable:!1}),Da[m]={klass:h,omit:b.omit||[],shallow:b.shallow||[]}}In("Object",Object),In("TransferableGridIndex",Pn),In("Color",mn),In("Error",Error),In("AJAXError",vn),In("ResolvedImage",Yi),In("StylePropertyFunction",Xr),In("StyleExpression",ns,{omit:["_evaluator"]}),In("ZoomDependentExpression",nr),In("ZoomConstantExpression",Mr),In("CompoundExpression",dn,{omit:["_evaluate"]});for(const m in ko)ko[m]._classRegistryKey||In(`Expression_${m}`,ko[m]);function No(m){return m&&typeof ArrayBuffer<"u"&&(m instanceof ArrayBuffer||m.constructor&&m.constructor.name==="ArrayBuffer")}function Nl(m,h){if(m==null||typeof m=="boolean"||typeof m=="number"||typeof m=="string"||m instanceof Boolean||m instanceof Number||m instanceof String||m instanceof Date||m instanceof RegExp||m instanceof Blob||m instanceof Error)return m;if(No(m)||Bt(m))return h&&h.push(m),m;if(ArrayBuffer.isView(m)){const b=m;return h&&h.push(b.buffer),b}if(m instanceof ImageData)return h&&h.push(m.data.buffer),m;if(Array.isArray(m)){const b=[];for(const M of m)b.push(Nl(M,h));return b}if(typeof m=="object"){const b=m.constructor,M=b._classRegistryKey;if(!M)throw new Error(`can't serialize object of unregistered class ${b.name}`);if(!Da[M])throw new Error(`${M} is not registered.`);const q=b.serialize?b.serialize(m,h):{};if(b.serialize){if(h&&q===h[h.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const K in m){if(!m.hasOwnProperty(K)||Da[M].omit.indexOf(K)>=0)continue;const J=m[K];q[K]=Da[M].shallow.indexOf(K)>=0?J:Nl(J,h)}m instanceof Error&&(q.message=m.message)}if(q.$name)throw new Error("$name property is reserved for worker serialization logic.");return M!=="Object"&&(q.$name=M),q}throw new Error("can't serialize object of type "+typeof m)}function En(m){if(m==null||typeof m=="boolean"||typeof m=="number"||typeof m=="string"||m instanceof Boolean||m instanceof Number||m instanceof String||m instanceof Date||m instanceof RegExp||m instanceof Blob||m instanceof Error||No(m)||Bt(m)||ArrayBuffer.isView(m)||m instanceof ImageData)return m;if(Array.isArray(m))return m.map(En);if(typeof m=="object"){const h=m.$name||"Object";if(!Da[h])throw new Error(`can't deserialize unregistered class ${h}`);const{klass:b}=Da[h];if(!b)throw new Error(`can't deserialize unregistered class ${h}`);if(b.deserialize)return b.deserialize(m);const M=Object.create(b.prototype);for(const q of Object.keys(m)){if(q==="$name")continue;const K=m[q];M[q]=Da[h].shallow.indexOf(q)>=0?K:En(K)}return M}throw new Error("can't deserialize object of type "+typeof m)}class $l{constructor(){this.first=!0}update(h,b){const M=Math.floor(h);return this.first?(this.first=!1,this.lastIntegerZoom=M,this.lastIntegerZoomTime=0,this.lastZoom=h,this.lastFloorZoom=M,!0):(this.lastFloorZoom>M?(this.lastIntegerZoom=M+1,this.lastIntegerZoomTime=b):this.lastFloorZoom<M&&(this.lastIntegerZoom=M,this.lastIntegerZoomTime=b),h!==this.lastZoom&&(this.lastZoom=h,this.lastFloorZoom=M,!0))}}const Cn={"Latin-1 Supplement":m=>m>=128&&m<=255,Arabic:m=>m>=1536&&m<=1791,"Arabic Supplement":m=>m>=1872&&m<=1919,"Arabic Extended-A":m=>m>=2208&&m<=2303,"Hangul Jamo":m=>m>=4352&&m<=4607,"Unified Canadian Aboriginal Syllabics":m=>m>=5120&&m<=5759,Khmer:m=>m>=6016&&m<=6143,"Unified Canadian Aboriginal Syllabics Extended":m=>m>=6320&&m<=6399,"General Punctuation":m=>m>=8192&&m<=8303,"Letterlike Symbols":m=>m>=8448&&m<=8527,"Number Forms":m=>m>=8528&&m<=8591,"Miscellaneous Technical":m=>m>=8960&&m<=9215,"Control Pictures":m=>m>=9216&&m<=9279,"Optical Character Recognition":m=>m>=9280&&m<=9311,"Enclosed Alphanumerics":m=>m>=9312&&m<=9471,"Geometric Shapes":m=>m>=9632&&m<=9727,"Miscellaneous Symbols":m=>m>=9728&&m<=9983,"Miscellaneous Symbols and Arrows":m=>m>=11008&&m<=11263,"CJK Radicals Supplement":m=>m>=11904&&m<=12031,"Kangxi Radicals":m=>m>=12032&&m<=12255,"Ideographic Description Characters":m=>m>=12272&&m<=12287,"CJK Symbols and Punctuation":m=>m>=12288&&m<=12351,Hiragana:m=>m>=12352&&m<=12447,Katakana:m=>m>=12448&&m<=12543,Bopomofo:m=>m>=12544&&m<=12591,"Hangul Compatibility Jamo":m=>m>=12592&&m<=12687,Kanbun:m=>m>=12688&&m<=12703,"Bopomofo Extended":m=>m>=12704&&m<=12735,"CJK Strokes":m=>m>=12736&&m<=12783,"Katakana Phonetic Extensions":m=>m>=12784&&m<=12799,"Enclosed CJK Letters and Months":m=>m>=12800&&m<=13055,"CJK Compatibility":m=>m>=13056&&m<=13311,"CJK Unified Ideographs Extension A":m=>m>=13312&&m<=19903,"Yijing Hexagram Symbols":m=>m>=19904&&m<=19967,"CJK Unified Ideographs":m=>m>=19968&&m<=40959,"Yi Syllables":m=>m>=40960&&m<=42127,"Yi Radicals":m=>m>=42128&&m<=42191,"Hangul Jamo Extended-A":m=>m>=43360&&m<=43391,"Hangul Syllables":m=>m>=44032&&m<=55215,"Hangul Jamo Extended-B":m=>m>=55216&&m<=55295,"Private Use Area":m=>m>=57344&&m<=63743,"CJK Compatibility Ideographs":m=>m>=63744&&m<=64255,"Arabic Presentation Forms-A":m=>m>=64336&&m<=65023,"Vertical Forms":m=>m>=65040&&m<=65055,"CJK Compatibility Forms":m=>m>=65072&&m<=65103,"Small Form Variants":m=>m>=65104&&m<=65135,"Arabic Presentation Forms-B":m=>m>=65136&&m<=65279,"Halfwidth and Fullwidth Forms":m=>m>=65280&&m<=65519};function _l(m){for(const h of m)if(Vl(h.charCodeAt(0)))return!0;return!1}function uu(m){for(const h of m)if(!Ou(h.charCodeAt(0)))return!1;return!0}function Ou(m){return!(Cn.Arabic(m)||Cn["Arabic Supplement"](m)||Cn["Arabic Extended-A"](m)||Cn["Arabic Presentation Forms-A"](m)||Cn["Arabic Presentation Forms-B"](m))}function Vl(m){return!(m!==746&&m!==747&&(m<4352||!(Cn["Bopomofo Extended"](m)||Cn.Bopomofo(m)||Cn["CJK Compatibility Forms"](m)&&!(m>=65097&&m<=65103)||Cn["CJK Compatibility Ideographs"](m)||Cn["CJK Compatibility"](m)||Cn["CJK Radicals Supplement"](m)||Cn["CJK Strokes"](m)||!(!Cn["CJK Symbols and Punctuation"](m)||m>=12296&&m<=12305||m>=12308&&m<=12319||m===12336)||Cn["CJK Unified Ideographs Extension A"](m)||Cn["CJK Unified Ideographs"](m)||Cn["Enclosed CJK Letters and Months"](m)||Cn["Hangul Compatibility Jamo"](m)||Cn["Hangul Jamo Extended-A"](m)||Cn["Hangul Jamo Extended-B"](m)||Cn["Hangul Jamo"](m)||Cn["Hangul Syllables"](m)||Cn.Hiragana(m)||Cn["Ideographic Description Characters"](m)||Cn.Kanbun(m)||Cn["Kangxi Radicals"](m)||Cn["Katakana Phonetic Extensions"](m)||Cn.Katakana(m)&&m!==12540||!(!Cn["Halfwidth and Fullwidth Forms"](m)||m===65288||m===65289||m===65293||m>=65306&&m<=65310||m===65339||m===65341||m===65343||m>=65371&&m<=65503||m===65507||m>=65512&&m<=65519)||!(!Cn["Small Form Variants"](m)||m>=65112&&m<=65118||m>=65123&&m<=65126)||Cn["Unified Canadian Aboriginal Syllabics"](m)||Cn["Unified Canadian Aboriginal Syllabics Extended"](m)||Cn["Vertical Forms"](m)||Cn["Yijing Hexagram Symbols"](m)||Cn["Yi Syllables"](m)||Cn["Yi Radicals"](m))))}function yl(m){return!(Vl(m)||function(h){return!!(Cn["Latin-1 Supplement"](h)&&(h===167||h===169||h===174||h===177||h===188||h===189||h===190||h===215||h===247)||Cn["General Punctuation"](h)&&(h===8214||h===8224||h===8225||h===8240||h===8241||h===8251||h===8252||h===8258||h===8263||h===8264||h===8265||h===8273)||Cn["Letterlike Symbols"](h)||Cn["Number Forms"](h)||Cn["Miscellaneous Technical"](h)&&(h>=8960&&h<=8967||h>=8972&&h<=8991||h>=8996&&h<=9e3||h===9003||h>=9085&&h<=9114||h>=9150&&h<=9165||h===9167||h>=9169&&h<=9179||h>=9186&&h<=9215)||Cn["Control Pictures"](h)&&h!==9251||Cn["Optical Character Recognition"](h)||Cn["Enclosed Alphanumerics"](h)||Cn["Geometric Shapes"](h)||Cn["Miscellaneous Symbols"](h)&&!(h>=9754&&h<=9759)||Cn["Miscellaneous Symbols and Arrows"](h)&&(h>=11026&&h<=11055||h>=11088&&h<=11097||h>=11192&&h<=11243)||Cn["CJK Symbols and Punctuation"](h)||Cn.Katakana(h)||Cn["Private Use Area"](h)||Cn["CJK Compatibility Forms"](h)||Cn["Small Form Variants"](h)||Cn["Halfwidth and Fullwidth Forms"](h)||h===8734||h===8756||h===8757||h>=9984&&h<=10087||h>=10102&&h<=10131||h===65532||h===65533)}(m))}function ta(m){return m>=1424&&m<=2303||Cn["Arabic Presentation Forms-A"](m)||Cn["Arabic Presentation Forms-B"](m)}function oc(m,h){return!(!h&&ta(m)||m>=2304&&m<=3583||m>=3840&&m<=4255||Cn.Khmer(m))}function Xu(m){for(const h of m)if(ta(h.charCodeAt(0)))return!0;return!1}const Xl=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(m){this.pluginStatus=m.pluginStatus,this.pluginURL=m.pluginURL}setMethods(m){this.applyArabicShaping=m.applyArabicShaping,this.processBidirectionalText=m.processBidirectionalText,this.processStyledBidirectionalText=m.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class ms{constructor(h,b){this.zoom=h,b?(this.now=b.now,this.fadeDuration=b.fadeDuration,this.zoomHistory=b.zoomHistory,this.transition=b.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new $l,this.transition={})}isSupportedScript(h){return function(b,M){for(const q of b)if(!oc(q.charCodeAt(0),M))return!1;return!0}(h,Xl.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const h=this.zoom,b=h-Math.floor(h),M=this.crossFadingFactor();return h>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:b+(1-b)*M}:{fromScale:.5,toScale:1,t:1-(1-M)*b}}}class _a{constructor(h,b){this.property=h,this.value=b,this.expression=function(M,q){if(Ko(M))return new Xr(M,q);if(Zr(M)){const K=ll(M,q);if(K.result==="error")throw new Error(K.value.map(J=>`${J.key}: ${J.message}`).join(", "));return K.value}{let K=M;return q.type==="color"&&typeof M=="string"?K=mn.parse(M):q.type!=="padding"||typeof M!="number"&&!Array.isArray(M)?q.type==="variableAnchorOffsetCollection"&&Array.isArray(M)&&(K=Wt.parse(M)):K=ur.parse(M),{kind:"constant",evaluate:()=>K}}}(b===void 0?h.specification.default:b,h.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(h,b,M){return this.property.possiblyEvaluate(this,h,b,M)}}class el{constructor(h){this.property=h,this.value=new _a(h,void 0)}transitioned(h,b){return new Nu(this.property,this.value,b,jt({},h.transition,this.transition),h.now)}untransitioned(){return new Nu(this.property,this.value,null,{},0)}}class _u{constructor(h){this._properties=h,this._values=Object.create(h.defaultTransitionablePropertyValues)}getValue(h){return xt(this._values[h].value.value)}setValue(h,b){Object.prototype.hasOwnProperty.call(this._values,h)||(this._values[h]=new el(this._values[h].property)),this._values[h].value=new _a(this._values[h].property,b===null?void 0:xt(b))}getTransition(h){return xt(this._values[h].transition)}setTransition(h,b){Object.prototype.hasOwnProperty.call(this._values,h)||(this._values[h]=new el(this._values[h].property)),this._values[h].transition=xt(b)||void 0}serialize(){const h={};for(const b of Object.keys(this._values)){const M=this.getValue(b);M!==void 0&&(h[b]=M);const q=this.getTransition(b);q!==void 0&&(h[`${b}-transition`]=q)}return h}transitioned(h,b){const M=new cu(this._properties);for(const q of Object.keys(this._values))M._values[q]=this._values[q].transitioned(h,b._values[q]);return M}untransitioned(){const h=new cu(this._properties);for(const b of Object.keys(this._values))h._values[b]=this._values[b].untransitioned();return h}}class Nu{constructor(h,b,M,q,K){this.property=h,this.value=b,this.begin=K+q.delay||0,this.end=this.begin+q.duration||0,h.specification.transition&&(q.delay||q.duration)&&(this.prior=M)}possiblyEvaluate(h,b,M){const q=h.now||0,K=this.value.possiblyEvaluate(h,b,M),J=this.prior;if(J){if(q>this.end)return this.prior=null,K;if(this.value.isDataDriven())return this.prior=null,K;if(q<this.begin)return J.possiblyEvaluate(h,b,M);{const me=(q-this.begin)/(this.end-this.begin);return this.property.interpolate(J.possiblyEvaluate(h,b,M),K,function(Ce){if(Ce<=0)return 0;if(Ce>=1)return 1;const Ne=Ce*Ce,f=Ne*Ce;return 4*(Ce<.5?f:3*(Ce-Ne)+f-.75)}(me))}}return K}}class cu{constructor(h){this._properties=h,this._values=Object.create(h.defaultTransitioningPropertyValues)}possiblyEvaluate(h,b,M){const q=new gs(this._properties);for(const K of Object.keys(this._values))q._values[K]=this._values[K].possiblyEvaluate(h,b,M);return q}hasTransition(){for(const h of Object.keys(this._values))if(this._values[h].prior)return!0;return!1}}class Vu{constructor(h){this._properties=h,this._values=Object.create(h.defaultPropertyValues)}hasValue(h){return this._values[h].value!==void 0}getValue(h){return xt(this._values[h].value)}setValue(h,b){this._values[h]=new _a(this._values[h].property,b===null?void 0:xt(b))}serialize(){const h={};for(const b of Object.keys(this._values)){const M=this.getValue(b);M!==void 0&&(h[b]=M)}return h}possiblyEvaluate(h,b,M){const q=new gs(this._properties);for(const K of Object.keys(this._values))q._values[K]=this._values[K].possiblyEvaluate(h,b,M);return q}}class yr{constructor(h,b,M){this.property=h,this.value=b,this.parameters=M}isConstant(){return this.value.kind==="constant"}constantOr(h){return this.value.kind==="constant"?this.value.value:h}evaluate(h,b,M,q){return this.property.evaluate(this.value,this.parameters,h,b,M,q)}}class gs{constructor(h){this._properties=h,this._values=Object.create(h.defaultPossiblyEvaluatedValues)}get(h){return this._values[h]}}class gn{constructor(h){this.specification=h}possiblyEvaluate(h,b){if(h.isDataDriven())throw new Error("Value should not be data driven");return h.expression.evaluate(b)}interpolate(h,b,M){const q=xr[this.specification.type];return q?q(h,b,M):h}}class Zn{constructor(h,b){this.specification=h,this.overrides=b}possiblyEvaluate(h,b,M,q){return new yr(this,h.expression.kind==="constant"||h.expression.kind==="camera"?{kind:"constant",value:h.expression.evaluate(b,null,{},M,q)}:h.expression,b)}interpolate(h,b,M){if(h.value.kind!=="constant"||b.value.kind!=="constant")return h;if(h.value.value===void 0||b.value.value===void 0)return new yr(this,{kind:"constant",value:void 0},h.parameters);const q=xr[this.specification.type];if(q){const K=q(h.value.value,b.value.value,M);return new yr(this,{kind:"constant",value:K},h.parameters)}return h}evaluate(h,b,M,q,K,J){return h.kind==="constant"?h.value:h.evaluate(b,M,q,K,J)}}class Jn extends Zn{possiblyEvaluate(h,b,M,q){if(h.value===void 0)return new yr(this,{kind:"constant",value:void 0},b);if(h.expression.kind==="constant"){const K=h.expression.evaluate(b,null,{},M,q),J=h.property.specification.type==="resolvedImage"&&typeof K!="string"?K.name:K,me=this._calculate(J,J,J,b);return new yr(this,{kind:"constant",value:me},b)}if(h.expression.kind==="camera"){const K=this._calculate(h.expression.evaluate({zoom:b.zoom-1}),h.expression.evaluate({zoom:b.zoom}),h.expression.evaluate({zoom:b.zoom+1}),b);return new yr(this,{kind:"constant",value:K},b)}return new yr(this,h.expression,b)}evaluate(h,b,M,q,K,J){if(h.kind==="source"){const me=h.evaluate(b,M,q,K,J);return this._calculate(me,me,me,b)}return h.kind==="composite"?this._calculate(h.evaluate({zoom:Math.floor(b.zoom)-1},M,q),h.evaluate({zoom:Math.floor(b.zoom)},M,q),h.evaluate({zoom:Math.floor(b.zoom)+1},M,q),b):h.value}_calculate(h,b,M,q){return q.zoom>q.zoomHistory.lastIntegerZoom?{from:h,to:b}:{from:M,to:b}}interpolate(h){return h}}class tl{constructor(h){this.specification=h}possiblyEvaluate(h,b,M,q){if(h.value!==void 0){if(h.expression.kind==="constant"){const K=h.expression.evaluate(b,null,{},M,q);return this._calculate(K,K,K,b)}return this._calculate(h.expression.evaluate(new ms(Math.floor(b.zoom-1),b)),h.expression.evaluate(new ms(Math.floor(b.zoom),b)),h.expression.evaluate(new ms(Math.floor(b.zoom+1),b)),b)}}_calculate(h,b,M,q){return q.zoom>q.zoomHistory.lastIntegerZoom?{from:h,to:b}:{from:M,to:b}}interpolate(h){return h}}class Tu{constructor(h){this.specification=h}possiblyEvaluate(h,b,M,q){return!!h.expression.evaluate(b,null,{},M,q)}interpolate(){return!1}}class oa{constructor(h){this.properties=h,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const b in h){const M=h[b];M.specification.overridable&&this.overridableProperties.push(b);const q=this.defaultPropertyValues[b]=new _a(M,void 0),K=this.defaultTransitionablePropertyValues[b]=new el(M);this.defaultTransitioningPropertyValues[b]=K.untransitioned(),this.defaultPossiblyEvaluatedValues[b]=q.possiblyEvaluate({})}}}In("DataDrivenProperty",Zn),In("DataConstantProperty",gn),In("CrossFadedDataDrivenProperty",Jn),In("CrossFadedProperty",tl),In("ColorRampProperty",Tu);const yu="-transition";class bs extends rn{constructor(h,b){if(super(),this.id=h.id,this.type=h.type,this._featureFilter={filter:()=>!0,needGeometry:!1},h.type!=="custom"&&(this.metadata=h.metadata,this.minzoom=h.minzoom,this.maxzoom=h.maxzoom,h.type!=="background"&&(this.source=h.source,this.sourceLayer=h["source-layer"],this.filter=h.filter),b.layout&&(this._unevaluatedLayout=new Vu(b.layout)),b.paint)){this._transitionablePaint=new _u(b.paint);for(const M in h.paint)this.setPaintProperty(M,h.paint[M],{validate:!1});for(const M in h.layout)this.setLayoutProperty(M,h.layout[M],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new gs(b.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(h){return h==="visibility"?this.visibility:this._unevaluatedLayout.getValue(h)}setLayoutProperty(h,b,M={}){b!=null&&this._validate(vo,`layers.${this.id}.layout.${h}`,h,b,M)||(h!=="visibility"?this._unevaluatedLayout.setValue(h,b):this.visibility=b)}getPaintProperty(h){return h.endsWith(yu)?this._transitionablePaint.getTransition(h.slice(0,-11)):this._transitionablePaint.getValue(h)}setPaintProperty(h,b,M={}){if(b!=null&&this._validate(Fu,`layers.${this.id}.paint.${h}`,h,b,M))return!1;if(h.endsWith(yu))return this._transitionablePaint.setTransition(h.slice(0,-11),b||void 0),!1;{const q=this._transitionablePaint._values[h],K=q.property.specification["property-type"]==="cross-faded-data-driven",J=q.value.isDataDriven(),me=q.value;this._transitionablePaint.setValue(h,b),this._handleSpecialPaintPropertyUpdate(h);const Ce=this._transitionablePaint._values[h].value;return Ce.isDataDriven()||J||K||this._handleOverridablePaintPropertyUpdate(h,me,Ce)}}_handleSpecialPaintPropertyUpdate(h){}_handleOverridablePaintPropertyUpdate(h,b,M){return!1}isHidden(h){return!!(this.minzoom&&h<this.minzoom)||!!(this.maxzoom&&h>=this.maxzoom)||this.visibility==="none"}updateTransitions(h){this._transitioningPaint=this._transitionablePaint.transitioned(h,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(h,b){h.getCrossfadeParameters&&(this._crossfadeParameters=h.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(h,void 0,b)),this.paint=this._transitioningPaint.possiblyEvaluate(h,void 0,b)}serialize(){const h={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(h.layout=h.layout||{},h.layout.visibility=this.visibility),mt(h,(b,M)=>!(b===void 0||M==="layout"&&!Object.keys(b).length||M==="paint"&&!Object.keys(b).length))}_validate(h,b,M,q,K={}){return(!K||K.validate!==!1)&&Ml(this,h.call(os,{key:b,layerType:this.type,objectKey:M,value:q,styleSpec:Xt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const h in this.paint._values){const b=this.paint.get(h);if(b instanceof yr&&ks(b.property.specification)&&(b.value.kind==="source"||b.value.kind==="composite")&&b.value.isStateDependent)return!0}return!1}}const Lo={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ki{constructor(h,b){this._structArray=h,this._pos1=b*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Li{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(h,b){return h._trim(),b&&(h.isTransferred=!0,b.push(h.arrayBuffer)),{length:h.length,arrayBuffer:h.arrayBuffer}}static deserialize(h){const b=Object.create(this.prototype);return b.arrayBuffer=h.arrayBuffer,b.length=h.length,b.capacity=h.arrayBuffer.byteLength/b.bytesPerElement,b._refreshViews(),b}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(h){this.reserve(h),this.length=h}reserve(h){if(h>this.capacity){this.capacity=Math.max(h,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const b=this.uint8;this._refreshViews(),b&&this.uint8.set(b)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ws(m,h=1){let b=0,M=0;return{members:m.map(q=>{const K=Lo[q.type].BYTES_PER_ELEMENT,J=b=vu(b,Math.max(h,K)),me=q.components||1;return M=Math.max(M,K),b+=K*me,{name:q.name,type:q.type,components:me,offset:J}}),size:vu(b,Math.max(M,h)),alignment:h}}function vu(m,h){return Math.ceil(m/h)*h}class Vo extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,b){const M=this.length;return this.resize(M+1),this.emplace(M,h,b)}emplace(h,b,M){const q=2*h;return this.int16[q+0]=b,this.int16[q+1]=M,h}}Vo.prototype.bytesPerElement=4,In("StructArrayLayout2i4",Vo);class fs extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,b,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,b,M)}emplace(h,b,M,q){const K=3*h;return this.int16[K+0]=b,this.int16[K+1]=M,this.int16[K+2]=q,h}}fs.prototype.bytesPerElement=6,In("StructArrayLayout3i6",fs);class hl extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,b,M,q){const K=this.length;return this.resize(K+1),this.emplace(K,h,b,M,q)}emplace(h,b,M,q,K){const J=4*h;return this.int16[J+0]=b,this.int16[J+1]=M,this.int16[J+2]=q,this.int16[J+3]=K,h}}hl.prototype.bytesPerElement=8,In("StructArrayLayout4i8",hl);class Ds extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,b,M,q,K,J){const me=this.length;return this.resize(me+1),this.emplace(me,h,b,M,q,K,J)}emplace(h,b,M,q,K,J,me){const Ce=6*h;return this.int16[Ce+0]=b,this.int16[Ce+1]=M,this.int16[Ce+2]=q,this.int16[Ce+3]=K,this.int16[Ce+4]=J,this.int16[Ce+5]=me,h}}Ds.prototype.bytesPerElement=12,In("StructArrayLayout2i4i12",Ds);class C extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,b,M,q,K,J){const me=this.length;return this.resize(me+1),this.emplace(me,h,b,M,q,K,J)}emplace(h,b,M,q,K,J,me){const Ce=4*h,Ne=8*h;return this.int16[Ce+0]=b,this.int16[Ce+1]=M,this.uint8[Ne+4]=q,this.uint8[Ne+5]=K,this.uint8[Ne+6]=J,this.uint8[Ne+7]=me,h}}C.prototype.bytesPerElement=8,In("StructArrayLayout2i4ub8",C);class D extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,b){const M=this.length;return this.resize(M+1),this.emplace(M,h,b)}emplace(h,b,M){const q=2*h;return this.float32[q+0]=b,this.float32[q+1]=M,h}}D.prototype.bytesPerElement=8,In("StructArrayLayout2f8",D);class z extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,b,M,q,K,J,me,Ce,Ne,f){const u=this.length;return this.resize(u+1),this.emplace(u,h,b,M,q,K,J,me,Ce,Ne,f)}emplace(h,b,M,q,K,J,me,Ce,Ne,f,u){const p=10*h;return this.uint16[p+0]=b,this.uint16[p+1]=M,this.uint16[p+2]=q,this.uint16[p+3]=K,this.uint16[p+4]=J,this.uint16[p+5]=me,this.uint16[p+6]=Ce,this.uint16[p+7]=Ne,this.uint16[p+8]=f,this.uint16[p+9]=u,h}}z.prototype.bytesPerElement=20,In("StructArrayLayout10ui20",z);class R extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,b,M,q,K,J,me,Ce,Ne,f,u,p){const I=this.length;return this.resize(I+1),this.emplace(I,h,b,M,q,K,J,me,Ce,Ne,f,u,p)}emplace(h,b,M,q,K,J,me,Ce,Ne,f,u,p,I){const L=12*h;return this.int16[L+0]=b,this.int16[L+1]=M,this.int16[L+2]=q,this.int16[L+3]=K,this.uint16[L+4]=J,this.uint16[L+5]=me,this.uint16[L+6]=Ce,this.uint16[L+7]=Ne,this.int16[L+8]=f,this.int16[L+9]=u,this.int16[L+10]=p,this.int16[L+11]=I,h}}R.prototype.bytesPerElement=24,In("StructArrayLayout4i4ui4i24",R);class ee extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,b,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,b,M)}emplace(h,b,M,q){const K=3*h;return this.float32[K+0]=b,this.float32[K+1]=M,this.float32[K+2]=q,h}}ee.prototype.bytesPerElement=12,In("StructArrayLayout3f12",ee);class le extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(h){const b=this.length;return this.resize(b+1),this.emplace(b,h)}emplace(h,b){return this.uint32[1*h+0]=b,h}}le.prototype.bytesPerElement=4,In("StructArrayLayout1ul4",le);class oe extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,b,M,q,K,J,me,Ce,Ne){const f=this.length;return this.resize(f+1),this.emplace(f,h,b,M,q,K,J,me,Ce,Ne)}emplace(h,b,M,q,K,J,me,Ce,Ne,f){const u=10*h,p=5*h;return this.int16[u+0]=b,this.int16[u+1]=M,this.int16[u+2]=q,this.int16[u+3]=K,this.int16[u+4]=J,this.int16[u+5]=me,this.uint32[p+3]=Ce,this.uint16[u+8]=Ne,this.uint16[u+9]=f,h}}oe.prototype.bytesPerElement=20,In("StructArrayLayout6i1ul2ui20",oe);class we extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,b,M,q,K,J){const me=this.length;return this.resize(me+1),this.emplace(me,h,b,M,q,K,J)}emplace(h,b,M,q,K,J,me){const Ce=6*h;return this.int16[Ce+0]=b,this.int16[Ce+1]=M,this.int16[Ce+2]=q,this.int16[Ce+3]=K,this.int16[Ce+4]=J,this.int16[Ce+5]=me,h}}we.prototype.bytesPerElement=12,In("StructArrayLayout2i2i2i12",we);class We extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,b,M,q,K){const J=this.length;return this.resize(J+1),this.emplace(J,h,b,M,q,K)}emplace(h,b,M,q,K,J){const me=4*h,Ce=8*h;return this.float32[me+0]=b,this.float32[me+1]=M,this.float32[me+2]=q,this.int16[Ce+6]=K,this.int16[Ce+7]=J,h}}We.prototype.bytesPerElement=16,In("StructArrayLayout2f1f2i16",We);class yt extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,b,M,q){const K=this.length;return this.resize(K+1),this.emplace(K,h,b,M,q)}emplace(h,b,M,q,K){const J=12*h,me=3*h;return this.uint8[J+0]=b,this.uint8[J+1]=M,this.float32[me+1]=q,this.float32[me+2]=K,h}}yt.prototype.bytesPerElement=12,In("StructArrayLayout2ub2f12",yt);class Ct extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,b,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,b,M)}emplace(h,b,M,q){const K=3*h;return this.uint16[K+0]=b,this.uint16[K+1]=M,this.uint16[K+2]=q,h}}Ct.prototype.bytesPerElement=6,In("StructArrayLayout3ui6",Ct);class ri extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,b,M,q,K,J,me,Ce,Ne,f,u,p,I,L,G,Q,re){const Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,h,b,M,q,K,J,me,Ce,Ne,f,u,p,I,L,G,Q,re)}emplace(h,b,M,q,K,J,me,Ce,Ne,f,u,p,I,L,G,Q,re,Ae){const _e=24*h,Le=12*h,qe=48*h;return this.int16[_e+0]=b,this.int16[_e+1]=M,this.uint16[_e+2]=q,this.uint16[_e+3]=K,this.uint32[Le+2]=J,this.uint32[Le+3]=me,this.uint32[Le+4]=Ce,this.uint16[_e+10]=Ne,this.uint16[_e+11]=f,this.uint16[_e+12]=u,this.float32[Le+7]=p,this.float32[Le+8]=I,this.uint8[qe+36]=L,this.uint8[qe+37]=G,this.uint8[qe+38]=Q,this.uint32[Le+10]=re,this.int16[_e+22]=Ae,h}}ri.prototype.bytesPerElement=48,In("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ri);class Gt extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,b,M,q,K,J,me,Ce,Ne,f,u,p,I,L,G,Q,re,Ae,_e,Le,qe,tt,ft,gt,Mt,Pt,Lt,ei){const Ht=this.length;return this.resize(Ht+1),this.emplace(Ht,h,b,M,q,K,J,me,Ce,Ne,f,u,p,I,L,G,Q,re,Ae,_e,Le,qe,tt,ft,gt,Mt,Pt,Lt,ei)}emplace(h,b,M,q,K,J,me,Ce,Ne,f,u,p,I,L,G,Q,re,Ae,_e,Le,qe,tt,ft,gt,Mt,Pt,Lt,ei,Ht){const Qt=32*h,hi=16*h;return this.int16[Qt+0]=b,this.int16[Qt+1]=M,this.int16[Qt+2]=q,this.int16[Qt+3]=K,this.int16[Qt+4]=J,this.int16[Qt+5]=me,this.int16[Qt+6]=Ce,this.int16[Qt+7]=Ne,this.uint16[Qt+8]=f,this.uint16[Qt+9]=u,this.uint16[Qt+10]=p,this.uint16[Qt+11]=I,this.uint16[Qt+12]=L,this.uint16[Qt+13]=G,this.uint16[Qt+14]=Q,this.uint16[Qt+15]=re,this.uint16[Qt+16]=Ae,this.uint16[Qt+17]=_e,this.uint16[Qt+18]=Le,this.uint16[Qt+19]=qe,this.uint16[Qt+20]=tt,this.uint16[Qt+21]=ft,this.uint16[Qt+22]=gt,this.uint32[hi+12]=Mt,this.float32[hi+13]=Pt,this.float32[hi+14]=Lt,this.uint16[Qt+30]=ei,this.uint16[Qt+31]=Ht,h}}Gt.prototype.bytesPerElement=64,In("StructArrayLayout8i15ui1ul2f2ui64",Gt);class Zt extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h){const b=this.length;return this.resize(b+1),this.emplace(b,h)}emplace(h,b){return this.float32[1*h+0]=b,h}}Zt.prototype.bytesPerElement=4,In("StructArrayLayout1f4",Zt);class Z extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,b,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,b,M)}emplace(h,b,M,q){const K=3*h;return this.uint16[6*h+0]=b,this.float32[K+1]=M,this.float32[K+2]=q,h}}Z.prototype.bytesPerElement=12,In("StructArrayLayout1ui2f12",Z);class A extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,b,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,b,M)}emplace(h,b,M,q){const K=4*h;return this.uint32[2*h+0]=b,this.uint16[K+2]=M,this.uint16[K+3]=q,h}}A.prototype.bytesPerElement=8,In("StructArrayLayout1ul2ui8",A);class E extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,b){const M=this.length;return this.resize(M+1),this.emplace(M,h,b)}emplace(h,b,M){const q=2*h;return this.uint16[q+0]=b,this.uint16[q+1]=M,h}}E.prototype.bytesPerElement=4,In("StructArrayLayout2ui4",E);class F extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h){const b=this.length;return this.resize(b+1),this.emplace(b,h)}emplace(h,b){return this.uint16[1*h+0]=b,h}}F.prototype.bytesPerElement=2,In("StructArrayLayout1ui2",F);class O extends Li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,b,M,q){const K=this.length;return this.resize(K+1),this.emplace(K,h,b,M,q)}emplace(h,b,M,q,K){const J=4*h;return this.float32[J+0]=b,this.float32[J+1]=M,this.float32[J+2]=q,this.float32[J+3]=K,h}}O.prototype.bytesPerElement=16,In("StructArrayLayout4f16",O);class y extends ki{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ae(this.anchorPointX,this.anchorPointY)}}y.prototype.size=20;class s extends oe{get(h){return new y(this,h)}}In("CollisionBoxArray",s);class i extends ki{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(h){this._structArray.uint8[this._pos1+37]=h}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(h){this._structArray.uint8[this._pos1+38]=h}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(h){this._structArray.uint32[this._pos4+10]=h}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}i.prototype.size=48;class r extends ri{get(h){return new i(this,h)}}In("PlacedSymbolArray",r);class l extends ki{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(h){this._structArray.uint32[this._pos4+12]=h}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}l.prototype.size=64;class d extends Gt{get(h){return new l(this,h)}}In("SymbolInstanceArray",d);class _ extends Zt{getoffsetX(h){return this.float32[1*h+0]}}In("GlyphOffsetArray",_);class w extends fs{getx(h){return this.int16[3*h+0]}gety(h){return this.int16[3*h+1]}gettileUnitDistanceFromAnchor(h){return this.int16[3*h+2]}}In("SymbolLineVertexArray",w);class T extends ki{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}T.prototype.size=12;class B extends Z{get(h){return new T(this,h)}}In("TextAnchorOffsetArray",B);class j extends ki{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}j.prototype.size=8;class X extends A{get(h){return new j(this,h)}}In("FeatureIndexArray",X);class ue extends Vo{}class Se extends Vo{}class Te extends Vo{}class Re extends Ds{}class Be extends C{}class et extends D{}class vt extends z{}class ot extends R{}class ht extends ee{}class Et extends le{}class wt extends we{}class si extends yt{}class Kt extends Ct{}class ii extends E{}const ai=ws([{name:"a_pos",components:2,type:"Int16"}],4),{members:Zi}=ai;class Qi{constructor(h=[]){this.segments=h}prepareSegment(h,b,M,q){let K=this.segments[this.segments.length-1];return h>Qi.MAX_VERTEX_ARRAY_LENGTH&&lt(`Max vertices per segment is ${Qi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${h}`),(!K||K.vertexLength+h>Qi.MAX_VERTEX_ARRAY_LENGTH||K.sortKey!==q)&&(K={vertexOffset:b.length,primitiveOffset:M.length,vertexLength:0,primitiveLength:0},q!==void 0&&(K.sortKey=q),this.segments.push(K)),K}get(){return this.segments}destroy(){for(const h of this.segments)for(const b in h.vaos)h.vaos[b].destroy()}static simpleSegment(h,b,M,q){return new Qi([{vertexOffset:h,primitiveOffset:b,vertexLength:M,primitiveLength:q,vaos:{},sortKey:0}])}}function Si(m,h){return 256*(m=Rt(Math.floor(m),0,255))+Rt(Math.floor(h),0,255)}Qi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,In("SegmentVector",Qi);const Ui=ws([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Gi={exports:{}},un={exports:{}};un.exports=function(m,h){var b,M,q,K,J,me,Ce,Ne;for(M=m.length-(b=3&m.length),q=h,J=3432918353,me=461845907,Ne=0;Ne<M;)Ce=255&m.charCodeAt(Ne)|(255&m.charCodeAt(++Ne))<<8|(255&m.charCodeAt(++Ne))<<16|(255&m.charCodeAt(++Ne))<<24,++Ne,q=27492+(65535&(K=5*(65535&(q=(q^=Ce=(65535&(Ce=(Ce=(65535&Ce)*J+(((Ce>>>16)*J&65535)<<16)&4294967295)<<15|Ce>>>17))*me+(((Ce>>>16)*me&65535)<<16)&4294967295)<<13|q>>>19))+((5*(q>>>16)&65535)<<16)&4294967295))+((58964+(K>>>16)&65535)<<16);switch(Ce=0,b){case 3:Ce^=(255&m.charCodeAt(Ne+2))<<16;case 2:Ce^=(255&m.charCodeAt(Ne+1))<<8;case 1:q^=Ce=(65535&(Ce=(Ce=(65535&(Ce^=255&m.charCodeAt(Ne)))*J+(((Ce>>>16)*J&65535)<<16)&4294967295)<<15|Ce>>>17))*me+(((Ce>>>16)*me&65535)<<16)&4294967295}return q^=m.length,q=2246822507*(65535&(q^=q>>>16))+((2246822507*(q>>>16)&65535)<<16)&4294967295,q=3266489909*(65535&(q^=q>>>13))+((3266489909*(q>>>16)&65535)<<16)&4294967295,(q^=q>>>16)>>>0};var Bn=un.exports,en={exports:{}};en.exports=function(m,h){for(var b,M=m.length,q=h^M,K=0;M>=4;)b=1540483477*(65535&(b=255&m.charCodeAt(K)|(255&m.charCodeAt(++K))<<8|(255&m.charCodeAt(++K))<<16|(255&m.charCodeAt(++K))<<24))+((1540483477*(b>>>16)&65535)<<16),q=1540483477*(65535&q)+((1540483477*(q>>>16)&65535)<<16)^(b=1540483477*(65535&(b^=b>>>24))+((1540483477*(b>>>16)&65535)<<16)),M-=4,++K;switch(M){case 3:q^=(255&m.charCodeAt(K+2))<<16;case 2:q^=(255&m.charCodeAt(K+1))<<8;case 1:q=1540483477*(65535&(q^=255&m.charCodeAt(K)))+((1540483477*(q>>>16)&65535)<<16)}return q=1540483477*(65535&(q^=q>>>13))+((1540483477*(q>>>16)&65535)<<16),(q^=q>>>15)>>>0};var kn=Bn,vr=en.exports;Gi.exports=kn,Gi.exports.murmur3=kn,Gi.exports.murmur2=vr;var er=U(Gi.exports);class Ca{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(h,b,M,q){this.ids.push(fa(h)),this.positions.push(b,M,q)}getPositions(h){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const b=fa(h);let M=0,q=this.ids.length-1;for(;M<q;){const J=M+q>>1;this.ids[J]>=b?q=J:M=J+1}const K=[];for(;this.ids[M]===b;)K.push({index:this.positions[3*M],start:this.positions[3*M+1],end:this.positions[3*M+2]}),M++;return K}static serialize(h,b){const M=new Float64Array(h.ids),q=new Uint32Array(h.positions);return zs(M,q,0,M.length-1),b&&b.push(M.buffer,q.buffer),{ids:M,positions:q}}static deserialize(h){const b=new Ca;return b.ids=h.ids,b.positions=h.positions,b.indexed=!0,b}}function fa(m){const h=+m;return!isNaN(h)&&h<=Number.MAX_SAFE_INTEGER?h:er(String(m))}function zs(m,h,b,M){for(;b<M;){const q=m[b+M>>1];let K=b-1,J=M+1;for(;;){do K++;while(m[K]<q);do J--;while(m[J]>q);if(K>=J)break;oo(m,K,J),oo(h,3*K,3*J),oo(h,3*K+1,3*J+1),oo(h,3*K+2,3*J+2)}J-b<M-J?(zs(m,h,b,J),b=J+1):(zs(m,h,J+1,M),M=J)}}function oo(m,h,b){const M=m[h];m[h]=m[b],m[b]=M}In("FeaturePositionMap",Ca);class lo{constructor(h,b){this.gl=h.gl,this.location=b}}class qr extends lo{constructor(h,b){super(h,b),this.current=0}set(h){this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class ya extends lo{constructor(h,b){super(h,b),this.current=[0,0,0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3]))}}class xo extends lo{constructor(h,b){super(h,b),this.current=mn.transparent}set(h){h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a))}}const bo=new Float32Array(16);function Qs(m){return[Si(255*m.r,255*m.g),Si(255*m.b,255*m.a)]}class rs{constructor(h,b,M){this.value=h,this.uniformNames=b.map(q=>`u_${q}`),this.type=M}setUniform(h,b,M){h.set(M.constantOr(this.value))}getBinding(h,b,M){return this.type==="color"?new xo(h,b):new qr(h,b)}}class ss{constructor(h,b){this.uniformNames=b.map(M=>`u_${M}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(h,b){this.pixelRatioFrom=b.pixelRatio,this.pixelRatioTo=h.pixelRatio,this.patternFrom=b.tlbr,this.patternTo=h.tlbr}setUniform(h,b,M,q){const K=q==="u_pattern_to"?this.patternTo:q==="u_pattern_from"?this.patternFrom:q==="u_pixel_ratio_to"?this.pixelRatioTo:q==="u_pixel_ratio_from"?this.pixelRatioFrom:null;K&&h.set(K)}getBinding(h,b,M){return M.substr(0,9)==="u_pattern"?new ya(h,b):new qr(h,b)}}class Rr{constructor(h,b,M,q){this.expression=h,this.type=M,this.maxValue=0,this.paintVertexAttributes=b.map(K=>({name:`a_${K}`,type:"Float32",components:M==="color"?2:1,offset:0})),this.paintVertexArray=new q}populatePaintArray(h,b,M,q,K){const J=this.paintVertexArray.length,me=this.expression.evaluate(new ms(0),b,{},q,[],K);this.paintVertexArray.resize(h),this._setPaintValue(J,h,me)}updatePaintArray(h,b,M,q){const K=this.expression.evaluate({zoom:0},M,q);this._setPaintValue(h,b,K)}_setPaintValue(h,b,M){if(this.type==="color"){const q=Qs(M);for(let K=h;K<b;K++)this.paintVertexArray.emplace(K,q[0],q[1])}else{for(let q=h;q<b;q++)this.paintVertexArray.emplace(q,M);this.maxValue=Math.max(this.maxValue,Math.abs(M))}}upload(h){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=h.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ss{constructor(h,b,M,q,K,J){this.expression=h,this.uniformNames=b.map(me=>`u_${me}_t`),this.type=M,this.useIntegerZoom=q,this.zoom=K,this.maxValue=0,this.paintVertexAttributes=b.map(me=>({name:`a_${me}`,type:"Float32",components:M==="color"?4:2,offset:0})),this.paintVertexArray=new J}populatePaintArray(h,b,M,q,K){const J=this.expression.evaluate(new ms(this.zoom),b,{},q,[],K),me=this.expression.evaluate(new ms(this.zoom+1),b,{},q,[],K),Ce=this.paintVertexArray.length;this.paintVertexArray.resize(h),this._setPaintValue(Ce,h,J,me)}updatePaintArray(h,b,M,q){const K=this.expression.evaluate({zoom:this.zoom},M,q),J=this.expression.evaluate({zoom:this.zoom+1},M,q);this._setPaintValue(h,b,K,J)}_setPaintValue(h,b,M,q){if(this.type==="color"){const K=Qs(M),J=Qs(q);for(let me=h;me<b;me++)this.paintVertexArray.emplace(me,K[0],K[1],J[0],J[1])}else{for(let K=h;K<b;K++)this.paintVertexArray.emplace(K,M,q);this.maxValue=Math.max(this.maxValue,Math.abs(M),Math.abs(q))}}upload(h){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=h.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(h,b){const M=this.useIntegerZoom?Math.floor(b.zoom):b.zoom,q=Rt(this.expression.interpolationFactor(M,this.zoom,this.zoom+1),0,1);h.set(q)}getBinding(h,b,M){return new qr(h,b)}}class Ws{constructor(h,b,M,q,K,J){this.expression=h,this.type=b,this.useIntegerZoom=M,this.zoom=q,this.layerId=J,this.zoomInPaintVertexArray=new K,this.zoomOutPaintVertexArray=new K}populatePaintArray(h,b,M){const q=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(h),this.zoomOutPaintVertexArray.resize(h),this._setPaintValues(q,h,b.patterns&&b.patterns[this.layerId],M)}updatePaintArray(h,b,M,q,K){this._setPaintValues(h,b,M.patterns&&M.patterns[this.layerId],K)}_setPaintValues(h,b,M,q){if(!q||!M)return;const{min:K,mid:J,max:me}=M,Ce=q[K],Ne=q[J],f=q[me];if(Ce&&Ne&&f)for(let u=h;u<b;u++)this.zoomInPaintVertexArray.emplace(u,Ne.tl[0],Ne.tl[1],Ne.br[0],Ne.br[1],Ce.tl[0],Ce.tl[1],Ce.br[0],Ce.br[1],Ne.pixelRatio,Ce.pixelRatio),this.zoomOutPaintVertexArray.emplace(u,Ne.tl[0],Ne.tl[1],Ne.br[0],Ne.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],Ne.pixelRatio,f.pixelRatio)}upload(h){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=h.createVertexBuffer(this.zoomInPaintVertexArray,Ui.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=h.createVertexBuffer(this.zoomOutPaintVertexArray,Ui.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Bo{constructor(h,b,M){this.binders={},this._buffers=[];const q=[];for(const K in h.paint._values){if(!M(K))continue;const J=h.paint.get(K);if(!(J instanceof yr&&ks(J.property.specification)))continue;const me=Go(K,h.type),Ce=J.value,Ne=J.property.specification.type,f=J.property.useIntegerZoom,u=J.property.specification["property-type"],p=u==="cross-faded"||u==="cross-faded-data-driven";if(Ce.kind==="constant")this.binders[K]=p?new ss(Ce.value,me):new rs(Ce.value,me,Ne),q.push(`/u_${K}`);else if(Ce.kind==="source"||p){const I=Ec(K,Ne,"source");this.binders[K]=p?new Ws(Ce,Ne,f,b,I,h.id):new Rr(Ce,me,Ne,I),q.push(`/a_${K}`)}else{const I=Ec(K,Ne,"composite");this.binders[K]=new Ss(Ce,me,Ne,f,b,I),q.push(`/z_${K}`)}}this.cacheKey=q.sort().join("")}getMaxValue(h){const b=this.binders[h];return b instanceof Rr||b instanceof Ss?b.maxValue:0}populatePaintArrays(h,b,M,q,K){for(const J in this.binders){const me=this.binders[J];(me instanceof Rr||me instanceof Ss||me instanceof Ws)&&me.populatePaintArray(h,b,M,q,K)}}setConstantPatternPositions(h,b){for(const M in this.binders){const q=this.binders[M];q instanceof ss&&q.setConstantPatternPositions(h,b)}}updatePaintArrays(h,b,M,q,K){let J=!1;for(const me in h){const Ce=b.getPositions(me);for(const Ne of Ce){const f=M.feature(Ne.index);for(const u in this.binders){const p=this.binders[u];if((p instanceof Rr||p instanceof Ss||p instanceof Ws)&&p.expression.isStateDependent===!0){const I=q.paint.get(u);p.expression=I.value,p.updatePaintArray(Ne.start,Ne.end,f,h[me],K),J=!0}}}}return J}defines(){const h=[];for(const b in this.binders){const M=this.binders[b];(M instanceof rs||M instanceof ss)&&h.push(...M.uniformNames.map(q=>`#define HAS_UNIFORM_${q}`))}return h}getBinderAttributes(){const h=[];for(const b in this.binders){const M=this.binders[b];if(M instanceof Rr||M instanceof Ss)for(let q=0;q<M.paintVertexAttributes.length;q++)h.push(M.paintVertexAttributes[q].name);else if(M instanceof Ws)for(let q=0;q<Ui.members.length;q++)h.push(Ui.members[q].name)}return h}getBinderUniforms(){const h=[];for(const b in this.binders){const M=this.binders[b];if(M instanceof rs||M instanceof ss||M instanceof Ss)for(const q of M.uniformNames)h.push(q)}return h}getPaintVertexBuffers(){return this._buffers}getUniforms(h,b){const M=[];for(const q in this.binders){const K=this.binders[q];if(K instanceof rs||K instanceof ss||K instanceof Ss){for(const J of K.uniformNames)if(b[J]){const me=K.getBinding(h,b[J],J);M.push({name:J,property:q,binding:me})}}}return M}setUniforms(h,b,M,q){for(const{name:K,property:J,binding:me}of b)this.binders[J].setUniform(me,q,M.get(J),K)}updatePaintBuffers(h){this._buffers=[];for(const b in this.binders){const M=this.binders[b];if(h&&M instanceof Ws){const q=h.fromScale===2?M.zoomInPaintVertexBuffer:M.zoomOutPaintVertexBuffer;q&&this._buffers.push(q)}else(M instanceof Rr||M instanceof Ss)&&M.paintVertexBuffer&&this._buffers.push(M.paintVertexBuffer)}}upload(h){for(const b in this.binders){const M=this.binders[b];(M instanceof Rr||M instanceof Ss||M instanceof Ws)&&M.upload(h)}this.updatePaintBuffers()}destroy(){for(const h in this.binders){const b=this.binders[h];(b instanceof Rr||b instanceof Ss||b instanceof Ws)&&b.destroy()}}}class Uo{constructor(h,b,M=()=>!0){this.programConfigurations={};for(const q of h)this.programConfigurations[q.id]=new Bo(q,b,M);this.needsUpload=!1,this._featureMap=new Ca,this._bufferOffset=0}populatePaintArrays(h,b,M,q,K,J){for(const me in this.programConfigurations)this.programConfigurations[me].populatePaintArrays(h,b,q,K,J);b.id!==void 0&&this._featureMap.add(b.id,M,this._bufferOffset,h),this._bufferOffset=h,this.needsUpload=!0}updatePaintArrays(h,b,M,q){for(const K of M)this.needsUpload=this.programConfigurations[K.id].updatePaintArrays(h,this._featureMap,b,K,q)||this.needsUpload}get(h){return this.programConfigurations[h]}upload(h){if(this.needsUpload){for(const b in this.programConfigurations)this.programConfigurations[b].upload(h);this.needsUpload=!1}}destroy(){for(const h in this.programConfigurations)this.programConfigurations[h].destroy()}}function Go(m,h){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[m]||[m.replace(`${h}-`,"").replace(/-/g,"_")]}function Ec(m,h,b){const M={color:{source:D,composite:O},number:{source:Zt,composite:D}},q=function(K){return{"line-pattern":{source:vt,composite:vt},"fill-pattern":{source:vt,composite:vt},"fill-extrusion-pattern":{source:vt,composite:vt}}[K]}(m);return q&&q[b]||M[h][b]}In("ConstantBinder",rs),In("CrossFadedConstantBinder",ss),In("SourceExpressionBinder",Rr),In("CrossFadedCompositeBinder",Ws),In("CompositeExpressionBinder",Ss),In("ProgramConfiguration",Bo,{omit:["_buffers"]}),In("ProgramConfigurationSet",Uo);const $s=8192,Yl=Math.pow(2,14)-1,hu=-Yl-1;function il(m){const h=$s/m.extent,b=m.loadGeometry();for(let M=0;M<b.length;M++){const q=b[M];for(let K=0;K<q.length;K++){const J=q[K],me=Math.round(J.x*h),Ce=Math.round(J.y*h);J.x=Rt(me,hu,Yl),J.y=Rt(Ce,hu,Yl),(me<J.x||me>J.x+1||Ce<J.y||Ce>J.y+1)&&lt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return b}function vl(m,h){return{type:m.type,id:m.id,properties:m.properties,geometry:h?il(m):[]}}function Pl(m,h,b,M,q){m.emplaceBack(2*h+(M+1)/2,2*b+(q+1)/2)}class Au{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(b=>b.id),this.index=h.index,this.hasPattern=!1,this.layoutVertexArray=new Se,this.indexArray=new Kt,this.segments=new Qi,this.programConfigurations=new Uo(h.layers,h.zoom),this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id)}populate(h,b,M){const q=this.layers[0],K=[];let J=null,me=!1;q.type==="circle"&&(J=q.layout.get("circle-sort-key"),me=!J.isConstant());for(const{feature:Ce,id:Ne,index:f,sourceLayerIndex:u}of h){const p=this.layers[0]._featureFilter.needGeometry,I=vl(Ce,p);if(!this.layers[0]._featureFilter.filter(new ms(this.zoom),I,M))continue;const L=me?J.evaluate(I,{},M):void 0,G={id:Ne,properties:Ce.properties,type:Ce.type,sourceLayerIndex:u,index:f,geometry:p?I.geometry:il(Ce),patterns:{},sortKey:L};K.push(G)}me&&K.sort((Ce,Ne)=>Ce.sortKey-Ne.sortKey);for(const Ce of K){const{geometry:Ne,index:f,sourceLayerIndex:u}=Ce,p=h[f].feature;this.addFeature(Ce,Ne,f,M),b.featureIndex.insert(p,Ne,f,u,this.index)}}update(h,b,M){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,b,this.stateDependentLayers,M)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,Zi),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(h,b,M,q){for(const K of b)for(const J of K){const me=J.x,Ce=J.y;if(me<0||me>=$s||Ce<0||Ce>=$s)continue;const Ne=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,h.sortKey),f=Ne.vertexLength;Pl(this.layoutVertexArray,me,Ce,-1,-1),Pl(this.layoutVertexArray,me,Ce,1,-1),Pl(this.layoutVertexArray,me,Ce,1,1),Pl(this.layoutVertexArray,me,Ce,-1,1),this.indexArray.emplaceBack(f,f+1,f+2),this.indexArray.emplaceBack(f,f+3,f+2),Ne.vertexLength+=4,Ne.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,M,{},q)}}function af(m,h){for(let b=0;b<m.length;b++)if(Xc(h,m[b]))return!0;for(let b=0;b<h.length;b++)if(Xc(m,h[b]))return!0;return!!yh(m,h)}function Vh(m,h,b){return!!Xc(m,h)||!!Cc(h,m,b)}function La(m,h){if(m.length===1)return h0(h,m[0]);for(let b=0;b<h.length;b++){const M=h[b];for(let q=0;q<M.length;q++)if(Xc(m,M[q]))return!0}for(let b=0;b<m.length;b++)if(h0(h,m[b]))return!0;for(let b=0;b<h.length;b++)if(yh(m,h[b]))return!0;return!1}function pA(m,h,b){if(m.length>1){if(yh(m,h))return!0;for(let M=0;M<h.length;M++)if(Cc(h[M],m,b))return!0}for(let M=0;M<m.length;M++)if(Cc(m[M],h,b))return!0;return!1}function yh(m,h){if(m.length===0||h.length===0)return!1;for(let b=0;b<m.length-1;b++){const M=m[b],q=m[b+1];for(let K=0;K<h.length-1;K++)if(Uh(M,q,h[K],h[K+1]))return!0}return!1}function Uh(m,h,b,M){return $e(m,b,M)!==$e(h,b,M)&&$e(m,h,b)!==$e(m,h,M)}function Cc(m,h,b){const M=b*b;if(h.length===1)return m.distSqr(h[0])<M;for(let q=1;q<h.length;q++)if(Gh(m,h[q-1],h[q])<M)return!0;return!1}function Gh(m,h,b){const M=h.distSqr(b);if(M===0)return m.distSqr(h);const q=((m.x-h.x)*(b.x-h.x)+(m.y-h.y)*(b.y-h.y))/M;return m.distSqr(q<0?h:q>1?b:b.sub(h)._mult(q)._add(h))}function h0(m,h){let b,M,q,K=!1;for(let J=0;J<m.length;J++){b=m[J];for(let me=0,Ce=b.length-1;me<b.length;Ce=me++)M=b[me],q=b[Ce],M.y>h.y!=q.y>h.y&&h.x<(q.x-M.x)*(h.y-M.y)/(q.y-M.y)+M.x&&(K=!K)}return K}function Xc(m,h){let b=!1;for(let M=0,q=m.length-1;M<m.length;q=M++){const K=m[M],J=m[q];K.y>h.y!=J.y>h.y&&h.x<(J.x-K.x)*(h.y-K.y)/(J.y-K.y)+K.x&&(b=!b)}return b}function _p(m,h,b){const M=b[0],q=b[2];if(m.x<M.x&&h.x<M.x||m.x>q.x&&h.x>q.x||m.y<M.y&&h.y<M.y||m.y>q.y&&h.y>q.y)return!1;const K=$e(m,h,b[0]);return K!==$e(m,h,b[1])||K!==$e(m,h,b[2])||K!==$e(m,h,b[3])}function qh(m,h,b){const M=h.paint.get(m).value;return M.kind==="constant"?M.value:b.programConfigurations.get(h.id).getMaxValue(m)}function of(m){return Math.sqrt(m[0]*m[0]+m[1]*m[1])}function Yc(m,h,b,M,q){if(!h[0]&&!h[1])return m;const K=ae.convert(h)._mult(q);b==="viewport"&&K._rotate(-M);const J=[];for(let me=0;me<m.length;me++)J.push(m[me].sub(K));return J}let yp,lf;In("CircleBucket",Au,{omit:["layers"]});var j0={get paint(){return lf=lf||new oa({"circle-radius":new Zn(Xt.paint_circle["circle-radius"]),"circle-color":new Zn(Xt.paint_circle["circle-color"]),"circle-blur":new Zn(Xt.paint_circle["circle-blur"]),"circle-opacity":new Zn(Xt.paint_circle["circle-opacity"]),"circle-translate":new gn(Xt.paint_circle["circle-translate"]),"circle-translate-anchor":new gn(Xt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new gn(Xt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new gn(Xt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Zn(Xt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Zn(Xt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Zn(Xt.paint_circle["circle-stroke-opacity"])})},get layout(){return yp=yp||new oa({"circle-sort-key":new Zn(Xt.layout_circle["circle-sort-key"])})}},Kl=1e-6,Yu=typeof Float32Array<"u"?Float32Array:Array;function Z0(m){return m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=1,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=1,m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,m}function vh(m,h,b){var M=h[0],q=h[1],K=h[2],J=h[3],me=h[4],Ce=h[5],Ne=h[6],f=h[7],u=h[8],p=h[9],I=h[10],L=h[11],G=h[12],Q=h[13],re=h[14],Ae=h[15],_e=b[0],Le=b[1],qe=b[2],tt=b[3];return m[0]=_e*M+Le*me+qe*u+tt*G,m[1]=_e*q+Le*Ce+qe*p+tt*Q,m[2]=_e*K+Le*Ne+qe*I+tt*re,m[3]=_e*J+Le*f+qe*L+tt*Ae,m[4]=(_e=b[4])*M+(Le=b[5])*me+(qe=b[6])*u+(tt=b[7])*G,m[5]=_e*q+Le*Ce+qe*p+tt*Q,m[6]=_e*K+Le*Ne+qe*I+tt*re,m[7]=_e*J+Le*f+qe*L+tt*Ae,m[8]=(_e=b[8])*M+(Le=b[9])*me+(qe=b[10])*u+(tt=b[11])*G,m[9]=_e*q+Le*Ce+qe*p+tt*Q,m[10]=_e*K+Le*Ne+qe*I+tt*re,m[11]=_e*J+Le*f+qe*L+tt*Ae,m[12]=(_e=b[12])*M+(Le=b[13])*me+(qe=b[14])*u+(tt=b[15])*G,m[13]=_e*q+Le*Ce+qe*p+tt*Q,m[14]=_e*K+Le*Ne+qe*I+tt*re,m[15]=_e*J+Le*f+qe*L+tt*Ae,m}Math.hypot||(Math.hypot=function(){for(var m=0,h=arguments.length;h--;)m+=arguments[h]*arguments[h];return Math.sqrt(m)});var Kc,mA=vh;function uf(m,h,b){var M=h[0],q=h[1],K=h[2],J=h[3];return m[0]=b[0]*M+b[4]*q+b[8]*K+b[12]*J,m[1]=b[1]*M+b[5]*q+b[9]*K+b[13]*J,m[2]=b[2]*M+b[6]*q+b[10]*K+b[14]*J,m[3]=b[3]*M+b[7]*q+b[11]*K+b[15]*J,m}Kc=new Yu(4),Yu!=Float32Array&&(Kc[0]=0,Kc[1]=0,Kc[2]=0,Kc[3]=0);class A0 extends bs{constructor(h){super(h,j0)}createBucket(h){return new Au(h)}queryRadius(h){const b=h;return qh("circle-radius",this,b)+qh("circle-stroke-width",this,b)+of(this.paint.get("circle-translate"))}queryIntersectsFeature(h,b,M,q,K,J,me,Ce){const Ne=Yc(h,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),J.angle,me),f=this.paint.get("circle-radius").evaluate(b,M)+this.paint.get("circle-stroke-width").evaluate(b,M),u=this.paint.get("circle-pitch-alignment")==="map",p=u?Ne:function(L,G){return L.map(Q=>_s(Q,G))}(Ne,Ce),I=u?f*me:f;for(const L of q)for(const G of L){const Q=u?G:_s(G,Ce);let re=I;const Ae=uf([],[G.x,G.y,0,1],Ce);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?re*=Ae[3]/J.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(re*=J.cameraToCenterDistance/Ae[3]),Vh(p,Q,re))return!0}return!1}}function _s(m,h){const b=uf([],[m.x,m.y,0,1],h);return new ae(b[0]/b[3],b[1]/b[3])}class Jl extends Au{}let Hh;In("HeatmapBucket",Jl,{omit:["layers"]});var jh={get paint(){return Hh=Hh||new oa({"heatmap-radius":new Zn(Xt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Zn(Xt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new gn(Xt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Tu(Xt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new gn(Xt.paint_heatmap["heatmap-opacity"])})}};function cf(m,{width:h,height:b},M,q){if(q){if(q instanceof Uint8ClampedArray)q=new Uint8Array(q.buffer);else if(q.length!==h*b*M)throw new RangeError(`mismatched image size. expected: ${q.length} but got: ${h*b*M}`)}else q=new Uint8Array(h*b*M);return m.width=h,m.height=b,m.data=q,m}function gA(m,{width:h,height:b},M){if(h===m.width&&b===m.height)return;const q=cf({},{width:h,height:b},M);Q0(m,q,{x:0,y:0},{x:0,y:0},{width:Math.min(m.width,h),height:Math.min(m.height,b)},M),m.width=h,m.height=b,m.data=q.data}function Q0(m,h,b,M,q,K){if(q.width===0||q.height===0)return h;if(q.width>m.width||q.height>m.height||b.x>m.width-q.width||b.y>m.height-q.height)throw new RangeError("out of range source coordinates for image copy");if(q.width>h.width||q.height>h.height||M.x>h.width-q.width||M.y>h.height-q.height)throw new RangeError("out of range destination coordinates for image copy");const J=m.data,me=h.data;if(J===me)throw new Error("srcData equals dstData, so image is already copied");for(let Ce=0;Ce<q.height;Ce++){const Ne=((b.y+Ce)*m.width+b.x)*K,f=((M.y+Ce)*h.width+M.x)*K;for(let u=0;u<q.width*K;u++)me[f+u]=J[Ne+u]}return h}class Dl{constructor(h,b){cf(this,h,1,b)}resize(h){gA(this,h,1)}clone(){return new Dl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(h,b,M,q,K){Q0(h,b,M,q,K,1)}}class Uu{constructor(h,b){cf(this,h,4,b)}resize(h){gA(this,h,4)}replace(h,b){b?this.data.set(h):this.data=h instanceof Uint8ClampedArray?new Uint8Array(h.buffer):h}clone(){return new Uu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(h,b,M,q,K){Q0(h,b,M,q,K,4)}}function _A(m){const h={},b=m.resolution||256,M=m.clips?m.clips.length:1,q=m.image||new Uu({width:b,height:M});if(Math.log(b)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${b}`);const K=(J,me,Ce)=>{h[m.evaluationKey]=Ce;const Ne=m.expression.evaluate(h);q.data[J+me+0]=Math.floor(255*Ne.r/Ne.a),q.data[J+me+1]=Math.floor(255*Ne.g/Ne.a),q.data[J+me+2]=Math.floor(255*Ne.b/Ne.a),q.data[J+me+3]=Math.floor(255*Ne.a)};if(m.clips)for(let J=0,me=0;J<M;++J,me+=4*b)for(let Ce=0,Ne=0;Ce<b;Ce++,Ne+=4){const f=Ce/(b-1),{start:u,end:p}=m.clips[J];K(me,Ne,u*(1-f)+p*f)}else for(let J=0,me=0;J<b;J++,me+=4)K(0,me,J/(b-1));return q}In("AlphaImage",Dl),In("RGBAImage",Uu);class f0 extends bs{createBucket(h){return new Jl(h)}constructor(h){super(h,jh),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(h){h==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=_A({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let d0;var vp={get paint(){return d0=d0||new oa({"hillshade-illumination-direction":new gn(Xt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new gn(Xt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new gn(Xt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new gn(Xt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new gn(Xt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new gn(Xt.paint_hillshade["hillshade-accent-color"])})}};class xu extends bs{constructor(h){super(h,vp)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const Jc=ws([{name:"a_pos",components:2,type:"Int16"}],4),{members:hf}=Jc;var xh={exports:{}};function Ll(m,h,b){b=b||2;var M,q,K,J,me,Ce,Ne,f=h&&h.length,u=f?h[0]*b:m.length,p=p0(m,0,u,b,!0),I=[];if(!p||p.next===p.prev)return I;if(f&&(p=function(G,Q,re,Ae){var _e,Le,qe,tt=[];for(_e=0,Le=Q.length;_e<Le;_e++)(qe=p0(G,Q[_e]*Ae,_e<Le-1?Q[_e+1]*Ae:G.length,Ae,!1))===qe.next&&(qe.steiner=!0),tt.push(ff(qe));for(tt.sort(Tc),_e=0;_e<tt.length;_e++)re=Af(tt[_e],re);return re}(m,h,p,b)),m.length>80*b){M=K=m[0],q=J=m[1];for(var L=b;L<u;L+=b)(me=m[L])<M&&(M=me),(Ce=m[L+1])<q&&(q=Ce),me>K&&(K=me),Ce>J&&(J=Ce);Ne=(Ne=Math.max(K-M,J-q))!==0?32767/Ne:0}return Zh(p,I,b,M,q,Ne,0),I}function p0(m,h,b,M,q){var K,J;if(q===cc(m,h,b,M)>0)for(K=h;K<b;K+=M)J=Qh(K,m[K],m[K+1],J);else for(K=b-M;K>=h;K-=M)J=Qh(K,m[K],m[K+1],J);return J&&df(J,J.next)&&(gf(J),J=J.next),J}function eh(m,h){if(!m)return m;h||(h=m);var b,M=m;do if(b=!1,M.steiner||!df(M,M.next)&&zo(M.prev,M,M.next)!==0)M=M.next;else{if(gf(M),(M=h=M.prev)===M.next)break;b=!0}while(b||M!==h);return h}function Zh(m,h,b,M,q,K,J){if(m){!J&&K&&function(f,u,p,I){var L=f;do L.z===0&&(L.z=lc(L.x,L.y,u,p,I)),L.prevZ=L.prev,L.nextZ=L.next,L=L.next;while(L!==f);L.prevZ.nextZ=null,L.prevZ=null,function(G){var Q,re,Ae,_e,Le,qe,tt,ft,gt=1;do{for(re=G,G=null,Le=null,qe=0;re;){for(qe++,Ae=re,tt=0,Q=0;Q<gt&&(tt++,Ae=Ae.nextZ);Q++);for(ft=gt;tt>0||ft>0&&Ae;)tt!==0&&(ft===0||!Ae||re.z<=Ae.z)?(_e=re,re=re.nextZ,tt--):(_e=Ae,Ae=Ae.nextZ,ft--),Le?Le.nextZ=_e:G=_e,_e.prevZ=Le,Le=_e;re=Ae}Le.nextZ=null,gt*=2}while(qe>1)}(L)}(m,M,q,K);for(var me,Ce,Ne=m;m.prev!==m.next;)if(me=m.prev,Ce=m.next,K?$0(m,M,q,K):W0(m))h.push(me.i/b|0),h.push(m.i/b|0),h.push(Ce.i/b|0),gf(m),m=Ce.next,Ne=Ce.next;else if((m=Ce)===Ne){J?J===1?Zh(m=bh(eh(m),h,b),h,b,M,q,K,2):J===2&&Tm(m,h,b,M,q,K):Zh(eh(m),h,b,M,q,K,1);break}}}function W0(m){var h=m.prev,b=m,M=m.next;if(zo(h,b,M)>=0)return!1;for(var q=h.x,K=b.x,J=M.x,me=h.y,Ce=b.y,Ne=M.y,f=q<K?q<J?q:J:K<J?K:J,u=me<Ce?me<Ne?me:Ne:Ce<Ne?Ce:Ne,p=q>K?q>J?q:J:K>J?K:J,I=me>Ce?me>Ne?me:Ne:Ce>Ne?Ce:Ne,L=M.next;L!==h;){if(L.x>=f&&L.x<=p&&L.y>=u&&L.y<=I&&yA(q,me,K,Ce,J,Ne,L.x,L.y)&&zo(L.prev,L,L.next)>=0)return!1;L=L.next}return!0}function $0(m,h,b,M){var q=m.prev,K=m,J=m.next;if(zo(q,K,J)>=0)return!1;for(var me=q.x,Ce=K.x,Ne=J.x,f=q.y,u=K.y,p=J.y,I=me<Ce?me<Ne?me:Ne:Ce<Ne?Ce:Ne,L=f<u?f<p?f:p:u<p?u:p,G=me>Ce?me>Ne?me:Ne:Ce>Ne?Ce:Ne,Q=f>u?f>p?f:p:u>p?u:p,re=lc(I,L,h,b,M),Ae=lc(G,Q,h,b,M),_e=m.prevZ,Le=m.nextZ;_e&&_e.z>=re&&Le&&Le.z<=Ae;){if(_e.x>=I&&_e.x<=G&&_e.y>=L&&_e.y<=Q&&_e!==q&&_e!==J&&yA(me,f,Ce,u,Ne,p,_e.x,_e.y)&&zo(_e.prev,_e,_e.next)>=0||(_e=_e.prevZ,Le.x>=I&&Le.x<=G&&Le.y>=L&&Le.y<=Q&&Le!==q&&Le!==J&&yA(me,f,Ce,u,Ne,p,Le.x,Le.y)&&zo(Le.prev,Le,Le.next)>=0))return!1;Le=Le.nextZ}for(;_e&&_e.z>=re;){if(_e.x>=I&&_e.x<=G&&_e.y>=L&&_e.y<=Q&&_e!==q&&_e!==J&&yA(me,f,Ce,u,Ne,p,_e.x,_e.y)&&zo(_e.prev,_e,_e.next)>=0)return!1;_e=_e.prevZ}for(;Le&&Le.z<=Ae;){if(Le.x>=I&&Le.x<=G&&Le.y>=L&&Le.y<=Q&&Le!==q&&Le!==J&&yA(me,f,Ce,u,Ne,p,Le.x,Le.y)&&zo(Le.prev,Le,Le.next)>=0)return!1;Le=Le.nextZ}return!0}function bh(m,h,b){var M=m;do{var q=M.prev,K=M.next.next;!df(q,K)&&xp(q,M,M.next,K)&&xl(q,K)&&xl(K,q)&&(h.push(q.i/b|0),h.push(M.i/b|0),h.push(K.i/b|0),gf(M),gf(M.next),M=m=K),M=M.next}while(M!==m);return eh(M)}function Tm(m,h,b,M,q,K){var J=m;do{for(var me=J.next.next;me!==J.prev;){if(J.i!==me.i&&km(J,me)){var Ce=uc(J,me);return J=eh(J,J.next),Ce=eh(Ce,Ce.next),Zh(J,h,b,M,q,K,0),void Zh(Ce,h,b,M,q,K,0)}me=me.next}J=J.next}while(J!==m)}function Tc(m,h){return m.x-h.x}function Af(m,h){var b=function(q,K){var J,me=K,Ce=q.x,Ne=q.y,f=-1/0;do{if(Ne<=me.y&&Ne>=me.next.y&&me.next.y!==me.y){var u=me.x+(Ne-me.y)*(me.next.x-me.x)/(me.next.y-me.y);if(u<=Ce&&u>f&&(f=u,J=me.x<me.next.x?me:me.next,u===Ce))return J}me=me.next}while(me!==K);if(!J)return null;var p,I=J,L=J.x,G=J.y,Q=1/0;me=J;do Ce>=me.x&&me.x>=L&&Ce!==me.x&&yA(Ne<G?Ce:f,Ne,L,G,Ne<G?f:Ce,Ne,me.x,me.y)&&(p=Math.abs(Ne-me.y)/(Ce-me.x),xl(me,q)&&(p<Q||p===Q&&(me.x>J.x||me.x===J.x&&X0(J,me)))&&(J=me,Q=p)),me=me.next;while(me!==I);return J}(m,h);if(!b)return h;var M=uc(b,m);return eh(M,M.next),eh(b,b.next)}function X0(m,h){return zo(m.prev,m,h.prev)<0&&zo(h.next,m,m.next)<0}function lc(m,h,b,M,q){return(m=1431655765&((m=858993459&((m=252645135&((m=16711935&((m=(m-b)*q|0)|m<<8))|m<<4))|m<<2))|m<<1))|(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-M)*q|0)|h<<8))|h<<4))|h<<2))|h<<1))<<1}function ff(m){var h=m,b=m;do(h.x<b.x||h.x===b.x&&h.y<b.y)&&(b=h),h=h.next;while(h!==m);return b}function yA(m,h,b,M,q,K,J,me){return(q-J)*(h-me)>=(m-J)*(K-me)&&(m-J)*(M-me)>=(b-J)*(h-me)&&(b-J)*(K-me)>=(q-J)*(M-me)}function km(m,h){return m.next.i!==h.i&&m.prev.i!==h.i&&!function(b,M){var q=b;do{if(q.i!==b.i&&q.next.i!==b.i&&q.i!==M.i&&q.next.i!==M.i&&xp(q,q.next,b,M))return!0;q=q.next}while(q!==b);return!1}(m,h)&&(xl(m,h)&&xl(h,m)&&function(b,M){var q=b,K=!1,J=(b.x+M.x)/2,me=(b.y+M.y)/2;do q.y>me!=q.next.y>me&&q.next.y!==q.y&&J<(q.next.x-q.x)*(me-q.y)/(q.next.y-q.y)+q.x&&(K=!K),q=q.next;while(q!==b);return K}(m,h)&&(zo(m.prev,m,h.prev)||zo(m,h.prev,h))||df(m,h)&&zo(m.prev,m,m.next)>0&&zo(h.prev,h,h.next)>0)}function zo(m,h,b){return(h.y-m.y)*(b.x-h.x)-(h.x-m.x)*(b.y-h.y)}function df(m,h){return m.x===h.x&&m.y===h.y}function xp(m,h,b,M){var q=mf(zo(m,h,b)),K=mf(zo(m,h,M)),J=mf(zo(b,M,m)),me=mf(zo(b,M,h));return q!==K&&J!==me||!(q!==0||!pf(m,b,h))||!(K!==0||!pf(m,M,h))||!(J!==0||!pf(b,m,M))||!(me!==0||!pf(b,h,M))}function pf(m,h,b){return h.x<=Math.max(m.x,b.x)&&h.x>=Math.min(m.x,b.x)&&h.y<=Math.max(m.y,b.y)&&h.y>=Math.min(m.y,b.y)}function mf(m){return m>0?1:m<0?-1:0}function xl(m,h){return zo(m.prev,m,m.next)<0?zo(m,h,m.next)>=0&&zo(m,m.prev,h)>=0:zo(m,h,m.prev)<0||zo(m,m.next,h)<0}function uc(m,h){var b=new Ba(m.i,m.x,m.y),M=new Ba(h.i,h.x,h.y),q=m.next,K=h.prev;return m.next=h,h.prev=m,b.next=q,q.prev=b,M.next=b,b.prev=M,K.next=M,M.prev=K,M}function Qh(m,h,b,M){var q=new Ba(m,h,b);return M?(q.next=M.next,q.prev=M,M.next.prev=q,M.next=q):(q.prev=q,q.next=q),q}function gf(m){m.next.prev=m.prev,m.prev.next=m.next,m.prevZ&&(m.prevZ.nextZ=m.nextZ),m.nextZ&&(m.nextZ.prevZ=m.prevZ)}function Ba(m,h,b){this.i=m,this.x=h,this.y=b,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function cc(m,h,b,M){for(var q=0,K=h,J=b-M;K<b;K+=M)q+=(m[J]-m[K])*(m[K+1]+m[J+1]),J=K;return q}xh.exports=Ll,xh.exports.default=Ll,Ll.deviation=function(m,h,b,M){var q=h&&h.length,K=Math.abs(cc(m,0,q?h[0]*b:m.length,b));if(q)for(var J=0,me=h.length;J<me;J++)K-=Math.abs(cc(m,h[J]*b,J<me-1?h[J+1]*b:m.length,b));var Ce=0;for(J=0;J<M.length;J+=3){var Ne=M[J]*b,f=M[J+1]*b,u=M[J+2]*b;Ce+=Math.abs((m[Ne]-m[u])*(m[f+1]-m[Ne+1])-(m[Ne]-m[f])*(m[u+1]-m[Ne+1]))}return K===0&&Ce===0?0:Math.abs((Ce-K)/K)},Ll.flatten=function(m){for(var h=m[0][0].length,b={vertices:[],holes:[],dimensions:h},M=0,q=0;q<m.length;q++){for(var K=0;K<m[q].length;K++)for(var J=0;J<h;J++)b.vertices.push(m[q][K][J]);q>0&&b.holes.push(M+=m[q-1].length)}return b};var m0=U(xh.exports);function _f(m,h,b,M,q){yf(m,h,b||0,M||m.length-1,q||Wh)}function yf(m,h,b,M,q){for(;M>b;){if(M-b>600){var K=M-b+1,J=h-b+1,me=Math.log(K),Ce=.5*Math.exp(2*me/3),Ne=.5*Math.sqrt(me*Ce*(K-Ce)/K)*(J-K/2<0?-1:1);yf(m,h,Math.max(b,Math.floor(h-J*Ce/K+Ne)),Math.min(M,Math.floor(h+(K-J)*Ce/K+Ne)),q)}var f=m[h],u=b,p=M;for(kc(m,b,h),q(m[M],f)>0&&kc(m,b,M);u<p;){for(kc(m,u,p),u++,p--;q(m[u],f)<0;)u++;for(;q(m[p],f)>0;)p--}q(m[b],f)===0?kc(m,b,p):kc(m,++p,M),p<=h&&(b=p+1),h<=p&&(M=p-1)}}function kc(m,h,b){var M=m[h];m[h]=m[b],m[b]=M}function Wh(m,h){return m<h?-1:m>h?1:0}function wh(m,h){const b=m.length;if(b<=1)return[m];const M=[];let q,K;for(let J=0;J<b;J++){const me=pt(m[J]);me!==0&&(m[J].area=Math.abs(me),K===void 0&&(K=me<0),K===me<0?(q&&M.push(q),q=[m[J]]):q.push(m[J]))}if(q&&M.push(q),h>1)for(let J=0;J<M.length;J++)M[J].length<=h||(_f(M[J],h,1,M[J].length-1,vf),M[J]=M[J].slice(0,h));return M}function vf(m,h){return h.area-m.area}function vA(m,h,b){const M=b.patternDependencies;let q=!1;for(const K of h){const J=K.paint.get(`${m}-pattern`);J.isConstant()||(q=!0);const me=J.constantOr(null);me&&(q=!0,M[me.to]=!0,M[me.from]=!0)}return q}function xA(m,h,b,M,q){const K=q.patternDependencies;for(const J of h){const me=J.paint.get(`${m}-pattern`).value;if(me.kind!=="constant"){let Ce=me.evaluate({zoom:M-1},b,{},q.availableImages),Ne=me.evaluate({zoom:M},b,{},q.availableImages),f=me.evaluate({zoom:M+1},b,{},q.availableImages);Ce=Ce&&Ce.name?Ce.name:Ce,Ne=Ne&&Ne.name?Ne.name:Ne,f=f&&f.name?f.name:f,K[Ce]=!0,K[Ne]=!0,K[f]=!0,b.patterns[J.id]={min:Ce,mid:Ne,max:f}}}return b}class $h{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(b=>b.id),this.index=h.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Te,this.indexArray=new Kt,this.indexArray2=new ii,this.programConfigurations=new Uo(h.layers,h.zoom),this.segments=new Qi,this.segments2=new Qi,this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id)}populate(h,b,M){this.hasPattern=vA("fill",this.layers,b);const q=this.layers[0].layout.get("fill-sort-key"),K=!q.isConstant(),J=[];for(const{feature:me,id:Ce,index:Ne,sourceLayerIndex:f}of h){const u=this.layers[0]._featureFilter.needGeometry,p=vl(me,u);if(!this.layers[0]._featureFilter.filter(new ms(this.zoom),p,M))continue;const I=K?q.evaluate(p,{},M,b.availableImages):void 0,L={id:Ce,properties:me.properties,type:me.type,sourceLayerIndex:f,index:Ne,geometry:u?p.geometry:il(me),patterns:{},sortKey:I};J.push(L)}K&&J.sort((me,Ce)=>me.sortKey-Ce.sortKey);for(const me of J){const{geometry:Ce,index:Ne,sourceLayerIndex:f}=me;if(this.hasPattern){const u=xA("fill",this.layers,me,this.zoom,b);this.patternFeatures.push(u)}else this.addFeature(me,Ce,Ne,M,{});b.featureIndex.insert(h[Ne].feature,Ce,Ne,f,this.index)}}update(h,b,M){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,b,this.stateDependentLayers,M)}addFeatures(h,b,M){for(const q of this.patternFeatures)this.addFeature(q,q.geometry,q.index,b,M)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,hf),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.indexBuffer2=h.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(h,b,M,q,K){for(const J of wh(b,500)){let me=0;for(const I of J)me+=I.length;const Ce=this.segments.prepareSegment(me,this.layoutVertexArray,this.indexArray),Ne=Ce.vertexLength,f=[],u=[];for(const I of J){if(I.length===0)continue;I!==J[0]&&u.push(f.length/2);const L=this.segments2.prepareSegment(I.length,this.layoutVertexArray,this.indexArray2),G=L.vertexLength;this.layoutVertexArray.emplaceBack(I[0].x,I[0].y),this.indexArray2.emplaceBack(G+I.length-1,G),f.push(I[0].x),f.push(I[0].y);for(let Q=1;Q<I.length;Q++)this.layoutVertexArray.emplaceBack(I[Q].x,I[Q].y),this.indexArray2.emplaceBack(G+Q-1,G+Q),f.push(I[Q].x),f.push(I[Q].y);L.vertexLength+=I.length,L.primitiveLength+=I.length}const p=m0(f,u);for(let I=0;I<p.length;I+=3)this.indexArray.emplaceBack(Ne+p[I],Ne+p[I+1],Ne+p[I+2]);Ce.vertexLength+=me,Ce.primitiveLength+=p.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,M,K,q)}}let Y0,bA;In("FillBucket",$h,{omit:["layers","patternFeatures"]});var Xh={get paint(){return bA=bA||new oa({"fill-antialias":new gn(Xt.paint_fill["fill-antialias"]),"fill-opacity":new Zn(Xt.paint_fill["fill-opacity"]),"fill-color":new Zn(Xt.paint_fill["fill-color"]),"fill-outline-color":new Zn(Xt.paint_fill["fill-outline-color"]),"fill-translate":new gn(Xt.paint_fill["fill-translate"]),"fill-translate-anchor":new gn(Xt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Jn(Xt.paint_fill["fill-pattern"])})},get layout(){return Y0=Y0||new oa({"fill-sort-key":new Zn(Xt.layout_fill["fill-sort-key"])})}};class g0 extends bs{constructor(h){super(h,Xh)}recalculate(h,b){super.recalculate(h,b);const M=this.paint._values["fill-outline-color"];M.value.kind==="constant"&&M.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(h){return new $h(h)}queryRadius(){return of(this.paint.get("fill-translate"))}queryIntersectsFeature(h,b,M,q,K,J,me){return La(Yc(h,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),J.angle,me),q)}isTileClipped(){return!0}}const K0=ws([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),bp=ws([{name:"a_centroid",components:2,type:"Int16"}],4),{members:wA}=K0;var hc={},xf=W,J0=Sh;function Sh(m,h,b,M,q){this.properties={},this.extent=b,this.type=0,this._pbf=m,this._geometry=-1,this._keys=M,this._values=q,m.readFields(th,this,h)}function th(m,h,b){m==1?h.id=b.readVarint():m==2?function(M,q){for(var K=M.readVarint()+M.pos;M.pos<K;){var J=q._keys[M.readVarint()],me=q._values[M.readVarint()];q.properties[J]=me}}(b,h):m==3?h.type=b.readVarint():m==4&&(h._geometry=b.pos)}function wp(m){for(var h,b,M=0,q=0,K=m.length,J=K-1;q<K;J=q++)M+=((b=m[J]).x-(h=m[q]).x)*(h.y+b.y);return M}Sh.types=["Unknown","Point","LineString","Polygon"],Sh.prototype.loadGeometry=function(){var m=this._pbf;m.pos=this._geometry;for(var h,b=m.readVarint()+m.pos,M=1,q=0,K=0,J=0,me=[];m.pos<b;){if(q<=0){var Ce=m.readVarint();M=7&Ce,q=Ce>>3}if(q--,M===1||M===2)K+=m.readSVarint(),J+=m.readSVarint(),M===1&&(h&&me.push(h),h=[]),h.push(new xf(K,J));else{if(M!==7)throw new Error("unknown command "+M);h&&h.push(h[0].clone())}}return h&&me.push(h),me},Sh.prototype.bbox=function(){var m=this._pbf;m.pos=this._geometry;for(var h=m.readVarint()+m.pos,b=1,M=0,q=0,K=0,J=1/0,me=-1/0,Ce=1/0,Ne=-1/0;m.pos<h;){if(M<=0){var f=m.readVarint();b=7&f,M=f>>3}if(M--,b===1||b===2)(q+=m.readSVarint())<J&&(J=q),q>me&&(me=q),(K+=m.readSVarint())<Ce&&(Ce=K),K>Ne&&(Ne=K);else if(b!==7)throw new Error("unknown command "+b)}return[J,Ce,me,Ne]},Sh.prototype.toGeoJSON=function(m,h,b){var M,q,K=this.extent*Math.pow(2,b),J=this.extent*m,me=this.extent*h,Ce=this.loadGeometry(),Ne=Sh.types[this.type];function f(I){for(var L=0;L<I.length;L++){var G=I[L];I[L]=[360*(G.x+J)/K-180,360/Math.PI*Math.atan(Math.exp((180-360*(G.y+me)/K)*Math.PI/180))-90]}}switch(this.type){case 1:var u=[];for(M=0;M<Ce.length;M++)u[M]=Ce[M][0];f(Ce=u);break;case 2:for(M=0;M<Ce.length;M++)f(Ce[M]);break;case 3:for(Ce=function(I){var L=I.length;if(L<=1)return[I];for(var G,Q,re=[],Ae=0;Ae<L;Ae++){var _e=wp(I[Ae]);_e!==0&&(Q===void 0&&(Q=_e<0),Q===_e<0?(G&&re.push(G),G=[I[Ae]]):G.push(I[Ae]))}return G&&re.push(G),re}(Ce),M=0;M<Ce.length;M++)for(q=0;q<Ce[M].length;q++)f(Ce[M][q])}Ce.length===1?Ce=Ce[0]:Ne="Multi"+Ne;var p={type:"Feature",geometry:{type:Ne,coordinates:Ce},properties:this.properties};return"id"in this&&(p.id=this.id),p};var Sp=J0,Ip=ed;function ed(m,h){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=m,this._keys=[],this._values=[],this._features=[],m.readFields(Ih,this,h),this.length=this._features.length}function Ih(m,h,b){m===15?h.version=b.readVarint():m===1?h.name=b.readString():m===5?h.extent=b.readVarint():m===2?h._features.push(b.pos):m===3?h._keys.push(b.readString()):m===4&&h._values.push(function(M){for(var q=null,K=M.readVarint()+M.pos;M.pos<K;){var J=M.readVarint()>>3;q=J===1?M.readString():J===2?M.readFloat():J===3?M.readDouble():J===4?M.readVarint64():J===5?M.readVarint():J===6?M.readSVarint():J===7?M.readBoolean():null}return q}(b))}ed.prototype.feature=function(m){if(m<0||m>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[m];var h=this._pbf.readVarint()+this._pbf.pos;return new Sp(this._pbf,h,this.extent,this._keys,this._values)};var Mm=Ip;function Mc(m,h,b){if(m===3){var M=new Mm(b,b.readVarint()+b.pos);M.length&&(h[M.name]=M)}}hc.VectorTile=function(m,h){this.layers=m.readFields(Mc,{},h)},hc.VectorTileFeature=J0,hc.VectorTileLayer=Ip;const Eh=hc.VectorTileFeature.types,bf=Math.pow(2,13);function Yh(m,h,b,M,q,K,J,me){m.emplaceBack(h,b,2*Math.floor(M*bf)+J,q*bf*2,K*bf*2,Math.round(me))}class SA{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(b=>b.id),this.index=h.index,this.hasPattern=!1,this.layoutVertexArray=new Re,this.centroidVertexArray=new ue,this.indexArray=new Kt,this.programConfigurations=new Uo(h.layers,h.zoom),this.segments=new Qi,this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id)}populate(h,b,M){this.features=[],this.hasPattern=vA("fill-extrusion",this.layers,b);for(const{feature:q,id:K,index:J,sourceLayerIndex:me}of h){const Ce=this.layers[0]._featureFilter.needGeometry,Ne=vl(q,Ce);if(!this.layers[0]._featureFilter.filter(new ms(this.zoom),Ne,M))continue;const f={id:K,sourceLayerIndex:me,index:J,geometry:Ce?Ne.geometry:il(q),properties:q.properties,type:q.type,patterns:{}};this.hasPattern?this.features.push(xA("fill-extrusion",this.layers,f,this.zoom,b)):this.addFeature(f,f.geometry,J,M,{}),b.featureIndex.insert(q,f.geometry,J,me,this.index,!0)}}addFeatures(h,b,M){for(const q of this.features){const{geometry:K}=q;this.addFeature(q,K,q.index,b,M)}}update(h,b,M){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,b,this.stateDependentLayers,M)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,wA),this.centroidVertexBuffer=h.createVertexBuffer(this.centroidVertexArray,bp.members,!0),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(h,b,M,q,K){const J={x:0,y:0,vertexCount:0};for(const me of wh(b,500)){let Ce=0;for(const L of me)Ce+=L.length;let Ne=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const L of me){if(L.length===0||Tr(L))continue;let G=0;for(let Q=0;Q<L.length;Q++){const re=L[Q];if(Q>=1){const Ae=L[Q-1];if(!Kh(re,Ae)){Ne.vertexLength+4>Qi.MAX_VERTEX_ARRAY_LENGTH&&(Ne=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const _e=re.sub(Ae)._perp()._unit(),Le=Ae.dist(re);G+Le>32768&&(G=0),Yh(this.layoutVertexArray,re.x,re.y,_e.x,_e.y,0,0,G),Yh(this.layoutVertexArray,re.x,re.y,_e.x,_e.y,0,1,G),J.x+=2*re.x,J.y+=2*re.y,J.vertexCount+=2,G+=Le,Yh(this.layoutVertexArray,Ae.x,Ae.y,_e.x,_e.y,0,0,G),Yh(this.layoutVertexArray,Ae.x,Ae.y,_e.x,_e.y,0,1,G),J.x+=2*Ae.x,J.y+=2*Ae.y,J.vertexCount+=2;const qe=Ne.vertexLength;this.indexArray.emplaceBack(qe,qe+2,qe+1),this.indexArray.emplaceBack(qe+1,qe+2,qe+3),Ne.vertexLength+=4,Ne.primitiveLength+=2}}}}if(Ne.vertexLength+Ce>Qi.MAX_VERTEX_ARRAY_LENGTH&&(Ne=this.segments.prepareSegment(Ce,this.layoutVertexArray,this.indexArray)),Eh[h.type]!=="Polygon")continue;const f=[],u=[],p=Ne.vertexLength;for(const L of me)if(L.length!==0){L!==me[0]&&u.push(f.length/2);for(let G=0;G<L.length;G++){const Q=L[G];Yh(this.layoutVertexArray,Q.x,Q.y,0,0,1,1,0),J.x+=Q.x,J.y+=Q.y,J.vertexCount+=1,f.push(Q.x),f.push(Q.y)}}const I=m0(f,u);for(let L=0;L<I.length;L+=3)this.indexArray.emplaceBack(p+I[L],p+I[L+2],p+I[L+1]);Ne.primitiveLength+=I.length/3,Ne.vertexLength+=Ce}for(let me=0;me<J.vertexCount;me++)this.centroidVertexArray.emplaceBack(Math.floor(J.x/J.vertexCount),Math.floor(J.y/J.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,M,K,q)}}function Kh(m,h){return m.x===h.x&&(m.x<0||m.x>$s)||m.y===h.y&&(m.y<0||m.y>$s)}function Tr(m){return m.every(h=>h.x<0)||m.every(h=>h.x>$s)||m.every(h=>h.y<0)||m.every(h=>h.y>$s)}let wf;In("FillExtrusionBucket",SA,{omit:["layers","features"]});var td={get paint(){return wf=wf||new oa({"fill-extrusion-opacity":new gn(Xt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Zn(Xt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new gn(Xt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new gn(Xt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Jn(Xt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Zn(Xt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Zn(Xt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new gn(Xt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Jh extends bs{constructor(h){super(h,td)}createBucket(h){return new SA(h)}queryRadius(){return of(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(h,b,M,q,K,J,me,Ce){const Ne=Yc(h,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),J.angle,me),f=this.paint.get("fill-extrusion-height").evaluate(b,M),u=this.paint.get("fill-extrusion-base").evaluate(b,M),p=function(L,G,Q,re){const Ae=[];for(const _e of L){const Le=[_e.x,_e.y,0,1];uf(Le,Le,G),Ae.push(new ae(Le[0]/Le[3],Le[1]/Le[3]))}return Ae}(Ne,Ce),I=function(L,G,Q,re){const Ae=[],_e=[],Le=re[8]*G,qe=re[9]*G,tt=re[10]*G,ft=re[11]*G,gt=re[8]*Q,Mt=re[9]*Q,Pt=re[10]*Q,Lt=re[11]*Q;for(const ei of L){const Ht=[],Qt=[];for(const hi of ei){const _i=hi.x,Xi=hi.y,Sn=re[0]*_i+re[4]*Xi+re[12],ln=re[1]*_i+re[5]*Xi+re[13],on=re[2]*_i+re[6]*Xi+re[14],fn=re[3]*_i+re[7]*Xi+re[15],zn=on+tt,an=fn+ft,$i=Sn+gt,Dn=ln+Mt,Nn=on+Pt,pr=fn+Lt,Vr=new ae((Sn+Le)/an,(ln+qe)/an);Vr.z=zn/an,Ht.push(Vr);const Hr=new ae($i/pr,Dn/pr);Hr.z=Nn/pr,Qt.push(Hr)}Ae.push(Ht),_e.push(Qt)}return[Ae,_e]}(q,u,f,Ce);return function(L,G,Q){let re=1/0;La(Q,G)&&(re=IA(Q,G[0]));for(let Ae=0;Ae<G.length;Ae++){const _e=G[Ae],Le=L[Ae];for(let qe=0;qe<_e.length-1;qe++){const tt=_e[qe],ft=[tt,_e[qe+1],Le[qe+1],Le[qe],tt];af(Q,ft)&&(re=Math.min(re,IA(Q,ft)))}}return re!==1/0&&re}(I[0],I[1],p)}}function Sf(m,h){return m.x*h.x+m.y*h.y}function IA(m,h){if(m.length===1){let b=0;const M=h[b++];let q;for(;!q||M.equals(q);)if(q=h[b++],!q)return 1/0;for(;b<h.length;b++){const K=h[b],J=m[0],me=q.sub(M),Ce=K.sub(M),Ne=J.sub(M),f=Sf(me,me),u=Sf(me,Ce),p=Sf(Ce,Ce),I=Sf(Ne,me),L=Sf(Ne,Ce),G=f*p-u*u,Q=(p*I-u*L)/G,re=(f*L-u*I)/G,Ae=M.z*(1-Q-re)+q.z*Q+K.z*re;if(isFinite(Ae))return Ae}return 1/0}{let b=1/0;for(const M of h)b=Math.min(b,M.z);return b}}const EA=ws([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Ul}=EA,Pm=ws([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Dm}=Pm,id=hc.VectorTileFeature.types,Lm=Math.cos(Math.PI/180*37.5),nd=Math.pow(2,14)/.5;class eA{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(b=>b.id),this.index=h.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(b=>{this.gradients[b.id]={}}),this.layoutVertexArray=new Be,this.layoutVertexArray2=new et,this.indexArray=new Kt,this.programConfigurations=new Uo(h.layers,h.zoom),this.segments=new Qi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id)}populate(h,b,M){this.hasPattern=vA("line",this.layers,b);const q=this.layers[0].layout.get("line-sort-key"),K=!q.isConstant(),J=[];for(const{feature:me,id:Ce,index:Ne,sourceLayerIndex:f}of h){const u=this.layers[0]._featureFilter.needGeometry,p=vl(me,u);if(!this.layers[0]._featureFilter.filter(new ms(this.zoom),p,M))continue;const I=K?q.evaluate(p,{},M):void 0,L={id:Ce,properties:me.properties,type:me.type,sourceLayerIndex:f,index:Ne,geometry:u?p.geometry:il(me),patterns:{},sortKey:I};J.push(L)}K&&J.sort((me,Ce)=>me.sortKey-Ce.sortKey);for(const me of J){const{geometry:Ce,index:Ne,sourceLayerIndex:f}=me;if(this.hasPattern){const u=xA("line",this.layers,me,this.zoom,b);this.patternFeatures.push(u)}else this.addFeature(me,Ce,Ne,M,{});b.featureIndex.insert(h[Ne].feature,Ce,Ne,f,this.index)}}update(h,b,M){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,b,this.stateDependentLayers,M)}addFeatures(h,b,M){for(const q of this.patternFeatures)this.addFeature(q,q.geometry,q.index,b,M)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=h.createVertexBuffer(this.layoutVertexArray2,Dm)),this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,Ul),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(h){if(h.properties&&Object.prototype.hasOwnProperty.call(h.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(h.properties,"mapbox_clip_end"))return{start:+h.properties.mapbox_clip_start,end:+h.properties.mapbox_clip_end}}addFeature(h,b,M,q,K){const J=this.layers[0].layout,me=J.get("line-join").evaluate(h,{}),Ce=J.get("line-cap"),Ne=J.get("line-miter-limit"),f=J.get("line-round-limit");this.lineClips=this.lineFeatureClips(h);for(const u of b)this.addLine(u,h,me,Ce,Ne,f);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,M,K,q)}addLine(h,b,M,q,K,J){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let re=0;re<h.length-1;re++)this.totalDistance+=h[re].dist(h[re+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const me=id[b.type]==="Polygon";let Ce=h.length;for(;Ce>=2&&h[Ce-1].equals(h[Ce-2]);)Ce--;let Ne=0;for(;Ne<Ce-1&&h[Ne].equals(h[Ne+1]);)Ne++;if(Ce<(me?3:2))return;M==="bevel"&&(K=1.05);const f=this.overscaling<=16?15*$s/(512*this.overscaling):0,u=this.segments.prepareSegment(10*Ce,this.layoutVertexArray,this.indexArray);let p,I,L,G,Q;this.e1=this.e2=-1,me&&(p=h[Ce-2],Q=h[Ne].sub(p)._unit()._perp());for(let re=Ne;re<Ce;re++){if(L=re===Ce-1?me?h[Ne+1]:void 0:h[re+1],L&&h[re].equals(L))continue;Q&&(G=Q),p&&(I=p),p=h[re],Q=L?L.sub(p)._unit()._perp():G,G=G||Q;let Ae=G.add(Q);Ae.x===0&&Ae.y===0||Ae._unit();const _e=G.x*Q.x+G.y*Q.y,Le=Ae.x*Q.x+Ae.y*Q.y,qe=Le!==0?1/Le:1/0,tt=2*Math.sqrt(2-2*Le),ft=Le<Lm&&I&&L,gt=G.x*Q.y-G.y*Q.x>0;if(ft&&re>Ne){const Lt=p.dist(I);if(Lt>2*f){const ei=p.sub(p.sub(I)._mult(f/Lt)._round());this.updateDistance(I,ei),this.addCurrentVertex(ei,G,0,0,u),I=ei}}const Mt=I&&L;let Pt=Mt?M:me?"butt":q;if(Mt&&Pt==="round"&&(qe<J?Pt="miter":qe<=2&&(Pt="fakeround")),Pt==="miter"&&qe>K&&(Pt="bevel"),Pt==="bevel"&&(qe>2&&(Pt="flipbevel"),qe<K&&(Pt="miter")),I&&this.updateDistance(I,p),Pt==="miter")Ae._mult(qe),this.addCurrentVertex(p,Ae,0,0,u);else if(Pt==="flipbevel"){if(qe>100)Ae=Q.mult(-1);else{const Lt=qe*G.add(Q).mag()/G.sub(Q).mag();Ae._perp()._mult(Lt*(gt?-1:1))}this.addCurrentVertex(p,Ae,0,0,u),this.addCurrentVertex(p,Ae.mult(-1),0,0,u)}else if(Pt==="bevel"||Pt==="fakeround"){const Lt=-Math.sqrt(qe*qe-1),ei=gt?Lt:0,Ht=gt?0:Lt;if(I&&this.addCurrentVertex(p,G,ei,Ht,u),Pt==="fakeround"){const Qt=Math.round(180*tt/Math.PI/20);for(let hi=1;hi<Qt;hi++){let _i=hi/Qt;if(_i!==.5){const Sn=_i-.5;_i+=_i*Sn*(_i-1)*((1.0904+_e*(_e*(3.55645-1.43519*_e)-3.2452))*Sn*Sn+(.848013+_e*(.215638*_e-1.06021)))}const Xi=Q.sub(G)._mult(_i)._add(G)._unit()._mult(gt?-1:1);this.addHalfVertex(p,Xi.x,Xi.y,!1,gt,0,u)}}L&&this.addCurrentVertex(p,Q,-ei,-Ht,u)}else if(Pt==="butt")this.addCurrentVertex(p,Ae,0,0,u);else if(Pt==="square"){const Lt=I?1:-1;this.addCurrentVertex(p,Ae,Lt,Lt,u)}else Pt==="round"&&(I&&(this.addCurrentVertex(p,G,0,0,u),this.addCurrentVertex(p,G,1,1,u,!0)),L&&(this.addCurrentVertex(p,Q,-1,-1,u,!0),this.addCurrentVertex(p,Q,0,0,u)));if(ft&&re<Ce-1){const Lt=p.dist(L);if(Lt>2*f){const ei=p.add(L.sub(p)._mult(f/Lt)._round());this.updateDistance(p,ei),this.addCurrentVertex(ei,Q,0,0,u),p=ei}}}}addCurrentVertex(h,b,M,q,K,J=!1){const me=b.y*q-b.x,Ce=-b.y-b.x*q;this.addHalfVertex(h,b.x+b.y*M,b.y-b.x*M,J,!1,M,K),this.addHalfVertex(h,me,Ce,J,!0,-q,K),this.distance>nd/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(h,b,M,q,K,J))}addHalfVertex({x:h,y:b},M,q,K,J,me,Ce){const Ne=.5*(this.lineClips?this.scaledDistance*(nd-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((h<<1)+(K?1:0),(b<<1)+(J?1:0),Math.round(63*M)+128,Math.round(63*q)+128,1+(me===0?0:me<0?-1:1)|(63&Ne)<<2,Ne>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const f=Ce.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,f),Ce.primitiveLength++),J?this.e2=f:this.e1=f}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(h,b){this.distance+=h.dist(b),this.updateScaledDistance()}}let rd,Ep;In("LineBucket",eA,{omit:["layers","patternFeatures"]});var Pc={get paint(){return Ep=Ep||new oa({"line-opacity":new Zn(Xt.paint_line["line-opacity"]),"line-color":new Zn(Xt.paint_line["line-color"]),"line-translate":new gn(Xt.paint_line["line-translate"]),"line-translate-anchor":new gn(Xt.paint_line["line-translate-anchor"]),"line-width":new Zn(Xt.paint_line["line-width"]),"line-gap-width":new Zn(Xt.paint_line["line-gap-width"]),"line-offset":new Zn(Xt.paint_line["line-offset"]),"line-blur":new Zn(Xt.paint_line["line-blur"]),"line-dasharray":new tl(Xt.paint_line["line-dasharray"]),"line-pattern":new Jn(Xt.paint_line["line-pattern"]),"line-gradient":new Tu(Xt.paint_line["line-gradient"])})},get layout(){return rd=rd||new oa({"line-cap":new gn(Xt.layout_line["line-cap"]),"line-join":new Zn(Xt.layout_line["line-join"]),"line-miter-limit":new gn(Xt.layout_line["line-miter-limit"]),"line-round-limit":new gn(Xt.layout_line["line-round-limit"]),"line-sort-key":new Zn(Xt.layout_line["line-sort-key"])})}};class bu extends Zn{possiblyEvaluate(h,b){return b=new ms(Math.floor(b.zoom),{now:b.now,fadeDuration:b.fadeDuration,zoomHistory:b.zoomHistory,transition:b.transition}),super.possiblyEvaluate(h,b)}evaluate(h,b,M,q){return b=jt({},b,{zoom:Math.floor(b.zoom)}),super.evaluate(h,b,M,q)}}let CA;class Bm extends bs{constructor(h){super(h,Pc),this.gradientVersion=0,CA||(CA=new bu(Pc.paint.properties["line-width"].specification),CA.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(h){if(h==="line-gradient"){const b=this.gradientExpression();this.stepInterpolant=!!function(M){return M._styleExpression!==void 0}(b)&&b._styleExpression.expression instanceof Qa,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(h,b){super.recalculate(h,b),this.paint._values["line-floorwidth"]=CA.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,h)}createBucket(h){return new eA(h)}queryRadius(h){const b=h,M=_0(qh("line-width",this,b),qh("line-gap-width",this,b)),q=qh("line-offset",this,b);return M/2+Math.abs(q)+of(this.paint.get("line-translate"))}queryIntersectsFeature(h,b,M,q,K,J,me){const Ce=Yc(h,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),J.angle,me),Ne=me/2*_0(this.paint.get("line-width").evaluate(b,M),this.paint.get("line-gap-width").evaluate(b,M)),f=this.paint.get("line-offset").evaluate(b,M);return f&&(q=function(u,p){const I=[];for(let L=0;L<u.length;L++){const G=u[L],Q=[];for(let re=0;re<G.length;re++){const Ae=G[re-1],_e=G[re],Le=G[re+1],qe=re===0?new ae(0,0):_e.sub(Ae)._unit()._perp(),tt=re===G.length-1?new ae(0,0):Le.sub(_e)._unit()._perp(),ft=qe._add(tt)._unit(),gt=ft.x*tt.x+ft.y*tt.y;gt!==0&&ft._mult(1/gt),Q.push(ft._mult(p)._add(_e))}I.push(Q)}return I}(q,f*me)),function(u,p,I){for(let L=0;L<p.length;L++){const G=p[L];if(u.length>=3){for(let Q=0;Q<G.length;Q++)if(Xc(u,G[Q]))return!0}if(pA(u,G,I))return!0}return!1}(Ce,q,Ne)}isTileClipped(){return!0}}function _0(m,h){return h>0?h+2*m:m}const Cp=ws([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),sd=ws([{name:"a_projected_pos",components:3,type:"Float32"}],4);ws([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const TA=ws([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);ws([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const y0=ws([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ad=ws([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function zm(m,h,b){return m.sections.forEach(M=>{M.text=function(q,K,J){const me=K.layout.get("text-transform").evaluate(J,{});return me==="uppercase"?q=q.toLocaleUpperCase():me==="lowercase"&&(q=q.toLocaleLowerCase()),Xl.applyArabicShaping&&(q=Xl.applyArabicShaping(q)),q}(M.text,h,b)}),m}ws([{name:"triangle",components:3,type:"Uint16"}]),ws([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ws([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),ws([{type:"Float32",name:"offsetX"}]),ws([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),ws([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Ch={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Al=24,od=da,ld=function(m,h,b,M,q){var K,J,me=8*q-M-1,Ce=(1<<me)-1,Ne=Ce>>1,f=-7,u=b?q-1:0,p=b?-1:1,I=m[h+u];for(u+=p,K=I&(1<<-f)-1,I>>=-f,f+=me;f>0;K=256*K+m[h+u],u+=p,f-=8);for(J=K&(1<<-f)-1,K>>=-f,f+=M;f>0;J=256*J+m[h+u],u+=p,f-=8);if(K===0)K=1-Ne;else{if(K===Ce)return J?NaN:1/0*(I?-1:1);J+=Math.pow(2,M),K-=Ne}return(I?-1:1)*J*Math.pow(2,K-M)},ud=function(m,h,b,M,q,K){var J,me,Ce,Ne=8*K-q-1,f=(1<<Ne)-1,u=f>>1,p=q===23?Math.pow(2,-24)-Math.pow(2,-77):0,I=M?0:K-1,L=M?1:-1,G=h<0||h===0&&1/h<0?1:0;for(h=Math.abs(h),isNaN(h)||h===1/0?(me=isNaN(h)?1:0,J=f):(J=Math.floor(Math.log(h)/Math.LN2),h*(Ce=Math.pow(2,-J))<1&&(J--,Ce*=2),(h+=J+u>=1?p/Ce:p*Math.pow(2,1-u))*Ce>=2&&(J++,Ce/=2),J+u>=f?(me=0,J=f):J+u>=1?(me=(h*Ce-1)*Math.pow(2,q),J+=u):(me=h*Math.pow(2,u-1)*Math.pow(2,q),J=0));q>=8;m[b+I]=255&me,I+=L,me/=256,q-=8);for(J=J<<q|me,Ne+=q;Ne>0;m[b+I]=255&J,I+=L,J/=256,Ne-=8);m[b+I-L]|=128*G};function da(m){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(m)?m:new Uint8Array(m||0),this.pos=0,this.type=0,this.length=this.buf.length}da.Varint=0,da.Fixed64=1,da.Bytes=2,da.Fixed32=5;var kA=4294967296,cd=1/kA,MA=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function wu(m){return m.type===da.Bytes?m.readVarint()+m.pos:m.pos+1}function eo(m,h,b){return b?4294967296*h+(m>>>0):4294967296*(h>>>0)+(m>>>0)}function v0(m,h,b){var M=h<=16383?1:h<=2097151?2:h<=268435455?3:Math.floor(Math.log(h)/(7*Math.LN2));b.realloc(M);for(var q=b.pos-1;q>=m;q--)b.buf[q+M]=b.buf[q]}function If(m,h){for(var b=0;b<m.length;b++)h.writeVarint(m[b])}function hd(m,h){for(var b=0;b<m.length;b++)h.writeSVarint(m[b])}function ys(m,h){for(var b=0;b<m.length;b++)h.writeFloat(m[b])}function ih(m,h){for(var b=0;b<m.length;b++)h.writeDouble(m[b])}function Tp(m,h){for(var b=0;b<m.length;b++)h.writeBoolean(m[b])}function Ad(m,h){for(var b=0;b<m.length;b++)h.writeFixed32(m[b])}function nh(m,h){for(var b=0;b<m.length;b++)h.writeSFixed32(m[b])}function PA(m,h){for(var b=0;b<m.length;b++)h.writeFixed64(m[b])}function kp(m,h){for(var b=0;b<m.length;b++)h.writeSFixed64(m[b])}function x0(m,h){return(m[h]|m[h+1]<<8|m[h+2]<<16)+16777216*m[h+3]}function DA(m,h,b){m[b]=h,m[b+1]=h>>>8,m[b+2]=h>>>16,m[b+3]=h>>>24}function Mp(m,h){return(m[h]|m[h+1]<<8|m[h+2]<<16)+(m[h+3]<<24)}da.prototype={destroy:function(){this.buf=null},readFields:function(m,h,b){for(b=b||this.length;this.pos<b;){var M=this.readVarint(),q=M>>3,K=this.pos;this.type=7&M,m(q,h,this),this.pos===K&&this.skip(M)}return h},readMessage:function(m,h){return this.readFields(m,h,this.readVarint()+this.pos)},readFixed32:function(){var m=x0(this.buf,this.pos);return this.pos+=4,m},readSFixed32:function(){var m=Mp(this.buf,this.pos);return this.pos+=4,m},readFixed64:function(){var m=x0(this.buf,this.pos)+x0(this.buf,this.pos+4)*kA;return this.pos+=8,m},readSFixed64:function(){var m=x0(this.buf,this.pos)+Mp(this.buf,this.pos+4)*kA;return this.pos+=8,m},readFloat:function(){var m=ld(this.buf,this.pos,!0,23,4);return this.pos+=4,m},readDouble:function(){var m=ld(this.buf,this.pos,!0,52,8);return this.pos+=8,m},readVarint:function(m){var h,b,M=this.buf;return h=127&(b=M[this.pos++]),b<128?h:(h|=(127&(b=M[this.pos++]))<<7,b<128?h:(h|=(127&(b=M[this.pos++]))<<14,b<128?h:(h|=(127&(b=M[this.pos++]))<<21,b<128?h:function(q,K,J){var me,Ce,Ne=J.buf;if(me=(112&(Ce=Ne[J.pos++]))>>4,Ce<128||(me|=(127&(Ce=Ne[J.pos++]))<<3,Ce<128)||(me|=(127&(Ce=Ne[J.pos++]))<<10,Ce<128)||(me|=(127&(Ce=Ne[J.pos++]))<<17,Ce<128)||(me|=(127&(Ce=Ne[J.pos++]))<<24,Ce<128)||(me|=(1&(Ce=Ne[J.pos++]))<<31,Ce<128))return eo(q,me,K);throw new Error("Expected varint not more than 10 bytes")}(h|=(15&(b=M[this.pos]))<<28,m,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var m=this.readVarint();return m%2==1?(m+1)/-2:m/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var m=this.readVarint()+this.pos,h=this.pos;return this.pos=m,m-h>=12&&MA?function(b,M,q){return MA.decode(b.subarray(M,q))}(this.buf,h,m):function(b,M,q){for(var K="",J=M;J<q;){var me,Ce,Ne,f=b[J],u=null,p=f>239?4:f>223?3:f>191?2:1;if(J+p>q)break;p===1?f<128&&(u=f):p===2?(192&(me=b[J+1]))==128&&(u=(31&f)<<6|63&me)<=127&&(u=null):p===3?(Ce=b[J+2],(192&(me=b[J+1]))==128&&(192&Ce)==128&&((u=(15&f)<<12|(63&me)<<6|63&Ce)<=2047||u>=55296&&u<=57343)&&(u=null)):p===4&&(Ce=b[J+2],Ne=b[J+3],(192&(me=b[J+1]))==128&&(192&Ce)==128&&(192&Ne)==128&&((u=(15&f)<<18|(63&me)<<12|(63&Ce)<<6|63&Ne)<=65535||u>=1114112)&&(u=null)),u===null?(u=65533,p=1):u>65535&&(u-=65536,K+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),K+=String.fromCharCode(u),J+=p}return K}(this.buf,h,m)},readBytes:function(){var m=this.readVarint()+this.pos,h=this.buf.subarray(this.pos,m);return this.pos=m,h},readPackedVarint:function(m,h){if(this.type!==da.Bytes)return m.push(this.readVarint(h));var b=wu(this);for(m=m||[];this.pos<b;)m.push(this.readVarint(h));return m},readPackedSVarint:function(m){if(this.type!==da.Bytes)return m.push(this.readSVarint());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readSVarint());return m},readPackedBoolean:function(m){if(this.type!==da.Bytes)return m.push(this.readBoolean());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readBoolean());return m},readPackedFloat:function(m){if(this.type!==da.Bytes)return m.push(this.readFloat());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readFloat());return m},readPackedDouble:function(m){if(this.type!==da.Bytes)return m.push(this.readDouble());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readDouble());return m},readPackedFixed32:function(m){if(this.type!==da.Bytes)return m.push(this.readFixed32());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readFixed32());return m},readPackedSFixed32:function(m){if(this.type!==da.Bytes)return m.push(this.readSFixed32());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readSFixed32());return m},readPackedFixed64:function(m){if(this.type!==da.Bytes)return m.push(this.readFixed64());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readFixed64());return m},readPackedSFixed64:function(m){if(this.type!==da.Bytes)return m.push(this.readSFixed64());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readSFixed64());return m},skip:function(m){var h=7&m;if(h===da.Varint)for(;this.buf[this.pos++]>127;);else if(h===da.Bytes)this.pos=this.readVarint()+this.pos;else if(h===da.Fixed32)this.pos+=4;else{if(h!==da.Fixed64)throw new Error("Unimplemented type: "+h);this.pos+=8}},writeTag:function(m,h){this.writeVarint(m<<3|h)},realloc:function(m){for(var h=this.length||16;h<this.pos+m;)h*=2;if(h!==this.length){var b=new Uint8Array(h);b.set(this.buf),this.buf=b,this.length=h}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(m){this.realloc(4),DA(this.buf,m,this.pos),this.pos+=4},writeSFixed32:function(m){this.realloc(4),DA(this.buf,m,this.pos),this.pos+=4},writeFixed64:function(m){this.realloc(8),DA(this.buf,-1&m,this.pos),DA(this.buf,Math.floor(m*cd),this.pos+4),this.pos+=8},writeSFixed64:function(m){this.realloc(8),DA(this.buf,-1&m,this.pos),DA(this.buf,Math.floor(m*cd),this.pos+4),this.pos+=8},writeVarint:function(m){(m=+m||0)>268435455||m<0?function(h,b){var M,q;if(h>=0?(M=h%4294967296|0,q=h/4294967296|0):(q=~(-h/4294967296),4294967295^(M=~(-h%4294967296))?M=M+1|0:(M=0,q=q+1|0)),h>=18446744073709552e3||h<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");b.realloc(10),function(K,J,me){me.buf[me.pos++]=127&K|128,K>>>=7,me.buf[me.pos++]=127&K|128,K>>>=7,me.buf[me.pos++]=127&K|128,K>>>=7,me.buf[me.pos++]=127&K|128,me.buf[me.pos]=127&(K>>>=7)}(M,0,b),function(K,J){var me=(7&K)<<4;J.buf[J.pos++]|=me|((K>>>=3)?128:0),K&&(J.buf[J.pos++]=127&K|((K>>>=7)?128:0),K&&(J.buf[J.pos++]=127&K|((K>>>=7)?128:0),K&&(J.buf[J.pos++]=127&K|((K>>>=7)?128:0),K&&(J.buf[J.pos++]=127&K|((K>>>=7)?128:0),K&&(J.buf[J.pos++]=127&K)))))}(q,b)}(m,this):(this.realloc(4),this.buf[this.pos++]=127&m|(m>127?128:0),m<=127||(this.buf[this.pos++]=127&(m>>>=7)|(m>127?128:0),m<=127||(this.buf[this.pos++]=127&(m>>>=7)|(m>127?128:0),m<=127||(this.buf[this.pos++]=m>>>7&127))))},writeSVarint:function(m){this.writeVarint(m<0?2*-m-1:2*m)},writeBoolean:function(m){this.writeVarint(!!m)},writeString:function(m){m=String(m),this.realloc(4*m.length),this.pos++;var h=this.pos;this.pos=function(M,q,K){for(var J,me,Ce=0;Ce<q.length;Ce++){if((J=q.charCodeAt(Ce))>55295&&J<57344){if(!me){J>56319||Ce+1===q.length?(M[K++]=239,M[K++]=191,M[K++]=189):me=J;continue}if(J<56320){M[K++]=239,M[K++]=191,M[K++]=189,me=J;continue}J=me-55296<<10|J-56320|65536,me=null}else me&&(M[K++]=239,M[K++]=191,M[K++]=189,me=null);J<128?M[K++]=J:(J<2048?M[K++]=J>>6|192:(J<65536?M[K++]=J>>12|224:(M[K++]=J>>18|240,M[K++]=J>>12&63|128),M[K++]=J>>6&63|128),M[K++]=63&J|128)}return K}(this.buf,m,this.pos);var b=this.pos-h;b>=128&&v0(h,b,this),this.pos=h-1,this.writeVarint(b),this.pos+=b},writeFloat:function(m){this.realloc(4),ud(this.buf,m,this.pos,!0,23,4),this.pos+=4},writeDouble:function(m){this.realloc(8),ud(this.buf,m,this.pos,!0,52,8),this.pos+=8},writeBytes:function(m){var h=m.length;this.writeVarint(h),this.realloc(h);for(var b=0;b<h;b++)this.buf[this.pos++]=m[b]},writeRawMessage:function(m,h){this.pos++;var b=this.pos;m(h,this);var M=this.pos-b;M>=128&&v0(b,M,this),this.pos=b-1,this.writeVarint(M),this.pos+=M},writeMessage:function(m,h,b){this.writeTag(m,da.Bytes),this.writeRawMessage(h,b)},writePackedVarint:function(m,h){h.length&&this.writeMessage(m,If,h)},writePackedSVarint:function(m,h){h.length&&this.writeMessage(m,hd,h)},writePackedBoolean:function(m,h){h.length&&this.writeMessage(m,Tp,h)},writePackedFloat:function(m,h){h.length&&this.writeMessage(m,ys,h)},writePackedDouble:function(m,h){h.length&&this.writeMessage(m,ih,h)},writePackedFixed32:function(m,h){h.length&&this.writeMessage(m,Ad,h)},writePackedSFixed32:function(m,h){h.length&&this.writeMessage(m,nh,h)},writePackedFixed64:function(m,h){h.length&&this.writeMessage(m,PA,h)},writePackedSFixed64:function(m,h){h.length&&this.writeMessage(m,kp,h)},writeBytesField:function(m,h){this.writeTag(m,da.Bytes),this.writeBytes(h)},writeFixed32Field:function(m,h){this.writeTag(m,da.Fixed32),this.writeFixed32(h)},writeSFixed32Field:function(m,h){this.writeTag(m,da.Fixed32),this.writeSFixed32(h)},writeFixed64Field:function(m,h){this.writeTag(m,da.Fixed64),this.writeFixed64(h)},writeSFixed64Field:function(m,h){this.writeTag(m,da.Fixed64),this.writeSFixed64(h)},writeVarintField:function(m,h){this.writeTag(m,da.Varint),this.writeVarint(h)},writeSVarintField:function(m,h){this.writeTag(m,da.Varint),this.writeSVarint(h)},writeStringField:function(m,h){this.writeTag(m,da.Bytes),this.writeString(h)},writeFloatField:function(m,h){this.writeTag(m,da.Fixed32),this.writeFloat(h)},writeDoubleField:function(m,h){this.writeTag(m,da.Fixed64),this.writeDouble(h)},writeBooleanField:function(m,h){this.writeVarintField(m,!!h)}};var fd=U(od);const dd=3;function Rm(m,h,b){m===1&&b.readMessage(Fm,h)}function Fm(m,h,b){if(m===3){const{id:M,bitmap:q,width:K,height:J,left:me,top:Ce,advance:Ne}=b.readMessage(Om,{});h.push({id:M,bitmap:new Dl({width:K+2*dd,height:J+2*dd},q),metrics:{width:K,height:J,left:me,top:Ce,advance:Ne}})}}function Om(m,h,b){m===1?h.id=b.readVarint():m===2?h.bitmap=b.readBytes():m===3?h.width=b.readVarint():m===4?h.height=b.readVarint():m===5?h.left=b.readSVarint():m===6?h.top=b.readSVarint():m===7&&(h.advance=b.readVarint())}const pd=dd;function LA(m){let h=0,b=0;for(const J of m)h+=J.w*J.h,b=Math.max(b,J.w);m.sort((J,me)=>me.h-J.h);const M=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(h/.95)),b),h:1/0}];let q=0,K=0;for(const J of m)for(let me=M.length-1;me>=0;me--){const Ce=M[me];if(!(J.w>Ce.w||J.h>Ce.h)){if(J.x=Ce.x,J.y=Ce.y,K=Math.max(K,J.y+J.h),q=Math.max(q,J.x+J.w),J.w===Ce.w&&J.h===Ce.h){const Ne=M.pop();me<M.length&&(M[me]=Ne)}else J.h===Ce.h?(Ce.x+=J.w,Ce.w-=J.w):J.w===Ce.w?(Ce.y+=J.h,Ce.h-=J.h):(M.push({x:Ce.x+J.w,y:Ce.y,w:Ce.w-J.w,h:J.h}),Ce.y+=J.h,Ce.h-=J.h);break}}return{w:q,h:K,fill:h/(q*K)||0}}const fl=1;class b0{constructor(h,{pixelRatio:b,version:M,stretchX:q,stretchY:K,content:J}){this.paddedRect=h,this.pixelRatio=b,this.stretchX=q,this.stretchY=K,this.content=J,this.version=M}get tl(){return[this.paddedRect.x+fl,this.paddedRect.y+fl]}get br(){return[this.paddedRect.x+this.paddedRect.w-fl,this.paddedRect.y+this.paddedRect.h-fl]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*fl)/this.pixelRatio,(this.paddedRect.h-2*fl)/this.pixelRatio]}}class w0{constructor(h,b){const M={},q={};this.haveRenderCallbacks=[];const K=[];this.addImages(h,M,K),this.addImages(b,q,K);const{w:J,h:me}=LA(K),Ce=new Uu({width:J||1,height:me||1});for(const Ne in h){const f=h[Ne],u=M[Ne].paddedRect;Uu.copy(f.data,Ce,{x:0,y:0},{x:u.x+fl,y:u.y+fl},f.data)}for(const Ne in b){const f=b[Ne],u=q[Ne].paddedRect,p=u.x+fl,I=u.y+fl,L=f.data.width,G=f.data.height;Uu.copy(f.data,Ce,{x:0,y:0},{x:p,y:I},f.data),Uu.copy(f.data,Ce,{x:0,y:G-1},{x:p,y:I-1},{width:L,height:1}),Uu.copy(f.data,Ce,{x:0,y:0},{x:p,y:I+G},{width:L,height:1}),Uu.copy(f.data,Ce,{x:L-1,y:0},{x:p-1,y:I},{width:1,height:G}),Uu.copy(f.data,Ce,{x:0,y:0},{x:p+L,y:I},{width:1,height:G})}this.image=Ce,this.iconPositions=M,this.patternPositions=q}addImages(h,b,M){for(const q in h){const K=h[q],J={x:0,y:0,w:K.data.width+2*fl,h:K.data.height+2*fl};M.push(J),b[q]=new b0(J,K),K.hasRenderCallback&&this.haveRenderCallbacks.push(q)}}patchUpdatedImages(h,b){h.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const M in h.updatedImages)this.patchUpdatedImage(this.iconPositions[M],h.getImage(M),b),this.patchUpdatedImage(this.patternPositions[M],h.getImage(M),b)}patchUpdatedImage(h,b,M){if(!h||!b||h.version===b.version)return;h.version=b.version;const[q,K]=h.tl;M.update(b.data,void 0,{x:q,y:K})}}var Dc;In("ImagePosition",b0),In("ImageAtlas",w0),S.ah=void 0,(Dc=S.ah||(S.ah={}))[Dc.none=0]="none",Dc[Dc.horizontal=1]="horizontal",Dc[Dc.vertical=2]="vertical",Dc[Dc.horizontalOnly=3]="horizontalOnly";const BA=-17;class Ef{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(h,b){const M=new Ef;return M.scale=h||1,M.fontStack=b,M}static forImage(h){const b=new Ef;return b.imageName=h,b}}class zA{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(h,b){const M=new zA;for(let q=0;q<h.sections.length;q++){const K=h.sections[q];K.image?M.addImageSection(K):M.addTextSection(K,b)}return M}length(){return this.text.length}getSection(h){return this.sections[this.sectionIndex[h]]}getSectionIndex(h){return this.sectionIndex[h]}getCharCode(h){return this.text.charCodeAt(h)}verticalizePunctuation(){this.text=function(h){let b="";for(let M=0;M<h.length;M++){const q=h.charCodeAt(M+1)||null,K=h.charCodeAt(M-1)||null;b+=q&&yl(q)&&!Ch[h[M+1]]||K&&yl(K)&&!Ch[h[M-1]]||!Ch[h[M]]?h[M]:Ch[h[M]]}return b}(this.text)}trim(){let h=0;for(let M=0;M<this.text.length&&Tf[this.text.charCodeAt(M)];M++)h++;let b=this.text.length;for(let M=this.text.length-1;M>=0&&M>=h&&Tf[this.text.charCodeAt(M)];M--)b--;this.text=this.text.substring(h,b),this.sectionIndex=this.sectionIndex.slice(h,b)}substring(h,b){const M=new zA;return M.text=this.text.substring(h,b),M.sectionIndex=this.sectionIndex.slice(h,b),M.sections=this.sections,M}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((h,b)=>Math.max(h,this.sections[b].scale),0)}addTextSection(h,b){this.text+=h.text,this.sections.push(Ef.forText(h.scale,h.fontStack||b));const M=this.sections.length-1;for(let q=0;q<h.text.length;++q)this.sectionIndex.push(M)}addImageSection(h){const b=h.image?h.image.name:"";if(b.length===0)return void lt("Can't add FormattedSection with an empty image.");const M=this.getNextImageSectionCharCode();M?(this.text+=String.fromCharCode(M),this.sections.push(Ef.forImage(b)),this.sectionIndex.push(this.sections.length-1)):lt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Cf(m,h,b,M,q,K,J,me,Ce,Ne,f,u,p,I,L,G){const Q=zA.fromFeature(m,q);let re;u===S.ah.vertical&&Q.verticalizePunctuation();const{processBidirectionalText:Ae,processStyledBidirectionalText:_e}=Xl;if(Ae&&Q.sections.length===1){re=[];const tt=Ae(Q.toString(),rh(Q,Ne,K,h,M,I,L));for(const ft of tt){const gt=new zA;gt.text=ft,gt.sections=Q.sections;for(let Mt=0;Mt<ft.length;Mt++)gt.sectionIndex.push(0);re.push(gt)}}else if(_e){re=[];const tt=_e(Q.text,Q.sectionIndex,rh(Q,Ne,K,h,M,I,L));for(const ft of tt){const gt=new zA;gt.text=ft[0],gt.sectionIndex=ft[1],gt.sections=Q.sections,re.push(gt)}}else re=function(tt,ft){const gt=[],Mt=tt.text;let Pt=0;for(const Lt of ft)gt.push(tt.substring(Pt,Lt)),Pt=Lt;return Pt<Mt.length&&gt.push(tt.substring(Pt,Mt.length)),gt}(Q,rh(Q,Ne,K,h,M,I,L));const Le=[],qe={positionedLines:Le,text:Q.toString(),top:f[1],bottom:f[1],left:f[0],right:f[0],writingMode:u,iconsInText:!1,verticalizable:!1};return function(tt,ft,gt,Mt,Pt,Lt,ei,Ht,Qt,hi,_i,Xi){let Sn=0,ln=BA,on=0,fn=0;const zn=Ht==="right"?1:Ht==="left"?0:.5;let an=0;for(const Vr of Pt){Vr.trim();const Hr=Vr.getMaxScale(),Rs=(Hr-1)*Al,Ta={positionedGlyphs:[],lineOffset:0};tt.positionedLines[an]=Ta;const ia=Ta.positionedGlyphs;let as=0;if(!Vr.length()){ln+=Lt,++an;continue}for(let Is=0;Is<Vr.length();Is++){const tr=Vr.getSection(Is),na=Vr.getSectionIndex(Is),Ls=Vr.getCharCode(Is);let Kn=0,za=null,to=null,va=null,qo=Al;const uo=!(Qt===S.ah.horizontal||!_i&&!Vl(Ls)||_i&&(Tf[Ls]||($i=Ls,Cn.Arabic($i)||Cn["Arabic Supplement"]($i)||Cn["Arabic Extended-A"]($i)||Cn["Arabic Presentation Forms-A"]($i)||Cn["Arabic Presentation Forms-B"]($i))));if(tr.imageName){const ra=Mt[tr.imageName];if(!ra)continue;va=tr.imageName,tt.iconsInText=tt.iconsInText||!0,to=ra.paddedRect;const wr=ra.displaySize;tr.scale=tr.scale*Al/Xi,za={width:wr[0],height:wr[1],left:fl,top:-pd,advance:uo?wr[1]:wr[0]},Kn=Rs+(Al-wr[1]*tr.scale),qo=za.advance;const wo=uo?wr[0]*tr.scale-Al*Hr:wr[1]*tr.scale-Al*Hr;wo>0&&wo>as&&(as=wo)}else{const ra=gt[tr.fontStack],wr=ra&&ra[Ls];if(wr&&wr.rect)to=wr.rect,za=wr.metrics;else{const wo=ft[tr.fontStack],nl=wo&&wo[Ls];if(!nl)continue;za=nl.metrics}Kn=(Hr-tr.scale)*Al}uo?(tt.verticalizable=!0,ia.push({glyph:Ls,imageName:va,x:Sn,y:ln+Kn,vertical:uo,scale:tr.scale,fontStack:tr.fontStack,sectionIndex:na,metrics:za,rect:to}),Sn+=qo*tr.scale+hi):(ia.push({glyph:Ls,imageName:va,x:Sn,y:ln+Kn,vertical:uo,scale:tr.scale,fontStack:tr.fontStack,sectionIndex:na,metrics:za,rect:to}),Sn+=za.advance*tr.scale+hi)}ia.length!==0&&(on=Math.max(Sn-hi,on),I0(ia,0,ia.length-1,zn,as)),Sn=0;const Wn=Lt*Hr+as;Ta.lineOffset=Math.max(as,Rs),ln+=Wn,fn=Math.max(Wn,fn),++an}var $i;const Dn=ln-BA,{horizontalAlign:Nn,verticalAlign:pr}=OA(ei);(function(Vr,Hr,Rs,Ta,ia,as,Wn,Is,tr){const na=(Hr-Rs)*ia;let Ls=0;Ls=as!==Wn?-Is*Ta-BA:(-Ta*tr+.5)*Wn;for(const Kn of Vr)for(const za of Kn.positionedGlyphs)za.x+=na,za.y+=Ls})(tt.positionedLines,zn,Nn,pr,on,fn,Lt,Dn,Pt.length),tt.top+=-pr*Dn,tt.bottom=tt.top+Dn,tt.left+=-Nn*on,tt.right=tt.left+on}(qe,h,b,M,re,J,me,Ce,u,Ne,p,G),!function(tt){for(const ft of tt)if(ft.positionedGlyphs.length!==0)return!1;return!0}(Le)&&qe}const Tf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Su={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function S0(m,h,b,M,q,K){if(h.imageName){const J=M[h.imageName];return J?J.displaySize[0]*h.scale*Al/K+q:0}{const J=b[h.fontStack],me=J&&J[m];return me?me.metrics.advance*h.scale+q:0}}function ku(m,h,b,M){const q=Math.pow(m-h,2);return M?m<h?q/2:2*q:q+Math.abs(b)*b}function Th(m,h,b){let M=0;return m===10&&(M-=1e4),b&&(M+=150),m!==40&&m!==65288||(M+=50),h!==41&&h!==65289||(M+=50),M}function RA(m,h,b,M,q,K){let J=null,me=ku(h,b,q,K);for(const Ce of M){const Ne=ku(h-Ce.x,b,q,K)+Ce.badness;Ne<=me&&(J=Ce,me=Ne)}return{index:m,x:h,priorBreak:J,badness:me}}function FA(m){return m?FA(m.priorBreak).concat(m.index):[]}function rh(m,h,b,M,q,K,J){if(K!=="point")return[];if(!m)return[];const me=[],Ce=function(p,I,L,G,Q,re){let Ae=0;for(let _e=0;_e<p.length();_e++){const Le=p.getSection(_e);Ae+=S0(p.getCharCode(_e),Le,G,Q,I,re)}return Ae/Math.max(1,Math.ceil(Ae/L))}(m,h,b,M,q,J),Ne=m.text.indexOf("")>=0;let f=0;for(let p=0;p<m.length();p++){const I=m.getSection(p),L=m.getCharCode(p);if(Tf[L]||(f+=S0(L,I,M,q,h,J)),p<m.length()-1){const G=!((u=L)<11904||!(Cn["Bopomofo Extended"](u)||Cn.Bopomofo(u)||Cn["CJK Compatibility Forms"](u)||Cn["CJK Compatibility Ideographs"](u)||Cn["CJK Compatibility"](u)||Cn["CJK Radicals Supplement"](u)||Cn["CJK Strokes"](u)||Cn["CJK Symbols and Punctuation"](u)||Cn["CJK Unified Ideographs Extension A"](u)||Cn["CJK Unified Ideographs"](u)||Cn["Enclosed CJK Letters and Months"](u)||Cn["Halfwidth and Fullwidth Forms"](u)||Cn.Hiragana(u)||Cn["Ideographic Description Characters"](u)||Cn["Kangxi Radicals"](u)||Cn["Katakana Phonetic Extensions"](u)||Cn.Katakana(u)||Cn["Vertical Forms"](u)||Cn["Yi Radicals"](u)||Cn["Yi Syllables"](u)));(Su[L]||G||I.imageName)&&me.push(RA(p+1,f,Ce,me,Th(L,m.getCharCode(p+1),G&&Ne),!1))}}var u;return FA(RA(m.length(),f,Ce,me,0,!0))}function OA(m){let h=.5,b=.5;switch(m){case"right":case"top-right":case"bottom-right":h=1;break;case"left":case"top-left":case"bottom-left":h=0}switch(m){case"bottom":case"bottom-right":case"bottom-left":b=1;break;case"top":case"top-right":case"top-left":b=0}return{horizontalAlign:h,verticalAlign:b}}function I0(m,h,b,M,q){if(!M&&!q)return;const K=m[b],J=(m[b].x+K.metrics.advance*K.scale)*M;for(let me=h;me<=b;me++)m[me].x-=J,m[me].y+=q}function Nm(m,h,b){const{horizontalAlign:M,verticalAlign:q}=OA(b),K=h[0]-m.displaySize[0]*M,J=h[1]-m.displaySize[1]*q;return{image:m,top:J,bottom:J+m.displaySize[1],left:K,right:K+m.displaySize[0]}}function md(m,h,b,M,q,K){const J=m.image;let me;if(J.content){const Q=J.content,re=J.pixelRatio||1;me=[Q[0]/re,Q[1]/re,J.displaySize[0]-Q[2]/re,J.displaySize[1]-Q[3]/re]}const Ce=h.left*K,Ne=h.right*K;let f,u,p,I;b==="width"||b==="both"?(I=q[0]+Ce-M[3],u=q[0]+Ne+M[1]):(I=q[0]+(Ce+Ne-J.displaySize[0])/2,u=I+J.displaySize[0]);const L=h.top*K,G=h.bottom*K;return b==="height"||b==="both"?(f=q[1]+L-M[0],p=q[1]+G+M[2]):(f=q[1]+(L+G-J.displaySize[1])/2,p=f+J.displaySize[1]),{image:J,top:f,right:u,bottom:p,left:I,collisionPadding:me}}const kh=255,Lc=128,sh=kh*Lc;function gd(m,h){const{expression:b}=h;if(b.kind==="constant")return{kind:"constant",layoutSize:b.evaluate(new ms(m+1))};if(b.kind==="source")return{kind:"source"};{const{zoomStops:M,interpolationType:q}=b;let K=0;for(;K<M.length&&M[K]<=m;)K++;K=Math.max(0,K-1);let J=K;for(;J<M.length&&M[J]<m+1;)J++;J=Math.min(M.length-1,J);const me=M[K],Ce=M[J];return b.kind==="composite"?{kind:"composite",minZoom:me,maxZoom:Ce,interpolationType:q}:{kind:"camera",minZoom:me,maxZoom:Ce,minSize:b.evaluate(new ms(me)),maxSize:b.evaluate(new ms(Ce)),interpolationType:q}}}function kf(m,h,b){let M="never";const q=m.get(h);return q?M=q:m.get(b)&&(M="always"),M}const _d=hc.VectorTileFeature.types,Vm=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function E0(m,h,b,M,q,K,J,me,Ce,Ne,f,u,p){const I=me?Math.min(sh,Math.round(me[0])):0,L=me?Math.min(sh,Math.round(me[1])):0;m.emplaceBack(h,b,Math.round(32*M),Math.round(32*q),K,J,(I<<1)+(Ce?1:0),L,16*Ne,16*f,256*u,256*p)}function C0(m,h,b){m.emplaceBack(h.x,h.y,b),m.emplaceBack(h.x,h.y,b),m.emplaceBack(h.x,h.y,b),m.emplaceBack(h.x,h.y,b)}function Mf(m){for(const h of m.sections)if(Xu(h.text))return!0;return!1}class Ku{constructor(h){this.layoutVertexArray=new ot,this.indexArray=new Kt,this.programConfigurations=h,this.segments=new Qi,this.dynamicLayoutVertexArray=new ht,this.opacityVertexArray=new Et,this.hasVisibleVertices=!1,this.placedSymbolArray=new r}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(h,b,M,q){this.isEmpty()||(M&&(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,Cp.members),this.indexBuffer=h.createIndexBuffer(this.indexArray,b),this.dynamicLayoutVertexBuffer=h.createVertexBuffer(this.dynamicLayoutVertexArray,sd.members,!0),this.opacityVertexBuffer=h.createVertexBuffer(this.opacityVertexArray,Vm,!0),this.opacityVertexBuffer.itemSize=1),(M||q)&&this.programConfigurations.upload(h))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}In("SymbolBuffers",Ku);class Bc{constructor(h,b,M){this.layoutVertexArray=new h,this.layoutAttributes=b,this.indexArray=new M,this.segments=new Qi,this.collisionVertexArray=new si}upload(h){this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=h.createVertexBuffer(this.collisionVertexArray,TA.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}In("CollisionBuffers",Bc);class tA{constructor(h){this.collisionBoxArray=h.collisionBoxArray,this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(J=>J.id),this.index=h.index,this.pixelRatio=h.pixelRatio,this.sourceLayerIndex=h.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Z0([]),this.placementViewportMatrix=Z0([]);const b=this.layers[0]._unevaluatedLayout._values;this.textSizeData=gd(this.zoom,b["text-size"]),this.iconSizeData=gd(this.zoom,b["icon-size"]);const M=this.layers[0].layout,q=M.get("symbol-sort-key"),K=M.get("symbol-z-order");this.canOverlap=kf(M,"text-overlap","text-allow-overlap")!=="never"||kf(M,"icon-overlap","icon-allow-overlap")!=="never"||M.get("text-ignore-placement")||M.get("icon-ignore-placement"),this.sortFeaturesByKey=K!=="viewport-y"&&!q.isConstant(),this.sortFeaturesByY=(K==="viewport-y"||K==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,M.get("symbol-placement")==="point"&&(this.writingModes=M.get("text-writing-mode").map(J=>S.ah[J])),this.stateDependentLayerIds=this.layers.filter(J=>J.isStateDependent()).map(J=>J.id),this.sourceID=h.sourceID}createArrays(){this.text=new Ku(new Uo(this.layers,this.zoom,h=>/^text/.test(h))),this.icon=new Ku(new Uo(this.layers,this.zoom,h=>/^icon/.test(h))),this.glyphOffsetArray=new _,this.lineVertexArray=new w,this.symbolInstances=new d,this.textAnchorOffsets=new B}calculateGlyphDependencies(h,b,M,q,K){for(let J=0;J<h.length;J++)if(b[h.charCodeAt(J)]=!0,(M||q)&&K){const me=Ch[h.charAt(J)];me&&(b[me.charCodeAt(0)]=!0)}}populate(h,b,M){const q=this.layers[0],K=q.layout,J=K.get("text-font"),me=K.get("text-field"),Ce=K.get("icon-image"),Ne=(me.value.kind!=="constant"||me.value.value instanceof ji&&!me.value.value.isEmpty()||me.value.value.toString().length>0)&&(J.value.kind!=="constant"||J.value.value.length>0),f=Ce.value.kind!=="constant"||!!Ce.value.value||Object.keys(Ce.parameters).length>0,u=K.get("symbol-sort-key");if(this.features=[],!Ne&&!f)return;const p=b.iconDependencies,I=b.glyphDependencies,L=b.availableImages,G=new ms(this.zoom);for(const{feature:Q,id:re,index:Ae,sourceLayerIndex:_e}of h){const Le=q._featureFilter.needGeometry,qe=vl(Q,Le);if(!q._featureFilter.filter(G,qe,M))continue;let tt,ft;if(Le||(qe.geometry=il(Q)),Ne){const Mt=q.getValueAndResolveTokens("text-field",qe,M,L),Pt=ji.factory(Mt);Mf(Pt)&&(this.hasRTLText=!0),(!this.hasRTLText||Xl.getRTLTextPluginStatus()==="unavailable"||this.hasRTLText&&Xl.isParsed())&&(tt=zm(Pt,q,qe))}if(f){const Mt=q.getValueAndResolveTokens("icon-image",qe,M,L);ft=Mt instanceof Yi?Mt:Yi.fromString(Mt)}if(!tt&&!ft)continue;const gt=this.sortFeaturesByKey?u.evaluate(qe,{},M):void 0;if(this.features.push({id:re,text:tt,icon:ft,index:Ae,sourceLayerIndex:_e,geometry:qe.geometry,properties:Q.properties,type:_d[Q.type],sortKey:gt}),ft&&(p[ft.name]=!0),tt){const Mt=J.evaluate(qe,{},M).join(","),Pt=K.get("text-rotation-alignment")!=="viewport"&&K.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(S.ah.vertical)>=0;for(const Lt of tt.sections)if(Lt.image)p[Lt.image.name]=!0;else{const ei=_l(tt.toString()),Ht=Lt.fontStack||Mt,Qt=I[Ht]=I[Ht]||{};this.calculateGlyphDependencies(Lt.text,Qt,Pt,this.allowVerticalPlacement,ei)}}}K.get("symbol-placement")==="line"&&(this.features=function(Q){const re={},Ae={},_e=[];let Le=0;function qe(Mt){_e.push(Q[Mt]),Le++}function tt(Mt,Pt,Lt){const ei=Ae[Mt];return delete Ae[Mt],Ae[Pt]=ei,_e[ei].geometry[0].pop(),_e[ei].geometry[0]=_e[ei].geometry[0].concat(Lt[0]),ei}function ft(Mt,Pt,Lt){const ei=re[Pt];return delete re[Pt],re[Mt]=ei,_e[ei].geometry[0].shift(),_e[ei].geometry[0]=Lt[0].concat(_e[ei].geometry[0]),ei}function gt(Mt,Pt,Lt){const ei=Lt?Pt[0][Pt[0].length-1]:Pt[0][0];return`${Mt}:${ei.x}:${ei.y}`}for(let Mt=0;Mt<Q.length;Mt++){const Pt=Q[Mt],Lt=Pt.geometry,ei=Pt.text?Pt.text.toString():null;if(!ei){qe(Mt);continue}const Ht=gt(ei,Lt),Qt=gt(ei,Lt,!0);if(Ht in Ae&&Qt in re&&Ae[Ht]!==re[Qt]){const hi=ft(Ht,Qt,Lt),_i=tt(Ht,Qt,_e[hi].geometry);delete re[Ht],delete Ae[Qt],Ae[gt(ei,_e[_i].geometry,!0)]=_i,_e[hi].geometry=null}else Ht in Ae?tt(Ht,Qt,Lt):Qt in re?ft(Ht,Qt,Lt):(qe(Mt),re[Ht]=Le-1,Ae[Qt]=Le-1)}return _e.filter(Mt=>Mt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Q,re)=>Q.sortKey-re.sortKey)}update(h,b,M){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(h,b,this.layers,M),this.icon.programConfigurations.updatePaintArrays(h,b,this.layers,M))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(h){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(h),this.iconCollisionBox.upload(h)),this.text.upload(h,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(h,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(h,b){const M=this.lineVertexArray.length;if(h.segment!==void 0){let q=h.dist(b[h.segment+1]),K=h.dist(b[h.segment]);const J={};for(let me=h.segment+1;me<b.length;me++)J[me]={x:b[me].x,y:b[me].y,tileUnitDistanceFromAnchor:q},me<b.length-1&&(q+=b[me+1].dist(b[me]));for(let me=h.segment||0;me>=0;me--)J[me]={x:b[me].x,y:b[me].y,tileUnitDistanceFromAnchor:K},me>0&&(K+=b[me-1].dist(b[me]));for(let me=0;me<b.length;me++){const Ce=J[me];this.lineVertexArray.emplaceBack(Ce.x,Ce.y,Ce.tileUnitDistanceFromAnchor)}}return{lineStartIndex:M,lineLength:this.lineVertexArray.length-M}}addSymbols(h,b,M,q,K,J,me,Ce,Ne,f,u,p){const I=h.indexArray,L=h.layoutVertexArray,G=h.segments.prepareSegment(4*b.length,L,I,this.canOverlap?J.sortKey:void 0),Q=this.glyphOffsetArray.length,re=G.vertexLength,Ae=this.allowVerticalPlacement&&me===S.ah.vertical?Math.PI/2:0,_e=J.text&&J.text.sections;for(let Le=0;Le<b.length;Le++){const{tl:qe,tr:tt,bl:ft,br:gt,tex:Mt,pixelOffsetTL:Pt,pixelOffsetBR:Lt,minFontScaleX:ei,minFontScaleY:Ht,glyphOffset:Qt,isSDF:hi,sectionIndex:_i}=b[Le],Xi=G.vertexLength,Sn=Qt[1];E0(L,Ce.x,Ce.y,qe.x,Sn+qe.y,Mt.x,Mt.y,M,hi,Pt.x,Pt.y,ei,Ht),E0(L,Ce.x,Ce.y,tt.x,Sn+tt.y,Mt.x+Mt.w,Mt.y,M,hi,Lt.x,Pt.y,ei,Ht),E0(L,Ce.x,Ce.y,ft.x,Sn+ft.y,Mt.x,Mt.y+Mt.h,M,hi,Pt.x,Lt.y,ei,Ht),E0(L,Ce.x,Ce.y,gt.x,Sn+gt.y,Mt.x+Mt.w,Mt.y+Mt.h,M,hi,Lt.x,Lt.y,ei,Ht),C0(h.dynamicLayoutVertexArray,Ce,Ae),I.emplaceBack(Xi,Xi+1,Xi+2),I.emplaceBack(Xi+1,Xi+2,Xi+3),G.vertexLength+=4,G.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Qt[0]),Le!==b.length-1&&_i===b[Le+1].sectionIndex||h.programConfigurations.populatePaintArrays(L.length,J,J.index,{},p,_e&&_e[_i])}h.placedSymbolArray.emplaceBack(Ce.x,Ce.y,Q,this.glyphOffsetArray.length-Q,re,Ne,f,Ce.segment,M?M[0]:0,M?M[1]:0,q[0],q[1],me,0,!1,0,u)}_addCollisionDebugVertex(h,b,M,q,K,J){return b.emplaceBack(0,0),h.emplaceBack(M.x,M.y,q,K,Math.round(J.x),Math.round(J.y))}addCollisionDebugVertices(h,b,M,q,K,J,me){const Ce=K.segments.prepareSegment(4,K.layoutVertexArray,K.indexArray),Ne=Ce.vertexLength,f=K.layoutVertexArray,u=K.collisionVertexArray,p=me.anchorX,I=me.anchorY;this._addCollisionDebugVertex(f,u,J,p,I,new ae(h,b)),this._addCollisionDebugVertex(f,u,J,p,I,new ae(M,b)),this._addCollisionDebugVertex(f,u,J,p,I,new ae(M,q)),this._addCollisionDebugVertex(f,u,J,p,I,new ae(h,q)),Ce.vertexLength+=4;const L=K.indexArray;L.emplaceBack(Ne,Ne+1),L.emplaceBack(Ne+1,Ne+2),L.emplaceBack(Ne+2,Ne+3),L.emplaceBack(Ne+3,Ne),Ce.primitiveLength+=4}addDebugCollisionBoxes(h,b,M,q){for(let K=h;K<b;K++){const J=this.collisionBoxArray.get(K);this.addCollisionDebugVertices(J.x1,J.y1,J.x2,J.y2,q?this.textCollisionBox:this.iconCollisionBox,J.anchorPoint,M)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Bc(wt,y0.members,ii),this.iconCollisionBox=new Bc(wt,y0.members,ii);for(let h=0;h<this.symbolInstances.length;h++){const b=this.symbolInstances.get(h);this.addDebugCollisionBoxes(b.textBoxStartIndex,b.textBoxEndIndex,b,!0),this.addDebugCollisionBoxes(b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b,!0),this.addDebugCollisionBoxes(b.iconBoxStartIndex,b.iconBoxEndIndex,b,!1),this.addDebugCollisionBoxes(b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b,!1)}}_deserializeCollisionBoxesForSymbol(h,b,M,q,K,J,me,Ce,Ne){const f={};for(let u=b;u<M;u++){const p=h.get(u);f.textBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.textFeatureIndex=p.featureIndex;break}for(let u=q;u<K;u++){const p=h.get(u);f.verticalTextBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.verticalTextFeatureIndex=p.featureIndex;break}for(let u=J;u<me;u++){const p=h.get(u);f.iconBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.iconFeatureIndex=p.featureIndex;break}for(let u=Ce;u<Ne;u++){const p=h.get(u);f.verticalIconBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.verticalIconFeatureIndex=p.featureIndex;break}return f}deserializeCollisionBoxes(h){this.collisionArrays=[];for(let b=0;b<this.symbolInstances.length;b++){const M=this.symbolInstances.get(b);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(h,M.textBoxStartIndex,M.textBoxEndIndex,M.verticalTextBoxStartIndex,M.verticalTextBoxEndIndex,M.iconBoxStartIndex,M.iconBoxEndIndex,M.verticalIconBoxStartIndex,M.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(h,b){const M=h.placedSymbolArray.get(b),q=M.vertexStartIndex+4*M.numGlyphs;for(let K=M.vertexStartIndex;K<q;K+=4)h.indexArray.emplaceBack(K,K+1,K+2),h.indexArray.emplaceBack(K+1,K+2,K+3)}getSortedSymbolIndexes(h){if(this.sortedAngle===h&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const b=Math.sin(h),M=Math.cos(h),q=[],K=[],J=[];for(let me=0;me<this.symbolInstances.length;++me){J.push(me);const Ce=this.symbolInstances.get(me);q.push(0|Math.round(b*Ce.anchorX+M*Ce.anchorY)),K.push(Ce.featureIndex)}return J.sort((me,Ce)=>q[me]-q[Ce]||K[Ce]-K[me]),J}addToSortKeyRanges(h,b){const M=this.sortKeyRanges[this.sortKeyRanges.length-1];M&&M.sortKey===b?M.symbolInstanceEnd=h+1:this.sortKeyRanges.push({sortKey:b,symbolInstanceStart:h,symbolInstanceEnd:h+1})}sortFeatures(h){if(this.sortFeaturesByY&&this.sortedAngle!==h&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(h),this.sortedAngle=h,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const b of this.symbolInstanceIndexes){const M=this.symbolInstances.get(b);this.featureSortOrder.push(M.featureIndex),[M.rightJustifiedTextSymbolIndex,M.centerJustifiedTextSymbolIndex,M.leftJustifiedTextSymbolIndex].forEach((q,K,J)=>{q>=0&&J.indexOf(q)===K&&this.addIndicesForPlacedSymbol(this.text,q)}),M.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,M.verticalPlacedTextSymbolIndex),M.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,M.placedIconSymbolIndex),M.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,M.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let T0,Pp;In("SymbolBucket",tA,{omit:["layers","collisionBoxArray","features","compareText"]}),tA.MAX_GLYPHS=65535,tA.addDynamicAttributes=C0;var yd={get paint(){return Pp=Pp||new oa({"icon-opacity":new Zn(Xt.paint_symbol["icon-opacity"]),"icon-color":new Zn(Xt.paint_symbol["icon-color"]),"icon-halo-color":new Zn(Xt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Zn(Xt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Zn(Xt.paint_symbol["icon-halo-blur"]),"icon-translate":new gn(Xt.paint_symbol["icon-translate"]),"icon-translate-anchor":new gn(Xt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Zn(Xt.paint_symbol["text-opacity"]),"text-color":new Zn(Xt.paint_symbol["text-color"],{runtimeType:He,getOverride:m=>m.textColor,hasOverride:m=>!!m.textColor}),"text-halo-color":new Zn(Xt.paint_symbol["text-halo-color"]),"text-halo-width":new Zn(Xt.paint_symbol["text-halo-width"]),"text-halo-blur":new Zn(Xt.paint_symbol["text-halo-blur"]),"text-translate":new gn(Xt.paint_symbol["text-translate"]),"text-translate-anchor":new gn(Xt.paint_symbol["text-translate-anchor"])})},get layout(){return T0=T0||new oa({"symbol-placement":new gn(Xt.layout_symbol["symbol-placement"]),"symbol-spacing":new gn(Xt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new gn(Xt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Zn(Xt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new gn(Xt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new gn(Xt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new gn(Xt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new gn(Xt.layout_symbol["icon-ignore-placement"]),"icon-optional":new gn(Xt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new gn(Xt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Zn(Xt.layout_symbol["icon-size"]),"icon-text-fit":new gn(Xt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new gn(Xt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Zn(Xt.layout_symbol["icon-image"]),"icon-rotate":new Zn(Xt.layout_symbol["icon-rotate"]),"icon-padding":new Zn(Xt.layout_symbol["icon-padding"]),"icon-keep-upright":new gn(Xt.layout_symbol["icon-keep-upright"]),"icon-offset":new Zn(Xt.layout_symbol["icon-offset"]),"icon-anchor":new Zn(Xt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new gn(Xt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new gn(Xt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new gn(Xt.layout_symbol["text-rotation-alignment"]),"text-field":new Zn(Xt.layout_symbol["text-field"]),"text-font":new Zn(Xt.layout_symbol["text-font"]),"text-size":new Zn(Xt.layout_symbol["text-size"]),"text-max-width":new Zn(Xt.layout_symbol["text-max-width"]),"text-line-height":new gn(Xt.layout_symbol["text-line-height"]),"text-letter-spacing":new Zn(Xt.layout_symbol["text-letter-spacing"]),"text-justify":new Zn(Xt.layout_symbol["text-justify"]),"text-radial-offset":new Zn(Xt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new gn(Xt.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Zn(Xt.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Zn(Xt.layout_symbol["text-anchor"]),"text-max-angle":new gn(Xt.layout_symbol["text-max-angle"]),"text-writing-mode":new gn(Xt.layout_symbol["text-writing-mode"]),"text-rotate":new Zn(Xt.layout_symbol["text-rotate"]),"text-padding":new gn(Xt.layout_symbol["text-padding"]),"text-keep-upright":new gn(Xt.layout_symbol["text-keep-upright"]),"text-transform":new Zn(Xt.layout_symbol["text-transform"]),"text-offset":new Zn(Xt.layout_symbol["text-offset"]),"text-allow-overlap":new gn(Xt.layout_symbol["text-allow-overlap"]),"text-overlap":new gn(Xt.layout_symbol["text-overlap"]),"text-ignore-placement":new gn(Xt.layout_symbol["text-ignore-placement"]),"text-optional":new gn(Xt.layout_symbol["text-optional"])})}};class Pf{constructor(h){if(h.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=h.property.overrides?h.property.overrides.runtimeType:Ie,this.defaultValue=h}evaluate(h){if(h.formattedSection){const b=this.defaultValue.property.overrides;if(b&&b.hasOverride(h.formattedSection))return b.getOverride(h.formattedSection)}return h.feature&&h.featureState?this.defaultValue.evaluate(h.feature,h.featureState):this.defaultValue.property.specification.default}eachChild(h){this.defaultValue.isConstant()||h(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}In("FormatSectionOverride",Pf,{omit:["defaultValue"]});class NA extends bs{constructor(h){super(h,yd)}recalculate(h,b){if(super.recalculate(h,b),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const M=this.layout.get("text-writing-mode");if(M){const q=[];for(const K of M)q.indexOf(K)<0&&q.push(K);this.layout._values["text-writing-mode"]=q}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(h,b,M,q){const K=this.layout.get(h).evaluate(b,{},M,q),J=this._unevaluatedLayout._values[h];return J.isDataDriven()||Zr(J.value)||!K?K:function(me,Ce){return Ce.replace(/{([^{}]+)}/g,(Ne,f)=>me&&f in me?String(me[f]):"")}(b.properties,K)}createBucket(h){return new tA(h)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const h of yd.paint.overridableProperties){if(!NA.hasPaintOverride(this.layout,h))continue;const b=this.paint.get(h),M=new Pf(b),q=new ns(M,b.property.specification);let K=null;K=b.value.kind==="constant"||b.value.kind==="source"?new Mr("source",q):new nr("composite",q,b.value.zoomStops),this.paint._values[h]=new yr(b.property,K,b.parameters)}}_handleOverridablePaintPropertyUpdate(h,b,M){return!(!this.layout||b.isDataDriven()||M.isDataDriven())&&NA.hasPaintOverride(this.layout,h)}static hasPaintOverride(h,b){const M=h.get("text-field"),q=yd.paint.properties[b];let K=!1;const J=me=>{for(const Ce of me)if(q.overrides&&q.overrides.hasOverride(Ce))return void(K=!0)};if(M.value.kind==="constant"&&M.value.value instanceof ji)J(M.value.value.sections);else if(M.value.kind==="source"){const me=Ne=>{K||(Ne instanceof Ur&&cr(Ne.value)===rt?J(Ne.value.sections):Ne instanceof Wl?J(Ne.sections):Ne.eachChild(me))},Ce=M.value;Ce._styleExpression&&me(Ce._styleExpression.expression)}return K}}let Dp;var vd={get paint(){return Dp=Dp||new oa({"background-color":new gn(Xt.paint_background["background-color"]),"background-pattern":new tl(Xt.paint_background["background-pattern"]),"background-opacity":new gn(Xt.paint_background["background-opacity"])})}};class xd extends bs{constructor(h){super(h,vd)}}let ah;var bd={get paint(){return ah=ah||new oa({"raster-opacity":new gn(Xt.paint_raster["raster-opacity"]),"raster-hue-rotate":new gn(Xt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new gn(Xt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new gn(Xt.paint_raster["raster-brightness-max"]),"raster-saturation":new gn(Xt.paint_raster["raster-saturation"]),"raster-contrast":new gn(Xt.paint_raster["raster-contrast"]),"raster-resampling":new gn(Xt.paint_raster["raster-resampling"]),"raster-fade-duration":new gn(Xt.paint_raster["raster-fade-duration"])})}};class Lp extends bs{constructor(h){super(h,bd)}}class wd extends bs{constructor(h){super(h,{}),this.onAdd=b=>{this.implementation.onAdd&&this.implementation.onAdd(b,b.painter.context.gl)},this.onRemove=b=>{this.implementation.onRemove&&this.implementation.onRemove(b,b.painter.context.gl)},this.implementation=h}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Bp{constructor(h){this._methodToThrottle=h,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const VA=63710088e-1;class oh{constructor(h,b){if(isNaN(h)||isNaN(b))throw new Error(`Invalid LngLat object: (${h}, ${b})`);if(this.lng=+h,this.lat=+b,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new oh(Oe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(h){const b=Math.PI/180,M=this.lat*b,q=h.lat*b,K=Math.sin(M)*Math.sin(q)+Math.cos(M)*Math.cos(q)*Math.cos((h.lng-this.lng)*b);return VA*Math.acos(Math.min(K,1))}static convert(h){if(h instanceof oh)return h;if(Array.isArray(h)&&(h.length===2||h.length===3))return new oh(Number(h[0]),Number(h[1]));if(!Array.isArray(h)&&typeof h=="object"&&h!==null)return new oh(Number("lng"in h?h.lng:h.lon),Number(h.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const zp=2*Math.PI*VA;function Rp(m){return zp*Math.cos(m*Math.PI/180)}function Sd(m){return(180+m)/360}function Id(m){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+m*Math.PI/360)))/360}function Fp(m,h){return m/Rp(h)}function UA(m){return 360/Math.PI*Math.atan(Math.exp((180-360*m)*Math.PI/180))-90}class k0{constructor(h,b,M=0){this.x=+h,this.y=+b,this.z=+M}static fromLngLat(h,b=0){const M=oh.convert(h);return new k0(Sd(M.lng),Id(M.lat),Fp(b,M.lat))}toLngLat(){return new oh(360*this.x-180,UA(this.y))}toAltitude(){return this.z*Rp(UA(this.y))}meterInMercatorCoordinateUnits(){return 1/zp*(h=UA(this.y),1/Math.cos(h*Math.PI/180));var h}}function M0(m,h,b){var M=2*Math.PI*6378137/256/Math.pow(2,b);return[m*M-2*Math.PI*6378137/2,h*M-2*Math.PI*6378137/2]}class zc{constructor(h,b,M){if(h<0||h>25||M<0||M>=Math.pow(2,h)||b<0||b>=Math.pow(2,h))throw new Error(`x=${b}, y=${M}, z=${h} outside of bounds. 0<=x<${Math.pow(2,h)}, 0<=y<${Math.pow(2,h)} 0<=z<=25 `);this.z=h,this.x=b,this.y=M,this.key=GA(0,h,h,b,M)}equals(h){return this.z===h.z&&this.x===h.x&&this.y===h.y}url(h,b,M){const q=(J=this.y,me=this.z,Ce=M0(256*(K=this.x),256*(J=Math.pow(2,me)-J-1),me),Ne=M0(256*(K+1),256*(J+1),me),Ce[0]+","+Ce[1]+","+Ne[0]+","+Ne[1]);var K,J,me,Ce,Ne;const f=function(u,p,I){let L,G="";for(let Q=u;Q>0;Q--)L=1<<Q-1,G+=(p&L?1:0)+(I&L?2:0);return G}(this.z,this.x,this.y);return h[(this.x+this.y)%h.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(M==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,b>1?"@2x":"").replace(/{quadkey}/g,f).replace(/{bbox-epsg-3857}/g,q)}isChildOf(h){const b=this.z-h.z;return b>0&&h.x===this.x>>b&&h.y===this.y>>b}getTilePoint(h){const b=Math.pow(2,this.z);return new ae((h.x*b-this.x)*$s,(h.y*b-this.y)*$s)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ed{constructor(h,b){this.wrap=h,this.canonical=b,this.key=GA(h,b.z,b.z,b.x,b.y)}}class Mu{constructor(h,b,M,q,K){if(h<M)throw new Error(`overscaledZ should be >= z; overscaledZ = ${h}; z = ${M}`);this.overscaledZ=h,this.wrap=b,this.canonical=new zc(M,+q,+K),this.key=GA(b,h,M,q,K)}clone(){return new Mu(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(h){return this.overscaledZ===h.overscaledZ&&this.wrap===h.wrap&&this.canonical.equals(h.canonical)}scaledTo(h){if(h>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${h}; overscaledZ = ${this.overscaledZ}`);const b=this.canonical.z-h;return h>this.canonical.z?new Mu(h,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Mu(h,this.wrap,h,this.canonical.x>>b,this.canonical.y>>b)}calculateScaledKey(h,b){if(h>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${h}; overscaledZ = ${this.overscaledZ}`);const M=this.canonical.z-h;return h>this.canonical.z?GA(this.wrap*+b,h,this.canonical.z,this.canonical.x,this.canonical.y):GA(this.wrap*+b,h,h,this.canonical.x>>M,this.canonical.y>>M)}isChildOf(h){if(h.wrap!==this.wrap)return!1;const b=this.canonical.z-h.canonical.z;return h.overscaledZ===0||h.overscaledZ<this.overscaledZ&&h.canonical.x===this.canonical.x>>b&&h.canonical.y===this.canonical.y>>b}children(h){if(this.overscaledZ>=h)return[new Mu(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const b=this.canonical.z+1,M=2*this.canonical.x,q=2*this.canonical.y;return[new Mu(b,this.wrap,b,M,q),new Mu(b,this.wrap,b,M+1,q),new Mu(b,this.wrap,b,M,q+1),new Mu(b,this.wrap,b,M+1,q+1)]}isLessThan(h){return this.wrap<h.wrap||!(this.wrap>h.wrap)&&(this.overscaledZ<h.overscaledZ||!(this.overscaledZ>h.overscaledZ)&&(this.canonical.x<h.canonical.x||!(this.canonical.x>h.canonical.x)&&this.canonical.y<h.canonical.y))}wrapped(){return new Mu(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(h){return new Mu(this.overscaledZ,h,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ed(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(h){return this.canonical.getTilePoint(new k0(h.x-this.wrap,h.y))}}function GA(m,h,b,M,q){(m*=2)<0&&(m=-1*m-1);const K=1<<b;return(K*K*m+K*q+M).toString(36)+b.toString(36)+h.toString(36)}In("CanonicalTileID",zc),In("OverscaledTileID",Mu,{omit:["posMatrix"]});class Cd{constructor(h,b,M,q=1,K=1,J=1,me=0){if(this.uid=h,b.height!==b.width)throw new RangeError("DEM tiles must be square");if(M&&!["mapbox","terrarium","custom"].includes(M))return void lt(`"${M}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=b.height;const Ce=this.dim=b.height-2;switch(this.data=new Uint32Array(b.data.buffer),M){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=q,this.greenFactor=K,this.blueFactor=J,this.baseShift=me;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let Ne=0;Ne<Ce;Ne++)this.data[this._idx(-1,Ne)]=this.data[this._idx(0,Ne)],this.data[this._idx(Ce,Ne)]=this.data[this._idx(Ce-1,Ne)],this.data[this._idx(Ne,-1)]=this.data[this._idx(Ne,0)],this.data[this._idx(Ne,Ce)]=this.data[this._idx(Ne,Ce-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(Ce,-1)]=this.data[this._idx(Ce-1,0)],this.data[this._idx(-1,Ce)]=this.data[this._idx(0,Ce-1)],this.data[this._idx(Ce,Ce)]=this.data[this._idx(Ce-1,Ce-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let Ne=0;Ne<Ce;Ne++)for(let f=0;f<Ce;f++){const u=this.get(Ne,f);u>this.max&&(this.max=u),u<this.min&&(this.min=u)}}get(h,b){const M=new Uint8Array(this.data.buffer),q=4*this._idx(h,b);return this.unpack(M[q],M[q+1],M[q+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(h,b){if(h<-1||h>=this.dim+1||b<-1||b>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(b+1)*this.stride+(h+1)}unpack(h,b,M){return h*this.redFactor+b*this.greenFactor+M*this.blueFactor-this.baseShift}getPixels(){return new Uu({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(h,b,M){if(this.dim!==h.dim)throw new Error("dem dimension mismatch");let q=b*this.dim,K=b*this.dim+this.dim,J=M*this.dim,me=M*this.dim+this.dim;switch(b){case-1:q=K-1;break;case 1:K=q+1}switch(M){case-1:J=me-1;break;case 1:me=J+1}const Ce=-b*this.dim,Ne=-M*this.dim;for(let f=J;f<me;f++)for(let u=q;u<K;u++)this.data[this._idx(u,f)]=h.data[this._idx(u+Ce,f+Ne)]}}In("DEMData",Cd);class Td{constructor(h){this._stringToNumber={},this._numberToString=[];for(let b=0;b<h.length;b++){const M=h[b];this._stringToNumber[M]=b,this._numberToString[b]=M}}encode(h){return this._stringToNumber[h]}decode(h){if(h>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${h} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[h]}}class kd{constructor(h,b,M,q,K){this.type="Feature",this._vectorTileFeature=h,h._z=b,h._x=M,h._y=q,this.properties=h.properties,this.id=K}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(h){this._geometry=h}toJSON(){const h={geometry:this.geometry};for(const b in this)b!=="_geometry"&&b!=="_vectorTileFeature"&&(h[b]=this[b]);return h}}class P0{constructor(h,b){this.tileID=h,this.x=h.canonical.x,this.y=h.canonical.y,this.z=h.canonical.z,this.grid=new Pn($s,16,0),this.grid3D=new Pn($s,16,0),this.featureIndexArray=new X,this.promoteId=b}insert(h,b,M,q,K,J){const me=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(M,q,K);const Ce=J?this.grid3D:this.grid;for(let Ne=0;Ne<b.length;Ne++){const f=b[Ne],u=[1/0,1/0,-1/0,-1/0];for(let p=0;p<f.length;p++){const I=f[p];u[0]=Math.min(u[0],I.x),u[1]=Math.min(u[1],I.y),u[2]=Math.max(u[2],I.x),u[3]=Math.max(u[3],I.y)}u[0]<$s&&u[1]<$s&&u[2]>=0&&u[3]>=0&&Ce.insert(me,u[0],u[1],u[2],u[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new hc.VectorTile(new fd(this.rawTileData)).layers,this.sourceLayerCoder=new Td(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(h,b,M,q){this.loadVTLayers();const K=h.params||{},J=$s/h.tileSize/h.scale,me=ds(K.filter),Ce=h.queryGeometry,Ne=h.queryPadding*J,f=Md(Ce),u=this.grid.query(f.minX-Ne,f.minY-Ne,f.maxX+Ne,f.maxY+Ne),p=Md(h.cameraQueryGeometry),I=this.grid3D.query(p.minX-Ne,p.minY-Ne,p.maxX+Ne,p.maxY+Ne,(Q,re,Ae,_e)=>function(Le,qe,tt,ft,gt){for(const Pt of Le)if(qe<=Pt.x&&tt<=Pt.y&&ft>=Pt.x&&gt>=Pt.y)return!0;const Mt=[new ae(qe,tt),new ae(qe,gt),new ae(ft,gt),new ae(ft,tt)];if(Le.length>2){for(const Pt of Mt)if(Xc(Le,Pt))return!0}for(let Pt=0;Pt<Le.length-1;Pt++)if(_p(Le[Pt],Le[Pt+1],Mt))return!0;return!1}(h.cameraQueryGeometry,Q-Ne,re-Ne,Ae+Ne,_e+Ne));for(const Q of I)u.push(Q);u.sort(Pd);const L={};let G;for(let Q=0;Q<u.length;Q++){const re=u[Q];if(re===G)continue;G=re;const Ae=this.featureIndexArray.get(re);let _e=null;this.loadMatchingFeature(L,Ae.bucketIndex,Ae.sourceLayerIndex,Ae.featureIndex,me,K.layers,K.availableImages,b,M,q,(Le,qe,tt)=>(_e||(_e=il(Le)),qe.queryIntersectsFeature(Ce,Le,tt,_e,this.z,h.transform,J,h.pixelPosMatrix)))}return L}loadMatchingFeature(h,b,M,q,K,J,me,Ce,Ne,f,u){const p=this.bucketLayerIDs[b];if(J&&!function(Q,re){for(let Ae=0;Ae<Q.length;Ae++)if(re.indexOf(Q[Ae])>=0)return!0;return!1}(J,p))return;const I=this.sourceLayerCoder.decode(M),L=this.vtLayers[I].feature(q);if(K.needGeometry){const Q=vl(L,!0);if(!K.filter(new ms(this.tileID.overscaledZ),Q,this.tileID.canonical))return}else if(!K.filter(new ms(this.tileID.overscaledZ),L))return;const G=this.getId(L,I);for(let Q=0;Q<p.length;Q++){const re=p[Q];if(J&&J.indexOf(re)<0)continue;const Ae=Ce[re];if(!Ae)continue;let _e={};G&&f&&(_e=f.getState(Ae.sourceLayer||"_geojsonTileLayer",G));const Le=jt({},Ne[re]);Le.paint=Df(Le.paint,Ae.paint,L,_e,me),Le.layout=Df(Le.layout,Ae.layout,L,_e,me);const qe=!u||u(L,Ae,_e);if(!qe)continue;const tt=new kd(L,this.z,this.x,this.y,G);tt.layer=Le;let ft=h[re];ft===void 0&&(ft=h[re]=[]),ft.push({featureIndex:q,feature:tt,intersectionZ:qe})}}lookupSymbolFeatures(h,b,M,q,K,J,me,Ce){const Ne={};this.loadVTLayers();const f=ds(K);for(const u of h)this.loadMatchingFeature(Ne,M,q,u,f,J,me,Ce,b);return Ne}hasLayer(h){for(const b of this.bucketLayerIDs)for(const M of b)if(h===M)return!0;return!1}getId(h,b){let M=h.id;return this.promoteId&&(M=h.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[b]],typeof M=="boolean"&&(M=Number(M))),M}}function Df(m,h,b,M,q){return _t(m,(K,J)=>{const me=h instanceof gs?h.get(J):null;return me&&me.evaluate?me.evaluate(b,M,q):me})}function Md(m){let h=1/0,b=1/0,M=-1/0,q=-1/0;for(const K of m)h=Math.min(h,K.x),b=Math.min(b,K.y),M=Math.max(M,K.x),q=Math.max(q,K.y);return{minX:h,minY:b,maxX:M,maxY:q}}function Pd(m,h){return h-m}function Dd(m,h,b,M,q){const K=[];for(let J=0;J<m.length;J++){const me=m[J];let Ce;for(let Ne=0;Ne<me.length-1;Ne++){let f=me[Ne],u=me[Ne+1];f.x<h&&u.x<h||(f.x<h?f=new ae(h,f.y+(h-f.x)/(u.x-f.x)*(u.y-f.y))._round():u.x<h&&(u=new ae(h,f.y+(h-f.x)/(u.x-f.x)*(u.y-f.y))._round()),f.y<b&&u.y<b||(f.y<b?f=new ae(f.x+(b-f.y)/(u.y-f.y)*(u.x-f.x),b)._round():u.y<b&&(u=new ae(f.x+(b-f.y)/(u.y-f.y)*(u.x-f.x),b)._round()),f.x>=M&&u.x>=M||(f.x>=M?f=new ae(M,f.y+(M-f.x)/(u.x-f.x)*(u.y-f.y))._round():u.x>=M&&(u=new ae(M,f.y+(M-f.x)/(u.x-f.x)*(u.y-f.y))._round()),f.y>=q&&u.y>=q||(f.y>=q?f=new ae(f.x+(q-f.y)/(u.y-f.y)*(u.x-f.x),q)._round():u.y>=q&&(u=new ae(f.x+(q-f.y)/(u.y-f.y)*(u.x-f.x),q)._round()),Ce&&f.equals(Ce[Ce.length-1])||(Ce=[f],K.push(Ce)),Ce.push(u)))))}}return K}In("FeatureIndex",P0,{omit:["rawTileData","sourceLayerCoder"]});class bl extends ae{constructor(h,b,M,q){super(h,b),this.angle=M,q!==void 0&&(this.segment=q)}clone(){return new bl(this.x,this.y,this.angle,this.segment)}}function qA(m,h,b,M,q){if(h.segment===void 0||b===0)return!0;let K=h,J=h.segment+1,me=0;for(;me>-b/2;){if(J--,J<0)return!1;me-=m[J].dist(K),K=m[J]}me+=m[J].dist(m[J+1]),J++;const Ce=[];let Ne=0;for(;me<b/2;){const f=m[J],u=m[J+1];if(!u)return!1;let p=m[J-1].angleTo(f)-f.angleTo(u);for(p=Math.abs((p+3*Math.PI)%(2*Math.PI)-Math.PI),Ce.push({distance:me,angleDelta:p}),Ne+=p;me-Ce[0].distance>M;)Ne-=Ce.shift().angleDelta;if(Ne>q)return!1;J++,me+=f.dist(u)}return!0}function D0(m){let h=0;for(let b=0;b<m.length-1;b++)h+=m[b].dist(m[b+1]);return h}function L0(m,h,b){return m?.6*h*b:0}function Ld(m,h){return Math.max(m?m.right-m.left:0,h?h.right-h.left:0)}function Op(m,h,b,M,q,K){const J=L0(b,q,K),me=Ld(b,M)*K;let Ce=0;const Ne=D0(m)/2;for(let f=0;f<m.length-1;f++){const u=m[f],p=m[f+1],I=u.dist(p);if(Ce+I>Ne){const L=(Ne-Ce)/I,G=xr.number(u.x,p.x,L),Q=xr.number(u.y,p.y,L),re=new bl(G,Q,p.angleTo(u),f);return re._round(),!J||qA(m,re,me,J,h)?re:void 0}Ce+=I}}function Np(m,h,b,M,q,K,J,me,Ce){const Ne=L0(M,K,J),f=Ld(M,q),u=f*J,p=m[0].x===0||m[0].x===Ce||m[0].y===0||m[0].y===Ce;return h-u<h/4&&(h=u+h/4),Bd(m,p?h/2*me%h:(f/2+2*K)*J*me%h,h,Ne,b,u,p,!1,Ce)}function Bd(m,h,b,M,q,K,J,me,Ce){const Ne=K/2,f=D0(m);let u=0,p=h-b,I=[];for(let L=0;L<m.length-1;L++){const G=m[L],Q=m[L+1],re=G.dist(Q),Ae=Q.angleTo(G);for(;p+b<u+re;){p+=b;const _e=(p-u)/re,Le=xr.number(G.x,Q.x,_e),qe=xr.number(G.y,Q.y,_e);if(Le>=0&&Le<Ce&&qe>=0&&qe<Ce&&p-Ne>=0&&p+Ne<=f){const tt=new bl(Le,qe,Ae,L);tt._round(),M&&!qA(m,tt,K,M,q)||I.push(tt)}}u+=re}return me||I.length||J||(I=Bd(m,u/2,b,M,q,K,J,!0,Ce)),I}In("Anchor",bl);const lh=fl;function zd(m,h,b,M){const q=[],K=m.image,J=K.pixelRatio,me=K.paddedRect.w-2*lh,Ce=K.paddedRect.h-2*lh,Ne=m.right-m.left,f=m.bottom-m.top,u=K.stretchX||[[0,me]],p=K.stretchY||[[0,Ce]],I=(Lt,ei)=>Lt+ei[1]-ei[0],L=u.reduce(I,0),G=p.reduce(I,0),Q=me-L,re=Ce-G;let Ae=0,_e=L,Le=0,qe=G,tt=0,ft=Q,gt=0,Mt=re;if(K.content&&M){const Lt=K.content;Ae=Ac(u,0,Lt[0]),Le=Ac(p,0,Lt[1]),_e=Ac(u,Lt[0],Lt[2]),qe=Ac(p,Lt[1],Lt[3]),tt=Lt[0]-Ae,gt=Lt[1]-Le,ft=Lt[2]-Lt[0]-_e,Mt=Lt[3]-Lt[1]-qe}const Pt=(Lt,ei,Ht,Qt)=>{const hi=Lf(Lt.stretch-Ae,_e,Ne,m.left),_i=Bf(Lt.fixed-tt,ft,Lt.stretch,L),Xi=Lf(ei.stretch-Le,qe,f,m.top),Sn=Bf(ei.fixed-gt,Mt,ei.stretch,G),ln=Lf(Ht.stretch-Ae,_e,Ne,m.left),on=Bf(Ht.fixed-tt,ft,Ht.stretch,L),fn=Lf(Qt.stretch-Le,qe,f,m.top),zn=Bf(Qt.fixed-gt,Mt,Qt.stretch,G),an=new ae(hi,Xi),$i=new ae(ln,Xi),Dn=new ae(ln,fn),Nn=new ae(hi,fn),pr=new ae(_i/J,Sn/J),Vr=new ae(on/J,zn/J),Hr=h*Math.PI/180;if(Hr){const ia=Math.sin(Hr),as=Math.cos(Hr),Wn=[as,-ia,ia,as];an._matMult(Wn),$i._matMult(Wn),Nn._matMult(Wn),Dn._matMult(Wn)}const Rs=Lt.stretch+Lt.fixed,Ta=ei.stretch+ei.fixed;return{tl:an,tr:$i,bl:Nn,br:Dn,tex:{x:K.paddedRect.x+lh+Rs,y:K.paddedRect.y+lh+Ta,w:Ht.stretch+Ht.fixed-Rs,h:Qt.stretch+Qt.fixed-Ta},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:pr,pixelOffsetBR:Vr,minFontScaleX:ft/J/Ne,minFontScaleY:Mt/J/f,isSDF:b}};if(M&&(K.stretchX||K.stretchY)){const Lt=Rd(u,Q,L),ei=Rd(p,re,G);for(let Ht=0;Ht<Lt.length-1;Ht++){const Qt=Lt[Ht],hi=Lt[Ht+1];for(let _i=0;_i<ei.length-1;_i++)q.push(Pt(Qt,ei[_i],hi,ei[_i+1]))}}else q.push(Pt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:me+1},{fixed:0,stretch:Ce+1}));return q}function Ac(m,h,b){let M=0;for(const q of m)M+=Math.max(h,Math.min(b,q[1]))-Math.max(h,Math.min(b,q[0]));return M}function Rd(m,h,b){const M=[{fixed:-lh,stretch:0}];for(const[q,K]of m){const J=M[M.length-1];M.push({fixed:q-J.stretch,stretch:J.stretch}),M.push({fixed:q-J.stretch,stretch:J.stretch+(K-q)})}return M.push({fixed:h+lh,stretch:b}),M}function Lf(m,h,b,M){return m/h*b+M}function Bf(m,h,b,M){return m-h*b/M}class zf{constructor(h,b,M,q,K,J,me,Ce,Ne,f){if(this.boxStartIndex=h.length,Ne){let u=J.top,p=J.bottom;const I=J.collisionPadding;I&&(u-=I[1],p+=I[3]);let L=p-u;L>0&&(L=Math.max(10,L),this.circleDiameter=L)}else{let u=J.top*me-Ce[0],p=J.bottom*me+Ce[2],I=J.left*me-Ce[3],L=J.right*me+Ce[1];const G=J.collisionPadding;if(G&&(I-=G[0]*me,u-=G[1]*me,L+=G[2]*me,p+=G[3]*me),f){const Q=new ae(I,u),re=new ae(L,u),Ae=new ae(I,p),_e=new ae(L,p),Le=f*Math.PI/180;Q._rotate(Le),re._rotate(Le),Ae._rotate(Le),_e._rotate(Le),I=Math.min(Q.x,re.x,Ae.x,_e.x),L=Math.max(Q.x,re.x,Ae.x,_e.x),u=Math.min(Q.y,re.y,Ae.y,_e.y),p=Math.max(Q.y,re.y,Ae.y,_e.y)}h.emplaceBack(b.x,b.y,I,u,L,p,M,q,K)}this.boxEndIndex=h.length}}class Um{constructor(h=[],b=Gm){if(this.data=h,this.length=this.data.length,this.compare=b,this.length>0)for(let M=(this.length>>1)-1;M>=0;M--)this._down(M)}push(h){this.data.push(h),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const h=this.data[0],b=this.data.pop();return this.length--,this.length>0&&(this.data[0]=b,this._down(0)),h}peek(){return this.data[0]}_up(h){const{data:b,compare:M}=this,q=b[h];for(;h>0;){const K=h-1>>1,J=b[K];if(M(q,J)>=0)break;b[h]=J,h=K}b[h]=q}_down(h){const{data:b,compare:M}=this,q=this.length>>1,K=b[h];for(;h<q;){let J=1+(h<<1),me=b[J];const Ce=J+1;if(Ce<this.length&&M(b[Ce],me)<0&&(J=Ce,me=b[Ce]),M(me,K)>=0)break;b[h]=me,h=J}b[h]=K}}function Gm(m,h){return m<h?-1:m>h?1:0}function Vp(m,h=1,b=!1){let M=1/0,q=1/0,K=-1/0,J=-1/0;const me=m[0];for(let I=0;I<me.length;I++){const L=me[I];(!I||L.x<M)&&(M=L.x),(!I||L.y<q)&&(q=L.y),(!I||L.x>K)&&(K=L.x),(!I||L.y>J)&&(J=L.y)}const Ce=Math.min(K-M,J-q);let Ne=Ce/2;const f=new Um([],HA);if(Ce===0)return new ae(M,q);for(let I=M;I<K;I+=Ce)for(let L=q;L<J;L+=Ce)f.push(new iA(I+Ne,L+Ne,Ne,m));let u=function(I){let L=0,G=0,Q=0;const re=I[0];for(let Ae=0,_e=re.length,Le=_e-1;Ae<_e;Le=Ae++){const qe=re[Ae],tt=re[Le],ft=qe.x*tt.y-tt.x*qe.y;G+=(qe.x+tt.x)*ft,Q+=(qe.y+tt.y)*ft,L+=3*ft}return new iA(G/L,Q/L,0,I)}(m),p=f.length;for(;f.length;){const I=f.pop();(I.d>u.d||!u.d)&&(u=I,b&&console.log("found best %d after %d probes",Math.round(1e4*I.d)/1e4,p)),I.max-u.d<=h||(Ne=I.h/2,f.push(new iA(I.p.x-Ne,I.p.y-Ne,Ne,m)),f.push(new iA(I.p.x+Ne,I.p.y-Ne,Ne,m)),f.push(new iA(I.p.x-Ne,I.p.y+Ne,Ne,m)),f.push(new iA(I.p.x+Ne,I.p.y+Ne,Ne,m)),p+=4)}return b&&(console.log(`num probes: ${p}`),console.log(`best distance: ${u.d}`)),u.p}function HA(m,h){return h.max-m.max}function iA(m,h,b,M){this.p=new ae(m,h),this.h=b,this.d=function(q,K){let J=!1,me=1/0;for(let Ce=0;Ce<K.length;Ce++){const Ne=K[Ce];for(let f=0,u=Ne.length,p=u-1;f<u;p=f++){const I=Ne[f],L=Ne[p];I.y>q.y!=L.y>q.y&&q.x<(L.x-I.x)*(q.y-I.y)/(L.y-I.y)+I.x&&(J=!J),me=Math.min(me,Gh(q,I,L))}}return(J?1:-1)*Math.sqrt(me)}(this.p,M),this.max=this.d+this.h*Math.SQRT2}var Ro;S.ap=void 0,(Ro=S.ap||(S.ap={}))[Ro.center=1]="center",Ro[Ro.left=2]="left",Ro[Ro.right=3]="right",Ro[Ro.top=4]="top",Ro[Ro.bottom=5]="bottom",Ro[Ro["top-left"]=6]="top-left",Ro[Ro["top-right"]=7]="top-right",Ro[Ro["bottom-left"]=8]="bottom-left",Ro[Ro["bottom-right"]=9]="bottom-right";const uh=7,nA=Number.POSITIVE_INFINITY;function jA(m,h){return h[1]!==nA?function(b,M,q){let K=0,J=0;switch(M=Math.abs(M),q=Math.abs(q),b){case"top-right":case"top-left":case"top":J=q-uh;break;case"bottom-right":case"bottom-left":case"bottom":J=-q+uh}switch(b){case"top-right":case"bottom-right":case"right":K=-M;break;case"top-left":case"bottom-left":case"left":K=M}return[K,J]}(m,h[0],h[1]):function(b,M){let q=0,K=0;M<0&&(M=0);const J=M/Math.SQRT2;switch(b){case"top-right":case"top-left":K=J-uh;break;case"bottom-right":case"bottom-left":K=-J+uh;break;case"bottom":K=-M+uh;break;case"top":K=M-uh}switch(b){case"top-right":case"bottom-right":q=-J;break;case"top-left":case"bottom-left":q=J;break;case"left":q=M;break;case"right":q=-M}return[q,K]}(m,h[0])}function rA(m,h,b){var M;const q=m.layout,K=(M=q.get("text-variable-anchor-offset"))===null||M===void 0?void 0:M.evaluate(h,{},b);if(K){const me=K.values,Ce=[];for(let Ne=0;Ne<me.length;Ne+=2){const f=Ce[Ne]=me[Ne],u=me[Ne+1].map(p=>p*Al);f.startsWith("top")?u[1]-=uh:f.startsWith("bottom")&&(u[1]+=uh),Ce[Ne+1]=u}return new Wt(Ce)}const J=q.get("text-variable-anchor");if(J){let me;me=m._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[q.get("text-radial-offset").evaluate(h,{},b)*Al,nA]:q.get("text-offset").evaluate(h,{},b).map(Ne=>Ne*Al);const Ce=[];for(const Ne of J)Ce.push(Ne,jA(Ne,me));return new Wt(Ce)}return null}function B0(m){switch(m){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Up(m,h,b,M,q,K,J,me,Ce,Ne,f){let u=K.textMaxSize.evaluate(h,{});u===void 0&&(u=J);const p=m.layers[0].layout,I=p.get("icon-offset").evaluate(h,{},f),L=Od(b.horizontal),G=J/24,Q=m.tilePixelRatio*G,re=m.tilePixelRatio*u/24,Ae=m.tilePixelRatio*me,_e=m.tilePixelRatio*p.get("symbol-spacing"),Le=p.get("text-padding")*m.tilePixelRatio,qe=function(Qt,hi,_i,Xi=1){const Sn=Qt.get("icon-padding").evaluate(hi,{},_i),ln=Sn&&Sn.values;return[ln[0]*Xi,ln[1]*Xi,ln[2]*Xi,ln[3]*Xi]}(p,h,f,m.tilePixelRatio),tt=p.get("text-max-angle")/180*Math.PI,ft=p.get("text-rotation-alignment")!=="viewport"&&p.get("symbol-placement")!=="point",gt=p.get("icon-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point",Mt=p.get("symbol-placement"),Pt=_e/2,Lt=p.get("icon-text-fit");let ei;M&&Lt!=="none"&&(m.allowVerticalPlacement&&b.vertical&&(ei=md(M,b.vertical,Lt,p.get("icon-text-fit-padding"),I,G)),L&&(M=md(M,L,Lt,p.get("icon-text-fit-padding"),I,G)));const Ht=(Qt,hi)=>{hi.x<0||hi.x>=$s||hi.y<0||hi.y>=$s||function(_i,Xi,Sn,ln,on,fn,zn,an,$i,Dn,Nn,pr,Vr,Hr,Rs,Ta,ia,as,Wn,Is,tr,na,Ls,Kn,za){const to=_i.addToLineVertexArray(Xi,Sn);let va,qo,uo,ra,wr=0,wo=0,nl=0,rl=0,Pu=-1,Gu=-1;const zl={};let Fc=er("");if(_i.allowVerticalPlacement&&ln.vertical){const tu=an.layout.get("text-rotate").evaluate(tr,{},Kn)+90;uo=new zf($i,Xi,Dn,Nn,pr,ln.vertical,Vr,Hr,Rs,tu),zn&&(ra=new zf($i,Xi,Dn,Nn,pr,zn,ia,as,Rs,tu))}if(on){const tu=an.layout.get("icon-rotate").evaluate(tr,{}),ju=an.layout.get("icon-text-fit")!=="none",Ph=zd(on,tu,Ls,ju),fc=zn?zd(zn,tu,Ls,ju):void 0;qo=new zf($i,Xi,Dn,Nn,pr,on,ia,as,!1,tu),wr=4*Ph.length;const iu=_i.iconSizeData;let Zu=null;iu.kind==="source"?(Zu=[Lc*an.layout.get("icon-size").evaluate(tr,{})],Zu[0]>sh&&lt(`${_i.layerIds[0]}: Value for "icon-size" is >= ${kh}. Reduce your "icon-size".`)):iu.kind==="composite"&&(Zu=[Lc*na.compositeIconSizes[0].evaluate(tr,{},Kn),Lc*na.compositeIconSizes[1].evaluate(tr,{},Kn)],(Zu[0]>sh||Zu[1]>sh)&&lt(`${_i.layerIds[0]}: Value for "icon-size" is >= ${kh}. Reduce your "icon-size".`)),_i.addSymbols(_i.icon,Ph,Zu,Is,Wn,tr,S.ah.none,Xi,to.lineStartIndex,to.lineLength,-1,Kn),Pu=_i.icon.placedSymbolArray.length-1,fc&&(wo=4*fc.length,_i.addSymbols(_i.icon,fc,Zu,Is,Wn,tr,S.ah.vertical,Xi,to.lineStartIndex,to.lineLength,-1,Kn),Gu=_i.icon.placedSymbolArray.length-1)}const qu=Object.keys(ln.horizontal);for(const tu of qu){const ju=ln.horizontal[tu];if(!va){Fc=er(ju.text);const fc=an.layout.get("text-rotate").evaluate(tr,{},Kn);va=new zf($i,Xi,Dn,Nn,pr,ju,Vr,Hr,Rs,fc)}const Ph=ju.positionedLines.length===1;if(nl+=Fd(_i,Xi,ju,fn,an,Rs,tr,Ta,to,ln.vertical?S.ah.horizontal:S.ah.horizontalOnly,Ph?qu:[tu],zl,Pu,na,Kn),Ph)break}ln.vertical&&(rl+=Fd(_i,Xi,ln.vertical,fn,an,Rs,tr,Ta,to,S.ah.vertical,["vertical"],zl,Gu,na,Kn));const Hu=va?va.boxStartIndex:_i.collisionBoxArray.length,eu=va?va.boxEndIndex:_i.collisionBoxArray.length,ch=uo?uo.boxStartIndex:_i.collisionBoxArray.length,sA=uo?uo.boxEndIndex:_i.collisionBoxArray.length,qp=qo?qo.boxStartIndex:_i.collisionBoxArray.length,Nd=qo?qo.boxEndIndex:_i.collisionBoxArray.length,Vd=ra?ra.boxStartIndex:_i.collisionBoxArray.length,co=ra?ra.boxEndIndex:_i.collisionBoxArray.length;let So=-1;const Gf=(tu,ju)=>tu&&tu.circleDiameter?Math.max(tu.circleDiameter,ju):ju;So=Gf(va,So),So=Gf(uo,So),So=Gf(qo,So),So=Gf(ra,So);const Hp=So>-1?1:0;Hp&&(So*=za/Al),_i.glyphOffsetArray.length>=tA.MAX_GLYPHS&&lt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),tr.sortKey!==void 0&&_i.addToSortKeyRanges(_i.symbolInstances.length,tr.sortKey);const qm=rA(an,tr,Kn),[jp,Hm]=function(tu,ju){const Ph=tu.length,fc=ju==null?void 0:ju.values;if((fc==null?void 0:fc.length)>0)for(let iu=0;iu<fc.length;iu+=2){const Zu=fc[iu+1];tu.emplaceBack(S.ap[fc[iu]],Zu[0],Zu[1])}return[Ph,tu.length]}(_i.textAnchorOffsets,qm);_i.symbolInstances.emplaceBack(Xi.x,Xi.y,zl.right>=0?zl.right:-1,zl.center>=0?zl.center:-1,zl.left>=0?zl.left:-1,zl.vertical||-1,Pu,Gu,Fc,Hu,eu,ch,sA,qp,Nd,Vd,co,Dn,nl,rl,wr,wo,Hp,0,Vr,So,jp,Hm)}(m,hi,Qt,b,M,q,ei,m.layers[0],m.collisionBoxArray,h.index,h.sourceLayerIndex,m.index,Q,[Le,Le,Le,Le],ft,Ce,Ae,qe,gt,I,h,K,Ne,f,J)};if(Mt==="line")for(const Qt of Dd(h.geometry,0,0,$s,$s)){const hi=Np(Qt,_e,tt,b.vertical||L,M,24,re,m.overscaling,$s);for(const _i of hi)L&&ZA(m,L.text,Pt,_i)||Ht(Qt,_i)}else if(Mt==="line-center"){for(const Qt of h.geometry)if(Qt.length>1){const hi=Op(Qt,tt,b.vertical||L,M,24,re);hi&&Ht(Qt,hi)}}else if(h.type==="Polygon")for(const Qt of wh(h.geometry,0)){const hi=Vp(Qt,16);Ht(Qt[0],new bl(hi.x,hi.y,0))}else if(h.type==="LineString")for(const Qt of h.geometry)Ht(Qt,new bl(Qt[0].x,Qt[0].y,0));else if(h.type==="Point")for(const Qt of h.geometry)for(const hi of Qt)Ht([hi],new bl(hi.x,hi.y,0))}function Fd(m,h,b,M,q,K,J,me,Ce,Ne,f,u,p,I,L){const G=function(Ae,_e,Le,qe,tt,ft,gt,Mt){const Pt=qe.layout.get("text-rotate").evaluate(ft,{})*Math.PI/180,Lt=[];for(const ei of _e.positionedLines)for(const Ht of ei.positionedGlyphs){if(!Ht.rect)continue;const Qt=Ht.rect||{};let hi=pd+1,_i=!0,Xi=1,Sn=0;const ln=(tt||Mt)&&Ht.vertical,on=Ht.metrics.advance*Ht.scale/2;if(Mt&&_e.verticalizable&&(Sn=ei.lineOffset/2-(Ht.imageName?-(Al-Ht.metrics.width*Ht.scale)/2:(Ht.scale-1)*Al)),Ht.imageName){const Is=gt[Ht.imageName];_i=Is.sdf,Xi=Is.pixelRatio,hi=fl/Xi}const fn=tt?[Ht.x+on,Ht.y]:[0,0];let zn=tt?[0,0]:[Ht.x+on+Le[0],Ht.y+Le[1]-Sn],an=[0,0];ln&&(an=zn,zn=[0,0]);const $i=Ht.metrics.isDoubleResolution?2:1,Dn=(Ht.metrics.left-hi)*Ht.scale-on+zn[0],Nn=(-Ht.metrics.top-hi)*Ht.scale+zn[1],pr=Dn+Qt.w/$i*Ht.scale/Xi,Vr=Nn+Qt.h/$i*Ht.scale/Xi,Hr=new ae(Dn,Nn),Rs=new ae(pr,Nn),Ta=new ae(Dn,Vr),ia=new ae(pr,Vr);if(ln){const Is=new ae(-on,on-BA),tr=-Math.PI/2,na=Al/2-on,Ls=new ae(5-BA-na,-(Ht.imageName?na:0)),Kn=new ae(...an);Hr._rotateAround(tr,Is)._add(Ls)._add(Kn),Rs._rotateAround(tr,Is)._add(Ls)._add(Kn),Ta._rotateAround(tr,Is)._add(Ls)._add(Kn),ia._rotateAround(tr,Is)._add(Ls)._add(Kn)}if(Pt){const Is=Math.sin(Pt),tr=Math.cos(Pt),na=[tr,-Is,Is,tr];Hr._matMult(na),Rs._matMult(na),Ta._matMult(na),ia._matMult(na)}const as=new ae(0,0),Wn=new ae(0,0);Lt.push({tl:Hr,tr:Rs,bl:Ta,br:ia,tex:Qt,writingMode:_e.writingMode,glyphOffset:fn,sectionIndex:Ht.sectionIndex,isSDF:_i,pixelOffsetTL:as,pixelOffsetBR:Wn,minFontScaleX:0,minFontScaleY:0})}return Lt}(0,b,me,q,K,J,M,m.allowVerticalPlacement),Q=m.textSizeData;let re=null;Q.kind==="source"?(re=[Lc*q.layout.get("text-size").evaluate(J,{})],re[0]>sh&&lt(`${m.layerIds[0]}: Value for "text-size" is >= ${kh}. Reduce your "text-size".`)):Q.kind==="composite"&&(re=[Lc*I.compositeTextSizes[0].evaluate(J,{},L),Lc*I.compositeTextSizes[1].evaluate(J,{},L)],(re[0]>sh||re[1]>sh)&&lt(`${m.layerIds[0]}: Value for "text-size" is >= ${kh}. Reduce your "text-size".`)),m.addSymbols(m.text,G,re,me,K,J,Ne,h,Ce.lineStartIndex,Ce.lineLength,p,L);for(const Ae of f)u[Ae]=m.text.placedSymbolArray.length-1;return 4*G.length}function Od(m){for(const h in m)return m[h];return null}function ZA(m,h,b,M){const q=m.compareText;if(h in q){const K=q[h];for(let J=K.length-1;J>=0;J--)if(M.dist(K[J])<b)return!0}else q[h]=[];return q[h].push(M),!1}const Bl=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Rc{static from(h){if(!(h instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[b,M]=new Uint8Array(h,0,2);if(b!==219)throw new Error("Data does not appear to be in a KDBush format.");const q=M>>4;if(q!==1)throw new Error(`Got v${q} data when expected v1.`);const K=Bl[15&M];if(!K)throw new Error("Unrecognized array type.");const[J]=new Uint16Array(h,2,1),[me]=new Uint32Array(h,4,1);return new Rc(me,J,K,h)}constructor(h,b=64,M=Float64Array,q){if(isNaN(h)||h<0)throw new Error(`Unpexpected numItems value: ${h}.`);this.numItems=+h,this.nodeSize=Math.min(Math.max(+b,2),65535),this.ArrayType=M,this.IndexArrayType=h<65536?Uint16Array:Uint32Array;const K=Bl.indexOf(this.ArrayType),J=2*h*this.ArrayType.BYTES_PER_ELEMENT,me=h*this.IndexArrayType.BYTES_PER_ELEMENT,Ce=(8-me%8)%8;if(K<0)throw new Error(`Unexpected typed array class: ${M}.`);q&&q instanceof ArrayBuffer?(this.data=q,this.ids=new this.IndexArrayType(this.data,8,h),this.coords=new this.ArrayType(this.data,8+me+Ce,2*h),this._pos=2*h,this._finished=!0):(this.data=new ArrayBuffer(8+J+me+Ce),this.ids=new this.IndexArrayType(this.data,8,h),this.coords=new this.ArrayType(this.data,8+me+Ce,2*h),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+K]),new Uint16Array(this.data,2,1)[0]=b,new Uint32Array(this.data,4,1)[0]=h)}add(h,b){const M=this._pos>>1;return this.ids[M]=M,this.coords[this._pos++]=h,this.coords[this._pos++]=b,M}finish(){const h=this._pos>>1;if(h!==this.numItems)throw new Error(`Added ${h} items when expected ${this.numItems}.`);return Mh(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(h,b,M,q){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:K,coords:J,nodeSize:me}=this,Ce=[0,K.length-1,0],Ne=[];for(;Ce.length;){const f=Ce.pop()||0,u=Ce.pop()||0,p=Ce.pop()||0;if(u-p<=me){for(let Q=p;Q<=u;Q++){const re=J[2*Q],Ae=J[2*Q+1];re>=h&&re<=M&&Ae>=b&&Ae<=q&&Ne.push(K[Q])}continue}const I=p+u>>1,L=J[2*I],G=J[2*I+1];L>=h&&L<=M&&G>=b&&G<=q&&Ne.push(K[I]),(f===0?h<=L:b<=G)&&(Ce.push(p),Ce.push(I-1),Ce.push(1-f)),(f===0?M>=L:q>=G)&&(Ce.push(I+1),Ce.push(u),Ce.push(1-f))}return Ne}within(h,b,M){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:q,coords:K,nodeSize:J}=this,me=[0,q.length-1,0],Ce=[],Ne=M*M;for(;me.length;){const f=me.pop()||0,u=me.pop()||0,p=me.pop()||0;if(u-p<=J){for(let Q=p;Q<=u;Q++)z0(K[2*Q],K[2*Q+1],h,b)<=Ne&&Ce.push(q[Q]);continue}const I=p+u>>1,L=K[2*I],G=K[2*I+1];z0(L,G,h,b)<=Ne&&Ce.push(q[I]),(f===0?h-M<=L:b-M<=G)&&(me.push(p),me.push(I-1),me.push(1-f)),(f===0?h+M>=L:b+M>=G)&&(me.push(I+1),me.push(u),me.push(1-f))}return Ce}}function Mh(m,h,b,M,q,K){if(q-M<=b)return;const J=M+q>>1;QA(m,h,J,M,q,K),Mh(m,h,b,M,J-1,1-K),Mh(m,h,b,J+1,q,1-K)}function QA(m,h,b,M,q,K){for(;q>M;){if(q-M>600){const Ne=q-M+1,f=b-M+1,u=Math.log(Ne),p=.5*Math.exp(2*u/3),I=.5*Math.sqrt(u*p*(Ne-p)/Ne)*(f-Ne/2<0?-1:1);QA(m,h,b,Math.max(M,Math.floor(b-f*p/Ne+I)),Math.min(q,Math.floor(b+(Ne-f)*p/Ne+I)),K)}const J=h[2*b+K];let me=M,Ce=q;for(WA(m,h,M,b),h[2*q+K]>J&&WA(m,h,M,q);me<Ce;){for(WA(m,h,me,Ce),me++,Ce--;h[2*me+K]<J;)me++;for(;h[2*Ce+K]>J;)Ce--}h[2*M+K]===J?WA(m,h,M,Ce):(Ce++,WA(m,h,Ce,q)),Ce<=b&&(M=Ce+1),b<=Ce&&(q=Ce-1)}}function WA(m,h,b,M){Rf(m,b,M),Rf(h,2*b,2*M),Rf(h,2*b+1,2*M+1)}function Rf(m,h,b){const M=m[h];m[h]=m[b],m[b]=M}function z0(m,h,b,M){const q=m-b,K=h-M;return q*q+K*K}var Ff;S.bc=void 0,(Ff=S.bc||(S.bc={})).create="create",Ff.load="load",Ff.fullLoad="fullLoad";let Of=null,Nf=[];const R0=1e3/60,Vf="loadTime",Uf="fullLoadTime",Gp={mark(m){performance.mark(m)},frame(m){const h=m;Of!=null&&Nf.push(h-Of),Of=h},clearMetrics(){Of=null,Nf=[],performance.clearMeasures(Vf),performance.clearMeasures(Uf);for(const m in S.bc)performance.clearMarks(S.bc[m])},getPerformanceMetrics(){performance.measure(Vf,S.bc.create,S.bc.load),performance.measure(Uf,S.bc.create,S.bc.fullLoad);const m=performance.getEntriesByName(Vf)[0].duration,h=performance.getEntriesByName(Uf)[0].duration,b=Nf.length,M=1/(Nf.reduce((K,J)=>K+J,0)/b/1e3),q=Nf.filter(K=>K>R0).reduce((K,J)=>K+(J-R0)/R0,0);return{loadTime:m,fullLoadTime:h,fps:M,percentDroppedFrames:q/(b+q)*100,totalFrames:b}}};S.$=Qi,S.A=Yu,S.B=function(m){if(Nt==null){const h=m.navigator?m.navigator.userAgent:null;Nt=!!m.safari||!(!h||!(/\b(iPad|iPhone|iPod)\b/.test(h)||h.match("Safari")&&!h.match("Chrome")))}return Nt},S.C=class{constructor(m,h){this.target=m,this.mapId=h,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Bp(()=>this.process()),this.subscription=function(b,M,q,K){return b.addEventListener(M,q,!1),{unsubscribe:()=>{b.removeEventListener(M,q,!1)}}}(this.target,"message",b=>this.receive(b)),this.globalScope=ut(self)?m:window}registerMessageHandler(m,h){this.messageHandlers[m]=h}sendAsync(m,h){return new Promise((b,M)=>{const q=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[q]={resolve:b,reject:M},h&&h.signal.addEventListener("abort",()=>{delete this.resolveRejects[q];const me={id:q,type:"<cancel>",origin:location.origin,targetMapId:m.targetMapId,sourceMapId:this.mapId};this.target.postMessage(me)},{once:!0});const K=[],J=Object.assign(Object.assign({},m),{id:q,sourceMapId:this.mapId,origin:location.origin,data:Nl(m.data,K)});this.target.postMessage(J,{transfer:K})})}receive(m){const h=m.data,b=h.id;if(!(h.origin!=="file://"&&location.origin!=="file://"&&h.origin!==location.origin||h.targetMapId&&this.mapId!==h.targetMapId)){if(h.type==="<cancel>"){delete this.tasks[b];const M=this.abortControllers[b];return delete this.abortControllers[b],void(M&&M.abort())}if(ut(self)||h.mustQueue)return this.tasks[b]=h,this.taskQueue.push(b),void this.invoker.trigger();this.processTask(b,h)}}process(){if(this.taskQueue.length===0)return;const m=this.taskQueue.shift(),h=this.tasks[m];delete this.tasks[m],this.taskQueue.length>0&&this.invoker.trigger(),h&&this.processTask(m,h)}processTask(m,h){return a(this,void 0,void 0,function*(){if(h.type==="<response>"){const q=this.resolveRejects[m];return delete this.resolveRejects[m],q?void(h.error?q.reject(En(h.error)):q.resolve(En(h.data))):void 0}if(!this.messageHandlers[h.type])return void this.completeTask(m,new Error(`Could not find a registered handler for ${h.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const b=En(h.data),M=new AbortController;this.abortControllers[m]=M;try{const q=yield this.messageHandlers[h.type](h.sourceMapId,b,M);this.completeTask(m,null,q)}catch(q){this.completeTask(m,q)}})}completeTask(m,h,b){const M=[];delete this.abortControllers[m];const q={id:m,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:h?Nl(h):null,data:Nl(b,M)};this.target.postMessage(q,{transfer:M})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},S.D=gn,S.E=rn,S.F=function(){var m=new Yu(16);return Yu!=Float32Array&&(m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[11]=0,m[12]=0,m[13]=0,m[14]=0),m[0]=1,m[5]=1,m[10]=1,m[15]=1,m},S.G=nn,S.H=function(m,h,b){var M,q,K,J,me,Ce,Ne,f,u,p,I,L,G=b[0],Q=b[1],re=b[2];return h===m?(m[12]=h[0]*G+h[4]*Q+h[8]*re+h[12],m[13]=h[1]*G+h[5]*Q+h[9]*re+h[13],m[14]=h[2]*G+h[6]*Q+h[10]*re+h[14],m[15]=h[3]*G+h[7]*Q+h[11]*re+h[15]):(q=h[1],K=h[2],J=h[3],me=h[4],Ce=h[5],Ne=h[6],f=h[7],u=h[8],p=h[9],I=h[10],L=h[11],m[0]=M=h[0],m[1]=q,m[2]=K,m[3]=J,m[4]=me,m[5]=Ce,m[6]=Ne,m[7]=f,m[8]=u,m[9]=p,m[10]=I,m[11]=L,m[12]=M*G+me*Q+u*re+h[12],m[13]=q*G+Ce*Q+p*re+h[13],m[14]=K*G+Ne*Q+I*re+h[14],m[15]=J*G+f*Q+L*re+h[15]),m},S.I=b0,S.J=function(m,h,b){var M=b[0],q=b[1],K=b[2];return m[0]=h[0]*M,m[1]=h[1]*M,m[2]=h[2]*M,m[3]=h[3]*M,m[4]=h[4]*q,m[5]=h[5]*q,m[6]=h[6]*q,m[7]=h[7]*q,m[8]=h[8]*K,m[9]=h[9]*K,m[10]=h[10]*K,m[11]=h[11]*K,m[12]=h[12],m[13]=h[13],m[14]=h[14],m[15]=h[15],m},S.K=vh,S.L=function(m,h){const b={};for(let M=0;M<h.length;M++){const q=h[M];q in m&&(b[q]=m[q])}return b},S.M=oh,S.N=Sd,S.O=Id,S.P=ae,S.Q=Mu,S.R=Uu,S.S=it,S.T=_u,S.U=ct,S.V=gi,S.W=$s,S.X=ws,S.Y=k0,S.Z=class extends hl{},S._=a,S.a=Hi,S.a$=function(m,h){return m[0]*h[0]+m[1]*h[1]+m[2]*h[2]+m[3]*h[3]},S.a0=zc,S.a1=Y,S.a2=m=>{const h=window.document.createElement("video");return h.muted=!0,new Promise(b=>{h.onloadstart=()=>{b(h)};for(const M of m){const q=window.document.createElement("source");zi(M)||(h.crossOrigin="Anonymous"),q.src=M,h.appendChild(q)}})},S.a3=function(){return at++},S.a4=s,S.a5=tA,S.a6=ds,S.a7=vl,S.a8=ms,S.a9=kd,S.aA=xt,S.aB=function(m,h){if(!m)return[{command:"setStyle",args:[h]}];let b=[];try{if(!ci(m.version,h.version))return[{command:"setStyle",args:[h]}];ci(m.center,h.center)||b.push({command:"setCenter",args:[h.center]}),ci(m.zoom,h.zoom)||b.push({command:"setZoom",args:[h.zoom]}),ci(m.bearing,h.bearing)||b.push({command:"setBearing",args:[h.bearing]}),ci(m.pitch,h.pitch)||b.push({command:"setPitch",args:[h.pitch]}),ci(m.sprite,h.sprite)||b.push({command:"setSprite",args:[h.sprite]}),ci(m.glyphs,h.glyphs)||b.push({command:"setGlyphs",args:[h.glyphs]}),ci(m.transition,h.transition)||b.push({command:"setTransition",args:[h.transition]}),ci(m.light,h.light)||b.push({command:"setLight",args:[h.light]}),ci(m.terrain,h.terrain)||b.push({command:"setTerrain",args:[h.terrain]}),ci(m.sky,h.sky)||b.push({command:"setSky",args:[h.sky]});const M={},q=[];(function(J,me,Ce,Ne){let f;for(f in me=me||{},J=J||{})Object.prototype.hasOwnProperty.call(J,f)&&(Object.prototype.hasOwnProperty.call(me,f)||On(f,Ce,Ne));for(f in me)Object.prototype.hasOwnProperty.call(me,f)&&(Object.prototype.hasOwnProperty.call(J,f)?ci(J[f],me[f])||(J[f].type==="geojson"&&me[f].type==="geojson"&&pn(J,me,f)?sn(Ce,{command:"setGeoJSONSourceData",args:[f,me[f].data]}):Gn(f,me,Ce,Ne)):lr(f,me,Ce))})(m.sources,h.sources,q,M);const K=[];m.layers&&m.layers.forEach(J=>{"source"in J&&M[J.source]?b.push({command:"removeLayer",args:[J.id]}):K.push(J)}),b=b.concat(q),function(J,me,Ce){me=me||[];const Ne=(J=J||[]).map(k),f=me.map(k),u=J.reduce(V,{}),p=me.reduce(V,{}),I=Ne.slice(),L=Object.create(null);let G,Q,re,Ae,_e;for(let Le=0,qe=0;Le<Ne.length;Le++)G=Ne[Le],Object.prototype.hasOwnProperty.call(p,G)?qe++:(sn(Ce,{command:"removeLayer",args:[G]}),I.splice(I.indexOf(G,qe),1));for(let Le=0,qe=0;Le<f.length;Le++)G=f[f.length-1-Le],I[I.length-1-Le]!==G&&(Object.prototype.hasOwnProperty.call(u,G)?(sn(Ce,{command:"removeLayer",args:[G]}),I.splice(I.lastIndexOf(G,I.length-qe),1)):qe++,Ae=I[I.length-Le],sn(Ce,{command:"addLayer",args:[p[G],Ae]}),I.splice(I.length-Le,0,G),L[G]=!0);for(let Le=0;Le<f.length;Le++)if(G=f[Le],Q=u[G],re=p[G],!L[G]&&!ci(Q,re))if(ci(Q.source,re.source)&&ci(Q["source-layer"],re["source-layer"])&&ci(Q.type,re.type)){for(_e in v(Q.layout,re.layout,Ce,G,null,"setLayoutProperty"),v(Q.paint,re.paint,Ce,G,null,"setPaintProperty"),ci(Q.filter,re.filter)||sn(Ce,{command:"setFilter",args:[G,re.filter]}),ci(Q.minzoom,re.minzoom)&&ci(Q.maxzoom,re.maxzoom)||sn(Ce,{command:"setLayerZoomRange",args:[G,re.minzoom,re.maxzoom]}),Q)Object.prototype.hasOwnProperty.call(Q,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?v(Q[_e],re[_e],Ce,G,_e.slice(6),"setPaintProperty"):ci(Q[_e],re[_e])||sn(Ce,{command:"setLayerProperty",args:[G,_e,re[_e]]}));for(_e in re)Object.prototype.hasOwnProperty.call(re,_e)&&!Object.prototype.hasOwnProperty.call(Q,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?v(Q[_e],re[_e],Ce,G,_e.slice(6),"setPaintProperty"):ci(Q[_e],re[_e])||sn(Ce,{command:"setLayerProperty",args:[G,_e,re[_e]]}))}else sn(Ce,{command:"removeLayer",args:[G]}),Ae=I[I.lastIndexOf(G)+1],sn(Ce,{command:"addLayer",args:[re,Ae]})}(K,h.layers,b)}catch(M){console.warn("Unable to compute style diff:",M),b=[{command:"setStyle",args:[h]}]}return b},S.aC=function(m){const h=[],b=m.id;return b===void 0&&h.push({message:`layers.${b}: missing required property "id"`}),m.render===void 0&&h.push({message:`layers.${b}: missing required method "render"`}),m.renderingMode&&m.renderingMode!=="2d"&&m.renderingMode!=="3d"&&h.push({message:`layers.${b}: property "renderingMode" must be either "2d" or "3d"`}),h},S.aD=function m(h,b){if(Array.isArray(h)){if(!Array.isArray(b)||h.length!==b.length)return!1;for(let M=0;M<h.length;M++)if(!m(h[M],b[M]))return!1;return!0}if(typeof h=="object"&&h!==null&&b!==null){if(typeof b!="object"||Object.keys(h).length!==Object.keys(b).length)return!1;for(const M in h)if(!m(h[M],b[M]))return!1;return!0}return h===b},S.aE=_t,S.aF=mt,S.aG=class extends lo{constructor(m,h){super(m,h),this.current=0}set(m){this.current!==m&&(this.current=m,this.gl.uniform1i(this.location,m))}},S.aH=qr,S.aI=class extends lo{constructor(m,h){super(m,h),this.current=bo}set(m){if(m[12]!==this.current[12]||m[0]!==this.current[0])return this.current=m,void this.gl.uniformMatrix4fv(this.location,!1,m);for(let h=1;h<16;h++)if(m[h]!==this.current[h]){this.current=m,this.gl.uniformMatrix4fv(this.location,!1,m);break}}},S.aJ=ya,S.aK=class extends lo{constructor(m,h){super(m,h),this.current=[0,0,0]}set(m){m[0]===this.current[0]&&m[1]===this.current[1]&&m[2]===this.current[2]||(this.current=m,this.gl.uniform3f(this.location,m[0],m[1],m[2]))}},S.aL=class extends lo{constructor(m,h){super(m,h),this.current=[0,0]}set(m){m[0]===this.current[0]&&m[1]===this.current[1]||(this.current=m,this.gl.uniform2f(this.location,m[0],m[1]))}},S.aM=xo,S.aN=function(m,h,b,M,q,K,J){var me=1/(h-b),Ce=1/(M-q),Ne=1/(K-J);return m[0]=-2*me,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=-2*Ce,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=2*Ne,m[11]=0,m[12]=(h+b)*me,m[13]=(q+M)*Ce,m[14]=(J+K)*Ne,m[15]=1,m},S.aO=mn,S.aP=mA,S.aQ=class extends We{},S.aR=ad,S.aS=class extends Ct{},S.aT=function(m){return m<=1?1:Math.pow(2,Math.ceil(Math.log(m)/Math.LN2))},S.aU=_A,S.aV=ue,S.aW=class extends F{},S.aX=Kt,S.aY=function(m,h){var b=m[0],M=m[1],q=m[2],K=m[3],J=m[4],me=m[5],Ce=m[6],Ne=m[7],f=m[8],u=m[9],p=m[10],I=m[11],L=m[12],G=m[13],Q=m[14],re=m[15],Ae=h[0],_e=h[1],Le=h[2],qe=h[3],tt=h[4],ft=h[5],gt=h[6],Mt=h[7],Pt=h[8],Lt=h[9],ei=h[10],Ht=h[11],Qt=h[12],hi=h[13],_i=h[14],Xi=h[15];return Math.abs(b-Ae)<=Kl*Math.max(1,Math.abs(b),Math.abs(Ae))&&Math.abs(M-_e)<=Kl*Math.max(1,Math.abs(M),Math.abs(_e))&&Math.abs(q-Le)<=Kl*Math.max(1,Math.abs(q),Math.abs(Le))&&Math.abs(K-qe)<=Kl*Math.max(1,Math.abs(K),Math.abs(qe))&&Math.abs(J-tt)<=Kl*Math.max(1,Math.abs(J),Math.abs(tt))&&Math.abs(me-ft)<=Kl*Math.max(1,Math.abs(me),Math.abs(ft))&&Math.abs(Ce-gt)<=Kl*Math.max(1,Math.abs(Ce),Math.abs(gt))&&Math.abs(Ne-Mt)<=Kl*Math.max(1,Math.abs(Ne),Math.abs(Mt))&&Math.abs(f-Pt)<=Kl*Math.max(1,Math.abs(f),Math.abs(Pt))&&Math.abs(u-Lt)<=Kl*Math.max(1,Math.abs(u),Math.abs(Lt))&&Math.abs(p-ei)<=Kl*Math.max(1,Math.abs(p),Math.abs(ei))&&Math.abs(I-Ht)<=Kl*Math.max(1,Math.abs(I),Math.abs(Ht))&&Math.abs(L-Qt)<=Kl*Math.max(1,Math.abs(L),Math.abs(Qt))&&Math.abs(G-hi)<=Kl*Math.max(1,Math.abs(G),Math.abs(hi))&&Math.abs(Q-_i)<=Kl*Math.max(1,Math.abs(Q),Math.abs(_i))&&Math.abs(re-Xi)<=Kl*Math.max(1,Math.abs(re),Math.abs(Xi))},S.aZ=function(m,h){return m[0]=h[0],m[1]=h[1],m[2]=h[2],m[3]=h[3],m[4]=h[4],m[5]=h[5],m[6]=h[6],m[7]=h[7],m[8]=h[8],m[9]=h[9],m[10]=h[10],m[11]=h[11],m[12]=h[12],m[13]=h[13],m[14]=h[14],m[15]=h[15],m},S.a_=function(m,h,b){return m[0]=h[0]*b[0],m[1]=h[1]*b[1],m[2]=h[2]*b[2],m[3]=h[3]*b[3],m},S.aa=function(m){const h={};if(m.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(b,M,q,K)=>{const J=q||K;return h[M]=!J||J.toLowerCase(),""}),h["max-age"]){const b=parseInt(h["max-age"],10);isNaN(b)?delete h["max-age"]:h["max-age"]=b}return h},S.ab=function(m,h){const b=[];for(const M in m)M in h||b.push(M);return b},S.ac=Rt,S.ad=function(m,h,b){var M=Math.sin(b),q=Math.cos(b),K=h[0],J=h[1],me=h[2],Ce=h[3],Ne=h[4],f=h[5],u=h[6],p=h[7];return h!==m&&(m[8]=h[8],m[9]=h[9],m[10]=h[10],m[11]=h[11],m[12]=h[12],m[13]=h[13],m[14]=h[14],m[15]=h[15]),m[0]=K*q+Ne*M,m[1]=J*q+f*M,m[2]=me*q+u*M,m[3]=Ce*q+p*M,m[4]=Ne*q-K*M,m[5]=f*q-J*M,m[6]=u*q-me*M,m[7]=p*q-Ce*M,m},S.ae=function(m){var h=new Yu(16);return h[0]=m[0],h[1]=m[1],h[2]=m[2],h[3]=m[3],h[4]=m[4],h[5]=m[5],h[6]=m[6],h[7]=m[7],h[8]=m[8],h[9]=m[9],h[10]=m[10],h[11]=m[11],h[12]=m[12],h[13]=m[13],h[14]=m[14],h[15]=m[15],h},S.af=uf,S.ag=function(m,h){let b=0,M=0;if(m.kind==="constant")M=m.layoutSize;else if(m.kind!=="source"){const{interpolationType:q,minZoom:K,maxZoom:J}=m,me=q?Rt(Ks.interpolationFactor(q,h,K,J),0,1):0;m.kind==="camera"?M=xr.number(m.minSize,m.maxSize,me):b=me}return{uSizeT:b,uSize:M}},S.ai=function(m,{uSize:h,uSizeT:b},{lowerSize:M,upperSize:q}){return m.kind==="source"?M/Lc:m.kind==="composite"?xr.number(M/Lc,q/Lc,b):h},S.aj=C0,S.ak=function(m,h,b,M){const q=h.y-m.y,K=h.x-m.x,J=M.y-b.y,me=M.x-b.x,Ce=J*K-me*q;if(Ce===0)return null;const Ne=(me*(m.y-b.y)-J*(m.x-b.x))/Ce;return new ae(m.x+Ne*K,m.y+Ne*q)},S.al=Dd,S.am=af,S.an=Z0,S.ao=Al,S.aq=kf,S.ar=function(m,h){var b=h[0],M=h[1],q=h[2],K=h[3],J=h[4],me=h[5],Ce=h[6],Ne=h[7],f=h[8],u=h[9],p=h[10],I=h[11],L=h[12],G=h[13],Q=h[14],re=h[15],Ae=b*me-M*J,_e=b*Ce-q*J,Le=b*Ne-K*J,qe=M*Ce-q*me,tt=M*Ne-K*me,ft=q*Ne-K*Ce,gt=f*G-u*L,Mt=f*Q-p*L,Pt=f*re-I*L,Lt=u*Q-p*G,ei=u*re-I*G,Ht=p*re-I*Q,Qt=Ae*Ht-_e*ei+Le*Lt+qe*Pt-tt*Mt+ft*gt;return Qt?(m[0]=(me*Ht-Ce*ei+Ne*Lt)*(Qt=1/Qt),m[1]=(q*ei-M*Ht-K*Lt)*Qt,m[2]=(G*ft-Q*tt+re*qe)*Qt,m[3]=(p*tt-u*ft-I*qe)*Qt,m[4]=(Ce*Pt-J*Ht-Ne*Mt)*Qt,m[5]=(b*Ht-q*Pt+K*Mt)*Qt,m[6]=(Q*Le-L*ft-re*_e)*Qt,m[7]=(f*ft-p*Le+I*_e)*Qt,m[8]=(J*ei-me*Pt+Ne*gt)*Qt,m[9]=(M*Pt-b*ei-K*gt)*Qt,m[10]=(L*tt-G*Le+re*Ae)*Qt,m[11]=(u*Le-f*tt-I*Ae)*Qt,m[12]=(me*Mt-J*Lt-Ce*gt)*Qt,m[13]=(b*Lt-M*Mt+q*gt)*Qt,m[14]=(G*_e-L*qe-Q*Ae)*Qt,m[15]=(f*qe-u*_e+p*Ae)*Qt,m):null},S.as=B0,S.at=OA,S.au=Rc,S.av=function(){const m={},h=Xt.$version;for(const b in Xt.$root){const M=Xt.$root[b];if(M.required){let q=null;q=b==="version"?h:M.type==="array"?[]:{},q!=null&&(m[b]=q)}}return m},S.aw=$l,S.ax=Ei,S.ay=function(m){m=m.slice();const h=Object.create(null);for(let b=0;b<m.length;b++)h[m[b].id]=m[b];for(let b=0;b<m.length;b++)"ref"in m[b]&&(m[b]=mr(m[b],h[m[b].ref]));return m},S.az=function(m){if(m.type==="custom")return new wd(m);switch(m.type){case"background":return new xd(m);case"circle":return new A0(m);case"fill":return new g0(m);case"fill-extrusion":return new Jh(m);case"heatmap":return new f0(m);case"hillshade":return new xu(m);case"line":return new Bm(m);case"raster":return new Lp(m);case"symbol":return new NA(m)}},S.b=Bt,S.b0=Oe,S.b1=Ed,S.b2=Fp,S.b3=function(m,h,b,M,q){var K,J=1/Math.tan(h/2);return m[0]=J/b,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=J,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[11]=-1,m[12]=0,m[13]=0,m[15]=0,q!=null&&q!==1/0?(m[10]=(q+M)*(K=1/(M-q)),m[14]=2*q*M*K):(m[10]=-1,m[14]=-2*M),m},S.b4=function(m,h,b){var M=Math.sin(b),q=Math.cos(b),K=h[4],J=h[5],me=h[6],Ce=h[7],Ne=h[8],f=h[9],u=h[10],p=h[11];return h!==m&&(m[0]=h[0],m[1]=h[1],m[2]=h[2],m[3]=h[3],m[12]=h[12],m[13]=h[13],m[14]=h[14],m[15]=h[15]),m[4]=K*q+Ne*M,m[5]=J*q+f*M,m[6]=me*q+u*M,m[7]=Ce*q+p*M,m[8]=Ne*q-K*M,m[9]=f*q-J*M,m[10]=u*q-me*M,m[11]=p*q-Ce*M,m},S.b5=Tt,S.b6=zt,S.b7=function(m){return m*Math.PI/180},S.b8=function(m,h){return m[0]=h[0],m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=h[1],m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=h[2],m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,m},S.b9=class extends fs{},S.ba=VA,S.bb=Gp,S.bd=vn,S.be=function(m,h){Hi.REGISTERED_PROTOCOLS[m]=h},S.bf=function(m){delete Hi.REGISTERED_PROTOCOLS[m]},S.bg=function(m,h){const b={};for(let q=0;q<m.length;q++){const K=h&&h[m[q].id]||Jo(m[q]);h&&(h[m[q].id]=K);let J=b[K];J||(J=b[K]=[]),J.push(m[q])}const M=[];for(const q in b)M.push(b[q]);return M},S.bh=In,S.bi=Td,S.bj=P0,S.bk=w0,S.bl=function(m){m.bucket.createArrays(),m.bucket.tilePixelRatio=$s/(512*m.bucket.overscaling),m.bucket.compareText={},m.bucket.iconsNeedLinear=!1;const h=m.bucket.layers[0],b=h.layout,M=h._unevaluatedLayout._values,q={layoutIconSize:M["icon-size"].possiblyEvaluate(new ms(m.bucket.zoom+1),m.canonical),layoutTextSize:M["text-size"].possiblyEvaluate(new ms(m.bucket.zoom+1),m.canonical),textMaxSize:M["text-size"].possiblyEvaluate(new ms(18))};if(m.bucket.textSizeData.kind==="composite"){const{minZoom:Ne,maxZoom:f}=m.bucket.textSizeData;q.compositeTextSizes=[M["text-size"].possiblyEvaluate(new ms(Ne),m.canonical),M["text-size"].possiblyEvaluate(new ms(f),m.canonical)]}if(m.bucket.iconSizeData.kind==="composite"){const{minZoom:Ne,maxZoom:f}=m.bucket.iconSizeData;q.compositeIconSizes=[M["icon-size"].possiblyEvaluate(new ms(Ne),m.canonical),M["icon-size"].possiblyEvaluate(new ms(f),m.canonical)]}const K=b.get("text-line-height")*Al,J=b.get("text-rotation-alignment")!=="viewport"&&b.get("symbol-placement")!=="point",me=b.get("text-keep-upright"),Ce=b.get("text-size");for(const Ne of m.bucket.features){const f=b.get("text-font").evaluate(Ne,{},m.canonical).join(","),u=Ce.evaluate(Ne,{},m.canonical),p=q.layoutTextSize.evaluate(Ne,{},m.canonical),I=q.layoutIconSize.evaluate(Ne,{},m.canonical),L={horizontal:{},vertical:void 0},G=Ne.text;let Q,re=[0,0];if(G){const Le=G.toString(),qe=b.get("text-letter-spacing").evaluate(Ne,{},m.canonical)*Al,tt=uu(Le)?qe:0,ft=b.get("text-anchor").evaluate(Ne,{},m.canonical),gt=rA(h,Ne,m.canonical);if(!gt){const Ht=b.get("text-radial-offset").evaluate(Ne,{},m.canonical);re=Ht?jA(ft,[Ht*Al,nA]):b.get("text-offset").evaluate(Ne,{},m.canonical).map(Qt=>Qt*Al)}let Mt=J?"center":b.get("text-justify").evaluate(Ne,{},m.canonical);const Pt=b.get("symbol-placement"),Lt=Pt==="point"?b.get("text-max-width").evaluate(Ne,{},m.canonical)*Al:0,ei=()=>{m.bucket.allowVerticalPlacement&&_l(Le)&&(L.vertical=Cf(G,m.glyphMap,m.glyphPositions,m.imagePositions,f,Lt,K,ft,"left",tt,re,S.ah.vertical,!0,Pt,p,u))};if(!J&&gt){const Ht=new Set;if(Mt==="auto")for(let hi=0;hi<gt.values.length;hi+=2)Ht.add(B0(gt.values[hi]));else Ht.add(Mt);let Qt=!1;for(const hi of Ht)if(!L.horizontal[hi])if(Qt)L.horizontal[hi]=L.horizontal[0];else{const _i=Cf(G,m.glyphMap,m.glyphPositions,m.imagePositions,f,Lt,K,"center",hi,tt,re,S.ah.horizontal,!1,Pt,p,u);_i&&(L.horizontal[hi]=_i,Qt=_i.positionedLines.length===1)}ei()}else{Mt==="auto"&&(Mt=B0(ft));const Ht=Cf(G,m.glyphMap,m.glyphPositions,m.imagePositions,f,Lt,K,ft,Mt,tt,re,S.ah.horizontal,!1,Pt,p,u);Ht&&(L.horizontal[Mt]=Ht),ei(),_l(Le)&&J&&me&&(L.vertical=Cf(G,m.glyphMap,m.glyphPositions,m.imagePositions,f,Lt,K,ft,Mt,tt,re,S.ah.vertical,!1,Pt,p,u))}}let Ae=!1;if(Ne.icon&&Ne.icon.name){const Le=m.imageMap[Ne.icon.name];Le&&(Q=Nm(m.imagePositions[Ne.icon.name],b.get("icon-offset").evaluate(Ne,{},m.canonical),b.get("icon-anchor").evaluate(Ne,{},m.canonical)),Ae=!!Le.sdf,m.bucket.sdfIcons===void 0?m.bucket.sdfIcons=Ae:m.bucket.sdfIcons!==Ae&&lt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Le.pixelRatio!==m.bucket.pixelRatio||b.get("icon-rotate").constantOr(1)!==0)&&(m.bucket.iconsNeedLinear=!0))}const _e=Od(L.horizontal)||L.vertical;m.bucket.iconsInText=!!_e&&_e.iconsInText,(_e||Q)&&Up(m.bucket,Ne,L,Q,m.imageMap,q,p,I,re,Ae,m.canonical)}m.showCollisionBoxes&&m.bucket.generateCollisionDebugBuffers()},S.bm=eA,S.bn=$h,S.bo=SA,S.bp=hc,S.bq=fd,S.br=class{constructor(m){this._marks={start:[m.url,"start"].join("#"),end:[m.url,"end"].join("#"),measure:m.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let m=performance.getEntriesByName(this._marks.measure);return m.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),m=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),m}},S.bs=function(m,h,b,M,q){return a(this,void 0,void 0,function*(){if(ct())try{return yield gi(m,h,b,M,q)}catch{}return function(K,J,me,Ce,Ne){const f=K.width,u=K.height;Ii&&Ci||(Ii=new OffscreenCanvas(f,u),Ci=Ii.getContext("2d",{willReadFrequently:!0})),Ii.width=f,Ii.height=u,Ci.drawImage(K,0,0,f,u);const p=Ci.getImageData(J,me,Ce,Ne);return Ci.clearRect(0,0,f,u),p.data}(m,h,b,M,q)})},S.bt=Cd,S.bu=U,S.bv=W,S.bw=od,S.bx=Ms,S.by=function(m){return m.message===Ri},S.bz=Xl,S.c=Ki,S.d=m=>a(void 0,void 0,void 0,function*(){if(m.byteLength===0)return createImageBitmap(new ImageData(1,1));const h=new Blob([new Uint8Array(m)],{type:"image/png"});try{return createImageBitmap(h)}catch(b){throw new Error(`Could not load image because of ${b.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),S.e=jt,S.f=m=>new Promise((h,b)=>{const M=new Image;M.onload=()=>{h(M),URL.revokeObjectURL(M.src),M.onload=null,window.requestAnimationFrame(()=>{M.src=Ot})},M.onerror=()=>b(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const q=new Blob([new Uint8Array(m)],{type:"image/png"});M.src=m.byteLength?URL.createObjectURL(q):Ot}),S.g=Ni,S.h=(m,h)=>mi(jt(m,{type:"json"}),h),S.i=ut,S.j=Yt,S.k=bn,S.l=(m,h)=>mi(jt(m,{type:"arrayBuffer"}),h),S.m=mi,S.n=function(m){return new fd(m).readFields(Rm,[])},S.o=Dl,S.p=LA,S.q=oa,S.r=$u,S.s=zi,S.t=Ml,S.u=Cn,S.v=Xt,S.w=lt,S.x=os,S.y=function([m,h,b]){return h+=90,h*=Math.PI/180,b*=Math.PI/180,{x:m*Math.cos(h)*Math.sin(b),y:m*Math.sin(h)*Math.sin(b),z:m*Math.cos(b)}},S.z=xr}),g("worker",["./shared"],function(S){class a{constructor(se){this.keyCache={},se&&this.replace(se)}replace(se){this._layerConfigs={},this._layers={},this.update(se,[])}update(se,ne){for(const ie of se){this._layerConfigs[ie.id]=ie;const de=this._layers[ie.id]=S.az(ie);de._featureFilter=S.a6(de.filter),this.keyCache[ie.id]&&delete this.keyCache[ie.id]}for(const ie of ne)delete this.keyCache[ie],delete this._layerConfigs[ie],delete this._layers[ie];this.familiesBySource={};const $=S.bg(Object.values(this._layerConfigs),this.keyCache);for(const ie of $){const de=ie.map(Xe=>this._layers[Xe.id]),ye=de[0];if(ye.visibility==="none")continue;const ge=ye.source||"";let Pe=this.familiesBySource[ge];Pe||(Pe=this.familiesBySource[ge]={});const Fe=ye.sourceLayer||"_geojsonTileLayer";let Ve=Pe[Fe];Ve||(Ve=Pe[Fe]=[]),Ve.push(de)}}}class U{constructor(se){const ne={},$=[];for(const ge in se){const Pe=se[ge],Fe=ne[ge]={};for(const Ve in Pe){const Xe=Pe[+Ve];if(!Xe||Xe.bitmap.width===0||Xe.bitmap.height===0)continue;const Ke={x:0,y:0,w:Xe.bitmap.width+2,h:Xe.bitmap.height+2};$.push(Ke),Fe[Ve]={rect:Ke,metrics:Xe.metrics}}}const{w:ie,h:de}=S.p($),ye=new S.o({width:ie||1,height:de||1});for(const ge in se){const Pe=se[ge];for(const Fe in Pe){const Ve=Pe[+Fe];if(!Ve||Ve.bitmap.width===0||Ve.bitmap.height===0)continue;const Xe=ne[ge][Fe].rect;S.o.copy(Ve.bitmap,ye,{x:0,y:0},{x:Xe.x+1,y:Xe.y+1},Ve.bitmap)}}this.image=ye,this.positions=ne}}S.bh("GlyphAtlas",U);class W{constructor(se){this.tileID=new S.Q(se.tileID.overscaledZ,se.tileID.wrap,se.tileID.canonical.z,se.tileID.canonical.x,se.tileID.canonical.y),this.uid=se.uid,this.zoom=se.zoom,this.pixelRatio=se.pixelRatio,this.tileSize=se.tileSize,this.source=se.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=se.showCollisionBoxes,this.collectResourceTiming=!!se.collectResourceTiming,this.returnDependencies=!!se.returnDependencies,this.promoteId=se.promoteId,this.inFlightDependencies=[]}parse(se,ne,$,ie){return S._(this,void 0,void 0,function*(){this.status="parsing",this.data=se,this.collisionBoxArray=new S.a4;const de=new S.bi(Object.keys(se.layers).sort()),ye=new S.bj(this.tileID,this.promoteId);ye.bucketLayerIDs=[];const ge={},Pe={featureIndex:ye,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:$},Fe=ne.familiesBySource[this.source];for(const Ai in Fe){const ti=se.layers[Ai];if(!ti)continue;ti.version===1&&S.w(`Vector tile source "${this.source}" layer "${Ai}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const li=de.encode(Ai),Bi=[];for(let vi=0;vi<ti.length;vi++){const bi=ti.feature(vi),Jt=ye.getId(bi,Ai);Bi.push({feature:bi,id:Jt,index:vi,sourceLayerIndex:li})}for(const vi of Fe[Ai]){const bi=vi[0];bi.source!==this.source&&S.w(`layer.source = ${bi.source} does not equal this.source = ${this.source}`),bi.minzoom&&this.zoom<Math.floor(bi.minzoom)||bi.maxzoom&&this.zoom>=bi.maxzoom||bi.visibility!=="none"&&(he(vi,this.zoom,$),(ge[bi.id]=bi.createBucket({index:ye.bucketLayerIDs.length,layers:vi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:li,sourceID:this.source})).populate(Bi,Pe,this.tileID.canonical),ye.bucketLayerIDs.push(vi.map(Jt=>Jt.id)))}}const Ve=S.aE(Pe.glyphDependencies,Ai=>Object.keys(Ai).map(Number));this.inFlightDependencies.forEach(Ai=>Ai==null?void 0:Ai.abort()),this.inFlightDependencies=[];let Xe=Promise.resolve({});if(Object.keys(Ve).length){const Ai=new AbortController;this.inFlightDependencies.push(Ai),Xe=ie.sendAsync({type:"getGlyphs",data:{stacks:Ve,source:this.source,tileID:this.tileID,type:"glyphs"}},Ai)}const Ke=Object.keys(Pe.iconDependencies);let De=Promise.resolve({});if(Ke.length){const Ai=new AbortController;this.inFlightDependencies.push(Ai),De=ie.sendAsync({type:"getImages",data:{icons:Ke,source:this.source,tileID:this.tileID,type:"icons"}},Ai)}const Ge=Object.keys(Pe.patternDependencies);let At=Promise.resolve({});if(Ge.length){const Ai=new AbortController;this.inFlightDependencies.push(Ai),At=ie.sendAsync({type:"getImages",data:{icons:Ge,source:this.source,tileID:this.tileID,type:"patterns"}},Ai)}const[kt,o,ke]=yield Promise.all([Xe,De,At]),oi=new U(kt),fi=new S.bk(o,ke);for(const Ai in ge){const ti=ge[Ai];ti instanceof S.a5?(he(ti.layers,this.zoom,$),S.bl({bucket:ti,glyphMap:kt,glyphPositions:oi.positions,imageMap:o,imagePositions:fi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):ti.hasPattern&&(ti instanceof S.bm||ti instanceof S.bn||ti instanceof S.bo)&&(he(ti.layers,this.zoom,$),ti.addFeatures(Pe,this.tileID.canonical,fi.patternPositions))}return this.status="done",{buckets:Object.values(ge).filter(Ai=>!Ai.isEmpty()),featureIndex:ye,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:oi.image,imageAtlas:fi,glyphMap:this.returnDependencies?kt:null,iconMap:this.returnDependencies?o:null,glyphPositions:this.returnDependencies?oi.positions:null}})}}function he(Me,se,ne){const $=new S.a8(se);for(const ie of Me)ie.recalculate($,ne)}class ae{constructor(se,ne,$){this.actor=se,this.layerIndex=ne,this.availableImages=$,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(se,ne){return S._(this,void 0,void 0,function*(){const $=yield S.l(se.request,ne);try{return{vectorTile:new S.bp.VectorTile(new S.bq($.data)),rawData:$.data,cacheControl:$.cacheControl,expires:$.expires}}catch(ie){const de=new Uint8Array($.data);let ye=`Unable to parse the tile at ${se.request.url}, `;throw ye+=de[0]===31&&de[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ie.messge}`,new Error(ye)}})}loadTile(se){return S._(this,void 0,void 0,function*(){const ne=se.uid,$=!!(se&&se.request&&se.request.collectResourceTiming)&&new S.br(se.request),ie=new W(se);this.loading[ne]=ie;const de=new AbortController;ie.abort=de;try{const ye=yield this.loadVectorTile(se,de);if(delete this.loading[ne],!ye)return null;const ge=ye.rawData,Pe={};ye.expires&&(Pe.expires=ye.expires),ye.cacheControl&&(Pe.cacheControl=ye.cacheControl);const Fe={};if($){const Xe=$.finish();Xe&&(Fe.resourceTiming=JSON.parse(JSON.stringify(Xe)))}ie.vectorTile=ye.vectorTile;const Ve=ie.parse(ye.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[ne]=ie,this.fetching[ne]={rawTileData:ge,cacheControl:Pe,resourceTiming:Fe};try{const Xe=yield Ve;return S.e({rawTileData:ge.slice(0)},Xe,Pe,Fe)}finally{delete this.fetching[ne]}}catch(ye){throw delete this.loading[ne],ie.status="done",this.loaded[ne]=ie,ye}})}reloadTile(se){return S._(this,void 0,void 0,function*(){const ne=se.uid;if(!this.loaded||!this.loaded[ne])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const $=this.loaded[ne];if($.showCollisionBoxes=se.showCollisionBoxes,$.status==="parsing"){const ie=yield $.parse($.vectorTile,this.layerIndex,this.availableImages,this.actor);let de;if(this.fetching[ne]){const{rawTileData:ye,cacheControl:ge,resourceTiming:Pe}=this.fetching[ne];delete this.fetching[ne],de=S.e({rawTileData:ye.slice(0)},ie,ge,Pe)}else de=ie;return de}if($.status==="done"&&$.vectorTile)return $.parse($.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(se){return S._(this,void 0,void 0,function*(){const ne=this.loading,$=se.uid;ne&&ne[$]&&ne[$].abort&&(ne[$].abort.abort(),delete ne[$])})}removeTile(se){return S._(this,void 0,void 0,function*(){this.loaded&&this.loaded[se.uid]&&delete this.loaded[se.uid]})}}class ce{constructor(){this.loaded={}}loadTile(se){return S._(this,void 0,void 0,function*(){const{uid:ne,encoding:$,rawImageData:ie,redFactor:de,greenFactor:ye,blueFactor:ge,baseShift:Pe}=se,Fe=ie.width+2,Ve=ie.height+2,Xe=S.b(ie)?new S.R({width:Fe,height:Ve},yield S.bs(ie,-1,-1,Fe,Ve)):ie,Ke=new S.bt(ne,Xe,$,de,ye,ge,Pe);return this.loaded=this.loaded||{},this.loaded[ne]=Ke,Ke})}removeTile(se){const ne=this.loaded,$=se.uid;ne&&ne[$]&&delete ne[$]}}function be(Me,se){if(Me.length!==0){Je(Me[0],se);for(var ne=1;ne<Me.length;ne++)Je(Me[ne],!se)}}function Je(Me,se){for(var ne=0,$=0,ie=0,de=Me.length,ye=de-1;ie<de;ye=ie++){var ge=(Me[ie][0]-Me[ye][0])*(Me[ye][1]+Me[ie][1]),Pe=ne+ge;$+=Math.abs(ne)>=Math.abs(ge)?ne-Pe+ge:ge-Pe+ne,ne=Pe}ne+$>=0!=!!se&&Me.reverse()}var st=S.bu(function Me(se,ne){var $,ie=se&&se.type;if(ie==="FeatureCollection")for($=0;$<se.features.length;$++)Me(se.features[$],ne);else if(ie==="GeometryCollection")for($=0;$<se.geometries.length;$++)Me(se.geometries[$],ne);else if(ie==="Feature")Me(se.geometry,ne);else if(ie==="Polygon")be(se.coordinates,ne);else if(ie==="MultiPolygon")for($=0;$<se.coordinates.length;$++)be(se.coordinates[$],ne);return se});const Ye=S.bp.VectorTileFeature.prototype.toGeoJSON;var it={exports:{}},ct=S.bv,Tt=S.bp.VectorTileFeature,zt=Rt;function Rt(Me,se){this.options=se||{},this.features=Me,this.length=Me.length}function Oe(Me,se){this.id=typeof Me.id=="number"?Me.id:void 0,this.type=Me.type,this.rawGeometry=Me.type===1?[Me.geometry]:Me.geometry,this.properties=Me.tags,this.extent=se||4096}Rt.prototype.feature=function(Me){return new Oe(this.features[Me],this.options.extent)},Oe.prototype.loadGeometry=function(){var Me=this.rawGeometry;this.geometry=[];for(var se=0;se<Me.length;se++){for(var ne=Me[se],$=[],ie=0;ie<ne.length;ie++)$.push(new ct(ne[ie][0],ne[ie][1]));this.geometry.push($)}return this.geometry},Oe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Me=this.geometry,se=1/0,ne=-1/0,$=1/0,ie=-1/0,de=0;de<Me.length;de++)for(var ye=Me[de],ge=0;ge<ye.length;ge++){var Pe=ye[ge];se=Math.min(se,Pe.x),ne=Math.max(ne,Pe.x),$=Math.min($,Pe.y),ie=Math.max(ie,Pe.y)}return[se,$,ne,ie]},Oe.prototype.toGeoJSON=Tt.prototype.toGeoJSON;var jt=S.bw,at=zt;function _t(Me){var se=new jt;return function(ne,$){for(var ie in ne.layers)$.writeMessage(3,mt,ne.layers[ie])}(Me,se),se.finish()}function mt(Me,se){var ne;se.writeVarintField(15,Me.version||1),se.writeStringField(1,Me.name||""),se.writeVarintField(5,Me.extent||4096);var $={keys:[],values:[],keycache:{},valuecache:{}};for(ne=0;ne<Me.length;ne++)$.feature=Me.feature(ne),se.writeMessage(2,xt,$);var ie=$.keys;for(ne=0;ne<ie.length;ne++)se.writeStringField(3,ie[ne]);var de=$.values;for(ne=0;ne<de.length;ne++)se.writeMessage(4,ut,de[ne])}function xt(Me,se){var ne=Me.feature;ne.id!==void 0&&se.writeVarintField(1,ne.id),se.writeMessage(2,bt,Me),se.writeVarintField(3,ne.type),se.writeMessage(4,pt,ne)}function bt(Me,se){var ne=Me.feature,$=Me.keys,ie=Me.values,de=Me.keycache,ye=Me.valuecache;for(var ge in ne.properties){var Pe=ne.properties[ge],Fe=de[ge];if(Pe!==null){Fe===void 0&&($.push(ge),de[ge]=Fe=$.length-1),se.writeVarint(Fe);var Ve=typeof Pe;Ve!=="string"&&Ve!=="boolean"&&Ve!=="number"&&(Pe=JSON.stringify(Pe));var Xe=Ve+":"+Pe,Ke=ye[Xe];Ke===void 0&&(ie.push(Pe),ye[Xe]=Ke=ie.length-1),se.writeVarint(Ke)}}}function lt(Me,se){return(se<<3)+(7&Me)}function $e(Me){return Me<<1^Me>>31}function pt(Me,se){for(var ne=Me.loadGeometry(),$=Me.type,ie=0,de=0,ye=ne.length,ge=0;ge<ye;ge++){var Pe=ne[ge],Fe=1;$===1&&(Fe=Pe.length),se.writeVarint(lt(1,Fe));for(var Ve=$===3?Pe.length-1:Pe.length,Xe=0;Xe<Ve;Xe++){Xe===1&&$!==1&&se.writeVarint(lt(2,Ve-1));var Ke=Pe[Xe].x-ie,De=Pe[Xe].y-de;se.writeVarint($e(Ke)),se.writeVarint($e(De)),ie+=Ke,de+=De}$===3&&se.writeVarint(lt(7,1))}}function ut(Me,se){var ne=typeof Me;ne==="string"?se.writeStringField(1,Me):ne==="boolean"?se.writeBooleanField(7,Me):ne==="number"&&(Me%1!=0?se.writeDoubleField(3,Me):Me<0?se.writeSVarintField(6,Me):se.writeVarintField(5,Me))}it.exports=_t,it.exports.fromVectorTileJs=_t,it.exports.fromGeojsonVt=function(Me,se){se=se||{};var ne={};for(var $ in Me)ne[$]=new at(Me[$].features,se),ne[$].name=$,ne[$].version=se.version,ne[$].extent=se.extent;return _t({layers:ne})},it.exports.GeoJSONWrapper=at;var Nt=S.bu(it.exports);const Bt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Me=>Me},Ot=Math.fround||(gi=new Float32Array(1),Me=>(gi[0]=+Me,gi[0]));var gi;const Ii=3,Ci=5,Ri=6;class Ki{constructor(se){this.options=Object.assign(Object.create(Bt),se),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(se){const{log:ne,minZoom:$,maxZoom:ie}=this.options;ne&&console.time("total time");const de=`prepare ${se.length} points`;ne&&console.time(de),this.points=se;const ye=[];for(let Pe=0;Pe<se.length;Pe++){const Fe=se[Pe];if(!Fe.geometry)continue;const[Ve,Xe]=Fe.geometry.coordinates,Ke=Ot(nn(Ve)),De=Ot(vn(Xe));ye.push(Ke,De,1/0,Pe,-1,1),this.options.reduce&&ye.push(0)}let ge=this.trees[ie+1]=this._createTree(ye);ne&&console.timeEnd(de);for(let Pe=ie;Pe>=$;Pe--){const Fe=+Date.now();ge=this.trees[Pe]=this._createTree(this._cluster(ge,Pe)),ne&&console.log("z%d: %d clusters in %dms",Pe,ge.numItems,+Date.now()-Fe)}return ne&&console.timeEnd("total time"),this}getClusters(se,ne){let $=((se[0]+180)%360+360)%360-180;const ie=Math.max(-90,Math.min(90,se[1]));let de=se[2]===180?180:((se[2]+180)%360+360)%360-180;const ye=Math.max(-90,Math.min(90,se[3]));if(se[2]-se[0]>=360)$=-180,de=180;else if($>de){const Xe=this.getClusters([$,ie,180,ye],ne),Ke=this.getClusters([-180,ie,de,ye],ne);return Xe.concat(Ke)}const ge=this.trees[this._limitZoom(ne)],Pe=ge.range(nn($),vn(ye),nn(de),vn(ie)),Fe=ge.data,Ve=[];for(const Xe of Pe){const Ke=this.stride*Xe;Ve.push(Fe[Ke+Ci]>1?Hi(Fe,Ke,this.clusterProps):this.points[Fe[Ke+Ii]])}return Ve}getChildren(se){const ne=this._getOriginId(se),$=this._getOriginZoom(se),ie="No cluster with the specified id.",de=this.trees[$];if(!de)throw new Error(ie);const ye=de.data;if(ne*this.stride>=ye.length)throw new Error(ie);const ge=this.options.radius/(this.options.extent*Math.pow(2,$-1)),Pe=de.within(ye[ne*this.stride],ye[ne*this.stride+1],ge),Fe=[];for(const Ve of Pe){const Xe=Ve*this.stride;ye[Xe+4]===se&&Fe.push(ye[Xe+Ci]>1?Hi(ye,Xe,this.clusterProps):this.points[ye[Xe+Ii]])}if(Fe.length===0)throw new Error(ie);return Fe}getLeaves(se,ne,$){const ie=[];return this._appendLeaves(ie,se,ne=ne||10,$=$||0,0),ie}getTile(se,ne,$){const ie=this.trees[this._limitZoom(se)],de=Math.pow(2,se),{extent:ye,radius:ge}=this.options,Pe=ge/ye,Fe=($-Pe)/de,Ve=($+1+Pe)/de,Xe={features:[]};return this._addTileFeatures(ie.range((ne-Pe)/de,Fe,(ne+1+Pe)/de,Ve),ie.data,ne,$,de,Xe),ne===0&&this._addTileFeatures(ie.range(1-Pe/de,Fe,1,Ve),ie.data,de,$,de,Xe),ne===de-1&&this._addTileFeatures(ie.range(0,Fe,Pe/de,Ve),ie.data,-1,$,de,Xe),Xe.features.length?Xe:null}getClusterExpansionZoom(se){let ne=this._getOriginZoom(se)-1;for(;ne<=this.options.maxZoom;){const $=this.getChildren(se);if(ne++,$.length!==1)break;se=$[0].properties.cluster_id}return ne}_appendLeaves(se,ne,$,ie,de){const ye=this.getChildren(ne);for(const ge of ye){const Pe=ge.properties;if(Pe&&Pe.cluster?de+Pe.point_count<=ie?de+=Pe.point_count:de=this._appendLeaves(se,Pe.cluster_id,$,ie,de):de<ie?de++:se.push(ge),se.length===$)break}return de}_createTree(se){const ne=new S.au(se.length/this.stride|0,this.options.nodeSize,Float32Array);for(let $=0;$<se.length;$+=this.stride)ne.add(se[$],se[$+1]);return ne.finish(),ne.data=se,ne}_addTileFeatures(se,ne,$,ie,de,ye){for(const ge of se){const Pe=ge*this.stride,Fe=ne[Pe+Ci]>1;let Ve,Xe,Ke;if(Fe)Ve=Ni(ne,Pe,this.clusterProps),Xe=ne[Pe],Ke=ne[Pe+1];else{const At=this.points[ne[Pe+Ii]];Ve=At.properties;const[kt,o]=At.geometry.coordinates;Xe=nn(kt),Ke=vn(o)}const De={type:1,geometry:[[Math.round(this.options.extent*(Xe*de-$)),Math.round(this.options.extent*(Ke*de-ie))]],tags:Ve};let Ge;Ge=Fe||this.options.generateId?ne[Pe+Ii]:this.points[ne[Pe+Ii]].id,Ge!==void 0&&(De.id=Ge),ye.features.push(De)}}_limitZoom(se){return Math.max(this.options.minZoom,Math.min(Math.floor(+se),this.options.maxZoom+1))}_cluster(se,ne){const{radius:$,extent:ie,reduce:de,minPoints:ye}=this.options,ge=$/(ie*Math.pow(2,ne)),Pe=se.data,Fe=[],Ve=this.stride;for(let Xe=0;Xe<Pe.length;Xe+=Ve){if(Pe[Xe+2]<=ne)continue;Pe[Xe+2]=ne;const Ke=Pe[Xe],De=Pe[Xe+1],Ge=se.within(Pe[Xe],Pe[Xe+1],ge),At=Pe[Xe+Ci];let kt=At;for(const o of Ge){const ke=o*Ve;Pe[ke+2]>ne&&(kt+=Pe[ke+Ci])}if(kt>At&&kt>=ye){let o,ke=Ke*At,oi=De*At,fi=-1;const Ai=((Xe/Ve|0)<<5)+(ne+1)+this.points.length;for(const ti of Ge){const li=ti*Ve;if(Pe[li+2]<=ne)continue;Pe[li+2]=ne;const Bi=Pe[li+Ci];ke+=Pe[li]*Bi,oi+=Pe[li+1]*Bi,Pe[li+4]=Ai,de&&(o||(o=this._map(Pe,Xe,!0),fi=this.clusterProps.length,this.clusterProps.push(o)),de(o,this._map(Pe,li)))}Pe[Xe+4]=Ai,Fe.push(ke/kt,oi/kt,1/0,Ai,-1,kt),de&&Fe.push(fi)}else{for(let o=0;o<Ve;o++)Fe.push(Pe[Xe+o]);if(kt>1)for(const o of Ge){const ke=o*Ve;if(!(Pe[ke+2]<=ne)){Pe[ke+2]=ne;for(let oi=0;oi<Ve;oi++)Fe.push(Pe[ke+oi])}}}}return Fe}_getOriginId(se){return se-this.points.length>>5}_getOriginZoom(se){return(se-this.points.length)%32}_map(se,ne,$){if(se[ne+Ci]>1){const ye=this.clusterProps[se[ne+Ri]];return $?Object.assign({},ye):ye}const ie=this.points[se[ne+Ii]].properties,de=this.options.map(ie);return $&&de===ie?Object.assign({},de):de}}function Hi(Me,se,ne){return{type:"Feature",id:Me[se+Ii],properties:Ni(Me,se,ne),geometry:{type:"Point",coordinates:[($=Me[se],360*($-.5)),Ei(Me[se+1])]}};var $}function Ni(Me,se,ne){const $=Me[se+Ci],ie=$>=1e4?`${Math.round($/1e3)}k`:$>=1e3?Math.round($/100)/10+"k":$,de=Me[se+Ri],ye=de===-1?{}:Object.assign({},ne[de]);return Object.assign(ye,{cluster:!0,cluster_id:Me[se+Ii],point_count:$,point_count_abbreviated:ie})}function nn(Me){return Me/360+.5}function vn(Me){const se=Math.sin(Me*Math.PI/180),ne=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return ne<0?0:ne>1?1:ne}function Ei(Me){const se=(180-360*Me)*Math.PI/180;return 360*Math.atan(Math.exp(se))/Math.PI-90}function mi(Me,se,ne,$){for(var ie,de=$,ye=ne-se>>1,ge=ne-se,Pe=Me[se],Fe=Me[se+1],Ve=Me[ne],Xe=Me[ne+1],Ke=se+3;Ke<ne;Ke+=3){var De=zi(Me[Ke],Me[Ke+1],Pe,Fe,Ve,Xe);if(De>de)ie=Ke,de=De;else if(De===de){var Ge=Math.abs(Ke-ye);Ge<ge&&(ie=Ke,ge=Ge)}}de>$&&(ie-se>3&&mi(Me,se,ie,$),Me[ie+2]=de,ne-ie>3&&mi(Me,ie,ne,$))}function zi(Me,se,ne,$,ie,de){var ye=ie-ne,ge=de-$;if(ye!==0||ge!==0){var Pe=((Me-ne)*ye+(se-$)*ge)/(ye*ye+ge*ge);Pe>1?(ne=ie,$=de):Pe>0&&(ne+=ye*Pe,$+=ge*Pe)}return(ye=Me-ne)*ye+(ge=se-$)*ge}function Oi(Me,se,ne,$){var ie={id:Me===void 0?null:Me,type:se,geometry:ne,tags:$,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(de){var ye=de.geometry,ge=de.type;if(ge==="Point"||ge==="MultiPoint"||ge==="LineString")xn(de,ye);else if(ge==="Polygon"||ge==="MultiLineString")for(var Pe=0;Pe<ye.length;Pe++)xn(de,ye[Pe]);else if(ge==="MultiPolygon")for(Pe=0;Pe<ye.length;Pe++)for(var Fe=0;Fe<ye[Pe].length;Fe++)xn(de,ye[Pe][Fe])}(ie),ie}function xn(Me,se){for(var ne=0;ne<se.length;ne+=3)Me.minX=Math.min(Me.minX,se[ne]),Me.minY=Math.min(Me.minY,se[ne+1]),Me.maxX=Math.max(Me.maxX,se[ne]),Me.maxY=Math.max(Me.maxY,se[ne+1])}function bn(Me,se,ne,$){if(se.geometry){var ie=se.geometry.coordinates,de=se.geometry.type,ye=Math.pow(ne.tolerance/((1<<ne.maxZoom)*ne.extent),2),ge=[],Pe=se.id;if(ne.promoteId?Pe=se.properties[ne.promoteId]:ne.generateId&&(Pe=$||0),de==="Point")Yt(ie,ge);else if(de==="MultiPoint")for(var Fe=0;Fe<ie.length;Fe++)Yt(ie[Fe],ge);else if(de==="LineString")rn(ie,ge,ye,!1);else if(de==="MultiLineString"){if(ne.lineMetrics){for(Fe=0;Fe<ie.length;Fe++)rn(ie[Fe],ge=[],ye,!1),Me.push(Oi(Pe,"LineString",ge,se.properties));return}Xt(ie,ge,ye,!1)}else if(de==="Polygon")Xt(ie,ge,ye,!0);else{if(de!=="MultiPolygon"){if(de==="GeometryCollection"){for(Fe=0;Fe<se.geometry.geometries.length;Fe++)bn(Me,{id:Pe,geometry:se.geometry.geometries[Fe],properties:se.properties},ne,$);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Fe=0;Fe<ie.length;Fe++){var Ve=[];Xt(ie[Fe],Ve,ye,!0),ge.push(Ve)}}Me.push(Oi(Pe,de,ge,se.properties))}}function Yt(Me,se){se.push(Ji(Me[0])),se.push(mr(Me[1])),se.push(0)}function rn(Me,se,ne,$){for(var ie,de,ye=0,ge=0;ge<Me.length;ge++){var Pe=Ji(Me[ge][0]),Fe=mr(Me[ge][1]);se.push(Pe),se.push(Fe),se.push(0),ge>0&&(ye+=$?(ie*Fe-Pe*de)/2:Math.sqrt(Math.pow(Pe-ie,2)+Math.pow(Fe-de,2))),ie=Pe,de=Fe}var Ve=se.length-3;se[2]=1,mi(se,0,Ve,ne),se[Ve+2]=1,se.size=Math.abs(ye),se.start=0,se.end=se.size}function Xt(Me,se,ne,$){for(var ie=0;ie<Me.length;ie++){var de=[];rn(Me[ie],de,ne,$),se.push(de)}}function Ji(Me){return Me/360+.5}function mr(Me){var se=Math.sin(Me*Math.PI/180),ne=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return ne<0?0:ne>1?1:ne}function ci(Me,se,ne,$,ie,de,ye,ge){if($/=se,de>=(ne/=se)&&ye<$)return Me;if(ye<ne||de>=$)return null;for(var Pe=[],Fe=0;Fe<Me.length;Fe++){var Ve=Me[Fe],Xe=Ve.geometry,Ke=Ve.type,De=ie===0?Ve.minX:Ve.minY,Ge=ie===0?Ve.maxX:Ve.maxY;if(De>=ne&&Ge<$)Pe.push(Ve);else if(!(Ge<ne||De>=$)){var At=[];if(Ke==="Point"||Ke==="MultiPoint")sn(Xe,At,ne,$,ie);else if(Ke==="LineString")lr(Xe,At,ne,$,ie,!1,ge.lineMetrics);else if(Ke==="MultiLineString")Gn(Xe,At,ne,$,ie,!1);else if(Ke==="Polygon")Gn(Xe,At,ne,$,ie,!0);else if(Ke==="MultiPolygon")for(var kt=0;kt<Xe.length;kt++){var o=[];Gn(Xe[kt],o,ne,$,ie,!0),o.length&&At.push(o)}if(At.length){if(ge.lineMetrics&&Ke==="LineString"){for(kt=0;kt<At.length;kt++)Pe.push(Oi(Ve.id,Ke,At[kt],Ve.tags));continue}Ke!=="LineString"&&Ke!=="MultiLineString"||(At.length===1?(Ke="LineString",At=At[0]):Ke="MultiLineString"),Ke!=="Point"&&Ke!=="MultiPoint"||(Ke=At.length===3?"Point":"MultiPoint"),Pe.push(Oi(Ve.id,Ke,At,Ve.tags))}}}return Pe.length?Pe:null}function sn(Me,se,ne,$,ie){for(var de=0;de<Me.length;de+=3){var ye=Me[de+ie];ye>=ne&&ye<=$&&(se.push(Me[de]),se.push(Me[de+1]),se.push(Me[de+2]))}}function lr(Me,se,ne,$,ie,de,ye){for(var ge,Pe,Fe=On(Me),Ve=ie===0?v:k,Xe=Me.start,Ke=0;Ke<Me.length-3;Ke+=3){var De=Me[Ke],Ge=Me[Ke+1],At=Me[Ke+2],kt=Me[Ke+3],o=Me[Ke+4],ke=ie===0?De:Ge,oi=ie===0?kt:o,fi=!1;ye&&(ge=Math.sqrt(Math.pow(De-kt,2)+Math.pow(Ge-o,2))),ke<ne?oi>ne&&(Pe=Ve(Fe,De,Ge,kt,o,ne),ye&&(Fe.start=Xe+ge*Pe)):ke>$?oi<$&&(Pe=Ve(Fe,De,Ge,kt,o,$),ye&&(Fe.start=Xe+ge*Pe)):pn(Fe,De,Ge,At),oi<ne&&ke>=ne&&(Pe=Ve(Fe,De,Ge,kt,o,ne),fi=!0),oi>$&&ke<=$&&(Pe=Ve(Fe,De,Ge,kt,o,$),fi=!0),!de&&fi&&(ye&&(Fe.end=Xe+ge*Pe),se.push(Fe),Fe=On(Me)),ye&&(Xe+=ge)}var Ai=Me.length-3;De=Me[Ai],Ge=Me[Ai+1],At=Me[Ai+2],(ke=ie===0?De:Ge)>=ne&&ke<=$&&pn(Fe,De,Ge,At),Ai=Fe.length-3,de&&Ai>=3&&(Fe[Ai]!==Fe[0]||Fe[Ai+1]!==Fe[1])&&pn(Fe,Fe[0],Fe[1],Fe[2]),Fe.length&&se.push(Fe)}function On(Me){var se=[];return se.size=Me.size,se.start=Me.start,se.end=Me.end,se}function Gn(Me,se,ne,$,ie,de){for(var ye=0;ye<Me.length;ye++)lr(Me[ye],se,ne,$,ie,de,!1)}function pn(Me,se,ne,$){Me.push(se),Me.push(ne),Me.push($)}function v(Me,se,ne,$,ie,de){var ye=(de-se)/($-se);return Me.push(de),Me.push(ne+(ie-ne)*ye),Me.push(1),ye}function k(Me,se,ne,$,ie,de){var ye=(de-ne)/(ie-ne);return Me.push(se+($-se)*ye),Me.push(de),Me.push(1),ye}function V(Me,se){for(var ne=[],$=0;$<Me.length;$++){var ie,de=Me[$],ye=de.type;if(ye==="Point"||ye==="MultiPoint"||ye==="LineString")ie=Y(de.geometry,se);else if(ye==="MultiLineString"||ye==="Polygon"){ie=[];for(var ge=0;ge<de.geometry.length;ge++)ie.push(Y(de.geometry[ge],se))}else if(ye==="MultiPolygon")for(ie=[],ge=0;ge<de.geometry.length;ge++){for(var Pe=[],Fe=0;Fe<de.geometry[ge].length;Fe++)Pe.push(Y(de.geometry[ge][Fe],se));ie.push(Pe)}ne.push(Oi(de.id,ye,ie,de.tags))}return ne}function Y(Me,se){var ne=[];ne.size=Me.size,Me.start!==void 0&&(ne.start=Me.start,ne.end=Me.end);for(var $=0;$<Me.length;$+=3)ne.push(Me[$]+se,Me[$+1],Me[$+2]);return ne}function te(Me,se){if(Me.transformed)return Me;var ne,$,ie,de=1<<Me.z,ye=Me.x,ge=Me.y;for(ne=0;ne<Me.features.length;ne++){var Pe=Me.features[ne],Fe=Pe.geometry,Ve=Pe.type;if(Pe.geometry=[],Ve===1)for($=0;$<Fe.length;$+=2)Pe.geometry.push(fe(Fe[$],Fe[$+1],se,de,ye,ge));else for($=0;$<Fe.length;$++){var Xe=[];for(ie=0;ie<Fe[$].length;ie+=2)Xe.push(fe(Fe[$][ie],Fe[$][ie+1],se,de,ye,ge));Pe.geometry.push(Xe)}}return Me.transformed=!0,Me}function fe(Me,se,ne,$,ie,de){return[Math.round(ne*(Me*$-ie)),Math.round(ne*(se*$-de))]}function ve(Me,se,ne,$,ie){for(var de=se===ie.maxZoom?0:ie.tolerance/((1<<se)*ie.extent),ye={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ne,y:$,z:se,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ge=0;ge<Me.length;ge++){ye.numFeatures++,Ie(ye,Me[ge],de,ie);var Pe=Me[ge].minX,Fe=Me[ge].minY,Ve=Me[ge].maxX,Xe=Me[ge].maxY;Pe<ye.minX&&(ye.minX=Pe),Fe<ye.minY&&(ye.minY=Fe),Ve>ye.maxX&&(ye.maxX=Ve),Xe>ye.maxY&&(ye.maxY=Xe)}return ye}function Ie(Me,se,ne,$){var ie=se.geometry,de=se.type,ye=[];if(de==="Point"||de==="MultiPoint")for(var ge=0;ge<ie.length;ge+=3)ye.push(ie[ge]),ye.push(ie[ge+1]),Me.numPoints++,Me.numSimplified++;else if(de==="LineString")Ee(ye,ie,Me,ne,!1,!1);else if(de==="MultiLineString"||de==="Polygon")for(ge=0;ge<ie.length;ge++)Ee(ye,ie[ge],Me,ne,de==="Polygon",ge===0);else if(de==="MultiPolygon")for(var Pe=0;Pe<ie.length;Pe++){var Fe=ie[Pe];for(ge=0;ge<Fe.length;ge++)Ee(ye,Fe[ge],Me,ne,!0,ge===0)}if(ye.length){var Ve=se.tags||null;if(de==="LineString"&&$.lineMetrics){for(var Xe in Ve={},se.tags)Ve[Xe]=se.tags[Xe];Ve.mapbox_clip_start=ie.start/ie.size,Ve.mapbox_clip_end=ie.end/ie.size}var Ke={geometry:ye,type:de==="Polygon"||de==="MultiPolygon"?3:de==="LineString"||de==="MultiLineString"?2:1,tags:Ve};se.id!==null&&(Ke.id=se.id),Me.features.push(Ke)}}function Ee(Me,se,ne,$,ie,de){var ye=$*$;if($>0&&se.size<(ie?ye:$))ne.numPoints+=se.length/3;else{for(var ge=[],Pe=0;Pe<se.length;Pe+=3)($===0||se[Pe+2]>ye)&&(ne.numSimplified++,ge.push(se[Pe]),ge.push(se[Pe+1])),ne.numPoints++;ie&&function(Fe,Ve){for(var Xe=0,Ke=0,De=Fe.length,Ge=De-2;Ke<De;Ge=Ke,Ke+=2)Xe+=(Fe[Ke]-Fe[Ge])*(Fe[Ke+1]+Fe[Ge+1]);if(Xe>0===Ve)for(Ke=0,De=Fe.length;Ke<De/2;Ke+=2){var At=Fe[Ke],kt=Fe[Ke+1];Fe[Ke]=Fe[De-2-Ke],Fe[Ke+1]=Fe[De-1-Ke],Fe[De-2-Ke]=At,Fe[De-1-Ke]=kt}}(ge,de),Me.push(ge)}}function ze(Me,se){var ne=(se=this.options=function(ie,de){for(var ye in de)ie[ye]=de[ye];return ie}(Object.create(this.options),se)).debug;if(ne&&console.time("preprocess data"),se.maxZoom<0||se.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(se.promoteId&&se.generateId)throw new Error("promoteId and generateId cannot be used together.");var $=function(ie,de){var ye=[];if(ie.type==="FeatureCollection")for(var ge=0;ge<ie.features.length;ge++)bn(ye,ie.features[ge],de,ge);else bn(ye,ie.type==="Feature"?ie:{geometry:ie},de);return ye}(Me,se);this.tiles={},this.tileCoords=[],ne&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",se.indexMaxZoom,se.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),$=function(ie,de){var ye=de.buffer/de.extent,ge=ie,Pe=ci(ie,1,-1-ye,ye,0,-1,2,de),Fe=ci(ie,1,1-ye,2+ye,0,-1,2,de);return(Pe||Fe)&&(ge=ci(ie,1,-ye,1+ye,0,-1,2,de)||[],Pe&&(ge=V(Pe,1).concat(ge)),Fe&&(ge=ge.concat(V(Fe,-1)))),ge}($,se),$.length&&this.splitTile($,0,0,0),ne&&($.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Qe(Me,se,ne){return 32*((1<<Me)*ne+se)+Me}function He(Me,se){return se?Me.properties[se]:Me.id}function Ze(Me,se){if(Me==null)return!0;if(Me.type==="Feature")return He(Me,se)!=null;if(Me.type==="FeatureCollection"){const ne=new Set;for(const $ of Me.features){const ie=He($,se);if(ie==null||ne.has(ie))return!1;ne.add(ie)}return!0}return!1}function Ue(Me,se){const ne=new Map;if(Me!=null)if(Me.type==="Feature")ne.set(He(Me,se),Me);else for(const $ of Me.features)ne.set(He($,se),$);return ne}ze.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ze.prototype.splitTile=function(Me,se,ne,$,ie,de,ye){for(var ge=[Me,se,ne,$],Pe=this.options,Fe=Pe.debug;ge.length;){$=ge.pop(),ne=ge.pop(),se=ge.pop(),Me=ge.pop();var Ve=1<<se,Xe=Qe(se,ne,$),Ke=this.tiles[Xe];if(!Ke&&(Fe>1&&console.time("creation"),Ke=this.tiles[Xe]=ve(Me,se,ne,$,Pe),this.tileCoords.push({z:se,x:ne,y:$}),Fe)){Fe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",se,ne,$,Ke.numFeatures,Ke.numPoints,Ke.numSimplified),console.timeEnd("creation"));var De="z"+se;this.stats[De]=(this.stats[De]||0)+1,this.total++}if(Ke.source=Me,ie){if(se===Pe.maxZoom||se===ie)continue;var Ge=1<<ie-se;if(ne!==Math.floor(de/Ge)||$!==Math.floor(ye/Ge))continue}else if(se===Pe.indexMaxZoom||Ke.numPoints<=Pe.indexMaxPoints)continue;if(Ke.source=null,Me.length!==0){Fe>1&&console.time("clipping");var At,kt,o,ke,oi,fi,Ai=.5*Pe.buffer/Pe.extent,ti=.5-Ai,li=.5+Ai,Bi=1+Ai;At=kt=o=ke=null,oi=ci(Me,Ve,ne-Ai,ne+li,0,Ke.minX,Ke.maxX,Pe),fi=ci(Me,Ve,ne+ti,ne+Bi,0,Ke.minX,Ke.maxX,Pe),Me=null,oi&&(At=ci(oi,Ve,$-Ai,$+li,1,Ke.minY,Ke.maxY,Pe),kt=ci(oi,Ve,$+ti,$+Bi,1,Ke.minY,Ke.maxY,Pe),oi=null),fi&&(o=ci(fi,Ve,$-Ai,$+li,1,Ke.minY,Ke.maxY,Pe),ke=ci(fi,Ve,$+ti,$+Bi,1,Ke.minY,Ke.maxY,Pe),fi=null),Fe>1&&console.timeEnd("clipping"),ge.push(At||[],se+1,2*ne,2*$),ge.push(kt||[],se+1,2*ne,2*$+1),ge.push(o||[],se+1,2*ne+1,2*$),ge.push(ke||[],se+1,2*ne+1,2*$+1)}}},ze.prototype.getTile=function(Me,se,ne){var $=this.options,ie=$.extent,de=$.debug;if(Me<0||Me>24)return null;var ye=1<<Me,ge=Qe(Me,se=(se%ye+ye)%ye,ne);if(this.tiles[ge])return te(this.tiles[ge],ie);de>1&&console.log("drilling down to z%d-%d-%d",Me,se,ne);for(var Pe,Fe=Me,Ve=se,Xe=ne;!Pe&&Fe>0;)Fe--,Ve=Math.floor(Ve/2),Xe=Math.floor(Xe/2),Pe=this.tiles[Qe(Fe,Ve,Xe)];return Pe&&Pe.source?(de>1&&console.log("found parent tile z%d-%d-%d",Fe,Ve,Xe),de>1&&console.time("drilling down"),this.splitTile(Pe.source,Fe,Ve,Xe,Me,se,ne),de>1&&console.timeEnd("drilling down"),this.tiles[ge]?te(this.tiles[ge],ie):null):null};class dt extends ae{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(se,ne){return S._(this,void 0,void 0,function*(){const $=se.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ie=this._geoJSONIndex.getTile($.z,$.x,$.y);if(!ie)return null;const de=new class{constructor(ge){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=S.W,this.length=ge.length,this._features=ge}feature(ge){return new class{constructor(Pe){this._feature=Pe,this.extent=S.W,this.type=Pe.type,this.properties=Pe.tags,"id"in Pe&&!isNaN(Pe.id)&&(this.id=parseInt(Pe.id,10))}loadGeometry(){if(this._feature.type===1){const Pe=[];for(const Fe of this._feature.geometry)Pe.push([new S.P(Fe[0],Fe[1])]);return Pe}{const Pe=[];for(const Fe of this._feature.geometry){const Ve=[];for(const Xe of Fe)Ve.push(new S.P(Xe[0],Xe[1]));Pe.push(Ve)}return Pe}}toGeoJSON(Pe,Fe,Ve){return Ye.call(this,Pe,Fe,Ve)}}(this._features[ge])}}(ie.features);let ye=Nt(de);return ye.byteOffset===0&&ye.byteLength===ye.buffer.byteLength||(ye=new Uint8Array(ye)),{vectorTile:de,rawData:ye.buffer}})}loadData(se){var ne;return S._(this,void 0,void 0,function*(){(ne=this._pendingRequest)===null||ne===void 0||ne.abort();const $=!!(se&&se.request&&se.request.collectResourceTiming)&&new S.br(se.request);this._pendingRequest=new AbortController;try{let ie=yield this.loadGeoJSON(se,this._pendingRequest);if(delete this._pendingRequest,typeof ie!="object")throw new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`);if(st(ie,!0),se.filter){const ye=S.bx(se.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ye.result==="error")throw new Error(ye.value.map(Pe=>`${Pe.key}: ${Pe.message}`).join(", "));ie={type:"FeatureCollection",features:ie.features.filter(Pe=>ye.value.evaluate({zoom:0},Pe))}}this._geoJSONIndex=se.cluster?new Ki(function({superclusterOptions:ye,clusterProperties:ge}){if(!ge||!ye)return ye;const Pe={},Fe={},Ve={accumulated:null,zoom:0},Xe={properties:null},Ke=Object.keys(ge);for(const De of Ke){const[Ge,At]=ge[De],kt=S.bx(At),o=S.bx(typeof Ge=="string"?[Ge,["accumulated"],["get",De]]:Ge);Pe[De]=kt.value,Fe[De]=o.value}return ye.map=De=>{Xe.properties=De;const Ge={};for(const At of Ke)Ge[At]=Pe[At].evaluate(Ve,Xe);return Ge},ye.reduce=(De,Ge)=>{Xe.properties=Ge;for(const At of Ke)Ve.accumulated=De[At],De[At]=Fe[At].evaluate(Ve,Xe)},ye}(se)).load(ie.features):function(ye,ge){return new ze(ye,ge)}(ie,se.geojsonVtOptions),this.loaded={};const de={};if($){const ye=$.finish();ye&&(de.resourceTiming={},de.resourceTiming[se.source]=JSON.parse(JSON.stringify(ye)))}return de}catch(ie){if(delete this._pendingRequest,S.by(ie))return{abandoned:!0};throw ie}})}reloadTile(se){const ne=this.loaded;return ne&&ne[se.uid]?super.reloadTile(se):this.loadTile(se)}loadGeoJSON(se,ne){return S._(this,void 0,void 0,function*(){const{promoteId:$}=se;if(se.request){const ie=yield S.h(se.request,ne);return this._dataUpdateable=Ze(ie.data,$)?Ue(ie.data,$):void 0,ie.data}if(typeof se.data=="string")try{const ie=JSON.parse(se.data);return this._dataUpdateable=Ze(ie,$)?Ue(ie,$):void 0,ie}catch{throw new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`)}if(!se.dataDiff)throw new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${se.source}`);return function(ie,de,ye){var ge,Pe,Fe,Ve;if(de.removeAll&&ie.clear(),de.remove)for(const Xe of de.remove)ie.delete(Xe);if(de.add)for(const Xe of de.add){const Ke=He(Xe,ye);Ke!=null&&ie.set(Ke,Xe)}if(de.update)for(const Xe of de.update){let Ke=ie.get(Xe.id);if(Ke==null)continue;const De=!Xe.removeAllProperties&&(((ge=Xe.removeProperties)===null||ge===void 0?void 0:ge.length)>0||((Pe=Xe.addOrUpdateProperties)===null||Pe===void 0?void 0:Pe.length)>0);if((Xe.newGeometry||Xe.removeAllProperties||De)&&(Ke=Object.assign({},Ke),ie.set(Xe.id,Ke),De&&(Ke.properties=Object.assign({},Ke.properties))),Xe.newGeometry&&(Ke.geometry=Xe.newGeometry),Xe.removeAllProperties)Ke.properties={};else if(((Fe=Xe.removeProperties)===null||Fe===void 0?void 0:Fe.length)>0)for(const Ge of Xe.removeProperties)Object.prototype.hasOwnProperty.call(Ke.properties,Ge)&&delete Ke.properties[Ge];if(((Ve=Xe.addOrUpdateProperties)===null||Ve===void 0?void 0:Ve.length)>0)for(const{key:Ge,value:At}of Xe.addOrUpdateProperties)Ke.properties[Ge]=At}}(this._dataUpdateable,se.dataDiff,$),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(se){return S._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(se){return this._geoJSONIndex.getClusterExpansionZoom(se.clusterId)}getClusterChildren(se){return this._geoJSONIndex.getChildren(se.clusterId)}getClusterLeaves(se){return this._geoJSONIndex.getLeaves(se.clusterId,se.limit,se.offset)}}class rt{constructor(se){this.self=se,this.actor=new S.C(se),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(ne,$)=>{if(this.externalWorkerSourceTypes[ne])throw new Error(`Worker source with name "${ne}" already registered.`);this.externalWorkerSourceTypes[ne]=$},this.self.addProtocol=S.be,this.self.removeProtocol=S.bf,this.self.registerRTLTextPlugin=ne=>{if(S.bz.isParsed())throw new Error("RTL text plugin already registered.");S.bz.setMethods(ne)},this.actor.registerMessageHandler("loadDEMTile",(ne,$)=>this._getDEMWorkerSource(ne,$.source).loadTile($)),this.actor.registerMessageHandler("removeDEMTile",(ne,$)=>S._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ne,$.source).removeTile($)})),this.actor.registerMessageHandler("getClusterExpansionZoom",(ne,$)=>S._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,$.type,$.source).getClusterExpansionZoom($)})),this.actor.registerMessageHandler("getClusterChildren",(ne,$)=>S._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,$.type,$.source).getClusterChildren($)})),this.actor.registerMessageHandler("getClusterLeaves",(ne,$)=>S._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,$.type,$.source).getClusterLeaves($)})),this.actor.registerMessageHandler("loadData",(ne,$)=>this._getWorkerSource(ne,$.type,$.source).loadData($)),this.actor.registerMessageHandler("loadTile",(ne,$)=>this._getWorkerSource(ne,$.type,$.source).loadTile($)),this.actor.registerMessageHandler("reloadTile",(ne,$)=>this._getWorkerSource(ne,$.type,$.source).reloadTile($)),this.actor.registerMessageHandler("abortTile",(ne,$)=>this._getWorkerSource(ne,$.type,$.source).abortTile($)),this.actor.registerMessageHandler("removeTile",(ne,$)=>this._getWorkerSource(ne,$.type,$.source).removeTile($)),this.actor.registerMessageHandler("removeSource",(ne,$)=>S._(this,void 0,void 0,function*(){if(!this.workerSources[ne]||!this.workerSources[ne][$.type]||!this.workerSources[ne][$.type][$.source])return;const ie=this.workerSources[ne][$.type][$.source];delete this.workerSources[ne][$.type][$.source],ie.removeSource!==void 0&&ie.removeSource($)})),this.actor.registerMessageHandler("removeMap",ne=>S._(this,void 0,void 0,function*(){delete this.layerIndexes[ne],delete this.availableImages[ne],delete this.workerSources[ne],delete this.demWorkerSources[ne]})),this.actor.registerMessageHandler("setReferrer",(ne,$)=>S._(this,void 0,void 0,function*(){this.referrer=$})),this.actor.registerMessageHandler("syncRTLPluginState",(ne,$)=>this._syncRTLPluginState(ne,$)),this.actor.registerMessageHandler("importScript",(ne,$)=>S._(this,void 0,void 0,function*(){this.self.importScripts($)})),this.actor.registerMessageHandler("setImages",(ne,$)=>this._setImages(ne,$)),this.actor.registerMessageHandler("updateLayers",(ne,$)=>S._(this,void 0,void 0,function*(){this._getLayerIndex(ne).update($.layers,$.removedIds)})),this.actor.registerMessageHandler("setLayers",(ne,$)=>S._(this,void 0,void 0,function*(){this._getLayerIndex(ne).replace($)}))}_setImages(se,ne){return S._(this,void 0,void 0,function*(){this.availableImages[se]=ne;for(const $ in this.workerSources[se]){const ie=this.workerSources[se][$];for(const de in ie)ie[de].availableImages=ne}})}_syncRTLPluginState(se,ne){return S._(this,void 0,void 0,function*(){S.bz.setState(ne);const $=S.bz.getPluginURL();if(ne.pluginStatus==="loaded"&&!S.bz.isParsed()&&$!=null){this.self.importScripts($);const ie=S.bz.isParsed();if(ie)return ie;throw new Error(`RTL Text Plugin failed to import scripts from ${$}`)}return!1})}_getAvailableImages(se){let ne=this.availableImages[se];return ne||(ne=[]),ne}_getLayerIndex(se){let ne=this.layerIndexes[se];return ne||(ne=this.layerIndexes[se]=new a),ne}_getWorkerSource(se,ne,$){if(this.workerSources[se]||(this.workerSources[se]={}),this.workerSources[se][ne]||(this.workerSources[se][ne]={}),!this.workerSources[se][ne][$]){const ie={sendAsync:(de,ye)=>(de.targetMapId=se,this.actor.sendAsync(de,ye))};switch(ne){case"vector":this.workerSources[se][ne][$]=new ae(ie,this._getLayerIndex(se),this._getAvailableImages(se));break;case"geojson":this.workerSources[se][ne][$]=new dt(ie,this._getLayerIndex(se),this._getAvailableImages(se));break;default:this.workerSources[se][ne][$]=new this.externalWorkerSourceTypes[ne](ie,this._getLayerIndex(se),this._getAvailableImages(se))}}return this.workerSources[se][ne][$]}_getDEMWorkerSource(se,ne){return this.demWorkerSources[se]||(this.demWorkerSources[se]={}),this.demWorkerSources[se][ne]||(this.demWorkerSources[se][ne]=new ce),this.demWorkerSources[se][ne]}}return S.i(self)&&(self.worker=new rt(self)),rt}),g("index",["exports","./shared"],function(S,a){var U="4.1.0";let W,he;const ae={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:y=>new Promise((s,i)=>{const r=requestAnimationFrame(s);y.signal.addEventListener("abort",()=>{cancelAnimationFrame(r),i(a.c())})}),getImageData(y,s=0){return this.getImageCanvasContext(y).getImageData(-s,-s,y.width+2*s,y.height+2*s)},getImageCanvasContext(y){const s=window.document.createElement("canvas"),i=s.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("failed to create canvas 2d context");return s.width=y.width,s.height=y.height,i.drawImage(y,0,0,y.width,y.height),i},resolveURL:y=>(W||(W=document.createElement("a")),W.href=y,W.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(he==null&&(he=matchMedia("(prefers-reduced-motion: reduce)")),he.matches)}};class ce{static testProp(s){if(!ce.docStyle)return s[0];for(let i=0;i<s.length;i++)if(s[i]in ce.docStyle)return s[i];return s[0]}static create(s,i,r){const l=window.document.createElement(s);return i!==void 0&&(l.className=i),r&&r.appendChild(l),l}static createNS(s,i){return window.document.createElementNS(s,i)}static disableDrag(){ce.docStyle&&ce.selectProp&&(ce.userSelect=ce.docStyle[ce.selectProp],ce.docStyle[ce.selectProp]="none")}static enableDrag(){ce.docStyle&&ce.selectProp&&(ce.docStyle[ce.selectProp]=ce.userSelect)}static setTransform(s,i){s.style[ce.transformProp]=i}static addEventListener(s,i,r,l={}){s.addEventListener(i,r,"passive"in l?l:l.capture)}static removeEventListener(s,i,r,l={}){s.removeEventListener(i,r,"passive"in l?l:l.capture)}static suppressClickInternal(s){s.preventDefault(),s.stopPropagation(),window.removeEventListener("click",ce.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ce.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",ce.suppressClickInternal,!0)},0)}static getScale(s){const i=s.getBoundingClientRect();return{x:i.width/s.offsetWidth||1,y:i.height/s.offsetHeight||1,boundingClientRect:i}}static getPoint(s,i,r){const l=i.boundingClientRect;return new a.P((r.clientX-l.left)/i.x-s.clientLeft,(r.clientY-l.top)/i.y-s.clientTop)}static mousePos(s,i){const r=ce.getScale(s);return ce.getPoint(s,r,i)}static touchPos(s,i){const r=[],l=ce.getScale(s);for(let d=0;d<i.length;d++)r.push(ce.getPoint(s,l,i[d]));return r}static mouseButton(s){return s.button}static remove(s){s.parentNode&&s.parentNode.removeChild(s)}}ce.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,ce.selectProp=ce.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ce.transformProp=ce.testProp(["transform","WebkitTransform"]);const be={supported:!1,testSupport:function(y){!Ye&&st&&(it?ct(y):Je=y)}};let Je,st,Ye=!1,it=!1;function ct(y){const s=y.createTexture();y.bindTexture(y.TEXTURE_2D,s);try{if(y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,st),y.isContextLost())return;be.supported=!0}catch{}y.deleteTexture(s),Ye=!0}var Tt,zt;typeof document<"u"&&(st=document.createElement("img"),st.onload=function(){Je&&ct(Je),Je=null,it=!0},st.onerror=function(){Ye=!0,Je=null},st.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(y){let s,i,r,l;y.resetRequestQueue=()=>{s=[],i=0,r=0,l={}},y.addThrottleControl=T=>{const B=r++;return l[B]=T,B},y.removeThrottleControl=T=>{delete l[T],_()},y.getImage=(T,B,j=!0)=>new Promise((X,ue)=>{be.supported&&(T.headers||(T.headers={}),T.headers.accept="image/webp,*/*"),a.e(T,{type:"image"}),s.push({abortController:B,requestParameters:T,supportImageRefresh:j,state:"queued",onError:Se=>{ue(Se)},onSuccess:Se=>{X(Se)}}),_()});const d=T=>a._(this,void 0,void 0,function*(){T.state="running";const{requestParameters:B,supportImageRefresh:j,onError:X,onSuccess:ue,abortController:Se}=T,Te=j===!1&&!a.i(self)&&!a.g(B.url)&&(!B.headers||Object.keys(B.headers).reduce((et,vt)=>et&&vt==="accept",!0));i++;const Re=Te?w(B,Se):a.m(B,Se);try{const et=yield Re;delete T.abortController,T.state="completed",et.data instanceof HTMLImageElement||a.b(et.data)?ue(et):et.data&&ue({data:yield(Be=et.data,typeof createImageBitmap=="function"?a.d(Be):a.f(Be)),cacheControl:et.cacheControl,expires:et.expires})}catch(et){delete T.abortController,X(et)}finally{i--,_()}var Be}),_=()=>{const T=(()=>{for(const B of Object.keys(l))if(l[B]())return!0;return!1})()?a.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let B=i;B<T&&s.length>0;B++){const j=s.shift();j.abortController.signal.aborted?B--:d(j)}},w=(T,B)=>new Promise((j,X)=>{const ue=new Image,Se=T.url,Te=T.credentials;Te&&Te==="include"?ue.crossOrigin="use-credentials":(Te&&Te==="same-origin"||!a.s(Se))&&(ue.crossOrigin="anonymous"),B.signal.addEventListener("abort",()=>{ue.src="",X(a.c())}),ue.fetchPriority="high",ue.onload=()=>{ue.onerror=ue.onload=null,j({data:ue})},ue.onerror=()=>{ue.onerror=ue.onload=null,B.signal.aborted||X(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},ue.src=Se})}(Tt||(Tt={})),Tt.resetRequestQueue(),function(y){y.Glyphs="Glyphs",y.Image="Image",y.Source="Source",y.SpriteImage="SpriteImage",y.SpriteJSON="SpriteJSON",y.Style="Style",y.Tile="Tile",y.Unknown="Unknown"}(zt||(zt={}));class Rt{constructor(s){this._transformRequestFn=s}transformRequest(s,i){return this._transformRequestFn&&this._transformRequestFn(s,i)||{url:s}}normalizeSpriteURL(s,i,r){const l=function(d){const _=d.match(Oe);if(!_)throw new Error(`Unable to parse URL "${d}"`);return{protocol:_[1],authority:_[2],path:_[3]||"/",params:_[4]?_[4].split("&"):[]}}(s);return l.path+=`${i}${r}`,function(d){const _=d.params.length?`?${d.params.join("&")}`:"";return`${d.protocol}://${d.authority}${d.path}${_}`}(l)}setTransformRequest(s){this._transformRequestFn=s}}const Oe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function jt(y){var s=new a.A(3);return s[0]=y[0],s[1]=y[1],s[2]=y[2],s}var at,_t=function(y,s,i){return y[0]=s[0]-i[0],y[1]=s[1]-i[1],y[2]=s[2]-i[2],y};at=new a.A(3),a.A!=Float32Array&&(at[0]=0,at[1]=0,at[2]=0);var mt=function(y){var s=y[0],i=y[1];return s*s+i*i};function xt(y){const s=[];if(typeof y=="string")s.push({id:"default",url:y});else if(y&&y.length>0){const i=[];for(const{id:r,url:l}of y){const d=`${r}${l}`;i.indexOf(d)===-1&&(i.push(d),s.push({id:r,url:l}))}}return s}(function(){var y=new a.A(2);a.A!=Float32Array&&(y[0]=0,y[1]=0)})();class bt{constructor(s,i,r,l){this.context=s,this.format=r,this.texture=s.gl.createTexture(),this.update(i,l)}update(s,i,r){const{width:l,height:d}=s,_=!(this.size&&this.size[0]===l&&this.size[1]===d||r),{context:w}=this,{gl:T}=w;if(this.useMipmap=!!(i&&i.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!i||i.premultiply!==!1)),_)this.size=[l,d],s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||a.b(s)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,s):T.texImage2D(T.TEXTURE_2D,0,this.format,l,d,0,this.format,T.UNSIGNED_BYTE,s.data);else{const{x:B,y:j}=r||{x:0,y:0};s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||a.b(s)?T.texSubImage2D(T.TEXTURE_2D,0,B,j,T.RGBA,T.UNSIGNED_BYTE,s):T.texSubImage2D(T.TEXTURE_2D,0,B,j,l,d,T.RGBA,T.UNSIGNED_BYTE,s.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D)}bind(s,i,r){const{context:l}=this,{gl:d}=l;d.bindTexture(d.TEXTURE_2D,this.texture),r!==d.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=d.LINEAR),s!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,s),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,r||s),this.filter=s),i!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,i),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}function lt(y){const{userImage:s}=y;return!!(s&&s.render&&s.render())&&(y.data.replace(new Uint8Array(s.data.buffer)),!0)}class $e extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(s){if(this.loaded!==s&&(this.loaded=s,s)){for(const{ids:i,promiseResolve:r}of this.requestors)r(this._getImagesForIds(i));this.requestors=[]}}getImage(s){const i=this.images[s];if(i&&!i.data&&i.spriteData){const r=i.spriteData;i.data=new a.R({width:r.width,height:r.height},r.context.getImageData(r.x,r.y,r.width,r.height).data),i.spriteData=null}return i}addImage(s,i){if(this.images[s])throw new Error(`Image id ${s} already exist, use updateImage instead`);this._validate(s,i)&&(this.images[s]=i)}_validate(s,i){let r=!0;const l=i.data||i.spriteData;return this._validateStretch(i.stretchX,l&&l.width)||(this.fire(new a.j(new Error(`Image "${s}" has invalid "stretchX" value`))),r=!1),this._validateStretch(i.stretchY,l&&l.height)||(this.fire(new a.j(new Error(`Image "${s}" has invalid "stretchY" value`))),r=!1),this._validateContent(i.content,i)||(this.fire(new a.j(new Error(`Image "${s}" has invalid "content" value`))),r=!1),r}_validateStretch(s,i){if(!s)return!0;let r=0;for(const l of s){if(l[0]<r||l[1]<l[0]||i<l[1])return!1;r=l[1]}return!0}_validateContent(s,i){if(!s)return!0;if(s.length!==4)return!1;const r=i.spriteData,l=r&&r.width||i.data.width,d=r&&r.height||i.data.height;return!(s[0]<0||l<s[0]||s[1]<0||d<s[1]||s[2]<0||l<s[2]||s[3]<0||d<s[3]||s[2]<s[0]||s[3]<s[1])}updateImage(s,i,r=!0){const l=this.getImage(s);if(r&&(l.data.width!==i.data.width||l.data.height!==i.data.height))throw new Error(`size mismatch between old image (${l.data.width}x${l.data.height}) and new image (${i.data.width}x${i.data.height}).`);i.version=l.version+1,this.images[s]=i,this.updatedImages[s]=!0}removeImage(s){const i=this.images[s];delete this.images[s],delete this.patterns[s],i.userImage&&i.userImage.onRemove&&i.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(s){return new Promise((i,r)=>{let l=!0;if(!this.isLoaded())for(const d of s)this.images[d]||(l=!1);this.isLoaded()||l?i(this._getImagesForIds(s)):this.requestors.push({ids:s,promiseResolve:i})})}_getImagesForIds(s){const i={};for(const r of s){let l=this.getImage(r);l||(this.fire(new a.k("styleimagemissing",{id:r})),l=this.getImage(r)),l?i[r]={data:l.data.clone(),pixelRatio:l.pixelRatio,sdf:l.sdf,version:l.version,stretchX:l.stretchX,stretchY:l.stretchY,content:l.content,hasRenderCallback:!!(l.userImage&&l.userImage.render)}:a.w(`Image "${r}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return i}getPixelSize(){const{width:s,height:i}=this.atlasImage;return{width:s,height:i}}getPattern(s){const i=this.patterns[s],r=this.getImage(s);if(!r)return null;if(i&&i.position.version===r.version)return i.position;if(i)i.position.version=r.version;else{const l={w:r.data.width+2,h:r.data.height+2,x:0,y:0},d=new a.I(l,r);this.patterns[s]={bin:l,position:d}}return this._updatePatternAtlas(),this.patterns[s].position}bind(s){const i=s.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new bt(s,this.atlasImage,i.RGBA),this.atlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}_updatePatternAtlas(){const s=[];for(const d in this.patterns)s.push(this.patterns[d].bin);const{w:i,h:r}=a.p(s),l=this.atlasImage;l.resize({width:i||1,height:r||1});for(const d in this.patterns){const{bin:_}=this.patterns[d],w=_.x+1,T=_.y+1,B=this.getImage(d).data,j=B.width,X=B.height;a.R.copy(B,l,{x:0,y:0},{x:w,y:T},{width:j,height:X}),a.R.copy(B,l,{x:0,y:X-1},{x:w,y:T-1},{width:j,height:1}),a.R.copy(B,l,{x:0,y:0},{x:w,y:T+X},{width:j,height:1}),a.R.copy(B,l,{x:j-1,y:0},{x:w-1,y:T},{width:1,height:X}),a.R.copy(B,l,{x:0,y:0},{x:w+j,y:T},{width:1,height:X})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(s){for(const i of s){if(this.callbackDispatchedThisFrame[i])continue;this.callbackDispatchedThisFrame[i]=!0;const r=this.getImage(i);r||a.w(`Image with ID: "${i}" was not found`),lt(r)&&this.updateImage(i,r)}}}const pt=1e20;function ut(y,s,i,r,l,d,_,w,T){for(let B=s;B<s+r;B++)Nt(y,i*d+B,d,l,_,w,T);for(let B=i;B<i+l;B++)Nt(y,B*d+s,1,r,_,w,T)}function Nt(y,s,i,r,l,d,_){d[0]=0,_[0]=-pt,_[1]=pt,l[0]=y[s];for(let w=1,T=0,B=0;w<r;w++){l[w]=y[s+w*i];const j=w*w;do{const X=d[T];B=(l[w]-l[X]+j-X*X)/(w-X)/2}while(B<=_[T]&&--T>-1);T++,d[T]=w,_[T]=B,_[T+1]=pt}for(let w=0,T=0;w<r;w++){for(;_[T+1]<w;)T++;const B=d[T],j=w-B;y[s+w*i]=l[B]+j*j}}class Bt{constructor(s,i){this.requestManager=s,this.localIdeographFontFamily=i,this.entries={}}setURL(s){this.url=s}getGlyphs(s){return a._(this,void 0,void 0,function*(){const i=[];for(const d in s)for(const _ of s[d])i.push(this._getAndCacheGlyphsPromise(d,_));const r=yield Promise.all(i),l={};for(const{stack:d,id:_,glyph:w}of r)l[d]||(l[d]={}),l[d][_]=w&&{id:w.id,bitmap:w.bitmap.clone(),metrics:w.metrics};return l})}_getAndCacheGlyphsPromise(s,i){return a._(this,void 0,void 0,function*(){let r=this.entries[s];r||(r=this.entries[s]={glyphs:{},requests:{},ranges:{}});let l=r.glyphs[i];if(l!==void 0)return{stack:s,id:i,glyph:l};if(l=this._tinySDF(r,s,i),l)return r.glyphs[i]=l,{stack:s,id:i,glyph:l};const d=Math.floor(i/256);if(256*d>65535)throw new Error("glyphs > 65535 not supported");if(r.ranges[d])return{stack:s,id:i,glyph:l};if(!this.url)throw new Error("glyphsUrl is not set");if(!r.requests[d]){const w=Bt.loadGlyphRange(s,d,this.url,this.requestManager);r.requests[d]=w}const _=yield r.requests[d];for(const w in _)this._doesCharSupportLocalGlyph(+w)||(r.glyphs[+w]=_[+w]);return r.ranges[d]=!0,{stack:s,id:i,glyph:_[i]||null}})}_doesCharSupportLocalGlyph(s){return!!this.localIdeographFontFamily&&(a.u["CJK Unified Ideographs"](s)||a.u["Hangul Syllables"](s)||a.u.Hiragana(s)||a.u.Katakana(s))}_tinySDF(s,i,r){const l=this.localIdeographFontFamily;if(!l||!this._doesCharSupportLocalGlyph(r))return;let d=s.tinySDF;if(!d){let w="400";/bold/i.test(i)?w="900":/medium/i.test(i)?w="500":/light/i.test(i)&&(w="200"),d=s.tinySDF=new Bt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:l,fontWeight:w})}const _=d.draw(String.fromCharCode(r));return{id:r,bitmap:new a.o({width:_.width||60,height:_.height||60},_.data),metrics:{width:_.glyphWidth/2||24,height:_.glyphHeight/2||24,left:_.glyphLeft/2+.5||0,top:_.glyphTop/2-27.5||-8,advance:_.glyphAdvance/2||24,isDoubleResolution:!0}}}}Bt.loadGlyphRange=function(y,s,i,r){return a._(this,void 0,void 0,function*(){const l=256*s,d=l+255,_=r.transformRequest(i.replace("{fontstack}",y).replace("{range}",`${l}-${d}`),zt.Glyphs),w=yield a.l(_,new AbortController);if(!w||!w.data)throw new Error(`Could not load glyph range. range: ${s}, ${l}-${d}`);const T={};for(const B of a.n(w.data))T[B.id]=B;return T})},Bt.TinySDF=class{constructor({fontSize:y=24,buffer:s=3,radius:i=8,cutoff:r=.25,fontFamily:l="sans-serif",fontWeight:d="normal",fontStyle:_="normal"}={}){this.buffer=s,this.cutoff=r,this.radius=i;const w=this.size=y+4*s,T=this._createCanvas(w),B=this.ctx=T.getContext("2d",{willReadFrequently:!0});B.font=`${_} ${d} ${y}px ${l}`,B.textBaseline="alphabetic",B.textAlign="left",B.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(y){const s=document.createElement("canvas");return s.width=s.height=y,s}draw(y){const{width:s,actualBoundingBoxAscent:i,actualBoundingBoxDescent:r,actualBoundingBoxLeft:l,actualBoundingBoxRight:d}=this.ctx.measureText(y),_=Math.ceil(i),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(d-l))),T=Math.min(this.size-this.buffer,_+Math.ceil(r)),B=w+2*this.buffer,j=T+2*this.buffer,X=Math.max(B*j,0),ue=new Uint8ClampedArray(X),Se={data:ue,width:B,height:j,glyphWidth:w,glyphHeight:T,glyphTop:_,glyphLeft:0,glyphAdvance:s};if(w===0||T===0)return Se;const{ctx:Te,buffer:Re,gridInner:Be,gridOuter:et}=this;Te.clearRect(Re,Re,w,T),Te.fillText(y,Re,Re+_);const vt=Te.getImageData(Re,Re,w,T);et.fill(pt,0,X),Be.fill(0,0,X);for(let ot=0;ot<T;ot++)for(let ht=0;ht<w;ht++){const Et=vt.data[4*(ot*w+ht)+3]/255;if(Et===0)continue;const wt=(ot+Re)*B+ht+Re;if(Et===1)et[wt]=0,Be[wt]=pt;else{const si=.5-Et;et[wt]=si>0?si*si:0,Be[wt]=si<0?si*si:0}}ut(et,0,0,B,j,B,this.f,this.v,this.z),ut(Be,Re,Re,w,T,B,this.f,this.v,this.z);for(let ot=0;ot<X;ot++){const ht=Math.sqrt(et[ot])-Math.sqrt(Be[ot]);ue[ot]=Math.round(255-255*(ht/this.radius+this.cutoff))}return Se}};class Ot{constructor(){this.specification=a.v.light.position}possiblyEvaluate(s,i){return a.y(s.expression.evaluate(i))}interpolate(s,i,r){return{x:a.z.number(s.x,i.x,r),y:a.z.number(s.y,i.y,r),z:a.z.number(s.z,i.z,r)}}}let gi;class Ii extends a.E{constructor(s){super(),gi=gi||new a.q({anchor:new a.D(a.v.light.anchor),position:new Ot,color:new a.D(a.v.light.color),intensity:new a.D(a.v.light.intensity)}),this._transitionable=new a.T(gi),this.setLight(s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,i={}){if(!this._validate(a.r,s,i))for(const r in s){const l=s[r];r.endsWith("-transition")?this._transitionable.setTransition(r.slice(0,-11),l):this._transitionable.setValue(r,l)}}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,i,r){return(!r||r.validate!==!1)&&a.t(this,s.call(a.x,{value:i,style:{glyphs:!0,sprite:!0},styleSpec:a.v}))}}class Ci{constructor(s,i){this.width=s,this.height=i,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(s,i){const r=s.join(",")+String(i);return this.dashEntry[r]||(this.dashEntry[r]=this.addDash(s,i)),this.dashEntry[r]}getDashRanges(s,i,r){const l=[];let d=s.length%2==1?-s[s.length-1]*r:0,_=s[0]*r,w=!0;l.push({left:d,right:_,isDash:w,zeroLength:s[0]===0});let T=s[0];for(let B=1;B<s.length;B++){w=!w;const j=s[B];d=T*r,T+=j,_=T*r,l.push({left:d,right:_,isDash:w,zeroLength:j===0})}return l}addRoundDash(s,i,r){const l=i/2;for(let d=-r;d<=r;d++){const _=this.width*(this.nextRow+r+d);let w=0,T=s[w];for(let B=0;B<this.width;B++){B/T.right>1&&(T=s[++w]);const j=Math.abs(B-T.left),X=Math.abs(B-T.right),ue=Math.min(j,X);let Se;const Te=d/r*(l+1);if(T.isDash){const Re=l-Math.abs(Te);Se=Math.sqrt(ue*ue+Re*Re)}else Se=l-Math.sqrt(ue*ue+Te*Te);this.data[_+B]=Math.max(0,Math.min(255,Se+128))}}}addRegularDash(s){for(let w=s.length-1;w>=0;--w){const T=s[w],B=s[w+1];T.zeroLength?s.splice(w,1):B&&B.isDash===T.isDash&&(B.left=T.left,s.splice(w,1))}const i=s[0],r=s[s.length-1];i.isDash===r.isDash&&(i.left=r.left-this.width,r.right=i.right+this.width);const l=this.width*this.nextRow;let d=0,_=s[d];for(let w=0;w<this.width;w++){w/_.right>1&&(_=s[++d]);const T=Math.abs(w-_.left),B=Math.abs(w-_.right),j=Math.min(T,B);this.data[l+w]=Math.max(0,Math.min(255,(_.isDash?j:-j)+128))}}addDash(s,i){const r=i?7:0,l=2*r+1;if(this.nextRow+l>this.height)return a.w("LineAtlas out of space"),null;let d=0;for(let w=0;w<s.length;w++)d+=s[w];if(d!==0){const w=this.width/d,T=this.getDashRanges(s,this.width,w);i?this.addRoundDash(T,w,r):this.addRegularDash(T)}const _={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:d};return this.nextRow+=l,this.dirty=!0,_}bind(s){const i=s.gl;this.texture?(i.bindTexture(i.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,i.texSubImage2D(i.TEXTURE_2D,0,0,0,this.width,this.height,i.ALPHA,i.UNSIGNED_BYTE,this.data))):(this.texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.ALPHA,this.width,this.height,0,i.ALPHA,i.UNSIGNED_BYTE,this.data))}}const Ri="maplibre_preloaded_worker_pool";class Ki{constructor(){this.active={}}acquire(s){if(!this.workers)for(this.workers=[];this.workers.length<Ki.workerCount;)this.workers.push(new Worker(a.a.WORKER_URL));return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(i=>{i.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ri]}numActive(){return Object.keys(this.active).length}}const Hi=Math.floor(ae.hardwareConcurrency/2);let Ni,nn;function vn(){return Ni||(Ni=new Ki),Ni}Ki.workerCount=a.B(globalThis)?Math.max(Math.min(Hi,3),1):1;class Ei{constructor(s,i){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=i;const r=this.workerPool.acquire(i);for(let l=0;l<r.length;l++){const d=new a.C(r[l],i);d.name=`Worker ${l}`,this.actors.push(d)}if(!this.actors.length)throw new Error("No actors found")}broadcast(s,i){const r=[];for(const l of this.actors)r.push(l.sendAsync({type:s,data:i}));return Promise.all(r)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(s=!0){this.actors.forEach(i=>{i.remove()}),this.actors=[],s&&this.workerPool.release(this.id)}registerMessageHandler(s,i){for(const r of this.actors)r.registerMessageHandler(s,i)}}function mi(){return nn||(nn=new Ei(vn(),a.G),nn.registerMessageHandler("getResource",(y,s,i)=>a.m(s,i))),nn}function zi(y,s){const i=a.F();return a.H(i,i,[1,1,0]),a.J(i,i,[.5*y.width,.5*y.height,1]),a.K(i,i,y.calculatePosMatrix(s.toUnwrapped()))}function Oi(y,s,i,r,l,d){const _=function(X,ue,Se){if(X)for(const Te of X){const Re=ue[Te];if(Re&&Re.source===Se&&Re.type==="fill-extrusion")return!0}else for(const Te in ue){const Re=ue[Te];if(Re.source===Se&&Re.type==="fill-extrusion")return!0}return!1}(l&&l.layers,s,y.id),w=d.maxPitchScaleFactor(),T=y.tilesIn(r,w,_);T.sort(xn);const B=[];for(const X of T)B.push({wrappedTileID:X.tileID.wrapped().key,queryResults:X.tile.queryRenderedFeatures(s,i,y._state,X.queryGeometry,X.cameraQueryGeometry,X.scale,l,d,w,zi(y.transform,X.tileID))});const j=function(X){const ue={},Se={};for(const Te of X){const Re=Te.queryResults,Be=Te.wrappedTileID,et=Se[Be]=Se[Be]||{};for(const vt in Re){const ot=Re[vt],ht=et[vt]=et[vt]||{},Et=ue[vt]=ue[vt]||[];for(const wt of ot)ht[wt.featureIndex]||(ht[wt.featureIndex]=!0,Et.push(wt))}}return ue}(B);for(const X in j)j[X].forEach(ue=>{const Se=ue.feature,Te=y.getFeatureState(Se.layer["source-layer"],Se.id);Se.source=Se.layer.source,Se.layer["source-layer"]&&(Se.sourceLayer=Se.layer["source-layer"]),Se.state=Te});return j}function xn(y,s){const i=y.tileID,r=s.tileID;return i.overscaledZ-r.overscaledZ||i.canonical.y-r.canonical.y||i.wrap-r.wrap||i.canonical.x-r.canonical.x}function bn(y,s,i){return a._(this,void 0,void 0,function*(){let r=y;if(y.url?r=(yield a.h(s.transformRequest(y.url,zt.Source),i)).data:yield ae.frameAsync(i),!r)return null;const l=a.L(a.e(r,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in r&&r.vector_layers&&(l.vectorLayerIds=r.vector_layers.map(d=>d.id)),l})}class Yt{constructor(s,i){s&&(i?this.setSouthWest(s).setNorthEast(i):Array.isArray(s)&&(s.length===4?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1])))}setNorthEast(s){return this._ne=s instanceof a.M?new a.M(s.lng,s.lat):a.M.convert(s),this}setSouthWest(s){return this._sw=s instanceof a.M?new a.M(s.lng,s.lat):a.M.convert(s),this}extend(s){const i=this._sw,r=this._ne;let l,d;if(s instanceof a.M)l=s,d=s;else{if(!(s instanceof Yt))return Array.isArray(s)?s.length===4||s.every(Array.isArray)?this.extend(Yt.convert(s)):this.extend(a.M.convert(s)):s&&("lng"in s||"lon"in s)&&"lat"in s?this.extend(a.M.convert(s)):this;if(l=s._sw,d=s._ne,!l||!d)return this}return i||r?(i.lng=Math.min(l.lng,i.lng),i.lat=Math.min(l.lat,i.lat),r.lng=Math.max(d.lng,r.lng),r.lat=Math.max(d.lat,r.lat)):(this._sw=new a.M(l.lng,l.lat),this._ne=new a.M(d.lng,d.lat)),this}getCenter(){return new a.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.M(this.getWest(),this.getNorth())}getSouthEast(){return new a.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:i,lat:r}=a.M.convert(s);let l=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(l=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=r&&r<=this._ne.lat&&l}static convert(s){return s instanceof Yt?s:s&&new Yt(s)}static fromLngLat(s,i=0){const r=360*i/40075017,l=r/Math.cos(Math.PI/180*s.lat);return new Yt(new a.M(s.lng-l,s.lat-r),new a.M(s.lng+l,s.lat+r))}}class rn{constructor(s,i,r){this.bounds=Yt.convert(this.validateBounds(s)),this.minzoom=i||0,this.maxzoom=r||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){const i=Math.pow(2,s.z),r=Math.floor(a.N(this.bounds.getWest())*i),l=Math.floor(a.O(this.bounds.getNorth())*i),d=Math.ceil(a.N(this.bounds.getEast())*i),_=Math.ceil(a.O(this.bounds.getSouth())*i);return s.x>=r&&s.x<d&&s.y>=l&&s.y<_}}class Xt extends a.E{constructor(s,i,r,l){if(super(),this.id=s,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.L(i,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(l)}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const s=yield bn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),s&&(a.e(this,s),s.bounds&&(this.tileBounds=new rn(s.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))}catch(s){this._tileJSONRequest=null,this.fire(new a.j(s))}})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}setSourceProperty(s){this._tileJSONRequest&&this._tileJSONRequest.abort(),s(),this.load()}setTiles(s){return this.setSourceProperty(()=>{this._options.tiles=s}),this}setUrl(s){return this.setSourceProperty(()=>{this.url=s,this._options.url=s}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return a.e({},this._options)}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r={request:this.map._requestManager.transformRequest(i,zt.Tile),uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.request.collectResourceTiming=this._collectResourceTiming;let l="reloadTile";if(s.actor&&s.state!=="expired"){if(s.state==="loading")return new Promise((d,_)=>{s.reloadPromise={resolve:d,reject:_}})}else s.actor=this.dispatcher.getActor(),l="loadTile";s.abortController=new AbortController;try{const d=yield s.actor.sendAsync({type:l,data:r},s.abortController);if(delete s.abortController,s.aborted)return;this._afterTileLoadWorkerResponse(s,d)}catch(d){if(delete s.abortController,s.aborted)return;if(d&&d.status!==404)throw d;this._afterTileLoadWorkerResponse(s,null)}})}_afterTileLoadWorkerResponse(s,i){if(i&&i.resourceTiming&&(s.resourceTiming=i.resourceTiming),i&&this.map._refreshExpiredTiles&&s.setExpiryData(i),s.loadVectorData(i,this.map.painter),s.reloadPromise){const r=s.reloadPromise;s.reloadPromise=null,this.loadTile(s).then(r.resolve).catch(r.reject)}}abortTile(s){return a._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController),s.actor&&(yield s.actor.sendAsync({type:"abortTile",data:{uid:s.uid,type:this.type,source:this.id}}))})}unloadTile(s){return a._(this,void 0,void 0,function*(){s.unloadVectorData(),s.actor&&(yield s.actor.sendAsync({type:"removeTile",data:{uid:s.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ji extends a.E{constructor(s,i,r,l){super(),this.id=s,this.dispatcher=r,this.setEventedParent(l),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},i),a.e(this,a.L(i,["url","scheme","tileSize"]))}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const s=yield bn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,s&&(a.e(this,s),s.bounds&&(this.tileBounds=new rn(s.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))}catch(s){this._tileJSONRequest=null,this.fire(new a.j(s))}})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(s){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),s(),this.load()}setTiles(s){return this.setSourceProperty(()=>{this._options.tiles=s}),this}setUrl(s){return this.setSourceProperty(()=>{this.url=s,this._options.url=s}),this}serialize(){return a.e({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);s.abortController=new AbortController;try{const r=yield Tt.getImage(this.map._requestManager.transformRequest(i,zt.Tile),s.abortController,this.map._refreshExpiredTiles);if(delete s.abortController,s.aborted)return void(s.state="unloaded");if(r&&r.data){this.map._refreshExpiredTiles&&r.cacheControl&&r.expires&&s.setExpiryData({cacheControl:r.cacheControl,expires:r.expires});const l=this.map.painter.context,d=l.gl,_=r.data;s.texture=this.map.painter.getTileTexture(_.width),s.texture?s.texture.update(_,{useMipmap:!0}):(s.texture=new bt(l,_,d.RGBA,{useMipmap:!0}),s.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),l.extTextureFilterAnisotropic&&d.texParameterf(d.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax)),s.state="loaded"}}catch(r){if(delete s.abortController,s.aborted)s.state="unloaded";else if(r)throw s.state="errored",r}})}abortTile(s){return a._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController)})}unloadTile(s){return a._(this,void 0,void 0,function*(){s.texture&&this.map.painter.saveTileTexture(s.texture)})}hasTransition(){return!1}}class mr extends Ji{constructor(s,i,r,l){super(s,i,r,l),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox",this.redFactor=i.redFactor,this.greenFactor=i.greenFactor,this.blueFactor=i.blueFactor,this.baseShift=i.baseShift}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r=this.map._requestManager.transformRequest(i,zt.Tile);s.neighboringTiles=this._getNeighboringTiles(s.tileID),s.abortController=new AbortController;try{const l=yield Tt.getImage(r,s.abortController,this.map._refreshExpiredTiles);if(delete s.abortController,s.aborted)return void(s.state="unloaded");if(l&&l.data){const d=l.data;this.map._refreshExpiredTiles&&l.cacheControl&&l.expires&&s.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const _=a.b(d)&&a.S()?d:yield this.readImageNow(d),w={type:this.type,uid:s.uid,source:this.id,rawImageData:_,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!s.actor||s.state==="expired"){s.actor=this.dispatcher.getActor();const T=yield s.actor.sendAsync({type:"loadDEMTile",data:w});s.dem=T,s.needsHillshadePrepare=!0,s.needsTerrainPrepare=!0,s.state="loaded"}}}catch(l){if(delete s.abortController,s.aborted)s.state="unloaded";else if(l)throw s.state="errored",l}})}readImageNow(s){return a._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&a.U()){const i=s.width+2,r=s.height+2;try{return new a.R({width:i,height:r},yield a.V(s,-1,-1,i,r))}catch{}}return ae.getImageData(s,1)})}_getNeighboringTiles(s){const i=s.canonical,r=Math.pow(2,i.z),l=(i.x-1+r)%r,d=i.x===0?s.wrap-1:s.wrap,_=(i.x+1+r)%r,w=i.x+1===r?s.wrap+1:s.wrap,T={};return T[new a.Q(s.overscaledZ,d,i.z,l,i.y).key]={backfilled:!1},T[new a.Q(s.overscaledZ,w,i.z,_,i.y).key]={backfilled:!1},i.y>0&&(T[new a.Q(s.overscaledZ,d,i.z,l,i.y-1).key]={backfilled:!1},T[new a.Q(s.overscaledZ,s.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},T[new a.Q(s.overscaledZ,w,i.z,_,i.y-1).key]={backfilled:!1}),i.y+1<r&&(T[new a.Q(s.overscaledZ,d,i.z,l,i.y+1).key]={backfilled:!1},T[new a.Q(s.overscaledZ,s.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},T[new a.Q(s.overscaledZ,w,i.z,_,i.y+1).key]={backfilled:!1}),T}unloadTile(s){return a._(this,void 0,void 0,function*(){s.demTexture&&this.map.painter.saveTileTexture(s.demTexture),s.fbo&&(s.fbo.destroy(),delete s.fbo),s.dem&&delete s.dem,delete s.neighboringTiles,s.state="unloaded",s.actor&&(yield s.actor.sendAsync({type:"removeDEMTile",data:{type:this.type,uid:s.uid,source:this.id}}))})}}class ci extends a.E{constructor(s,i,r,l){super(),this.id=s,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=r.getActor(),this.setEventedParent(l),this._data=i.data,this._options=a.e({},i),this._collectResourceTiming=i.collectResourceTiming,i.maxzoom!==void 0&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const d=a.W/this.tileSize;this.workerOptions=a.e({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(i.buffer!==void 0?i.buffer:128)*d,tolerance:(i.tolerance!==void 0?i.tolerance:.375)*d,extent:a.W,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:i.clusterMaxZoom!==void 0?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:a.W,radius:(i.clusterRadius||50)*d,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return a._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(s){this.map=s,this.load()}setData(s){return this._data=s,this._updateWorkerData(),this}updateData(s){return this._updateWorkerData(s),this}setClusterOptions(s){return this.workerOptions.cluster=s.cluster,s&&(s.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=s.clusterRadius),s.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=s.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(s){return this.actor.sendAsync({type:"getClusterExpansionZoom",data:{type:this.type,clusterId:s,source:this.id}})}getClusterChildren(s){return this.actor.sendAsync({type:"getClusterChildren",data:{type:this.type,clusterId:s,source:this.id}})}getClusterLeaves(s,i,r){return this.actor.sendAsync({type:"getClusterLeaves",data:{type:this.type,source:this.id,clusterId:s,limit:i,offset:r}})}_updateWorkerData(s){return a._(this,void 0,void 0,function*(){const i=a.e({type:this.type},this.workerOptions);s?i.dataDiff=s:typeof this._data=="string"?(i.request=this.map._requestManager.transformRequest(ae.resolveURL(this._data),zt.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new a.k("dataloading",{dataType:"source"}));try{const r=yield this.actor.sendAsync({type:"loadData",data:i});if(this._pendingLoads--,this._removed||r.abandoned)return void this.fire(new a.k("dataabort",{dataType:"source"}));let l=null;r.resourceTiming&&r.resourceTiming[this.id]&&(l=r.resourceTiming[this.id].slice(0));const d={dataType:"source"};this._collectResourceTiming&&l&&l.length>0&&a.e(d,{resourceTiming:l}),this.fire(new a.k("data",Object.assign(Object.assign({},d),{sourceDataType:"metadata"}))),this.fire(new a.k("data",Object.assign(Object.assign({},d),{sourceDataType:"content"})))}catch(r){if(this._pendingLoads--,this._removed)return void this.fire(new a.k("dataabort",{dataType:"source"}));this.fire(new a.j(r))}})}loaded(){return this._pendingLoads===0}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.actor?"reloadTile":"loadTile";s.actor=this.actor;const r={type:this.type,uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};s.abortController=new AbortController;const l=yield this.actor.sendAsync({type:i,data:r},s.abortController);delete s.abortController,s.unloadVectorData(),s.aborted||s.loadVectorData(l,this.map.painter,i==="reloadTile")})}abortTile(s){return a._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController),s.aborted=!0})}unloadTile(s){return a._(this,void 0,void 0,function*(){s.unloadVectorData(),yield this.actor.sendAsync({type:"removeTile",data:{uid:s.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"removeSource",data:{type:this.type,source:this.id}})}serialize(){return a.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var sn=a.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class lr extends a.E{constructor(s,i,r,l){super(),this.id=s,this.dispatcher=r,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(l),this.options=i}load(s){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const i=yield Tt.getImage(this.map._requestManager.transformRequest(this.url,zt.Image),this._request);this._request=null,this._loaded=!0,i&&i.data&&(this.image=i.data,s&&(this.coordinates=s),this._finishLoading())}catch(i){this._request=null,this.fire(new a.j(i))}})}loaded(){return this._loaded}updateImage(s){return s.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=s.url,this.load(s.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(s){this.coordinates=s;const i=s.map(a.Y.fromLngLat);this.tileID=function(l){let d=1/0,_=1/0,w=-1/0,T=-1/0;for(const ue of l)d=Math.min(d,ue.x),_=Math.min(_,ue.y),w=Math.max(w,ue.x),T=Math.max(T,ue.y);const B=Math.max(w-d,T-_),j=Math.max(0,Math.floor(-Math.log(B)/Math.LN2)),X=Math.pow(2,j);return new a.a0(j,Math.floor((d+w)/2*X),Math.floor((_+T)/2*X))}(i),this.minzoom=this.maxzoom=this.tileID.z;const r=i.map(l=>this.tileID.getTilePoint(l)._round());return this._boundsArray=new a.Z,this._boundsArray.emplaceBack(r[0].x,r[0].y,0,0),this._boundsArray.emplaceBack(r[1].x,r[1].y,a.W,0),this._boundsArray.emplaceBack(r[3].x,r[3].y,0,a.W),this._boundsArray.emplaceBack(r[2].x,r[2].y,a.W,a.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const s=this.map.painter.context,i=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,sn.members)),this.boundsSegments||(this.boundsSegments=a.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new bt(s,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let r=!1;for(const l in this.tiles){const d=this.tiles[l];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture,r=!0)}r&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(s){return a._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={}):s.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class On extends lr{constructor(s,i,r,l){super(s,i,r,l),this.roundZoom=!0,this.type="video",this.options=i}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1;const s=this.options;this.urls=[];for(const i of s.urls)this.urls.push(this.map._requestManager.transformRequest(i,zt.Source).url);try{const i=yield a.a2(this.urls);if(this._loaded=!0,!i)return;this.video=i,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(i){this.fire(new a.j(i))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(s){if(this.video){const i=this.video.seekable;s<i.start(0)||s>i.end(0)?this.fire(new a.j(new a.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=s}}getVideo(){return this.video}onAdd(s){this.map||(this.map=s,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const s=this.map.painter.context,i=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,sn.members)),this.boundsSegments||(this.boundsSegments=a.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new bt(s,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let r=!1;for(const l in this.tiles){const d=this.tiles[l];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture,r=!0)}r&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Gn extends lr{constructor(s,i,r,l){super(s,i,r,l),i.coordinates?Array.isArray(i.coordinates)&&i.coordinates.length===4&&!i.coordinates.some(d=>!Array.isArray(d)||d.length!==2||d.some(_=>typeof _!="number"))||this.fire(new a.j(new a.a1(`sources.${s}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.j(new a.a1(`sources.${s}`,null,'missing required property "coordinates"'))),i.animate&&typeof i.animate!="boolean"&&this.fire(new a.j(new a.a1(`sources.${s}`,null,'optional "animate" property must be a boolean value'))),i.canvas?typeof i.canvas=="string"||i.canvas instanceof HTMLCanvasElement||this.fire(new a.j(new a.a1(`sources.${s}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.j(new a.a1(`sources.${s}`,null,'missing required property "canvas"'))),this.options=i,this.animate=i.animate===void 0||i.animate}load(){return a._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(s){this.map=s,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let s=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,s=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,s=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const i=this.map.painter.context,r=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,sn.members)),this.boundsSegments||(this.boundsSegments=a.$.simpleSegment(0,0,4,2)),this.texture?(s||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new bt(i,this.canvas,r.RGBA,{premultiply:!0});let l=!1;for(const d in this.tiles){const _=this.tiles[d];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,l=!0)}l&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const s of[this.canvas.width,this.canvas.height])if(isNaN(s)||s<=0)return!0;return!1}}const pn={},v=y=>{switch(y){case"geojson":return ci;case"image":return lr;case"raster":return Ji;case"raster-dem":return mr;case"vector":return Xt;case"video":return On;case"canvas":return Gn}return pn[y]};class k extends a.E{constructor(){super(...arguments),this.pluginStatus="unavailable",this.pluginURL=null,this.dispatcher=mi(),this.queue=[]}_sendPluginStateToWorker(){return a._(this,void 0,void 0,function*(){yield this.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}),this.fire(new a.k("pluginStateChange",{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}))})}getRTLTextPluginStatus(){return this.pluginStatus}clearRTLTextPlugin(){this.pluginStatus="unavailable",this.pluginURL=null}setRTLTextPlugin(s,i=!1){return a._(this,void 0,void 0,function*(){if(this.pluginStatus==="deferred"||this.pluginStatus==="loading"||this.pluginStatus==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");this.pluginURL=ae.resolveURL(s),this.pluginStatus="deferred",yield this._sendPluginStateToWorker(),i||(yield this._downloadRTLTextPlugin())})}_downloadRTLTextPlugin(){return a._(this,void 0,void 0,function*(){if(this.pluginStatus!=="deferred"||!this.pluginURL)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");try{this.pluginStatus="loading",yield this._sendPluginStateToWorker(),yield a.l({url:this.pluginURL},new AbortController),this.pluginStatus="loaded"}catch{this.pluginStatus="error"}yield this._sendPluginStateToWorker()})}lazyLoadRTLTextPlugin(){return a._(this,void 0,void 0,function*(){this.pluginStatus==="deferred"&&(yield this._downloadRTLTextPlugin())})}}let V=null;function Y(){return V||(V=new k),V}class te{constructor(s,i){this.timeAdded=0,this.fadeEndTime=0,this.tileID=s,this.uid=a.a3(),this.uses=0,this.tileSize=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(s){const i=s+this.timeAdded;i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(s){this.demTexture&&s.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(s,i,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(l,d){const _={};if(!d)return _;for(const w of l){const T=w.layerIds.map(B=>d.getLayer(B)).filter(Boolean);if(T.length!==0){w.layers=T,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(B=>T.filter(j=>j.id===B)[0]));for(const B of T)_[B.id]=w}}return _}(s.buckets,i.style),this.hasSymbolBuckets=!1;for(const l in this.buckets){const d=this.buckets[l];if(d instanceof a.a5){if(this.hasSymbolBuckets=!0,!r)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const l in this.buckets){const d=this.buckets[l];if(d instanceof a.a5&&d.hasRTLText){this.hasRTLText=!0,Y().lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const l in this.buckets){const d=this.buckets[l];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(l).queryRadius(d))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage)}else this.collisionBoxArray=new a.a4}unloadVectorData(){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(s){return this.buckets[s.id]}upload(s){for(const r in this.buckets){const l=this.buckets[r];l.uploadPending()&&l.upload(s)}const i=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new bt(s,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new bt(s,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null)}prepare(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)}queryRenderedFeatures(s,i,r,l,d,_,w,T,B,j){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:l,cameraQueryGeometry:d,scale:_,tileSize:this.tileSize,pixelPosMatrix:j,transform:T,params:w,queryPadding:this.queryPadding*B},s,i,r):{}}querySourceFeatures(s,i){const r=this.latestFeatureIndex;if(!r||!r.rawTileData)return;const l=r.loadVTLayers(),d=i&&i.sourceLayer?i.sourceLayer:"",_=l._geojsonTileLayer||l[d];if(!_)return;const w=a.a6(i&&i.filter),{z:T,x:B,y:j}=this.tileID.canonical,X={z:T,x:B,y:j};for(let ue=0;ue<_.length;ue++){const Se=_.feature(ue);if(w.needGeometry){const Be=a.a7(Se,!0);if(!w.filter(new a.a8(this.tileID.overscaledZ),Be,this.tileID.canonical))continue}else if(!w.filter(new a.a8(this.tileID.overscaledZ),Se))continue;const Te=r.getId(Se,d),Re=new a.a9(Se,T,B,j,Te);Re.tile=X,s.push(Re)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const i=this.expirationTime;if(s.cacheControl){const r=a.aa(s.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const r=Date.now();let l=!1;if(this.expirationTime>r)l=!1;else if(i)if(this.expirationTime<i)l=!0;else{const d=this.expirationTime-i;d?this.expirationTime=r+Math.max(d,3e4):l=!0}else l=!0;l?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(s,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(s).length===0)return;const r=this.latestFeatureIndex.loadVTLayers();for(const l in this.buckets){if(!i.style.hasLayer(l))continue;const d=this.buckets[l],_=d.layers[0].sourceLayer||"_geojsonTileLayer",w=r[_],T=s[_];if(!w||!T||Object.keys(T).length===0)continue;d.update(T,w,this.imageAtlas&&this.imageAtlas.patternPositions||{});const B=i&&i.style&&i.style.getLayer(l);B&&(this.queryPadding=Math.max(this.queryPadding,B.queryRadius(d)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ae.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=ae.now()+s}setDependencies(s,i){const r={};for(const l of i)r[l]=!0;this.dependencies[s]=r}hasDependency(s,i){for(const r of s){const l=this.dependencies[r];if(l){for(const d of i)if(l[d])return!0}}return!1}}class fe{constructor(s,i){this.max=s,this.onRemove=i,this.reset()}reset(){for(const s in this.data)for(const i of this.data[s])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(s,i,r){const l=s.wrapped().key;this.data[l]===void 0&&(this.data[l]=[]);const d={value:i,timeout:void 0};if(r!==void 0&&(d.timeout=setTimeout(()=>{this.remove(s,d)},r)),this.data[l].push(d),this.order.push(l),this.order.length>this.max){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const i=this.data[s].shift();return i.timeout&&clearTimeout(i.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),i.value}getByKey(s){const i=this.data[s];return i?i[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,i){if(!this.has(s))return this;const r=s.wrapped().key,l=i===void 0?0:this.data[r].indexOf(i),d=this.data[r][l];return this.data[r].splice(l,1),d.timeout&&clearTimeout(d.timeout),this.data[r].length===0&&delete this.data[r],this.onRemove(d.value),this.order.splice(this.order.indexOf(r),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(s){const i=[];for(const r in this.data)for(const l of this.data[r])s(l.value)||i.push(l);for(const r of i)this.remove(r.value.tileID,r)}}class ve{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,i,r){const l=String(i);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][l]=this.stateChanges[s][l]||{},a.e(this.stateChanges[s][l],r),this.deletedStates[s]===null){this.deletedStates[s]={};for(const d in this.state[s])d!==l&&(this.deletedStates[s][d]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][l]===null){this.deletedStates[s][l]={};for(const d in this.state[s][l])r[d]||(this.deletedStates[s][l][d]=null)}else for(const d in r)this.deletedStates[s]&&this.deletedStates[s][l]&&this.deletedStates[s][l][d]===null&&delete this.deletedStates[s][l][d]}removeFeatureState(s,i,r){if(this.deletedStates[s]===null)return;const l=String(i);if(this.deletedStates[s]=this.deletedStates[s]||{},r&&i!==void 0)this.deletedStates[s][l]!==null&&(this.deletedStates[s][l]=this.deletedStates[s][l]||{},this.deletedStates[s][l][r]=null);else if(i!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][l])for(r in this.deletedStates[s][l]={},this.stateChanges[s][l])this.deletedStates[s][l][r]=null;else this.deletedStates[s][l]=null;else this.deletedStates[s]=null}getState(s,i){const r=String(i),l=a.e({},(this.state[s]||{})[r],(this.stateChanges[s]||{})[r]);if(this.deletedStates[s]===null)return{};if(this.deletedStates[s]){const d=this.deletedStates[s][i];if(d===null)return{};for(const _ in d)delete l[_]}return l}initializeTileState(s,i){s.setFeatureState(this.state,i)}coalesceChanges(s,i){const r={};for(const l in this.stateChanges){this.state[l]=this.state[l]||{};const d={};for(const _ in this.stateChanges[l])this.state[l][_]||(this.state[l][_]={}),a.e(this.state[l][_],this.stateChanges[l][_]),d[_]=this.state[l][_];r[l]=d}for(const l in this.deletedStates){this.state[l]=this.state[l]||{};const d={};if(this.deletedStates[l]===null)for(const _ in this.state[l])d[_]={},this.state[l][_]={};else for(const _ in this.deletedStates[l]){if(this.deletedStates[l][_]===null)this.state[l][_]={};else for(const w of Object.keys(this.deletedStates[l][_]))delete this.state[l][_][w];d[_]=this.state[l][_]}r[l]=r[l]||{},a.e(r[l],d)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(const l in s)s[l].setFeatureState(r,i)}}class Ie extends a.E{constructor(s,i,r){super(),this.id=s,this.dispatcher=r,this.on("data",l=>{l.dataType==="source"&&l.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&l.dataType==="source"&&l.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((l,d,_,w)=>{const T=new(v(d.type))(l,d,_,w);if(T.id!==l)throw new Error(`Expected Source id to be ${l} instead of ${T.id}`);return T})(s,i,r,this),this._tiles={},this._cache=new fe(0,l=>this._unloadTile(l)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ve,this._didEmitContent=!1,this._updated=!1}onAdd(s){this.map=s,this._maxTileCacheSize=s?s._maxTileCacheSize:null,this._maxTileCacheZoomLevels=s?s._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(s)}onRemove(s){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(s)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const s in this._tiles){const i=this._tiles[s];if(i.state!=="loaded"&&i.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(s,i,r){return a._(this,void 0,void 0,function*(){try{yield this._source.loadTile(s),this._tileLoaded(s,i,r)}catch(l){s.state="errored",l.status!==404?this._source.fire(new a.j(l,{tile:s})):this.update(this.transform,this.terrain)}})}_unloadTile(s){this._source.unloadTile&&this._source.unloadTile(s)}_abortTile(s){this._source.abortTile&&this._source.abortTile(s),this._source.fire(new a.k("dataabort",{tile:s,coord:s.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const r=this._tiles[i];r.upload(s),r.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(s=>s.tileID).sort(Ee).map(s=>s.key)}getRenderableIds(s){const i=[];for(const r in this._tiles)this._isIdRenderable(r,s)&&i.push(this._tiles[r]);return s?i.sort((r,l)=>{const d=r.tileID,_=l.tileID,w=new a.P(d.canonical.x,d.canonical.y)._rotate(this.transform.angle),T=new a.P(_.canonical.x,_.canonical.y)._rotate(this.transform.angle);return d.overscaledZ-_.overscaledZ||T.y-w.y||T.x-w.x}).map(r=>r.tileID.key):i.map(r=>r.tileID).sort(Ee).map(r=>r.key)}hasRenderableParent(s){const i=this.findLoadedParent(s,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(s,i){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(i||!this._tiles[s].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(s,"reloading")}}_reloadTile(s,i){return a._(this,void 0,void 0,function*(){const r=this._tiles[s];r&&(r.state!=="loading"&&(r.state=i),yield this._loadTile(r,s,i))})}_tileLoaded(s,i,r){s.timeAdded=ae.now(),r==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(i,s),this.getSource().type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),s.aborted||this._source.fire(new a.k("data",{dataType:"source",tile:s,coord:s.tileID}))}_backfillDEM(s){const i=this.getRenderableIds();for(let l=0;l<i.length;l++){const d=i[l];if(s.neighboringTiles&&s.neighboringTiles[d]){const _=this.getTileByID(d);r(s,_),r(_,s)}}function r(l,d){l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0;let _=d.tileID.canonical.x-l.tileID.canonical.x;const w=d.tileID.canonical.y-l.tileID.canonical.y,T=Math.pow(2,l.tileID.canonical.z),B=d.tileID.key;_===0&&w===0||Math.abs(w)>1||(Math.abs(_)>1&&(Math.abs(_+T)===1?_+=T:Math.abs(_-T)===1&&(_-=T)),d.dem&&l.dem&&(l.dem.backfillBorder(d.dem,_,w),l.neighboringTiles&&l.neighboringTiles[B]&&(l.neighboringTiles[B].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,i,r,l){for(const d in this._tiles){let _=this._tiles[d];if(l[d]||!_.hasData()||_.tileID.overscaledZ<=i||_.tileID.overscaledZ>r)continue;let w=_.tileID;for(;_&&_.tileID.overscaledZ>i+1;){const B=_.tileID.scaledTo(_.tileID.overscaledZ-1);_=this._tiles[B.key],_&&_.hasData()&&(w=B)}let T=w;for(;T.overscaledZ>i;)if(T=T.scaledTo(T.overscaledZ-1),s[T.key]){l[w.key]=w;break}}}findLoadedParent(s,i){if(s.key in this._loadedParentTiles){const r=this._loadedParentTiles[s.key];return r&&r.tileID.overscaledZ>=i?r:null}for(let r=s.overscaledZ-1;r>=i;r--){const l=s.scaledTo(r),d=this._getLoadedTile(l);if(d)return d}}_getLoadedTile(s){const i=this._tiles[s.key];return i&&i.hasData()?i:this._cache.getByKey(s.wrapped().key)}updateCacheSize(s){const i=Math.ceil(s.width/this._source.tileSize)+1,r=Math.ceil(s.height/this._source.tileSize)+1,l=Math.floor(i*r*(this._maxTileCacheZoomLevels===null?a.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),d=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,l):l;this._cache.setMaxSize(d)}handleWrapJump(s){const i=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,i){const r={};for(const l in this._tiles){const d=this._tiles[l];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+i),r[d.tileID.key]=d}this._tiles=r;for(const l in this._timers)clearTimeout(this._timers[l]),delete this._timers[l];for(const l in this._tiles)this._setTileReloadTimer(l,this._tiles[l])}}update(s,i){if(this.transform=s,this.terrain=i,!this._sourceLoaded||this._paused)return;let r;this.updateCacheSize(s),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?r=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(j=>new a.Q(j.canonical.z,j.wrap,j.canonical.z,j.canonical.x,j.canonical.y)):(r=s.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:i}),this._source.hasTile&&(r=r.filter(j=>this._source.hasTile(j)))):r=[];const l=s.coveringZoomLevel(this._source),d=Math.max(l-Ie.maxOverzooming,this._source.minzoom),_=Math.max(l+Ie.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const j={};for(const X of r)if(X.canonical.z>this._source.minzoom){const ue=X.scaledTo(X.canonical.z-1);j[ue.key]=ue;const Se=X.scaledTo(Math.max(this._source.minzoom,Math.min(X.canonical.z,5)));j[Se.key]=Se}r=r.concat(Object.values(j))}const w=r.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,w&&this.fire(new a.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const T=this._updateRetainedTiles(r,l);if(ze(this._source.type)){const j={},X={},ue=Object.keys(T),Se=ae.now();for(const Te of ue){const Re=T[Te],Be=this._tiles[Te];if(!Be||Be.fadeEndTime!==0&&Be.fadeEndTime<=Se)continue;const et=this.findLoadedParent(Re,d);et&&(this._addTile(et.tileID),j[et.tileID.key]=et.tileID),X[Te]=Re}this._retainLoadedChildren(X,l,_,T);for(const Te in j)T[Te]||(this._coveredTiles[Te]=!0,T[Te]=j[Te]);if(i){const Te={},Re={};for(const Be of r)this._tiles[Be.key].hasData()?Te[Be.key]=Be:Re[Be.key]=Be;for(const Be in Re){const et=Re[Be].children(this._source.maxzoom);this._tiles[et[0].key]&&this._tiles[et[1].key]&&this._tiles[et[2].key]&&this._tiles[et[3].key]&&(Te[et[0].key]=T[et[0].key]=et[0],Te[et[1].key]=T[et[1].key]=et[1],Te[et[2].key]=T[et[2].key]=et[2],Te[et[3].key]=T[et[3].key]=et[3],delete Re[Be])}for(const Be in Re){const et=this.findLoadedParent(Re[Be],this._source.minzoom);if(et){Te[et.tileID.key]=T[et.tileID.key]=et.tileID;for(const vt in Te)Te[vt].isChildOf(et.tileID)&&delete Te[vt]}}for(const Be in this._tiles)Te[Be]||(this._coveredTiles[Be]=!0)}}for(const j in T)this._tiles[j].clearFadeHold();const B=a.ab(this._tiles,T);for(const j of B){const X=this._tiles[j];X.hasSymbolBuckets&&!X.holdingForFade()?X.setHoldDuration(this.map._fadeDuration):X.hasSymbolBuckets&&!X.symbolFadeFinished()||this._removeTile(j)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(s)}_updateRetainedTiles(s,i){const r={},l={},d=Math.max(i-Ie.maxOverzooming,this._source.minzoom),_=Math.max(i+Ie.maxUnderzooming,this._source.minzoom),w={};for(const T of s){const B=this._addTile(T);r[T.key]=T,B.hasData()||i<this._source.maxzoom&&(w[T.key]=T)}this._retainLoadedChildren(w,i,_,r);for(const T of s){let B=this._tiles[T.key];if(B.hasData())continue;if(i+1>this._source.maxzoom){const X=T.children(this._source.maxzoom)[0],ue=this.getTile(X);if(ue&&ue.hasData()){r[X.key]=X;continue}}else{const X=T.children(this._source.maxzoom);if(r[X[0].key]&&r[X[1].key]&&r[X[2].key]&&r[X[3].key])continue}let j=B.wasRequested();for(let X=T.overscaledZ-1;X>=d;--X){const ue=T.scaledTo(X);if(l[ue.key])break;if(l[ue.key]=!0,B=this.getTile(ue),!B&&j&&(B=this._addTile(ue)),B){const Se=B.hasData();if((j||Se)&&(r[ue.key]=ue),j=B.wasRequested(),Se)break}}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const i=[];let r,l=this._tiles[s].tileID;for(;l.overscaledZ>0;){if(l.key in this._loadedParentTiles){r=this._loadedParentTiles[l.key];break}i.push(l.key);const d=l.scaledTo(l.overscaledZ-1);if(r=this._getLoadedTile(d),r)break;l=d}for(const d of i)this._loadedParentTiles[d]=r}}_addTile(s){let i=this._tiles[s.key];if(i)return i;i=this._cache.getAndRemove(s),i&&(this._setTileReloadTimer(s.key,i),i.tileID=s,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,i)));const r=i;return i||(i=new te(s,this._source.tileSize*s.overscaleFactor()),this._loadTile(i,s.key,i.state)),i.uses++,this._tiles[s.key]=i,r||this._source.fire(new a.k("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i}_setTileReloadTimer(s,i){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const r=i.getExpiryTimeout();r&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},r))}_removeTile(s){const i=this._tiles[s];i&&(i.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(s);this._cache.reset()}tilesIn(s,i,r){const l=[],d=this.transform;if(!d)return l;const _=r?d.getCameraQueryGeometry(s):s,w=s.map(Te=>d.pointCoordinate(Te,this.terrain)),T=_.map(Te=>d.pointCoordinate(Te,this.terrain)),B=this.getIds();let j=1/0,X=1/0,ue=-1/0,Se=-1/0;for(const Te of T)j=Math.min(j,Te.x),X=Math.min(X,Te.y),ue=Math.max(ue,Te.x),Se=Math.max(Se,Te.y);for(let Te=0;Te<B.length;Te++){const Re=this._tiles[B[Te]];if(Re.holdingForFade())continue;const Be=Re.tileID,et=Math.pow(2,d.zoom-Re.tileID.overscaledZ),vt=i*Re.queryPadding*a.W/Re.tileSize/et,ot=[Be.getTilePoint(new a.Y(j,X)),Be.getTilePoint(new a.Y(ue,Se))];if(ot[0].x-vt<a.W&&ot[0].y-vt<a.W&&ot[1].x+vt>=0&&ot[1].y+vt>=0){const ht=w.map(wt=>Be.getTilePoint(wt)),Et=T.map(wt=>Be.getTilePoint(wt));l.push({tile:Re,tileID:Be,queryGeometry:ht,cameraQueryGeometry:Et,scale:et})}}return l}getVisibleCoordinates(s){const i=this.getRenderableIds(s).map(r=>this._tiles[r].tileID);for(const r of i)r.posMatrix=this.transform.calculatePosMatrix(r.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(ze(this._source.type)){const s=ae.now();for(const i in this._tiles)if(this._tiles[i].fadeEndTime>=s)return!0}return!1}setFeatureState(s,i,r){this._state.updateState(s=s||"_geojsonTileLayer",i,r)}removeFeatureState(s,i,r){this._state.removeFeatureState(s=s||"_geojsonTileLayer",i,r)}getFeatureState(s,i){return this._state.getState(s=s||"_geojsonTileLayer",i)}setDependencies(s,i,r){const l=this._tiles[s];l&&l.setDependencies(i,r)}reloadTilesForDependencies(s,i){for(const r in this._tiles)this._tiles[r].hasDependency(s,i)&&this._reloadTile(r,"reloading");this._cache.filter(r=>!r.hasDependency(s,i))}}function Ee(y,s){const i=Math.abs(2*y.wrap)-+(y.wrap<0),r=Math.abs(2*s.wrap)-+(s.wrap<0);return y.overscaledZ-s.overscaledZ||r-i||s.canonical.y-y.canonical.y||s.canonical.x-y.canonical.x}function ze(y){return y==="raster"||y==="image"||y==="video"}Ie.maxOverzooming=10,Ie.maxUnderzooming=3;class Qe{constructor(s,i){this.reset(s,i)}reset(s,i){this.points=s||[],this._distances=[0];for(let r=1;r<this.points.length;r++)this._distances[r]=this._distances[r-1]+this.points[r].dist(this.points[r-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(i||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=a.ac(s,0,1);let i=1,r=this._distances[i];const l=s*this.paddedLength+this.padding;for(;r<l&&i<this._distances.length;)r=this._distances[++i];const d=i-1,_=this._distances[d],w=r-_,T=w>0?(l-_)/w:0;return this.points[d].mult(1-T).add(this.points[i].mult(T))}}function He(y,s){let i=!0;return y==="always"||y!=="never"&&s!=="never"||(i=!1),i}class Ze{constructor(s,i,r){const l=this.boxCells=[],d=this.circleCells=[];this.xCellCount=Math.ceil(s/r),this.yCellCount=Math.ceil(i/r);for(let _=0;_<this.xCellCount*this.yCellCount;_++)l.push([]),d.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=i,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/i,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,i,r,l,d){this._forEachCell(i,r,l,d,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(d)}insertCircle(s,i,r,l){this._forEachCell(i-l,r-l,i+l,r+l,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(i),this.circles.push(r),this.circles.push(l)}_insertBoxCell(s,i,r,l,d,_){this.boxCells[d].push(_)}_insertCircleCell(s,i,r,l,d,_){this.circleCells[d].push(_)}_query(s,i,r,l,d,_,w){if(r<0||s>this.width||l<0||i>this.height)return[];const T=[];if(s<=0&&i<=0&&this.width<=r&&this.height<=l){if(d)return[{key:null,x1:s,y1:i,x2:r,y2:l}];for(let B=0;B<this.boxKeys.length;B++)T.push({key:this.boxKeys[B],x1:this.bboxes[4*B],y1:this.bboxes[4*B+1],x2:this.bboxes[4*B+2],y2:this.bboxes[4*B+3]});for(let B=0;B<this.circleKeys.length;B++){const j=this.circles[3*B],X=this.circles[3*B+1],ue=this.circles[3*B+2];T.push({key:this.circleKeys[B],x1:j-ue,y1:X-ue,x2:j+ue,y2:X+ue})}}else this._forEachCell(s,i,r,l,this._queryCell,T,{hitTest:d,overlapMode:_,seenUids:{box:{},circle:{}}},w);return T}query(s,i,r,l){return this._query(s,i,r,l,!1,null)}hitTest(s,i,r,l,d,_){return this._query(s,i,r,l,!0,d,_).length>0}hitTestCircle(s,i,r,l,d){const _=s-r,w=s+r,T=i-r,B=i+r;if(w<0||_>this.width||B<0||T>this.height)return!1;const j=[];return this._forEachCell(_,T,w,B,this._queryCellCircle,j,{hitTest:!0,overlapMode:l,circle:{x:s,y:i,radius:r},seenUids:{box:{},circle:{}}},d),j.length>0}_queryCell(s,i,r,l,d,_,w,T){const{seenUids:B,hitTest:j,overlapMode:X}=w,ue=this.boxCells[d];if(ue!==null){const Te=this.bboxes;for(const Re of ue)if(!B.box[Re]){B.box[Re]=!0;const Be=4*Re,et=this.boxKeys[Re];if(s<=Te[Be+2]&&i<=Te[Be+3]&&r>=Te[Be+0]&&l>=Te[Be+1]&&(!T||T(et))&&(!j||!He(X,et.overlapMode))&&(_.push({key:et,x1:Te[Be],y1:Te[Be+1],x2:Te[Be+2],y2:Te[Be+3]}),j))return!0}}const Se=this.circleCells[d];if(Se!==null){const Te=this.circles;for(const Re of Se)if(!B.circle[Re]){B.circle[Re]=!0;const Be=3*Re,et=this.circleKeys[Re];if(this._circleAndRectCollide(Te[Be],Te[Be+1],Te[Be+2],s,i,r,l)&&(!T||T(et))&&(!j||!He(X,et.overlapMode))){const vt=Te[Be],ot=Te[Be+1],ht=Te[Be+2];if(_.push({key:et,x1:vt-ht,y1:ot-ht,x2:vt+ht,y2:ot+ht}),j)return!0}}}return!1}_queryCellCircle(s,i,r,l,d,_,w,T){const{circle:B,seenUids:j,overlapMode:X}=w,ue=this.boxCells[d];if(ue!==null){const Te=this.bboxes;for(const Re of ue)if(!j.box[Re]){j.box[Re]=!0;const Be=4*Re,et=this.boxKeys[Re];if(this._circleAndRectCollide(B.x,B.y,B.radius,Te[Be+0],Te[Be+1],Te[Be+2],Te[Be+3])&&(!T||T(et))&&!He(X,et.overlapMode))return _.push(!0),!0}}const Se=this.circleCells[d];if(Se!==null){const Te=this.circles;for(const Re of Se)if(!j.circle[Re]){j.circle[Re]=!0;const Be=3*Re,et=this.circleKeys[Re];if(this._circlesCollide(Te[Be],Te[Be+1],Te[Be+2],B.x,B.y,B.radius)&&(!T||T(et))&&!He(X,et.overlapMode))return _.push(!0),!0}}}_forEachCell(s,i,r,l,d,_,w,T){const B=this._convertToXCellCoord(s),j=this._convertToYCellCoord(i),X=this._convertToXCellCoord(r),ue=this._convertToYCellCoord(l);for(let Se=B;Se<=X;Se++)for(let Te=j;Te<=ue;Te++)if(d.call(this,s,i,r,l,this.xCellCount*Te+Se,_,w,T))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,i,r,l,d,_){const w=l-s,T=d-i,B=r+_;return B*B>w*w+T*T}_circleAndRectCollide(s,i,r,l,d,_,w){const T=(_-l)/2,B=Math.abs(s-(l+T));if(B>T+r)return!1;const j=(w-d)/2,X=Math.abs(i-(d+j));if(X>j+r)return!1;if(B<=T||X<=j)return!0;const ue=B-T,Se=X-j;return ue*ue+Se*Se<=r*r}}function Ue(y,s,i,r,l){const d=a.F();return s?(a.J(d,d,[1/l,1/l,1]),i||a.ad(d,d,r.angle)):a.K(d,r.labelPlaneMatrix,y),d}function dt(y,s,i,r,l){if(s){const d=a.ae(y);return a.J(d,d,[l,l,1]),i||a.ad(d,d,-r.angle),d}return r.glCoordMatrix}function rt(y,s,i){let r;i?(r=[y.x,y.y,i(y.x,y.y),1],a.af(r,r,s)):(r=[y.x,y.y,0,1],De(r,r,s));const l=r[3];return{point:new a.P(r[0]/l,r[1]/l),signedDistanceFromCamera:l}}function Me(y,s){return .5+y/s*.5}function se(y,s){const i=y[0]/y[3],r=y[1]/y[3];return i>=-s[0]&&i<=s[0]&&r>=-s[1]&&r<=s[1]}function ne(y,s,i,r,l,d,_,w,T,B){const j=r?y.textSizeData:y.iconSizeData,X=a.ag(j,i.transform.zoom),ue=[256/i.width*2+1,256/i.height*2+1],Se=r?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;Se.clear();const Te=y.lineVertexArray,Re=r?y.text.placedSymbolArray:y.icon.placedSymbolArray,Be=i.transform.width/i.transform.height;let et=!1;for(let vt=0;vt<Re.length;vt++){const ot=Re.get(vt);if(ot.hidden||ot.writingMode===a.ah.vertical&&!et){Ke(ot.numGlyphs,Se);continue}let ht;if(et=!1,B?(ht=[ot.anchorX,ot.anchorY,B(ot.anchorX,ot.anchorY),1],a.af(ht,ht,s)):(ht=[ot.anchorX,ot.anchorY,0,1],De(ht,ht,s)),!se(ht,ue)){Ke(ot.numGlyphs,Se);continue}const Et=Me(i.transform.cameraToCenterDistance,ht[3]),wt=a.ai(j,X,ot),si=_?wt/Et:wt*Et,Kt=new a.P(ot.anchorX,ot.anchorY),ii=rt(Kt,l,B).point,ai={projections:{},offsets:{}},Zi=de(ot,si,!1,w,s,l,d,y.glyphOffsetArray,Te,Se,ii,Kt,ai,Be,T,B);et=Zi.useVertical,(Zi.notEnoughRoom||et||Zi.needsFlipping&&de(ot,si,!0,w,s,l,d,y.glyphOffsetArray,Te,Se,ii,Kt,ai,Be,T,B).notEnoughRoom)&&Ke(ot.numGlyphs,Se)}r?y.text.dynamicLayoutVertexBuffer.updateData(Se):y.icon.dynamicLayoutVertexBuffer.updateData(Se)}function $(y,s,i,r,l,d,_,w,T,B,j,X,ue){const Se=w.glyphStartIndex+w.numGlyphs,Te=w.lineStartIndex,Re=w.lineStartIndex+w.lineLength,Be=s.getoffsetX(w.glyphStartIndex),et=s.getoffsetX(Se-1),vt=Ve(y*Be,i,r,l,d,_,w.segment,Te,Re,T,B,j,X,ue);if(!vt)return null;const ot=Ve(y*et,i,r,l,d,_,w.segment,Te,Re,T,B,j,X,ue);return ot?{first:vt,last:ot}:null}function ie(y,s,i,r){return y===a.ah.horizontal&&Math.abs(i.y-s.y)>Math.abs(i.x-s.x)*r?{useVertical:!0}:(y===a.ah.vertical?s.y<i.y:s.x>i.x)?{needsFlipping:!0}:null}function de(y,s,i,r,l,d,_,w,T,B,j,X,ue,Se,Te,Re){const Be=s/24,et=y.lineOffsetX*Be,vt=y.lineOffsetY*Be;let ot;if(y.numGlyphs>1){const ht=y.glyphStartIndex+y.numGlyphs,Et=y.lineStartIndex,wt=y.lineStartIndex+y.lineLength,si=$(Be,w,et,vt,i,j,X,y,T,d,ue,Te,Re);if(!si)return{notEnoughRoom:!0};const Kt=rt(si.first.point,_,Re).point,ii=rt(si.last.point,_,Re).point;if(r&&!i){const ai=ie(y.writingMode,Kt,ii,Se);if(ai)return ai}ot=[si.first];for(let ai=y.glyphStartIndex+1;ai<ht-1;ai++)ot.push(Ve(Be*w.getoffsetX(ai),et,vt,i,j,X,y.segment,Et,wt,T,d,ue,Te,Re));ot.push(si.last)}else{if(r&&!i){const Et=rt(X,l,Re).point,wt=y.lineStartIndex+y.segment+1,si=new a.P(T.getx(wt),T.gety(wt)),Kt=rt(si,l,Re),ii=Kt.signedDistanceFromCamera>0?Kt.point:ye(X,si,Et,1,l,Re),ai=ie(y.writingMode,Et,ii,Se);if(ai)return ai}const ht=Ve(Be*w.getoffsetX(y.glyphStartIndex),et,vt,i,j,X,y.segment,y.lineStartIndex,y.lineStartIndex+y.lineLength,T,d,ue,Te,Re);if(!ht)return{notEnoughRoom:!0};ot=[ht]}for(const ht of ot)a.aj(B,ht.point,ht.angle);return{}}function ye(y,s,i,r,l,d){const _=rt(y.add(y.sub(s)._unit()),l,d).point,w=i.sub(_);return i.add(w._mult(r/w.mag()))}function ge(y,s){const{projectionCache:i,lineVertexArray:r,labelPlaneMatrix:l,tileAnchorPoint:d,distanceFromAnchor:_,getElevation:w,previousVertex:T,direction:B,absOffsetX:j}=s;if(i.projections[y])return i.projections[y];const X=new a.P(r.getx(y),r.gety(y)),ue=rt(X,l,w);if(ue.signedDistanceFromCamera>0)return i.projections[y]=ue.point,ue.point;const Se=y-B;return ye(_===0?d:new a.P(r.getx(Se),r.gety(Se)),X,T,j-_+1,l,w)}function Pe(y,s,i){return y._unit()._perp()._mult(s*i)}function Fe(y,s,i,r,l,d,_,w){const{projectionCache:T,direction:B}=w;if(T.offsets[y])return T.offsets[y];const j=i.add(s);if(y+B<r||y+B>=l)return T.offsets[y]=j,j;const X=ge(y+B,w),ue=Pe(X.sub(i),_,B),Se=i.add(ue),Te=X.add(ue);return T.offsets[y]=a.ak(d,j,Se,Te)||j,T.offsets[y]}function Ve(y,s,i,r,l,d,_,w,T,B,j,X,ue,Se){const Te=r?y-s:y+s;let Re=Te>0?1:-1,Be=0;r&&(Re*=-1,Be=Math.PI),Re<0&&(Be+=Math.PI);let et,vt,ot=Re>0?w+_:w+_+1,ht=l,Et=l,wt=0,si=0;const Kt=Math.abs(Te),ii=[];let ai;for(;wt+si<=Kt;){if(ot+=Re,ot<w||ot>=T)return null;wt+=si,Et=ht,vt=et;const Si={projectionCache:X,lineVertexArray:B,labelPlaneMatrix:j,tileAnchorPoint:d,distanceFromAnchor:wt,getElevation:Se,previousVertex:Et,direction:Re,absOffsetX:Kt};if(ht=ge(ot,Si),i===0)ii.push(Et),ai=ht.sub(Et);else{let Ui;const Gi=ht.sub(Et);Ui=Gi.mag()===0?Pe(ge(ot+Re,Si).sub(ht),i,Re):Pe(Gi,i,Re),vt||(vt=Et.add(Ui)),et=Fe(ot,Ui,ht,w,T,vt,i,Si),ii.push(vt),ai=et.sub(vt)}si=ai.mag()}const Zi=ai._mult((Kt-wt)/si)._add(vt||Et),Qi=Be+Math.atan2(ht.y-Et.y,ht.x-Et.x);return ii.push(Zi),{point:Zi,angle:ue?Qi:0,path:ii}}const Xe=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ke(y,s){for(let i=0;i<y;i++){const r=s.length;s.resize(r+4),s.float32.set(Xe,3*r)}}function De(y,s,i){const r=s[0],l=s[1];return y[0]=i[0]*r+i[4]*l+i[12],y[1]=i[1]*r+i[5]*l+i[13],y[3]=i[3]*r+i[7]*l+i[15],y}const Ge=100;class At{constructor(s,i=new Ze(s.width+200,s.height+200,25),r=new Ze(s.width+200,s.height+200,25)){this.transform=s,this.grid=i,this.ignoredGrid=r,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+Ge,this.screenBottomBoundary=s.height+Ge,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(s,i,r,l,d,_){const w=this.projectAndGetPerspectiveRatio(l,s.anchorPointX,s.anchorPointY,_),T=r*w.perspectiveRatio,B=s.x1*T+w.point.x,j=s.y1*T+w.point.y,X=s.x2*T+w.point.x,ue=s.y2*T+w.point.y;return!this.isInsideGrid(B,j,X,ue)||i!=="always"&&this.grid.hitTest(B,j,X,ue,i,d)||w.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[B,j,X,ue],offscreen:this.isOffscreen(B,j,X,ue)}}placeCollisionCircles(s,i,r,l,d,_,w,T,B,j,X,ue,Se,Te){const Re=[],Be=new a.P(i.anchorX,i.anchorY),et=rt(Be,_,Te),vt=Me(this.transform.cameraToCenterDistance,et.signedDistanceFromCamera),ot=(j?d/vt:d*vt)/a.ao,ht=rt(Be,w,Te).point,Et=$(ot,l,i.lineOffsetX*ot,i.lineOffsetY*ot,!1,ht,Be,i,r,w,{projections:{},offsets:{}},!1,Te);let wt=!1,si=!1,Kt=!0;if(Et){const ii=.5*ue*vt+Se,ai=new a.P(-100,-100),Zi=new a.P(this.screenRightBoundary,this.screenBottomBoundary),Qi=new Qe,Si=Et.first,Ui=Et.last;let Gi=[];for(let en=Si.path.length-1;en>=1;en--)Gi.push(Si.path[en]);for(let en=1;en<Ui.path.length;en++)Gi.push(Ui.path[en]);const un=2.5*ii;if(T){const en=Gi.map(kn=>rt(kn,T,Te));Gi=en.some(kn=>kn.signedDistanceFromCamera<=0)?[]:en.map(kn=>kn.point)}let Bn=[];if(Gi.length>0){const en=Gi[0].clone(),kn=Gi[0].clone();for(let vr=1;vr<Gi.length;vr++)en.x=Math.min(en.x,Gi[vr].x),en.y=Math.min(en.y,Gi[vr].y),kn.x=Math.max(kn.x,Gi[vr].x),kn.y=Math.max(kn.y,Gi[vr].y);Bn=en.x>=ai.x&&kn.x<=Zi.x&&en.y>=ai.y&&kn.y<=Zi.y?[Gi]:kn.x<ai.x||en.x>Zi.x||kn.y<ai.y||en.y>Zi.y?[]:a.al([Gi],ai.x,ai.y,Zi.x,Zi.y)}for(const en of Bn){Qi.reset(en,.25*ii);let kn=0;kn=Qi.length<=.5*ii?1:Math.ceil(Qi.paddedLength/un)+1;for(let vr=0;vr<kn;vr++){const er=vr/Math.max(kn-1,1),Ca=Qi.lerp(er),fa=Ca.x+Ge,zs=Ca.y+Ge;Re.push(fa,zs,ii,0);const oo=fa-ii,lo=zs-ii,qr=fa+ii,ya=zs+ii;if(Kt=Kt&&this.isOffscreen(oo,lo,qr,ya),si=si||this.isInsideGrid(oo,lo,qr,ya),s!=="always"&&this.grid.hitTestCircle(fa,zs,ii,s,X)&&(wt=!0,!B))return{circles:[],offscreen:!1,collisionDetected:wt}}}}return{circles:!B&&wt||!si||vt<this.perspectiveRatioCutoff?[]:Re,offscreen:Kt,collisionDetected:wt}}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const i=[];let r=1/0,l=1/0,d=-1/0,_=-1/0;for(const j of s){const X=new a.P(j.x+Ge,j.y+Ge);r=Math.min(r,X.x),l=Math.min(l,X.y),d=Math.max(d,X.x),_=Math.max(_,X.y),i.push(X)}const w=this.grid.query(r,l,d,_).concat(this.ignoredGrid.query(r,l,d,_)),T={},B={};for(const j of w){const X=j.key;if(T[X.bucketInstanceId]===void 0&&(T[X.bucketInstanceId]={}),T[X.bucketInstanceId][X.featureIndex])continue;const ue=[new a.P(j.x1,j.y1),new a.P(j.x2,j.y1),new a.P(j.x2,j.y2),new a.P(j.x1,j.y2)];a.am(i,ue)&&(T[X.bucketInstanceId][X.featureIndex]=!0,B[X.bucketInstanceId]===void 0&&(B[X.bucketInstanceId]=[]),B[X.bucketInstanceId].push(X.featureIndex))}return B}insertCollisionBox(s,i,r,l,d,_){(r?this.ignoredGrid:this.grid).insert({bucketInstanceId:l,featureIndex:d,collisionGroupID:_,overlapMode:i},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,i,r,l,d,_){const w=r?this.ignoredGrid:this.grid,T={bucketInstanceId:l,featureIndex:d,collisionGroupID:_,overlapMode:i};for(let B=0;B<s.length;B+=4)w.insertCircle(T,s[B],s[B+1],s[B+2])}projectAndGetPerspectiveRatio(s,i,r,l){let d;return l?(d=[i,r,l(i,r),1],a.af(d,d,s)):(d=[i,r,0,1],De(d,d,s)),{point:new a.P((d[0]/d[3]+1)/2*this.transform.width+Ge,(-d[1]/d[3]+1)/2*this.transform.height+Ge),perspectiveRatio:.5+this.transform.cameraToCenterDistance/d[3]*.5}}isOffscreen(s,i,r,l){return r<Ge||s>=this.screenRightBoundary||l<Ge||i>this.screenBottomBoundary}isInsideGrid(s,i,r,l){return r>=0&&s<this.gridRightBoundary&&l>=0&&i<this.gridBottomBoundary}getViewportMatrix(){const s=a.an([]);return a.H(s,s,[-100,-100,0]),s}}function kt(y,s,i){return s*(a.W/(y.tileSize*Math.pow(2,i-y.tileID.overscaledZ)))}class o{constructor(s,i,r,l){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?i:-i))):l&&r?1:0,this.placed=r}isHidden(){return this.opacity===0&&!this.placed}}class ke{constructor(s,i,r,l,d){this.text=new o(s?s.text:null,i,r,d),this.icon=new o(s?s.icon:null,i,l,d)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class oi{constructor(s,i,r){this.text=s,this.icon=i,this.skipFade=r}}class fi{constructor(){this.invProjMatrix=a.F(),this.viewportMatrix=a.F(),this.circles=[]}}class Ai{constructor(s,i,r,l,d){this.bucketInstanceId=s,this.featureIndex=i,this.sourceLayerIndex=r,this.bucketIndex=l,this.tileID=d}}class ti{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const i=++this.maxGroupID;this.collisionGroups[s]={ID:i,predicate:r=>r.collisionGroupID===i}}return this.collisionGroups[s]}}function li(y,s,i,r,l){const{horizontalAlign:d,verticalAlign:_}=a.at(y);return new a.P(-(d-.5)*s+r[0]*l,-(_-.5)*i+r[1]*l)}function Bi(y,s,i,r,l,d){const{x1:_,x2:w,y1:T,y2:B,anchorPointX:j,anchorPointY:X}=y,ue=new a.P(s,i);return r&&ue._rotate(l?d:-d),{x1:_+ue.x,y1:T+ue.y,x2:w+ue.x,y2:B+ue.y,anchorPointX:j,anchorPointY:X}}class vi{constructor(s,i,r,l,d){this.transform=s.clone(),this.terrain=i,this.collisionIndex=new At(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new ti(l),this.collisionCircleArrays={},this.prevPlacement=d,d&&(d.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,i,r,l){const d=r.getBucket(i),_=r.latestFeatureIndex;if(!d||!_||i.id!==d.layerIds[0])return;const w=r.collisionBoxArray,T=d.layers[0].layout,B=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),j=r.tileSize/a.W,X=this.transform.calculatePosMatrix(r.tileID.toUnwrapped()),ue=T.get("text-pitch-alignment")==="map",Se=T.get("text-rotation-alignment")==="map",Te=kt(r,1,this.transform.zoom),Re=Ue(X,ue,Se,this.transform,Te);let Be=null;if(ue){const vt=dt(X,ue,Se,this.transform,Te);Be=a.K([],this.transform.labelPlaneMatrix,vt)}this.retainedQueryData[d.bucketInstanceId]=new Ai(d.bucketInstanceId,_,d.sourceLayerIndex,d.index,r.tileID);const et={bucket:d,layout:T,posMatrix:X,textLabelPlaneMatrix:Re,labelToScreenMatrix:Be,scale:B,textPixelRatio:j,holdingForFade:r.holdingForFade(),collisionBoxArray:w,partiallyEvaluatedTextSize:a.ag(d.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(d.sourceID)};if(l)for(const vt of d.sortKeyRanges){const{sortKey:ot,symbolInstanceStart:ht,symbolInstanceEnd:Et}=vt;s.push({sortKey:ot,symbolInstanceStart:ht,symbolInstanceEnd:Et,parameters:et})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:d.symbolInstances.length,parameters:et})}attemptAnchorPlacement(s,i,r,l,d,_,w,T,B,j,X,ue,Se,Te,Re,Be){const et=a.ap[s.textAnchor],vt=[s.textOffset0,s.textOffset1],ot=li(et,r,l,vt,d),ht=this.collisionIndex.placeCollisionBox(Bi(i,ot.x,ot.y,_,w,this.transform.angle),X,T,B,j.predicate,Be);if((!Re||this.collisionIndex.placeCollisionBox(Bi(Re,ot.x,ot.y,_,w,this.transform.angle),X,T,B,j.predicate,Be).box.length!==0)&&ht.box.length>0){let Et;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ue.crossTileID]&&this.prevPlacement.placements[ue.crossTileID]&&this.prevPlacement.placements[ue.crossTileID].text&&(Et=this.prevPlacement.variableOffsets[ue.crossTileID].anchor),ue.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ue.crossTileID]={textOffset:vt,width:r,height:l,anchor:et,textBoxScale:d,prevAnchor:Et},this.markUsedJustification(Se,et,ue,Te),Se.allowVerticalPlacement&&(this.markUsedOrientation(Se,Te,ue),this.placedOrientations[ue.crossTileID]=Te),{shift:ot,placedGlyphBoxes:ht}}}placeLayerBucketPart(s,i,r){const{bucket:l,layout:d,posMatrix:_,textLabelPlaneMatrix:w,labelToScreenMatrix:T,textPixelRatio:B,holdingForFade:j,collisionBoxArray:X,partiallyEvaluatedTextSize:ue,collisionGroup:Se}=s.parameters,Te=d.get("text-optional"),Re=d.get("icon-optional"),Be=a.aq(d,"text-overlap","text-allow-overlap"),et=Be==="always",vt=a.aq(d,"icon-overlap","icon-allow-overlap"),ot=vt==="always",ht=d.get("text-rotation-alignment")==="map",Et=d.get("text-pitch-alignment")==="map",wt=d.get("icon-text-fit")!=="none",si=d.get("symbol-z-order")==="viewport-y",Kt=et&&(ot||!l.hasIconData()||Re),ii=ot&&(et||!l.hasTextData()||Te);!l.collisionArrays&&X&&l.deserializeCollisionBoxes(X);const ai=this.retainedQueryData[l.bucketInstanceId].tileID,Zi=this.terrain?(Si,Ui)=>this.terrain.getElevation(ai,Si,Ui):null,Qi=(Si,Ui)=>{var Gi,un;if(i[Si.crossTileID])return;if(j)return void(this.placements[Si.crossTileID]=new oi(!1,!1,!1));let Bn=!1,en=!1,kn=!0,vr=null,er={box:null,offscreen:null},Ca={box:null,offscreen:null},fa=null,zs=null,oo=null,lo=0,qr=0,ya=0;Ui.textFeatureIndex?lo=Ui.textFeatureIndex:Si.useRuntimeCollisionCircles&&(lo=Si.featureIndex),Ui.verticalTextFeatureIndex&&(qr=Ui.verticalTextFeatureIndex);const xo=Ui.textBox;if(xo){const rs=Ws=>{let Bo=a.ah.horizontal;if(l.allowVerticalPlacement&&!Ws&&this.prevPlacement){const Uo=this.prevPlacement.placedOrientations[Si.crossTileID];Uo&&(this.placedOrientations[Si.crossTileID]=Uo,Bo=Uo,this.markUsedOrientation(l,Bo,Si))}return Bo},ss=(Ws,Bo)=>{if(l.allowVerticalPlacement&&Si.numVerticalGlyphVertices>0&&Ui.verticalTextBox){for(const Uo of l.writingModes)if(Uo===a.ah.vertical?(er=Bo(),Ca=er):er=Ws(),er&&er.box&&er.box.length)break}else er=Ws()},Rr=Si.textAnchorOffsetStartIndex,Ss=Si.textAnchorOffsetEndIndex;if(Ss===Rr){const Ws=(Bo,Uo)=>{const Go=this.collisionIndex.placeCollisionBox(Bo,Be,B,_,Se.predicate,Zi);return Go&&Go.box&&Go.box.length&&(this.markUsedOrientation(l,Uo,Si),this.placedOrientations[Si.crossTileID]=Uo),Go};ss(()=>Ws(xo,a.ah.horizontal),()=>{const Bo=Ui.verticalTextBox;return l.allowVerticalPlacement&&Si.numVerticalGlyphVertices>0&&Bo?Ws(Bo,a.ah.vertical):{box:null,offscreen:null}}),rs(er&&er.box&&er.box.length)}else{let Ws=a.ap[(un=(Gi=this.prevPlacement)===null||Gi===void 0?void 0:Gi.variableOffsets[Si.crossTileID])===null||un===void 0?void 0:un.anchor];const Bo=(Go,Ec,$s)=>{const Yl=Go.x2-Go.x1,hu=Go.y2-Go.y1,il=Si.textBoxScale,vl=wt&&vt==="never"?Ec:null;let Pl={box:[],offscreen:!1},Au=Be==="never"?1:2,af="never";Ws&&Au++;for(let Vh=0;Vh<Au;Vh++){for(let La=Rr;La<Ss;La++){const pA=l.textAnchorOffsets.get(La);if(Ws&&pA.textAnchor!==Ws)continue;const yh=this.attemptAnchorPlacement(pA,Go,Yl,hu,il,ht,Et,B,_,Se,af,Si,l,$s,vl,Zi);if(yh&&(Pl=yh.placedGlyphBoxes,Pl&&Pl.box&&Pl.box.length))return Bn=!0,vr=yh.shift,Pl}Ws?Ws=null:af=Be}return Pl};ss(()=>Bo(xo,Ui.iconBox,a.ah.horizontal),()=>{const Go=Ui.verticalTextBox;return l.allowVerticalPlacement&&!(er&&er.box&&er.box.length)&&Si.numVerticalGlyphVertices>0&&Go?Bo(Go,Ui.verticalIconBox,a.ah.vertical):{box:null,offscreen:null}}),er&&(Bn=er.box,kn=er.offscreen);const Uo=rs(er&&er.box);if(!Bn&&this.prevPlacement){const Go=this.prevPlacement.variableOffsets[Si.crossTileID];Go&&(this.variableOffsets[Si.crossTileID]=Go,this.markUsedJustification(l,Go.anchor,Si,Uo))}}}if(fa=er,Bn=fa&&fa.box&&fa.box.length>0,kn=fa&&fa.offscreen,Si.useRuntimeCollisionCircles){const rs=l.text.placedSymbolArray.get(Si.centerJustifiedTextSymbolIndex),ss=a.ai(l.textSizeData,ue,rs),Rr=d.get("text-padding");zs=this.collisionIndex.placeCollisionCircles(Be,rs,l.lineVertexArray,l.glyphOffsetArray,ss,_,w,T,r,Et,Se.predicate,Si.collisionCircleDiameter,Rr,Zi),zs.circles.length&&zs.collisionDetected&&!r&&a.w("Collisions detected, but collision boxes are not shown"),Bn=et||zs.circles.length>0&&!zs.collisionDetected,kn=kn&&zs.offscreen}if(Ui.iconFeatureIndex&&(ya=Ui.iconFeatureIndex),Ui.iconBox){const rs=ss=>{const Rr=wt&&vr?Bi(ss,vr.x,vr.y,ht,Et,this.transform.angle):ss;return this.collisionIndex.placeCollisionBox(Rr,vt,B,_,Se.predicate,Zi)};Ca&&Ca.box&&Ca.box.length&&Ui.verticalIconBox?(oo=rs(Ui.verticalIconBox),en=oo.box.length>0):(oo=rs(Ui.iconBox),en=oo.box.length>0),kn=kn&&oo.offscreen}const bo=Te||Si.numHorizontalGlyphVertices===0&&Si.numVerticalGlyphVertices===0,Qs=Re||Si.numIconVertices===0;if(bo||Qs?Qs?bo||(en=en&&Bn):Bn=en&&Bn:en=Bn=en&&Bn,Bn&&fa&&fa.box&&this.collisionIndex.insertCollisionBox(fa.box,Be,d.get("text-ignore-placement"),l.bucketInstanceId,Ca&&Ca.box&&qr?qr:lo,Se.ID),en&&oo&&this.collisionIndex.insertCollisionBox(oo.box,vt,d.get("icon-ignore-placement"),l.bucketInstanceId,ya,Se.ID),zs&&(Bn&&this.collisionIndex.insertCollisionCircles(zs.circles,Be,d.get("text-ignore-placement"),l.bucketInstanceId,lo,Se.ID),r)){const rs=l.bucketInstanceId;let ss=this.collisionCircleArrays[rs];ss===void 0&&(ss=this.collisionCircleArrays[rs]=new fi);for(let Rr=0;Rr<zs.circles.length;Rr+=4)ss.circles.push(zs.circles[Rr+0]),ss.circles.push(zs.circles[Rr+1]),ss.circles.push(zs.circles[Rr+2]),ss.circles.push(zs.collisionDetected?1:0)}if(Si.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(l.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Si.crossTileID]=new oi(Bn||Kt,en||ii,kn||l.justReloaded),i[Si.crossTileID]=!0};if(si){if(s.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Si=l.getSortedSymbolIndexes(this.transform.angle);for(let Ui=Si.length-1;Ui>=0;--Ui){const Gi=Si[Ui];Qi(l.symbolInstances.get(Gi),l.collisionArrays[Gi])}}else for(let Si=s.symbolInstanceStart;Si<s.symbolInstanceEnd;Si++)Qi(l.symbolInstances.get(Si),l.collisionArrays[Si]);if(r&&l.bucketInstanceId in this.collisionCircleArrays){const Si=this.collisionCircleArrays[l.bucketInstanceId];a.ar(Si.invProjMatrix,_),Si.viewportMatrix=this.collisionIndex.getViewportMatrix()}l.justReloaded=!1}markUsedJustification(s,i,r,l){let d;d=l===a.ah.vertical?r.verticalPlacedTextSymbolIndex:{left:r.leftJustifiedTextSymbolIndex,center:r.centerJustifiedTextSymbolIndex,right:r.rightJustifiedTextSymbolIndex}[a.as(i)];const _=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex,r.verticalPlacedTextSymbolIndex];for(const w of _)w>=0&&(s.text.placedSymbolArray.get(w).crossTileID=d>=0&&w!==d?0:r.crossTileID)}markUsedOrientation(s,i,r){const l=i===a.ah.horizontal||i===a.ah.horizontalOnly?i:0,d=i===a.ah.vertical?i:0,_=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex];for(const w of _)s.text.placedSymbolArray.get(w).placedOrientation=l;r.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation=d)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const i=this.prevPlacement;let r=!1;this.prevZoomAdjustment=i?i.zoomAdjustment(this.transform.zoom):0;const l=i?i.symbolFadeChange(s):1,d=i?i.opacities:{},_=i?i.variableOffsets:{},w=i?i.placedOrientations:{};for(const T in this.placements){const B=this.placements[T],j=d[T];j?(this.opacities[T]=new ke(j,l,B.text,B.icon),r=r||B.text!==j.text.placed||B.icon!==j.icon.placed):(this.opacities[T]=new ke(null,l,B.text,B.icon,B.skipFade),r=r||B.text||B.icon)}for(const T in d){const B=d[T];if(!this.opacities[T]){const j=new ke(B,l,!1,!1);j.isHidden()||(this.opacities[T]=j,r=r||B.text.placed||B.icon.placed)}}for(const T in _)this.variableOffsets[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.variableOffsets[T]=_[T]);for(const T in w)this.placedOrientations[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.placedOrientations[T]=w[T]);if(i&&i.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");r?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=i?i.lastPlacementChangeTime:s)}updateLayerOpacities(s,i){const r={};for(const l of i){const d=l.getBucket(s);d&&l.latestFeatureIndex&&s.id===d.layerIds[0]&&this.updateBucketOpacities(d,r,l.collisionBoxArray)}}updateBucketOpacities(s,i,r){s.hasTextData()&&(s.text.opacityVertexArray.clear(),s.text.hasVisibleVertices=!1),s.hasIconData()&&(s.icon.opacityVertexArray.clear(),s.icon.hasVisibleVertices=!1),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const l=s.layers[0],d=l.layout,_=new ke(null,0,!1,!1,!0),w=d.get("text-allow-overlap"),T=d.get("icon-allow-overlap"),B=l._unevaluatedLayout.hasValue("text-variable-anchor")||l._unevaluatedLayout.hasValue("text-variable-anchor-offset"),j=d.get("text-rotation-alignment")==="map",X=d.get("text-pitch-alignment")==="map",ue=d.get("icon-text-fit")!=="none",Se=new ke(null,0,w&&(T||!s.hasIconData()||d.get("icon-optional")),T&&(w||!s.hasTextData()||d.get("text-optional")),!0);!s.collisionArrays&&r&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(r);const Te=(Re,Be,et)=>{for(let vt=0;vt<Be/4;vt++)Re.opacityVertexArray.emplaceBack(et);Re.hasVisibleVertices=Re.hasVisibleVertices||et!==Vn};for(let Re=0;Re<s.symbolInstances.length;Re++){const Be=s.symbolInstances.get(Re),{numHorizontalGlyphVertices:et,numVerticalGlyphVertices:vt,crossTileID:ot}=Be;let ht=this.opacities[ot];i[ot]?ht=_:ht||(ht=Se,this.opacities[ot]=ht),i[ot]=!0;const Et=Be.numIconVertices>0,wt=this.placedOrientations[Be.crossTileID],si=wt===a.ah.vertical,Kt=wt===a.ah.horizontal||wt===a.ah.horizontalOnly;if(et>0||vt>0){const ii=ur(ht.text);Te(s.text,et,si?Vn:ii),Te(s.text,vt,Kt?Vn:ii);const ai=ht.text.isHidden();[Be.rightJustifiedTextSymbolIndex,Be.centerJustifiedTextSymbolIndex,Be.leftJustifiedTextSymbolIndex].forEach(Si=>{Si>=0&&(s.text.placedSymbolArray.get(Si).hidden=ai||si?1:0)}),Be.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(Be.verticalPlacedTextSymbolIndex).hidden=ai||Kt?1:0);const Zi=this.variableOffsets[Be.crossTileID];Zi&&this.markUsedJustification(s,Zi.anchor,Be,wt);const Qi=this.placedOrientations[Be.crossTileID];Qi&&(this.markUsedJustification(s,"left",Be,Qi),this.markUsedOrientation(s,Qi,Be))}if(Et){const ii=ur(ht.icon),ai=!(ue&&Be.verticalPlacedIconSymbolIndex&&si);Be.placedIconSymbolIndex>=0&&(Te(s.icon,Be.numIconVertices,ai?ii:Vn),s.icon.placedSymbolArray.get(Be.placedIconSymbolIndex).hidden=ht.icon.isHidden()),Be.verticalPlacedIconSymbolIndex>=0&&(Te(s.icon,Be.numVerticalIconVertices,ai?Vn:ii),s.icon.placedSymbolArray.get(Be.verticalPlacedIconSymbolIndex).hidden=ht.icon.isHidden())}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const ii=s.collisionArrays[Re];if(ii){let ai=new a.P(0,0);if(ii.textBox||ii.verticalTextBox){let Qi=!0;if(B){const Si=this.variableOffsets[ot];Si?(ai=li(Si.anchor,Si.width,Si.height,Si.textOffset,Si.textBoxScale),j&&ai._rotate(X?this.transform.angle:-this.transform.angle)):Qi=!1}ii.textBox&&bi(s.textCollisionBox.collisionVertexArray,ht.text.placed,!Qi||si,ai.x,ai.y),ii.verticalTextBox&&bi(s.textCollisionBox.collisionVertexArray,ht.text.placed,!Qi||Kt,ai.x,ai.y)}const Zi=!!(!Kt&&ii.verticalIconBox);ii.iconBox&&bi(s.iconCollisionBox.collisionVertexArray,ht.icon.placed,Zi,ue?ai.x:0,ue?ai.y:0),ii.verticalIconBox&&bi(s.iconCollisionBox.collisionVertexArray,ht.icon.placed,!Zi,ue?ai.x:0,ue?ai.y:0)}}}if(s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.text.opacityVertexArray.length!==s.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${s.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${s.text.layoutVertexArray.length}) / 4`);if(s.icon.opacityVertexArray.length!==s.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${s.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${s.icon.layoutVertexArray.length}) / 4`);if(s.bucketInstanceId in this.collisionCircleArrays){const Re=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=Re.invProjMatrix,s.placementViewportMatrix=Re.viewportMatrix,s.collisionCircleArray=Re.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,i){const r=this.zoomAtLastRecencyCheck===i?1-this.zoomAdjustment(i):1;return this.zoomAtLastRecencyCheck=i,this.commitTime+this.fadeDuration*r>s}setStale(){this.stale=!0}}function bi(y,s,i,r,l){y.emplaceBack(s?1:0,i?1:0,r||0,l||0),y.emplaceBack(s?1:0,i?1:0,r||0,l||0),y.emplaceBack(s?1:0,i?1:0,r||0,l||0),y.emplaceBack(s?1:0,i?1:0,r||0,l||0)}const Jt=Math.pow(2,25),wn=Math.pow(2,24),ar=Math.pow(2,17),mn=Math.pow(2,16),Hn=Math.pow(2,9),jr=Math.pow(2,8),ji=Math.pow(2,1);function ur(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const s=y.placed?1:0,i=Math.floor(127*y.opacity);return i*Jt+s*wn+i*ar+s*mn+i*Hn+s*jr+i*ji+s}const Vn=0;class Wt{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&!s.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(s,i,r,l,d){const _=this._bucketParts;for(;this._currentTileIndex<s.length;)if(i.getBucketParts(_,l,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,d())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,_.sort((w,T)=>w.sortKey-T.sortKey));this._currentPartIndex<_.length;)if(i.placeLayerBucketPart(_[this._currentPartIndex],this._seenCrossTileIDs,r),this._currentPartIndex++,d())return!0;return!1}}class Yi{constructor(s,i,r,l,d,_,w,T){this.placement=new vi(s,i,_,w,T),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=l,this._showCollisionBoxes=d,this._done=!1}isDone(){return this._done}continuePlacement(s,i,r){const l=ae.now(),d=()=>!this._forceFullPlacement&&ae.now()-l>2;for(;this._currentPlacementIndex>=0;){const _=i[s[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if(_.type==="symbol"&&(!_.minzoom||_.minzoom<=w)&&(!_.maxzoom||_.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new Wt(_)),this._inProgressLayer.continuePlacement(r[_.source],this.placement,this._showCollisionBoxes,_,d))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const Ut=512/a.W/2;class Tn{constructor(s,i,r){this.tileID=s,this.bucketInstanceId=r,this._symbolsByKey={};const l=new Map;for(let d=0;d<i.length;d++){const _=i.get(d),w=_.key,T=l.get(w);T?T.push(_):l.set(w,[_])}for(const[d,_]of l){const w={positions:_.map(T=>({x:Math.floor(T.anchorX*Ut),y:Math.floor(T.anchorY*Ut)})),crossTileIDs:_.map(T=>T.crossTileID)};if(w.positions.length>128){const T=new a.au(w.positions.length,16,Uint16Array);for(const{x:B,y:j}of w.positions)T.add(B,j);T.finish(),delete w.positions,w.index=T}this._symbolsByKey[d]=w}}getScaledCoordinates(s,i){const{x:r,y:l,z:d}=this.tileID.canonical,{x:_,y:w,z:T}=i.canonical,B=Ut/Math.pow(2,T-d),j=(w*a.W+s.anchorY)*B,X=l*a.W*Ut;return{x:Math.floor((_*a.W+s.anchorX)*B-r*a.W*Ut),y:Math.floor(j-X)}}findMatches(s,i,r){const l=this.tileID.canonical.z<i.canonical.z?1:Math.pow(2,this.tileID.canonical.z-i.canonical.z);for(let d=0;d<s.length;d++){const _=s.get(d);if(_.crossTileID)continue;const w=this._symbolsByKey[_.key];if(!w)continue;const T=this.getScaledCoordinates(_,i);if(w.index){const B=w.index.range(T.x-l,T.y-l,T.x+l,T.y+l).sort();for(const j of B){const X=w.crossTileIDs[j];if(!r[X]){r[X]=!0,_.crossTileID=X;break}}}else if(w.positions)for(let B=0;B<w.positions.length;B++){const j=w.positions[B],X=w.crossTileIDs[B];if(Math.abs(j.x-T.x)<=l&&Math.abs(j.y-T.y)<=l&&!r[X]){r[X]=!0,_.crossTileID=X;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:s})=>s)}}class cr{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Vs{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const i=Math.round((s-this.lng)/360);if(i!==0)for(const r in this.indexes){const l=this.indexes[r],d={};for(const _ in l){const w=l[_];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+i),d[w.tileID.key]=w}this.indexes[r]=d}this.lng=s}addBucket(s,i,r){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===i.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let d=0;d<i.symbolInstances.length;d++)i.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});const l=this.usedCrossTileIDs[s.overscaledZ];for(const d in this.indexes){const _=this.indexes[d];if(Number(d)>s.overscaledZ)for(const w in _){const T=_[w];T.tileID.isChildOf(s)&&T.findMatches(i.symbolInstances,s,l)}else{const w=_[s.scaledTo(Number(d)).key];w&&w.findMatches(i.symbolInstances,s,l)}}for(let d=0;d<i.symbolInstances.length;d++){const _=i.symbolInstances.get(d);_.crossTileID||(_.crossTileID=r.generate(),l[_.crossTileID]=!0)}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new Tn(s,i.symbolInstances,i.bucketInstanceId),!0}removeBucketCrossTileIDs(s,i){for(const r of i.getCrossTileIDsLists())for(const l of r)delete this.usedCrossTileIDs[s][l]}removeStaleBuckets(s){let i=!1;for(const r in this.indexes){const l=this.indexes[r];for(const d in l)s[l[d].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,l[d]),delete l[d],i=!0)}return i}}class Ur{constructor(){this.layerIndexes={},this.crossTileIDs=new cr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,i,r){let l=this.layerIndexes[s.id];l===void 0&&(l=this.layerIndexes[s.id]=new Vs);let d=!1;const _={};l.handleWrapJump(r);for(const w of i){const T=w.getBucket(s);T&&s.id===T.layerIds[0]&&(T.bucketInstanceId||(T.bucketInstanceId=++this.maxBucketInstanceId),l.addBucket(w.tileID,T,this.crossTileIDs)&&(d=!0),_[T.bucketInstanceId]=!0)}return l.removeStaleBuckets(_)&&(d=!0),d}pruneUnusedLayers(s){const i={};s.forEach(r=>{i[r]=!0});for(const r in this.layerIndexes)i[r]||delete this.layerIndexes[r]}}const Vt=(y,s)=>a.t(y,s&&s.filter(i=>i.identifier!=="source.canvas")),hr=a.av();class Dt extends a.E{constructor(s,i={}){super(),this._rtlTextPluginStateChange=()=>{for(const r in this.sourceCaches){const l=this.sourceCaches[r].getSource().type;l!=="vector"&&l!=="geojson"||this.sourceCaches[r].reload()}},this.map=s,this.dispatcher=new Ei(vn(),s._getMapId()),this.dispatcher.registerMessageHandler("getGlyphs",(r,l)=>this.getGlyphs(r,l)),this.dispatcher.registerMessageHandler("getImages",(r,l)=>this.getImages(r,l)),this.imageManager=new $e,this.imageManager.setEventedParent(this),this.glyphManager=new Bt(s._requestManager,i.localIdeographFontFamily),this.lineAtlas=new Ci(256,512),this.crossTileSymbolIndex=new Ur,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.aw,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.ax()),Y().on("pluginStateChange",this._rtlTextPluginStateChange),this.on("data",r=>{if(r.dataType!=="source"||r.sourceDataType!=="metadata")return;const l=this.sourceCaches[r.sourceId];if(!l)return;const d=l.getSource();if(d&&d.vectorLayerIds)for(const _ in this._layers){const w=this._layers[_];w.source===d.id&&this._validateLayer(w)}})}loadURL(s,i={},r){this.fire(new a.k("dataloading",{dataType:"style"})),i.validate=typeof i.validate!="boolean"||i.validate;const l=this.map._requestManager.transformRequest(s,zt.Style);this._loadStyleRequest=new AbortController,a.h(l,this._loadStyleRequest).then(d=>{this._loadStyleRequest=null,this._load(d.data,i,r)}).catch(d=>{this._loadStyleRequest=null,d&&this.fire(new a.j(d))})}loadJSON(s,i={},r){this.fire(new a.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,ae.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,i.validate=i.validate!==!1,this._load(s,i,r)}).catch(()=>{})}loadEmpty(){this.fire(new a.k("dataloading",{dataType:"style"})),this._load(hr,{validate:!1})}_load(s,i,r){var l;const d=i.transformStyle?i.transformStyle(r,s):s;if(!i.validate||!Vt(this,a.x(d))){this._loaded=!0,this.stylesheet=d;for(const _ in d.sources)this.addSource(_,d.sources[_],{validate:!1});d.sprite?this._loadSprite(d.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(d.glyphs),this._createLayers(),this.light=new Ii(this.stylesheet.light),this.map.setTerrain((l=this.stylesheet.terrain)!==null&&l!==void 0?l:null),this.fire(new a.k("data",{dataType:"style"})),this.fire(new a.k("style.load"))}}_createLayers(){const s=a.ay(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",s),this._order=s.map(i=>i.id),this._layers={},this._serializedLayers=null;for(const i of s){const r=a.az(i);r.setEventedParent(this,{layer:{id:i.id}}),this._layers[i.id]=r}}_loadSprite(s,i=!1,r=void 0){let l;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(d,_,w,T){return a._(this,void 0,void 0,function*(){const B=xt(d),j=w>1?"@2x":"",X={},ue={};for(const{id:Se,url:Te}of B){const Re=_.transformRequest(_.normalizeSpriteURL(Te,j,".json"),zt.SpriteJSON);X[Se]=a.h(Re,T);const Be=_.transformRequest(_.normalizeSpriteURL(Te,j,".png"),zt.SpriteImage);ue[Se]=Tt.getImage(Be,T)}return yield Promise.all([...Object.values(X),...Object.values(ue)]),function(Se,Te){return a._(this,void 0,void 0,function*(){const Re={};for(const Be in Se){Re[Be]={};const et=ae.getImageCanvasContext((yield Te[Be]).data),vt=(yield Se[Be]).data;for(const ot in vt){const{width:ht,height:Et,x:wt,y:si,sdf:Kt,pixelRatio:ii,stretchX:ai,stretchY:Zi,content:Qi}=vt[ot];Re[Be][ot]={data:null,pixelRatio:ii,sdf:Kt,stretchX:ai,stretchY:Zi,content:Qi,spriteData:{width:ht,height:Et,x:wt,y:si,context:et}}}}return Re})}(X,ue)})}(s,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(d=>{if(this._spriteRequest=null,d)for(const _ in d){this._spritesImagesIds[_]=[];const w=this._spritesImagesIds[_]?this._spritesImagesIds[_].filter(T=>!(T in d)):[];for(const T of w)this.imageManager.removeImage(T),this._changedImages[T]=!0;for(const T in d[_]){const B=_==="default"?T:`${_}:${T}`;this._spritesImagesIds[_].push(B),B in this.imageManager.images?this.imageManager.updateImage(B,d[_][T],!1):this.imageManager.addImage(B,d[_][T]),i&&(this._changedImages[B]=!0)}}}).catch(d=>{this._spriteRequest=null,l=d,this.fire(new a.j(l))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),i&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"})),r&&r(l)})}_unloadSprite(){for(const s of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(s),this._changedImages[s]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}_validateLayer(s){const i=this.sourceCaches[s.source];if(!i)return;const r=s.sourceLayer;if(!r)return;const l=i.getSource();(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(r)===-1)&&this.fire(new a.j(new Error(`Source layer "${r}" does not exist on source "${l.id}" as specified by style layer "${s.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const s in this.sourceCaches)if(!this.sourceCaches[s].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(s){const i=this._serializedAllLayers();if(!s||s.length===0)return Object.values(i);const r=[];for(const l of s)i[l]&&r.push(i[l]);return r}_serializedAllLayers(){let s=this._serializedLayers;if(s)return s;s=this._serializedLayers={};const i=Object.keys(this._layers);for(const r of i){const l=this._layers[r];l.type!=="custom"&&(s[r]=l.serialize())}return s}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const s in this.sourceCaches)if(this.sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(s){if(!this._loaded)return;const i=this._changed;if(this._changed){const l=Object.keys(this._updatedLayers),d=Object.keys(this._removedLayers);(l.length||d.length)&&this._updateWorkerLayers(l,d);for(const _ in this._updatedSources){const w=this._updatedSources[_];if(w==="reload")this._reloadSource(_);else{if(w!=="clear")throw new Error(`Invalid action ${w}`);this._clearSource(_)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const _ in this._updatedPaintProps)this._layers[_].updateTransitions(s);this.light.updateTransitions(s),this._resetUpdates()}const r={};for(const l in this.sourceCaches){const d=this.sourceCaches[l];r[l]=d.used,d.used=!1}for(const l of this._order){const d=this._layers[l];d.recalculate(s,this._availableImages),!d.isHidden(s.zoom)&&d.source&&(this.sourceCaches[d.source].used=!0)}for(const l in r){const d=this.sourceCaches[l];r[l]!==d.used&&d.fire(new a.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:l}))}this.light.recalculate(s),this.z=s.zoom,i&&this.fire(new a.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const s=Object.keys(this._changedImages);if(s.length){for(const i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["icons","patterns"],s);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(s,i){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(s),removedIds:i})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(s,i={}){var r;this._checkLoaded();const l=this.serialize();if(s=i.transformStyle?i.transformStyle(l,s):s,((r=i.validate)===null||r===void 0||r)&&Vt(this,a.x(s)))return!1;(s=a.aA(s)).layers=a.ay(s.layers);const d=a.aB(l,s),_=this._getOperationsToPerform(d);if(_.unimplemented.length>0)throw new Error(`Unimplemented: ${_.unimplemented.join(", ")}.`);if(_.operations.length===0)return!1;for(const w of _.operations)w();return this.stylesheet=s,this._serializedLayers=null,!0}_getOperationsToPerform(s){const i=[],r=[];for(const l of s)switch(l.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":i.push(()=>this.addLayer.apply(this,l.args));break;case"removeLayer":i.push(()=>this.removeLayer.apply(this,l.args));break;case"setPaintProperty":i.push(()=>this.setPaintProperty.apply(this,l.args));break;case"setLayoutProperty":i.push(()=>this.setLayoutProperty.apply(this,l.args));break;case"setFilter":i.push(()=>this.setFilter.apply(this,l.args));break;case"addSource":i.push(()=>this.addSource.apply(this,l.args));break;case"removeSource":i.push(()=>this.removeSource.apply(this,l.args));break;case"setLayerZoomRange":i.push(()=>this.setLayerZoomRange.apply(this,l.args));break;case"setLight":i.push(()=>this.setLight.apply(this,l.args));break;case"setGeoJSONSourceData":i.push(()=>this.setGeoJSONSourceData.apply(this,l.args));break;case"setGlyphs":i.push(()=>this.setGlyphs.apply(this,l.args));break;case"setSprite":i.push(()=>this.setSprite.apply(this,l.args));break;case"setTerrain":i.push(()=>this.map.setTerrain.apply(this,l.args));break;case"setTransition":i.push(()=>{});break;default:r.push(l.command)}return{operations:i,unimplemented:r}}addImage(s,i){if(this.getImage(s))return this.fire(new a.j(new Error(`An image named "${s}" already exists.`)));this.imageManager.addImage(s,i),this._afterImageUpdated(s)}updateImage(s,i){this.imageManager.updateImage(s,i)}getImage(s){return this.imageManager.getImage(s)}removeImage(s){if(!this.getImage(s))return this.fire(new a.j(new Error(`An image named "${s}" does not exist.`)));this.imageManager.removeImage(s),this._afterImageUpdated(s)}_afterImageUpdated(s){this._availableImages=this.imageManager.listImages(),this._changedImages[s]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(s,i,r={}){if(this._checkLoaded(),this.sourceCaches[s]!==void 0)throw new Error(`Source "${s}" already exists.`);if(!i.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(i).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(a.x.source,`sources.${s}`,i,null,r))return;this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);const l=this.sourceCaches[s]=new Ie(s,i,this.dispatcher);l.style=this,l.setEventedParent(this,()=>({isSourceLoaded:l.loaded(),source:l.serialize(),sourceId:s})),l.onAdd(this.map),this._changed=!0}removeSource(s){if(this._checkLoaded(),this.sourceCaches[s]===void 0)throw new Error("There is no source with this ID");for(const r in this._layers)if(this._layers[r].source===s)return this.fire(new a.j(new Error(`Source "${s}" cannot be removed while layer "${r}" is using it.`)));const i=this.sourceCaches[s];delete this.sourceCaches[s],delete this._updatedSources[s],i.fire(new a.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:s})),i.setEventedParent(null),i.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(s,i){if(this._checkLoaded(),this.sourceCaches[s]===void 0)throw new Error(`There is no source with this ID=${s}`);const r=this.sourceCaches[s].getSource();if(r.type!=="geojson")throw new Error(`geojsonSource.type is ${r.type}, which is !== 'geojson`);r.setData(i),this._changed=!0}getSource(s){return this.sourceCaches[s]&&this.sourceCaches[s].getSource()}addLayer(s,i,r={}){this._checkLoaded();const l=s.id;if(this.getLayer(l))return void this.fire(new a.j(new Error(`Layer "${l}" already exists on this map.`)));let d;if(s.type==="custom"){if(Vt(this,a.aC(s)))return;d=a.az(s)}else{if("source"in s&&typeof s.source=="object"&&(this.addSource(l,s.source),s=a.aA(s),s=a.e(s,{source:l})),this._validate(a.x.layer,`layers.${l}`,s,{arrayIndex:-1},r))return;d=a.az(s),this._validateLayer(d),d.setEventedParent(this,{layer:{id:l}})}const _=i?this._order.indexOf(i):this._order.length;if(i&&_===-1)this.fire(new a.j(new Error(`Cannot add layer "${l}" before non-existing layer "${i}".`)));else{if(this._order.splice(_,0,l),this._layerOrderChanged=!0,this._layers[l]=d,this._removedLayers[l]&&d.source&&d.type!=="custom"){const w=this._removedLayers[l];delete this._removedLayers[l],w.type!==d.type?this._updatedSources[d.source]="clear":(this._updatedSources[d.source]="reload",this.sourceCaches[d.source].pause())}this._updateLayer(d),d.onAdd&&d.onAdd(this.map)}}moveLayer(s,i){if(this._checkLoaded(),this._changed=!0,!this._layers[s])return void this.fire(new a.j(new Error(`The layer '${s}' does not exist in the map's style and cannot be moved.`)));if(s===i)return;const r=this._order.indexOf(s);this._order.splice(r,1);const l=i?this._order.indexOf(i):this._order.length;i&&l===-1?this.fire(new a.j(new Error(`Cannot move layer "${s}" before non-existing layer "${i}".`))):(this._order.splice(l,0,s),this._layerOrderChanged=!0)}removeLayer(s){this._checkLoaded();const i=this._layers[s];if(!i)return void this.fire(new a.j(new Error(`Cannot remove non-existing layer "${s}".`)));i.setEventedParent(null);const r=this._order.indexOf(s);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[s]=i,delete this._layers[s],this._serializedLayers&&delete this._serializedLayers[s],delete this._updatedLayers[s],delete this._updatedPaintProps[s],i.onRemove&&i.onRemove(this.map)}getLayer(s){return this._layers[s]}getLayersOrder(){return[...this._order]}hasLayer(s){return s in this._layers}setLayerZoomRange(s,i,r){this._checkLoaded();const l=this.getLayer(s);l?l.minzoom===i&&l.maxzoom===r||(i!=null&&(l.minzoom=i),r!=null&&(l.maxzoom=r),this._updateLayer(l)):this.fire(new a.j(new Error(`Cannot set the zoom range of non-existing layer "${s}".`)))}setFilter(s,i,r={}){this._checkLoaded();const l=this.getLayer(s);if(l){if(!a.aD(l.filter,i))return i==null?(l.filter=void 0,void this._updateLayer(l)):void(this._validate(a.x.filter,`layers.${l.id}.filter`,i,null,r)||(l.filter=a.aA(i),this._updateLayer(l)))}else this.fire(new a.j(new Error(`Cannot filter non-existing layer "${s}".`)))}getFilter(s){return a.aA(this.getLayer(s).filter)}setLayoutProperty(s,i,r,l={}){this._checkLoaded();const d=this.getLayer(s);d?a.aD(d.getLayoutProperty(i),r)||(d.setLayoutProperty(i,r,l),this._updateLayer(d)):this.fire(new a.j(new Error(`Cannot style non-existing layer "${s}".`)))}getLayoutProperty(s,i){const r=this.getLayer(s);if(r)return r.getLayoutProperty(i);this.fire(new a.j(new Error(`Cannot get style of non-existing layer "${s}".`)))}setPaintProperty(s,i,r,l={}){this._checkLoaded();const d=this.getLayer(s);d?a.aD(d.getPaintProperty(i),r)||(d.setPaintProperty(i,r,l)&&this._updateLayer(d),this._changed=!0,this._updatedPaintProps[s]=!0):this.fire(new a.j(new Error(`Cannot style non-existing layer "${s}".`)))}getPaintProperty(s,i){return this.getLayer(s).getPaintProperty(i)}setFeatureState(s,i){this._checkLoaded();const r=s.source,l=s.sourceLayer,d=this.sourceCaches[r];if(d===void 0)return void this.fire(new a.j(new Error(`The source '${r}' does not exist in the map's style.`)));const _=d.getSource().type;_==="geojson"&&l?this.fire(new a.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):_!=="vector"||l?(s.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),d.setFeatureState(l,s.id,i)):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(s,i){this._checkLoaded();const r=s.source,l=this.sourceCaches[r];if(l===void 0)return void this.fire(new a.j(new Error(`The source '${r}' does not exist in the map's style.`)));const d=l.getSource().type,_=d==="vector"?s.sourceLayer:void 0;d!=="vector"||_?i&&typeof s.id!="string"&&typeof s.id!="number"?this.fire(new a.j(new Error("A feature id is required to remove its specific state property."))):l.removeFeatureState(_,s.id,i):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(s){this._checkLoaded();const i=s.source,r=s.sourceLayer,l=this.sourceCaches[i];if(l!==void 0)return l.getSource().type!=="vector"||r?(s.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),l.getFeatureState(r,s.id)):void this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.j(new Error(`The source '${i}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const s=a.aE(this.sourceCaches,d=>d.serialize()),i=this._serializeByIds(this._order),r=this.map.getTerrain()||void 0,l=this.stylesheet;return a.aF({version:l.version,name:l.name,metadata:l.metadata,light:l.light,center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,sprite:l.sprite,glyphs:l.glyphs,transition:l.transition,sources:s,layers:i,terrain:r},d=>d!==void 0)}_updateLayer(s){this._updatedLayers[s.id]=!0,s.source&&!this._updatedSources[s.source]&&this.sourceCaches[s.source].getSource().type!=="raster"&&(this._updatedSources[s.source]="reload",this.sourceCaches[s.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(s){const i=_=>this._layers[_].type==="fill-extrusion",r={},l=[];for(let _=this._order.length-1;_>=0;_--){const w=this._order[_];if(i(w)){r[w]=_;for(const T of s){const B=T[w];if(B)for(const j of B)l.push(j)}}}l.sort((_,w)=>w.intersectionZ-_.intersectionZ);const d=[];for(let _=this._order.length-1;_>=0;_--){const w=this._order[_];if(i(w))for(let T=l.length-1;T>=0;T--){const B=l[T].feature;if(r[B.layer.id]<_)break;d.push(B),l.pop()}else for(const T of s){const B=T[w];if(B)for(const j of B)d.push(j.feature)}}return d}queryRenderedFeatures(s,i,r){i&&i.filter&&this._validate(a.x.filter,"queryRenderedFeatures.filter",i.filter,null,i);const l={};if(i&&i.layers){if(!Array.isArray(i.layers))return this.fire(new a.j(new Error("parameters.layers must be an Array."))),[];for(const w of i.layers){const T=this._layers[w];if(!T)return this.fire(new a.j(new Error(`The layer '${w}' does not exist in the map's style and cannot be queried for features.`))),[];l[T.source]=!0}}const d=[];i.availableImages=this._availableImages;const _=this._serializedAllLayers();for(const w in this.sourceCaches)i.layers&&!l[w]||d.push(Oi(this.sourceCaches[w],this._layers,_,s,i,r));return this.placement&&d.push(function(w,T,B,j,X,ue,Se){const Te={},Re=ue.queryRenderedSymbols(j),Be=[];for(const et of Object.keys(Re).map(Number))Be.push(Se[et]);Be.sort(xn);for(const et of Be){const vt=et.featureIndex.lookupSymbolFeatures(Re[et.bucketInstanceId],T,et.bucketIndex,et.sourceLayerIndex,X.filter,X.layers,X.availableImages,w);for(const ot in vt){const ht=Te[ot]=Te[ot]||[],Et=vt[ot];Et.sort((wt,si)=>{const Kt=et.featureSortOrder;if(Kt){const ii=Kt.indexOf(wt.featureIndex);return Kt.indexOf(si.featureIndex)-ii}return si.featureIndex-wt.featureIndex});for(const wt of Et)ht.push(wt)}}for(const et in Te)Te[et].forEach(vt=>{const ot=vt.feature,ht=B[w[et].source].getFeatureState(ot.layer["source-layer"],ot.id);ot.source=ot.layer.source,ot.layer["source-layer"]&&(ot.sourceLayer=ot.layer["source-layer"]),ot.state=ht});return Te}(this._layers,_,this.sourceCaches,s,i,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(d)}querySourceFeatures(s,i){i&&i.filter&&this._validate(a.x.filter,"querySourceFeatures.filter",i.filter,null,i);const r=this.sourceCaches[s];return r?function(l,d){const _=l.getRenderableIds().map(B=>l.getTileByID(B)),w=[],T={};for(let B=0;B<_.length;B++){const j=_[B],X=j.tileID.canonical.key;T[X]||(T[X]=!0,j.querySourceFeatures(w,d))}return w}(r,i):[]}getLight(){return this.light.getLight()}setLight(s,i={}){this._checkLoaded();const r=this.light.getLight();let l=!1;for(const _ in s)if(!a.aD(s[_],r[_])){l=!0;break}if(!l)return;const d={now:ae.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(s,i),this.light.updateTransitions(d)}_validate(s,i,r,l,d={}){return(!d||d.validate!==!1)&&Vt(this,s.call(a.x,a.e({key:i,style:this.serialize(),value:r,styleSpec:a.v},l)))}_remove(s=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Y().off("pluginStateChange",this._rtlTextPluginStateChange);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this.sourceCaches){const r=this.sourceCaches[i];r.setEventedParent(null),r.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),s&&this.dispatcher.broadcast("removeMap",void 0),this.dispatcher.remove(s)}_clearSource(s){this.sourceCaches[s].clearTiles()}_reloadSource(s){this.sourceCaches[s].resume(),this.sourceCaches[s].reload()}_updateSources(s){for(const i in this.sourceCaches)this.sourceCaches[i].update(s,this.map.terrain)}_generateCollisionBoxes(){for(const s in this.sourceCaches)this._reloadSource(s)}_updatePlacement(s,i,r,l,d=!1){let _=!1,w=!1;const T={};for(const B of this._order){const j=this._layers[B];if(j.type!=="symbol")continue;if(!T[j.source]){const ue=this.sourceCaches[j.source];T[j.source]=ue.getRenderableIds(!0).map(Se=>ue.getTileByID(Se)).sort((Se,Te)=>Te.tileID.overscaledZ-Se.tileID.overscaledZ||(Se.tileID.isLessThan(Te.tileID)?-1:1))}const X=this.crossTileSymbolIndex.addLayer(j,T[j.source],s.center.lng);_=_||X}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((d=d||this._layerOrderChanged||r===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(ae.now(),s.zoom))&&(this.pauseablePlacement=new Yi(s,this.map.terrain,this._order,d,i,r,l,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,T),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(ae.now()),w=!0),_&&this.pauseablePlacement.placement.setStale()),w||_)for(const B of this._order){const j=this._layers[B];j.type==="symbol"&&this.placement.updateLayerOpacities(j,T[j.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(ae.now())}_releaseSymbolFadeTiles(){for(const s in this.sourceCaches)this.sourceCaches[s].releaseSymbolFadeTiles()}getImages(s,i){return a._(this,void 0,void 0,function*(){const r=yield this.imageManager.getImages(i.icons);this._updateTilesForChangedImages();const l=this.sourceCaches[i.source];return l&&l.setDependencies(i.tileID.key,i.type,i.icons),r})}getGlyphs(s,i){return a._(this,void 0,void 0,function*(){const r=yield this.glyphManager.getGlyphs(i.stacks),l=this.sourceCaches[i.source];return l&&l.setDependencies(i.tileID.key,i.type,[""]),r})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(s,i={}){this._checkLoaded(),s&&this._validate(a.x.glyphs,"glyphs",s,null,i)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=s,this.glyphManager.entries={},this.glyphManager.setURL(s))}addSprite(s,i,r={},l){this._checkLoaded();const d=[{id:s,url:i}],_=[...xt(this.stylesheet.sprite),...d];this._validate(a.x.sprite,"sprite",_,null,r)||(this.stylesheet.sprite=_,this._loadSprite(d,!0,l))}removeSprite(s){this._checkLoaded();const i=xt(this.stylesheet.sprite);if(i.find(r=>r.id===s)){if(this._spritesImagesIds[s])for(const r of this._spritesImagesIds[s])this.imageManager.removeImage(r),this._changedImages[r]=!0;i.splice(i.findIndex(r=>r.id===s),1),this.stylesheet.sprite=i.length>0?i:void 0,delete this._spritesImagesIds[s],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}else this.fire(new a.j(new Error(`Sprite "${s}" doesn't exists on this map.`)))}getSprite(){return xt(this.stylesheet.sprite)}setSprite(s,i={},r){this._checkLoaded(),s&&this._validate(a.x.sprite,"sprite",s,null,i)||(this.stylesheet.sprite=s,s?this._loadSprite(s,!0,r):(this._unloadSprite(),r&&r(null)))}}var Fr=a.X([{name:"a_pos",type:"Int16",components:2}]),Us="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const ca={prelude:Dr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Dr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Dr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Dr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Dr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Dr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Dr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Dr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Dr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Dr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Dr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Dr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Dr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Dr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Dr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Dr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Dr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Dr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Dr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Dr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Dr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Dr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Dr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Dr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Dr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Dr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Dr("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Us),terrainDepth:Dr("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Us),terrainCoords:Dr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Us)};function Dr(y,s){const i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=s.match(/attribute ([\w]+) ([\w]+)/g),l=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),d=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=d?d.concat(l):l,w={};return{fragmentSource:y=y.replace(i,(T,B,j,X,ue)=>(w[ue]=!0,B==="define"?`
#ifndef HAS_UNIFORM_u_${ue}
varying ${j} ${X} ${ue};
#else
uniform ${j} ${X} u_${ue};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ue}
    ${j} ${X} ${ue} = u_${ue};
#endif
`)),vertexSource:s=s.replace(i,(T,B,j,X,ue)=>{const Se=X==="float"?"vec2":"vec4",Te=ue.match(/color/)?"color":Se;return w[ue]?B==="define"?`
#ifndef HAS_UNIFORM_u_${ue}
uniform lowp float u_${ue}_t;
attribute ${j} ${Se} a_${ue};
varying ${j} ${X} ${ue};
#else
uniform ${j} ${X} u_${ue};
#endif
`:Te==="vec4"?`
#ifndef HAS_UNIFORM_u_${ue}
    ${ue} = a_${ue};
#else
    ${j} ${X} ${ue} = u_${ue};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ue}
    ${ue} = unpack_mix_${Te}(a_${ue}, u_${ue}_t);
#else
    ${j} ${X} ${ue} = u_${ue};
#endif
`:B==="define"?`
#ifndef HAS_UNIFORM_u_${ue}
uniform lowp float u_${ue}_t;
attribute ${j} ${Se} a_${ue};
#else
uniform ${j} ${X} u_${ue};
#endif
`:Te==="vec4"?`
#ifndef HAS_UNIFORM_u_${ue}
    ${j} ${X} ${ue} = a_${ue};
#else
    ${j} ${X} ${ue} = u_${ue};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ue}
    ${j} ${X} ${ue} = unpack_mix_${Te}(a_${ue}, u_${ue}_t);
#else
    ${j} ${X} ${ue} = u_${ue};
#endif
`}),staticAttributes:r,staticUniforms:_}}class Ua{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(s,i,r,l,d,_,w,T,B){this.context=s;let j=this.boundPaintVertexBuffers.length!==l.length;for(let X=0;!j&&X<l.length;X++)this.boundPaintVertexBuffers[X]!==l[X]&&(j=!0);!this.vao||this.boundProgram!==i||this.boundLayoutVertexBuffer!==r||j||this.boundIndexBuffer!==d||this.boundVertexOffset!==_||this.boundDynamicVertexBuffer!==w||this.boundDynamicVertexBuffer2!==T||this.boundDynamicVertexBuffer3!==B?this.freshBind(i,r,l,d,_,w,T,B):(s.bindVertexArray.set(this.vao),w&&w.bind(),d&&d.dynamicDraw&&d.bind(),T&&T.bind(),B&&B.bind())}freshBind(s,i,r,l,d,_,w,T){const B=s.numAttributes,j=this.context,X=j.gl;this.vao&&this.destroy(),this.vao=j.createVertexArray(),j.bindVertexArray.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=i,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=l,this.boundVertexOffset=d,this.boundDynamicVertexBuffer=_,this.boundDynamicVertexBuffer2=w,this.boundDynamicVertexBuffer3=T,i.enableAttributes(X,s);for(const ue of r)ue.enableAttributes(X,s);_&&_.enableAttributes(X,s),w&&w.enableAttributes(X,s),T&&T.enableAttributes(X,s),i.bind(),i.setVertexAttribPointers(X,s,d);for(const ue of r)ue.bind(),ue.setVertexAttribPointers(X,s,d);_&&(_.bind(),_.setVertexAttribPointers(X,s,d)),l&&l.bind(),w&&(w.bind(),w.setVertexAttribPointers(X,s,d)),T&&(T.bind(),T.setVertexAttribPointers(X,s,d)),j.currentNumAttributes=B}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Fo(y){const s=[];for(let i=0;i<y.length;i++){if(y[i]===null)continue;const r=y[i].split(" ");s.push(r.pop())}return s}class Ga{constructor(s,i,r,l,d,_){const w=s.gl;this.program=w.createProgram();const T=Fo(i.staticAttributes),B=r?r.getBinderAttributes():[],j=T.concat(B),X=ca.prelude.staticUniforms?Fo(ca.prelude.staticUniforms):[],ue=i.staticUniforms?Fo(i.staticUniforms):[],Se=r?r.getBinderUniforms():[],Te=X.concat(ue).concat(Se),Re=[];for(const wt of Te)Re.indexOf(wt)<0&&Re.push(wt);const Be=r?r.defines():[];d&&Be.push("#define OVERDRAW_INSPECTOR;"),_&&Be.push("#define TERRAIN3D;");const et=Be.concat(ca.prelude.fragmentSource,i.fragmentSource).join(`
`),vt=Be.concat(ca.prelude.vertexSource,i.vertexSource).join(`
`),ot=w.createShader(w.FRAGMENT_SHADER);if(w.isContextLost())return void(this.failedToCreate=!0);if(w.shaderSource(ot,et),w.compileShader(ot),!w.getShaderParameter(ot,w.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${w.getShaderInfoLog(ot)}`);w.attachShader(this.program,ot);const ht=w.createShader(w.VERTEX_SHADER);if(w.isContextLost())return void(this.failedToCreate=!0);if(w.shaderSource(ht,vt),w.compileShader(ht),!w.getShaderParameter(ht,w.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${w.getShaderInfoLog(ht)}`);w.attachShader(this.program,ht),this.attributes={};const Et={};this.numAttributes=j.length;for(let wt=0;wt<this.numAttributes;wt++)j[wt]&&(w.bindAttribLocation(this.program,wt,j[wt]),this.attributes[j[wt]]=wt);if(w.linkProgram(this.program),!w.getProgramParameter(this.program,w.LINK_STATUS))throw new Error(`Program failed to link: ${w.getProgramInfoLog(this.program)}`);w.deleteShader(ht),w.deleteShader(ot);for(let wt=0;wt<Re.length;wt++){const si=Re[wt];if(si&&!Et[si]){const Kt=w.getUniformLocation(this.program,si);Kt&&(Et[si]=Kt)}}this.fixedUniforms=l(s,Et),this.terrainUniforms=((wt,si)=>({u_depth:new a.aG(wt,si.u_depth),u_terrain:new a.aG(wt,si.u_terrain),u_terrain_dim:new a.aH(wt,si.u_terrain_dim),u_terrain_matrix:new a.aI(wt,si.u_terrain_matrix),u_terrain_unpack:new a.aJ(wt,si.u_terrain_unpack),u_terrain_exaggeration:new a.aH(wt,si.u_terrain_exaggeration)}))(s,Et),this.binderUniforms=r?r.getUniforms(s,Et):[]}draw(s,i,r,l,d,_,w,T,B,j,X,ue,Se,Te,Re,Be,et,vt){const ot=s.gl;if(this.failedToCreate)return;if(s.program.set(this.program),s.setDepthMode(r),s.setStencilMode(l),s.setColorMode(d),s.setCullFace(_),T){s.activeTexture.set(ot.TEXTURE2),ot.bindTexture(ot.TEXTURE_2D,T.depthTexture),s.activeTexture.set(ot.TEXTURE3),ot.bindTexture(ot.TEXTURE_2D,T.texture);for(const Et in this.terrainUniforms)this.terrainUniforms[Et].set(T[Et])}for(const Et in this.fixedUniforms)this.fixedUniforms[Et].set(w[Et]);Re&&Re.setUniforms(s,this.binderUniforms,Se,{zoom:Te});let ht=0;switch(i){case ot.LINES:ht=2;break;case ot.TRIANGLES:ht=3;break;case ot.LINE_STRIP:ht=1}for(const Et of ue.get()){const wt=Et.vaos||(Et.vaos={});(wt[B]||(wt[B]=new Ua)).bind(s,this,j,Re?Re.getPaintVertexBuffers():[],X,Et.vertexOffset,Be,et,vt),ot.drawElements(i,Et.primitiveLength*ht,ot.UNSIGNED_SHORT,Et.primitiveOffset*ht*2)}}}function Xs(y,s,i){const r=1/kt(i,1,s.transform.tileZoom),l=Math.pow(2,i.tileID.overscaledZ),d=i.tileSize*Math.pow(2,s.transform.tileZoom)/l,_=d*(i.tileID.canonical.x+i.tileID.wrap*l),w=d*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[r,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[_>>16,w>>16],u_pixel_coord_lower:[65535&_,65535&w]}}const Qn=(y,s,i,r)=>{const l=s.style.light,d=l.properties.get("position"),_=[d.x,d.y,d.z],w=function(){var B=new a.A(9);return a.A!=Float32Array&&(B[1]=0,B[2]=0,B[3]=0,B[5]=0,B[6]=0,B[7]=0),B[0]=1,B[4]=1,B[8]=1,B}();l.properties.get("anchor")==="viewport"&&function(B,j){var X=Math.sin(j),ue=Math.cos(j);B[0]=ue,B[1]=X,B[2]=0,B[3]=-X,B[4]=ue,B[5]=0,B[6]=0,B[7]=0,B[8]=1}(w,-s.transform.angle),function(B,j,X){var ue=j[0],Se=j[1],Te=j[2];B[0]=ue*X[0]+Se*X[3]+Te*X[6],B[1]=ue*X[1]+Se*X[4]+Te*X[7],B[2]=ue*X[2]+Se*X[5]+Te*X[8]}(_,_,w);const T=l.properties.get("color");return{u_matrix:y,u_lightpos:_,u_lightintensity:l.properties.get("intensity"),u_lightcolor:[T.r,T.g,T.b],u_vertical_gradient:+i,u_opacity:r}},aa=(y,s,i,r,l,d,_)=>a.e(Qn(y,s,i,r),Xs(d,s,_),{u_height_factor:-Math.pow(2,l.overscaledZ)/_.tileSize/8}),hs=y=>({u_matrix:y}),qa=(y,s,i,r)=>a.e(hs(y),Xs(i,s,r)),al=(y,s)=>({u_matrix:y,u_world:s}),ol=(y,s,i,r,l)=>a.e(qa(y,s,i,r),{u_world:l}),no=(y,s,i,r)=>{const l=y.transform;let d,_;if(r.paint.get("circle-pitch-alignment")==="map"){const w=kt(i,1,l.zoom);d=!0,_=[w,w]}else d=!1,_=l.pixelsToGLUnits;return{u_camera_to_center_distance:l.cameraToCenterDistance,u_scale_with_map:+(r.paint.get("circle-pitch-scale")==="map"),u_matrix:y.translatePosMatrix(s.posMatrix,i,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_pitch_with_map:+d,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:_}},Ha=(y,s,i)=>{const r=kt(i,1,s.zoom),l=Math.pow(2,s.zoom-i.tileID.overscaledZ),d=i.tileID.overscaleFactor();return{u_matrix:y,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:r,u_extrude_scale:[s.pixelsToGLUnits[0]/(r*l),s.pixelsToGLUnits[1]/(r*l)],u_overscale_factor:d}},N=(y,s,i=1)=>({u_matrix:y,u_color:s,u_overlay:0,u_overlay_scale:i}),xe=y=>({u_matrix:y}),nt=(y,s,i,r)=>({u_matrix:y,u_extrude_scale:kt(s,1,i),u_intensity:r});function It(y,s){const i=Math.pow(2,s.canonical.z),r=s.canonical.y;return[new a.Y(0,r/i).toLngLat().lat,new a.Y(0,(r+1)/i).toLngLat().lat]}const $t=(y,s,i,r)=>{const l=y.transform;return{u_matrix:rr(y,s,i,r),u_ratio:1/kt(s,1,l.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/l.pixelsToGLUnits[0],1/l.pixelsToGLUnits[1]]}},wi=(y,s,i,r,l)=>a.e($t(y,s,i,l),{u_image:0,u_image_height:r}),Di=(y,s,i,r,l)=>{const d=y.transform,_=dn(s,d);return{u_matrix:rr(y,s,i,l),u_texsize:s.imageAtlasTexture.size,u_ratio:1/kt(s,1,d.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[_,r.fromScale,r.toScale],u_fade:r.t,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},hn=(y,s,i,r,l,d)=>{const _=y.lineAtlas,w=dn(s,y.transform),T=i.layout.get("line-cap")==="round",B=_.getDash(r.from,T),j=_.getDash(r.to,T),X=B.width*l.fromScale,ue=j.width*l.toScale;return a.e($t(y,s,i,d),{u_patternscale_a:[w/X,-B.height/2],u_patternscale_b:[w/ue,-j.height/2],u_sdfgamma:_.width/(256*Math.min(X,ue)*y.pixelRatio)/2,u_image:0,u_tex_y_a:B.y,u_tex_y_b:j.y,u_mix:l.t})};function dn(y,s){return 1/kt(y,1,s.tileZoom)}function rr(y,s,i,r){return y.translatePosMatrix(r?r.posMatrix:s.tileID.posMatrix,s,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const Ar=(y,s,i,r,l)=>{return{u_matrix:y,u_tl_parent:s,u_scale_parent:i,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(_=l.paint.get("raster-saturation"),_>0?1-1/(1.001-_):-_),u_contrast_factor:(d=l.paint.get("raster-contrast"),d>0?1/(1-d):1+d),u_spin_weights:Or(l.paint.get("raster-hue-rotate"))};var d,_};function Or(y){y*=Math.PI/180;const s=Math.sin(y),i=Math.cos(y);return[(2*i+1)/3,(-Math.sqrt(3)*s-i+1)/3,(Math.sqrt(3)*s-i+1)/3]}const ja=(y,s,i,r,l,d,_,w,T,B)=>{const j=l.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:j.cameraToCenterDistance,u_pitch:j.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:j.width/j.height,u_fade_change:l.options.fadeDuration?l.symbolFadeChange:1,u_matrix:d,u_label_plane_matrix:_,u_coord_matrix:w,u_is_text:+T,u_pitch_with_map:+r,u_texsize:B,u_texture:0}},Za=(y,s,i,r,l,d,_,w,T,B,j)=>{const X=l.transform;return a.e(ja(y,s,i,r,l,d,_,w,T,B),{u_gamma_scale:r?Math.cos(X._pitch)*X.cameraToCenterDistance:1,u_device_pixel_ratio:l.pixelRatio,u_is_halo:+j})},Qa=(y,s,i,r,l,d,_,w,T,B)=>a.e(Za(y,s,i,r,l,d,_,w,!0,T,!0),{u_texsize_icon:B,u_texture_icon:1}),pl=(y,s,i)=>({u_matrix:y,u_opacity:s,u_color:i}),Gr=(y,s,i,r,l,d)=>a.e(function(_,w,T,B){const j=T.imageManager.getPattern(_.from.toString()),X=T.imageManager.getPattern(_.to.toString()),{width:ue,height:Se}=T.imageManager.getPixelSize(),Te=Math.pow(2,B.tileID.overscaledZ),Re=B.tileSize*Math.pow(2,T.transform.tileZoom)/Te,Be=Re*(B.tileID.canonical.x+B.tileID.wrap*Te),et=Re*B.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:j.tl,u_pattern_br_a:j.br,u_pattern_tl_b:X.tl,u_pattern_br_b:X.br,u_texsize:[ue,Se],u_mix:w.t,u_pattern_size_a:j.displaySize,u_pattern_size_b:X.displaySize,u_scale_a:w.fromScale,u_scale_b:w.toScale,u_tile_units_to_pixels:1/kt(B,1,T.transform.tileZoom),u_pixel_coord_upper:[Be>>16,et>>16],u_pixel_coord_lower:[65535&Be,65535&et]}}(r,d,i,l),{u_matrix:y,u_opacity:s}),ir={fillExtrusion:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_lightpos:new a.aK(y,s.u_lightpos),u_lightintensity:new a.aH(y,s.u_lightintensity),u_lightcolor:new a.aK(y,s.u_lightcolor),u_vertical_gradient:new a.aH(y,s.u_vertical_gradient),u_opacity:new a.aH(y,s.u_opacity)}),fillExtrusionPattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_lightpos:new a.aK(y,s.u_lightpos),u_lightintensity:new a.aH(y,s.u_lightintensity),u_lightcolor:new a.aK(y,s.u_lightcolor),u_vertical_gradient:new a.aH(y,s.u_vertical_gradient),u_height_factor:new a.aH(y,s.u_height_factor),u_image:new a.aG(y,s.u_image),u_texsize:new a.aL(y,s.u_texsize),u_pixel_coord_upper:new a.aL(y,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(y,s.u_pixel_coord_lower),u_scale:new a.aK(y,s.u_scale),u_fade:new a.aH(y,s.u_fade),u_opacity:new a.aH(y,s.u_opacity)}),fill:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix)}),fillPattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_image:new a.aG(y,s.u_image),u_texsize:new a.aL(y,s.u_texsize),u_pixel_coord_upper:new a.aL(y,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(y,s.u_pixel_coord_lower),u_scale:new a.aK(y,s.u_scale),u_fade:new a.aH(y,s.u_fade)}),fillOutline:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_world:new a.aL(y,s.u_world)}),fillOutlinePattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_world:new a.aL(y,s.u_world),u_image:new a.aG(y,s.u_image),u_texsize:new a.aL(y,s.u_texsize),u_pixel_coord_upper:new a.aL(y,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(y,s.u_pixel_coord_lower),u_scale:new a.aK(y,s.u_scale),u_fade:new a.aH(y,s.u_fade)}),circle:(y,s)=>({u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_scale_with_map:new a.aG(y,s.u_scale_with_map),u_pitch_with_map:new a.aG(y,s.u_pitch_with_map),u_extrude_scale:new a.aL(y,s.u_extrude_scale),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_matrix:new a.aI(y,s.u_matrix)}),collisionBox:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_pixels_to_tile_units:new a.aH(y,s.u_pixels_to_tile_units),u_extrude_scale:new a.aL(y,s.u_extrude_scale),u_overscale_factor:new a.aH(y,s.u_overscale_factor)}),collisionCircle:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_inv_matrix:new a.aI(y,s.u_inv_matrix),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_viewport_size:new a.aL(y,s.u_viewport_size)}),debug:(y,s)=>({u_color:new a.aM(y,s.u_color),u_matrix:new a.aI(y,s.u_matrix),u_overlay:new a.aG(y,s.u_overlay),u_overlay_scale:new a.aH(y,s.u_overlay_scale)}),clippingMask:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix)}),heatmap:(y,s)=>({u_extrude_scale:new a.aH(y,s.u_extrude_scale),u_intensity:new a.aH(y,s.u_intensity),u_matrix:new a.aI(y,s.u_matrix)}),heatmapTexture:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_world:new a.aL(y,s.u_world),u_image:new a.aG(y,s.u_image),u_color_ramp:new a.aG(y,s.u_color_ramp),u_opacity:new a.aH(y,s.u_opacity)}),hillshade:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_image:new a.aG(y,s.u_image),u_latrange:new a.aL(y,s.u_latrange),u_light:new a.aL(y,s.u_light),u_shadow:new a.aM(y,s.u_shadow),u_highlight:new a.aM(y,s.u_highlight),u_accent:new a.aM(y,s.u_accent)}),hillshadePrepare:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_image:new a.aG(y,s.u_image),u_dimension:new a.aL(y,s.u_dimension),u_zoom:new a.aH(y,s.u_zoom),u_unpack:new a.aJ(y,s.u_unpack)}),line:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_ratio:new a.aH(y,s.u_ratio),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_units_to_pixels:new a.aL(y,s.u_units_to_pixels)}),lineGradient:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_ratio:new a.aH(y,s.u_ratio),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_units_to_pixels:new a.aL(y,s.u_units_to_pixels),u_image:new a.aG(y,s.u_image),u_image_height:new a.aH(y,s.u_image_height)}),linePattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_texsize:new a.aL(y,s.u_texsize),u_ratio:new a.aH(y,s.u_ratio),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_image:new a.aG(y,s.u_image),u_units_to_pixels:new a.aL(y,s.u_units_to_pixels),u_scale:new a.aK(y,s.u_scale),u_fade:new a.aH(y,s.u_fade)}),lineSDF:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_ratio:new a.aH(y,s.u_ratio),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_units_to_pixels:new a.aL(y,s.u_units_to_pixels),u_patternscale_a:new a.aL(y,s.u_patternscale_a),u_patternscale_b:new a.aL(y,s.u_patternscale_b),u_sdfgamma:new a.aH(y,s.u_sdfgamma),u_image:new a.aG(y,s.u_image),u_tex_y_a:new a.aH(y,s.u_tex_y_a),u_tex_y_b:new a.aH(y,s.u_tex_y_b),u_mix:new a.aH(y,s.u_mix)}),raster:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_tl_parent:new a.aL(y,s.u_tl_parent),u_scale_parent:new a.aH(y,s.u_scale_parent),u_buffer_scale:new a.aH(y,s.u_buffer_scale),u_fade_t:new a.aH(y,s.u_fade_t),u_opacity:new a.aH(y,s.u_opacity),u_image0:new a.aG(y,s.u_image0),u_image1:new a.aG(y,s.u_image1),u_brightness_low:new a.aH(y,s.u_brightness_low),u_brightness_high:new a.aH(y,s.u_brightness_high),u_saturation_factor:new a.aH(y,s.u_saturation_factor),u_contrast_factor:new a.aH(y,s.u_contrast_factor),u_spin_weights:new a.aK(y,s.u_spin_weights)}),symbolIcon:(y,s)=>({u_is_size_zoom_constant:new a.aG(y,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aG(y,s.u_is_size_feature_constant),u_size_t:new a.aH(y,s.u_size_t),u_size:new a.aH(y,s.u_size),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_pitch:new a.aH(y,s.u_pitch),u_rotate_symbol:new a.aG(y,s.u_rotate_symbol),u_aspect_ratio:new a.aH(y,s.u_aspect_ratio),u_fade_change:new a.aH(y,s.u_fade_change),u_matrix:new a.aI(y,s.u_matrix),u_label_plane_matrix:new a.aI(y,s.u_label_plane_matrix),u_coord_matrix:new a.aI(y,s.u_coord_matrix),u_is_text:new a.aG(y,s.u_is_text),u_pitch_with_map:new a.aG(y,s.u_pitch_with_map),u_texsize:new a.aL(y,s.u_texsize),u_texture:new a.aG(y,s.u_texture)}),symbolSDF:(y,s)=>({u_is_size_zoom_constant:new a.aG(y,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aG(y,s.u_is_size_feature_constant),u_size_t:new a.aH(y,s.u_size_t),u_size:new a.aH(y,s.u_size),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_pitch:new a.aH(y,s.u_pitch),u_rotate_symbol:new a.aG(y,s.u_rotate_symbol),u_aspect_ratio:new a.aH(y,s.u_aspect_ratio),u_fade_change:new a.aH(y,s.u_fade_change),u_matrix:new a.aI(y,s.u_matrix),u_label_plane_matrix:new a.aI(y,s.u_label_plane_matrix),u_coord_matrix:new a.aI(y,s.u_coord_matrix),u_is_text:new a.aG(y,s.u_is_text),u_pitch_with_map:new a.aG(y,s.u_pitch_with_map),u_texsize:new a.aL(y,s.u_texsize),u_texture:new a.aG(y,s.u_texture),u_gamma_scale:new a.aH(y,s.u_gamma_scale),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_is_halo:new a.aG(y,s.u_is_halo)}),symbolTextAndIcon:(y,s)=>({u_is_size_zoom_constant:new a.aG(y,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aG(y,s.u_is_size_feature_constant),u_size_t:new a.aH(y,s.u_size_t),u_size:new a.aH(y,s.u_size),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_pitch:new a.aH(y,s.u_pitch),u_rotate_symbol:new a.aG(y,s.u_rotate_symbol),u_aspect_ratio:new a.aH(y,s.u_aspect_ratio),u_fade_change:new a.aH(y,s.u_fade_change),u_matrix:new a.aI(y,s.u_matrix),u_label_plane_matrix:new a.aI(y,s.u_label_plane_matrix),u_coord_matrix:new a.aI(y,s.u_coord_matrix),u_is_text:new a.aG(y,s.u_is_text),u_pitch_with_map:new a.aG(y,s.u_pitch_with_map),u_texsize:new a.aL(y,s.u_texsize),u_texsize_icon:new a.aL(y,s.u_texsize_icon),u_texture:new a.aG(y,s.u_texture),u_texture_icon:new a.aG(y,s.u_texture_icon),u_gamma_scale:new a.aH(y,s.u_gamma_scale),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_is_halo:new a.aG(y,s.u_is_halo)}),background:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_opacity:new a.aH(y,s.u_opacity),u_color:new a.aM(y,s.u_color)}),backgroundPattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_opacity:new a.aH(y,s.u_opacity),u_image:new a.aG(y,s.u_image),u_pattern_tl_a:new a.aL(y,s.u_pattern_tl_a),u_pattern_br_a:new a.aL(y,s.u_pattern_br_a),u_pattern_tl_b:new a.aL(y,s.u_pattern_tl_b),u_pattern_br_b:new a.aL(y,s.u_pattern_br_b),u_texsize:new a.aL(y,s.u_texsize),u_mix:new a.aH(y,s.u_mix),u_pattern_size_a:new a.aL(y,s.u_pattern_size_a),u_pattern_size_b:new a.aL(y,s.u_pattern_size_b),u_scale_a:new a.aH(y,s.u_scale_a),u_scale_b:new a.aH(y,s.u_scale_b),u_pixel_coord_upper:new a.aL(y,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(y,s.u_pixel_coord_lower),u_tile_units_to_pixels:new a.aH(y,s.u_tile_units_to_pixels)}),terrain:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_texture:new a.aG(y,s.u_texture),u_ele_delta:new a.aH(y,s.u_ele_delta)}),terrainDepth:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_ele_delta:new a.aH(y,s.u_ele_delta)}),terrainCoords:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_texture:new a.aG(y,s.u_texture),u_terrain_coords_id:new a.aH(y,s.u_terrain_coords_id),u_ele_delta:new a.aH(y,s.u_ele_delta)})};class Er{constructor(s,i,r){this.context=s;const l=s.gl;this.buffer=l.createBuffer(),this.dynamicDraw=!!r,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),l.bufferData(l.ELEMENT_ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?l.DYNAMIC_DRAW:l.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){const i=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Lr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Zs{constructor(s,i,r,l){this.length=i.length,this.attributes=r,this.itemSize=i.bytesPerElement,this.dynamicDraw=l,this.context=s;const d=s.gl;this.buffer=d.createBuffer(),s.bindVertexBuffer.set(this.buffer),d.bufferData(d.ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){if(s.length!==this.length)throw new Error(`Length of new data is ${s.length}, which doesn't match current length of ${this.length}`);const i=this.context.gl;this.bind(),i.bufferSubData(i.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,i){for(let r=0;r<this.attributes.length;r++){const l=i.attributes[this.attributes[r].name];l!==void 0&&s.enableVertexAttribArray(l)}}setVertexAttribPointers(s,i,r){for(let l=0;l<this.attributes.length;l++){const d=this.attributes[l],_=i.attributes[d.name];_!==void 0&&s.vertexAttribPointer(_,d.components,s[Lr[d.type]],!1,this.itemSize,d.offset+this.itemSize*(r||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const xr=new WeakMap;function Ks(y){var s;if(xr.has(y))return xr.get(y);{const i=(s=y.getParameter(y.VERSION))===null||s===void 0?void 0:s.startsWith("WebGL 2.0");return xr.set(y,i),i}}class Br{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class To extends Br{getDefault(){return a.aO.transparent}set(s){const i=this.current;(s.r!==i.r||s.g!==i.g||s.b!==i.b||s.a!==i.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Zo extends Br{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class Bs extends Br{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class Il extends Br{getDefault(){return[!0,!0,!0,!0]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||s[2]!==i[2]||s[3]!==i[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class mo extends Br{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class Qo extends Br{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class ha extends Br{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const i=this.current;(s.func!==i.func||s.ref!==i.ref||s.mask!==i.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class Ys extends Br{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||s[2]!==i[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class El extends Br{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.STENCIL_TEST):i.disable(i.STENCIL_TEST),this.current=s,this.dirty=!1}}class Wa extends Br{getDefault(){return[0,1]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class Ma extends Br{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.DEPTH_TEST):i.disable(i.DEPTH_TEST),this.current=s,this.dirty=!1}}class ml extends Br{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class Cl extends Br{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.BLEND):i.disable(i.BLEND),this.current=s,this.dirty=!1}}class mu extends Br{getDefault(){const s=this.gl;return[s.ONE,s.ZERO]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||this.dirty)&&(this.gl.blendFunc(s[0],s[1]),this.current=s,this.dirty=!1)}}class As extends Br{getDefault(){return a.aO.transparent}set(s){const i=this.current;(s.r!==i.r||s.g!==i.g||s.b!==i.b||s.a!==i.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class ac extends Br{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquation(s),this.current=s,this.dirty=!1)}}class ro extends Br{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.CULL_FACE):i.disable(i.CULL_FACE),this.current=s,this.dirty=!1}}class so extends Br{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class Wl extends Br{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}class Oo extends Br{getDefault(){return null}set(s){(s!==this.current||this.dirty)&&(this.gl.useProgram(s),this.current=s,this.dirty=!1)}}class Wo extends Br{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class ko extends Br{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||s[2]!==i[2]||s[3]!==i[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Gs extends Br{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindFramebuffer(i.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class $o extends Br{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindRenderbuffer(i.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Xo extends Br{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindTexture(i.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class Yo extends Br{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindBuffer(i.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class Sa extends Br{getDefault(){return null}set(s){const i=this.gl;i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class $a extends Br{getDefault(){return null}set(s){var i;if(s===this.current&&!this.dirty)return;const r=this.gl;Ks(r)?r.bindVertexArray(s):(i=r.getExtension("OES_vertex_array_object"))===null||i===void 0||i.bindVertexArrayOES(s),this.current=s,this.dirty=!1}}class ks extends Br{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class gu extends Br{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class Cr extends Br{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class $n extends Br{constructor(s,i){super(s),this.context=s,this.parent=i}getDefault(){return null}}class Ko extends $n{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class zr extends $n{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Xa extends $n{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class is{constructor(s,i,r,l,d){this.context=s,this.width=i,this.height=r;const _=s.gl,w=this.framebuffer=_.createFramebuffer();if(this.colorAttachment=new Ko(s,w),l)this.depthAttachment=d?new Xa(s,w):new zr(s,w);else if(d)throw new Error("Stencil cannot be set without depth");if(_.checkFramebufferStatus(_.FRAMEBUFFER)!==_.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const s=this.context.gl,i=this.colorAttachment.get();if(i&&s.deleteTexture(i),this.depthAttachment){const r=this.depthAttachment.get();r&&s.deleteRenderbuffer(r)}s.deleteFramebuffer(this.framebuffer)}}class fr{constructor(s,i,r){this.blendFunction=s,this.blendColor=i,this.mask=r}}fr.Replace=[1,0],fr.disabled=new fr(fr.Replace,a.aO.transparent,[!1,!1,!1,!1]),fr.unblended=new fr(fr.Replace,a.aO.transparent,[!0,!0,!0,!0]),fr.alphaBlended=new fr([1,771],a.aO.transparent,[!0,!0,!0,!0]);class Mo{constructor(s){var i,r;if(this.gl=s,this.clearColor=new To(this),this.clearDepth=new Zo(this),this.clearStencil=new Bs(this),this.colorMask=new Il(this),this.depthMask=new mo(this),this.stencilMask=new Qo(this),this.stencilFunc=new ha(this),this.stencilOp=new Ys(this),this.stencilTest=new El(this),this.depthRange=new Wa(this),this.depthTest=new Ma(this),this.depthFunc=new ml(this),this.blend=new Cl(this),this.blendFunc=new mu(this),this.blendColor=new As(this),this.blendEquation=new ac(this),this.cullFace=new ro(this),this.cullFaceSide=new so(this),this.frontFace=new Wl(this),this.program=new Oo(this),this.activeTexture=new Wo(this),this.viewport=new ko(this),this.bindFramebuffer=new Gs(this),this.bindRenderbuffer=new $o(this),this.bindTexture=new Xo(this),this.bindVertexBuffer=new Yo(this),this.bindElementBuffer=new Sa(this),this.bindVertexArray=new $a(this),this.pixelStoreUnpack=new ks(this),this.pixelStoreUnpackPremultiplyAlpha=new gu(this),this.pixelStoreUnpackFlipY=new Cr(this),this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),Ks(s)){this.HALF_FLOAT=s.HALF_FLOAT;const l=s.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(i=s.RGBA16F)!==null&&i!==void 0?i:l==null?void 0:l.RGBA16F_EXT,this.RGB16F=(r=s.RGB16F)!==null&&r!==void 0?r:l==null?void 0:l.RGB16F_EXT,s.getExtension("EXT_color_buffer_float")}else{s.getExtension("EXT_color_buffer_half_float"),s.getExtension("OES_texture_half_float_linear");const l=s.getExtension("OES_texture_half_float");this.HALF_FLOAT=l==null?void 0:l.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,i){return new Er(this,s,i)}createVertexBuffer(s,i,r){return new Zs(this,s,i,r)}createRenderbuffer(s,i,r){const l=this.gl,d=l.createRenderbuffer();return this.bindRenderbuffer.set(d),l.renderbufferStorage(l.RENDERBUFFER,s,i,r),this.bindRenderbuffer.set(null),d}createFramebuffer(s,i,r,l){return new is(this,s,i,r,l)}clear({color:s,depth:i,stencil:r}){const l=this.gl;let d=0;s&&(d|=l.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),i!==void 0&&(d|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),r!==void 0&&(d|=l.STENCIL_BUFFER_BIT,this.clearStencil.set(r),this.stencilMask.set(255)),l.clear(d)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){a.aD(s.blendFunction,fr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)}createVertexArray(){var s;return Ks(this.gl)?this.gl.createVertexArray():(s=this.gl.getExtension("OES_vertex_array_object"))===null||s===void 0?void 0:s.createVertexArrayOES()}deleteVertexArray(s){var i;return Ks(this.gl)?this.gl.deleteVertexArray(s):(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.deleteVertexArrayOES(s)}unbindVAO(){this.bindVertexArray.set(null)}}class qn{constructor(s,i,r){this.func=s,this.mask=i,this.range=r}}qn.ReadOnly=!1,qn.ReadWrite=!0,qn.disabled=new qn(519,qn.ReadOnly,[0,1]);const Ol=7680;class ns{constructor(s,i,r,l,d,_){this.test=s,this.ref=i,this.mask=r,this.fail=l,this.depthFail=d,this.pass=_}}ns.disabled=new ns({func:519,mask:0},0,0,Ol,Ol,Ol);class Zr{constructor(s,i,r){this.enable=s,this.mode=i,this.frontFace=r}}let Ms;function Mr(y,s,i,r,l,d,_){const w=y.context,T=w.gl,B=y.useProgram("collisionBox"),j=[];let X=0,ue=0;for(let ot=0;ot<r.length;ot++){const ht=r[ot],Et=s.getTile(ht),wt=Et.getBucket(i);if(!wt)continue;let si=ht.posMatrix;l[0]===0&&l[1]===0||(si=y.translatePosMatrix(ht.posMatrix,Et,l,d));const Kt=_?wt.textCollisionBox:wt.iconCollisionBox,ii=wt.collisionCircleArray;if(ii.length>0){const ai=a.F(),Zi=si;a.aP(ai,wt.placementInvProjMatrix,y.transform.glCoordMatrix),a.aP(ai,ai,wt.placementViewportMatrix),j.push({circleArray:ii,circleOffset:ue,transform:Zi,invTransform:ai,coord:ht}),X+=ii.length/4,ue=X}Kt&&B.draw(w,T.LINES,qn.disabled,ns.disabled,y.colorModeForRenderPass(),Zr.disabled,Ha(si,y.transform,Et),y.style.map.terrain&&y.style.map.terrain.getTerrainData(ht),i.id,Kt.layoutVertexBuffer,Kt.indexBuffer,Kt.segments,null,y.transform.zoom,null,null,Kt.collisionVertexBuffer)}if(!_||!j.length)return;const Se=y.useProgram("collisionCircle"),Te=new a.aQ;Te.resize(4*X),Te._trim();let Re=0;for(const ot of j)for(let ht=0;ht<ot.circleArray.length/4;ht++){const Et=4*ht,wt=ot.circleArray[Et+0],si=ot.circleArray[Et+1],Kt=ot.circleArray[Et+2],ii=ot.circleArray[Et+3];Te.emplace(Re++,wt,si,Kt,ii,0),Te.emplace(Re++,wt,si,Kt,ii,1),Te.emplace(Re++,wt,si,Kt,ii,2),Te.emplace(Re++,wt,si,Kt,ii,3)}(!Ms||Ms.length<2*X)&&(Ms=function(ot){const ht=2*ot,Et=new a.aS;Et.resize(ht),Et._trim();for(let wt=0;wt<ht;wt++){const si=6*wt;Et.uint16[si+0]=4*wt+0,Et.uint16[si+1]=4*wt+1,Et.uint16[si+2]=4*wt+2,Et.uint16[si+3]=4*wt+2,Et.uint16[si+4]=4*wt+3,Et.uint16[si+5]=4*wt+0}return Et}(X));const Be=w.createIndexBuffer(Ms,!0),et=w.createVertexBuffer(Te,a.aR.members,!0);for(const ot of j){const ht={u_matrix:ot.transform,u_inv_matrix:ot.invTransform,u_camera_to_center_distance:(vt=y.transform).cameraToCenterDistance,u_viewport_size:[vt.width,vt.height]};Se.draw(w,T.TRIANGLES,qn.disabled,ns.disabled,y.colorModeForRenderPass(),Zr.disabled,ht,y.style.map.terrain&&y.style.map.terrain.getTerrainData(ot.coord),i.id,et,Be,a.$.simpleSegment(0,2*ot.circleOffset,ot.circleArray.length,ot.circleArray.length/2),null,y.transform.zoom,null,null,null)}var vt;et.destroy(),Be.destroy()}Zr.disabled=new Zr(!1,1029,2305),Zr.backCCW=new Zr(!0,1029,2305);const nr=a.an(new Float32Array(16));function ll(y,s,i,r,l,d){const{horizontalAlign:_,verticalAlign:w}=a.at(y);return new a.P((-(_-.5)*s/l+r[0])*d,(-(w-.5)*i/l+r[1])*d)}function Xr(y,s,i,r,l,d,_,w,T,B,j){const X=y.text.placedSymbolArray,ue=y.text.dynamicLayoutVertexArray,Se=y.icon.dynamicLayoutVertexArray,Te={};ue.clear();for(let Re=0;Re<X.length;Re++){const Be=X.get(Re),et=Be.hidden||!Be.crossTileID||y.allowVerticalPlacement&&!Be.placedOrientation?null:r[Be.crossTileID];if(et){const vt=new a.P(Be.anchorX,Be.anchorY),ot=rt(vt,i?_:d,j),ht=Me(l.cameraToCenterDistance,ot.signedDistanceFromCamera);let Et=a.ai(y.textSizeData,T,Be)*ht/a.ao;i&&(Et*=y.tilePixelRatio/w);const{width:wt,height:si,anchor:Kt,textOffset:ii,textBoxScale:ai}=et,Zi=ll(Kt,wt,si,ii,ai,Et),Qi=i?rt(vt.add(Zi),d,j).point:ot.point.add(s?Zi.rotate(-l.angle):Zi),Si=y.allowVerticalPlacement&&Be.placedOrientation===a.ah.vertical?Math.PI/2:0;for(let Ui=0;Ui<Be.numGlyphs;Ui++)a.aj(ue,Qi,Si);B&&Be.associatedIconIndex>=0&&(Te[Be.associatedIconIndex]={shiftedAnchor:Qi,angle:Si})}else Ke(Be.numGlyphs,ue)}if(B){Se.clear();const Re=y.icon.placedSymbolArray;for(let Be=0;Be<Re.length;Be++){const et=Re.get(Be);if(et.hidden)Ke(et.numGlyphs,Se);else{const vt=Te[Be];if(vt)for(let ot=0;ot<et.numGlyphs;ot++)a.aj(Se,vt.shiftedAnchor,vt.angle);else Ke(et.numGlyphs,Se)}}y.icon.dynamicLayoutVertexBuffer.updateData(Se)}y.text.dynamicLayoutVertexBuffer.updateData(ue)}function Po(y,s,i){return i.iconsInText&&s?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function ul(y,s,i,r,l,d,_,w,T,B,j,X){const ue=y.context,Se=ue.gl,Te=y.transform,Re=w==="map",Be=T==="map",et=w!=="viewport"&&i.layout.get("symbol-placement")!=="point",vt=Re&&!Be&&!et,ot=!i.layout.get("symbol-sort-key").isConstant();let ht=!1;const Et=y.depthModeForSublayer(0,qn.ReadOnly),wt=i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"),si=[];for(const Kt of r){const ii=s.getTile(Kt),ai=ii.getBucket(i);if(!ai)continue;const Zi=l?ai.text:ai.icon;if(!Zi||!Zi.segments.get().length||!Zi.hasVisibleVertices)continue;const Qi=Zi.programConfigurations.get(i.id),Si=l||ai.sdfIcons,Ui=l?ai.textSizeData:ai.iconSizeData,Gi=Be||Te.pitch!==0,un=y.useProgram(Po(Si,l,ai),Qi),Bn=a.ag(Ui,Te.zoom),en=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Kt);let kn,vr,er,Ca,fa=[0,0],zs=null;if(l)vr=ii.glyphAtlasTexture,er=Se.LINEAR,kn=ii.glyphAtlasTexture.size,ai.iconsInText&&(fa=ii.imageAtlasTexture.size,zs=ii.imageAtlasTexture,Ca=Gi||y.options.rotating||y.options.zooming||Ui.kind==="composite"||Ui.kind==="camera"?Se.LINEAR:Se.NEAREST);else{const Ws=i.layout.get("icon-size").constantOr(0)!==1||ai.iconsNeedLinear;vr=ii.imageAtlasTexture,er=Si||y.options.rotating||y.options.zooming||Ws||Gi?Se.LINEAR:Se.NEAREST,kn=ii.imageAtlasTexture.size}const oo=kt(ii,1,y.transform.zoom),lo=Ue(Kt.posMatrix,Be,Re,y.transform,oo),qr=dt(Kt.posMatrix,Be,Re,y.transform,oo),ya=wt&&ai.hasTextData(),xo=i.layout.get("icon-text-fit")!=="none"&&ya&&ai.hasIconData();if(et){const Ws=y.style.map.terrain?(Uo,Go)=>y.style.map.terrain.getElevation(Kt,Uo,Go):null,Bo=i.layout.get("text-rotation-alignment")==="map";ne(ai,Kt.posMatrix,y,l,lo,qr,Be,B,Bo,Ws)}const bo=y.translatePosMatrix(Kt.posMatrix,ii,d,_),Qs=et||l&&wt||xo?nr:lo,rs=y.translatePosMatrix(qr,ii,d,_,!0),ss=Si&&i.paint.get(l?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Rr;Rr=Si?ai.iconsInText?Qa(Ui.kind,Bn,vt,Be,y,bo,Qs,rs,kn,fa):Za(Ui.kind,Bn,vt,Be,y,bo,Qs,rs,l,kn,!0):ja(Ui.kind,Bn,vt,Be,y,bo,Qs,rs,l,kn);const Ss={program:un,buffers:Zi,uniformValues:Rr,atlasTexture:vr,atlasTextureIcon:zs,atlasInterpolation:er,atlasInterpolationIcon:Ca,isSDF:Si,hasHalo:ss};if(ot&&ai.canOverlap){ht=!0;const Ws=Zi.segments.get();for(const Bo of Ws)si.push({segments:new a.$([Bo]),sortKey:Bo.sortKey,state:Ss,terrainData:en})}else si.push({segments:Zi.segments,sortKey:0,state:Ss,terrainData:en})}ht&&si.sort((Kt,ii)=>Kt.sortKey-ii.sortKey);for(const Kt of si){const ii=Kt.state;if(ue.activeTexture.set(Se.TEXTURE0),ii.atlasTexture.bind(ii.atlasInterpolation,Se.CLAMP_TO_EDGE),ii.atlasTextureIcon&&(ue.activeTexture.set(Se.TEXTURE1),ii.atlasTextureIcon&&ii.atlasTextureIcon.bind(ii.atlasInterpolationIcon,Se.CLAMP_TO_EDGE)),ii.isSDF){const ai=ii.uniformValues;ii.hasHalo&&(ai.u_is_halo=1,Qr(ii.buffers,Kt.segments,i,y,ii.program,Et,j,X,ai,Kt.terrainData)),ai.u_is_halo=0}Qr(ii.buffers,Kt.segments,i,y,ii.program,Et,j,X,ii.uniformValues,Kt.terrainData)}}function Qr(y,s,i,r,l,d,_,w,T,B){const j=r.context;l.draw(j,j.gl.TRIANGLES,d,_,w,Zr.disabled,T,B,i.id,y.layoutVertexBuffer,y.indexBuffer,s,i.paint,r.transform.zoom,y.programConfigurations.get(i.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function ds(y,s,i,r,l){if(!i||!r||!r.imageAtlas)return;const d=r.imageAtlas.patternPositions;let _=d[i.to.toString()],w=d[i.from.toString()];if(!_&&w&&(_=w),!w&&_&&(w=_),!_||!w){const T=l.getPaintProperty(s);_=d[T],w=d[T]}_&&w&&y.setConstantPatternPositions(_,w)}function Ia(y,s,i,r,l,d,_){const w=y.context.gl,T="fill-pattern",B=i.paint.get(T),j=B&&B.constantOr(1),X=i.getCrossfadeParameters();let ue,Se,Te,Re,Be;_?(Se=j&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ue=w.LINES):(Se=j?"fillPattern":"fill",ue=w.TRIANGLES);const et=B.constantOr(null);for(const vt of r){const ot=s.getTile(vt);if(j&&!ot.patternsLoaded())continue;const ht=ot.getBucket(i);if(!ht)continue;const Et=ht.programConfigurations.get(i.id),wt=y.useProgram(Se,Et),si=y.style.map.terrain&&y.style.map.terrain.getTerrainData(vt);j&&(y.context.activeTexture.set(w.TEXTURE0),ot.imageAtlasTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),Et.updatePaintBuffers(X)),ds(Et,T,et,ot,i);const Kt=si?vt:null,ii=y.translatePosMatrix(Kt?Kt.posMatrix:vt.posMatrix,ot,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(_){Re=ht.indexBuffer2,Be=ht.segments2;const ai=[w.drawingBufferWidth,w.drawingBufferHeight];Te=Se==="fillOutlinePattern"&&j?ol(ii,y,X,ot,ai):al(ii,ai)}else Re=ht.indexBuffer,Be=ht.segments,Te=j?qa(ii,y,X,ot):hs(ii);wt.draw(y.context,ue,l,y.stencilModeForClipping(vt),d,Zr.disabled,Te,si,i.id,ht.layoutVertexBuffer,Re,Be,i.paint,y.transform.zoom,Et)}}function Tl(y,s,i,r,l,d,_){const w=y.context,T=w.gl,B="fill-extrusion-pattern",j=i.paint.get(B),X=j.constantOr(1),ue=i.getCrossfadeParameters(),Se=i.paint.get("fill-extrusion-opacity"),Te=j.constantOr(null);for(const Re of r){const Be=s.getTile(Re),et=Be.getBucket(i);if(!et)continue;const vt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Re),ot=et.programConfigurations.get(i.id),ht=y.useProgram(X?"fillExtrusionPattern":"fillExtrusion",ot);X&&(y.context.activeTexture.set(T.TEXTURE0),Be.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),ot.updatePaintBuffers(ue)),ds(ot,B,Te,Be,i);const Et=y.translatePosMatrix(Re.posMatrix,Be,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),wt=i.paint.get("fill-extrusion-vertical-gradient"),si=X?aa(Et,y,wt,Se,Re,ue,Be):Qn(Et,y,wt,Se);ht.draw(w,w.gl.TRIANGLES,l,d,_,Zr.backCCW,si,vt,i.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,i.paint,y.transform.zoom,ot,y.style.map.terrain&&et.centroidVertexBuffer)}}function Do(y,s,i,r,l,d,_){const w=y.context,T=w.gl,B=i.fbo;if(!B)return;const j=y.useProgram("hillshade"),X=y.style.map.terrain&&y.style.map.terrain.getTerrainData(s);w.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,B.colorAttachment.get()),j.draw(w,T.TRIANGLES,l,d,_,Zr.disabled,((ue,Se,Te,Re)=>{const Be=Te.paint.get("hillshade-shadow-color"),et=Te.paint.get("hillshade-highlight-color"),vt=Te.paint.get("hillshade-accent-color");let ot=Te.paint.get("hillshade-illumination-direction")*(Math.PI/180);Te.paint.get("hillshade-illumination-anchor")==="viewport"&&(ot-=ue.transform.angle);const ht=!ue.options.moving;return{u_matrix:Re?Re.posMatrix:ue.transform.calculatePosMatrix(Se.tileID.toUnwrapped(),ht),u_image:0,u_latrange:It(0,Se.tileID),u_light:[Te.paint.get("hillshade-exaggeration"),ot],u_shadow:Be,u_highlight:et,u_accent:vt}})(y,i,r,X?s:null),X,r.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}function kl(y,s,i,r,l,d){const _=y.context,w=_.gl,T=s.dem;if(T&&T.data){const B=T.dim,j=T.stride,X=T.getPixels();if(_.activeTexture.set(w.TEXTURE1),_.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||y.getTileTexture(j),s.demTexture){const Se=s.demTexture;Se.update(X,{premultiply:!1}),Se.bind(w.NEAREST,w.CLAMP_TO_EDGE)}else s.demTexture=new bt(_,X,w.RGBA,{premultiply:!1}),s.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);_.activeTexture.set(w.TEXTURE0);let ue=s.fbo;if(!ue){const Se=new bt(_,{width:B,height:B,data:null},w.RGBA);Se.bind(w.LINEAR,w.CLAMP_TO_EDGE),ue=s.fbo=_.createFramebuffer(B,B,!0,!1),ue.colorAttachment.set(Se.texture)}_.bindFramebuffer.set(ue.framebuffer),_.viewport.set([0,0,B,B]),y.useProgram("hillshadePrepare").draw(_,w.TRIANGLES,r,l,d,Zr.disabled,((Se,Te)=>{const Re=Te.stride,Be=a.F();return a.aN(Be,0,a.W,-a.W,0,0,1),a.H(Be,Be,[0,-a.W,0]),{u_matrix:Be,u_image:1,u_dimension:[Re,Re],u_zoom:Se.overscaledZ,u_unpack:Te.getUnpackVector()}})(s.tileID,T),null,i.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function go(y,s,i,r,l,d){const _=r.paint.get("raster-fade-duration");if(!d&&_>0){const w=ae.now(),T=(w-y.timeAdded)/_,B=s?(w-s.timeAdded)/_:-1,j=i.getSource(),X=l.coveringZoomLevel({tileSize:j.tileSize,roundZoom:j.roundZoom}),ue=!s||Math.abs(s.tileID.overscaledZ-X)>Math.abs(y.tileID.overscaledZ-X),Se=ue&&y.refreshedUponExpiration?1:a.ac(ue?T:1-B,0,1);return y.refreshedUponExpiration&&T>=1&&(y.refreshedUponExpiration=!1),s?{opacity:1,mix:1-Se}:{opacity:Se,mix:0}}return{opacity:1,mix:0}}const Js=new a.aO(1,0,0,1),qs=new a.aO(0,1,0,1),Ya=new a.aO(0,0,1,1),Jo=new a.aO(1,0,1,1),Yr=new a.aO(0,1,1,1);function gr(y,s,i,r){Aa(y,0,s+i/2,y.transform.width,i,r)}function Nr(y,s,i,r){Aa(y,s-i/2,0,i,y.transform.height,r)}function Aa(y,s,i,r,l,d){const _=y.context,w=_.gl;w.enable(w.SCISSOR_TEST),w.scissor(s*y.pixelRatio,i*y.pixelRatio,r*y.pixelRatio,l*y.pixelRatio),_.clear({color:d}),w.disable(w.SCISSOR_TEST)}function _o(y,s,i){const r=y.context,l=r.gl,d=i.posMatrix,_=y.useProgram("debug"),w=qn.disabled,T=ns.disabled,B=y.colorModeForRenderPass(),j="$debug",X=y.style.map.terrain&&y.style.map.terrain.getTerrainData(i);r.activeTexture.set(l.TEXTURE0);const ue=s.getTileByID(i.key).latestRawTileData,Se=Math.floor((ue&&ue.byteLength||0)/1024),Te=s.getTile(i).tileSize,Re=512/Math.min(Te,512)*(i.overscaledZ/y.transform.zoom)*.5;let Be=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(Be+=` => ${i.overscaledZ}`),function(et,vt){et.initDebugOverlayCanvas();const ot=et.debugOverlayCanvas,ht=et.context.gl,Et=et.debugOverlayCanvas.getContext("2d");Et.clearRect(0,0,ot.width,ot.height),Et.shadowColor="white",Et.shadowBlur=2,Et.lineWidth=1.5,Et.strokeStyle="white",Et.textBaseline="top",Et.font="bold 36px Open Sans, sans-serif",Et.fillText(vt,5,5),Et.strokeText(vt,5,5),et.debugOverlayTexture.update(ot),et.debugOverlayTexture.bind(ht.LINEAR,ht.CLAMP_TO_EDGE)}(y,`${Be} ${Se}kB`),_.draw(r,l.TRIANGLES,w,T,fr.alphaBlended,Zr.disabled,N(d,a.aO.transparent,Re),null,j,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments),_.draw(r,l.LINE_STRIP,w,T,B,Zr.disabled,N(d,a.aO.red),X,j,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments)}function ea(y,s,i){const r=y.context,l=r.gl,d=y.colorModeForRenderPass(),_=new qn(l.LEQUAL,qn.ReadWrite,y.depthRangeFor3D),w=y.useProgram("terrain"),T=s.getTerrainMesh();r.bindFramebuffer.set(null),r.viewport.set([0,0,y.width,y.height]);for(const B of i){const j=y.renderToTexture.getTexture(B),X=s.getTerrainData(B.tileID);r.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,j.texture);const ue={u_matrix:y.transform.calculatePosMatrix(B.tileID.toUnwrapped()),u_texture:0,u_ele_delta:s.getMeshFrameDelta(y.transform.zoom)};w.draw(r,l.TRIANGLES,_,ns.disabled,d,Zr.backCCW,ue,X,"terrain",T.vertexBuffer,T.indexBuffer,T.segments)}}class Ea{constructor(s,i){this.context=new Mo(s),this.transform=i,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.F(),renderTime:0},this.setup(),this.numSublayers=Ie.maxUnderzooming+Ie.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ur}resize(s,i,r){if(this.width=Math.floor(s*r),this.height=Math.floor(i*r),this.pixelRatio=r,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const l of this.style._order)this.style._layers[l].resize()}setup(){const s=this.context,i=new a.aV;i.emplaceBack(0,0),i.emplaceBack(a.W,0),i.emplaceBack(0,a.W),i.emplaceBack(a.W,a.W),this.tileExtentBuffer=s.createVertexBuffer(i,Fr.members),this.tileExtentSegments=a.$.simpleSegment(0,0,4,2);const r=new a.aV;r.emplaceBack(0,0),r.emplaceBack(a.W,0),r.emplaceBack(0,a.W),r.emplaceBack(a.W,a.W),this.debugBuffer=s.createVertexBuffer(r,Fr.members),this.debugSegments=a.$.simpleSegment(0,0,4,5);const l=new a.Z;l.emplaceBack(0,0,0,0),l.emplaceBack(a.W,0,a.W,0),l.emplaceBack(0,a.W,0,a.W),l.emplaceBack(a.W,a.W,a.W,a.W),this.rasterBoundsBuffer=s.createVertexBuffer(l,sn.members),this.rasterBoundsSegments=a.$.simpleSegment(0,0,4,2);const d=new a.aV;d.emplaceBack(0,0),d.emplaceBack(1,0),d.emplaceBack(0,1),d.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(d,Fr.members),this.viewportSegments=a.$.simpleSegment(0,0,4,2);const _=new a.aW;_.emplaceBack(0),_.emplaceBack(1),_.emplaceBack(3),_.emplaceBack(2),_.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(_);const w=new a.aX;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(w);const T=this.context.gl;this.stencilClearMode=new ns({func:T.ALWAYS,mask:0},0,255,T.ZERO,T.ZERO,T.ZERO)}clearStencil(){const s=this.context,i=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const r=a.F();a.aN(r,0,this.width,this.height,0,0,1),a.J(r,r,[i.drawingBufferWidth,i.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(s,i.TRIANGLES,qn.disabled,this.stencilClearMode,fr.disabled,Zr.disabled,xe(r),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(s,i){if(this.currentStencilSource===s.source||!s.isTileClipped()||!i||!i.length)return;this.currentStencilSource=s.source;const r=this.context,l=r.gl;this.nextStencilID+i.length>256&&this.clearStencil(),r.setColorMode(fr.disabled),r.setDepthMode(qn.disabled);const d=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const _ of i){const w=this._tileClippingMaskIDs[_.key]=this.nextStencilID++,T=this.style.map.terrain&&this.style.map.terrain.getTerrainData(_);d.draw(r,l.TRIANGLES,qn.disabled,new ns({func:l.ALWAYS,mask:0},w,255,l.KEEP,l.KEEP,l.REPLACE),fr.disabled,Zr.disabled,xe(_.posMatrix),T,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,i=this.context.gl;return new ns({func:i.NOTEQUAL,mask:255},s,255,i.KEEP,i.KEEP,i.REPLACE)}stencilModeForClipping(s){const i=this.context.gl;return new ns({func:i.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,i.KEEP,i.KEEP,i.REPLACE)}stencilConfigForOverlap(s){const i=this.context.gl,r=s.sort((_,w)=>w.overscaledZ-_.overscaledZ),l=r[r.length-1].overscaledZ,d=r[0].overscaledZ-l+1;if(d>1){this.currentStencilSource=void 0,this.nextStencilID+d>256&&this.clearStencil();const _={};for(let w=0;w<d;w++)_[w+l]=new ns({func:i.GEQUAL,mask:255},w+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=d,[_,r]}return[{[l]:ns.disabled},r]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new fr([s.CONSTANT_COLOR,s.ONE],new a.aO(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?fr.unblended:fr.alphaBlended}depthModeForSublayer(s,i,r){if(!this.opaquePassEnabledForLayer())return qn.disabled;const l=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new qn(r||this.context.gl.LEQUAL,i,[l,l])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(s,i){this.style=s,this.options=i,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(ae.now()),this.imageManager.beginFrame();const r=this.style._order,l=this.style.sourceCaches,d={},_={},w={};for(const T in l){const B=l[T];B.used&&B.prepare(this.context),d[T]=B.getVisibleCoordinates(),_[T]=d[T].slice().reverse(),w[T]=B.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let T=0;T<r.length;T++)if(this.style._layers[r[T]].is3D()){this.opaquePassCutoff=T;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const T=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!a.aY(this.terrainFacilitator.matrix,this.transform.projMatrix)||T.length)&&(a.aZ(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(B,j){const X=B.context,ue=X.gl,Se=fr.unblended,Te=new qn(ue.LEQUAL,qn.ReadWrite,[0,1]),Re=j.getTerrainMesh(),Be=j.sourceCache.getRenderableTiles(),et=B.useProgram("terrainDepth");X.bindFramebuffer.set(j.getFramebuffer("depth").framebuffer),X.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),X.clear({color:a.aO.transparent,depth:1});for(const vt of Be){const ot=j.getTerrainData(vt.tileID),ht={u_matrix:B.transform.calculatePosMatrix(vt.tileID.toUnwrapped()),u_ele_delta:j.getMeshFrameDelta(B.transform.zoom)};et.draw(X,ue.TRIANGLES,Te,ns.disabled,Se,Zr.backCCW,ht,ot,"terrain",Re.vertexBuffer,Re.indexBuffer,Re.segments)}X.bindFramebuffer.set(null),X.viewport.set([0,0,B.width,B.height])}(this,this.style.map.terrain),function(B,j){const X=B.context,ue=X.gl,Se=fr.unblended,Te=new qn(ue.LEQUAL,qn.ReadWrite,[0,1]),Re=j.getTerrainMesh(),Be=j.getCoordsTexture(),et=j.sourceCache.getRenderableTiles(),vt=B.useProgram("terrainCoords");X.bindFramebuffer.set(j.getFramebuffer("coords").framebuffer),X.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),X.clear({color:a.aO.transparent,depth:1}),j.coordsIndex=[];for(const ot of et){const ht=j.getTerrainData(ot.tileID);X.activeTexture.set(ue.TEXTURE0),ue.bindTexture(ue.TEXTURE_2D,Be.texture);const Et={u_matrix:B.transform.calculatePosMatrix(ot.tileID.toUnwrapped()),u_terrain_coords_id:(255-j.coordsIndex.length)/255,u_texture:0,u_ele_delta:j.getMeshFrameDelta(B.transform.zoom)};vt.draw(X,ue.TRIANGLES,Te,ns.disabled,Se,Zr.backCCW,Et,ht,"terrain",Re.vertexBuffer,Re.indexBuffer,Re.segments),j.coordsIndex.push(ot.tileID.key)}X.bindFramebuffer.set(null),X.viewport.set([0,0,B.width,B.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const T of r){const B=this.style._layers[T];if(!B.hasOffscreenPass()||B.isHidden(this.transform.zoom))continue;const j=_[B.source];(B.type==="custom"||j.length)&&this.renderLayer(this,l[B.source],B,j)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:i.showOverdrawInspector?a.aO.black:a.aO.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){const T=this.style._layers[r[this.currentLayer]],B=l[T.source],j=d[T.source];this._renderTileClippingMasks(T,j),this.renderLayer(this,B,T,j)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){const T=this.style._layers[r[this.currentLayer]],B=l[T.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(T))continue;const j=(T.type==="symbol"?w:_)[T.source];this._renderTileClippingMasks(T,d[T.source]),this.renderLayer(this,B,T,j)}if(this.options.showTileBoundaries){const T=function(B,j){let X=null;const ue=Object.values(B._layers).flatMap(Be=>Be.source&&!Be.isHidden(j)?[B.sourceCaches[Be.source]]:[]),Se=ue.filter(Be=>Be.getSource().type==="vector"),Te=ue.filter(Be=>Be.getSource().type!=="vector"),Re=Be=>{(!X||X.getSource().maxzoom<Be.getSource().maxzoom)&&(X=Be)};return Se.forEach(Be=>Re(Be)),X||Te.forEach(Be=>Re(Be)),X}(this.style,this.transform.zoom);T&&function(B,j,X){for(let ue=0;ue<X.length;ue++)_o(B,j,X[ue])}(this,T,T.getVisibleCoordinates())}this.options.showPadding&&function(T){const B=T.transform.padding;gr(T,T.transform.height-(B.top||0),3,Js),gr(T,B.bottom||0,3,qs),Nr(T,B.left||0,3,Ya),Nr(T,T.transform.width-(B.right||0),3,Jo);const j=T.transform.centerPoint;(function(X,ue,Se,Te){Aa(X,ue-1,Se-10,2,20,Te),Aa(X,ue-10,Se-1,20,2,Te)})(T,j.x,T.transform.height-j.y,Yr)}(this),this.context.setDefault()}renderLayer(s,i,r,l){if(!r.isHidden(this.transform.zoom)&&(r.type==="background"||r.type==="custom"||(l||[]).length))switch(this.id=r.id,r.type){case"symbol":(function(d,_,w,T,B){if(d.renderPass!=="translucent")return;const j=ns.disabled,X=d.colorModeForRenderPass();(w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ue,Se,Te,Re,Be,et,vt){const ot=Se.transform,ht=Be==="map",Et=et==="map";for(const wt of ue){const si=Re.getTile(wt),Kt=si.getBucket(Te);if(!Kt||!Kt.text||!Kt.text.segments.get().length)continue;const ii=a.ag(Kt.textSizeData,ot.zoom),ai=kt(si,1,Se.transform.zoom),Zi=Ue(wt.posMatrix,Et,ht,Se.transform,ai),Qi=Te.layout.get("icon-text-fit")!=="none"&&Kt.hasIconData();if(ii){const Si=Math.pow(2,ot.zoom-si.tileID.overscaledZ);Xr(Kt,ht,Et,vt,ot,Zi,wt.posMatrix,Si,ii,Qi,Se.style.map.terrain?(Ui,Gi)=>Se.style.map.terrain.getElevation(wt,Ui,Gi):null)}}}(T,d,w,_,w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),B),w.paint.get("icon-opacity").constantOr(1)!==0&&ul(d,_,w,T,!1,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),w.layout.get("icon-rotation-alignment"),w.layout.get("icon-pitch-alignment"),w.layout.get("icon-keep-upright"),j,X),w.paint.get("text-opacity").constantOr(1)!==0&&ul(d,_,w,T,!0,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),w.layout.get("text-keep-upright"),j,X),_.map.showCollisionBoxes&&(Mr(d,_,w,T,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),!0),Mr(d,_,w,T,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),!1))})(s,i,r,l,this.style.placement.variableOffsets);break;case"circle":(function(d,_,w,T){if(d.renderPass!=="translucent")return;const B=w.paint.get("circle-opacity"),j=w.paint.get("circle-stroke-width"),X=w.paint.get("circle-stroke-opacity"),ue=!w.layout.get("circle-sort-key").isConstant();if(B.constantOr(1)===0&&(j.constantOr(1)===0||X.constantOr(1)===0))return;const Se=d.context,Te=Se.gl,Re=d.depthModeForSublayer(0,qn.ReadOnly),Be=ns.disabled,et=d.colorModeForRenderPass(),vt=[];for(let ot=0;ot<T.length;ot++){const ht=T[ot],Et=_.getTile(ht),wt=Et.getBucket(w);if(!wt)continue;const si=wt.programConfigurations.get(w.id),Kt=d.useProgram("circle",si),ii=wt.layoutVertexBuffer,ai=wt.indexBuffer,Zi=d.style.map.terrain&&d.style.map.terrain.getTerrainData(ht),Qi={programConfiguration:si,program:Kt,layoutVertexBuffer:ii,indexBuffer:ai,uniformValues:no(d,ht,Et,w),terrainData:Zi};if(ue){const Si=wt.segments.get();for(const Ui of Si)vt.push({segments:new a.$([Ui]),sortKey:Ui.sortKey,state:Qi})}else vt.push({segments:wt.segments,sortKey:0,state:Qi})}ue&&vt.sort((ot,ht)=>ot.sortKey-ht.sortKey);for(const ot of vt){const{programConfiguration:ht,program:Et,layoutVertexBuffer:wt,indexBuffer:si,uniformValues:Kt,terrainData:ii}=ot.state;Et.draw(Se,Te.TRIANGLES,Re,Be,et,Zr.disabled,Kt,ii,w.id,wt,si,ot.segments,w.paint,d.transform.zoom,ht)}})(s,i,r,l);break;case"heatmap":(function(d,_,w,T){if(w.paint.get("heatmap-opacity")!==0)if(d.renderPass==="offscreen"){const B=d.context,j=B.gl,X=ns.disabled,ue=new fr([j.ONE,j.ONE],a.aO.transparent,[!0,!0,!0,!0]);(function(Se,Te,Re){const Be=Se.gl;Se.activeTexture.set(Be.TEXTURE1),Se.viewport.set([0,0,Te.width/4,Te.height/4]);let et=Re.heatmapFbo;if(et)Be.bindTexture(Be.TEXTURE_2D,et.colorAttachment.get()),Se.bindFramebuffer.set(et.framebuffer);else{const vt=Be.createTexture();Be.bindTexture(Be.TEXTURE_2D,vt),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_WRAP_S,Be.CLAMP_TO_EDGE),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_WRAP_T,Be.CLAMP_TO_EDGE),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_MIN_FILTER,Be.LINEAR),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_MAG_FILTER,Be.LINEAR),et=Re.heatmapFbo=Se.createFramebuffer(Te.width/4,Te.height/4,!1,!1),function(ot,ht,Et,wt){var si,Kt;const ii=ot.gl,ai=(si=ot.HALF_FLOAT)!==null&&si!==void 0?si:ii.UNSIGNED_BYTE,Zi=(Kt=ot.RGBA16F)!==null&&Kt!==void 0?Kt:ii.RGBA;ii.texImage2D(ii.TEXTURE_2D,0,Zi,ht.width/4,ht.height/4,0,ii.RGBA,ai,null),wt.colorAttachment.set(Et)}(Se,Te,vt,et)}})(B,d,w),B.clear({color:a.aO.transparent});for(let Se=0;Se<T.length;Se++){const Te=T[Se];if(_.hasRenderableParent(Te))continue;const Re=_.getTile(Te),Be=Re.getBucket(w);if(!Be)continue;const et=Be.programConfigurations.get(w.id),vt=d.useProgram("heatmap",et),{zoom:ot}=d.transform;vt.draw(B,j.TRIANGLES,qn.disabled,X,ue,Zr.disabled,nt(Te.posMatrix,Re,ot,w.paint.get("heatmap-intensity")),null,w.id,Be.layoutVertexBuffer,Be.indexBuffer,Be.segments,w.paint,d.transform.zoom,et)}B.viewport.set([0,0,d.width,d.height])}else d.renderPass==="translucent"&&(d.context.setColorMode(d.colorModeForRenderPass()),function(B,j){const X=B.context,ue=X.gl,Se=j.heatmapFbo;if(!Se)return;X.activeTexture.set(ue.TEXTURE0),ue.bindTexture(ue.TEXTURE_2D,Se.colorAttachment.get()),X.activeTexture.set(ue.TEXTURE1);let Te=j.colorRampTexture;Te||(Te=j.colorRampTexture=new bt(X,j.colorRamp,ue.RGBA)),Te.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),B.useProgram("heatmapTexture").draw(X,ue.TRIANGLES,qn.disabled,ns.disabled,B.colorModeForRenderPass(),Zr.disabled,((Re,Be,et,vt)=>{const ot=a.F();a.aN(ot,0,Re.width,Re.height,0,0,1);const ht=Re.context.gl;return{u_matrix:ot,u_world:[ht.drawingBufferWidth,ht.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Be.paint.get("heatmap-opacity")}})(B,j),null,j.id,B.viewportBuffer,B.quadTriangleIndexBuffer,B.viewportSegments,j.paint,B.transform.zoom)}(d,w))})(s,i,r,l);break;case"line":(function(d,_,w,T){if(d.renderPass!=="translucent")return;const B=w.paint.get("line-opacity"),j=w.paint.get("line-width");if(B.constantOr(1)===0||j.constantOr(1)===0)return;const X=d.depthModeForSublayer(0,qn.ReadOnly),ue=d.colorModeForRenderPass(),Se=w.paint.get("line-dasharray"),Te=w.paint.get("line-pattern"),Re=Te.constantOr(1),Be=w.paint.get("line-gradient"),et=w.getCrossfadeParameters(),vt=Re?"linePattern":Se?"lineSDF":Be?"lineGradient":"line",ot=d.context,ht=ot.gl;let Et=!0;for(const wt of T){const si=_.getTile(wt);if(Re&&!si.patternsLoaded())continue;const Kt=si.getBucket(w);if(!Kt)continue;const ii=Kt.programConfigurations.get(w.id),ai=d.context.program.get(),Zi=d.useProgram(vt,ii),Qi=Et||Zi.program!==ai,Si=d.style.map.terrain&&d.style.map.terrain.getTerrainData(wt),Ui=Te.constantOr(null);if(Ui&&si.imageAtlas){const Bn=si.imageAtlas,en=Bn.patternPositions[Ui.to.toString()],kn=Bn.patternPositions[Ui.from.toString()];en&&kn&&ii.setConstantPatternPositions(en,kn)}const Gi=Si?wt:null,un=Re?Di(d,si,w,et,Gi):Se?hn(d,si,w,Se,et,Gi):Be?wi(d,si,w,Kt.lineClipsArray.length,Gi):$t(d,si,w,Gi);if(Re)ot.activeTexture.set(ht.TEXTURE0),si.imageAtlasTexture.bind(ht.LINEAR,ht.CLAMP_TO_EDGE),ii.updatePaintBuffers(et);else if(Se&&(Qi||d.lineAtlas.dirty))ot.activeTexture.set(ht.TEXTURE0),d.lineAtlas.bind(ot);else if(Be){const Bn=Kt.gradients[w.id];let en=Bn.texture;if(w.gradientVersion!==Bn.version){let kn=256;if(w.stepInterpolant){const vr=_.getSource().maxzoom,er=wt.canonical.z===vr?Math.ceil(1<<d.transform.maxZoom-wt.canonical.z):1;kn=a.ac(a.aT(Kt.maxLineLength/a.W*1024*er),256,ot.maxTextureSize)}Bn.gradient=a.aU({expression:w.gradientExpression(),evaluationKey:"lineProgress",resolution:kn,image:Bn.gradient||void 0,clips:Kt.lineClipsArray}),Bn.texture?Bn.texture.update(Bn.gradient):Bn.texture=new bt(ot,Bn.gradient,ht.RGBA),Bn.version=w.gradientVersion,en=Bn.texture}ot.activeTexture.set(ht.TEXTURE0),en.bind(w.stepInterpolant?ht.NEAREST:ht.LINEAR,ht.CLAMP_TO_EDGE)}Zi.draw(ot,ht.TRIANGLES,X,d.stencilModeForClipping(wt),ue,Zr.disabled,un,Si,w.id,Kt.layoutVertexBuffer,Kt.indexBuffer,Kt.segments,w.paint,d.transform.zoom,ii,Kt.layoutVertexBuffer2),Et=!1}})(s,i,r,l);break;case"fill":(function(d,_,w,T){const B=w.paint.get("fill-color"),j=w.paint.get("fill-opacity");if(j.constantOr(1)===0)return;const X=d.colorModeForRenderPass(),ue=w.paint.get("fill-pattern"),Se=d.opaquePassEnabledForLayer()&&!ue.constantOr(1)&&B.constantOr(a.aO.transparent).a===1&&j.constantOr(0)===1?"opaque":"translucent";if(d.renderPass===Se){const Te=d.depthModeForSublayer(1,d.renderPass==="opaque"?qn.ReadWrite:qn.ReadOnly);Ia(d,_,w,T,Te,X,!1)}if(d.renderPass==="translucent"&&w.paint.get("fill-antialias")){const Te=d.depthModeForSublayer(w.getPaintProperty("fill-outline-color")?2:0,qn.ReadOnly);Ia(d,_,w,T,Te,X,!0)}})(s,i,r,l);break;case"fill-extrusion":(function(d,_,w,T){const B=w.paint.get("fill-extrusion-opacity");if(B!==0&&d.renderPass==="translucent"){const j=new qn(d.context.gl.LEQUAL,qn.ReadWrite,d.depthRangeFor3D);if(B!==1||w.paint.get("fill-extrusion-pattern").constantOr(1))Tl(d,_,w,T,j,ns.disabled,fr.disabled),Tl(d,_,w,T,j,d.stencilModeFor3D(),d.colorModeForRenderPass());else{const X=d.colorModeForRenderPass();Tl(d,_,w,T,j,ns.disabled,X)}}})(s,i,r,l);break;case"hillshade":(function(d,_,w,T){if(d.renderPass!=="offscreen"&&d.renderPass!=="translucent")return;const B=d.context,j=d.depthModeForSublayer(0,qn.ReadOnly),X=d.colorModeForRenderPass(),[ue,Se]=d.renderPass==="translucent"?d.stencilConfigForOverlap(T):[{},T];for(const Te of Se){const Re=_.getTile(Te);Re.needsHillshadePrepare!==void 0&&Re.needsHillshadePrepare&&d.renderPass==="offscreen"?kl(d,Re,w,j,ns.disabled,X):d.renderPass==="translucent"&&Do(d,Te,Re,w,j,ue[Te.overscaledZ],X)}B.viewport.set([0,0,d.width,d.height])})(s,i,r,l);break;case"raster":(function(d,_,w,T){if(d.renderPass!=="translucent"||w.paint.get("raster-opacity")===0||!T.length)return;const B=d.context,j=B.gl,X=_.getSource(),ue=d.useProgram("raster"),Se=d.colorModeForRenderPass(),[Te,Re]=X instanceof lr?[{},T]:d.stencilConfigForOverlap(T),Be=Re[Re.length-1].overscaledZ,et=!d.options.moving;for(const vt of Re){const ot=d.depthModeForSublayer(vt.overscaledZ-Be,w.paint.get("raster-opacity")===1?qn.ReadWrite:qn.ReadOnly,j.LESS),ht=_.getTile(vt);ht.registerFadeDuration(w.paint.get("raster-fade-duration"));const Et=_.findLoadedParent(vt,0),wt=go(ht,Et,_,w,d.transform,d.style.map.terrain);let si,Kt;const ii=w.paint.get("raster-resampling")==="nearest"?j.NEAREST:j.LINEAR;B.activeTexture.set(j.TEXTURE0),ht.texture.bind(ii,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),B.activeTexture.set(j.TEXTURE1),Et?(Et.texture.bind(ii,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),si=Math.pow(2,Et.tileID.overscaledZ-ht.tileID.overscaledZ),Kt=[ht.tileID.canonical.x*si%1,ht.tileID.canonical.y*si%1]):ht.texture.bind(ii,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST);const ai=d.style.map.terrain&&d.style.map.terrain.getTerrainData(vt),Zi=ai?vt:null,Qi=Zi?Zi.posMatrix:d.transform.calculatePosMatrix(vt.toUnwrapped(),et),Si=Ar(Qi,Kt||[0,0],si||1,wt,w);X instanceof lr?ue.draw(B,j.TRIANGLES,ot,ns.disabled,Se,Zr.disabled,Si,ai,w.id,X.boundsBuffer,d.quadTriangleIndexBuffer,X.boundsSegments):ue.draw(B,j.TRIANGLES,ot,Te[vt.overscaledZ],Se,Zr.disabled,Si,ai,w.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments)}})(s,i,r,l);break;case"background":(function(d,_,w,T){const B=w.paint.get("background-color"),j=w.paint.get("background-opacity");if(j===0)return;const X=d.context,ue=X.gl,Se=d.transform,Te=Se.tileSize,Re=w.paint.get("background-pattern");if(d.isPatternMissing(Re))return;const Be=!Re&&B.a===1&&j===1&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass!==Be)return;const et=ns.disabled,vt=d.depthModeForSublayer(0,Be==="opaque"?qn.ReadWrite:qn.ReadOnly),ot=d.colorModeForRenderPass(),ht=d.useProgram(Re?"backgroundPattern":"background"),Et=T||Se.coveringTiles({tileSize:Te,terrain:d.style.map.terrain});Re&&(X.activeTexture.set(ue.TEXTURE0),d.imageManager.bind(d.context));const wt=w.getCrossfadeParameters();for(const si of Et){const Kt=T?si.posMatrix:d.transform.calculatePosMatrix(si.toUnwrapped()),ii=Re?Gr(Kt,j,d,Re,{tileID:si,tileSize:Te},wt):pl(Kt,j,B),ai=d.style.map.terrain&&d.style.map.terrain.getTerrainData(si);ht.draw(X,ue.TRIANGLES,vt,et,ot,Zr.disabled,ii,ai,w.id,d.tileExtentBuffer,d.quadTriangleIndexBuffer,d.tileExtentSegments)}})(s,0,r,l);break;case"custom":(function(d,_,w){const T=d.context,B=w.implementation;if(d.renderPass==="offscreen"){const j=B.prerender;j&&(d.setCustomLayerDefaults(),T.setColorMode(d.colorModeForRenderPass()),j.call(B,T.gl,d.transform.customLayerMatrix()),T.setDirty(),d.setBaseState())}else if(d.renderPass==="translucent"){d.setCustomLayerDefaults(),T.setColorMode(d.colorModeForRenderPass()),T.setStencilMode(ns.disabled);const j=B.renderingMode==="3d"?new qn(d.context.gl.LEQUAL,qn.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,qn.ReadOnly);T.setDepthMode(j),B.render(T.gl,d.transform.customLayerMatrix()),T.setDirty(),d.setBaseState(),T.bindFramebuffer.set(null)}})(s,0,r)}}translatePosMatrix(s,i,r,l,d){if(!r[0]&&!r[1])return s;const _=d?l==="map"?this.transform.angle:0:l==="viewport"?-this.transform.angle:0;if(_){const B=Math.sin(_),j=Math.cos(_);r=[r[0]*j-r[1]*B,r[0]*B+r[1]*j]}const w=[d?r[0]:kt(i,r[0],this.transform.zoom),d?r[1]:kt(i,r[1],this.transform.zoom),0],T=new Float32Array(16);return a.H(T,s,w),T}saveTileTexture(s){const i=this._tileTextures[s.size[0]];i?i.push(s):this._tileTextures[s.size[0]]=[s]}getTileTexture(s){const i=this._tileTextures[s];return i&&i.length>0?i.pop():null}isPatternMissing(s){if(!s)return!1;if(!s.from||!s.to)return!0;const i=this.imageManager.getPattern(s.from.toString()),r=this.imageManager.getPattern(s.to.toString());return!i||!r}useProgram(s,i){this.cache=this.cache||{};const r=s+(i?i.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[r]||(this.cache[r]=new Ga(this.context,ca[s],i,ir[s],this._showOverdrawInspector,this.style.map.terrain)),this.cache[r]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new bt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:s,drawingBufferHeight:i}=this.context.gl;return this.width!==s||this.height!==i}}class Pa{constructor(s,i){this.points=s,this.planes=i}static fromInvProjectionMatrix(s,i,r){const l=Math.pow(2,r),d=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(w=>{const T=1/(w=a.af([],w,s))[3]/i*l;return a.a_(w,w,[T,T,1/w[3],T])}),_=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(w=>{const T=function(ue,Se){var Te=Se[0],Re=Se[1],Be=Se[2],et=Te*Te+Re*Re+Be*Be;return et>0&&(et=1/Math.sqrt(et)),ue[0]=Se[0]*et,ue[1]=Se[1]*et,ue[2]=Se[2]*et,ue}([],function(ue,Se,Te){var Re=Se[0],Be=Se[1],et=Se[2],vt=Te[0],ot=Te[1],ht=Te[2];return ue[0]=Be*ht-et*ot,ue[1]=et*vt-Re*ht,ue[2]=Re*ot-Be*vt,ue}([],_t([],d[w[0]],d[w[1]]),_t([],d[w[2]],d[w[1]]))),B=-((j=T)[0]*(X=d[w[1]])[0]+j[1]*X[1]+j[2]*X[2]);var j,X;return T.concat(B)});return new Pa(d,_)}}class Ka{constructor(s,i){this.min=s,this.max=i,this.center=function(r,l,d){return r[0]=.5*l[0],r[1]=.5*l[1],r[2]=.5*l[2],r}([],function(r,l,d){return r[0]=l[0]+d[0],r[1]=l[1]+d[1],r[2]=l[2]+d[2],r}([],this.min,this.max))}quadrant(s){const i=[s%2==0,s<2],r=jt(this.min),l=jt(this.max);for(let d=0;d<i.length;d++)r[d]=i[d]?this.min[d]:this.center[d],l[d]=i[d]?this.center[d]:this.max[d];return l[2]=this.max[2],new Ka(r,l)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}intersects(s){const i=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let r=!0;for(let l=0;l<s.planes.length;l++){const d=s.planes[l];let _=0;for(let w=0;w<i.length;w++)a.a$(d,i[w])>=0&&_++;if(_===0)return 0;_!==i.length&&(r=!1)}if(r)return 2;for(let l=0;l<3;l++){let d=Number.MAX_VALUE,_=-Number.MAX_VALUE;for(let w=0;w<s.points.length;w++){const T=s.points[w][l]-this.min[l];d=Math.min(d,T),_=Math.max(_,T)}if(_<0||d>this.max[l]-this.min[l])return 0}return 1}}class cl{constructor(s=0,i=0,r=0,l=0){if(isNaN(s)||s<0||isNaN(i)||i<0||isNaN(r)||r<0||isNaN(l)||l<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=i,this.left=r,this.right=l}interpolate(s,i,r){return i.top!=null&&s.top!=null&&(this.top=a.z.number(s.top,i.top,r)),i.bottom!=null&&s.bottom!=null&&(this.bottom=a.z.number(s.bottom,i.bottom,r)),i.left!=null&&s.left!=null&&(this.left=a.z.number(s.left,i.left,r)),i.right!=null&&s.right!=null&&(this.right=a.z.number(s.right,i.right,r)),this}getCenter(s,i){const r=a.ac((this.left+s-this.right)/2,0,s),l=a.ac((this.top+i-this.bottom)/2,0,i);return new a.P(r,l)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new cl(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class lu{constructor(s,i,r,l,d){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=d===void 0||!!d,this._minZoom=s||0,this._maxZoom=i||22,this._minPitch=r??0,this._maxPitch=l??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new cl,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const s=new lu(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return s.apply(this),s}apply(s){this.tileSize=s.tileSize,this.latRange=s.latRange,this.width=s.width,this.height=s.height,this._center=s._center,this._elevation=s._elevation,this.minElevationForCurrentTile=s.minElevationForCurrentTile,this.zoom=s.zoom,this.angle=s.angle,this._fov=s._fov,this._pitch=s._pitch,this._unmodified=s._unmodified,this._edgeInsets=s._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(s){const i=-a.b0(s,-180,180)*Math.PI/180;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=function(){var r=new a.A(4);return a.A!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r}(),function(r,l,d){var _=l[0],w=l[1],T=l[2],B=l[3],j=Math.sin(d),X=Math.cos(d);r[0]=_*X+T*j,r[1]=w*X+B*j,r[2]=_*-j+T*X,r[3]=w*-j+B*X}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const i=a.ac(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=s/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(s){const i=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==i&&(this._unmodified=!1,this._zoom=i,this.tileZoom=Math.max(0,Math.floor(i)),this.scale=this.zoomScale(i),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(s){s!==this._elevation&&(this._elevation=s,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,i,r){this._unmodified=!1,this._edgeInsets.interpolate(s,i,r),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const i=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,i)}getVisibleUnwrappedCoordinates(s){const i=[new a.b1(0,s)];if(this._renderWorldCopies){const r=this.pointCoordinate(new a.P(0,0)),l=this.pointCoordinate(new a.P(this.width,0)),d=this.pointCoordinate(new a.P(this.width,this.height)),_=this.pointCoordinate(new a.P(0,this.height)),w=Math.floor(Math.min(r.x,l.x,d.x,_.x)),T=Math.floor(Math.max(r.x,l.x,d.x,_.x)),B=1;for(let j=w-B;j<=T+B;j++)j!==0&&i.push(new a.b1(j,s))}return i}coveringTiles(s){var i,r;let l=this.coveringZoomLevel(s);const d=l;if(s.minzoom!==void 0&&l<s.minzoom)return[];s.maxzoom!==void 0&&l>s.maxzoom&&(l=s.maxzoom);const _=this.pointCoordinate(this.getCameraPoint()),w=a.Y.fromLngLat(this.center),T=Math.pow(2,l),B=[T*_.x,T*_.y,0],j=[T*w.x,T*w.y,0],X=Pa.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l);let ue=s.minzoom||0;!s.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(ue=l);const Se=s.terrain?2/Math.min(this.tileSize,s.tileSize)*this.tileSize:3,Te=ot=>({aabb:new Ka([ot*T,0,0],[(ot+1)*T,T,0]),zoom:0,x:0,y:0,wrap:ot,fullyVisible:!1}),Re=[],Be=[],et=l,vt=s.reparseOverscaled?d:l;if(this._renderWorldCopies)for(let ot=1;ot<=3;ot++)Re.push(Te(-ot)),Re.push(Te(ot));for(Re.push(Te(0));Re.length>0;){const ot=Re.pop(),ht=ot.x,Et=ot.y;let wt=ot.fullyVisible;if(!wt){const Zi=ot.aabb.intersects(X);if(Zi===0)continue;wt=Zi===2}const si=s.terrain?B:j,Kt=ot.aabb.distanceX(si),ii=ot.aabb.distanceY(si),ai=Math.max(Math.abs(Kt),Math.abs(ii));if(ot.zoom===et||ai>Se+(1<<et-ot.zoom)-2&&ot.zoom>=ue){const Zi=et-ot.zoom,Qi=B[0]-.5-(ht<<Zi),Si=B[1]-.5-(Et<<Zi);Be.push({tileID:new a.Q(ot.zoom===et?vt:ot.zoom,ot.wrap,ot.zoom,ht,Et),distanceSq:mt([j[0]-.5-ht,j[1]-.5-Et]),tileDistanceToCamera:Math.sqrt(Qi*Qi+Si*Si)})}else for(let Zi=0;Zi<4;Zi++){const Qi=(ht<<1)+Zi%2,Si=(Et<<1)+(Zi>>1),Ui=ot.zoom+1;let Gi=ot.aabb.quadrant(Zi);if(s.terrain){const un=new a.Q(Ui,ot.wrap,Ui,Qi,Si),Bn=s.terrain.getMinMaxElevation(un),en=(i=Bn.minElevation)!==null&&i!==void 0?i:this.elevation,kn=(r=Bn.maxElevation)!==null&&r!==void 0?r:this.elevation;Gi=new Ka([Gi.min[0],Gi.min[1],en],[Gi.max[0],Gi.max[1],kn])}Re.push({aabb:Gi,zoom:Ui,x:Qi,y:Si,wrap:ot.wrap,fullyVisible:wt})}}return Be.sort((ot,ht)=>ot.distanceSq-ht.distanceSq).map(ot=>ot.tileID)}resize(s,i){this.width=s,this.height=i,this.pixelsToGLUnits=[2/s,-2/i],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){const i=a.ac(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.P(a.N(s.lng)*this.worldSize,a.O(i)*this.worldSize)}unproject(s){return new a.Y(s.x/this.worldSize,s.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(s){const i=this.pointLocation(this.centerPoint,s),r=s.getElevationForLngLatZoom(i,this.tileZoom);if(!(this.elevation-r))return;const l=this.getCameraPosition(),d=a.Y.fromLngLat(l.lngLat,l.altitude),_=a.Y.fromLngLat(i,r),w=d.x-_.x,T=d.y-_.y,B=d.z-_.z,j=Math.sqrt(w*w+T*T+B*B),X=this.scaleZoom(this.cameraToCenterDistance/j/this.tileSize);this._elevation=r,this._center=i,this.zoom=X}setLocationAtPoint(s,i){const r=this.pointCoordinate(i),l=this.pointCoordinate(this.centerPoint),d=this.locationCoordinate(s),_=new a.Y(d.x-(r.x-l.x),d.y-(r.y-l.y));this.center=this.coordinateLocation(_),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(s,i){return i?this.coordinatePoint(this.locationCoordinate(s),i.getElevationForLngLatZoom(s,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(s))}pointLocation(s,i){return this.coordinateLocation(this.pointCoordinate(s,i))}locationCoordinate(s){return a.Y.fromLngLat(s)}coordinateLocation(s){return s&&s.toLngLat()}pointCoordinate(s,i){if(i){const ue=i.pointCoordinate(s);if(ue!=null)return ue}const r=[s.x,s.y,0,1],l=[s.x,s.y,1,1];a.af(r,r,this.pixelMatrixInverse),a.af(l,l,this.pixelMatrixInverse);const d=r[3],_=l[3],w=r[1]/d,T=l[1]/_,B=r[2]/d,j=l[2]/_,X=B===j?0:(0-B)/(j-B);return new a.Y(a.z.number(r[0]/d,l[0]/_,X)/this.worldSize,a.z.number(w,T,X)/this.worldSize)}coordinatePoint(s,i=0,r=this.pixelMatrix){const l=[s.x*this.worldSize,s.y*this.worldSize,i,1];return a.af(l,l,r),new a.P(l[0]/l[3],l[1]/l[3])}getBounds(){const s=Math.max(0,this.height/2-this.getHorizon());return new Yt().extend(this.pointLocation(new a.P(0,s))).extend(this.pointLocation(new a.P(this.width,s))).extend(this.pointLocation(new a.P(this.width,this.height))).extend(this.pointLocation(new a.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Yt([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(s,i=!1){const r=s.key,l=i?this._alignedPosMatrixCache:this._posMatrixCache;if(l[r])return l[r];const d=s.canonical,_=this.worldSize/this.zoomScale(d.z),w=d.x+Math.pow(2,d.z)*s.wrap,T=a.an(new Float64Array(16));return a.H(T,T,[w*_,d.y*_,0]),a.J(T,T,[_/a.W,_/a.W,1]),a.K(T,i?this.alignedProjMatrix:this.projMatrix,T),l[r]=new Float32Array(T),l[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;let s=this.lngRange;if(!this._renderWorldCopies&&s===null){const Te=179.9999999999;s=[-Te,Te]}this._constraining=!0;let i,r,l,d,_=-90,w=90,T=-180,B=180;const j=this.size,X=this._unmodified;if(this.latRange){const Te=this.latRange;_=a.O(Te[1])*this.worldSize,w=a.O(Te[0])*this.worldSize,i=w-_<j.y?j.y/(w-_):0}s&&(T=a.b0(a.N(s[0])*this.worldSize,0,this.worldSize),B=a.b0(a.N(s[1])*this.worldSize,0,this.worldSize),B<T&&(B+=this.worldSize),r=B-T<j.x?j.x/(B-T):0);const ue=this.point,Se=Math.max(r||0,i||0);if(Se)return this.center=this.unproject(new a.P(r?(B+T)/2:ue.x,i?(w+_)/2:ue.y)),this.zoom+=this.scaleZoom(Se),this._unmodified=X,void(this._constraining=!1);if(this.latRange){const Te=ue.y,Re=j.y/2;Te-Re<_&&(d=_+Re),Te+Re>w&&(d=w-Re)}if(s){const Te=(T+B)/2;let Re=ue.x;this._renderWorldCopies&&(Re=a.b0(ue.x,Te-this.worldSize/2,Te+this.worldSize/2));const Be=j.x/2;Re-Be<T&&(l=T+Be),Re+Be>B&&(l=B-Be)}l===void 0&&d===void 0||(this.center=this.unproject(new a.P(l!==void 0?l:ue.x,d!==void 0?d:ue.y)).wrap()),this._unmodified=X,this._constraining=!1}_calcMatrices(){if(!this.height)return;const s=this.centerOffset,i=this.point.x,r=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=a.b2(1,this.center.lat)*this.worldSize;let l=a.an(new Float64Array(16));a.J(l,l,[this.width/2,-this.height/2,1]),a.H(l,l,[1,-1,0]),this.labelPlaneMatrix=l,l=a.an(new Float64Array(16)),a.J(l,l,[1,-1,1]),a.H(l,l,[-1,-1,0]),a.J(l,l,[2/this.width,2/this.height,1]),this.glCoordMatrix=l;const d=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),_=Math.min(this.elevation,this.minElevationForCurrentTile),w=d-_*this._pixelPerMeter/Math.cos(this._pitch),T=_<0?w:d,B=Math.PI/2+this._pitch,j=this._fov*(.5+s.y/this.height),X=Math.sin(j)*T/Math.sin(a.ac(Math.PI-B-j,.01,Math.PI-.01)),ue=this.getHorizon(),Se=2*Math.atan(ue/this.cameraToCenterDistance)*(.5+s.y/(2*ue)),Te=Math.sin(Se)*T/Math.sin(a.ac(Math.PI-B-Se,.01,Math.PI-.01)),Re=Math.min(X,Te),Be=1.01*(Math.cos(Math.PI/2-this._pitch)*Re+T),et=this.height/50;l=new Float64Array(16),a.b3(l,this._fov,this.width/this.height,et,Be),l[8]=2*-s.x/this.width,l[9]=2*s.y/this.height,a.J(l,l,[1,-1,1]),a.H(l,l,[0,0,-this.cameraToCenterDistance]),a.b4(l,l,this._pitch),a.ad(l,l,this.angle),a.H(l,l,[-i,-r,0]),this.mercatorMatrix=a.J([],l,[this.worldSize,this.worldSize,this.worldSize]),a.J(l,l,[1,1,this._pixelPerMeter]),this.pixelMatrix=a.K(new Float64Array(16),this.labelPlaneMatrix,l),a.H(l,l,[0,0,-this.elevation]),this.projMatrix=l,this.invProjMatrix=a.ar([],l),this.pixelMatrix3D=a.K(new Float64Array(16),this.labelPlaneMatrix,l);const vt=this.width%2/2,ot=this.height%2/2,ht=Math.cos(this.angle),Et=Math.sin(this.angle),wt=i-Math.round(i)+ht*vt+Et*ot,si=r-Math.round(r)+ht*ot+Et*vt,Kt=new Float64Array(l);if(a.H(Kt,Kt,[wt>.5?wt-1:wt,si>.5?si-1:si,0]),this.alignedProjMatrix=Kt,l=a.ar(new Float64Array(16),this.pixelMatrix),!l)throw new Error("failed to invert matrix");this.pixelMatrixInverse=l,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const s=this.pointCoordinate(new a.P(0,0)),i=[s.x*this.worldSize,s.y*this.worldSize,0,1];return a.af(i,i,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,s))}getCameraQueryGeometry(s){const i=this.getCameraPoint();if(s.length===1)return[s[0],i];{let r=i.x,l=i.y,d=i.x,_=i.y;for(const w of s)r=Math.min(r,w.x),l=Math.min(l,w.y),d=Math.max(d,w.x),_=Math.max(_,w.y);return[new a.P(r,l),new a.P(d,l),new a.P(d,_),new a.P(r,_),new a.P(r,l)]}}lngLatToCameraDepth(s,i){const r=this.locationCoordinate(s),l=[r.x*this.worldSize,r.y*this.worldSize,i,1];return a.af(l,l,this.projMatrix),l[2]/l[3]}}function gl(y,s){let i,r=!1,l=null,d=null;const _=()=>{l=null,r&&(y.apply(d,i),l=setTimeout(_,s),r=!1)};return(...w)=>(r=!0,d=this,i=w,l||_(),l)}class ao{constructor(s){this._getCurrentHash=()=>{const i=window.location.hash.replace("#","");if(this._hashName){let r;return i.split("&").map(l=>l.split("=")).forEach(l=>{l[0]===this._hashName&&(r=l)}),(r&&r[1]||"").split("/")}return i.split("/")},this._onHashChange=()=>{const i=this._getCurrentHash();if(i.length>=3&&!i.some(r=>isNaN(r))){const r=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(i[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+i[2],+i[1]],zoom:+i[0],bearing:r,pitch:+(i[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const i=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,i)}catch{}},this._updateHash=gl(this._updateHashUnthrottled,300),this._hashName=s&&encodeURIComponent(s)}addTo(s){return this._map=s,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(s){const i=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,l=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),d=Math.pow(10,l),_=Math.round(i.lng*d)/d,w=Math.round(i.lat*d)/d,T=this._map.getBearing(),B=this._map.getPitch();let j="";if(j+=s?`/${_}/${w}/${r}`:`${r}/${w}/${_}`,(T||B)&&(j+="/"+Math.round(10*T)/10),B&&(j+=`/${Math.round(B)}`),this._hashName){const X=this._hashName;let ue=!1;const Se=window.location.hash.slice(1).split("&").map(Te=>{const Re=Te.split("=")[0];return Re===X?(ue=!0,`${Re}=${j}`):Te}).filter(Te=>Te);return ue||Se.push(`${X}=${j}`),`#${Se.join("&")}`}return`#${j}`}}const pi={linearity:.3,easing:a.b5(0,0,.3,1)},Vi=a.e({deceleration:2500,maxSpeed:1400},pi),Pi=a.e({deceleration:20,maxSpeed:1400},pi),Ft=a.e({deceleration:1e3,maxSpeed:360},pi),ni=a.e({deceleration:1e3,maxSpeed:90},pi);class xi{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:ae.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,i=ae.now();for(;s.length>0&&i-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const i={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:d}of this._inertiaBuffer)i.zoom+=d.zoomDelta||0,i.bearing+=d.bearingDelta||0,i.pitch+=d.pitchDelta||0,d.panDelta&&i.pan._add(d.panDelta),d.around&&(i.around=d.around),d.pinchAround&&(i.pinchAround=d.pinchAround);const r=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,l={};if(i.pan.mag()){const d=Ln(i.pan.mag(),r,a.e({},Vi,s||{}));l.offset=i.pan.mult(d.amount/i.pan.mag()),l.center=this._map.transform.center,Fi(l,d)}if(i.zoom){const d=Ln(i.zoom,r,Pi);l.zoom=this._map.transform.zoom+d.amount,Fi(l,d)}if(i.bearing){const d=Ln(i.bearing,r,Ft);l.bearing=this._map.transform.bearing+a.ac(d.amount,-179,179),Fi(l,d)}if(i.pitch){const d=Ln(i.pitch,r,ni);l.pitch=this._map.transform.pitch+d.amount,Fi(l,d)}if(l.zoom||l.bearing){const d=i.pinchAround===void 0?i.around:i.pinchAround;l.around=d?this._map.unproject(d):this._map.getCenter()}return this.clear(),a.e(l,{noMoveStart:!0})}}function Fi(y,s){(!y.duration||y.duration<s.duration)&&(y.duration=s.duration,y.easing=s.easing)}function Ln(y,s,i){const{maxSpeed:r,linearity:l,deceleration:d}=i,_=a.ac(y*l/(s/1e3),-r,r),w=Math.abs(_)/(d*l);return{easing:i.easing,duration:1e3*w,amount:_*(w/2)}}class jn extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,i,r,l={}){const d=ce.mousePos(i.getCanvas(),r),_=i.unproject(d);super(s,a.e({point:d,lngLat:_,originalEvent:r},l)),this._defaultPrevented=!1,this.target=i}}class or extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,i,r){const l=s==="touchend"?r.changedTouches:r.touches,d=ce.touchPos(i.getCanvasContainer(),l),_=d.map(T=>i.unproject(T)),w=d.reduce((T,B,j,X)=>T.add(B.div(X.length)),new a.P(0,0));super(s,{points:d,point:w,lngLats:_,lngLat:i.unproject(w),originalEvent:r}),this._defaultPrevented=!1}}class Xn extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,i,r){super(s,{originalEvent:r}),this._defaultPrevented=!1}}class Hs{constructor(s,i){this._map=s,this._clickTolerance=i.clickTolerance}reset(){delete this._mousedownPos}wheel(s){return this._firePreventable(new Xn(s.type,this._map,s))}mousedown(s,i){return this._mousedownPos=i,this._firePreventable(new jn(s.type,this._map,s))}mouseup(s){this._map.fire(new jn(s.type,this._map,s))}click(s,i){this._mousedownPos&&this._mousedownPos.dist(i)>=this._clickTolerance||this._map.fire(new jn(s.type,this._map,s))}dblclick(s){return this._firePreventable(new jn(s.type,this._map,s))}mouseover(s){this._map.fire(new jn(s.type,this._map,s))}mouseout(s){this._map.fire(new jn(s.type,this._map,s))}touchstart(s){return this._firePreventable(new or(s.type,this._map,s))}touchmove(s){this._map.fire(new or(s.type,this._map,s))}touchend(s){this._map.fire(new or(s.type,this._map,s))}touchcancel(s){this._map.fire(new or(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ps{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(s){this._map.fire(new jn(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new jn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._ignoreContextMenu||this._map.fire(new jn(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ps{constructor(s){this._map=s}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(s){return this.transform.pointLocation(a.P.convert(s),this._map.terrain)}}class Ja{constructor(s,i){this._map=s,this._tr=new ps(s),this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=i.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,i){this.isEnabled()&&s.shiftKey&&s.button===0&&(ce.disableDrag(),this._startPos=this._lastPos=i,this._active=!0)}mousemoveWindow(s,i){if(!this._active)return;const r=i;if(this._lastPos.equals(r)||!this._box&&r.dist(this._startPos)<this._clickTolerance)return;const l=this._startPos;this._lastPos=r,this._box||(this._box=ce.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",s));const d=Math.min(l.x,r.x),_=Math.max(l.x,r.x),w=Math.min(l.y,r.y),T=Math.max(l.y,r.y);ce.setTransform(this._box,`translate(${d}px,${w}px)`),this._box.style.width=_-d+"px",this._box.style.height=T-w+"px"}mouseupWindow(s,i){if(!this._active||s.button!==0)return;const r=this._startPos,l=i;if(this.reset(),ce.suppressClick(),r.x!==l.x||r.y!==l.y)return this._map.fire(new a.k("boxzoomend",{originalEvent:s})),{cameraAnimation:d=>d.fitScreenCoordinates(r,l,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",s)}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(ce.remove(this._box),this._box=null),ce.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(s,i){return this._map.fire(new a.k(s,{originalEvent:i}))}}function yo(y,s){if(y.length!==s.length)throw new Error(`The number of touches and points are not equal - touches ${y.length}, points ${s.length}`);const i={};for(let r=0;r<y.length;r++)i[y[r].identifier]=s[r];return i}class os{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(s,i,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=s.timeStamp),r.length===this.numTouches&&(this.centroid=function(l){const d=new a.P(0,0);for(const _ of l)d._add(_);return d.div(l.length)}(i),this.touches=yo(r,i)))}touchmove(s,i,r){if(this.aborted||!this.centroid)return;const l=yo(r,i);for(const d in this.touches){const _=l[d];(!_||_.dist(this.touches[d])>30)&&(this.aborted=!0)}}touchend(s,i,r){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),r.length===0){const l=!this.aborted&&this.centroid;if(this.reset(),l)return l}}}class $u{constructor(s){this.singleTap=new os(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(s,i,r){this.singleTap.touchstart(s,i,r)}touchmove(s,i,r){this.singleTap.touchmove(s,i,r)}touchend(s,i,r){const l=this.singleTap.touchend(s,i,r);if(l){const d=s.timeStamp-this.lastTime<500,_=!this.lastTap||this.lastTap.dist(l)<30;if(d&&_||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=l,this.count===this.numTaps)return this.reset(),l}}}class Fu{constructor(s){this._tr=new ps(s),this._zoomIn=new $u({numTouches:1,numTaps:2}),this._zoomOut=new $u({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,i,r){this._zoomIn.touchstart(s,i,r),this._zoomOut.touchstart(s,i,r)}touchmove(s,i,r){this._zoomIn.touchmove(s,i,r),this._zoomOut.touchmove(s,i,r)}touchend(s,i,r){const l=this._zoomIn.touchend(s,i,r),d=this._zoomOut.touchend(s,i,r),_=this._tr;return l?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:_.zoom+1,around:_.unproject(l)},{originalEvent:s})}):d?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:_.zoom-1,around:_.unproject(d)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class vo{constructor(s){this._enabled=!!s.enable,this._moveStateManager=s.moveStateManager,this._clickTolerance=s.clickTolerance||1,this._moveFunction=s.move,this._activateOnStart=!!s.activateOnStart,s.assignEvents(this),this.reset()}reset(s){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(s)}_move(...s){const i=this._moveFunction(...s);if(i.bearingDelta||i.pitchDelta||i.around||i.panDelta)return this._active=!0,i}dragStart(s,i){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(s)&&(this._moveStateManager.startMove(s),this._lastPoint=i.length?i[0]:i,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(s,i){if(!this.isEnabled())return;const r=this._lastPoint;if(!r)return;if(s.preventDefault(),!this._moveStateManager.isValidMoveEvent(s))return void this.reset(s);const l=i.length?i[0]:i;return!this._moved&&l.dist(r)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=l,this._move(r,l))}dragEnd(s){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(s)&&(this._moved&&ce.suppressClick(),this.reset(s))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ml={0:1,2:2};class Pn{constructor(s){this._correctEvent=s.checkCorrectEvent}startMove(s){const i=ce.mouseButton(s);this._eventButton=i}endMove(s){delete this._eventButton}isValidStartEvent(s){return this._correctEvent(s)}isValidMoveEvent(s){return!function(i,r){const l=Ml[r];return i.buttons===void 0||(i.buttons&l)!==l}(s,this._eventButton)}isValidEndEvent(s){return ce.mouseButton(s)===this._eventButton}}class Da{constructor(){this._firstTouch=void 0}_isOneFingerTouch(s){return s.targetTouches.length===1}_isSameTouchEvent(s){return s.targetTouches[0].identifier===this._firstTouch}startMove(s){this._firstTouch=s.targetTouches[0].identifier}endMove(s){delete this._firstTouch}isValidStartEvent(s){return this._isOneFingerTouch(s)}isValidMoveEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}isValidEndEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}}const In=y=>{y.mousedown=y.dragStart,y.mousemoveWindow=y.dragMove,y.mouseup=y.dragEnd,y.contextmenu=function(s){s.preventDefault()}},No=({enable:y,clickTolerance:s,bearingDegreesPerPixelMoved:i=.8})=>{const r=new Pn({checkCorrectEvent:l=>ce.mouseButton(l)===0&&l.ctrlKey||ce.mouseButton(l)===2});return new vo({clickTolerance:s,move:(l,d)=>({bearingDelta:(d.x-l.x)*i}),moveStateManager:r,enable:y,assignEvents:In})},Nl=({enable:y,clickTolerance:s,pitchDegreesPerPixelMoved:i=-.5})=>{const r=new Pn({checkCorrectEvent:l=>ce.mouseButton(l)===0&&l.ctrlKey||ce.mouseButton(l)===2});return new vo({clickTolerance:s,move:(l,d)=>({pitchDelta:(d.y-l.y)*i}),moveStateManager:r,enable:y,assignEvents:In})};class En{constructor(s,i){this._clickTolerance=s.clickTolerance||1,this._map=i,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(s,i,r){return this._calculateTransform(s,i,r)}touchmove(s,i,r){if(this._active&&!(r.length<this.minTouchs()))return s.preventDefault(),this._calculateTransform(s,i,r)}touchend(s,i,r){this._calculateTransform(s,i,r),this._active&&r.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,i,r){r.length>0&&(this._active=!0);const l=yo(r,i),d=new a.P(0,0),_=new a.P(0,0);let w=0;for(const B in l){const j=l[B],X=this._touches[B];X&&(d._add(j),_._add(j.sub(X)),w++,l[B]=j)}if(this._touches=l,w<this.minTouchs()||!_.mag())return;const T=_.div(w);return this._sum._add(T),this._sum.mag()<this._clickTolerance?void 0:{around:d.div(w),panDelta:T}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $l{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(s,i,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([i[0],i[1]]))}touchmove(s,i,r){if(!this._firstTwoTouches)return;s.preventDefault();const[l,d]=this._firstTwoTouches,_=Cn(r,i,l),w=Cn(r,i,d);if(!_||!w)return;const T=this._aroundCenter?null:_.add(w).div(2);return this._move([_,w],T,s)}touchend(s,i,r){if(!this._firstTwoTouches)return;const[l,d]=this._firstTwoTouches,_=Cn(r,i,l),w=Cn(r,i,d);_&&w||(this._active&&ce.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Cn(y,s,i){for(let r=0;r<y.length;r++)if(y[r].identifier===i)return s[r]}function _l(y,s){return Math.log(y/s)/Math.LN2}class uu extends $l{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,i){const r=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(_l(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:_l(this._distance,r),pinchAround:i}}}function Ou(y,s){return 180*y.angleWith(s)/Math.PI}class Vl extends $l{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,i,r){const l=this._vector;if(this._vector=s[0].sub(s[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ou(this._vector,l),pinchAround:i}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const i=25/(Math.PI*this._minDiameter)*360,r=Ou(s,this._startVector);return Math.abs(r)<i}}function yl(y){return Math.abs(y.y)>Math.abs(y.x)}class ta extends $l{constructor(s){super(),this._currentTouchCount=0,this._map=s}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(s,i,r){super.touchstart(s,i,r),this._currentTouchCount=r.length}_start(s){this._lastPoints=s,yl(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,i,r){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const l=s[0].sub(this._lastPoints[0]),d=s[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(l,d,r.timeStamp),this._valid?(this._lastPoints=s,this._active=!0,{pitchDelta:(l.y+d.y)/2*-.5}):void 0}gestureBeginsVertically(s,i,r){if(this._valid!==void 0)return this._valid;const l=s.mag()>=2,d=i.mag()>=2;if(!l&&!d)return;if(!l||!d)return this._firstMove===void 0&&(this._firstMove=r),r-this._firstMove<100&&void 0;const _=s.y>0==i.y>0;return yl(s)&&yl(i)&&_}}const oc={panStep:100,bearingStep:15,pitchStep:10};class Xu{constructor(s){this._tr=new ps(s);const i=oc;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let i=0,r=0,l=0,d=0,_=0;switch(s.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:s.shiftKey?r=-1:(s.preventDefault(),d=-1);break;case 39:s.shiftKey?r=1:(s.preventDefault(),d=1);break;case 38:s.shiftKey?l=1:(s.preventDefault(),_=-1);break;case 40:s.shiftKey?l=-1:(s.preventDefault(),_=1);break;default:return}return this._rotationDisabled&&(r=0,l=0),{cameraAnimation:w=>{const T=this._tr;w.easeTo({duration:300,easeId:"keyboardHandler",easing:Xl,zoom:i?Math.round(T.zoom)+i*(s.shiftKey?2:1):T.zoom,bearing:T.bearing+r*this._bearingStep,pitch:T.pitch+l*this._pitchStep,offset:[-d*this._panStep,-_*this._panStep],center:T.center},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Xl(y){return y*(2-y)}const ms=4.000244140625;class _a{constructor(s,i){this._onTimeout=r=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)},this._map=s,this._tr=new ps(s),this._triggerRenderFrame=i,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(s){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!s[this._map.cooperativeGestures._bypassKey])return;let i=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const r=ae.now(),l=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,i!==0&&i%ms==0?this._type="wheel":i!==0&&Math.abs(i)<4?this._type="trackpad":l>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(l*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),s.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=s,this._delta-=i,this._active||this._start(s)),s.preventDefault()}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const i=ce.mousePos(this._map.getCanvas(),s),r=this._tr;this._around=i.y>r.transform.height/2-r.transform.getHorizon()?a.M.convert(this._aroundCenter?r.center:r.unproject(i)):a.M.convert(r.center),this._aroundPoint=r.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._tr.transform;if(this._delta!==0){const w=this._type==="wheel"&&Math.abs(this._delta)>ms?this._wheelZoomRate:this._defaultZoomRate;let T=2/(1+Math.exp(-Math.abs(this._delta*w)));this._delta<0&&T!==0&&(T=1/T);const B=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(B*T))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const i=typeof this._targetZoom=="number"?this._targetZoom:s.zoom,r=this._startZoom,l=this._easing;let d,_=!1;if(this._type==="wheel"&&r&&l){const w=Math.min((ae.now()-this._lastWheelEventTime)/200,1),T=l(w);d=a.z.number(r,i,T),w<1?this._frameId||(this._frameId=!0):_=!0}else d=i,_=!0;return this._active=!0,_&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!_,zoomDelta:d-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let i=a.b6;if(this._prevEase){const r=this._prevEase,l=(ae.now()-r.start)/r.duration,d=r.easing(l+.01)-r.easing(l),_=.27/Math.sqrt(d*d+1e-4)*.01,w=Math.sqrt(.0729-_*_);i=a.b5(_,w,.25,1)}return this._prevEase={start:ae.now(),duration:s,easing:i},i}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class el{constructor(s,i){this._clickZoom=s,this._tapZoom=i}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class _u{constructor(s){this._tr=new ps(s),this.reset()}reset(){this._active=!1}dblclick(s,i){return s.preventDefault(),{cameraAnimation:r=>{r.easeTo({duration:300,zoom:this._tr.zoom+(s.shiftKey?-1:1),around:this._tr.unproject(i)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Nu{constructor(){this._tap=new $u({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(s,i,r){if(!this._swipePoint)if(this._tapTime){const l=i[0],d=s.timeStamp-this._tapTime<500,_=this._tapPoint.dist(l)<30;d&&_?r.length>0&&(this._swipePoint=l,this._swipeTouch=r[0].identifier):this.reset()}else this._tap.touchstart(s,i,r)}touchmove(s,i,r){if(this._tapTime){if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;const l=i[0],d=l.y-this._swipePoint.y;return this._swipePoint=l,s.preventDefault(),this._active=!0,{zoomDelta:d/128}}}else this._tap.touchmove(s,i,r)}touchend(s,i,r){if(this._tapTime)this._swipePoint&&r.length===0&&this.reset();else{const l=this._tap.touchend(s,i,r);l&&(this._tapTime=s.timeStamp,this._tapPoint=l)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class cu{constructor(s,i,r){this._el=s,this._mousePan=i,this._touchPan=r}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Vu{constructor(s,i,r){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=i,this._mousePitch=r}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class yr{constructor(s,i,r,l){this._el=s,this._touchZoom=i,this._touchRotate=r,this._tapDragZoom=l,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class gs{constructor(s,i){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=s,this._options=i,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const s=this._map.getCanvasContainer();s.classList.add("maplibregl-cooperative-gestures"),this._container=ce.create("div","maplibregl-cooperative-gesture-screen",s);let i=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(i=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const r=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),l=document.createElement("div");l.className="maplibregl-desktop-message",l.textContent=i,this._container.appendChild(l);const d=document.createElement("div");d.className="maplibregl-mobile-message",d.textContent=r,this._container.appendChild(d),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(ce.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(s){this._onCooperativeGesture(s.touches.length===1)}wheel(s){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!s[this._bypassKey])}_onCooperativeGesture(s){this._enabled&&s&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const gn=y=>y.zoom||y.drag||y.pitch||y.rotate;class Zn extends a.k{}function Jn(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class tl{constructor(s,i){this.handleWindowEvent=l=>{this.handleEvent(l,`${l.type}Window`)},this.handleEvent=(l,d)=>{if(l.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const _=l.type==="renderFrame"?void 0:l,w={needsRenderFrame:!1},T={},B={},j=l.touches,X=j?this._getMapTouches(j):void 0,ue=X?ce.touchPos(this._map.getCanvas(),X):ce.mousePos(this._map.getCanvas(),l);for(const{handlerName:Re,handler:Be,allowed:et}of this._handlers){if(!Be.isEnabled())continue;let vt;this._blockedByActive(B,et,Re)?Be.reset():Be[d||l.type]&&(vt=Be[d||l.type](l,ue,X),this.mergeHandlerResult(w,T,vt,Re,_),vt&&vt.needsRenderFrame&&this._triggerRenderFrame()),(vt||Be.isActive())&&(B[Re]=Be)}const Se={};for(const Re in this._previousActiveHandlers)B[Re]||(Se[Re]=_);this._previousActiveHandlers=B,(Object.keys(Se).length||Jn(w))&&(this._changes.push([w,T,Se]),this._triggerRenderFrame()),(Object.keys(B).length||Jn(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Te}=w;Te&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Te(this._map))},this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new xi(s),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(i);const r=this._el;this._listeners=[[r,"touchstart",{passive:!0}],[r,"touchmove",{passive:!1}],[r,"touchend",void 0],[r,"touchcancel",void 0],[r,"mousedown",void 0],[r,"mousemove",void 0],[r,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[r,"mouseover",void 0],[r,"mouseout",void 0],[r,"dblclick",void 0],[r,"click",void 0],[r,"keydown",{capture:!1}],[r,"keyup",void 0],[r,"wheel",{passive:!1}],[r,"contextmenu",void 0],[window,"blur",void 0]];for(const[l,d,_]of this._listeners)ce.addEventListener(l,d,l===document?this.handleWindowEvent:this.handleEvent,_)}destroy(){for(const[s,i,r]of this._listeners)ce.removeEventListener(s,i,s===document?this.handleWindowEvent:this.handleEvent,r)}_addDefaultHandlers(s){const i=this._map,r=i.getCanvasContainer();this._add("mapEvent",new Hs(i,s));const l=i.boxZoom=new Ja(i,s);this._add("boxZoom",l),s.interactive&&s.boxZoom&&l.enable();const d=i.cooperativeGestures=new gs(i,s.cooperativeGestures);this._add("cooperativeGestures",d),s.cooperativeGestures&&d.enable();const _=new Fu(i),w=new _u(i);i.doubleClickZoom=new el(w,_),this._add("tapZoom",_),this._add("clickZoom",w),s.interactive&&s.doubleClickZoom&&i.doubleClickZoom.enable();const T=new Nu;this._add("tapDragZoom",T);const B=i.touchPitch=new ta(i);this._add("touchPitch",B),s.interactive&&s.touchPitch&&i.touchPitch.enable(s.touchPitch);const j=No(s),X=Nl(s);i.dragRotate=new Vu(s,j,X),this._add("mouseRotate",j,["mousePitch"]),this._add("mousePitch",X,["mouseRotate"]),s.interactive&&s.dragRotate&&i.dragRotate.enable();const ue=(({enable:vt,clickTolerance:ot})=>{const ht=new Pn({checkCorrectEvent:Et=>ce.mouseButton(Et)===0&&!Et.ctrlKey});return new vo({clickTolerance:ot,move:(Et,wt)=>({around:wt,panDelta:wt.sub(Et)}),activateOnStart:!0,moveStateManager:ht,enable:vt,assignEvents:In})})(s),Se=new En(s,i);i.dragPan=new cu(r,ue,Se),this._add("mousePan",ue),this._add("touchPan",Se,["touchZoom","touchRotate"]),s.interactive&&s.dragPan&&i.dragPan.enable(s.dragPan);const Te=new Vl,Re=new uu;i.touchZoomRotate=new yr(r,Re,Te,T),this._add("touchRotate",Te,["touchPan","touchZoom"]),this._add("touchZoom",Re,["touchPan","touchRotate"]),s.interactive&&s.touchZoomRotate&&i.touchZoomRotate.enable(s.touchZoomRotate);const Be=i.scrollZoom=new _a(i,()=>this._triggerRenderFrame());this._add("scrollZoom",Be,["mousePan"]),s.interactive&&s.scrollZoom&&i.scrollZoom.enable(s.scrollZoom);const et=i.keyboard=new Xu(i);this._add("keyboard",et),s.interactive&&s.keyboard&&i.keyboard.enable(),this._add("blockableMapEvent",new Ps(i))}_add(s,i,r){this._handlers.push({handlerName:s,handler:i,allowed:r}),this._handlersById[s]=i}stop(s){if(!this._updatingCamera){for(const{handler:i}of this._handlers)i.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!gn(this._eventsInProgress)||this.isZooming()}_blockedByActive(s,i,r){for(const l in s)if(l!==r&&(!i||i.indexOf(l)<0))return!0;return!1}_getMapTouches(s){const i=[];for(const r of s)this._el.contains(r.target)&&i.push(r);return i}mergeHandlerResult(s,i,r,l,d){if(!r)return;a.e(s,r);const _={handlerName:l,originalEvent:r.originalEvent||d};r.zoomDelta!==void 0&&(i.zoom=_),r.panDelta!==void 0&&(i.drag=_),r.pitchDelta!==void 0&&(i.pitch=_),r.bearingDelta!==void 0&&(i.rotate=_)}_applyChanges(){const s={},i={},r={};for(const[l,d,_]of this._changes)l.panDelta&&(s.panDelta=(s.panDelta||new a.P(0,0))._add(l.panDelta)),l.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+l.zoomDelta),l.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+l.bearingDelta),l.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+l.pitchDelta),l.around!==void 0&&(s.around=l.around),l.pinchAround!==void 0&&(s.pinchAround=l.pinchAround),l.noInertia&&(s.noInertia=l.noInertia),a.e(i,d),a.e(r,_);this._updateMapTransform(s,i,r),this._changes=[]}_updateMapTransform(s,i,r){const l=this._map,d=l._getTransformForUpdate(),_=l.terrain;if(!(Jn(s)||_&&this._terrainMovement))return this._fireEvents(i,r,!0);let{panDelta:w,zoomDelta:T,bearingDelta:B,pitchDelta:j,around:X,pinchAround:ue}=s;ue!==void 0&&(X=ue),l._stop(!0),X=X||l.transform.centerPoint;const Se=d.pointLocation(w?X.sub(w):X);B&&(d.bearing+=B),j&&(d.pitch+=j),T&&(d.zoom+=T),_?this._terrainMovement||!i.drag&&!i.zoom?i.drag&&this._terrainMovement?d.center=d.pointLocation(d.centerPoint.sub(w)):d.setLocationAtPoint(Se,X):(this._terrainMovement=!0,this._map._elevationFreeze=!0,d.setLocationAtPoint(Se,X),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,d.recalculateZoom(l.terrain)})):d.setLocationAtPoint(Se,X),l._applyUpdatedTransform(d),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(i,r,!0)}_fireEvents(s,i,r){const l=gn(this._eventsInProgress),d=gn(s),_={};for(const j in s){const{originalEvent:X}=s[j];this._eventsInProgress[j]||(_[`${j}start`]=X),this._eventsInProgress[j]=s[j]}!l&&d&&this._fireEvent("movestart",d.originalEvent);for(const j in _)this._fireEvent(j,_[j]);d&&this._fireEvent("move",d.originalEvent);for(const j in s){const{originalEvent:X}=s[j];this._fireEvent(j,X)}const w={};let T;for(const j in this._eventsInProgress){const{handlerName:X,originalEvent:ue}=this._eventsInProgress[j];this._handlersById[X].isActive()||(delete this._eventsInProgress[j],T=i[X]||ue,w[`${j}end`]=T)}for(const j in w)this._fireEvent(j,w[j]);const B=gn(this._eventsInProgress);if(r&&(l||d)&&!B){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),X=ue=>ue!==0&&-this._bearingSnap<ue&&ue<this._bearingSnap;!j||!j.essential&&ae.prefersReducedMotion?(this._map.fire(new a.k("moveend",{originalEvent:T})),X(this._map.getBearing())&&this._map.resetNorth()):(X(j.bearing||this._map.getBearing())&&(j.bearing=0),j.freezeElevation=!0,this._map.easeTo(j,{originalEvent:T})),this._updatingCamera=!1}}_fireEvent(s,i){this._map.fire(new a.k(s,i?{originalEvent:i}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{delete this._frameId,this.handleEvent(new Zn("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Tu extends a.E{constructor(s,i){super(),this._renderFrameCallback=()=>{const r=Math.min((ae.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(r)),r<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=i.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new a.M(this.transform.center.lng,this.transform.center.lat)}setCenter(s,i){return this.jumpTo({center:s},i)}panBy(s,i,r){return s=a.P.convert(s).mult(-1),this.panTo(this.transform.center,a.e({offset:s},i),r)}panTo(s,i,r){return this.easeTo(a.e({center:s},i),r)}getZoom(){return this.transform.zoom}setZoom(s,i){return this.jumpTo({zoom:s},i),this}zoomTo(s,i,r){return this.easeTo(a.e({zoom:s},i),r)}zoomIn(s,i){return this.zoomTo(this.getZoom()+1,s,i),this}zoomOut(s,i){return this.zoomTo(this.getZoom()-1,s,i),this}getBearing(){return this.transform.bearing}setBearing(s,i){return this.jumpTo({bearing:s},i),this}getPadding(){return this.transform.padding}setPadding(s,i){return this.jumpTo({padding:s},i),this}rotateTo(s,i,r){return this.easeTo(a.e({bearing:s},i),r)}resetNorth(s,i){return this.rotateTo(0,a.e({duration:1e3},s),i),this}resetNorthPitch(s,i){return this.easeTo(a.e({bearing:0,pitch:0,duration:1e3},s),i),this}snapToNorth(s,i){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,i):this}getPitch(){return this.transform.pitch}setPitch(s,i){return this.jumpTo({pitch:s},i),this}cameraForBounds(s,i){s=Yt.convert(s);const r=i&&i.bearing||0;return this._cameraForBoxAndBearing(s.getNorthWest(),s.getSouthEast(),r,i)}_cameraForBoxAndBearing(s,i,r,l){const d={top:0,bottom:0,right:0,left:0};if(typeof(l=a.e({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},l)).padding=="number"){const Zi=l.padding;l.padding={top:Zi,bottom:Zi,right:Zi,left:Zi}}l.padding=a.e(d,l.padding);const _=this.transform,w=_.padding,T=new Yt(s,i),B=_.project(T.getNorthWest()),j=_.project(T.getNorthEast()),X=_.project(T.getSouthEast()),ue=_.project(T.getSouthWest()),Se=a.b7(-r),Te=B.rotate(Se),Re=j.rotate(Se),Be=X.rotate(Se),et=ue.rotate(Se),vt=new a.P(Math.max(Te.x,Re.x,et.x,Be.x),Math.max(Te.y,Re.y,et.y,Be.y)),ot=new a.P(Math.min(Te.x,Re.x,et.x,Be.x),Math.min(Te.y,Re.y,et.y,Be.y)),ht=vt.sub(ot),Et=(_.width-(w.left+w.right+l.padding.left+l.padding.right))/ht.x,wt=(_.height-(w.top+w.bottom+l.padding.top+l.padding.bottom))/ht.y;if(wt<0||Et<0)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const si=Math.min(_.scaleZoom(_.scale*Math.min(Et,wt)),l.maxZoom),Kt=a.P.convert(l.offset),ii=new a.P((l.padding.left-l.padding.right)/2,(l.padding.top-l.padding.bottom)/2).rotate(a.b7(r)),ai=Kt.add(ii).mult(_.scale/_.zoomScale(si));return{center:_.unproject(B.add(X).div(2).sub(ai)),zoom:si,bearing:r}}fitBounds(s,i,r){return this._fitInternal(this.cameraForBounds(s,i),i,r)}fitScreenCoordinates(s,i,r,l,d){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.P.convert(s)),this.transform.pointLocation(a.P.convert(i)),r,l),l,d)}_fitInternal(s,i,r){return s?(delete(i=a.e(s,i)).padding,i.linear?this.easeTo(i,r):this.flyTo(i,r)):this}jumpTo(s,i){this.stop();const r=this._getTransformForUpdate();let l=!1,d=!1,_=!1;return"zoom"in s&&r.zoom!==+s.zoom&&(l=!0,r.zoom=+s.zoom),s.center!==void 0&&(r.center=a.M.convert(s.center)),"bearing"in s&&r.bearing!==+s.bearing&&(d=!0,r.bearing=+s.bearing),"pitch"in s&&r.pitch!==+s.pitch&&(_=!0,r.pitch=+s.pitch),s.padding==null||r.isPaddingEqual(s.padding)||(r.padding=s.padding),this._applyUpdatedTransform(r),this.fire(new a.k("movestart",i)).fire(new a.k("move",i)),l&&this.fire(new a.k("zoomstart",i)).fire(new a.k("zoom",i)).fire(new a.k("zoomend",i)),d&&this.fire(new a.k("rotatestart",i)).fire(new a.k("rotate",i)).fire(new a.k("rotateend",i)),_&&this.fire(new a.k("pitchstart",i)).fire(new a.k("pitch",i)).fire(new a.k("pitchend",i)),this.fire(new a.k("moveend",i))}calculateCameraOptionsFromTo(s,i,r,l=0){const d=a.Y.fromLngLat(s,i),_=a.Y.fromLngLat(r,l),w=_.x-d.x,T=_.y-d.y,B=_.z-d.z,j=Math.hypot(w,T,B);if(j===0)throw new Error("Can't calculate camera options with same From and To");const X=Math.hypot(w,T),ue=this.transform.scaleZoom(this.transform.cameraToCenterDistance/j/this.transform.tileSize),Se=180*Math.atan2(w,-T)/Math.PI;let Te=180*Math.acos(X/j)/Math.PI;return Te=B<0?90-Te:90+Te,{center:_.toLngLat(),zoom:ue,pitch:Te,bearing:Se}}easeTo(s,i){this._stop(!1,s.easeId),((s=a.e({offset:[0,0],duration:500,easing:a.b6},s)).animate===!1||!s.essential&&ae.prefersReducedMotion)&&(s.duration=0);const r=this._getTransformForUpdate(),l=this.getZoom(),d=this.getBearing(),_=this.getPitch(),w=this.getPadding(),T="zoom"in s?+s.zoom:l,B="bearing"in s?this._normalizeBearing(s.bearing,d):d,j="pitch"in s?+s.pitch:_,X="padding"in s?s.padding:r.padding,ue=a.P.convert(s.offset);let Se=r.centerPoint.add(ue);const Te=r.pointLocation(Se),Re=a.M.convert(s.center||Te);this._normalizeCenter(Re);const Be=r.project(Te),et=r.project(Re).sub(Be),vt=r.zoomScale(T-l);let ot,ht;s.around&&(ot=a.M.convert(s.around),ht=r.locationPoint(ot));const Et={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||T!==l,this._rotating=this._rotating||d!==B,this._pitching=this._pitching||j!==_,this._padding=!r.isPaddingEqual(X),this._easeId=s.easeId,this._prepareEase(i,s.noMoveStart,Et),this.terrain&&this._prepareElevation(Re),this._ease(wt=>{if(this._zooming&&(r.zoom=a.z.number(l,T,wt)),this._rotating&&(r.bearing=a.z.number(d,B,wt)),this._pitching&&(r.pitch=a.z.number(_,j,wt)),this._padding&&(r.interpolatePadding(w,X,wt),Se=r.centerPoint.add(ue)),this.terrain&&!s.freezeElevation&&this._updateElevation(wt),ot)r.setLocationAtPoint(ot,ht);else{const si=r.zoomScale(r.zoom-l),Kt=T>l?Math.min(2,vt):Math.max(.5,vt),ii=Math.pow(Kt,1-wt),ai=r.unproject(Be.add(et.mult(wt*ii)).mult(si));r.setLocationAtPoint(r.renderWorldCopies?ai.wrap():ai,Se)}this._applyUpdatedTransform(r),this._fireMoveEvents(i)},wt=>{this.terrain&&this._finalizeElevation(),this._afterEase(i,wt)},s),this}_prepareEase(s,i,r={}){this._moving=!0,i||r.moving||this.fire(new a.k("movestart",s)),this._zooming&&!r.zooming&&this.fire(new a.k("zoomstart",s)),this._rotating&&!r.rotating&&this.fire(new a.k("rotatestart",s)),this._pitching&&!r.pitching&&this.fire(new a.k("pitchstart",s))}_prepareElevation(s){this._elevationCenter=s,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(s,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(s){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const i=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(s<1&&i!==this._elevationTarget){const r=this._elevationTarget-this._elevationStart;this._elevationStart+=s*(r-(i-(r*s+this._elevationStart))/(1-s)),this._elevationTarget=i}this.transform.elevation=a.z.number(this._elevationStart,this._elevationTarget,s)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(s){if(!this.transformCameraUpdate)return;const i=s.clone(),{center:r,zoom:l,pitch:d,bearing:_,elevation:w}=this.transformCameraUpdate(i);r&&(i.center=r),l!==void 0&&(i.zoom=l),d!==void 0&&(i.pitch=d),_!==void 0&&(i.bearing=_),w!==void 0&&(i.elevation=w),this.transform.apply(i)}_fireMoveEvents(s){this.fire(new a.k("move",s)),this._zooming&&this.fire(new a.k("zoom",s)),this._rotating&&this.fire(new a.k("rotate",s)),this._pitching&&this.fire(new a.k("pitch",s))}_afterEase(s,i){if(this._easeId&&i&&this._easeId===i)return;delete this._easeId;const r=this._zooming,l=this._rotating,d=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new a.k("zoomend",s)),l&&this.fire(new a.k("rotateend",s)),d&&this.fire(new a.k("pitchend",s)),this.fire(new a.k("moveend",s))}flyTo(s,i){if(!s.essential&&ae.prefersReducedMotion){const Gi=a.L(s,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Gi,i)}this.stop(),s=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.b6},s);const r=this._getTransformForUpdate(),l=this.getZoom(),d=this.getBearing(),_=this.getPitch(),w=this.getPadding(),T="zoom"in s?a.ac(+s.zoom,r.minZoom,r.maxZoom):l,B="bearing"in s?this._normalizeBearing(s.bearing,d):d,j="pitch"in s?+s.pitch:_,X="padding"in s?s.padding:r.padding,ue=r.zoomScale(T-l),Se=a.P.convert(s.offset);let Te=r.centerPoint.add(Se);const Re=r.pointLocation(Te),Be=a.M.convert(s.center||Re);this._normalizeCenter(Be);const et=r.project(Re),vt=r.project(Be).sub(et);let ot=s.curve;const ht=Math.max(r.width,r.height),Et=ht/ue,wt=vt.mag();if("minZoom"in s){const Gi=a.ac(Math.min(s.minZoom,l,T),r.minZoom,r.maxZoom),un=ht/r.zoomScale(Gi-l);ot=Math.sqrt(un/wt*2)}const si=ot*ot;function Kt(Gi){const un=(Et*Et-ht*ht+(Gi?-1:1)*si*si*wt*wt)/(2*(Gi?Et:ht)*si*wt);return Math.log(Math.sqrt(un*un+1)-un)}function ii(Gi){return(Math.exp(Gi)-Math.exp(-Gi))/2}function ai(Gi){return(Math.exp(Gi)+Math.exp(-Gi))/2}const Zi=Kt(!1);let Qi=function(Gi){return ai(Zi)/ai(Zi+ot*Gi)},Si=function(Gi){return ht*((ai(Zi)*(ii(un=Zi+ot*Gi)/ai(un))-ii(Zi))/si)/wt;var un},Ui=(Kt(!0)-Zi)/ot;if(Math.abs(wt)<1e-6||!isFinite(Ui)){if(Math.abs(ht-Et)<1e-6)return this.easeTo(s,i);const Gi=Et<ht?-1:1;Ui=Math.abs(Math.log(Et/ht))/ot,Si=function(){return 0},Qi=function(un){return Math.exp(Gi*ot*un)}}return s.duration="duration"in s?+s.duration:1e3*Ui/("screenSpeed"in s?+s.screenSpeed/ot:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0),this._zooming=!0,this._rotating=d!==B,this._pitching=j!==_,this._padding=!r.isPaddingEqual(X),this._prepareEase(i,!1),this.terrain&&this._prepareElevation(Be),this._ease(Gi=>{const un=Gi*Ui,Bn=1/Qi(un);r.zoom=Gi===1?T:l+r.scaleZoom(Bn),this._rotating&&(r.bearing=a.z.number(d,B,Gi)),this._pitching&&(r.pitch=a.z.number(_,j,Gi)),this._padding&&(r.interpolatePadding(w,X,Gi),Te=r.centerPoint.add(Se)),this.terrain&&!s.freezeElevation&&this._updateElevation(Gi);const en=Gi===1?Be:r.unproject(et.add(vt.mult(Si(un))).mult(Bn));r.setLocationAtPoint(r.renderWorldCopies?en.wrap():en,Te),this._applyUpdatedTransform(r),this._fireMoveEvents(i)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(i)},s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(s,i){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const r=this._onEaseEnd;delete this._onEaseEnd,r.call(this,i)}if(!s){const r=this.handlers;r&&r.stop(!1)}return this}_ease(s,i,r){r.animate===!1||r.duration===0?(s(1),i()):(this._easeStart=ae.now(),this._easeOptions=r,this._onEaseFrame=s,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(s,i){s=a.b0(s,-180,180);const r=Math.abs(s-i);return Math.abs(s-360-i)<r&&(s-=360),Math.abs(s+360-i)<r&&(s+=360),s}_normalizeCenter(s){const i=this.transform;if(!i.renderWorldCopies||i.lngRange)return;const r=s.lng-i.center.lng;s.lng+=r>180?-360:r<-180?360:0}queryTerrainElevation(s){return this.terrain?this.terrain.getElevationForLngLatZoom(a.M.convert(s),this.transform.tileZoom)-this.transform.elevation:null}}const oa={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class yu{constructor(s=oa){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=i=>{!i||i.sourceDataType!=="metadata"&&i.sourceDataType!=="visibility"&&i.dataType!=="style"&&i.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=s}getDefaultPosition(){return"bottom-right"}onAdd(s){return this._map=s,this._compact=this.options.compact,this._container=ce.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=ce.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ce.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){ce.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(s,i){const r=this._map._getUIString(`AttributionControl.${i}`);s.title=r,s.setAttribute("aria-label",r)}_updateAttributions(){if(!this._map.style)return;let s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(l=>typeof l!="string"?"":l)):typeof this.options.customAttribution=="string"&&s.push(this.options.customAttribution)),this._map.style.stylesheet){const l=this._map.style.stylesheet;this.styleOwner=l.owner,this.styleId=l.id}const i=this._map.style.sourceCaches;for(const l in i){const d=i[l];if(d.used||d.usedForTerrain){const _=d.getSource();_.attribution&&s.indexOf(_.attribution)<0&&s.push(_.attribution)}}s=s.filter(l=>String(l).trim()),s.sort((l,d)=>l.length-d.length),s=s.filter((l,d)=>{for(let _=d+1;_<s.length;_++)if(s[_].indexOf(l)>=0)return!1;return!0});const r=s.join(" | ");r!==this._attribHTML&&(this._attribHTML=r,s.length?(this._innerContainer.innerHTML=r,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class bs{constructor(s={}){this._updateCompact=()=>{const i=this._container.children;if(i.length){const r=i[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&r.classList.add("maplibregl-compact"):r.classList.remove("maplibregl-compact")}},this.options=s}getDefaultPosition(){return"bottom-left"}onAdd(s){this._map=s,this._compact=this.options&&this.options.compact,this._container=ce.create("div","maplibregl-ctrl");const i=ce.create("a","maplibregl-ctrl-logo");return i.target="_blank",i.rel="noopener nofollow",i.href="https://maplibre.org/",i.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),i.setAttribute("rel","noopener nofollow"),this._container.appendChild(i),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ce.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Lo{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const i=++this._id;return this._queue.push({callback:s,id:i,cancelled:!1}),i}remove(s){const i=this._currentlyRunning,r=i?this._queue.concat(i):this._queue;for(const l of r)if(l.id===s)return void(l.cancelled=!0)}run(s=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const i=this._currentlyRunning=this._queue;this._queue=[];for(const r of i)if(!r.cancelled&&(r.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var ki=a.X([{name:"a_pos3d",type:"Int16",components:3}]);class Li extends a.E{constructor(s){super(),this.sourceCache=s,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,s.usedForTerrain=!0,s.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(s,i){this.sourceCache.update(s,i),this._renderableTilesKeys=[];const r={};for(const l of s.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:i}))r[l.key]=!0,this._renderableTilesKeys.push(l.key),this._tiles[l.key]||(l.posMatrix=new Float64Array(16),a.aN(l.posMatrix,0,a.W,0,a.W,0,1),this._tiles[l.key]=new te(l,this.tileSize));for(const l in this._tiles)r[l]||delete this._tiles[l]}freeRtt(s){for(const i in this._tiles){const r=this._tiles[i];(!s||r.tileID.equals(s)||r.tileID.isChildOf(s)||s.isChildOf(r.tileID))&&(r.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(s=>this.getTileByID(s))}getTileByID(s){return this._tiles[s]}getTerrainCoords(s){const i={};for(const r of this._renderableTilesKeys){const l=this._tiles[r].tileID;if(l.canonical.equals(s.canonical)){const d=s.clone();d.posMatrix=new Float64Array(16),a.aN(d.posMatrix,0,a.W,0,a.W,0,1),i[r]=d}else if(l.canonical.isChildOf(s.canonical)){const d=s.clone();d.posMatrix=new Float64Array(16);const _=l.canonical.z-s.canonical.z,w=l.canonical.x-(l.canonical.x>>_<<_),T=l.canonical.y-(l.canonical.y>>_<<_),B=a.W>>_;a.aN(d.posMatrix,0,B,0,B,0,1),a.H(d.posMatrix,d.posMatrix,[-w*B,-T*B,0]),i[r]=d}else if(s.canonical.isChildOf(l.canonical)){const d=s.clone();d.posMatrix=new Float64Array(16);const _=s.canonical.z-l.canonical.z,w=s.canonical.x-(s.canonical.x>>_<<_),T=s.canonical.y-(s.canonical.y>>_<<_),B=a.W>>_;a.aN(d.posMatrix,0,a.W,0,a.W,0,1),a.H(d.posMatrix,d.posMatrix,[w*B,T*B,0]),a.J(d.posMatrix,d.posMatrix,[1/2**_,1/2**_,0]),i[r]=d}}return i}getSourceTile(s,i){const r=this.sourceCache._source;let l=s.overscaledZ-this.deltaZoom;if(l>r.maxzoom&&(l=r.maxzoom),l<r.minzoom)return null;this._sourceTileCache[s.key]||(this._sourceTileCache[s.key]=s.scaledTo(l).key);let d=this.sourceCache.getTileByID(this._sourceTileCache[s.key]);if((!d||!d.dem)&&i)for(;l>=r.minzoom&&(!d||!d.dem);)d=this.sourceCache.getTileByID(s.scaledTo(l--).key);return d}tilesAfterTime(s=Date.now()){return Object.values(this._tiles).filter(i=>i.timeAdded>=s)}}class ws{constructor(s,i,r){this.painter=s,this.sourceCache=new Li(i),this.options=r,this.exaggeration=typeof r.exaggeration=="number"?r.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(s,i,r,l=a.W){var d;if(!(i>=0&&i<l&&r>=0&&r<l))return 0;const _=this.getTerrainData(s),w=(d=_.tile)===null||d===void 0?void 0:d.dem;if(!w)return 0;const T=function(Te,Re,Be){var et=Re[0],vt=Re[1];return Te[0]=Be[0]*et+Be[4]*vt+Be[12],Te[1]=Be[1]*et+Be[5]*vt+Be[13],Te}([],[i/l*a.W,r/l*a.W],_.u_terrain_matrix),B=[T[0]*w.dim,T[1]*w.dim],j=Math.floor(B[0]),X=Math.floor(B[1]),ue=B[0]-j,Se=B[1]-X;return w.get(j,X)*(1-ue)*(1-Se)+w.get(j+1,X)*ue*(1-Se)+w.get(j,X+1)*(1-ue)*Se+w.get(j+1,X+1)*ue*Se}getElevationForLngLatZoom(s,i){const{tileID:r,mercatorX:l,mercatorY:d}=this._getOverscaledTileIDFromLngLatZoom(s,i);return this.getElevation(r,l%a.W,d%a.W,a.W)}getElevation(s,i,r,l=a.W){return this.getDEMElevation(s,i,r,l)*this.exaggeration}getTerrainData(s){if(!this._emptyDemTexture){const l=this.painter.context,d=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new bt(l,d,l.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new bt(l,new a.R({width:1,height:1}),l.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.an([])}const i=this.sourceCache.getSourceTile(s,!0);if(i&&i.dem&&(!i.demTexture||i.needsTerrainPrepare)){const l=this.painter.context;i.demTexture=this.painter.getTileTexture(i.dem.stride),i.demTexture?i.demTexture.update(i.dem.getPixels(),{premultiply:!1}):i.demTexture=new bt(l,i.dem.getPixels(),l.gl.RGBA,{premultiply:!1}),i.demTexture.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),i.needsTerrainPrepare=!1}const r=i&&i+i.tileID.key+s.key;if(r&&!this._demMatrixCache[r]){const l=this.sourceCache.sourceCache._source.maxzoom;let d=s.canonical.z-i.tileID.canonical.z;s.overscaledZ>s.canonical.z&&(s.canonical.z>=l?d=s.canonical.z-l:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const _=s.canonical.x-(s.canonical.x>>d<<d),w=s.canonical.y-(s.canonical.y>>d<<d),T=a.b8(new Float64Array(16),[1/(a.W<<d),1/(a.W<<d),0]);a.H(T,T,[_*a.W,w*a.W,0]),this._demMatrixCache[s.key]={matrix:T,coord:s}}return{u_depth:2,u_terrain:3,u_terrain_dim:i&&i.dem&&i.dem.dim||1,u_terrain_matrix:r?this._demMatrixCache[s.key].matrix:this._emptyDemMatrix,u_terrain_unpack:i&&i.dem&&i.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(i&&i.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:i}}getFramebuffer(s){const i=this.painter,r=i.width/devicePixelRatio,l=i.height/devicePixelRatio;return!this._fbo||this._fbo.width===r&&this._fbo.height===l||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new bt(i.context,{width:r,height:l,data:null},i.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(i.context.gl.NEAREST,i.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new bt(i.context,{width:r,height:l,data:null},i.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(i.context.gl.NEAREST,i.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=i.context.createFramebuffer(r,l,!0,!1),this._fbo.depthAttachment.set(i.context.createRenderbuffer(i.context.gl.DEPTH_COMPONENT16,r,l))),this._fbo.colorAttachment.set(s==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const s=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const i=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let d=0,_=0;d<this._coordsTextureSize;d++)for(let w=0;w<this._coordsTextureSize;w++,_+=4)i[_+0]=255&w,i[_+1]=255&d,i[_+2]=w>>8<<4|d>>8,i[_+3]=0;const r=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(i.buffer)),l=new bt(s,r,s.gl.RGBA,{premultiply:!1});return l.bind(s.gl.NEAREST,s.gl.CLAMP_TO_EDGE),this._coordsTexture=l,l}pointCoordinate(s){const i=new Uint8Array(4),r=this.painter.context,l=r.gl;r.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),l.readPixels(s.x,this.painter.height/devicePixelRatio-s.y-1,1,1,l.RGBA,l.UNSIGNED_BYTE,i),r.bindFramebuffer.set(null);const d=i[0]+(i[2]>>4<<8),_=i[1]+((15&i[2])<<8),w=this.coordsIndex[255-i[3]],T=w&&this.sourceCache.getTileByID(w);if(!T)return null;const B=this._coordsTextureSize,j=(1<<T.tileID.canonical.z)*B;return new a.Y((T.tileID.canonical.x*B+d)/j+T.tileID.wrap,(T.tileID.canonical.y*B+_)/j,this.getElevation(T.tileID,d,_,B))}depthAtPoint(s){const i=new Uint8Array(4),r=this.painter.context,l=r.gl;return r.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),l.readPixels(s.x,this.painter.height/devicePixelRatio-s.y-1,1,1,l.RGBA,l.UNSIGNED_BYTE,i),r.bindFramebuffer.set(null),(i[0]/16777216+i[1]/65536+i[2]/256+i[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const s=this.painter.context,i=new a.b9,r=new a.aX,l=this.meshSize,d=a.W/l,_=l*l;for(let X=0;X<=l;X++)for(let ue=0;ue<=l;ue++)i.emplaceBack(ue*d,X*d,0);for(let X=0;X<_;X+=l+1)for(let ue=0;ue<l;ue++)r.emplaceBack(ue+X,l+ue+X+1,l+ue+X+2),r.emplaceBack(ue+X,l+ue+X+2,ue+X+1);const w=i.length,T=w+2*(l+1);for(const X of[0,1])for(let ue=0;ue<=l;ue++)for(const Se of[0,1])i.emplaceBack(ue*d,X*a.W,Se);for(let X=0;X<2*l;X+=2)r.emplaceBack(T+X,T+X+1,T+X+3),r.emplaceBack(T+X,T+X+3,T+X+2),r.emplaceBack(w+X,w+X+3,w+X+1),r.emplaceBack(w+X,w+X+2,w+X+3);const B=i.length,j=B+2*(l+1);for(const X of[0,1])for(let ue=0;ue<=l;ue++)for(const Se of[0,1])i.emplaceBack(X*a.W,ue*d,Se);for(let X=0;X<2*l;X+=2)r.emplaceBack(B+X,B+X+1,B+X+3),r.emplaceBack(B+X,B+X+3,B+X+2),r.emplaceBack(j+X,j+X+3,j+X+1),r.emplaceBack(j+X,j+X+2,j+X+3);return this._mesh={indexBuffer:s.createIndexBuffer(r),vertexBuffer:s.createVertexBuffer(i,ki.members),segments:a.$.simpleSegment(0,0,i.length,r.length)},this._mesh}getMeshFrameDelta(s){return 2*Math.PI*a.ba/Math.pow(2,s)/5}getMinTileElevationForLngLatZoom(s,i){var r;const{tileID:l}=this._getOverscaledTileIDFromLngLatZoom(s,i);return(r=this.getMinMaxElevation(l).minElevation)!==null&&r!==void 0?r:0}getMinMaxElevation(s){const i=this.getTerrainData(s).tile,r={minElevation:null,maxElevation:null};return i&&i.dem&&(r.minElevation=i.dem.min*this.exaggeration,r.maxElevation=i.dem.max*this.exaggeration),r}_getOverscaledTileIDFromLngLatZoom(s,i){const r=a.Y.fromLngLat(s.wrap()),l=(1<<i)*a.W,d=r.x*l,_=r.y*l,w=Math.floor(d/a.W),T=Math.floor(_/a.W);return{tileID:new a.Q(i,0,i,w,T),mercatorX:d,mercatorY:_}}}class vu{constructor(s,i,r){this._context=s,this._size=i,this._tileSize=r,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const s of this._objects)s.texture.destroy(),s.fbo.destroy()}_createObject(s){const i=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),r=new bt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return r.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),i.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),i.colorAttachment.set(r.texture),{id:s,fbo:i,texture:r,stamp:-1,inUse:!1}}getObjectForId(s){return this._objects[s]}useObject(s){s.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(i=>s.id!==i),this._recentlyUsed.push(s.id)}stampObject(s){s.stamp=++this._stamp}getOrCreateFreeObject(){for(const i of this._recentlyUsed)if(!this._objects[i].inUse)return this._objects[i];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const s=this._createObject(this._objects.length);return this._objects.push(s),s}freeObject(s){s.inUse=!1}freeAllObjects(){for(const s of this._objects)this.freeObject(s)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(s=>!s.inUse)===!1}}const Vo={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class fs{constructor(s,i){this.painter=s,this.terrain=i,this.pool=new vu(s.context,30,i.sourceCache.tileSize*i.qualityFactor)}destruct(){this.pool.destruct()}getTexture(s){return this.pool.getObjectForId(s.rtt[this._stacks.length-1].id).texture}prepareForRender(s,i){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=s._order.filter(r=>!s._layers[r].isHidden(i)),this._coordsDescendingInv={};for(const r in s.sourceCaches){this._coordsDescendingInv[r]={};const l=s.sourceCaches[r].getVisibleCoordinates();for(const d of l){const _=this.terrain.sourceCache.getTerrainCoords(d);for(const w in _)this._coordsDescendingInv[r][w]||(this._coordsDescendingInv[r][w]=[]),this._coordsDescendingInv[r][w].push(_[w])}}this._coordsDescendingInvStr={};for(const r of s._order){const l=s._layers[r],d=l.source;if(Vo[l.type]&&!this._coordsDescendingInvStr[d]){this._coordsDescendingInvStr[d]={};for(const _ in this._coordsDescendingInv[d])this._coordsDescendingInvStr[d][_]=this._coordsDescendingInv[d][_].map(w=>w.key).sort().join()}}for(const r of this._renderableTiles)for(const l in this._coordsDescendingInvStr){const d=this._coordsDescendingInvStr[l][r.tileID.key];d&&d!==r.rttCoords[l]&&(r.rtt=[])}}renderLayer(s){if(s.isHidden(this.painter.transform.zoom))return!1;const i=s.type,r=this.painter,l=this._renderableLayerIds[this._renderableLayerIds.length-1]===s.id;if(Vo[i]&&(this._prevType&&Vo[this._prevType]||this._stacks.push([]),this._prevType=i,this._stacks[this._stacks.length-1].push(s.id),!l))return!0;if(Vo[this._prevType]||Vo[i]&&l){this._prevType=i;const d=this._stacks.length-1,_=this._stacks[d]||[];for(const w of this._renderableTiles){if(this.pool.isFull()&&(ea(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(w),w.rtt[d]){const B=this.pool.getObjectForId(w.rtt[d].id);if(B.stamp===w.rtt[d].stamp){this.pool.useObject(B);continue}}const T=this.pool.getOrCreateFreeObject();this.pool.useObject(T),this.pool.stampObject(T),w.rtt[d]={id:T.id,stamp:T.stamp},r.context.bindFramebuffer.set(T.fbo.framebuffer),r.context.clear({color:a.aO.transparent,stencil:0}),r.currentStencilSource=void 0;for(let B=0;B<_.length;B++){const j=r.style._layers[_[B]],X=j.source?this._coordsDescendingInv[j.source][w.tileID.key]:[w.tileID];r.context.viewport.set([0,0,T.fbo.width,T.fbo.height]),r._renderTileClippingMasks(j,X),r.renderLayer(r,r.style.sourceCaches[j.source],j,X),j.source&&(w.rttCoords[j.source]=this._coordsDescendingInvStr[j.source][w.tileID.key])}}return ea(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Vo[i]}return!1}}const hl={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Ds=U,C={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:oa,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.a.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},D=y=>{y.touchstart=y.dragStart,y.touchmoveWindow=y.dragMove,y.touchend=y.dragEnd},z={showCompass:!0,showZoom:!0,visualizePitch:!1};class R{constructor(s,i,r=!1){this.mousedown=_=>{this.startMouse(a.e({},_,{ctrlKey:!0,preventDefault:()=>_.preventDefault()}),ce.mousePos(this.element,_)),ce.addEventListener(window,"mousemove",this.mousemove),ce.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=_=>{this.moveMouse(_,ce.mousePos(this.element,_))},this.mouseup=_=>{this.mouseRotate.dragEnd(_),this.mousePitch&&this.mousePitch.dragEnd(_),this.offTemp()},this.touchstart=_=>{_.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ce.touchPos(this.element,_.targetTouches)[0],this.startTouch(_,this._startPos),ce.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),ce.addEventListener(window,"touchend",this.touchend))},this.touchmove=_=>{_.targetTouches.length!==1?this.reset():(this._lastPos=ce.touchPos(this.element,_.targetTouches)[0],this.moveTouch(_,this._lastPos))},this.touchend=_=>{_.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const l=s.dragRotate._mouseRotate.getClickTolerance(),d=s.dragRotate._mousePitch.getClickTolerance();this.element=i,this.mouseRotate=No({clickTolerance:l,enable:!0}),this.touchRotate=(({enable:_,clickTolerance:w,bearingDegreesPerPixelMoved:T=.8})=>{const B=new Da;return new vo({clickTolerance:w,move:(j,X)=>({bearingDelta:(X.x-j.x)*T}),moveStateManager:B,enable:_,assignEvents:D})})({clickTolerance:l,enable:!0}),this.map=s,r&&(this.mousePitch=Nl({clickTolerance:d,enable:!0}),this.touchPitch=(({enable:_,clickTolerance:w,pitchDegreesPerPixelMoved:T=-.5})=>{const B=new Da;return new vo({clickTolerance:w,move:(j,X)=>({pitchDelta:(X.y-j.y)*T}),moveStateManager:B,enable:_,assignEvents:D})})({clickTolerance:d,enable:!0})),ce.addEventListener(i,"mousedown",this.mousedown),ce.addEventListener(i,"touchstart",this.touchstart,{passive:!1}),ce.addEventListener(i,"touchcancel",this.reset)}startMouse(s,i){this.mouseRotate.dragStart(s,i),this.mousePitch&&this.mousePitch.dragStart(s,i),ce.disableDrag()}startTouch(s,i){this.touchRotate.dragStart(s,i),this.touchPitch&&this.touchPitch.dragStart(s,i),ce.disableDrag()}moveMouse(s,i){const r=this.map,{bearingDelta:l}=this.mouseRotate.dragMove(s,i)||{};if(l&&r.setBearing(r.getBearing()+l),this.mousePitch){const{pitchDelta:d}=this.mousePitch.dragMove(s,i)||{};d&&r.setPitch(r.getPitch()+d)}}moveTouch(s,i){const r=this.map,{bearingDelta:l}=this.touchRotate.dragMove(s,i)||{};if(l&&r.setBearing(r.getBearing()+l),this.touchPitch){const{pitchDelta:d}=this.touchPitch.dragMove(s,i)||{};d&&r.setPitch(r.getPitch()+d)}}off(){const s=this.element;ce.removeEventListener(s,"mousedown",this.mousedown),ce.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),ce.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ce.removeEventListener(window,"touchend",this.touchend),ce.removeEventListener(s,"touchcancel",this.reset),this.offTemp()}offTemp(){ce.enableDrag(),ce.removeEventListener(window,"mousemove",this.mousemove),ce.removeEventListener(window,"mouseup",this.mouseup),ce.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ce.removeEventListener(window,"touchend",this.touchend)}}let ee;function le(y,s,i){const r=new a.M(y.lng,y.lat);if(y=new a.M(y.lng,y.lat),s){const l=new a.M(y.lng-360,y.lat),d=new a.M(y.lng+360,y.lat),_=i.locationPoint(y).distSqr(s);i.locationPoint(l).distSqr(s)<_?y=l:i.locationPoint(d).distSqr(s)<_&&(y=d)}for(;Math.abs(y.lng-i.center.lng)>180;){const l=i.locationPoint(y);if(l.x>=0&&l.y>=0&&l.x<=i.width&&l.y<=i.height)break;y.lng>i.center.lng?y.lng-=360:y.lng+=360}return y.lng!==r.lng&&i.locationPoint(y).y>i.height/2-i.getHorizon()?y:r}const oe={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function we(y,s,i){const r=y.classList;for(const l in oe)r.remove(`maplibregl-${i}-anchor-${l}`);r.add(`maplibregl-${i}-anchor-${s}`)}class We extends a.E{constructor(s){if(super(),this._onKeyPress=i=>{const r=i.code,l=i.charCode||i.keyCode;r!=="Space"&&r!=="Enter"&&l!==32&&l!==13||this.togglePopup()},this._onMapClick=i=>{const r=i.originalEvent.target,l=this._element;this._popup&&(r===l||l.contains(r))&&this.togglePopup()},this._update=i=>{var r;if(!this._map)return;const l=this._map.loaded()&&!this._map.isMoving();((i==null?void 0:i.type)==="terrain"||(i==null?void 0:i.type)==="render"&&!l)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?le(this._lngLat,this._flatPos,this._map.transform):(r=this._lngLat)===null||r===void 0?void 0:r.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let d="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?d=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(d=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let _="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?_="rotateX(0deg)":this._pitchAlignment==="map"&&(_=`rotateX(${this._map.getPitch()}deg)`),i&&i.type!=="moveend"||(this._pos=this._pos.round()),ce.setTransform(this._element,`${oe[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${_} ${d}`),ae.frameAsync(new AbortController).then(()=>{this._updateOpacity(i&&i.type==="moveend")}).catch(()=>{})},this._onMove=i=>{if(!this._isDragging){const r=this._clickTolerance||this._map._clickTolerance;this._isDragging=i.point.dist(this._pointerdownPos)>=r}this._isDragging&&(this._pos=i.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.k("dragstart"))),this.fire(new a.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.k("dragend")),this._state="inactive"},this._addDragHandler=i=>{this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos).add(this._offset),this._pointerdownPos=i.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=s&&s.anchor||"center",this._color=s&&s.color||"#3FB1CE",this._scale=s&&s.scale||1,this._draggable=s&&s.draggable||!1,this._clickTolerance=s&&s.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=s&&s.rotation||0,this._rotationAlignment=s&&s.rotationAlignment||"auto",this._pitchAlignment=s&&s.pitchAlignment&&s.pitchAlignment!=="auto"?s.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(s==null?void 0:s.opacity,s==null?void 0:s.opacityWhenCovered),s&&s.element)this._element=s.element,this._offset=a.P.convert(s&&s.offset||[0,0]);else{this._defaultMarker=!0,this._element=ce.create("div"),this._element.setAttribute("aria-label","Map marker");const i=ce.createNS("http://www.w3.org/2000/svg","svg"),r=41,l=27;i.setAttributeNS(null,"display","block"),i.setAttributeNS(null,"height",`${r}px`),i.setAttributeNS(null,"width",`${l}px`),i.setAttributeNS(null,"viewBox",`0 0 ${l} ${r}`);const d=ce.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"stroke","none"),d.setAttributeNS(null,"stroke-width","1"),d.setAttributeNS(null,"fill","none"),d.setAttributeNS(null,"fill-rule","evenodd");const _=ce.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"fill-rule","nonzero");const w=ce.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(3.0, 29.0)"),w.setAttributeNS(null,"fill","#000000");const T=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const et of T){const vt=ce.createNS("http://www.w3.org/2000/svg","ellipse");vt.setAttributeNS(null,"opacity","0.04"),vt.setAttributeNS(null,"cx","10.5"),vt.setAttributeNS(null,"cy","5.80029008"),vt.setAttributeNS(null,"rx",et.rx),vt.setAttributeNS(null,"ry",et.ry),w.appendChild(vt)}const B=ce.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"fill",this._color);const j=ce.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),B.appendChild(j);const X=ce.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"opacity","0.25"),X.setAttributeNS(null,"fill","#000000");const ue=ce.createNS("http://www.w3.org/2000/svg","path");ue.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),X.appendChild(ue);const Se=ce.createNS("http://www.w3.org/2000/svg","g");Se.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Se.setAttributeNS(null,"fill","#FFFFFF");const Te=ce.createNS("http://www.w3.org/2000/svg","g");Te.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Re=ce.createNS("http://www.w3.org/2000/svg","circle");Re.setAttributeNS(null,"fill","#000000"),Re.setAttributeNS(null,"opacity","0.25"),Re.setAttributeNS(null,"cx","5.5"),Re.setAttributeNS(null,"cy","5.5"),Re.setAttributeNS(null,"r","5.4999962");const Be=ce.createNS("http://www.w3.org/2000/svg","circle");Be.setAttributeNS(null,"fill","#FFFFFF"),Be.setAttributeNS(null,"cx","5.5"),Be.setAttributeNS(null,"cy","5.5"),Be.setAttributeNS(null,"r","5.4999962"),Te.appendChild(Re),Te.appendChild(Be),_.appendChild(w),_.appendChild(B),_.appendChild(X),_.appendChild(Se),_.appendChild(Te),i.appendChild(_),i.setAttributeNS(null,"height",r*this._scale+"px"),i.setAttributeNS(null,"width",l*this._scale+"px"),this._element.appendChild(i),this._offset=a.P.convert(s&&s.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",i=>{i.preventDefault()}),this._element.addEventListener("mousedown",i=>{i.preventDefault()}),we(this._element,this._anchor,"marker"),s&&s.className)for(const i of s.className.split(" "))this._element.classList.add(i);this._popup=null}addTo(s){return this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._update),s.on("moveend",this._update),s.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ce.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=a.M.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const l=Math.abs(13.5)/Math.SQRT2;s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[l,-1*(38.1-13.5+l)],"bottom-right":[-l,-1*(38.1-13.5+l)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?s.remove():(s.setLngLat(this._lngLat),s.addTo(this._map)),this):this}_updateOpacity(s=!1){var i;if(!(!((i=this._map)===null||i===void 0)&&i.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(s)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const r=this._map,l=r.terrain.depthAtPoint(this._pos),d=r.terrain.getElevationForLngLatZoom(this._lngLat,r.transform.tileZoom);if(r.transform.lngLatToCameraDepth(this._lngLat,d)-l<.006)return void(this._element.style.opacity=this._opacity);const _=-this._offset.y/r.transform._pixelPerMeter,w=Math.sin(r.getPitch()*Math.PI/180)*_,T=r.terrain.depthAtPoint(new a.P(this._pos.x,this._pos.y-this._offset.y)),B=r.transform.lngLatToCameraDepth(this._lngLat,d+w);this._element.style.opacity=B-T>.006?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(s){return this._offset=a.P.convert(s),this._update(),this}addClassName(s){this._element.classList.add(s)}removeClassName(s){this._element.classList.remove(s)}toggleClassName(s){return this._element.classList.toggle(s)}setDraggable(s){return this._draggable=!!s,this._map&&(s?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s&&s!=="auto"?s:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(s,i){return s===void 0&&i===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),s!==void 0&&(this._opacity=s),i!==void 0&&(this._opacityWhenCovered=i),this._map&&this._updateOpacity(!0),this}}const yt={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ct=0,ri=!1;const Gt={maxWidth:100,unit:"metric"};function Zt(y,s,i){const r=i&&i.maxWidth||100,l=y._container.clientHeight/2,d=y.unproject([0,l]),_=y.unproject([r,l]),w=d.distanceTo(_);if(i&&i.unit==="imperial"){const T=3.2808*w;T>5280?Z(s,r,T/5280,y._getUIString("ScaleControl.Miles")):Z(s,r,T,y._getUIString("ScaleControl.Feet"))}else i&&i.unit==="nautical"?Z(s,r,w/1852,y._getUIString("ScaleControl.NauticalMiles")):w>=1e3?Z(s,r,w/1e3,y._getUIString("ScaleControl.Kilometers")):Z(s,r,w,y._getUIString("ScaleControl.Meters"))}function Z(y,s,i,r){const l=function(d){const _=Math.pow(10,`${Math.floor(d)}`.length-1);let w=d/_;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:w>=1?1:function(T){const B=Math.pow(10,Math.ceil(-Math.log(T)/Math.LN10));return Math.round(T*B)/B}(w),_*w}(i);y.style.width=s*(l/i)+"px",y.innerHTML=`${l}&nbsp;${r}`}const A={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},E=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function F(y){if(y){if(typeof y=="number"){const s=Math.round(Math.abs(y)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,y),"top-left":new a.P(s,s),"top-right":new a.P(-s,s),bottom:new a.P(0,-y),"bottom-left":new a.P(s,-s),"bottom-right":new a.P(-s,-s),left:new a.P(y,0),right:new a.P(-y,0)}}if(y instanceof a.P||Array.isArray(y)){const s=a.P.convert(y);return{center:s,top:s,"top-left":s,"top-right":s,bottom:s,"bottom-left":s,"bottom-right":s,left:s,right:s}}return{center:a.P.convert(y.center||[0,0]),top:a.P.convert(y.top||[0,0]),"top-left":a.P.convert(y["top-left"]||[0,0]),"top-right":a.P.convert(y["top-right"]||[0,0]),bottom:a.P.convert(y.bottom||[0,0]),"bottom-left":a.P.convert(y["bottom-left"]||[0,0]),"bottom-right":a.P.convert(y["bottom-right"]||[0,0]),left:a.P.convert(y.left||[0,0]),right:a.P.convert(y.right||[0,0])}}return F(new a.P(0,0))}const O=U;S.AJAXError=a.bd,S.Evented=a.E,S.LngLat=a.M,S.MercatorCoordinate=a.Y,S.Point=a.P,S.addProtocol=a.be,S.config=a.a,S.removeProtocol=a.bf,S.AttributionControl=yu,S.BoxZoomHandler=Ja,S.CanvasSource=Gn,S.CooperativeGesturesHandler=gs,S.DoubleClickZoomHandler=el,S.DragPanHandler=cu,S.DragRotateHandler=Vu,S.EdgeInsets=cl,S.FullscreenControl=class extends a.E{constructor(y={}){super(),this._onFullscreenChange=()=>{var s;let i=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((s=i==null?void 0:i.shadowRoot)===null||s===void 0)&&s.fullscreenElement;)i=i.shadowRoot.fullscreenElement;i===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){ce.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const y=this._fullscreenButton=ce.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);ce.create("span","maplibregl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new a.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},S.GeoJSONSource=ci,S.GeolocateControl=class extends a.E{constructor(y){super(),this._onSuccess=s=>{if(this._map){if(this._isOutOfMapMaxBounds(s))return this._setErrorState(),this.fire(new a.k("outofmaxbounds",s)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=s,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(s),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(s),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.k("geolocate",s)),this._finish()}},this._updateCamera=s=>{const i=new a.M(s.coords.longitude,s.coords.latitude),r=s.coords.accuracy,l=this._map.getBearing(),d=a.e({bearing:l},this.options.fitBoundsOptions),_=Yt.fromLngLat(i,r);this._map.fitBounds(_,d,{geolocateSource:!0})},this._updateMarker=s=>{if(s){const i=new a.M(s.coords.longitude,s.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=s.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=s=>{if(this._map){if(this.options.trackUserLocation)if(s.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(s.code===3&&ri)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.k("error",s)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=s=>{if(this._map){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=ce.create("button","maplibregl-ctrl-geolocate",this._container),ce.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",s===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ce.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new We({element:this._dotElement}),this._circleElement=ce.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new We({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||this._watchState!=="ACTIVE_LOCK"||i.originalEvent&&i.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.k("trackuserlocationend")))})}},this.options=a.e({},yt,y)}onAdd(y){return this._map=y,this._container=ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(s=!1){return a._(this,void 0,void 0,function*(){if(ee!==void 0&&!s)return ee;if(window.navigator.permissions===void 0)return ee=!!window.navigator.geolocation,ee;try{ee=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ee=!!window.navigator.geolocation}return ee})}().then(s=>this._setupUI(s)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ce.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ct=0,ri=!1}_isOutOfMapMaxBounds(y){const s=this._map.getMaxBounds(),i=y.coords;return s&&(i.longitude<s.getWest()||i.longitude>s.getEast()||i.latitude<s.getSouth()||i.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const y=this._map.getBounds(),s=y.getSouthEast(),i=y.getNorthEast(),r=s.distanceTo(i),l=Math.ceil(this._accuracy/(r/this._map._container.clientHeight)*2);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ct--,ri=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ct++,Ct>1?(y={maximumAge:6e5,timeout:0},ri=!0):(y=this.options.positionOptions,ri=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},S.Hash=ao,S.ImageSource=lr,S.KeyboardHandler=Xu,S.LngLatBounds=Yt,S.LogoControl=bs,S.Map=class extends Tu{constructor(y){if(a.bb.mark(a.bc.create),(y=a.e({},C,y)).minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(y.minPitch!=null&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(y.maxPitch!=null&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new lu(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies),{bearingSnap:y.bearingSnap}),this._contextLost=s=>{s.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new a.k("webglcontextlost",{originalEvent:s}))},this._contextRestored=s=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.k("webglcontextrestored",{originalEvent:s}))},this._onMapScroll=s=>{if(s.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=y.interactive,this._maxTileCacheSize=y.maxTileCacheSize,this._maxTileCacheZoomLevels=y.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._crossSourceCollisions=y.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=y.collectResourceTiming,this._renderTaskQueue=new Lo,this._controls=[],this._mapId=a.a3(),this._locale=a.e({},hl,y.locale),this._clickTolerance=y.clickTolerance,this._overridePixelRatio=y.pixelRatio,this._maxCanvasSize=y.maxCanvasSize,this.transformCameraUpdate=y.transformCameraUpdate,this._imageQueueHandle=Tt.addThrottleControl(()=>this.isMoving()),this._requestManager=new Rt(y.transformRequest),typeof y.container=="string"){if(this._container=document.getElementById(y.container),!this._container)throw new Error(`Container '${y.container}' not found.`)}else{if(!(y.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(y.maxBounds&&this.setMaxBounds(y.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let s=!1;const i=gl(r=>{this._trackResize&&!this._removed&&this.resize(r)._update()},50);this._resizeObserver=new ResizeObserver(r=>{s?i(r):s=!0}),this._resizeObserver.observe(this._container)}this.handlers=new tl(this,y),this._hash=y.hash&&new ao(typeof y.hash=="string"&&y.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),y.bounds&&(this.resize(),this.fitBounds(y.bounds,a.e({},y.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=y.localIdeographFontFamily,this._validateStyle=y.validateStyle,y.style&&this.setStyle(y.style,{localIdeographFontFamily:y.localIdeographFontFamily}),y.attributionControl&&this.addControl(new yu(typeof y.attributionControl=="boolean"?void 0:y.attributionControl)),y.maplibreLogo&&this.addControl(new bs,y.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new a.k(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new a.k(`${s.dataType}dataloading`,s))}),this.on("dataabort",s=>{this.fire(new a.k("sourcedataabort",s))})}_getMapId(){return this._mapId}addControl(y,s){if(s===void 0&&(s=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new a.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=y.onAdd(this);this._controls.push(y);const r=this._controlPositions[s];return s.indexOf("bottom")!==-1?r.insertBefore(i,r.firstChild):r.appendChild(i),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new a.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(y);return s>-1&&this._controls.splice(s,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}calculateCameraOptionsFromTo(y,s,i,r){return r==null&&this.terrain&&(r=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(y,s,i,r)}resize(y){var s;const i=this._containerDimensions(),r=i[0],l=i[1],d=this._getClampedPixelRatio(r,l);if(this._resizeCanvas(r,l,d),this.painter.resize(r,l,d),this.painter.overLimit()){const w=this.painter.context.gl;this._maxCanvasSize=[w.drawingBufferWidth,w.drawingBufferHeight];const T=this._getClampedPixelRatio(r,l);this._resizeCanvas(r,l,T),this.painter.resize(r,l,T)}this.transform.resize(r,l),(s=this._requestedCameraState)===null||s===void 0||s.resize(r,l);const _=!this._moving;return _&&(this.stop(),this.fire(new a.k("movestart",y)).fire(new a.k("move",y))),this.fire(new a.k("resize",y)),_&&this.fire(new a.k("moveend",y)),this}_getClampedPixelRatio(y,s){const{0:i,1:r}=this._maxCanvasSize,l=this.getPixelRatio(),d=y*l,_=s*l;return Math.min(d>i?i/d:1,_>r?r/_:1)*l}getPixelRatio(){var y;return(y=this._overridePixelRatio)!==null&&y!==void 0?y:devicePixelRatio}setPixelRatio(y){this._overridePixelRatio=y,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(Yt.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this._update()}project(y){return this.transform.locationPoint(a.M.convert(y),this.style&&this.terrain)}unproject(y){return this.transform.pointLocation(a.P.convert(y),this.terrain)}isMoving(){var y;return this._moving||((y=this.handlers)===null||y===void 0?void 0:y.isMoving())}isZooming(){var y;return this._zooming||((y=this.handlers)===null||y===void 0?void 0:y.isZooming())}isRotating(){var y;return this._rotating||((y=this.handlers)===null||y===void 0?void 0:y.isRotating())}_createDelegatedListener(y,s,i){if(y==="mouseenter"||y==="mouseover"){let r=!1;return{layer:s,listener:i,delegates:{mousemove:d=>{const _=this.getLayer(s)?this.queryRenderedFeatures(d.point,{layers:[s]}):[];_.length?r||(r=!0,i.call(this,new jn(y,this,d.originalEvent,{features:_}))):r=!1},mouseout:()=>{r=!1}}}}if(y==="mouseleave"||y==="mouseout"){let r=!1;return{layer:s,listener:i,delegates:{mousemove:_=>{(this.getLayer(s)?this.queryRenderedFeatures(_.point,{layers:[s]}):[]).length?r=!0:r&&(r=!1,i.call(this,new jn(y,this,_.originalEvent)))},mouseout:_=>{r&&(r=!1,i.call(this,new jn(y,this,_.originalEvent)))}}}}{const r=l=>{const d=this.getLayer(s)?this.queryRenderedFeatures(l.point,{layers:[s]}):[];d.length&&(l.features=d,i.call(this,l),delete l.features)};return{layer:s,listener:i,delegates:{[y]:r}}}}on(y,s,i){if(i===void 0)return super.on(y,s);const r=this._createDelegatedListener(y,s,i);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(r);for(const l in r.delegates)this.on(l,r.delegates[l]);return this}once(y,s,i){if(i===void 0)return super.once(y,s);const r=this._createDelegatedListener(y,s,i);for(const l in r.delegates)this.once(l,r.delegates[l]);return this}off(y,s,i){return i===void 0?super.off(y,s):(this._delegatedListeners&&this._delegatedListeners[y]&&(r=>{const l=this._delegatedListeners[y];for(let d=0;d<l.length;d++){const _=l[d];if(_.layer===s&&_.listener===i){for(const w in _.delegates)this.off(w,_.delegates[w]);return l.splice(d,1),this}}})(),this)}queryRenderedFeatures(y,s){if(!this.style)return[];let i;const r=y instanceof a.P||Array.isArray(y),l=r?y:[[0,0],[this.transform.width,this.transform.height]];if(s=s||(r?{}:y)||{},l instanceof a.P||typeof l[0]=="number")i=[a.P.convert(l)];else{const d=a.P.convert(l[0]),_=a.P.convert(l[1]);i=[d,new a.P(_.x,d.y),_,new a.P(d.x,_.y),d]}return this.style.queryRenderedFeatures(i,s,this.transform)}querySourceFeatures(y,s){return this.style.querySourceFeatures(y,s)}setStyle(y,s){return(s=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},s)).diff!==!1&&s.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,s),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._updateStyle(y,s))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){const s=this._locale[y];if(s==null)throw new Error(`Missing UI string '${y}'`);return s}_updateStyle(y,s){if(s.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(y,s));const i=this.style&&s.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!y)),y?(this.style=new Dt(this,s||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y,s,i):this.style.loadJSON(y,s,i),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Dt(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,s){if(typeof y=="string"){const i=this._requestManager.transformRequest(y,zt.Style);a.h(i,new AbortController).then(r=>{this._updateDiff(r.data,s)}).catch(r=>{r&&this.fire(new a.j(r))})}else typeof y=="object"&&this._updateDiff(y,s)}_updateDiff(y,s){try{this.style.setState(y,s)&&this._update(!0)}catch(i){a.w(`Unable to perform style diff: ${i.message||i.error||i}.  Rebuilding the style from scratch.`),this._updateStyle(y,s)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(y,s){return this._lazyInitEmptyStyle(),this.style.addSource(y,s),this._update(!0)}isSourceLoaded(y){const s=this.style&&this.style.sourceCaches[y];if(s!==void 0)return s.loaded();this.fire(new a.j(new Error(`There is no source with ID '${y}'`)))}setTerrain(y){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),y){const s=this.style.sourceCaches[y.source];if(!s)throw new Error(`cannot load terrain, because there exists no source with ID: ${y.source}`);this.terrain===null&&s.reload();for(const i in this.style._layers){const r=this.style._layers[i];r.type==="hillshade"&&r.source===y.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ws(this.painter,s,y),this.painter.renderToTexture=new fs(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=i=>{i.dataType==="style"?this.terrain.sourceCache.freeRtt():i.dataType==="source"&&i.tile&&(i.sourceId!==y.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(i.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new a.k("terrain",{terrain:y})),this}getTerrain(){var y,s;return(s=(y=this.terrain)===null||y===void 0?void 0:y.options)!==null&&s!==void 0?s:null}areTilesLoaded(){const y=this.style&&this.style.sourceCaches;for(const s in y){const i=y[s]._tiles;for(const r in i){const l=i[r];if(l.state!=="loaded"&&l.state!=="errored")return!1}}return!0}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,s,i={}){const{pixelRatio:r=1,sdf:l=!1,stretchX:d,stretchY:_,content:w}=i;if(this._lazyInitEmptyStyle(),!(s instanceof HTMLImageElement||a.b(s))){if(s.width===void 0||s.height===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:T,height:B,data:j}=s,X=s;return this.style.addImage(y,{data:new a.R({width:T,height:B},new Uint8Array(j)),pixelRatio:r,stretchX:d,stretchY:_,content:w,sdf:l,version:0,userImage:X}),X.onAdd&&X.onAdd(this,y),this}}{const{width:T,height:B,data:j}=ae.getImageData(s);this.style.addImage(y,{data:new a.R({width:T,height:B},j),pixelRatio:r,stretchX:d,stretchY:_,content:w,sdf:l,version:0})}}updateImage(y,s){const i=this.style.getImage(y);if(!i)return this.fire(new a.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const r=s instanceof HTMLImageElement||a.b(s)?ae.getImageData(s):s,{width:l,height:d,data:_}=r;if(l===void 0||d===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(l!==i.data.width||d!==i.data.height)return this.fire(new a.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const w=!(s instanceof HTMLImageElement||a.b(s));return i.data.replace(_,w),this.style.updateImage(y,i),this}getImage(y){return this.style.getImage(y)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new a.j(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y){return Tt.getImage(this._requestManager.transformRequest(y,zt.Image),new AbortController)}listImages(){return this.style.listImages()}addLayer(y,s){return this._lazyInitEmptyStyle(),this.style.addLayer(y,s),this._update(!0)}moveLayer(y,s){return this.style.moveLayer(y,s),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(y,s,i){return this.style.setLayerZoomRange(y,s,i),this._update(!0)}setFilter(y,s,i={}){return this.style.setFilter(y,s,i),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,s,i,r={}){return this.style.setPaintProperty(y,s,i,r),this._update(!0)}getPaintProperty(y,s){return this.style.getPaintProperty(y,s)}setLayoutProperty(y,s,i,r={}){return this.style.setLayoutProperty(y,s,i,r),this._update(!0)}getLayoutProperty(y,s){return this.style.getLayoutProperty(y,s)}setGlyphs(y,s={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(y,s),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(y,s,i={}){return this._lazyInitEmptyStyle(),this.style.addSprite(y,s,i,r=>{r||this._update(!0)}),this}removeSprite(y){return this._lazyInitEmptyStyle(),this.style.removeSprite(y),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(y,s={}){return this._lazyInitEmptyStyle(),this.style.setSprite(y,s,i=>{i||this._update(!0)}),this}setLight(y,s={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,s),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(y,s){return this.style.setFeatureState(y,s),this._update()}removeFeatureState(y,s){return this.style.removeFeatureState(y,s),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,s=0;return this._container&&(y=this._container.clientWidth||400,s=this._container.clientHeight||300),[y,s]}_setupContainer(){const y=this._container;y.classList.add("maplibregl-map");const s=this._canvasContainer=ce.create("div","maplibregl-canvas-container",y);this._interactive&&s.classList.add("maplibregl-interactive"),this._canvas=ce.create("canvas","maplibregl-canvas",s),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const i=this._containerDimensions(),r=this._getClampedPixelRatio(i[0],i[1]);this._resizeCanvas(i[0],i[1],r);const l=this._controlContainer=ce.create("div","maplibregl-control-container",y),d=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(_=>{d[_]=ce.create("div",`maplibregl-ctrl-${_} `,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,s,i){this._canvas.width=Math.floor(i*y),this._canvas.height=Math.floor(i*s),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${s}px`}_setupPainter(){const y={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let s=null;this._canvas.addEventListener("webglcontextcreationerror",r=>{s={requestedAttributes:y},r&&(s.statusMessage=r.statusMessage,s.type=r.type)},{once:!0});const i=this._canvas.getContext("webgl2",y)||this._canvas.getContext("webgl",y);if(!i){const r="Failed to initialize WebGL";throw s?(s.message=r,new Error(JSON.stringify(s))):new Error(r)}this.painter=new Ea(i,this.transform),be.testSupport(i)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){const s=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let i=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const l=this.transform.zoom,d=ae.now();this.style.zoomHistory.update(l,d);const _=new a.a8(l,{now:d,fadeDuration:s,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),w=_.crossFadingFactor();w===1&&w===this._crossFadingFactor||(i=!0,this._crossFadingFactor=w),this.style.update(_)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,s,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:s,showPadding:this.showPadding}),this.fire(new a.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.bb.mark(a.bc.load),this.fire(new a.k("load"))),this.style&&(this.style.hasTransitions()||i)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const r=this._sourcesDirty||this._styleDirty||this._placementDirty;return r||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.k("idle")),!this._loaded||this._fullyLoaded||r||(this._fullyLoaded=!0,a.bb.mark(a.bc.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var y;this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Tt.removeThrottleControl(this._imageQueueHandle),(y=this._resizeObserver)===null||y===void 0||y.disconnect();const s=this.painter.context.gl.getExtension("WEBGL_lose_context");s&&s.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),ce.remove(this._canvasContainer),ce.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),a.bb.clearMetrics(),this._removed=!0,this.fire(new a.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,ae.frameAsync(this._frameRequest).then(y=>{a.bb.frame(y),this._frameRequest=null,this._render(y)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get version(){return Ds}getCameraTargetElevation(){return this.transform.elevation}},S.MapMouseEvent=jn,S.MapTouchEvent=or,S.MapWheelEvent=Xn,S.Marker=We,S.NavigationControl=class{constructor(y){this._updateZoomButtons=()=>{const s=this._map.getZoom(),i=s===this._map.getMaxZoom(),r=s===this._map.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=r,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",r.toString())},this._rotateCompassArrow=()=>{const s=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=s},this._setButtonTitle=(s,i)=>{const r=this._map._getUIString(`NavigationControl.${i}`);s.title=r,s.setAttribute("aria-label",r)},this.options=a.e({},z,y),this._container=ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",s=>this._map.zoomIn({},{originalEvent:s})),ce.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",s=>this._map.zoomOut({},{originalEvent:s})),ce.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",s=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:s}):this._map.resetNorth({},{originalEvent:s})}),this._compassIcon=ce.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new R(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ce.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,s){const i=ce.create("button",y,this._container);return i.type="button",i.addEventListener("click",s),i}},S.Popup=class extends a.E{constructor(y){super(),this.remove=()=>(this._content&&ce.remove(this._content),this._container&&(ce.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map),this.fire(new a.k("close")),this),this._onMouseUp=s=>{this._update(s.point)},this._onMouseMove=s=>{this._update(s.point)},this._onDrag=s=>{this._update(s.point)},this._update=s=>{var i;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=ce.create("div","maplibregl-popup",this._map.getContainer()),this._tip=ce.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const w of this.options.className.split(" "))this._container.classList.add(w);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?le(this._lngLat,this._flatPos,this._map.transform):(i=this._lngLat)===null||i===void 0?void 0:i.wrap(),this._trackPointer&&!s)return;const r=this._flatPos=this._pos=this._trackPointer&&s?s:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&s?s:this._map.transform.locationPoint(this._lngLat));let l=this.options.anchor;const d=F(this.options.offset);if(!l){const w=this._container.offsetWidth,T=this._container.offsetHeight;let B;B=r.y+d.bottom.y<T?["top"]:r.y>this._map.transform.height-T?["bottom"]:[],r.x<w/2?B.push("left"):r.x>this._map.transform.width-w/2&&B.push("right"),l=B.length===0?"bottom":B.join("-")}let _=r.add(d[l]);this.options.subpixelPositioning||(_=_.round()),ce.setTransform(this._container,`${oe[l]} translate(${_.x}px,${_.y}px)`),we(this._container,l,"popup")},this._onClose=()=>{this.remove()},this.options=a.e(Object.create(A),y)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=a.M.convert(y),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const s=document.createDocumentFragment(),i=document.createElement("body");let r;for(i.innerHTML=y;r=i.firstChild,r;)s.appendChild(r);return this.setDOMContent(s)}getMaxWidth(){var y;return(y=this._container)===null||y===void 0?void 0:y.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ce.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){this._container&&this._container.classList.add(y)}removeClassName(y){this._container&&this._container.classList.remove(y)}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}setSubpixelPositioning(y){this.options.subpixelPositioning=y}_createCloseButton(){this.options.closeButton&&(this._closeButton=ce.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(E);y&&y.focus()}},S.RasterDEMTileSource=mr,S.RasterTileSource=Ji,S.ScaleControl=class{constructor(y){this._onMove=()=>{Zt(this._map,this._container,this.options)},this.setUnit=s=>{this.options.unit=s,Zt(this._map,this._container,this.options)},this.options=a.e({},Gt,y)}getDefaultPosition(){return"bottom-left"}onAdd(y){return this._map=y,this._container=ce.create("div","maplibregl-ctrl maplibregl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ce.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},S.ScrollZoomHandler=_a,S.Style=Dt,S.TerrainControl=class{constructor(y){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=y}onAdd(y){return this._map=y,this._container=ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=ce.create("button","maplibregl-ctrl-terrain",this._container),ce.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){ce.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},S.TwoFingersTouchPitchHandler=ta,S.TwoFingersTouchRotateHandler=Vl,S.TwoFingersTouchZoomHandler=uu,S.TwoFingersTouchZoomRotateHandler=yr,S.VectorTileSource=Xt,S.VideoSource=On,S.addSourceType=(y,s)=>a._(void 0,void 0,void 0,function*(){if(v(y))throw new Error(`A source type called "${y}" already exists.`);((i,r)=>{pn[i]=r})(y,s)}),S.clearPrewarmedResources=function(){const y=Ni;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(Ri),Ni=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},S.getMaxParallelImageRequests=function(){return a.a.MAX_PARALLEL_IMAGE_REQUESTS},S.getRTLTextPluginStatus=function(){return Y().getRTLTextPluginStatus()},S.getVersion=function(){return O},S.getWorkerCount=function(){return Ki.workerCount},S.getWorkerUrl=function(){return a.a.WORKER_URL},S.importScriptInWorkers=function(y){return mi().broadcast("importScript",y)},S.prewarm=function(){vn().acquire(Ri)},S.setMaxParallelImageRequests=function(y){a.a.MAX_PARALLEL_IMAGE_REQUESTS=y},S.setRTLTextPlugin=function(y,s){return Y().setRTLTextPlugin(y,s)},S.setWorkerCount=function(y){Ki.workerCount=y},S.setWorkerUrl=function(y){a.a.WORKER_URL=y}});var x=n;return x})})(g3);var yx=g3.exports;const Kp=hT();function hT(){const{subscribe:e,set:t,update:n}=r0(new Map);return{subscribe:e,set:t,update:n}}const Ry=r0(.78),AT=r0(1),Fy=r0({}),Oy=r0("hex"),$_=fT(),hg=r0(null);function fT(){const{subscribe:e,set:t,update:n}=r0(null);return{subscribe:e,set:t,update:n}}function vx(e,t,n){const c=e.slice();return c[21]=t[n],c}function xx(e){let t,n=e[21]+"",c;return{c(){t=Rn("option"),c=ba(n),this.h()},l(g){t=Fn(g,"OPTION",{});var x=_n(t);c=wa(x,n),x.forEach(yi),this.h()},h(){t.__value=e[21],lE(t,t.__value)},m(g,x){Un(g,t,x),qi(t,c)},p:Oa,d(g){g&&yi(t)}}}function dT(e){let t,n,c,g="Palette",x,S,a,U,W,he="Show county lines?",ae,ce,be,Je,st,Ye="Show ecoregions?",it,ct,Tt,zt,Rt,Oe="Draw Mode?",jt,at,_t="Draw Polygon",mt,xt,bt="Reset",lt,$e,pt,ut="Fill Opacity",Nt,Bt,Ot,gi,Ii=yc(e[9]),Ci=[];for(let Ri=0;Ri<Ii.length;Ri+=1)Ci[Ri]=xx(vx(e,Ii,Ri));return{c(){t=Rn("div"),n=Rn("div"),c=Rn("h4"),c.textContent=g,x=Sr(),S=Rn("select");for(let Ri=0;Ri<Ci.length;Ri+=1)Ci[Ri].c();a=Sr(),U=Rn("div"),W=Rn("h4"),W.textContent=he,ae=Sr(),ce=Rn("input"),be=Sr(),Je=Rn("div"),st=Rn("h4"),st.textContent=Ye,it=Sr(),ct=Rn("input"),Tt=Sr(),zt=Rn("div"),Rt=Rn("h4"),Rt.textContent=Oe,jt=Sr(),at=Rn("button"),at.textContent=_t,mt=Sr(),xt=Rn("button"),xt.textContent=bt,lt=Sr(),$e=Rn("div"),pt=Rn("h4"),pt.textContent=ut,Nt=Sr(),Bt=Rn("input"),this.h()},l(Ri){t=Fn(Ri,"DIV",{class:!0});var Ki=_n(t);n=Fn(Ki,"DIV",{class:!0});var Hi=_n(n);c=Fn(Hi,"H4",{class:!0,"data-svelte-h":!0}),Qu(c)!=="svelte-16skbun"&&(c.textContent=g),x=Ir(Hi),S=Fn(Hi,"SELECT",{label:!0});var Ni=_n(S);for(let zi=0;zi<Ci.length;zi+=1)Ci[zi].l(Ni);Ni.forEach(yi),Hi.forEach(yi),a=Ir(Ki),U=Fn(Ki,"DIV",{class:!0});var nn=_n(U);W=Fn(nn,"H4",{class:!0,"data-svelte-h":!0}),Qu(W)!=="svelte-tf6nwt"&&(W.textContent=he),ae=Ir(nn),ce=Fn(nn,"INPUT",{type:!0}),nn.forEach(yi),be=Ir(Ki),Je=Fn(Ki,"DIV",{class:!0});var vn=_n(Je);st=Fn(vn,"H4",{class:!0,"data-svelte-h":!0}),Qu(st)!=="svelte-1f8vskc"&&(st.textContent=Ye),it=Ir(vn),ct=Fn(vn,"INPUT",{type:!0}),vn.forEach(yi),Tt=Ir(Ki),zt=Fn(Ki,"DIV",{class:!0});var Ei=_n(zt);Rt=Fn(Ei,"H4",{class:!0,"data-svelte-h":!0}),Qu(Rt)!=="svelte-hi5xw8"&&(Rt.textContent=Oe),jt=Ir(Ei),at=Fn(Ei,"BUTTON",{"data-svelte-h":!0}),Qu(at)!=="svelte-o8r62u"&&(at.textContent=_t),mt=Ir(Ei),xt=Fn(Ei,"BUTTON",{"data-svelte-h":!0}),Qu(xt)!=="svelte-2y01av"&&(xt.textContent=bt),Ei.forEach(yi),lt=Ir(Ki),$e=Fn(Ki,"DIV",{class:!0});var mi=_n($e);pt=Fn(mi,"H4",{class:!0,"data-svelte-h":!0}),Qu(pt)!=="svelte-1fb1xwq"&&(pt.textContent=ut),Nt=Ir(mi),Bt=Fn(mi,"INPUT",{type:!0,min:!0,max:!0}),mi.forEach(yi),Ki.forEach(yi),this.h()},h(){Ti(c,"class","svelte-11w56ip"),Ti(S,"label","Color Scheme"),e[5]===void 0&&aE(()=>e[11].call(S)),Ti(n,"class","control-item svelte-11w56ip"),Ti(W,"class","svelte-11w56ip"),Ti(ce,"type","checkbox"),Ti(U,"class","control-item svelte-11w56ip"),Ti(st,"class","svelte-11w56ip"),Ti(ct,"type","checkbox"),Ti(Je,"class","control-item svelte-11w56ip"),Ti(Rt,"class","svelte-11w56ip"),Ti(zt,"class","control-item svelte-11w56ip"),Ti(pt,"class","svelte-11w56ip"),Ti(Bt,"type","range"),Ti(Bt,"min","0"),Ti(Bt,"max","100"),Bt.value=e[8]*100,Ti($e,"class","control-item svelte-11w56ip"),Ti(t,"class","controls svelte-11w56ip")},m(Ri,Ki){Un(Ri,t,Ki),qi(t,n),qi(n,c),qi(n,x),qi(n,S);for(let Hi=0;Hi<Ci.length;Hi+=1)Ci[Hi]&&Ci[Hi].m(S,null);G2(S,e[5],!0),qi(t,a),qi(t,U),qi(U,W),qi(U,ae),qi(U,ce),ce.checked=e[6],qi(t,be),qi(t,Je),qi(Je,st),qi(Je,it),qi(Je,ct),ct.checked=e[7],qi(t,Tt),qi(t,zt),qi(zt,Rt),qi(zt,jt),qi(zt,at),qi(zt,mt),qi(zt,xt),qi(t,lt),qi(t,$e),qi($e,pt),qi($e,Nt),qi($e,Bt),Ot||(gi=[Gl(S,"change",e[11]),Gl(S,"change",e[12]),Gl(ce,"change",e[13]),Gl(ce,"change",e[14]),Gl(ct,"change",e[15]),Gl(ct,"change",e[16]),Gl(at,"click",e[17]),Gl(xt,"click",e[18]),Gl(Bt,"input",e[19])],Ot=!0)},p(Ri,[Ki]){if(Ki&512){Ii=yc(Ri[9]);let Hi;for(Hi=0;Hi<Ii.length;Hi+=1){const Ni=vx(Ri,Ii,Hi);Ci[Hi]?Ci[Hi].p(Ni,Ki):(Ci[Hi]=xx(Ni),Ci[Hi].c(),Ci[Hi].m(S,null))}for(;Hi<Ci.length;Hi+=1)Ci[Hi].d(1);Ci.length=Ii.length}Ki&544&&G2(S,Ri[5]),Ki&64&&(ce.checked=Ri[6]),Ki&128&&(ct.checked=Ri[7])},i:Oa,o:Oa,d(Ri){Ri&&yi(t),G0(Ci,Ri),Ot=!1,Nh(gi)}}}function pT(e,t,n){let c;Bu(e,Ry,at=>n(20,c=at));let{updateColorScheme:g}=t,{updateShowCounties:x}=t,{updateShowEcoregions:S}=t,{updateDrawing:a}=t,{updateDrawnPath:U}=t,{isDrawing:W}=t,he,ae,ce,be=c;const Je=Object.keys(zv);bc(()=>{g(he)});function st(){he=uE(this),n(5,he),n(9,Je)}const Ye=()=>g(he);function it(){ae=this.checked,n(6,ae)}const ct=()=>x(ae);function Tt(){ce=this.checked,n(7,ce)}const zt=()=>S(ce),Rt=()=>a(!0),Oe=()=>U(null),jt=at=>Ry.set(Number.parseInt(at.target.value)/100);return e.$$set=at=>{"updateColorScheme"in at&&n(0,g=at.updateColorScheme),"updateShowCounties"in at&&n(1,x=at.updateShowCounties),"updateShowEcoregions"in at&&n(2,S=at.updateShowEcoregions),"updateDrawing"in at&&n(3,a=at.updateDrawing),"updateDrawnPath"in at&&n(4,U=at.updateDrawnPath),"isDrawing"in at&&n(10,W=at.isDrawing)},[g,x,S,a,U,he,ae,ce,be,Je,W,st,Ye,it,ct,Tt,zt,Rt,Oe,jt]}class mT extends fo{constructor(t){super(),po(this,t,pT,dT,Va,{updateColorScheme:0,updateShowCounties:1,updateShowEcoregions:2,updateDrawing:3,updateDrawnPath:4,isDrawing:10})}}function gT(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var y3={exports:{}};const _T={},yT=Object.freeze(Object.defineProperty({__proto__:null,default:_T},Symbol.toStringTag,{value:"Module"})),bx=Rv(yT);var Ug={exports:{}},wx;function vT(){return wx||(wx=1,function(e,t){(function(n,c){c(t)})(Jf,function(n){var c=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,81,2,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,9,5351,0,7,14,13835,9,87,9,39,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,4706,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,983,6,110,6,6,9,4759,9,787719,239],g=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,68,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,4026,582,8634,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,757,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],x="-----------------------------------------------------------------------------------------------------------------------------------------------------",S="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",a={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},U="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",W={5:U,"5module":U+" export import",6:U+" const class extends export import super"},he=/^in(stanceof)?$/,ae=new RegExp("["+S+"]"),ce=new RegExp("["+S+x+"]");function be(N,xe){for(var nt=65536,It=0;It<xe.length;It+=2){if(nt+=xe[It],nt>N)return!1;if(nt+=xe[It+1],nt>=N)return!0}return!1}function Je(N,xe){return N<65?N===36:N<91?!0:N<97?N===95:N<123?!0:N<=65535?N>=170&&ae.test(String.fromCharCode(N)):xe===!1?!1:be(N,g)}function st(N,xe){return N<48?N===36:N<58?!0:N<65?!1:N<91?!0:N<97?N===95:N<123?!0:N<=65535?N>=170&&ce.test(String.fromCharCode(N)):xe===!1?!1:be(N,g)||be(N,c)}var Ye=function(xe,nt){nt===void 0&&(nt={}),this.label=xe,this.keyword=nt.keyword,this.beforeExpr=!!nt.beforeExpr,this.startsExpr=!!nt.startsExpr,this.isLoop=!!nt.isLoop,this.isAssign=!!nt.isAssign,this.prefix=!!nt.prefix,this.postfix=!!nt.postfix,this.binop=nt.binop||null,this.updateContext=null};function it(N,xe){return new Ye(N,{beforeExpr:!0,binop:xe})}var ct={beforeExpr:!0},Tt={startsExpr:!0},zt={};function Rt(N,xe){return xe===void 0&&(xe={}),xe.keyword=N,zt[N]=new Ye(N,xe)}var Oe={num:new Ye("num",Tt),regexp:new Ye("regexp",Tt),string:new Ye("string",Tt),name:new Ye("name",Tt),privateId:new Ye("privateId",Tt),eof:new Ye("eof"),bracketL:new Ye("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new Ye("]"),braceL:new Ye("{",{beforeExpr:!0,startsExpr:!0}),braceR:new Ye("}"),parenL:new Ye("(",{beforeExpr:!0,startsExpr:!0}),parenR:new Ye(")"),comma:new Ye(",",ct),semi:new Ye(";",ct),colon:new Ye(":",ct),dot:new Ye("."),question:new Ye("?",ct),questionDot:new Ye("?."),arrow:new Ye("=>",ct),template:new Ye("template"),invalidTemplate:new Ye("invalidTemplate"),ellipsis:new Ye("...",ct),backQuote:new Ye("`",Tt),dollarBraceL:new Ye("${",{beforeExpr:!0,startsExpr:!0}),eq:new Ye("=",{beforeExpr:!0,isAssign:!0}),assign:new Ye("_=",{beforeExpr:!0,isAssign:!0}),incDec:new Ye("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new Ye("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:it("||",1),logicalAND:it("&&",2),bitwiseOR:it("|",3),bitwiseXOR:it("^",4),bitwiseAND:it("&",5),equality:it("==/!=/===/!==",6),relational:it("</>/<=/>=",7),bitShift:it("<</>>/>>>",8),plusMin:new Ye("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:it("%",10),star:it("*",10),slash:it("/",10),starstar:new Ye("**",{beforeExpr:!0}),coalesce:it("??",1),_break:Rt("break"),_case:Rt("case",ct),_catch:Rt("catch"),_continue:Rt("continue"),_debugger:Rt("debugger"),_default:Rt("default",ct),_do:Rt("do",{isLoop:!0,beforeExpr:!0}),_else:Rt("else",ct),_finally:Rt("finally"),_for:Rt("for",{isLoop:!0}),_function:Rt("function",Tt),_if:Rt("if"),_return:Rt("return",ct),_switch:Rt("switch"),_throw:Rt("throw",ct),_try:Rt("try"),_var:Rt("var"),_const:Rt("const"),_while:Rt("while",{isLoop:!0}),_with:Rt("with"),_new:Rt("new",{beforeExpr:!0,startsExpr:!0}),_this:Rt("this",Tt),_super:Rt("super",Tt),_class:Rt("class",Tt),_extends:Rt("extends",ct),_export:Rt("export"),_import:Rt("import",Tt),_null:Rt("null",Tt),_true:Rt("true",Tt),_false:Rt("false",Tt),_in:Rt("in",{beforeExpr:!0,binop:7}),_instanceof:Rt("instanceof",{beforeExpr:!0,binop:7}),_typeof:Rt("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Rt("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Rt("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},jt=/\r\n?|\n|\u2028|\u2029/,at=new RegExp(jt.source,"g");function _t(N){return N===10||N===13||N===8232||N===8233}function mt(N,xe,nt){nt===void 0&&(nt=N.length);for(var It=xe;It<nt;It++){var $t=N.charCodeAt(It);if(_t($t))return It<nt-1&&$t===13&&N.charCodeAt(It+1)===10?It+2:It+1}return-1}var xt=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,bt=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,lt=Object.prototype,$e=lt.hasOwnProperty,pt=lt.toString,ut=Object.hasOwn||function(N,xe){return $e.call(N,xe)},Nt=Array.isArray||function(N){return pt.call(N)==="[object Array]"},Bt=Object.create(null);function Ot(N){return Bt[N]||(Bt[N]=new RegExp("^(?:"+N.replace(/ /g,"|")+")$"))}function gi(N){return N<=65535?String.fromCharCode(N):(N-=65536,String.fromCharCode((N>>10)+55296,(N&1023)+56320))}var Ii=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,Ci=function(xe,nt){this.line=xe,this.column=nt};Ci.prototype.offset=function(xe){return new Ci(this.line,this.column+xe)};var Ri=function(xe,nt,It){this.start=nt,this.end=It,xe.sourceFile!==null&&(this.source=xe.sourceFile)};function Ki(N,xe){for(var nt=1,It=0;;){var $t=mt(N,It,xe);if($t<0)return new Ci(nt,xe-It);++nt,It=$t}}var Hi={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},Ni=!1;function nn(N){var xe={};for(var nt in Hi)xe[nt]=N&&ut(N,nt)?N[nt]:Hi[nt];if(xe.ecmaVersion==="latest"?xe.ecmaVersion=1e8:xe.ecmaVersion==null?(!Ni&&typeof console=="object"&&console.warn&&(Ni=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),xe.ecmaVersion=11):xe.ecmaVersion>=2015&&(xe.ecmaVersion-=2009),xe.allowReserved==null&&(xe.allowReserved=xe.ecmaVersion<5),(!N||N.allowHashBang==null)&&(xe.allowHashBang=xe.ecmaVersion>=14),Nt(xe.onToken)){var It=xe.onToken;xe.onToken=function($t){return It.push($t)}}return Nt(xe.onComment)&&(xe.onComment=vn(xe,xe.onComment)),xe}function vn(N,xe){return function(nt,It,$t,wi,Di,hn){var dn={type:nt?"Block":"Line",value:It,start:$t,end:wi};N.locations&&(dn.loc=new Ri(this,Di,hn)),N.ranges&&(dn.range=[$t,wi]),xe.push(dn)}}var Ei=1,mi=2,zi=4,Oi=8,xn=16,bn=32,Yt=64,rn=128,Xt=256,Ji=Ei|mi|Xt;function mr(N,xe){return mi|(N?zi:0)|(xe?Oi:0)}var ci=0,sn=1,lr=2,On=3,Gn=4,pn=5,v=function(xe,nt,It){this.options=xe=nn(xe),this.sourceFile=xe.sourceFile,this.keywords=Ot(W[xe.ecmaVersion>=6?6:xe.sourceType==="module"?"5module":5]);var $t="";xe.allowReserved!==!0&&($t=a[xe.ecmaVersion>=6?6:xe.ecmaVersion===5?5:3],xe.sourceType==="module"&&($t+=" await")),this.reservedWords=Ot($t);var wi=($t?$t+" ":"")+a.strict;this.reservedWordsStrict=Ot(wi),this.reservedWordsStrictBind=Ot(wi+" "+a.strictBind),this.input=String(nt),this.containsEsc=!1,It?(this.pos=It,this.lineStart=this.input.lastIndexOf(`
`,It-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(jt).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=Oe.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=xe.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&xe.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(Ei),this.regexpState=null,this.privateNameStack=[]},k={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};v.prototype.parse=function(){var xe=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(xe)},k.inFunction.get=function(){return(this.currentVarScope().flags&mi)>0},k.inGenerator.get=function(){return(this.currentVarScope().flags&Oi)>0&&!this.currentVarScope().inClassFieldInit},k.inAsync.get=function(){return(this.currentVarScope().flags&zi)>0&&!this.currentVarScope().inClassFieldInit},k.canAwait.get=function(){for(var N=this.scopeStack.length-1;N>=0;N--){var xe=this.scopeStack[N];if(xe.inClassFieldInit||xe.flags&Xt)return!1;if(xe.flags&mi)return(xe.flags&zi)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction},k.allowSuper.get=function(){var N=this.currentThisScope(),xe=N.flags,nt=N.inClassFieldInit;return(xe&Yt)>0||nt||this.options.allowSuperOutsideMethod},k.allowDirectSuper.get=function(){return(this.currentThisScope().flags&rn)>0},k.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},k.allowNewDotTarget.get=function(){var N=this.currentThisScope(),xe=N.flags,nt=N.inClassFieldInit;return(xe&(mi|Xt))>0||nt},k.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&Xt)>0},v.extend=function(){for(var xe=[],nt=arguments.length;nt--;)xe[nt]=arguments[nt];for(var It=this,$t=0;$t<xe.length;$t++)It=xe[$t](It);return It},v.parse=function(xe,nt){return new this(nt,xe).parse()},v.parseExpressionAt=function(xe,nt,It){var $t=new this(It,xe,nt);return $t.nextToken(),$t.parseExpression()},v.tokenizer=function(xe,nt){return new this(nt,xe)},Object.defineProperties(v.prototype,k);var V=v.prototype,Y=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;V.strictDirective=function(N){if(this.options.ecmaVersion<5)return!1;for(;;){bt.lastIndex=N,N+=bt.exec(this.input)[0].length;var xe=Y.exec(this.input.slice(N));if(!xe)return!1;if((xe[1]||xe[2])==="use strict"){bt.lastIndex=N+xe[0].length;var nt=bt.exec(this.input),It=nt.index+nt[0].length,$t=this.input.charAt(It);return $t===";"||$t==="}"||jt.test(nt[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test($t)||$t==="!"&&this.input.charAt(It+1)==="=")}N+=xe[0].length,bt.lastIndex=N,N+=bt.exec(this.input)[0].length,this.input[N]===";"&&N++}},V.eat=function(N){return this.type===N?(this.next(),!0):!1},V.isContextual=function(N){return this.type===Oe.name&&this.value===N&&!this.containsEsc},V.eatContextual=function(N){return this.isContextual(N)?(this.next(),!0):!1},V.expectContextual=function(N){this.eatContextual(N)||this.unexpected()},V.canInsertSemicolon=function(){return this.type===Oe.eof||this.type===Oe.braceR||jt.test(this.input.slice(this.lastTokEnd,this.start))},V.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},V.semicolon=function(){!this.eat(Oe.semi)&&!this.insertSemicolon()&&this.unexpected()},V.afterTrailingComma=function(N,xe){if(this.type===N)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),xe||this.next(),!0},V.expect=function(N){this.eat(N)||this.unexpected()},V.unexpected=function(N){this.raise(N??this.start,"Unexpected token")};var te=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};V.checkPatternErrors=function(N,xe){if(N){N.trailingComma>-1&&this.raiseRecoverable(N.trailingComma,"Comma is not permitted after the rest element");var nt=xe?N.parenthesizedAssign:N.parenthesizedBind;nt>-1&&this.raiseRecoverable(nt,xe?"Assigning to rvalue":"Parenthesized pattern")}},V.checkExpressionErrors=function(N,xe){if(!N)return!1;var nt=N.shorthandAssign,It=N.doubleProto;if(!xe)return nt>=0||It>=0;nt>=0&&this.raise(nt,"Shorthand property assignments are valid only in destructuring patterns"),It>=0&&this.raiseRecoverable(It,"Redefinition of __proto__ property")},V.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},V.isSimpleAssignTarget=function(N){return N.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(N.expression):N.type==="Identifier"||N.type==="MemberExpression"};var fe=v.prototype;fe.parseTopLevel=function(N){var xe=Object.create(null);for(N.body||(N.body=[]);this.type!==Oe.eof;){var nt=this.parseStatement(null,!0,xe);N.body.push(nt)}if(this.inModule)for(var It=0,$t=Object.keys(this.undefinedExports);It<$t.length;It+=1){var wi=$t[It];this.raiseRecoverable(this.undefinedExports[wi].start,"Export '"+wi+"' is not defined")}return this.adaptDirectivePrologue(N.body),this.next(),N.sourceType=this.options.sourceType,this.finishNode(N,"Program")};var ve={kind:"loop"},Ie={kind:"switch"};fe.isLet=function(N){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;bt.lastIndex=this.pos;var xe=bt.exec(this.input),nt=this.pos+xe[0].length,It=this.input.charCodeAt(nt);if(It===91||It===92)return!0;if(N)return!1;if(It===123||It>55295&&It<56320)return!0;if(Je(It,!0)){for(var $t=nt+1;st(It=this.input.charCodeAt($t),!0);)++$t;if(It===92||It>55295&&It<56320)return!0;var wi=this.input.slice(nt,$t);if(!he.test(wi))return!0}return!1},fe.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;bt.lastIndex=this.pos;var N=bt.exec(this.input),xe=this.pos+N[0].length,nt;return!jt.test(this.input.slice(this.pos,xe))&&this.input.slice(xe,xe+8)==="function"&&(xe+8===this.input.length||!(st(nt=this.input.charCodeAt(xe+8))||nt>55295&&nt<56320))},fe.parseStatement=function(N,xe,nt){var It=this.type,$t=this.startNode(),wi;switch(this.isLet(N)&&(It=Oe._var,wi="let"),It){case Oe._break:case Oe._continue:return this.parseBreakContinueStatement($t,It.keyword);case Oe._debugger:return this.parseDebuggerStatement($t);case Oe._do:return this.parseDoStatement($t);case Oe._for:return this.parseForStatement($t);case Oe._function:return N&&(this.strict||N!=="if"&&N!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement($t,!1,!N);case Oe._class:return N&&this.unexpected(),this.parseClass($t,!0);case Oe._if:return this.parseIfStatement($t);case Oe._return:return this.parseReturnStatement($t);case Oe._switch:return this.parseSwitchStatement($t);case Oe._throw:return this.parseThrowStatement($t);case Oe._try:return this.parseTryStatement($t);case Oe._const:case Oe._var:return wi=wi||this.value,N&&wi!=="var"&&this.unexpected(),this.parseVarStatement($t,wi);case Oe._while:return this.parseWhileStatement($t);case Oe._with:return this.parseWithStatement($t);case Oe.braceL:return this.parseBlock(!0,$t);case Oe.semi:return this.parseEmptyStatement($t);case Oe._export:case Oe._import:if(this.options.ecmaVersion>10&&It===Oe._import){bt.lastIndex=this.pos;var Di=bt.exec(this.input),hn=this.pos+Di[0].length,dn=this.input.charCodeAt(hn);if(dn===40||dn===46)return this.parseExpressionStatement($t,this.parseExpression())}return this.options.allowImportExportEverywhere||(xe||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),It===Oe._import?this.parseImport($t):this.parseExport($t,nt);default:if(this.isAsyncFunction())return N&&this.unexpected(),this.next(),this.parseFunctionStatement($t,!0,!N);var rr=this.value,Ar=this.parseExpression();return It===Oe.name&&Ar.type==="Identifier"&&this.eat(Oe.colon)?this.parseLabeledStatement($t,rr,Ar,N):this.parseExpressionStatement($t,Ar)}},fe.parseBreakContinueStatement=function(N,xe){var nt=xe==="break";this.next(),this.eat(Oe.semi)||this.insertSemicolon()?N.label=null:this.type!==Oe.name?this.unexpected():(N.label=this.parseIdent(),this.semicolon());for(var It=0;It<this.labels.length;++It){var $t=this.labels[It];if((N.label==null||$t.name===N.label.name)&&($t.kind!=null&&(nt||$t.kind==="loop")||N.label&&nt))break}return It===this.labels.length&&this.raise(N.start,"Unsyntactic "+xe),this.finishNode(N,nt?"BreakStatement":"ContinueStatement")},fe.parseDebuggerStatement=function(N){return this.next(),this.semicolon(),this.finishNode(N,"DebuggerStatement")},fe.parseDoStatement=function(N){return this.next(),this.labels.push(ve),N.body=this.parseStatement("do"),this.labels.pop(),this.expect(Oe._while),N.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(Oe.semi):this.semicolon(),this.finishNode(N,"DoWhileStatement")},fe.parseForStatement=function(N){this.next();var xe=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(ve),this.enterScope(0),this.expect(Oe.parenL),this.type===Oe.semi)return xe>-1&&this.unexpected(xe),this.parseFor(N,null);var nt=this.isLet();if(this.type===Oe._var||this.type===Oe._const||nt){var It=this.startNode(),$t=nt?"let":this.value;return this.next(),this.parseVar(It,!0,$t),this.finishNode(It,"VariableDeclaration"),(this.type===Oe._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&It.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===Oe._in?xe>-1&&this.unexpected(xe):N.await=xe>-1),this.parseForIn(N,It)):(xe>-1&&this.unexpected(xe),this.parseFor(N,It))}var wi=this.isContextual("let"),Di=!1,hn=new te,dn=this.parseExpression(xe>-1?"await":!0,hn);return this.type===Oe._in||(Di=this.options.ecmaVersion>=6&&this.isContextual("of"))?(this.options.ecmaVersion>=9&&(this.type===Oe._in?xe>-1&&this.unexpected(xe):N.await=xe>-1),wi&&Di&&this.raise(dn.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(dn,!1,hn),this.checkLValPattern(dn),this.parseForIn(N,dn)):(this.checkExpressionErrors(hn,!0),xe>-1&&this.unexpected(xe),this.parseFor(N,dn))},fe.parseFunctionStatement=function(N,xe,nt){return this.next(),this.parseFunction(N,ze|(nt?0:Qe),!1,xe)},fe.parseIfStatement=function(N){return this.next(),N.test=this.parseParenExpression(),N.consequent=this.parseStatement("if"),N.alternate=this.eat(Oe._else)?this.parseStatement("if"):null,this.finishNode(N,"IfStatement")},fe.parseReturnStatement=function(N){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(Oe.semi)||this.insertSemicolon()?N.argument=null:(N.argument=this.parseExpression(),this.semicolon()),this.finishNode(N,"ReturnStatement")},fe.parseSwitchStatement=function(N){this.next(),N.discriminant=this.parseParenExpression(),N.cases=[],this.expect(Oe.braceL),this.labels.push(Ie),this.enterScope(0);for(var xe,nt=!1;this.type!==Oe.braceR;)if(this.type===Oe._case||this.type===Oe._default){var It=this.type===Oe._case;xe&&this.finishNode(xe,"SwitchCase"),N.cases.push(xe=this.startNode()),xe.consequent=[],this.next(),It?xe.test=this.parseExpression():(nt&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),nt=!0,xe.test=null),this.expect(Oe.colon)}else xe||this.unexpected(),xe.consequent.push(this.parseStatement(null));return this.exitScope(),xe&&this.finishNode(xe,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(N,"SwitchStatement")},fe.parseThrowStatement=function(N){return this.next(),jt.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),N.argument=this.parseExpression(),this.semicolon(),this.finishNode(N,"ThrowStatement")};var Ee=[];fe.parseCatchClauseParam=function(){var N=this.parseBindingAtom(),xe=N.type==="Identifier";return this.enterScope(xe?bn:0),this.checkLValPattern(N,xe?Gn:lr),this.expect(Oe.parenR),N},fe.parseTryStatement=function(N){if(this.next(),N.block=this.parseBlock(),N.handler=null,this.type===Oe._catch){var xe=this.startNode();this.next(),this.eat(Oe.parenL)?xe.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),xe.param=null,this.enterScope(0)),xe.body=this.parseBlock(!1),this.exitScope(),N.handler=this.finishNode(xe,"CatchClause")}return N.finalizer=this.eat(Oe._finally)?this.parseBlock():null,!N.handler&&!N.finalizer&&this.raise(N.start,"Missing catch or finally clause"),this.finishNode(N,"TryStatement")},fe.parseVarStatement=function(N,xe,nt){return this.next(),this.parseVar(N,!1,xe,nt),this.semicolon(),this.finishNode(N,"VariableDeclaration")},fe.parseWhileStatement=function(N){return this.next(),N.test=this.parseParenExpression(),this.labels.push(ve),N.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(N,"WhileStatement")},fe.parseWithStatement=function(N){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),N.object=this.parseParenExpression(),N.body=this.parseStatement("with"),this.finishNode(N,"WithStatement")},fe.parseEmptyStatement=function(N){return this.next(),this.finishNode(N,"EmptyStatement")},fe.parseLabeledStatement=function(N,xe,nt,It){for(var $t=0,wi=this.labels;$t<wi.length;$t+=1){var Di=wi[$t];Di.name===xe&&this.raise(nt.start,"Label '"+xe+"' is already declared")}for(var hn=this.type.isLoop?"loop":this.type===Oe._switch?"switch":null,dn=this.labels.length-1;dn>=0;dn--){var rr=this.labels[dn];if(rr.statementStart===N.start)rr.statementStart=this.start,rr.kind=hn;else break}return this.labels.push({name:xe,kind:hn,statementStart:this.start}),N.body=this.parseStatement(It?It.indexOf("label")===-1?It+"label":It:"label"),this.labels.pop(),N.label=nt,this.finishNode(N,"LabeledStatement")},fe.parseExpressionStatement=function(N,xe){return N.expression=xe,this.semicolon(),this.finishNode(N,"ExpressionStatement")},fe.parseBlock=function(N,xe,nt){for(N===void 0&&(N=!0),xe===void 0&&(xe=this.startNode()),xe.body=[],this.expect(Oe.braceL),N&&this.enterScope(0);this.type!==Oe.braceR;){var It=this.parseStatement(null);xe.body.push(It)}return nt&&(this.strict=!1),this.next(),N&&this.exitScope(),this.finishNode(xe,"BlockStatement")},fe.parseFor=function(N,xe){return N.init=xe,this.expect(Oe.semi),N.test=this.type===Oe.semi?null:this.parseExpression(),this.expect(Oe.semi),N.update=this.type===Oe.parenR?null:this.parseExpression(),this.expect(Oe.parenR),N.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(N,"ForStatement")},fe.parseForIn=function(N,xe){var nt=this.type===Oe._in;return this.next(),xe.type==="VariableDeclaration"&&xe.declarations[0].init!=null&&(!nt||this.options.ecmaVersion<8||this.strict||xe.kind!=="var"||xe.declarations[0].id.type!=="Identifier")&&this.raise(xe.start,(nt?"for-in":"for-of")+" loop variable declaration may not have an initializer"),N.left=xe,N.right=nt?this.parseExpression():this.parseMaybeAssign(),this.expect(Oe.parenR),N.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(N,nt?"ForInStatement":"ForOfStatement")},fe.parseVar=function(N,xe,nt,It){for(N.declarations=[],N.kind=nt;;){var $t=this.startNode();if(this.parseVarId($t,nt),this.eat(Oe.eq)?$t.init=this.parseMaybeAssign(xe):!It&&nt==="const"&&!(this.type===Oe._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!It&&$t.id.type!=="Identifier"&&!(xe&&(this.type===Oe._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):$t.init=null,N.declarations.push(this.finishNode($t,"VariableDeclarator")),!this.eat(Oe.comma))break}return N},fe.parseVarId=function(N,xe){N.id=this.parseBindingAtom(),this.checkLValPattern(N.id,xe==="var"?sn:lr,!1)};var ze=1,Qe=2,He=4;fe.parseFunction=function(N,xe,nt,It,$t){this.initFunction(N),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!It)&&(this.type===Oe.star&&xe&Qe&&this.unexpected(),N.generator=this.eat(Oe.star)),this.options.ecmaVersion>=8&&(N.async=!!It),xe&ze&&(N.id=xe&He&&this.type!==Oe.name?null:this.parseIdent(),N.id&&!(xe&Qe)&&this.checkLValSimple(N.id,this.strict||N.generator||N.async?this.treatFunctionsAsVar?sn:lr:On));var wi=this.yieldPos,Di=this.awaitPos,hn=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(mr(N.async,N.generator)),xe&ze||(N.id=this.type===Oe.name?this.parseIdent():null),this.parseFunctionParams(N),this.parseFunctionBody(N,nt,!1,$t),this.yieldPos=wi,this.awaitPos=Di,this.awaitIdentPos=hn,this.finishNode(N,xe&ze?"FunctionDeclaration":"FunctionExpression")},fe.parseFunctionParams=function(N){this.expect(Oe.parenL),N.params=this.parseBindingList(Oe.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},fe.parseClass=function(N,xe){this.next();var nt=this.strict;this.strict=!0,this.parseClassId(N,xe),this.parseClassSuper(N);var It=this.enterClassBody(),$t=this.startNode(),wi=!1;for($t.body=[],this.expect(Oe.braceL);this.type!==Oe.braceR;){var Di=this.parseClassElement(N.superClass!==null);Di&&($t.body.push(Di),Di.type==="MethodDefinition"&&Di.kind==="constructor"?(wi&&this.raiseRecoverable(Di.start,"Duplicate constructor in the same class"),wi=!0):Di.key&&Di.key.type==="PrivateIdentifier"&&Ze(It,Di)&&this.raiseRecoverable(Di.key.start,"Identifier '#"+Di.key.name+"' has already been declared"))}return this.strict=nt,this.next(),N.body=this.finishNode($t,"ClassBody"),this.exitClassBody(),this.finishNode(N,xe?"ClassDeclaration":"ClassExpression")},fe.parseClassElement=function(N){if(this.eat(Oe.semi))return null;var xe=this.options.ecmaVersion,nt=this.startNode(),It="",$t=!1,wi=!1,Di="method",hn=!1;if(this.eatContextual("static")){if(xe>=13&&this.eat(Oe.braceL))return this.parseClassStaticBlock(nt),nt;this.isClassElementNameStart()||this.type===Oe.star?hn=!0:It="static"}if(nt.static=hn,!It&&xe>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===Oe.star)&&!this.canInsertSemicolon()?wi=!0:It="async"),!It&&(xe>=9||!wi)&&this.eat(Oe.star)&&($t=!0),!It&&!wi&&!$t){var dn=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?Di=dn:It=dn)}if(It?(nt.computed=!1,nt.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),nt.key.name=It,this.finishNode(nt.key,"Identifier")):this.parseClassElementName(nt),xe<13||this.type===Oe.parenL||Di!=="method"||$t||wi){var rr=!nt.static&&Ue(nt,"constructor"),Ar=rr&&N;rr&&Di!=="method"&&this.raise(nt.key.start,"Constructor can't have get/set modifier"),nt.kind=rr?"constructor":Di,this.parseClassMethod(nt,$t,wi,Ar)}else this.parseClassField(nt);return nt},fe.isClassElementNameStart=function(){return this.type===Oe.name||this.type===Oe.privateId||this.type===Oe.num||this.type===Oe.string||this.type===Oe.bracketL||this.type.keyword},fe.parseClassElementName=function(N){this.type===Oe.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),N.computed=!1,N.key=this.parsePrivateIdent()):this.parsePropertyName(N)},fe.parseClassMethod=function(N,xe,nt,It){var $t=N.key;N.kind==="constructor"?(xe&&this.raise($t.start,"Constructor can't be a generator"),nt&&this.raise($t.start,"Constructor can't be an async method")):N.static&&Ue(N,"prototype")&&this.raise($t.start,"Classes may not have a static property named prototype");var wi=N.value=this.parseMethod(xe,nt,It);return N.kind==="get"&&wi.params.length!==0&&this.raiseRecoverable(wi.start,"getter should have no params"),N.kind==="set"&&wi.params.length!==1&&this.raiseRecoverable(wi.start,"setter should have exactly one param"),N.kind==="set"&&wi.params[0].type==="RestElement"&&this.raiseRecoverable(wi.params[0].start,"Setter cannot use rest params"),this.finishNode(N,"MethodDefinition")},fe.parseClassField=function(N){if(Ue(N,"constructor")?this.raise(N.key.start,"Classes can't have a field named 'constructor'"):N.static&&Ue(N,"prototype")&&this.raise(N.key.start,"Classes can't have a static field named 'prototype'"),this.eat(Oe.eq)){var xe=this.currentThisScope(),nt=xe.inClassFieldInit;xe.inClassFieldInit=!0,N.value=this.parseMaybeAssign(),xe.inClassFieldInit=nt}else N.value=null;return this.semicolon(),this.finishNode(N,"PropertyDefinition")},fe.parseClassStaticBlock=function(N){N.body=[];var xe=this.labels;for(this.labels=[],this.enterScope(Xt|Yt);this.type!==Oe.braceR;){var nt=this.parseStatement(null);N.body.push(nt)}return this.next(),this.exitScope(),this.labels=xe,this.finishNode(N,"StaticBlock")},fe.parseClassId=function(N,xe){this.type===Oe.name?(N.id=this.parseIdent(),xe&&this.checkLValSimple(N.id,lr,!1)):(xe===!0&&this.unexpected(),N.id=null)},fe.parseClassSuper=function(N){N.superClass=this.eat(Oe._extends)?this.parseExprSubscripts(null,!1):null},fe.enterClassBody=function(){var N={declared:Object.create(null),used:[]};return this.privateNameStack.push(N),N.declared},fe.exitClassBody=function(){var N=this.privateNameStack.pop(),xe=N.declared,nt=N.used;if(this.options.checkPrivateFields)for(var It=this.privateNameStack.length,$t=It===0?null:this.privateNameStack[It-1],wi=0;wi<nt.length;++wi){var Di=nt[wi];ut(xe,Di.name)||($t?$t.used.push(Di):this.raiseRecoverable(Di.start,"Private field '#"+Di.name+"' must be declared in an enclosing class"))}};function Ze(N,xe){var nt=xe.key.name,It=N[nt],$t="true";return xe.type==="MethodDefinition"&&(xe.kind==="get"||xe.kind==="set")&&($t=(xe.static?"s":"i")+xe.kind),It==="iget"&&$t==="iset"||It==="iset"&&$t==="iget"||It==="sget"&&$t==="sset"||It==="sset"&&$t==="sget"?(N[nt]="true",!1):It?!0:(N[nt]=$t,!1)}function Ue(N,xe){var nt=N.computed,It=N.key;return!nt&&(It.type==="Identifier"&&It.name===xe||It.type==="Literal"&&It.value===xe)}fe.parseExportAllDeclaration=function(N,xe){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(N.exported=this.parseModuleExportName(),this.checkExport(xe,N.exported,this.lastTokStart)):N.exported=null),this.expectContextual("from"),this.type!==Oe.string&&this.unexpected(),N.source=this.parseExprAtom(),this.semicolon(),this.finishNode(N,"ExportAllDeclaration")},fe.parseExport=function(N,xe){if(this.next(),this.eat(Oe.star))return this.parseExportAllDeclaration(N,xe);if(this.eat(Oe._default))return this.checkExport(xe,"default",this.lastTokStart),N.declaration=this.parseExportDefaultDeclaration(),this.finishNode(N,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())N.declaration=this.parseExportDeclaration(N),N.declaration.type==="VariableDeclaration"?this.checkVariableExport(xe,N.declaration.declarations):this.checkExport(xe,N.declaration.id,N.declaration.id.start),N.specifiers=[],N.source=null;else{if(N.declaration=null,N.specifiers=this.parseExportSpecifiers(xe),this.eatContextual("from"))this.type!==Oe.string&&this.unexpected(),N.source=this.parseExprAtom();else{for(var nt=0,It=N.specifiers;nt<It.length;nt+=1){var $t=It[nt];this.checkUnreserved($t.local),this.checkLocalExport($t.local),$t.local.type==="Literal"&&this.raise($t.local.start,"A string literal cannot be used as an exported binding without `from`.")}N.source=null}this.semicolon()}return this.finishNode(N,"ExportNamedDeclaration")},fe.parseExportDeclaration=function(N){return this.parseStatement(null)},fe.parseExportDefaultDeclaration=function(){var N;if(this.type===Oe._function||(N=this.isAsyncFunction())){var xe=this.startNode();return this.next(),N&&this.next(),this.parseFunction(xe,ze|He,!1,N)}else if(this.type===Oe._class){var nt=this.startNode();return this.parseClass(nt,"nullableID")}else{var It=this.parseMaybeAssign();return this.semicolon(),It}},fe.checkExport=function(N,xe,nt){N&&(typeof xe!="string"&&(xe=xe.type==="Identifier"?xe.name:xe.value),ut(N,xe)&&this.raiseRecoverable(nt,"Duplicate export '"+xe+"'"),N[xe]=!0)},fe.checkPatternExport=function(N,xe){var nt=xe.type;if(nt==="Identifier")this.checkExport(N,xe,xe.start);else if(nt==="ObjectPattern")for(var It=0,$t=xe.properties;It<$t.length;It+=1){var wi=$t[It];this.checkPatternExport(N,wi)}else if(nt==="ArrayPattern")for(var Di=0,hn=xe.elements;Di<hn.length;Di+=1){var dn=hn[Di];dn&&this.checkPatternExport(N,dn)}else nt==="Property"?this.checkPatternExport(N,xe.value):nt==="AssignmentPattern"?this.checkPatternExport(N,xe.left):nt==="RestElement"&&this.checkPatternExport(N,xe.argument)},fe.checkVariableExport=function(N,xe){if(N)for(var nt=0,It=xe;nt<It.length;nt+=1){var $t=It[nt];this.checkPatternExport(N,$t.id)}},fe.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},fe.parseExportSpecifier=function(N){var xe=this.startNode();return xe.local=this.parseModuleExportName(),xe.exported=this.eatContextual("as")?this.parseModuleExportName():xe.local,this.checkExport(N,xe.exported,xe.exported.start),this.finishNode(xe,"ExportSpecifier")},fe.parseExportSpecifiers=function(N){var xe=[],nt=!0;for(this.expect(Oe.braceL);!this.eat(Oe.braceR);){if(nt)nt=!1;else if(this.expect(Oe.comma),this.afterTrailingComma(Oe.braceR))break;xe.push(this.parseExportSpecifier(N))}return xe},fe.parseImport=function(N){return this.next(),this.type===Oe.string?(N.specifiers=Ee,N.source=this.parseExprAtom()):(N.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),N.source=this.type===Oe.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(N,"ImportDeclaration")},fe.parseImportSpecifier=function(){var N=this.startNode();return N.imported=this.parseModuleExportName(),this.eatContextual("as")?N.local=this.parseIdent():(this.checkUnreserved(N.imported),N.local=N.imported),this.checkLValSimple(N.local,lr),this.finishNode(N,"ImportSpecifier")},fe.parseImportDefaultSpecifier=function(){var N=this.startNode();return N.local=this.parseIdent(),this.checkLValSimple(N.local,lr),this.finishNode(N,"ImportDefaultSpecifier")},fe.parseImportNamespaceSpecifier=function(){var N=this.startNode();return this.next(),this.expectContextual("as"),N.local=this.parseIdent(),this.checkLValSimple(N.local,lr),this.finishNode(N,"ImportNamespaceSpecifier")},fe.parseImportSpecifiers=function(){var N=[],xe=!0;if(this.type===Oe.name&&(N.push(this.parseImportDefaultSpecifier()),!this.eat(Oe.comma)))return N;if(this.type===Oe.star)return N.push(this.parseImportNamespaceSpecifier()),N;for(this.expect(Oe.braceL);!this.eat(Oe.braceR);){if(xe)xe=!1;else if(this.expect(Oe.comma),this.afterTrailingComma(Oe.braceR))break;N.push(this.parseImportSpecifier())}return N},fe.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===Oe.string){var N=this.parseLiteral(this.value);return Ii.test(N.value)&&this.raise(N.start,"An export name cannot include a lone surrogate."),N}return this.parseIdent(!0)},fe.adaptDirectivePrologue=function(N){for(var xe=0;xe<N.length&&this.isDirectiveCandidate(N[xe]);++xe)N[xe].directive=N[xe].expression.raw.slice(1,-1)},fe.isDirectiveCandidate=function(N){return this.options.ecmaVersion>=5&&N.type==="ExpressionStatement"&&N.expression.type==="Literal"&&typeof N.expression.value=="string"&&(this.input[N.start]==='"'||this.input[N.start]==="'")};var dt=v.prototype;dt.toAssignable=function(N,xe,nt){if(this.options.ecmaVersion>=6&&N)switch(N.type){case"Identifier":this.inAsync&&N.name==="await"&&this.raise(N.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":N.type="ObjectPattern",nt&&this.checkPatternErrors(nt,!0);for(var It=0,$t=N.properties;It<$t.length;It+=1){var wi=$t[It];this.toAssignable(wi,xe),wi.type==="RestElement"&&(wi.argument.type==="ArrayPattern"||wi.argument.type==="ObjectPattern")&&this.raise(wi.argument.start,"Unexpected token")}break;case"Property":N.kind!=="init"&&this.raise(N.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(N.value,xe);break;case"ArrayExpression":N.type="ArrayPattern",nt&&this.checkPatternErrors(nt,!0),this.toAssignableList(N.elements,xe);break;case"SpreadElement":N.type="RestElement",this.toAssignable(N.argument,xe),N.argument.type==="AssignmentPattern"&&this.raise(N.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":N.operator!=="="&&this.raise(N.left.end,"Only '=' operator can be used for specifying default value."),N.type="AssignmentPattern",delete N.operator,this.toAssignable(N.left,xe);break;case"ParenthesizedExpression":this.toAssignable(N.expression,xe,nt);break;case"ChainExpression":this.raiseRecoverable(N.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!xe)break;default:this.raise(N.start,"Assigning to rvalue")}else nt&&this.checkPatternErrors(nt,!0);return N},dt.toAssignableList=function(N,xe){for(var nt=N.length,It=0;It<nt;It++){var $t=N[It];$t&&this.toAssignable($t,xe)}if(nt){var wi=N[nt-1];this.options.ecmaVersion===6&&xe&&wi&&wi.type==="RestElement"&&wi.argument.type!=="Identifier"&&this.unexpected(wi.argument.start)}return N},dt.parseSpread=function(N){var xe=this.startNode();return this.next(),xe.argument=this.parseMaybeAssign(!1,N),this.finishNode(xe,"SpreadElement")},dt.parseRestBinding=function(){var N=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==Oe.name&&this.unexpected(),N.argument=this.parseBindingAtom(),this.finishNode(N,"RestElement")},dt.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case Oe.bracketL:var N=this.startNode();return this.next(),N.elements=this.parseBindingList(Oe.bracketR,!0,!0),this.finishNode(N,"ArrayPattern");case Oe.braceL:return this.parseObj(!0)}return this.parseIdent()},dt.parseBindingList=function(N,xe,nt,It){for(var $t=[],wi=!0;!this.eat(N);)if(wi?wi=!1:this.expect(Oe.comma),xe&&this.type===Oe.comma)$t.push(null);else{if(nt&&this.afterTrailingComma(N))break;if(this.type===Oe.ellipsis){var Di=this.parseRestBinding();this.parseBindingListItem(Di),$t.push(Di),this.type===Oe.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(N);break}else $t.push(this.parseAssignableListItem(It))}return $t},dt.parseAssignableListItem=function(N){var xe=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(xe),xe},dt.parseBindingListItem=function(N){return N},dt.parseMaybeDefault=function(N,xe,nt){if(nt=nt||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(Oe.eq))return nt;var It=this.startNodeAt(N,xe);return It.left=nt,It.right=this.parseMaybeAssign(),this.finishNode(It,"AssignmentPattern")},dt.checkLValSimple=function(N,xe,nt){xe===void 0&&(xe=ci);var It=xe!==ci;switch(N.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(N.name)&&this.raiseRecoverable(N.start,(It?"Binding ":"Assigning to ")+N.name+" in strict mode"),It&&(xe===lr&&N.name==="let"&&this.raiseRecoverable(N.start,"let is disallowed as a lexically bound name"),nt&&(ut(nt,N.name)&&this.raiseRecoverable(N.start,"Argument name clash"),nt[N.name]=!0),xe!==pn&&this.declareName(N.name,xe,N.start));break;case"ChainExpression":this.raiseRecoverable(N.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":It&&this.raiseRecoverable(N.start,"Binding member expression");break;case"ParenthesizedExpression":return It&&this.raiseRecoverable(N.start,"Binding parenthesized expression"),this.checkLValSimple(N.expression,xe,nt);default:this.raise(N.start,(It?"Binding":"Assigning to")+" rvalue")}},dt.checkLValPattern=function(N,xe,nt){switch(xe===void 0&&(xe=ci),N.type){case"ObjectPattern":for(var It=0,$t=N.properties;It<$t.length;It+=1){var wi=$t[It];this.checkLValInnerPattern(wi,xe,nt)}break;case"ArrayPattern":for(var Di=0,hn=N.elements;Di<hn.length;Di+=1){var dn=hn[Di];dn&&this.checkLValInnerPattern(dn,xe,nt)}break;default:this.checkLValSimple(N,xe,nt)}},dt.checkLValInnerPattern=function(N,xe,nt){switch(xe===void 0&&(xe=ci),N.type){case"Property":this.checkLValInnerPattern(N.value,xe,nt);break;case"AssignmentPattern":this.checkLValPattern(N.left,xe,nt);break;case"RestElement":this.checkLValPattern(N.argument,xe,nt);break;default:this.checkLValPattern(N,xe,nt)}};var rt=function(xe,nt,It,$t,wi){this.token=xe,this.isExpr=!!nt,this.preserveSpace=!!It,this.override=$t,this.generator=!!wi},Me={b_stat:new rt("{",!1),b_expr:new rt("{",!0),b_tmpl:new rt("${",!1),p_stat:new rt("(",!1),p_expr:new rt("(",!0),q_tmpl:new rt("`",!0,!0,function(N){return N.tryReadTemplateToken()}),f_stat:new rt("function",!1),f_expr:new rt("function",!0),f_expr_gen:new rt("function",!0,!1,null,!0),f_gen:new rt("function",!1,!1,null,!0)},se=v.prototype;se.initialContext=function(){return[Me.b_stat]},se.curContext=function(){return this.context[this.context.length-1]},se.braceIsBlock=function(N){var xe=this.curContext();return xe===Me.f_expr||xe===Me.f_stat?!0:N===Oe.colon&&(xe===Me.b_stat||xe===Me.b_expr)?!xe.isExpr:N===Oe._return||N===Oe.name&&this.exprAllowed?jt.test(this.input.slice(this.lastTokEnd,this.start)):N===Oe._else||N===Oe.semi||N===Oe.eof||N===Oe.parenR||N===Oe.arrow?!0:N===Oe.braceL?xe===Me.b_stat:N===Oe._var||N===Oe._const||N===Oe.name?!1:!this.exprAllowed},se.inGeneratorContext=function(){for(var N=this.context.length-1;N>=1;N--){var xe=this.context[N];if(xe.token==="function")return xe.generator}return!1},se.updateContext=function(N){var xe,nt=this.type;nt.keyword&&N===Oe.dot?this.exprAllowed=!1:(xe=nt.updateContext)?xe.call(this,N):this.exprAllowed=nt.beforeExpr},se.overrideContext=function(N){this.curContext()!==N&&(this.context[this.context.length-1]=N)},Oe.parenR.updateContext=Oe.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var N=this.context.pop();N===Me.b_stat&&this.curContext().token==="function"&&(N=this.context.pop()),this.exprAllowed=!N.isExpr},Oe.braceL.updateContext=function(N){this.context.push(this.braceIsBlock(N)?Me.b_stat:Me.b_expr),this.exprAllowed=!0},Oe.dollarBraceL.updateContext=function(){this.context.push(Me.b_tmpl),this.exprAllowed=!0},Oe.parenL.updateContext=function(N){var xe=N===Oe._if||N===Oe._for||N===Oe._with||N===Oe._while;this.context.push(xe?Me.p_stat:Me.p_expr),this.exprAllowed=!0},Oe.incDec.updateContext=function(){},Oe._function.updateContext=Oe._class.updateContext=function(N){N.beforeExpr&&N!==Oe._else&&!(N===Oe.semi&&this.curContext()!==Me.p_stat)&&!(N===Oe._return&&jt.test(this.input.slice(this.lastTokEnd,this.start)))&&!((N===Oe.colon||N===Oe.braceL)&&this.curContext()===Me.b_stat)?this.context.push(Me.f_expr):this.context.push(Me.f_stat),this.exprAllowed=!1},Oe.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0},Oe.backQuote.updateContext=function(){this.curContext()===Me.q_tmpl?this.context.pop():this.context.push(Me.q_tmpl),this.exprAllowed=!1},Oe.star.updateContext=function(N){if(N===Oe._function){var xe=this.context.length-1;this.context[xe]===Me.f_expr?this.context[xe]=Me.f_expr_gen:this.context[xe]=Me.f_gen}this.exprAllowed=!0},Oe.name.updateContext=function(N){var xe=!1;this.options.ecmaVersion>=6&&N!==Oe.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(xe=!0),this.exprAllowed=xe};var ne=v.prototype;ne.checkPropClash=function(N,xe,nt){if(!(this.options.ecmaVersion>=9&&N.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(N.computed||N.method||N.shorthand))){var It=N.key,$t;switch(It.type){case"Identifier":$t=It.name;break;case"Literal":$t=String(It.value);break;default:return}var wi=N.kind;if(this.options.ecmaVersion>=6){$t==="__proto__"&&wi==="init"&&(xe.proto&&(nt?nt.doubleProto<0&&(nt.doubleProto=It.start):this.raiseRecoverable(It.start,"Redefinition of __proto__ property")),xe.proto=!0);return}$t="$"+$t;var Di=xe[$t];if(Di){var hn;wi==="init"?hn=this.strict&&Di.init||Di.get||Di.set:hn=Di.init||Di[wi],hn&&this.raiseRecoverable(It.start,"Redefinition of property")}else Di=xe[$t]={init:!1,get:!1,set:!1};Di[wi]=!0}},ne.parseExpression=function(N,xe){var nt=this.start,It=this.startLoc,$t=this.parseMaybeAssign(N,xe);if(this.type===Oe.comma){var wi=this.startNodeAt(nt,It);for(wi.expressions=[$t];this.eat(Oe.comma);)wi.expressions.push(this.parseMaybeAssign(N,xe));return this.finishNode(wi,"SequenceExpression")}return $t},ne.parseMaybeAssign=function(N,xe,nt){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(N);this.exprAllowed=!1}var It=!1,$t=-1,wi=-1,Di=-1;xe?($t=xe.parenthesizedAssign,wi=xe.trailingComma,Di=xe.doubleProto,xe.parenthesizedAssign=xe.trailingComma=-1):(xe=new te,It=!0);var hn=this.start,dn=this.startLoc;(this.type===Oe.parenL||this.type===Oe.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=N==="await");var rr=this.parseMaybeConditional(N,xe);if(nt&&(rr=nt.call(this,rr,hn,dn)),this.type.isAssign){var Ar=this.startNodeAt(hn,dn);return Ar.operator=this.value,this.type===Oe.eq&&(rr=this.toAssignable(rr,!1,xe)),It||(xe.parenthesizedAssign=xe.trailingComma=xe.doubleProto=-1),xe.shorthandAssign>=rr.start&&(xe.shorthandAssign=-1),this.type===Oe.eq?this.checkLValPattern(rr):this.checkLValSimple(rr),Ar.left=rr,this.next(),Ar.right=this.parseMaybeAssign(N),Di>-1&&(xe.doubleProto=Di),this.finishNode(Ar,"AssignmentExpression")}else It&&this.checkExpressionErrors(xe,!0);return $t>-1&&(xe.parenthesizedAssign=$t),wi>-1&&(xe.trailingComma=wi),rr},ne.parseMaybeConditional=function(N,xe){var nt=this.start,It=this.startLoc,$t=this.parseExprOps(N,xe);if(this.checkExpressionErrors(xe))return $t;if(this.eat(Oe.question)){var wi=this.startNodeAt(nt,It);return wi.test=$t,wi.consequent=this.parseMaybeAssign(),this.expect(Oe.colon),wi.alternate=this.parseMaybeAssign(N),this.finishNode(wi,"ConditionalExpression")}return $t},ne.parseExprOps=function(N,xe){var nt=this.start,It=this.startLoc,$t=this.parseMaybeUnary(xe,!1,!1,N);return this.checkExpressionErrors(xe)||$t.start===nt&&$t.type==="ArrowFunctionExpression"?$t:this.parseExprOp($t,nt,It,-1,N)},ne.parseExprOp=function(N,xe,nt,It,$t){var wi=this.type.binop;if(wi!=null&&(!$t||this.type!==Oe._in)&&wi>It){var Di=this.type===Oe.logicalOR||this.type===Oe.logicalAND,hn=this.type===Oe.coalesce;hn&&(wi=Oe.logicalAND.binop);var dn=this.value;this.next();var rr=this.start,Ar=this.startLoc,Or=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,$t),rr,Ar,wi,$t),ja=this.buildBinary(xe,nt,N,Or,dn,Di||hn);return(Di&&this.type===Oe.coalesce||hn&&(this.type===Oe.logicalOR||this.type===Oe.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(ja,xe,nt,It,$t)}return N},ne.buildBinary=function(N,xe,nt,It,$t,wi){It.type==="PrivateIdentifier"&&this.raise(It.start,"Private identifier can only be left side of binary expression");var Di=this.startNodeAt(N,xe);return Di.left=nt,Di.operator=$t,Di.right=It,this.finishNode(Di,wi?"LogicalExpression":"BinaryExpression")},ne.parseMaybeUnary=function(N,xe,nt,It){var $t=this.start,wi=this.startLoc,Di;if(this.isContextual("await")&&this.canAwait)Di=this.parseAwait(It),xe=!0;else if(this.type.prefix){var hn=this.startNode(),dn=this.type===Oe.incDec;hn.operator=this.value,hn.prefix=!0,this.next(),hn.argument=this.parseMaybeUnary(null,!0,dn,It),this.checkExpressionErrors(N,!0),dn?this.checkLValSimple(hn.argument):this.strict&&hn.operator==="delete"&&hn.argument.type==="Identifier"?this.raiseRecoverable(hn.start,"Deleting local variable in strict mode"):hn.operator==="delete"&&$(hn.argument)?this.raiseRecoverable(hn.start,"Private fields can not be deleted"):xe=!0,Di=this.finishNode(hn,dn?"UpdateExpression":"UnaryExpression")}else if(!xe&&this.type===Oe.privateId)(It||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),Di=this.parsePrivateIdent(),this.type!==Oe._in&&this.unexpected();else{if(Di=this.parseExprSubscripts(N,It),this.checkExpressionErrors(N))return Di;for(;this.type.postfix&&!this.canInsertSemicolon();){var rr=this.startNodeAt($t,wi);rr.operator=this.value,rr.prefix=!1,rr.argument=Di,this.checkLValSimple(Di),this.next(),Di=this.finishNode(rr,"UpdateExpression")}}if(!nt&&this.eat(Oe.starstar))if(xe)this.unexpected(this.lastTokStart);else return this.buildBinary($t,wi,Di,this.parseMaybeUnary(null,!1,!1,It),"**",!1);else return Di};function $(N){return N.type==="MemberExpression"&&N.property.type==="PrivateIdentifier"||N.type==="ChainExpression"&&$(N.expression)}ne.parseExprSubscripts=function(N,xe){var nt=this.start,It=this.startLoc,$t=this.parseExprAtom(N,xe);if($t.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return $t;var wi=this.parseSubscripts($t,nt,It,!1,xe);return N&&wi.type==="MemberExpression"&&(N.parenthesizedAssign>=wi.start&&(N.parenthesizedAssign=-1),N.parenthesizedBind>=wi.start&&(N.parenthesizedBind=-1),N.trailingComma>=wi.start&&(N.trailingComma=-1)),wi},ne.parseSubscripts=function(N,xe,nt,It,$t){for(var wi=this.options.ecmaVersion>=8&&N.type==="Identifier"&&N.name==="async"&&this.lastTokEnd===N.end&&!this.canInsertSemicolon()&&N.end-N.start===5&&this.potentialArrowAt===N.start,Di=!1;;){var hn=this.parseSubscript(N,xe,nt,It,wi,Di,$t);if(hn.optional&&(Di=!0),hn===N||hn.type==="ArrowFunctionExpression"){if(Di){var dn=this.startNodeAt(xe,nt);dn.expression=hn,hn=this.finishNode(dn,"ChainExpression")}return hn}N=hn}},ne.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(Oe.arrow)},ne.parseSubscriptAsyncArrow=function(N,xe,nt,It){return this.parseArrowExpression(this.startNodeAt(N,xe),nt,!0,It)},ne.parseSubscript=function(N,xe,nt,It,$t,wi,Di){var hn=this.options.ecmaVersion>=11,dn=hn&&this.eat(Oe.questionDot);It&&dn&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var rr=this.eat(Oe.bracketL);if(rr||dn&&this.type!==Oe.parenL&&this.type!==Oe.backQuote||this.eat(Oe.dot)){var Ar=this.startNodeAt(xe,nt);Ar.object=N,rr?(Ar.property=this.parseExpression(),this.expect(Oe.bracketR)):this.type===Oe.privateId&&N.type!=="Super"?Ar.property=this.parsePrivateIdent():Ar.property=this.parseIdent(this.options.allowReserved!=="never"),Ar.computed=!!rr,hn&&(Ar.optional=dn),N=this.finishNode(Ar,"MemberExpression")}else if(!It&&this.eat(Oe.parenL)){var Or=new te,ja=this.yieldPos,Za=this.awaitPos,Qa=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var pl=this.parseExprList(Oe.parenR,this.options.ecmaVersion>=8,!1,Or);if($t&&!dn&&this.shouldParseAsyncArrow())return this.checkPatternErrors(Or,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=ja,this.awaitPos=Za,this.awaitIdentPos=Qa,this.parseSubscriptAsyncArrow(xe,nt,pl,Di);this.checkExpressionErrors(Or,!0),this.yieldPos=ja||this.yieldPos,this.awaitPos=Za||this.awaitPos,this.awaitIdentPos=Qa||this.awaitIdentPos;var Gr=this.startNodeAt(xe,nt);Gr.callee=N,Gr.arguments=pl,hn&&(Gr.optional=dn),N=this.finishNode(Gr,"CallExpression")}else if(this.type===Oe.backQuote){(dn||wi)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var ir=this.startNodeAt(xe,nt);ir.tag=N,ir.quasi=this.parseTemplate({isTagged:!0}),N=this.finishNode(ir,"TaggedTemplateExpression")}return N},ne.parseExprAtom=function(N,xe,nt){this.type===Oe.slash&&this.readRegexp();var It,$t=this.potentialArrowAt===this.start;switch(this.type){case Oe._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),It=this.startNode(),this.next(),this.type===Oe.parenL&&!this.allowDirectSuper&&this.raise(It.start,"super() call outside constructor of a subclass"),this.type!==Oe.dot&&this.type!==Oe.bracketL&&this.type!==Oe.parenL&&this.unexpected(),this.finishNode(It,"Super");case Oe._this:return It=this.startNode(),this.next(),this.finishNode(It,"ThisExpression");case Oe.name:var wi=this.start,Di=this.startLoc,hn=this.containsEsc,dn=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!hn&&dn.name==="async"&&!this.canInsertSemicolon()&&this.eat(Oe._function))return this.overrideContext(Me.f_expr),this.parseFunction(this.startNodeAt(wi,Di),0,!1,!0,xe);if($t&&!this.canInsertSemicolon()){if(this.eat(Oe.arrow))return this.parseArrowExpression(this.startNodeAt(wi,Di),[dn],!1,xe);if(this.options.ecmaVersion>=8&&dn.name==="async"&&this.type===Oe.name&&!hn&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return dn=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(Oe.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(wi,Di),[dn],!0,xe)}return dn;case Oe.regexp:var rr=this.value;return It=this.parseLiteral(rr.value),It.regex={pattern:rr.pattern,flags:rr.flags},It;case Oe.num:case Oe.string:return this.parseLiteral(this.value);case Oe._null:case Oe._true:case Oe._false:return It=this.startNode(),It.value=this.type===Oe._null?null:this.type===Oe._true,It.raw=this.type.keyword,this.next(),this.finishNode(It,"Literal");case Oe.parenL:var Ar=this.start,Or=this.parseParenAndDistinguishExpression($t,xe);return N&&(N.parenthesizedAssign<0&&!this.isSimpleAssignTarget(Or)&&(N.parenthesizedAssign=Ar),N.parenthesizedBind<0&&(N.parenthesizedBind=Ar)),Or;case Oe.bracketL:return It=this.startNode(),this.next(),It.elements=this.parseExprList(Oe.bracketR,!0,!0,N),this.finishNode(It,"ArrayExpression");case Oe.braceL:return this.overrideContext(Me.b_expr),this.parseObj(!1,N);case Oe._function:return It=this.startNode(),this.next(),this.parseFunction(It,0);case Oe._class:return this.parseClass(this.startNode(),!1);case Oe._new:return this.parseNew();case Oe.backQuote:return this.parseTemplate();case Oe._import:return this.options.ecmaVersion>=11?this.parseExprImport(nt):this.unexpected();default:return this.parseExprAtomDefault()}},ne.parseExprAtomDefault=function(){this.unexpected()},ne.parseExprImport=function(N){var xe=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===Oe.parenL&&!N)return this.parseDynamicImport(xe);if(this.type===Oe.dot){var nt=this.startNodeAt(xe.start,xe.loc&&xe.loc.start);return nt.name="import",xe.meta=this.finishNode(nt,"Identifier"),this.parseImportMeta(xe)}else this.unexpected()},ne.parseDynamicImport=function(N){if(this.next(),N.source=this.parseMaybeAssign(),!this.eat(Oe.parenR)){var xe=this.start;this.eat(Oe.comma)&&this.eat(Oe.parenR)?this.raiseRecoverable(xe,"Trailing comma is not allowed in import()"):this.unexpected(xe)}return this.finishNode(N,"ImportExpression")},ne.parseImportMeta=function(N){this.next();var xe=this.containsEsc;return N.property=this.parseIdent(!0),N.property.name!=="meta"&&this.raiseRecoverable(N.property.start,"The only valid meta property for import is 'import.meta'"),xe&&this.raiseRecoverable(N.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(N.start,"Cannot use 'import.meta' outside a module"),this.finishNode(N,"MetaProperty")},ne.parseLiteral=function(N){var xe=this.startNode();return xe.value=N,xe.raw=this.input.slice(this.start,this.end),xe.raw.charCodeAt(xe.raw.length-1)===110&&(xe.bigint=xe.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(xe,"Literal")},ne.parseParenExpression=function(){this.expect(Oe.parenL);var N=this.parseExpression();return this.expect(Oe.parenR),N},ne.shouldParseArrow=function(N){return!this.canInsertSemicolon()},ne.parseParenAndDistinguishExpression=function(N,xe){var nt=this.start,It=this.startLoc,$t,wi=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var Di=this.start,hn=this.startLoc,dn=[],rr=!0,Ar=!1,Or=new te,ja=this.yieldPos,Za=this.awaitPos,Qa;for(this.yieldPos=0,this.awaitPos=0;this.type!==Oe.parenR;)if(rr?rr=!1:this.expect(Oe.comma),wi&&this.afterTrailingComma(Oe.parenR,!0)){Ar=!0;break}else if(this.type===Oe.ellipsis){Qa=this.start,dn.push(this.parseParenItem(this.parseRestBinding())),this.type===Oe.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else dn.push(this.parseMaybeAssign(!1,Or,this.parseParenItem));var pl=this.lastTokEnd,Gr=this.lastTokEndLoc;if(this.expect(Oe.parenR),N&&this.shouldParseArrow(dn)&&this.eat(Oe.arrow))return this.checkPatternErrors(Or,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=ja,this.awaitPos=Za,this.parseParenArrowList(nt,It,dn,xe);(!dn.length||Ar)&&this.unexpected(this.lastTokStart),Qa&&this.unexpected(Qa),this.checkExpressionErrors(Or,!0),this.yieldPos=ja||this.yieldPos,this.awaitPos=Za||this.awaitPos,dn.length>1?($t=this.startNodeAt(Di,hn),$t.expressions=dn,this.finishNodeAt($t,"SequenceExpression",pl,Gr)):$t=dn[0]}else $t=this.parseParenExpression();if(this.options.preserveParens){var ir=this.startNodeAt(nt,It);return ir.expression=$t,this.finishNode(ir,"ParenthesizedExpression")}else return $t},ne.parseParenItem=function(N){return N},ne.parseParenArrowList=function(N,xe,nt,It){return this.parseArrowExpression(this.startNodeAt(N,xe),nt,!1,It)};var ie=[];ne.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var N=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===Oe.dot){var xe=this.startNodeAt(N.start,N.loc&&N.loc.start);xe.name="new",N.meta=this.finishNode(xe,"Identifier"),this.next();var nt=this.containsEsc;return N.property=this.parseIdent(!0),N.property.name!=="target"&&this.raiseRecoverable(N.property.start,"The only valid meta property for new is 'new.target'"),nt&&this.raiseRecoverable(N.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(N.start,"'new.target' can only be used in functions and class static block"),this.finishNode(N,"MetaProperty")}var It=this.start,$t=this.startLoc;return N.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),It,$t,!0,!1),this.eat(Oe.parenL)?N.arguments=this.parseExprList(Oe.parenR,this.options.ecmaVersion>=8,!1):N.arguments=ie,this.finishNode(N,"NewExpression")},ne.parseTemplateElement=function(N){var xe=N.isTagged,nt=this.startNode();return this.type===Oe.invalidTemplate?(xe||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),nt.value={raw:this.value,cooked:null}):nt.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),nt.tail=this.type===Oe.backQuote,this.finishNode(nt,"TemplateElement")},ne.parseTemplate=function(N){N===void 0&&(N={});var xe=N.isTagged;xe===void 0&&(xe=!1);var nt=this.startNode();this.next(),nt.expressions=[];var It=this.parseTemplateElement({isTagged:xe});for(nt.quasis=[It];!It.tail;)this.type===Oe.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(Oe.dollarBraceL),nt.expressions.push(this.parseExpression()),this.expect(Oe.braceR),nt.quasis.push(It=this.parseTemplateElement({isTagged:xe}));return this.next(),this.finishNode(nt,"TemplateLiteral")},ne.isAsyncProp=function(N){return!N.computed&&N.key.type==="Identifier"&&N.key.name==="async"&&(this.type===Oe.name||this.type===Oe.num||this.type===Oe.string||this.type===Oe.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===Oe.star)&&!jt.test(this.input.slice(this.lastTokEnd,this.start))},ne.parseObj=function(N,xe){var nt=this.startNode(),It=!0,$t={};for(nt.properties=[],this.next();!this.eat(Oe.braceR);){if(It)It=!1;else if(this.expect(Oe.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(Oe.braceR))break;var wi=this.parseProperty(N,xe);N||this.checkPropClash(wi,$t,xe),nt.properties.push(wi)}return this.finishNode(nt,N?"ObjectPattern":"ObjectExpression")},ne.parseProperty=function(N,xe){var nt=this.startNode(),It,$t,wi,Di;if(this.options.ecmaVersion>=9&&this.eat(Oe.ellipsis))return N?(nt.argument=this.parseIdent(!1),this.type===Oe.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(nt,"RestElement")):(nt.argument=this.parseMaybeAssign(!1,xe),this.type===Oe.comma&&xe&&xe.trailingComma<0&&(xe.trailingComma=this.start),this.finishNode(nt,"SpreadElement"));this.options.ecmaVersion>=6&&(nt.method=!1,nt.shorthand=!1,(N||xe)&&(wi=this.start,Di=this.startLoc),N||(It=this.eat(Oe.star)));var hn=this.containsEsc;return this.parsePropertyName(nt),!N&&!hn&&this.options.ecmaVersion>=8&&!It&&this.isAsyncProp(nt)?($t=!0,It=this.options.ecmaVersion>=9&&this.eat(Oe.star),this.parsePropertyName(nt)):$t=!1,this.parsePropertyValue(nt,N,It,$t,wi,Di,xe,hn),this.finishNode(nt,"Property")},ne.parseGetterSetter=function(N){N.kind=N.key.name,this.parsePropertyName(N),N.value=this.parseMethod(!1);var xe=N.kind==="get"?0:1;if(N.value.params.length!==xe){var nt=N.value.start;N.kind==="get"?this.raiseRecoverable(nt,"getter should have no params"):this.raiseRecoverable(nt,"setter should have exactly one param")}else N.kind==="set"&&N.value.params[0].type==="RestElement"&&this.raiseRecoverable(N.value.params[0].start,"Setter cannot use rest params")},ne.parsePropertyValue=function(N,xe,nt,It,$t,wi,Di,hn){(nt||It)&&this.type===Oe.colon&&this.unexpected(),this.eat(Oe.colon)?(N.value=xe?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,Di),N.kind="init"):this.options.ecmaVersion>=6&&this.type===Oe.parenL?(xe&&this.unexpected(),N.kind="init",N.method=!0,N.value=this.parseMethod(nt,It)):!xe&&!hn&&this.options.ecmaVersion>=5&&!N.computed&&N.key.type==="Identifier"&&(N.key.name==="get"||N.key.name==="set")&&this.type!==Oe.comma&&this.type!==Oe.braceR&&this.type!==Oe.eq?((nt||It)&&this.unexpected(),this.parseGetterSetter(N)):this.options.ecmaVersion>=6&&!N.computed&&N.key.type==="Identifier"?((nt||It)&&this.unexpected(),this.checkUnreserved(N.key),N.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=$t),N.kind="init",xe?N.value=this.parseMaybeDefault($t,wi,this.copyNode(N.key)):this.type===Oe.eq&&Di?(Di.shorthandAssign<0&&(Di.shorthandAssign=this.start),N.value=this.parseMaybeDefault($t,wi,this.copyNode(N.key))):N.value=this.copyNode(N.key),N.shorthand=!0):this.unexpected()},ne.parsePropertyName=function(N){if(this.options.ecmaVersion>=6){if(this.eat(Oe.bracketL))return N.computed=!0,N.key=this.parseMaybeAssign(),this.expect(Oe.bracketR),N.key;N.computed=!1}return N.key=this.type===Oe.num||this.type===Oe.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},ne.initFunction=function(N){N.id=null,this.options.ecmaVersion>=6&&(N.generator=N.expression=!1),this.options.ecmaVersion>=8&&(N.async=!1)},ne.parseMethod=function(N,xe,nt){var It=this.startNode(),$t=this.yieldPos,wi=this.awaitPos,Di=this.awaitIdentPos;return this.initFunction(It),this.options.ecmaVersion>=6&&(It.generator=N),this.options.ecmaVersion>=8&&(It.async=!!xe),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(mr(xe,It.generator)|Yt|(nt?rn:0)),this.expect(Oe.parenL),It.params=this.parseBindingList(Oe.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(It,!1,!0,!1),this.yieldPos=$t,this.awaitPos=wi,this.awaitIdentPos=Di,this.finishNode(It,"FunctionExpression")},ne.parseArrowExpression=function(N,xe,nt,It){var $t=this.yieldPos,wi=this.awaitPos,Di=this.awaitIdentPos;return this.enterScope(mr(nt,!1)|xn),this.initFunction(N),this.options.ecmaVersion>=8&&(N.async=!!nt),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,N.params=this.toAssignableList(xe,!0),this.parseFunctionBody(N,!0,!1,It),this.yieldPos=$t,this.awaitPos=wi,this.awaitIdentPos=Di,this.finishNode(N,"ArrowFunctionExpression")},ne.parseFunctionBody=function(N,xe,nt,It){var $t=xe&&this.type!==Oe.braceL,wi=this.strict,Di=!1;if($t)N.body=this.parseMaybeAssign(It),N.expression=!0,this.checkParams(N,!1);else{var hn=this.options.ecmaVersion>=7&&!this.isSimpleParamList(N.params);(!wi||hn)&&(Di=this.strictDirective(this.end),Di&&hn&&this.raiseRecoverable(N.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var dn=this.labels;this.labels=[],Di&&(this.strict=!0),this.checkParams(N,!wi&&!Di&&!xe&&!nt&&this.isSimpleParamList(N.params)),this.strict&&N.id&&this.checkLValSimple(N.id,pn),N.body=this.parseBlock(!1,void 0,Di&&!wi),N.expression=!1,this.adaptDirectivePrologue(N.body.body),this.labels=dn}this.exitScope()},ne.isSimpleParamList=function(N){for(var xe=0,nt=N;xe<nt.length;xe+=1){var It=nt[xe];if(It.type!=="Identifier")return!1}return!0},ne.checkParams=function(N,xe){for(var nt=Object.create(null),It=0,$t=N.params;It<$t.length;It+=1){var wi=$t[It];this.checkLValInnerPattern(wi,sn,xe?null:nt)}},ne.parseExprList=function(N,xe,nt,It){for(var $t=[],wi=!0;!this.eat(N);){if(wi)wi=!1;else if(this.expect(Oe.comma),xe&&this.afterTrailingComma(N))break;var Di=void 0;nt&&this.type===Oe.comma?Di=null:this.type===Oe.ellipsis?(Di=this.parseSpread(It),It&&this.type===Oe.comma&&It.trailingComma<0&&(It.trailingComma=this.start)):Di=this.parseMaybeAssign(!1,It),$t.push(Di)}return $t},ne.checkUnreserved=function(N){var xe=N.start,nt=N.end,It=N.name;if(this.inGenerator&&It==="yield"&&this.raiseRecoverable(xe,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&It==="await"&&this.raiseRecoverable(xe,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().inClassFieldInit&&It==="arguments"&&this.raiseRecoverable(xe,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(It==="arguments"||It==="await")&&this.raise(xe,"Cannot use "+It+" in class static initialization block"),this.keywords.test(It)&&this.raise(xe,"Unexpected keyword '"+It+"'"),!(this.options.ecmaVersion<6&&this.input.slice(xe,nt).indexOf("\\")!==-1)){var $t=this.strict?this.reservedWordsStrict:this.reservedWords;$t.test(It)&&(!this.inAsync&&It==="await"&&this.raiseRecoverable(xe,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(xe,"The keyword '"+It+"' is reserved"))}},ne.parseIdent=function(N){var xe=this.parseIdentNode();return this.next(!!N),this.finishNode(xe,"Identifier"),N||(this.checkUnreserved(xe),xe.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=xe.start)),xe},ne.parseIdentNode=function(){var N=this.startNode();return this.type===Oe.name?N.name=this.value:this.type.keyword?(N.name=this.type.keyword,(N.name==="class"||N.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=Oe.name):this.unexpected(),N},ne.parsePrivateIdent=function(){var N=this.startNode();return this.type===Oe.privateId?N.name=this.value:this.unexpected(),this.next(),this.finishNode(N,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(N.start,"Private field '#"+N.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(N)),N},ne.parseYield=function(N){this.yieldPos||(this.yieldPos=this.start);var xe=this.startNode();return this.next(),this.type===Oe.semi||this.canInsertSemicolon()||this.type!==Oe.star&&!this.type.startsExpr?(xe.delegate=!1,xe.argument=null):(xe.delegate=this.eat(Oe.star),xe.argument=this.parseMaybeAssign(N)),this.finishNode(xe,"YieldExpression")},ne.parseAwait=function(N){this.awaitPos||(this.awaitPos=this.start);var xe=this.startNode();return this.next(),xe.argument=this.parseMaybeUnary(null,!0,!1,N),this.finishNode(xe,"AwaitExpression")};var de=v.prototype;de.raise=function(N,xe){var nt=Ki(this.input,N);xe+=" ("+nt.line+":"+nt.column+")";var It=new SyntaxError(xe);throw It.pos=N,It.loc=nt,It.raisedAt=this.pos,It},de.raiseRecoverable=de.raise,de.curPosition=function(){if(this.options.locations)return new Ci(this.curLine,this.pos-this.lineStart)};var ye=v.prototype,ge=function(xe){this.flags=xe,this.var=[],this.lexical=[],this.functions=[],this.inClassFieldInit=!1};ye.enterScope=function(N){this.scopeStack.push(new ge(N))},ye.exitScope=function(){this.scopeStack.pop()},ye.treatFunctionsAsVarInScope=function(N){return N.flags&mi||!this.inModule&&N.flags&Ei},ye.declareName=function(N,xe,nt){var It=!1;if(xe===lr){var $t=this.currentScope();It=$t.lexical.indexOf(N)>-1||$t.functions.indexOf(N)>-1||$t.var.indexOf(N)>-1,$t.lexical.push(N),this.inModule&&$t.flags&Ei&&delete this.undefinedExports[N]}else if(xe===Gn){var wi=this.currentScope();wi.lexical.push(N)}else if(xe===On){var Di=this.currentScope();this.treatFunctionsAsVar?It=Di.lexical.indexOf(N)>-1:It=Di.lexical.indexOf(N)>-1||Di.var.indexOf(N)>-1,Di.functions.push(N)}else for(var hn=this.scopeStack.length-1;hn>=0;--hn){var dn=this.scopeStack[hn];if(dn.lexical.indexOf(N)>-1&&!(dn.flags&bn&&dn.lexical[0]===N)||!this.treatFunctionsAsVarInScope(dn)&&dn.functions.indexOf(N)>-1){It=!0;break}if(dn.var.push(N),this.inModule&&dn.flags&Ei&&delete this.undefinedExports[N],dn.flags&Ji)break}It&&this.raiseRecoverable(nt,"Identifier '"+N+"' has already been declared")},ye.checkLocalExport=function(N){this.scopeStack[0].lexical.indexOf(N.name)===-1&&this.scopeStack[0].var.indexOf(N.name)===-1&&(this.undefinedExports[N.name]=N)},ye.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},ye.currentVarScope=function(){for(var N=this.scopeStack.length-1;;N--){var xe=this.scopeStack[N];if(xe.flags&Ji)return xe}},ye.currentThisScope=function(){for(var N=this.scopeStack.length-1;;N--){var xe=this.scopeStack[N];if(xe.flags&Ji&&!(xe.flags&xn))return xe}};var Pe=function(xe,nt,It){this.type="",this.start=nt,this.end=0,xe.options.locations&&(this.loc=new Ri(xe,It)),xe.options.directSourceFile&&(this.sourceFile=xe.options.directSourceFile),xe.options.ranges&&(this.range=[nt,0])},Fe=v.prototype;Fe.startNode=function(){return new Pe(this,this.start,this.startLoc)},Fe.startNodeAt=function(N,xe){return new Pe(this,N,xe)};function Ve(N,xe,nt,It){return N.type=xe,N.end=nt,this.options.locations&&(N.loc.end=It),this.options.ranges&&(N.range[1]=nt),N}Fe.finishNode=function(N,xe){return Ve.call(this,N,xe,this.lastTokEnd,this.lastTokEndLoc)},Fe.finishNodeAt=function(N,xe,nt,It){return Ve.call(this,N,xe,nt,It)},Fe.copyNode=function(N){var xe=new Pe(this,N.start,this.startLoc);for(var nt in N)xe[nt]=N[nt];return xe};var Xe="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",Ke=Xe+" Extended_Pictographic",De=Ke,Ge=De+" EBase EComp EMod EPres ExtPict",At=Ge,kt=At,o={9:Xe,10:Ke,11:De,12:Ge,13:At,14:kt},ke="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",oi={9:"",10:"",11:"",12:"",13:"",14:ke},fi="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",Ai="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",ti=Ai+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",li=ti+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",Bi=li+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",vi=Bi+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",bi=vi+" Hrkt Katakana_Or_Hiragana Kawi Nag_Mundari Nagm Unknown Zzzz",Jt={9:Ai,10:ti,11:li,12:Bi,13:vi,14:bi},wn={};function ar(N){var xe=wn[N]={binary:Ot(o[N]+" "+fi),binaryOfStrings:Ot(oi[N]),nonBinary:{General_Category:Ot(fi),Script:Ot(Jt[N])}};xe.nonBinary.Script_Extensions=xe.nonBinary.Script,xe.nonBinary.gc=xe.nonBinary.General_Category,xe.nonBinary.sc=xe.nonBinary.Script,xe.nonBinary.scx=xe.nonBinary.Script_Extensions}for(var mn=0,Hn=[9,10,11,12,13,14];mn<Hn.length;mn+=1){var jr=Hn[mn];ar(jr)}var ji=v.prototype,ur=function(xe){this.parser=xe,this.validFlags="gim"+(xe.options.ecmaVersion>=6?"uy":"")+(xe.options.ecmaVersion>=9?"s":"")+(xe.options.ecmaVersion>=13?"d":"")+(xe.options.ecmaVersion>=15?"v":""),this.unicodeProperties=wn[xe.options.ecmaVersion>=14?14:xe.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};ur.prototype.reset=function(xe,nt,It){var $t=It.indexOf("v")!==-1,wi=It.indexOf("u")!==-1;this.start=xe|0,this.source=nt+"",this.flags=It,$t&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=wi&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=wi&&this.parser.options.ecmaVersion>=9)},ur.prototype.raise=function(xe){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+xe)},ur.prototype.at=function(xe,nt){nt===void 0&&(nt=!1);var It=this.source,$t=It.length;if(xe>=$t)return-1;var wi=It.charCodeAt(xe);if(!(nt||this.switchU)||wi<=55295||wi>=57344||xe+1>=$t)return wi;var Di=It.charCodeAt(xe+1);return Di>=56320&&Di<=57343?(wi<<10)+Di-56613888:wi},ur.prototype.nextIndex=function(xe,nt){nt===void 0&&(nt=!1);var It=this.source,$t=It.length;if(xe>=$t)return $t;var wi=It.charCodeAt(xe),Di;return!(nt||this.switchU)||wi<=55295||wi>=57344||xe+1>=$t||(Di=It.charCodeAt(xe+1))<56320||Di>57343?xe+1:xe+2},ur.prototype.current=function(xe){return xe===void 0&&(xe=!1),this.at(this.pos,xe)},ur.prototype.lookahead=function(xe){return xe===void 0&&(xe=!1),this.at(this.nextIndex(this.pos,xe),xe)},ur.prototype.advance=function(xe){xe===void 0&&(xe=!1),this.pos=this.nextIndex(this.pos,xe)},ur.prototype.eat=function(xe,nt){return nt===void 0&&(nt=!1),this.current(nt)===xe?(this.advance(nt),!0):!1},ur.prototype.eatChars=function(xe,nt){nt===void 0&&(nt=!1);for(var It=this.pos,$t=0,wi=xe;$t<wi.length;$t+=1){var Di=wi[$t],hn=this.at(It,nt);if(hn===-1||hn!==Di)return!1;It=this.nextIndex(It,nt)}return this.pos=It,!0},ji.validateRegExpFlags=function(N){for(var xe=N.validFlags,nt=N.flags,It=!1,$t=!1,wi=0;wi<nt.length;wi++){var Di=nt.charAt(wi);xe.indexOf(Di)===-1&&this.raise(N.start,"Invalid regular expression flag"),nt.indexOf(Di,wi+1)>-1&&this.raise(N.start,"Duplicate regular expression flag"),Di==="u"&&(It=!0),Di==="v"&&($t=!0)}this.options.ecmaVersion>=15&&It&&$t&&this.raise(N.start,"Invalid regular expression flag")},ji.validateRegExpPattern=function(N){this.regexp_pattern(N),!N.switchN&&this.options.ecmaVersion>=9&&N.groupNames.length>0&&(N.switchN=!0,this.regexp_pattern(N))},ji.regexp_pattern=function(N){N.pos=0,N.lastIntValue=0,N.lastStringValue="",N.lastAssertionIsQuantifiable=!1,N.numCapturingParens=0,N.maxBackReference=0,N.groupNames.length=0,N.backReferenceNames.length=0,this.regexp_disjunction(N),N.pos!==N.source.length&&(N.eat(41)&&N.raise("Unmatched ')'"),(N.eat(93)||N.eat(125))&&N.raise("Lone quantifier brackets")),N.maxBackReference>N.numCapturingParens&&N.raise("Invalid escape");for(var xe=0,nt=N.backReferenceNames;xe<nt.length;xe+=1){var It=nt[xe];N.groupNames.indexOf(It)===-1&&N.raise("Invalid named capture referenced")}},ji.regexp_disjunction=function(N){for(this.regexp_alternative(N);N.eat(124);)this.regexp_alternative(N);this.regexp_eatQuantifier(N,!0)&&N.raise("Nothing to repeat"),N.eat(123)&&N.raise("Lone quantifier brackets")},ji.regexp_alternative=function(N){for(;N.pos<N.source.length&&this.regexp_eatTerm(N););},ji.regexp_eatTerm=function(N){return this.regexp_eatAssertion(N)?(N.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(N)&&N.switchU&&N.raise("Invalid quantifier"),!0):(N.switchU?this.regexp_eatAtom(N):this.regexp_eatExtendedAtom(N))?(this.regexp_eatQuantifier(N),!0):!1},ji.regexp_eatAssertion=function(N){var xe=N.pos;if(N.lastAssertionIsQuantifiable=!1,N.eat(94)||N.eat(36))return!0;if(N.eat(92)){if(N.eat(66)||N.eat(98))return!0;N.pos=xe}if(N.eat(40)&&N.eat(63)){var nt=!1;if(this.options.ecmaVersion>=9&&(nt=N.eat(60)),N.eat(61)||N.eat(33))return this.regexp_disjunction(N),N.eat(41)||N.raise("Unterminated group"),N.lastAssertionIsQuantifiable=!nt,!0}return N.pos=xe,!1},ji.regexp_eatQuantifier=function(N,xe){return xe===void 0&&(xe=!1),this.regexp_eatQuantifierPrefix(N,xe)?(N.eat(63),!0):!1},ji.regexp_eatQuantifierPrefix=function(N,xe){return N.eat(42)||N.eat(43)||N.eat(63)||this.regexp_eatBracedQuantifier(N,xe)},ji.regexp_eatBracedQuantifier=function(N,xe){var nt=N.pos;if(N.eat(123)){var It=0,$t=-1;if(this.regexp_eatDecimalDigits(N)&&(It=N.lastIntValue,N.eat(44)&&this.regexp_eatDecimalDigits(N)&&($t=N.lastIntValue),N.eat(125)))return $t!==-1&&$t<It&&!xe&&N.raise("numbers out of order in {} quantifier"),!0;N.switchU&&!xe&&N.raise("Incomplete quantifier"),N.pos=nt}return!1},ji.regexp_eatAtom=function(N){return this.regexp_eatPatternCharacters(N)||N.eat(46)||this.regexp_eatReverseSolidusAtomEscape(N)||this.regexp_eatCharacterClass(N)||this.regexp_eatUncapturingGroup(N)||this.regexp_eatCapturingGroup(N)},ji.regexp_eatReverseSolidusAtomEscape=function(N){var xe=N.pos;if(N.eat(92)){if(this.regexp_eatAtomEscape(N))return!0;N.pos=xe}return!1},ji.regexp_eatUncapturingGroup=function(N){var xe=N.pos;if(N.eat(40)){if(N.eat(63)&&N.eat(58)){if(this.regexp_disjunction(N),N.eat(41))return!0;N.raise("Unterminated group")}N.pos=xe}return!1},ji.regexp_eatCapturingGroup=function(N){if(N.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(N):N.current()===63&&N.raise("Invalid group"),this.regexp_disjunction(N),N.eat(41))return N.numCapturingParens+=1,!0;N.raise("Unterminated group")}return!1},ji.regexp_eatExtendedAtom=function(N){return N.eat(46)||this.regexp_eatReverseSolidusAtomEscape(N)||this.regexp_eatCharacterClass(N)||this.regexp_eatUncapturingGroup(N)||this.regexp_eatCapturingGroup(N)||this.regexp_eatInvalidBracedQuantifier(N)||this.regexp_eatExtendedPatternCharacter(N)},ji.regexp_eatInvalidBracedQuantifier=function(N){return this.regexp_eatBracedQuantifier(N,!0)&&N.raise("Nothing to repeat"),!1},ji.regexp_eatSyntaxCharacter=function(N){var xe=N.current();return Vn(xe)?(N.lastIntValue=xe,N.advance(),!0):!1};function Vn(N){return N===36||N>=40&&N<=43||N===46||N===63||N>=91&&N<=94||N>=123&&N<=125}ji.regexp_eatPatternCharacters=function(N){for(var xe=N.pos,nt=0;(nt=N.current())!==-1&&!Vn(nt);)N.advance();return N.pos!==xe},ji.regexp_eatExtendedPatternCharacter=function(N){var xe=N.current();return xe!==-1&&xe!==36&&!(xe>=40&&xe<=43)&&xe!==46&&xe!==63&&xe!==91&&xe!==94&&xe!==124?(N.advance(),!0):!1},ji.regexp_groupSpecifier=function(N){if(N.eat(63)){if(this.regexp_eatGroupName(N)){N.groupNames.indexOf(N.lastStringValue)!==-1&&N.raise("Duplicate capture group name"),N.groupNames.push(N.lastStringValue);return}N.raise("Invalid group")}},ji.regexp_eatGroupName=function(N){if(N.lastStringValue="",N.eat(60)){if(this.regexp_eatRegExpIdentifierName(N)&&N.eat(62))return!0;N.raise("Invalid capture group name")}return!1},ji.regexp_eatRegExpIdentifierName=function(N){if(N.lastStringValue="",this.regexp_eatRegExpIdentifierStart(N)){for(N.lastStringValue+=gi(N.lastIntValue);this.regexp_eatRegExpIdentifierPart(N);)N.lastStringValue+=gi(N.lastIntValue);return!0}return!1},ji.regexp_eatRegExpIdentifierStart=function(N){var xe=N.pos,nt=this.options.ecmaVersion>=11,It=N.current(nt);return N.advance(nt),It===92&&this.regexp_eatRegExpUnicodeEscapeSequence(N,nt)&&(It=N.lastIntValue),Wt(It)?(N.lastIntValue=It,!0):(N.pos=xe,!1)};function Wt(N){return Je(N,!0)||N===36||N===95}ji.regexp_eatRegExpIdentifierPart=function(N){var xe=N.pos,nt=this.options.ecmaVersion>=11,It=N.current(nt);return N.advance(nt),It===92&&this.regexp_eatRegExpUnicodeEscapeSequence(N,nt)&&(It=N.lastIntValue),Yi(It)?(N.lastIntValue=It,!0):(N.pos=xe,!1)};function Yi(N){return st(N,!0)||N===36||N===95||N===8204||N===8205}ji.regexp_eatAtomEscape=function(N){return this.regexp_eatBackReference(N)||this.regexp_eatCharacterClassEscape(N)||this.regexp_eatCharacterEscape(N)||N.switchN&&this.regexp_eatKGroupName(N)?!0:(N.switchU&&(N.current()===99&&N.raise("Invalid unicode escape"),N.raise("Invalid escape")),!1)},ji.regexp_eatBackReference=function(N){var xe=N.pos;if(this.regexp_eatDecimalEscape(N)){var nt=N.lastIntValue;if(N.switchU)return nt>N.maxBackReference&&(N.maxBackReference=nt),!0;if(nt<=N.numCapturingParens)return!0;N.pos=xe}return!1},ji.regexp_eatKGroupName=function(N){if(N.eat(107)){if(this.regexp_eatGroupName(N))return N.backReferenceNames.push(N.lastStringValue),!0;N.raise("Invalid named reference")}return!1},ji.regexp_eatCharacterEscape=function(N){return this.regexp_eatControlEscape(N)||this.regexp_eatCControlLetter(N)||this.regexp_eatZero(N)||this.regexp_eatHexEscapeSequence(N)||this.regexp_eatRegExpUnicodeEscapeSequence(N,!1)||!N.switchU&&this.regexp_eatLegacyOctalEscapeSequence(N)||this.regexp_eatIdentityEscape(N)},ji.regexp_eatCControlLetter=function(N){var xe=N.pos;if(N.eat(99)){if(this.regexp_eatControlLetter(N))return!0;N.pos=xe}return!1},ji.regexp_eatZero=function(N){return N.current()===48&&!Dr(N.lookahead())?(N.lastIntValue=0,N.advance(),!0):!1},ji.regexp_eatControlEscape=function(N){var xe=N.current();return xe===116?(N.lastIntValue=9,N.advance(),!0):xe===110?(N.lastIntValue=10,N.advance(),!0):xe===118?(N.lastIntValue=11,N.advance(),!0):xe===102?(N.lastIntValue=12,N.advance(),!0):xe===114?(N.lastIntValue=13,N.advance(),!0):!1},ji.regexp_eatControlLetter=function(N){var xe=N.current();return Ut(xe)?(N.lastIntValue=xe%32,N.advance(),!0):!1};function Ut(N){return N>=65&&N<=90||N>=97&&N<=122}ji.regexp_eatRegExpUnicodeEscapeSequence=function(N,xe){xe===void 0&&(xe=!1);var nt=N.pos,It=xe||N.switchU;if(N.eat(117)){if(this.regexp_eatFixedHexDigits(N,4)){var $t=N.lastIntValue;if(It&&$t>=55296&&$t<=56319){var wi=N.pos;if(N.eat(92)&&N.eat(117)&&this.regexp_eatFixedHexDigits(N,4)){var Di=N.lastIntValue;if(Di>=56320&&Di<=57343)return N.lastIntValue=($t-55296)*1024+(Di-56320)+65536,!0}N.pos=wi,N.lastIntValue=$t}return!0}if(It&&N.eat(123)&&this.regexp_eatHexDigits(N)&&N.eat(125)&&Tn(N.lastIntValue))return!0;It&&N.raise("Invalid unicode escape"),N.pos=nt}return!1};function Tn(N){return N>=0&&N<=1114111}ji.regexp_eatIdentityEscape=function(N){if(N.switchU)return this.regexp_eatSyntaxCharacter(N)?!0:N.eat(47)?(N.lastIntValue=47,!0):!1;var xe=N.current();return xe!==99&&(!N.switchN||xe!==107)?(N.lastIntValue=xe,N.advance(),!0):!1},ji.regexp_eatDecimalEscape=function(N){N.lastIntValue=0;var xe=N.current();if(xe>=49&&xe<=57){do N.lastIntValue=10*N.lastIntValue+(xe-48),N.advance();while((xe=N.current())>=48&&xe<=57);return!0}return!1};var cr=0,Vs=1,Ur=2;ji.regexp_eatCharacterClassEscape=function(N){var xe=N.current();if(Vt(xe))return N.lastIntValue=-1,N.advance(),Vs;var nt=!1;if(N.switchU&&this.options.ecmaVersion>=9&&((nt=xe===80)||xe===112)){N.lastIntValue=-1,N.advance();var It;if(N.eat(123)&&(It=this.regexp_eatUnicodePropertyValueExpression(N))&&N.eat(125))return nt&&It===Ur&&N.raise("Invalid property name"),It;N.raise("Invalid property name")}return cr};function Vt(N){return N===100||N===68||N===115||N===83||N===119||N===87}ji.regexp_eatUnicodePropertyValueExpression=function(N){var xe=N.pos;if(this.regexp_eatUnicodePropertyName(N)&&N.eat(61)){var nt=N.lastStringValue;if(this.regexp_eatUnicodePropertyValue(N)){var It=N.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(N,nt,It),Vs}}if(N.pos=xe,this.regexp_eatLoneUnicodePropertyNameOrValue(N)){var $t=N.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(N,$t)}return cr},ji.regexp_validateUnicodePropertyNameAndValue=function(N,xe,nt){ut(N.unicodeProperties.nonBinary,xe)||N.raise("Invalid property name"),N.unicodeProperties.nonBinary[xe].test(nt)||N.raise("Invalid property value")},ji.regexp_validateUnicodePropertyNameOrValue=function(N,xe){if(N.unicodeProperties.binary.test(xe))return Vs;if(N.switchV&&N.unicodeProperties.binaryOfStrings.test(xe))return Ur;N.raise("Invalid property name")},ji.regexp_eatUnicodePropertyName=function(N){var xe=0;for(N.lastStringValue="";hr(xe=N.current());)N.lastStringValue+=gi(xe),N.advance();return N.lastStringValue!==""};function hr(N){return Ut(N)||N===95}ji.regexp_eatUnicodePropertyValue=function(N){var xe=0;for(N.lastStringValue="";Dt(xe=N.current());)N.lastStringValue+=gi(xe),N.advance();return N.lastStringValue!==""};function Dt(N){return hr(N)||Dr(N)}ji.regexp_eatLoneUnicodePropertyNameOrValue=function(N){return this.regexp_eatUnicodePropertyValue(N)},ji.regexp_eatCharacterClass=function(N){if(N.eat(91)){var xe=N.eat(94),nt=this.regexp_classContents(N);return N.eat(93)||N.raise("Unterminated character class"),xe&&nt===Ur&&N.raise("Negated character class may contain strings"),!0}return!1},ji.regexp_classContents=function(N){return N.current()===93?Vs:N.switchV?this.regexp_classSetExpression(N):(this.regexp_nonEmptyClassRanges(N),Vs)},ji.regexp_nonEmptyClassRanges=function(N){for(;this.regexp_eatClassAtom(N);){var xe=N.lastIntValue;if(N.eat(45)&&this.regexp_eatClassAtom(N)){var nt=N.lastIntValue;N.switchU&&(xe===-1||nt===-1)&&N.raise("Invalid character class"),xe!==-1&&nt!==-1&&xe>nt&&N.raise("Range out of order in character class")}}},ji.regexp_eatClassAtom=function(N){var xe=N.pos;if(N.eat(92)){if(this.regexp_eatClassEscape(N))return!0;if(N.switchU){var nt=N.current();(nt===99||Ga(nt))&&N.raise("Invalid class escape"),N.raise("Invalid escape")}N.pos=xe}var It=N.current();return It!==93?(N.lastIntValue=It,N.advance(),!0):!1},ji.regexp_eatClassEscape=function(N){var xe=N.pos;if(N.eat(98))return N.lastIntValue=8,!0;if(N.switchU&&N.eat(45))return N.lastIntValue=45,!0;if(!N.switchU&&N.eat(99)){if(this.regexp_eatClassControlLetter(N))return!0;N.pos=xe}return this.regexp_eatCharacterClassEscape(N)||this.regexp_eatCharacterEscape(N)},ji.regexp_classSetExpression=function(N){var xe=Vs,nt;if(!this.regexp_eatClassSetRange(N))if(nt=this.regexp_eatClassSetOperand(N)){nt===Ur&&(xe=Ur);for(var It=N.pos;N.eatChars([38,38]);){if(N.current()!==38&&(nt=this.regexp_eatClassSetOperand(N))){nt!==Ur&&(xe=Vs);continue}N.raise("Invalid character in character class")}if(It!==N.pos)return xe;for(;N.eatChars([45,45]);)this.regexp_eatClassSetOperand(N)||N.raise("Invalid character in character class");if(It!==N.pos)return xe}else N.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(N)){if(nt=this.regexp_eatClassSetOperand(N),!nt)return xe;nt===Ur&&(xe=Ur)}},ji.regexp_eatClassSetRange=function(N){var xe=N.pos;if(this.regexp_eatClassSetCharacter(N)){var nt=N.lastIntValue;if(N.eat(45)&&this.regexp_eatClassSetCharacter(N)){var It=N.lastIntValue;return nt!==-1&&It!==-1&&nt>It&&N.raise("Range out of order in character class"),!0}N.pos=xe}return!1},ji.regexp_eatClassSetOperand=function(N){return this.regexp_eatClassSetCharacter(N)?Vs:this.regexp_eatClassStringDisjunction(N)||this.regexp_eatNestedClass(N)},ji.regexp_eatNestedClass=function(N){var xe=N.pos;if(N.eat(91)){var nt=N.eat(94),It=this.regexp_classContents(N);if(N.eat(93))return nt&&It===Ur&&N.raise("Negated character class may contain strings"),It;N.pos=xe}if(N.eat(92)){var $t=this.regexp_eatCharacterClassEscape(N);if($t)return $t;N.pos=xe}return null},ji.regexp_eatClassStringDisjunction=function(N){var xe=N.pos;if(N.eatChars([92,113])){if(N.eat(123)){var nt=this.regexp_classStringDisjunctionContents(N);if(N.eat(125))return nt}else N.raise("Invalid escape");N.pos=xe}return null},ji.regexp_classStringDisjunctionContents=function(N){for(var xe=this.regexp_classString(N);N.eat(124);)this.regexp_classString(N)===Ur&&(xe=Ur);return xe},ji.regexp_classString=function(N){for(var xe=0;this.regexp_eatClassSetCharacter(N);)xe++;return xe===1?Vs:Ur},ji.regexp_eatClassSetCharacter=function(N){var xe=N.pos;if(N.eat(92))return this.regexp_eatCharacterEscape(N)||this.regexp_eatClassSetReservedPunctuator(N)?!0:N.eat(98)?(N.lastIntValue=8,!0):(N.pos=xe,!1);var nt=N.current();return nt<0||nt===N.lookahead()&&Fr(nt)||Us(nt)?!1:(N.advance(),N.lastIntValue=nt,!0)};function Fr(N){return N===33||N>=35&&N<=38||N>=42&&N<=44||N===46||N>=58&&N<=64||N===94||N===96||N===126}function Us(N){return N===40||N===41||N===45||N===47||N>=91&&N<=93||N>=123&&N<=125}ji.regexp_eatClassSetReservedPunctuator=function(N){var xe=N.current();return ca(xe)?(N.lastIntValue=xe,N.advance(),!0):!1};function ca(N){return N===33||N===35||N===37||N===38||N===44||N===45||N>=58&&N<=62||N===64||N===96||N===126}ji.regexp_eatClassControlLetter=function(N){var xe=N.current();return Dr(xe)||xe===95?(N.lastIntValue=xe%32,N.advance(),!0):!1},ji.regexp_eatHexEscapeSequence=function(N){var xe=N.pos;if(N.eat(120)){if(this.regexp_eatFixedHexDigits(N,2))return!0;N.switchU&&N.raise("Invalid escape"),N.pos=xe}return!1},ji.regexp_eatDecimalDigits=function(N){var xe=N.pos,nt=0;for(N.lastIntValue=0;Dr(nt=N.current());)N.lastIntValue=10*N.lastIntValue+(nt-48),N.advance();return N.pos!==xe};function Dr(N){return N>=48&&N<=57}ji.regexp_eatHexDigits=function(N){var xe=N.pos,nt=0;for(N.lastIntValue=0;Ua(nt=N.current());)N.lastIntValue=16*N.lastIntValue+Fo(nt),N.advance();return N.pos!==xe};function Ua(N){return N>=48&&N<=57||N>=65&&N<=70||N>=97&&N<=102}function Fo(N){return N>=65&&N<=70?10+(N-65):N>=97&&N<=102?10+(N-97):N-48}ji.regexp_eatLegacyOctalEscapeSequence=function(N){if(this.regexp_eatOctalDigit(N)){var xe=N.lastIntValue;if(this.regexp_eatOctalDigit(N)){var nt=N.lastIntValue;xe<=3&&this.regexp_eatOctalDigit(N)?N.lastIntValue=xe*64+nt*8+N.lastIntValue:N.lastIntValue=xe*8+nt}else N.lastIntValue=xe;return!0}return!1},ji.regexp_eatOctalDigit=function(N){var xe=N.current();return Ga(xe)?(N.lastIntValue=xe-48,N.advance(),!0):(N.lastIntValue=0,!1)};function Ga(N){return N>=48&&N<=55}ji.regexp_eatFixedHexDigits=function(N,xe){var nt=N.pos;N.lastIntValue=0;for(var It=0;It<xe;++It){var $t=N.current();if(!Ua($t))return N.pos=nt,!1;N.lastIntValue=16*N.lastIntValue+Fo($t),N.advance()}return!0};var Xs=function(xe){this.type=xe.type,this.value=xe.value,this.start=xe.start,this.end=xe.end,xe.options.locations&&(this.loc=new Ri(xe,xe.startLoc,xe.endLoc)),xe.options.ranges&&(this.range=[xe.start,xe.end])},Qn=v.prototype;Qn.next=function(N){!N&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Xs(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},Qn.getToken=function(){return this.next(),new Xs(this)},typeof Symbol<"u"&&(Qn[Symbol.iterator]=function(){var N=this;return{next:function(){var xe=N.getToken();return{done:xe.type===Oe.eof,value:xe}}}}),Qn.nextToken=function(){var N=this.curContext();if((!N||!N.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(Oe.eof);if(N.override)return N.override(this);this.readToken(this.fullCharCodeAtPos())},Qn.readToken=function(N){return Je(N,this.options.ecmaVersion>=6)||N===92?this.readWord():this.getTokenFromCode(N)},Qn.fullCharCodeAtPos=function(){var N=this.input.charCodeAt(this.pos);if(N<=55295||N>=56320)return N;var xe=this.input.charCodeAt(this.pos+1);return xe<=56319||xe>=57344?N:(N<<10)+xe-56613888},Qn.skipBlockComment=function(){var N=this.options.onComment&&this.curPosition(),xe=this.pos,nt=this.input.indexOf("*/",this.pos+=2);if(nt===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=nt+2,this.options.locations)for(var It=void 0,$t=xe;(It=mt(this.input,$t,this.pos))>-1;)++this.curLine,$t=this.lineStart=It;this.options.onComment&&this.options.onComment(!0,this.input.slice(xe+2,nt),xe,this.pos,N,this.curPosition())},Qn.skipLineComment=function(N){for(var xe=this.pos,nt=this.options.onComment&&this.curPosition(),It=this.input.charCodeAt(this.pos+=N);this.pos<this.input.length&&!_t(It);)It=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(xe+N,this.pos),xe,this.pos,nt,this.curPosition())},Qn.skipSpace=function(){e:for(;this.pos<this.input.length;){var N=this.input.charCodeAt(this.pos);switch(N){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(N>8&&N<14||N>=5760&&xt.test(String.fromCharCode(N)))++this.pos;else break e}}},Qn.finishToken=function(N,xe){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var nt=this.type;this.type=N,this.value=xe,this.updateContext(nt)},Qn.readToken_dot=function(){var N=this.input.charCodeAt(this.pos+1);if(N>=48&&N<=57)return this.readNumber(!0);var xe=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&N===46&&xe===46?(this.pos+=3,this.finishToken(Oe.ellipsis)):(++this.pos,this.finishToken(Oe.dot))},Qn.readToken_slash=function(){var N=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):N===61?this.finishOp(Oe.assign,2):this.finishOp(Oe.slash,1)},Qn.readToken_mult_modulo_exp=function(N){var xe=this.input.charCodeAt(this.pos+1),nt=1,It=N===42?Oe.star:Oe.modulo;return this.options.ecmaVersion>=7&&N===42&&xe===42&&(++nt,It=Oe.starstar,xe=this.input.charCodeAt(this.pos+2)),xe===61?this.finishOp(Oe.assign,nt+1):this.finishOp(It,nt)},Qn.readToken_pipe_amp=function(N){var xe=this.input.charCodeAt(this.pos+1);if(xe===N){if(this.options.ecmaVersion>=12){var nt=this.input.charCodeAt(this.pos+2);if(nt===61)return this.finishOp(Oe.assign,3)}return this.finishOp(N===124?Oe.logicalOR:Oe.logicalAND,2)}return xe===61?this.finishOp(Oe.assign,2):this.finishOp(N===124?Oe.bitwiseOR:Oe.bitwiseAND,1)},Qn.readToken_caret=function(){var N=this.input.charCodeAt(this.pos+1);return N===61?this.finishOp(Oe.assign,2):this.finishOp(Oe.bitwiseXOR,1)},Qn.readToken_plus_min=function(N){var xe=this.input.charCodeAt(this.pos+1);return xe===N?xe===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||jt.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(Oe.incDec,2):xe===61?this.finishOp(Oe.assign,2):this.finishOp(Oe.plusMin,1)},Qn.readToken_lt_gt=function(N){var xe=this.input.charCodeAt(this.pos+1),nt=1;return xe===N?(nt=N===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+nt)===61?this.finishOp(Oe.assign,nt+1):this.finishOp(Oe.bitShift,nt)):xe===33&&N===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(xe===61&&(nt=2),this.finishOp(Oe.relational,nt))},Qn.readToken_eq_excl=function(N){var xe=this.input.charCodeAt(this.pos+1);return xe===61?this.finishOp(Oe.equality,this.input.charCodeAt(this.pos+2)===61?3:2):N===61&&xe===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(Oe.arrow)):this.finishOp(N===61?Oe.eq:Oe.prefix,1)},Qn.readToken_question=function(){var N=this.options.ecmaVersion;if(N>=11){var xe=this.input.charCodeAt(this.pos+1);if(xe===46){var nt=this.input.charCodeAt(this.pos+2);if(nt<48||nt>57)return this.finishOp(Oe.questionDot,2)}if(xe===63){if(N>=12){var It=this.input.charCodeAt(this.pos+2);if(It===61)return this.finishOp(Oe.assign,3)}return this.finishOp(Oe.coalesce,2)}}return this.finishOp(Oe.question,1)},Qn.readToken_numberSign=function(){var N=this.options.ecmaVersion,xe=35;if(N>=13&&(++this.pos,xe=this.fullCharCodeAtPos(),Je(xe,!0)||xe===92))return this.finishToken(Oe.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+gi(xe)+"'")},Qn.getTokenFromCode=function(N){switch(N){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(Oe.parenL);case 41:return++this.pos,this.finishToken(Oe.parenR);case 59:return++this.pos,this.finishToken(Oe.semi);case 44:return++this.pos,this.finishToken(Oe.comma);case 91:return++this.pos,this.finishToken(Oe.bracketL);case 93:return++this.pos,this.finishToken(Oe.bracketR);case 123:return++this.pos,this.finishToken(Oe.braceL);case 125:return++this.pos,this.finishToken(Oe.braceR);case 58:return++this.pos,this.finishToken(Oe.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(Oe.backQuote);case 48:var xe=this.input.charCodeAt(this.pos+1);if(xe===120||xe===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(xe===111||xe===79)return this.readRadixNumber(8);if(xe===98||xe===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(N);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(N);case 124:case 38:return this.readToken_pipe_amp(N);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(N);case 60:case 62:return this.readToken_lt_gt(N);case 61:case 33:return this.readToken_eq_excl(N);case 63:return this.readToken_question();case 126:return this.finishOp(Oe.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+gi(N)+"'")},Qn.finishOp=function(N,xe){var nt=this.input.slice(this.pos,this.pos+xe);return this.pos+=xe,this.finishToken(N,nt)},Qn.readRegexp=function(){for(var N,xe,nt=this.pos;;){this.pos>=this.input.length&&this.raise(nt,"Unterminated regular expression");var It=this.input.charAt(this.pos);if(jt.test(It)&&this.raise(nt,"Unterminated regular expression"),N)N=!1;else{if(It==="[")xe=!0;else if(It==="]"&&xe)xe=!1;else if(It==="/"&&!xe)break;N=It==="\\"}++this.pos}var $t=this.input.slice(nt,this.pos);++this.pos;var wi=this.pos,Di=this.readWord1();this.containsEsc&&this.unexpected(wi);var hn=this.regexpState||(this.regexpState=new ur(this));hn.reset(nt,$t,Di),this.validateRegExpFlags(hn),this.validateRegExpPattern(hn);var dn=null;try{dn=new RegExp($t,Di)}catch{}return this.finishToken(Oe.regexp,{pattern:$t,flags:Di,value:dn})},Qn.readInt=function(N,xe,nt){for(var It=this.options.ecmaVersion>=12&&xe===void 0,$t=nt&&this.input.charCodeAt(this.pos)===48,wi=this.pos,Di=0,hn=0,dn=0,rr=xe??1/0;dn<rr;++dn,++this.pos){var Ar=this.input.charCodeAt(this.pos),Or=void 0;if(It&&Ar===95){$t&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),hn===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),dn===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),hn=Ar;continue}if(Ar>=97?Or=Ar-97+10:Ar>=65?Or=Ar-65+10:Ar>=48&&Ar<=57?Or=Ar-48:Or=1/0,Or>=N)break;hn=Ar,Di=Di*N+Or}return It&&hn===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===wi||xe!=null&&this.pos-wi!==xe?null:Di};function aa(N,xe){return xe?parseInt(N,8):parseFloat(N.replace(/_/g,""))}function hs(N){return typeof BigInt!="function"?null:BigInt(N.replace(/_/g,""))}Qn.readRadixNumber=function(N){var xe=this.pos;this.pos+=2;var nt=this.readInt(N);return nt==null&&this.raise(this.start+2,"Expected number in radix "+N),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(nt=hs(this.input.slice(xe,this.pos)),++this.pos):Je(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Oe.num,nt)},Qn.readNumber=function(N){var xe=this.pos;!N&&this.readInt(10,void 0,!0)===null&&this.raise(xe,"Invalid number");var nt=this.pos-xe>=2&&this.input.charCodeAt(xe)===48;nt&&this.strict&&this.raise(xe,"Invalid number");var It=this.input.charCodeAt(this.pos);if(!nt&&!N&&this.options.ecmaVersion>=11&&It===110){var $t=hs(this.input.slice(xe,this.pos));return++this.pos,Je(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Oe.num,$t)}nt&&/[89]/.test(this.input.slice(xe,this.pos))&&(nt=!1),It===46&&!nt&&(++this.pos,this.readInt(10),It=this.input.charCodeAt(this.pos)),(It===69||It===101)&&!nt&&(It=this.input.charCodeAt(++this.pos),(It===43||It===45)&&++this.pos,this.readInt(10)===null&&this.raise(xe,"Invalid number")),Je(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var wi=aa(this.input.slice(xe,this.pos),nt);return this.finishToken(Oe.num,wi)},Qn.readCodePoint=function(){var N=this.input.charCodeAt(this.pos),xe;if(N===123){this.options.ecmaVersion<6&&this.unexpected();var nt=++this.pos;xe=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,xe>1114111&&this.invalidStringToken(nt,"Code point out of bounds")}else xe=this.readHexChar(4);return xe},Qn.readString=function(N){for(var xe="",nt=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var It=this.input.charCodeAt(this.pos);if(It===N)break;It===92?(xe+=this.input.slice(nt,this.pos),xe+=this.readEscapedChar(!1),nt=this.pos):It===8232||It===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(_t(It)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return xe+=this.input.slice(nt,this.pos++),this.finishToken(Oe.string,xe)};var qa={};Qn.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(N){if(N===qa)this.readInvalidTemplateToken();else throw N}this.inTemplateElement=!1},Qn.invalidStringToken=function(N,xe){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw qa;this.raise(N,xe)},Qn.readTmplToken=function(){for(var N="",xe=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var nt=this.input.charCodeAt(this.pos);if(nt===96||nt===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===Oe.template||this.type===Oe.invalidTemplate)?nt===36?(this.pos+=2,this.finishToken(Oe.dollarBraceL)):(++this.pos,this.finishToken(Oe.backQuote)):(N+=this.input.slice(xe,this.pos),this.finishToken(Oe.template,N));if(nt===92)N+=this.input.slice(xe,this.pos),N+=this.readEscapedChar(!0),xe=this.pos;else if(_t(nt)){switch(N+=this.input.slice(xe,this.pos),++this.pos,nt){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:N+=`
`;break;default:N+=String.fromCharCode(nt);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),xe=this.pos}else++this.pos}},Qn.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(Oe.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},Qn.readEscapedChar=function(N){var xe=this.input.charCodeAt(++this.pos);switch(++this.pos,xe){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return gi(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),N){var nt=this.pos-1;this.invalidStringToken(nt,"Invalid escape sequence in template string")}default:if(xe>=48&&xe<=55){var It=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],$t=parseInt(It,8);return $t>255&&(It=It.slice(0,-1),$t=parseInt(It,8)),this.pos+=It.length-1,xe=this.input.charCodeAt(this.pos),(It!=="0"||xe===56||xe===57)&&(this.strict||N)&&this.invalidStringToken(this.pos-1-It.length,N?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode($t)}return _t(xe)?"":String.fromCharCode(xe)}},Qn.readHexChar=function(N){var xe=this.pos,nt=this.readInt(16,N);return nt===null&&this.invalidStringToken(xe,"Bad character escape sequence"),nt},Qn.readWord1=function(){this.containsEsc=!1;for(var N="",xe=!0,nt=this.pos,It=this.options.ecmaVersion>=6;this.pos<this.input.length;){var $t=this.fullCharCodeAtPos();if(st($t,It))this.pos+=$t<=65535?1:2;else if($t===92){this.containsEsc=!0,N+=this.input.slice(nt,this.pos);var wi=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var Di=this.readCodePoint();(xe?Je:st)(Di,It)||this.invalidStringToken(wi,"Invalid Unicode escape"),N+=gi(Di),nt=this.pos}else break;xe=!1}return N+this.input.slice(nt,this.pos)},Qn.readWord=function(){var N=this.readWord1(),xe=Oe.name;return this.keywords.test(N)&&(xe=zt[N]),this.finishToken(xe,N)};var al="8.11.3";v.acorn={Parser:v,version:al,defaultOptions:Hi,Position:Ci,SourceLocation:Ri,getLineInfo:Ki,Node:Pe,TokenType:Ye,tokTypes:Oe,keywordTypes:zt,TokContext:rt,tokContexts:Me,isIdentifierChar:st,isIdentifierStart:Je,Token:Xs,isNewLine:_t,lineBreak:jt,lineBreakG:at,nonASCIIwhitespace:xt};function ol(N,xe){return v.parse(N,xe)}function no(N,xe,nt){return v.parseExpressionAt(N,xe,nt)}function Ha(N,xe){return v.tokenizer(N,xe)}n.Node=Pe,n.Parser=v,n.Position=Ci,n.SourceLocation=Ri,n.TokContext=rt,n.Token=Xs,n.TokenType=Ye,n.defaultOptions=Hi,n.getLineInfo=Ki,n.isIdentifierChar=st,n.isIdentifierStart=Je,n.isNewLine=_t,n.keywordTypes=zt,n.lineBreak=jt,n.lineBreakG=at,n.nonASCIIwhitespace=xt,n.parse=ol,n.parseExpressionAt=no,n.tokContexts=Me,n.tokTypes=Oe,n.tokenizer=Ha,n.version=al})}(Ug,Ug.exports)),Ug.exports}/*!
 * Paper.js v0.12.17 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jrg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Thu Nov 3 21:15:36 2022 +0100
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jrg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */(function(e){(function(t,n){t=t||bx;var c=t.window,g=t.document,x=new function(){var v=/^(statics|enumerable|beans|preserve)$/,k=[],V=k.slice,Y=Object.create,te=Object.getOwnPropertyDescriptor,fe=Object.defineProperty,ve=k.forEach||function(Ze,Ue){for(var dt=0,rt=this.length;dt<rt;dt++)Ze.call(Ue,this[dt],dt,this)},Ie=function(Ze,Ue){for(var dt in this)this.hasOwnProperty(dt)&&Ze.call(Ue,this[dt],dt,this)},Ee=Object.assign||function(Ze){for(var Ue=1,dt=arguments.length;Ue<dt;Ue++){var rt=arguments[Ue];for(var Me in rt)rt.hasOwnProperty(Me)&&(Ze[Me]=rt[Me])}return Ze},ze=function(Ze,Ue,dt){if(Ze){var rt=te(Ze,"length");(rt&&typeof rt.value=="number"?ve:Ie).call(Ze,Ue,dt=dt||Ze)}return dt};function Qe(Ze,Ue,dt,rt,Me){var se={};function ne(ge,Pe){Pe=Pe||(Pe=te(Ue,ge))&&(Pe.get?Pe:Pe.value),typeof Pe=="string"&&Pe[0]==="#"&&(Pe=Ze[Pe.substring(1)]||Pe);var Fe=typeof Pe=="function",Ve=Pe,Xe=Me||Fe&&!Pe.base?Pe&&Pe.get?ge in Ze:Ze[ge]:null,Ke;(!Me||!Xe)&&(Fe&&Xe&&(Pe.base=Xe),Fe&&rt!==!1&&(Ke=ge.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(se[Ke[3].toLowerCase()+Ke[4]]=Ke[2]),(!Ve||Fe||!Ve.get||typeof Ve.get!="function"||!He.isPlainObject(Ve))&&(Ve={value:Ve,writable:!0}),(te(Ze,ge)||{configurable:!0}).configurable&&(Ve.configurable=!0,Ve.enumerable=dt??!Ke),fe(Ze,ge,Ve))}if(Ue){for(var $ in Ue)Ue.hasOwnProperty($)&&!v.test($)&&ne($);for(var $ in se){var ie=se[$],de=Ze["set"+ie],ye=Ze["get"+ie]||de&&Ze["is"+ie];ye&&(rt===!0||ye.length===0)&&ne($,{get:ye,set:de})}}return Ze}function He(){for(var Ze=0,Ue=arguments.length;Ze<Ue;Ze++){var dt=arguments[Ze];dt&&Ee(this,dt)}return this}return Qe(He,{inject:function(Ze){if(Ze){var Ue=Ze.statics===!0?Ze:Ze.statics,dt=Ze.beans,rt=Ze.preserve;Ue!==Ze&&Qe(this.prototype,Ze,Ze.enumerable,dt,rt),Qe(this,Ue,null,dt,rt)}for(var Me=1,se=arguments.length;Me<se;Me++)this.inject(arguments[Me]);return this},extend:function(){for(var Ze=this,Ue,dt,rt=0,Me,se=arguments.length;rt<se&&!(Ue&&dt);rt++)Me=arguments[rt],Ue=Ue||Me.initialize,dt=dt||Me.prototype;return Ue=Ue||function(){Ze.apply(this,arguments)},dt=Ue.prototype=dt||Y(this.prototype),fe(dt,"constructor",{value:Ue,writable:!0,configurable:!0}),Qe(Ue,this),arguments.length&&this.inject.apply(Ue,arguments),Ue.base=Ze,Ue}}).inject({enumerable:!1,initialize:He,set:He,inject:function(){for(var Ze=0,Ue=arguments.length;Ze<Ue;Ze++){var dt=arguments[Ze];dt&&Qe(this,dt,dt.enumerable,dt.beans,dt.preserve)}return this},extend:function(){var Ze=Y(this);return Ze.inject.apply(Ze,arguments)},each:function(Ze,Ue){return ze(this,Ze,Ue)},clone:function(){return new this.constructor(this)},statics:{set:Ee,each:ze,create:Y,define:fe,describe:te,clone:function(Ze){return Ee(new Ze.constructor,Ze)},isPlainObject:function(Ze){var Ue=Ze!=null&&Ze.constructor;return Ue&&(Ue===Object||Ue===He||Ue.name==="Object")},pick:function(Ze,Ue){return Ze!==n?Ze:Ue},slice:function(Ze,Ue,dt){return V.call(Ze,Ue,dt)}}})};e.exports=x,x.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+x.each(this,function(v,k){if(!/^_/.test(k)){var V=typeof v;this.push(k+": "+(V==="number"?he.instance.number(v):V==="string"?"'"+v+"'":v))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(v){return x.importJSON(v,this)},exportJSON:function(v){return x.exportJSON(this,v)},toJSON:function(){return x.serialize(this)},set:function(v,k){return v&&x.filter(this,v,k,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function v(){var k=v.base.apply(this,arguments),V=k.prototype._class;return V&&!x.exports[V]&&(x.exports[V]=k),k},equals:function(v,k){if(v===k)return!0;if(v&&v.equals)return v.equals(k);if(k&&k.equals)return k.equals(v);if(v&&k&&typeof v=="object"&&typeof k=="object"){if(Array.isArray(v)&&Array.isArray(k)){var V=v.length;if(V!==k.length)return!1;for(;V--;)if(!x.equals(v[V],k[V]))return!1}else{var Y=Object.keys(v),V=Y.length;if(V!==Object.keys(k).length)return!1;for(;V--;){var te=Y[V];if(!(k.hasOwnProperty(te)&&x.equals(v[te],k[te])))return!1}}return!0}return!1},read:function(v,k,V,Y){if(this===x){var te=this.peek(v,k);return v.__index++,te}var fe=this.prototype,ve=fe._readIndex,Ie=k||ve&&v.__index||0,Ee=v.length,ze=v[Ie];if(Y=Y||Ee-Ie,ze instanceof this||V&&V.readNull&&ze==null&&Y<=1)return ve&&(v.__index=Ie+1),ze&&V&&V.clone?ze.clone():ze;if(ze=x.create(fe),ve&&(ze.__read=!0),ze=ze.initialize.apply(ze,Ie>0||Ie+Y<Ee?x.slice(v,Ie,Ie+Y):v)||ze,ve){v.__index=Ie+ze.__read;var Qe=ze.__filtered;Qe&&(v.__filtered=Qe,ze.__filtered=n),ze.__read=n}return ze},peek:function(v,k){return v[v.__index=k||v.__index||0]},remain:function(v){return v.length-(v.__index||0)},readList:function(v,k,V,Y){for(var te=[],fe,ve=k||0,Ie=Y?ve+Y:v.length,Ee=ve;Ee<Ie;Ee++)te.push(Array.isArray(fe=v[Ee])?this.read(fe,0,V):this.read(v,Ee,V,1));return te},readNamed:function(v,k,V,Y,te){var fe=this.getNamed(v,k),ve=fe!==n;if(ve){var Ie=v.__filtered;if(!Ie){var Ee=this.getSource(v);Ie=v.__filtered=x.create(Ee),Ie.__unfiltered=Ee}Ie[k]=n}return this.read(ve?[fe]:v,V,Y,te)},readSupported:function(v,k){var V=this.getSource(v),Y=this,te=!1;return V&&Object.keys(V).forEach(function(fe){if(fe in k){var ve=Y.readNamed(v,fe);ve!==n&&(k[fe]=ve),te=!0}}),te},getSource:function(v){var k=v.__source;if(k===n){var V=v.length===1&&v[0];k=v.__source=V&&x.isPlainObject(V)?V:null}return k},getNamed:function(v,k){var V=this.getSource(v);if(V)return k?V[k]:v.__filtered||V},hasNamed:function(v,k){return!!this.getNamed(v,k)},filter:function(v,k,V,Y){var te;function fe(Qe){if(!(V&&Qe in V)&&!(te&&Qe in te)){var He=k[Qe];He!==n&&(v[Qe]=He)}}if(Y){for(var ve={},Ie=0,Ee,ze=Y.length;Ie<ze;Ie++)(Ee=Y[Ie])in k&&(fe(Ee),ve[Ee]=!0);te=ve}return Object.keys(k.__unfiltered||k).forEach(fe),v},isPlainValue:function(v,k){return x.isPlainObject(v)||Array.isArray(v)||k&&typeof v=="string"},serialize:function(v,k,V,Y){k=k||{};var te=!Y,fe;if(te&&(k.formatter=new he(k.precision),Y={length:0,definitions:{},references:{},add:function(He,Ze){var Ue="#"+He._id,dt=this.references[Ue];if(!dt){this.length++;var rt=Ze.call(He),Me=He._class;Me&&rt[0]!==Me&&rt.unshift(Me),this.definitions[Ue]=rt,dt=this.references[Ue]=[Ue]}return dt}}),v&&v._serialize){fe=v._serialize(k,Y);var ve=v._class;ve&&!v._compactSerialize&&(te||!V)&&fe[0]!==ve&&fe.unshift(ve)}else if(Array.isArray(v)){fe=[];for(var Ie=0,Ee=v.length;Ie<Ee;Ie++)fe[Ie]=x.serialize(v[Ie],k,V,Y)}else if(x.isPlainObject(v)){fe={};for(var ze=Object.keys(v),Ie=0,Ee=ze.length;Ie<Ee;Ie++){var Qe=ze[Ie];fe[Qe]=x.serialize(v[Qe],k,V,Y)}}else typeof v=="number"?fe=k.formatter.number(v,k.precision):fe=v;return te&&Y.length>0?[["dictionary",Y.definitions],fe]:fe},deserialize:function(v,k,V,Y,te){var fe=v,ve=!V,Ie=ve&&v&&v.length&&v[0][0]==="dictionary";if(V=V||{},Array.isArray(v)){var Ee=v[0],ze=Ee==="dictionary";if(v.length==1&&/^#/.test(Ee))return V.dictionary[Ee];Ee=x.exports[Ee],fe=[];for(var Qe=Ee?1:0,He=v.length;Qe<He;Qe++)fe.push(x.deserialize(v[Qe],k,V,ze,Ie));if(Ee){var Ze=fe;k?fe=k(Ee,Ze,ve||te):fe=new Ee(Ze)}}else if(x.isPlainObject(v)){fe={},Y&&(V.dictionary=fe);for(var Ue in v)fe[Ue]=x.deserialize(v[Ue],k,V)}return Ie?fe[1]:fe},exportJSON:function(v,k){var V=x.serialize(v,k);return k&&k.asString==!1?V:JSON.stringify(V)},importJSON:function(v,k){return x.deserialize(typeof v=="string"?JSON.parse(v):v,function(V,Y,te){var fe=te&&k&&k.constructor===V,ve=fe?k:x.create(V.prototype);if(Y.length===1&&ve instanceof Oe&&(fe||!(ve instanceof at))){var Ie=Y[0];x.isPlainObject(Ie)&&(Ie.insert=!1,fe&&(Y=Y.concat([Oe.INSERT])))}return(fe?ve.set:V).apply(ve,Y),fe&&(k=null),ve})},push:function(v,k){var V=k.length;if(V<4096)v.push.apply(v,k);else{var Y=v.length;v.length+=V;for(var te=0;te<V;te++)v[Y+te]=k[te]}return v},splice:function(v,k,V,Y){var te=k&&k.length,fe=V===n;V=fe?v.length:V,V>v.length&&(V=v.length);for(var ve=0;ve<te;ve++)k[ve]._index=V+ve;if(fe)return x.push(v,k),[];var Ie=[V,Y];k&&x.push(Ie,k);for(var Ee=v.splice.apply(v,Ie),ve=0,ze=Ee.length;ve<ze;ve++)Ee[ve]._index=n;for(var ve=V+te,ze=v.length;ve<ze;ve++)v[ve]._index=ve;return Ee},capitalize:function(v){return v.replace(/\b[a-z]/g,function(k){return k.toUpperCase()})},camelize:function(v){return v.replace(/-(.)/g,function(k,V){return V.toUpperCase()})},hyphenate:function(v){return v.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var S={on:function(v,k){if(typeof v!="string")x.each(v,function(fe,ve){this.on(ve,fe)},this);else{var V=this._eventTypes,Y=V&&V[v],te=this._callbacks=this._callbacks||{};te=te[v]=te[v]||[],te.indexOf(k)===-1&&(te.push(k),Y&&Y.install&&te.length===1&&Y.install.call(this,v))}return this},off:function(v,k){if(typeof v!="string"){x.each(v,function(ve,Ie){this.off(Ie,ve)},this);return}var V=this._eventTypes,Y=V&&V[v],te=this._callbacks&&this._callbacks[v],fe;return te&&(!k||(fe=te.indexOf(k))!==-1&&te.length===1?(Y&&Y.uninstall&&Y.uninstall.call(this,v),delete this._callbacks[v]):fe!==-1&&te.splice(fe,1)),this},once:function(v,k){return this.on(v,function V(){k.apply(this,arguments),this.off(v,V)})},emit:function(v,k){var V=this._callbacks&&this._callbacks[v];if(!V)return!1;var Y=x.slice(arguments,1),te=k&&k.target&&!k.currentTarget;V=V.slice(),te&&(k.currentTarget=this);for(var fe=0,ve=V.length;fe<ve;fe++)if(V[fe].apply(this,Y)==!1){k&&k.stop&&k.stop();break}return te&&delete k.currentTarget,!0},responds:function(v){return!!(this._callbacks&&this._callbacks[v])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(v){var k=this._eventTypes,V=this._callbacks,Y=v?"install":"uninstall";if(k){for(var te in V)if(V[te].length>0){var fe=k[te],ve=fe&&fe[Y];ve&&ve.call(this,te)}}},statics:{inject:function v(k){var V=k._events;if(V){var Y={};x.each(V,function(te,fe){var ve=typeof te=="string",Ie=ve?te:fe,Ee=x.capitalize(Ie),ze=Ie.substring(2).toLowerCase();Y[ze]=ve?{}:te,Ie="_"+Ie,k["get"+Ee]=function(){return this[Ie]},k["set"+Ee]=function(Qe){var He=this[Ie];He&&this.off(ze,He),Qe&&this.on(ze,Qe),this[Ie]=Qe}}),k._eventTypes=Y}return v.base.apply(this,arguments)}}},a=x.extend({_class:"PaperScope",initialize:function v(){pn=this,this.settings=new x({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=v._id++,v._scopes[this._id]=this;var k=v.prototype;if(!this.support){var V=sn.getContext(1,1)||{};k.support={nativeDash:"setLineDash"in V||"mozDash"in V,nativeBlendModes:lr.nativeModes},sn.release(V)}if(!this.agent){var Y=t.navigator.userAgent.toLowerCase(),te=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(Y)||[])[0],fe=te==="darwin"?"mac":te,ve=k.agent=k.browser={platform:fe};fe&&(ve[fe]=!0),Y.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(Ie,Ee,ze,Qe,He){if(!ve.chrome){var Ze=Ee==="opera"?Qe:/^(node|trident)$/.test(Ee)?He:ze;ve.version=Ze,ve.versionNumber=parseFloat(Ze),Ee={trident:"msie",jsdom:"node"}[Ee]||Ee,ve.name=Ee,ve[Ee]=!0}}),ve.chrome&&delete ve.webkit,ve.atom&&delete ve.chrome}},version:"0.12.17",getView:function(){var v=this.project;return v&&v._view},getPaper:function(){return this},execute:function(v,k){var V=pn.PaperScript.execute(v,this,k);return zi.updateFocus(),V},install:function(v){var k=this;x.each(["project","view","tool"],function(Y){x.define(v,Y,{configurable:!0,get:function(){return k[Y]}})});for(var V in this)!/^_/.test(V)&&this[V]&&(v[V]=this[V])},setup:function(v){return pn=this,this.project=new Rt(v),this},createCanvas:function(v,k){return sn.getCanvas(v,k)},activate:function(){pn=this},clear:function(){for(var v=this.projects,k=this.tools,V=v.length-1;V>=0;V--)v[V].remove();for(var V=k.length-1;V>=0;V--)k[V].remove()},remove:function(){this.clear(),delete a._scopes[this._id]},statics:new function(){function v(k){return k+="Attribute",function(V,Y){return V[k](Y)||V[k]("data-paper-"+Y)}}return{_scopes:{},_id:0,get:function(k){return this._scopes[k]||null},getAttribute:v("get"),hasAttribute:v("has")}}}),U=x.extend(S,{initialize:function(v){this._scope=pn,this._index=this._scope[this._list].push(this)-1,(v||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var v=this._scope[this._reference];return v&&v!==this&&v.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",v),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return this._index==null?!1:(x.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),W={findItemBoundsCollisions:function(v,k,V){function Y(ve){for(var Ie=new Array(ve.length),Ee=0;Ee<ve.length;Ee++){var ze=ve[Ee].getBounds();Ie[Ee]=[ze.left,ze.top,ze.right,ze.bottom]}return Ie}var te=Y(v),fe=!k||k===v?te:Y(k);return this.findBoundsCollisions(te,fe,V||0)},findCurveBoundsCollisions:function(v,k,V,Y){function te(Ze){for(var Ue=Math.min,dt=Math.max,rt=new Array(Ze.length),Me=0;Me<Ze.length;Me++){var se=Ze[Me];rt[Me]=[Ue(se[0],se[2],se[4],se[6]),Ue(se[1],se[3],se[5],se[7]),dt(se[0],se[2],se[4],se[6]),dt(se[1],se[3],se[5],se[7])]}return rt}var fe=te(v),ve=!k||k===v?fe:te(k);if(Y){for(var Ie=this.findBoundsCollisions(fe,ve,V||0,!1,!0),Ee=this.findBoundsCollisions(fe,ve,V||0,!0,!0),ze=[],Qe=0,He=Ie.length;Qe<He;Qe++)ze[Qe]={hor:Ie[Qe],ver:Ee[Qe]};return ze}return this.findBoundsCollisions(fe,ve,V||0)},findBoundsCollisions:function(v,k,V,Y,te){var fe=!k||v===k,ve=fe?v:v.concat(k),Ie=v.length,Ee=ve.length;function ze(oi,fi,Ai){for(var ti=0,li=oi.length;ti<li;){var Bi=li+ti>>>1;ve[oi[Bi]][fi]<Ai?ti=Bi+1:li=Bi}return ti-1}for(var Qe=Y?1:0,He=Qe+2,Ze=Y?0:1,Ue=Ze+2,dt=new Array(Ee),rt=0;rt<Ee;rt++)dt[rt]=rt;dt.sort(function(oi,fi){return ve[oi][Qe]-ve[fi][Qe]});for(var Me=[],se=new Array(Ie),rt=0;rt<Ee;rt++){var ne=dt[rt],$=ve[ne],ie=fe?ne:ne-Ie,de=ne<Ie,ye=fe||!de,ge=de?[]:null;if(Me.length){var Pe=ze(Me,He,$[Qe]-V)+1;if(Me.splice(0,Pe),fe&&te){ge=ge.concat(Me);for(var Fe=0;Fe<Me.length;Fe++){var Ve=Me[Fe];se[Ve].push(ie)}}else for(var Xe=$[Ue],Ke=$[Ze],Fe=0;Fe<Me.length;Fe++){var Ve=Me[Fe],De=ve[Ve],Ge=Ve<Ie,At=fe||Ve>=Ie;(te||(de&&At||ye&&Ge)&&Xe>=De[Ze]-V&&Ke<=De[Ue]+V)&&(de&&At&&ge.push(fe?Ve:Ve-Ie),ye&&Ge&&se[Ve].push(ie))}}if(de&&(v===k&&ge.push(ne),se[ne]=ge),Me.length){var kt=$[He],o=ze(Me,He,kt);Me.splice(o+1,0,ne)}else Me.push(ne)}for(var rt=0;rt<se.length;rt++){var ke=se[rt];ke&&ke.sort(function(fi,Ai){return fi-Ai})}return se}},he=x.extend({initialize:function(v){this.precision=x.pick(v,5),this.multiplier=Math.pow(10,this.precision)},number:function(v){return this.precision<16?Math.round(v*this.multiplier)/this.multiplier:v},pair:function(v,k,V){return this.number(v)+(V||",")+this.number(k)},point:function(v,k){return this.number(v.x)+(k||",")+this.number(v.y)},size:function(v,k){return this.number(v.width)+(k||",")+this.number(v.height)},rectangle:function(v,k){return this.point(v,k)+(k||",")+this.size(v,k)}});he.instance=new he;var ae=new function(){var v=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],k=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],V=Math.abs,Y=Math.sqrt,te=Math.pow,fe=Math.log2||function(He){return Math.log(He)*Math.LOG2E},ve=1e-12,Ie=112e-18;function Ee(He,Ze,Ue){return He<Ze?Ze:He>Ue?Ue:He}function ze(He,Ze,Ue){function dt(Pe){var Fe=Pe*134217729,Ve=Pe-Fe,Xe=Ve+Fe,Ke=Pe-Xe;return[Xe,Ke]}var rt=Ze*Ze-He*Ue,Me=Ze*Ze+He*Ue;if(V(rt)*3<Me){var se=dt(He),ne=dt(Ze),$=dt(Ue),ie=Ze*Ze,de=ne[0]*ne[0]-ie+2*ne[0]*ne[1]+ne[1]*ne[1],ye=He*Ue,ge=se[0]*$[0]-ye+se[0]*$[1]+se[1]*$[0]+se[1]*$[1];rt=ie-ye+(de-ge)}return rt}function Qe(){var He=Math.max.apply(Math,arguments);return He&&(He<1e-8||He>1e8)?te(2,-Math.round(fe(He))):0}return{EPSILON:ve,MACHINE_EPSILON:Ie,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,ANGULAR_EPSILON:1e-5,KAPPA:4*(Y(2)-1)/3,isZero:function(He){return He>=-ve&&He<=ve},isMachineZero:function(He){return He>=-Ie&&He<=Ie},clamp:Ee,integrate:function(He,Ze,Ue,dt){for(var rt=v[dt-2],Me=k[dt-2],se=(Ue-Ze)*.5,ne=se+Ze,$=0,ie=dt+1>>1,de=dt&1?Me[$++]*He(ne):0;$<ie;){var ye=se*rt[$];de+=Me[$++]*(He(ne+ye)+He(ne-ye))}return se*de},findRoot:function(He,Ze,Ue,dt,rt,Me,se){for(var ne=0;ne<Me;ne++){var $=He(Ue),ie=$/Ze(Ue),de=Ue-ie;if(V(ie)<se){Ue=de;break}$>0?(rt=Ue,Ue=de<=dt?(dt+rt)*.5:de):(dt=Ue,Ue=de>=rt?(dt+rt)*.5:de)}return Ee(Ue,dt,rt)},solveQuadratic:function(He,Ze,Ue,dt,rt,Me){var se,ne=1/0;if(V(He)<ve){if(V(Ze)<ve)return V(Ue)<ve?-1:0;se=-Ue/Ze}else{Ze*=-.5;var $=ze(He,Ze,Ue);if($&&V($)<Ie){var ie=Qe(V(He),V(Ze),V(Ue));ie&&(He*=ie,Ze*=ie,Ue*=ie,$=ze(He,Ze,Ue))}if($>=-Ie){var de=$<0?0:Y($),ye=Ze+(Ze<0?-de:de);ye===0?(se=Ue/He,ne=-se):(se=ye/He,ne=Ue/ye)}}var ge=0,Pe=rt==null,Fe=rt-ve,Ve=Me+ve;return isFinite(se)&&(Pe||se>Fe&&se<Ve)&&(dt[ge++]=Pe?se:Ee(se,rt,Me)),ne!==se&&isFinite(ne)&&(Pe||ne>Fe&&ne<Ve)&&(dt[ge++]=Pe?ne:Ee(ne,rt,Me)),ge},solveCubic:function(He,Ze,Ue,dt,rt,Me,se){var ne=Qe(V(He),V(Ze),V(Ue),V(dt)),$,ie,de,ye,ge;ne&&(He*=ne,Ze*=ne,Ue*=ne,dt*=ne);function Pe(o){$=o;var ke=He*$;ie=ke+Ze,de=ie*$+Ue,ye=(ke+ie)*$+de,ge=de*$+dt}if(V(He)<ve)He=Ze,ie=Ue,de=dt,$=1/0;else if(V(dt)<ve)ie=Ze,de=Ue,$=0;else{Pe(-(Ze/He)/3);var Fe=ge/He,Ve=te(V(Fe),1/3),Xe=Fe<0?-1:1,Ke=-ye/He,De=Ke>0?1.324717957244746*Math.max(Ve,Y(Ke)):Ve,Ge=$-Xe*De;if(Ge!==$){do Pe(Ge),Ge=ye===0?$:$-ge/ye/(1+Ie);while(Xe*Ge>Xe*$);V(He)*$*$>V(dt/$)&&(de=-dt/$,ie=(de-Ue)/$)}}var At=ae.solveQuadratic(He,ie,de,rt,Me,se),kt=Me==null;return isFinite($)&&(At===0||At>0&&$!==rt[0]&&$!==rt[1])&&(kt||$>Me-ve&&$<se+ve)&&(rt[At++]=kt?$:Ee($,Me,se)),At}}},ce={_id:1,_pools:{},get:function(v){if(v){var k=this._pools[v];return k||(k=this._pools[v]={_id:1}),k._id++}else return this._id++}},be=x.extend({_class:"Point",_readIndex:!0,initialize:function(k,V){var Y=typeof k,te=this.__read,fe=0;if(Y==="number"){var ve=typeof V=="number";this._set(k,ve?V:k),te&&(fe=ve?2:1)}else if(Y==="undefined"||k===null)this._set(0,0),te&&(fe=k===null?1:0);else{var Ie=Y==="string"?k.split(/[\s,]+/)||[]:k;fe=1,Array.isArray(Ie)?this._set(+Ie[0],+(Ie.length>1?Ie[1]:Ie[0])):"x"in Ie?this._set(Ie.x||0,Ie.y||0):"width"in Ie?this._set(Ie.width||0,Ie.height||0):"angle"in Ie?(this._set(Ie.length||0,0),this.setAngle(Ie.angle||0)):(this._set(0,0),fe=0)}return te&&(this.__read=fe),this},set:"#initialize",_set:function(v,k){return this.x=v,this.y=k,this},equals:function(v){return this===v||v&&(this.x===v.x&&this.y===v.y||Array.isArray(v)&&this.x===v[0]&&this.y===v[1])||!1},clone:function(){return new be(this.x,this.y)},toString:function(){var v=he.instance;return"{ x: "+v.number(this.x)+", y: "+v.number(this.y)+" }"},_serialize:function(v){var k=v.formatter;return[k.number(this.x),k.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(v){if(this.isZero()){var k=this._angle||0;this._set(Math.cos(k)*v,Math.sin(k)*v)}else{var V=v/this.getLength();ae.isZero(V)&&this.getAngle(),this._set(this.x*V,this.y*V)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function(v){this.setAngleInRadians.call(this,v*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var v=be.read(arguments),k=this.getLength()*v.getLength();if(ae.isZero(k))return NaN;var V=this.dot(v)/k;return Math.acos(V<-1?-1:V>1?1:V)}else return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(v){if(this._angle=v,!this.isZero()){var k=this.getLength();this._set(Math.cos(v)*k,Math.sin(v)*k)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var v=be.read(arguments);return Math.atan2(this.cross(v),this.dot(v))*180/Math.PI},getDistance:function(){var v=arguments,k=be.read(v),V=k.x-this.x,Y=k.y-this.y,te=V*V+Y*Y,fe=x.read(v);return fe?te:Math.sqrt(te)},normalize:function(v){v===n&&(v=1);var k=this.getLength(),V=k!==0?v/k:0,Y=new be(this.x*V,this.y*V);return V>=0&&(Y._angle=this._angle),Y},rotate:function(v,k){if(v===0)return this.clone();v=v*Math.PI/180;var V=k?this.subtract(k):this,Y=Math.sin(v),te=Math.cos(v);return V=new be(V.x*te-V.y*Y,V.x*Y+V.y*te),k?V.add(k):V},transform:function(v){return v?v._transformPoint(this):this},add:function(){var v=be.read(arguments);return new be(this.x+v.x,this.y+v.y)},subtract:function(){var v=be.read(arguments);return new be(this.x-v.x,this.y-v.y)},multiply:function(){var v=be.read(arguments);return new be(this.x*v.x,this.y*v.y)},divide:function(){var v=be.read(arguments);return new be(this.x/v.x,this.y/v.y)},modulo:function(){var v=be.read(arguments);return new be(this.x%v.x,this.y%v.y)},negate:function(){return new be(-this.x,-this.y)},isInside:function(){return it.read(arguments).contains(this)},isClose:function(){var v=arguments,k=be.read(v),V=x.read(v);return this.getDistance(k)<=V},isCollinear:function(){var v=be.read(arguments);return be.isCollinear(this.x,this.y,v.x,v.y)},isColinear:"#isCollinear",isOrthogonal:function(){var v=be.read(arguments);return be.isOrthogonal(this.x,this.y,v.x,v.y)},isZero:function(){var v=ae.isZero;return v(this.x)&&v(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(v){return this.x*(v>1&&v<4?-1:1)>=0&&this.y*(v>2?-1:1)>=0},dot:function(){var v=be.read(arguments);return this.x*v.x+this.y*v.y},cross:function(){var v=be.read(arguments);return this.x*v.y-this.y*v.x},project:function(){var v=be.read(arguments),k=v.isZero()?0:this.dot(v)/v.dot(v);return new be(v.x*k,v.y*k)},statics:{min:function(){var v=arguments,k=be.read(v),V=be.read(v);return new be(Math.min(k.x,V.x),Math.min(k.y,V.y))},max:function(){var v=arguments,k=be.read(v),V=be.read(v);return new be(Math.max(k.x,V.x),Math.max(k.y,V.y))},random:function(){return new be(Math.random(),Math.random())},isCollinear:function(v,k,V,Y){return Math.abs(v*Y-k*V)<=Math.sqrt((v*v+k*k)*(V*V+Y*Y))*1e-8},isOrthogonal:function(v,k,V,Y){return Math.abs(v*V+k*Y)<=Math.sqrt((v*v+k*k)*(V*V+Y*Y))*1e-8}}},x.each(["round","ceil","floor","abs"],function(v){var k=Math[v];this[v]=function(){return new be(k(this.x),k(this.y))}},{})),Je=be.extend({initialize:function(k,V,Y,te){this._x=k,this._y=V,this._owner=Y,this._setter=te},_set:function(v,k,V){return this._x=v,this._y=k,V||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(v){this._x=v,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(v){this._y=v,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(v){this._owner._changeSelection(this._getSelection(),v)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),st=x.extend({_class:"Size",_readIndex:!0,initialize:function(k,V){var Y=typeof k,te=this.__read,fe=0;if(Y==="number"){var ve=typeof V=="number";this._set(k,ve?V:k),te&&(fe=ve?2:1)}else if(Y==="undefined"||k===null)this._set(0,0),te&&(fe=k===null?1:0);else{var Ie=Y==="string"?k.split(/[\s,]+/)||[]:k;fe=1,Array.isArray(Ie)?this._set(+Ie[0],+(Ie.length>1?Ie[1]:Ie[0])):"width"in Ie?this._set(Ie.width||0,Ie.height||0):"x"in Ie?this._set(Ie.x||0,Ie.y||0):(this._set(0,0),fe=0)}return te&&(this.__read=fe),this},set:"#initialize",_set:function(v,k){return this.width=v,this.height=k,this},equals:function(v){return v===this||v&&(this.width===v.width&&this.height===v.height||Array.isArray(v)&&this.width===v[0]&&this.height===v[1])||!1},clone:function(){return new st(this.width,this.height)},toString:function(){var v=he.instance;return"{ width: "+v.number(this.width)+", height: "+v.number(this.height)+" }"},_serialize:function(v){var k=v.formatter;return[k.number(this.width),k.number(this.height)]},add:function(){var v=st.read(arguments);return new st(this.width+v.width,this.height+v.height)},subtract:function(){var v=st.read(arguments);return new st(this.width-v.width,this.height-v.height)},multiply:function(){var v=st.read(arguments);return new st(this.width*v.width,this.height*v.height)},divide:function(){var v=st.read(arguments);return new st(this.width/v.width,this.height/v.height)},modulo:function(){var v=st.read(arguments);return new st(this.width%v.width,this.height%v.height)},negate:function(){return new st(-this.width,-this.height)},isZero:function(){var v=ae.isZero;return v(this.width)&&v(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(v,k){return new st(Math.min(v.width,k.width),Math.min(v.height,k.height))},max:function(v,k){return new st(Math.max(v.width,k.width),Math.max(v.height,k.height))},random:function(){return new st(Math.random(),Math.random())}}},x.each(["round","ceil","floor","abs"],function(v){var k=Math[v];this[v]=function(){return new st(k(this.width),k(this.height))}},{})),Ye=st.extend({initialize:function(k,V,Y,te){this._width=k,this._height=V,this._owner=Y,this._setter=te},_set:function(v,k,V){return this._width=v,this._height=k,V||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(v){this._width=v,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(v){this._height=v,this._owner[this._setter](this)}}),it=x.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(k,V,Y,te){var fe=arguments,ve=typeof k,Ie;if(ve==="number"?(this._set(k,V,Y,te),Ie=4):ve==="undefined"||k===null?(this._set(0,0,0,0),Ie=k===null?1:0):fe.length===1&&(Array.isArray(k)?(this._set.apply(this,k),Ie=1):k.x!==n||k.width!==n?(this._set(k.x||0,k.y||0,k.width||0,k.height||0),Ie=1):k.from===n&&k.to===n&&(this._set(0,0,0,0),x.readSupported(fe,this)&&(Ie=1))),Ie===n){var Ee=be.readNamed(fe,"from"),ze=x.peek(fe),Qe=Ee.x,He=Ee.y,Ze,Ue;if(ze&&ze.x!==n||x.hasNamed(fe,"to")){var dt=be.readNamed(fe,"to");Ze=dt.x-Qe,Ue=dt.y-He,Ze<0&&(Qe=dt.x,Ze=-Ze),Ue<0&&(He=dt.y,Ue=-Ue)}else{var rt=st.read(fe);Ze=rt.width,Ue=rt.height}this._set(Qe,He,Ze,Ue),Ie=fe.__index}var Me=fe.__filtered;return Me&&(this.__filtered=Me),this.__read&&(this.__read=Ie),this},set:"#initialize",_set:function(v,k,V,Y){return this.x=v,this.y=k,this.width=V,this.height=Y,this},clone:function(){return new it(this.x,this.y,this.width,this.height)},equals:function(v){var k=x.isPlainValue(v)?it.read(arguments):v;return k===this||k&&this.x===k.x&&this.y===k.y&&this.width===k.width&&this.height===k.height||!1},toString:function(){var v=he.instance;return"{ x: "+v.number(this.x)+", y: "+v.number(this.y)+", width: "+v.number(this.width)+", height: "+v.number(this.height)+" }"},_serialize:function(v){var k=v.formatter;return[k.number(this.x),k.number(this.y),k.number(this.width),k.number(this.height)]},getPoint:function(v){var k=v?be:Je;return new k(this.x,this.y,this,"setPoint")},setPoint:function(){var v=be.read(arguments);this.x=v.x,this.y=v.y},getSize:function(v){var k=v?st:Ye;return new k(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var v=st.read(arguments),k=this._sx,V=this._sy,Y=v.width,te=v.height;k&&(this.x+=(this.width-Y)*k),V&&(this.y+=(this.height-te)*V),this.width=Y,this.height=te,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(v){if(!this._fw){var k=v-this.x;this.width-=this._sx===.5?k*2:k}this.x=v,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(v){if(!this._fh){var k=v-this.y;this.height-=this._sy===.5?k*2:k}this.y=v,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(v){if(!this._fw){var k=v-this.x;this.width=this._sx===.5?k*2:k}this.x=v-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(v){if(!this._fh){var k=v-this.y;this.height=this._sy===.5?k*2:k}this.y=v-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(v){this._fw||this._sx===.5?this.x=v-this.width/2:(this._sx&&(this.x+=(v-this.x)*2*this._sx),this.width=(v-this.x)*2),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(v){this._fh||this._sy===.5?this.y=v-this.height/2:(this._sy&&(this.y+=(v-this.y)*2*this._sy),this.height=(v-this.y)*2),this._sy=.5,this._fh=0},getCenter:function(v){var k=v?be:Je;return new k(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var v=be.read(arguments);return this.setCenterX(v.x),this.setCenterY(v.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function(v){return v&&v.width!==n||(Array.isArray(v)?v:arguments).length===4?this._containsRectangle(it.read(arguments)):this._containsPoint(be.read(arguments))},_containsPoint:function(v){var k=v.x,V=v.y;return k>=this.x&&V>=this.y&&k<=this.x+this.width&&V<=this.y+this.height},_containsRectangle:function(v){var k=v.x,V=v.y;return k>=this.x&&V>=this.y&&k+v.width<=this.x+this.width&&V+v.height<=this.y+this.height},intersects:function(){var v=it.read(arguments),k=x.read(arguments)||0;return v.x+v.width>this.x-k&&v.y+v.height>this.y-k&&v.x<this.x+this.width+k&&v.y<this.y+this.height+k},intersect:function(){var v=it.read(arguments),k=Math.max(this.x,v.x),V=Math.max(this.y,v.y),Y=Math.min(this.x+this.width,v.x+v.width),te=Math.min(this.y+this.height,v.y+v.height);return new it(k,V,Y-k,te-V)},unite:function(){var v=it.read(arguments),k=Math.min(this.x,v.x),V=Math.min(this.y,v.y),Y=Math.max(this.x+this.width,v.x+v.width),te=Math.max(this.y+this.height,v.y+v.height);return new it(k,V,Y-k,te-V)},include:function(){var v=be.read(arguments),k=Math.min(this.x,v.x),V=Math.min(this.y,v.y),Y=Math.max(this.x+this.width,v.x),te=Math.max(this.y+this.height,v.y);return new it(k,V,Y-k,te-V)},expand:function(){var v=st.read(arguments),k=v.width,V=v.height;return new it(this.x-k/2,this.y-V/2,this.width+k,this.height+V)},scale:function(v,k){return this.expand(this.width*v-this.width,this.height*(k===n?v:k)-this.height)}},x.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(v,k){var V=v.join(""),Y=/^[RL]/.test(V);k>=4&&(v[1]+=Y?"Y":"X");var te=v[Y?0:1],fe=v[Y?1:0],ve="get"+te,Ie="get"+fe,Ee="set"+te,ze="set"+fe,Qe="get"+V,He="set"+V;this[Qe]=function(Ze){var Ue=Ze?be:Je;return new Ue(this[ve](),this[Ie](),this,He)},this[He]=function(){var Ze=be.read(arguments);this[Ee](Ze.x),this[ze](Ze.y)}},{beans:!0})),ct=it.extend({initialize:function(k,V,Y,te,fe,ve){this._set(k,V,Y,te,!0),this._owner=fe,this._setter=ve},_set:function(v,k,V,Y,te){return this._x=v,this._y=k,this._width=V,this._height=Y,te||this._owner[this._setter](this),this}},new function(){var v=it.prototype;return x.each(["x","y","width","height"],function(k){var V=x.capitalize(k),Y="_"+k;this["get"+V]=function(){return this[Y]},this["set"+V]=function(te){this[Y]=te,this._dontNotify||this._owner[this._setter](this)}},x.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(k){var V="set"+k;this[V]=function(){this._dontNotify=!0,v[V].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(k){var V=this._owner;V._changeSelection&&V._changeSelection(2,k)}}))}),Tt=x.extend({_class:"Matrix",initialize:function v(k,V){var Y=arguments,te=Y.length,fe=!0;if(te>=6?this._set.apply(this,Y):te===1||te===2?k instanceof v?this._set(k._a,k._b,k._c,k._d,k._tx,k._ty,V):Array.isArray(k)?this._set.apply(this,V?k.concat([V]):k):fe=!1:te?fe=!1:this.reset(),!fe)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(v,k,V,Y,te,fe,ve){return this._a=v,this._b=k,this._c=V,this._d=Y,this._tx=te,this._ty=fe,ve||this._changed(),this},_serialize:function(v,k){return x.serialize(this.getValues(),v,!0,k)},_changed:function(){var v=this._owner;v&&(v._applyMatrix?v.transform(null,!0):v._changed(25))},clone:function(){return new Tt(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(v){return v===this||v&&this._a===v._a&&this._b===v._b&&this._c===v._c&&this._d===v._d&&this._tx===v._tx&&this._ty===v._ty},toString:function(){var v=he.instance;return"[["+[v.number(this._a),v.number(this._c),v.number(this._tx)].join(", ")+"], ["+[v.number(this._b),v.number(this._d),v.number(this._ty)].join(", ")+"]]"},reset:function(v){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,v||this._changed(),this},apply:function(v,k){var V=this._owner;return V?(V.transform(null,x.pick(v,!0),k),this.isIdentity()):!1},translate:function(){var v=be.read(arguments),k=v.x,V=v.y;return this._tx+=k*this._a+V*this._c,this._ty+=k*this._b+V*this._d,this._changed(),this},scale:function(){var v=arguments,k=be.read(v),V=be.read(v,0,{readNull:!0});return V&&this.translate(V),this._a*=k.x,this._b*=k.x,this._c*=k.y,this._d*=k.y,V&&this.translate(V.negate()),this._changed(),this},rotate:function(v){v*=Math.PI/180;var k=be.read(arguments,1),V=k.x,Y=k.y,te=Math.cos(v),fe=Math.sin(v),ve=V-V*te+Y*fe,Ie=Y-V*fe-Y*te,Ee=this._a,ze=this._b,Qe=this._c,He=this._d;return this._a=te*Ee+fe*Qe,this._b=te*ze+fe*He,this._c=-fe*Ee+te*Qe,this._d=-fe*ze+te*He,this._tx+=ve*Ee+Ie*Qe,this._ty+=ve*ze+Ie*He,this._changed(),this},shear:function(){var v=arguments,k=be.read(v),V=be.read(v,0,{readNull:!0});V&&this.translate(V);var Y=this._a,te=this._b;return this._a+=k.y*this._c,this._b+=k.y*this._d,this._c+=k.x*Y,this._d+=k.x*te,V&&this.translate(V.negate()),this._changed(),this},skew:function(){var v=arguments,k=be.read(v),V=be.read(v,0,{readNull:!0}),Y=Math.PI/180,te=new be(Math.tan(k.x*Y),Math.tan(k.y*Y));return this.shear(te,V)},append:function(v,k){if(v){var V=this._a,Y=this._b,te=this._c,fe=this._d,ve=v._a,Ie=v._c,Ee=v._b,ze=v._d,Qe=v._tx,He=v._ty;this._a=ve*V+Ee*te,this._c=Ie*V+ze*te,this._b=ve*Y+Ee*fe,this._d=Ie*Y+ze*fe,this._tx+=Qe*V+He*te,this._ty+=Qe*Y+He*fe,k||this._changed()}return this},prepend:function(v,k){if(v){var V=this._a,Y=this._b,te=this._c,fe=this._d,ve=this._tx,Ie=this._ty,Ee=v._a,ze=v._c,Qe=v._b,He=v._d,Ze=v._tx,Ue=v._ty;this._a=Ee*V+ze*Y,this._c=Ee*te+ze*fe,this._b=Qe*V+He*Y,this._d=Qe*te+He*fe,this._tx=Ee*ve+ze*Ie+Ze,this._ty=Qe*ve+He*Ie+Ue,k||this._changed()}return this},appended:function(v){return this.clone().append(v)},prepended:function(v){return this.clone().prepend(v)},invert:function(){var v=this._a,k=this._b,V=this._c,Y=this._d,te=this._tx,fe=this._ty,ve=v*Y-k*V,Ie=null;return ve&&!isNaN(ve)&&isFinite(te)&&isFinite(fe)&&(this._a=Y/ve,this._b=-k/ve,this._c=-V/ve,this._d=v/ve,this._tx=(V*fe-Y*te)/ve,this._ty=(k*te-v*fe)/ve,Ie=this),Ie},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new Tt(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var v=this._a*this._d-this._c*this._b;return v&&!isNaN(v)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(v,k,V){return arguments.length<3?this._transformPoint(be.read(arguments)):this._transformCoordinates(v,k,V)},_transformPoint:function(v,k,V){var Y=v.x,te=v.y;return k||(k=new be),k._set(Y*this._a+te*this._c+this._tx,Y*this._b+te*this._d+this._ty,V)},_transformCoordinates:function(v,k,V){for(var Y=0,te=2*V;Y<te;Y+=2){var fe=v[Y],ve=v[Y+1];k[Y]=fe*this._a+ve*this._c+this._tx,k[Y+1]=fe*this._b+ve*this._d+this._ty}return k},_transformCorners:function(v){var k=v.x,V=v.y,Y=k+v.width,te=V+v.height,fe=[k,V,Y,V,Y,te,k,te];return this._transformCoordinates(fe,fe,4)},_transformBounds:function(v,k,V){for(var Y=this._transformCorners(v),te=Y.slice(0,2),fe=te.slice(),ve=2;ve<8;ve++){var Ie=Y[ve],Ee=ve&1;Ie<te[Ee]?te[Ee]=Ie:Ie>fe[Ee]&&(fe[Ee]=Ie)}return k||(k=new it),k._set(te[0],te[1],fe[0]-te[0],fe[1]-te[1],V)},inverseTransform:function(){return this._inverseTransform(be.read(arguments))},_inverseTransform:function(v,k,V){var Y=this._a,te=this._b,fe=this._c,ve=this._d,Ie=this._tx,Ee=this._ty,ze=Y*ve-te*fe,Qe=null;if(ze&&!isNaN(ze)&&isFinite(Ie)&&isFinite(Ee)){var He=v.x-this._tx,Ze=v.y-this._ty;k||(k=new be),Qe=k._set((He*ve-Ze*fe)/ze,(Ze*Y-He*te)/ze,V)}return Qe},decompose:function(){var v=this._a,k=this._b,V=this._c,Y=this._d,te=v*Y-k*V,fe=Math.sqrt,ve=Math.atan2,Ie=180/Math.PI,Ee,ze,Qe;if(v!==0||k!==0){var He=fe(v*v+k*k);Ee=Math.acos(v/He)*(k>0?1:-1),ze=[He,te/He],Qe=[ve(v*V+k*Y,He*He),0]}else if(V!==0||Y!==0){var Ze=fe(V*V+Y*Y);Ee=Math.asin(V/Ze)*(Y>0?1:-1),ze=[te/Ze,Ze],Qe=[0,ve(v*V+k*Y,Ze*Ze)]}else Ee=0,Qe=ze=[0,0];return{translation:this.getTranslation(),rotation:Ee*Ie,scaling:new be(ze),skewing:new be(Qe[0]*Ie,Qe[1]*Ie)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new be(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(v){this.isIdentity()||v.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},x.each(["a","b","c","d","tx","ty"],function(v){var k=x.capitalize(v),V="_"+v;this["get"+k]=function(){return this[V]},this["set"+k]=function(Y){this[V]=Y,this._changed()}},{})),zt=x.extend({_class:"Line",initialize:function(k,V,Y,te,fe){var ve=!1;arguments.length>=4?(this._px=k,this._py=V,this._vx=Y,this._vy=te,ve=fe):(this._px=k.x,this._py=k.y,this._vx=V.x,this._vy=V.y,ve=Y),ve||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new be(this._px,this._py)},getVector:function(){return new be(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(v,k){return zt.intersect(this._px,this._py,this._vx,this._vy,v._px,v._py,v._vx,v._vy,!0,k)},getSide:function(v,k){return zt.getSide(this._px,this._py,this._vx,this._vy,v.x,v.y,!0,k)},getDistance:function(v){return Math.abs(this.getSignedDistance(v))},getSignedDistance:function(v){return zt.getSignedDistance(this._px,this._py,this._vx,this._vy,v.x,v.y,!0)},isCollinear:function(v){return be.isCollinear(this._vx,this._vy,v._vx,v._vy)},isOrthogonal:function(v){return be.isOrthogonal(this._vx,this._vy,v._vx,v._vy)},statics:{intersect:function(v,k,V,Y,te,fe,ve,Ie,Ee,ze){Ee||(V-=v,Y-=k,ve-=te,Ie-=fe);var Qe=V*Ie-Y*ve;if(!ae.isMachineZero(Qe)){var He=v-te,Ze=k-fe,Ue=(ve*Ze-Ie*He)/Qe,dt=(V*Ze-Y*He)/Qe,rt=1e-12,Me=-rt,se=1+rt;if(ze||Me<Ue&&Ue<se&&Me<dt&&dt<se)return ze||(Ue=Ue<=0?0:Ue>=1?1:Ue),new be(v+Ue*V,k+Ue*Y)}},getSide:function(v,k,V,Y,te,fe,ve,Ie){ve||(V-=v,Y-=k);var Ee=te-v,ze=fe-k,Qe=Ee*Y-ze*V;return!Ie&&ae.isMachineZero(Qe)&&(Qe=(Ee*V+Ee*V)/(V*V+Y*Y),Qe>=0&&Qe<=1&&(Qe=0)),Qe<0?-1:Qe>0?1:0},getSignedDistance:function(v,k,V,Y,te,fe,ve){return ve||(V-=v,Y-=k),V===0?Y>0?te-v:v-te:Y===0?V<0?fe-k:k-fe:((te-v)*Y-(fe-k)*V)/(Y>V?Y*Math.sqrt(1+V*V/(Y*Y)):V*Math.sqrt(1+Y*Y/(V*V)))},getDistance:function(v,k,V,Y,te,fe,ve){return Math.abs(zt.getSignedDistance(v,k,V,Y,te,fe,ve))}}}),Rt=U.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(k){U.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new vn(null,null,this),this._view=zi.create(this,k||sn.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(v,k){return x.serialize(this._children,v,!0,k)},_changed:function(v,k){if(v&1){var V=this._view;V&&(V._needsUpdate=!0,!V._requested&&V._autoUpdate&&V.requestUpdate())}var Y=this._changes;if(Y&&k){var te=this._changesById,fe=k._id,ve=te[fe];ve?ve.flags|=v:Y.push(te[fe]={item:k,flags:v})}},clear:function(){for(var v=this._children,k=v.length-1;k>=0;k--)v[k].remove()},isEmpty:function(){return!this._children.length},remove:function v(){return v.base.call(this)?(this._view&&this._view.remove(),!0):!1},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(v){this._currentStyle.set(v)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new at({project:this,insert:!0})},getSymbolDefinitions:function(){var v=[],k={};return this.getItems({class:xt,match:function(V){var Y=V._definition,te=Y._id;return k[te]||(k[te]=!0,v.push(Y)),!1}}),v},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var v=this._selectionItems,k=[];for(var V in v){var Y=v[V],te=Y._selection;te&1&&Y.isInserted()?k.push(Y):te||this._updateSelection(Y)}return k},_updateSelection:function(v){var k=v._id,V=this._selectionItems;v._selection?V[k]!==v&&(this._selectionCount++,V[k]=v):V[k]===v&&(this._selectionCount--,delete V[k])},selectAll:function(){for(var v=this._children,k=0,V=v.length;k<V;k++)v[k].setFullySelected(!0)},deselectAll:function(){var v=this._selectionItems;for(var k in v)v[k].setFullySelected(!1)},addLayer:function(v){return this.insertLayer(n,v)},insertLayer:function(v,k){if(k instanceof at){k._remove(!1,!0),x.splice(this._children,[k],v,0),k._setProject(this,!0);var V=k._name;V&&k.setName(V),this._changes&&k._changed(5),this._activeLayer||(this._activeLayer=k)}else k=null;return k},_insertItem:function(v,k,V){return k=this.insertLayer(v,k)||(this._activeLayer||this._insertItem(n,new at(Oe.NO_INSERT),!0)).insertChild(v,k),V&&k.activate&&k.activate(),k},getItems:function(v){return Oe._getItems(this,v)},getItem:function(v){return Oe._getItems(this,v,null,null,!0)[0]||null},importJSON:function(v){this.activate();var k=this._activeLayer;return x.importJSON(v,k&&k.isEmpty()&&k)},removeOn:function(v){var k=this._removeSets;if(k){v==="mouseup"&&(k.mousedrag=null);var V=k[v];if(V){for(var Y in V){var te=V[Y];for(var fe in k){var ve=k[fe];ve&&ve!=V&&delete ve[te._id]}te.remove()}k[v]=null}}},draw:function(v,k,V){this._updateVersion++,v.save(),k.applyToContext(v);for(var Y=this._children,te=new x({offset:new be(0,0),pixelRatio:V,viewMatrix:k.isIdentity()?null:k,matrices:[new Tt],updateMatrix:!0}),fe=0,ve=Y.length;fe<ve;fe++)Y[fe].draw(v,te);if(v.restore(),this._selectionCount>0){v.save(),v.strokeWidth=1;var Ie=this._selectionItems,Ee=this._scope.settings.handleSize,ze=this._updateVersion;for(var Qe in Ie)Ie[Qe]._drawSelection(v,k,Ee,Ie,ze);v.restore()}}}),Oe=x.extend(S,{statics:{extend:function v(k){return k._serializeFields&&(k._serializeFields=x.set({},this.prototype._serializeFields,k._serializeFields)),v.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new Tt,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var v=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return x.each(v,function(k){this._events[k]={install:function(V){this.getView()._countItemEvent(V,1)},uninstall:function(V){this.getView()._countItemEvent(V,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:v}})},{initialize:function(){},_initialize:function(v,k){var V=v&&x.isPlainObject(v),Y=V&&v.internal===!0,te=this._matrix=new Tt,fe=V&&v.project||pn.project,ve=pn.settings;return this._id=Y?null:ce.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&ve.applyMatrix,k&&te.translate(k),te._owner=this,this._style=new vn(fe._currentStyle,this,fe),Y||V&&v.insert==!1||!ve.insertItems&&!(V&&v.insert==!0)?this._setProject(fe):(V&&v.parent||fe)._insertItem(n,this,!0),V&&v!==Oe.NO_INSERT&&v!==Oe.INSERT&&this.set(v,{internal:!0,insert:!0,project:!0,parent:!0}),V},_serialize:function(v,k){var V={},Y=this;function te(fe){for(var ve in fe){var Ie=Y[ve];x.equals(Ie,ve==="leading"?fe.fontSize*1.2:fe[ve])||(V[ve]=x.serialize(Ie,v,ve!=="data",k))}}return te(this._serializeFields),this instanceof jt||te(this._style._defaults),[this._class,V]},_changed:function(v){var k=this._symbol,V=this._parent||k,Y=this._project;v&8&&(this._bounds=this._position=this._decomposed=n),v&16&&(this._globalMatrix=n),V&&v&72&&Oe._clearBoundsCache(V),v&2&&Oe._clearBoundsCache(this),Y&&Y._changed(v,this),k&&k._changed(v)},getId:function(){return this._id},getName:function(){return this._name},setName:function(v){if(this._name&&this._removeNamed(),v===+v+"")throw new Error("Names consisting only of numbers are not supported.");var k=this._getOwner();if(v&&k){var V=k._children,Y=k._namedChildren;(Y[v]=Y[v]||[]).push(this),v in V||(V[v]=this)}this._name=v||n,this._changed(256)},getStyle:function(){return this._style},setStyle:function(v){this.getStyle().set(v)}},x.each(["locked","visible","blendMode","opacity","guide"],function(v){var k=x.capitalize(v),V="_"+v,Y={locked:256,visible:265};this["get"+k]=function(){return this[V]},this["set"+k]=function(te){te!=this[V]&&(this[V]=te,this._changed(Y[v]||257))}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(v){if(v!==this._selection){this._selection=v;var k=this._project;k&&(k._updateSelection(this),this._changed(257))}},_changeSelection:function(v,k){var V=this._selection;this.setSelection(k?V|v:V&~v)},isSelected:function(){if(this._selectChildren){for(var v=this._children,k=0,V=v.length;k<V;k++)if(v[k].isSelected())return!0}return!!(this._selection&1)},setSelected:function(v){if(this._selectChildren)for(var k=this._children,V=0,Y=k.length;V<Y;V++)k[V].setSelected(v);this._changeSelection(1,v)},isFullySelected:function(){var v=this._children,k=!!(this._selection&1);if(v&&k){for(var V=0,Y=v.length;V<Y;V++)if(!v[V].isFullySelected())return!1;return!0}return k},setFullySelected:function(v){var k=this._children;if(k)for(var V=0,Y=k.length;V<Y;V++)k[V].setFullySelected(v);this._changeSelection(1,v)},isClipMask:function(){return this._clipMask},setClipMask:function(v){this._clipMask!=(v=!!v)&&(this._clipMask=v,v&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(v){this._data=v},getPosition:function(v){var k=v?be:Je,V=this._position||(this._position=this._getPositionFromBounds());return new k(V.x,V.y,this,"setPosition")},setPosition:function(){this.translate(be.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(v){return this._pivot?this._matrix._transformPoint(this._pivot):(v||this.getBounds()).getCenter(!0)},getPivot:function(){var v=this._pivot;return v?new Je(v.x,v.y,this,"setPivot"):null},setPivot:function(){this._pivot=be.read(arguments,0,{clone:!0,readNull:!0}),this._position=n}},x.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(v,k){this[k]=function(V){return this.getBounds(V,v)}},{beans:!0,getBounds:function(v,k){var V=k||v instanceof Tt,Y=x.set({},V?k:v,this._boundsOptions);(!Y.stroke||this.getStrokeScaling())&&(Y.cacheItem=this);var te=this._getCachedBounds(V&&v,Y).rect;return arguments.length?te:new ct(te.x,te.y,te.width,te.height,this,"setBounds")},setBounds:function(){var v=it.read(arguments),k=this.getBounds(),V=this._matrix,Y=new Tt,te=v.getCenter();Y.translate(te),(v.width!=k.width||v.height!=k.height)&&(V.isInvertible()||(V.set(V._backup||new Tt().translate(V.getTranslation())),k=this.getBounds()),Y.scale(k.width!==0?v.width/k.width:0,k.height!==0?v.height/k.height:0)),te=k.getCenter(),Y.translate(-te.x,-te.y),this.transform(Y)},_getBounds:function(v,k){var V=this._children;return!V||!V.length?new it:(Oe._updateBoundsCache(this,k.cacheItem),Oe._getBounds(V,v,k))},_getBoundsCacheKey:function(v,k){return[v.stroke?1:0,v.handle?1:0,k?1:0].join("")},_getCachedBounds:function(v,k,V){v=v&&v._orNullIfIdentity();var Y=k.internal&&!V,te=k.cacheItem,fe=Y?null:this._matrix._orNullIfIdentity(),ve=te&&(!v||v.equals(fe))&&this._getBoundsCacheKey(k,Y),Ie=this._bounds;if(Oe._updateBoundsCache(this._parent||this._symbol,te),ve&&Ie&&ve in Ie){var Ee=Ie[ve];return{rect:Ee.rect.clone(),nonscaling:Ee.nonscaling}}var ze=this._getBounds(v||fe,k),Qe=ze.rect||ze,He=this._style,Ze=ze.nonscaling||He.hasStroke()&&!He.getStrokeScaling();if(ve){Ie||(this._bounds=Ie={});var Ee=Ie[ve]={rect:Qe.clone(),nonscaling:Ze,internal:Y}}return{rect:Qe,nonscaling:Ze}},_getStrokeMatrix:function(v,k){var V=this.getStrokeScaling()?null:k&&k.internal?this:this._parent||this._symbol&&this._symbol._item,Y=V?V.getViewMatrix().invert():v;return Y&&Y._shiftless()},statics:{_updateBoundsCache:function(v,k){if(v&&k){var V=k._id,Y=v._boundsCache=v._boundsCache||{ids:{},list:[]};Y.ids[V]||(Y.list.push(k),Y.ids[V]=k)}},_clearBoundsCache:function(v){var k=v._boundsCache;if(k){v._bounds=v._position=v._boundsCache=n;for(var V=0,Y=k.list,te=Y.length;V<te;V++){var fe=Y[V];fe!==v&&(fe._bounds=fe._position=n,fe._boundsCache&&Oe._clearBoundsCache(fe))}}},_getBounds:function(v,k,V){var Y=1/0,te=-Y,fe=Y,ve=te,Ie=!1;V=V||{};for(var Ee=0,ze=v.length;Ee<ze;Ee++){var Qe=v[Ee];if(Qe._visible&&!Qe.isEmpty(!0)){var He=Qe._getCachedBounds(k&&k.appended(Qe._matrix),V,!0),Ze=He.rect;Y=Math.min(Ze.x,Y),fe=Math.min(Ze.y,fe),te=Math.max(Ze.x+Ze.width,te),ve=Math.max(Ze.y+Ze.height,ve),He.nonscaling&&(Ie=!0)}}return{rect:isFinite(Y)?new it(Y,fe,te-Y,ve-fe):new it,nonscaling:Ie}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var v=this._decompose();return v?v.rotation:0},setRotation:function(v){var k=this.getRotation();if(k!=null&&v!=null){var V=this._decomposed;this.rotate(v-k),V&&(V.rotation=v,this._decomposed=V)}},getScaling:function(){var v=this._decompose(),k=v&&v.scaling;return new Je(k?k.x:1,k?k.y:1,this,"setScaling")},setScaling:function(){var v=this.getScaling(),k=be.read(arguments,0,{clone:!0,readNull:!0});if(v&&k&&!v.equals(k)){var V=this.getRotation(),Y=this._decomposed,te=new Tt,fe=ae.isZero;if(fe(v.x)||fe(v.y))te.translate(Y.translation),V&&te.rotate(V),te.scale(k.x,k.y),this._matrix.set(te);else{var ve=this.getPosition(!0);te.translate(ve),V&&te.rotate(V),te.scale(k.x/v.x,k.y/v.y),V&&te.rotate(-V),te.translate(ve.negate()),this.transform(te)}Y&&(Y.scaling=k,this._decomposed=Y)}},getMatrix:function(){return this._matrix},setMatrix:function(){var v=this._matrix;v.set.apply(v,arguments)},getGlobalMatrix:function(v){var k=this._globalMatrix;if(k)for(var V=this._parent,Y=[];V;){if(!V._globalMatrix){k=null;for(var te=0,fe=Y.length;te<fe;te++)Y[te]._globalMatrix=null;break}Y.push(V),V=V._parent}if(!k){k=this._globalMatrix=this._matrix.clone();var V=this._parent;V&&k.prepend(V.getGlobalMatrix(!0))}return v?k:k.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(v){(this._applyMatrix=this._canApplyMatrix&&!!v)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(v,k){if(this._project!==v){this._project&&this._installEvents(!1),this._project=v;for(var V=this._children,Y=0,te=V&&V.length;Y<te;Y++)V[Y]._setProject(v);k=!0}k&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function v(k){v.base.call(this,k);for(var V=this._children,Y=0,te=V&&V.length;Y<te;Y++)V[Y]._installEvents(k)},getLayer:function(){for(var v=this;v=v._parent;)if(v instanceof at)return v;return null},getParent:function(){return this._parent},setParent:function(v){return v.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(v){this.removeChildren(),this.addChildren(v)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var v=this._getOwner();return v&&v._children[this._index+1]||null},getPreviousSibling:function(){var v=this._getOwner();return v&&v._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(v){return v===this||v&&this._class===v._class&&this._style.equals(v._style)&&this._matrix.equals(v._matrix)&&this._locked===v._locked&&this._visible===v._visible&&this._blendMode===v._blendMode&&this._opacity===v._opacity&&this._clipMask===v._clipMask&&this._guide===v._guide&&this._equals(v)||!1},_equals:function(v){return x.equals(this._children,v._children)},clone:function(v){var k=new this.constructor(Oe.NO_INSERT),V=this._children,Y=x.pick(v?v.insert:n,v===n||v===!0),te=x.pick(v?v.deep:n,!0);V&&k.copyAttributes(this),(!V||te)&&k.copyContent(this),V||k.copyAttributes(this),Y&&k.insertAbove(this);var fe=this._name,ve=this._parent;if(fe&&ve){for(var V=ve._children,Ie=fe,Ee=1;V[fe];)fe=Ie+" "+Ee++;fe!==Ie&&k.setName(fe)}return k},copyContent:function(v){for(var k=v._children,V=0,Y=k&&k.length;V<Y;V++)this.addChild(k[V].clone(!1),!0)},copyAttributes:function(v,k){this.setStyle(v._style);for(var V=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],Y=0,te=V.length;Y<te;Y++){var fe=V[Y];v.hasOwnProperty(fe)&&(this[fe]=v[fe])}k||this._matrix.set(v._matrix,!0),this.setApplyMatrix(v._applyMatrix),this.setPivot(v._pivot),this.setSelection(v._selection);var ve=v._data,Ie=v._name;this._data=ve?x.clone(ve):null,Ie&&this.setName(Ie)},rasterize:function(v,k){var V,Y,te;x.isPlainObject(v)?(V=v.resolution,Y=v.insert,te=v.raster):(V=v,Y=k),te||(te=new mt(Oe.NO_INSERT));var fe=this.getStrokeBounds(),ve=(V||this.getView().getResolution())/72,Ie=fe.getTopLeft().floor(),Ee=fe.getBottomRight().ceil(),ze=new st(Ee.subtract(Ie)),Qe=ze.multiply(ve);if(te.setSize(Qe,!0),!Qe.isZero()){var He=te.getContext(!0),Ze=new Tt().scale(ve).translate(Ie.negate());He.save(),Ze.applyToContext(He),this.draw(He,new x({matrices:[Ze]})),He.restore()}return te._matrix.set(new Tt().translate(Ie.add(ze.divide(2))).scale(1/ve)),(Y===n||Y)&&te.insertAbove(this),te},contains:function(){var v=this._matrix;return v.isInvertible()&&!!this._contains(v._inverseTransform(be.read(arguments)))},_contains:function(v){var k=this._children;if(k){for(var V=k.length-1;V>=0;V--)if(k[V].contains(v))return!0;return!1}return v.isInside(this.getInternalBounds())},isInside:function(){return it.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new Ot.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(v,k){return v instanceof Oe?this._asPathItem().getIntersections(v._asPathItem(),null,k,!0).length>0:!1}},new function(){function v(){var Y=arguments;return this._hitTest(be.read(Y),lt.getOptions(Y))}function k(){var Y=arguments,te=be.read(Y),fe=lt.getOptions(Y),ve=[];return this._hitTest(te,new x({all:ve},fe)),ve}function V(Y,te,fe,ve){var Ie=this._children;if(Ie)for(var Ee=Ie.length-1;Ee>=0;Ee--){var ze=Ie[Ee],Qe=ze!==ve&&ze._hitTest(Y,te,fe);if(Qe&&!te.all)return Qe}return null}return Rt.inject({hitTest:v,hitTestAll:k,_hitTest:V}),{hitTest:v,hitTestAll:k,_hitTestChildren:V}},{_hitTest:function(v,k,V){if(this._locked||!this._visible||this._guide&&!k.guides||this.isEmpty())return null;var Y=this._matrix,te=V?V.appended(Y):this.getGlobalMatrix().prepend(this.getView()._matrix),fe=Math.max(k.tolerance,1e-12),ve=k._tolerancePadding=new st(Ot._getStrokePadding(fe,Y._shiftless().invert()));if(v=Y._inverseTransform(v),!v||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(ve.multiply(2))._containsPoint(v))return null;var Ie=!(k.guides&&!this._guide||k.selected&&!this.isSelected()||k.type&&k.type!==x.hyphenate(this._class)||k.class&&!(this instanceof k.class)),Ee=k.match,ze=this,Qe,He;function Ze($){return $&&Ee&&!Ee($)&&($=null),$&&k.all&&k.all.push($),$}function Ue($,ie){var de=ie?Qe["get"+ie]():ze.getPosition();if(v.subtract(de).divide(ve).length<=1)return new lt($,ze,{name:ie?x.hyphenate(ie):$,point:de})}var dt=k.position,rt=k.center,Me=k.bounds;if(Ie&&this._parent&&(dt||rt||Me)){if((rt||Me)&&(Qe=this.getInternalBounds()),He=dt&&Ue("position")||rt&&Ue("center","Center"),!He&&Me)for(var se=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],ne=0;ne<8&&!He;ne++)He=Ue("bounds",se[ne]);He=Ze(He)}return He||(He=this._hitTestChildren(v,k,te)||Ie&&Ze(this._hitTestSelf(v,k,te,this.getStrokeScaling()?null:te._shiftless().invert()))||null),He&&He.point&&(He.point=Y.transform(He.point)),He},_hitTestSelf:function(v,k){if(k.fill&&this.hasFill()&&this._contains(v))return new lt("fill",this)},matches:function(v,k){function V(ve,Ie){for(var Ee in ve)if(ve.hasOwnProperty(Ee)){var ze=ve[Ee],Qe=Ie[Ee];if(x.isPlainObject(ze)&&x.isPlainObject(Qe)){if(!V(ze,Qe))return!1}else if(!x.equals(ze,Qe))return!1}return!0}var Y=typeof v;if(Y==="object"){for(var te in v)if(v.hasOwnProperty(te)&&!this.matches(te,v[te]))return!1;return!0}else{if(Y==="function")return v(this);if(v==="match")return k(this);var fe=/^(empty|editable)$/.test(v)?this["is"+x.capitalize(v)]():v==="type"?x.hyphenate(this._class):this[v];if(v==="class"){if(typeof k=="function")return this instanceof k;fe=this._class}if(typeof k=="function")return!!k(fe);if(k){if(k.test)return k.test(fe);if(x.isPlainObject(k))return V(k,fe)}return x.equals(fe,k)}},getItems:function(v){return Oe._getItems(this,v,this._matrix)},getItem:function(v){return Oe._getItems(this,v,this._matrix,null,!0)[0]||null},statics:{_getItems:function v(k,V,Y,te,fe){if(!te){var ve=typeof V=="object"&&V,Ie=ve&&ve.overlapping,Ee=ve&&ve.inside,ze=Ie||Ee,Ze=ze&&it.read([ze]);te={items:[],recursive:ve&&ve.recursive!==!1,inside:!!Ee,overlapping:!!Ie,rect:Ze,path:Ie&&new Ot.Rectangle({rectangle:Ze,insert:!1})},ve&&(V=x.filter({},V,{recursive:!0,inside:!0,overlapping:!0}))}var Qe=k._children,He=te.items,Ze=te.rect;Y=Ze&&(Y||new Tt);for(var Ue=0,dt=Qe&&Qe.length;Ue<dt;Ue++){var rt=Qe[Ue],Me=Y&&Y.appended(rt._matrix),se=!0;if(Ze){var ze=rt.getBounds(Me);if(!Ze.intersects(ze))continue;Ze.contains(ze)||te.overlapping&&(ze.contains(Ze)||te.path.intersects(rt,Me))||(se=!1)}if(se&&rt.matches(V)&&(He.push(rt),fe)||(te.recursive!==!1&&v(rt,V,Me,te,fe),fe&&He.length>0))break}return He}}},{importJSON:function(v){var k=x.importJSON(v,this);return k!==this?this.addChild(k):k},addChild:function(v){return this.insertChild(n,v)},insertChild:function(v,k){var V=k?this.insertChildren(v,[k]):null;return V&&V[0]},addChildren:function(v){return this.insertChildren(this._children.length,v)},insertChildren:function(v,k){var V=this._children;if(V&&k&&k.length>0){k=x.slice(k);for(var Y={},te=k.length-1;te>=0;te--){var fe=k[te],ve=fe&&fe._id;!fe||Y[ve]?k.splice(te,1):(fe._remove(!1,!0),Y[ve]=!0)}x.splice(V,k,v,0);for(var Ie=this._project,Ee=Ie._changes,te=0,ze=k.length;te<ze;te++){var fe=k[te],Qe=fe._name;fe._parent=this,fe._setProject(Ie,!0),Qe&&fe.setName(Qe),Ee&&fe._changed(5)}this._changed(11)}else k=null;return k},_insertItem:"#insertChild",_insertAt:function(v,k){var V=v&&v._getOwner(),Y=v!==this&&V?this:null;return Y&&(Y._remove(!1,!0),V._insertItem(v._index+k,Y)),Y},insertAbove:function(v){return this._insertAt(v,1)},insertBelow:function(v){return this._insertAt(v,0)},sendToBack:function(){var v=this._getOwner();return v?v._insertItem(0,this):null},bringToFront:function(){var v=this._getOwner();return v?v._insertItem(n,this):null},appendTop:"#addChild",appendBottom:function(v){return this.insertChild(0,v)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(v){return v._insertItem(n,this)},copyTo:function(v){return this.clone(!1).addTo(v)},reduce:function(v){var k=this._children;if(k&&k.length===1){var V=k[0].reduce(v);return this._parent?(V.insertAbove(this),this.remove()):V.remove(),V}return this},_removeNamed:function(){var v=this._getOwner();if(v){var k=v._children,V=v._namedChildren,Y=this._name,te=V[Y],fe=te?te.indexOf(this):-1;fe!==-1&&(k[Y]==this&&delete k[Y],te.splice(fe,1),te.length?k[Y]=te[0]:delete V[Y])}},_remove:function(v,k){var V=this._getOwner(),Y=this._project,te=this._index;return this._style&&this._style._dispose(),V?(this._name&&this._removeNamed(),te!=null&&(Y._activeLayer===this&&(Y._activeLayer=this.getNextSibling()||this.getPreviousSibling()),x.splice(V._children,null,te,1)),this._installEvents(!1),v&&Y._changes&&this._changed(5),k&&V._changed(11,this),this._parent=null,!0):!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(v){var k=v&&v.insertBelow(this);return k&&this.remove(),k},removeChildren:function(v,k){if(!this._children)return null;v=v||0,k=x.pick(k,this._children.length);for(var V=x.splice(this._children,null,v,k-v),Y=V.length-1;Y>=0;Y--)V[Y]._remove(!0,!1);return V.length>0&&this._changed(11),V},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var v=0,k=this._children.length;v<k;v++)this._children[v]._index=v;this._changed(11)}},isEmpty:function(v){var k=this._children,V=k?k.length:0;if(v){for(var Y=0;Y<V;Y++)if(!k[Y].isEmpty(v))return!1;return!0}return!V},isEditable:function(){for(var v=this;v;){if(!v._visible||v._locked)return!1;v=v._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(v){function k(ve){var Ie=[];do Ie.unshift(ve);while(ve=ve._parent);return Ie}for(var V=k(this),Y=k(v),te=0,fe=Math.min(V.length,Y.length);te<fe;te++)if(V[te]!=Y[te])return V[te]._index<Y[te]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function(v){return this._getOrder(v)===-1},isBelow:function(v){return this._getOrder(v)===1},isParent:function(v){return this._parent===v},isChild:function(v){return v&&v._parent===this},isDescendant:function(v){for(var k=this;k=k._parent;)if(k===v)return!0;return!1},isAncestor:function(v){return v?v.isDescendant(this):!1},isSibling:function(v){return this._parent===v._parent},isGroupedWith:function(v){for(var k=this._parent;k;){if(k._parent&&/^(Group|Layer|CompoundPath)$/.test(k._class)&&v.isDescendant(k))return!0;k=k._parent}return!1}},x.each(["rotate","scale","shear","skew"],function(v){var k=v==="rotate";this[v]=function(){var V=arguments,Y=(k?x:be).read(V),te=be.read(V,0,{readNull:!0});return this.transform(new Tt()[v](Y,te||this.getPosition(!0)))}},{translate:function(){var v=new Tt;return this.transform(v.translate.apply(v,arguments))},transform:function(v,k,V){var Y=this._matrix,te=v&&!v.isIdentity(),fe=V&&this._canApplyMatrix||this._applyMatrix&&(te||!Y.isIdentity()||k&&this._children);if(!te&&!fe)return this;if(te){!v.isInvertible()&&Y.isInvertible()&&(Y._backup=Y.getValues()),Y.prepend(v,!0);var ve=this._style,Ie=ve.getFillColor(!0),Ee=ve.getStrokeColor(!0);Ie&&Ie.transform(v),Ee&&Ee.transform(v)}if(fe&&(fe=this._transformContent(Y,k,V))){var ze=this._pivot;ze&&Y._transformPoint(ze,ze,!0),Y.reset(!0),V&&this._canApplyMatrix&&(this._applyMatrix=!0)}var Qe=this._bounds,He=this._position;(te||fe)&&this._changed(25);var Ze=te&&Qe&&v.decompose();if(Ze&&Ze.skewing.isZero()&&Ze.rotation%90===0){for(var Ue in Qe){var dt=Qe[Ue];if(dt.nonscaling)delete Qe[Ue];else if(fe||!dt.internal){var rt=dt.rect;v._transformBounds(rt,rt)}}this._bounds=Qe;var Me=Qe[this._getBoundsCacheKey(this._boundsOptions||{})];Me&&(this._position=this._getPositionFromBounds(Me.rect))}else te&&He&&this._pivot&&(this._position=v._transformPoint(He,He));return this},_transformContent:function(v,k,V){var Y=this._children;if(Y){for(var te=0,fe=Y.length;te<fe;te++)Y[te].transform(v,k,V);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(be.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(be.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(be.read(arguments))},localToParent:function(){return this._matrix._transformPoint(be.read(arguments))},fitBounds:function(v,k){v=it.read(arguments);var V=this.getBounds(),Y=V.height/V.width,te=v.height/v.width,fe=(k?Y>te:Y<te)?v.width/V.width:v.height/V.height,ve=new it(new be,new st(V.width*fe,V.height*fe));ve.setCenter(v.getCenter()),this.setBounds(ve)}}),{_setStyles:function(v,k,V){var Y=this._style,te=this._matrix;if(Y.hasFill()&&(v.fillStyle=Y.getFillColor().toCanvasStyle(v,te)),Y.hasStroke()){v.strokeStyle=Y.getStrokeColor().toCanvasStyle(v,te),v.lineWidth=Y.getStrokeWidth();var fe=Y.getStrokeJoin(),ve=Y.getStrokeCap(),Ie=Y.getMiterLimit();if(fe&&(v.lineJoin=fe),ve&&(v.lineCap=ve),Ie&&(v.miterLimit=Ie),pn.support.nativeDash){var Ee=Y.getDashArray(),ze=Y.getDashOffset();Ee&&Ee.length&&("setLineDash"in v?(v.setLineDash(Ee),v.lineDashOffset=ze):(v.mozDash=Ee,v.mozDashOffset=ze))}}if(Y.hasShadow()){var Qe=k.pixelRatio||1,He=V._shiftless().prepend(new Tt().scale(Qe,Qe)),Ze=He.transform(new be(Y.getShadowBlur(),0)),Ue=He.transform(this.getShadowOffset());v.shadowColor=Y.getShadowColor().toCanvasStyle(v),v.shadowBlur=Ze.getLength(),v.shadowOffsetX=Ue.x,v.shadowOffsetY=Ue.y}},draw:function(v,k,V){if(this._updateVersion=this._project._updateVersion,!(!this._visible||this._opacity===0)){var Y=k.matrices,te=k.viewMatrix,fe=this._matrix,ve=Y[Y.length-1].appended(fe);if(ve.isInvertible()){te=te?te.appended(ve):ve,Y.push(ve),k.updateMatrix&&(this._globalMatrix=ve);var Ie=this._blendMode,Ee=ae.clamp(this._opacity,0,1),ze=Ie==="normal",Qe=lr.nativeModes[Ie],He=ze&&Ee===1||k.dontStart||k.clip||(Qe||ze&&Ee<1)&&this._canComposite(),Ze=k.pixelRatio||1,Ue,dt,rt;if(!He){var Me=this.getStrokeBounds(te);if(!Me.width||!Me.height){Y.pop();return}rt=k.offset,dt=k.offset=Me.getTopLeft().floor(),Ue=v,v=sn.getContext(Me.getSize().ceil().add(1).multiply(Ze)),Ze!==1&&v.scale(Ze,Ze)}v.save();var se=V?V.appended(fe):this._canScaleStroke&&!this.getStrokeScaling(!0)&&te,ne=!He&&k.clipItem,$=!se||ne;if(He?(v.globalAlpha=Ee,Qe&&(v.globalCompositeOperation=Ie)):$&&v.translate(-dt.x,-dt.y),$&&(He?fe:te).applyToContext(v),ne&&k.clipItem.draw(v,k.extend({clip:!0})),se){v.setTransform(Ze,0,0,Ze,0,0);var ie=k.offset;ie&&v.translate(-ie.x,-ie.y)}this._draw(v,k,te,se),v.restore(),Y.pop(),k.clip&&!k.dontFinish&&v.clip(this.getFillRule()),He||(lr.process(Ie,v,Ue,Ee,dt.subtract(rt).multiply(Ze)),sn.release(v),k.offset=rt)}}},_isUpdated:function(v){var k=this._parent;if(k instanceof gi)return k._isUpdated(v);var V=this._updateVersion===v;return!V&&k&&k._visible&&k._isUpdated(v)&&(this._updateVersion=v,V=!0),V},_drawSelection:function(v,k,V,Y,te){var fe=this._selection,ve=fe&1,Ie=fe&2||ve&&this._selectBounds,Ee=fe&4;if(this._drawSelected||(ve=!1),(ve||Ie||Ee)&&this._isUpdated(te)){var ze,Qe=this.getSelectedColor(!0)||(ze=this.getLayer())&&ze.getSelectedColor(!0),He=k.appended(this.getGlobalMatrix(!0)),Ze=V/2;if(v.strokeStyle=v.fillStyle=Qe?Qe.toCanvasStyle(v):"#009dec",ve&&this._drawSelected(v,He,Y),Ee){var Ue=this.getPosition(!0),dt=this._parent,rt=dt?dt.localToGlobal(Ue):Ue,Me=rt.x,se=rt.y;v.beginPath(),v.arc(Me,se,Ze,0,Math.PI*2,!0),v.stroke();for(var ne=[[0,-1],[1,0],[0,1],[-1,0]],$=Ze,ie=V+1,de=0;de<4;de++){var ye=ne[de],ge=ye[0],Pe=ye[1];v.moveTo(Me+ge*$,se+Pe*$),v.lineTo(Me+ge*ie,se+Pe*ie),v.stroke()}}if(Ie){var Fe=He._transformCorners(this.getInternalBounds());v.beginPath();for(var de=0;de<8;de++)v[de?"lineTo":"moveTo"](Fe[de],Fe[++de]);v.closePath(),v.stroke();for(var de=0;de<8;de++)v.fillRect(Fe[de]-Ze,Fe[++de]-Ze,V,V)}}},_canComposite:function(){return!1}},x.each(["down","drag","up","move"],function(v){this["removeOn"+x.capitalize(v)]=function(){var k={};return k[v]=!0,this.removeOn(k)}},{removeOn:function(v){for(var k in v)if(v[k]){var V="mouse"+k,Y=this._project,te=Y._removeSets=Y._removeSets||{};te[V]=te[V]||{},te[V][this._id]=this}return this}}),{tween:function(v,k,V){V||(V=k,k=v,v=null,V||(V=k,k=null));var Y=V&&V.easing,te=V&&V.start,fe=V!=null&&(typeof V=="number"?V:V.duration),ve=new mr(this,v,k,fe,Y,te);function Ie(Ee){ve._handleFrame(Ee.time*1e3),ve.running||this.off("frame",Ie)}return fe&&this.on("frame",Ie),ve},tweenTo:function(v,k){return this.tween(null,v,k)},tweenFrom:function(v,k){return this.tween(v,null,k)}}),jt=Oe.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(k){this._children=[],this._namedChildren={},this._initialize(k)||this.addChildren(Array.isArray(k)?k:arguments)},_changed:function v(k){v.base.call(this,k),k&2050&&(this._clipItem=n)},_getClipItem:function(){var v=this._clipItem;if(v===n){v=null;for(var k=this._children,V=0,Y=k.length;V<Y;V++)if(k[V]._clipMask){v=k[V];break}this._clipItem=v}return v},isClipped:function(){return!!this._getClipItem()},setClipped:function(v){var k=this.getFirstChild();k&&k.setClipMask(v)},_getBounds:function v(k,V){var Y=this._getClipItem();return Y?Y._getCachedBounds(Y._matrix.prepended(k),x.set({},V,{stroke:!1})):v.base.call(this,k,V)},_hitTestChildren:function v(k,V,Y){var te=this._getClipItem();return(!te||te.contains(k))&&v.base.call(this,k,V,Y,te)},_draw:function(v,k){var V=k.clip,Y=!V&&this._getClipItem();k=k.extend({clipItem:Y,clip:!1}),V?(v.beginPath(),k.dontStart=k.dontFinish=!0):Y&&Y.draw(v,k.extend({clip:!0}));for(var te=this._children,fe=0,ve=te.length;fe<ve;fe++){var Ie=te[fe];Ie!==Y&&Ie.draw(v,k)}}}),at=jt.extend({_class:"Layer",initialize:function(){jt.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function v(){return this._parent?v.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),_t=Oe.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(k,V){this._initialize(k,V)},_equals:function(v){return this._type===v._type&&this._size.equals(v._size)&&x.equals(this._radius,v._radius)},copyContent:function(v){this.setType(v._type),this.setSize(v._size),this.setRadius(v._radius)},getType:function(){return this._type},setType:function(v){this._type=v},getShape:"#getType",setShape:"#setType",getSize:function(){var v=this._size;return new Ye(v.width,v.height,this,"setSize")},setSize:function(){var v=st.read(arguments);if(!this._size)this._size=v.clone();else if(!this._size.equals(v)){var k=this._type,V=v.width,Y=v.height;k==="rectangle"?this._radius.set(st.min(this._radius,v.divide(2).abs())):k==="circle"?(V=Y=(V+Y)/2,this._radius=V/2):k==="ellipse"&&this._radius._set(V/2,Y/2),this._size._set(V,Y),this._changed(9)}},getRadius:function(){var v=this._radius;return this._type==="circle"?v:new Ye(v.width,v.height,this,"setRadius")},setRadius:function(v){var k=this._type;if(k==="circle"){if(v===this._radius)return;var V=v*2;this._radius=v,this._size._set(V,V)}else if(v=st.read(arguments),!this._radius)this._radius=v.clone();else{if(this._radius.equals(v))return;if(this._radius.set(v),k==="rectangle"){var V=st.max(this._size,v.multiply(2));this._size.set(V)}else k==="ellipse"&&this._size._set(v.width*2,v.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function(v){var k=new Ot[x.capitalize(this._type)]({center:new be,size:this._size,radius:this._radius,insert:!1});return k.copyAttributes(this),pn.settings.applyMatrix&&k.setApplyMatrix(!0),(v===n||v)&&k.insertAbove(this),k},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(v,k,V,Y){var te=this._style,fe=te.hasFill(),ve=te.hasStroke(),Ie=k.dontFinish||k.clip,Ee=!Y;if(fe||ve||Ie){var ze=this._type,Qe=this._radius,He=ze==="circle";if(k.dontStart||v.beginPath(),Ee&&He)v.arc(0,0,Qe,0,Math.PI*2,!0);else{var Ze=He?Qe:Qe.width,Ue=He?Qe:Qe.height,dt=this._size,rt=dt.width,Me=dt.height;if(Ee&&ze==="rectangle"&&Ze===0&&Ue===0)v.rect(-rt/2,-Me/2,rt,Me);else{var se=rt/2,ne=Me/2,$=1-.5522847498307936,ie=Ze*$,de=Ue*$,ye=[-se,-ne+Ue,-se,-ne+de,-se+ie,-ne,-se+Ze,-ne,se-Ze,-ne,se-ie,-ne,se,-ne+de,se,-ne+Ue,se,ne-Ue,se,ne-de,se-ie,ne,se-Ze,ne,-se+Ze,ne,-se+ie,ne,-se,ne-de,-se,ne-Ue];Y&&Y.transform(ye,ye,32),v.moveTo(ye[0],ye[1]),v.bezierCurveTo(ye[2],ye[3],ye[4],ye[5],ye[6],ye[7]),se!==Ze&&v.lineTo(ye[8],ye[9]),v.bezierCurveTo(ye[10],ye[11],ye[12],ye[13],ye[14],ye[15]),ne!==Ue&&v.lineTo(ye[16],ye[17]),v.bezierCurveTo(ye[18],ye[19],ye[20],ye[21],ye[22],ye[23]),se!==Ze&&v.lineTo(ye[24],ye[25]),v.bezierCurveTo(ye[26],ye[27],ye[28],ye[29],ye[30],ye[31])}}v.closePath()}!Ie&&(fe||ve)&&(this._setStyles(v,k,V),fe&&(v.fill(te.getFillRule()),v.shadowColor="rgba(0,0,0,0)"),ve&&v.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(v,k){var V=new it(this._size).setCenter(0,0),Y=this._style,te=k.stroke&&Y.hasStroke()&&Y.getStrokeWidth();return v&&(V=v._transformBounds(V)),te?V.expand(Ot._getStrokePadding(te,this._getStrokeMatrix(v,k))):V}},new function(){function v(V,Y,te){var fe=V._radius;if(!fe.isZero())for(var ve=V._size.divide(2),Ie=1;Ie<=4;Ie++){var Ee=new be(Ie>1&&Ie<4?-1:1,Ie>2?-1:1),ze=Ee.multiply(ve),Qe=ze.subtract(Ee.multiply(fe)),He=new it(te?ze.add(Ee.multiply(te)):ze,Qe);if(He.contains(Y))return{point:Qe,quadrant:Ie}}}function k(V,Y,te,fe){var ve=V.divide(Y);return(!fe||ve.isInQuadrant(fe))&&ve.subtract(ve.normalize()).multiply(Y).divide(te).length<=1}return{_contains:function V(Y){if(this._type==="rectangle"){var te=v(this,Y);return te?Y.subtract(te.point).divide(this._radius).getLength()<=1:V.base.call(this,Y)}else return Y.divide(this.size).getLength()<=.5},_hitTestSelf:function V(Y,te,fe,ve){var Ie=!1,Ee=this._style,ze=te.stroke&&Ee.hasStroke(),Qe=te.fill&&Ee.hasFill();if(ze||Qe){var He=this._type,Ze=this._radius,Ue=ze?Ee.getStrokeWidth()/2:0,dt=te._tolerancePadding.add(Ot._getStrokePadding(Ue,!Ee.getStrokeScaling()&&ve));if(He==="rectangle"){var rt=dt.multiply(2),Me=v(this,Y,rt);if(Me)Ie=k(Y.subtract(Me.point),Ze,dt,Me.quadrant);else{var se=new it(this._size).setCenter(0,0),ne=se.expand(rt),$=se.expand(rt.negate());Ie=ne._containsPoint(Y)&&!$._containsPoint(Y)}}else Ie=k(Y,Ze,dt)}return Ie?new lt(ze?"stroke":"fill",this):V.base.apply(this,arguments)}}},{statics:new function(){function v(k,V,Y,te,fe){var ve=x.create(_t.prototype);return ve._type=k,ve._size=Y,ve._radius=te,ve._initialize(x.getNamed(fe),V),ve}return{Circle:function(){var k=arguments,V=be.readNamed(k,"center"),Y=x.readNamed(k,"radius");return v("circle",V,new st(Y*2),Y,k)},Rectangle:function(){var k=arguments,V=it.readNamed(k,"rectangle"),Y=st.min(st.readNamed(k,"radius"),V.getSize(!0).divide(2));return v("rectangle",V.getCenter(!0),V.getSize(!0),Y,k)},Ellipse:function(){var k=arguments,V=_t._readEllipse(k),Y=V.radius;return v("ellipse",V.center,Y.multiply(2),Y,k)},_readEllipse:function(k){var V,Y;if(x.hasNamed(k,"radius"))V=be.readNamed(k,"center"),Y=st.readNamed(k,"radius");else{var te=it.readNamed(k,"rectangle");V=te.getCenter(!0),Y=te.getSize(!0).divide(2)}return{center:V,radius:Y}}}}}),mt=Oe.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(k,V){if(!this._initialize(k,V!==n&&be.read(arguments))){var Y,te=typeof k,fe=te==="string"?g.getElementById(k):te==="object"?k:null;if(fe&&fe!==Oe.NO_INSERT){if(fe.getContext||fe.naturalHeight!=null)Y=fe;else if(fe){var ve=st.read(arguments);ve.isZero()||(Y=sn.getCanvas(ve))}}Y?this.setImage(Y):this.setSource(k)}this._size||(this._size=new st,this._loaded=!1)},_equals:function(v){return this.getSource()===v.getSource()},copyContent:function(v){var k=v._image,V=v._canvas;if(k)this._setImage(k);else if(V){var Y=sn.getCanvas(v._size);Y.getContext("2d").drawImage(V,0,0),this._setImage(Y)}this._crossOrigin=v._crossOrigin},getSize:function(){var v=this._size;return new Ye(v?v.width:0,v?v.height:0,this,"setSize")},setSize:function(v,k){var V=st.read(arguments);if(V.equals(this._size))k&&this.clear();else if(V.width>0&&V.height>0){var Y=!k&&this.getElement();this._setImage(sn.getCanvas(V)),Y&&this.getContext(!0).drawImage(Y,0,0,V.width,V.height)}else this._canvas&&sn.release(this._canvas),this._size=V.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(v){this.setSize(v,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(v){this.setSize(this.getWidth(),v)},getLoaded:function(){return this._loaded},isEmpty:function(){var v=this._size;return!v||v.width===0&&v.height===0},getResolution:function(){var v=this._matrix,k=new be(0,0).transform(v),V=new be(1,0).transform(v).subtract(k),Y=new be(0,1).transform(v).subtract(k);return new st(72/V.getLength(),72/Y.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(v){var k=this;function V(Y){var te=k.getView(),fe=Y&&Y.type||"load";te&&k.responds(fe)&&(pn=te._scope,k.emit(fe,new xn(Y)))}this._setImage(v),this._loaded?setTimeout(V,0):v&&mi.add(v,{load:function(Y){k._setImage(v),V(Y)},error:V})},_setImage:function(v){this._canvas&&sn.release(this._canvas),v&&v.getContext?(this._image=null,this._canvas=v,this._loaded=!0):(this._image=v,this._canvas=null,this._loaded=!!(v&&v.src&&v.complete)),this._size=new st(v?v.naturalWidth||v.width:0,v?v.naturalHeight||v.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var v=sn.getContext(this._size);try{this._image&&v.drawImage(this._image,0,0),this._canvas=v.canvas}catch{sn.release(v)}}return this._canvas},setCanvas:"#setImage",getContext:function(v){return this._context||(this._context=this.getCanvas().getContext("2d")),v&&(this._image=null,this._changed(1025)),this._context},setContext:function(v){this._context=v},getSource:function(){var v=this._image;return v&&v.src||this.toDataURL()},setSource:function(v){var k=new t.Image,V=this._crossOrigin;V&&(k.crossOrigin=V),v&&(k.src=v),this.setImage(k)},getCrossOrigin:function(){var v=this._image;return v&&v.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(v){this._crossOrigin=v;var k=this._image;k&&(k.crossOrigin=v)},getSmoothing:function(){return this._smoothing},setSmoothing:function(v){this._smoothing=typeof v=="string"?v:v?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var v=it.read(arguments),k=sn.getContext(v.getSize());return k.drawImage(this.getCanvas(),v.x,v.y,v.width,v.height,0,0,v.width,v.height),k.canvas},getSubRaster:function(){var v=it.read(arguments),k=new mt(Oe.NO_INSERT);return k._setImage(this.getSubCanvas(v)),k.translate(v.getCenter().subtract(this.getSize().divide(2))),k._matrix.prepend(this._matrix),k.insertAbove(this),k},toDataURL:function(){var v=this._image,k=v&&v.src;if(/^data:/.test(k))return k;var V=this.getCanvas();return V?V.toDataURL.apply(V,arguments):null},drawImage:function(v){var k=be.read(arguments,1);this.getContext(!0).drawImage(v,k.x,k.y)},getAverageColor:function(v){var k,V;if(v?v instanceof Bt?(V=v,k=v.getBounds()):typeof v=="object"&&("width"in v?k=new it(v):"x"in v&&(k=new it(v.x-.5,v.y-.5,1,1))):k=this.getBounds(),!k)return null;var Y=32,te=Math.min(k.width,Y),fe=Math.min(k.height,Y),ve=mt._sampleContext;ve?ve.clearRect(0,0,Y+1,Y+1):ve=mt._sampleContext=sn.getContext(new st(Y)),ve.save();var Ie=new Tt().scale(te/k.width,fe/k.height).translate(-k.x,-k.y);Ie.applyToContext(ve),V&&V.draw(ve,new x({clip:!0,matrices:[Ie]})),this._matrix.applyToContext(ve);var Ee=this.getElement(),ze=this._size;Ee&&ve.drawImage(Ee,-ze.width/2,-ze.height/2),ve.restore();for(var Qe=ve.getImageData(.5,.5,Math.ceil(te),Math.ceil(fe)).data,He=[0,0,0],Ze=0,Ue=0,dt=Qe.length;Ue<dt;Ue+=4){var rt=Qe[Ue+3];Ze+=rt,rt/=255,He[0]+=Qe[Ue]*rt,He[1]+=Qe[Ue+1]*rt,He[2]+=Qe[Ue+2]*rt}for(var Ue=0;Ue<3;Ue++)He[Ue]/=Ze;return Ze?Hi.read(He):null},getPixel:function(){var v=be.read(arguments),k=this.getContext().getImageData(v.x,v.y,1,1).data;return new Hi("rgb",[k[0]/255,k[1]/255,k[2]/255],k[3]/255)},setPixel:function(){var v=arguments,k=be.read(v),V=Hi.read(v),Y=V._convert("rgb"),te=V._alpha,fe=this.getContext(!0),ve=fe.createImageData(1,1),Ie=ve.data;Ie[0]=Y[0]*255,Ie[1]=Y[1]*255,Ie[2]=Y[2]*255,Ie[3]=te!=null?te*255:255,fe.putImageData(ve,k.x,k.y)},clear:function(){var v=this._size;this.getContext(!0).clearRect(0,0,v.width+1,v.height+1)},createImageData:function(){var v=st.read(arguments);return this.getContext().createImageData(v.width,v.height)},getImageData:function(){var v=it.read(arguments);return v.isEmpty()&&(v=new it(this._size)),this.getContext().getImageData(v.x,v.y,v.width,v.height)},putImageData:function(v){var k=be.read(arguments,1);this.getContext(!0).putImageData(v,k.x,k.y)},setImageData:function(v){this.setSize(v),this.getContext(!0).putImageData(v,0,0)},_getBounds:function(v,k){var V=new it(this._size).setCenter(0,0);return v?v._transformBounds(V):V},_hitTestSelf:function(v){if(this._contains(v)){var k=this;return new lt("pixel",k,{offset:v.add(k._size.divide(2)).round(),color:{get:function(){return k.getPixel(this.offset)}}})}},_draw:function(v,k,V){var Y=this.getElement();if(Y&&Y.width>0&&Y.height>0){v.globalAlpha=ae.clamp(this._opacity,0,1),this._setStyles(v,k,V);var te=this._smoothing,fe=te==="off";Ei.setPrefixed(v,fe?"imageSmoothingEnabled":"imageSmoothingQuality",fe?!1:te),v.drawImage(Y,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),xt=Oe.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(k,V){this._initialize(k,V!==n&&be.read(arguments,1))||this.setDefinition(k instanceof bt?k:new bt(k))},_equals:function(v){return this._definition===v._definition},copyContent:function(v){this.setDefinition(v._definition)},getDefinition:function(){return this._definition},setDefinition:function(v){this._definition=v,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(v,k){var V=this._definition._item;return V._getCachedBounds(V._matrix.prepended(v),k)},_hitTestSelf:function(v,k,V){var Y=k.extend({all:!1}),te=this._definition._item._hitTest(v,Y,V);return te&&(te.item=this),te},_draw:function(v,k){this._definition._item.draw(v,k)}}),bt=x.extend({_class:"SymbolDefinition",initialize:function(k,V){this._id=ce.get(),this.project=pn.project,k&&this.setItem(k,V)},_serialize:function(v,k){return k.add(this,function(){return x.serialize([this._class,this._item],v,!1,k)})},_changed:function(v){v&8&&Oe._clearBoundsCache(this),v&1&&this.project._changed(v)},getItem:function(){return this._item},setItem:function(v,k){v._symbol&&(v=v.clone()),this._item&&(this._item._symbol=null),this._item=v,v.remove(),v.setSelected(!1),k||v.setPosition(new be),v._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(v){return new xt(this,v)},clone:function(){return new bt(this._item.clone(!1))},equals:function(v){return v===this||v&&this._item.equals(v._item)||!1}}),lt=x.extend({_class:"HitResult",initialize:function(k,V,Y){this.type=k,this.item=V,Y&&this.inject(Y)},statics:{getOptions:function(v){var k=v&&x.read(v);return new x({type:null,tolerance:pn.settings.hitTolerance,fill:!k,stroke:!k,segments:!k,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},k)}}}),$e=x.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(k,V,Y,te,fe,ve){var Ie=arguments.length,Ee,ze,Qe,He;Ie>0&&(k==null||typeof k=="object"?Ie===1&&k&&"point"in k?(Ee=k.point,ze=k.handleIn,Qe=k.handleOut,He=k.selection):(Ee=k,ze=V,Qe=Y,He=te):(Ee=[k,V],ze=Y!==n?[Y,te]:null,Qe=fe!==n?[fe,ve]:null)),new pt(Ee,this,"_point"),new pt(ze,this,"_handleIn"),new pt(Qe,this,"_handleOut"),He&&this.setSelection(He)},_serialize:function(v,k){var V=this._point,Y=this._selection,te=Y||this.hasHandles()?[V,this._handleIn,this._handleOut]:V;return Y&&te.push(Y),x.serialize(te,v,!0,k)},_changed:function(v){var k=this._path;if(k){var V=k._curves,Y=this._index,te;V&&((!v||v===this._point||v===this._handleIn)&&(te=Y>0?V[Y-1]:k._closed?V[V.length-1]:null)&&te._changed(),(!v||v===this._point||v===this._handleOut)&&(te=V[Y])&&te._changed()),k._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(be.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(be.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(be.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var v=this._handleIn,k=this._handleOut;return!v.isZero()&&!k.isZero()&&v.isCollinear(k)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(v){var k=this._selection,V=this._path;this._selection=v=v||0,V&&v!==k&&(V._updateSelection(this,k,v),V._changed(257))},_changeSelection:function(v,k){var V=this._selection;this.setSelection(k?V|v:V&~v)},isSelected:function(){return!!(this._selection&7)},setSelected:function(v){this._changeSelection(7,v)},getIndex:function(){return this._index!==n?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var v=this._path,k=this._index;return v?(k>0&&!v._closed&&k===v._segments.length-1&&k--,v.getCurves()[k]||null):null},getLocation:function(){var v=this.getCurve();return v?new Nt(v,this===v._segment1?0:1):null},getNext:function(){var v=this._path&&this._path._segments;return v&&(v[this._index+1]||this._path._closed&&v[0])||null},smooth:function(v,k,V){var Y=v||{},te=Y.type,fe=Y.factor,ve=this.getPrevious(),Ie=this.getNext(),Ee=(ve||this)._point,ze=this._point,Qe=(Ie||this)._point,He=Ee.getDistance(ze),Ze=ze.getDistance(Qe);if(!te||te==="catmull-rom"){var Ue=fe===n?.5:fe,dt=Math.pow(He,Ue),rt=dt*dt,Me=Math.pow(Ze,Ue),se=Me*Me;if(!k&&ve){var ne=2*se+3*Me*dt+rt,$=3*Me*(Me+dt);this.setHandleIn($!==0?new be((se*Ee._x+ne*ze._x-rt*Qe._x)/$-ze._x,(se*Ee._y+ne*ze._y-rt*Qe._y)/$-ze._y):new be)}if(!V&&Ie){var ne=2*rt+3*dt*Me+se,$=3*dt*(dt+Me);this.setHandleOut($!==0?new be((rt*Qe._x+ne*ze._x-se*Ee._x)/$-ze._x,(rt*Qe._y+ne*ze._y-se*Ee._y)/$-ze._y):new be)}}else if(te==="geometric"){if(ve&&Ie){var ie=Ee.subtract(Qe),de=fe===n?.4:fe,ye=de*He/(He+Ze);k||this.setHandleIn(ie.multiply(ye)),V||this.setHandleOut(ie.multiply(ye-de))}}else throw new Error("Smoothing method '"+te+"' not supported.")},getPrevious:function(){var v=this._path&&this._path._segments;return v&&(v[this._index-1]||this._path._closed&&v[v.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var v=this._path;return v&&this._index===v._segments.length-1||!1},reverse:function(){var v=this._handleIn,k=this._handleOut,V=v.clone();v.set(k),k.set(V)},reversed:function(){return new $e(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new $e(this._point,this._handleIn,this._handleOut)},equals:function(v){return v===this||v&&this._class===v._class&&this._point.equals(v._point)&&this._handleIn.equals(v._handleIn)&&this._handleOut.equals(v._handleOut)||!1},toString:function(){var v=["point: "+this._point];return this._handleIn.isZero()||v.push("handleIn: "+this._handleIn),this._handleOut.isZero()||v.push("handleOut: "+this._handleOut),"{ "+v.join(", ")+" }"},transform:function(v){this._transformCoordinates(v,new Array(6),!0),this._changed()},interpolate:function(v,k,V){var Y=1-V,te=V,fe=v._point,ve=k._point,Ie=v._handleIn,Ee=k._handleIn,ze=k._handleOut,Qe=v._handleOut;this._point._set(Y*fe._x+te*ve._x,Y*fe._y+te*ve._y,!0),this._handleIn._set(Y*Ie._x+te*Ee._x,Y*Ie._y+te*Ee._y,!0),this._handleOut._set(Y*Qe._x+te*ze._x,Y*Qe._y+te*ze._y,!0),this._changed()},_transformCoordinates:function(v,k,V){var Y=this._point,te=!V||!this._handleIn.isZero()?this._handleIn:null,fe=!V||!this._handleOut.isZero()?this._handleOut:null,ve=Y._x,Ie=Y._y,Ee=2;return k[0]=ve,k[1]=Ie,te&&(k[Ee++]=te._x+ve,k[Ee++]=te._y+Ie),fe&&(k[Ee++]=fe._x+ve,k[Ee++]=fe._y+Ie),v&&(v._transformCoordinates(k,k,Ee/2),ve=k[0],Ie=k[1],V?(Y._x=ve,Y._y=Ie,Ee=2,te&&(te._x=k[Ee++]-ve,te._y=k[Ee++]-Ie),fe&&(fe._x=k[Ee++]-ve,fe._y=k[Ee++]-Ie)):(te||(k[Ee++]=ve,k[Ee++]=Ie),fe||(k[Ee++]=ve,k[Ee++]=Ie))),k}}),pt=be.extend({initialize:function(k,V,Y){var te,fe,ve;if(!k)te=fe=0;else if((te=k[0])!==n)fe=k[1];else{var Ie=k;(te=Ie.x)===n&&(Ie=be.read(arguments),te=Ie.x),fe=Ie.y,ve=Ie.selected}this._x=te,this._y=fe,this._owner=V,V[Y]=this,ve&&this.setSelected(!0)},_set:function(v,k){return this._x=v,this._y=k,this._owner._changed(this),this},getX:function(){return this._x},setX:function(v){this._x=v,this._owner._changed(this)},getY:function(){return this._y},setY:function(v){this._y=v,this._owner._changed(this)},isZero:function(){var v=ae.isZero;return v(this._x)&&v(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(v){this._owner._changeSelection(this._getSelection(),v)},_getSelection:function(){var v=this._owner;return this===v._point?1:this===v._handleIn?2:this===v._handleOut?4:0}}),ut=x.extend({_class:"Curve",beans:!0,initialize:function(k,V,Y,te,fe,ve,Ie,Ee){var ze=arguments.length,Qe,He,Ze,Ue,dt,rt;ze===3?(this._path=k,Qe=V,He=Y):ze?ze===1?"segment1"in k?(Qe=new $e(k.segment1),He=new $e(k.segment2)):"point1"in k?(Ze=k.point1,dt=k.handle1,rt=k.handle2,Ue=k.point2):Array.isArray(k)&&(Ze=[k[0],k[1]],Ue=[k[6],k[7]],dt=[k[2]-k[0],k[3]-k[1]],rt=[k[4]-k[6],k[5]-k[7]]):ze===2?(Qe=new $e(k),He=new $e(V)):ze===4?(Ze=k,dt=V,rt=Y,Ue=te):ze===8&&(Ze=[k,V],Ue=[Ie,Ee],dt=[Y-k,te-V],rt=[fe-Ie,ve-Ee]):(Qe=new $e,He=new $e),this._segment1=Qe||new $e(Ze,null,dt),this._segment2=He||new $e(Ue,rt,null)},_serialize:function(v,k){return x.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],v,!0,k)},_changed:function(){this._length=this._bounds=n},clone:function(){return new ut(this._segment1,this._segment2)},toString:function(){var v=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||v.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||v.push("handle2: "+this._segment2._handleIn),v.push("point2: "+this._segment2._point),"{ "+v.join(", ")+" }"},classify:function(){return ut.classify(this.getValues())},remove:function(){var v=!1;if(this._path){var k=this._segment2,V=k._handleOut;v=k.remove(),v&&this._segment1._handleOut.set(V)}return v},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(be.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(be.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(be.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(be.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var v=this._path&&this._path._curves;return v&&(v[this._segment1._index+1]||this._path._closed&&v[0])||null},getPrevious:function(){var v=this._path&&this._path._curves;return v&&(v[this._segment1._index-1]||this._path._closed&&v[v.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var v=this._path;return v&&this._segment1._index===v._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(v){this.getPoint1().setSelected(v),this.getHandle1().setSelected(v),this.getHandle2().setSelected(v),this.getPoint2().setSelected(v)},getValues:function(v){return ut.getValues(this._segment1,this._segment2,v)},getPoints:function(){for(var v=this.getValues(),k=[],V=0;V<8;V+=2)k.push(new be(v[V],v[V+1]));return k}},{getLength:function(){return this._length==null&&(this._length=ut.getLength(this.getValues(),0,1)),this._length},getArea:function(){return ut.getArea(this.getValues())},getLine:function(){return new zt(this._segment1._point,this._segment2._point)},getPart:function(v,k){return new ut(ut.getPart(this.getValues(),v,k))},getPartLength:function(v,k){return ut.getLength(this.getValues(),v,k)},divideAt:function(v){return this.divideAtTime(v&&v.curve===this?v.time:this.getTimeAt(v))},divideAtTime:function(v,k){var V=1e-8,Y=1-V,te=null;if(v>=V&&v<=Y){var fe=ut.subdivide(this.getValues(),v),ve=fe[0],Ie=fe[1],Ee=k||this.hasHandles(),ze=this._segment1,Qe=this._segment2,He=this._path;Ee&&(ze._handleOut._set(ve[2]-ve[0],ve[3]-ve[1]),Qe._handleIn._set(Ie[4]-Ie[6],Ie[5]-Ie[7]));var Ze=ve[6],Ue=ve[7],dt=new $e(new be(Ze,Ue),Ee&&new be(ve[4]-Ze,ve[5]-Ue),Ee&&new be(Ie[2]-Ze,Ie[3]-Ue));He?(He.insert(ze._index+1,dt),te=this.getNext()):(this._segment2=dt,this._changed(),te=new ut(dt,Qe))}return te},splitAt:function(v){var k=this._path;return k?k.splitAt(v):null},splitAtTime:function(v){return this.splitAt(this.getLocationAtTime(v))},divide:function(v,k){return this.divideAtTime(v===n?.5:k?v:this.getTimeAt(v))},split:function(v,k){return this.splitAtTime(v===n?.5:k?v:this.getTimeAt(v))},reversed:function(){return new ut(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(v,k,V,Y){var te=v._point,fe=v._handleOut,ve=k._handleIn,Ie=k._point,Ee=te.x,ze=te.y,Qe=Ie.x,He=Ie.y,Ze=Y?[Ee,ze,Ee,ze,Qe,He,Qe,He]:[Ee,ze,Ee+fe._x,ze+fe._y,Qe+ve._x,He+ve._y,Qe,He];return V&&V._transformCoordinates(Ze,Ze,4),Ze},subdivide:function(v,k){var V=v[0],Y=v[1],te=v[2],fe=v[3],ve=v[4],Ie=v[5],Ee=v[6],ze=v[7];k===n&&(k=.5);var Qe=1-k,He=Qe*V+k*te,Ze=Qe*Y+k*fe,Ue=Qe*te+k*ve,dt=Qe*fe+k*Ie,rt=Qe*ve+k*Ee,Me=Qe*Ie+k*ze,se=Qe*He+k*Ue,ne=Qe*Ze+k*dt,$=Qe*Ue+k*rt,ie=Qe*dt+k*Me,de=Qe*se+k*$,ye=Qe*ne+k*ie;return[[V,Y,He,Ze,se,ne,de,ye],[de,ye,$,ie,rt,Me,Ee,ze]]},getMonoCurves:function(v,k){var V=[],Y=k?0:1,te=v[Y+0],fe=v[Y+2],ve=v[Y+4],Ie=v[Y+6];if(te>=fe==fe>=ve&&fe>=ve==ve>=Ie||ut.isStraight(v))V.push(v);else{var Ee=3*(fe-ve)-te+Ie,ze=2*(te+ve)-4*fe,Qe=fe-te,He=1e-8,Ze=1-He,Ue=[],dt=ae.solveQuadratic(Ee,ze,Qe,Ue,He,Ze);if(!dt)V.push(v);else{Ue.sort();var rt=Ue[0],Me=ut.subdivide(v,rt);V.push(Me[0]),dt>1&&(rt=(Ue[1]-rt)/(1-rt),Me=ut.subdivide(Me[1],rt),V.push(Me[0])),V.push(Me[1])}}return V},solveCubic:function(v,k,V,Y,te,fe){var ve=v[k],Ie=v[k+2],Ee=v[k+4],ze=v[k+6],Qe=0;if(!(ve<V&&ze<V&&Ie<V&&Ee<V||ve>V&&ze>V&&Ie>V&&Ee>V)){var He=3*(Ie-ve),Ze=3*(Ee-Ie)-He,Ue=ze-ve-He-Ze;Qe=ae.solveCubic(Ue,Ze,He,ve-V,Y,te,fe)}return Qe},getTimeOf:function(v,k){var V=new be(v[0],v[1]),Y=new be(v[6],v[7]),te=1e-12,fe=1e-7,ve=k.isClose(V,te)?0:k.isClose(Y,te)?1:null;if(ve===null)for(var Ie=[k.x,k.y],Ee=[],ze=0;ze<2;ze++)for(var Qe=ut.solveCubic(v,ze,Ie[ze],Ee,0,1),He=0;He<Qe;He++){var Ze=Ee[He];if(k.isClose(ut.getPoint(v,Ze),fe))return Ze}return k.isClose(V,fe)?0:k.isClose(Y,fe)?1:null},getNearestTime:function(v,k){if(ut.isStraight(v)){var V=v[0],Y=v[1],te=v[6],fe=v[7],ve=te-V,Ie=fe-Y,Ee=ve*ve+Ie*Ie;if(Ee===0)return 0;var ze=((k.x-V)*ve+(k.y-Y)*Ie)/Ee;return ze<1e-12?0:ze>.999999999999?1:ut.getTimeOf(v,new be(V+ze*ve,Y+ze*Ie))}var Qe=100,He=1/0,Ze=0;function Ue(Me){if(Me>=0&&Me<=1){var se=k.getDistance(ut.getPoint(v,Me),!0);if(se<He)return He=se,Ze=Me,!0}}for(var dt=0;dt<=Qe;dt++)Ue(dt/Qe);for(var rt=1/(Qe*2);rt>1e-8;)!Ue(Ze-rt)&&!Ue(Ze+rt)&&(rt/=2);return Ze},getPart:function(v,k,V){var Y=k>V;if(Y){var te=k;k=V,V=te}return k>0&&(v=ut.subdivide(v,k)[1]),V<1&&(v=ut.subdivide(v,(V-k)/(1-k))[0]),Y?[v[6],v[7],v[4],v[5],v[2],v[3],v[0],v[1]]:v},isFlatEnough:function(v,k){var V=v[0],Y=v[1],te=v[2],fe=v[3],ve=v[4],Ie=v[5],Ee=v[6],ze=v[7],Qe=3*te-2*V-Ee,He=3*fe-2*Y-ze,Ze=3*ve-2*Ee-V,Ue=3*Ie-2*ze-Y;return Math.max(Qe*Qe,Ze*Ze)+Math.max(He*He,Ue*Ue)<=16*k*k},getArea:function(v){var k=v[0],V=v[1],Y=v[2],te=v[3],fe=v[4],ve=v[5],Ie=v[6],Ee=v[7];return 3*((Ee-V)*(Y+fe)-(Ie-k)*(te+ve)+te*(k-fe)-Y*(V-ve)+Ee*(fe+k/3)-Ie*(ve+V/3))/20},getBounds:function(v){for(var k=v.slice(0,2),V=k.slice(),Y=[0,0],te=0;te<2;te++)ut._addBounds(v[te],v[te+2],v[te+4],v[te+6],te,0,k,V,Y);return new it(k[0],k[1],V[0]-k[0],V[1]-k[1])},_addBounds:function(v,k,V,Y,te,fe,ve,Ie,Ee){function ze(de,ye){var ge=de-ye,Pe=de+ye;ge<ve[te]&&(ve[te]=ge),Pe>Ie[te]&&(Ie[te]=Pe)}fe/=2;var Qe=ve[te]+fe,He=Ie[te]-fe;if(v<Qe||k<Qe||V<Qe||Y<Qe||v>He||k>He||V>He||Y>He)if(k<v!=k<Y&&V<v!=V<Y)ze(v,0),ze(Y,0);else{var Ze=3*(k-V)-v+Y,Ue=2*(v+V)-4*k,dt=k-v,rt=ae.solveQuadratic(Ze,Ue,dt,Ee),Me=1e-8,se=1-Me;ze(Y,0);for(var ne=0;ne<rt;ne++){var $=Ee[ne],ie=1-$;Me<=$&&$<=se&&ze(ie*ie*ie*v+3*ie*ie*$*k+3*ie*$*$*V+$*$*$*Y,fe)}}}}},x.each(["getBounds","getStrokeBounds","getHandleBounds"],function(v){this[v]=function(){this._bounds||(this._bounds={});var k=this._bounds[v];return k||(k=this._bounds[v]=Ot[v]([this._segment1,this._segment2],!1,this._path)),k.clone()}},{}),x.each({isStraight:function(v,k,V,Y){if(k.isZero()&&V.isZero())return!0;var te=Y.subtract(v);if(te.isZero())return!1;if(te.isCollinear(k)&&te.isCollinear(V)){var fe=new zt(v,Y),ve=1e-7;if(fe.getDistance(v.add(k))<ve&&fe.getDistance(Y.add(V))<ve){var Ie=te.dot(te),Ee=te.dot(k)/Ie,ze=te.dot(V)/Ie;return Ee>=0&&Ee<=1&&ze<=0&&ze>=-1}}return!1},isLinear:function(v,k,V,Y){var te=Y.subtract(v).divide(3);return k.equals(te)&&V.negate().equals(te)}},function(v,k){this[k]=function(V){var Y=this._segment1,te=this._segment2;return v(Y._point,Y._handleOut,te._handleIn,te._point,V)},this.statics[k]=function(V,Y){var te=V[0],fe=V[1],ve=V[6],Ie=V[7];return v(new be(te,fe),new be(V[2]-te,V[3]-fe),new be(V[4]-ve,V[5]-Ie),new be(ve,Ie),Y)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(v){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(v||0)},isCollinear:function(v){return v&&this.isStraight()&&v.isStraight()&&this.getLine().isCollinear(v.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(v,k){return this.getLocationAtTime(k?v:this.getTimeAt(v))},getLocationAtTime:function(v){return v!=null&&v>=0&&v<=1?new Nt(this,v):null},getTimeAt:function(v,k){return ut.getTimeAt(this.getValues(),v,k)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var v=be.read(arguments);return v.isZero()?[]:ut.getTimesWithTangent(this.getValues(),v)},getOffsetAtTime:function(v){return this.getPartLength(0,v)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(be.read(arguments)))},getOffsetOf:function(){var v=this.getLocationOf.apply(this,arguments);return v?v.getOffset():null},getTimeOf:function(){return ut.getTimeOf(this.getValues(),be.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var v=be.read(arguments),k=this.getValues(),V=ut.getNearestTime(k,v),Y=ut.getPoint(k,V);return new Nt(this,V,Y,null,v.getDistance(Y))},getNearestPoint:function(){var v=this.getNearestLocation.apply(this,arguments);return v&&v.getPoint()}},new function(){var v=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return x.each(v,function(k){this[k+"At"]=function(V,Y){var te=this.getValues();return ut[k](te,Y?V:ut.getTimeAt(te,V))},this[k+"AtTime"]=function(V){return ut[k](this.getValues(),V)}},{statics:{_evaluateMethods:v}})},new function(){function v(Y){var te=Y[0],fe=Y[1],ve=Y[2],Ie=Y[3],Ee=Y[4],ze=Y[5],Qe=Y[6],He=Y[7],Ze=9*(ve-Ee)+3*(Qe-te),Ue=6*(te+Ee)-12*ve,dt=3*(ve-te),rt=9*(Ie-ze)+3*(He-fe),Me=6*(fe+ze)-12*Ie,se=3*(Ie-fe);return function(ne){var $=(Ze*ne+Ue)*ne+dt,ie=(rt*ne+Me)*ne+se;return Math.sqrt($*$+ie*ie)}}function k(Y,te){return Math.max(2,Math.min(16,Math.ceil(Math.abs(te-Y)*32)))}function V(Y,te,fe,ve){if(te==null||te<0||te>1)return null;var Ie=Y[0],Ee=Y[1],ze=Y[2],Qe=Y[3],He=Y[4],Ze=Y[5],Ue=Y[6],dt=Y[7],rt=ae.isZero;rt(ze-Ie)&&rt(Qe-Ee)&&(ze=Ie,Qe=Ee),rt(He-Ue)&&rt(Ze-dt)&&(He=Ue,Ze=dt);var Me=3*(ze-Ie),se=3*(He-ze)-Me,ne=Ue-Ie-Me-se,$=3*(Qe-Ee),ie=3*(Ze-Qe)-$,de=dt-Ee-$-ie,ye,ge;if(fe===0)ye=te===0?Ie:te===1?Ue:((ne*te+se)*te+Me)*te+Ie,ge=te===0?Ee:te===1?dt:((de*te+ie)*te+$)*te+Ee;else{var Pe=1e-8,Fe=1-Pe;if(te<Pe?(ye=Me,ge=$):te>Fe?(ye=3*(Ue-He),ge=3*(dt-Ze)):(ye=(3*ne*te+2*se)*te+Me,ge=(3*de*te+2*ie)*te+$),ve){ye===0&&ge===0&&(te<Pe||te>Fe)&&(ye=He-ze,ge=Ze-Qe);var Ve=Math.sqrt(ye*ye+ge*ge);Ve&&(ye/=Ve,ge/=Ve)}if(fe===3){var He=6*ne*te+2*se,Ze=6*de*te+2*ie,Xe=Math.pow(ye*ye+ge*ge,3/2);ye=Xe!==0?(ye*Ze-ge*He)/Xe:0,ge=0}}return fe===2?new be(ge,-ye):new be(ye,ge)}return{statics:{classify:function(Y){var te=Y[0],fe=Y[1],ve=Y[2],Ie=Y[3],Ee=Y[4],ze=Y[5],Qe=Y[6],He=Y[7],Ze=te*(He-ze)+fe*(Ee-Qe)+Qe*ze-He*Ee,Ue=ve*(fe-He)+Ie*(Qe-te)+te*He-fe*Qe,dt=Ee*(Ie-fe)+ze*(te-ve)+ve*fe-Ie*te,rt=3*dt,Me=rt-Ue,se=Me-Ue+Ze,ne=Math.sqrt(se*se+Me*Me+rt*rt),$=ne!==0?1/ne:0,ie=ae.isZero,de="serpentine";se*=$,Me*=$,rt*=$;function ye(Ve,Xe,Ke){var De=Xe!==n,Ge=De&&Xe>0&&Xe<1,At=De&&Ke>0&&Ke<1;return De&&(!(Ge||At)||Ve==="loop"&&!(Ge&&At))&&(Ve="arch",Ge=At=!1),{type:Ve,roots:Ge||At?Ge&&At?Xe<Ke?[Xe,Ke]:[Ke,Xe]:[Ge?Xe:Ke]:null}}if(ie(se))return ie(Me)?ye(ie(rt)?"line":"quadratic"):ye(de,rt/(3*Me));var ge=3*Me*Me-4*se*rt;if(ie(ge))return ye("cusp",Me/(2*se));var Pe=ge>0?Math.sqrt(ge/3):Math.sqrt(-ge),Fe=2*se;return ye(ge>0?de:"loop",(Me+Pe)/Fe,(Me-Pe)/Fe)},getLength:function(Y,te,fe,ve){if(te===n&&(te=0),fe===n&&(fe=1),ut.isStraight(Y)){var Ie=Y;fe<1&&(Ie=ut.subdivide(Ie,fe)[0],te/=fe),te>0&&(Ie=ut.subdivide(Ie,te)[1]);var Ee=Ie[6]-Ie[0],ze=Ie[7]-Ie[1];return Math.sqrt(Ee*Ee+ze*ze)}return ae.integrate(ve||v(Y),te,fe,k(te,fe))},getTimeAt:function(Y,te,fe){if(fe===n&&(fe=te<0?1:0),te===0)return fe;var ve=Math.abs,Ie=1e-12,Ee=te>0,ze=Ee?fe:0,Qe=Ee?1:fe,He=v(Y),Ze=ut.getLength(Y,ze,Qe,He),Ue=ve(te)-Ze;if(ve(Ue)<Ie)return Ee?Qe:ze;if(Ue>Ie)return null;var dt=te/Ze,rt=0;function Me(se){return rt+=ae.integrate(He,fe,se,k(fe,se)),fe=se,rt-te}return ae.findRoot(Me,He,fe+dt,ze,Qe,32,1e-12)},getPoint:function(Y,te){return V(Y,te,0,!1)},getTangent:function(Y,te){return V(Y,te,1,!0)},getWeightedTangent:function(Y,te){return V(Y,te,1,!1)},getNormal:function(Y,te){return V(Y,te,2,!0)},getWeightedNormal:function(Y,te){return V(Y,te,2,!1)},getCurvature:function(Y,te){return V(Y,te,3,!1).x},getPeaks:function(Y){var te=Y[0],fe=Y[1],ve=Y[2],Ie=Y[3],Ee=Y[4],ze=Y[5],Qe=Y[6],He=Y[7],Ze=-te+3*ve-3*Ee+Qe,Ue=3*te-6*ve+3*Ee,dt=-3*te+3*ve,rt=-fe+3*Ie-3*ze+He,Me=3*fe-6*Ie+3*ze,se=-3*fe+3*Ie,ne=1e-8,$=1-ne,ie=[];return ae.solveCubic(9*(Ze*Ze+rt*rt),9*(Ze*Ue+Me*rt),2*(Ue*Ue+Me*Me)+3*(dt*Ze+se*rt),dt*Ue+Me*se,ie,ne,$),ie.sort()}}}},new function(){function v(Ue,dt,rt,Me,se,ne,$){var ie=!$&&rt.getPrevious()===se,de=!$&&rt!==se&&rt.getNext()===se,ye=1e-8,ge=1-ye;if(Me!==null&&Me>=(ie?ye:0)&&Me<=(de?ge:1)&&ne!==null&&ne>=(de?ye:0)&&ne<=(ie?ge:1)){var Pe=new Nt(rt,Me,null,$),Fe=new Nt(se,ne,null,$);Pe._intersection=Fe,Fe._intersection=Pe,(!dt||dt(Pe))&&Nt.insert(Ue,Pe,!0)}}function k(Ue,dt,rt,Me,se,ne,$,ie,de,ye,ge,Pe,Fe){if(++de>=4096||++ie>=40)return de;var Ve=1e-9,Xe=dt[0],Ke=dt[1],De=dt[6],Ge=dt[7],At=zt.getSignedDistance,kt=At(Xe,Ke,De,Ge,dt[2],dt[3]),o=At(Xe,Ke,De,Ge,dt[4],dt[5]),ke=kt*o>0?3/4:4/9,oi=ke*Math.min(0,kt,o),fi=ke*Math.max(0,kt,o),Ai=At(Xe,Ke,De,Ge,Ue[0],Ue[1]),ti=At(Xe,Ke,De,Ge,Ue[2],Ue[3]),li=At(Xe,Ke,De,Ge,Ue[4],Ue[5]),Bi=At(Xe,Ke,De,Ge,Ue[6],Ue[7]),vi=V(Ai,ti,li,Bi),bi=vi[0],Jt=vi[1],wn,ar;if(kt===0&&o===0&&Ai===0&&ti===0&&li===0&&Bi===0||(wn=Y(bi,Jt,oi,fi))==null||(ar=Y(bi.reverse(),Jt.reverse(),oi,fi))==null)return de;var mn=ye+(ge-ye)*wn,Hn=ye+(ge-ye)*ar;if(Math.max(Fe-Pe,Hn-mn)<Ve){var jr=(mn+Hn)/2,ji=(Pe+Fe)/2;v(se,ne,$?Me:rt,$?ji:jr,$?rt:Me,$?jr:ji)}else{Ue=ut.getPart(Ue,wn,ar);var ur=Fe-Pe;if(ar-wn>.8)if(Hn-mn>ur){var Vn=ut.subdivide(Ue,.5),jr=(mn+Hn)/2;de=k(dt,Vn[0],Me,rt,se,ne,!$,ie,de,Pe,Fe,mn,jr),de=k(dt,Vn[1],Me,rt,se,ne,!$,ie,de,Pe,Fe,jr,Hn)}else{var Vn=ut.subdivide(dt,.5),ji=(Pe+Fe)/2;de=k(Vn[0],Ue,Me,rt,se,ne,!$,ie,de,Pe,ji,mn,Hn),de=k(Vn[1],Ue,Me,rt,se,ne,!$,ie,de,ji,Fe,mn,Hn)}else ur===0||ur>=Ve?de=k(dt,Ue,Me,rt,se,ne,!$,ie,de,Pe,Fe,mn,Hn):de=k(Ue,dt,rt,Me,se,ne,$,ie,de,mn,Hn,Pe,Fe)}return de}function V(Ue,dt,rt,Me){var se=[0,Ue],ne=[1/3,dt],$=[2/3,rt],ie=[1,Me],de=dt-(2*Ue+Me)/3,ye=rt-(Ue+2*Me)/3,ge;if(de*ye<0)ge=[[se,ne,ie],[se,$,ie]];else{var Pe=de/ye;ge=[Pe>=2?[se,ne,ie]:Pe<=.5?[se,$,ie]:[se,ne,$,ie],[se,ie]]}return(de||ye)<0?ge.reverse():ge}function Y(Ue,dt,rt,Me){return Ue[0][1]<rt?te(Ue,!0,rt):dt[0][1]>Me?te(dt,!1,Me):Ue[0][0]}function te(Ue,dt,rt){for(var Me=Ue[0][0],se=Ue[0][1],ne=1,$=Ue.length;ne<$;ne++){var ie=Ue[ne][0],de=Ue[ne][1];if(dt?de>=rt:de<=rt)return de===rt?ie:Me+(rt-se)*(ie-Me)/(de-se);Me=ie,se=de}return null}function fe(Ue,dt,rt,Me,se){var ne=ae.isZero;if(ne(Me)&&ne(se)){var $=ut.getTimeOf(Ue,new be(dt,rt));return $===null?[]:[$]}for(var ie=Math.atan2(-se,Me),de=Math.sin(ie),ye=Math.cos(ie),ge=[],Pe=[],Fe=0;Fe<8;Fe+=2){var Ve=Ue[Fe]-dt,Xe=Ue[Fe+1]-rt;ge.push(Ve*ye-Xe*de,Ve*de+Xe*ye)}return ut.solveCubic(ge,1,0,Pe,0,1),Pe}function ve(Ue,dt,rt,Me,se,ne,$){for(var ie=dt[0],de=dt[1],ye=dt[6],ge=dt[7],Pe=fe(Ue,ie,de,ye-ie,ge-de),Fe=0,Ve=Pe.length;Fe<Ve;Fe++){var Xe=Pe[Fe],Ke=ut.getPoint(Ue,Xe),De=ut.getTimeOf(dt,Ke);De!==null&&v(se,ne,$?Me:rt,$?De:Xe,$?rt:Me,$?Xe:De)}}function Ie(Ue,dt,rt,Me,se,ne){var $=zt.intersect(Ue[0],Ue[1],Ue[6],Ue[7],dt[0],dt[1],dt[6],dt[7]);$&&v(se,ne,rt,ut.getTimeOf(Ue,$),Me,ut.getTimeOf(dt,$))}function Ee(Ue,dt,rt,Me,se,ne){var $=1e-12,ie=Math.min,de=Math.max;if(de(Ue[0],Ue[2],Ue[4],Ue[6])+$>ie(dt[0],dt[2],dt[4],dt[6])&&ie(Ue[0],Ue[2],Ue[4],Ue[6])-$<de(dt[0],dt[2],dt[4],dt[6])&&de(Ue[1],Ue[3],Ue[5],Ue[7])+$>ie(dt[1],dt[3],dt[5],dt[7])&&ie(Ue[1],Ue[3],Ue[5],Ue[7])-$<de(dt[1],dt[3],dt[5],dt[7])){var ye=He(Ue,dt);if(ye)for(var ge=0;ge<2;ge++){var Pe=ye[ge];v(se,ne,rt,Pe[0],Me,Pe[1],!0)}else{var Fe=ut.isStraight(Ue),Ve=ut.isStraight(dt),Xe=Fe&&Ve,Ke=Fe&&!Ve,De=se.length;if((Xe?Ie:Fe||Ve?ve:k)(Ke?dt:Ue,Ke?Ue:dt,Ke?Me:rt,Ke?rt:Me,se,ne,Ke,0,0,0,1,0,1),!Xe||se.length===De)for(var ge=0;ge<4;ge++){var Ge=ge>>1,At=ge&1,kt=Ge*6,o=At*6,ke=new be(Ue[kt],Ue[kt+1]),oi=new be(dt[o],dt[o+1]);ke.isClose(oi,$)&&v(se,ne,rt,Ge,Me,At)}}}return se}function ze(Ue,dt,rt,Me){var se=ut.classify(Ue);if(se.type==="loop"){var ne=se.roots;v(rt,Me,dt,ne[0],dt,ne[1])}return rt}function Qe(Ue,dt,rt,Me,se,ne){var $=1e-7,ie=!dt;ie&&(dt=Ue);for(var de=Ue.length,ye=dt.length,ge=new Array(de),Pe=ie?ge:new Array(ye),Fe=[],Ve=0;Ve<de;Ve++)ge[Ve]=Ue[Ve].getValues(Me);if(!ie)for(var Ve=0;Ve<ye;Ve++)Pe[Ve]=dt[Ve].getValues(se);for(var Xe=W.findCurveBoundsCollisions(ge,Pe,$),Ke=0;Ke<de;Ke++){var De=Ue[Ke],Ge=ge[Ke];ie&&ze(Ge,De,Fe,rt);var At=Xe[Ke];if(At)for(var kt=0;kt<At.length;kt++){if(ne&&Fe.length)return Fe;var o=At[kt];if(!ie||o>Ke){var ke=dt[o],oi=Pe[o];Ee(Ge,oi,De,ke,Fe,rt)}}}return Fe}function He(Ue,dt){function rt(Bi){var vi=Bi[6]-Bi[0],bi=Bi[7]-Bi[1];return vi*vi+bi*bi}var Me=Math.abs,se=zt.getDistance,ne=1e-8,$=1e-7,ie=ut.isStraight(Ue),de=ut.isStraight(dt),ye=ie&&de,ge=rt(Ue)<rt(dt),Pe=ge?dt:Ue,Fe=ge?Ue:dt,Ve=Pe[0],Xe=Pe[1],Ke=Pe[6]-Ve,De=Pe[7]-Xe;if(se(Ve,Xe,Ke,De,Fe[0],Fe[1],!0)<$&&se(Ve,Xe,Ke,De,Fe[6],Fe[7],!0)<$)!ye&&se(Ve,Xe,Ke,De,Pe[2],Pe[3],!0)<$&&se(Ve,Xe,Ke,De,Pe[4],Pe[5],!0)<$&&se(Ve,Xe,Ke,De,Fe[2],Fe[3],!0)<$&&se(Ve,Xe,Ke,De,Fe[4],Fe[5],!0)<$&&(ie=de=ye=!0);else if(ye)return null;if(ie^de)return null;for(var Ge=[Ue,dt],At=[],kt=0;kt<4&&At.length<2;kt++){var o=kt&1,ke=o^1,oi=kt>>1,fi=ut.getTimeOf(Ge[o],new be(Ge[ke][oi?6:0],Ge[ke][oi?7:1]));if(fi!=null){var Ai=o?[oi,fi]:[fi,oi];(!At.length||Me(Ai[0]-At[0][0])>ne&&Me(Ai[1]-At[0][1])>ne)&&At.push(Ai)}if(kt>2&&!At.length)break}if(At.length!==2)At=null;else if(!ye){var ti=ut.getPart(Ue,At[0][0],At[1][0]),li=ut.getPart(dt,At[0][1],At[1][1]);(Me(li[2]-ti[2])>$||Me(li[3]-ti[3])>$||Me(li[4]-ti[4])>$||Me(li[5]-ti[5])>$)&&(At=null)}return At}function Ze(Ue,dt){var rt=Ue[0],Me=Ue[1],se=Ue[2],ne=Ue[3],$=Ue[4],ie=Ue[5],de=Ue[6],ye=Ue[7],ge=dt.normalize(),Pe=ge.x,Fe=ge.y,Ve=3*de-9*$+9*se-3*rt,Xe=3*ye-9*ie+9*ne-3*Me,Ke=6*$-12*se+6*rt,De=6*ie-12*ne+6*Me,Ge=3*se-3*rt,At=3*ne-3*Me,kt=2*Ve*Fe-2*Xe*Pe,o=[];if(Math.abs(kt)<ae.CURVETIME_EPSILON){var ke=Ve*At-Xe*Ge,kt=Ve*De-Xe*Ke;if(kt!=0){var oi=-ke/kt;oi>=0&&oi<=1&&o.push(oi)}}else{var fi=(Ke*Ke-4*Ve*Ge)*Fe*Fe+(-2*Ke*De+4*Xe*Ge+4*Ve*At)*Pe*Fe+(De*De-4*Xe*At)*Pe*Pe,Ai=Ke*Fe-De*Pe;if(fi>=0&&kt!=0){var ti=Math.sqrt(fi),li=-(Ai+ti)/kt,Bi=(-Ai+ti)/kt;li>=0&&li<=1&&o.push(li),Bi>=0&&Bi<=1&&o.push(Bi)}}return o}return{getIntersections:function(Ue){var dt=this.getValues(),rt=Ue&&Ue!==this&&Ue.getValues();return rt?Ee(dt,rt,this,Ue,[]):ze(dt,this,[])},statics:{getOverlaps:He,getIntersections:Qe,getCurveLineIntersections:fe,getTimesWithTangent:Ze}}}),Nt=x.extend({_class:"CurveLocation",initialize:function(k,V,Y,te,fe){if(V>=.99999999){var ve=k.getNext();ve&&(V=0,k=ve)}this._setCurve(k),this._time=V,this._point=Y||k.getPointAtTime(V),this._overlap=te,this._distance=fe,this._intersection=this._next=this._previous=null},_setPath:function(v){this._path=v,this._version=v?v._version:0},_setCurve:function(v){this._setPath(v._path),this._curve=v,this._segment=null,this._segment1=v._segment1,this._segment2=v._segment2},_setSegment:function(v){var k=v.getCurve();k?this._setCurve(k):(this._setPath(v._path),this._segment1=v,this._segment2=null),this._segment=v,this._time=v===this._segment1?0:1,this._point=v._point.clone()},getSegment:function(){var v=this._segment;if(!v){var k=this.getCurve(),V=this.getTime();V===0?v=k._segment1:V===1?v=k._segment2:V!=null&&(v=k.getPartLength(0,V)<k.getPartLength(V,1)?k._segment1:k._segment2),this._segment=v}return v},getCurve:function(){var v=this._path,k=this;v&&v._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null);function V(Y){var te=Y&&Y.getCurve();if(te&&(k._time=te.getTimeOf(k._point))!=null)return k._setCurve(te),te}return this._curve||V(this._segment)||V(this._segment1)||V(this._segment2.getPrevious())},getPath:function(){var v=this.getCurve();return v&&v._path},getIndex:function(){var v=this.getCurve();return v&&v.getIndex()},getTime:function(){var v=this.getCurve(),k=this._time;return v&&k==null?this._time=v.getTimeOf(this._point):k},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var v=this._offset;if(v==null){v=0;var k=this.getPath(),V=this.getIndex();if(k&&V!=null)for(var Y=k.getCurves(),te=0;te<V;te++)v+=Y[te].getLength();this._offset=v+=this.getCurveOffset()}return v},getCurveOffset:function(){var v=this._curveOffset;if(v==null){var k=this.getCurve(),V=this.getTime();this._curveOffset=v=V!=null&&k&&k.getPartLength(0,V)}return v},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var v=this.getCurve(),k=v&&v.divideAtTime(this.getTime());return k&&this._setSegment(k._segment1),k},split:function(){var v=this.getCurve(),k=v._path,V=v&&v.splitAtTime(this.getTime());return V&&this._setSegment(k.getLastSegment()),V},equals:function(v,k){var V=this===v;if(!V&&v instanceof Nt){var Y=this.getCurve(),te=v.getCurve(),fe=Y._path,ve=te._path;if(fe===ve){var Ie=Math.abs,Ee=1e-7,ze=Ie(this.getOffset()-v.getOffset()),Qe=!k&&this._intersection,He=!k&&v._intersection;V=(ze<Ee||fe&&Ie(fe.getLength()-ze)<Ee)&&(!Qe&&!He||Qe&&He&&Qe.equals(He,!0))}}return V},toString:function(){var v=[],k=this.getPoint(),V=he.instance;k&&v.push("point: "+k);var Y=this.getIndex();Y!=null&&v.push("index: "+Y);var te=this.getTime();return te!=null&&v.push("time: "+V.number(te)),this._distance!=null&&v.push("distance: "+V.number(this._distance)),"{ "+v.join(", ")+" }"},isTouching:function(){var v=this._intersection;if(v&&this.getTangent().isCollinear(v.getTangent())){var k=this.getCurve(),V=v.getCurve();return!(k.isStraight()&&V.isStraight()&&k.getLine().intersect(V.getLine()))}return!1},isCrossing:function(){var v=this._intersection;if(!v)return!1;var k=this.getTime(),V=v.getTime(),Y=1e-8,te=1-Y,fe=k>=Y&&k<=te,ve=V>=Y&&V<=te;if(fe&&ve)return!this.isTouching();var Ie=this.getCurve(),Ee=Ie&&k<Y?Ie.getPrevious():Ie,ze=v.getCurve(),Qe=ze&&V<Y?ze.getPrevious():ze;if(k>te&&(Ie=Ie.getNext()),V>te&&(ze=ze.getNext()),!Ee||!Ie||!Qe||!ze)return!1;var He=[];function Ze(Pe,Fe){var Ve=Pe.getValues(),Xe=ut.classify(Ve).roots||ut.getPeaks(Ve),Ke=Xe.length,De=ut.getLength(Ve,Fe&&Ke?Xe[Ke-1]:0,!Fe&&Ke?Xe[0]:1);He.push(Ke?De:De/32)}function Ue(Pe,Fe,Ve){return Fe<Ve?Pe>Fe&&Pe<Ve:Pe>Fe||Pe<Ve}fe||(Ze(Ee,!0),Ze(Ie,!1)),ve||(Ze(Qe,!0),Ze(ze,!1));var dt=this.getPoint(),rt=Math.min.apply(Math,He),Me=fe?Ie.getTangentAtTime(k):Ie.getPointAt(rt).subtract(dt),se=fe?Me.negate():Ee.getPointAt(-rt).subtract(dt),ne=ve?ze.getTangentAtTime(V):ze.getPointAt(rt).subtract(dt),$=ve?ne.negate():Qe.getPointAt(-rt).subtract(dt),ie=se.getAngle(),de=Me.getAngle(),ye=$.getAngle(),ge=ne.getAngle();return!!(fe?Ue(ie,ye,ge)^Ue(de,ye,ge)&&Ue(ie,ge,ye)^Ue(de,ge,ye):Ue(ye,ie,de)^Ue(ge,ie,de)&&Ue(ye,de,ie)^Ue(ge,de,ie))},hasOverlap:function(){return!!this._overlap}},x.each(ut._evaluateMethods,function(v){var k=v+"At";this[v]=function(){var V=this.getCurve(),Y=this.getTime();return Y!=null&&V&&V[k](Y,!0)}},{preserve:!0}),new function(){function v(k,V,Y){var te=k.length,fe=0,ve=te-1;function Ie(dt,rt){for(var Me=dt+rt;Me>=-1&&Me<=te;Me+=rt){var se=k[(Me%te+te)%te];if(!V.getPoint().isClose(se.getPoint(),1e-7))break;if(V.equals(se))return se}return null}for(;fe<=ve;){var Ee=fe+ve>>>1,ze=k[Ee],Qe;if(Y&&(Qe=V.equals(ze)?ze:Ie(Ee,-1)||Ie(Ee,1)))return V._overlap&&(Qe._overlap=Qe._intersection._overlap=!0),Qe;var He=V.getPath(),Ze=ze.getPath(),Ue=He!==Ze?He._id-Ze._id:V.getIndex()+V.getTime()-(ze.getIndex()+ze.getTime());Ue<0?ve=Ee-1:fe=Ee+1}return k.splice(fe,0,V),V}return{statics:{insert:v,expand:function(k){for(var V=k.slice(),Y=k.length-1;Y>=0;Y--)v(V,k[Y]._intersection,!1);return V}}}}),Bt=Oe.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(v){var k,V,Y;if(x.isPlainObject(v)?(V=v.segments,k=v.pathData):Array.isArray(v)?V=v:typeof v=="string"&&(k=v),V){var te=V[0];Y=te&&Array.isArray(te[0])}else k&&(Y=(k.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(k));var fe=Y?gi:Ot;return new fe(v)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(v){this.isClockwise()!=(v=!!v)&&this.reverse()},setPathData:function(v){var k=v&&v.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),V,Y=!1,te,fe,ve=new be,Ie=new be;function Ee($,ie){var de=+V[$];return Y&&(de+=ve[ie]),de}function ze($){return new be(Ee($,"x"),Ee($+1,"y"))}this.clear();for(var Qe=0,He=k&&k.length;Qe<He;Qe++){var Ze=k[Qe],Ue=Ze[0],dt=Ue.toLowerCase();V=Ze.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var rt=V&&V.length;switch(Y=Ue===dt,te==="z"&&!/[mz]/.test(dt)&&this.moveTo(ve),dt){case"m":case"l":for(var Me=dt==="m",se=0;se<rt;se+=2)this[Me?"moveTo":"lineTo"](ve=ze(se)),Me&&(Ie=ve,Me=!1);fe=ve;break;case"h":case"v":var ne=dt==="h"?"x":"y";ve=ve.clone();for(var se=0;se<rt;se++)ve[ne]=Ee(se,ne),this.lineTo(ve);fe=ve;break;case"c":for(var se=0;se<rt;se+=6)this.cubicCurveTo(ze(se),fe=ze(se+2),ve=ze(se+4));break;case"s":for(var se=0;se<rt;se+=4)this.cubicCurveTo(/[cs]/.test(te)?ve.multiply(2).subtract(fe):ve,fe=ze(se),ve=ze(se+2)),te=dt;break;case"q":for(var se=0;se<rt;se+=4)this.quadraticCurveTo(fe=ze(se),ve=ze(se+2));break;case"t":for(var se=0;se<rt;se+=2)this.quadraticCurveTo(fe=/[qt]/.test(te)?ve.multiply(2).subtract(fe):ve,ve=ze(se)),te=dt;break;case"a":for(var se=0;se<rt;se+=7)this.arcTo(ve=ze(se+5),new st(+V[se],+V[se+1]),+V[se+2],+V[se+4],+V[se+3]);break;case"z":this.closePath(1e-12),ve=Ie;break}te=dt}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(v){var k=v.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(v):{};return k.onPath||!!(this.getFillRule()==="evenodd"?k.windingL&1||k.windingR&1:k.winding)},getIntersections:function(v,k,V,Y){var te=this===v||!v,fe=this._matrix._orNullIfIdentity(),ve=te?fe:(V||v._matrix)._orNullIfIdentity();return te||this.getBounds(fe).intersects(v.getBounds(ve),1e-12)?ut.getIntersections(this.getCurves(),!te&&v.getCurves(),k,fe,ve,Y):[]},getCrossings:function(v){return this.getIntersections(v,function(k){return k.isCrossing()})},getNearestLocation:function(){for(var v=be.read(arguments),k=this.getCurves(),V=1/0,Y=null,te=0,fe=k.length;te<fe;te++){var ve=k[te].getNearestLocation(v);ve._distance<V&&(V=ve._distance,Y=ve)}return Y},getNearestPoint:function(){var v=this.getNearestLocation.apply(this,arguments);return v&&v.getPoint()},interpolate:function(v,k,V){var Y=!this._children,te=Y?"_segments":"_children",fe=v[te],ve=k[te],Ie=this[te];if(!fe||!ve||fe.length!==ve.length)throw new Error("Invalid operands in interpolate() call: "+v+", "+k);var Ee=Ie.length,ze=ve.length;if(Ee<ze)for(var Qe=Y?$e:Ot,He=Ee;He<ze;He++)this.add(new Qe);else Ee>ze&&this[Y?"removeSegments":"removeChildren"](ze,Ee);for(var He=0;He<ze;He++)Ie[He].interpolate(fe[He],ve[He],V);Y&&(this.setClosed(v._closed),this._changed(9))},compare:function(v){var k=!1;if(v){var V=this._children||[this],Y=v._children?v._children.slice():[v],te=V.length,fe=Y.length,ve=[],Ie=0;k=!0;for(var Ee=W.findItemBoundsCollisions(V,Y,ae.GEOMETRIC_EPSILON),ze=te-1;ze>=0&&k;ze--){var Qe=V[ze];k=!1;var He=Ee[ze];if(He)for(var Ze=He.length-1;Ze>=0&&!k;Ze--)Qe.compare(Y[He[Ze]])&&(ve[He[Ze]]||(ve[He[Ze]]=!0,Ie++),k=!0)}k=k&&Ie===fe}return k}}),Ot=Bt.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(k){this._closed=!1,this._segments=[],this._version=0;var V=arguments,Y=Array.isArray(k)?typeof k[0]=="object"?k:V:k&&k.size===n&&(k.x!==n||k.point!==n)?V:null;Y&&Y.length>0?this.setSegments(Y):(this._curves=n,this._segmentSelection=0,!Y&&typeof k=="string"&&(this.setPathData(k),k=null)),this._initialize(!Y&&k)},_equals:function(v){return this._closed===v._closed&&x.equals(this._segments,v._segments)},copyContent:function(v){this.setSegments(v._segments),this._closed=v._closed},_changed:function v(k){if(v.base.call(this,k),k&8){if(this._length=this._area=n,k&32)this._version++;else if(this._curves)for(var V=0,Y=this._curves.length;V<Y;V++)this._curves[V]._changed()}else k&64&&(this._bounds=n)},getStyle:function(){var v=this._parent;return(v instanceof gi?v:this)._style},getSegments:function(){return this._segments},setSegments:function(v){var k=this.isFullySelected(),V=v&&v.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=n,V){var Y=v[V-1];typeof Y=="boolean"&&(this.setClosed(Y),V--),this._add($e.readList(v,0,{},V))}k&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var v=this._curves,k=this._segments;if(!v){var V=this._countCurves();v=this._curves=new Array(V);for(var Y=0;Y<V;Y++)v[Y]=new ut(this,k[Y],k[Y+1]||k[0])}return v},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var v=this.getCurves();return v[v.length-1]},isClosed:function(){return this._closed},setClosed:function(v){if(this._closed!=(v=!!v)){if(this._closed=v,this._curves){var k=this._curves.length=this._countCurves();v&&(this._curves[k-1]=new ut(this,this._segments[k-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(v,k){var V=this._segments,Y=V.length,te=new he(k),fe=new Array(6),ve=!0,Ie,Ee,ze,Qe,He,Ze,Ue,dt,rt=[];function Me(ne,$){if(ne._transformCoordinates(v,fe),Ie=fe[0],Ee=fe[1],ve)rt.push("M"+te.pair(Ie,Ee)),ve=!1;else if(He=fe[2],Ze=fe[3],He===Ie&&Ze===Ee&&Ue===ze&&dt===Qe){if(!$){var ie=Ie-ze,de=Ee-Qe;rt.push(ie===0?"v"+te.number(de):de===0?"h"+te.number(ie):"l"+te.pair(ie,de))}}else rt.push("c"+te.pair(Ue-ze,dt-Qe)+" "+te.pair(He-ze,Ze-Qe)+" "+te.pair(Ie-ze,Ee-Qe));ze=Ie,Qe=Ee,Ue=fe[4],dt=fe[5]}if(!Y)return"";for(var se=0;se<Y;se++)Me(V[se]);return this._closed&&Y>0&&(Me(V[0],!0),rt.push("z")),rt.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(v){for(var k=this._segments,V=new Array(6),Y=0,te=k.length;Y<te;Y++)k[Y]._transformCoordinates(v,V,!0);return!0},_add:function(v,ve){for(var V=this._segments,Y=this._curves,te=v.length,fe=ve==null,ve=fe?V.length:ve,Ie=0;Ie<te;Ie++){var Ee=v[Ie];Ee._path&&(Ee=v[Ie]=Ee.clone()),Ee._path=this,Ee._index=ve+Ie,Ee._selection&&this._updateSelection(Ee,0,Ee._selection)}if(fe)x.push(V,v);else{V.splice.apply(V,[ve,0].concat(v));for(var Ie=ve+te,ze=V.length;Ie<ze;Ie++)V[Ie]._index=Ie}if(Y){var Qe=this._countCurves(),He=ve>0&&ve+te-1===Qe?ve-1:ve,Ze=He,Ue=Math.min(He+te,Qe);v._curves&&(Y.splice.apply(Y,[He,0].concat(v._curves)),Ze+=v._curves.length);for(var Ie=Ze;Ie<Ue;Ie++)Y.splice(Ie,0,new ut(this,null,null));this._adjustCurves(He,Ue)}return this._changed(41),v},_adjustCurves:function(v,k){for(var V=this._segments,Y=this._curves,te,fe=v;fe<k;fe++)te=Y[fe],te._path=this,te._segment1=V[fe],te._segment2=V[fe+1]||V[0],te._changed();(te=Y[this._closed&&!v?V.length-1:v-1])&&(te._segment2=V[v]||V[0],te._changed()),(te=Y[k])&&(te._segment1=V[k],te._changed())},_countCurves:function(){var v=this._segments.length;return!this._closed&&v>0?v-1:v},add:function(v){var k=arguments;return k.length>1&&typeof v!="number"?this._add($e.readList(k)):this._add([$e.read(k)])[0]},insert:function(v,k){var V=arguments;return V.length>2&&typeof k!="number"?this._add($e.readList(V,1),v):this._add([$e.read(V,1)],v)[0]},addSegment:function(){return this._add([$e.read(arguments)])[0]},insertSegment:function(v){return this._add([$e.read(arguments,1)],v)[0]},addSegments:function(v){return this._add($e.readList(v))},insertSegments:function(v,k){return this._add($e.readList(k),v)},removeSegment:function(v){return this.removeSegments(v,v+1)[0]||null},removeSegments:function(v,k,V){v=v||0,k=x.pick(k,this._segments.length);var Y=this._segments,te=this._curves,fe=Y.length,ve=Y.splice(v,k-v),Ie=ve.length;if(!Ie)return ve;for(var Ee=0;Ee<Ie;Ee++){var ze=ve[Ee];ze._selection&&this._updateSelection(ze,ze._selection,0),ze._index=ze._path=null}for(var Ee=v,Qe=Y.length;Ee<Qe;Ee++)Y[Ee]._index=Ee;if(te){for(var He=v>0&&k===fe+(this._closed?1:0)?v-1:v,te=te.splice(He,Ie),Ee=te.length-1;Ee>=0;Ee--)te[Ee]._path=null;V&&(ve._curves=te.slice(1)),this._adjustCurves(He,He)}return this._changed(41),ve},clear:"#removeSegments",hasHandles:function(){for(var v=this._segments,k=0,V=v.length;k<V;k++)if(v[k].hasHandles())return!0;return!1},clearHandles:function(){for(var v=this._segments,k=0,V=v.length;k<V;k++)v[k].clearHandles()},getLength:function(){if(this._length==null){for(var v=this.getCurves(),k=0,V=0,Y=v.length;V<Y;V++)k+=v[V].getLength();this._length=k}return this._length},getArea:function(){var v=this._area;if(v==null){var k=this._segments,V=this._closed;v=0;for(var Y=0,te=k.length;Y<te;Y++){var fe=Y+1===te;v+=ut.getArea(ut.getValues(k[Y],k[fe?0:Y+1],null,fe&&!V))}this._area=v}return v},isFullySelected:function(){var v=this._segments.length;return this.isSelected()&&v>0&&this._segmentSelection===v*7},setFullySelected:function(v){v&&this._selectSegments(!0),this.setSelected(v)},setSelection:function v(k){k&1||this._selectSegments(!1),v.base.call(this,k)},_selectSegments:function(v){var k=this._segments,V=k.length,Y=v?7:0;this._segmentSelection=Y*V;for(var te=0;te<V;te++)k[te]._selection=Y},_updateSelection:function(v,k,V){v._selection=V;var Y=this._segmentSelection+=V-k;Y>0&&this.setSelected(!0)},divideAt:function(v){var k=this.getLocationAt(v),V;return k&&(V=k.getCurve().divideAt(k.getCurveOffset()))?V._segment1:null},splitAt:function(v){var k=this.getLocationAt(v),V=k&&k.index,Y=k&&k.time,te=1e-8,fe=1-te;Y>fe&&(V++,Y=0);var ve=this.getCurves();if(V>=0&&V<ve.length){Y>=te&&ve[V++].divideAtTime(Y);var Ie=this.removeSegments(V,this._segments.length,!0),Ee;return this._closed?(this.setClosed(!1),Ee=this):(Ee=new Ot(Oe.NO_INSERT),Ee.insertAbove(this),Ee.copyAttributes(this)),Ee._add(Ie,0),this.addSegment(Ie[0]),Ee}return null},split:function(v,k){var V,Y=k===n?v:(V=this.getCurves()[v])&&V.getLocationAtTime(k);return Y!=null?this.splitAt(Y):null},join:function(v,k){var V=k||0;if(v&&v!==this){var Y=v._segments,te=this.getLastSegment(),fe=v.getLastSegment();if(!fe)return this;te&&te._point.isClose(fe._point,V)&&v.reverse();var ve=v.getFirstSegment();if(te&&te._point.isClose(ve._point,V))te.setHandleOut(ve._handleOut),this._add(Y.slice(1));else{var Ie=this.getFirstSegment();Ie&&Ie._point.isClose(ve._point,V)&&v.reverse(),fe=v.getLastSegment(),Ie&&Ie._point.isClose(fe._point,V)?(Ie.setHandleIn(fe._handleIn),this._add(Y.slice(0,Y.length-1),0)):this._add(Y.slice())}v._closed&&this._add([Y[0]]),v.remove()}var Ee=this.getFirstSegment(),ze=this.getLastSegment();return Ee!==ze&&Ee._point.isClose(ze._point,V)&&(Ee.setHandleIn(ze._handleIn),ze.remove(),this.setClosed(!0)),this},reduce:function(v){for(var k=this.getCurves(),V=v&&v.simplify,Y=V?1e-7:0,te=k.length-1;te>=0;te--){var fe=k[te];!fe.hasHandles()&&(!fe.hasLength(Y)||V&&fe.isCollinear(fe.getNext()))&&fe.remove()}return this},reverse:function(){this._segments.reverse();for(var v=0,k=this._segments.length;v<k;v++){var V=this._segments[v],Y=V._handleIn;V._handleIn=V._handleOut,V._handleOut=Y,V._index=v}this._curves=null,this._changed(9)},flatten:function(v){for(var k=new Ii(this,v||.25,256,!0),V=k.parts,Y=V.length,te=[],fe=0;fe<Y;fe++)te.push(new $e(V[fe].curve.slice(0,2)));!this._closed&&Y>0&&te.push(new $e(V[Y-1].curve.slice(6))),this.setSegments(te)},simplify:function(v){var k=new Ci(this).fit(v||2.5);return k&&this.setSegments(k),!!k},smooth:function(v){var k=this,V=v||{},Y=V.type||"asymmetric",te=this._segments,fe=te.length,ve=this._closed;function Ie(bi,Jt){var wn=bi&&bi.index;if(wn!=null){var ar=bi.path;if(ar&&ar!==k)throw new Error(bi._class+" "+wn+" of "+ar+" is not part of "+k);Jt&&bi instanceof ut&&wn++}else wn=typeof bi=="number"?bi:Jt;return Math.min(wn<0&&ve?wn%fe:wn<0?wn+fe:wn,fe-1)}var Ee=ve&&V.from===n&&V.to===n,ze=Ie(V.from,0),Qe=Ie(V.to,fe-1);if(ze>Qe)if(ve)ze-=fe;else{var He=ze;ze=Qe,Qe=He}if(/^(?:asymmetric|continuous)$/.test(Y)){var Ze=Y==="asymmetric",Ue=Math.min,dt=Qe-ze+1,rt=dt-1,Me=Ee?Ue(dt,4):1,se=Me,ne=Me,$=[];if(ve||(se=Ue(1,ze),ne=Ue(1,fe-Qe-1)),rt+=se+ne,rt<=1)return;for(var ie=0,de=ze-se;ie<=rt;ie++,de++)$[ie]=te[(de<0?de+fe:de)%fe]._point;for(var ye=$[0]._x+2*$[1]._x,ge=$[0]._y+2*$[1]._y,Pe=2,Fe=rt-1,Ve=[ye],Xe=[ge],Ke=[Pe],De=[],Ge=[],ie=1;ie<rt;ie++){var At=ie<Fe,kt=At||Ze?1:2,o=At?4:Ze?2:7,ke=At?4:Ze?3:8,oi=At?2:Ze?0:1,fi=kt/Pe;Pe=Ke[ie]=o-fi,ye=Ve[ie]=ke*$[ie]._x+oi*$[ie+1]._x-fi*ye,ge=Xe[ie]=ke*$[ie]._y+oi*$[ie+1]._y-fi*ge}De[Fe]=Ve[Fe]/Ke[Fe],Ge[Fe]=Xe[Fe]/Ke[Fe];for(var ie=rt-2;ie>=0;ie--)De[ie]=(Ve[ie]-De[ie+1])/Ke[ie],Ge[ie]=(Xe[ie]-Ge[ie+1])/Ke[ie];De[rt]=(3*$[rt]._x-De[Fe])/2,Ge[rt]=(3*$[rt]._y-Ge[Fe])/2;for(var ie=se,Ai=rt-ne,de=ze;ie<=Ai;ie++,de++){var ti=te[de<0?de+fe:de],li=ti._point,Bi=De[ie]-li._x,vi=Ge[ie]-li._y;(Ee||ie<Ai)&&ti.setHandleOut(Bi,vi),(Ee||ie>se)&&ti.setHandleIn(-Bi,-vi)}}else for(var ie=ze;ie<=Qe;ie++)te[ie<0?ie+fe:ie].smooth(V,!Ee&&ie===ze,!Ee&&ie===Qe)},toShape:function(v){if(!this._closed)return null;var k=this._segments,V,Y,te,fe;function ve(Ze,Ue){var dt=k[Ze],rt=dt.getNext(),Me=k[Ue],se=Me.getNext();return dt._handleOut.isZero()&&rt._handleIn.isZero()&&Me._handleOut.isZero()&&se._handleIn.isZero()&&rt._point.subtract(dt._point).isCollinear(se._point.subtract(Me._point))}function Ie(Ze){var Ue=k[Ze],dt=Ue.getPrevious(),rt=Ue.getNext();return dt._handleOut.isZero()&&Ue._handleIn.isZero()&&Ue._handleOut.isZero()&&rt._handleIn.isZero()&&Ue._point.subtract(dt._point).isOrthogonal(rt._point.subtract(Ue._point))}function Ee(Ze){var Ue=k[Ze],dt=Ue.getNext(),rt=Ue._handleOut,Me=dt._handleIn,se=.5522847498307936;if(rt.isOrthogonal(Me)){var ne=Ue._point,$=dt._point,ie=new zt(ne,rt,!0).intersect(new zt($,Me,!0),!0);return ie&&ae.isZero(rt.getLength()/ie.subtract(ne).getLength()-se)&&ae.isZero(Me.getLength()/ie.subtract($).getLength()-se)}return!1}function ze(Ze,Ue){return k[Ze]._point.getDistance(k[Ue]._point)}if(!this.hasHandles()&&k.length===4&&ve(0,2)&&ve(1,3)&&Ie(1)?(V=_t.Rectangle,Y=new st(ze(0,3),ze(0,1)),fe=k[1]._point.add(k[2]._point).divide(2)):k.length===8&&Ee(0)&&Ee(2)&&Ee(4)&&Ee(6)&&ve(1,5)&&ve(3,7)?(V=_t.Rectangle,Y=new st(ze(1,6),ze(0,3)),te=Y.subtract(new st(ze(0,7),ze(1,2))).divide(2),fe=k[3]._point.add(k[4]._point).divide(2)):k.length===4&&Ee(0)&&Ee(1)&&Ee(2)&&Ee(3)&&(ae.isZero(ze(0,2)-ze(1,3))?(V=_t.Circle,te=ze(0,2)/2):(V=_t.Ellipse,te=new st(ze(2,0)/2,ze(3,1)/2)),fe=k[1]._point),V){var Qe=this.getPosition(!0),He=new V({center:Qe,size:Y,radius:te,insert:!1});return He.copyAttributes(this,!0),He._matrix.prepend(this._matrix),He.rotate(fe.subtract(Qe).getAngle()+90),(v===n||v)&&He.insertAbove(this),He}return null},toPath:"#clone",compare:function v(k){if(!k||k instanceof gi)return v.base.call(this,k);var V=this.getCurves(),Y=k.getCurves(),te=V.length,fe=Y.length;if(!te||!fe)return te==fe;for(var ve=V[0].getValues(),Ie=[],Ee=0,ze,Qe=0,He,Ze=0;Ze<fe;Ze++){var Me=Y[Ze].getValues();Ie.push(Me);var Ue=ut.getOverlaps(ve,Me);if(Ue){ze=!Ze&&Ue[0][0]>0?fe-1:Ze,He=Ue[0][1];break}}for(var dt=Math.abs,rt=1e-8,Me=Ie[ze],se;ve&&Me;){var Ue=ut.getOverlaps(ve,Me);if(Ue){var ne=Ue[0][0];if(dt(ne-Qe)<rt){Qe=Ue[1][0],Qe===1&&(ve=++Ee<te?V[Ee].getValues():null,Qe=0);var $=Ue[0][1];if(dt($-He)<rt){if(se||(se=[ze,$]),He=Ue[1][1],He===1&&(++ze>=fe&&(ze=0),Me=Ie[ze]||Y[ze].getValues(),He=0),!ve)return se[0]===ze&&se[1]===He;continue}}}break}return!1},_hitTestSelf:function(v,k,V,Y){var te=this,fe=this.getStyle(),ve=this._segments,Ie=ve.length,Ee=this._closed,ze=k._tolerancePadding,Qe=ze,He,Ze,Ue,dt,rt,Me,se=k.stroke&&fe.hasStroke(),ne=k.fill&&fe.hasFill(),$=k.curves,ie=se?fe.getStrokeWidth()/2:ne&&k.tolerance>0||$?0:null;ie!==null&&(ie>0?(He=fe.getStrokeJoin(),Ze=fe.getStrokeCap(),Ue=fe.getMiterLimit(),Qe=Qe.add(Ot._getStrokePadding(ie,Y))):He=Ze="round");function de(De,Ge){return v.subtract(De).divide(Ge).length<=1}function ye(De,Ge,At){if(!k.selected||Ge.isSelected()){var kt=De._point;if(Ge!==kt&&(Ge=Ge.add(kt)),de(Ge,Qe))return new lt(At,te,{segment:De,point:Ge})}}function ge(De,Ge){return(Ge||k.segments)&&ye(De,De._point,"segment")||!Ge&&k.handles&&(ye(De,De._handleIn,"handle-in")||ye(De,De._handleOut,"handle-out"))}function Pe(De){dt.add(De)}function Fe(De){var Ge=Ee||De._index>0&&De._index<Ie-1;if((Ge?He:Ze)==="round")return de(De._point,Qe);if(dt=new Ot({internal:!0,closed:!0}),Ge?De.isSmooth()||Ot._addBevelJoin(De,He,ie,Ue,null,Y,Pe,!0):Ze==="square"&&Ot._addSquareCap(De,Ze,ie,null,Y,Pe,!0),!dt.isEmpty()){var At;return dt.contains(v)||(At=dt.getNearestLocation(v))&&de(At.getPoint(),ze)}}if(k.ends&&!k.segments&&!Ee){if(Me=ge(ve[0],!0)||ge(ve[Ie-1],!0))return Me}else if(k.segments||k.handles){for(var Ve=0;Ve<Ie;Ve++)if(Me=ge(ve[Ve]))return Me}if(ie!==null){if(rt=this.getNearestLocation(v),rt){var Xe=rt.getTime();Xe===0||Xe===1&&Ie>1?Fe(rt.getSegment())||(rt=null):de(rt.getPoint(),Qe)||(rt=null)}if(!rt&&He==="miter"&&Ie>1)for(var Ve=0;Ve<Ie;Ve++){var Ke=ve[Ve];if(v.getDistance(Ke._point)<=Ue*ie&&Fe(Ke)){rt=Ke.getLocation();break}}}return!rt&&ne&&this._contains(v)||rt&&!se&&!$?new lt("fill",this):rt?new lt(se?"stroke":"curve",this,{location:rt,point:rt.getPoint()}):null}},x.each(ut._evaluateMethods,function(v){this[v+"At"]=function(k){var V=this.getLocationAt(k);return V&&V[v]()}},{beans:!1,getLocationOf:function(){for(var v=be.read(arguments),k=this.getCurves(),V=0,Y=k.length;V<Y;V++){var te=k[V].getLocationOf(v);if(te)return te}return null},getOffsetOf:function(){var v=this.getLocationOf.apply(this,arguments);return v?v.getOffset():null},getLocationAt:function(v){if(typeof v=="number"){for(var k=this.getCurves(),V=0,Y=0,te=k.length;Y<te;Y++){var fe=V,ve=k[Y];if(V+=ve.getLength(),V>v)return ve.getLocationAt(v-fe)}if(k.length>0&&v<=this.getLength())return new Nt(k[k.length-1],1)}else if(v&&v.getPath&&v.getPath()===this)return v;return null},getOffsetsWithTangent:function(){var v=be.read(arguments);if(v.isZero())return[];for(var k=[],V=0,Y=this.getCurves(),te=0,fe=Y.length;te<fe;te++){for(var ve=Y[te],Ie=ve.getTimesWithTangent(v),Ee=0,ze=Ie.length;Ee<ze;Ee++){var Qe=V+ve.getOffsetAtTime(Ie[Ee]);k.indexOf(Qe)<0&&k.push(Qe)}V+=ve.length}return k}}),new function(){function v(V,Y,te,fe){if(fe<=0)return;var ve=fe/2,Ie=fe-2,Ee=ve-1,ze=new Array(6),Qe,He;function Ze(ne){var $=ze[ne],ie=ze[ne+1];(Qe!=$||He!=ie)&&(V.beginPath(),V.moveTo(Qe,He),V.lineTo($,ie),V.stroke(),V.beginPath(),V.arc($,ie,ve,0,Math.PI*2,!0),V.fill())}for(var Ue=0,dt=Y.length;Ue<dt;Ue++){var rt=Y[Ue],Me=rt._selection;if(rt._transformCoordinates(te,ze),Qe=ze[0],He=ze[1],Me&2&&Ze(2),Me&4&&Ze(4),V.fillRect(Qe-ve,He-ve,fe,fe),Ie>0&&!(Me&1)){var se=V.fillStyle;V.fillStyle="#ffffff",V.fillRect(Qe-Ee,He-Ee,Ie,Ie),V.fillStyle=se}}}function k(V,Y,te){var fe=Y._segments,ve=fe.length,Ie=new Array(6),Ee=!0,ze,Qe,He,Ze,Ue,dt,rt,Me;function se($){if(te)$._transformCoordinates(te,Ie),ze=Ie[0],Qe=Ie[1];else{var ie=$._point;ze=ie._x,Qe=ie._y}if(Ee)V.moveTo(ze,Qe),Ee=!1;else{if(te)Ue=Ie[2],dt=Ie[3];else{var de=$._handleIn;Ue=ze+de._x,dt=Qe+de._y}Ue===ze&&dt===Qe&&rt===He&&Me===Ze?V.lineTo(ze,Qe):V.bezierCurveTo(rt,Me,Ue,dt,ze,Qe)}if(He=ze,Ze=Qe,te)rt=Ie[4],Me=Ie[5];else{var de=$._handleOut;rt=He+de._x,Me=Ze+de._y}}for(var ne=0;ne<ve;ne++)se(fe[ne]);Y._closed&&ve>0&&se(fe[0])}return{_draw:function(V,Y,te,fe){var ve=Y.dontStart,Ie=Y.dontFinish||Y.clip,Ee=this.getStyle(),ze=Ee.hasFill(),Qe=Ee.hasStroke(),He=Ee.getDashArray(),Ze=!pn.support.nativeDash&&Qe&&He&&He.length;ve||V.beginPath(),(ze||Qe&&!Ze||Ie)&&(k(V,this,fe),this._closed&&V.closePath());function Ue($){return He[($%Ze+Ze)%Ze]}if(!Ie&&(ze||Qe)&&(this._setStyles(V,Y,te),ze&&(V.fill(Ee.getFillRule()),V.shadowColor="rgba(0,0,0,0)"),Qe)){if(Ze){ve||V.beginPath();for(var dt=new Ii(this,.25,32,!1,fe),rt=dt.length,Me=-Ee.getDashOffset(),se,ne=0;Me>0;)Me-=Ue(ne--)+Ue(ne--);for(;Me<rt;)se=Me+Ue(ne++),(Me>0||se>0)&&dt.drawPart(V,Math.max(Me,0),Math.max(se,0)),Me=se+Ue(ne++)}V.stroke()}},_drawSelected:function(V,Y){V.beginPath(),k(V,this,Y),V.stroke(),v(V,this._segments,Y,pn.settings.handleSize)}}},new function(){function v(k){var V=k._segments;if(!V.length)throw new Error("Use a moveTo() command first");return V[V.length-1]}return{moveTo:function(){var k=this._segments;k.length===1&&this.removeSegment(0),k.length||this._add([new $e(be.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new $e(be.read(arguments))])},cubicCurveTo:function(){var k=arguments,V=be.read(k),Y=be.read(k),te=be.read(k),fe=v(this);fe.setHandleOut(V.subtract(fe._point)),this._add([new $e(te,Y.subtract(te))])},quadraticCurveTo:function(){var k=arguments,V=be.read(k),Y=be.read(k),te=v(this)._point;this.cubicCurveTo(V.add(te.subtract(V).multiply(1/3)),V.add(Y.subtract(V).multiply(1/3)),Y)},curveTo:function(){var k=arguments,V=be.read(k),Y=be.read(k),te=x.pick(x.read(k),.5),fe=1-te,ve=v(this)._point,Ie=V.subtract(ve.multiply(fe*fe)).subtract(Y.multiply(te*te)).divide(2*te*fe);if(Ie.isNaN())throw new Error("Cannot put a curve through points with parameter = "+te);this.quadraticCurveTo(Ie,Y)},arcTo:function(){var k=arguments,V=Math.abs,Y=Math.sqrt,te=v(this),fe=te._point,ve=be.read(k),Ie,Ee=x.peek(k),ze=x.pick(Ee,!0),Qe,He,Ze,Ue;if(typeof ze=="boolean")var dt=fe.add(ve).divide(2),Ie=dt.add(dt.subtract(fe).rotate(ze?-90:90));else if(x.remain(k)<=2)Ie=ve,ve=be.read(k);else if(!fe.equals(ve)){var rt=st.read(k),Me=ae.isZero;if(Me(rt.width)||Me(rt.height))return this.lineTo(ve);var se=x.read(k),ze=!!x.read(k),ne=!!x.read(k),dt=fe.add(ve).divide(2),$=fe.subtract(dt).rotate(-se),ie=$.x,de=$.y,ye=V(rt.width),ge=V(rt.height),Pe=ye*ye,Fe=ge*ge,Ve=ie*ie,Xe=de*de,Ke=Y(Ve/Pe+Xe/Fe);if(Ke>1&&(ye*=Ke,ge*=Ke,Pe=ye*ye,Fe=ge*ge),Ke=(Pe*Fe-Pe*Xe-Fe*Ve)/(Pe*Xe+Fe*Ve),V(Ke)<1e-12&&(Ke=0),Ke<0)throw new Error("Cannot create an arc with the given arguments");Qe=new be(ye*de/ge,-ge*ie/ye).multiply((ne===ze?-1:1)*Y(Ke)).rotate(se).add(dt),Ue=new Tt().translate(Qe).rotate(se).scale(ye,ge),Ze=Ue._inverseTransform(fe),He=Ze.getDirectedAngle(Ue._inverseTransform(ve)),!ze&&He>0?He-=360:ze&&He<0&&(He+=360)}if(Ie){var De=new zt(fe.add(Ie).divide(2),Ie.subtract(fe).rotate(90),!0),Ge=new zt(Ie.add(ve).divide(2),ve.subtract(Ie).rotate(90),!0),At=new zt(fe,ve),kt=At.getSide(Ie);if(Qe=De.intersect(Ge,!0),!Qe){if(!kt)return this.lineTo(ve);throw new Error("Cannot create an arc with the given arguments")}Ze=fe.subtract(Qe),He=Ze.getDirectedAngle(ve.subtract(Qe));var o=At.getSide(Qe,!0);o===0?He=kt*V(He):kt===o&&(He+=He<0?360:-360)}if(He){for(var ke=1e-5,oi=V(He),fi=oi>=360?4:Math.ceil((oi-ke)/90),Ai=He/fi,ti=Ai*Math.PI/360,li=4/3*Math.sin(ti)/(1+Math.cos(ti)),Bi=[],vi=0;vi<=fi;vi++){var $=ve,bi=null;if(vi<fi&&(bi=Ze.rotate(90).multiply(li),Ue?($=Ue._transformPoint(Ze),bi=Ue._transformPoint(Ze.add(bi)).subtract($)):$=Qe.add(Ze)),!vi)te.setHandleOut(bi);else{var Jt=Ze.rotate(-90).multiply(li);Ue&&(Jt=Ue._transformPoint(Ze.add(Jt)).subtract($)),Bi.push(new $e($,Jt,bi))}Ze=Ze.rotate(Ai)}this._add(Bi)}},lineBy:function(){var k=be.read(arguments),V=v(this)._point;this.lineTo(V.add(k))},curveBy:function(){var k=arguments,V=be.read(k),Y=be.read(k),te=x.read(k),fe=v(this)._point;this.curveTo(fe.add(V),fe.add(Y),te)},cubicCurveBy:function(){var k=arguments,V=be.read(k),Y=be.read(k),te=be.read(k),fe=v(this)._point;this.cubicCurveTo(fe.add(V),fe.add(Y),fe.add(te))},quadraticCurveBy:function(){var k=arguments,V=be.read(k),Y=be.read(k),te=v(this)._point;this.quadraticCurveTo(te.add(V),te.add(Y))},arcBy:function(){var k=arguments,V=v(this)._point,Y=V.add(be.read(k)),te=x.pick(x.peek(k),!0);typeof te=="boolean"?this.arcTo(Y,te):this.arcTo(Y,V.add(be.read(k)))},closePath:function(k){this.setClosed(!0),this.join(this,k)}}},{_getBounds:function(v,k){var V=k.handle?"getHandleBounds":k.stroke?"getStrokeBounds":"getBounds";return Ot[V](this._segments,this._closed,this,v,k)},statics:{getBounds:function(v,k,V,Y,te,fe){var ve=v[0];if(!ve)return new it;var Ie=new Array(6),Ee=ve._transformCoordinates(Y,new Array(6)),ze=Ee.slice(0,2),Qe=ze.slice(),He=new Array(2);function Ze(rt){rt._transformCoordinates(Y,Ie);for(var Me=0;Me<2;Me++)ut._addBounds(Ee[Me],Ee[Me+4],Ie[Me+2],Ie[Me],Me,fe?fe[Me]:0,ze,Qe,He);var se=Ee;Ee=Ie,Ie=se}for(var Ue=1,dt=v.length;Ue<dt;Ue++)Ze(v[Ue]);return k&&Ze(ve),new it(ze[0],ze[1],Qe[0]-ze[0],Qe[1]-ze[1])},getStrokeBounds:function(v,k,V,Y,te){var fe=V.getStyle(),ve=fe.hasStroke(),Ie=fe.getStrokeWidth(),Ee=ve&&V._getStrokeMatrix(Y,te),ze=ve&&Ot._getStrokePadding(Ie,Ee),Qe=Ot.getBounds(v,k,V,Y,te,ze);if(!ve)return Qe;var He=Ie/2,Ze=fe.getStrokeJoin(),Ue=fe.getStrokeCap(),dt=fe.getMiterLimit(),rt=new it(new st(ze));function Me(ye){Qe=Qe.include(ye)}function se(ye){Qe=Qe.unite(rt.setCenter(ye._point.transform(Y)))}function ne(ye,ge){ge==="round"||ye.isSmooth()?se(ye):Ot._addBevelJoin(ye,ge,He,dt,Y,Ee,Me)}function $(ye,ge){ge==="round"?se(ye):Ot._addSquareCap(ye,ge,He,Y,Ee,Me)}var ie=v.length-(k?0:1);if(ie>0){for(var de=1;de<ie;de++)ne(v[de],Ze);k?ne(v[0],Ze):($(v[0],Ue),$(v[v.length-1],Ue))}return Qe},_getStrokePadding:function(v,k){if(!k)return[v,v];var V=new be(v,0).transform(k),Y=new be(0,v).transform(k),te=V.getAngleInRadians(),fe=V.getLength(),ve=Y.getLength(),Ie=Math.sin(te),Ee=Math.cos(te),ze=Math.tan(te),Qe=Math.atan2(ve*ze,fe),He=Math.atan2(ve,ze*fe);return[Math.abs(fe*Math.cos(Qe)*Ee+ve*Math.sin(Qe)*Ie),Math.abs(ve*Math.sin(He)*Ee+fe*Math.cos(He)*Ie)]},_addBevelJoin:function(v,k,V,Y,te,fe,ve,Ie){var Ee=v.getCurve(),ze=Ee.getPrevious(),Qe=Ee.getPoint1().transform(te),He=ze.getNormalAtTime(1).multiply(V).transform(fe),Ze=Ee.getNormalAtTime(0).multiply(V).transform(fe),Ue=He.getDirectedAngle(Ze);if((Ue<0||Ue>=180)&&(He=He.negate(),Ze=Ze.negate()),Ie&&ve(Qe),ve(Qe.add(He)),k==="miter"){var dt=new zt(Qe.add(He),new be(-He.y,He.x),!0).intersect(new zt(Qe.add(Ze),new be(-Ze.y,Ze.x),!0),!0);dt&&Qe.getDistance(dt)<=Y*V&&ve(dt)}ve(Qe.add(Ze))},_addSquareCap:function(v,k,V,Y,te,fe,ve){var Ie=v._point.transform(Y),Ee=v.getLocation(),ze=Ee.getNormal().multiply(Ee.getTime()===0?V:-V).transform(te);k==="square"&&(ve&&(fe(Ie.subtract(ze)),fe(Ie.add(ze))),Ie=Ie.add(ze.rotate(-90))),fe(Ie.add(ze)),fe(Ie.subtract(ze))},getHandleBounds:function(v,k,V,Y,te){var fe=V.getStyle(),ve=te.stroke&&fe.hasStroke(),Ie,Ee;if(ve){var ze=V._getStrokeMatrix(Y,te),Qe=fe.getStrokeWidth()/2,He=Qe;fe.getStrokeJoin()==="miter"&&(He=Qe*fe.getMiterLimit()),fe.getStrokeCap()==="square"&&(He=Math.max(He,Qe*Math.SQRT2)),Ie=Ot._getStrokePadding(Qe,ze),Ee=Ot._getStrokePadding(He,ze)}for(var Ze=new Array(6),Ue=1/0,dt=-Ue,rt=Ue,Me=dt,se=0,ne=v.length;se<ne;se++){var $=v[se];$._transformCoordinates(Y,Ze);for(var ie=0;ie<6;ie+=2){var de=ie?Ie:Ee,ye=de?de[0]:0,ge=de?de[1]:0,Pe=Ze[ie],Fe=Ze[ie+1],Ve=Pe-ye,Xe=Pe+ye,Ke=Fe-ge,De=Fe+ge;Ve<Ue&&(Ue=Ve),Xe>dt&&(dt=Xe),Ke<rt&&(rt=Ke),De>Me&&(Me=De)}}return new it(Ue,rt,dt-Ue,Me-rt)}}});Ot.inject({statics:new function(){var v=.5522847498307936,k=[new $e([-1,0],[0,v],[0,-v]),new $e([0,-1],[-v,0],[v,0]),new $e([1,0],[0,-v],[0,v]),new $e([0,1],[v,0],[-v,0])];function V(te,fe,ve){var Ie=x.getNamed(ve),Ee=new Ot(Ie&&(Ie.insert==!0?Oe.INSERT:Ie.insert==!1?Oe.NO_INSERT:null));return Ee._add(te),Ee._closed=fe,Ee.set(Ie,Oe.INSERT)}function Y(te,fe,ve){for(var Ie=new Array(4),Ee=0;Ee<4;Ee++){var ze=k[Ee];Ie[Ee]=new $e(ze._point.multiply(fe).add(te),ze._handleIn.multiply(fe),ze._handleOut.multiply(fe))}return V(Ie,!0,ve)}return{Line:function(){var te=arguments;return V([new $e(be.readNamed(te,"from")),new $e(be.readNamed(te,"to"))],!1,te)},Circle:function(){var te=arguments,fe=be.readNamed(te,"center"),ve=x.readNamed(te,"radius");return Y(fe,new st(ve),te)},Rectangle:function(){var te=arguments,fe=it.readNamed(te,"rectangle"),ve=st.readNamed(te,"radius",0,{readNull:!0}),Ie=fe.getBottomLeft(!0),Ee=fe.getTopLeft(!0),ze=fe.getTopRight(!0),Qe=fe.getBottomRight(!0),He;if(!ve||ve.isZero())He=[new $e(Ie),new $e(Ee),new $e(ze),new $e(Qe)];else{ve=st.min(ve,fe.getSize(!0).divide(2));var Ze=ve.width,Ue=ve.height,dt=Ze*v,rt=Ue*v;He=[new $e(Ie.add(Ze,0),null,[-dt,0]),new $e(Ie.subtract(0,Ue),[0,rt]),new $e(Ee.add(0,Ue),null,[0,-rt]),new $e(Ee.add(Ze,0),[-dt,0],null),new $e(ze.subtract(Ze,0),null,[dt,0]),new $e(ze.add(0,Ue),[0,-rt],null),new $e(Qe.subtract(0,Ue),null,[0,rt]),new $e(Qe.subtract(Ze,0),[dt,0])]}return V(He,!0,te)},RoundRectangle:"#Rectangle",Ellipse:function(){var te=arguments,fe=_t._readEllipse(te);return Y(fe.center,fe.radius,te)},Oval:"#Ellipse",Arc:function(){var te=arguments,fe=be.readNamed(te,"from"),ve=be.readNamed(te,"through"),Ie=be.readNamed(te,"to"),Ee=x.getNamed(te),ze=new Ot(Ee&&Ee.insert==!1&&Oe.NO_INSERT);return ze.moveTo(fe),ze.arcTo(ve,Ie),ze.set(Ee)},RegularPolygon:function(){for(var te=arguments,fe=be.readNamed(te,"center"),ve=x.readNamed(te,"sides"),Ie=x.readNamed(te,"radius"),Ee=360/ve,ze=ve%3===0,Qe=new be(0,ze?-Ie:Ie),He=ze?-1:.5,Ze=new Array(ve),Ue=0;Ue<ve;Ue++)Ze[Ue]=new $e(fe.add(Qe.rotate((Ue+He)*Ee)));return V(Ze,!0,te)},Star:function(){for(var te=arguments,fe=be.readNamed(te,"center"),ve=x.readNamed(te,"points")*2,Ie=x.readNamed(te,"radius1"),Ee=x.readNamed(te,"radius2"),ze=360/ve,Qe=new be(0,-1),He=new Array(ve),Ze=0;Ze<ve;Ze++)He[Ze]=new $e(fe.add(Qe.rotate(ze*Ze).multiply(Ze%2?Ee:Ie)));return V(He,!0,te)}}}});var gi=Bt.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(k){this._children=[],this._namedChildren={},this._initialize(k)||(typeof k=="string"?this.setPathData(k):this.addChildren(Array.isArray(k)?k:arguments))},insertChildren:function v(k,V){var Y=V,te=Y[0];te&&typeof te[0]=="number"&&(Y=[Y]);for(var fe=V.length-1;fe>=0;fe--){var ve=Y[fe];Y===V&&!(ve instanceof Ot)&&(Y=x.slice(Y)),Array.isArray(ve)?Y[fe]=new Ot({segments:ve,insert:!1}):ve instanceof gi&&(Y.splice.apply(Y,[fe,1].concat(ve.removeChildren())),ve.remove())}return v.base.call(this,k,Y)},reduce:function v(k){for(var V=this._children,Y=V.length-1;Y>=0;Y--){var te=V[Y].reduce(k);te.isEmpty()&&te.remove()}if(!V.length){var te=new Ot(Oe.NO_INSERT);return te.copyAttributes(this),te.insertAbove(this),this.remove(),te}return v.base.call(this)},isClosed:function(){for(var v=this._children,k=0,V=v.length;k<V;k++)if(!v[k]._closed)return!1;return!0},setClosed:function(v){for(var k=this._children,V=0,Y=k.length;V<Y;V++)k[V].setClosed(v)},getFirstSegment:function(){var v=this.getFirstChild();return v&&v.getFirstSegment()},getLastSegment:function(){var v=this.getLastChild();return v&&v.getLastSegment()},getCurves:function(){for(var v=this._children,k=[],V=0,Y=v.length;V<Y;V++)x.push(k,v[V].getCurves());return k},getFirstCurve:function(){var v=this.getFirstChild();return v&&v.getFirstCurve()},getLastCurve:function(){var v=this.getLastChild();return v&&v.getLastCurve()},getArea:function(){for(var v=this._children,k=0,V=0,Y=v.length;V<Y;V++)k+=v[V].getArea();return k},getLength:function(){for(var v=this._children,k=0,V=0,Y=v.length;V<Y;V++)k+=v[V].getLength();return k},getPathData:function(v,k){for(var V=this._children,Y=[],te=0,fe=V.length;te<fe;te++){var ve=V[te],Ie=ve._matrix;Y.push(ve.getPathData(v&&!Ie.isIdentity()?v.appended(Ie):v,k))}return Y.join("")},_hitTestChildren:function v(k,V,Y){return v.base.call(this,k,V.class===Ot||V.type==="path"?V:x.set({},V,{fill:!1}),Y)},_draw:function(v,k,V,Y){var te=this._children;if(te.length){k=k.extend({dontStart:!0,dontFinish:!0}),v.beginPath();for(var fe=0,ve=te.length;fe<ve;fe++)te[fe].draw(v,k,Y);if(!k.clip){this._setStyles(v,k,V);var Ie=this._style;Ie.hasFill()&&(v.fill(Ie.getFillRule()),v.shadowColor="rgba(0,0,0,0)"),Ie.hasStroke()&&v.stroke()}}},_drawSelected:function(v,k,V){for(var Y=this._children,te=0,fe=Y.length;te<fe;te++){var ve=Y[te],Ie=ve._matrix;V[ve._id]||ve._drawSelected(v,Ie.isIdentity()?k:k.appended(Ie))}}},new function(){function v(k,V){var Y=k._children;if(V&&!Y.length)throw new Error("Use a moveTo() command first");return Y[Y.length-1]}return x.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(k){this[k]=function(){var V=v(this,!0);V[k].apply(V,arguments)}},{moveTo:function(){var k=v(this),V=k&&k.isEmpty()?k:new Ot(Oe.NO_INSERT);V!==k&&this.addChild(V),V.moveTo.apply(V,arguments)},moveBy:function(){var k=v(this,!0),V=k&&k.getLastSegment(),Y=be.read(arguments);this.moveTo(V?Y.add(V._point):Y)},closePath:function(k){v(this,!0).closePath(k)}})},x.each(["reverse","flatten","simplify","smooth"],function(v){this[v]=function(k){for(var V=this._children,Y,te=0,fe=V.length;te<fe;te++)Y=V[te][v](k)||Y;return Y}},{}));Bt.inject(new function(){var v=Math.min,k=Math.max,V=Math.abs,Y={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function te(se){return se._children||[se]}function fe(se,ne){var $=se.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(ne){for(var ie=te($),de=0,ye=ie.length;de<ye;de++){var se=ie[de];!se._closed&&!se.isEmpty()&&(se.closePath(1e-12),se.getFirstSegment().setHandleIn(0,0),se.getLastSegment().setHandleOut(0,0))}$=$.resolveCrossings().reorient($.getFillRule()==="nonzero",!0)}return $}function ve(se,ne,$,ie,de){var ye=new gi(Oe.NO_INSERT);return ye.addChildren(se,!0),ye=ye.reduce({simplify:ne}),de&&de.insert==!1||ye.insertAbove(ie&&$.isSibling(ie)&&$.getIndex()<ie.getIndex()?ie:$),ye.copyAttributes($,!0),ye}function Ie(se){return se.hasOverlap()||se.isCrossing()}function Ee(se,ne,$,ie){if(ie&&(ie.trace==!1||ie.stroke)&&/^(subtract|intersect)$/.test($))return ze(se,ne,$);var de=fe(se,!0),ye=ne&&se!==ne&&fe(ne,!0),ge=Y[$];ge[$]=!0,ye&&(ge.subtract||ge.exclude)^(ye.isClockwise()^de.isClockwise())&&ye.reverse();var Pe=Ue(Nt.expand(de.getIntersections(ye,Ie))),Fe=te(de),Ve=ye&&te(ye),Xe=[],Ke=[],De;function Ge(bi){for(var Jt=0,wn=bi.length;Jt<wn;Jt++){var ar=bi[Jt];x.push(Xe,ar._segments),x.push(Ke,ar.getCurves()),ar._overlapsOnly=!0}}function At(bi){for(var Jt=[],wn=0,ar=bi&&bi.length;wn<ar;wn++)Jt.push(Ke[bi[wn]]);return Jt}if(Pe.length){Ge(Fe),Ve&&Ge(Ve);for(var kt=new Array(Ke.length),o=0,ke=Ke.length;o<ke;o++)kt[o]=Ke[o].getValues();for(var oi=W.findCurveBoundsCollisions(kt,kt,0,!0),fi={},o=0;o<Ke.length;o++){var Ai=Ke[o],ti=Ai._path._id,li=fi[ti]=fi[ti]||{};li[Ai.getIndex()]={hor:At(oi[o].hor),ver:At(oi[o].ver)}}for(var o=0,ke=Pe.length;o<ke;o++)rt(Pe[o]._segment,de,ye,fi,ge);for(var o=0,ke=Xe.length;o<ke;o++){var Bi=Xe[o],vi=Bi._intersection;Bi._winding||rt(Bi,de,ye,fi,ge),vi&&vi._overlap||(Bi._path._overlapsOnly=!1)}De=Me(Xe,ge)}else De=Ze(Ve?Fe.concat(Ve):Fe.slice(),function(bi){return!!ge[bi]});return ve(De,!0,se,ne,ie)}function ze(se,ne,$){var ie=fe(se),de=fe(ne),ye=ie.getIntersections(de,Ie),ge=$==="subtract",Pe=$==="divide",Fe={},Ve=[];function Xe(Ge){if(!Fe[Ge._id]&&(Pe||de.contains(Ge.getPointAt(Ge.getLength()/2))^ge))return Ve.unshift(Ge),Fe[Ge._id]=!0}for(var Ke=ye.length-1;Ke>=0;Ke--){var De=ye[Ke].split();De&&(Xe(De)&&De.getFirstSegment().setHandleIn(0,0),ie.getLastSegment().setHandleOut(0,0))}return Xe(ie),ve(Ve,!1,se,ne)}function Qe(se,ne){for(var $=se;$;){if($===ne)return;$=$._previous}for(;se._next&&se._next!==ne;)se=se._next;if(!se._next){for(;ne._previous;)ne=ne._previous;se._next=ne,ne._previous=se}}function He(se){for(var ne=se.length-1;ne>=0;ne--)se[ne].clearHandles()}function Ze(se,ne,$){var ie=se&&se.length;if(ie){var de=x.each(se,function(oi,fi){this[oi._id]={container:null,winding:oi.isClockwise()?1:-1,index:fi}},{}),ye=se.slice().sort(function(oi,fi){return V(fi.getArea())-V(oi.getArea())}),ge=ye[0],Pe=W.findItemBoundsCollisions(ye,null,ae.GEOMETRIC_EPSILON);$==null&&($=ge.isClockwise());for(var Fe=0;Fe<ie;Fe++){var Ve=ye[Fe],Xe=de[Ve._id],Ke=0,De=Pe[Fe];if(De){for(var Ge=null,At=De.length-1;At>=0;At--)if(De[At]<Fe){Ge=Ge||Ve.getInteriorPoint();var kt=ye[De[At]];if(kt.contains(Ge)){var o=de[kt._id];Ke=o.winding,Xe.winding+=Ke,Xe.container=o.exclude?o.container:kt;break}}}if(ne(Xe.winding)===ne(Ke))Xe.exclude=!0,se[Xe.index]=null;else{var ke=Xe.container;Ve.setClockwise(ke?!ke.isClockwise():$)}}}return se}function Ue(se,ne,$){var ie=ne&&[],de=1e-8,ye=1-de,ge=!1,Pe=$||[],Fe=$&&{},Ve,Xe,Ke;function De(Jt){return Jt._path._id+"."+Jt._segment1._index}for(var Ge=($&&$.length)-1;Ge>=0;Ge--){var At=$[Ge];At._path&&(Fe[De(At)]=!0)}for(var Ge=se.length-1;Ge>=0;Ge--){var kt=se[Ge],o=kt._time,ke=o,oi=ne&&!ne(kt),At=kt._curve,fi;if(At&&(At!==Xe?(ge=!At.hasHandles()||Fe&&Fe[De(At)],Ve=[],Ke=null,Xe=At):Ke>=de&&(o/=Ke)),oi){Ve&&Ve.push(kt);continue}else ne&&ie.unshift(kt);if(Ke=ke,o<de)fi=At._segment1;else if(o>ye)fi=At._segment2;else{var Ai=At.divideAtTime(o,!0);ge&&Pe.push(At,Ai),fi=Ai._segment1;for(var ti=Ve.length-1;ti>=0;ti--){var li=Ve[ti];li._time=(li._time-o)/(1-o)}}kt._setSegment(fi);var Bi=fi._intersection,vi=kt._intersection;if(Bi){Qe(Bi,vi);for(var bi=Bi;bi;)Qe(bi._intersection,Bi),bi=bi._next}else fi._intersection=vi}return $||He(Pe),ie||se}function dt(se,ne,$,ie,de){var ye=Array.isArray(ne)?ne:ne[$?"hor":"ver"],ge=$?1:0,Pe=ge^1,Fe=[se.x,se.y],Ve=Fe[ge],Xe=Fe[Pe],Ke=1e-9,De=1e-6,Ge=Ve-Ke,At=Ve+Ke,kt=0,o=0,ke=0,oi=0,fi=!1,Ai=!1,ti=1,li=[],Bi,vi;function bi(Wt){var Yi=Wt[Pe+0],Ut=Wt[Pe+6];if(!(Xe<v(Yi,Ut)||Xe>k(Yi,Ut))){var Tn=Wt[ge+0],cr=Wt[ge+2],Vs=Wt[ge+4],Ur=Wt[ge+6];if(Yi===Ut){(Tn<At&&Ur>Ge||Ur<At&&Tn>Ge)&&(fi=!0);return}var Vt=Xe===Yi?0:Xe===Ut||Ge>k(Tn,cr,Vs,Ur)||At<v(Tn,cr,Vs,Ur)?1:ut.solveCubic(Wt,Pe,Xe,li,0,1)>0?li[0]:1,hr=Vt===0?Tn:Vt===1?Ur:ut.getPoint(Wt,Vt)[$?"y":"x"],Dt=Yi>Ut?1:-1,Fr=Bi[Pe]>Bi[Pe+6]?1:-1,Us=Bi[ge+6];return Xe!==Yi?(hr<Ge?ke+=Dt:hr>At?oi+=Dt:fi=!0,hr>Ve-De&&hr<Ve+De&&(ti/=2)):(Dt!==Fr?Tn<Ge?ke+=Dt:Tn>At&&(oi+=Dt):Tn!=Us&&(Us<At&&hr>At?(oi+=Dt,fi=!0):Us>Ge&&hr<Ge&&(ke+=Dt,fi=!0)),ti/=4),Bi=Wt,!de&&hr>Ge&&hr<At&&ut.getTangent(Wt,Vt)[$?"x":"y"]===0&&dt(se,ne,!$,ie,!0)}}function Jt(Wt){var Yi=Wt[Pe+0],Ut=Wt[Pe+2],Tn=Wt[Pe+4],cr=Wt[Pe+6];if(Xe<=k(Yi,Ut,Tn,cr)&&Xe>=v(Yi,Ut,Tn,cr)){for(var Vs=Wt[ge+0],Ur=Wt[ge+2],Vt=Wt[ge+4],hr=Wt[ge+6],Dt=Ge>k(Vs,Ur,Vt,hr)||At<v(Vs,Ur,Vt,hr)?[Wt]:ut.getMonoCurves(Wt,$),Fr,Us=0,ca=Dt.length;Us<ca;Us++)if(Fr=bi(Dt[Us]))return Fr}}for(var wn=0,ar=ye.length;wn<ar;wn++){var mn=ye[wn],Hn=mn._path,jr=mn.getValues(),ji;if((!wn||ye[wn-1]._path!==Hn)&&(Bi=null,Hn._closed||(vi=ut.getValues(Hn.getLastCurve().getSegment2(),mn.getSegment1(),null,!ie),vi[Pe]!==vi[Pe+6]&&(Bi=vi)),!Bi)){Bi=jr;for(var ur=Hn.getLastCurve();ur&&ur!==mn;){var Vn=ur.getValues();if(Vn[Pe]!==Vn[Pe+6]){Bi=Vn;break}ur=ur.getPrevious()}}if(ji=Jt(jr))return ji;if(wn+1===ar||ye[wn+1]._path!==Hn){if(vi&&(ji=Jt(vi)))return ji;fi&&!ke&&!oi&&(ke=oi=Hn.isClockwise(ie)^$?1:-1),kt+=ke,o+=oi,ke=oi=0,fi&&(Ai=!0,fi=!1),vi=null}}return kt=V(kt),o=V(o),{winding:k(kt,o),windingL:kt,windingR:o,quality:ti,onPath:Ai}}function rt(se,ne,$,ie,de){var ye=[],ge=se,Pe=0,Ke;do{var Fe=se.getCurve();if(Fe){var Ve=Fe.getLength();ye.push({segment:se,curve:Fe,length:Ve}),Pe+=Ve}se=se.getNext()}while(se&&!se._intersection&&se!==ge);for(var Xe=[.5,.25,.75],Ke={winding:0,quality:-1},De=.001,Ge=1-De,At=0;At<Xe.length&&Ke.quality<.5;At++)for(var Ve=Pe*Xe[At],kt=0,o=ye.length;kt<o;kt++){var ke=ye[kt],oi=ke.length;if(Ve<=oi){var Fe=ke.curve,fi=Fe._path,Ai=fi._parent,ti=Ai instanceof gi?Ai:fi,li=ae.clamp(Fe.getTimeAt(Ve),De,Ge),Bi=Fe.getPointAtTime(li),vi=V(Fe.getTangentAtTime(li).y)<Math.SQRT1_2,bi=null;if(de.subtract&&$){var Jt=ti===ne?$:ne,wn=Jt._getWinding(Bi,vi,!0);if(ti===ne&&wn.winding||ti===$&&!wn.winding){if(wn.quality<1)continue;bi={winding:0,quality:1}}}bi=bi||dt(Bi,ie[fi._id][Fe.getIndex()],vi,!0),bi.quality>Ke.quality&&(Ke=bi);break}Ve-=oi}for(var kt=ye.length-1;kt>=0;kt--)ye[kt].segment._winding=Ke}function Me(se,ne){var $=[],ie;function de(ar){var mn;return!!(ar&&!ar._visited&&(!ne||ne[(mn=ar._winding||{}).winding]&&!(ne.unite&&mn.winding===2&&mn.windingL&&mn.windingR)))}function ye(ar){if(ar){for(var mn=0,Hn=ie.length;mn<Hn;mn++)if(ar===ie[mn])return!0}return!1}function ge(ar){for(var mn=ar._segments,Hn=0,jr=mn.length;Hn<jr;Hn++)mn[Hn]._visited=!0}function Pe(ar,mn){var Hn=ar._intersection,jr=Hn,ji=[];mn&&(ie=[ar]);function ur(Vn,Wt){for(;Vn&&Vn!==Wt;){var Yi=Vn._segment,Ut=Yi&&Yi._path;if(Ut){var Tn=Yi.getNext()||Ut.getFirstSegment(),cr=Tn._intersection;Yi!==ar&&(ye(Yi)||ye(Tn)||Tn&&de(Yi)&&(de(Tn)||cr&&de(cr._segment)))&&ji.push(Yi),mn&&ie.push(Yi)}Vn=Vn._next}}if(Hn){for(ur(Hn);Hn&&Hn._previous;)Hn=Hn._previous;ur(Hn,jr)}return ji}se.sort(function(ar,mn){var Hn=ar._intersection,jr=mn._intersection,ji=!!(Hn&&Hn._overlap),ur=!!(jr&&jr._overlap),Vn=ar._path,Wt=mn._path;return ji^ur?ji?1:-1:!Hn^!jr?Hn?1:-1:Vn!==Wt?Vn._id-Wt._id:ar._index-mn._index});for(var Fe=0,Ve=se.length;Fe<Ve;Fe++){var Xe=se[Fe],Ke=de(Xe),De=null,Ge=!1,At=!0,kt=[],o,ke,oi;if(Ke&&Xe._path._overlapsOnly){var fi=Xe._path,Ai=Xe._intersection._segment._path;fi.compare(Ai)&&(fi.getArea()&&$.push(fi.clone(!1)),ge(fi),ge(Ai),Ke=!1)}for(;Ke;){var ti=!De,li=Pe(Xe,ti),Bi=li.shift(),Ge=!ti&&(ye(Xe)||ye(Bi)),vi=!Ge&&Bi;if(ti&&(De=new Ot(Oe.NO_INSERT),o=null),Ge){(Xe.isFirst()||Xe.isLast())&&(At=Xe._path._closed),Xe._visited=!0;break}if(vi&&o&&(kt.push(o),o=null),o||(vi&&li.push(Xe),o={start:De._segments.length,crossings:li,visited:ke=[],handleIn:oi}),vi&&(Xe=Bi),!de(Xe)){De.removeSegments(o.start);for(var bi=0,Jt=ke.length;bi<Jt;bi++)ke[bi]._visited=!1;ke.length=0;do Xe=o&&o.crossings.shift(),(!Xe||!Xe._path)&&(Xe=null,o=kt.pop(),o&&(ke=o.visited,oi=o.handleIn));while(o&&!de(Xe));if(!Xe)break}var wn=Xe.getNext();De.add(new $e(Xe._point,oi,wn&&Xe._handleOut)),Xe._visited=!0,ke.push(Xe),Xe=wn||Xe._path.getFirstSegment(),oi=wn&&wn._handleIn}Ge&&(At&&(De.getFirstSegment().setHandleIn(oi),De.setClosed(At)),De.getArea()!==0&&$.push(De))}return $}return{_getWinding:function(se,ne,$){return dt(se,this.getCurves(),ne,$)},unite:function(se,ne){return Ee(this,se,"unite",ne)},intersect:function(se,ne){return Ee(this,se,"intersect",ne)},subtract:function(se,ne){return Ee(this,se,"subtract",ne)},exclude:function(se,ne){return Ee(this,se,"exclude",ne)},divide:function(se,ne){return ne&&(ne.trace==!1||ne.stroke)?ze(this,se,"divide"):ve([this.subtract(se,ne),this.intersect(se,ne)],!0,this,se,ne)},resolveCrossings:function(){var se=this._children,ne=se||[this];function $(o,ke){var oi=o&&o._intersection;return oi&&oi._overlap&&oi._path===ke}var ie=!1,de=!1,ye=this.getIntersections(null,function(o){return o.hasOverlap()&&(ie=!0)||o.isCrossing()&&(de=!0)}),ge=ie&&de&&[];if(ye=Nt.expand(ye),ie)for(var Pe=Ue(ye,function(o){return o.hasOverlap()},ge),Fe=Pe.length-1;Fe>=0;Fe--){var Ve=Pe[Fe],Xe=Ve._path,Ke=Ve._segment,De=Ke.getPrevious(),Ge=Ke.getNext();$(De,Xe)&&$(Ge,Xe)&&(Ke.remove(),De._handleOut._set(0,0),Ge._handleIn._set(0,0),De!==Ke&&!De.getCurve().hasLength()&&(Ge._handleIn.set(De._handleIn),De.remove()))}de&&(Ue(ye,ie&&function(o){var ke=o.getCurve(),oi=o.getSegment(),fi=o._intersection,Ai=fi._curve,ti=fi._segment;if(ke&&Ai&&ke._path&&Ai._path)return!0;oi&&(oi._intersection=null),ti&&(ti._intersection=null)},ge),ge&&He(ge),ne=Me(x.each(ne,function(o){x.push(this,o._segments)},[])));var At=ne.length,kt;return At>1&&se?(ne!==se&&this.setChildren(ne),kt=this):At===1&&!se&&(ne[0]!==this&&this.setSegments(ne[0].removeSegments()),kt=this),kt||(kt=new gi(Oe.NO_INSERT),kt.addChildren(ne),kt=kt.reduce(),kt.copyAttributes(this),this.replaceWith(kt)),kt},reorient:function(se,ne){var $=this._children;return $&&$.length?this.setChildren(Ze(this.removeChildren(),function(ie){return!!(se?ie:ie&1)},ne)):ne!==n&&this.setClockwise(ne),this},getInteriorPoint:function(){var se=this.getBounds(),ne=se.getCenter(!0);if(!this.contains(ne)){for(var $=this.getCurves(),ie=ne.y,de=[],ye=[],ge=0,Pe=$.length;ge<Pe;ge++){var Fe=$[ge].getValues(),Ve=Fe[1],Xe=Fe[3],Ke=Fe[5],De=Fe[7];if(ie>=v(Ve,Xe,Ke,De)&&ie<=k(Ve,Xe,Ke,De))for(var Ge=ut.getMonoCurves(Fe),At=0,kt=Ge.length;At<kt;At++){var o=Ge[At],ke=o[1],oi=o[7];if(ke!==oi&&(ie>=ke&&ie<=oi||ie>=oi&&ie<=ke)){var fi=ie===ke?o[0]:ie===oi?o[6]:ut.solveCubic(o,1,ie,ye,0,1)===1?ut.getPoint(o,ye[0]).x:(o[0]+o[6])/2;de.push(fi)}}}de.length>1&&(de.sort(function(Ai,ti){return Ai-ti}),ne.x=(de[0]+de[1])/2)}return ne}}});var Ii=x.extend({_class:"PathFlattener",initialize:function(v,k,V,Y,te){var fe=[],ve=[],Ie=0,Ee=1/(V||32),ze=v._segments,Qe=ze[0],He;function Ze(Me,se){var ne=ut.getValues(Me,se,te);fe.push(ne),Ue(ne,Me._index,0,1)}function Ue(Me,se,ne,$){if($-ne>Ee&&!(Y&&ut.isStraight(Me))&&!ut.isFlatEnough(Me,k||.25)){var ie=ut.subdivide(Me,.5),de=(ne+$)/2;Ue(ie[0],se,ne,de),Ue(ie[1],se,de,$)}else{var ye=Me[6]-Me[0],ge=Me[7]-Me[1],Pe=Math.sqrt(ye*ye+ge*ge);Pe>0&&(Ie+=Pe,ve.push({offset:Ie,curve:Me,index:se,time:$}))}}for(var dt=1,rt=ze.length;dt<rt;dt++)He=ze[dt],Ze(Qe,He),Qe=He;v._closed&&Ze(He||Qe,ze[0]),this.curves=fe,this.parts=ve,this.length=Ie,this.index=0},_get:function(v){for(var k=this.parts,V=k.length,Y,te=this.index;Y=te,!(!te||k[--te].offset<v););for(;Y<V;Y++){var fe=k[Y];if(fe.offset>=v){this.index=Y;var ve=k[Y-1],Ie=ve&&ve.index===fe.index?ve.time:0,Ee=ve?ve.offset:0;return{index:fe.index,time:Ie+(fe.time-Ie)*(v-Ee)/(fe.offset-Ee)}}}return{index:k[V-1].index,time:1}},drawPart:function(v,k,V){for(var Y=this._get(k),te=this._get(V),fe=Y.index,ve=te.index;fe<=ve;fe++){var Ie=ut.getPart(this.curves[fe],fe===Y.index?Y.time:0,fe===te.index?te.time:1);fe===Y.index&&v.moveTo(Ie[0],Ie[1]),v.bezierCurveTo.apply(v,Ie.slice(2))}}},x.each(ut._evaluateMethods,function(v){this[v+"At"]=function(k){var V=this._get(k);return ut[v](this.curves[V.index],V.time)}},{})),Ci=x.extend({initialize:function(v){for(var k=this.points=[],V=v._segments,Y=v._closed,te=0,fe,ve=V.length;te<ve;te++){var Ie=V[te].point;(!fe||!fe.equals(Ie))&&k.push(fe=Ie.clone())}Y&&(k.unshift(k[k.length-1]),k.push(k[1])),this.closed=Y},fit:function(v){var k=this.points,V=k.length,Y=null;return V>0&&(Y=[new $e(k[0])],V>1&&(this.fitCubic(Y,v,0,V-1,k[1].subtract(k[0]),k[V-2].subtract(k[V-1])),this.closed&&(Y.shift(),Y.pop()))),Y},fitCubic:function(v,k,V,Y,te,fe){var ve=this.points;if(Y-V===1){var Ie=ve[V],Ee=ve[Y],ze=Ie.getDistance(Ee)/3;this.addCurve(v,[Ie,Ie.add(te.normalize(ze)),Ee.add(fe.normalize(ze)),Ee]);return}for(var Qe=this.chordLengthParameterize(V,Y),He=Math.max(k,k*k),Ze,Ue=!0,dt=0;dt<=4;dt++){var rt=this.generateBezier(V,Y,Qe,te,fe),Me=this.findMaxError(V,Y,rt,Qe);if(Me.error<k&&Ue){this.addCurve(v,rt);return}if(Ze=Me.index,Me.error>=He)break;Ue=this.reparameterize(V,Y,Qe,rt),He=Me.error}var se=ve[Ze-1].subtract(ve[Ze+1]);this.fitCubic(v,k,V,Ze,te,se),this.fitCubic(v,k,Ze,Y,se.negate(),fe)},addCurve:function(v,k){var V=v[v.length-1];V.setHandleOut(k[1].subtract(k[0])),v.push(new $e(k[3],k[2].subtract(k[3])))},generateBezier:function(v,k,V,Y,te){for(var fe=1e-12,ve=Math.abs,Ie=this.points,Ee=Ie[v],ze=Ie[k],Qe=[[0,0],[0,0]],He=[0,0],Ze=0,Ue=k-v+1;Ze<Ue;Ze++){var dt=V[Ze],rt=1-dt,Me=3*dt*rt,se=rt*rt*rt,ne=Me*rt,$=Me*dt,ie=dt*dt*dt,de=Y.normalize(ne),ye=te.normalize($),ge=Ie[v+Ze].subtract(Ee.multiply(se+ne)).subtract(ze.multiply($+ie));Qe[0][0]+=de.dot(de),Qe[0][1]+=de.dot(ye),Qe[1][0]=Qe[0][1],Qe[1][1]+=ye.dot(ye),He[0]+=de.dot(ge),He[1]+=ye.dot(ge)}var Pe=Qe[0][0]*Qe[1][1]-Qe[1][0]*Qe[0][1],Fe,Ve;if(ve(Pe)>fe){var Xe=Qe[0][0]*He[1]-Qe[1][0]*He[0],Ke=He[0]*Qe[1][1]-He[1]*Qe[0][1];Fe=Ke/Pe,Ve=Xe/Pe}else{var De=Qe[0][0]+Qe[0][1],Ge=Qe[1][0]+Qe[1][1];Fe=Ve=ve(De)>fe?He[0]/De:ve(Ge)>fe?He[1]/Ge:0}var At=ze.getDistance(Ee),kt=fe*At,o,ke;if(Fe<kt||Ve<kt)Fe=Ve=At/3;else{var oi=ze.subtract(Ee);o=Y.normalize(Fe),ke=te.normalize(Ve),o.dot(oi)-ke.dot(oi)>At*At&&(Fe=Ve=At/3,o=ke=null)}return[Ee,Ee.add(o||Y.normalize(Fe)),ze.add(ke||te.normalize(Ve)),ze]},reparameterize:function(v,k,V,Y){for(var te=v;te<=k;te++)V[te-v]=this.findRoot(Y,this.points[te],V[te-v]);for(var te=1,fe=V.length;te<fe;te++)if(V[te]<=V[te-1])return!1;return!0},findRoot:function(v,k,V){for(var Y=[],te=[],fe=0;fe<=2;fe++)Y[fe]=v[fe+1].subtract(v[fe]).multiply(3);for(var fe=0;fe<=1;fe++)te[fe]=Y[fe+1].subtract(Y[fe]).multiply(2);var ve=this.evaluate(3,v,V),Ie=this.evaluate(2,Y,V),Ee=this.evaluate(1,te,V),ze=ve.subtract(k),Qe=Ie.dot(Ie)+ze.dot(Ee);return ae.isMachineZero(Qe)?V:V-ze.dot(Ie)/Qe},evaluate:function(v,k,V){for(var Y=k.slice(),te=1;te<=v;te++)for(var fe=0;fe<=v-te;fe++)Y[fe]=Y[fe].multiply(1-V).add(Y[fe+1].multiply(V));return Y[0]},chordLengthParameterize:function(v,k){for(var V=[0],Y=v+1;Y<=k;Y++)V[Y-v]=V[Y-v-1]+this.points[Y].getDistance(this.points[Y-1]);for(var Y=1,te=k-v;Y<=te;Y++)V[Y]/=V[te];return V},findMaxError:function(v,k,V,Y){for(var te=Math.floor((k-v+1)/2),fe=0,ve=v+1;ve<k;ve++){var Ie=this.evaluate(3,V,Y[ve-v]),Ee=Ie.subtract(this.points[ve]),ze=Ee.x*Ee.x+Ee.y*Ee.y;ze>=fe&&(fe=ze,te=ve)}return{error:fe,index:te}}}),Ri=Oe.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(k){this._content="",this._lines=[];var V=k&&x.isPlainObject(k)&&k.x===n&&k.y===n;this._initialize(V&&k,!V&&be.read(arguments))},_equals:function(v){return this._content===v._content},copyContent:function(v){this.setContent(v._content)},getContent:function(){return this._content},setContent:function(v){this._content=""+v,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),Ki=Ri.extend({_class:"PointText",initialize:function(){Ri.apply(this,arguments)},getPoint:function(){var v=this._matrix.getTranslation();return new Je(v.x,v.y,this,"setPoint")},setPoint:function(){var v=be.read(arguments);this.translate(v.subtract(this._matrix.getTranslation()))},_draw:function(v,k,V){if(this._content){this._setStyles(v,k,V);var Y=this._lines,te=this._style,fe=te.hasFill(),ve=te.hasStroke(),Ie=te.getLeading(),Ee=v.shadowColor;v.font=te.getFontStyle(),v.textAlign=te.getJustification();for(var ze=0,Qe=Y.length;ze<Qe;ze++){v.shadowColor=Ee;var He=Y[ze];fe&&(v.fillText(He,0,0),v.shadowColor="rgba(0,0,0,0)"),ve&&v.strokeText(He,0,0),v.translate(0,Ie)}}},_getBounds:function(v,k){var V=this._style,Y=this._lines,te=Y.length,fe=V.getJustification(),ve=V.getLeading(),Ie=this.getView().getTextWidth(V.getFontStyle(),Y),Ee=0;fe!=="left"&&(Ee-=Ie/(fe==="center"?2:1));var ze=new it(Ee,te?-.75*ve:0,Ie,te*ve);return v?v._transformBounds(ze,ze):ze}}),Hi=x.extend(new function(){var v={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},k={},V={transparent:[0,0,0,0]},Y;function te(Ie){var Ee=Ie.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||Ie.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),ze="rgb",Qe;if(Ee){var He=Ee[4]?4:3;Qe=new Array(He);for(var Ze=0;Ze<He;Ze++){var Ue=Ee[Ze+1];Qe[Ze]=parseInt(Ue.length==1?Ue+Ue:Ue,16)/255}}else if(Ee=Ie.match(/^(rgb|hsl)a?\((.*)\)$/)){ze=Ee[1],Qe=Ee[2].trim().split(/[,\s]+/g);for(var dt=ze==="hsl",Ze=0,rt=Math.min(Qe.length,4);Ze<rt;Ze++){var Me=Qe[Ze],Ue=parseFloat(Me);if(dt)if(Ze===0){var se=Me.match(/([a-z]*)$/)[1];Ue*={turn:360,rad:180/Math.PI,grad:.9}[se]||1}else Ze<3&&(Ue/=100);else Ze<3&&(Ue/=/%$/.test(Me)?100:255);Qe[Ze]=Ue}}else{var ne=V[Ie];if(!ne)if(c){Y||(Y=sn.getContext(1,1,{willReadFrequently:!0}),Y.globalCompositeOperation="copy"),Y.fillStyle="rgba(0,0,0,0)",Y.fillStyle=Ie,Y.fillRect(0,0,1,1);var $=Y.getImageData(0,0,1,1).data;ne=V[Ie]=[$[0]/255,$[1]/255,$[2]/255]}else ne=[0,0,0];Qe=ne.slice()}return[ze,Qe]}var fe=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],ve={"rgb-hsb":function(Ie,Ee,ze){var Qe=Math.max(Ie,Ee,ze),He=Math.min(Ie,Ee,ze),Ze=Qe-He,Ue=Ze===0?0:(Qe==Ie?(Ee-ze)/Ze+(Ee<ze?6:0):Qe==Ee?(ze-Ie)/Ze+2:(Ie-Ee)/Ze+4)*60;return[Ue,Qe===0?0:Ze/Qe,Qe]},"hsb-rgb":function(Ie,Ee,ze){Ie=(Ie/60%6+6)%6;var He=Math.floor(Ie),Qe=Ie-He,He=fe[He],Ze=[ze,ze*(1-Ee),ze*(1-Ee*Qe),ze*(1-Ee*(1-Qe))];return[Ze[He[0]],Ze[He[1]],Ze[He[2]]]},"rgb-hsl":function(Ie,Ee,ze){var Qe=Math.max(Ie,Ee,ze),He=Math.min(Ie,Ee,ze),Ze=Qe-He,Ue=Ze===0,dt=Ue?0:(Qe==Ie?(Ee-ze)/Ze+(Ee<ze?6:0):Qe==Ee?(ze-Ie)/Ze+2:(Ie-Ee)/Ze+4)*60,rt=(Qe+He)/2,Me=Ue?0:rt<.5?Ze/(Qe+He):Ze/(2-Qe-He);return[dt,Me,rt]},"hsl-rgb":function(Ie,Ee,ze){if(Ie=(Ie/360%1+1)%1,Ee===0)return[ze,ze,ze];for(var Qe=[Ie+1/3,Ie,Ie-1/3],He=ze<.5?ze*(1+Ee):ze+Ee-ze*Ee,Ze=2*ze-He,Ue=[],dt=0;dt<3;dt++){var rt=Qe[dt];rt<0&&(rt+=1),rt>1&&(rt-=1),Ue[dt]=6*rt<1?Ze+(He-Ze)*6*rt:2*rt<1?He:3*rt<2?Ze+(He-Ze)*(2/3-rt)*6:Ze}return Ue},"rgb-gray":function(Ie,Ee,ze){return[Ie*.2989+Ee*.587+ze*.114]},"gray-rgb":function(Ie){return[Ie,Ie,Ie]},"gray-hsb":function(Ie){return[0,0,Ie]},"gray-hsl":function(Ie){return[0,0,Ie]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return x.each(v,function(Ie,Ee){k[Ee]=[],x.each(Ie,function(ze,Qe){var He=x.capitalize(ze),Ze=/^(hue|saturation)$/.test(ze),Ue=k[Ee][Qe]=Ee==="gradient"?ze==="gradient"?function(dt){var rt=this._components[0];return dt=Ni.read(Array.isArray(dt)?dt:arguments,0,{readNull:!0}),rt!==dt&&(rt&&rt._removeOwner(this),dt&&dt._addOwner(this)),dt}:function(){return be.read(arguments,0,{readNull:ze==="highlight",clone:!0})}:function(dt){return dt==null||isNaN(dt)?0:+dt};this["get"+He]=function(){return this._type===Ee||Ze&&/^hs[bl]$/.test(this._type)?this._components[Qe]:this._convert(Ee)[Qe]},this["set"+He]=function(dt){this._type!==Ee&&!(Ze&&/^hs[bl]$/.test(this._type))&&(this._components=this._convert(Ee),this._properties=v[Ee],this._type=Ee),this._components[Qe]=Ue.call(this,dt),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function Ie(Ee){var ze=arguments,Qe=this.__read,He=0,Ze,Ue,dt,rt;Array.isArray(Ee)&&(ze=Ee,Ee=ze[0]);var Me=Ee!=null&&typeof Ee;if(Me==="string"&&Ee in v&&(Ze=Ee,Ee=ze[1],Array.isArray(Ee)?(Ue=Ee,dt=ze[2]):(Qe&&(He=1),ze=x.slice(ze,1),Me=typeof Ee)),!Ue){if(rt=Me==="number"?ze:Me==="object"&&Ee.length!=null?Ee:null,rt){Ze||(Ze=rt.length>=3?"rgb":"gray");var se=v[Ze].length;dt=rt[se],Qe&&(He+=rt===arguments?se+(dt!=null?1:0):1),rt.length>se&&(rt=x.slice(rt,0,se))}else if(Me==="string"){var ne=te(Ee);Ze=ne[0],Ue=ne[1],Ue.length===4&&(dt=Ue[3],Ue.length--)}else if(Me==="object")if(Ee.constructor===Ie){if(Ze=Ee._type,Ue=Ee._components.slice(),dt=Ee._alpha,Ze==="gradient")for(var $=1,ie=Ue.length;$<ie;$++){var de=Ue[$];de&&(Ue[$]=de.clone())}}else if(Ee.constructor===Ni)Ze="gradient",rt=ze;else{Ze="hue"in Ee?"lightness"in Ee?"hsl":"hsb":"gradient"in Ee||"stops"in Ee||"radial"in Ee?"gradient":"gray"in Ee?"gray":"rgb";var ye=v[Ze],ge=k[Ze];this._components=Ue=[];for(var $=0,ie=ye.length;$<ie;$++){var Pe=Ee[ye[$]];Pe==null&&!$&&Ze==="gradient"&&"stops"in Ee&&(Pe={stops:Ee.stops,radial:Ee.radial}),Pe=ge[$].call(this,Pe),Pe!=null&&(Ue[$]=Pe)}dt=Ee.alpha}Qe&&Ze&&(He=1)}if(this._type=Ze||"rgb",!Ue){this._components=Ue=[];for(var ge=k[this._type],$=0,ie=ge.length;$<ie;$++){var Pe=ge[$].call(this,rt&&rt[$]);Pe!=null&&(Ue[$]=Pe)}}return this._components=Ue,this._properties=v[this._type],this._alpha=dt,Qe&&(this.__read=He),this},set:"#initialize",_serialize:function(Ie,Ee){var ze=this.getComponents();return x.serialize(/^(gray|rgb)$/.test(this._type)?ze:[this._type].concat(ze),Ie,!0,Ee)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(Ie){var Ee;return this._type===Ie?this._components.slice():(Ee=ve[this._type+"-"+Ie])?Ee.apply(this,this._components):ve["rgb-"+Ie].apply(this,ve[this._type+"-rgb"].apply(this,this._components))},convert:function(Ie){return new Hi(Ie,this._convert(Ie),this._alpha)},getType:function(){return this._type},setType:function(Ie){this._components=this._convert(Ie),this._properties=v[Ie],this._type=Ie},getComponents:function(){var Ie=this._components.slice();return this._alpha!=null&&Ie.push(this._alpha),Ie},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(Ie){this._alpha=Ie==null?null:Math.min(Math.max(Ie,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(Ie){var Ee=x.isPlainValue(Ie,!0)?Hi.read(arguments):Ie;return Ee===this||Ee&&this._class===Ee._class&&this._type===Ee._type&&this.getAlpha()===Ee.getAlpha()&&x.equals(this._components,Ee._components)||!1},toString:function(){for(var Ie=this._properties,Ee=[],ze=this._type==="gradient",Qe=he.instance,He=0,Ze=Ie.length;He<Ze;He++){var Ue=this._components[He];Ue!=null&&Ee.push(Ie[He]+": "+(ze?Ue:Qe.number(Ue)))}return this._alpha!=null&&Ee.push("alpha: "+Qe.number(this._alpha)),"{ "+Ee.join(", ")+" }"},toCSS:function(Ie){var Ee=this._convert("rgb"),ze=Ie||this._alpha==null?1:this._alpha;function Qe(He){return Math.round((He<0?0:He>1?1:He)*255)}return Ee=[Qe(Ee[0]),Qe(Ee[1]),Qe(Ee[2])],ze<1&&Ee.push(ze<0?0:ze),Ie?"#"+((1<<24)+(Ee[0]<<16)+(Ee[1]<<8)+Ee[2]).toString(16).slice(1):(Ee.length==4?"rgba(":"rgb(")+Ee.join(",")+")"},toCanvasStyle:function(Ie,Ee){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var ze=this._components,Qe=ze[0],He=Qe._stops,Ze=ze[1],Ue=ze[2],dt=ze[3],rt=Ee&&Ee.inverted(),Me;if(rt&&(Ze=rt._transformPoint(Ze),Ue=rt._transformPoint(Ue),dt&&(dt=rt._transformPoint(dt))),Qe._radial){var se=Ue.getDistance(Ze);if(dt){var ne=dt.subtract(Ze);ne.getLength()>se&&(dt=Ze.add(ne.normalize(se-.1)))}var $=dt||Ze;Me=Ie.createRadialGradient($.x,$.y,0,Ze.x,Ze.y,se)}else Me=Ie.createLinearGradient(Ze.x,Ze.y,Ue.x,Ue.y);for(var ie=0,de=He.length;ie<de;ie++){var ye=He[ie],ge=ye._offset;Me.addColorStop(ge??ie/(de-1),ye._color.toCanvasStyle())}return this._canvasStyle=Me},transform:function(Ie){if(this._type==="gradient"){for(var Ee=this._components,ze=1,Qe=Ee.length;ze<Qe;ze++){var He=Ee[ze];Ie._transformPoint(He,He,!0)}this._changed()}},statics:{_types:v,random:function(){var Ie=Math.random;return new Hi(Ie(),Ie(),Ie())},_setOwner:function(Ie,Ee,ze){return Ie&&(Ie._owner&&Ee&&Ie._owner!==Ee&&(Ie=Ie.clone()),!Ie._owner^!Ee&&(Ie._owner=Ee||null,Ie._setter=ze||null)),Ie}}})},new function(){var v={add:function(k,V){return k+V},subtract:function(k,V){return k-V},multiply:function(k,V){return k*V},divide:function(k,V){return k/V}};return x.each(v,function(k,V){this[V]=function(Y){Y=Hi.read(arguments);for(var te=this._type,fe=this._components,ve=Y._convert(te),Ie=0,Ee=fe.length;Ie<Ee;Ie++)ve[Ie]=k(fe[Ie],ve[Ie]);return new Hi(te,ve,this._alpha!=null?k(this._alpha,Y.getAlpha()):null)}},{})}),Ni=x.extend({_class:"Gradient",initialize:function(k,V){this._id=ce.get(),k&&x.isPlainObject(k)&&(this.set(k),k=V=null),this._stops==null&&this.setStops(k||["white","black"]),this._radial==null&&this.setRadial(typeof V=="string"&&V==="radial"||V||!1)},_serialize:function(v,k){return k.add(this,function(){return x.serialize([this._stops,this._radial],v,!0,k)})},_changed:function(){for(var v=0,k=this._owners&&this._owners.length;v<k;v++)this._owners[v]._changed()},_addOwner:function(v){this._owners||(this._owners=[]),this._owners.push(v)},_removeOwner:function(v){var k=this._owners?this._owners.indexOf(v):-1;k!=-1&&(this._owners.splice(k,1),this._owners.length||(this._owners=n))},clone:function(){for(var v=[],k=0,V=this._stops.length;k<V;k++)v[k]=this._stops[k].clone();return new Ni(v,this._radial)},getStops:function(){return this._stops},setStops:function(v){if(v.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var k=this._stops;if(k)for(var V=0,Y=k.length;V<Y;V++)k[V]._owner=n;k=this._stops=nn.readList(v,0,{clone:!0});for(var V=0,Y=k.length;V<Y;V++)k[V]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(v){this._radial=v,this._changed()},equals:function(v){if(v===this)return!0;if(v&&this._class===v._class){var k=this._stops,V=v._stops,Y=k.length;if(Y===V.length){for(var te=0;te<Y;te++)if(!k[te].equals(V[te]))return!1;return!0}}return!1}}),nn=x.extend({_class:"GradientStop",initialize:function(k,V){var Y=k,te=V;typeof k=="object"&&V===n&&(Array.isArray(k)&&typeof k[0]!="number"?(Y=k[0],te=k[1]):("color"in k||"offset"in k||"rampPoint"in k)&&(Y=k.color,te=k.offset||k.rampPoint||0)),this.setColor(Y),this.setOffset(te)},clone:function(){return new nn(this._color.clone(),this._offset)},_serialize:function(v,k){var V=this._color,Y=this._offset;return x.serialize(Y==null?[V]:[V,Y],v,!0,k)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(v){this._offset=v,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){Hi._setOwner(this._color,null),this._color=Hi._setOwner(Hi.read(arguments,0),this,"setColor"),this._changed()},equals:function(v){return v===this||v&&this._class===v._class&&this._color.equals(v._color)&&this._offset==v._offset||!1}}),vn=x.extend(new function(){var v={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new be,selectedColor:null},k=x.set({},v,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),V=x.set({},k,{fillColor:new Hi}),Y={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},te={beans:!0},fe={_class:"Style",beans:!0,initialize:function(Ie,Ee,ze){this._values={},this._owner=Ee,this._project=Ee&&Ee._project||ze||pn.project,this._defaults=!Ee||Ee instanceof jt?k:Ee instanceof Ri?V:v,Ie&&this.set(Ie)}};return x.each(k,function(ve,Ie){var Ee=/Color$/.test(Ie),ze=Ie==="shadowOffset",Qe=x.capitalize(Ie),He=Y[Ie],Ze="set"+Qe,Ue="get"+Qe;fe[Ze]=function(dt){var rt=this._owner,Me=rt&&rt._children,se=Me&&Me.length>0&&!(rt instanceof gi);if(se)for(var ne=0,$=Me.length;ne<$;ne++)Me[ne]._style[Ze](dt);if((Ie==="selectedColor"||!se)&&Ie in this._defaults){var ie=this._values[Ie];ie!==dt&&(Ee&&(ie&&(Hi._setOwner(ie,null),ie._canvasStyle=null),dt&&dt.constructor===Hi&&(dt=Hi._setOwner(dt,rt,se&&Ze))),this._values[Ie]=dt,rt&&rt._changed(He||129))}},fe[Ue]=function(dt){var rt=this._owner,Me=rt&&rt._children,se=Me&&Me.length>0&&!(rt instanceof gi),ne;if(se&&!dt)for(var $=0,ie=Me.length;$<ie;$++){var de=Me[$]._style[Ue]();if(!$)ne=de;else if(!x.equals(ne,de))return n}else if(Ie in this._defaults){var ne=this._values[Ie];if(ne===n)ne=this._defaults[Ie],ne&&ne.clone&&(ne=ne.clone());else{var ye=Ee?Hi:ze?be:null;ye&&!(ne&&ne.constructor===ye)&&(this._values[Ie]=ne=ye.read([ne],0,{readNull:!0,clone:!0}))}}return ne&&Ee&&(ne=Hi._setOwner(ne,rt,se&&Ze)),ne},te[Ue]=function(dt){return this._style[Ue](dt)},te[Ze]=function(dt){this._style[Ze](dt)}}),x.each({Font:"FontFamily",WindingRule:"FillRule"},function(ve,Ie){var Ee="get"+Ie,ze="set"+Ie;fe[Ee]=te[Ee]="#get"+ve,fe[ze]=te[ze]="#set"+ve}),Oe.inject(te),fe},{set:function(v){var k=v instanceof vn,V=k?v._values:v;if(V){for(var Y in V)if(Y in this._defaults){var te=V[Y];this[Y]=te&&k&&te.clone?te.clone():te}}},equals:function(v){function k(V,Y,te){var fe=V._values,ve=Y._values,Ie=Y._defaults;for(var Ee in fe){var ze=fe[Ee],Qe=ve[Ee];if(!(te&&Ee in ve)&&!x.equals(ze,Qe===n?Ie[Ee]:Qe))return!1}return!0}return v===this||v&&this._class===v._class&&k(this,v)&&k(v,this,!0)||!1},_dispose:function(){var v;v=this.getFillColor(),v&&(v._canvasStyle=null),v=this.getStrokeColor(),v&&(v._canvasStyle=null),v=this.getShadowColor(),v&&(v._canvasStyle=null)},hasFill:function(){var v=this.getFillColor();return!!v&&v.alpha>0},hasStroke:function(){var v=this.getStrokeColor();return!!v&&v.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var v=this.getShadowColor();return!!v&&v.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var v=this.getFontSize();return this.getFontWeight()+" "+v+(/[a-z]/i.test(v+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function v(){var k=v.base.call(this),V=this.getFontSize();return/pt|em|%|px/.test(V)&&(V=this.getView().getPixelSize(V)),k??V*1.2}}),Ei=new function(){function v(k,V,Y,te){for(var fe=["","webkit","moz","Moz","ms","o"],ve=V[0].toUpperCase()+V.substring(1),Ie=0;Ie<6;Ie++){var Ee=fe[Ie],ze=Ee?Ee+ve:V;if(ze in k){if(Y)k[ze]=te;else return k[ze];break}}}return{getStyles:function(k){var V=k&&k.nodeType!==9?k.ownerDocument:k,Y=V&&V.defaultView;return Y&&Y.getComputedStyle(k,"")},getBounds:function(k,V){var Y=k.ownerDocument,te=Y.body,fe=Y.documentElement,ve;try{ve=k.getBoundingClientRect()}catch{ve={left:0,top:0,width:0,height:0}}var Ie=ve.left-(fe.clientLeft||te.clientLeft||0),Ee=ve.top-(fe.clientTop||te.clientTop||0);if(!V){var ze=Y.defaultView;Ie+=ze.pageXOffset||fe.scrollLeft||te.scrollLeft,Ee+=ze.pageYOffset||fe.scrollTop||te.scrollTop}return new it(Ie,Ee,ve.width,ve.height)},getViewportBounds:function(k){var V=k.ownerDocument,Y=V.defaultView,te=V.documentElement;return new it(0,0,Y.innerWidth||te.clientWidth,Y.innerHeight||te.clientHeight)},getOffset:function(k,V){return Ei.getBounds(k,V).getPoint()},getSize:function(k){return Ei.getBounds(k,!0).getSize()},isInvisible:function(k){return Ei.getSize(k).equals(new st(0,0))},isInView:function(k){return!Ei.isInvisible(k)&&Ei.getViewportBounds(k).intersects(Ei.getBounds(k,!0))},isInserted:function(k){return g.body.contains(k)},getPrefixed:function(k,V){return k&&v(k,V)},setPrefixed:function(k,V,Y){if(typeof V=="object")for(var te in V)v(k,te,!0,V[te]);else v(k,V,!0,Y)}}},mi={add:function(v,k){if(v)for(var V in k)for(var Y=k[V],te=V.split(/[\s,]+/g),fe=0,ve=te.length;fe<ve;fe++){var Ie=te[fe],Ee=v===g&&(Ie==="touchstart"||Ie==="touchmove")?{passive:!1}:!1;v.addEventListener(Ie,Y,Ee)}},remove:function(v,k){if(v)for(var V in k)for(var Y=k[V],te=V.split(/[\s,]+/g),fe=0,ve=te.length;fe<ve;fe++)v.removeEventListener(te[fe],Y,!1)},getPoint:function(v){var k=v.targetTouches?v.targetTouches.length?v.targetTouches[0]:v.changedTouches[0]:v;return new be(k.pageX||k.clientX+g.documentElement.scrollLeft,k.pageY||k.clientY+g.documentElement.scrollTop)},getTarget:function(v){return v.target||v.srcElement},getRelatedTarget:function(v){return v.relatedTarget||v.toElement},getOffset:function(v,k){return mi.getPoint(v).subtract(Ei.getOffset(k||mi.getTarget(v)))}};mi.requestAnimationFrame=new function(){var v=Ei.getPrefixed(c,"requestAnimationFrame"),k=!1,V=[],Y;function te(){var fe=V;V=[];for(var ve=0,Ie=fe.length;ve<Ie;ve++)fe[ve]();k=v&&V.length,k&&v(te)}return function(fe){V.push(fe),v?k||(v(te),k=!0):Y||(Y=setInterval(te,1e3/60))}};var zi=x.extend(S,{_class:"View",initialize:function v(k,V){function Y(He){return V[He]||parseInt(V.getAttribute(He),10)}function te(){var He=Ei.getSize(V);return He.isNaN()||He.isZero()?new st(Y("width"),Y("height")):He}var fe;if(c&&V){this._id=V.getAttribute("id"),this._id==null&&V.setAttribute("id",this._id="paper-view-"+v._id++),mi.add(V,this._viewEvents);var ve="none";if(Ei.setPrefixed(V.style,{userDrag:ve,userSelect:ve,touchCallout:ve,contentZooming:ve,tapHighlightColor:"rgba(0,0,0,0)"}),a.hasAttribute(V,"resize")){var Ie=this;mi.add(c,this._windowEvents={resize:function(){Ie.setViewSize(te())}})}if(fe=te(),a.hasAttribute(V,"stats")&&typeof Stats<"u"){this._stats=new Stats;var Ee=this._stats.domElement,ze=Ee.style,Qe=Ei.getOffset(V);ze.position="absolute",ze.left=Qe.x+"px",ze.top=Qe.y+"px",g.body.appendChild(Ee)}}else fe=new st(V),V=null;this._project=k,this._scope=k._scope,this._element=V,this._pixelRatio||(this._pixelRatio=c&&c.devicePixelRatio||1),this._setElementSize(fe.width,fe.height),this._viewSize=fe,v._views.push(this),v._viewsById[this._id]=this,(this._matrix=new Tt)._owner=this,v._focused||(v._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!pn.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;zi._focused===this&&(zi._focused=null),zi._views.splice(zi._views.indexOf(this),1),delete zi._viewsById[this._id];var v=this._project;return v._view===this&&(v._view=null),mi.remove(this._element,this._viewEvents),mi.remove(c,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:x.each(Oe._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(v){this[v]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(v){this._autoUpdate=v,v&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var v=this;mi.requestAnimationFrame(function(){if(v._requested=!1,v._animate){v.requestUpdate();var k=v._element;(!Ei.getPrefixed(g,"hidden")||a.getAttribute(k,"keepalive")==="true")&&Ei.isInView(k)&&v._handleFrame()}v._autoUpdate&&v.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){pn=this._scope;var v=Date.now()/1e3,k=this._last?v-this._last:0;this._last=v,this.emit("frame",new x({delta:k,time:this._time+=k,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(v,k){var V=this._frameItems;k?(V[v._id]={item:v,time:0,count:0},++this._frameItemCount===1&&this.on("frame",this._handleFrameItems)):(delete V[v._id],--this._frameItemCount===0&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(v){for(var k in this._frameItems){var V=this._frameItems[k];V.item.emit("frame",new x(v,{time:V.time+=v.delta,count:V.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=n},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var v=this._viewSize;return new Ye(v.width,v.height,this,"setViewSize")},setViewSize:function(){var v=st.read(arguments),k=v.subtract(this._viewSize);k.isZero()||(this._setElementSize(v.width,v.height),this._viewSize.set(v),this._changed(),this.emit("resize",{size:v,delta:k}),this._autoUpdate&&this.update())},_setElementSize:function(v,k){var V=this._element;V&&(V.width!==v&&(V.width=v),V.height!==k&&(V.height=k))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new it(new be,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return Ei.isInView(this._element)},isInserted:function(){return Ei.isInserted(this._element)},getPixelSize:function(v){var k=this._element,V;if(k){var Y=k.parentNode,te=g.createElement("div");te.style.fontSize=v,Y.appendChild(te),V=parseFloat(Ei.getStyles(te).fontSize),Y.removeChild(te)}else V=parseFloat(V);return V},getTextWidth:function(v,k){return 0}},x.each(["rotate","scale","shear","skew"],function(v){var k=v==="rotate";this[v]=function(){var V=arguments,Y=(k?x:be).read(V),te=be.read(V,0,{readNull:!0});return this.transform(new Tt()[v](Y,te||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var v=new Tt;return this.transform(v.translate.apply(v,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var v=be.read(arguments);this.translate(this.getCenter().subtract(v))},getZoom:function(){var v=this._decompose().scaling;return(v.x+v.y)/2},setZoom:function(v){this.transform(new Tt().scale(v/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(v){var k=this.getRotation();k!=null&&v!=null&&this.rotate(v-k)},getScaling:function(){var v=this._decompose().scaling;return new Je(v.x,v.y,this,"setScaling")},setScaling:function(){var v=this.getScaling(),k=be.read(arguments,0,{clone:!0,readNull:!0});v&&k&&this.scale(k.x/v.x,k.y/v.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var v=this._matrix;v.set.apply(v,arguments)},transform:function(v){this._matrix.append(v)},scrollBy:function(){this.translate(be.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(be.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(be.read(arguments))},getEventPoint:function(v){return this.viewToProject(mi.getOffset(v,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(v,k){g&&typeof k=="string"&&(k=g.getElementById(k));var V=c?Oi:zi;return new V(v,k)}}},new function(){if(!c)return;var v,k,V=!1,Y=!1;function te(Ke){var De=mi.getTarget(Ke);return De.getAttribute&&zi._viewsById[De.getAttribute("id")]}function fe(){var Ke=zi._focused;if(!Ke||!Ke.isVisible()){for(var De=0,Ge=zi._views.length;De<Ge;De++)if((Ke=zi._views[De]).isVisible()){zi._focused=k=Ke;break}}}function ve(Ke,De,Ge){Ke._handleMouseEvent("mousemove",De,Ge)}var Ie=c.navigator,Ee,ze,Qe;Ie.pointerEnabled||Ie.msPointerEnabled?(Ee="pointerdown MSPointerDown",ze="pointermove MSPointerMove",Qe="pointerup pointercancel MSPointerUp MSPointerCancel"):(Ee="touchstart",ze="touchmove",Qe="touchend touchcancel","ontouchstart"in c&&Ie.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(Ee+=" mousedown",ze+=" mousemove",Qe+=" mouseup"));var He={},Ze={mouseout:function(Ke){var De=zi._focused,Ge=mi.getRelatedTarget(Ke);if(De&&(!Ge||Ge.nodeName==="HTML")){var At=mi.getOffset(Ke,De._element),kt=At.x,o=Math.abs,ke=o(kt),oi=1<<25,fi=ke-oi;At.x=o(fi)<ke?fi*(kt<0?-1:1):kt,ve(De,Ke,De.viewToProject(At))}},scroll:fe};He[Ee]=function(Ke){var De=zi._focused=te(Ke);V||(V=!0,De._handleMouseEvent("mousedown",Ke))},Ze[ze]=function(Ke){var De=zi._focused;if(!Y){var Ge=te(Ke);Ge?De!==Ge&&(De&&ve(De,Ke),v||(v=De),De=zi._focused=k=Ge):k&&k===De&&(v&&!v.isInserted()&&(v=null),De=zi._focused=v,v=null,fe())}De&&ve(De,Ke)},Ze[Ee]=function(){Y=!0},Ze[Qe]=function(Ke){var De=zi._focused;De&&V&&De._handleMouseEvent("mouseup",Ke),Y=V=!1},mi.add(g,Ze),mi.add(c,{load:fe});var Ue=!1,dt=!1,rt={doubleclick:"click",mousedrag:"mousemove"},Me=!1,se,ne,$,ie,de,ye,ge,Pe;function Fe(Ke,De,Ge,At,kt,o,ke){var oi=!1,fi;function Ai(ti,li){if(ti.responds(li)){if(fi||(fi=new rn(li,At,kt,De||ti,o?kt.subtract(o):null)),ti.emit(li,fi)&&(Ue=!0,fi.prevented&&(dt=!0),fi.stopped))return oi=!0}else{var Bi=rt[li];if(Bi)return Ai(ti,Bi)}}for(;Ke&&Ke!==ke&&!Ai(Ke,Ge);)Ke=Ke._parent;return oi}function Ve(Ke,De,Ge,At,kt,o){return Ke._project.removeOn(Ge),dt=Ue=!1,de&&Fe(de,null,Ge,At,kt,o)||De&&De!==de&&!De.isDescendant(de)&&Fe(De,null,Ge==="mousedrag"?"mousemove":Ge,At,kt,o,de)||Fe(Ke,de||De||Ke,Ge,At,kt,o)}var Xe={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:He,_handleMouseEvent:function(Ke,De,Ge){var At=this._itemEvents,kt=At.native[Ke],o=Ke==="mousemove",ke=this._scope.tool,oi=this;function fi(Jt){return At.virtual[Jt]||oi.responds(Jt)||ke&&ke.responds(Jt)}o&&V&&fi("mousedrag")&&(Ke="mousedrag"),Ge||(Ge=this.getEventPoint(De));var Ai=this.getBounds().contains(Ge),ti=kt&&Ai&&oi._project.hitTest(Ge,{tolerance:0,fill:!0,stroke:!0}),li=ti&&ti.item||null,Bi=!1,vi={};if(vi[Ke.substr(5)]=!0,kt&&li!==ie&&(ie&&Fe(ie,null,"mouseleave",De,Ge),li&&Fe(li,null,"mouseenter",De,Ge),ie=li),Me^Ai&&(Fe(this,null,Ai?"mouseenter":"mouseleave",De,Ge),Bi=!0),(Ai||vi.drag)&&!Ge.equals(ne)&&(Ve(this,li,o?Ke:"mousemove",De,Ge,ne),Bi=!0),Me=Ai,vi.down&&Ai||vi.up&&se){if(Ve(this,li,Ke,De,Ge,se),vi.down){if(Pe=li===ye&&Date.now()-ge<300,$=ye=li,!dt&&li){for(var bi=li;bi&&!bi.responds("mousedrag");)bi=bi._parent;bi&&(de=li)}se=Ge}else vi.up&&(!dt&&li===$&&(ge=Date.now(),Ve(this,li,Pe?"doubleclick":"click",De,Ge,se),Pe=!1),$=de=null);Me=!1,Bi=!0}ne=Ge,Bi&&ke&&(Ue=ke._handleMouseEvent(Ke,De,Ge,vi)||Ue),De.cancelable!==!1&&(Ue&&!vi.move||vi.down&&fi("mouseup"))&&De.preventDefault()},_handleKeyEvent:function(Ke,De,Ge,At){var kt=this._scope,o=kt.tool,ke;function oi(fi){fi.responds(Ke)&&(pn=kt,fi.emit(Ke,ke=ke||new bn(Ke,De,Ge,At)))}this.isVisible()&&(oi(this),o&&o.responds(Ke)&&oi(o))},_countItemEvent:function(Ke,De){var Ge=this._itemEvents,At=Ge.native,kt=Ge.virtual;for(var o in Xe)At[o]=(At[o]||0)+(Xe[o][Ke]||0)*De;kt[Ke]=(kt[Ke]||0)+De},statics:{updateFocus:fe,_resetState:function(){V=Y=Ue=Me=!1,v=k=se=ne=$=ie=de=ye=ge=Pe=null}}}}),Oi=zi.extend({_class:"CanvasView",initialize:function(k,V){if(!(V instanceof c.HTMLCanvasElement)){var Y=st.read(arguments,1);if(Y.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+x.slice(arguments,1));V=sn.getCanvas(Y)}var te=this._context=V.getContext("2d");if(te.save(),this._pixelRatio=1,!/^off|false$/.test(a.getAttribute(V,"hidpi"))){var fe=c.devicePixelRatio||1,ve=Ei.getPrefixed(te,"backingStorePixelRatio")||1;this._pixelRatio=fe/ve}zi.call(this,k,V),this._needsUpdate=!0},remove:function v(){return this._context.restore(),v.base.call(this)},_setElementSize:function v(k,V){var Y=this._pixelRatio;if(v.base.call(this,k*Y,V*Y),Y!==1){var te=this._element,fe=this._context;if(!a.hasAttribute(te,"resize")){var ve=te.style;ve.width=k+"px",ve.height=V+"px"}fe.restore(),fe.save(),fe.scale(Y,Y)}},getContext:function(){return this._context},getPixelSize:function v(k){var V=pn.agent,Y;if(V&&V.firefox)Y=v.base.call(this,k);else{var te=this._context,fe=te.font;te.font=k+" serif",Y=parseFloat(te.font),te.font=fe}return Y},getTextWidth:function(v,k){var V=this._context,Y=V.font,te=0;V.font=v;for(var fe=0,ve=k.length;fe<ve;fe++)te=Math.max(te,V.measureText(k[fe]).width);return V.font=Y,te},update:function(){if(!this._needsUpdate)return!1;var v=this._project,k=this._context,V=this._viewSize;return k.clearRect(0,0,V.width+1,V.height+1),v&&v.draw(k,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),xn=x.extend({_class:"Event",initialize:function(k){this.event=k,this.type=k&&k.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return Yt.modifiers}}),bn=xn.extend({_class:"KeyEvent",initialize:function(k,V,Y,te){this.type=k,this.event=V,this.key=Y,this.character=te},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),Yt=new function(){var v={"	":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},k={tab:"	",space:" ",enter:"\r"},V={},Y={},te,fe,ve=new x({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var ze=pn&&pn.agent;return ze&&ze.mac?this.meta:this.control}}});function Ie(ze){var Qe=ze.key||ze.keyIdentifier;return Qe=/^U\+/.test(Qe)?String.fromCharCode(parseInt(Qe.substr(2),16)):/^Arrow[A-Z]/.test(Qe)?Qe.substr(5):Qe==="Unidentified"||Qe===n?String.fromCharCode(ze.keyCode):Qe,v[Qe]||(Qe.length>1?x.hyphenate(Qe):Qe.toLowerCase())}function Ee(ze,Qe,He,Ze){var Ue=zi._focused,dt;if(V[Qe]=ze,ze?Y[Qe]=He:delete Y[Qe],Qe.length>1&&(dt=x.camelize(Qe))in ve){ve[dt]=ze;var rt=pn&&pn.agent;if(dt==="meta"&&rt&&rt.mac)if(ze)te={};else{for(var Me in te)Me in Y&&Ee(!1,Me,te[Me],Ze);te=null}}else ze&&te&&(te[Qe]=He);Ue&&Ue._handleKeyEvent(ze?"keydown":"keyup",Ze,Qe,He)}return mi.add(g,{keydown:function(ze){var Qe=Ie(ze),He=pn&&pn.agent;Qe.length>1||He&&He.chrome&&(ze.altKey||He.mac&&ze.metaKey||!He.mac&&ze.ctrlKey)?Ee(!0,Qe,k[Qe]||(Qe.length>1?"":Qe),ze):fe=Qe},keypress:function(ze){if(fe){var Qe=Ie(ze),He=ze.charCode,Ze=He>=32?String.fromCharCode(He):Qe.length>1?"":Qe;Qe!==fe&&(Qe=Ze.toLowerCase()),Ee(!0,Qe,Ze,ze),fe=null}},keyup:function(ze){var Qe=Ie(ze);Qe in Y&&Ee(!1,Qe,Y[Qe],ze)}}),mi.add(c,{blur:function(ze){for(var Qe in Y)Ee(!1,Qe,Y[Qe],ze)}}),{modifiers:ve,isDown:function(ze){return!!V[ze]}}},rn=xn.extend({_class:"MouseEvent",initialize:function(k,V,Y,te,fe){this.type=k,this.event=V,this.point=Y,this.target=te,this.delta=fe},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),Xt=xn.extend({_class:"ToolEvent",_item:null,initialize:function(k,V,Y){this.tool=k,this.type=V,this.event=Y},_choosePoint:function(v,k){return v||(k?k.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(v){this._point=v},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(v){this._lastPoint=v},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(v){this._downPoint=v},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(v){this._middlePoint=v},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(v){this._delta=v},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(v){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=v},getItem:function(){if(!this._item){var v=this.tool._scope.project.hitTest(this.getPoint());if(v){for(var k=v.item,V=k._parent;/^(Group|CompoundPath)$/.test(V._class);)k=V,V=V._parent;this._item=k}}return this._item},setItem:function(v){this._item=v},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),Ji=U.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(k){U.call(this),this._moveCount=-1,this._downCount=-1,this.set(k)},getMinDistance:function(){return this._minDistance},setMinDistance:function(v){this._minDistance=v,v!=null&&this._maxDistance!=null&&v>this._maxDistance&&(this._maxDistance=v)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(v){this._maxDistance=v,this._minDistance!=null&&v!=null&&v<this._minDistance&&(this._minDistance=v)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(v){this._minDistance=this._maxDistance=v},_handleMouseEvent:function(v,k,V,Y){pn=this._scope,Y.drag&&!this.responds(v)&&(v="mousemove");var te=Y.move||Y.drag,fe=this.responds(v),ve=this.minDistance,Ie=this.maxDistance,Ee=!1,ze=this;function Qe(Ze,Ue){var dt=V,rt=te?ze._point:ze._downPoint||dt;if(te){if(ze._moveCount>=0&&dt.equals(rt))return!1;if(rt&&(Ze!=null||Ue!=null)){var Me=dt.subtract(rt),se=Me.getLength();if(se<(Ze||0))return!1;Ue&&(dt=rt.add(Me.normalize(Math.min(se,Ue))))}ze._moveCount++}return ze._point=dt,ze._lastPoint=rt||dt,Y.down&&(ze._moveCount=-1,ze._downPoint=dt,ze._downCount++),!0}function He(){fe&&(Ee=ze.emit(v,new Xt(ze,v,k))||Ee)}if(Y.down)Qe(),He();else if(Y.up)Qe(null,Ie),He();else if(fe)for(;Qe(ve,Ie);)He();return Ee}}),mr=x.extend(S,{_class:"Tween",statics:{easings:new x({linear:function(v){return v},easeInQuad:function(v){return v*v},easeOutQuad:function(v){return v*(2-v)},easeInOutQuad:function(v){return v<.5?2*v*v:-1+2*(2-v)*v},easeInCubic:function(v){return v*v*v},easeOutCubic:function(v){return--v*v*v+1},easeInOutCubic:function(v){return v<.5?4*v*v*v:(v-1)*(2*v-2)*(2*v-2)+1},easeInQuart:function(v){return v*v*v*v},easeOutQuart:function(v){return 1- --v*v*v*v},easeInOutQuart:function(v){return v<.5?8*v*v*v*v:1-8*--v*v*v*v},easeInQuint:function(v){return v*v*v*v*v},easeOutQuint:function(v){return 1+--v*v*v*v*v},easeInOutQuint:function(v){return v<.5?16*v*v*v*v*v:1+16*--v*v*v*v*v}})},initialize:function v(k,V,Y,te,fe,ve){this.object=k;var Ie=typeof fe,Ee=Ie==="function";this.type=Ee?Ie:Ie==="string"?fe:"linear",this.easing=Ee?fe:v.easings[this.type],this.duration=te,this.running=!1,this._then=null,this._startTime=null;var ze=V||Y;this._keys=ze?Object.keys(ze):[],this._parsedKeys=this._parseKeys(this._keys),this._from=ze&&this._getState(V),this._to=ze&&this._getState(Y),ve!==!1&&this.start()},then:function(v){return this._then=v,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(v){if(this.running){v>=1&&(v=1,this.running=!1);for(var k=this.easing(v),V=this._keys,Y=function(Qe){return typeof Qe=="function"?Qe(k,v):Qe},te=0,fe=V&&V.length;te<fe;te++){var ve=V[te],Ie=Y(this._from[ve]),Ee=Y(this._to[ve]),ze=Ie&&Ee&&Ie.__add&&Ee.__add?Ee.__subtract(Ie).__multiply(k).__add(Ie):(Ee-Ie)*k+Ie;this._setProperty(this._parsedKeys[ve],ze)}this.responds("update")&&this.emit("update",new x({progress:v,factor:k})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(v){var k=this._startTime,V=k?(v-k)/this.duration:0;k||(this._startTime=v),this.update(V)},_getState:function(v){for(var k=this._keys,V={},Y=0,te=k.length;Y<te;Y++){var fe=k[Y],ve=this._parsedKeys[fe],Ie=this._getProperty(ve),Ee;if(v){var ze=this._resolveValue(Ie,v[fe]);this._setProperty(ve,ze),Ee=this._getProperty(ve),Ee=Ee&&Ee.clone?Ee.clone():Ee,this._setProperty(ve,Ie)}else Ee=Ie&&Ie.clone?Ie.clone():Ie;V[fe]=Ee}return V},_resolveValue:function(v,k){if(k){if(Array.isArray(k)&&k.length===2){var V=k[0];return V&&V.match&&V.match(/^[+\-\*\/]=/)?this._calculate(v,V[0],k[1]):k}else if(typeof k=="string"){var Y=k.match(/^[+\-*/]=(.*)/);if(Y){var te=JSON.parse(Y[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(v,k[0],te)}}}return k},_calculate:function(v,k,V){return pn.PaperScript.calculateBinary(v,k,V)},_parseKeys:function(v){for(var k={},V=0,Y=v.length;V<Y;V++){var te=v[V],fe=te.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");k[te]=fe.split("/")}return k},_getProperty:function(v,k){for(var V=this.object,Y=0,te=v.length-(k||0);Y<te&&V;Y++)V=V[v[Y]];return V},_setProperty:function(v,k){var V=this._getProperty(v,1);V&&(V[v[v.length-1]]=k)}}),ci={request:function(v){var k=new t.XMLHttpRequest;return k.open((v.method||"get").toUpperCase(),v.url,x.pick(v.async,!0)),v.mimeType&&k.overrideMimeType(v.mimeType),k.onload=function(){var V=k.status;V===0||V===200?v.onLoad&&v.onLoad.call(k,k.responseText):k.onerror()},k.onerror=function(){var V=k.status,Y='Could not load "'+v.url+'" (Status: '+V+")";if(v.onError)v.onError(Y,V);else throw new Error(Y)},k.send(null)}},sn=x.exports.CanvasProvider={canvases:[],getCanvas:function(v,k,V){if(!c)return null;var Y,te=!0;typeof v=="object"&&(k=v.height,v=v.width),this.canvases.length?Y=this.canvases.pop():(Y=g.createElement("canvas"),te=!1);var fe=Y.getContext("2d",V||{});if(!fe)throw new Error("Canvas "+Y+" is unable to provide a 2D context.");return Y.width===v&&Y.height===k?te&&fe.clearRect(0,0,v+1,k+1):(Y.width=v,Y.height=k),fe.save(),Y},getContext:function(v,k,V){var Y=this.getCanvas(v,k,V);return Y?Y.getContext("2d",V||{}):null},release:function(v){var k=v&&v.canvas?v.canvas:v;k&&k.getContext&&(k.getContext("2d").restore(),this.canvases.push(k))}},lr=new function(){var v=Math.min,k=Math.max,V=Math.abs,Y,te,fe,ve,Ie,Ee,ze,Qe,He,Ze,Ue;function dt(de,ye,ge){return .2989*de+.587*ye+.114*ge}function rt(de,ye,ge,Ve){var Fe=Ve-dt(de,ye,ge);He=de+Fe,Ze=ye+Fe,Ue=ge+Fe;var Ve=dt(He,Ze,Ue),Xe=v(He,Ze,Ue),Ke=k(He,Ze,Ue);if(Xe<0){var De=Ve-Xe;He=Ve+(He-Ve)*Ve/De,Ze=Ve+(Ze-Ve)*Ve/De,Ue=Ve+(Ue-Ve)*Ve/De}if(Ke>255){var Ge=255-Ve,At=Ke-Ve;He=Ve+(He-Ve)*Ge/At,Ze=Ve+(Ze-Ve)*Ge/At,Ue=Ve+(Ue-Ve)*Ge/At}}function Me(de,ye,ge){return k(de,ye,ge)-v(de,ye,ge)}function se(de,ye,ge,Pe){var Fe=[de,ye,ge],Ve=k(de,ye,ge),Xe=v(de,ye,ge),Ke;Xe=Xe===de?0:Xe===ye?1:2,Ve=Ve===de?0:Ve===ye?1:2,Ke=v(Xe,Ve)===0?k(Xe,Ve)===1?2:1:0,Fe[Ve]>Fe[Xe]?(Fe[Ke]=(Fe[Ke]-Fe[Xe])*Pe/(Fe[Ve]-Fe[Xe]),Fe[Ve]=Pe):Fe[Ke]=Fe[Ve]=0,Fe[Xe]=0,He=Fe[0],Ze=Fe[1],Ue=Fe[2]}var ne={multiply:function(){He=Ie*Y/255,Ze=Ee*te/255,Ue=ze*fe/255},screen:function(){He=Ie+Y-Ie*Y/255,Ze=Ee+te-Ee*te/255,Ue=ze+fe-ze*fe/255},overlay:function(){He=Ie<128?2*Ie*Y/255:255-2*(255-Ie)*(255-Y)/255,Ze=Ee<128?2*Ee*te/255:255-2*(255-Ee)*(255-te)/255,Ue=ze<128?2*ze*fe/255:255-2*(255-ze)*(255-fe)/255},"soft-light":function(){var de=Y*Ie/255;He=de+Ie*(255-(255-Ie)*(255-Y)/255-de)/255,de=te*Ee/255,Ze=de+Ee*(255-(255-Ee)*(255-te)/255-de)/255,de=fe*ze/255,Ue=de+ze*(255-(255-ze)*(255-fe)/255-de)/255},"hard-light":function(){He=Y<128?2*Y*Ie/255:255-2*(255-Y)*(255-Ie)/255,Ze=te<128?2*te*Ee/255:255-2*(255-te)*(255-Ee)/255,Ue=fe<128?2*fe*ze/255:255-2*(255-fe)*(255-ze)/255},"color-dodge":function(){He=Ie===0?0:Y===255?255:v(255,255*Ie/(255-Y)),Ze=Ee===0?0:te===255?255:v(255,255*Ee/(255-te)),Ue=ze===0?0:fe===255?255:v(255,255*ze/(255-fe))},"color-burn":function(){He=Ie===255?255:Y===0?0:k(0,255-(255-Ie)*255/Y),Ze=Ee===255?255:te===0?0:k(0,255-(255-Ee)*255/te),Ue=ze===255?255:fe===0?0:k(0,255-(255-ze)*255/fe)},darken:function(){He=Ie<Y?Ie:Y,Ze=Ee<te?Ee:te,Ue=ze<fe?ze:fe},lighten:function(){He=Ie>Y?Ie:Y,Ze=Ee>te?Ee:te,Ue=ze>fe?ze:fe},difference:function(){He=Ie-Y,He<0&&(He=-He),Ze=Ee-te,Ze<0&&(Ze=-Ze),Ue=ze-fe,Ue<0&&(Ue=-Ue)},exclusion:function(){He=Ie+Y*(255-Ie-Ie)/255,Ze=Ee+te*(255-Ee-Ee)/255,Ue=ze+fe*(255-ze-ze)/255},hue:function(){se(Y,te,fe,Me(Ie,Ee,ze)),rt(He,Ze,Ue,dt(Ie,Ee,ze))},saturation:function(){se(Ie,Ee,ze,Me(Y,te,fe)),rt(He,Ze,Ue,dt(Ie,Ee,ze))},luminosity:function(){rt(Ie,Ee,ze,dt(Y,te,fe))},color:function(){rt(Y,te,fe,dt(Ie,Ee,ze))},add:function(){He=v(Ie+Y,255),Ze=v(Ee+te,255),Ue=v(ze+fe,255)},subtract:function(){He=k(Ie-Y,0),Ze=k(Ee-te,0),Ue=k(ze-fe,0)},average:function(){He=(Ie+Y)/2,Ze=(Ee+te)/2,Ue=(ze+fe)/2},negation:function(){He=255-V(255-Y-Ie),Ze=255-V(255-te-Ee),Ue=255-V(255-fe-ze)}},$=this.nativeModes=x.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(de){this[de]=!0},{}),ie=sn.getContext(1,1,{willReadFrequently:!0});ie&&(x.each(ne,function(de,ye){var ge=ye==="darken",Pe=!1;ie.save();try{ie.fillStyle=ge?"#300":"#a00",ie.fillRect(0,0,1,1),ie.globalCompositeOperation=ye,ie.globalCompositeOperation===ye&&(ie.fillStyle=ge?"#a00":"#300",ie.fillRect(0,0,1,1),Pe=ie.getImageData(0,0,1,1).data[0]!==ge?170:51)}catch{}ie.restore(),$[ye]=Pe}),sn.release(ie)),this.process=function(de,ye,ge,Pe,Fe){var Ve=ye.canvas,Xe=de==="normal";if(Xe||$[de])ge.save(),ge.setTransform(1,0,0,1,0,0),ge.globalAlpha=Pe,Xe||(ge.globalCompositeOperation=de),ge.drawImage(Ve,Fe.x,Fe.y),ge.restore();else{var Ke=ne[de];if(!Ke)return;for(var De=ge.getImageData(Fe.x,Fe.y,Ve.width,Ve.height),Ge=De.data,At=ye.getImageData(0,0,Ve.width,Ve.height).data,kt=0,o=Ge.length;kt<o;kt+=4){Y=At[kt],Ie=Ge[kt],te=At[kt+1],Ee=Ge[kt+1],fe=At[kt+2],ze=Ge[kt+2],ve=At[kt+3],Qe=Ge[kt+3],Ke();var ke=ve*Pe/255,oi=1-ke;Ge[kt]=ke*He+oi*Ie,Ge[kt+1]=ke*Ze+oi*Ee,Ge[kt+2]=ke*Ue+oi*ze,Ge[kt+3]=ve*Pe+oi*Qe}ge.putImageData(De,Fe.x,Fe.y)}}},On=new function(){var v="http://www.w3.org/2000/svg",k="http://www.w3.org/2000/xmlns",V="http://www.w3.org/1999/xlink",Y={href:V,xlink:k,xmlns:k+"/","xmlns:xlink":k+"/"};function te(Ie,Ee,ze){return ve(g.createElementNS(v,Ie),Ee,ze)}function fe(Ie,Ee){var ze=Y[Ee],Qe=ze?Ie.getAttributeNS(ze,Ee):Ie.getAttribute(Ee);return Qe==="null"?null:Qe}function ve(Ie,Ee,ze){for(var Qe in Ee){var He=Ee[Qe],Ze=Y[Qe];typeof He=="number"&&ze&&(He=ze.number(He)),Ze?Ie.setAttributeNS(Ze,Qe,He):Ie.setAttribute(Qe,He)}return Ie}return{svg:v,xmlns:k,xlink:V,create:te,get:fe,set:ve}},Gn=x.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(v,k){return!k&&(v instanceof Bt||v instanceof _t||v instanceof Ri)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(v,k){var V=x.capitalize(k),Y=v[2];this[k]={type:v[1],property:k,attribute:v[0],toSVG:Y,fromSVG:Y&&x.each(Y,function(te,fe){this[te]=fe},{}),exportFilter:v[3],get:"get"+V,set:"set"+V}},{});new function(){var v;function k(ne,$,ie){var de=new x,ye=ne.getTranslation();if($){var ge;ne.isInvertible()?(ne=ne._shiftless(),ge=ne._inverseTransform(ye),ye=null):ge=new be,de[ie?"cx":"x"]=ge.x,de[ie?"cy":"y"]=ge.y}if(!ne.isIdentity()){var Pe=ne.decompose();if(Pe){var Fe=[],Ve=Pe.rotation,Xe=Pe.scaling,Ke=Pe.skewing;ye&&!ye.isZero()&&Fe.push("translate("+v.point(ye)+")"),Ve&&Fe.push("rotate("+v.number(Ve)+")"),(!ae.isZero(Xe.x-1)||!ae.isZero(Xe.y-1))&&Fe.push("scale("+v.point(Xe)+")"),Ke.x&&Fe.push("skewX("+v.number(Ke.x)+")"),Ke.y&&Fe.push("skewY("+v.number(Ke.y)+")"),de.transform=Fe.join(" ")}else de.transform="matrix("+ne.getValues().join(",")+")"}return de}function V(ne,$){for(var ie=k(ne._matrix),de=ne._children,ye=On.create("g",ie,v),ge=0,Pe=de.length;ge<Pe;ge++){var Fe=de[ge],Ve=Me(Fe,$);if(Ve)if(Fe.isClipMask()){var Xe=On.create("clipPath");Xe.appendChild(Ve),dt(Fe,Xe,"clip"),On.set(ye,{"clip-path":"url(#"+Xe.id+")"})}else ye.appendChild(Ve)}return ye}function Y(ne,$){var ie=k(ne._matrix,!0),de=ne.getSize(),ye=ne.getImage();return ie.x-=de.width/2,ie.y-=de.height/2,ie.width=de.width,ie.height=de.height,ie.href=$.embedImages==!1&&ye&&ye.src||ne.toDataURL(),On.create("image",ie,v)}function te(ne,$){var ie=$.matchShapes;if(ie){var de=ne.toShape(!1);if(de)return fe(de)}var ye=ne._segments,ge=ye.length,Pe,Fe=k(ne._matrix);if(ie&&ge>=2&&!ne.hasHandles())if(ge>2){Pe=ne._closed?"polygon":"polyline";for(var Ve=[],Xe=0;Xe<ge;Xe++)Ve.push(v.point(ye[Xe]._point));Fe.points=Ve.join(" ")}else{Pe="line";var Ke=ye[0]._point,De=ye[1]._point;Fe.set({x1:Ke.x,y1:Ke.y,x2:De.x,y2:De.y})}else Pe="path",Fe.d=ne.getPathData(null,$.precision);return On.create(Pe,Fe,v)}function fe(ne){var $=ne._type,ie=ne._radius,de=k(ne._matrix,!0,$!=="rectangle");if($==="rectangle"){$="rect";var ye=ne._size,ge=ye.width,Pe=ye.height;de.x-=ge/2,de.y-=Pe/2,de.width=ge,de.height=Pe,ie.isZero()&&(ie=null)}return ie&&($==="circle"?de.r=ie:(de.rx=ie.width,de.ry=ie.height)),On.create($,de,v)}function ve(ne,$){var ie=k(ne._matrix),de=ne.getPathData(null,$.precision);return de&&(ie.d=de),On.create("path",ie,v)}function Ie(ne,$){var ie=k(ne._matrix,!0),de=ne._definition,ye=Ue(de,"symbol"),ge=de._item,Pe=ge.getStrokeBounds();return ye||(ye=On.create("symbol",{viewBox:v.rectangle(Pe)}),ye.appendChild(Me(ge,$)),dt(de,ye,"symbol")),ie.href="#"+ye.id,ie.x+=Pe.x,ie.y+=Pe.y,ie.width=Pe.width,ie.height=Pe.height,ie.overflow="visible",On.create("use",ie,v)}function Ee(ne){var $=Ue(ne,"color");if(!$){var ie=ne.getGradient(),de=ie._radial,ye=ne.getOrigin(),ge=ne.getDestination(),Pe;if(de){Pe={cx:ye.x,cy:ye.y,r:ye.getDistance(ge)};var Fe=ne.getHighlight();Fe&&(Pe.fx=Fe.x,Pe.fy=Fe.y)}else Pe={x1:ye.x,y1:ye.y,x2:ge.x,y2:ge.y};Pe.gradientUnits="userSpaceOnUse",$=On.create((de?"radial":"linear")+"Gradient",Pe,v);for(var Ve=ie._stops,Xe=0,Ke=Ve.length;Xe<Ke;Xe++){var De=Ve[Xe],Ge=De._color,At=Ge.getAlpha(),kt=De._offset;Pe={offset:kt??Xe/(Ke-1)},Ge&&(Pe["stop-color"]=Ge.toCSS(!0)),At<1&&(Pe["stop-opacity"]=At),$.appendChild(On.create("stop",Pe,v))}dt(ne,$,"color")}return"url(#"+$.id+")"}function ze(ne){var $=On.create("text",k(ne._matrix,!0),v);return $.textContent=ne._content,$}var Qe={Group:V,Layer:V,Raster:Y,Path:te,Shape:fe,CompoundPath:ve,SymbolItem:Ie,PointText:ze};function He(ne,$,ie){var de={},ye=!ie&&ne.getParent(),ge=[];return ne._name!=null&&(de.id=ne._name),x.each(Gn,function(Pe){var Fe=Pe.get,Ve=Pe.type,Xe=ne[Fe]();if(Pe.exportFilter?Pe.exportFilter(ne,Xe):!ye||!x.equals(ye[Fe](),Xe)){if(Ve==="color"&&Xe!=null){var Ke=Xe.getAlpha();Ke<1&&(de[Pe.attribute+"-opacity"]=Ke)}Ve==="style"?ge.push(Pe.attribute+": "+Xe):de[Pe.attribute]=Xe==null?"none":Ve==="color"?Xe.gradient?Ee(Xe):Xe.toCSS(!0):Ve==="array"?Xe.join(","):Ve==="lookup"?Pe.toSVG[Xe]:Xe}}),ge.length&&(de.style=ge.join(";")),de.opacity===1&&delete de.opacity,ne._visible||(de.visibility="hidden"),On.set($,de,v)}var Ze;function Ue(ne,$){return Ze||(Ze={ids:{},svgs:{}}),ne&&Ze.svgs[$+"-"+(ne._id||ne.__id||(ne.__id=ce.get("svg")))]}function dt(ne,$,ie){Ze||Ue();var de=Ze.ids[ie]=(Ze.ids[ie]||0)+1;$.id=ie+"-"+de,Ze.svgs[ie+"-"+(ne._id||ne.__id)]=$}function rt(ne,$){var ie=ne,de=null;if(Ze){ie=ne.nodeName.toLowerCase()==="svg"&&ne;for(var ye in Ze.svgs)de||(ie||(ie=On.create("svg"),ie.appendChild(ne)),de=ie.insertBefore(On.create("defs"),ie.firstChild)),de.appendChild(Ze.svgs[ye]);Ze=null}return $.asString?new t.XMLSerializer().serializeToString(ie):ie}function Me(ne,$,ie){var de=Qe[ne._class],ye=de&&de(ne,$);if(ye){var ge=$.onExport;ge&&(ye=ge(ne,ye,$)||ye);var Pe=JSON.stringify(ne._data);Pe&&Pe!=="{}"&&Pe!=="null"&&ye.setAttribute("data-paper-data",Pe)}return ye&&He(ne,ye,ie)}function se(ne){return ne||(ne={}),v=new he(ne.precision),ne}Oe.inject({exportSVG:function(ne){return ne=se(ne),rt(Me(this,ne,!0),ne)}}),Rt.inject({exportSVG:function(ne){ne=se(ne);var $=this._children,ie=this.getView(),de=x.pick(ne.bounds,"view"),ye=ne.matrix||de==="view"&&ie._matrix,ge=ye&&Tt.read([ye]),Pe=de==="view"?new it([0,0],ie.getViewSize()):de==="content"?Oe._getBounds($,ge,{stroke:!0}).rect:it.read([de],0,{readNull:!0}),Fe={version:"1.1",xmlns:On.svg,"xmlns:xlink":On.xlink};Pe&&(Fe.width=Pe.width,Fe.height=Pe.height,(Pe.x||Pe.x===0||Pe.y||Pe.y===0)&&(Fe.viewBox=v.rectangle(Pe)));var Ve=On.create("svg",Fe,v),Xe=Ve;ge&&!ge.isIdentity()&&(Xe=Ve.appendChild(On.create("g",k(ge),v)));for(var Ke=0,De=$.length;Ke<De;Ke++)Xe.appendChild(Me($[Ke],ne,!0));return rt(Ve,ne)}})},new function(){var v={},k;function V($,ie,de,ye,ge,Pe){var Fe=On.get($,ie)||Pe,Ve=Fe==null?ye?null:de?"":0:de?Fe:parseFloat(Fe);return/%\s*$/.test(Fe)?Ve/100*(ge?1:k[/x|^width/.test(ie)?"width":"height"]):Ve}function Y($,ie,de,ye,ge,Pe,Fe){return ie=V($,ie||"x",!1,ye,ge,Pe),de=V($,de||"y",!1,ye,ge,Fe),ye&&(ie==null||de==null)?null:new be(ie,de)}function te($,ie,de,ye,ge){return ie=V($,ie||"width",!1,ye,ge),de=V($,de||"height",!1,ye,ge),ye&&(ie==null||de==null)?null:new st(ie,de)}function fe($,ie,de){return $==="none"?null:ie==="number"?parseFloat($):ie==="array"?$?$.split(/[\s,]+/g).map(parseFloat):[]:ie==="color"?Me($)||$:ie==="lookup"?de[$]:$}function ve($,ie,de,ye){var ge=$.childNodes,Pe=ie==="clippath",Fe=ie==="defs",Ve=new jt,Xe=Ve._project,Ke=Xe._currentStyle,De=[];if(!Pe&&!Fe&&(Ve=rt(Ve,$,ye),Xe._currentStyle=Ve._style.clone()),ye)for(var Ge=$.querySelectorAll("defs"),At=0,kt=Ge.length;At<kt;At++)se(Ge[At],de,!1);for(var At=0,kt=ge.length;At<kt;At++){var o=ge[At],ke;o.nodeType===1&&!/^defs$/i.test(o.nodeName)&&(ke=se(o,de,!1))&&!(ke instanceof bt)&&De.push(ke)}return Ve.addChildren(De),Pe&&(Ve=rt(Ve.reduce(),$,ye)),Xe._currentStyle=Ke,(Pe||Fe)&&(Ve.remove(),Ve=null),Ve}function Ie($,ie){for(var de=$.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),ye=[],ge=0,Pe=de.length;ge<Pe;ge+=2)ye.push(new be(parseFloat(de[ge]),parseFloat(de[ge+1])));var Fe=new Ot(ye);return ie==="polygon"&&Fe.closePath(),Fe}function Ee($){return Bt.create($.getAttribute("d"))}function ze($,ie){var de=(V($,"href",!0)||"").substring(1),ye=ie==="radialgradient",ge;if(de)ge=v[de].getGradient(),ge._radial^ye&&(ge=ge.clone(),ge._radial=ye);else{for(var Pe=$.childNodes,Fe=[],Ve=0,Xe=Pe.length;Ve<Xe;Ve++){var Ke=Pe[Ve];Ke.nodeType===1&&Fe.push(rt(new nn,Ke))}ge=new Ni(Fe,ye)}var De,Ge,At,kt=V($,"gradientUnits",!0)!=="userSpaceOnUse";ye?(De=Y($,"cx","cy",!1,kt,"50%","50%"),Ge=De.add(V($,"r",!1,!1,kt,"50%"),0),At=Y($,"fx","fy",!0,kt)):(De=Y($,"x1","y1",!1,kt,"0%","0%"),Ge=Y($,"x2","y2",!1,kt,"100%","0%"));var o=rt(new Hi(ge,De,Ge,At),$);return o._scaleToBounds=kt,null}var Qe={"#document":function($,ie,de,ye){for(var ge=$.childNodes,Pe=0,Fe=ge.length;Pe<Fe;Pe++){var Ve=ge[Pe];if(Ve.nodeType===1)return se(Ve,de,ye)}},g:ve,svg:ve,clippath:ve,polygon:Ie,polyline:Ie,path:Ee,lineargradient:ze,radialgradient:ze,image:function($){var ie=new mt(V($,"href",!0));return ie.on("load",function(){var de=te($);this.setSize(de);var ye=Y($).add(de.divide(2));this._matrix.append(new Tt().translate(ye))}),ie},symbol:function($,ie,de,ye){return new bt(ve($,ie,de,ye),!0)},defs:ve,use:function($){var ie=(V($,"href",!0)||"").substring(1),de=v[ie],ye=Y($);return de?de instanceof bt?de.place(ye):de.clone().translate(ye):null},circle:function($){return new _t.Circle(Y($,"cx","cy"),V($,"r"))},ellipse:function($){return new _t.Ellipse({center:Y($,"cx","cy"),radius:te($,"rx","ry")})},rect:function($){return new _t.Rectangle(new it(Y($),te($)),te($,"rx","ry"))},line:function($){return new Ot.Line(Y($,"x1","y1"),Y($,"x2","y2"))},text:function($){var ie=new Ki(Y($).add(Y($,"dx","dy")));return ie.setContent($.textContent.trim()||""),ie},switch:ve};function He($,ie,de,ye){if($.transform){for(var ge=(ye.getAttribute(de)||"").split(/\)\s*/g),Pe=new Tt,Fe=0,Ve=ge.length;Fe<Ve;Fe++){var Xe=ge[Fe];if(!Xe)break;for(var Ke=Xe.split(/\(\s*/),De=Ke[0],Ge=Ke[1].split(/[\s,]+/g),At=0,kt=Ge.length;At<kt;At++)Ge[At]=parseFloat(Ge[At]);switch(De){case"matrix":Pe.append(new Tt(Ge[0],Ge[1],Ge[2],Ge[3],Ge[4],Ge[5]));break;case"rotate":Pe.rotate(Ge[0],Ge[1]||0,Ge[2]||0);break;case"translate":Pe.translate(Ge[0],Ge[1]||0);break;case"scale":Pe.scale(Ge);break;case"skewX":Pe.skew(Ge[0],0);break;case"skewY":Pe.skew(0,Ge[0]);break}}$.transform(Pe)}}function Ze($,ie,de){var ye=de==="fill-opacity"?"getFillColor":"getStrokeColor",ge=$[ye]&&$[ye]();ge&&ge.setAlpha(parseFloat(ie))}var Ue=x.set(x.each(Gn,function($){this[$.attribute]=function(ie,de){if(ie[$.set]&&(ie[$.set](fe(de,$.type,$.fromSVG)),$.type==="color")){var ye=ie[$.get]();if(ye&&ye._scaleToBounds){var ge=ie.getBounds();ye.transform(new Tt().translate(ge.getPoint()).scale(ge.getSize()))}}}},{}),{id:function($,ie){v[ie]=$,$.setName&&$.setName(ie)},"clip-path":function($,ie){var de=Me(ie);if(de)if(de=de.clone(),de.setClipMask(!0),$ instanceof jt)$.insertChild(0,de);else return new jt(de,$)},gradientTransform:He,transform:He,"fill-opacity":Ze,"stroke-opacity":Ze,visibility:function($,ie){$.setVisible&&$.setVisible(ie==="visible")},display:function($,ie){$.setVisible&&$.setVisible(ie!==null)},"stop-color":function($,ie){$.setColor&&$.setColor(ie)},"stop-opacity":function($,ie){$._color&&$._color.setAlpha(parseFloat(ie))},offset:function($,ie){if($.setOffset){var de=ie.match(/(.*)%$/);$.setOffset(de?de[1]/100:parseFloat(ie))}},viewBox:function($,ie,de,ye,ge){var Pe=new it(fe(ie,"array")),Fe=te(ye,null,null,!0),Ve,Xe;if($ instanceof jt){var Ke=Fe?Fe.divide(Pe.getSize()):1,Xe=new Tt().scale(Ke).translate(Pe.getPoint().negate());Ve=$}else $ instanceof bt&&(Fe&&Pe.setSize(Fe),Ve=$._item);if(Ve){if(dt(ye,"overflow",ge)!=="visible"){var De=new _t.Rectangle(Pe);De.setClipMask(!0),Ve.addChild(De)}Xe&&Ve.transform(Xe)}}});function dt($,ie,de){var ye=$.attributes[ie],ge=ye&&ye.value;if(!ge&&$.style){var Pe=x.camelize(ie);ge=$.style[Pe],!ge&&de.node[Pe]!==de.parent[Pe]&&(ge=de.node[Pe])}return ge?ge==="none"?null:ge:n}function rt($,ie,de){var ye=ie.parentNode,ge={node:Ei.getStyles(ie)||{},parent:!de&&!/^defs$/i.test(ye.tagName)&&Ei.getStyles(ye)||{}};return x.each(Ue,function(Pe,Fe){var Ve=dt(ie,Fe,ge);$=Ve!==n&&Pe($,Ve,Fe,ie,ge)||$}),$}function Me($){var ie=$&&$.match(/\((?:["'#]*)([^"')]+)/),de=ie&&ie[1],ye=de&&v[c?de.replace(c.location.href.split("#")[0]+"#",""):de];return ye&&ye._scaleToBounds&&(ye=ye.clone(),ye._scaleToBounds=!0),ye}function se($,ie,de){var ye=$.nodeName.toLowerCase(),ge=ye!=="#document",Pe=g.body,Fe,Ve,Xe;de&&ge&&(k=pn.getView().getSize(),k=te($,null,null,!0)||k,Fe=On.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),Ve=$.parentNode,Xe=$.nextSibling,Fe.appendChild($),Pe.appendChild(Fe));var Ke=pn.settings,De=Ke.applyMatrix,Ge=Ke.insertItems;Ke.applyMatrix=!1,Ke.insertItems=!1;var At=Qe[ye],kt=At&&At($,ye,ie,de)||null;if(Ke.insertItems=Ge,Ke.applyMatrix=De,kt){ge&&!(kt instanceof jt)&&(kt=rt(kt,$,de));var o=ie.onImport,ke=ge&&$.getAttribute("data-paper-data");o&&(kt=o($,kt,ie)||kt),ie.expandShapes&&kt instanceof _t&&(kt.remove(),kt=kt.toPath()),ke&&(kt._data=JSON.parse(ke))}return Fe&&(Pe.removeChild(Fe),Ve&&(Xe?Ve.insertBefore($,Xe):Ve.appendChild($))),de&&(v={},kt&&x.pick(ie.applyMatrix,De)&&kt.matrix.apply(!0,!0)),kt}function ne($,ie,de){if(!$)return null;ie=typeof ie=="function"?{onLoad:ie}:ie||{};var ye=pn,ge=null;function Pe(Ke){try{var De=typeof Ke=="object"?Ke:new t.DOMParser().parseFromString(Ke.trim(),"image/svg+xml");if(!De.nodeName)throw De=null,new Error("Unsupported SVG source: "+$);pn=ye,ge=se(De,ie,!0),(!ie||ie.insert!==!1)&&de._insertItem(n,ge);var Ge=ie.onLoad;Ge&&Ge(ge,Ke)}catch(At){Fe(At)}}function Fe(Ke,De){var Ge=ie.onError;if(Ge)Ge(Ke,De);else throw new Error(Ke)}if(typeof $=="string"&&!/^[\s\S]*</.test($)){var Ve=g.getElementById($);Ve?Pe(Ve):ci.request({url:$,async:!0,onLoad:Pe,onError:Fe})}else if(typeof File<"u"&&$ instanceof File){var Xe=new FileReader;return Xe.onload=function(){Pe(Xe.result)},Xe.onerror=function(){Fe(Xe.error)},Xe.readAsText($)}else Pe($);return ge}Oe.inject({importSVG:function($,ie){return ne($,ie,this)}}),Rt.inject({importSVG:function($,ie){return this.activate(),ne($,ie,this)}})},x.exports.PaperScript=(function(){var v=this,k=v.acorn;if(!k&&typeof gT<"u")try{k=vT()}catch{}if(!k){var V,Y;k=V=Y={},function(rt,Me){if(typeof V=="object"&&typeof Y=="object")return Me(V);if(typeof n=="function"&&n.amd)return n(["exports"],Me);Me(rt.acorn||(rt.acorn={}))}(this,function(rt){rt.version="0.5.0";var Me,se,ne,$;rt.parse=function(Ft,ni){return se=String(Ft),ne=se.length,de(ni),mu(),Tl(Me.program)};var ie=rt.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function de(Ft){Me=Ft||{};for(var ni in ie)Object.prototype.hasOwnProperty.call(Me,ni)||(Me[ni]=ie[ni]);$=Me.sourceFile||null}var ye=rt.getLineInfo=function(Ft,ni){for(var xi=1,Fi=0;;){Wa.lastIndex=Fi;var Ln=Wa.exec(Ft);if(Ln&&Ln.index<ni)++xi,Fi=Ln.index+Ln[0].length;else break}return{line:xi,column:ni-Fi}};rt.tokenize=function(Ft,ni){se=String(Ft),ne=se.length,de(ni),mu();var xi={};function Fi(Ln){return ke=Fe,$a(Ln),xi.start=Pe,xi.end=Fe,xi.startLoc=Ve,xi.endLoc=Xe,xi.type=Ke,xi.value=De,xi}return Fi.jumpTo=function(Ln,jn){if(ge=Ln,Me.locations){At=1,kt=Wa.lastIndex=0;for(var or;(or=Wa.exec(se))&&or.index<Ln;)++At,kt=or.index+or[0].length}Ge=jn,so()},Fi};var ge,Pe,Fe,Ve,Xe,Ke,De,Ge,At,kt,o,ke,oi,fi,Ai,ti;function li(Ft,ni){var xi=ye(se,Ft);ni+=" ("+xi.line+":"+xi.column+")";var Fi=new SyntaxError(ni);throw Fi.pos=Ft,Fi.loc=xi,Fi.raisedAt=ge,Fi}var Bi=[],vi={type:"num"},bi={type:"regexp"},Jt={type:"string"},wn={type:"name"},ar={type:"eof"},mn={keyword:"break"},Hn={keyword:"case",beforeExpr:!0},jr={keyword:"catch"},ji={keyword:"continue"},ur={keyword:"debugger"},Vn={keyword:"default"},Wt={keyword:"do",isLoop:!0},Yi={keyword:"else",beforeExpr:!0},Ut={keyword:"finally"},Tn={keyword:"for",isLoop:!0},cr={keyword:"function"},Vs={keyword:"if"},Ur={keyword:"return",beforeExpr:!0},Vt={keyword:"switch"},hr={keyword:"throw",beforeExpr:!0},Dt={keyword:"try"},Fr={keyword:"var"},Us={keyword:"while",isLoop:!0},ca={keyword:"with"},Dr={keyword:"new",beforeExpr:!0},Ua={keyword:"this"},Fo={keyword:"null",atomValue:null},Ga={keyword:"true",atomValue:!0},Xs={keyword:"false",atomValue:!1},Qn={keyword:"in",binop:7,beforeExpr:!0},aa={break:mn,case:Hn,catch:jr,continue:ji,debugger:ur,default:Vn,do:Wt,else:Yi,finally:Ut,for:Tn,function:cr,if:Vs,return:Ur,switch:Vt,throw:hr,try:Dt,var:Fr,while:Us,with:ca,null:Fo,true:Ga,false:Xs,new:Dr,in:Qn,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:Ua,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},hs={type:"[",beforeExpr:!0},qa={type:"]"},al={type:"{",beforeExpr:!0},ol={type:"}"},no={type:"(",beforeExpr:!0},Ha={type:")"},N={type:",",beforeExpr:!0},xe={type:";",beforeExpr:!0},nt={type:":",beforeExpr:!0},It={type:"."},$t={type:"?",beforeExpr:!0},wi={binop:10,beforeExpr:!0},Di={isAssign:!0,beforeExpr:!0},hn={isAssign:!0,beforeExpr:!0},dn={postfix:!0,prefix:!0,isUpdate:!0},rr={prefix:!0,beforeExpr:!0},Ar={binop:1,beforeExpr:!0},Or={binop:2,beforeExpr:!0},ja={binop:3,beforeExpr:!0},Za={binop:4,beforeExpr:!0},Qa={binop:5,beforeExpr:!0},pl={binop:6,beforeExpr:!0},Gr={binop:7,beforeExpr:!0},ir={binop:8,beforeExpr:!0},Er={binop:9,prefix:!0,beforeExpr:!0},Lr={binop:10,beforeExpr:!0};rt.tokTypes={bracketL:hs,bracketR:qa,braceL:al,braceR:ol,parenL:no,parenR:Ha,comma:N,semi:xe,colon:nt,dot:It,question:$t,slash:wi,eq:Di,name:wn,eof:ar,num:vi,regexp:bi,string:Jt};for(var Zs in aa)rt.tokTypes["_"+Zs]=aa[Zs];function xr(Ft){Ft=Ft.split(" ");var ni="",xi=[];e:for(var Fi=0;Fi<Ft.length;++Fi){for(var Ln=0;Ln<xi.length;++Ln)if(xi[Ln][0].length==Ft[Fi].length){xi[Ln].push(Ft[Fi]);continue e}xi.push([Ft[Fi]])}function jn(Xn){if(Xn.length==1)return ni+="return str === "+JSON.stringify(Xn[0])+";";ni+="switch(str){";for(var Hs=0;Hs<Xn.length;++Hs)ni+="case "+JSON.stringify(Xn[Hs])+":";ni+="return true}return false;"}if(xi.length>3){xi.sort(function(Xn,Hs){return Hs.length-Xn.length}),ni+="switch(str.length){";for(var Fi=0;Fi<xi.length;++Fi){var or=xi[Fi];ni+="case "+or[0].length+":",jn(or)}ni+="}"}else jn(Ft);return new Function("str",ni)}var Ks=xr("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),Br=xr("class enum extends super const export import"),To=xr("implements interface let package private protected public static yield"),Zo=xr("eval arguments"),Bs=xr("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Il=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,mo="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",Qo="------------------------------------------------------------------------------------------------------------------------------------------",ha=new RegExp("["+mo+"]"),Ys=new RegExp("["+mo+Qo+"]"),El=/[\n\r\u2028\u2029]/,Wa=/\r\n|[\n\r\u2028\u2029]/g,Ma=rt.isIdentifierStart=function(Ft){return Ft<65?Ft===36:Ft<91?!0:Ft<97?Ft===95:Ft<123?!0:Ft>=170&&ha.test(String.fromCharCode(Ft))},ml=rt.isIdentifierChar=function(Ft){return Ft<48?Ft===36:Ft<58?!0:Ft<65?!1:Ft<91?!0:Ft<97?Ft===95:Ft<123?!0:Ft>=170&&Ys.test(String.fromCharCode(Ft))};function Cl(){this.line=At,this.column=ge-kt}function mu(){At=1,ge=kt=0,Ge=!0,so()}function As(Ft,ni){Fe=ge,Me.locations&&(Xe=new Cl),Ke=Ft,so(),De=ni,Ge=Ft.beforeExpr}function ac(){var Ft=Me.onComment&&Me.locations&&new Cl,ni=ge,xi=se.indexOf("*/",ge+=2);if(xi===-1&&li(ge-2,"Unterminated comment"),ge=xi+2,Me.locations){Wa.lastIndex=ni;for(var Fi;(Fi=Wa.exec(se))&&Fi.index<ge;)++At,kt=Fi.index+Fi[0].length}Me.onComment&&Me.onComment(!0,se.slice(ni+2,xi),ni,ge,Ft,Me.locations&&new Cl)}function ro(){for(var Ft=ge,ni=Me.onComment&&Me.locations&&new Cl,xi=se.charCodeAt(ge+=2);ge<ne&&xi!==10&&xi!==13&&xi!==8232&&xi!==8233;)++ge,xi=se.charCodeAt(ge);Me.onComment&&Me.onComment(!1,se.slice(Ft+2,ge),Ft,ge,ni,Me.locations&&new Cl)}function so(){for(;ge<ne;){var Ft=se.charCodeAt(ge);if(Ft===32)++ge;else if(Ft===13){++ge;var ni=se.charCodeAt(ge);ni===10&&++ge,Me.locations&&(++At,kt=ge)}else if(Ft===10||Ft===8232||Ft===8233)++ge,Me.locations&&(++At,kt=ge);else if(Ft>8&&Ft<14)++ge;else if(Ft===47){var ni=se.charCodeAt(ge+1);if(ni===42)ac();else if(ni===47)ro();else break}else if(Ft===160)++ge;else if(Ft>=5760&&Il.test(String.fromCharCode(Ft)))++ge;else break}}function Wl(){var Ft=se.charCodeAt(ge+1);return Ft>=48&&Ft<=57?Ko(!0):(++ge,As(It))}function Oo(){var Ft=se.charCodeAt(ge+1);return Ge?(++ge,gu()):Ft===61?ks(hn,2):ks(wi,1)}function Wo(){var Ft=se.charCodeAt(ge+1);return Ft===61?ks(hn,2):ks(Lr,1)}function ko(Ft){var ni=se.charCodeAt(ge+1);return ni===Ft?ks(Ft===124?Ar:Or,2):ni===61?ks(hn,2):ks(Ft===124?ja:Qa,1)}function Gs(){var Ft=se.charCodeAt(ge+1);return Ft===61?ks(hn,2):ks(Za,1)}function $o(Ft){var ni=se.charCodeAt(ge+1);return ni===Ft?ni==45&&se.charCodeAt(ge+2)==62&&El.test(se.slice(ke,ge))?(ge+=3,ro(),so(),$a()):ks(dn,2):ni===61?ks(hn,2):ks(Er,1)}function Xo(Ft){var ni=se.charCodeAt(ge+1),xi=1;return ni===Ft?(xi=Ft===62&&se.charCodeAt(ge+2)===62?3:2,se.charCodeAt(ge+xi)===61?ks(hn,xi+1):ks(ir,xi)):ni==33&&Ft==60&&se.charCodeAt(ge+2)==45&&se.charCodeAt(ge+3)==45?(ge+=4,ro(),so(),$a()):(ni===61&&(xi=se.charCodeAt(ge+2)===61?3:2),ks(Gr,xi))}function Yo(Ft){var ni=se.charCodeAt(ge+1);return ni===61?ks(pl,se.charCodeAt(ge+2)===61?3:2):ks(Ft===61?Di:rr,1)}function Sa(Ft){switch(Ft){case 46:return Wl();case 40:return++ge,As(no);case 41:return++ge,As(Ha);case 59:return++ge,As(xe);case 44:return++ge,As(N);case 91:return++ge,As(hs);case 93:return++ge,As(qa);case 123:return++ge,As(al);case 125:return++ge,As(ol);case 58:return++ge,As(nt);case 63:return++ge,As($t);case 48:var ni=se.charCodeAt(ge+1);if(ni===120||ni===88)return $n();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return Ko(!1);case 34:case 39:return zr(Ft);case 47:return Oo();case 37:case 42:return Wo();case 124:case 38:return ko(Ft);case 94:return Gs();case 43:case 45:return $o(Ft);case 60:case 62:return Xo(Ft);case 61:case 33:return Yo(Ft);case 126:return ks(rr,1)}return!1}function $a(Ft){if(Ft?ge=Pe+1:Pe=ge,Me.locations&&(Ve=new Cl),Ft)return gu();if(ge>=ne)return As(ar);var ni=se.charCodeAt(ge);if(Ma(ni)||ni===92)return Mo();var xi=Sa(ni);if(xi===!1){var Fi=String.fromCharCode(ni);if(Fi==="\\"||ha.test(Fi))return Mo();li(ge,"Unexpected character '"+Fi+"'")}return xi}function ks(Ft,ni){var xi=se.slice(ge,ge+ni);ge+=ni,As(Ft,xi)}function gu(){for(var Ln="",Ft,ni,xi=ge;;){ge>=ne&&li(xi,"Unterminated regular expression");var Fi=se.charAt(ge);if(El.test(Fi)&&li(xi,"Unterminated regular expression"),Ft)Ft=!1;else{if(Fi==="[")ni=!0;else if(Fi==="]"&&ni)ni=!1;else if(Fi==="/"&&!ni)break;Ft=Fi==="\\"}++ge}var Ln=se.slice(xi,ge);++ge;var jn=fr();jn&&!/^[gmsiy]*$/.test(jn)&&li(xi,"Invalid regexp flag");try{var or=new RegExp(Ln,jn)}catch(Xn){Xn instanceof SyntaxError&&li(xi,Xn.message),li(Xn)}return As(bi,or)}function Cr(Ft,ni){for(var xi=ge,Fi=0,Ln=0,jn=ni??1/0;Ln<jn;++Ln){var or=se.charCodeAt(ge),Xn;if(or>=97?Xn=or-97+10:or>=65?Xn=or-65+10:or>=48&&or<=57?Xn=or-48:Xn=1/0,Xn>=Ft)break;++ge,Fi=Fi*Ft+Xn}return ge===xi||ni!=null&&ge-xi!==ni?null:Fi}function $n(){ge+=2;var Ft=Cr(16);return Ft==null&&li(Pe+2,"Expected hexadecimal number"),Ma(se.charCodeAt(ge))&&li(ge,"Identifier directly after number"),As(vi,Ft)}function Ko(Ft){var ni=ge,xi=!1,Fi=se.charCodeAt(ge)===48;!Ft&&Cr(10)===null&&li(ni,"Invalid number"),se.charCodeAt(ge)===46&&(++ge,Cr(10),xi=!0);var Ln=se.charCodeAt(ge);(Ln===69||Ln===101)&&(Ln=se.charCodeAt(++ge),(Ln===43||Ln===45)&&++ge,Cr(10)===null&&li(ni,"Invalid number"),xi=!0),Ma(se.charCodeAt(ge))&&li(ge,"Identifier directly after number");var jn=se.slice(ni,ge),or;return xi?or=parseFloat(jn):!Fi||jn.length===1?or=parseInt(jn,10):/[89]/.test(jn)||ti?li(ni,"Invalid number"):or=parseInt(jn,8),As(vi,or)}function zr(Ft){ge++;for(var ni="";;){ge>=ne&&li(Pe,"Unterminated string constant");var xi=se.charCodeAt(ge);if(xi===Ft)return++ge,As(Jt,ni);if(xi===92){xi=se.charCodeAt(++ge);var Fi=/^[0-7]+/.exec(se.slice(ge,ge+3));for(Fi&&(Fi=Fi[0]);Fi&&parseInt(Fi,8)>255;)Fi=Fi.slice(0,-1);if(Fi==="0"&&(Fi=null),++ge,Fi)ti&&li(ge-2,"Octal literal in strict mode"),ni+=String.fromCharCode(parseInt(Fi,8)),ge+=Fi.length-1;else switch(xi){case 110:ni+=`
`;break;case 114:ni+="\r";break;case 120:ni+=String.fromCharCode(Xa(2));break;case 117:ni+=String.fromCharCode(Xa(4));break;case 85:ni+=String.fromCharCode(Xa(8));break;case 116:ni+="	";break;case 98:ni+="\b";break;case 118:ni+="\v";break;case 102:ni+="\f";break;case 48:ni+="\0";break;case 13:se.charCodeAt(ge)===10&&++ge;case 10:Me.locations&&(kt=ge,++At);break;default:ni+=String.fromCharCode(xi);break}}else(xi===13||xi===10||xi===8232||xi===8233)&&li(Pe,"Unterminated string constant"),ni+=String.fromCharCode(xi),++ge}}function Xa(Ft){var ni=Cr(16,Ft);return ni===null&&li(Pe,"Bad character escape sequence"),ni}var is;function fr(){is=!1;for(var Ft,ni=!0,xi=ge;;){var Fi=se.charCodeAt(ge);if(ml(Fi))is&&(Ft+=se.charAt(ge)),++ge;else if(Fi===92){is||(Ft=se.slice(xi,ge)),is=!0,se.charCodeAt(++ge)!=117&&li(ge,"Expecting Unicode escape sequence \\uXXXX"),++ge;var Ln=Xa(4),jn=String.fromCharCode(Ln);jn||li(ge-1,"Invalid Unicode escape"),(ni?Ma(Ln):ml(Ln))||li(ge-4,"Invalid Unicode escape"),Ft+=jn}else break;ni=!1}return is?Ft:se.slice(xi,ge)}function Mo(){var Ft=fr(),ni=wn;return!is&&Bs(Ft)&&(ni=aa[Ft]),As(ni,Ft)}function qn(){o=Pe,ke=Fe,oi=Xe,$a()}function Ol(Ft){if(ti=Ft,ge=Pe,Me.locations)for(;ge<kt;)kt=se.lastIndexOf(`
`,kt-2)+1,--At;so(),$a()}function ns(){this.type=null,this.start=Pe,this.end=null}function Zr(){this.start=Ve,this.end=null,$!==null&&(this.source=$)}function Ms(){var Ft=new ns;return Me.locations&&(Ft.loc=new Zr),Me.directSourceFile&&(Ft.sourceFile=Me.directSourceFile),Me.ranges&&(Ft.range=[Pe,0]),Ft}function Mr(Ft){var ni=new ns;return ni.start=Ft.start,Me.locations&&(ni.loc=new Zr,ni.loc.start=Ft.loc.start),Me.ranges&&(ni.range=[Ft.range[0],0]),ni}function nr(Ft,ni){return Ft.type=ni,Ft.end=ke,Me.locations&&(Ft.loc.end=oi),Me.ranges&&(Ft.range[1]=ke),Ft}function ll(Ft){return Me.ecmaVersion>=5&&Ft.type==="ExpressionStatement"&&Ft.expression.type==="Literal"&&Ft.expression.value==="use strict"}function Xr(Ft){if(Ke===Ft)return qn(),!0}function Po(){return!Me.strictSemicolons&&(Ke===ar||Ke===ol||El.test(se.slice(ke,Pe)))}function ul(){!Xr(xe)&&!Po()&&ds()}function Qr(Ft){Ke===Ft?qn():ds()}function ds(){li(Pe,"Unexpected token")}function Ia(Ft){Ft.type!=="Identifier"&&Ft.type!=="MemberExpression"&&li(Ft.start,"Assigning to rvalue"),ti&&Ft.type==="Identifier"&&Zo(Ft.name)&&li(Ft.start,"Assigning to "+Ft.name+" in strict mode")}function Tl(Ft){o=ke=ge,Me.locations&&(oi=new Cl),fi=ti=null,Ai=[],$a();var ni=Ft||Ms(),xi=!0;for(Ft||(ni.body=[]);Ke!==ar;){var Fi=go();ni.body.push(Fi),xi&&ll(Fi)&&Ol(!0),xi=!1}return nr(ni,"Program")}var Do={kind:"loop"},kl={kind:"switch"};function go(){(Ke===wi||Ke===hn&&De=="/=")&&$a(!0);var Ft=Ke,ni=Ms();switch(Ft){case mn:case ji:qn();var xi=Ft===mn;Xr(xe)||Po()?ni.label=null:Ke!==wn?ds():(ni.label=Pi(),ul());for(var Fi=0;Fi<Ai.length;++Fi){var Ln=Ai[Fi];if((ni.label==null||Ln.name===ni.label.name)&&(Ln.kind!=null&&(xi||Ln.kind==="loop")||ni.label&&xi))break}return Fi===Ai.length&&li(ni.start,"Unsyntactic "+Ft.keyword),nr(ni,xi?"BreakStatement":"ContinueStatement");case ur:return qn(),ul(),nr(ni,"DebuggerStatement");case Wt:return qn(),Ai.push(Do),ni.body=go(),Ai.pop(),Qr(Us),ni.test=Js(),ul(),nr(ni,"DoWhileStatement");case Tn:if(qn(),Ai.push(Do),Qr(no),Ke===xe)return Ya(ni,null);if(Ke===Fr){var jn=Ms();return qn(),Yr(jn,!0),nr(jn,"VariableDeclaration"),jn.declarations.length===1&&Xr(Qn)?Jo(ni,jn):Ya(ni,jn)}var jn=gr(!1,!0);return Xr(Qn)?(Ia(jn),Jo(ni,jn)):Ya(ni,jn);case cr:return qn(),pi(ni,!0);case Vs:return qn(),ni.test=Js(),ni.consequent=go(),ni.alternate=Xr(Yi)?go():null,nr(ni,"IfStatement");case Ur:return!fi&&!Me.allowReturnOutsideFunction&&li(Pe,"'return' outside of function"),qn(),Xr(xe)||Po()?ni.argument=null:(ni.argument=gr(),ul()),nr(ni,"ReturnStatement");case Vt:qn(),ni.discriminant=Js(),ni.cases=[],Qr(al),Ai.push(kl);for(var or,Xn;Ke!=ol;)if(Ke===Hn||Ke===Vn){var Hs=Ke===Hn;or&&nr(or,"SwitchCase"),ni.cases.push(or=Ms()),or.consequent=[],qn(),Hs?or.test=gr():(Xn&&li(o,"Multiple default clauses"),Xn=!0,or.test=null),Qr(nt)}else or||ds(),or.consequent.push(go());return or&&nr(or,"SwitchCase"),qn(),Ai.pop(),nr(ni,"SwitchStatement");case hr:return qn(),El.test(se.slice(ke,Pe))&&li(ke,"Illegal newline after throw"),ni.argument=gr(),ul(),nr(ni,"ThrowStatement");case Dt:if(qn(),ni.block=qs(),ni.handler=null,Ke===jr){var Ps=Ms();qn(),Qr(no),Ps.param=Pi(),ti&&Zo(Ps.param.name)&&li(Ps.param.start,"Binding "+Ps.param.name+" in strict mode"),Qr(Ha),Ps.guard=null,Ps.body=qs(),ni.handler=nr(Ps,"CatchClause")}return ni.guardedHandlers=Bi,ni.finalizer=Xr(Ut)?qs():null,!ni.handler&&!ni.finalizer&&li(ni.start,"Missing catch or finally clause"),nr(ni,"TryStatement");case Fr:return qn(),Yr(ni),ul(),nr(ni,"VariableDeclaration");case Us:return qn(),ni.test=Js(),Ai.push(Do),ni.body=go(),Ai.pop(),nr(ni,"WhileStatement");case ca:return ti&&li(Pe,"'with' in strict mode"),qn(),ni.object=Js(),ni.body=go(),nr(ni,"WithStatement");case al:return qs();case xe:return qn(),nr(ni,"EmptyStatement");default:var ps=De,Ja=gr();if(Ft===wn&&Ja.type==="Identifier"&&Xr(nt)){for(var Fi=0;Fi<Ai.length;++Fi)Ai[Fi].name===ps&&li(Ja.start,"Label '"+ps+"' is already declared");var yo=Ke.isLoop?"loop":Ke===Vt?"switch":null;return Ai.push({name:ps,kind:yo}),ni.body=go(),Ai.pop(),ni.label=Ja,nr(ni,"LabeledStatement")}else return ni.expression=Ja,ul(),nr(ni,"ExpressionStatement")}}function Js(){Qr(no);var Ft=gr();return Qr(Ha),Ft}function qs(Ft){var ni=Ms(),xi=!0,Fi=!1,Ln;for(ni.body=[],Qr(al);!Xr(ol);){var jn=go();ni.body.push(jn),xi&&Ft&&ll(jn)&&(Ln=Fi,Ol(Fi=!0)),xi=!1}return Fi&&!Ln&&Ol(!1),nr(ni,"BlockStatement")}function Ya(Ft,ni){return Ft.init=ni,Qr(xe),Ft.test=Ke===xe?null:gr(),Qr(xe),Ft.update=Ke===Ha?null:gr(),Qr(Ha),Ft.body=go(),Ai.pop(),nr(Ft,"ForStatement")}function Jo(Ft,ni){return Ft.left=ni,Ft.right=gr(),Qr(Ha),Ft.body=go(),Ai.pop(),nr(Ft,"ForInStatement")}function Yr(Ft,ni){for(Ft.declarations=[],Ft.kind="var";;){var xi=Ms();if(xi.id=Pi(),ti&&Zo(xi.id.name)&&li(xi.id.start,"Binding "+xi.id.name+" in strict mode"),xi.init=Xr(Di)?gr(!0,ni):null,Ft.declarations.push(nr(xi,"VariableDeclarator")),!Xr(N))break}return Ft}function gr(Ft,ni){var xi=Nr(ni);if(!Ft&&Ke===N){var Fi=Mr(xi);for(Fi.expressions=[xi];Xr(N);)Fi.expressions.push(Nr(ni));return nr(Fi,"SequenceExpression")}return xi}function Nr(Ft){var ni=Aa(Ft);if(Ke.isAssign){var xi=Mr(ni);return xi.operator=De,xi.left=ni,qn(),xi.right=Nr(Ft),Ia(ni),nr(xi,"AssignmentExpression")}return ni}function Aa(Ft){var ni=_o(Ft);if(Xr($t)){var xi=Mr(ni);return xi.test=ni,xi.consequent=gr(!0),Qr(nt),xi.alternate=gr(!0,Ft),nr(xi,"ConditionalExpression")}return ni}function _o(Ft){return ea(Ea(),-1,Ft)}function ea(Ft,ni,xi){var Fi=Ke.binop;if(Fi!=null&&(!xi||Ke!==Qn)&&Fi>ni){var Ln=Mr(Ft);Ln.left=Ft,Ln.operator=De;var jn=Ke;qn(),Ln.right=ea(Ea(),Fi,xi);var or=nr(Ln,jn===Ar||jn===Or?"LogicalExpression":"BinaryExpression");return ea(or,ni,xi)}return Ft}function Ea(){if(Ke.prefix){var Ft=Ms(),ni=Ke.isUpdate;return Ft.operator=De,Ft.prefix=!0,Ge=!0,qn(),Ft.argument=Ea(),ni?Ia(Ft.argument):ti&&Ft.operator==="delete"&&Ft.argument.type==="Identifier"&&li(Ft.start,"Deleting local variable in strict mode"),nr(Ft,ni?"UpdateExpression":"UnaryExpression")}for(var xi=Pa();Ke.postfix&&!Po();){var Ft=Mr(xi);Ft.operator=De,Ft.prefix=!1,Ft.argument=xi,Ia(xi),qn(),xi=nr(Ft,"UpdateExpression")}return xi}function Pa(){return Ka(cl())}function Ka(Ft,ni){if(Xr(It)){var xi=Mr(Ft);return xi.object=Ft,xi.property=Pi(!0),xi.computed=!1,Ka(nr(xi,"MemberExpression"),ni)}else if(Xr(hs)){var xi=Mr(Ft);return xi.object=Ft,xi.property=gr(),xi.computed=!0,Qr(qa),Ka(nr(xi,"MemberExpression"),ni)}else if(!ni&&Xr(no)){var xi=Mr(Ft);return xi.callee=Ft,xi.arguments=Vi(Ha,!1),Ka(nr(xi,"CallExpression"),ni)}else return Ft}function cl(){switch(Ke){case Ua:var Fi=Ms();return qn(),nr(Fi,"ThisExpression");case wn:return Pi();case vi:case Jt:case bi:var Fi=Ms();return Fi.value=De,Fi.raw=se.slice(Pe,Fe),qn(),nr(Fi,"Literal");case Fo:case Ga:case Xs:var Fi=Ms();return Fi.value=Ke.atomValue,Fi.raw=Ke.keyword,qn(),nr(Fi,"Literal");case no:var Ft=Ve,ni=Pe;qn();var xi=gr();return xi.start=ni,xi.end=Fe,Me.locations&&(xi.loc.start=Ft,xi.loc.end=Xe),Me.ranges&&(xi.range=[ni,Fe]),Qr(Ha),xi;case hs:var Fi=Ms();return qn(),Fi.elements=Vi(qa,!0,!0),nr(Fi,"ArrayExpression");case al:return gl();case cr:var Fi=Ms();return qn(),pi(Fi,!1);case Dr:return lu();default:ds()}}function lu(){var Ft=Ms();return qn(),Ft.callee=Ka(cl(),!0),Xr(no)?Ft.arguments=Vi(Ha,!1):Ft.arguments=Bi,nr(Ft,"NewExpression")}function gl(){var Ft=Ms(),ni=!0,xi=!1;for(Ft.properties=[],qn();!Xr(ol);){if(ni)ni=!1;else if(Qr(N),Me.allowTrailingCommas&&Xr(ol))break;var Fi={key:ao()},Ln=!1,jn;if(Xr(nt)?(Fi.value=gr(!0),jn=Fi.kind="init"):Me.ecmaVersion>=5&&Fi.key.type==="Identifier"&&(Fi.key.name==="get"||Fi.key.name==="set")?(Ln=xi=!0,jn=Fi.kind=Fi.key.name,Fi.key=ao(),Ke!==no&&ds(),Fi.value=pi(Ms(),!1)):ds(),Fi.key.type==="Identifier"&&(ti||xi))for(var or=0;or<Ft.properties.length;++or){var Xn=Ft.properties[or];if(Xn.key.name===Fi.key.name){var Hs=jn==Xn.kind||Ln&&Xn.kind==="init"||jn==="init"&&(Xn.kind==="get"||Xn.kind==="set");Hs&&!ti&&jn==="init"&&Xn.kind==="init"&&(Hs=!1),Hs&&li(Fi.key.start,"Redefinition of property")}}Ft.properties.push(Fi)}return nr(Ft,"ObjectExpression")}function ao(){return Ke===vi||Ke===Jt?cl():Pi(!0)}function pi(Ft,ni){Ke===wn?Ft.id=Pi():ni?ds():Ft.id=null,Ft.params=[];var xi=!0;for(Qr(no);!Xr(Ha);)xi?xi=!1:Qr(N),Ft.params.push(Pi());var Fi=fi,Ln=Ai;if(fi=!0,Ai=[],Ft.body=qs(!0),fi=Fi,Ai=Ln,ti||Ft.body.body.length&&ll(Ft.body.body[0]))for(var jn=Ft.id?-1:0;jn<Ft.params.length;++jn){var or=jn<0?Ft.id:Ft.params[jn];if((To(or.name)||Zo(or.name))&&li(or.start,"Defining '"+or.name+"' in strict mode"),jn>=0)for(var Xn=0;Xn<jn;++Xn)or.name===Ft.params[Xn].name&&li(or.start,"Argument name clash in strict mode")}return nr(Ft,ni?"FunctionDeclaration":"FunctionExpression")}function Vi(Ft,ni,xi){for(var Fi=[],Ln=!0;!Xr(Ft);){if(Ln)Ln=!1;else if(Qr(N),ni&&Me.allowTrailingCommas&&Xr(Ft))break;xi&&Ke===N?Fi.push(null):Fi.push(gr(!0))}return Fi}function Pi(Ft){var ni=Ms();return Ft&&Me.forbidReserved=="everywhere"&&(Ft=!1),Ke===wn?(!Ft&&(Me.forbidReserved&&(Me.ecmaVersion===3?Ks:Br)(De)||ti&&To(De))&&se.slice(Pe,Fe).indexOf("\\")==-1&&li(Pe,"The keyword '"+De+"' is reserved"),ni.name=De):Ft&&Ke.keyword?ni.name=Ke.keyword:ds(),Ge=!1,qn(),nr(ni,"Identifier")}}),k.version||(k=null)}function te(rt,Me){return(v.acorn||k).parse(rt,Me)}var fe={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"__equals","!=":"__equals"},ve={"-":"__negate","+":"__self"},Ie=x.each(["add","subtract","multiply","divide","modulo","equals","negate"],function(rt){this["__"+rt]="#"+rt},{__self:function(){return this}});be.inject(Ie),st.inject(Ie),Hi.inject(Ie);function Ee(rt,Me,se){var ne=fe[Me];if(rt&&rt[ne]){var $=rt[ne](se);return Me==="!="?!$:$}switch(Me){case"+":return rt+se;case"-":return rt-se;case"*":return rt*se;case"/":return rt/se;case"%":return rt%se;case"==":return rt==se;case"!=":return rt!=se}}function ze(rt,Me){var se=ve[rt];if(Me&&Me[se])return Me[se]();switch(rt){case"+":return+Me;case"-":return-Me}}function Qe(rt,Me){if(!rt)return"";Me=Me||{};var se=[];function ne(ti){for(var li=0,Bi=se.length;li<Bi;li++){var vi=se[li];if(vi[0]>=ti)break;ti+=vi[1]}return ti}function $(ti){return rt.substring(ne(ti.range[0]),ne(ti.range[1]))}function ie(ti,li){return rt.substring(ne(ti.range[1]),ne(li.range[0]))}function de(ti,li){for(var Bi=ne(ti.range[0]),vi=ne(ti.range[1]),bi=0,Jt=se.length-1;Jt>=0;Jt--)if(Bi>se[Jt][0]){bi=Jt+1;break}se.splice(bi,0,[Bi,li.length-vi+Bi]),rt=rt.substring(0,Bi)+li+rt.substring(vi)}function ye(ti,li){switch(ti.type){case"UnaryExpression":if(ti.operator in ve&&ti.argument.type!=="Literal"){var Bi=$(ti.argument);de(ti,'$__("'+ti.operator+'", '+Bi+")")}break;case"BinaryExpression":if(ti.operator in fe&&ti.left.type!=="Literal"){var vi=$(ti.left),bi=$(ti.right),Jt=ie(ti.left,ti.right),wn=ti.operator;de(ti,"__$__("+vi+","+Jt.replace(new RegExp("\\"+wn),'"'+wn+'"')+", "+bi+")")}break;case"UpdateExpression":case"AssignmentExpression":var ar=li&&li.type;if(!(ar==="ForStatement"||ar==="BinaryExpression"&&/^[=!<>]/.test(li.operator)||ar==="MemberExpression"&&li.computed)){if(ti.type==="UpdateExpression"){var Bi=$(ti.argument),mn="__$__("+Bi+', "'+ti.operator[0]+'", 1)',Hn=Bi+" = "+mn;ti.prefix?Hn="("+Hn+")":(ar==="AssignmentExpression"||ar==="VariableDeclarator"||ar==="BinaryExpression")&&($(li.left||li.id)===Bi&&(Hn=mn),Hn=Bi+"; "+Hn),de(ti,Hn)}else if(/^.=$/.test(ti.operator)&&ti.left.type!=="Literal"){var vi=$(ti.left),bi=$(ti.right),mn=vi+" = __$__("+vi+', "'+ti.operator[0]+'", '+bi+")";de(ti,/^\(.*\)$/.test($(ti))?"("+mn+")":mn)}}break}}function ge(ti){switch(ti.type){case"ExportDefaultDeclaration":de({range:[ti.start,ti.declaration.start]},"module.exports = ");break;case"ExportNamedDeclaration":var li=ti.declaration,Bi=ti.specifiers;if(li){var vi=li.declarations;vi&&(vi.forEach(function(Jt){de(Jt,"module.exports."+$(Jt))}),de({range:[ti.start,li.start+li.kind.length]},""))}else if(Bi){var bi=Bi.map(function(Jt){var wn=$(Jt);return"module.exports."+wn+" = "+wn+"; "}).join("");bi&&de(ti,bi)}break}}function Pe(ti,li,Bi){if(ti){for(var vi in ti)if(vi!=="range"&&vi!=="loc"){var bi=ti[vi];if(Array.isArray(bi))for(var Jt=0,wn=bi.length;Jt<wn;Jt++)Pe(bi[Jt],ti,Bi);else bi&&typeof bi=="object"&&Pe(bi,ti,Bi)}Bi.operatorOverloading!==!1&&ye(ti,li),Bi.moduleExports!==!1&&ge(ti)}}function Fe(ti){var li="",Bi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(ti=(Math.abs(ti)<<1)+(ti<0?1:0);ti||!li;){var vi=ti&31;ti>>=5,ti&&(vi|=32),li+=Bi[vi]}return li}var Ve=Me.url||"",Xe=Me.sourceMaps,Ke=Me.paperFeatures||{},De=Me.source||rt,Ge=Me.offset||0,At=pn.agent,kt=At.versionNumber,o=!1,ke=/\r\n|\n|\r/mg,oi;if(Xe&&(At.chrome&&kt>=30||At.webkit&&kt>=537.76||At.firefox&&kt>=23||At.node)){if(At.node)Ge-=2;else if(c&&Ve&&!c.location.href.indexOf(Ve)){var fi=g.getElementsByTagName("html")[0].innerHTML;Ge=fi.substr(0,fi.indexOf(rt)+1).match(ke).length+1}o=Ge>0&&!(At.chrome&&kt>=36||At.safari&&kt>=600||At.firefox&&kt>=40||At.node);var Ai=["AA"+Fe(o?0:Ge)+"A"];Ai.length=(rt.match(ke)||[]).length+1+(o?Ge:0),oi={version:3,file:Ve,names:[],mappings:Ai.join(";AACA"),sourceRoot:"",sources:[Ve],sourcesContent:[De]}}return(Ke.operatorOverloading!==!1||Ke.moduleExports!==!1)&&Pe(te(rt,{ranges:!0,preserveParens:!0,sourceType:"module"}),null,Ke),oi&&(o&&(rt=new Array(Ge+1).join(`
`)+rt),/^(inline|both)$/.test(Xe)&&(rt+=`
//# sourceMappingURL=data:application/json;base64,`+t.btoa(unescape(encodeURIComponent(JSON.stringify(oi))))),rt+=`
//# sourceURL=`+(Ve||"paperscript")),{url:Ve,source:De,code:rt,map:oi}}function He(rt,Me,se){pn=Me;var ne=Me.getView(),$=/\btool\.\w+|\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(rt)&&!/\bnew\s+Tool\b/.test(rt)?new Ji:null,ie=$?$._events:[],de=["onFrame","onResize"].concat(ie),ye=[],ge=[],Pe,Fe=typeof rt=="object"?rt:Qe(rt,se);rt=Fe.code;function Ve(kt,o){for(var ke in kt)(o||!/^_/.test(ke))&&new RegExp("([\\b\\s\\W]|^)"+ke.replace(/\$/g,"\\$")+"\\b").test(rt)&&(ye.push(ke),ge.push(kt[ke]))}Ve({__$__:Ee,$__:ze,paper:Me,tool:$},!0),Ve(Me),rt="var module = { exports: {} }; "+rt;var Ge=x.each(de,function(kt){new RegExp("\\s+"+kt+"\\b").test(rt)&&(ye.push(kt),this.push("module.exports."+kt+" = "+kt+";"))},[]).join(`
`);Ge&&(rt+=`
`+Ge),rt+=`
return module.exports;`;var Xe=pn.agent;if(g&&(Xe.chrome||Xe.firefox&&Xe.versionNumber<40)){var Ke=g.createElement("script"),De=g.head||g.getElementsByTagName("head")[0];Xe.firefox&&(rt=`
`+rt),Ke.appendChild(g.createTextNode("document.__paperscript__ = function("+ye+") {"+rt+`
}`)),De.appendChild(Ke),Pe=g.__paperscript__,delete g.__paperscript__,De.removeChild(Ke)}else Pe=Function(ye,rt);var Ge=Pe&&Pe.apply(Me,ge),At=Ge||{};return x.each(ie,function(kt){var o=At[kt];o&&($[kt]=o)}),ne&&(At.onResize&&ne.setOnResize(At.onResize),ne.emit("resize",{size:ne.size,delta:new be}),At.onFrame&&ne.setOnFrame(At.onFrame),ne.requestUpdate()),Ge}function Ze(rt){if(/^text\/(?:x-|)paperscript$/.test(rt.type)&&a.getAttribute(rt,"ignore")!=="true"){var Me=a.getAttribute(rt,"canvas"),se=g.getElementById(Me),ne=rt.src||rt.getAttribute("data-src"),$=a.hasAttribute(rt,"async"),ie="data-paper-scope";if(!se)throw new Error('Unable to find canvas with id "'+Me+'"');var de=a.get(se.getAttribute(ie))||new a().setup(se);return se.setAttribute(ie,de._id),ne?ci.request({url:ne,async:$,mimeType:"text/plain",onLoad:function(ye){He(ye,de,ne)}}):He(rt.innerHTML,de,rt.baseURI),rt.setAttribute("data-paper-ignore","true"),de}}function Ue(){x.each(g&&g.getElementsByTagName("script"),Ze)}function dt(rt){return rt?Ze(rt):Ue()}return c&&(g.readyState==="complete"?setTimeout(Ue):mi.add(c,{load:Ue})),{compile:Qe,execute:He,load:dt,parse:te,calculateBinary:Ee,calculateUnary:ze}}).call(this);var pn=new(a.inject(x.exports,{Base:x,Numerical:ae,Key:Yt,DomEvent:mi,DomElement:Ei,document:g,window:c,Symbol:bt,PlacedSymbol:xt}));return pn.agent.node&&bx(pn),typeof n=="function"&&n.amd?n("paper",pn):e&&(e.exports=pn),pn}).call(Jf,typeof self=="object"?self:null)})(y3);var L1=y3.exports;function xT(e){let t,n,c="Click and drag to draw a polygon. Press Escape to exit.",g,x;return{c(){t=Rn("div"),n=Rn("span"),n.textContent=c,g=Sr(),x=Rn("canvas"),this.h()},l(S){t=Fn(S,"DIV",{class:!0});var a=_n(t);n=Fn(a,"SPAN",{class:!0,"data-svelte-h":!0}),Qu(n)!=="svelte-1m9xrla"&&(n.textContent=c),g=Ir(a),x=Fn(a,"CANVAS",{class:!0}),_n(x).forEach(yi),a.forEach(yi),this.h()},h(){Ti(n,"class","svelte-jrtjeu"),Ti(x,"class","canvas svelte-jrtjeu"),Ti(t,"class","draw-wrapper svelte-jrtjeu")},m(S,a){Un(S,t,a),qi(t,n),qi(t,g),qi(t,x),e[5](x)},p:Oa,i:Oa,o:Oa,d(S){S&&yi(t),e[5](null)}}}function bT(e,t,n){let{path:c}=t,{updatePath:g}=t,{updateIsDrawing:x}=t,{isDrawing:S}=t,a,U;bc(()=>{L1.setup(U);let he=new L1.Tool;he.onMouseDown=function(ae){n(1,c=new L1.Path),n(1,c.strokeColor="white",c),c.add(ae.point)},he.onMouseDrag=function(ae){a&&c.add(ae.point)},he.onMouseUp=function(ae){if(!a)return;c.simplify(.5),c.clearHandles(),n(1,c.closed=!0,c);let ce=[];for(let be of c.segments){console.log();let Je=be.point;ce.push({x:Je.x,y:Je.y})}g(ce),x(!1)},he.onKeyDown=function(ae){console.log(ae),ae.key==="escape"&&x(!1)}});function W(he){ua[he?"unshift":"push"](()=>{U=he,n(0,U)})}return e.$$set=he=>{"path"in he&&n(1,c=he.path),"updatePath"in he&&n(2,g=he.updatePath),"updateIsDrawing"in he&&n(3,x=he.updateIsDrawing),"isDrawing"in he&&n(4,S=he.isDrawing)},e.$$.update=()=>{e.$$.dirty&16&&(a=S)},[U,c,g,x,S,W]}class wT extends fo{constructor(t){super(),po(this,t,bT,xT,Va,{path:1,updatePath:2,updateIsDrawing:3,isDrawing:4})}}const m_=["pd","mpd","mntd","pdSigCal","mpdSigCal","mntdSigCal","pdSigEco","mpdSigEco","mntdSigEco","tree_sizes"],Sx={pd:"phylodiversity",mpd:"mean pairwise phylogenetic distance",mntd:"mean nearest-taxon phylogenetic distance"};function ST(e){if(!e||!m_.includes(e))return;const n=650;let c=new Array(n),g=[0,1];const x=Ix[1]/n;let S;switch(e){case"mntd":case"rel_mntd":S=cm.mntd;break;case"mpd":case"rel_mpd":S=cm.mpd;break;default:case"pd":S=cm.pd}let a=S.d,U=S.b,W=S.e,he=S.c,ae=S.modelHigh,ce=S.modelLow,be=S.minY,Je=S.maxY,st=2;for(let Ye=0;Ye<n;Ye++){let it=(Ye+st)*x;c[Ye]={x:it,high:ae({x:it,b:U.high,c:he.high,d:a.high,e:W.high}),low:ce({x:it,b:U.low,c:he.low,d:a.low,e:W.low})}}return g=[be,Je],{confidence:c,yAxis:g,xAxis:Ix,xAxisLabel:"Tree Size",yAxisLabel:S.yAxisLabel}}const Ix=[0,300],cm={pd:{b:{low:-.7505,high:-.6608},c:{low:9.567,high:123.1524},d:{low:11690.7906,high:10762.3392},e:{low:1298.4931,high:1308.4918},minY:100,maxY:5e3,yAxisLabel:"Phylodiversity (pd)",modelHigh:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g)))),modelLow:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g))))},mpd:{b:{low:-.6495,high:.4117},c:{low:-39.3099,high:93.617},d:{low:102.1695,high:152.3637},e:{low:1.2904,high:2.763},minY:0,maxY:200,yAxisLabel:"Mean pairwise phylogenetic distance (mpd)",modelHigh:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g)))),modelLow:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g))))},mntd:{b:{low:1.2883,high:.9501},c:{low:8.8277,high:5.9462},d:{low:33.4172,high:156.3706},e:{low:44.5908,high:10.2206},minY:0,maxY:150,yAxisLabel:"Mean nearest-taxon phylogenetic distance (mntd)",modelHigh:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g)))),modelLow:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g))))}};function IT(e,t,n){if(t===-1||t==NaN)return-1;let c;switch(e){case"mntd":case"rel_mntd":c=cm.mntd;break;case"mpd":case"rel_mpd":c=cm.mpd;break;default:case"pd":c=cm.pd}let g=c.d,x=c.b,S=c.e,a=c.c,U=c.modelHigh,W=c.modelLow;U({x:n,b:x.high,c:a.high,d:g.high,e:S.high});let he=W({x:n,b:x.low,c:a.low,d:g.low,e:S.low});return t-he}function Ex(e){let t,n=(e[1][0]??"min")+"",c,g,x,S=(e[1][1]??"med")+"",a,U,W,he=(e[1][2]??"max")+"",ae;return{c(){t=Rn("span"),c=ba(n),g=Sr(),x=Rn("span"),a=ba(S),U=Sr(),W=Rn("span"),ae=ba(he),this.h()},l(ce){t=Fn(ce,"SPAN",{class:!0});var be=_n(t);c=wa(be,n),be.forEach(yi),g=Ir(ce),x=Fn(ce,"SPAN",{class:!0});var Je=_n(x);a=wa(Je,S),Je.forEach(yi),U=Ir(ce),W=Fn(ce,"SPAN",{class:!0});var st=_n(W);ae=wa(st,he),st.forEach(yi),this.h()},h(){Ti(t,"class","svelte-1mfvjh6"),Ti(x,"class","svelte-1mfvjh6"),Ti(W,"class","svelte-1mfvjh6")},m(ce,be){Un(ce,t,be),qi(t,c),Un(ce,g,be),Un(ce,x,be),qi(x,a),Un(ce,U,be),Un(ce,W,be),qi(W,ae)},p(ce,be){be&2&&n!==(n=(ce[1][0]??"min")+"")&&ql(c,n),be&2&&S!==(S=(ce[1][1]??"med")+"")&&ql(a,S),be&2&&he!==(he=(ce[1][2]??"max")+"")&&ql(ae,he)},d(ce){ce&&(yi(t),yi(g),yi(x),yi(U),yi(W))}}}function ET(e){let t,n,c,g,x,S=e[1]&&Ex(e);return{c(){t=Rn("div"),n=Rn("div"),g=Sr(),x=Rn("div"),S&&S.c(),this.h()},l(a){t=Fn(a,"DIV",{class:!0});var U=_n(t);n=Fn(U,"DIV",{class:!0,style:!0}),_n(n).forEach(yi),g=Ir(U),x=Fn(U,"DIV",{class:!0});var W=_n(x);S&&S.l(W),W.forEach(yi),U.forEach(yi),this.h()},h(){Ti(n,"class","gradient svelte-1mfvjh6"),Ti(n,"style",c=`background-image: none, ${e[0]}`),Ti(x,"class","label-container svelte-1mfvjh6"),Ti(t,"class","legend-container svelte-1mfvjh6")},m(a,U){Un(a,t,U),qi(t,n),qi(t,g),qi(t,x),S&&S.m(x,null)},p(a,[U]){U&1&&c!==(c=`background-image: none, ${a[0]}`)&&Ti(n,"style",c),a[1]?S?S.p(a,U):(S=Ex(a),S.c(),S.m(x,null)):S&&(S.d(1),S=null)},i:Oa,o:Oa,d(a){a&&yi(t),S&&S.d()}}}function CT(e,t,n){let c;Bu(e,Fy,ae=>n(6,c=ae));let g=d_(),x,{colorScheme:S}=t,{metric:a}=t,U=[0,.5,1];function W(ae){console.log(ae);let ce=`linear-gradient(${ae.map(be=>be[1]).flat().reverse()})`;return console.log(ce),ce}function he(ae){if(!(ae!=null&&ae.length))return;let ce=ae.length-2;n(1,U[2]=Math.round(ae[ce]??1),U),n(1,U[1]=Math.round(ae[ce-2]??.5),U),n(1,U[0]=Math.round(ae[ce-4]??0),U)}return e.$$set=ae=>{"colorScheme"in ae&&n(2,S=ae.colorScheme),"metric"in ae&&n(3,a=ae.metric)},e.$$.update=()=>{e.$$.dirty&4&&n(5,g=d_(0,1,S).slice(1)),e.$$.dirty&32&&n(0,x=W(g)),e.$$.dirty&64&&he(c)},[x,U,S,a,W,g,c]}class TT extends fo{constructor(t){super(),po(this,t,CT,ET,Va,{colorScheme:2,metric:3,createPaletteGradient:4})}get createPaletteGradient(){return this.$$.ctx[4]}}function kT(e){let t,n,c,g,x,S,a,U,W,he,ae,ce,be;return{c(){t=Ra("svg"),n=Ra("defs"),c=Ra("style"),g=ba(`.cls-1 {
        fill: #29abe2;
      }
    `),x=Ra("g"),S=Ra("g"),a=Ra("g"),U=Ra("path"),W=Ra("path"),he=Ra("path"),ae=Ra("path"),ce=Ra("path"),be=Ra("polygon"),this.h()},l(Je){t=Fa(Je,"svg",{id:!0,"data-name":!0,xmlns:!0,viewBox:!0});var st=_n(t);n=Fa(st,"defs",{});var Ye=_n(n);c=Fa(Ye,"style",{});var it=_n(c);g=wa(it,`.cls-1 {
        fill: #29abe2;
      }
    `),it.forEach(yi),Ye.forEach(yi),x=Fa(st,"g",{id:!0,"data-name":!0});var ct=_n(x);S=Fa(ct,"g",{});var Tt=_n(S);a=Fa(Tt,"g",{});var zt=_n(a);U=Fa(zt,"path",{class:!0,d:!0}),_n(U).forEach(yi),W=Fa(zt,"path",{class:!0,d:!0}),_n(W).forEach(yi),he=Fa(zt,"path",{class:!0,d:!0}),_n(he).forEach(yi),ae=Fa(zt,"path",{class:!0,d:!0}),_n(ae).forEach(yi),ce=Fa(zt,"path",{class:!0,d:!0}),_n(ce).forEach(yi),zt.forEach(yi),be=Fa(Tt,"polygon",{class:!0,points:!0}),_n(be).forEach(yi),Tt.forEach(yi),ct.forEach(yi),st.forEach(yi),this.h()},h(){Ti(U,"class","cls-1"),Ti(U,"d","m9.41.16c1.38,0,2.18.92,1.92,2.28-.33,1.76-1.73,2.88-3.52,2.98l-1.2.06-1.13,3.08-1.68.12L6.91.16h2.5Zm-1.4,1.58l-.8,2.12.87-.03c.93-.03,1.38-.63,1.48-1.19.1-.56-.12-.92-.86-.91h-.68Z"),Ti(W,"class","cls-1"),Ti(W,"d","m14.62,7.9l1.24-3.16-2.79.12-1.25,3.24-1.68.12L13.24.15h1.69s-1.21,3.04-1.21,3.04l2.8-.08,1.21-2.96h1.7s-3.11,7.63-3.11,7.63l-1.7.12Z"),Ti(he,"class","cls-1"),Ti(he,"d","m22.82,5.85l-2.81.16-1.15,1.58-1.89.14L22.88.14h1.96s-.36,7.04-.36,7.04l-1.75.13.1-1.46Zm-1.65-1.38l1.75-.08.19-2.47-1.94,2.54Z"),Ti(ae,"class","cls-1"),Ti(ae,"d","m29.21,4.99c.06-.27,0-.48-.4-.63l-.81-.29c-.94-.34-1.26-1.02-1.08-1.84.3-1.36,1.78-2.23,3.24-2.23,2.08,0,2.33,1.22,2.18,1.89l-1.62.26c.04-.19.1-.88-.92-.86-.62,0-1.07.4-1.15.77-.08.34.12.52.39.63l.73.28c1.08.4,1.41,1,1.22,1.82-.23,1.05-1.46,2.18-3.22,2.31-2.15.16-2.61-1.14-2.41-2.06.03-.13.05-.21.08-.27l1.6-.32s-.05.14-.07.23c-.12.58.14,1.13,1.06,1.09.65-.04,1.09-.34,1.18-.77Z"),Ti(ce,"class","cls-1"),Ti(ce,"d","m36.78,1.44l-2.45,5.03-1.69.12,2.44-5.13-2.22.04.67-1.38h6.04s-.67,1.28-.67,1.28l-2.12.03Z"),Ti(be,"class","cls-1"),Ti(be,"points","3.79 .23 1.5 .23 0 2.22 .8 4.21 3.09 4.21 4.59 2.22 3.79 .23"),Ti(x,"id","Layer_1-2"),Ti(x,"data-name","Layer 1"),Ti(t,"id","Layer_2"),Ti(t,"data-name","Layer 2"),Ti(t,"xmlns","http://www.w3.org/2000/svg"),Ti(t,"viewBox","0 0 39.57 8.68")},m(Je,st){Un(Je,t,st),qi(t,n),qi(n,c),qi(c,g),qi(t,x),qi(x,S),qi(S,a),qi(a,U),qi(a,W),qi(a,he),qi(a,ae),qi(a,ce),qi(S,be)},p:Oa,i:Oa,o:Oa,d(Je){Je&&yi(t)}}}class v3 extends fo{constructor(t){super(),po(this,t,null,kT,Va,{})}}function Jg(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function MT(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function x3(e){let t,n,c;e.length!==2?(t=Jg,n=(a,U)=>Jg(e(a),U),c=(a,U)=>e(a)-U):(t=e===Jg||e===MT?e:PT,n=e,c=e);function g(a,U,W=0,he=a.length){if(W<he){if(t(U,U)!==0)return he;do{const ae=W+he>>>1;n(a[ae],U)<0?W=ae+1:he=ae}while(W<he)}return W}function x(a,U,W=0,he=a.length){if(W<he){if(t(U,U)!==0)return he;do{const ae=W+he>>>1;n(a[ae],U)<=0?W=ae+1:he=ae}while(W<he)}return W}function S(a,U,W=0,he=a.length){const ae=g(a,U,W,he-1);return ae>W&&c(a[ae-1],U)>-c(a[ae],U)?ae-1:ae}return{left:g,center:S,right:x}}function PT(){return 0}function DT(e){return e===null?NaN:+e}const LT=x3(Jg),BT=LT.right;x3(DT).center;function Cx(e,t){let n,c;if(t===void 0)for(const g of e)g!=null&&(n===void 0?g>=g&&(n=c=g):(n>g&&(n=g),c<g&&(c=g)));else{let g=-1;for(let x of e)(x=t(x,++g,e))!=null&&(n===void 0?x>=x&&(n=c=x):(n>x&&(n=x),c<x&&(c=x)))}return[n,c]}const zT=Math.sqrt(50),RT=Math.sqrt(10),FT=Math.sqrt(2);function g_(e,t,n){const c=(t-e)/Math.max(0,n),g=Math.floor(Math.log10(c)),x=c/Math.pow(10,g),S=x>=zT?10:x>=RT?5:x>=FT?2:1;let a,U,W;return g<0?(W=Math.pow(10,-g)/S,a=Math.round(e*W),U=Math.round(t*W),a/W<e&&++a,U/W>t&&--U,W=-W):(W=Math.pow(10,g)*S,a=Math.round(e/W),U=Math.round(t/W),a*W<e&&++a,U*W>t&&--U),U<a&&.5<=n&&n<2?g_(e,t,n*2):[a,U,W]}function OT(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const c=t<e,[g,x,S]=c?g_(t,e,n):g_(e,t,n);if(!(x>=g))return[];const a=x-g+1,U=new Array(a);if(c)if(S<0)for(let W=0;W<a;++W)U[W]=(x-W)/-S;else for(let W=0;W<a;++W)U[W]=(x-W)*S;else if(S<0)for(let W=0;W<a;++W)U[W]=(g+W)/-S;else for(let W=0;W<a;++W)U[W]=(g+W)*S;return U}function Ny(e,t,n){return t=+t,e=+e,n=+n,g_(e,t,n)[2]}function NT(e,t,n){t=+t,e=+e,n=+n;const c=t<e,g=c?Ny(t,e,n):Ny(e,t,n);return(c?-1:1)*(g<0?1/-g:g)}function VT(e){return e}var B1=1,z1=2,Vy=3,rg=4,Tx=1e-6;function UT(e){return"translate("+e+",0)"}function GT(e){return"translate(0,"+e+")"}function qT(e){return t=>+e(t)}function HT(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function jT(){return!this.__axis}function b3(e,t){var n=[],c=null,g=null,x=6,S=6,a=3,U=typeof window<"u"&&window.devicePixelRatio>1?0:.5,W=e===B1||e===rg?-1:1,he=e===rg||e===z1?"x":"y",ae=e===B1||e===Vy?UT:GT;function ce(be){var Je=c??(t.ticks?t.ticks.apply(t,n):t.domain()),st=g??(t.tickFormat?t.tickFormat.apply(t,n):VT),Ye=Math.max(x,0)+a,it=t.range(),ct=+it[0]+U,Tt=+it[it.length-1]+U,zt=(t.bandwidth?HT:qT)(t.copy(),U),Rt=be.selection?be.selection():be,Oe=Rt.selectAll(".domain").data([null]),jt=Rt.selectAll(".tick").data(Je,t).order(),at=jt.exit(),_t=jt.enter().append("g").attr("class","tick"),mt=jt.select("line"),xt=jt.select("text");Oe=Oe.merge(Oe.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),jt=jt.merge(_t),mt=mt.merge(_t.append("line").attr("stroke","currentColor").attr(he+"2",W*x)),xt=xt.merge(_t.append("text").attr("fill","currentColor").attr(he,W*Ye).attr("dy",e===B1?"0em":e===Vy?"0.71em":"0.32em")),be!==Rt&&(Oe=Oe.transition(be),jt=jt.transition(be),mt=mt.transition(be),xt=xt.transition(be),at=at.transition(be).attr("opacity",Tx).attr("transform",function(bt){return isFinite(bt=zt(bt))?ae(bt+U):this.getAttribute("transform")}),_t.attr("opacity",Tx).attr("transform",function(bt){var lt=this.parentNode.__axis;return ae((lt&&isFinite(lt=lt(bt))?lt:zt(bt))+U)})),at.remove(),Oe.attr("d",e===rg||e===z1?S?"M"+W*S+","+ct+"H"+U+"V"+Tt+"H"+W*S:"M"+U+","+ct+"V"+Tt:S?"M"+ct+","+W*S+"V"+U+"H"+Tt+"V"+W*S:"M"+ct+","+U+"H"+Tt),jt.attr("opacity",1).attr("transform",function(bt){return ae(zt(bt)+U)}),mt.attr(he+"2",W*x),xt.attr(he,W*Ye).text(st),Rt.filter(jT).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===z1?"start":e===rg?"end":"middle"),Rt.each(function(){this.__axis=zt})}return ce.scale=function(be){return arguments.length?(t=be,ce):t},ce.ticks=function(){return n=Array.from(arguments),ce},ce.tickArguments=function(be){return arguments.length?(n=be==null?[]:Array.from(be),ce):n.slice()},ce.tickValues=function(be){return arguments.length?(c=be==null?null:Array.from(be),ce):c&&c.slice()},ce.tickFormat=function(be){return arguments.length?(g=be,ce):g},ce.tickSize=function(be){return arguments.length?(x=S=+be,ce):x},ce.tickSizeInner=function(be){return arguments.length?(x=+be,ce):x},ce.tickSizeOuter=function(be){return arguments.length?(S=+be,ce):S},ce.tickPadding=function(be){return arguments.length?(a=+be,ce):a},ce.offset=function(be){return arguments.length?(U=+be,ce):U},ce}function ZT(e){return b3(Vy,e)}function QT(e){return b3(rg,e)}var WT={value:()=>{}};function w3(){for(var e=0,t=arguments.length,n={},c;e<t;++e){if(!(c=arguments[e]+"")||c in n||/[\s.]/.test(c))throw new Error("illegal type: "+c);n[c]=[]}return new e_(n)}function e_(e){this._=e}function $T(e,t){return e.trim().split(/^|\s+/).map(function(n){var c="",g=n.indexOf(".");if(g>=0&&(c=n.slice(g+1),n=n.slice(0,g)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:c}})}e_.prototype=w3.prototype={constructor:e_,on:function(e,t){var n=this._,c=$T(e+"",n),g,x=-1,S=c.length;if(arguments.length<2){for(;++x<S;)if((g=(e=c[x]).type)&&(g=XT(n[g],e.name)))return g;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++x<S;)if(g=(e=c[x]).type)n[g]=kx(n[g],e.name,t);else if(t==null)for(g in n)n[g]=kx(n[g],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new e_(e)},call:function(e,t){if((g=arguments.length-2)>0)for(var n=new Array(g),c=0,g,x;c<g;++c)n[c]=arguments[c+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(x=this._[e],c=0,g=x.length;c<g;++c)x[c].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var c=this._[e],g=0,x=c.length;g<x;++g)c[g].value.apply(t,n)}};function XT(e,t){for(var n=0,c=e.length,g;n<c;++n)if((g=e[n]).name===t)return g.value}function kx(e,t,n){for(var c=0,g=e.length;c<g;++c)if(e[c].name===t){e[c]=WT,e=e.slice(0,c).concat(e.slice(c+1));break}return n!=null&&e.push({name:t,value:n}),e}var Uy="http://www.w3.org/1999/xhtml";const Mx={svg:"http://www.w3.org/2000/svg",xhtml:Uy,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function X_(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Mx.hasOwnProperty(t)?{space:Mx[t],local:e}:e}function YT(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Uy&&t.documentElement.namespaceURI===Uy?t.createElement(e):t.createElementNS(n,e)}}function KT(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function S3(e){var t=X_(e);return(t.local?KT:YT)(t)}function JT(){}function Fv(e){return e==null?JT:function(){return this.querySelector(e)}}function ek(e){typeof e!="function"&&(e=Fv(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var x=t[g],S=x.length,a=c[g]=new Array(S),U,W,he=0;he<S;++he)(U=x[he])&&(W=e.call(U,U.__data__,he,x))&&("__data__"in U&&(W.__data__=U.__data__),a[he]=W);return new mh(c,this._parents)}function tk(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function ik(){return[]}function I3(e){return e==null?ik:function(){return this.querySelectorAll(e)}}function nk(e){return function(){return tk(e.apply(this,arguments))}}function rk(e){typeof e=="function"?e=nk(e):e=I3(e);for(var t=this._groups,n=t.length,c=[],g=[],x=0;x<n;++x)for(var S=t[x],a=S.length,U,W=0;W<a;++W)(U=S[W])&&(c.push(e.call(U,U.__data__,W,S)),g.push(U));return new mh(c,g)}function E3(e){return function(){return this.matches(e)}}function C3(e){return function(t){return t.matches(e)}}var sk=Array.prototype.find;function ak(e){return function(){return sk.call(this.children,e)}}function ok(){return this.firstElementChild}function lk(e){return this.select(e==null?ok:ak(typeof e=="function"?e:C3(e)))}var uk=Array.prototype.filter;function ck(){return Array.from(this.children)}function hk(e){return function(){return uk.call(this.children,e)}}function Ak(e){return this.selectAll(e==null?ck:hk(typeof e=="function"?e:C3(e)))}function fk(e){typeof e!="function"&&(e=E3(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var x=t[g],S=x.length,a=c[g]=[],U,W=0;W<S;++W)(U=x[W])&&e.call(U,U.__data__,W,x)&&a.push(U);return new mh(c,this._parents)}function T3(e){return new Array(e.length)}function dk(){return new mh(this._enter||this._groups.map(T3),this._parents)}function __(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}__.prototype={constructor:__,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function pk(e){return function(){return e}}function mk(e,t,n,c,g,x){for(var S=0,a,U=t.length,W=x.length;S<W;++S)(a=t[S])?(a.__data__=x[S],c[S]=a):n[S]=new __(e,x[S]);for(;S<U;++S)(a=t[S])&&(g[S]=a)}function gk(e,t,n,c,g,x,S){var a,U,W=new Map,he=t.length,ae=x.length,ce=new Array(he),be;for(a=0;a<he;++a)(U=t[a])&&(ce[a]=be=S.call(U,U.__data__,a,t)+"",W.has(be)?g[a]=U:W.set(be,U));for(a=0;a<ae;++a)be=S.call(e,x[a],a,x)+"",(U=W.get(be))?(c[a]=U,U.__data__=x[a],W.delete(be)):n[a]=new __(e,x[a]);for(a=0;a<he;++a)(U=t[a])&&W.get(ce[a])===U&&(g[a]=U)}function _k(e){return e.__data__}function yk(e,t){if(!arguments.length)return Array.from(this,_k);var n=t?gk:mk,c=this._parents,g=this._groups;typeof e!="function"&&(e=pk(e));for(var x=g.length,S=new Array(x),a=new Array(x),U=new Array(x),W=0;W<x;++W){var he=c[W],ae=g[W],ce=ae.length,be=vk(e.call(he,he&&he.__data__,W,c)),Je=be.length,st=a[W]=new Array(Je),Ye=S[W]=new Array(Je),it=U[W]=new Array(ce);n(he,ae,st,Ye,it,be,t);for(var ct=0,Tt=0,zt,Rt;ct<Je;++ct)if(zt=st[ct]){for(ct>=Tt&&(Tt=ct+1);!(Rt=Ye[Tt])&&++Tt<Je;);zt._next=Rt||null}}return S=new mh(S,c),S._enter=a,S._exit=U,S}function vk(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function xk(){return new mh(this._exit||this._groups.map(T3),this._parents)}function bk(e,t,n){var c=this.enter(),g=this,x=this.exit();return typeof e=="function"?(c=e(c),c&&(c=c.selection())):c=c.append(e+""),t!=null&&(g=t(g),g&&(g=g.selection())),n==null?x.remove():n(x),c&&g?c.merge(g).order():g}function wk(e){for(var t=e.selection?e.selection():e,n=this._groups,c=t._groups,g=n.length,x=c.length,S=Math.min(g,x),a=new Array(g),U=0;U<S;++U)for(var W=n[U],he=c[U],ae=W.length,ce=a[U]=new Array(ae),be,Je=0;Je<ae;++Je)(be=W[Je]||he[Je])&&(ce[Je]=be);for(;U<g;++U)a[U]=n[U];return new mh(a,this._parents)}function Sk(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var c=e[t],g=c.length-1,x=c[g],S;--g>=0;)(S=c[g])&&(x&&S.compareDocumentPosition(x)^4&&x.parentNode.insertBefore(S,x),x=S);return this}function Ik(e){e||(e=Ek);function t(ae,ce){return ae&&ce?e(ae.__data__,ce.__data__):!ae-!ce}for(var n=this._groups,c=n.length,g=new Array(c),x=0;x<c;++x){for(var S=n[x],a=S.length,U=g[x]=new Array(a),W,he=0;he<a;++he)(W=S[he])&&(U[he]=W);U.sort(t)}return new mh(g,this._parents).order()}function Ek(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Ck(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Tk(){return Array.from(this)}function kk(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var c=e[t],g=0,x=c.length;g<x;++g){var S=c[g];if(S)return S}return null}function Mk(){let e=0;for(const t of this)++e;return e}function Pk(){return!this.node()}function Dk(e){for(var t=this._groups,n=0,c=t.length;n<c;++n)for(var g=t[n],x=0,S=g.length,a;x<S;++x)(a=g[x])&&e.call(a,a.__data__,x,g);return this}function Lk(e){return function(){this.removeAttribute(e)}}function Bk(e){return function(){this.removeAttributeNS(e.space,e.local)}}function zk(e,t){return function(){this.setAttribute(e,t)}}function Rk(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Fk(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Ok(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Nk(e,t){var n=X_(e);if(arguments.length<2){var c=this.node();return n.local?c.getAttributeNS(n.space,n.local):c.getAttribute(n)}return this.each((t==null?n.local?Bk:Lk:typeof t=="function"?n.local?Ok:Fk:n.local?Rk:zk)(n,t))}function k3(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Vk(e){return function(){this.style.removeProperty(e)}}function Uk(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Gk(e,t,n){return function(){var c=t.apply(this,arguments);c==null?this.style.removeProperty(e):this.style.setProperty(e,c,n)}}function qk(e,t,n){return arguments.length>1?this.each((t==null?Vk:typeof t=="function"?Gk:Uk)(e,t,n??"")):dm(this.node(),e)}function dm(e,t){return e.style.getPropertyValue(t)||k3(e).getComputedStyle(e,null).getPropertyValue(t)}function Hk(e){return function(){delete this[e]}}function jk(e,t){return function(){this[e]=t}}function Zk(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Qk(e,t){return arguments.length>1?this.each((t==null?Hk:typeof t=="function"?Zk:jk)(e,t)):this.node()[e]}function M3(e){return e.trim().split(/^|\s+/)}function Ov(e){return e.classList||new P3(e)}function P3(e){this._node=e,this._names=M3(e.getAttribute("class")||"")}P3.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function D3(e,t){for(var n=Ov(e),c=-1,g=t.length;++c<g;)n.add(t[c])}function L3(e,t){for(var n=Ov(e),c=-1,g=t.length;++c<g;)n.remove(t[c])}function Wk(e){return function(){D3(this,e)}}function $k(e){return function(){L3(this,e)}}function Xk(e,t){return function(){(t.apply(this,arguments)?D3:L3)(this,e)}}function Yk(e,t){var n=M3(e+"");if(arguments.length<2){for(var c=Ov(this.node()),g=-1,x=n.length;++g<x;)if(!c.contains(n[g]))return!1;return!0}return this.each((typeof t=="function"?Xk:t?Wk:$k)(n,t))}function Kk(){this.textContent=""}function Jk(e){return function(){this.textContent=e}}function e6(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function t6(e){return arguments.length?this.each(e==null?Kk:(typeof e=="function"?e6:Jk)(e)):this.node().textContent}function i6(){this.innerHTML=""}function n6(e){return function(){this.innerHTML=e}}function r6(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function s6(e){return arguments.length?this.each(e==null?i6:(typeof e=="function"?r6:n6)(e)):this.node().innerHTML}function a6(){this.nextSibling&&this.parentNode.appendChild(this)}function o6(){return this.each(a6)}function l6(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function u6(){return this.each(l6)}function c6(e){var t=typeof e=="function"?e:S3(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function h6(){return null}function A6(e,t){var n=typeof e=="function"?e:S3(e),c=t==null?h6:typeof t=="function"?t:Fv(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),c.apply(this,arguments)||null)})}function f6(){var e=this.parentNode;e&&e.removeChild(this)}function d6(){return this.each(f6)}function p6(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function m6(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function g6(e){return this.select(e?m6:p6)}function _6(e){return arguments.length?this.property("__data__",e):this.node().__data__}function y6(e){return function(t){e.call(this,t,this.__data__)}}function v6(e){return e.trim().split(/^|\s+/).map(function(t){var n="",c=t.indexOf(".");return c>=0&&(n=t.slice(c+1),t=t.slice(0,c)),{type:t,name:n}})}function x6(e){return function(){var t=this.__on;if(t){for(var n=0,c=-1,g=t.length,x;n<g;++n)x=t[n],(!e.type||x.type===e.type)&&x.name===e.name?this.removeEventListener(x.type,x.listener,x.options):t[++c]=x;++c?t.length=c:delete this.__on}}}function b6(e,t,n){return function(){var c=this.__on,g,x=y6(t);if(c){for(var S=0,a=c.length;S<a;++S)if((g=c[S]).type===e.type&&g.name===e.name){this.removeEventListener(g.type,g.listener,g.options),this.addEventListener(g.type,g.listener=x,g.options=n),g.value=t;return}}this.addEventListener(e.type,x,n),g={type:e.type,name:e.name,value:t,listener:x,options:n},c?c.push(g):this.__on=[g]}}function w6(e,t,n){var c=v6(e+""),g,x=c.length,S;if(arguments.length<2){var a=this.node().__on;if(a){for(var U=0,W=a.length,he;U<W;++U)for(g=0,he=a[U];g<x;++g)if((S=c[g]).type===he.type&&S.name===he.name)return he.value}return}for(a=t?b6:x6,g=0;g<x;++g)this.each(a(c[g],t,n));return this}function B3(e,t,n){var c=k3(e),g=c.CustomEvent;typeof g=="function"?g=new g(t,n):(g=c.document.createEvent("Event"),n?(g.initEvent(t,n.bubbles,n.cancelable),g.detail=n.detail):g.initEvent(t,!1,!1)),e.dispatchEvent(g)}function S6(e,t){return function(){return B3(this,e,t)}}function I6(e,t){return function(){return B3(this,e,t.apply(this,arguments))}}function E6(e,t){return this.each((typeof t=="function"?I6:S6)(e,t))}function*C6(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var c=e[t],g=0,x=c.length,S;g<x;++g)(S=c[g])&&(yield S)}var z3=[null];function mh(e,t){this._groups=e,this._parents=t}function Tg(){return new mh([[document.documentElement]],z3)}function T6(){return this}mh.prototype=Tg.prototype={constructor:mh,select:ek,selectAll:rk,selectChild:lk,selectChildren:Ak,filter:fk,data:yk,enter:dk,exit:xk,join:bk,merge:wk,selection:T6,order:Sk,sort:Ik,call:Ck,nodes:Tk,node:kk,size:Mk,empty:Pk,each:Dk,attr:Nk,style:qk,property:Qk,classed:Yk,text:t6,html:s6,raise:o6,lower:u6,append:c6,insert:A6,remove:d6,clone:g6,datum:_6,on:w6,dispatch:E6,[Symbol.iterator]:C6};function R1(e){return typeof e=="string"?new mh([[document.querySelector(e)]],[document.documentElement]):new mh([[e]],z3)}function Nv(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function R3(e,t){var n=Object.create(e.prototype);for(var c in t)n[c]=t[c];return n}function kg(){}var dg=.7,y_=1/dg,hm="\\s*([+-]?\\d+)\\s*",pg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",YA="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",k6=/^#([0-9a-f]{3,8})$/,M6=new RegExp(`^rgb\\(${hm},${hm},${hm}\\)$`),P6=new RegExp(`^rgb\\(${YA},${YA},${YA}\\)$`),D6=new RegExp(`^rgba\\(${hm},${hm},${hm},${pg}\\)$`),L6=new RegExp(`^rgba\\(${YA},${YA},${YA},${pg}\\)$`),B6=new RegExp(`^hsl\\(${pg},${YA},${YA}\\)$`),z6=new RegExp(`^hsla\\(${pg},${YA},${YA},${pg}\\)$`),Px={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Nv(kg,ip,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Dx,formatHex:Dx,formatHex8:R6,formatHsl:F6,formatRgb:Lx,toString:Lx});function Dx(){return this.rgb().formatHex()}function R6(){return this.rgb().formatHex8()}function F6(){return F3(this).formatHsl()}function Lx(){return this.rgb().formatRgb()}function ip(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=k6.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Bx(t):n===3?new Gc(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Gg(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Gg(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=M6.exec(e))?new Gc(t[1],t[2],t[3],1):(t=P6.exec(e))?new Gc(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=D6.exec(e))?Gg(t[1],t[2],t[3],t[4]):(t=L6.exec(e))?Gg(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=B6.exec(e))?Fx(t[1],t[2]/100,t[3]/100,1):(t=z6.exec(e))?Fx(t[1],t[2]/100,t[3]/100,t[4]):Px.hasOwnProperty(e)?Bx(Px[e]):e==="transparent"?new Gc(NaN,NaN,NaN,0):null}function Bx(e){return new Gc(e>>16&255,e>>8&255,e&255,1)}function Gg(e,t,n,c){return c<=0&&(e=t=n=NaN),new Gc(e,t,n,c)}function O6(e){return e instanceof kg||(e=ip(e)),e?(e=e.rgb(),new Gc(e.r,e.g,e.b,e.opacity)):new Gc}function Gy(e,t,n,c){return arguments.length===1?O6(e):new Gc(e,t,n,c??1)}function Gc(e,t,n,c){this.r=+e,this.g=+t,this.b=+n,this.opacity=+c}Nv(Gc,Gy,R3(kg,{brighter(e){return e=e==null?y_:Math.pow(y_,e),new Gc(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?dg:Math.pow(dg,e),new Gc(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Gc(Yd(this.r),Yd(this.g),Yd(this.b),v_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zx,formatHex:zx,formatHex8:N6,formatRgb:Rx,toString:Rx}));function zx(){return`#${Wd(this.r)}${Wd(this.g)}${Wd(this.b)}`}function N6(){return`#${Wd(this.r)}${Wd(this.g)}${Wd(this.b)}${Wd((isNaN(this.opacity)?1:this.opacity)*255)}`}function Rx(){const e=v_(this.opacity);return`${e===1?"rgb(":"rgba("}${Yd(this.r)}, ${Yd(this.g)}, ${Yd(this.b)}${e===1?")":`, ${e})`}`}function v_(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Yd(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Wd(e){return e=Yd(e),(e<16?"0":"")+e.toString(16)}function Fx(e,t,n,c){return c<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new cA(e,t,n,c)}function F3(e){if(e instanceof cA)return new cA(e.h,e.s,e.l,e.opacity);if(e instanceof kg||(e=ip(e)),!e)return new cA;if(e instanceof cA)return e;e=e.rgb();var t=e.r/255,n=e.g/255,c=e.b/255,g=Math.min(t,n,c),x=Math.max(t,n,c),S=NaN,a=x-g,U=(x+g)/2;return a?(t===x?S=(n-c)/a+(n<c)*6:n===x?S=(c-t)/a+2:S=(t-n)/a+4,a/=U<.5?x+g:2-x-g,S*=60):a=U>0&&U<1?0:S,new cA(S,a,U,e.opacity)}function V6(e,t,n,c){return arguments.length===1?F3(e):new cA(e,t,n,c??1)}function cA(e,t,n,c){this.h=+e,this.s=+t,this.l=+n,this.opacity=+c}Nv(cA,V6,R3(kg,{brighter(e){return e=e==null?y_:Math.pow(y_,e),new cA(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?dg:Math.pow(dg,e),new cA(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,c=n+(n<.5?n:1-n)*t,g=2*n-c;return new Gc(F1(e>=240?e-240:e+120,g,c),F1(e,g,c),F1(e<120?e+240:e-120,g,c),this.opacity)},clamp(){return new cA(Ox(this.h),qg(this.s),qg(this.l),v_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=v_(this.opacity);return`${e===1?"hsl(":"hsla("}${Ox(this.h)}, ${qg(this.s)*100}%, ${qg(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Ox(e){return e=(e||0)%360,e<0?e+360:e}function qg(e){return Math.max(0,Math.min(1,e||0))}function F1(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Vv=e=>()=>e;function U6(e,t){return function(n){return e+n*t}}function G6(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(c){return Math.pow(e+c*t,n)}}function q6(e){return(e=+e)==1?O3:function(t,n){return n-t?G6(t,n,e):Vv(isNaN(t)?n:t)}}function O3(e,t){var n=t-e;return n?U6(e,n):Vv(isNaN(e)?t:e)}const x_=function e(t){var n=q6(t);function c(g,x){var S=n((g=Gy(g)).r,(x=Gy(x)).r),a=n(g.g,x.g),U=n(g.b,x.b),W=O3(g.opacity,x.opacity);return function(he){return g.r=S(he),g.g=a(he),g.b=U(he),g.opacity=W(he),g+""}}return c.gamma=e,c}(1);function H6(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,c=t.slice(),g;return function(x){for(g=0;g<n;++g)c[g]=e[g]*(1-x)+t[g]*x;return c}}function j6(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Z6(e,t){var n=t?t.length:0,c=e?Math.min(n,e.length):0,g=new Array(c),x=new Array(n),S;for(S=0;S<c;++S)g[S]=Uv(e[S],t[S]);for(;S<n;++S)x[S]=t[S];return function(a){for(S=0;S<c;++S)x[S]=g[S](a);return x}}function Q6(e,t){var n=new Date;return e=+e,t=+t,function(c){return n.setTime(e*(1-c)+t*c),n}}function lA(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function W6(e,t){var n={},c={},g;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(g in t)g in e?n[g]=Uv(e[g],t[g]):c[g]=t[g];return function(x){for(g in n)c[g]=n[g](x);return c}}var qy=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,O1=new RegExp(qy.source,"g");function $6(e){return function(){return e}}function X6(e){return function(t){return e(t)+""}}function N3(e,t){var n=qy.lastIndex=O1.lastIndex=0,c,g,x,S=-1,a=[],U=[];for(e=e+"",t=t+"";(c=qy.exec(e))&&(g=O1.exec(t));)(x=g.index)>n&&(x=t.slice(n,x),a[S]?a[S]+=x:a[++S]=x),(c=c[0])===(g=g[0])?a[S]?a[S]+=g:a[++S]=g:(a[++S]=null,U.push({i:S,x:lA(c,g)})),n=O1.lastIndex;return n<t.length&&(x=t.slice(n),a[S]?a[S]+=x:a[++S]=x),a.length<2?U[0]?X6(U[0].x):$6(t):(t=U.length,function(W){for(var he=0,ae;he<t;++he)a[(ae=U[he]).i]=ae.x(W);return a.join("")})}function Uv(e,t){var n=typeof t,c;return t==null||n==="boolean"?Vv(t):(n==="number"?lA:n==="string"?(c=ip(t))?(t=c,x_):N3:t instanceof ip?x_:t instanceof Date?Q6:j6(t)?H6:Array.isArray(t)?Z6:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?W6:lA)(e,t)}function Y6(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var Nx=180/Math.PI,Hy={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function V3(e,t,n,c,g,x){var S,a,U;return(S=Math.sqrt(e*e+t*t))&&(e/=S,t/=S),(U=e*n+t*c)&&(n-=e*U,c-=t*U),(a=Math.sqrt(n*n+c*c))&&(n/=a,c/=a,U/=a),e*c<t*n&&(e=-e,t=-t,U=-U,S=-S),{translateX:g,translateY:x,rotate:Math.atan2(t,e)*Nx,skewX:Math.atan(U)*Nx,scaleX:S,scaleY:a}}var Hg;function K6(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Hy:V3(t.a,t.b,t.c,t.d,t.e,t.f)}function J6(e){return e==null||(Hg||(Hg=document.createElementNS("http://www.w3.org/2000/svg","g")),Hg.setAttribute("transform",e),!(e=Hg.transform.baseVal.consolidate()))?Hy:(e=e.matrix,V3(e.a,e.b,e.c,e.d,e.e,e.f))}function U3(e,t,n,c){function g(W){return W.length?W.pop()+" ":""}function x(W,he,ae,ce,be,Je){if(W!==ae||he!==ce){var st=be.push("translate(",null,t,null,n);Je.push({i:st-4,x:lA(W,ae)},{i:st-2,x:lA(he,ce)})}else(ae||ce)&&be.push("translate("+ae+t+ce+n)}function S(W,he,ae,ce){W!==he?(W-he>180?he+=360:he-W>180&&(W+=360),ce.push({i:ae.push(g(ae)+"rotate(",null,c)-2,x:lA(W,he)})):he&&ae.push(g(ae)+"rotate("+he+c)}function a(W,he,ae,ce){W!==he?ce.push({i:ae.push(g(ae)+"skewX(",null,c)-2,x:lA(W,he)}):he&&ae.push(g(ae)+"skewX("+he+c)}function U(W,he,ae,ce,be,Je){if(W!==ae||he!==ce){var st=be.push(g(be)+"scale(",null,",",null,")");Je.push({i:st-4,x:lA(W,ae)},{i:st-2,x:lA(he,ce)})}else(ae!==1||ce!==1)&&be.push(g(be)+"scale("+ae+","+ce+")")}return function(W,he){var ae=[],ce=[];return W=e(W),he=e(he),x(W.translateX,W.translateY,he.translateX,he.translateY,ae,ce),S(W.rotate,he.rotate,ae,ce),a(W.skewX,he.skewX,ae,ce),U(W.scaleX,W.scaleY,he.scaleX,he.scaleY,ae,ce),W=he=null,function(be){for(var Je=-1,st=ce.length,Ye;++Je<st;)ae[(Ye=ce[Je]).i]=Ye.x(be);return ae.join("")}}}var e8=U3(K6,"px, ","px)","deg)"),t8=U3(J6,", ",")",")"),pm=0,sg=0,Qm=0,G3=1e3,b_,ag,w_=0,np=0,Y_=0,mg=typeof performance=="object"&&performance.now?performance:Date,q3=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Gv(){return np||(q3(i8),np=mg.now()+Y_)}function i8(){np=0}function S_(){this._call=this._time=this._next=null}S_.prototype=H3.prototype={constructor:S_,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Gv():+n)+(t==null?0:+t),!this._next&&ag!==this&&(ag?ag._next=this:b_=this,ag=this),this._call=e,this._time=n,jy()},stop:function(){this._call&&(this._call=null,this._time=1/0,jy())}};function H3(e,t,n){var c=new S_;return c.restart(e,t,n),c}function n8(){Gv(),++pm;for(var e=b_,t;e;)(t=np-e._time)>=0&&e._call.call(void 0,t),e=e._next;--pm}function Vx(){np=(w_=mg.now())+Y_,pm=sg=0;try{n8()}finally{pm=0,s8(),np=0}}function r8(){var e=mg.now(),t=e-w_;t>G3&&(Y_-=t,w_=e)}function s8(){for(var e,t=b_,n,c=1/0;t;)t._call?(c>t._time&&(c=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:b_=n);ag=e,jy(c)}function jy(e){if(!pm){sg&&(sg=clearTimeout(sg));var t=e-np;t>24?(e<1/0&&(sg=setTimeout(Vx,e-mg.now()-Y_)),Qm&&(Qm=clearInterval(Qm))):(Qm||(w_=mg.now(),Qm=setInterval(r8,G3)),pm=1,q3(Vx))}}function Ux(e,t,n){var c=new S_;return t=t==null?0:+t,c.restart(g=>{c.stop(),e(g+t)},t,n),c}var a8=w3("start","end","cancel","interrupt"),o8=[],j3=0,Gx=1,Zy=2,t_=3,qx=4,Qy=5,i_=6;function K_(e,t,n,c,g,x){var S=e.__transition;if(!S)e.__transition={};else if(n in S)return;l8(e,n,{name:t,index:c,group:g,on:a8,tween:o8,time:x.time,delay:x.delay,duration:x.duration,ease:x.ease,timer:null,state:j3})}function qv(e,t){var n=hA(e,t);if(n.state>j3)throw new Error("too late; already scheduled");return n}function rf(e,t){var n=hA(e,t);if(n.state>t_)throw new Error("too late; already running");return n}function hA(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function l8(e,t,n){var c=e.__transition,g;c[t]=n,n.timer=H3(x,0,n.time);function x(W){n.state=Gx,n.timer.restart(S,n.delay,n.time),n.delay<=W&&S(W-n.delay)}function S(W){var he,ae,ce,be;if(n.state!==Gx)return U();for(he in c)if(be=c[he],be.name===n.name){if(be.state===t_)return Ux(S);be.state===qx?(be.state=i_,be.timer.stop(),be.on.call("interrupt",e,e.__data__,be.index,be.group),delete c[he]):+he<t&&(be.state=i_,be.timer.stop(),be.on.call("cancel",e,e.__data__,be.index,be.group),delete c[he])}if(Ux(function(){n.state===t_&&(n.state=qx,n.timer.restart(a,n.delay,n.time),a(W))}),n.state=Zy,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Zy){for(n.state=t_,g=new Array(ce=n.tween.length),he=0,ae=-1;he<ce;++he)(be=n.tween[he].value.call(e,e.__data__,n.index,n.group))&&(g[++ae]=be);g.length=ae+1}}function a(W){for(var he=W<n.duration?n.ease.call(null,W/n.duration):(n.timer.restart(U),n.state=Qy,1),ae=-1,ce=g.length;++ae<ce;)g[ae].call(e,he);n.state===Qy&&(n.on.call("end",e,e.__data__,n.index,n.group),U())}function U(){n.state=i_,n.timer.stop(),delete c[t];for(var W in c)return;delete e.__transition}}function u8(e,t){var n=e.__transition,c,g,x=!0,S;if(n){t=t==null?null:t+"";for(S in n){if((c=n[S]).name!==t){x=!1;continue}g=c.state>Zy&&c.state<Qy,c.state=i_,c.timer.stop(),c.on.call(g?"interrupt":"cancel",e,e.__data__,c.index,c.group),delete n[S]}x&&delete e.__transition}}function c8(e){return this.each(function(){u8(this,e)})}function h8(e,t){var n,c;return function(){var g=rf(this,e),x=g.tween;if(x!==n){c=n=x;for(var S=0,a=c.length;S<a;++S)if(c[S].name===t){c=c.slice(),c.splice(S,1);break}}g.tween=c}}function A8(e,t,n){var c,g;if(typeof n!="function")throw new Error;return function(){var x=rf(this,e),S=x.tween;if(S!==c){g=(c=S).slice();for(var a={name:t,value:n},U=0,W=g.length;U<W;++U)if(g[U].name===t){g[U]=a;break}U===W&&g.push(a)}x.tween=g}}function f8(e,t){var n=this._id;if(e+="",arguments.length<2){for(var c=hA(this.node(),n).tween,g=0,x=c.length,S;g<x;++g)if((S=c[g]).name===e)return S.value;return null}return this.each((t==null?h8:A8)(n,e,t))}function Hv(e,t,n){var c=e._id;return e.each(function(){var g=rf(this,c);(g.value||(g.value={}))[t]=n.apply(this,arguments)}),function(g){return hA(g,c).value[t]}}function Z3(e,t){var n;return(typeof t=="number"?lA:t instanceof ip?x_:(n=ip(t))?(t=n,x_):N3)(e,t)}function d8(e){return function(){this.removeAttribute(e)}}function p8(e){return function(){this.removeAttributeNS(e.space,e.local)}}function m8(e,t,n){var c,g=n+"",x;return function(){var S=this.getAttribute(e);return S===g?null:S===c?x:x=t(c=S,n)}}function g8(e,t,n){var c,g=n+"",x;return function(){var S=this.getAttributeNS(e.space,e.local);return S===g?null:S===c?x:x=t(c=S,n)}}function _8(e,t,n){var c,g,x;return function(){var S,a=n(this),U;return a==null?void this.removeAttribute(e):(S=this.getAttribute(e),U=a+"",S===U?null:S===c&&U===g?x:(g=U,x=t(c=S,a)))}}function y8(e,t,n){var c,g,x;return function(){var S,a=n(this),U;return a==null?void this.removeAttributeNS(e.space,e.local):(S=this.getAttributeNS(e.space,e.local),U=a+"",S===U?null:S===c&&U===g?x:(g=U,x=t(c=S,a)))}}function v8(e,t){var n=X_(e),c=n==="transform"?t8:Z3;return this.attrTween(e,typeof t=="function"?(n.local?y8:_8)(n,c,Hv(this,"attr."+e,t)):t==null?(n.local?p8:d8)(n):(n.local?g8:m8)(n,c,t))}function x8(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function b8(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function w8(e,t){var n,c;function g(){var x=t.apply(this,arguments);return x!==c&&(n=(c=x)&&b8(e,x)),n}return g._value=t,g}function S8(e,t){var n,c;function g(){var x=t.apply(this,arguments);return x!==c&&(n=(c=x)&&x8(e,x)),n}return g._value=t,g}function I8(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var c=X_(e);return this.tween(n,(c.local?w8:S8)(c,t))}function E8(e,t){return function(){qv(this,e).delay=+t.apply(this,arguments)}}function C8(e,t){return t=+t,function(){qv(this,e).delay=t}}function T8(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?E8:C8)(t,e)):hA(this.node(),t).delay}function k8(e,t){return function(){rf(this,e).duration=+t.apply(this,arguments)}}function M8(e,t){return t=+t,function(){rf(this,e).duration=t}}function P8(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?k8:M8)(t,e)):hA(this.node(),t).duration}function D8(e,t){if(typeof t!="function")throw new Error;return function(){rf(this,e).ease=t}}function L8(e){var t=this._id;return arguments.length?this.each(D8(t,e)):hA(this.node(),t).ease}function B8(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;rf(this,e).ease=n}}function z8(e){if(typeof e!="function")throw new Error;return this.each(B8(this._id,e))}function R8(e){typeof e!="function"&&(e=E3(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var x=t[g],S=x.length,a=c[g]=[],U,W=0;W<S;++W)(U=x[W])&&e.call(U,U.__data__,W,x)&&a.push(U);return new s0(c,this._parents,this._name,this._id)}function F8(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,c=t.length,g=n.length,x=Math.min(c,g),S=new Array(c),a=0;a<x;++a)for(var U=t[a],W=n[a],he=U.length,ae=S[a]=new Array(he),ce,be=0;be<he;++be)(ce=U[be]||W[be])&&(ae[be]=ce);for(;a<c;++a)S[a]=t[a];return new s0(S,this._parents,this._name,this._id)}function O8(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function N8(e,t,n){var c,g,x=O8(t)?qv:rf;return function(){var S=x(this,e),a=S.on;a!==c&&(g=(c=a).copy()).on(t,n),S.on=g}}function V8(e,t){var n=this._id;return arguments.length<2?hA(this.node(),n).on.on(e):this.each(N8(n,e,t))}function U8(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function G8(){return this.on("end.remove",U8(this._id))}function q8(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Fv(e));for(var c=this._groups,g=c.length,x=new Array(g),S=0;S<g;++S)for(var a=c[S],U=a.length,W=x[S]=new Array(U),he,ae,ce=0;ce<U;++ce)(he=a[ce])&&(ae=e.call(he,he.__data__,ce,a))&&("__data__"in he&&(ae.__data__=he.__data__),W[ce]=ae,K_(W[ce],t,n,ce,W,hA(he,n)));return new s0(x,this._parents,t,n)}function H8(e){var t=this._name,n=this._id;typeof e!="function"&&(e=I3(e));for(var c=this._groups,g=c.length,x=[],S=[],a=0;a<g;++a)for(var U=c[a],W=U.length,he,ae=0;ae<W;++ae)if(he=U[ae]){for(var ce=e.call(he,he.__data__,ae,U),be,Je=hA(he,n),st=0,Ye=ce.length;st<Ye;++st)(be=ce[st])&&K_(be,t,n,st,ce,Je);x.push(ce),S.push(he)}return new s0(x,S,t,n)}var j8=Tg.prototype.constructor;function Z8(){return new j8(this._groups,this._parents)}function Q8(e,t){var n,c,g;return function(){var x=dm(this,e),S=(this.style.removeProperty(e),dm(this,e));return x===S?null:x===n&&S===c?g:g=t(n=x,c=S)}}function Q3(e){return function(){this.style.removeProperty(e)}}function W8(e,t,n){var c,g=n+"",x;return function(){var S=dm(this,e);return S===g?null:S===c?x:x=t(c=S,n)}}function $8(e,t,n){var c,g,x;return function(){var S=dm(this,e),a=n(this),U=a+"";return a==null&&(U=a=(this.style.removeProperty(e),dm(this,e))),S===U?null:S===c&&U===g?x:(g=U,x=t(c=S,a))}}function X8(e,t){var n,c,g,x="style."+t,S="end."+x,a;return function(){var U=rf(this,e),W=U.on,he=U.value[x]==null?a||(a=Q3(t)):void 0;(W!==n||g!==he)&&(c=(n=W).copy()).on(S,g=he),U.on=c}}function Y8(e,t,n){var c=(e+="")=="transform"?e8:Z3;return t==null?this.styleTween(e,Q8(e,c)).on("end.style."+e,Q3(e)):typeof t=="function"?this.styleTween(e,$8(e,c,Hv(this,"style."+e,t))).each(X8(this._id,e)):this.styleTween(e,W8(e,c,t),n).on("end.style."+e,null)}function K8(e,t,n){return function(c){this.style.setProperty(e,t.call(this,c),n)}}function J8(e,t,n){var c,g;function x(){var S=t.apply(this,arguments);return S!==g&&(c=(g=S)&&K8(e,S,n)),c}return x._value=t,x}function eM(e,t,n){var c="style."+(e+="");if(arguments.length<2)return(c=this.tween(c))&&c._value;if(t==null)return this.tween(c,null);if(typeof t!="function")throw new Error;return this.tween(c,J8(e,t,n??""))}function tM(e){return function(){this.textContent=e}}function iM(e){return function(){var t=e(this);this.textContent=t??""}}function nM(e){return this.tween("text",typeof e=="function"?iM(Hv(this,"text",e)):tM(e==null?"":e+""))}function rM(e){return function(t){this.textContent=e.call(this,t)}}function sM(e){var t,n;function c(){var g=e.apply(this,arguments);return g!==n&&(t=(n=g)&&rM(g)),t}return c._value=e,c}function aM(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,sM(e))}function oM(){for(var e=this._name,t=this._id,n=W3(),c=this._groups,g=c.length,x=0;x<g;++x)for(var S=c[x],a=S.length,U,W=0;W<a;++W)if(U=S[W]){var he=hA(U,t);K_(U,e,n,W,S,{time:he.time+he.delay+he.duration,delay:0,duration:he.duration,ease:he.ease})}return new s0(c,this._parents,e,n)}function lM(){var e,t,n=this,c=n._id,g=n.size();return new Promise(function(x,S){var a={value:S},U={value:function(){--g===0&&x()}};n.each(function(){var W=rf(this,c),he=W.on;he!==e&&(t=(e=he).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(U)),W.on=t}),g===0&&x()})}var uM=0;function s0(e,t,n,c){this._groups=e,this._parents=t,this._name=n,this._id=c}function W3(){return++uM}var Qf=Tg.prototype;s0.prototype={constructor:s0,select:q8,selectAll:H8,selectChild:Qf.selectChild,selectChildren:Qf.selectChildren,filter:R8,merge:F8,selection:Z8,transition:oM,call:Qf.call,nodes:Qf.nodes,node:Qf.node,size:Qf.size,empty:Qf.empty,each:Qf.each,on:V8,attr:v8,attrTween:I8,style:Y8,styleTween:eM,text:nM,textTween:aM,remove:G8,tween:f8,delay:T8,duration:P8,ease:L8,easeVarying:z8,end:lM,[Symbol.iterator]:Qf[Symbol.iterator]};function cM(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var hM={time:null,delay:0,duration:250,ease:cM};function AM(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function fM(e){var t,n;e instanceof s0?(t=e._id,e=e._name):(t=W3(),(n=hM).time=Gv(),e=e==null?null:e+"");for(var c=this._groups,g=c.length,x=0;x<g;++x)for(var S=c[x],a=S.length,U,W=0;W<a;++W)(U=S[W])&&K_(U,e,t,W,S,n||AM(U,t));return new s0(c,this._parents,e,t)}Tg.prototype.interrupt=c8;Tg.prototype.transition=fM;const Wy=Math.PI,$y=2*Wy,Zd=1e-6,dM=$y-Zd;function $3(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function pM(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return $3;const n=10**t;return function(c){this._+=c[0];for(let g=1,x=c.length;g<x;++g)this._+=Math.round(arguments[g]*n)/n+c[g]}}let mM=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?$3:pM(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,c,g){this._append`Q${+t},${+n},${this._x1=+c},${this._y1=+g}`}bezierCurveTo(t,n,c,g,x,S){this._append`C${+t},${+n},${+c},${+g},${this._x1=+x},${this._y1=+S}`}arcTo(t,n,c,g,x){if(t=+t,n=+n,c=+c,g=+g,x=+x,x<0)throw new Error(`negative radius: ${x}`);let S=this._x1,a=this._y1,U=c-t,W=g-n,he=S-t,ae=a-n,ce=he*he+ae*ae;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(ce>Zd)if(!(Math.abs(ae*U-W*he)>Zd)||!x)this._append`L${this._x1=t},${this._y1=n}`;else{let be=c-S,Je=g-a,st=U*U+W*W,Ye=be*be+Je*Je,it=Math.sqrt(st),ct=Math.sqrt(ce),Tt=x*Math.tan((Wy-Math.acos((st+ce-Ye)/(2*it*ct)))/2),zt=Tt/ct,Rt=Tt/it;Math.abs(zt-1)>Zd&&this._append`L${t+zt*he},${n+zt*ae}`,this._append`A${x},${x},0,0,${+(ae*be>he*Je)},${this._x1=t+Rt*U},${this._y1=n+Rt*W}`}}arc(t,n,c,g,x,S){if(t=+t,n=+n,c=+c,S=!!S,c<0)throw new Error(`negative radius: ${c}`);let a=c*Math.cos(g),U=c*Math.sin(g),W=t+a,he=n+U,ae=1^S,ce=S?g-x:x-g;this._x1===null?this._append`M${W},${he}`:(Math.abs(this._x1-W)>Zd||Math.abs(this._y1-he)>Zd)&&this._append`L${W},${he}`,c&&(ce<0&&(ce=ce%$y+$y),ce>dM?this._append`A${c},${c},0,1,${ae},${t-a},${n-U}A${c},${c},0,1,${ae},${this._x1=W},${this._y1=he}`:ce>Zd&&this._append`A${c},${c},0,${+(ce>=Wy)},${ae},${this._x1=t+c*Math.cos(x)},${this._y1=n+c*Math.sin(x)}`)}rect(t,n,c,g){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${c=+c}v${+g}h${-c}Z`}toString(){return this._}};function gM(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function I_(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,c=e.slice(0,n);return[c.length>1?c[0]+c.slice(2):c,+e.slice(n+1)]}function mm(e){return e=I_(Math.abs(e)),e?e[1]:NaN}function _M(e,t){return function(n,c){for(var g=n.length,x=[],S=0,a=e[0],U=0;g>0&&a>0&&(U+a+1>c&&(a=Math.max(1,c-U)),x.push(n.substring(g-=a,g+a)),!((U+=a+1)>c));)a=e[S=(S+1)%e.length];return x.reverse().join(t)}}function yM(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var vM=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function E_(e){if(!(t=vM.exec(e)))throw new Error("invalid format: "+e);var t;return new jv({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}E_.prototype=jv.prototype;function jv(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}jv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function xM(e){e:for(var t=e.length,n=1,c=-1,g;n<t;++n)switch(e[n]){case".":c=g=n;break;case"0":c===0&&(c=n),g=n;break;default:if(!+e[n])break e;c>0&&(c=0);break}return c>0?e.slice(0,c)+e.slice(g+1):e}var X3;function bM(e,t){var n=I_(e,t);if(!n)return e+"";var c=n[0],g=n[1],x=g-(X3=Math.max(-8,Math.min(8,Math.floor(g/3)))*3)+1,S=c.length;return x===S?c:x>S?c+new Array(x-S+1).join("0"):x>0?c.slice(0,x)+"."+c.slice(x):"0."+new Array(1-x).join("0")+I_(e,Math.max(0,t+x-1))[0]}function Hx(e,t){var n=I_(e,t);if(!n)return e+"";var c=n[0],g=n[1];return g<0?"0."+new Array(-g).join("0")+c:c.length>g+1?c.slice(0,g+1)+"."+c.slice(g+1):c+new Array(g-c.length+2).join("0")}const jx={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:gM,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Hx(e*100,t),r:Hx,s:bM,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Zx(e){return e}var Qx=Array.prototype.map,Wx=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function wM(e){var t=e.grouping===void 0||e.thousands===void 0?Zx:_M(Qx.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",c=e.currency===void 0?"":e.currency[1]+"",g=e.decimal===void 0?".":e.decimal+"",x=e.numerals===void 0?Zx:yM(Qx.call(e.numerals,String)),S=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"":e.minus+"",U=e.nan===void 0?"NaN":e.nan+"";function W(ae){ae=E_(ae);var ce=ae.fill,be=ae.align,Je=ae.sign,st=ae.symbol,Ye=ae.zero,it=ae.width,ct=ae.comma,Tt=ae.precision,zt=ae.trim,Rt=ae.type;Rt==="n"?(ct=!0,Rt="g"):jx[Rt]||(Tt===void 0&&(Tt=12),zt=!0,Rt="g"),(Ye||ce==="0"&&be==="=")&&(Ye=!0,ce="0",be="=");var Oe=st==="$"?n:st==="#"&&/[boxX]/.test(Rt)?"0"+Rt.toLowerCase():"",jt=st==="$"?c:/[%p]/.test(Rt)?S:"",at=jx[Rt],_t=/[defgprs%]/.test(Rt);Tt=Tt===void 0?6:/[gprs]/.test(Rt)?Math.max(1,Math.min(21,Tt)):Math.max(0,Math.min(20,Tt));function mt(xt){var bt=Oe,lt=jt,$e,pt,ut;if(Rt==="c")lt=at(xt)+lt,xt="";else{xt=+xt;var Nt=xt<0||1/xt<0;if(xt=isNaN(xt)?U:at(Math.abs(xt),Tt),zt&&(xt=xM(xt)),Nt&&+xt==0&&Je!=="+"&&(Nt=!1),bt=(Nt?Je==="("?Je:a:Je==="-"||Je==="("?"":Je)+bt,lt=(Rt==="s"?Wx[8+X3/3]:"")+lt+(Nt&&Je==="("?")":""),_t){for($e=-1,pt=xt.length;++$e<pt;)if(ut=xt.charCodeAt($e),48>ut||ut>57){lt=(ut===46?g+xt.slice($e+1):xt.slice($e))+lt,xt=xt.slice(0,$e);break}}}ct&&!Ye&&(xt=t(xt,1/0));var Bt=bt.length+xt.length+lt.length,Ot=Bt<it?new Array(it-Bt+1).join(ce):"";switch(ct&&Ye&&(xt=t(Ot+xt,Ot.length?it-lt.length:1/0),Ot=""),be){case"<":xt=bt+xt+lt+Ot;break;case"=":xt=bt+Ot+xt+lt;break;case"^":xt=Ot.slice(0,Bt=Ot.length>>1)+bt+xt+lt+Ot.slice(Bt);break;default:xt=Ot+bt+xt+lt;break}return x(xt)}return mt.toString=function(){return ae+""},mt}function he(ae,ce){var be=W((ae=E_(ae),ae.type="f",ae)),Je=Math.max(-8,Math.min(8,Math.floor(mm(ce)/3)))*3,st=Math.pow(10,-Je),Ye=Wx[8+Je/3];return function(it){return be(st*it)+Ye}}return{format:W,formatPrefix:he}}var jg,Y3,K3;SM({thousands:",",grouping:[3],currency:["$",""]});function SM(e){return jg=wM(e),Y3=jg.format,K3=jg.formatPrefix,jg}function IM(e){return Math.max(0,-mm(Math.abs(e)))}function EM(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(mm(t)/3)))*3-mm(Math.abs(e)))}function CM(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,mm(t)-mm(e))+1}function TM(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function kM(e){return function(){return e}}function MM(e){return+e}var $x=[0,1];function im(e){return e}function Xy(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:kM(isNaN(t)?NaN:.5)}function PM(e,t){var n;return e>t&&(n=e,e=t,t=n),function(c){return Math.max(e,Math.min(t,c))}}function DM(e,t,n){var c=e[0],g=e[1],x=t[0],S=t[1];return g<c?(c=Xy(g,c),x=n(S,x)):(c=Xy(c,g),x=n(x,S)),function(a){return x(c(a))}}function LM(e,t,n){var c=Math.min(e.length,t.length)-1,g=new Array(c),x=new Array(c),S=-1;for(e[c]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++S<c;)g[S]=Xy(e[S],e[S+1]),x[S]=n(t[S],t[S+1]);return function(a){var U=BT(e,a,1,c)-1;return x[U](g[U](a))}}function BM(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function zM(){var e=$x,t=$x,n=Uv,c,g,x,S=im,a,U,W;function he(){var ce=Math.min(e.length,t.length);return S!==im&&(S=PM(e[0],e[ce-1])),a=ce>2?LM:DM,U=W=null,ae}function ae(ce){return ce==null||isNaN(ce=+ce)?x:(U||(U=a(e.map(c),t,n)))(c(S(ce)))}return ae.invert=function(ce){return S(g((W||(W=a(t,e.map(c),lA)))(ce)))},ae.domain=function(ce){return arguments.length?(e=Array.from(ce,MM),he()):e.slice()},ae.range=function(ce){return arguments.length?(t=Array.from(ce),he()):t.slice()},ae.rangeRound=function(ce){return t=Array.from(ce),n=Y6,he()},ae.clamp=function(ce){return arguments.length?(S=ce?!0:im,he()):S!==im},ae.interpolate=function(ce){return arguments.length?(n=ce,he()):n},ae.unknown=function(ce){return arguments.length?(x=ce,ae):x},function(ce,be){return c=ce,g=be,he()}}function RM(){return zM()(im,im)}function FM(e,t,n,c){var g=NT(e,t,n),x;switch(c=E_(c??",f"),c.type){case"s":{var S=Math.max(Math.abs(e),Math.abs(t));return c.precision==null&&!isNaN(x=EM(g,S))&&(c.precision=x),K3(c,S)}case"":case"e":case"g":case"p":case"r":{c.precision==null&&!isNaN(x=CM(g,Math.max(Math.abs(e),Math.abs(t))))&&(c.precision=x-(c.type==="e"));break}case"f":case"%":{c.precision==null&&!isNaN(x=IM(g))&&(c.precision=x-(c.type==="%")*2);break}}return Y3(c)}function OM(e){var t=e.domain;return e.ticks=function(n){var c=t();return OT(c[0],c[c.length-1],n??10)},e.tickFormat=function(n,c){var g=t();return FM(g[0],g[g.length-1],n??10,c)},e.nice=function(n){n==null&&(n=10);var c=t(),g=0,x=c.length-1,S=c[g],a=c[x],U,W,he=10;for(a<S&&(W=S,S=a,a=W,W=g,g=x,x=W);he-- >0;){if(W=Ny(S,a,n),W===U)return c[g]=S,c[x]=a,t(c);if(W>0)S=Math.floor(S/W)*W,a=Math.ceil(a/W)*W;else if(W<0)S=Math.ceil(S*W)/W,a=Math.floor(a*W)/W;else break;U=W}return e},e}function Yy(){var e=RM();return e.copy=function(){return BM(e,Yy())},TM.apply(e,arguments),OM(e)}function Lu(e){return function(){return e}}function J3(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const c=Math.floor(n);if(!(c>=0))throw new RangeError(`invalid digits: ${n}`);t=c}return e},()=>new mM(t)}function eS(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function tS(e){this._context=e}tS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function iS(e){return new tS(e)}function nS(e){return e[0]}function rS(e){return e[1]}function Jp(e,t){var n=Lu(!0),c=null,g=iS,x=null,S=J3(a);e=typeof e=="function"?e:e===void 0?nS:Lu(e),t=typeof t=="function"?t:t===void 0?rS:Lu(t);function a(U){var W,he=(U=eS(U)).length,ae,ce=!1,be;for(c==null&&(x=g(be=S())),W=0;W<=he;++W)!(W<he&&n(ae=U[W],W,U))===ce&&((ce=!ce)?x.lineStart():x.lineEnd()),ce&&x.point(+e(ae,W,U),+t(ae,W,U));if(be)return x=null,be+""||null}return a.x=function(U){return arguments.length?(e=typeof U=="function"?U:Lu(+U),a):e},a.y=function(U){return arguments.length?(t=typeof U=="function"?U:Lu(+U),a):t},a.defined=function(U){return arguments.length?(n=typeof U=="function"?U:Lu(!!U),a):n},a.curve=function(U){return arguments.length?(g=U,c!=null&&(x=g(c)),a):g},a.context=function(U){return arguments.length?(U==null?c=x=null:x=g(c=U),a):c},a}function N1(e,t,n){var c=null,g=Lu(!0),x=null,S=iS,a=null,U=J3(W);e=typeof e=="function"?e:e===void 0?nS:Lu(+e),t=typeof t=="function"?t:Lu(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?rS:Lu(+n);function W(ae){var ce,be,Je,st=(ae=eS(ae)).length,Ye,it=!1,ct,Tt=new Array(st),zt=new Array(st);for(x==null&&(a=S(ct=U())),ce=0;ce<=st;++ce){if(!(ce<st&&g(Ye=ae[ce],ce,ae))===it)if(it=!it)be=ce,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),Je=ce-1;Je>=be;--Je)a.point(Tt[Je],zt[Je]);a.lineEnd(),a.areaEnd()}it&&(Tt[ce]=+e(Ye,ce,ae),zt[ce]=+t(Ye,ce,ae),a.point(c?+c(Ye,ce,ae):Tt[ce],n?+n(Ye,ce,ae):zt[ce]))}if(ct)return a=null,ct+""||null}function he(){return Jp().defined(g).curve(S).context(x)}return W.x=function(ae){return arguments.length?(e=typeof ae=="function"?ae:Lu(+ae),c=null,W):e},W.x0=function(ae){return arguments.length?(e=typeof ae=="function"?ae:Lu(+ae),W):e},W.x1=function(ae){return arguments.length?(c=ae==null?null:typeof ae=="function"?ae:Lu(+ae),W):c},W.y=function(ae){return arguments.length?(t=typeof ae=="function"?ae:Lu(+ae),n=null,W):t},W.y0=function(ae){return arguments.length?(t=typeof ae=="function"?ae:Lu(+ae),W):t},W.y1=function(ae){return arguments.length?(n=ae==null?null:typeof ae=="function"?ae:Lu(+ae),W):n},W.lineX0=W.lineY0=function(){return he().x(e).y(t)},W.lineY1=function(){return he().x(e).y(n)},W.lineX1=function(){return he().x(c).y(t)},W.defined=function(ae){return arguments.length?(g=typeof ae=="function"?ae:Lu(!!ae),W):g},W.curve=function(ae){return arguments.length?(S=ae,x!=null&&(a=S(x)),W):S},W.context=function(ae){return arguments.length?(ae==null?x=a=null:a=S(x=ae),W):x},W}function Xx(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function sS(e){this._context=e}sS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Xx(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Xx(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function NM(e){return new sS(e)}function og(e,t,n){this.k=e,this.x=t,this.y=n}og.prototype={constructor:og,scale:function(e){return e===1?this:new og(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new og(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};og.prototype;function Yx(e,t,n){const c=e.slice();return c[34]=t[n],c[36]=n,c}function Kx(e){let t,n,c=Sx[e[5]]+"",g,x,S,a,U,W,he,ae,ce,be,Je,st,Ye,it,ct,Tt,zt,Rt,Oe,jt,at,_t,mt,xt=yc(e[0]),bt=[];for(let lt=0;lt<xt.length;lt+=1)bt[lt]=Jx(Yx(e,xt,lt));return{c(){t=Rn("div"),n=Rn("h2"),g=ba(c),x=ba(" by tree size"),S=Sr(),a=Ra("svg"),U=Ra("defs"),W=Ra("linearGradient"),he=Ra("stop"),ae=Ra("stop"),ce=Ra("stop"),be=Ra("g"),st=Ra("g"),it=Ra("path"),Tt=Ra("g");for(let lt=0;lt<bt.length;lt+=1)bt[lt].c();zt=Ra("text"),Rt=ba(e[11]),at=Ra("text"),_t=ba(e[12]),this.h()},l(lt){t=Fn(lt,"DIV",{class:!0});var $e=_n(t);n=Fn($e,"H2",{class:!0});var pt=_n(n);g=wa(pt,c),x=wa(pt," by tree size"),pt.forEach(yi),S=Ir($e),a=Fa($e,"svg",{id:!0,viewBox:!0,class:!0});var ut=_n(a);U=Fa(ut,"defs",{});var Nt=_n(U);W=Fa(Nt,"linearGradient",{id:!0,x1:!0,x2:!0,y1:!0,y2:!0});var Bt=_n(W);he=Fa(Bt,"stop",{class:!0,offset:!0}),_n(he).forEach(yi),ae=Fa(Bt,"stop",{class:!0,offset:!0}),_n(ae).forEach(yi),ce=Fa(Bt,"stop",{class:!0,offset:!0}),_n(ce).forEach(yi),Bt.forEach(yi),Nt.forEach(yi),be=Fa(ut,"g",{class:!0,transform:!0}),_n(be).forEach(yi),st=Fa(ut,"g",{class:!0,transform:!0}),_n(st).forEach(yi),it=Fa(ut,"path",{class:!0,fill:!0,stroke:!0,"stroke-width":!0,d:!0}),_n(it).forEach(yi),Tt=Fa(ut,"g",{class:!0,fill:!0,stroke:!0,"stroke-width":!0});var Ot=_n(Tt);for(let Ci=0;Ci<bt.length;Ci+=1)bt[Ci].l(Ot);Ot.forEach(yi),zt=Fa(ut,"text",{class:!0,"text-anchor":!0,x:!0,y:!0});var gi=_n(zt);Rt=wa(gi,e[11]),gi.forEach(yi),at=Fa(ut,"text",{class:!0,"text-anchor":!0,transform:!0,x:!0,y:!0});var Ii=_n(at);_t=wa(Ii,e[12]),Ii.forEach(yi),ut.forEach(yi),$e.forEach(yi),this.h()},h(){Ti(n,"class","svelte-156wt8f"),Ti(he,"class","stop1 svelte-156wt8f"),Ti(he,"offset","0%"),Ti(ae,"class","stop2 svelte-156wt8f"),Ti(ae,"offset","50%"),Ti(ce,"class","stop3 svelte-156wt8f"),Ti(ce,"offset","100%"),Ti(W,"id","Gradient1"),Ti(W,"x1","0"),Ti(W,"x2","0"),Ti(W,"y1","0"),Ti(W,"y2","0.2"),Ti(be,"class","scale x svelte-156wt8f"),Ti(be,"transform",Je="translate(0,"+(e[2]-e[3])+")"),Ti(st,"class","scale y svelte-156wt8f"),Ti(st,"transform",Ye="translate("+e[4]+",0)"),Ti(it,"class","area ci svelte-156wt8f"),Ti(it,"fill",p_()[300]),Ti(it,"stroke","currentColor"),Ti(it,"stroke-width","0"),Ti(it,"d",ct=e[14](e[10])),Ti(Tt,"class","point"),Ti(Tt,"fill",p_[700]),Ti(Tt,"stroke","currentColor"),Ti(Tt,"stroke-width","1.5"),Ti(zt,"class","axis-label svelte-156wt8f"),Ti(zt,"text-anchor","center"),Ti(zt,"x",Oe=e[1]/2),Ti(zt,"y",jt=e[2]+12),Ti(at,"class","axis-label svelte-156wt8f"),Ti(at,"text-anchor","center"),Ti(at,"transform","rotate(-90)"),Ti(at,"x",e[13]),Ti(at,"y",-10),Ti(a,"id","viz"),Ti(a,"viewBox",mt=`0 0 ${e[1]} ${e[2]}`),Ti(a,"class","svelte-156wt8f"),Ti(t,"class","graph-container svelte-156wt8f")},m(lt,$e){Un(lt,t,$e),qi(t,n),qi(n,g),qi(n,x),qi(t,S),qi(t,a),qi(a,U),qi(U,W),qi(W,he),qi(W,ae),qi(W,ce),qi(a,be),e[21](be),qi(a,st),e[22](st),qi(a,it),qi(a,Tt);for(let pt=0;pt<bt.length;pt+=1)bt[pt]&&bt[pt].m(Tt,null);qi(a,zt),qi(zt,Rt),qi(a,at),qi(at,_t)},p(lt,$e){if($e[0]&32&&c!==(c=Sx[lt[5]]+"")&&ql(g,c),$e[0]&12&&Je!==(Je="translate(0,"+(lt[2]-lt[3])+")")&&Ti(be,"transform",Je),$e[0]&16&&Ye!==(Ye="translate("+lt[4]+",0)")&&Ti(st,"transform",Ye),$e[0]&1024&&ct!==(ct=lt[14](lt[10]))&&Ti(it,"d",ct),$e[0]&769){xt=yc(lt[0]);let pt;for(pt=0;pt<xt.length;pt+=1){const ut=Yx(lt,xt,pt);bt[pt]?bt[pt].p(ut,$e):(bt[pt]=Jx(ut),bt[pt].c(),bt[pt].m(Tt,null))}for(;pt<bt.length;pt+=1)bt[pt].d(1);bt.length=xt.length}$e[0]&2048&&ql(Rt,lt[11]),$e[0]&2&&Oe!==(Oe=lt[1]/2)&&Ti(zt,"x",Oe),$e[0]&4&&jt!==(jt=lt[2]+12)&&Ti(zt,"y",jt),$e[0]&4096&&ql(_t,lt[12]),$e[0]&8192&&Ti(at,"x",lt[13]),$e[0]&6&&mt!==(mt=`0 0 ${lt[1]} ${lt[2]}`)&&Ti(a,"viewBox",mt)},d(lt){lt&&yi(t),e[21](null),e[22](null),G0(bt,lt)}}}function Jx(e){let t,n,c;return{c(){t=Ra("circle"),this.h()},l(g){t=Fa(g,"circle",{key:!0,cx:!0,cy:!0,r:!0,fill:!0,class:!0}),_n(t).forEach(yi),this.h()},h(){Ti(t,"key",e[36]),Ti(t,"cx",n=e[8](e[34][0])),Ti(t,"cy",c=e[9](e[34][1])),Ti(t,"r","5"),Ti(t,"fill",p_[700]),Ti(t,"class","anim-point svelte-156wt8f")},m(g,x){Un(g,t,x)},p(g,x){x[0]&257&&n!==(n=g[8](g[34][0]))&&Ti(t,"cx",n),x[0]&513&&c!==(c=g[9](g[34][1]))&&Ti(t,"cy",c)},d(g){g&&yi(t)}}}function VM(e){let t,n=e[10]&&e[5]&&Kx(e);return{c(){n&&n.c(),t=xs()},l(c){n&&n.l(c),t=xs()},m(c,g){n&&n.m(c,g),Un(c,t,g)},p(c,g){c[10]&&c[5]?n?n.p(c,g):(n=Kx(c),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:Oa,o:Oa,d(c){c&&yi(t),n&&n.d(c)}}}function UM(e,t,n){let{data:c}=t,{point:g}=t,{width:x=640}=t,{height:S=400}=t,{marginTop:a=20}=t,{marginRight:U=20}=t,{marginBottom:W=30}=t,{marginLeft:he=40}=t,{metric:ae}=t,ce,be,Je=null,st=[0,10],Ye=[0,10],it="",ct="",Tt=0,zt,Rt,{colorScheme:Oe}=t,jt;function at(lt){jt=ST(lt),console.log(jt),n(10,Je=jt.confidence),n(19,st=jt.yAxis),n(20,Ye=jt.xAxis),n(11,it=jt.xAxisLabel),n(12,ct=jt.yAxisLabel),n(13,Tt=_t(ct))}function _t(lt){return console.log("label length:",lt.length),-1*(S/2)-lt.length*2.5}const mt=N1().x(lt=>zt(lt.x)).y0(lt=>Rt(Math.max(lt.low,st[0]))).y1(lt=>Rt(Math.min(lt.high,st[1])));Jp(lt=>zt(lt.x),lt=>Rt(lt.y)),Jp(lt=>zt(lt.x),lt=>Rt(lt.low)),Jp(lt=>zt(lt.x),lt=>Rt(lt.high)),N1().x(lt=>zt(lt.x)).y0(lt=>Rt(lt.high)).y1(lt=>-1*Rt(st[1])),N1().x(lt=>zt(lt.x)).y0(lt=>Rt(st[0])).y1(lt=>Rt(lt.low)),Jp(lt=>zt(lt.x),lt=>Rt(lt.y)).curve(NM);function xt(lt){ua[lt?"unshift":"push"](()=>{ce=lt,n(6,ce)})}function bt(lt){ua[lt?"unshift":"push"](()=>{be=lt,n(7,be)})}return e.$$set=lt=>{"data"in lt&&n(15,c=lt.data),"point"in lt&&n(0,g=lt.point),"width"in lt&&n(1,x=lt.width),"height"in lt&&n(2,S=lt.height),"marginTop"in lt&&n(16,a=lt.marginTop),"marginRight"in lt&&n(17,U=lt.marginRight),"marginBottom"in lt&&n(3,W=lt.marginBottom),"marginLeft"in lt&&n(4,he=lt.marginLeft),"metric"in lt&&n(5,ae=lt.metric),"colorScheme"in lt&&n(18,Oe=lt.colorScheme)},e.$$.update=()=>{e.$$.dirty[0]&262144&&cT(Oe),e.$$.dirty[0]&32&&(jt=at(ae)),e.$$.dirty[0]&1179666&&n(8,zt=Yy(Cx(Ye),[he,x-U])),e.$$.dirty[0]&589836&&n(9,Rt=Yy(Cx(st),[S-W,a])),e.$$.dirty[0]&768&&Jp((lt,$e)=>zt($e),Rt),e.$$.dirty[0]&640&&R1(be).call(QT(Rt)),e.$$.dirty[0]&320&&R1(ce).call(ZT(zt)),e.$$.dirty[0]&6&&R1("svg").append("div").classed("svg-container",!0).append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox",`0 0 ${x} ${S}`).classed("svg-content-responsive",!0),e.$$.dirty[0]&33&&console.log("relative:",IT(ae,g[0][1],g[0][0]))},[g,x,S,W,he,ae,ce,be,zt,Rt,Je,it,ct,Tt,mt,c,a,U,Oe,st,Ye,xt,bt]}class GM extends fo{constructor(t){super(),po(this,t,UM,VM,Va,{data:15,point:0,width:1,height:2,marginTop:16,marginRight:17,marginBottom:3,marginLeft:4,metric:5,colorScheme:18},null,[-1,-1])}}function aS(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function oS(e){let t=e,n=e;e.length===1&&(t=(S,a)=>e(S)-a,n=qM(e));function c(S,a,U,W){for(U==null&&(U=0),W==null&&(W=S.length);U<W;){const he=U+W>>>1;n(S[he],a)<0?U=he+1:W=he}return U}function g(S,a,U,W){for(U==null&&(U=0),W==null&&(W=S.length);U<W;){const he=U+W>>>1;n(S[he],a)>0?W=he:U=he+1}return U}function x(S,a,U,W){U==null&&(U=0),W==null&&(W=S.length);const he=c(S,a,U,W-1);return he>U&&t(S[he-1],a)>-t(S[he],a)?he-1:he}return{left:c,center:x,right:g}}function qM(e){return(t,n)=>aS(e(t),n)}function HM(e){return e===null?NaN:+e}const jM=oS(aS),ZM=jM.right;oS(HM).center;var Ky=Math.sqrt(50),Jy=Math.sqrt(10),ev=Math.sqrt(2);function QM(e,t,n){var c,g=-1,x,S,a;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((c=t<e)&&(x=e,e=t,t=x),(a=lS(e,t,n))===0||!isFinite(a))return[];if(a>0){let U=Math.round(e/a),W=Math.round(t/a);for(U*a<e&&++U,W*a>t&&--W,S=new Array(x=W-U+1);++g<x;)S[g]=(U+g)*a}else{a=-a;let U=Math.round(e*a),W=Math.round(t*a);for(U/a<e&&++U,W/a>t&&--W,S=new Array(x=W-U+1);++g<x;)S[g]=(U+g)/a}return c&&S.reverse(),S}function lS(e,t,n){var c=(t-e)/Math.max(0,n),g=Math.floor(Math.log(c)/Math.LN10),x=c/Math.pow(10,g);return g>=0?(x>=Ky?10:x>=Jy?5:x>=ev?2:1)*Math.pow(10,g):-Math.pow(10,-g)/(x>=Ky?10:x>=Jy?5:x>=ev?2:1)}function WM(e,t,n){var c=Math.abs(t-e)/Math.max(0,n),g=Math.pow(10,Math.floor(Math.log(c)/Math.LN10)),x=c/g;return x>=Ky?g*=10:x>=Jy?g*=5:x>=ev&&(g*=2),t<e?-g:g}function $M(e,t){let n;if(t===void 0)for(const c of e)c!=null&&(n<c||n===void 0&&c>=c)&&(n=c);else{let c=-1;for(let g of e)(g=t(g,++c,e))!=null&&(n<g||n===void 0&&g>=g)&&(n=g)}return n}var V1=Array.prototype.slice;function XM(e){return e}var n_=1,U1=2,eb=3,Zg=4,tb=1e-6;function YM(e){return"translate("+e+",0)"}function KM(e){return"translate(0,"+e+")"}function JM(e){return t=>+e(t)}function eP(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function tP(){return!this.__axis}function iP(e,t){var n=[],c=null,g=null,x=6,S=6,a=3,U=typeof window<"u"&&window.devicePixelRatio>1?0:.5,W=e===n_||e===Zg?-1:1,he=e===Zg||e===U1?"x":"y",ae=e===n_||e===eb?YM:KM;function ce(be){var Je=c??(t.ticks?t.ticks.apply(t,n):t.domain()),st=g??(t.tickFormat?t.tickFormat.apply(t,n):XM),Ye=Math.max(x,0)+a,it=t.range(),ct=+it[0]+U,Tt=+it[it.length-1]+U,zt=(t.bandwidth?eP:JM)(t.copy(),U),Rt=be.selection?be.selection():be,Oe=Rt.selectAll(".domain").data([null]),jt=Rt.selectAll(".tick").data(Je,t).order(),at=jt.exit(),_t=jt.enter().append("g").attr("class","tick"),mt=jt.select("line"),xt=jt.select("text");Oe=Oe.merge(Oe.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),jt=jt.merge(_t),mt=mt.merge(_t.append("line").attr("stroke","currentColor").attr(he+"2",W*x)),xt=xt.merge(_t.append("text").attr("fill","currentColor").attr(he,W*Ye).attr("dy",e===n_?"0em":e===eb?"0.71em":"0.32em")),be!==Rt&&(Oe=Oe.transition(be),jt=jt.transition(be),mt=mt.transition(be),xt=xt.transition(be),at=at.transition(be).attr("opacity",tb).attr("transform",function(bt){return isFinite(bt=zt(bt))?ae(bt+U):this.getAttribute("transform")}),_t.attr("opacity",tb).attr("transform",function(bt){var lt=this.parentNode.__axis;return ae((lt&&isFinite(lt=lt(bt))?lt:zt(bt))+U)})),at.remove(),Oe.attr("d",e===Zg||e===U1?S?"M"+W*S+","+ct+"H"+U+"V"+Tt+"H"+W*S:"M"+U+","+ct+"V"+Tt:S?"M"+ct+","+W*S+"V"+U+"H"+Tt+"V"+W*S:"M"+ct+","+U+"H"+Tt),jt.attr("opacity",1).attr("transform",function(bt){return ae(zt(bt)+U)}),mt.attr(he+"2",W*x),xt.attr(he,W*Ye).text(st),Rt.filter(tP).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===U1?"start":e===Zg?"end":"middle"),Rt.each(function(){this.__axis=zt})}return ce.scale=function(be){return arguments.length?(t=be,ce):t},ce.ticks=function(){return n=V1.call(arguments),ce},ce.tickArguments=function(be){return arguments.length?(n=be==null?[]:V1.call(be),ce):n.slice()},ce.tickValues=function(be){return arguments.length?(c=be==null?null:V1.call(be),ce):c&&c.slice()},ce.tickFormat=function(be){return arguments.length?(g=be,ce):g},ce.tickSize=function(be){return arguments.length?(x=S=+be,ce):x},ce.tickSizeInner=function(be){return arguments.length?(x=+be,ce):x},ce.tickSizeOuter=function(be){return arguments.length?(S=+be,ce):S},ce.tickPadding=function(be){return arguments.length?(a=+be,ce):a},ce.offset=function(be){return arguments.length?(U=+be,ce):U},ce}function nP(e){return iP(n_,e)}var rP={value:()=>{}};function J_(){for(var e=0,t=arguments.length,n={},c;e<t;++e){if(!(c=arguments[e]+"")||c in n||/[\s.]/.test(c))throw new Error("illegal type: "+c);n[c]=[]}return new r_(n)}function r_(e){this._=e}function sP(e,t){return e.trim().split(/^|\s+/).map(function(n){var c="",g=n.indexOf(".");if(g>=0&&(c=n.slice(g+1),n=n.slice(0,g)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:c}})}r_.prototype=J_.prototype={constructor:r_,on:function(e,t){var n=this._,c=sP(e+"",n),g,x=-1,S=c.length;if(arguments.length<2){for(;++x<S;)if((g=(e=c[x]).type)&&(g=aP(n[g],e.name)))return g;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++x<S;)if(g=(e=c[x]).type)n[g]=ib(n[g],e.name,t);else if(t==null)for(g in n)n[g]=ib(n[g],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new r_(e)},call:function(e,t){if((g=arguments.length-2)>0)for(var n=new Array(g),c=0,g,x;c<g;++c)n[c]=arguments[c+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(x=this._[e],c=0,g=x.length;c<g;++c)x[c].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var c=this._[e],g=0,x=c.length;g<x;++g)c[g].value.apply(t,n)}};function aP(e,t){for(var n=0,c=e.length,g;n<c;++n)if((g=e[n]).name===t)return g.value}function ib(e,t,n){for(var c=0,g=e.length;c<g;++c)if(e[c].name===t){e[c]=rP,e=e.slice(0,c).concat(e.slice(c+1));break}return n!=null&&e.push({name:t,value:n}),e}var tv="http://www.w3.org/1999/xhtml";const nb={svg:"http://www.w3.org/2000/svg",xhtml:tv,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function e1(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),nb.hasOwnProperty(t)?{space:nb[t],local:e}:e}function oP(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===tv&&t.documentElement.namespaceURI===tv?t.createElement(e):t.createElementNS(n,e)}}function lP(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Zv(e){var t=e1(e);return(t.local?lP:oP)(t)}function uP(){}function Qv(e){return e==null?uP:function(){return this.querySelector(e)}}function cP(e){typeof e!="function"&&(e=Qv(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var x=t[g],S=x.length,a=c[g]=new Array(S),U,W,he=0;he<S;++he)(U=x[he])&&(W=e.call(U,U.__data__,he,x))&&("__data__"in U&&(W.__data__=U.__data__),a[he]=W);return new Hc(c,this._parents)}function uS(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function hP(){return[]}function cS(e){return e==null?hP:function(){return this.querySelectorAll(e)}}function AP(e){return function(){var t=e.apply(this,arguments);return t==null?[]:uS(t)}}function fP(e){typeof e=="function"?e=AP(e):e=cS(e);for(var t=this._groups,n=t.length,c=[],g=[],x=0;x<n;++x)for(var S=t[x],a=S.length,U,W=0;W<a;++W)(U=S[W])&&(c.push(e.call(U,U.__data__,W,S)),g.push(U));return new Hc(c,g)}function hS(e){return function(){return this.matches(e)}}function AS(e){return function(t){return t.matches(e)}}var dP=Array.prototype.find;function pP(e){return function(){return dP.call(this.children,e)}}function mP(){return this.firstElementChild}function gP(e){return this.select(e==null?mP:pP(typeof e=="function"?e:AS(e)))}var _P=Array.prototype.filter;function yP(){return this.children}function vP(e){return function(){return _P.call(this.children,e)}}function xP(e){return this.selectAll(e==null?yP:vP(typeof e=="function"?e:AS(e)))}function bP(e){typeof e!="function"&&(e=hS(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var x=t[g],S=x.length,a=c[g]=[],U,W=0;W<S;++W)(U=x[W])&&e.call(U,U.__data__,W,x)&&a.push(U);return new Hc(c,this._parents)}function fS(e){return new Array(e.length)}function wP(){return new Hc(this._enter||this._groups.map(fS),this._parents)}function C_(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}C_.prototype={constructor:C_,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function SP(e){return function(){return e}}function IP(e,t,n,c,g,x){for(var S=0,a,U=t.length,W=x.length;S<W;++S)(a=t[S])?(a.__data__=x[S],c[S]=a):n[S]=new C_(e,x[S]);for(;S<U;++S)(a=t[S])&&(g[S]=a)}function EP(e,t,n,c,g,x,S){var a,U,W=new Map,he=t.length,ae=x.length,ce=new Array(he),be;for(a=0;a<he;++a)(U=t[a])&&(ce[a]=be=S.call(U,U.__data__,a,t)+"",W.has(be)?g[a]=U:W.set(be,U));for(a=0;a<ae;++a)be=S.call(e,x[a],a,x)+"",(U=W.get(be))?(c[a]=U,U.__data__=x[a],W.delete(be)):n[a]=new C_(e,x[a]);for(a=0;a<he;++a)(U=t[a])&&W.get(ce[a])===U&&(g[a]=U)}function CP(e){return e.__data__}function TP(e,t){if(!arguments.length)return Array.from(this,CP);var n=t?EP:IP,c=this._parents,g=this._groups;typeof e!="function"&&(e=SP(e));for(var x=g.length,S=new Array(x),a=new Array(x),U=new Array(x),W=0;W<x;++W){var he=c[W],ae=g[W],ce=ae.length,be=uS(e.call(he,he&&he.__data__,W,c)),Je=be.length,st=a[W]=new Array(Je),Ye=S[W]=new Array(Je),it=U[W]=new Array(ce);n(he,ae,st,Ye,it,be,t);for(var ct=0,Tt=0,zt,Rt;ct<Je;++ct)if(zt=st[ct]){for(ct>=Tt&&(Tt=ct+1);!(Rt=Ye[Tt])&&++Tt<Je;);zt._next=Rt||null}}return S=new Hc(S,c),S._enter=a,S._exit=U,S}function kP(){return new Hc(this._exit||this._groups.map(fS),this._parents)}function MP(e,t,n){var c=this.enter(),g=this,x=this.exit();return c=typeof e=="function"?e(c):c.append(e+""),t!=null&&(g=t(g)),n==null?x.remove():n(x),c&&g?c.merge(g).order():g}function PP(e){if(!(e instanceof Hc))throw new Error("invalid merge");for(var t=this._groups,n=e._groups,c=t.length,g=n.length,x=Math.min(c,g),S=new Array(c),a=0;a<x;++a)for(var U=t[a],W=n[a],he=U.length,ae=S[a]=new Array(he),ce,be=0;be<he;++be)(ce=U[be]||W[be])&&(ae[be]=ce);for(;a<c;++a)S[a]=t[a];return new Hc(S,this._parents)}function DP(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var c=e[t],g=c.length-1,x=c[g],S;--g>=0;)(S=c[g])&&(x&&S.compareDocumentPosition(x)^4&&x.parentNode.insertBefore(S,x),x=S);return this}function LP(e){e||(e=BP);function t(ae,ce){return ae&&ce?e(ae.__data__,ce.__data__):!ae-!ce}for(var n=this._groups,c=n.length,g=new Array(c),x=0;x<c;++x){for(var S=n[x],a=S.length,U=g[x]=new Array(a),W,he=0;he<a;++he)(W=S[he])&&(U[he]=W);U.sort(t)}return new Hc(g,this._parents).order()}function BP(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function zP(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function RP(){return Array.from(this)}function FP(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var c=e[t],g=0,x=c.length;g<x;++g){var S=c[g];if(S)return S}return null}function OP(){let e=0;for(const t of this)++e;return e}function NP(){return!this.node()}function VP(e){for(var t=this._groups,n=0,c=t.length;n<c;++n)for(var g=t[n],x=0,S=g.length,a;x<S;++x)(a=g[x])&&e.call(a,a.__data__,x,g);return this}function UP(e){return function(){this.removeAttribute(e)}}function GP(e){return function(){this.removeAttributeNS(e.space,e.local)}}function qP(e,t){return function(){this.setAttribute(e,t)}}function HP(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function jP(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function ZP(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function QP(e,t){var n=e1(e);if(arguments.length<2){var c=this.node();return n.local?c.getAttributeNS(n.space,n.local):c.getAttribute(n)}return this.each((t==null?n.local?GP:UP:typeof t=="function"?n.local?ZP:jP:n.local?HP:qP)(n,t))}function dS(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function WP(e){return function(){this.style.removeProperty(e)}}function $P(e,t,n){return function(){this.style.setProperty(e,t,n)}}function XP(e,t,n){return function(){var c=t.apply(this,arguments);c==null?this.style.removeProperty(e):this.style.setProperty(e,c,n)}}function YP(e,t,n){return arguments.length>1?this.each((t==null?WP:typeof t=="function"?XP:$P)(e,t,n??"")):gm(this.node(),e)}function gm(e,t){return e.style.getPropertyValue(t)||dS(e).getComputedStyle(e,null).getPropertyValue(t)}function KP(e){return function(){delete this[e]}}function JP(e,t){return function(){this[e]=t}}function eD(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function tD(e,t){return arguments.length>1?this.each((t==null?KP:typeof t=="function"?eD:JP)(e,t)):this.node()[e]}function pS(e){return e.trim().split(/^|\s+/)}function Wv(e){return e.classList||new mS(e)}function mS(e){this._node=e,this._names=pS(e.getAttribute("class")||"")}mS.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function gS(e,t){for(var n=Wv(e),c=-1,g=t.length;++c<g;)n.add(t[c])}function _S(e,t){for(var n=Wv(e),c=-1,g=t.length;++c<g;)n.remove(t[c])}function iD(e){return function(){gS(this,e)}}function nD(e){return function(){_S(this,e)}}function rD(e,t){return function(){(t.apply(this,arguments)?gS:_S)(this,e)}}function sD(e,t){var n=pS(e+"");if(arguments.length<2){for(var c=Wv(this.node()),g=-1,x=n.length;++g<x;)if(!c.contains(n[g]))return!1;return!0}return this.each((typeof t=="function"?rD:t?iD:nD)(n,t))}function aD(){this.textContent=""}function oD(e){return function(){this.textContent=e}}function lD(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function uD(e){return arguments.length?this.each(e==null?aD:(typeof e=="function"?lD:oD)(e)):this.node().textContent}function cD(){this.innerHTML=""}function hD(e){return function(){this.innerHTML=e}}function AD(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function fD(e){return arguments.length?this.each(e==null?cD:(typeof e=="function"?AD:hD)(e)):this.node().innerHTML}function dD(){this.nextSibling&&this.parentNode.appendChild(this)}function pD(){return this.each(dD)}function mD(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function gD(){return this.each(mD)}function _D(e){var t=typeof e=="function"?e:Zv(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function yD(){return null}function vD(e,t){var n=typeof e=="function"?e:Zv(e),c=t==null?yD:typeof t=="function"?t:Qv(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),c.apply(this,arguments)||null)})}function xD(){var e=this.parentNode;e&&e.removeChild(this)}function bD(){return this.each(xD)}function wD(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function SD(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ID(e){return this.select(e?SD:wD)}function ED(e){return arguments.length?this.property("__data__",e):this.node().__data__}function CD(e){return function(t){e.call(this,t,this.__data__)}}function TD(e){return e.trim().split(/^|\s+/).map(function(t){var n="",c=t.indexOf(".");return c>=0&&(n=t.slice(c+1),t=t.slice(0,c)),{type:t,name:n}})}function kD(e){return function(){var t=this.__on;if(t){for(var n=0,c=-1,g=t.length,x;n<g;++n)x=t[n],(!e.type||x.type===e.type)&&x.name===e.name?this.removeEventListener(x.type,x.listener,x.options):t[++c]=x;++c?t.length=c:delete this.__on}}}function MD(e,t,n){return function(){var c=this.__on,g,x=CD(t);if(c){for(var S=0,a=c.length;S<a;++S)if((g=c[S]).type===e.type&&g.name===e.name){this.removeEventListener(g.type,g.listener,g.options),this.addEventListener(g.type,g.listener=x,g.options=n),g.value=t;return}}this.addEventListener(e.type,x,n),g={type:e.type,name:e.name,value:t,listener:x,options:n},c?c.push(g):this.__on=[g]}}function PD(e,t,n){var c=TD(e+""),g,x=c.length,S;if(arguments.length<2){var a=this.node().__on;if(a){for(var U=0,W=a.length,he;U<W;++U)for(g=0,he=a[U];g<x;++g)if((S=c[g]).type===he.type&&S.name===he.name)return he.value}return}for(a=t?MD:kD,g=0;g<x;++g)this.each(a(c[g],t,n));return this}function yS(e,t,n){var c=dS(e),g=c.CustomEvent;typeof g=="function"?g=new g(t,n):(g=c.document.createEvent("Event"),n?(g.initEvent(t,n.bubbles,n.cancelable),g.detail=n.detail):g.initEvent(t,!1,!1)),e.dispatchEvent(g)}function DD(e,t){return function(){return yS(this,e,t)}}function LD(e,t){return function(){return yS(this,e,t.apply(this,arguments))}}function BD(e,t){return this.each((typeof t=="function"?LD:DD)(e,t))}function*zD(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var c=e[t],g=0,x=c.length,S;g<x;++g)(S=c[g])&&(yield S)}var vS=[null];function Hc(e,t){this._groups=e,this._parents=t}function Mg(){return new Hc([[document.documentElement]],vS)}function RD(){return this}Hc.prototype=Mg.prototype={constructor:Hc,select:cP,selectAll:fP,selectChild:gP,selectChildren:xP,filter:bP,data:TP,enter:wP,exit:kP,join:MP,merge:PP,selection:RD,order:DP,sort:LP,call:zP,nodes:RP,node:FP,size:OP,empty:NP,each:VP,attr:QP,style:YP,property:tD,classed:sD,text:uD,html:fD,raise:pD,lower:gD,append:_D,insert:vD,remove:bD,clone:ID,datum:ED,on:PD,dispatch:BD,[Symbol.iterator]:zD};function dl(e){return typeof e=="string"?new Hc([[document.querySelector(e)]],[document.documentElement]):new Hc([[e]],vS)}function FD(e){return dl(Zv(e).call(document.documentElement))}function OD(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Yf(e,t){if(e=OD(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var c=n.createSVGPoint();return c.x=e.clientX,c.y=e.clientY,c=c.matrixTransform(t.getScreenCTM().inverse()),[c.x,c.y]}if(t.getBoundingClientRect){var g=t.getBoundingClientRect();return[e.clientX-g.left-t.clientLeft,e.clientY-g.top-t.clientTop]}}return[e.pageX,e.pageY]}function iv(e){e.preventDefault(),e.stopImmediatePropagation()}function xS(e){var t=e.document.documentElement,n=dl(e).on("dragstart.drag",iv,!0);"onselectstart"in t?n.on("selectstart.drag",iv,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function bS(e,t){var n=e.document.documentElement,c=dl(e).on("dragstart.drag",null);t&&(c.on("click.drag",iv,!0),setTimeout(function(){c.on("click.drag",null)},0)),"onselectstart"in n?c.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function $v(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function wS(e,t){var n=Object.create(e.prototype);for(var c in t)n[c]=t[c];return n}function Pg(){}var gg=.7,T_=1/gg,Am="\\s*([+-]?\\d+)\\s*",_g="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",KA="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ND=/^#([0-9a-f]{3,8})$/,VD=new RegExp("^rgb\\("+[Am,Am,Am]+"\\)$"),UD=new RegExp("^rgb\\("+[KA,KA,KA]+"\\)$"),GD=new RegExp("^rgba\\("+[Am,Am,Am,_g]+"\\)$"),qD=new RegExp("^rgba\\("+[KA,KA,KA,_g]+"\\)$"),HD=new RegExp("^hsl\\("+[_g,KA,KA]+"\\)$"),jD=new RegExp("^hsla\\("+[_g,KA,KA,_g]+"\\)$"),rb={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};$v(Pg,rp,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:sb,formatHex:sb,formatHsl:ZD,formatRgb:ab,toString:ab});function sb(){return this.rgb().formatHex()}function ZD(){return SS(this).formatHsl()}function ab(){return this.rgb().formatRgb()}function rp(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=ND.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?ob(t):n===3?new dh(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Qg(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Qg(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=VD.exec(e))?new dh(t[1],t[2],t[3],1):(t=UD.exec(e))?new dh(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=GD.exec(e))?Qg(t[1],t[2],t[3],t[4]):(t=qD.exec(e))?Qg(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=HD.exec(e))?cb(t[1],t[2]/100,t[3]/100,1):(t=jD.exec(e))?cb(t[1],t[2]/100,t[3]/100,t[4]):rb.hasOwnProperty(e)?ob(rb[e]):e==="transparent"?new dh(NaN,NaN,NaN,0):null}function ob(e){return new dh(e>>16&255,e>>8&255,e&255,1)}function Qg(e,t,n,c){return c<=0&&(e=t=n=NaN),new dh(e,t,n,c)}function QD(e){return e instanceof Pg||(e=rp(e)),e?(e=e.rgb(),new dh(e.r,e.g,e.b,e.opacity)):new dh}function nv(e,t,n,c){return arguments.length===1?QD(e):new dh(e,t,n,c??1)}function dh(e,t,n,c){this.r=+e,this.g=+t,this.b=+n,this.opacity=+c}$v(dh,nv,wS(Pg,{brighter:function(e){return e=e==null?T_:Math.pow(T_,e),new dh(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?gg:Math.pow(gg,e),new dh(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:lb,formatHex:lb,formatRgb:ub,toString:ub}));function lb(){return"#"+G1(this.r)+G1(this.g)+G1(this.b)}function ub(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function G1(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function cb(e,t,n,c){return c<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new $A(e,t,n,c)}function SS(e){if(e instanceof $A)return new $A(e.h,e.s,e.l,e.opacity);if(e instanceof Pg||(e=rp(e)),!e)return new $A;if(e instanceof $A)return e;e=e.rgb();var t=e.r/255,n=e.g/255,c=e.b/255,g=Math.min(t,n,c),x=Math.max(t,n,c),S=NaN,a=x-g,U=(x+g)/2;return a?(t===x?S=(n-c)/a+(n<c)*6:n===x?S=(c-t)/a+2:S=(t-n)/a+4,a/=U<.5?x+g:2-x-g,S*=60):a=U>0&&U<1?0:S,new $A(S,a,U,e.opacity)}function WD(e,t,n,c){return arguments.length===1?SS(e):new $A(e,t,n,c??1)}function $A(e,t,n,c){this.h=+e,this.s=+t,this.l=+n,this.opacity=+c}$v($A,WD,wS(Pg,{brighter:function(e){return e=e==null?T_:Math.pow(T_,e),new $A(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?gg:Math.pow(gg,e),new $A(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,c=n+(n<.5?n:1-n)*t,g=2*n-c;return new dh(q1(e>=240?e-240:e+120,g,c),q1(e,g,c),q1(e<120?e+240:e-120,g,c),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function q1(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Xv=e=>()=>e;function $D(e,t){return function(n){return e+n*t}}function XD(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(c){return Math.pow(e+c*t,n)}}function YD(e){return(e=+e)==1?IS:function(t,n){return n-t?XD(t,n,e):Xv(isNaN(t)?n:t)}}function IS(e,t){var n=t-e;return n?$D(e,n):Xv(isNaN(e)?t:e)}const k_=function e(t){var n=YD(t);function c(g,x){var S=n((g=nv(g)).r,(x=nv(x)).r),a=n(g.g,x.g),U=n(g.b,x.b),W=IS(g.opacity,x.opacity);return function(he){return g.r=S(he),g.g=a(he),g.b=U(he),g.opacity=W(he),g+""}}return c.gamma=e,c}(1);function KD(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,c=t.slice(),g;return function(x){for(g=0;g<n;++g)c[g]=e[g]*(1-x)+t[g]*x;return c}}function JD(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function eL(e,t){var n=t?t.length:0,c=e?Math.min(n,e.length):0,g=new Array(c),x=new Array(n),S;for(S=0;S<c;++S)g[S]=t1(e[S],t[S]);for(;S<n;++S)x[S]=t[S];return function(a){for(S=0;S<c;++S)x[S]=g[S](a);return x}}function tL(e,t){var n=new Date;return e=+e,t=+t,function(c){return n.setTime(e*(1-c)+t*c),n}}function uA(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function iL(e,t){var n={},c={},g;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(g in t)g in e?n[g]=t1(e[g],t[g]):c[g]=t[g];return function(x){for(g in n)c[g]=n[g](x);return c}}var rv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,H1=new RegExp(rv.source,"g");function nL(e){return function(){return e}}function rL(e){return function(t){return e(t)+""}}function ES(e,t){var n=rv.lastIndex=H1.lastIndex=0,c,g,x,S=-1,a=[],U=[];for(e=e+"",t=t+"";(c=rv.exec(e))&&(g=H1.exec(t));)(x=g.index)>n&&(x=t.slice(n,x),a[S]?a[S]+=x:a[++S]=x),(c=c[0])===(g=g[0])?a[S]?a[S]+=g:a[++S]=g:(a[++S]=null,U.push({i:S,x:uA(c,g)})),n=H1.lastIndex;return n<t.length&&(x=t.slice(n),a[S]?a[S]+=x:a[++S]=x),a.length<2?U[0]?rL(U[0].x):nL(t):(t=U.length,function(W){for(var he=0,ae;he<t;++he)a[(ae=U[he]).i]=ae.x(W);return a.join("")})}function t1(e,t){var n=typeof t,c;return t==null||n==="boolean"?Xv(t):(n==="number"?uA:n==="string"?(c=rp(t))?(t=c,k_):ES:t instanceof rp?k_:t instanceof Date?tL:JD(t)?KD:Array.isArray(t)?eL:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?iL:uA)(e,t)}function sL(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var hb=180/Math.PI,sv={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function CS(e,t,n,c,g,x){var S,a,U;return(S=Math.sqrt(e*e+t*t))&&(e/=S,t/=S),(U=e*n+t*c)&&(n-=e*U,c-=t*U),(a=Math.sqrt(n*n+c*c))&&(n/=a,c/=a,U/=a),e*c<t*n&&(e=-e,t=-t,U=-U,S=-S),{translateX:g,translateY:x,rotate:Math.atan2(t,e)*hb,skewX:Math.atan(U)*hb,scaleX:S,scaleY:a}}var Wg;function aL(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?sv:CS(t.a,t.b,t.c,t.d,t.e,t.f)}function oL(e){return e==null||(Wg||(Wg=document.createElementNS("http://www.w3.org/2000/svg","g")),Wg.setAttribute("transform",e),!(e=Wg.transform.baseVal.consolidate()))?sv:(e=e.matrix,CS(e.a,e.b,e.c,e.d,e.e,e.f))}function TS(e,t,n,c){function g(W){return W.length?W.pop()+" ":""}function x(W,he,ae,ce,be,Je){if(W!==ae||he!==ce){var st=be.push("translate(",null,t,null,n);Je.push({i:st-4,x:uA(W,ae)},{i:st-2,x:uA(he,ce)})}else(ae||ce)&&be.push("translate("+ae+t+ce+n)}function S(W,he,ae,ce){W!==he?(W-he>180?he+=360:he-W>180&&(W+=360),ce.push({i:ae.push(g(ae)+"rotate(",null,c)-2,x:uA(W,he)})):he&&ae.push(g(ae)+"rotate("+he+c)}function a(W,he,ae,ce){W!==he?ce.push({i:ae.push(g(ae)+"skewX(",null,c)-2,x:uA(W,he)}):he&&ae.push(g(ae)+"skewX("+he+c)}function U(W,he,ae,ce,be,Je){if(W!==ae||he!==ce){var st=be.push(g(be)+"scale(",null,",",null,")");Je.push({i:st-4,x:uA(W,ae)},{i:st-2,x:uA(he,ce)})}else(ae!==1||ce!==1)&&be.push(g(be)+"scale("+ae+","+ce+")")}return function(W,he){var ae=[],ce=[];return W=e(W),he=e(he),x(W.translateX,W.translateY,he.translateX,he.translateY,ae,ce),S(W.rotate,he.rotate,ae,ce),a(W.skewX,he.skewX,ae,ce),U(W.scaleX,W.scaleY,he.scaleX,he.scaleY,ae,ce),W=he=null,function(be){for(var Je=-1,st=ce.length,Ye;++Je<st;)ae[(Ye=ce[Je]).i]=Ye.x(be);return ae.join("")}}}var lL=TS(aL,"px, ","px)","deg)"),uL=TS(oL,", ",")",")"),cL=1e-12;function Ab(e){return((e=Math.exp(e))+1/e)/2}function hL(e){return((e=Math.exp(e))-1/e)/2}function AL(e){return((e=Math.exp(2*e))-1)/(e+1)}const fL=function e(t,n,c){function g(x,S){var a=x[0],U=x[1],W=x[2],he=S[0],ae=S[1],ce=S[2],be=he-a,Je=ae-U,st=be*be+Je*Je,Ye,it;if(st<cL)it=Math.log(ce/W)/t,Ye=function(jt){return[a+jt*be,U+jt*Je,W*Math.exp(t*jt*it)]};else{var ct=Math.sqrt(st),Tt=(ce*ce-W*W+c*st)/(2*W*n*ct),zt=(ce*ce-W*W-c*st)/(2*ce*n*ct),Rt=Math.log(Math.sqrt(Tt*Tt+1)-Tt),Oe=Math.log(Math.sqrt(zt*zt+1)-zt);it=(Oe-Rt)/t,Ye=function(jt){var at=jt*it,_t=Ab(Rt),mt=W/(n*ct)*(_t*AL(t*at+Rt)-hL(Rt));return[a+mt*be,U+mt*Je,W*_t/Ab(t*at+Rt)]}}return Ye.duration=it*1e3*t/Math.SQRT2,Ye}return g.rho=function(x){var S=Math.max(.001,+x),a=S*S,U=a*a;return e(S,a,U)},g}(Math.SQRT2,2,4);var _m=0,lg=0,Wm=0,kS=1e3,M_,ug,P_=0,sp=0,i1=0,yg=typeof performance=="object"&&performance.now?performance:Date,MS=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Yv(){return sp||(MS(dL),sp=yg.now()+i1)}function dL(){sp=0}function D_(){this._call=this._time=this._next=null}D_.prototype=PS.prototype={constructor:D_,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Yv():+n)+(t==null?0:+t),!this._next&&ug!==this&&(ug?ug._next=this:M_=this,ug=this),this._call=e,this._time=n,av()},stop:function(){this._call&&(this._call=null,this._time=1/0,av())}};function PS(e,t,n){var c=new D_;return c.restart(e,t,n),c}function pL(){Yv(),++_m;for(var e=M_,t;e;)(t=sp-e._time)>=0&&e._call.call(null,t),e=e._next;--_m}function fb(){sp=(P_=yg.now())+i1,_m=lg=0;try{pL()}finally{_m=0,gL(),sp=0}}function mL(){var e=yg.now(),t=e-P_;t>kS&&(i1-=t,P_=e)}function gL(){for(var e,t=M_,n,c=1/0;t;)t._call?(c>t._time&&(c=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:M_=n);ug=e,av(c)}function av(e){if(!_m){lg&&(lg=clearTimeout(lg));var t=e-sp;t>24?(e<1/0&&(lg=setTimeout(fb,e-yg.now()-i1)),Wm&&(Wm=clearInterval(Wm))):(Wm||(P_=yg.now(),Wm=setInterval(mL,kS)),_m=1,MS(fb))}}function db(e,t,n){var c=new D_;return t=t==null?0:+t,c.restart(g=>{c.stop(),e(g+t)},t,n),c}var _L=J_("start","end","cancel","interrupt"),yL=[],DS=0,pb=1,ov=2,s_=3,mb=4,lv=5,a_=6;function n1(e,t,n,c,g,x){var S=e.__transition;if(!S)e.__transition={};else if(n in S)return;vL(e,n,{name:t,index:c,group:g,on:_L,tween:yL,time:x.time,delay:x.delay,duration:x.duration,ease:x.ease,timer:null,state:DS})}function Kv(e,t){var n=AA(e,t);if(n.state>DS)throw new Error("too late; already scheduled");return n}function sf(e,t){var n=AA(e,t);if(n.state>s_)throw new Error("too late; already running");return n}function AA(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function vL(e,t,n){var c=e.__transition,g;c[t]=n,n.timer=PS(x,0,n.time);function x(W){n.state=pb,n.timer.restart(S,n.delay,n.time),n.delay<=W&&S(W-n.delay)}function S(W){var he,ae,ce,be;if(n.state!==pb)return U();for(he in c)if(be=c[he],be.name===n.name){if(be.state===s_)return db(S);be.state===mb?(be.state=a_,be.timer.stop(),be.on.call("interrupt",e,e.__data__,be.index,be.group),delete c[he]):+he<t&&(be.state=a_,be.timer.stop(),be.on.call("cancel",e,e.__data__,be.index,be.group),delete c[he])}if(db(function(){n.state===s_&&(n.state=mb,n.timer.restart(a,n.delay,n.time),a(W))}),n.state=ov,n.on.call("start",e,e.__data__,n.index,n.group),n.state===ov){for(n.state=s_,g=new Array(ce=n.tween.length),he=0,ae=-1;he<ce;++he)(be=n.tween[he].value.call(e,e.__data__,n.index,n.group))&&(g[++ae]=be);g.length=ae+1}}function a(W){for(var he=W<n.duration?n.ease.call(null,W/n.duration):(n.timer.restart(U),n.state=lv,1),ae=-1,ce=g.length;++ae<ce;)g[ae].call(e,he);n.state===lv&&(n.on.call("end",e,e.__data__,n.index,n.group),U())}function U(){n.state=a_,n.timer.stop(),delete c[t];for(var W in c)return;delete e.__transition}}function fm(e,t){var n=e.__transition,c,g,x=!0,S;if(n){t=t==null?null:t+"";for(S in n){if((c=n[S]).name!==t){x=!1;continue}g=c.state>ov&&c.state<lv,c.state=a_,c.timer.stop(),c.on.call(g?"interrupt":"cancel",e,e.__data__,c.index,c.group),delete n[S]}x&&delete e.__transition}}function xL(e){return this.each(function(){fm(this,e)})}function bL(e,t){var n,c;return function(){var g=sf(this,e),x=g.tween;if(x!==n){c=n=x;for(var S=0,a=c.length;S<a;++S)if(c[S].name===t){c=c.slice(),c.splice(S,1);break}}g.tween=c}}function wL(e,t,n){var c,g;if(typeof n!="function")throw new Error;return function(){var x=sf(this,e),S=x.tween;if(S!==c){g=(c=S).slice();for(var a={name:t,value:n},U=0,W=g.length;U<W;++U)if(g[U].name===t){g[U]=a;break}U===W&&g.push(a)}x.tween=g}}function SL(e,t){var n=this._id;if(e+="",arguments.length<2){for(var c=AA(this.node(),n).tween,g=0,x=c.length,S;g<x;++g)if((S=c[g]).name===e)return S.value;return null}return this.each((t==null?bL:wL)(n,e,t))}function Jv(e,t,n){var c=e._id;return e.each(function(){var g=sf(this,c);(g.value||(g.value={}))[t]=n.apply(this,arguments)}),function(g){return AA(g,c).value[t]}}function LS(e,t){var n;return(typeof t=="number"?uA:t instanceof rp?k_:(n=rp(t))?(t=n,k_):ES)(e,t)}function IL(e){return function(){this.removeAttribute(e)}}function EL(e){return function(){this.removeAttributeNS(e.space,e.local)}}function CL(e,t,n){var c,g=n+"",x;return function(){var S=this.getAttribute(e);return S===g?null:S===c?x:x=t(c=S,n)}}function TL(e,t,n){var c,g=n+"",x;return function(){var S=this.getAttributeNS(e.space,e.local);return S===g?null:S===c?x:x=t(c=S,n)}}function kL(e,t,n){var c,g,x;return function(){var S,a=n(this),U;return a==null?void this.removeAttribute(e):(S=this.getAttribute(e),U=a+"",S===U?null:S===c&&U===g?x:(g=U,x=t(c=S,a)))}}function ML(e,t,n){var c,g,x;return function(){var S,a=n(this),U;return a==null?void this.removeAttributeNS(e.space,e.local):(S=this.getAttributeNS(e.space,e.local),U=a+"",S===U?null:S===c&&U===g?x:(g=U,x=t(c=S,a)))}}function PL(e,t){var n=e1(e),c=n==="transform"?uL:LS;return this.attrTween(e,typeof t=="function"?(n.local?ML:kL)(n,c,Jv(this,"attr."+e,t)):t==null?(n.local?EL:IL)(n):(n.local?TL:CL)(n,c,t))}function DL(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function LL(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function BL(e,t){var n,c;function g(){var x=t.apply(this,arguments);return x!==c&&(n=(c=x)&&LL(e,x)),n}return g._value=t,g}function zL(e,t){var n,c;function g(){var x=t.apply(this,arguments);return x!==c&&(n=(c=x)&&DL(e,x)),n}return g._value=t,g}function RL(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var c=e1(e);return this.tween(n,(c.local?BL:zL)(c,t))}function FL(e,t){return function(){Kv(this,e).delay=+t.apply(this,arguments)}}function OL(e,t){return t=+t,function(){Kv(this,e).delay=t}}function NL(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?FL:OL)(t,e)):AA(this.node(),t).delay}function VL(e,t){return function(){sf(this,e).duration=+t.apply(this,arguments)}}function UL(e,t){return t=+t,function(){sf(this,e).duration=t}}function GL(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?VL:UL)(t,e)):AA(this.node(),t).duration}function qL(e,t){if(typeof t!="function")throw new Error;return function(){sf(this,e).ease=t}}function HL(e){var t=this._id;return arguments.length?this.each(qL(t,e)):AA(this.node(),t).ease}function jL(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;sf(this,e).ease=n}}function ZL(e){if(typeof e!="function")throw new Error;return this.each(jL(this._id,e))}function QL(e){typeof e!="function"&&(e=hS(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var x=t[g],S=x.length,a=c[g]=[],U,W=0;W<S;++W)(U=x[W])&&e.call(U,U.__data__,W,x)&&a.push(U);return new a0(c,this._parents,this._name,this._id)}function WL(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,c=t.length,g=n.length,x=Math.min(c,g),S=new Array(c),a=0;a<x;++a)for(var U=t[a],W=n[a],he=U.length,ae=S[a]=new Array(he),ce,be=0;be<he;++be)(ce=U[be]||W[be])&&(ae[be]=ce);for(;a<c;++a)S[a]=t[a];return new a0(S,this._parents,this._name,this._id)}function $L(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function XL(e,t,n){var c,g,x=$L(t)?Kv:sf;return function(){var S=x(this,e),a=S.on;a!==c&&(g=(c=a).copy()).on(t,n),S.on=g}}function YL(e,t){var n=this._id;return arguments.length<2?AA(this.node(),n).on.on(e):this.each(XL(n,e,t))}function KL(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function JL(){return this.on("end.remove",KL(this._id))}function eB(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Qv(e));for(var c=this._groups,g=c.length,x=new Array(g),S=0;S<g;++S)for(var a=c[S],U=a.length,W=x[S]=new Array(U),he,ae,ce=0;ce<U;++ce)(he=a[ce])&&(ae=e.call(he,he.__data__,ce,a))&&("__data__"in he&&(ae.__data__=he.__data__),W[ce]=ae,n1(W[ce],t,n,ce,W,AA(he,n)));return new a0(x,this._parents,t,n)}function tB(e){var t=this._name,n=this._id;typeof e!="function"&&(e=cS(e));for(var c=this._groups,g=c.length,x=[],S=[],a=0;a<g;++a)for(var U=c[a],W=U.length,he,ae=0;ae<W;++ae)if(he=U[ae]){for(var ce=e.call(he,he.__data__,ae,U),be,Je=AA(he,n),st=0,Ye=ce.length;st<Ye;++st)(be=ce[st])&&n1(be,t,n,st,ce,Je);x.push(ce),S.push(he)}return new a0(x,S,t,n)}var iB=Mg.prototype.constructor;function nB(){return new iB(this._groups,this._parents)}function rB(e,t){var n,c,g;return function(){var x=gm(this,e),S=(this.style.removeProperty(e),gm(this,e));return x===S?null:x===n&&S===c?g:g=t(n=x,c=S)}}function BS(e){return function(){this.style.removeProperty(e)}}function sB(e,t,n){var c,g=n+"",x;return function(){var S=gm(this,e);return S===g?null:S===c?x:x=t(c=S,n)}}function aB(e,t,n){var c,g,x;return function(){var S=gm(this,e),a=n(this),U=a+"";return a==null&&(U=a=(this.style.removeProperty(e),gm(this,e))),S===U?null:S===c&&U===g?x:(g=U,x=t(c=S,a))}}function oB(e,t){var n,c,g,x="style."+t,S="end."+x,a;return function(){var U=sf(this,e),W=U.on,he=U.value[x]==null?a||(a=BS(t)):void 0;(W!==n||g!==he)&&(c=(n=W).copy()).on(S,g=he),U.on=c}}function lB(e,t,n){var c=(e+="")=="transform"?lL:LS;return t==null?this.styleTween(e,rB(e,c)).on("end.style."+e,BS(e)):typeof t=="function"?this.styleTween(e,aB(e,c,Jv(this,"style."+e,t))).each(oB(this._id,e)):this.styleTween(e,sB(e,c,t),n).on("end.style."+e,null)}function uB(e,t,n){return function(c){this.style.setProperty(e,t.call(this,c),n)}}function cB(e,t,n){var c,g;function x(){var S=t.apply(this,arguments);return S!==g&&(c=(g=S)&&uB(e,S,n)),c}return x._value=t,x}function hB(e,t,n){var c="style."+(e+="");if(arguments.length<2)return(c=this.tween(c))&&c._value;if(t==null)return this.tween(c,null);if(typeof t!="function")throw new Error;return this.tween(c,cB(e,t,n??""))}function AB(e){return function(){this.textContent=e}}function fB(e){return function(){var t=e(this);this.textContent=t??""}}function dB(e){return this.tween("text",typeof e=="function"?fB(Jv(this,"text",e)):AB(e==null?"":e+""))}function pB(e){return function(t){this.textContent=e.call(this,t)}}function mB(e){var t,n;function c(){var g=e.apply(this,arguments);return g!==n&&(t=(n=g)&&pB(g)),t}return c._value=e,c}function gB(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,mB(e))}function _B(){for(var e=this._name,t=this._id,n=zS(),c=this._groups,g=c.length,x=0;x<g;++x)for(var S=c[x],a=S.length,U,W=0;W<a;++W)if(U=S[W]){var he=AA(U,t);n1(U,e,n,W,S,{time:he.time+he.delay+he.duration,delay:0,duration:he.duration,ease:he.ease})}return new a0(c,this._parents,e,n)}function yB(){var e,t,n=this,c=n._id,g=n.size();return new Promise(function(x,S){var a={value:S},U={value:function(){--g===0&&x()}};n.each(function(){var W=sf(this,c),he=W.on;he!==e&&(t=(e=he).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(U)),W.on=t}),g===0&&x()})}var vB=0;function a0(e,t,n,c){this._groups=e,this._parents=t,this._name=n,this._id=c}function zS(){return++vB}var Hd=Mg.prototype;a0.prototype={constructor:a0,select:eB,selectAll:tB,filter:QL,merge:WL,selection:nB,transition:_B,call:Hd.call,nodes:Hd.nodes,node:Hd.node,size:Hd.size,empty:Hd.empty,each:Hd.each,on:YL,attr:PL,attrTween:RL,style:lB,styleTween:hB,text:dB,textTween:gB,remove:JL,tween:SL,delay:NL,duration:GL,ease:HL,easeVarying:ZL,end:yB,[Symbol.iterator]:Hd[Symbol.iterator]};function xB(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var bB={time:null,delay:0,duration:250,ease:xB};function wB(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function SB(e){var t,n;e instanceof a0?(t=e._id,e=e._name):(t=zS(),(n=bB).time=Yv(),e=e==null?null:e+"");for(var c=this._groups,g=c.length,x=0;x<g;++x)for(var S=c[x],a=S.length,U,W=0;W<a;++W)(U=S[W])&&n1(U,e,t,W,S,n||wB(U,t));return new a0(c,this._parents,e,t)}Mg.prototype.interrupt=xL;Mg.prototype.transition=SB;const j1=e=>()=>e;function IB(e,{sourceEvent:t,target:n,selection:c,mode:g,dispatch:x}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:c,enumerable:!0,configurable:!0},mode:{value:g,enumerable:!0,configurable:!0},_:{value:x}})}function EB(e){e.stopImmediatePropagation()}function Z1(e){e.preventDefault(),e.stopImmediatePropagation()}var gb={name:"drag"},Q1={name:"space"},Wp={name:"handle"},$p={name:"center"};const{abs:_b,max:Ju,min:ec}=Math;function yb(e){return[+e[0],+e[1]]}function uv(e){return[yb(e[0]),yb(e[1])]}var W1={name:"x",handles:["w","e"].map(vg),input:function(e,t){return e==null?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},$1={name:"y",handles:["n","s"].map(vg),input:function(e,t){return e==null?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},CB={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(vg),input:function(e){return e==null?null:uv(e)},output:function(e){return e}},Wf={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},vb={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},xb={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},TB={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},kB={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function vg(e){return{type:e}}function MB(e){return!e.ctrlKey&&!e.button}function PB(){var e=this.ownerSVGElement||this;return e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function DB(){return navigator.maxTouchPoints||"ontouchstart"in this}function X1(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function LB(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}function BB(){return zB(CB)}function zB(e){var t=PB,n=MB,c=DB,g=!0,x=J_("start","brush","end"),S=6,a;function U(Ye){var it=Ye.property("__brush",st).selectAll(".overlay").data([vg("overlay")]);it.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Wf.overlay).merge(it).each(function(){var Tt=X1(this).extent;dl(this).attr("x",Tt[0][0]).attr("y",Tt[0][1]).attr("width",Tt[1][0]-Tt[0][0]).attr("height",Tt[1][1]-Tt[0][1])}),Ye.selectAll(".selection").data([vg("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Wf.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var ct=Ye.selectAll(".handle").data(e.handles,function(Tt){return Tt.type});ct.exit().remove(),ct.enter().append("rect").attr("class",function(Tt){return"handle handle--"+Tt.type}).attr("cursor",function(Tt){return Wf[Tt.type]}),Ye.each(W).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",ce).filter(c).on("touchstart.brush",ce).on("touchmove.brush",be).on("touchend.brush touchcancel.brush",Je).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}U.move=function(Ye,it){Ye.tween?Ye.on("start.brush",function(ct){he(this,arguments).beforestart().start(ct)}).on("interrupt.brush end.brush",function(ct){he(this,arguments).end(ct)}).tween("brush",function(){var ct=this,Tt=ct.__brush,zt=he(ct,arguments),Rt=Tt.selection,Oe=e.input(typeof it=="function"?it.apply(this,arguments):it,Tt.extent),jt=t1(Rt,Oe);function at(_t){Tt.selection=_t===1&&Oe===null?null:jt(_t),W.call(ct),zt.brush()}return Rt!==null&&Oe!==null?at:at(1)}):Ye.each(function(){var ct=this,Tt=arguments,zt=ct.__brush,Rt=e.input(typeof it=="function"?it.apply(ct,Tt):it,zt.extent),Oe=he(ct,Tt).beforestart();fm(ct),zt.selection=Rt===null?null:Rt,W.call(ct),Oe.start().brush().end()})},U.clear=function(Ye){U.move(Ye,null)};function W(){var Ye=dl(this),it=X1(this).selection;it?(Ye.selectAll(".selection").style("display",null).attr("x",it[0][0]).attr("y",it[0][1]).attr("width",it[1][0]-it[0][0]).attr("height",it[1][1]-it[0][1]),Ye.selectAll(".handle").style("display",null).attr("x",function(ct){return ct.type[ct.type.length-1]==="e"?it[1][0]-S/2:it[0][0]-S/2}).attr("y",function(ct){return ct.type[0]==="s"?it[1][1]-S/2:it[0][1]-S/2}).attr("width",function(ct){return ct.type==="n"||ct.type==="s"?it[1][0]-it[0][0]+S:S}).attr("height",function(ct){return ct.type==="e"||ct.type==="w"?it[1][1]-it[0][1]+S:S})):Ye.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function he(Ye,it,ct){var Tt=Ye.__brush.emitter;return Tt&&(!ct||!Tt.clean)?Tt:new ae(Ye,it,ct)}function ae(Ye,it,ct){this.that=Ye,this.args=it,this.state=Ye.__brush,this.active=0,this.clean=ct}ae.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(Ye,it){return this.starting?(this.starting=!1,this.emit("start",Ye,it)):this.emit("brush",Ye),this},brush:function(Ye,it){return this.emit("brush",Ye,it),this},end:function(Ye,it){return--this.active===0&&(delete this.state.emitter,this.emit("end",Ye,it)),this},emit:function(Ye,it,ct){var Tt=dl(this.that).datum();x.call(Ye,this.that,new IB(Ye,{sourceEvent:it,target:U,selection:e.output(this.state.selection),mode:ct,dispatch:x}),Tt)}};function ce(Ye){if(a&&!Ye.touches||!n.apply(this,arguments))return;var it=this,ct=Ye.target.__data__.type,Tt=(g&&Ye.metaKey?ct="overlay":ct)==="selection"?gb:g&&Ye.altKey?$p:Wp,zt=e===$1?null:TB[ct],Rt=e===W1?null:kB[ct],Oe=X1(it),jt=Oe.extent,at=Oe.selection,_t=jt[0][0],mt,xt,bt=jt[0][1],lt,$e,pt=jt[1][0],ut,Nt,Bt=jt[1][1],Ot,gi,Ii=0,Ci=0,Ri,Ki=zt&&Rt&&g&&Ye.shiftKey,Hi,Ni,nn=Array.from(Ye.touches||[Ye],Xt=>{const Ji=Xt.identifier;return Xt=Yf(Xt,it),Xt.point0=Xt.slice(),Xt.identifier=Ji,Xt});if(ct==="overlay"){at&&(Ri=!0);const Xt=[nn[0],nn[1]||nn[0]];Oe.selection=at=[[mt=e===$1?_t:ec(Xt[0][0],Xt[1][0]),lt=e===W1?bt:ec(Xt[0][1],Xt[1][1])],[ut=e===$1?pt:Ju(Xt[0][0],Xt[1][0]),Ot=e===W1?Bt:Ju(Xt[0][1],Xt[1][1])]],nn.length>1&&xn()}else mt=at[0][0],lt=at[0][1],ut=at[1][0],Ot=at[1][1];xt=mt,$e=lt,Nt=ut,gi=Ot;var vn=dl(it).attr("pointer-events","none"),Ei=vn.selectAll(".overlay").attr("cursor",Wf[ct]);fm(it);var mi=he(it,arguments,!0).beforestart();if(Ye.touches)mi.moved=Oi,mi.ended=bn;else{var zi=dl(Ye.view).on("mousemove.brush",Oi,!0).on("mouseup.brush",bn,!0);g&&zi.on("keydown.brush",Yt,!0).on("keyup.brush",rn,!0),xS(Ye.view)}W.call(it),mi.start(Ye,Tt.name);function Oi(Xt){for(const Ji of Xt.changedTouches||[Xt])for(const mr of nn)mr.identifier===Ji.identifier&&(mr.cur=Yf(Ji,it));if(Ki&&!Hi&&!Ni&&nn.length===1){const Ji=nn[0];_b(Ji.cur[0]-Ji[0])>_b(Ji.cur[1]-Ji[1])?Ni=!0:Hi=!0}for(const Ji of nn)Ji.cur&&(Ji[0]=Ji.cur[0],Ji[1]=Ji.cur[1]);Ri=!0,Z1(Xt),xn(Xt)}function xn(Xt){const Ji=nn[0],mr=Ji.point0;var ci;switch(Ii=Ji[0]-mr[0],Ci=Ji[1]-mr[1],Tt){case Q1:case gb:{zt&&(Ii=Ju(_t-mt,ec(pt-ut,Ii)),xt=mt+Ii,Nt=ut+Ii),Rt&&(Ci=Ju(bt-lt,ec(Bt-Ot,Ci)),$e=lt+Ci,gi=Ot+Ci);break}case Wp:{nn[1]?(zt&&(xt=Ju(_t,ec(pt,nn[0][0])),Nt=Ju(_t,ec(pt,nn[1][0])),zt=1),Rt&&($e=Ju(bt,ec(Bt,nn[0][1])),gi=Ju(bt,ec(Bt,nn[1][1])),Rt=1)):(zt<0?(Ii=Ju(_t-mt,ec(pt-mt,Ii)),xt=mt+Ii,Nt=ut):zt>0&&(Ii=Ju(_t-ut,ec(pt-ut,Ii)),xt=mt,Nt=ut+Ii),Rt<0?(Ci=Ju(bt-lt,ec(Bt-lt,Ci)),$e=lt+Ci,gi=Ot):Rt>0&&(Ci=Ju(bt-Ot,ec(Bt-Ot,Ci)),$e=lt,gi=Ot+Ci));break}case $p:{zt&&(xt=Ju(_t,ec(pt,mt-Ii*zt)),Nt=Ju(_t,ec(pt,ut+Ii*zt))),Rt&&($e=Ju(bt,ec(Bt,lt-Ci*Rt)),gi=Ju(bt,ec(Bt,Ot+Ci*Rt)));break}}Nt<xt&&(zt*=-1,ci=mt,mt=ut,ut=ci,ci=xt,xt=Nt,Nt=ci,ct in vb&&Ei.attr("cursor",Wf[ct=vb[ct]])),gi<$e&&(Rt*=-1,ci=lt,lt=Ot,Ot=ci,ci=$e,$e=gi,gi=ci,ct in xb&&Ei.attr("cursor",Wf[ct=xb[ct]])),Oe.selection&&(at=Oe.selection),Hi&&(xt=at[0][0],Nt=at[1][0]),Ni&&($e=at[0][1],gi=at[1][1]),(at[0][0]!==xt||at[0][1]!==$e||at[1][0]!==Nt||at[1][1]!==gi)&&(Oe.selection=[[xt,$e],[Nt,gi]],W.call(it),mi.brush(Xt,Tt.name))}function bn(Xt){if(EB(Xt),Xt.touches){if(Xt.touches.length)return;a&&clearTimeout(a),a=setTimeout(function(){a=null},500)}else bS(Xt.view,Ri),zi.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);vn.attr("pointer-events","all"),Ei.attr("cursor",Wf.overlay),Oe.selection&&(at=Oe.selection),LB(at)&&(Oe.selection=null,W.call(it)),mi.end(Xt,Tt.name)}function Yt(Xt){switch(Xt.keyCode){case 16:{Ki=zt&&Rt;break}case 18:{Tt===Wp&&(zt&&(ut=Nt-Ii*zt,mt=xt+Ii*zt),Rt&&(Ot=gi-Ci*Rt,lt=$e+Ci*Rt),Tt=$p,xn());break}case 32:{(Tt===Wp||Tt===$p)&&(zt<0?ut=Nt-Ii:zt>0&&(mt=xt-Ii),Rt<0?Ot=gi-Ci:Rt>0&&(lt=$e-Ci),Tt=Q1,Ei.attr("cursor",Wf.selection),xn());break}default:return}Z1(Xt)}function rn(Xt){switch(Xt.keyCode){case 16:{Ki&&(Hi=Ni=Ki=!1,xn());break}case 18:{Tt===$p&&(zt<0?ut=Nt:zt>0&&(mt=xt),Rt<0?Ot=gi:Rt>0&&(lt=$e),Tt=Wp,xn());break}case 32:{Tt===Q1&&(Xt.altKey?(zt&&(ut=Nt-Ii*zt,mt=xt+Ii*zt),Rt&&(Ot=gi-Ci*Rt,lt=$e+Ci*Rt),Tt=$p):(zt<0?ut=Nt:zt>0&&(mt=xt),Rt<0?Ot=gi:Rt>0&&(lt=$e),Tt=Wp),Ei.attr("cursor",Wf[ct]),xn());break}default:return}Z1(Xt)}}function be(Ye){he(this,arguments).moved(Ye)}function Je(Ye){he(this,arguments).ended(Ye)}function st(){var Ye=this.__brush||{selection:null};return Ye.extent=uv(t.apply(this,arguments)),Ye.dim=e,Ye}return U.extent=function(Ye){return arguments.length?(t=typeof Ye=="function"?Ye:j1(uv(Ye)),U):t},U.filter=function(Ye){return arguments.length?(n=typeof Ye=="function"?Ye:j1(!!Ye),U):n},U.touchable=function(Ye){return arguments.length?(c=typeof Ye=="function"?Ye:j1(!!Ye),U):c},U.handleSize=function(Ye){return arguments.length?(S=+Ye,U):S},U.keyModifiers=function(Ye){return arguments.length?(g=!!Ye,U):g},U.on=function(){var Ye=x.on.apply(x,arguments);return Ye===x?U:Ye},U}const cv=Math.PI,hv=2*cv,Qd=1e-6,RB=hv-Qd;function Av(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function RS(){return new Av}Av.prototype=RS.prototype={constructor:Av,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,c){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+c)},bezierCurveTo:function(e,t,n,c,g,x){this._+="C"+ +e+","+ +t+","+ +n+","+ +c+","+(this._x1=+g)+","+(this._y1=+x)},arcTo:function(e,t,n,c,g){e=+e,t=+t,n=+n,c=+c,g=+g;var x=this._x1,S=this._y1,a=n-e,U=c-t,W=x-e,he=S-t,ae=W*W+he*he;if(g<0)throw new Error("negative radius: "+g);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(ae>Qd)if(!(Math.abs(he*a-U*W)>Qd)||!g)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var ce=n-x,be=c-S,Je=a*a+U*U,st=ce*ce+be*be,Ye=Math.sqrt(Je),it=Math.sqrt(ae),ct=g*Math.tan((cv-Math.acos((Je+ae-st)/(2*Ye*it)))/2),Tt=ct/it,zt=ct/Ye;Math.abs(Tt-1)>Qd&&(this._+="L"+(e+Tt*W)+","+(t+Tt*he)),this._+="A"+g+","+g+",0,0,"+ +(he*ce>W*be)+","+(this._x1=e+zt*a)+","+(this._y1=t+zt*U)}},arc:function(e,t,n,c,g,x){e=+e,t=+t,n=+n,x=!!x;var S=n*Math.cos(c),a=n*Math.sin(c),U=e+S,W=t+a,he=1^x,ae=x?c-g:g-c;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+U+","+W:(Math.abs(this._x1-U)>Qd||Math.abs(this._y1-W)>Qd)&&(this._+="L"+U+","+W),n&&(ae<0&&(ae=ae%hv+hv),ae>RB?this._+="A"+n+","+n+",0,1,"+he+","+(e-S)+","+(t-a)+"A"+n+","+n+",0,1,"+he+","+(this._x1=U)+","+(this._y1=W):ae>Qd&&(this._+="A"+n+","+n+",0,"+ +(ae>=cv)+","+he+","+(this._x1=e+n*Math.cos(g))+","+(this._y1=t+n*Math.sin(g))))},rect:function(e,t,n,c){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +c+"h"+-n+"Z"},toString:function(){return this._}};function FB(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function L_(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,c=e.slice(0,n);return[c.length>1?c[0]+c.slice(2):c,+e.slice(n+1)]}function ym(e){return e=L_(Math.abs(e)),e?e[1]:NaN}function OB(e,t){return function(n,c){for(var g=n.length,x=[],S=0,a=e[0],U=0;g>0&&a>0&&(U+a+1>c&&(a=Math.max(1,c-U)),x.push(n.substring(g-=a,g+a)),!((U+=a+1)>c));)a=e[S=(S+1)%e.length];return x.reverse().join(t)}}function NB(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var VB=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function B_(e){if(!(t=VB.exec(e)))throw new Error("invalid format: "+e);var t;return new e2({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}B_.prototype=e2.prototype;function e2(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}e2.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function UB(e){e:for(var t=e.length,n=1,c=-1,g;n<t;++n)switch(e[n]){case".":c=g=n;break;case"0":c===0&&(c=n),g=n;break;default:if(!+e[n])break e;c>0&&(c=0);break}return c>0?e.slice(0,c)+e.slice(g+1):e}var FS;function GB(e,t){var n=L_(e,t);if(!n)return e+"";var c=n[0],g=n[1],x=g-(FS=Math.max(-8,Math.min(8,Math.floor(g/3)))*3)+1,S=c.length;return x===S?c:x>S?c+new Array(x-S+1).join("0"):x>0?c.slice(0,x)+"."+c.slice(x):"0."+new Array(1-x).join("0")+L_(e,Math.max(0,t+x-1))[0]}function bb(e,t){var n=L_(e,t);if(!n)return e+"";var c=n[0],g=n[1];return g<0?"0."+new Array(-g).join("0")+c:c.length>g+1?c.slice(0,g+1)+"."+c.slice(g+1):c+new Array(g-c.length+2).join("0")}const wb={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:FB,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>bb(e*100,t),r:bb,s:GB,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Sb(e){return e}var Ib=Array.prototype.map,Eb=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function qB(e){var t=e.grouping===void 0||e.thousands===void 0?Sb:OB(Ib.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",c=e.currency===void 0?"":e.currency[1]+"",g=e.decimal===void 0?".":e.decimal+"",x=e.numerals===void 0?Sb:NB(Ib.call(e.numerals,String)),S=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"":e.minus+"",U=e.nan===void 0?"NaN":e.nan+"";function W(ae){ae=B_(ae);var ce=ae.fill,be=ae.align,Je=ae.sign,st=ae.symbol,Ye=ae.zero,it=ae.width,ct=ae.comma,Tt=ae.precision,zt=ae.trim,Rt=ae.type;Rt==="n"?(ct=!0,Rt="g"):wb[Rt]||(Tt===void 0&&(Tt=12),zt=!0,Rt="g"),(Ye||ce==="0"&&be==="=")&&(Ye=!0,ce="0",be="=");var Oe=st==="$"?n:st==="#"&&/[boxX]/.test(Rt)?"0"+Rt.toLowerCase():"",jt=st==="$"?c:/[%p]/.test(Rt)?S:"",at=wb[Rt],_t=/[defgprs%]/.test(Rt);Tt=Tt===void 0?6:/[gprs]/.test(Rt)?Math.max(1,Math.min(21,Tt)):Math.max(0,Math.min(20,Tt));function mt(xt){var bt=Oe,lt=jt,$e,pt,ut;if(Rt==="c")lt=at(xt)+lt,xt="";else{xt=+xt;var Nt=xt<0||1/xt<0;if(xt=isNaN(xt)?U:at(Math.abs(xt),Tt),zt&&(xt=UB(xt)),Nt&&+xt==0&&Je!=="+"&&(Nt=!1),bt=(Nt?Je==="("?Je:a:Je==="-"||Je==="("?"":Je)+bt,lt=(Rt==="s"?Eb[8+FS/3]:"")+lt+(Nt&&Je==="("?")":""),_t){for($e=-1,pt=xt.length;++$e<pt;)if(ut=xt.charCodeAt($e),48>ut||ut>57){lt=(ut===46?g+xt.slice($e+1):xt.slice($e))+lt,xt=xt.slice(0,$e);break}}}ct&&!Ye&&(xt=t(xt,1/0));var Bt=bt.length+xt.length+lt.length,Ot=Bt<it?new Array(it-Bt+1).join(ce):"";switch(ct&&Ye&&(xt=t(Ot+xt,Ot.length?it-lt.length:1/0),Ot=""),be){case"<":xt=bt+xt+lt+Ot;break;case"=":xt=bt+Ot+xt+lt;break;case"^":xt=Ot.slice(0,Bt=Ot.length>>1)+bt+xt+lt+Ot.slice(Bt);break;default:xt=Ot+bt+xt+lt;break}return x(xt)}return mt.toString=function(){return ae+""},mt}function he(ae,ce){var be=W((ae=B_(ae),ae.type="f",ae)),Je=Math.max(-8,Math.min(8,Math.floor(ym(ce)/3)))*3,st=Math.pow(10,-Je),Ye=Eb[8+Je/3];return function(it){return be(st*it)+Ye}}return{format:W,formatPrefix:he}}var $g,t2,OS;HB({thousands:",",grouping:[3],currency:["$",""]});function HB(e){return $g=qB(e),t2=$g.format,OS=$g.formatPrefix,$g}function jB(e){return Math.max(0,-ym(Math.abs(e)))}function ZB(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ym(t)/3)))*3-ym(Math.abs(e)))}function QB(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ym(t)-ym(e))+1}function WB(e){var t=0,n=e.children,c=n&&n.length;if(!c)t=1;else for(;--c>=0;)t+=n[c].value;e.value=t}function $B(){return this.eachAfter(WB)}function XB(e,t){let n=-1;for(const c of this)e.call(t,c,++n,this);return this}function YB(e,t){for(var n=this,c=[n],g,x,S=-1;n=c.pop();)if(e.call(t,n,++S,this),g=n.children)for(x=g.length-1;x>=0;--x)c.push(g[x]);return this}function KB(e,t){for(var n=this,c=[n],g=[],x,S,a,U=-1;n=c.pop();)if(g.push(n),x=n.children)for(S=0,a=x.length;S<a;++S)c.push(x[S]);for(;n=g.pop();)e.call(t,n,++U,this);return this}function JB(e,t){let n=-1;for(const c of this)if(e.call(t,c,++n,this))return c}function ez(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,c=t.children,g=c&&c.length;--g>=0;)n+=c[g].value;t.value=n})}function tz(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function iz(e){for(var t=this,n=nz(t,e),c=[t];t!==n;)t=t.parent,c.push(t);for(var g=c.length;e!==n;)c.splice(g,0,e),e=e.parent;return c}function nz(e,t){if(e===t)return e;var n=e.ancestors(),c=t.ancestors(),g=null;for(e=n.pop(),t=c.pop();e===t;)g=e,e=n.pop(),t=c.pop();return g}function rz(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function sz(){return Array.from(this)}function az(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function oz(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*lz(){var e=this,t,n=[e],c,g,x;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,c=e.children)for(g=0,x=c.length;g<x;++g)n.push(c[g]);while(n.length)}function Kd(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=hz)):t===void 0&&(t=cz);for(var n=new z_(e),c,g=[n],x,S,a,U;c=g.pop();)if((S=t(c.data))&&(U=(S=Array.from(S)).length))for(c.children=S,a=U-1;a>=0;--a)g.push(x=S[a]=new z_(S[a])),x.parent=c,x.depth=c.depth+1;return n.eachBefore(fz)}function uz(){return Kd(this).eachBefore(Az)}function cz(e){return e.children}function hz(e){return Array.isArray(e)?e[1]:null}function Az(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function fz(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function z_(e){this.data=e,this.depth=this.height=0,this.parent=null}z_.prototype=Kd.prototype={constructor:z_,count:$B,each:XB,eachAfter:KB,eachBefore:YB,find:JB,sum:ez,sort:tz,path:iz,ancestors:rz,descendants:sz,leaves:az,links:oz,copy:uz,[Symbol.iterator]:lz};function dz(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function pz(e){return function(){return e}}function mz(e){return+e}var Cb=[0,1];function nm(e){return e}function fv(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:pz(isNaN(t)?NaN:.5)}function gz(e,t){var n;return e>t&&(n=e,e=t,t=n),function(c){return Math.max(e,Math.min(t,c))}}function _z(e,t,n){var c=e[0],g=e[1],x=t[0],S=t[1];return g<c?(c=fv(g,c),x=n(S,x)):(c=fv(c,g),x=n(x,S)),function(a){return x(c(a))}}function yz(e,t,n){var c=Math.min(e.length,t.length)-1,g=new Array(c),x=new Array(c),S=-1;for(e[c]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++S<c;)g[S]=fv(e[S],e[S+1]),x[S]=n(t[S],t[S+1]);return function(a){var U=ZM(e,a,1,c)-1;return x[U](g[U](a))}}function vz(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function xz(){var e=Cb,t=Cb,n=t1,c,g,x,S=nm,a,U,W;function he(){var ce=Math.min(e.length,t.length);return S!==nm&&(S=gz(e[0],e[ce-1])),a=ce>2?yz:_z,U=W=null,ae}function ae(ce){return ce==null||isNaN(ce=+ce)?x:(U||(U=a(e.map(c),t,n)))(c(S(ce)))}return ae.invert=function(ce){return S(g((W||(W=a(t,e.map(c),uA)))(ce)))},ae.domain=function(ce){return arguments.length?(e=Array.from(ce,mz),he()):e.slice()},ae.range=function(ce){return arguments.length?(t=Array.from(ce),he()):t.slice()},ae.rangeRound=function(ce){return t=Array.from(ce),n=sL,he()},ae.clamp=function(ce){return arguments.length?(S=ce?!0:nm,he()):S!==nm},ae.interpolate=function(ce){return arguments.length?(n=ce,he()):n},ae.unknown=function(ce){return arguments.length?(x=ce,ae):x},function(ce,be){return c=ce,g=be,he()}}function bz(){return xz()(nm,nm)}function wz(e,t,n,c){var g=WM(e,t,n),x;switch(c=B_(c??",f"),c.type){case"s":{var S=Math.max(Math.abs(e),Math.abs(t));return c.precision==null&&!isNaN(x=ZB(g,S))&&(c.precision=x),OS(c,S)}case"":case"e":case"g":case"p":case"r":{c.precision==null&&!isNaN(x=QB(g,Math.max(Math.abs(e),Math.abs(t))))&&(c.precision=x-(c.type==="e"));break}case"f":case"%":{c.precision==null&&!isNaN(x=jB(g))&&(c.precision=x-(c.type==="%")*2);break}}return t2(c)}function Sz(e){var t=e.domain;return e.ticks=function(n){var c=t();return QM(c[0],c[c.length-1],n??10)},e.tickFormat=function(n,c){var g=t();return wz(g[0],g[g.length-1],n??10,c)},e.nice=function(n){n==null&&(n=10);var c=t(),g=0,x=c.length-1,S=c[g],a=c[x],U,W,he=10;for(a<S&&(W=S,S=a,a=W,W=g,g=x,x=W);he-- >0;){if(W=lS(S,a,n),W===U)return c[g]=S,c[x]=a,t(c);if(W>0)S=Math.floor(S/W)*W,a=Math.ceil(a/W)*W;else if(W<0)S=Math.ceil(S*W)/W,a=Math.floor(a*W)/W;else break;U=W}return e},e}function NS(){var e=bz();return e.copy=function(){return vz(e,NS())},dz.apply(e,arguments),Sz(e)}var Y1=new Date,K1=new Date;function c0(e,t,n,c){function g(x){return e(x=arguments.length===0?new Date:new Date(+x)),x}return g.floor=function(x){return e(x=new Date(+x)),x},g.ceil=function(x){return e(x=new Date(x-1)),t(x,1),e(x),x},g.round=function(x){var S=g(x),a=g.ceil(x);return x-S<a-x?S:a},g.offset=function(x,S){return t(x=new Date(+x),S==null?1:Math.floor(S)),x},g.range=function(x,S,a){var U=[],W;if(x=g.ceil(x),a=a==null?1:Math.floor(a),!(x<S)||!(a>0))return U;do U.push(W=new Date(+x)),t(x,a),e(x);while(W<x&&x<S);return U},g.filter=function(x){return c0(function(S){if(S>=S)for(;e(S),!x(S);)S.setTime(S-1)},function(S,a){if(S>=S)if(a<0)for(;++a<=0;)for(;t(S,-1),!x(S););else for(;--a>=0;)for(;t(S,1),!x(S););})},n&&(g.count=function(x,S){return Y1.setTime(+x),K1.setTime(+S),e(Y1),e(K1),Math.floor(n(Y1,K1))},g.every=function(x){return x=Math.floor(x),!isFinite(x)||!(x>0)?null:x>1?g.filter(c?function(S){return c(S)%x===0}:function(S){return g.count(0,S)%x===0}):g}),g}const Iz=1e3,i2=Iz*60,Ez=i2*60,n2=Ez*24,VS=n2*7;var r2=c0(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*i2)/n2,e=>e.getDate()-1);r2.range;function hp(e){return c0(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*i2)/VS})}var US=hp(0),R_=hp(1),Cz=hp(2),Tz=hp(3),vm=hp(4),kz=hp(5),Mz=hp(6);US.range;R_.range;Cz.range;Tz.range;vm.range;kz.range;Mz.range;var ap=c0(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});ap.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:c0(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};ap.range;var s2=c0(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/n2},function(e){return e.getUTCDate()-1});s2.range;function Ap(e){return c0(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/VS})}var GS=Ap(0),F_=Ap(1),Pz=Ap(2),Dz=Ap(3),xm=Ap(4),Lz=Ap(5),Bz=Ap(6);GS.range;F_.range;Pz.range;Dz.range;xm.range;Lz.range;Bz.range;var op=c0(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});op.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:c0(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};op.range;function J1(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function ey(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function $m(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function zz(e){var t=e.dateTime,n=e.date,c=e.time,g=e.periods,x=e.days,S=e.shortDays,a=e.months,U=e.shortMonths,W=Xm(g),he=Ym(g),ae=Xm(x),ce=Ym(x),be=Xm(S),Je=Ym(S),st=Xm(a),Ye=Ym(a),it=Xm(U),ct=Ym(U),Tt={a:Nt,A:Bt,b:Ot,B:gi,c:null,d:Lb,e:Lb,f:rR,g:dR,G:mR,H:tR,I:iR,j:nR,L:qS,m:sR,M:aR,p:Ii,q:Ci,Q:Rb,s:Fb,S:oR,u:lR,U:uR,V:cR,w:hR,W:AR,x:null,X:null,y:fR,Y:pR,Z:gR,"%":zb},zt={a:Ri,A:Ki,b:Hi,B:Ni,c:null,d:Bb,e:Bb,f:xR,g:PR,G:LR,H:_R,I:yR,j:vR,L:jS,m:bR,M:wR,p:nn,q:vn,Q:Rb,s:Fb,S:SR,u:IR,U:ER,V:CR,w:TR,W:kR,x:null,X:null,y:MR,Y:DR,Z:BR,"%":zb},Rt={a:mt,A:xt,b:bt,B:lt,c:$e,d:Pb,e:Pb,f:Yz,g:Mb,G:kb,H:Db,I:Db,j:Qz,L:Xz,m:Zz,M:Wz,p:_t,q:jz,Q:Jz,s:eR,S:$z,u:Vz,U:Uz,V:Gz,w:Nz,W:qz,x:pt,X:ut,y:Mb,Y:kb,Z:Hz,"%":Kz};Tt.x=Oe(n,Tt),Tt.X=Oe(c,Tt),Tt.c=Oe(t,Tt),zt.x=Oe(n,zt),zt.X=Oe(c,zt),zt.c=Oe(t,zt);function Oe(Ei,mi){return function(zi){var Oi=[],xn=-1,bn=0,Yt=Ei.length,rn,Xt,Ji;for(zi instanceof Date||(zi=new Date(+zi));++xn<Yt;)Ei.charCodeAt(xn)===37&&(Oi.push(Ei.slice(bn,xn)),(Xt=Tb[rn=Ei.charAt(++xn)])!=null?rn=Ei.charAt(++xn):Xt=rn==="e"?" ":"0",(Ji=mi[rn])&&(rn=Ji(zi,Xt)),Oi.push(rn),bn=xn+1);return Oi.push(Ei.slice(bn,xn)),Oi.join("")}}function jt(Ei,mi){return function(zi){var Oi=$m(1900,void 0,1),xn=at(Oi,Ei,zi+="",0),bn,Yt;if(xn!=zi.length)return null;if("Q"in Oi)return new Date(Oi.Q);if("s"in Oi)return new Date(Oi.s*1e3+("L"in Oi?Oi.L:0));if(mi&&!("Z"in Oi)&&(Oi.Z=0),"p"in Oi&&(Oi.H=Oi.H%12+Oi.p*12),Oi.m===void 0&&(Oi.m="q"in Oi?Oi.q:0),"V"in Oi){if(Oi.V<1||Oi.V>53)return null;"w"in Oi||(Oi.w=1),"Z"in Oi?(bn=ey($m(Oi.y,0,1)),Yt=bn.getUTCDay(),bn=Yt>4||Yt===0?F_.ceil(bn):F_(bn),bn=s2.offset(bn,(Oi.V-1)*7),Oi.y=bn.getUTCFullYear(),Oi.m=bn.getUTCMonth(),Oi.d=bn.getUTCDate()+(Oi.w+6)%7):(bn=J1($m(Oi.y,0,1)),Yt=bn.getDay(),bn=Yt>4||Yt===0?R_.ceil(bn):R_(bn),bn=r2.offset(bn,(Oi.V-1)*7),Oi.y=bn.getFullYear(),Oi.m=bn.getMonth(),Oi.d=bn.getDate()+(Oi.w+6)%7)}else("W"in Oi||"U"in Oi)&&("w"in Oi||(Oi.w="u"in Oi?Oi.u%7:"W"in Oi?1:0),Yt="Z"in Oi?ey($m(Oi.y,0,1)).getUTCDay():J1($m(Oi.y,0,1)).getDay(),Oi.m=0,Oi.d="W"in Oi?(Oi.w+6)%7+Oi.W*7-(Yt+5)%7:Oi.w+Oi.U*7-(Yt+6)%7);return"Z"in Oi?(Oi.H+=Oi.Z/100|0,Oi.M+=Oi.Z%100,ey(Oi)):J1(Oi)}}function at(Ei,mi,zi,Oi){for(var xn=0,bn=mi.length,Yt=zi.length,rn,Xt;xn<bn;){if(Oi>=Yt)return-1;if(rn=mi.charCodeAt(xn++),rn===37){if(rn=mi.charAt(xn++),Xt=Rt[rn in Tb?mi.charAt(xn++):rn],!Xt||(Oi=Xt(Ei,zi,Oi))<0)return-1}else if(rn!=zi.charCodeAt(Oi++))return-1}return Oi}function _t(Ei,mi,zi){var Oi=W.exec(mi.slice(zi));return Oi?(Ei.p=he.get(Oi[0].toLowerCase()),zi+Oi[0].length):-1}function mt(Ei,mi,zi){var Oi=be.exec(mi.slice(zi));return Oi?(Ei.w=Je.get(Oi[0].toLowerCase()),zi+Oi[0].length):-1}function xt(Ei,mi,zi){var Oi=ae.exec(mi.slice(zi));return Oi?(Ei.w=ce.get(Oi[0].toLowerCase()),zi+Oi[0].length):-1}function bt(Ei,mi,zi){var Oi=it.exec(mi.slice(zi));return Oi?(Ei.m=ct.get(Oi[0].toLowerCase()),zi+Oi[0].length):-1}function lt(Ei,mi,zi){var Oi=st.exec(mi.slice(zi));return Oi?(Ei.m=Ye.get(Oi[0].toLowerCase()),zi+Oi[0].length):-1}function $e(Ei,mi,zi){return at(Ei,t,mi,zi)}function pt(Ei,mi,zi){return at(Ei,n,mi,zi)}function ut(Ei,mi,zi){return at(Ei,c,mi,zi)}function Nt(Ei){return S[Ei.getDay()]}function Bt(Ei){return x[Ei.getDay()]}function Ot(Ei){return U[Ei.getMonth()]}function gi(Ei){return a[Ei.getMonth()]}function Ii(Ei){return g[+(Ei.getHours()>=12)]}function Ci(Ei){return 1+~~(Ei.getMonth()/3)}function Ri(Ei){return S[Ei.getUTCDay()]}function Ki(Ei){return x[Ei.getUTCDay()]}function Hi(Ei){return U[Ei.getUTCMonth()]}function Ni(Ei){return a[Ei.getUTCMonth()]}function nn(Ei){return g[+(Ei.getUTCHours()>=12)]}function vn(Ei){return 1+~~(Ei.getUTCMonth()/3)}return{format:function(Ei){var mi=Oe(Ei+="",Tt);return mi.toString=function(){return Ei},mi},parse:function(Ei){var mi=jt(Ei+="",!1);return mi.toString=function(){return Ei},mi},utcFormat:function(Ei){var mi=Oe(Ei+="",zt);return mi.toString=function(){return Ei},mi},utcParse:function(Ei){var mi=jt(Ei+="",!0);return mi.toString=function(){return Ei},mi}}}var Tb={"-":"",_:" ",0:"0"},zu=/^\s*\d+/,Rz=/^%/,Fz=/[\\^$*+?|[\]().{}]/g;function Na(e,t,n){var c=e<0?"-":"",g=(c?-e:e)+"",x=g.length;return c+(x<n?new Array(n-x+1).join(t)+g:g)}function Oz(e){return e.replace(Fz,"\\$&")}function Xm(e){return new RegExp("^(?:"+e.map(Oz).join("|")+")","i")}function Ym(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function Nz(e,t,n){var c=zu.exec(t.slice(n,n+1));return c?(e.w=+c[0],n+c[0].length):-1}function Vz(e,t,n){var c=zu.exec(t.slice(n,n+1));return c?(e.u=+c[0],n+c[0].length):-1}function Uz(e,t,n){var c=zu.exec(t.slice(n,n+2));return c?(e.U=+c[0],n+c[0].length):-1}function Gz(e,t,n){var c=zu.exec(t.slice(n,n+2));return c?(e.V=+c[0],n+c[0].length):-1}function qz(e,t,n){var c=zu.exec(t.slice(n,n+2));return c?(e.W=+c[0],n+c[0].length):-1}function kb(e,t,n){var c=zu.exec(t.slice(n,n+4));return c?(e.y=+c[0],n+c[0].length):-1}function Mb(e,t,n){var c=zu.exec(t.slice(n,n+2));return c?(e.y=+c[0]+(+c[0]>68?1900:2e3),n+c[0].length):-1}function Hz(e,t,n){var c=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return c?(e.Z=c[1]?0:-(c[2]+(c[3]||"00")),n+c[0].length):-1}function jz(e,t,n){var c=zu.exec(t.slice(n,n+1));return c?(e.q=c[0]*3-3,n+c[0].length):-1}function Zz(e,t,n){var c=zu.exec(t.slice(n,n+2));return c?(e.m=c[0]-1,n+c[0].length):-1}function Pb(e,t,n){var c=zu.exec(t.slice(n,n+2));return c?(e.d=+c[0],n+c[0].length):-1}function Qz(e,t,n){var c=zu.exec(t.slice(n,n+3));return c?(e.m=0,e.d=+c[0],n+c[0].length):-1}function Db(e,t,n){var c=zu.exec(t.slice(n,n+2));return c?(e.H=+c[0],n+c[0].length):-1}function Wz(e,t,n){var c=zu.exec(t.slice(n,n+2));return c?(e.M=+c[0],n+c[0].length):-1}function $z(e,t,n){var c=zu.exec(t.slice(n,n+2));return c?(e.S=+c[0],n+c[0].length):-1}function Xz(e,t,n){var c=zu.exec(t.slice(n,n+3));return c?(e.L=+c[0],n+c[0].length):-1}function Yz(e,t,n){var c=zu.exec(t.slice(n,n+6));return c?(e.L=Math.floor(c[0]/1e3),n+c[0].length):-1}function Kz(e,t,n){var c=Rz.exec(t.slice(n,n+1));return c?n+c[0].length:-1}function Jz(e,t,n){var c=zu.exec(t.slice(n));return c?(e.Q=+c[0],n+c[0].length):-1}function eR(e,t,n){var c=zu.exec(t.slice(n));return c?(e.s=+c[0],n+c[0].length):-1}function Lb(e,t){return Na(e.getDate(),t,2)}function tR(e,t){return Na(e.getHours(),t,2)}function iR(e,t){return Na(e.getHours()%12||12,t,2)}function nR(e,t){return Na(1+r2.count(ap(e),e),t,3)}function qS(e,t){return Na(e.getMilliseconds(),t,3)}function rR(e,t){return qS(e,t)+"000"}function sR(e,t){return Na(e.getMonth()+1,t,2)}function aR(e,t){return Na(e.getMinutes(),t,2)}function oR(e,t){return Na(e.getSeconds(),t,2)}function lR(e){var t=e.getDay();return t===0?7:t}function uR(e,t){return Na(US.count(ap(e)-1,e),t,2)}function HS(e){var t=e.getDay();return t>=4||t===0?vm(e):vm.ceil(e)}function cR(e,t){return e=HS(e),Na(vm.count(ap(e),e)+(ap(e).getDay()===4),t,2)}function hR(e){return e.getDay()}function AR(e,t){return Na(R_.count(ap(e)-1,e),t,2)}function fR(e,t){return Na(e.getFullYear()%100,t,2)}function dR(e,t){return e=HS(e),Na(e.getFullYear()%100,t,2)}function pR(e,t){return Na(e.getFullYear()%1e4,t,4)}function mR(e,t){var n=e.getDay();return e=n>=4||n===0?vm(e):vm.ceil(e),Na(e.getFullYear()%1e4,t,4)}function gR(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Na(t/60|0,"0",2)+Na(t%60,"0",2)}function Bb(e,t){return Na(e.getUTCDate(),t,2)}function _R(e,t){return Na(e.getUTCHours(),t,2)}function yR(e,t){return Na(e.getUTCHours()%12||12,t,2)}function vR(e,t){return Na(1+s2.count(op(e),e),t,3)}function jS(e,t){return Na(e.getUTCMilliseconds(),t,3)}function xR(e,t){return jS(e,t)+"000"}function bR(e,t){return Na(e.getUTCMonth()+1,t,2)}function wR(e,t){return Na(e.getUTCMinutes(),t,2)}function SR(e,t){return Na(e.getUTCSeconds(),t,2)}function IR(e){var t=e.getUTCDay();return t===0?7:t}function ER(e,t){return Na(GS.count(op(e)-1,e),t,2)}function ZS(e){var t=e.getUTCDay();return t>=4||t===0?xm(e):xm.ceil(e)}function CR(e,t){return e=ZS(e),Na(xm.count(op(e),e)+(op(e).getUTCDay()===4),t,2)}function TR(e){return e.getUTCDay()}function kR(e,t){return Na(F_.count(op(e)-1,e),t,2)}function MR(e,t){return Na(e.getUTCFullYear()%100,t,2)}function PR(e,t){return e=ZS(e),Na(e.getUTCFullYear()%100,t,2)}function DR(e,t){return Na(e.getUTCFullYear()%1e4,t,4)}function LR(e,t){var n=e.getUTCDay();return e=n>=4||n===0?xm(e):xm.ceil(e),Na(e.getUTCFullYear()%1e4,t,4)}function BR(){return"+0000"}function zb(){return"%"}function Rb(e){return+e}function Fb(e){return Math.floor(+e/1e3)}var Xp,QS;zR({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function zR(e){return Xp=zz(e),Xp.format,QS=Xp.parse,Xp.utcFormat,Xp.utcParse,Xp}function Yp(e){return function(){return e}}function RR(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function WS(e){this._context=e}WS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function FR(e){return new WS(e)}function OR(e){return e[0]}function NR(e){return e[1]}function dv(e,t){var n=Yp(!0),c=null,g=FR,x=null;e=typeof e=="function"?e:e===void 0?OR:Yp(e),t=typeof t=="function"?t:t===void 0?NR:Yp(t);function S(a){var U,W=(a=RR(a)).length,he,ae=!1,ce;for(c==null&&(x=g(ce=RS())),U=0;U<=W;++U)!(U<W&&n(he=a[U],U,a))===ae&&((ae=!ae)?x.lineStart():x.lineEnd()),ae&&x.point(+e(he,U,a),+t(he,U,a));if(ce)return x=null,ce+""||null}return S.x=function(a){return arguments.length?(e=typeof a=="function"?a:Yp(+a),S):e},S.y=function(a){return arguments.length?(t=typeof a=="function"?a:Yp(+a),S):t},S.defined=function(a){return arguments.length?(n=typeof a=="function"?a:Yp(!!a),S):n},S.curve=function(a){return arguments.length?(g=a,c!=null&&(x=g(c)),S):g},S.context=function(a){return arguments.length?(a==null?c=x=null:x=g(c=a),S):c},S}function Ob(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function $S(e){this._context=e}$S.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ob(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ob(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Nb(e){return new $S(e)}function XS(e,t){this._context=e,this._t=t}XS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function VR(e){return new XS(e,0)}const Xg=e=>()=>e;function UR(e,{sourceEvent:t,target:n,transform:c,dispatch:g}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:c,enumerable:!0,configurable:!0},_:{value:g}})}function e0(e,t,n){this.k=e,this.x=t,this.y=n}e0.prototype={constructor:e0,scale:function(e){return e===1?this:new e0(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new e0(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var YS=new e0(1,0,0);e0.prototype;function ty(e){e.stopImmediatePropagation()}function Km(e){e.preventDefault(),e.stopImmediatePropagation()}function GR(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function qR(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Vb(){return this.__zoom||YS}function HR(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function jR(){return navigator.maxTouchPoints||"ontouchstart"in this}function ZR(e,t,n){var c=e.invertX(t[0][0])-n[0][0],g=e.invertX(t[1][0])-n[1][0],x=e.invertY(t[0][1])-n[0][1],S=e.invertY(t[1][1])-n[1][1];return e.translate(g>c?(c+g)/2:Math.min(0,c)||Math.max(0,g),S>x?(x+S)/2:Math.min(0,x)||Math.max(0,S))}function QR(){var e=GR,t=qR,n=ZR,c=HR,g=jR,x=[0,1/0],S=[[-1/0,-1/0],[1/0,1/0]],a=250,U=fL,W=J_("start","zoom","end"),he,ae,ce,be=500,Je=150,st=0,Ye=10;function it($e){$e.property("__zoom",Vb).on("wheel.zoom",at).on("mousedown.zoom",_t).on("dblclick.zoom",mt).filter(g).on("touchstart.zoom",xt).on("touchmove.zoom",bt).on("touchend.zoom touchcancel.zoom",lt).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}it.transform=function($e,pt,ut,Nt){var Bt=$e.selection?$e.selection():$e;Bt.property("__zoom",Vb),$e!==Bt?Rt($e,pt,ut,Nt):Bt.interrupt().each(function(){Oe(this,arguments).event(Nt).start().zoom(null,typeof pt=="function"?pt.apply(this,arguments):pt).end()})},it.scaleBy=function($e,pt,ut,Nt){it.scaleTo($e,function(){var Bt=this.__zoom.k,Ot=typeof pt=="function"?pt.apply(this,arguments):pt;return Bt*Ot},ut,Nt)},it.scaleTo=function($e,pt,ut,Nt){it.transform($e,function(){var Bt=t.apply(this,arguments),Ot=this.__zoom,gi=ut==null?zt(Bt):typeof ut=="function"?ut.apply(this,arguments):ut,Ii=Ot.invert(gi),Ci=typeof pt=="function"?pt.apply(this,arguments):pt;return n(Tt(ct(Ot,Ci),gi,Ii),Bt,S)},ut,Nt)},it.translateBy=function($e,pt,ut,Nt){it.transform($e,function(){return n(this.__zoom.translate(typeof pt=="function"?pt.apply(this,arguments):pt,typeof ut=="function"?ut.apply(this,arguments):ut),t.apply(this,arguments),S)},null,Nt)},it.translateTo=function($e,pt,ut,Nt,Bt){it.transform($e,function(){var Ot=t.apply(this,arguments),gi=this.__zoom,Ii=Nt==null?zt(Ot):typeof Nt=="function"?Nt.apply(this,arguments):Nt;return n(YS.translate(Ii[0],Ii[1]).scale(gi.k).translate(typeof pt=="function"?-pt.apply(this,arguments):-pt,typeof ut=="function"?-ut.apply(this,arguments):-ut),Ot,S)},Nt,Bt)};function ct($e,pt){return pt=Math.max(x[0],Math.min(x[1],pt)),pt===$e.k?$e:new e0(pt,$e.x,$e.y)}function Tt($e,pt,ut){var Nt=pt[0]-ut[0]*$e.k,Bt=pt[1]-ut[1]*$e.k;return Nt===$e.x&&Bt===$e.y?$e:new e0($e.k,Nt,Bt)}function zt($e){return[(+$e[0][0]+ +$e[1][0])/2,(+$e[0][1]+ +$e[1][1])/2]}function Rt($e,pt,ut,Nt){$e.on("start.zoom",function(){Oe(this,arguments).event(Nt).start()}).on("interrupt.zoom end.zoom",function(){Oe(this,arguments).event(Nt).end()}).tween("zoom",function(){var Bt=this,Ot=arguments,gi=Oe(Bt,Ot).event(Nt),Ii=t.apply(Bt,Ot),Ci=ut==null?zt(Ii):typeof ut=="function"?ut.apply(Bt,Ot):ut,Ri=Math.max(Ii[1][0]-Ii[0][0],Ii[1][1]-Ii[0][1]),Ki=Bt.__zoom,Hi=typeof pt=="function"?pt.apply(Bt,Ot):pt,Ni=U(Ki.invert(Ci).concat(Ri/Ki.k),Hi.invert(Ci).concat(Ri/Hi.k));return function(nn){if(nn===1)nn=Hi;else{var vn=Ni(nn),Ei=Ri/vn[2];nn=new e0(Ei,Ci[0]-vn[0]*Ei,Ci[1]-vn[1]*Ei)}gi.zoom(null,nn)}})}function Oe($e,pt,ut){return!ut&&$e.__zooming||new jt($e,pt)}function jt($e,pt){this.that=$e,this.args=pt,this.active=0,this.sourceEvent=null,this.extent=t.apply($e,pt),this.taps=0}jt.prototype={event:function($e){return $e&&(this.sourceEvent=$e),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function($e,pt){return this.mouse&&$e!=="mouse"&&(this.mouse[1]=pt.invert(this.mouse[0])),this.touch0&&$e!=="touch"&&(this.touch0[1]=pt.invert(this.touch0[0])),this.touch1&&$e!=="touch"&&(this.touch1[1]=pt.invert(this.touch1[0])),this.that.__zoom=pt,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function($e){var pt=dl(this.that).datum();W.call($e,this.that,new UR($e,{sourceEvent:this.sourceEvent,target:it,type:$e,transform:this.that.__zoom,dispatch:W}),pt)}};function at($e,...pt){if(!e.apply(this,arguments))return;var ut=Oe(this,pt).event($e),Nt=this.__zoom,Bt=Math.max(x[0],Math.min(x[1],Nt.k*Math.pow(2,c.apply(this,arguments)))),Ot=Yf($e);if(ut.wheel)(ut.mouse[0][0]!==Ot[0]||ut.mouse[0][1]!==Ot[1])&&(ut.mouse[1]=Nt.invert(ut.mouse[0]=Ot)),clearTimeout(ut.wheel);else{if(Nt.k===Bt)return;ut.mouse=[Ot,Nt.invert(Ot)],fm(this),ut.start()}Km($e),ut.wheel=setTimeout(gi,Je),ut.zoom("mouse",n(Tt(ct(Nt,Bt),ut.mouse[0],ut.mouse[1]),ut.extent,S));function gi(){ut.wheel=null,ut.end()}}function _t($e,...pt){if(ce||!e.apply(this,arguments))return;var ut=Oe(this,pt,!0).event($e),Nt=dl($e.view).on("mousemove.zoom",Ci,!0).on("mouseup.zoom",Ri,!0),Bt=Yf($e,Ot),Ot=$e.currentTarget,gi=$e.clientX,Ii=$e.clientY;xS($e.view),ty($e),ut.mouse=[Bt,this.__zoom.invert(Bt)],fm(this),ut.start();function Ci(Ki){if(Km(Ki),!ut.moved){var Hi=Ki.clientX-gi,Ni=Ki.clientY-Ii;ut.moved=Hi*Hi+Ni*Ni>st}ut.event(Ki).zoom("mouse",n(Tt(ut.that.__zoom,ut.mouse[0]=Yf(Ki,Ot),ut.mouse[1]),ut.extent,S))}function Ri(Ki){Nt.on("mousemove.zoom mouseup.zoom",null),bS(Ki.view,ut.moved),Km(Ki),ut.event(Ki).end()}}function mt($e,...pt){if(e.apply(this,arguments)){var ut=this.__zoom,Nt=Yf($e.changedTouches?$e.changedTouches[0]:$e,this),Bt=ut.invert(Nt),Ot=ut.k*($e.shiftKey?.5:2),gi=n(Tt(ct(ut,Ot),Nt,Bt),t.apply(this,pt),S);Km($e),a>0?dl(this).transition().duration(a).call(Rt,gi,Nt,$e):dl(this).call(it.transform,gi,Nt,$e)}}function xt($e,...pt){if(e.apply(this,arguments)){var ut=$e.touches,Nt=ut.length,Bt=Oe(this,pt,$e.changedTouches.length===Nt).event($e),Ot,gi,Ii,Ci;for(ty($e),gi=0;gi<Nt;++gi)Ii=ut[gi],Ci=Yf(Ii,this),Ci=[Ci,this.__zoom.invert(Ci),Ii.identifier],Bt.touch0?!Bt.touch1&&Bt.touch0[2]!==Ci[2]&&(Bt.touch1=Ci,Bt.taps=0):(Bt.touch0=Ci,Ot=!0,Bt.taps=1+!!he);he&&(he=clearTimeout(he)),Ot&&(Bt.taps<2&&(ae=Ci[0],he=setTimeout(function(){he=null},be)),fm(this),Bt.start())}}function bt($e,...pt){if(this.__zooming){var ut=Oe(this,pt).event($e),Nt=$e.changedTouches,Bt=Nt.length,Ot,gi,Ii,Ci;for(Km($e),Ot=0;Ot<Bt;++Ot)gi=Nt[Ot],Ii=Yf(gi,this),ut.touch0&&ut.touch0[2]===gi.identifier?ut.touch0[0]=Ii:ut.touch1&&ut.touch1[2]===gi.identifier&&(ut.touch1[0]=Ii);if(gi=ut.that.__zoom,ut.touch1){var Ri=ut.touch0[0],Ki=ut.touch0[1],Hi=ut.touch1[0],Ni=ut.touch1[1],nn=(nn=Hi[0]-Ri[0])*nn+(nn=Hi[1]-Ri[1])*nn,vn=(vn=Ni[0]-Ki[0])*vn+(vn=Ni[1]-Ki[1])*vn;gi=ct(gi,Math.sqrt(nn/vn)),Ii=[(Ri[0]+Hi[0])/2,(Ri[1]+Hi[1])/2],Ci=[(Ki[0]+Ni[0])/2,(Ki[1]+Ni[1])/2]}else if(ut.touch0)Ii=ut.touch0[0],Ci=ut.touch0[1];else return;ut.zoom("touch",n(Tt(gi,Ii,Ci),ut.extent,S))}}function lt($e,...pt){if(this.__zooming){var ut=Oe(this,pt).event($e),Nt=$e.changedTouches,Bt=Nt.length,Ot,gi;for(ty($e),ce&&clearTimeout(ce),ce=setTimeout(function(){ce=null},be),Ot=0;Ot<Bt;++Ot)gi=Nt[Ot],ut.touch0&&ut.touch0[2]===gi.identifier?delete ut.touch0:ut.touch1&&ut.touch1[2]===gi.identifier&&delete ut.touch1;if(ut.touch1&&!ut.touch0&&(ut.touch0=ut.touch1,delete ut.touch1),ut.touch0)ut.touch0[1]=this.__zoom.invert(ut.touch0[0]);else if(ut.end(),ut.taps===2&&(gi=Yf(gi,this),Math.hypot(ae[0]-gi[0],ae[1]-gi[1])<Ye)){var Ii=dl(this).on("dblclick.zoom");Ii&&Ii.apply(this,arguments)}}}return it.wheelDelta=function($e){return arguments.length?(c=typeof $e=="function"?$e:Xg(+$e),it):c},it.filter=function($e){return arguments.length?(e=typeof $e=="function"?$e:Xg(!!$e),it):e},it.touchable=function($e){return arguments.length?(g=typeof $e=="function"?$e:Xg(!!$e),it):g},it.extent=function($e){return arguments.length?(t=typeof $e=="function"?$e:Xg([[+$e[0][0],+$e[0][1]],[+$e[1][0],+$e[1][1]]]),it):t},it.scaleExtent=function($e){return arguments.length?(x[0]=+$e[0],x[1]=+$e[1],it):[x[0],x[1]]},it.translateExtent=function($e){return arguments.length?(S[0][0]=+$e[0][0],S[1][0]=+$e[1][0],S[0][1]=+$e[0][1],S[1][1]=+$e[1][1],it):[[S[0][0],S[0][1]],[S[1][0],S[1][1]]]},it.constrain=function($e){return arguments.length?(n=$e,it):n},it.duration=function($e){return arguments.length?(a=+$e,it):a},it.interpolate=function($e){return arguments.length?(U=$e,it):U},it.on=function(){var $e=W.on.apply(W,arguments);return $e===W?it:$e},it.clickDistance=function($e){return arguments.length?(st=($e=+$e)*$e,it):Math.sqrt(st)},it.tapDistance=function($e){return arguments.length?(Ye=+$e,it):Ye},it}var KS="1.13.6",Ub=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},r1=Array.prototype,a2=Object.prototype,Gb=typeof Symbol<"u"?Symbol.prototype:null,WR=r1.push,Dg=r1.slice,xg=a2.toString,$R=a2.hasOwnProperty,JS=typeof ArrayBuffer<"u",XR=typeof DataView<"u",YR=Array.isArray,qb=Object.keys,Hb=Object.create,jb=JS&&ArrayBuffer.isView,KR=isNaN,JR=isFinite,e4=!{toString:null}.propertyIsEnumerable("toString"),Zb=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],e7=Math.pow(2,53)-1;function jc(e,t){return t=t==null?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),c=Array(n),g=0;g<n;g++)c[g]=arguments[g+t];switch(t){case 0:return e.call(this,c);case 1:return e.call(this,arguments[0],c);case 2:return e.call(this,arguments[0],arguments[1],c)}var x=Array(t+1);for(g=0;g<t;g++)x[g]=arguments[g];return x[t]=c,e.apply(this,x)}}function fp(e){var t=typeof e;return t==="function"||t==="object"&&!!e}function t7(e){return e===null}function lp(e){return e===void 0}function t4(e){return e===!0||e===!1||xg.call(e)==="[object Boolean]"}function i7(e){return!!(e&&e.nodeType===1)}function sc(e){var t="[object "+e+"]";return function(n){return xg.call(n)===t}}const s1=sc("String"),i4=sc("Number"),n7=sc("Date"),r7=sc("RegExp"),s7=sc("Error"),n4=sc("Symbol"),r4=sc("ArrayBuffer");var s4=sc("Function"),a7=Ub.document&&Ub.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof a7!="function"&&(s4=function(e){return typeof e=="function"||!1});const nc=s4,a4=sc("Object");var o4=XR&&a4(new DataView(new ArrayBuffer(8))),o2=typeof Map<"u"&&a4(new Map),o7=sc("DataView");function l7(e){return e!=null&&nc(e.getInt8)&&r4(e.buffer)}const O_=o4?l7:o7,dp=YR||sc("Array");function H0(e,t){return e!=null&&$R.call(e,t)}var pv=sc("Arguments");(function(){pv(arguments)||(pv=function(e){return H0(e,"callee")})})();const l2=pv;function u7(e){return!n4(e)&&JR(e)&&!isNaN(parseFloat(e))}function l4(e){return i4(e)&&KR(e)}function u4(e){return function(){return e}}function c4(e){return function(t){var n=e(t);return typeof n=="number"&&n>=0&&n<=e7}}function h4(e){return function(t){return t==null?void 0:t[e]}}const N_=h4("byteLength"),c7=c4(N_);var h7=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function A7(e){return jb?jb(e)&&!O_(e):c7(e)&&h7.test(xg.call(e))}const A4=JS?A7:u4(!1),Zc=h4("length");function f7(e){for(var t={},n=e.length,c=0;c<n;++c)t[e[c]]=!0;return{contains:function(g){return t[g]===!0},push:function(g){return t[g]=!0,e.push(g)}}}function f4(e,t){t=f7(t);var n=Zb.length,c=e.constructor,g=nc(c)&&c.prototype||a2,x="constructor";for(H0(e,x)&&!t.contains(x)&&t.push(x);n--;)x=Zb[n],x in e&&e[x]!==g[x]&&!t.contains(x)&&t.push(x)}function pu(e){if(!fp(e))return[];if(qb)return qb(e);var t=[];for(var n in e)H0(e,n)&&t.push(n);return e4&&f4(e,t),t}function d7(e){if(e==null)return!0;var t=Zc(e);return typeof t=="number"&&(dp(e)||s1(e)||l2(e))?t===0:Zc(pu(e))===0}function d4(e,t){var n=pu(t),c=n.length;if(e==null)return!c;for(var g=Object(e),x=0;x<c;x++){var S=n[x];if(t[S]!==g[S]||!(S in g))return!1}return!0}function ho(e){if(e instanceof ho)return e;if(!(this instanceof ho))return new ho(e);this._wrapped=e}ho.VERSION=KS;ho.prototype.value=function(){return this._wrapped};ho.prototype.valueOf=ho.prototype.toJSON=ho.prototype.value;ho.prototype.toString=function(){return String(this._wrapped)};function Qb(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,N_(e))}var Wb="[object DataView]";function mv(e,t,n,c){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var g=typeof e;return g!=="function"&&g!=="object"&&typeof t!="object"?!1:p4(e,t,n,c)}function p4(e,t,n,c){e instanceof ho&&(e=e._wrapped),t instanceof ho&&(t=t._wrapped);var g=xg.call(e);if(g!==xg.call(t))return!1;if(o4&&g=="[object Object]"&&O_(e)){if(!O_(t))return!1;g=Wb}switch(g){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return Gb.valueOf.call(e)===Gb.valueOf.call(t);case"[object ArrayBuffer]":case Wb:return p4(Qb(e),Qb(t),n,c)}var x=g==="[object Array]";if(!x&&A4(e)){var S=N_(e);if(S!==N_(t))return!1;if(e.buffer===t.buffer&&e.byteOffset===t.byteOffset)return!0;x=!0}if(!x){if(typeof e!="object"||typeof t!="object")return!1;var a=e.constructor,U=t.constructor;if(a!==U&&!(nc(a)&&a instanceof a&&nc(U)&&U instanceof U)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],c=c||[];for(var W=n.length;W--;)if(n[W]===e)return c[W]===t;if(n.push(e),c.push(t),x){if(W=e.length,W!==t.length)return!1;for(;W--;)if(!mv(e[W],t[W],n,c))return!1}else{var he=pu(e),ae;if(W=he.length,pu(t).length!==W)return!1;for(;W--;)if(ae=he[W],!(H0(t,ae)&&mv(e[ae],t[ae],n,c)))return!1}return n.pop(),c.pop(),!0}function p7(e,t){return mv(e,t)}function Lg(e){if(!fp(e))return[];var t=[];for(var n in e)t.push(n);return e4&&f4(e,t),t}function u2(e){var t=Zc(e);return function(n){if(n==null)return!1;var c=Lg(n);if(Zc(c))return!1;for(var g=0;g<t;g++)if(!nc(n[e[g]]))return!1;return e!==_4||!nc(n[c2])}}var c2="forEach",m4="has",h2=["clear","delete"],g4=["get",m4,"set"],m7=h2.concat(c2,g4),_4=h2.concat(g4),g7=["add"].concat(h2,c2,m4);const _7=o2?u2(m7):sc("Map"),y7=o2?u2(_4):sc("WeakMap"),v7=o2?u2(g7):sc("Set"),x7=sc("WeakSet");function pp(e){for(var t=pu(e),n=t.length,c=Array(n),g=0;g<n;g++)c[g]=e[t[g]];return c}function b7(e){for(var t=pu(e),n=t.length,c=Array(n),g=0;g<n;g++)c[g]=[t[g],e[t[g]]];return c}function y4(e){for(var t={},n=pu(e),c=0,g=n.length;c<g;c++)t[e[n[c]]]=n[c];return t}function gv(e){var t=[];for(var n in e)nc(e[n])&&t.push(n);return t.sort()}function A2(e,t){return function(n){var c=arguments.length;if(t&&(n=Object(n)),c<2||n==null)return n;for(var g=1;g<c;g++)for(var x=arguments[g],S=e(x),a=S.length,U=0;U<a;U++){var W=S[U];(!t||n[W]===void 0)&&(n[W]=x[W])}return n}}const fA=A2(Lg),bg=A2(pu),f2=A2(Lg,!0);function w7(){return function(){}}function v4(e){if(!fp(e))return{};if(Hb)return Hb(e);var t=w7();t.prototype=e;var n=new t;return t.prototype=null,n}function S7(e,t){var n=v4(e);return t&&bg(n,t),n}function x4(e){return fp(e)?dp(e)?e.slice():fA({},e):e}function I7(e,t){return t(e),e}function b4(e){return dp(e)?e:[e]}ho.toPath=b4;function Bg(e){return ho.toPath(e)}function d2(e,t){for(var n=t.length,c=0;c<n;c++){if(e==null)return;e=e[t[c]]}return n?e:void 0}function w4(e,t,n){var c=d2(e,Bg(t));return lp(c)?n:c}function a1(e,t){t=Bg(t);for(var n=t.length,c=0;c<n;c++){var g=t[c];if(!H0(e,g))return!1;e=e[g]}return!!n}function p2(e){return e}function wg(e){return e=bg({},e),function(t){return d4(t,e)}}function m2(e){return e=Bg(e),function(t){return d2(t,e)}}function zg(e,t,n){if(t===void 0)return e;switch(n??3){case 1:return function(c){return e.call(t,c)};case 3:return function(c,g,x){return e.call(t,c,g,x)};case 4:return function(c,g,x,S){return e.call(t,c,g,x,S)}}return function(){return e.apply(t,arguments)}}function S4(e,t,n){return e==null?p2:nc(e)?zg(e,t,n):fp(e)&&!dp(e)?wg(e):m2(e)}function g2(e,t){return S4(e,t,1/0)}ho.iteratee=g2;function $c(e,t,n){return ho.iteratee!==g2?ho.iteratee(e,t):S4(e,t,n)}function I4(e,t,n){t=$c(t,n);for(var c=pu(e),g=c.length,x={},S=0;S<g;S++){var a=c[S];x[a]=t(e[a],a,e)}return x}function E4(){}function E7(e){return e==null?E4:function(t){return w4(e,t)}}function C7(e,t,n){var c=Array(Math.max(0,e));t=zg(t,n,1);for(var g=0;g<e;g++)c[g]=t(g);return c}function _v(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}const Sg=Date.now||function(){return new Date().getTime()};function C4(e){var t=function(x){return e[x]},n="(?:"+pu(e).join("|")+")",c=RegExp(n),g=RegExp(n,"g");return function(x){return x=x==null?"":""+x,c.test(x)?x.replace(g,t):x}}const T4={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},T7=C4(T4),k7=y4(T4),M7=C4(k7),P7=ho.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var iy=/(.)^/,D7={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},L7=/\\|'|\r|\n|\u2028|\u2029/g;function B7(e){return"\\"+D7[e]}var z7=/^\s*(\w|\$)+\s*$/;function R7(e,t,n){!t&&n&&(t=n),t=f2({},t,ho.templateSettings);var c=RegExp([(t.escape||iy).source,(t.interpolate||iy).source,(t.evaluate||iy).source].join("|")+"|$","g"),g=0,x="__p+='";e.replace(c,function(W,he,ae,ce,be){return x+=e.slice(g,be).replace(L7,B7),g=be+W.length,he?x+=`'+
((__t=(`+he+`))==null?'':_.escape(__t))+
'`:ae?x+=`'+
((__t=(`+ae+`))==null?'':__t)+
'`:ce&&(x+=`';
`+ce+`
__p+='`),W}),x+=`';
`;var S=t.variable;if(S){if(!z7.test(S))throw new Error("variable is not a bare identifier: "+S)}else x=`with(obj||{}){
`+x+`}
`,S="obj";x=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+x+`return __p;
`;var a;try{a=new Function(S,"_",x)}catch(W){throw W.source=x,W}var U=function(W){return a.call(this,W,ho)};return U.source="function("+S+`){
`+x+"}",U}function F7(e,t,n){t=Bg(t);var c=t.length;if(!c)return nc(n)?n.call(e):n;for(var g=0;g<c;g++){var x=e==null?void 0:e[t[g]];x===void 0&&(x=n,g=c),e=nc(x)?x.call(e):x}return e}var O7=0;function N7(e){var t=++O7+"";return e?e+t:t}function V7(e){var t=ho(e);return t._chain=!0,t}function k4(e,t,n,c,g){if(!(c instanceof t))return e.apply(n,g);var x=v4(e.prototype),S=e.apply(x,g);return fp(S)?S:x}var nf=jc(function(e,t){var n=nf.placeholder,c=function(){for(var g=0,x=t.length,S=Array(x),a=0;a<x;a++)S[a]=t[a]===n?arguments[g++]:t[a];for(;g<arguments.length;)S.push(arguments[g++]);return k4(e,c,this,this,S)};return c});nf.placeholder=ho;const M4=jc(function(e,t,n){if(!nc(e))throw new TypeError("Bind must be called on a function");var c=jc(function(g){return k4(e,c,t,this,n.concat(g))});return c}),_h=c4(Zc);function mp(e,t,n,c){if(c=c||[],!t&&t!==0)t=1/0;else if(t<=0)return c.concat(e);for(var g=c.length,x=0,S=Zc(e);x<S;x++){var a=e[x];if(_h(a)&&(dp(a)||l2(a)))if(t>1)mp(a,t-1,n,c),g=c.length;else for(var U=0,W=a.length;U<W;)c[g++]=a[U++];else n||(c[g++]=a)}return c}const U7=jc(function(e,t){t=mp(t,!1,!1);var n=t.length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var c=t[n];e[c]=M4(e[c],e)}return e});function G7(e,t){var n=function(c){var g=n.cache,x=""+(t?t.apply(this,arguments):c);return H0(g,x)||(g[x]=e.apply(this,arguments)),g[x]};return n.cache={},n}const P4=jc(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)}),q7=nf(P4,ho,1);function H7(e,t,n){var c,g,x,S,a=0;n||(n={});var U=function(){a=n.leading===!1?0:Sg(),c=null,S=e.apply(g,x),c||(g=x=null)},W=function(){var he=Sg();!a&&n.leading===!1&&(a=he);var ae=t-(he-a);return g=this,x=arguments,ae<=0||ae>t?(c&&(clearTimeout(c),c=null),a=he,S=e.apply(g,x),c||(g=x=null)):!c&&n.trailing!==!1&&(c=setTimeout(U,ae)),S};return W.cancel=function(){clearTimeout(c),a=0,c=g=x=null},W}function j7(e,t,n){var c,g,x,S,a,U=function(){var he=Sg()-g;t>he?c=setTimeout(U,t-he):(c=null,n||(S=e.apply(a,x)),c||(x=a=null))},W=jc(function(he){return a=this,x=he,g=Sg(),c||(c=setTimeout(U,t),n&&(S=e.apply(a,x))),S});return W.cancel=function(){clearTimeout(c),c=x=a=null},W}function Z7(e,t){return nf(t,e)}function _2(e){return function(){return!e.apply(this,arguments)}}function Q7(){var e=arguments,t=e.length-1;return function(){for(var n=t,c=e[t].apply(this,arguments);n--;)c=e[n].call(this,c);return c}}function W7(e,t){return function(){if(--e<1)return t.apply(this,arguments)}}function D4(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}}const $7=nf(D4,2);function L4(e,t,n){t=$c(t,n);for(var c=pu(e),g,x=0,S=c.length;x<S;x++)if(g=c[x],t(e[g],g,e))return g}function B4(e){return function(t,n,c){n=$c(n,c);for(var g=Zc(t),x=e>0?0:g-1;x>=0&&x<g;x+=e)if(n(t[x],x,t))return x;return-1}}const y2=B4(1),z4=B4(-1);function R4(e,t,n,c){n=$c(n,c,1);for(var g=n(t),x=0,S=Zc(e);x<S;){var a=Math.floor((x+S)/2);n(e[a])<g?x=a+1:S=a}return x}function F4(e,t,n){return function(c,g,x){var S=0,a=Zc(c);if(typeof x=="number")e>0?S=x>=0?x:Math.max(x+a,S):a=x>=0?Math.min(x+1,a):x+a+1;else if(n&&x&&a)return x=n(c,g),c[x]===g?x:-1;if(g!==g)return x=t(Dg.call(c,S,a),l4),x>=0?x+S:-1;for(x=e>0?S:a-1;x>=0&&x<a;x+=e)if(c[x]===g)return x;return-1}}const O4=F4(1,y2,R4),X7=F4(-1,z4);function yv(e,t,n){var c=_h(e)?y2:L4,g=c(e,t,n);if(g!==void 0&&g!==-1)return e[g]}function Y7(e,t){return yv(e,wg(t))}function Qc(e,t,n){t=zg(t,n);var c,g;if(_h(e))for(c=0,g=e.length;c<g;c++)t(e[c],c,e);else{var x=pu(e);for(c=0,g=x.length;c<g;c++)t(e[x[c]],x[c],e)}return e}function gc(e,t,n){t=$c(t,n);for(var c=!_h(e)&&pu(e),g=(c||e).length,x=Array(g),S=0;S<g;S++){var a=c?c[S]:S;x[S]=t(e[a],a,e)}return x}function N4(e){var t=function(n,c,g,x){var S=!_h(n)&&pu(n),a=(S||n).length,U=e>0?0:a-1;for(x||(g=n[S?S[U]:U],U+=e);U>=0&&U<a;U+=e){var W=S?S[U]:U;g=c(g,n[W],W,n)}return g};return function(n,c,g,x){var S=arguments.length>=3;return t(n,zg(c,x,4),g,S)}}const ny=N4(1),$b=N4(-1);function ph(e,t,n){var c=[];return t=$c(t,n),Qc(e,function(g,x,S){t(g,x,S)&&c.push(g)}),c}function V4(e,t,n){return ph(e,_2($c(t)),n)}function vv(e,t,n){t=$c(t,n);for(var c=!_h(e)&&pu(e),g=(c||e).length,x=0;x<g;x++){var S=c?c[x]:x;if(!t(e[S],S,e))return!1}return!0}function V_(e,t,n){t=$c(t,n);for(var c=!_h(e)&&pu(e),g=(c||e).length,x=0;x<g;x++){var S=c?c[x]:x;if(t(e[S],S,e))return!0}return!1}function JA(e,t,n,c){return _h(e)||(e=pp(e)),(typeof n!="number"||c)&&(n=0),O4(e,t,n)>=0}const K7=jc(function(e,t,n){var c,g;return nc(t)?g=t:(t=Bg(t),c=t.slice(0,-1),t=t[t.length-1]),gc(e,function(x){var S=g;if(!S){if(c&&c.length&&(x=d2(x,c)),x==null)return;S=x[t]}return S==null?S:S.apply(x,n)})});function o1(e,t){return gc(e,m2(t))}function J7(e,t){return ph(e,wg(t))}function v2(e,t,n){var c=-1/0,g=-1/0,x,S;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=_h(e)?e:pp(e);for(var a=0,U=e.length;a<U;a++)x=e[a],x!=null&&x>c&&(c=x)}else t=$c(t,n),Qc(e,function(W,he,ae){S=t(W,he,ae),(S>g||S===-1/0&&c===-1/0)&&(c=W,g=S)});return c}function U4(e,t,n){var c=1/0,g=1/0,x,S;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=_h(e)?e:pp(e);for(var a=0,U=e.length;a<U;a++)x=e[a],x!=null&&x<c&&(c=x)}else t=$c(t,n),Qc(e,function(W,he,ae){S=t(W,he,ae),(S<g||S===1/0&&c===1/0)&&(c=W,g=S)});return c}var e9=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function G4(e){return e?dp(e)?Dg.call(e):s1(e)?e.match(e9):_h(e)?gc(e,p2):pp(e):[]}function q4(e,t,n){if(t==null||n)return _h(e)||(e=pp(e)),e[_v(e.length-1)];var c=G4(e),g=Zc(c);t=Math.max(Math.min(t,g),0);for(var x=g-1,S=0;S<t;S++){var a=_v(S,x),U=c[S];c[S]=c[a],c[a]=U}return c.slice(0,t)}function t9(e){return q4(e,1/0)}function H4(e,t,n){var c=0;return t=$c(t,n),o1(gc(e,function(g,x,S){return{value:g,index:c++,criteria:t(g,x,S)}}).sort(function(g,x){var S=g.criteria,a=x.criteria;if(S!==a){if(S>a||S===void 0)return 1;if(S<a||a===void 0)return-1}return g.index-x.index}),"value")}function l1(e,t){return function(n,c,g){var x=t?[[],[]]:{};return c=$c(c,g),Qc(n,function(S,a){var U=c(S,a,n);e(x,S,U)}),x}}const i9=l1(function(e,t,n){H0(e,n)?e[n].push(t):e[n]=[t]}),n9=l1(function(e,t,n){e[n]=t}),r9=l1(function(e,t,n){H0(e,n)?e[n]++:e[n]=1}),s9=l1(function(e,t,n){e[n?0:1].push(t)},!0);function a9(e){return e==null?0:_h(e)?e.length:pu(e).length}function o9(e,t,n){return t in n}const x2=jc(function(e,t){var n={},c=t[0];if(e==null)return n;nc(c)?(t.length>1&&(c=zg(c,t[1])),t=Lg(e)):(c=o9,t=mp(t,!1,!1),e=Object(e));for(var g=0,x=t.length;g<x;g++){var S=t[g],a=e[S];c(a,S,e)&&(n[S]=a)}return n}),l9=jc(function(e,t){var n=t[0],c;return nc(n)?(n=_2(n),t.length>1&&(c=t[1])):(t=gc(mp(t,!1,!1),String),n=function(g,x){return!JA(t,x)}),x2(e,n,c)});function j4(e,t,n){return Dg.call(e,0,Math.max(0,e.length-(t==null||n?1:t)))}function ry(e,t,n){return e==null||e.length<1?t==null||n?void 0:[]:t==null||n?e[0]:j4(e,e.length-t)}function Jd(e,t,n){return Dg.call(e,t==null||n?1:t)}function u9(e,t,n){return e==null||e.length<1?t==null||n?void 0:[]:t==null||n?e[e.length-1]:Jd(e,Math.max(0,e.length-t))}function Z4(e){return ph(e,Boolean)}function c9(e,t){return mp(e,t,!1)}const Q4=jc(function(e,t){return t=mp(t,!0,!0),ph(e,function(n){return!JA(t,n)})}),h9=jc(function(e,t){return Q4(e,t)});function xv(e,t,n,c){t4(t)||(c=n,n=t,t=!1),n!=null&&(n=$c(n,c));for(var g=[],x=[],S=0,a=Zc(e);S<a;S++){var U=e[S],W=n?n(U,S,e):U;t&&!n?((!S||x!==W)&&g.push(U),x=W):n?JA(x,W)||(x.push(W),g.push(U)):JA(g,U)||g.push(U)}return g}const W4=jc(function(e){return xv(mp(e,!0,!0))});function $4(e){for(var t=[],n=arguments.length,c=0,g=Zc(e);c<g;c++){var x=e[c];if(!JA(t,x)){var S;for(S=1;S<n&&JA(arguments[S],x);S++);S===n&&t.push(x)}}return t}function bv(e){for(var t=e&&v2(e,Zc).length||0,n=Array(t),c=0;c<t;c++)n[c]=o1(e,c);return n}const A9=jc(bv);function o_(e,t){for(var n={},c=0,g=Zc(e);c<g;c++)t?n[e[c]]=t[c]:n[e[c][0]]=e[c][1];return n}function f9(e,t,n){t==null&&(t=e||0,e=0),n||(n=t<e?-1:1);for(var c=Math.max(Math.ceil((t-e)/n),0),g=Array(c),x=0;x<c;x++,e+=n)g[x]=e;return g}function d9(e,t){if(t==null||t<1)return[];for(var n=[],c=0,g=e.length;c<g;)n.push(Dg.call(e,c,c+=t));return n}function b2(e,t){return e._chain?ho(t).chain():t}function X4(e){return Qc(gv(e),function(t){var n=ho[t]=e[t];ho.prototype[t]=function(){var c=[this._wrapped];return WR.apply(c,arguments),b2(this,n.apply(ho,c))}}),ho}Qc(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r1[e];ho.prototype[e]=function(){var n=this._wrapped;return n!=null&&(t.apply(n,arguments),(e==="shift"||e==="splice")&&n.length===0&&delete n[0]),b2(this,n)}});Qc(["concat","join","slice"],function(e){var t=r1[e];ho.prototype[e]=function(){var n=this._wrapped;return n!=null&&(n=t.apply(n,arguments)),b2(this,n)}});const p9=Object.freeze(Object.defineProperty({__proto__:null,VERSION:KS,after:W7,all:vv,allKeys:Lg,any:V_,assign:bg,before:D4,bind:M4,bindAll:U7,chain:V7,chunk:d9,clone:x4,collect:gc,compact:Z4,compose:Q7,constant:u4,contains:JA,countBy:r9,create:S7,debounce:j7,default:ho,defaults:f2,defer:q7,delay:P4,detect:yv,difference:Q4,drop:Jd,each:Qc,escape:T7,every:vv,extend:fA,extendOwn:bg,filter:ph,find:yv,findIndex:y2,findKey:L4,findLastIndex:z4,findWhere:Y7,first:ry,flatten:c9,foldl:ny,foldr:$b,forEach:Qc,functions:gv,get:w4,groupBy:i9,has:a1,head:ry,identity:p2,include:JA,includes:JA,indexBy:n9,indexOf:O4,initial:j4,inject:ny,intersection:$4,invert:y4,invoke:K7,isArguments:l2,isArray:dp,isArrayBuffer:r4,isBoolean:t4,isDataView:O_,isDate:n7,isElement:i7,isEmpty:d7,isEqual:p7,isError:s7,isFinite:u7,isFunction:nc,isMap:_7,isMatch:d4,isNaN:l4,isNull:t7,isNumber:i4,isObject:fp,isRegExp:r7,isSet:v7,isString:s1,isSymbol:n4,isTypedArray:A4,isUndefined:lp,isWeakMap:y7,isWeakSet:x7,iteratee:g2,keys:pu,last:u9,lastIndexOf:X7,map:gc,mapObject:I4,matcher:wg,matches:wg,max:v2,memoize:G7,methods:gv,min:U4,mixin:X4,negate:_2,noop:E4,now:Sg,object:o_,omit:l9,once:$7,pairs:b7,partial:nf,partition:s9,pick:x2,pluck:o1,property:m2,propertyOf:E7,random:_v,range:f9,reduce:ny,reduceRight:$b,reject:V4,rest:Jd,restArguments:jc,result:F7,sample:q4,select:ph,shuffle:t9,size:a9,some:V_,sortBy:H4,sortedIndex:R4,tail:Jd,take:ry,tap:I7,template:R7,templateSettings:P7,throttle:H7,times:C7,toArray:G4,toPath:b4,transpose:bv,unescape:M7,union:W4,uniq:xv,unique:xv,uniqueId:N7,unzip:bv,values:pp,where:J7,without:h9,wrap:Z7,zip:A9},Symbol.toStringTag,{value:"Module"}));var Xb=X4(p9);Xb._=Xb;var m9=function(e,t){var n;return parseString(e,function(c,g){n=g["nex:nexml"].trees[0].tree.map(function(x){var S=x.node.map(ae=>ae.$),a=S.reduce(function(ae,ce){return ce.edges=[],ce.name=ce.id,ae[ce.id]=ce,ae},{}),U=S.filter(ae=>ae.root),W=U>0?U[0].id:S[0].id;a[W].name="root",x.edge.map(ae=>ae.$).forEach(function(ae){a[ae.source].edges.push(ae)});function he(ae,ce){if(ae.edges){var be=o1(ae.edges,"target");ae.children=pp(x2(a,be)),ae.children.forEach(function(Je,st){Je.attribute=ae.edges[st].length||""}),ae.children.forEach(he),ae.annotation=""}}return he(a[W]),a[W]})}),n};function g9(e,t,n,c){let g=this.nodes.descendants();if(e.parent&&g.indexOf(e)>=0){let S=e.parent.children.indexOf(e),a={name:n,parent:e.parent,attribute:c?c[2]:null,original_child_order:e.original_child_order},U={name:t,parent:a,attribute:c?c[1]:null,original_child_order:2};a.children=[e,U],e.parent.children[S]=a,e.parent=a,e.attribute=c?c[0]:null,e.original_child_order=1}return this}function _9(e,t){return e.children?e.children.push(t):e.children=[t],e}function y9(e,t){return{data:{name:e,attribute:t?t[1]:null},parent:""}}function v9(e){let t=this.nodes.descendants();if(typeof e!="number")return this.deleteANode(t.indexOf(e));if(e>0&&e<t.length){let n=t[e];if(n.parent){let c=n.parent.children.indexOf(n);c>=0&&(t.splice(e,1),n.children&&n.children.forEach(function(g){g.original_child_order=n.parent.children.length,n.parent.children.push(g),g.parent=n.parent}),n.parent.children.length>2?n.parent.children.splice(c,1):n.parent.parent?(n.parent.parent.children[n.parent.parent.children.indexOf(n.parent)]=n.parent.children[1-c],n.parent.children[1-c].parent=n.parent.parent,t.splice(t.indexOf(n.parent),1)):(t.splice(0,1),t.parent=null,delete t.data.attribute,delete t.data.annotation,delete t.data.original_child_order,t.name="root",t.data.name="root"))}}return this}function x9(){return ph(this.nodes.descendants(),e=>!a1(e,"children"))}function b9(){return ph(this.nodes.descendants(),e=>a1(e,"children"))}function w9(){return this.nodes}function S9(){return this.nodes}function I9(e){return ph(this.nodes.descendants(),t=>t.data.name==e)[0]}function E9(e){Qc(this.nodes.descendants(),function(t){t.data&&t.data.name in e&&(t.annotations=e[t.data.name])})}function Sl(e){return!a1(e,"children")}function C9(e,t){return this.nodes.each(function(n){e in n&&(t&&(n[t]=n[e]),delete n[e])}),this}function T9(e){e||this.nodes.each(t=>{Sl(t)||(t[this.selection_attribute_name]=!1,t.data.traits||(t.data.traits={}),t.data.traits[this.selection_attribute_name]=t[this.selection_attribute_name])})}function Y4(e,t,n){let c=[];function g(x){Sl(x)?t&&x!=e&&c.push(x):(n&&x!=e&&c.push(x),x.children.forEach(g))}return g(e),c}const k9=Object.freeze(Object.defineProperty({__proto__:null,addChild:_9,assignAttributes:E9,clearInternalNodes:T9,createNode:y9,deleteANode:v9,getInternals:b9,getNodeByName:I9,getNodes:S9,getRootNode:w9,getTips:x9,graftANode:g9,isLeafNode:Sl,selectAllDescendants:Y4,updateKeyName:C9},Symbol.toStringTag,{value:"Module"}));function Ig(e,t={}){const n=/^-?\d+(\.\d+)?$/;let c=t.left_delimiter||"{",g=t.right_delimiter||"}",x=[];function S(){let Tt={name:null},zt=x[x.length-1];"children"in zt||(zt.children=[]),x.push(Tt),zt.children.push(x[x.length-1]),x[x.length-1].original_child_order=zt.children.length}function a(){let Tt=x.pop();Tt.name=he,"children"in Tt?Tt.bootstrap_values=he:Tt.name=he,Tt.attribute=ae,c=="["&&ce.includes("&&NHX")?ce.split(":").slice(1).forEach(zt=>{const[Rt,Oe]=zt.split("=");Tt[Rt]=n.test(Oe)?+Oe:Oe}):Tt.annotation=ce,he="",ae="",ce=""}function U(Tt){return{json:null,error:"Unexpected '"+e[Tt]+"' in '"+e.substring(Tt-20,Tt+1)+"[ERROR HERE]"+e.substring(Tt+1,Tt+20)+"'"}}let W=0,he="",ae="",ce="",be=null,Je={"'":1,'"':1},st={name:"root"};x.push(st);for(var Ye=/\s/,it=0;it<e.length;it++)try{var ct=e[it];switch(W){case 0:{ct=="("&&(S(),W=1);break}case 1:case 3:{if(ct==":")W=3;else if(ct==","||ct==")")try{a(),W=1,ct==","&&S()}catch{return U(it)}else if(ct=="("){if(he.length>0)return U(it);S()}else if(ct in Je){if(W==1&&he.length===0&&ae.length===0&&ce.length===0){W=2,be=ct;continue}return U(it)}else if(ct==c){if(ce.length)return U(it);W=4}else if(W==3)ae+=ct;else{if(Ye.test(ct))continue;if(ct==";"){it=e.length;break}he+=ct}break}case 2:{if(ct==be){if(it<e.length-1&&e[it+1]==be){it++,he+=be;continue}be=0,W=1;continue}else he+=ct;break}case 4:{if(ct==g)W=3;else{if(ct==c)return U(it);ce+=ct}break}}}catch{return U(it)}return x.length!=1?U(e.length-1):{json:st,error:null}}function M9(e,t){let n=this;e||(e=x=>"");function c(x){if(x.notshown)return;if(Sl(x)||(g.push("("),x.children.forEach(function(a,U){U&&g.push(","),c(a)}),g.push(")")),x.data.name!=="root"){const a=x.data.name.replaceAll("'","''");/\W/.test(a)?g.push("'"+a+"'"):g.push(a)}g.push(e(x));let S=n.branch_length_accessor(x);S!==void 0&&g.push(":"+S)}let g=[];return e=e||"",c(t||this.nodes),g.join("")+";"}function P9(e){let t=e,n=t.toUpperCase().indexOf("BEGIN DATA;"),c=t.slice(n);if(c.length<2)return"";n=c.toUpperCase().indexOf("END;");let g=c.slice(0,n);c=gc(g.split(";"),U=>U.trim());let x=ph(c,U=>U.toUpperCase().startsWith("DIMENSION"));x=x[0].split(" "),x=o_(gc(Jd(x),U=>U.split("=")));let S=ph(c,U=>U.toUpperCase().startsWith("FORMAT"));S=S[0].split(" "),S=o_(gc(Jd(S),U=>U.split("="))),S.symbols=V4(S.symbols.split(""),U=>U=='"');let a=ph(c,U=>U.toUpperCase().startsWith("MATRIX"));return a=a[0].split(`
`),a=o_(gc(Jd(a),U=>Z4(U.split(" ")))),a=I4(a,(U,W)=>U=="?"?S.symbols:Array(U)),{dimensions:x,format:S,matrix:a}}function D9(e,t,n){Qc(e.getTips(),c=>{c.data.test=n.matrix[c.data.name]})}function K4(e){let t=e,n=t.toUpperCase().indexOf("BEGIN TREES;"),c=t.slice(n);if(c.length<2)return"";n=c.toUpperCase().indexOf("END;");let x=c.slice(0,n).split(`
`);return x=ph(x,S=>S.trim().toUpperCase().startsWith("TREE")),Ig(x[0])}const L9=Object.freeze(Object.defineProperty({__proto__:null,default:K4,loadAnnotations:D9,parseAnnotations:P9},Symbol.toStringTag,{value:"Module"}));function wv(e){var t={};if(e.nodeType==1){if(e.attributes.length>0){t["@attributes"]={};for(var n=0;n<e.attributes.length;n++){var c=e.attributes.item(n);t["@attributes"][c.nodeName]=c.nodeValue}}}else e.nodeType==3&&(t=e.nodeValue);if(e.hasChildNodes()&&e.childNodes.length===1&&e.childNodes[0].nodeType===3)t=e.childNodes[0].nodeValue;else if(e.hasChildNodes())for(var g=0;g<e.childNodes.length;g++){var x=e.childNodes.item(g),S=x.nodeName;if(typeof t[S]>"u")t[S]=wv(x);else{if(typeof t[S].push>"u"){var a=t[S];t[S]=[],t[S].push(a)}t[S].push(wv(x))}}return t}var J4=function(e,t){function n(g,x){g.clade&&(g.clade.forEach(n),g.children=g.clade,delete g.clade),g.annotation=1,g.attribute="0.01",g.branch_length&&(g.attribute=g.branch_length),g.taxonomy&&(g.name=g.taxonomy.scientific_name),g.annotation=""}var c;return e=wv(e),c=e.phyloxml.phylogeny.clade,c.name="root",n(c),{json:c,error:null}};function B9(e,t){t.left_delimiter="[",t.right_delimiter="]";const n=Ig(e,t);function c(g){if(g.annotation){g.beast={};const S=g.annotation.split(/=|,|{|}/).filter(a=>a);for(var x=0;x<S.length;x+=2){let a=S[x].replace(/&|%/g,"");/[a-df-zA-DF-Z]+/.test(S[x+2])?g.beast[a]=+S[x+1]:(g.beast[a]=[+S[x+1],+S[x+2]],x++)}}g.annotation=void 0,g.children&&g.children.forEach(c)}return c(n.json),n}var sy={nexml:m9,phyloxml:J4,nexus:K4,nwk:Ig,nhx:Ig,beast:B9};function z9(){let t=this.getTips(),n=gc(t,c=>({name:c.data.name,length:parseFloat(c.data.attribute)}));return n=H4(n,c=>-c.length),n}function R9(e,t){function n(g,x){if(x.mp=[[0,0],[!1,!1]],Sl(x))x.mp[1][0]=x.mp[1][1]=x[g]||!1,x.mp[0][0]=x.mp[1][0]?1:0,x.mp[0][1]=1-x.mp[0][0];else{x.children.forEach(c);var S=x.children.reduce(function(U,W){return W.mp[0][0]+U},0),a=x.children.reduce(function(U,W){return W.mp[0][1]+U},0);x[g]?(x.mp[0][0]=a+1,x.mp[1][0]=!0,x.mp[0][1]=a,x.mp[1][1]=!0):(S<a+1?(x.mp[0][0]=S,x.mp[1][0]=!1):(x.mp[0][0]=a+1,x.mp[1][0]=!0),a<S+1?(x.mp[0][1]=a,x.mp[1][1]=!0):(x.mp[0][1]=S+1,x.mp[1][1]=!1))}}const c=nf(n,t);c(this.nodes),this.nodes.each(g=>{g.parent?g.mp=g.mp[1][g.parent.mp?1:0]:g.mp=g.mp[1][g.mp[0][0]<g.mp[0][1]?0:1]}),this.display.modifySelection((g,x)=>Sl(g.target)?g.target[t]:g.target.mp)}var U_={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */U_.exports;(function(e,t){(function(){var n,c="4.17.21",g=200,x="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",S="Expected a function",a="Invalid `variable` option passed into `_.template`",U="__lodash_hash_undefined__",W=500,he="__lodash_placeholder__",ae=1,ce=2,be=4,Je=1,st=2,Ye=1,it=2,ct=4,Tt=8,zt=16,Rt=32,Oe=64,jt=128,at=256,_t=512,mt=30,xt="...",bt=800,lt=16,$e=1,pt=2,ut=3,Nt=1/0,Bt=9007199254740991,Ot=17976931348623157e292,gi=NaN,Ii=4294967295,Ci=Ii-1,Ri=Ii>>>1,Ki=[["ary",jt],["bind",Ye],["bindKey",it],["curry",Tt],["curryRight",zt],["flip",_t],["partial",Rt],["partialRight",Oe],["rearg",at]],Hi="[object Arguments]",Ni="[object Array]",nn="[object AsyncFunction]",vn="[object Boolean]",Ei="[object Date]",mi="[object DOMException]",zi="[object Error]",Oi="[object Function]",xn="[object GeneratorFunction]",bn="[object Map]",Yt="[object Number]",rn="[object Null]",Xt="[object Object]",Ji="[object Promise]",mr="[object Proxy]",ci="[object RegExp]",sn="[object Set]",lr="[object String]",On="[object Symbol]",Gn="[object Undefined]",pn="[object WeakMap]",v="[object WeakSet]",k="[object ArrayBuffer]",V="[object DataView]",Y="[object Float32Array]",te="[object Float64Array]",fe="[object Int8Array]",ve="[object Int16Array]",Ie="[object Int32Array]",Ee="[object Uint8Array]",ze="[object Uint8ClampedArray]",Qe="[object Uint16Array]",He="[object Uint32Array]",Ze=/\b__p \+= '';/g,Ue=/\b(__p \+=) '' \+/g,dt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,rt=/&(?:amp|lt|gt|quot|#39);/g,Me=/[&<>"']/g,se=RegExp(rt.source),ne=RegExp(Me.source),$=/<%-([\s\S]+?)%>/g,ie=/<%([\s\S]+?)%>/g,de=/<%=([\s\S]+?)%>/g,ye=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ge=/^\w*$/,Pe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Fe=/[\\^$.*+?()[\]{}|]/g,Ve=RegExp(Fe.source),Xe=/^\s+/,Ke=/\s/,De=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ge=/\{\n\/\* \[wrapped with (.+)\] \*/,At=/,? & /,kt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,o=/[()=,{}\[\]\/\s]/,ke=/\\(\\)?/g,oi=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,fi=/\w*$/,Ai=/^[-+]0x[0-9a-f]+$/i,ti=/^0b[01]+$/i,li=/^\[object .+?Constructor\]$/,Bi=/^0o[0-7]+$/i,vi=/^(?:0|[1-9]\d*)$/,bi=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Jt=/($^)/,wn=/['\n\r\u2028\u2029\\]/g,ar="\\ud800-\\udfff",mn="\\u0300-\\u036f",Hn="\\ufe20-\\ufe2f",jr="\\u20d0-\\u20ff",ji=mn+Hn+jr,ur="\\u2700-\\u27bf",Vn="a-z\\xdf-\\xf6\\xf8-\\xff",Wt="\\xac\\xb1\\xd7\\xf7",Yi="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ut="\\u2000-\\u206f",Tn=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",cr="A-Z\\xc0-\\xd6\\xd8-\\xde",Vs="\\ufe0e\\ufe0f",Ur=Wt+Yi+Ut+Tn,Vt="[']",hr="["+ar+"]",Dt="["+Ur+"]",Fr="["+ji+"]",Us="\\d+",ca="["+ur+"]",Dr="["+Vn+"]",Ua="[^"+ar+Ur+Us+ur+Vn+cr+"]",Fo="\\ud83c[\\udffb-\\udfff]",Ga="(?:"+Fr+"|"+Fo+")",Xs="[^"+ar+"]",Qn="(?:\\ud83c[\\udde6-\\uddff]){2}",aa="[\\ud800-\\udbff][\\udc00-\\udfff]",hs="["+cr+"]",qa="\\u200d",al="(?:"+Dr+"|"+Ua+")",ol="(?:"+hs+"|"+Ua+")",no="(?:"+Vt+"(?:d|ll|m|re|s|t|ve))?",Ha="(?:"+Vt+"(?:D|LL|M|RE|S|T|VE))?",N=Ga+"?",xe="["+Vs+"]?",nt="(?:"+qa+"(?:"+[Xs,Qn,aa].join("|")+")"+xe+N+")*",It="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",$t="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",wi=xe+N+nt,Di="(?:"+[ca,Qn,aa].join("|")+")"+wi,hn="(?:"+[Xs+Fr+"?",Fr,Qn,aa,hr].join("|")+")",dn=RegExp(Vt,"g"),rr=RegExp(Fr,"g"),Ar=RegExp(Fo+"(?="+Fo+")|"+hn+wi,"g"),Or=RegExp([hs+"?"+Dr+"+"+no+"(?="+[Dt,hs,"$"].join("|")+")",ol+"+"+Ha+"(?="+[Dt,hs+al,"$"].join("|")+")",hs+"?"+al+"+"+no,hs+"+"+Ha,$t,It,Us,Di].join("|"),"g"),ja=RegExp("["+qa+ar+ji+Vs+"]"),Za=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Qa=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],pl=-1,Gr={};Gr[Y]=Gr[te]=Gr[fe]=Gr[ve]=Gr[Ie]=Gr[Ee]=Gr[ze]=Gr[Qe]=Gr[He]=!0,Gr[Hi]=Gr[Ni]=Gr[k]=Gr[vn]=Gr[V]=Gr[Ei]=Gr[zi]=Gr[Oi]=Gr[bn]=Gr[Yt]=Gr[Xt]=Gr[ci]=Gr[sn]=Gr[lr]=Gr[pn]=!1;var ir={};ir[Hi]=ir[Ni]=ir[k]=ir[V]=ir[vn]=ir[Ei]=ir[Y]=ir[te]=ir[fe]=ir[ve]=ir[Ie]=ir[bn]=ir[Yt]=ir[Xt]=ir[ci]=ir[sn]=ir[lr]=ir[On]=ir[Ee]=ir[ze]=ir[Qe]=ir[He]=!0,ir[zi]=ir[Oi]=ir[pn]=!1;var Er={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Lr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Zs={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},xr={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ks=parseFloat,Br=parseInt,To=typeof Jf=="object"&&Jf&&Jf.Object===Object&&Jf,Zo=typeof self=="object"&&self&&self.Object===Object&&self,Bs=To||Zo||Function("return this")(),Il=t&&!t.nodeType&&t,mo=Il&&!0&&e&&!e.nodeType&&e,Qo=mo&&mo.exports===Il,ha=Qo&&To.process,Ys=function(){try{var pi=mo&&mo.require&&mo.require("util").types;return pi||ha&&ha.binding&&ha.binding("util")}catch{}}(),El=Ys&&Ys.isArrayBuffer,Wa=Ys&&Ys.isDate,Ma=Ys&&Ys.isMap,ml=Ys&&Ys.isRegExp,Cl=Ys&&Ys.isSet,mu=Ys&&Ys.isTypedArray;function As(pi,Vi,Pi){switch(Pi.length){case 0:return pi.call(Vi);case 1:return pi.call(Vi,Pi[0]);case 2:return pi.call(Vi,Pi[0],Pi[1]);case 3:return pi.call(Vi,Pi[0],Pi[1],Pi[2])}return pi.apply(Vi,Pi)}function ac(pi,Vi,Pi,Ft){for(var ni=-1,xi=pi==null?0:pi.length;++ni<xi;){var Fi=pi[ni];Vi(Ft,Fi,Pi(Fi),pi)}return Ft}function ro(pi,Vi){for(var Pi=-1,Ft=pi==null?0:pi.length;++Pi<Ft&&Vi(pi[Pi],Pi,pi)!==!1;);return pi}function so(pi,Vi){for(var Pi=pi==null?0:pi.length;Pi--&&Vi(pi[Pi],Pi,pi)!==!1;);return pi}function Wl(pi,Vi){for(var Pi=-1,Ft=pi==null?0:pi.length;++Pi<Ft;)if(!Vi(pi[Pi],Pi,pi))return!1;return!0}function Oo(pi,Vi){for(var Pi=-1,Ft=pi==null?0:pi.length,ni=0,xi=[];++Pi<Ft;){var Fi=pi[Pi];Vi(Fi,Pi,pi)&&(xi[ni++]=Fi)}return xi}function Wo(pi,Vi){var Pi=pi==null?0:pi.length;return!!Pi&&Ko(pi,Vi,0)>-1}function ko(pi,Vi,Pi){for(var Ft=-1,ni=pi==null?0:pi.length;++Ft<ni;)if(Pi(Vi,pi[Ft]))return!0;return!1}function Gs(pi,Vi){for(var Pi=-1,Ft=pi==null?0:pi.length,ni=Array(Ft);++Pi<Ft;)ni[Pi]=Vi(pi[Pi],Pi,pi);return ni}function $o(pi,Vi){for(var Pi=-1,Ft=Vi.length,ni=pi.length;++Pi<Ft;)pi[ni+Pi]=Vi[Pi];return pi}function Xo(pi,Vi,Pi,Ft){var ni=-1,xi=pi==null?0:pi.length;for(Ft&&xi&&(Pi=pi[++ni]);++ni<xi;)Pi=Vi(Pi,pi[ni],ni,pi);return Pi}function Yo(pi,Vi,Pi,Ft){var ni=pi==null?0:pi.length;for(Ft&&ni&&(Pi=pi[--ni]);ni--;)Pi=Vi(Pi,pi[ni],ni,pi);return Pi}function Sa(pi,Vi){for(var Pi=-1,Ft=pi==null?0:pi.length;++Pi<Ft;)if(Vi(pi[Pi],Pi,pi))return!0;return!1}var $a=fr("length");function ks(pi){return pi.split("")}function gu(pi){return pi.match(kt)||[]}function Cr(pi,Vi,Pi){var Ft;return Pi(pi,function(ni,xi,Fi){if(Vi(ni,xi,Fi))return Ft=xi,!1}),Ft}function $n(pi,Vi,Pi,Ft){for(var ni=pi.length,xi=Pi+(Ft?1:-1);Ft?xi--:++xi<ni;)if(Vi(pi[xi],xi,pi))return xi;return-1}function Ko(pi,Vi,Pi){return Vi===Vi?Nr(pi,Vi,Pi):$n(pi,Xa,Pi)}function zr(pi,Vi,Pi,Ft){for(var ni=Pi-1,xi=pi.length;++ni<xi;)if(Ft(pi[ni],Vi))return ni;return-1}function Xa(pi){return pi!==pi}function is(pi,Vi){var Pi=pi==null?0:pi.length;return Pi?ns(pi,Vi)/Pi:gi}function fr(pi){return function(Vi){return Vi==null?n:Vi[pi]}}function Mo(pi){return function(Vi){return pi==null?n:pi[Vi]}}function qn(pi,Vi,Pi,Ft,ni){return ni(pi,function(xi,Fi,Ln){Pi=Ft?(Ft=!1,xi):Vi(Pi,xi,Fi,Ln)}),Pi}function Ol(pi,Vi){var Pi=pi.length;for(pi.sort(Vi);Pi--;)pi[Pi]=pi[Pi].value;return pi}function ns(pi,Vi){for(var Pi,Ft=-1,ni=pi.length;++Ft<ni;){var xi=Vi(pi[Ft]);xi!==n&&(Pi=Pi===n?xi:Pi+xi)}return Pi}function Zr(pi,Vi){for(var Pi=-1,Ft=Array(pi);++Pi<pi;)Ft[Pi]=Vi(Pi);return Ft}function Ms(pi,Vi){return Gs(Vi,function(Pi){return[Pi,pi[Pi]]})}function Mr(pi){return pi&&pi.slice(0,Ea(pi)+1).replace(Xe,"")}function nr(pi){return function(Vi){return pi(Vi)}}function ll(pi,Vi){return Gs(Vi,function(Pi){return pi[Pi]})}function Xr(pi,Vi){return pi.has(Vi)}function Po(pi,Vi){for(var Pi=-1,Ft=pi.length;++Pi<Ft&&Ko(Vi,pi[Pi],0)>-1;);return Pi}function ul(pi,Vi){for(var Pi=pi.length;Pi--&&Ko(Vi,pi[Pi],0)>-1;);return Pi}function Qr(pi,Vi){for(var Pi=pi.length,Ft=0;Pi--;)pi[Pi]===Vi&&++Ft;return Ft}var ds=Mo(Er),Ia=Mo(Lr);function Tl(pi){return"\\"+xr[pi]}function Do(pi,Vi){return pi==null?n:pi[Vi]}function kl(pi){return ja.test(pi)}function go(pi){return Za.test(pi)}function Js(pi){for(var Vi,Pi=[];!(Vi=pi.next()).done;)Pi.push(Vi.value);return Pi}function qs(pi){var Vi=-1,Pi=Array(pi.size);return pi.forEach(function(Ft,ni){Pi[++Vi]=[ni,Ft]}),Pi}function Ya(pi,Vi){return function(Pi){return pi(Vi(Pi))}}function Jo(pi,Vi){for(var Pi=-1,Ft=pi.length,ni=0,xi=[];++Pi<Ft;){var Fi=pi[Pi];(Fi===Vi||Fi===he)&&(pi[Pi]=he,xi[ni++]=Pi)}return xi}function Yr(pi){var Vi=-1,Pi=Array(pi.size);return pi.forEach(function(Ft){Pi[++Vi]=Ft}),Pi}function gr(pi){var Vi=-1,Pi=Array(pi.size);return pi.forEach(function(Ft){Pi[++Vi]=[Ft,Ft]}),Pi}function Nr(pi,Vi,Pi){for(var Ft=Pi-1,ni=pi.length;++Ft<ni;)if(pi[Ft]===Vi)return Ft;return-1}function Aa(pi,Vi,Pi){for(var Ft=Pi+1;Ft--;)if(pi[Ft]===Vi)return Ft;return Ft}function _o(pi){return kl(pi)?Ka(pi):$a(pi)}function ea(pi){return kl(pi)?cl(pi):ks(pi)}function Ea(pi){for(var Vi=pi.length;Vi--&&Ke.test(pi.charAt(Vi)););return Vi}var Pa=Mo(Zs);function Ka(pi){for(var Vi=Ar.lastIndex=0;Ar.test(pi);)++Vi;return Vi}function cl(pi){return pi.match(Ar)||[]}function lu(pi){return pi.match(Or)||[]}var gl=function pi(Vi){Vi=Vi==null?Bs:ao.defaults(Bs.Object(),Vi,ao.pick(Bs,Qa));var Pi=Vi.Array,Ft=Vi.Date,ni=Vi.Error,xi=Vi.Function,Fi=Vi.Math,Ln=Vi.Object,jn=Vi.RegExp,or=Vi.String,Xn=Vi.TypeError,Hs=Pi.prototype,Ps=xi.prototype,ps=Ln.prototype,Ja=Vi["__core-js_shared__"],yo=Ps.toString,os=ps.hasOwnProperty,$u=0,Fu=function(){var P=/[^.]+$/.exec(Ja&&Ja.keys&&Ja.keys.IE_PROTO||"");return P?"Symbol(src)_1."+P:""}(),vo=ps.toString,Ml=yo.call(Ln),Pn=Bs._,Da=jn("^"+yo.call(os).replace(Fe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),In=Qo?Vi.Buffer:n,No=Vi.Symbol,Nl=Vi.Uint8Array,En=In?In.allocUnsafe:n,$l=Ya(Ln.getPrototypeOf,Ln),Cn=Ln.create,_l=ps.propertyIsEnumerable,uu=Hs.splice,Ou=No?No.isConcatSpreadable:n,Vl=No?No.iterator:n,yl=No?No.toStringTag:n,ta=function(){try{var P=Jh(Ln,"defineProperty");return P({},"",{}),P}catch{}}(),oc=Vi.clearTimeout!==Bs.clearTimeout&&Vi.clearTimeout,Xu=Ft&&Ft.now!==Bs.Date.now&&Ft.now,Xl=Vi.setTimeout!==Bs.setTimeout&&Vi.setTimeout,ms=Fi.ceil,_a=Fi.floor,el=Ln.getOwnPropertySymbols,_u=In?In.isBuffer:n,Nu=Vi.isFinite,cu=Hs.join,Vu=Ya(Ln.keys,Ln),yr=Fi.max,gs=Fi.min,gn=Ft.now,Zn=Vi.parseInt,Jn=Fi.random,tl=Hs.reverse,Tu=Jh(Vi,"DataView"),oa=Jh(Vi,"Map"),yu=Jh(Vi,"Promise"),bs=Jh(Vi,"Set"),Lo=Jh(Vi,"WeakMap"),ki=Jh(Ln,"create"),Li=Lo&&new Lo,ws={},vu=ih(Tu),Vo=ih(oa),fs=ih(yu),hl=ih(bs),Ds=ih(Lo),C=No?No.prototype:n,D=C?C.valueOf:n,z=C?C.toString:n;function R(P){if(Lt(P)&&!f(P)&&!(P instanceof we)){if(P instanceof oe)return P;if(os.call(P,"__wrapped__"))return Ad(P)}return new oe(P)}var ee=function(){function P(){}return function(H){if(!Pt(H))return{};if(Cn)return Cn(H);P.prototype=H;var pe=new P;return P.prototype=n,pe}}();function le(){}function oe(P,H){this.__wrapped__=P,this.__actions__=[],this.__chain__=!!H,this.__index__=0,this.__values__=n}R.templateSettings={escape:$,evaluate:ie,interpolate:de,variable:"",imports:{_:R}},R.prototype=le.prototype,R.prototype.constructor=R,oe.prototype=ee(le.prototype),oe.prototype.constructor=oe;function we(P){this.__wrapped__=P,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ii,this.__views__=[]}function We(){var P=new we(this.__wrapped__);return P.__actions__=xl(this.__actions__),P.__dir__=this.__dir__,P.__filtered__=this.__filtered__,P.__iteratees__=xl(this.__iteratees__),P.__takeCount__=this.__takeCount__,P.__views__=xl(this.__views__),P}function yt(){if(this.__filtered__){var P=new we(this);P.__dir__=-1,P.__filtered__=!0}else P=this.clone(),P.__dir__*=-1;return P}function Ct(){var P=this.__wrapped__.value(),H=this.__dir__,pe=f(P),je=H<0,St=pe?P.length:0,qt=Pm(0,St,this.__views__),ui=qt.start,di=qt.end,Mi=di-ui,cn=je?di:ui-1,An=this.__iteratees__,yn=An.length,Yn=0,br=gs(Mi,this.__takeCount__);if(!pe||!je&&St==Mi&&br==Mi)return p0(P,this.__actions__);var Wr=[];e:for(;Mi--&&Yn<br;){cn+=H;for(var js=-1,$r=P[cn];++js<yn;){var sa=An[js],pa=sa.iteratee,Ah=sa.type,pc=pa($r);if(Ah==pt)$r=pc;else if(!pc){if(Ah==$e)continue e;break e}}Wr[Yn++]=$r}return Wr}we.prototype=ee(le.prototype),we.prototype.constructor=we;function ri(P){var H=-1,pe=P==null?0:P.length;for(this.clear();++H<pe;){var je=P[H];this.set(je[0],je[1])}}function Gt(){this.__data__=ki?ki(null):{},this.size=0}function Zt(P){var H=this.has(P)&&delete this.__data__[P];return this.size-=H?1:0,H}function Z(P){var H=this.__data__;if(ki){var pe=H[P];return pe===U?n:pe}return os.call(H,P)?H[P]:n}function A(P){var H=this.__data__;return ki?H[P]!==n:os.call(H,P)}function E(P,H){var pe=this.__data__;return this.size+=this.has(P)?0:1,pe[P]=ki&&H===n?U:H,this}ri.prototype.clear=Gt,ri.prototype.delete=Zt,ri.prototype.get=Z,ri.prototype.has=A,ri.prototype.set=E;function F(P){var H=-1,pe=P==null?0:P.length;for(this.clear();++H<pe;){var je=P[H];this.set(je[0],je[1])}}function O(){this.__data__=[],this.size=0}function y(P){var H=this.__data__,pe=ii(H,P);if(pe<0)return!1;var je=H.length-1;return pe==je?H.pop():uu.call(H,pe,1),--this.size,!0}function s(P){var H=this.__data__,pe=ii(H,P);return pe<0?n:H[pe][1]}function i(P){return ii(this.__data__,P)>-1}function r(P,H){var pe=this.__data__,je=ii(pe,P);return je<0?(++this.size,pe.push([P,H])):pe[je][1]=H,this}F.prototype.clear=O,F.prototype.delete=y,F.prototype.get=s,F.prototype.has=i,F.prototype.set=r;function l(P){var H=-1,pe=P==null?0:P.length;for(this.clear();++H<pe;){var je=P[H];this.set(je[0],je[1])}}function d(){this.size=0,this.__data__={hash:new ri,map:new(oa||F),string:new ri}}function _(P){var H=wf(this,P).delete(P);return this.size-=H?1:0,H}function w(P){return wf(this,P).get(P)}function T(P){return wf(this,P).has(P)}function B(P,H){var pe=wf(this,P),je=pe.size;return pe.set(P,H),this.size+=pe.size==je?0:1,this}l.prototype.clear=d,l.prototype.delete=_,l.prototype.get=w,l.prototype.has=T,l.prototype.set=B;function j(P){var H=-1,pe=P==null?0:P.length;for(this.__data__=new l;++H<pe;)this.add(P[H])}function X(P){return this.__data__.set(P,U),this}function ue(P){return this.__data__.has(P)}j.prototype.add=j.prototype.push=X,j.prototype.has=ue;function Se(P){var H=this.__data__=new F(P);this.size=H.size}function Te(){this.__data__=new F,this.size=0}function Re(P){var H=this.__data__,pe=H.delete(P);return this.size=H.size,pe}function Be(P){return this.__data__.get(P)}function et(P){return this.__data__.has(P)}function vt(P,H){var pe=this.__data__;if(pe instanceof F){var je=pe.__data__;if(!oa||je.length<g-1)return je.push([P,H]),this.size=++pe.size,this;pe=this.__data__=new l(je)}return pe.set(P,H),this.size=pe.size,this}Se.prototype.clear=Te,Se.prototype.delete=Re,Se.prototype.get=Be,Se.prototype.has=et,Se.prototype.set=vt;function ot(P,H){var pe=f(P),je=!pe&&Ne(P),St=!pe&&!je&&G(P),qt=!pe&&!je&&!St&&Nn(P),ui=pe||je||St||qt,di=ui?Zr(P.length,or):[],Mi=di.length;for(var cn in P)(H||os.call(P,cn))&&!(ui&&(cn=="length"||St&&(cn=="offset"||cn=="parent")||qt&&(cn=="buffer"||cn=="byteLength"||cn=="byteOffset")||Pc(cn,Mi)))&&di.push(cn);return di}function ht(P){var H=P.length;return H?P[mA(0,H-1)]:n}function Et(P,H){return If(xl(P),Gi(H,0,P.length))}function wt(P){return If(xl(P))}function si(P,H,pe){(pe!==n&&!J(P[H],pe)||pe===n&&!(H in P))&&Si(P,H,pe)}function Kt(P,H,pe){var je=P[H];(!(os.call(P,H)&&J(je,pe))||pe===n&&!(H in P))&&Si(P,H,pe)}function ii(P,H){for(var pe=P.length;pe--;)if(J(P[pe][0],H))return pe;return-1}function ai(P,H,pe,je){return er(P,function(St,qt,ui){H(je,St,pe(St),ui)}),je}function Zi(P,H){return P&&uc(H,co(H),P)}function Qi(P,H){return P&&uc(H,So(H),P)}function Si(P,H,pe){H=="__proto__"&&ta?ta(P,H,{configurable:!0,enumerable:!0,value:pe,writable:!0}):P[H]=pe}function Ui(P,H){for(var pe=-1,je=H.length,St=Pi(je),qt=P==null;++pe<je;)St[pe]=qt?n:eu(P,H[pe]);return St}function Gi(P,H,pe){return P===P&&(pe!==n&&(P=P<=pe?P:pe),H!==n&&(P=P>=H?P:H)),P}function un(P,H,pe,je,St,qt){var ui,di=H&ae,Mi=H&ce,cn=H&be;if(pe&&(ui=St?pe(P,je,St,qt):pe(P)),ui!==n)return ui;if(!Pt(P))return P;var An=f(P);if(An){if(ui=Lm(P),!di)return xl(P,ui)}else{var yn=Ul(P),Yn=yn==Oi||yn==xn;if(G(P))return X0(P,di);if(yn==Xt||yn==Hi||Yn&&!St){if(ui=Mi||Yn?{}:nd(P),!di)return Mi?gf(P,Qi(ui,P)):Qh(P,Zi(ui,P))}else{if(!ir[yn])return St?P:{};ui=eA(P,yn,di)}}qt||(qt=new Se);var br=qt.get(P);if(br)return br;qt.set(P,ui),an(P)?P.forEach(function($r){ui.add(un($r,H,pe,$r,P,qt))}):ei(P)&&P.forEach(function($r,sa){ui.set(sa,un($r,H,pe,sa,P,qt))});var Wr=cn?Mi?bf:Eh:Mi?So:co,js=An?n:Wr(P);return ro(js||P,function($r,sa){js&&(sa=$r,$r=P[sa]),Kt(ui,sa,un($r,H,pe,sa,P,qt))}),ui}function Bn(P){var H=co(P);return function(pe){return en(pe,P,H)}}function en(P,H,pe){var je=pe.length;if(P==null)return!je;for(P=Ln(P);je--;){var St=pe[je],qt=H[St],ui=P[St];if(ui===n&&!(St in P)||!qt(ui))return!1}return!0}function kn(P,H,pe){if(typeof P!="function")throw new Xn(S);return MA(function(){P.apply(n,pe)},H)}function vr(P,H,pe,je){var St=-1,qt=Wo,ui=!0,di=P.length,Mi=[],cn=H.length;if(!di)return Mi;pe&&(H=Gs(H,nr(pe))),je?(qt=ko,ui=!1):H.length>=g&&(qt=Xr,ui=!1,H=new j(H));e:for(;++St<di;){var An=P[St],yn=pe==null?An:pe(An);if(An=je||An!==0?An:0,ui&&yn===yn){for(var Yn=cn;Yn--;)if(H[Yn]===yn)continue e;Mi.push(An)}else qt(H,yn,je)||Mi.push(An)}return Mi}var er=m0(bo),Ca=m0(Qs,!0);function fa(P,H){var pe=!0;return er(P,function(je,St,qt){return pe=!!H(je,St,qt),pe}),pe}function zs(P,H,pe){for(var je=-1,St=P.length;++je<St;){var qt=P[je],ui=H(qt);if(ui!=null&&(di===n?ui===ui&&!Dn(ui):pe(ui,di)))var di=ui,Mi=qt}return Mi}function oo(P,H,pe,je){var St=P.length;for(pe=Wn(pe),pe<0&&(pe=-pe>St?0:St+pe),je=je===n||je>St?St:Wn(je),je<0&&(je+=St),je=pe>je?0:Is(je);pe<je;)P[pe++]=H;return P}function lo(P,H){var pe=[];return er(P,function(je,St,qt){H(je,St,qt)&&pe.push(je)}),pe}function qr(P,H,pe,je,St){var qt=-1,ui=P.length;for(pe||(pe=Ep),St||(St=[]);++qt<ui;){var di=P[qt];H>0&&pe(di)?H>1?qr(di,H-1,pe,je,St):$o(St,di):je||(St[St.length]=di)}return St}var ya=_f(),xo=_f(!0);function bo(P,H){return P&&ya(P,H,co)}function Qs(P,H){return P&&xo(P,H,co)}function rs(P,H){return Oo(H,function(pe){return ft(P[pe])})}function ss(P,H){H=bh(H,P);for(var pe=0,je=H.length;P!=null&&pe<je;)P=P[ys(H[pe++])];return pe&&pe==je?P:n}function Rr(P,H,pe){var je=H(P);return f(P)?je:$o(je,pe(P))}function Ss(P){return P==null?P===n?Gn:rn:yl&&yl in Ln(P)?Sf(P):od(P)}function Ws(P,H){return P>H}function Bo(P,H){return P!=null&&os.call(P,H)}function Uo(P,H){return P!=null&&H in Ln(P)}function Go(P,H,pe){return P>=gs(H,pe)&&P<yr(H,pe)}function Ec(P,H,pe){for(var je=pe?ko:Wo,St=P[0].length,qt=P.length,ui=qt,di=Pi(qt),Mi=1/0,cn=[];ui--;){var An=P[ui];ui&&H&&(An=Gs(An,nr(H))),Mi=gs(An.length,Mi),di[ui]=!pe&&(H||St>=120&&An.length>=120)?new j(ui&&An):n}An=P[0];var yn=-1,Yn=di[0];e:for(;++yn<St&&cn.length<Mi;){var br=An[yn],Wr=H?H(br):br;if(br=pe||br!==0?br:0,!(Yn?Xr(Yn,Wr):je(cn,Wr,pe))){for(ui=qt;--ui;){var js=di[ui];if(!(js?Xr(js,Wr):je(P[ui],Wr,pe)))continue e}Yn&&Yn.push(Wr),cn.push(br)}}return cn}function $s(P,H,pe,je){return bo(P,function(St,qt,ui){H(je,pe(St),qt,ui)}),je}function Yl(P,H,pe){H=bh(H,P),P=ud(P,H);var je=P==null?P:P[ys(ku(H))];return je==null?n:As(je,P,pe)}function hu(P){return Lt(P)&&Ss(P)==Hi}function il(P){return Lt(P)&&Ss(P)==k}function vl(P){return Lt(P)&&Ss(P)==Ei}function Pl(P,H,pe,je,St){return P===H?!0:P==null||H==null||!Lt(P)&&!Lt(H)?P!==P&&H!==H:Au(P,H,pe,je,Pl,St)}function Au(P,H,pe,je,St,qt){var ui=f(P),di=f(H),Mi=ui?Ni:Ul(P),cn=di?Ni:Ul(H);Mi=Mi==Hi?Xt:Mi,cn=cn==Hi?Xt:cn;var An=Mi==Xt,yn=cn==Xt,Yn=Mi==cn;if(Yn&&G(P)){if(!G(H))return!1;ui=!0,An=!1}if(Yn&&!An)return qt||(qt=new Se),ui||Nn(P)?ed(P,H,pe,je,St,qt):Ih(P,H,Mi,pe,je,St,qt);if(!(pe&Je)){var br=An&&os.call(P,"__wrapped__"),Wr=yn&&os.call(H,"__wrapped__");if(br||Wr){var js=br?P.value():P,$r=Wr?H.value():H;return qt||(qt=new Se),St(js,$r,pe,je,qt)}}return Yn?(qt||(qt=new Se),Mm(P,H,pe,je,St,qt)):!1}function af(P){return Lt(P)&&Ul(P)==bn}function Vh(P,H,pe,je){var St=pe.length,qt=St,ui=!je;if(P==null)return!qt;for(P=Ln(P);St--;){var di=pe[St];if(ui&&di[2]?di[1]!==P[di[0]]:!(di[0]in P))return!1}for(;++St<qt;){di=pe[St];var Mi=di[0],cn=P[Mi],An=di[1];if(ui&&di[2]){if(cn===n&&!(Mi in P))return!1}else{var yn=new Se;if(je)var Yn=je(cn,An,Mi,P,H,yn);if(!(Yn===n?Pl(An,cn,Je|st,je,yn):Yn))return!1}}return!0}function La(P){if(!Pt(P)||Cp(P))return!1;var H=ft(P)?Da:li;return H.test(ih(P))}function pA(P){return Lt(P)&&Ss(P)==ci}function yh(P){return Lt(P)&&Ul(P)==sn}function Uh(P){return Lt(P)&&Mt(P.length)&&!!Gr[Ss(P)]}function Cc(P){return typeof P=="function"?P:P==null?Nc:typeof P=="object"?f(P)?of(P[0],P[1]):qh(P):N2(P)}function Gh(P){if(!TA(P))return Vu(P);var H=[];for(var pe in Ln(P))os.call(P,pe)&&pe!="constructor"&&H.push(pe);return H}function h0(P){if(!Pt(P))return Al(P);var H=TA(P),pe=[];for(var je in P)je=="constructor"&&(H||!os.call(P,je))||pe.push(je);return pe}function Xc(P,H){return P<H}function _p(P,H){var pe=-1,je=p(P)?Pi(P.length):[];return er(P,function(St,qt,ui){je[++pe]=H(St,qt,ui)}),je}function qh(P){var H=td(P);return H.length==1&&H[0][2]?ad(H[0][0],H[0][1]):function(pe){return pe===P||Vh(pe,P,H)}}function of(P,H){return CA(P)&&y0(H)?ad(ys(P),H):function(pe){var je=eu(pe,P);return je===n&&je===H?sA(pe,P):Pl(H,je,Je|st)}}function Yc(P,H,pe,je,St){P!==H&&ya(H,function(qt,ui){if(St||(St=new Se),Pt(qt))yp(P,H,ui,pe,Yc,je,St);else{var di=je?je(kA(P,ui),qt,ui+"",P,H,St):n;di===n&&(di=qt),si(P,ui,di)}},So)}function yp(P,H,pe,je,St,qt,ui){var di=kA(P,pe),Mi=kA(H,pe),cn=ui.get(Mi);if(cn){si(P,pe,cn);return}var An=qt?qt(di,Mi,pe+"",P,H,ui):n,yn=An===n;if(yn){var Yn=f(Mi),br=!Yn&&G(Mi),Wr=!Yn&&!br&&Nn(Mi);An=Mi,Yn||br||Wr?f(di)?An=di:I(di)?An=xl(di):br?(yn=!1,An=X0(Mi,!0)):Wr?(yn=!1,An=zo(Mi,!0)):An=[]:on(Mi)||Ne(Mi)?(An=di,Ne(di)?An=na(di):(!Pt(di)||ft(di))&&(An=nd(Mi))):yn=!1}yn&&(ui.set(Mi,An),St(An,Mi,je,qt,ui),ui.delete(Mi)),si(P,pe,An)}function lf(P,H){var pe=P.length;if(pe)return H+=H<0?pe:0,Pc(H,pe)?P[H]:n}function j0(P,H,pe){H.length?H=Gs(H,function(qt){return f(qt)?function(ui){return ss(ui,qt.length===1?qt[0]:qt)}:qt}):H=[Nc];var je=-1;H=Gs(H,nr(Tr()));var St=_p(P,function(qt,ui,di){var Mi=Gs(H,function(cn){return cn(qt)});return{criteria:Mi,index:++je,value:qt}});return Ol(St,function(qt,ui){return xp(qt,ui,pe)})}function Kl(P,H){return Yu(P,H,function(pe,je){return sA(P,je)})}function Yu(P,H,pe){for(var je=-1,St=H.length,qt={};++je<St;){var ui=H[je],di=ss(P,ui);pe(di,ui)&&jh(qt,bh(ui,P),di)}return qt}function Z0(P){return function(H){return ss(H,P)}}function vh(P,H,pe,je){var St=je?zr:Ko,qt=-1,ui=H.length,di=P;for(P===H&&(H=xl(H)),pe&&(di=Gs(P,nr(pe)));++qt<ui;)for(var Mi=0,cn=H[qt],An=pe?pe(cn):cn;(Mi=St(di,An,Mi,je))>-1;)di!==P&&uu.call(di,Mi,1),uu.call(P,Mi,1);return P}function Kc(P,H){for(var pe=P?H.length:0,je=pe-1;pe--;){var St=H[pe];if(pe==je||St!==qt){var qt=St;Pc(St)?uu.call(P,St,1):hf(P,St)}}return P}function mA(P,H){return P+_a(Jn()*(H-P+1))}function uf(P,H,pe,je){for(var St=-1,qt=yr(ms((H-P)/(pe||1)),0),ui=Pi(qt);qt--;)ui[je?qt:++St]=P,P+=pe;return ui}function A0(P,H){var pe="";if(!P||H<1||H>Bt)return pe;do H%2&&(pe+=P),H=_a(H/2),H&&(P+=P);while(H);return pe}function _s(P,H){return wu(ld(P,H,Nc),P+"")}function Jl(P){return ht(Oc(P))}function Hh(P,H){var pe=Oc(P);return If(pe,Gi(H,0,pe.length))}function jh(P,H,pe,je){if(!Pt(P))return P;H=bh(H,P);for(var St=-1,qt=H.length,ui=qt-1,di=P;di!=null&&++St<qt;){var Mi=ys(H[St]),cn=pe;if(Mi==="__proto__"||Mi==="constructor"||Mi==="prototype")return P;if(St!=ui){var An=di[Mi];cn=je?je(An,Mi,di):n,cn===n&&(cn=Pt(An)?An:Pc(H[St+1])?[]:{})}Kt(di,Mi,cn),di=di[Mi]}return P}var cf=Li?function(P,H){return Li.set(P,H),P}:Nc,gA=ta?function(P,H){return ta(P,"toString",{configurable:!0,enumerable:!1,value:w1(H),writable:!0})}:Nc;function Q0(P){return If(Oc(P))}function Dl(P,H,pe){var je=-1,St=P.length;H<0&&(H=-H>St?0:St+H),pe=pe>St?St:pe,pe<0&&(pe+=St),St=H>pe?0:pe-H>>>0,H>>>=0;for(var qt=Pi(St);++je<St;)qt[je]=P[je+H];return qt}function Uu(P,H){var pe;return er(P,function(je,St,qt){return pe=H(je,St,qt),!pe}),!!pe}function _A(P,H,pe){var je=0,St=P==null?je:P.length;if(typeof H=="number"&&H===H&&St<=Ri){for(;je<St;){var qt=je+St>>>1,ui=P[qt];ui!==null&&!Dn(ui)&&(pe?ui<=H:ui<H)?je=qt+1:St=qt}return St}return f0(P,H,Nc,pe)}function f0(P,H,pe,je){var St=0,qt=P==null?0:P.length;if(qt===0)return 0;H=pe(H);for(var ui=H!==H,di=H===null,Mi=Dn(H),cn=H===n;St<qt;){var An=_a((St+qt)/2),yn=pe(P[An]),Yn=yn!==n,br=yn===null,Wr=yn===yn,js=Dn(yn);if(ui)var $r=je||Wr;else cn?$r=Wr&&(je||Yn):di?$r=Wr&&Yn&&(je||!br):Mi?$r=Wr&&Yn&&!br&&(je||!js):br||js?$r=!1:$r=je?yn<=H:yn<H;$r?St=An+1:qt=An}return gs(qt,Ci)}function d0(P,H){for(var pe=-1,je=P.length,St=0,qt=[];++pe<je;){var ui=P[pe],di=H?H(ui):ui;if(!pe||!J(di,Mi)){var Mi=di;qt[St++]=ui===0?0:ui}}return qt}function vp(P){return typeof P=="number"?P:Dn(P)?gi:+P}function xu(P){if(typeof P=="string")return P;if(f(P))return Gs(P,xu)+"";if(Dn(P))return z?z.call(P):"";var H=P+"";return H=="0"&&1/P==-Nt?"-0":H}function Jc(P,H,pe){var je=-1,St=Wo,qt=P.length,ui=!0,di=[],Mi=di;if(pe)ui=!1,St=ko;else if(qt>=g){var cn=H?null:J0(P);if(cn)return Yr(cn);ui=!1,St=Xr,Mi=new j}else Mi=H?[]:di;e:for(;++je<qt;){var An=P[je],yn=H?H(An):An;if(An=pe||An!==0?An:0,ui&&yn===yn){for(var Yn=Mi.length;Yn--;)if(Mi[Yn]===yn)continue e;H&&Mi.push(yn),di.push(An)}else St(Mi,yn,pe)||(Mi!==di&&Mi.push(yn),di.push(An))}return di}function hf(P,H){return H=bh(H,P),P=ud(P,H),P==null||delete P[ys(ku(H))]}function xh(P,H,pe,je){return jh(P,H,pe(ss(P,H)),je)}function Ll(P,H,pe,je){for(var St=P.length,qt=je?St:-1;(je?qt--:++qt<St)&&H(P[qt],qt,P););return pe?Dl(P,je?0:qt,je?qt+1:St):Dl(P,je?qt+1:0,je?St:qt)}function p0(P,H){var pe=P;return pe instanceof we&&(pe=pe.value()),Xo(H,function(je,St){return St.func.apply(St.thisArg,$o([je],St.args))},pe)}function eh(P,H,pe){var je=P.length;if(je<2)return je?Jc(P[0]):[];for(var St=-1,qt=Pi(je);++St<je;)for(var ui=P[St],di=-1;++di<je;)di!=St&&(qt[St]=vr(qt[St]||ui,P[di],H,pe));return Jc(qr(qt,1),H,pe)}function Zh(P,H,pe){for(var je=-1,St=P.length,qt=H.length,ui={};++je<St;){var di=je<qt?H[je]:n;pe(ui,P[je],di)}return ui}function W0(P){return I(P)?P:[]}function $0(P){return typeof P=="function"?P:Nc}function bh(P,H){return f(P)?P:CA(P,H)?[P]:hd(Kn(P))}var Tm=_s;function Tc(P,H,pe){var je=P.length;return pe=pe===n?je:pe,!H&&pe>=je?P:Dl(P,H,pe)}var Af=oc||function(P){return Bs.clearTimeout(P)};function X0(P,H){if(H)return P.slice();var pe=P.length,je=En?En(pe):new P.constructor(pe);return P.copy(je),je}function lc(P){var H=new P.constructor(P.byteLength);return new Nl(H).set(new Nl(P)),H}function ff(P,H){var pe=H?lc(P.buffer):P.buffer;return new P.constructor(pe,P.byteOffset,P.byteLength)}function yA(P){var H=new P.constructor(P.source,fi.exec(P));return H.lastIndex=P.lastIndex,H}function km(P){return D?Ln(D.call(P)):{}}function zo(P,H){var pe=H?lc(P.buffer):P.buffer;return new P.constructor(pe,P.byteOffset,P.length)}function df(P,H){if(P!==H){var pe=P!==n,je=P===null,St=P===P,qt=Dn(P),ui=H!==n,di=H===null,Mi=H===H,cn=Dn(H);if(!di&&!cn&&!qt&&P>H||qt&&ui&&Mi&&!di&&!cn||je&&ui&&Mi||!pe&&Mi||!St)return 1;if(!je&&!qt&&!cn&&P<H||cn&&pe&&St&&!je&&!qt||di&&pe&&St||!ui&&St||!Mi)return-1}return 0}function xp(P,H,pe){for(var je=-1,St=P.criteria,qt=H.criteria,ui=St.length,di=pe.length;++je<ui;){var Mi=df(St[je],qt[je]);if(Mi){if(je>=di)return Mi;var cn=pe[je];return Mi*(cn=="desc"?-1:1)}}return P.index-H.index}function pf(P,H,pe,je){for(var St=-1,qt=P.length,ui=pe.length,di=-1,Mi=H.length,cn=yr(qt-ui,0),An=Pi(Mi+cn),yn=!je;++di<Mi;)An[di]=H[di];for(;++St<ui;)(yn||St<qt)&&(An[pe[St]]=P[St]);for(;cn--;)An[di++]=P[St++];return An}function mf(P,H,pe,je){for(var St=-1,qt=P.length,ui=-1,di=pe.length,Mi=-1,cn=H.length,An=yr(qt-di,0),yn=Pi(An+cn),Yn=!je;++St<An;)yn[St]=P[St];for(var br=St;++Mi<cn;)yn[br+Mi]=H[Mi];for(;++ui<di;)(Yn||St<qt)&&(yn[br+pe[ui]]=P[St++]);return yn}function xl(P,H){var pe=-1,je=P.length;for(H||(H=Pi(je));++pe<je;)H[pe]=P[pe];return H}function uc(P,H,pe,je){var St=!pe;pe||(pe={});for(var qt=-1,ui=H.length;++qt<ui;){var di=H[qt],Mi=je?je(pe[di],P[di],di,pe,P):n;Mi===n&&(Mi=P[di]),St?Si(pe,di,Mi):Kt(pe,di,Mi)}return pe}function Qh(P,H){return uc(P,IA(P),H)}function gf(P,H){return uc(P,EA(P),H)}function Ba(P,H){return function(pe,je){var St=f(pe)?ac:ai,qt=H?H():{};return St(pe,P,Tr(je,2),qt)}}function cc(P){return _s(function(H,pe){var je=-1,St=pe.length,qt=St>1?pe[St-1]:n,ui=St>2?pe[2]:n;for(qt=P.length>3&&typeof qt=="function"?(St--,qt):n,ui&&bu(pe[0],pe[1],ui)&&(qt=St<3?n:qt,St=1),H=Ln(H);++je<St;){var di=pe[je];di&&P(H,di,je,qt)}return H})}function m0(P,H){return function(pe,je){if(pe==null)return pe;if(!p(pe))return P(pe,je);for(var St=pe.length,qt=H?St:-1,ui=Ln(pe);(H?qt--:++qt<St)&&je(ui[qt],qt,ui)!==!1;);return pe}}function _f(P){return function(H,pe,je){for(var St=-1,qt=Ln(H),ui=je(H),di=ui.length;di--;){var Mi=ui[P?di:++St];if(pe(qt[Mi],Mi,qt)===!1)break}return H}}function yf(P,H,pe){var je=H&Ye,St=wh(P);function qt(){var ui=this&&this!==Bs&&this instanceof qt?St:P;return ui.apply(je?pe:this,arguments)}return qt}function kc(P){return function(H){H=Kn(H);var pe=kl(H)?ea(H):n,je=pe?pe[0]:H.charAt(0),St=pe?Tc(pe,1).join(""):H.slice(1);return je[P]()+St}}function Wh(P){return function(H){return Xo(F2(R2(H).replace(dn,"")),P,"")}}function wh(P){return function(){var H=arguments;switch(H.length){case 0:return new P;case 1:return new P(H[0]);case 2:return new P(H[0],H[1]);case 3:return new P(H[0],H[1],H[2]);case 4:return new P(H[0],H[1],H[2],H[3]);case 5:return new P(H[0],H[1],H[2],H[3],H[4]);case 6:return new P(H[0],H[1],H[2],H[3],H[4],H[5]);case 7:return new P(H[0],H[1],H[2],H[3],H[4],H[5],H[6])}var pe=ee(P.prototype),je=P.apply(pe,H);return Pt(je)?je:pe}}function vf(P,H,pe){var je=wh(P);function St(){for(var qt=arguments.length,ui=Pi(qt),di=qt,Mi=Kh(St);di--;)ui[di]=arguments[di];var cn=qt<3&&ui[0]!==Mi&&ui[qt-1]!==Mi?[]:Jo(ui,Mi);if(qt-=cn.length,qt<pe)return hc(P,H,$h,St.placeholder,n,ui,cn,n,n,pe-qt);var An=this&&this!==Bs&&this instanceof St?je:P;return As(An,this,ui)}return St}function vA(P){return function(H,pe,je){var St=Ln(H);if(!p(H)){var qt=Tr(pe,3);H=co(H),pe=function(di){return qt(St[di],di,St)}}var ui=P(H,pe,je);return ui>-1?St[qt?H[ui]:ui]:n}}function xA(P){return Mc(function(H){var pe=H.length,je=pe,St=oe.prototype.thru;for(P&&H.reverse();je--;){var qt=H[je];if(typeof qt!="function")throw new Xn(S);if(St&&!ui&&SA(qt)=="wrapper")var ui=new oe([],!0)}for(je=ui?je:pe;++je<pe;){qt=H[je];var di=SA(qt),Mi=di=="wrapper"?Yh(qt):n;Mi&&_0(Mi[0])&&Mi[1]==(jt|Tt|Rt|at)&&!Mi[4].length&&Mi[9]==1?ui=ui[SA(Mi[0])].apply(ui,Mi[3]):ui=qt.length==1&&_0(qt)?ui[di]():ui.thru(qt)}return function(){var cn=arguments,An=cn[0];if(ui&&cn.length==1&&f(An))return ui.plant(An).value();for(var yn=0,Yn=pe?H[yn].apply(this,cn):An;++yn<pe;)Yn=H[yn].call(this,Yn);return Yn}})}function $h(P,H,pe,je,St,qt,ui,di,Mi,cn){var An=H&jt,yn=H&Ye,Yn=H&it,br=H&(Tt|zt),Wr=H&_t,js=Yn?n:wh(P);function $r(){for(var sa=arguments.length,pa=Pi(sa),Ah=sa;Ah--;)pa[Ah]=arguments[Ah];if(br)var pc=Kh($r),fh=Qr(pa,pc);if(je&&(pa=pf(pa,je,St,br)),qt&&(pa=mf(pa,qt,ui,br)),sa-=fh,br&&sa<cn){var nu=Jo(pa,pc);return hc(P,H,$h,$r.placeholder,pe,pa,nu,di,Mi,cn-sa)}var aA=yn?pe:this,Hf=Yn?aA[P]:P;return sa=pa.length,di?pa=da(pa,di):Wr&&sa>1&&pa.reverse(),An&&Mi<sa&&(pa.length=Mi),this&&this!==Bs&&this instanceof $r&&(Hf=js||wh(Hf)),Hf.apply(aA,pa)}return $r}function Y0(P,H){return function(pe,je){return $s(pe,P,H(je),{})}}function bA(P,H){return function(pe,je){var St;if(pe===n&&je===n)return H;if(pe!==n&&(St=pe),je!==n){if(St===n)return je;typeof pe=="string"||typeof je=="string"?(pe=xu(pe),je=xu(je)):(pe=vp(pe),je=vp(je)),St=P(pe,je)}return St}}function Xh(P){return Mc(function(H){return H=Gs(H,nr(Tr())),_s(function(pe){var je=this;return P(H,function(St){return As(St,je,pe)})})})}function g0(P,H){H=H===n?" ":xu(H);var pe=H.length;if(pe<2)return pe?A0(H,P):H;var je=A0(H,ms(P/_o(H)));return kl(H)?Tc(ea(je),0,P).join(""):je.slice(0,P)}function K0(P,H,pe,je){var St=H&Ye,qt=wh(P);function ui(){for(var di=-1,Mi=arguments.length,cn=-1,An=je.length,yn=Pi(An+Mi),Yn=this&&this!==Bs&&this instanceof ui?qt:P;++cn<An;)yn[cn]=je[cn];for(;Mi--;)yn[cn++]=arguments[++di];return As(Yn,St?pe:this,yn)}return ui}function bp(P){return function(H,pe,je){return je&&typeof je!="number"&&bu(H,pe,je)&&(pe=je=n),H=as(H),pe===n?(pe=H,H=0):pe=as(pe),je=je===n?H<pe?1:-1:as(je),uf(H,pe,je,P)}}function wA(P){return function(H,pe){return typeof H=="string"&&typeof pe=="string"||(H=tr(H),pe=tr(pe)),P(H,pe)}}function hc(P,H,pe,je,St,qt,ui,di,Mi,cn){var An=H&Tt,yn=An?ui:n,Yn=An?n:ui,br=An?qt:n,Wr=An?n:qt;H|=An?Rt:Oe,H&=~(An?Oe:Rt),H&ct||(H&=~(Ye|it));var js=[P,H,St,br,yn,Wr,Yn,di,Mi,cn],$r=pe.apply(n,js);return _0(P)&&cd($r,js),$r.placeholder=je,eo($r,P,H)}function xf(P){var H=Fi[P];return function(pe,je){if(pe=tr(pe),je=je==null?0:gs(Wn(je),292),je&&Nu(pe)){var St=(Kn(pe)+"e").split("e"),qt=H(St[0]+"e"+(+St[1]+je));return St=(Kn(qt)+"e").split("e"),+(St[0]+"e"+(+St[1]-je))}return H(pe)}}var J0=bs&&1/Yr(new bs([,-0]))[1]==Nt?function(P){return new bs(P)}:E1;function Sh(P){return function(H){var pe=Ul(H);return pe==bn?qs(H):pe==sn?gr(H):Ms(H,P(H))}}function th(P,H,pe,je,St,qt,ui,di){var Mi=H&it;if(!Mi&&typeof P!="function")throw new Xn(S);var cn=je?je.length:0;if(cn||(H&=~(Rt|Oe),je=St=n),ui=ui===n?ui:yr(Wn(ui),0),di=di===n?di:Wn(di),cn-=St?St.length:0,H&Oe){var An=je,yn=St;je=St=n}var Yn=Mi?n:Yh(P),br=[P,H,pe,je,St,An,yn,qt,ui,di];if(Yn&&Ch(br,Yn),P=br[0],H=br[1],pe=br[2],je=br[3],St=br[4],di=br[9]=br[9]===n?Mi?0:P.length:yr(br[9]-cn,0),!di&&H&(Tt|zt)&&(H&=~(Tt|zt)),!H||H==Ye)var Wr=yf(P,H,pe);else H==Tt||H==zt?Wr=vf(P,H,di):(H==Rt||H==(Ye|Rt))&&!St.length?Wr=K0(P,H,pe,je):Wr=$h.apply(n,br);var js=Yn?cf:cd;return eo(js(Wr,br),P,H)}function wp(P,H,pe,je){return P===n||J(P,ps[pe])&&!os.call(je,pe)?H:P}function Sp(P,H,pe,je,St,qt){return Pt(P)&&Pt(H)&&(qt.set(H,P),Yc(P,H,n,Sp,qt),qt.delete(H)),P}function Ip(P){return on(P)?n:P}function ed(P,H,pe,je,St,qt){var ui=pe&Je,di=P.length,Mi=H.length;if(di!=Mi&&!(ui&&Mi>di))return!1;var cn=qt.get(P),An=qt.get(H);if(cn&&An)return cn==H&&An==P;var yn=-1,Yn=!0,br=pe&st?new j:n;for(qt.set(P,H),qt.set(H,P);++yn<di;){var Wr=P[yn],js=H[yn];if(je)var $r=ui?je(js,Wr,yn,H,P,qt):je(Wr,js,yn,P,H,qt);if($r!==n){if($r)continue;Yn=!1;break}if(br){if(!Sa(H,function(sa,pa){if(!Xr(br,pa)&&(Wr===sa||St(Wr,sa,pe,je,qt)))return br.push(pa)})){Yn=!1;break}}else if(!(Wr===js||St(Wr,js,pe,je,qt))){Yn=!1;break}}return qt.delete(P),qt.delete(H),Yn}function Ih(P,H,pe,je,St,qt,ui){switch(pe){case V:if(P.byteLength!=H.byteLength||P.byteOffset!=H.byteOffset)return!1;P=P.buffer,H=H.buffer;case k:return!(P.byteLength!=H.byteLength||!qt(new Nl(P),new Nl(H)));case vn:case Ei:case Yt:return J(+P,+H);case zi:return P.name==H.name&&P.message==H.message;case ci:case lr:return P==H+"";case bn:var di=qs;case sn:var Mi=je&Je;if(di||(di=Yr),P.size!=H.size&&!Mi)return!1;var cn=ui.get(P);if(cn)return cn==H;je|=st,ui.set(P,H);var An=ed(di(P),di(H),je,St,qt,ui);return ui.delete(P),An;case On:if(D)return D.call(P)==D.call(H)}return!1}function Mm(P,H,pe,je,St,qt){var ui=pe&Je,di=Eh(P),Mi=di.length,cn=Eh(H),An=cn.length;if(Mi!=An&&!ui)return!1;for(var yn=Mi;yn--;){var Yn=di[yn];if(!(ui?Yn in H:os.call(H,Yn)))return!1}var br=qt.get(P),Wr=qt.get(H);if(br&&Wr)return br==H&&Wr==P;var js=!0;qt.set(P,H),qt.set(H,P);for(var $r=ui;++yn<Mi;){Yn=di[yn];var sa=P[Yn],pa=H[Yn];if(je)var Ah=ui?je(pa,sa,Yn,H,P,qt):je(sa,pa,Yn,P,H,qt);if(!(Ah===n?sa===pa||St(sa,pa,pe,je,qt):Ah)){js=!1;break}$r||($r=Yn=="constructor")}if(js&&!$r){var pc=P.constructor,fh=H.constructor;pc!=fh&&"constructor"in P&&"constructor"in H&&!(typeof pc=="function"&&pc instanceof pc&&typeof fh=="function"&&fh instanceof fh)&&(js=!1)}return qt.delete(P),qt.delete(H),js}function Mc(P){return wu(ld(P,n,fl),P+"")}function Eh(P){return Rr(P,co,IA)}function bf(P){return Rr(P,So,EA)}var Yh=Li?function(P){return Li.get(P)}:E1;function SA(P){for(var H=P.name+"",pe=ws[H],je=os.call(ws,H)?pe.length:0;je--;){var St=pe[je],qt=St.func;if(qt==null||qt==P)return St.name}return H}function Kh(P){var H=os.call(R,"placeholder")?R:P;return H.placeholder}function Tr(){var P=R.iteratee||S1;return P=P===S1?Cc:P,arguments.length?P(arguments[0],arguments[1]):P}function wf(P,H){var pe=P.__data__;return Bm(H)?pe[typeof H=="string"?"string":"hash"]:pe.map}function td(P){for(var H=co(P),pe=H.length;pe--;){var je=H[pe],St=P[je];H[pe]=[je,St,y0(St)]}return H}function Jh(P,H){var pe=Do(P,H);return La(pe)?pe:n}function Sf(P){var H=os.call(P,yl),pe=P[yl];try{P[yl]=n;var je=!0}catch{}var St=vo.call(P);return je&&(H?P[yl]=pe:delete P[yl]),St}var IA=el?function(P){return P==null?[]:(P=Ln(P),Oo(el(P),function(H){return _l.call(P,H)}))}:C1,EA=el?function(P){for(var H=[];P;)$o(H,IA(P)),P=$l(P);return H}:C1,Ul=Ss;(Tu&&Ul(new Tu(new ArrayBuffer(1)))!=V||oa&&Ul(new oa)!=bn||yu&&Ul(yu.resolve())!=Ji||bs&&Ul(new bs)!=sn||Lo&&Ul(new Lo)!=pn)&&(Ul=function(P){var H=Ss(P),pe=H==Xt?P.constructor:n,je=pe?ih(pe):"";if(je)switch(je){case vu:return V;case Vo:return bn;case fs:return Ji;case hl:return sn;case Ds:return pn}return H});function Pm(P,H,pe){for(var je=-1,St=pe.length;++je<St;){var qt=pe[je],ui=qt.size;switch(qt.type){case"drop":P+=ui;break;case"dropRight":H-=ui;break;case"take":H=gs(H,P+ui);break;case"takeRight":P=yr(P,H-ui);break}}return{start:P,end:H}}function Dm(P){var H=P.match(Ge);return H?H[1].split(At):[]}function id(P,H,pe){H=bh(H,P);for(var je=-1,St=H.length,qt=!1;++je<St;){var ui=ys(H[je]);if(!(qt=P!=null&&pe(P,ui)))break;P=P[ui]}return qt||++je!=St?qt:(St=P==null?0:P.length,!!St&&Mt(St)&&Pc(ui,St)&&(f(P)||Ne(P)))}function Lm(P){var H=P.length,pe=new P.constructor(H);return H&&typeof P[0]=="string"&&os.call(P,"index")&&(pe.index=P.index,pe.input=P.input),pe}function nd(P){return typeof P.constructor=="function"&&!TA(P)?ee($l(P)):{}}function eA(P,H,pe){var je=P.constructor;switch(H){case k:return lc(P);case vn:case Ei:return new je(+P);case V:return ff(P,pe);case Y:case te:case fe:case ve:case Ie:case Ee:case ze:case Qe:case He:return zo(P,pe);case bn:return new je;case Yt:case lr:return new je(P);case ci:return yA(P);case sn:return new je;case On:return km(P)}}function rd(P,H){var pe=H.length;if(!pe)return P;var je=pe-1;return H[je]=(pe>1?"& ":"")+H[je],H=H.join(pe>2?", ":" "),P.replace(De,`{
/* [wrapped with `+H+`] */
`)}function Ep(P){return f(P)||Ne(P)||!!(Ou&&P&&P[Ou])}function Pc(P,H){var pe=typeof P;return H=H??Bt,!!H&&(pe=="number"||pe!="symbol"&&vi.test(P))&&P>-1&&P%1==0&&P<H}function bu(P,H,pe){if(!Pt(pe))return!1;var je=typeof H;return(je=="number"?p(pe)&&Pc(H,pe.length):je=="string"&&H in pe)?J(pe[H],P):!1}function CA(P,H){if(f(P))return!1;var pe=typeof P;return pe=="number"||pe=="symbol"||pe=="boolean"||P==null||Dn(P)?!0:ge.test(P)||!ye.test(P)||H!=null&&P in Ln(H)}function Bm(P){var H=typeof P;return H=="string"||H=="number"||H=="symbol"||H=="boolean"?P!=="__proto__":P===null}function _0(P){var H=SA(P),pe=R[H];if(typeof pe!="function"||!(H in we.prototype))return!1;if(P===pe)return!0;var je=Yh(pe);return!!je&&P===je[0]}function Cp(P){return!!Fu&&Fu in P}var sd=Ja?ft:T1;function TA(P){var H=P&&P.constructor,pe=typeof H=="function"&&H.prototype||ps;return P===pe}function y0(P){return P===P&&!Pt(P)}function ad(P,H){return function(pe){return pe==null?!1:pe[P]===H&&(H!==n||P in Ln(pe))}}function zm(P){var H=Mh(P,function(je){return pe.size===W&&pe.clear(),je}),pe=H.cache;return H}function Ch(P,H){var pe=P[1],je=H[1],St=pe|je,qt=St<(Ye|it|jt),ui=je==jt&&pe==Tt||je==jt&&pe==at&&P[7].length<=H[8]||je==(jt|at)&&H[7].length<=H[8]&&pe==Tt;if(!(qt||ui))return P;je&Ye&&(P[2]=H[2],St|=pe&Ye?0:ct);var di=H[3];if(di){var Mi=P[3];P[3]=Mi?pf(Mi,di,H[4]):di,P[4]=Mi?Jo(P[3],he):H[4]}return di=H[5],di&&(Mi=P[5],P[5]=Mi?mf(Mi,di,H[6]):di,P[6]=Mi?Jo(P[5],he):H[6]),di=H[7],di&&(P[7]=di),je&jt&&(P[8]=P[8]==null?H[8]:gs(P[8],H[8])),P[9]==null&&(P[9]=H[9]),P[0]=H[0],P[1]=St,P}function Al(P){var H=[];if(P!=null)for(var pe in Ln(P))H.push(pe);return H}function od(P){return vo.call(P)}function ld(P,H,pe){return H=yr(H===n?P.length-1:H,0),function(){for(var je=arguments,St=-1,qt=yr(je.length-H,0),ui=Pi(qt);++St<qt;)ui[St]=je[H+St];St=-1;for(var di=Pi(H+1);++St<H;)di[St]=je[St];return di[H]=pe(ui),As(P,this,di)}}function ud(P,H){return H.length<2?P:ss(P,Dl(H,0,-1))}function da(P,H){for(var pe=P.length,je=gs(H.length,pe),St=xl(P);je--;){var qt=H[je];P[je]=Pc(qt,pe)?St[qt]:n}return P}function kA(P,H){if(!(H==="constructor"&&typeof P[H]=="function")&&H!="__proto__")return P[H]}var cd=v0(cf),MA=Xl||function(P,H){return Bs.setTimeout(P,H)},wu=v0(gA);function eo(P,H,pe){var je=H+"";return wu(P,rd(je,Tp(Dm(je),pe)))}function v0(P){var H=0,pe=0;return function(){var je=gn(),St=lt-(je-pe);if(pe=je,St>0){if(++H>=bt)return arguments[0]}else H=0;return P.apply(n,arguments)}}function If(P,H){var pe=-1,je=P.length,St=je-1;for(H=H===n?je:H;++pe<H;){var qt=mA(pe,St),ui=P[qt];P[qt]=P[pe],P[pe]=ui}return P.length=H,P}var hd=zm(function(P){var H=[];return P.charCodeAt(0)===46&&H.push(""),P.replace(Pe,function(pe,je,St,qt){H.push(St?qt.replace(ke,"$1"):je||pe)}),H});function ys(P){if(typeof P=="string"||Dn(P))return P;var H=P+"";return H=="0"&&1/P==-Nt?"-0":H}function ih(P){if(P!=null){try{return yo.call(P)}catch{}try{return P+""}catch{}}return""}function Tp(P,H){return ro(Ki,function(pe){var je="_."+pe[0];H&pe[1]&&!Wo(P,je)&&P.push(je)}),P.sort()}function Ad(P){if(P instanceof we)return P.clone();var H=new oe(P.__wrapped__,P.__chain__);return H.__actions__=xl(P.__actions__),H.__index__=P.__index__,H.__values__=P.__values__,H}function nh(P,H,pe){(pe?bu(P,H,pe):H===n)?H=1:H=yr(Wn(H),0);var je=P==null?0:P.length;if(!je||H<1)return[];for(var St=0,qt=0,ui=Pi(ms(je/H));St<je;)ui[qt++]=Dl(P,St,St+=H);return ui}function PA(P){for(var H=-1,pe=P==null?0:P.length,je=0,St=[];++H<pe;){var qt=P[H];qt&&(St[je++]=qt)}return St}function kp(){var P=arguments.length;if(!P)return[];for(var H=Pi(P-1),pe=arguments[0],je=P;je--;)H[je-1]=arguments[je];return $o(f(pe)?xl(pe):[pe],qr(H,1))}var x0=_s(function(P,H){return I(P)?vr(P,qr(H,1,I,!0)):[]}),DA=_s(function(P,H){var pe=ku(H);return I(pe)&&(pe=n),I(P)?vr(P,qr(H,1,I,!0),Tr(pe,2)):[]}),Mp=_s(function(P,H){var pe=ku(H);return I(pe)&&(pe=n),I(P)?vr(P,qr(H,1,I,!0),n,pe):[]});function fd(P,H,pe){var je=P==null?0:P.length;return je?(H=pe||H===n?1:Wn(H),Dl(P,H<0?0:H,je)):[]}function dd(P,H,pe){var je=P==null?0:P.length;return je?(H=pe||H===n?1:Wn(H),H=je-H,Dl(P,0,H<0?0:H)):[]}function Rm(P,H){return P&&P.length?Ll(P,Tr(H,3),!0,!0):[]}function Fm(P,H){return P&&P.length?Ll(P,Tr(H,3),!0):[]}function Om(P,H,pe,je){var St=P==null?0:P.length;return St?(pe&&typeof pe!="number"&&bu(P,H,pe)&&(pe=0,je=St),oo(P,H,pe,je)):[]}function pd(P,H,pe){var je=P==null?0:P.length;if(!je)return-1;var St=pe==null?0:Wn(pe);return St<0&&(St=yr(je+St,0)),$n(P,Tr(H,3),St)}function LA(P,H,pe){var je=P==null?0:P.length;if(!je)return-1;var St=je-1;return pe!==n&&(St=Wn(pe),St=pe<0?yr(je+St,0):gs(St,je-1)),$n(P,Tr(H,3),St,!0)}function fl(P){var H=P==null?0:P.length;return H?qr(P,1):[]}function b0(P){var H=P==null?0:P.length;return H?qr(P,Nt):[]}function w0(P,H){var pe=P==null?0:P.length;return pe?(H=H===n?1:Wn(H),qr(P,H)):[]}function Dc(P){for(var H=-1,pe=P==null?0:P.length,je={};++H<pe;){var St=P[H];je[St[0]]=St[1]}return je}function BA(P){return P&&P.length?P[0]:n}function Ef(P,H,pe){var je=P==null?0:P.length;if(!je)return-1;var St=pe==null?0:Wn(pe);return St<0&&(St=yr(je+St,0)),Ko(P,H,St)}function zA(P){var H=P==null?0:P.length;return H?Dl(P,0,-1):[]}var Cf=_s(function(P){var H=Gs(P,W0);return H.length&&H[0]===P[0]?Ec(H):[]}),Tf=_s(function(P){var H=ku(P),pe=Gs(P,W0);return H===ku(pe)?H=n:pe.pop(),pe.length&&pe[0]===P[0]?Ec(pe,Tr(H,2)):[]}),Su=_s(function(P){var H=ku(P),pe=Gs(P,W0);return H=typeof H=="function"?H:n,H&&pe.pop(),pe.length&&pe[0]===P[0]?Ec(pe,n,H):[]});function S0(P,H){return P==null?"":cu.call(P,H)}function ku(P){var H=P==null?0:P.length;return H?P[H-1]:n}function Th(P,H,pe){var je=P==null?0:P.length;if(!je)return-1;var St=je;return pe!==n&&(St=Wn(pe),St=St<0?yr(je+St,0):gs(St,je-1)),H===H?Aa(P,H,St):$n(P,Xa,St,!0)}function RA(P,H){return P&&P.length?lf(P,Wn(H)):n}var FA=_s(rh);function rh(P,H){return P&&P.length&&H&&H.length?vh(P,H):P}function OA(P,H,pe){return P&&P.length&&H&&H.length?vh(P,H,Tr(pe,2)):P}function I0(P,H,pe){return P&&P.length&&H&&H.length?vh(P,H,n,pe):P}var Nm=Mc(function(P,H){var pe=P==null?0:P.length,je=Ui(P,H);return Kc(P,Gs(H,function(St){return Pc(St,pe)?+St:St}).sort(df)),je});function md(P,H){var pe=[];if(!(P&&P.length))return pe;var je=-1,St=[],qt=P.length;for(H=Tr(H,3);++je<qt;){var ui=P[je];H(ui,je,P)&&(pe.push(ui),St.push(je))}return Kc(P,St),pe}function kh(P){return P==null?P:tl.call(P)}function Lc(P,H,pe){var je=P==null?0:P.length;return je?(pe&&typeof pe!="number"&&bu(P,H,pe)?(H=0,pe=je):(H=H==null?0:Wn(H),pe=pe===n?je:Wn(pe)),Dl(P,H,pe)):[]}function sh(P,H){return _A(P,H)}function gd(P,H,pe){return f0(P,H,Tr(pe,2))}function kf(P,H){var pe=P==null?0:P.length;if(pe){var je=_A(P,H);if(je<pe&&J(P[je],H))return je}return-1}function _d(P,H){return _A(P,H,!0)}function Vm(P,H,pe){return f0(P,H,Tr(pe,2),!0)}function E0(P,H){var pe=P==null?0:P.length;if(pe){var je=_A(P,H,!0)-1;if(J(P[je],H))return je}return-1}function C0(P){return P&&P.length?d0(P):[]}function Mf(P,H){return P&&P.length?d0(P,Tr(H,2)):[]}function Ku(P){var H=P==null?0:P.length;return H?Dl(P,1,H):[]}function Bc(P,H,pe){return P&&P.length?(H=pe||H===n?1:Wn(H),Dl(P,0,H<0?0:H)):[]}function tA(P,H,pe){var je=P==null?0:P.length;return je?(H=pe||H===n?1:Wn(H),H=je-H,Dl(P,H<0?0:H,je)):[]}function T0(P,H){return P&&P.length?Ll(P,Tr(H,3),!1,!0):[]}function Pp(P,H){return P&&P.length?Ll(P,Tr(H,3)):[]}var yd=_s(function(P){return Jc(qr(P,1,I,!0))}),Pf=_s(function(P){var H=ku(P);return I(H)&&(H=n),Jc(qr(P,1,I,!0),Tr(H,2))}),NA=_s(function(P){var H=ku(P);return H=typeof H=="function"?H:n,Jc(qr(P,1,I,!0),n,H)});function Dp(P){return P&&P.length?Jc(P):[]}function vd(P,H){return P&&P.length?Jc(P,Tr(H,2)):[]}function xd(P,H){return H=typeof H=="function"?H:n,P&&P.length?Jc(P,n,H):[]}function ah(P){if(!(P&&P.length))return[];var H=0;return P=Oo(P,function(pe){if(I(pe))return H=yr(pe.length,H),!0}),Zr(H,function(pe){return Gs(P,fr(pe))})}function bd(P,H){if(!(P&&P.length))return[];var pe=ah(P);return H==null?pe:Gs(pe,function(je){return As(H,n,je)})}var Lp=_s(function(P,H){return I(P)?vr(P,H):[]}),wd=_s(function(P){return eh(Oo(P,I))}),Bp=_s(function(P){var H=ku(P);return I(H)&&(H=n),eh(Oo(P,I),Tr(H,2))}),VA=_s(function(P){var H=ku(P);return H=typeof H=="function"?H:n,eh(Oo(P,I),n,H)}),oh=_s(ah);function zp(P,H){return Zh(P||[],H||[],Kt)}function Rp(P,H){return Zh(P||[],H||[],jh)}var Sd=_s(function(P){var H=P.length,pe=H>1?P[H-1]:n;return pe=typeof pe=="function"?(P.pop(),pe):n,bd(P,pe)});function Id(P){var H=R(P);return H.__chain__=!0,H}function Fp(P,H){return H(P),P}function UA(P,H){return H(P)}var k0=Mc(function(P){var H=P.length,pe=H?P[0]:0,je=this.__wrapped__,St=function(qt){return Ui(qt,P)};return H>1||this.__actions__.length||!(je instanceof we)||!Pc(pe)?this.thru(St):(je=je.slice(pe,+pe+(H?1:0)),je.__actions__.push({func:UA,args:[St],thisArg:n}),new oe(je,this.__chain__).thru(function(qt){return H&&!qt.length&&qt.push(n),qt}))});function M0(){return Id(this)}function zc(){return new oe(this.value(),this.__chain__)}function Ed(){this.__values__===n&&(this.__values__=ia(this.value()));var P=this.__index__>=this.__values__.length,H=P?n:this.__values__[this.__index__++];return{done:P,value:H}}function Mu(){return this}function GA(P){for(var H,pe=this;pe instanceof le;){var je=Ad(pe);je.__index__=0,je.__values__=n,H?St.__wrapped__=je:H=je;var St=je;pe=pe.__wrapped__}return St.__wrapped__=P,H}function Cd(){var P=this.__wrapped__;if(P instanceof we){var H=P;return this.__actions__.length&&(H=new we(this)),H=H.reverse(),H.__actions__.push({func:UA,args:[kh],thisArg:n}),new oe(H,this.__chain__)}return this.thru(kh)}function Td(){return p0(this.__wrapped__,this.__actions__)}var kd=Ba(function(P,H,pe){os.call(P,pe)?++P[pe]:Si(P,pe,1)});function P0(P,H,pe){var je=f(P)?Wl:fa;return pe&&bu(P,H,pe)&&(H=n),je(P,Tr(H,3))}function Df(P,H){var pe=f(P)?Oo:lo;return pe(P,Tr(H,3))}var Md=vA(pd),Pd=vA(LA);function Dd(P,H){return qr(lh(P,H),1)}function bl(P,H){return qr(lh(P,H),Nt)}function qA(P,H,pe){return pe=pe===n?1:Wn(pe),qr(lh(P,H),pe)}function D0(P,H){var pe=f(P)?ro:er;return pe(P,Tr(H,3))}function L0(P,H){var pe=f(P)?so:Ca;return pe(P,Tr(H,3))}var Ld=Ba(function(P,H,pe){os.call(P,pe)?P[pe].push(H):Si(P,pe,[H])});function Op(P,H,pe,je){P=p(P)?P:Oc(P),pe=pe&&!je?Wn(pe):0;var St=P.length;return pe<0&&(pe=yr(St+pe,0)),$i(P)?pe<=St&&P.indexOf(H,pe)>-1:!!St&&Ko(P,H,pe)>-1}var Np=_s(function(P,H,pe){var je=-1,St=typeof H=="function",qt=p(P)?Pi(P.length):[];return er(P,function(ui){qt[++je]=St?As(H,ui,pe):Yl(ui,H,pe)}),qt}),Bd=Ba(function(P,H,pe){Si(P,pe,H)});function lh(P,H){var pe=f(P)?Gs:_p;return pe(P,Tr(H,3))}function zd(P,H,pe,je){return P==null?[]:(f(H)||(H=H==null?[]:[H]),pe=je?n:pe,f(pe)||(pe=pe==null?[]:[pe]),j0(P,H,pe))}var Ac=Ba(function(P,H,pe){P[pe?0:1].push(H)},function(){return[[],[]]});function Rd(P,H,pe){var je=f(P)?Xo:qn,St=arguments.length<3;return je(P,Tr(H,4),pe,St,er)}function Lf(P,H,pe){var je=f(P)?Yo:qn,St=arguments.length<3;return je(P,Tr(H,4),pe,St,Ca)}function Bf(P,H){var pe=f(P)?Oo:lo;return pe(P,QA(Tr(H,3)))}function zf(P){var H=f(P)?ht:Jl;return H(P)}function Um(P,H,pe){(pe?bu(P,H,pe):H===n)?H=1:H=Wn(H);var je=f(P)?Et:Hh;return je(P,H)}function Gm(P){var H=f(P)?wt:Q0;return H(P)}function Vp(P){if(P==null)return 0;if(p(P))return $i(P)?_o(P):P.length;var H=Ul(P);return H==bn||H==sn?P.size:Gh(P).length}function HA(P,H,pe){var je=f(P)?Sa:Uu;return pe&&bu(P,H,pe)&&(H=n),je(P,Tr(H,3))}var iA=_s(function(P,H){if(P==null)return[];var pe=H.length;return pe>1&&bu(P,H[0],H[1])?H=[]:pe>2&&bu(H[0],H[1],H[2])&&(H=[H[0]]),j0(P,qr(H,1),[])}),Ro=Xu||function(){return Bs.Date.now()};function uh(P,H){if(typeof H!="function")throw new Xn(S);return P=Wn(P),function(){if(--P<1)return H.apply(this,arguments)}}function nA(P,H,pe){return H=pe?n:H,H=P&&H==null?P.length:H,th(P,jt,n,n,n,n,H)}function jA(P,H){var pe;if(typeof H!="function")throw new Xn(S);return P=Wn(P),function(){return--P>0&&(pe=H.apply(this,arguments)),P<=1&&(H=n),pe}}var rA=_s(function(P,H,pe){var je=Ye;if(pe.length){var St=Jo(pe,Kh(rA));je|=Rt}return th(P,je,H,pe,St)}),B0=_s(function(P,H,pe){var je=Ye|it;if(pe.length){var St=Jo(pe,Kh(B0));je|=Rt}return th(H,je,P,pe,St)});function Up(P,H,pe){H=pe?n:H;var je=th(P,Tt,n,n,n,n,n,H);return je.placeholder=Up.placeholder,je}function Fd(P,H,pe){H=pe?n:H;var je=th(P,zt,n,n,n,n,n,H);return je.placeholder=Fd.placeholder,je}function Od(P,H,pe){var je,St,qt,ui,di,Mi,cn=0,An=!1,yn=!1,Yn=!0;if(typeof P!="function")throw new Xn(S);H=tr(H)||0,Pt(pe)&&(An=!!pe.leading,yn="maxWait"in pe,qt=yn?yr(tr(pe.maxWait)||0,H):qt,Yn="trailing"in pe?!!pe.trailing:Yn);function br(nu){var aA=je,Hf=St;return je=St=n,cn=nu,ui=P.apply(Hf,aA),ui}function Wr(nu){return cn=nu,di=MA(sa,H),An?br(nu):ui}function js(nu){var aA=nu-Mi,Hf=nu-cn,V2=H-aA;return yn?gs(V2,qt-Hf):V2}function $r(nu){var aA=nu-Mi,Hf=nu-cn;return Mi===n||aA>=H||aA<0||yn&&Hf>=qt}function sa(){var nu=Ro();if($r(nu))return pa(nu);di=MA(sa,js(nu))}function pa(nu){return di=n,Yn&&je?br(nu):(je=St=n,ui)}function Ah(){di!==n&&Af(di),cn=0,je=Mi=St=di=n}function pc(){return di===n?ui:pa(Ro())}function fh(){var nu=Ro(),aA=$r(nu);if(je=arguments,St=this,Mi=nu,aA){if(di===n)return Wr(Mi);if(yn)return Af(di),di=MA(sa,H),br(Mi)}return di===n&&(di=MA(sa,H)),ui}return fh.cancel=Ah,fh.flush=pc,fh}var ZA=_s(function(P,H){return kn(P,1,H)}),Bl=_s(function(P,H,pe){return kn(P,tr(H)||0,pe)});function Rc(P){return th(P,_t)}function Mh(P,H){if(typeof P!="function"||H!=null&&typeof H!="function")throw new Xn(S);var pe=function(){var je=arguments,St=H?H.apply(this,je):je[0],qt=pe.cache;if(qt.has(St))return qt.get(St);var ui=P.apply(this,je);return pe.cache=qt.set(St,ui)||qt,ui};return pe.cache=new(Mh.Cache||l),pe}Mh.Cache=l;function QA(P){if(typeof P!="function")throw new Xn(S);return function(){var H=arguments;switch(H.length){case 0:return!P.call(this);case 1:return!P.call(this,H[0]);case 2:return!P.call(this,H[0],H[1]);case 3:return!P.call(this,H[0],H[1],H[2])}return!P.apply(this,H)}}function WA(P){return jA(2,P)}var Rf=Tm(function(P,H){H=H.length==1&&f(H[0])?Gs(H[0],nr(Tr())):Gs(qr(H,1),nr(Tr()));var pe=H.length;return _s(function(je){for(var St=-1,qt=gs(je.length,pe);++St<qt;)je[St]=H[St].call(this,je[St]);return As(P,this,je)})}),z0=_s(function(P,H){var pe=Jo(H,Kh(z0));return th(P,Rt,n,H,pe)}),Ff=_s(function(P,H){var pe=Jo(H,Kh(Ff));return th(P,Oe,n,H,pe)}),Of=Mc(function(P,H){return th(P,at,n,n,n,H)});function Nf(P,H){if(typeof P!="function")throw new Xn(S);return H=H===n?H:Wn(H),_s(P,H)}function R0(P,H){if(typeof P!="function")throw new Xn(S);return H=H==null?0:yr(Wn(H),0),_s(function(pe){var je=pe[H],St=Tc(pe,0,H);return je&&$o(St,je),As(P,this,St)})}function Vf(P,H,pe){var je=!0,St=!0;if(typeof P!="function")throw new Xn(S);return Pt(pe)&&(je="leading"in pe?!!pe.leading:je,St="trailing"in pe?!!pe.trailing:St),Od(P,H,{leading:je,maxWait:H,trailing:St})}function Uf(P){return nA(P,1)}function Gp(P,H){return z0($0(H),P)}function m(){if(!arguments.length)return[];var P=arguments[0];return f(P)?P:[P]}function h(P){return un(P,be)}function b(P,H){return H=typeof H=="function"?H:n,un(P,be,H)}function M(P){return un(P,ae|be)}function q(P,H){return H=typeof H=="function"?H:n,un(P,ae|be,H)}function K(P,H){return H==null||en(P,H,co(H))}function J(P,H){return P===H||P!==P&&H!==H}var me=wA(Ws),Ce=wA(function(P,H){return P>=H}),Ne=hu(function(){return arguments}())?hu:function(P){return Lt(P)&&os.call(P,"callee")&&!_l.call(P,"callee")},f=Pi.isArray,u=El?nr(El):il;function p(P){return P!=null&&Mt(P.length)&&!ft(P)}function I(P){return Lt(P)&&p(P)}function L(P){return P===!0||P===!1||Lt(P)&&Ss(P)==vn}var G=_u||T1,Q=Wa?nr(Wa):vl;function re(P){return Lt(P)&&P.nodeType===1&&!on(P)}function Ae(P){if(P==null)return!0;if(p(P)&&(f(P)||typeof P=="string"||typeof P.splice=="function"||G(P)||Nn(P)||Ne(P)))return!P.length;var H=Ul(P);if(H==bn||H==sn)return!P.size;if(TA(P))return!Gh(P).length;for(var pe in P)if(os.call(P,pe))return!1;return!0}function _e(P,H){return Pl(P,H)}function Le(P,H,pe){pe=typeof pe=="function"?pe:n;var je=pe?pe(P,H):n;return je===n?Pl(P,H,n,pe):!!je}function qe(P){if(!Lt(P))return!1;var H=Ss(P);return H==zi||H==mi||typeof P.message=="string"&&typeof P.name=="string"&&!on(P)}function tt(P){return typeof P=="number"&&Nu(P)}function ft(P){if(!Pt(P))return!1;var H=Ss(P);return H==Oi||H==xn||H==nn||H==mr}function gt(P){return typeof P=="number"&&P==Wn(P)}function Mt(P){return typeof P=="number"&&P>-1&&P%1==0&&P<=Bt}function Pt(P){var H=typeof P;return P!=null&&(H=="object"||H=="function")}function Lt(P){return P!=null&&typeof P=="object"}var ei=Ma?nr(Ma):af;function Ht(P,H){return P===H||Vh(P,H,td(H))}function Qt(P,H,pe){return pe=typeof pe=="function"?pe:n,Vh(P,H,td(H),pe)}function hi(P){return ln(P)&&P!=+P}function _i(P){if(sd(P))throw new ni(x);return La(P)}function Xi(P){return P===null}function Sn(P){return P==null}function ln(P){return typeof P=="number"||Lt(P)&&Ss(P)==Yt}function on(P){if(!Lt(P)||Ss(P)!=Xt)return!1;var H=$l(P);if(H===null)return!0;var pe=os.call(H,"constructor")&&H.constructor;return typeof pe=="function"&&pe instanceof pe&&yo.call(pe)==Ml}var fn=ml?nr(ml):pA;function zn(P){return gt(P)&&P>=-Bt&&P<=Bt}var an=Cl?nr(Cl):yh;function $i(P){return typeof P=="string"||!f(P)&&Lt(P)&&Ss(P)==lr}function Dn(P){return typeof P=="symbol"||Lt(P)&&Ss(P)==On}var Nn=mu?nr(mu):Uh;function pr(P){return P===n}function Vr(P){return Lt(P)&&Ul(P)==pn}function Hr(P){return Lt(P)&&Ss(P)==v}var Rs=wA(Xc),Ta=wA(function(P,H){return P<=H});function ia(P){if(!P)return[];if(p(P))return $i(P)?ea(P):xl(P);if(Vl&&P[Vl])return Js(P[Vl]());var H=Ul(P),pe=H==bn?qs:H==sn?Yr:Oc;return pe(P)}function as(P){if(!P)return P===0?P:0;if(P=tr(P),P===Nt||P===-Nt){var H=P<0?-1:1;return H*Ot}return P===P?P:0}function Wn(P){var H=as(P),pe=H%1;return H===H?pe?H-pe:H:0}function Is(P){return P?Gi(Wn(P),0,Ii):0}function tr(P){if(typeof P=="number")return P;if(Dn(P))return gi;if(Pt(P)){var H=typeof P.valueOf=="function"?P.valueOf():P;P=Pt(H)?H+"":H}if(typeof P!="string")return P===0?P:+P;P=Mr(P);var pe=ti.test(P);return pe||Bi.test(P)?Br(P.slice(2),pe?2:8):Ai.test(P)?gi:+P}function na(P){return uc(P,So(P))}function Ls(P){return P?Gi(Wn(P),-Bt,Bt):P===0?P:0}function Kn(P){return P==null?"":xu(P)}var za=cc(function(P,H){if(TA(H)||p(H)){uc(H,co(H),P);return}for(var pe in H)os.call(H,pe)&&Kt(P,pe,H[pe])}),to=cc(function(P,H){uc(H,So(H),P)}),va=cc(function(P,H,pe,je){uc(H,So(H),P,je)}),qo=cc(function(P,H,pe,je){uc(H,co(H),P,je)}),uo=Mc(Ui);function ra(P,H){var pe=ee(P);return H==null?pe:Zi(pe,H)}var wr=_s(function(P,H){P=Ln(P);var pe=-1,je=H.length,St=je>2?H[2]:n;for(St&&bu(H[0],H[1],St)&&(je=1);++pe<je;)for(var qt=H[pe],ui=So(qt),di=-1,Mi=ui.length;++di<Mi;){var cn=ui[di],An=P[cn];(An===n||J(An,ps[cn])&&!os.call(P,cn))&&(P[cn]=qt[cn])}return P}),wo=_s(function(P){return P.push(n,Sp),As(jp,n,P)});function nl(P,H){return Cr(P,Tr(H,3),bo)}function rl(P,H){return Cr(P,Tr(H,3),Qs)}function Pu(P,H){return P==null?P:ya(P,Tr(H,3),So)}function Gu(P,H){return P==null?P:xo(P,Tr(H,3),So)}function zl(P,H){return P&&bo(P,Tr(H,3))}function Fc(P,H){return P&&Qs(P,Tr(H,3))}function qu(P){return P==null?[]:rs(P,co(P))}function Hu(P){return P==null?[]:rs(P,So(P))}function eu(P,H,pe){var je=P==null?n:ss(P,H);return je===n?pe:je}function ch(P,H){return P!=null&&id(P,H,Bo)}function sA(P,H){return P!=null&&id(P,H,Uo)}var qp=Y0(function(P,H,pe){H!=null&&typeof H.toString!="function"&&(H=vo.call(H)),P[H]=pe},w1(Nc)),Nd=Y0(function(P,H,pe){H!=null&&typeof H.toString!="function"&&(H=vo.call(H)),os.call(P,H)?P[H].push(pe):P[H]=[pe]},Tr),Vd=_s(Yl);function co(P){return p(P)?ot(P):Gh(P)}function So(P){return p(P)?ot(P,!0):h0(P)}function Gf(P,H){var pe={};return H=Tr(H,3),bo(P,function(je,St,qt){Si(pe,H(je,St,qt),je)}),pe}function Hp(P,H){var pe={};return H=Tr(H,3),bo(P,function(je,St,qt){Si(pe,St,H(je,St,qt))}),pe}var qm=cc(function(P,H,pe){Yc(P,H,pe)}),jp=cc(function(P,H,pe,je){Yc(P,H,pe,je)}),Hm=Mc(function(P,H){var pe={};if(P==null)return pe;var je=!1;H=Gs(H,function(qt){return qt=bh(qt,P),je||(je=qt.length>1),qt}),uc(P,bf(P),pe),je&&(pe=un(pe,ae|ce|be,Ip));for(var St=H.length;St--;)hf(pe,H[St]);return pe});function tu(P,H){return Ph(P,QA(Tr(H)))}var ju=Mc(function(P,H){return P==null?{}:Kl(P,H)});function Ph(P,H){if(P==null)return{};var pe=Gs(bf(P),function(je){return[je]});return H=Tr(H),Yu(P,pe,function(je,St){return H(je,St[0])})}function fc(P,H,pe){H=bh(H,P);var je=-1,St=H.length;for(St||(St=1,P=n);++je<St;){var qt=P==null?n:P[ys(H[je])];qt===n&&(je=St,qt=pe),P=ft(qt)?qt.call(P):qt}return P}function iu(P,H,pe){return P==null?P:jh(P,H,pe)}function Zu(P,H,pe,je){return je=typeof je=="function"?je:n,P==null?P:jh(P,H,pe,je)}var jm=Sh(co),Fg=Sh(So);function v1(P,H,pe){var je=f(P),St=je||G(P)||Nn(P);if(H=Tr(H,4),pe==null){var qt=P&&P.constructor;St?pe=je?new qt:[]:Pt(P)?pe=ft(qt)?ee($l(P)):{}:pe={}}return(St?ro:bo)(P,function(ui,di,Mi){return H(pe,ui,di,Mi)}),pe}function x1(P,H){return P==null?!0:hf(P,H)}function Iu(P,H,pe){return P==null?P:xh(P,H,$0(pe))}function dc(P,H,pe,je){return je=typeof je=="function"?je:n,P==null?P:xh(P,H,$0(pe),je)}function Oc(P){return P==null?[]:ll(P,co(P))}function hh(P){return P==null?[]:ll(P,So(P))}function qf(P,H,pe){return pe===n&&(pe=H,H=n),pe!==n&&(pe=tr(pe),pe=pe===pe?pe:0),H!==n&&(H=tr(H),H=H===H?H:0),Gi(tr(P),H,pe)}function Dh(P,H,pe){return H=as(H),pe===n?(pe=H,H=0):pe=as(pe),P=tr(P),Go(P,H,pe)}function j5(P,H,pe){if(pe&&typeof pe!="boolean"&&bu(P,H,pe)&&(H=pe=n),pe===n&&(typeof H=="boolean"?(pe=H,H=n):typeof P=="boolean"&&(pe=P,P=n)),P===n&&H===n?(P=0,H=1):(P=as(P),H===n?(H=P,P=0):H=as(H)),P>H){var je=P;P=H,H=je}if(pe||P%1||H%1){var St=Jn();return gs(P+St*(H-P+Ks("1e-"+((St+"").length-1))),H)}return mA(P,H)}var Z5=Wh(function(P,H,pe){return H=H.toLowerCase(),P+(pe?z2(H):H)});function z2(P){return b1(Kn(P).toLowerCase())}function R2(P){return P=Kn(P),P&&P.replace(bi,ds).replace(rr,"")}function Q5(P,H,pe){P=Kn(P),H=xu(H);var je=P.length;pe=pe===n?je:Gi(Wn(pe),0,je);var St=pe;return pe-=H.length,pe>=0&&P.slice(pe,St)==H}function W5(P){return P=Kn(P),P&&ne.test(P)?P.replace(Me,Ia):P}function $5(P){return P=Kn(P),P&&Ve.test(P)?P.replace(Fe,"\\$&"):P}var X5=Wh(function(P,H,pe){return P+(pe?"-":"")+H.toLowerCase()}),Y5=Wh(function(P,H,pe){return P+(pe?" ":"")+H.toLowerCase()}),K5=kc("toLowerCase");function J5(P,H,pe){P=Kn(P),H=Wn(H);var je=H?_o(P):0;if(!H||je>=H)return P;var St=(H-je)/2;return g0(_a(St),pe)+P+g0(ms(St),pe)}function eI(P,H,pe){P=Kn(P),H=Wn(H);var je=H?_o(P):0;return H&&je<H?P+g0(H-je,pe):P}function tI(P,H,pe){P=Kn(P),H=Wn(H);var je=H?_o(P):0;return H&&je<H?g0(H-je,pe)+P:P}function iI(P,H,pe){return pe||H==null?H=0:H&&(H=+H),Zn(Kn(P).replace(Xe,""),H||0)}function nI(P,H,pe){return(pe?bu(P,H,pe):H===n)?H=1:H=Wn(H),A0(Kn(P),H)}function rI(){var P=arguments,H=Kn(P[0]);return P.length<3?H:H.replace(P[1],P[2])}var sI=Wh(function(P,H,pe){return P+(pe?"_":"")+H.toLowerCase()});function aI(P,H,pe){return pe&&typeof pe!="number"&&bu(P,H,pe)&&(H=pe=n),pe=pe===n?Ii:pe>>>0,pe?(P=Kn(P),P&&(typeof H=="string"||H!=null&&!fn(H))&&(H=xu(H),!H&&kl(P))?Tc(ea(P),0,pe):P.split(H,pe)):[]}var oI=Wh(function(P,H,pe){return P+(pe?" ":"")+b1(H)});function lI(P,H,pe){return P=Kn(P),pe=pe==null?0:Gi(Wn(pe),0,P.length),H=xu(H),P.slice(pe,pe+H.length)==H}function uI(P,H,pe){var je=R.templateSettings;pe&&bu(P,H,pe)&&(H=n),P=Kn(P),H=va({},H,je,wp);var St=va({},H.imports,je.imports,wp),qt=co(St),ui=ll(St,qt),di,Mi,cn=0,An=H.interpolate||Jt,yn="__p += '",Yn=jn((H.escape||Jt).source+"|"+An.source+"|"+(An===de?oi:Jt).source+"|"+(H.evaluate||Jt).source+"|$","g"),br="//# sourceURL="+(os.call(H,"sourceURL")?(H.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++pl+"]")+`
`;P.replace(Yn,function($r,sa,pa,Ah,pc,fh){return pa||(pa=Ah),yn+=P.slice(cn,fh).replace(wn,Tl),sa&&(di=!0,yn+=`' +
__e(`+sa+`) +
'`),pc&&(Mi=!0,yn+=`';
`+pc+`;
__p += '`),pa&&(yn+=`' +
((__t = (`+pa+`)) == null ? '' : __t) +
'`),cn=fh+$r.length,$r}),yn+=`';
`;var Wr=os.call(H,"variable")&&H.variable;if(!Wr)yn=`with (obj) {
`+yn+`
}
`;else if(o.test(Wr))throw new ni(a);yn=(Mi?yn.replace(Ze,""):yn).replace(Ue,"$1").replace(dt,"$1;"),yn="function("+(Wr||"obj")+`) {
`+(Wr?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(di?", __e = _.escape":"")+(Mi?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+yn+`return __p
}`;var js=O2(function(){return xi(qt,br+"return "+yn).apply(n,ui)});if(js.source=yn,qe(js))throw js;return js}function cI(P){return Kn(P).toLowerCase()}function hI(P){return Kn(P).toUpperCase()}function AI(P,H,pe){if(P=Kn(P),P&&(pe||H===n))return Mr(P);if(!P||!(H=xu(H)))return P;var je=ea(P),St=ea(H),qt=Po(je,St),ui=ul(je,St)+1;return Tc(je,qt,ui).join("")}function fI(P,H,pe){if(P=Kn(P),P&&(pe||H===n))return P.slice(0,Ea(P)+1);if(!P||!(H=xu(H)))return P;var je=ea(P),St=ul(je,ea(H))+1;return Tc(je,0,St).join("")}function dI(P,H,pe){if(P=Kn(P),P&&(pe||H===n))return P.replace(Xe,"");if(!P||!(H=xu(H)))return P;var je=ea(P),St=Po(je,ea(H));return Tc(je,St).join("")}function pI(P,H){var pe=mt,je=xt;if(Pt(H)){var St="separator"in H?H.separator:St;pe="length"in H?Wn(H.length):pe,je="omission"in H?xu(H.omission):je}P=Kn(P);var qt=P.length;if(kl(P)){var ui=ea(P);qt=ui.length}if(pe>=qt)return P;var di=pe-_o(je);if(di<1)return je;var Mi=ui?Tc(ui,0,di).join(""):P.slice(0,di);if(St===n)return Mi+je;if(ui&&(di+=Mi.length-di),fn(St)){if(P.slice(di).search(St)){var cn,An=Mi;for(St.global||(St=jn(St.source,Kn(fi.exec(St))+"g")),St.lastIndex=0;cn=St.exec(An);)var yn=cn.index;Mi=Mi.slice(0,yn===n?di:yn)}}else if(P.indexOf(xu(St),di)!=di){var Yn=Mi.lastIndexOf(St);Yn>-1&&(Mi=Mi.slice(0,Yn))}return Mi+je}function mI(P){return P=Kn(P),P&&se.test(P)?P.replace(rt,Pa):P}var gI=Wh(function(P,H,pe){return P+(pe?" ":"")+H.toUpperCase()}),b1=kc("toUpperCase");function F2(P,H,pe){return P=Kn(P),H=pe?n:H,H===n?go(P)?lu(P):gu(P):P.match(H)||[]}var O2=_s(function(P,H){try{return As(P,n,H)}catch(pe){return qe(pe)?pe:new ni(pe)}}),_I=Mc(function(P,H){return ro(H,function(pe){pe=ys(pe),Si(P,pe,rA(P[pe],P))}),P});function yI(P){var H=P==null?0:P.length,pe=Tr();return P=H?Gs(P,function(je){if(typeof je[1]!="function")throw new Xn(S);return[pe(je[0]),je[1]]}):[],_s(function(je){for(var St=-1;++St<H;){var qt=P[St];if(As(qt[0],this,je))return As(qt[1],this,je)}})}function vI(P){return Bn(un(P,ae))}function w1(P){return function(){return P}}function xI(P,H){return P==null||P!==P?H:P}var bI=xA(),wI=xA(!0);function Nc(P){return P}function S1(P){return Cc(typeof P=="function"?P:un(P,ae))}function SI(P){return qh(un(P,ae))}function II(P,H){return of(P,un(H,ae))}var EI=_s(function(P,H){return function(pe){return Yl(pe,P,H)}}),CI=_s(function(P,H){return function(pe){return Yl(P,pe,H)}});function I1(P,H,pe){var je=co(H),St=rs(H,je);pe==null&&!(Pt(H)&&(St.length||!je.length))&&(pe=H,H=P,P=this,St=rs(H,co(H)));var qt=!(Pt(pe)&&"chain"in pe)||!!pe.chain,ui=ft(P);return ro(St,function(di){var Mi=H[di];P[di]=Mi,ui&&(P.prototype[di]=function(){var cn=this.__chain__;if(qt||cn){var An=P(this.__wrapped__),yn=An.__actions__=xl(this.__actions__);return yn.push({func:Mi,args:arguments,thisArg:P}),An.__chain__=cn,An}return Mi.apply(P,$o([this.value()],arguments))})}),P}function TI(){return Bs._===this&&(Bs._=Pn),this}function E1(){}function kI(P){return P=Wn(P),_s(function(H){return lf(H,P)})}var MI=Xh(Gs),PI=Xh(Wl),DI=Xh(Sa);function N2(P){return CA(P)?fr(ys(P)):Z0(P)}function LI(P){return function(H){return P==null?n:ss(P,H)}}var BI=bp(),zI=bp(!0);function C1(){return[]}function T1(){return!1}function RI(){return{}}function FI(){return""}function OI(){return!0}function NI(P,H){if(P=Wn(P),P<1||P>Bt)return[];var pe=Ii,je=gs(P,Ii);H=Tr(H),P-=Ii;for(var St=Zr(je,H);++pe<P;)H(pe);return St}function VI(P){return f(P)?Gs(P,ys):Dn(P)?[P]:xl(hd(Kn(P)))}function UI(P){var H=++$u;return Kn(P)+H}var GI=bA(function(P,H){return P+H},0),qI=xf("ceil"),HI=bA(function(P,H){return P/H},1),jI=xf("floor");function ZI(P){return P&&P.length?zs(P,Nc,Ws):n}function QI(P,H){return P&&P.length?zs(P,Tr(H,2),Ws):n}function WI(P){return is(P,Nc)}function $I(P,H){return is(P,Tr(H,2))}function XI(P){return P&&P.length?zs(P,Nc,Xc):n}function YI(P,H){return P&&P.length?zs(P,Tr(H,2),Xc):n}var KI=bA(function(P,H){return P*H},1),JI=xf("round"),eE=bA(function(P,H){return P-H},0);function tE(P){return P&&P.length?ns(P,Nc):0}function iE(P,H){return P&&P.length?ns(P,Tr(H,2)):0}return R.after=uh,R.ary=nA,R.assign=za,R.assignIn=to,R.assignInWith=va,R.assignWith=qo,R.at=uo,R.before=jA,R.bind=rA,R.bindAll=_I,R.bindKey=B0,R.castArray=m,R.chain=Id,R.chunk=nh,R.compact=PA,R.concat=kp,R.cond=yI,R.conforms=vI,R.constant=w1,R.countBy=kd,R.create=ra,R.curry=Up,R.curryRight=Fd,R.debounce=Od,R.defaults=wr,R.defaultsDeep=wo,R.defer=ZA,R.delay=Bl,R.difference=x0,R.differenceBy=DA,R.differenceWith=Mp,R.drop=fd,R.dropRight=dd,R.dropRightWhile=Rm,R.dropWhile=Fm,R.fill=Om,R.filter=Df,R.flatMap=Dd,R.flatMapDeep=bl,R.flatMapDepth=qA,R.flatten=fl,R.flattenDeep=b0,R.flattenDepth=w0,R.flip=Rc,R.flow=bI,R.flowRight=wI,R.fromPairs=Dc,R.functions=qu,R.functionsIn=Hu,R.groupBy=Ld,R.initial=zA,R.intersection=Cf,R.intersectionBy=Tf,R.intersectionWith=Su,R.invert=qp,R.invertBy=Nd,R.invokeMap=Np,R.iteratee=S1,R.keyBy=Bd,R.keys=co,R.keysIn=So,R.map=lh,R.mapKeys=Gf,R.mapValues=Hp,R.matches=SI,R.matchesProperty=II,R.memoize=Mh,R.merge=qm,R.mergeWith=jp,R.method=EI,R.methodOf=CI,R.mixin=I1,R.negate=QA,R.nthArg=kI,R.omit=Hm,R.omitBy=tu,R.once=WA,R.orderBy=zd,R.over=MI,R.overArgs=Rf,R.overEvery=PI,R.overSome=DI,R.partial=z0,R.partialRight=Ff,R.partition=Ac,R.pick=ju,R.pickBy=Ph,R.property=N2,R.propertyOf=LI,R.pull=FA,R.pullAll=rh,R.pullAllBy=OA,R.pullAllWith=I0,R.pullAt=Nm,R.range=BI,R.rangeRight=zI,R.rearg=Of,R.reject=Bf,R.remove=md,R.rest=Nf,R.reverse=kh,R.sampleSize=Um,R.set=iu,R.setWith=Zu,R.shuffle=Gm,R.slice=Lc,R.sortBy=iA,R.sortedUniq=C0,R.sortedUniqBy=Mf,R.split=aI,R.spread=R0,R.tail=Ku,R.take=Bc,R.takeRight=tA,R.takeRightWhile=T0,R.takeWhile=Pp,R.tap=Fp,R.throttle=Vf,R.thru=UA,R.toArray=ia,R.toPairs=jm,R.toPairsIn=Fg,R.toPath=VI,R.toPlainObject=na,R.transform=v1,R.unary=Uf,R.union=yd,R.unionBy=Pf,R.unionWith=NA,R.uniq=Dp,R.uniqBy=vd,R.uniqWith=xd,R.unset=x1,R.unzip=ah,R.unzipWith=bd,R.update=Iu,R.updateWith=dc,R.values=Oc,R.valuesIn=hh,R.without=Lp,R.words=F2,R.wrap=Gp,R.xor=wd,R.xorBy=Bp,R.xorWith=VA,R.zip=oh,R.zipObject=zp,R.zipObjectDeep=Rp,R.zipWith=Sd,R.entries=jm,R.entriesIn=Fg,R.extend=to,R.extendWith=va,I1(R,R),R.add=GI,R.attempt=O2,R.camelCase=Z5,R.capitalize=z2,R.ceil=qI,R.clamp=qf,R.clone=h,R.cloneDeep=M,R.cloneDeepWith=q,R.cloneWith=b,R.conformsTo=K,R.deburr=R2,R.defaultTo=xI,R.divide=HI,R.endsWith=Q5,R.eq=J,R.escape=W5,R.escapeRegExp=$5,R.every=P0,R.find=Md,R.findIndex=pd,R.findKey=nl,R.findLast=Pd,R.findLastIndex=LA,R.findLastKey=rl,R.floor=jI,R.forEach=D0,R.forEachRight=L0,R.forIn=Pu,R.forInRight=Gu,R.forOwn=zl,R.forOwnRight=Fc,R.get=eu,R.gt=me,R.gte=Ce,R.has=ch,R.hasIn=sA,R.head=BA,R.identity=Nc,R.includes=Op,R.indexOf=Ef,R.inRange=Dh,R.invoke=Vd,R.isArguments=Ne,R.isArray=f,R.isArrayBuffer=u,R.isArrayLike=p,R.isArrayLikeObject=I,R.isBoolean=L,R.isBuffer=G,R.isDate=Q,R.isElement=re,R.isEmpty=Ae,R.isEqual=_e,R.isEqualWith=Le,R.isError=qe,R.isFinite=tt,R.isFunction=ft,R.isInteger=gt,R.isLength=Mt,R.isMap=ei,R.isMatch=Ht,R.isMatchWith=Qt,R.isNaN=hi,R.isNative=_i,R.isNil=Sn,R.isNull=Xi,R.isNumber=ln,R.isObject=Pt,R.isObjectLike=Lt,R.isPlainObject=on,R.isRegExp=fn,R.isSafeInteger=zn,R.isSet=an,R.isString=$i,R.isSymbol=Dn,R.isTypedArray=Nn,R.isUndefined=pr,R.isWeakMap=Vr,R.isWeakSet=Hr,R.join=S0,R.kebabCase=X5,R.last=ku,R.lastIndexOf=Th,R.lowerCase=Y5,R.lowerFirst=K5,R.lt=Rs,R.lte=Ta,R.max=ZI,R.maxBy=QI,R.mean=WI,R.meanBy=$I,R.min=XI,R.minBy=YI,R.stubArray=C1,R.stubFalse=T1,R.stubObject=RI,R.stubString=FI,R.stubTrue=OI,R.multiply=KI,R.nth=RA,R.noConflict=TI,R.noop=E1,R.now=Ro,R.pad=J5,R.padEnd=eI,R.padStart=tI,R.parseInt=iI,R.random=j5,R.reduce=Rd,R.reduceRight=Lf,R.repeat=nI,R.replace=rI,R.result=fc,R.round=JI,R.runInContext=pi,R.sample=zf,R.size=Vp,R.snakeCase=sI,R.some=HA,R.sortedIndex=sh,R.sortedIndexBy=gd,R.sortedIndexOf=kf,R.sortedLastIndex=_d,R.sortedLastIndexBy=Vm,R.sortedLastIndexOf=E0,R.startCase=oI,R.startsWith=lI,R.subtract=eE,R.sum=tE,R.sumBy=iE,R.template=uI,R.times=NI,R.toFinite=as,R.toInteger=Wn,R.toLength=Is,R.toLower=cI,R.toNumber=tr,R.toSafeInteger=Ls,R.toString=Kn,R.toUpper=hI,R.trim=AI,R.trimEnd=fI,R.trimStart=dI,R.truncate=pI,R.unescape=mI,R.uniqueId=UI,R.upperCase=gI,R.upperFirst=b1,R.each=D0,R.eachRight=L0,R.first=BA,I1(R,function(){var P={};return bo(R,function(H,pe){os.call(R.prototype,pe)||(P[pe]=H)}),P}(),{chain:!1}),R.VERSION=c,ro(["bind","bindKey","curry","curryRight","partial","partialRight"],function(P){R[P].placeholder=R}),ro(["drop","take"],function(P,H){we.prototype[P]=function(pe){pe=pe===n?1:yr(Wn(pe),0);var je=this.__filtered__&&!H?new we(this):this.clone();return je.__filtered__?je.__takeCount__=gs(pe,je.__takeCount__):je.__views__.push({size:gs(pe,Ii),type:P+(je.__dir__<0?"Right":"")}),je},we.prototype[P+"Right"]=function(pe){return this.reverse()[P](pe).reverse()}}),ro(["filter","map","takeWhile"],function(P,H){var pe=H+1,je=pe==$e||pe==ut;we.prototype[P]=function(St){var qt=this.clone();return qt.__iteratees__.push({iteratee:Tr(St,3),type:pe}),qt.__filtered__=qt.__filtered__||je,qt}}),ro(["head","last"],function(P,H){var pe="take"+(H?"Right":"");we.prototype[P]=function(){return this[pe](1).value()[0]}}),ro(["initial","tail"],function(P,H){var pe="drop"+(H?"":"Right");we.prototype[P]=function(){return this.__filtered__?new we(this):this[pe](1)}}),we.prototype.compact=function(){return this.filter(Nc)},we.prototype.find=function(P){return this.filter(P).head()},we.prototype.findLast=function(P){return this.reverse().find(P)},we.prototype.invokeMap=_s(function(P,H){return typeof P=="function"?new we(this):this.map(function(pe){return Yl(pe,P,H)})}),we.prototype.reject=function(P){return this.filter(QA(Tr(P)))},we.prototype.slice=function(P,H){P=Wn(P);var pe=this;return pe.__filtered__&&(P>0||H<0)?new we(pe):(P<0?pe=pe.takeRight(-P):P&&(pe=pe.drop(P)),H!==n&&(H=Wn(H),pe=H<0?pe.dropRight(-H):pe.take(H-P)),pe)},we.prototype.takeRightWhile=function(P){return this.reverse().takeWhile(P).reverse()},we.prototype.toArray=function(){return this.take(Ii)},bo(we.prototype,function(P,H){var pe=/^(?:filter|find|map|reject)|While$/.test(H),je=/^(?:head|last)$/.test(H),St=R[je?"take"+(H=="last"?"Right":""):H],qt=je||/^find/.test(H);St&&(R.prototype[H]=function(){var ui=this.__wrapped__,di=je?[1]:arguments,Mi=ui instanceof we,cn=di[0],An=Mi||f(ui),yn=function(sa){var pa=St.apply(R,$o([sa],di));return je&&Yn?pa[0]:pa};An&&pe&&typeof cn=="function"&&cn.length!=1&&(Mi=An=!1);var Yn=this.__chain__,br=!!this.__actions__.length,Wr=qt&&!Yn,js=Mi&&!br;if(!qt&&An){ui=js?ui:new we(this);var $r=P.apply(ui,di);return $r.__actions__.push({func:UA,args:[yn],thisArg:n}),new oe($r,Yn)}return Wr&&js?P.apply(this,di):($r=this.thru(yn),Wr?je?$r.value()[0]:$r.value():$r)})}),ro(["pop","push","shift","sort","splice","unshift"],function(P){var H=Hs[P],pe=/^(?:push|sort|unshift)$/.test(P)?"tap":"thru",je=/^(?:pop|shift)$/.test(P);R.prototype[P]=function(){var St=arguments;if(je&&!this.__chain__){var qt=this.value();return H.apply(f(qt)?qt:[],St)}return this[pe](function(ui){return H.apply(f(ui)?ui:[],St)})}}),bo(we.prototype,function(P,H){var pe=R[H];if(pe){var je=pe.name+"";os.call(ws,je)||(ws[je]=[]),ws[je].push({name:H,func:pe})}}),ws[$h(n,it).name]=[{name:"wrapper",func:n}],we.prototype.clone=We,we.prototype.reverse=yt,we.prototype.value=Ct,R.prototype.at=k0,R.prototype.chain=M0,R.prototype.commit=zc,R.prototype.next=Ed,R.prototype.plant=GA,R.prototype.reverse=Cd,R.prototype.toJSON=R.prototype.valueOf=R.prototype.value=Td,R.prototype.first=R.prototype.head,Vl&&(R.prototype[Vl]=Mu),R},ao=gl();mo?((mo.exports=ao)._=ao,Il._=ao):Bs._=ao}).call(Jf)})(U_,U_.exports);var F9=U_.exports;function e5(e,t,n){let c=[e],g=[],x,S,a;for(;e=c.pop();)if(!(n&&n(e))&&(g.push(e),x=e.children,x))for(S=0,a=x.length;S<a;++S)c.push(x[S]);for(;e=g.pop();)t(e);return e}function O9(e,t,n){let c=[e],g,x;for(;e=c.pop();)if(!(n&&n(e))&&(t(e),g=e.children,g))for(x=g.length-1;x>=0;--x)c.push(g[x]);return e}function N9(e,t,n){let c,g=[e],x,S,a;do for(c=g.reverse(),g=[];e=c.pop();)if(!(n&&n(e))&&(t(e),x=e.children,x))for(S=0,a=x.length;S<a;++S)g.push(x[S]);while(g.length);return e}function V9(e){return e5(e,function(c){c.children&&(c.children[0].data.multiway_parent=c,c.children[1].data.multiway_parent=c.parent)}),F9.map(e.descendants(),c=>{let g=c.data.multiway_parent,x="unknown";return g&&(x=g.data.name),{source:c.data.multiway_parent,target:c,name:x}})}function U9(){let e=this.branch_length;return e?vv(this.nodes.descendants(),function(t){return!t.parent||!lp(e(t))}):!1}function G9(){let e=this.branch_length;return gc(this.nodes.descendants(),t=>e(t))}function Sv(e,t){let n=e.data;if("attribute"in n&&n.attribute&&n.attribute.length){t>0&&(n.attribute=String(t));let c=parseFloat(n.attribute);if(!isNaN(c))return Math.max(0,c)}if(n.name=="root")return 0;console.warn("Undefined branch length at "+n.name+"!")}function q9(e){return arguments.length?(this.branch_length_accessor=e||Sv,this):this.branch_length_accessor}function H9(e){let t=this.branch_length,n=gc(this.nodes.descendants(),function(S){return t(S)?t(S):null});const c=v2(n),g=U4(n);let x=function(S){return(S-g)/(c-g)};return Qc(this.nodes.descendants(),S=>{let a=t(S);a&&t(S,x(a))}),this}function j9(e){let t=this.branch_length;return Qc(this.nodes.descendants(),n=>{let c=t(n);c&&t(n,e(c))}),this}function Z9(e){return arguments.length?(this.nodeLabel=e,this):this.nodeLabel}function Q9(e,t){if(!(e instanceof Kd))throw new Error("node needs to be an instance of a d3.hierarchy node!");let n=this.nodes.copy();if(t=t!==void 0?t:.5,e.parent){var c=Kd({name:"new_root"});c.children=[e.copy()],c.data.__mapped_bl=void 0,n.each(W=>{W.data.__mapped_bl=this.branch_length_accessor(W)}),this.setBranchLength(W=>W.data.__mapped_bl);let x=e,S=e.parent,a=void 0,U=e.data.__mapped_bl===void 0?void 0:e.data.__mapped_bl*t;a=S.data.__mapped_bl,S.data.__mapped_bl=e.data.__mapped_bl===void 0?void 0:e.data.__mapped_bl-U,e.data.__mapped_bl=U;var g;if(S.parent){for(c.children.push(S);S.parent;){g=S.children.indexOf(x),S.parent.parent?S.children.splice(g,1,S.parent):S.children.splice(g,1);let W=S.parent.data.__mapped_bl;W!==void 0&&(S.parent.data.__mapped_bl=a,a=W),x=S,S=S.parent}g=S.children.indexOf(x),S.children.splice(g,1)}else g=S.children.indexOf(x),S.children.splice(g,1),a=S.data.__mapped_bl,x=c;if(S.children.length==1)a&&(S.children[0].data.__mapped_bl+=a),x.children=x.children.concat(S.children);else{let W=new Kd({name:"__reroot_top_clade",__mapped_bl:a});bg(c.children[0],e),W.data.__mapped_bl=a,W.children=S.children.map(function(he){return he.parent=W,he}),W.parent=x,x.children.push(W)}}if(this.update(c),this.traverse_and_compute(x=>{Qc(x.children,S=>{S.parent=x})},"pre-order"),!lp(this.display)){let x=this.display.options;dl(this.display.container).select("svg").remove();let S=this.display.selection_attribute_name;delete this.display;let a=this.render(x);a.selectionLabel(S),a.update(),dl(a.container).node().appendChild(a.show()),dl(this.display.container).dispatch("reroot")}return this}function W9(e,t){if(e=e||"attribute",t=t||"y_scaled","parent"in this){let n=parseFloat(this[e]);this[t]=this.parent[t]+(isNaN(n)?.1:n)}else this[t]=0;return this[t]}function $9(e){let t=[];for(;e;)t.push(e),e=e.parent;return t}const X9=Object.freeze(Object.defineProperty({__proto__:null,pathToRoot:$9,reroot:Q9,rootpath:W9},Symbol.toStringTag,{value:"Module"}));function n0(e){return e.y}function ep(e){return e.x}function G_(e,t,n){return{x:n+e*Math.sin(t),y:n+e*Math.cos(t)}}function Yb(e,t,n,c,g,x){e.radius=t*(e.radius+n),e.angle=2*Math.PI*e.x*g[0]/x[0];let S=G_(e.radius,e.angle,c);return e.x=S.x,e.y=S.y,e}function Kb(e,t){var n=G_(t[0].radius,t[0].angle,e),c=G_(t[0].radius,t[1].angle,e);return"M "+n0(n)+","+ep(n)+" A "+t[0].radius+","+t[0].radius+" 0,0, "+(t[1].angle>t[0].angle?1:0)+" "+n0(c)+","+ep(c)+" L "+n0(t[1])+","+ep(t[1])}function Y9(e,t,n){var c=G_(e.target.radius+(e.source.radius-e.target.radius)*t,e.target.angle,n);return{x:n0(c),y:ep(c)}}var Jb=dv().x(function(e){return n0(e)}).y(function(e){return ep(e)}).curve(VR);function ew(e,t){return{x:n0(e.target)+(n0(e.source)-n0(e.target))*t,y:ep(e.target)}}function w2(e){return e.tag||!1}function S2(e,t){return e[t]||!1}const jo={"tree-container":"phylotree-container","tree-scale-bar":"tree-scale-bar",node:"node","internal-node":"internal-node","tagged-node":"node-tagged","selected-node":"node-selected","collapsed-node":"node-collapsed","root-node":"root-node",branch:"branch","selected-branch":"branch-selected","tagged-branch":"branch-tagged","tree-selection-brush":"tree-selection-brush","branch-tracer":"branch-tracer",clade:"clade",node_text:"phylotree-node-text"};function K9(e){return arguments.length?(this.options["internal-names"]=e,this):this.options["internal-names"]}function J9(e){return arguments.length?(this.options["is-radial"]=e,this):this.options["is-radial"]}function eF(e){return arguments.length?(this.options["align-tips"]=e,this):this.options["align-tips"]}function tF(e){return this.options["draw-size-bubbles"]&&this.options["bubble-styler"]?this.options["bubble-styler"](e):this.options["draw-size-bubbles"]?this.relative_nodeSpan(e)*this.scales[0]*.25:0}function iF(e){return this.options["is-radial"]?[(e.text_align=="end"?-1:1)*(this.radius_pad_for_bubbles-e.radius),0]:this.options["right-to-left"]?[this.right_most_leaf-e.screen_x,0]:[this.right_most_leaf-e.screen_x,0]}function nF(e){return arguments.length?(this.layout_listener_handler=e,this):this.layout_listener_handler}function rF(e){return arguments.length?(this.selection_attribute_name=e,this.syncEdgeLabels(),this):this.selection_attribute_name}function l_(e){return arguments.length?(typeof e=="string"&&e=="equal"?l_=function(t){return 1}:l_=e,this):l_}var Iv={all:e=>!0,none:e=>!1,"all-leaf-nodes":e=>Sl(e.target),"all-internal-nodes":e=>!Sl(e.target)};function sF(e){return e?(this.selectionCallback=e,this):this.selectionCallback}const aF=Object.freeze(Object.defineProperty({__proto__:null,alignTips:eF,css_classes:jo,internalNames:K9,layoutHandler:nF,nodeBubbleSize:tF,get nodeSpan(){return l_},predefined_selecters:Iv,radial:J9,selectionCallback:sF,selectionLabel:rF,shiftTip:iF},Symbol.toStringTag,{value:"Module"}));function oF(e){return this.radial()?[(e.text_align=="end"?-1:1)*(this.radius_pad_for_bubbles-e.radius),0]:this.options["right-to-left"]?[this.right_most_leaf-e.screen_x,0]:[this.right_most_leaf-e.screen_x,0]}function lF(e,t,n){e=dl(e);var c=Sl(t);c&&(e=e.attr("data-node-name",t.data.name));var g=e.selectAll("text").data([t]),x=e.selectAll("line");if(c||this.showInternalName(t)&&!up(t))if(g=g.enter().append("text").classed(this.css_classes.node_text,!0).merge(g).on("click",a=>{this.handle_node_click(t,a)}).attr("dy",a=>this.shown_font_size*.33).text(a=>this.options["show-labels"]?this._nodeLabel(a):"").style("font-size",a=>this.ensure_size_is_in_px(this.shown_font_size)),this.radial()?g=g.attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)+this.d3PhylotreeSvgTranslate(this.alignTips()?this.shiftTip(a):null)).attr("text-anchor",a=>a.text_align):g=g.attr("text-anchor","start").attr("transform",a=>this.options.layout=="right-to-left"?this.d3PhylotreeSvgTranslate([-20,0]):this.d3PhylotreeSvgTranslate(this.alignTips()?this.shiftTip(a):null)),this.alignTips()?(x=x.data([t]),n?x=x.enter().append("line").classed(this.css_classes["branch-tracer"],!0).merge(x).attr("x1",a=>(a.text_align=="end"?-1:1)*this.nodeBubbleSize(t)).attr("x2",0).attr("y1",0).attr("y2",0).attr("x2",a=>this.options.layout=="right-to-left"?a.screen_x:this.shiftTip(a)[0]).attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)).attr("x2",a=>this.options.layout=="right-to-left"?a.screen_x:this.shiftTip(a)[0]).attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)):(x=x.enter().append("line").classed(this.css_classes["branch-tracer"],!0).merge(x).attr("x1",a=>(a.text_align=="end"?-1:1)*this.nodeBubbleSize(t)).attr("y2",0).attr("y1",0).attr("x2",a=>this.shiftTip(a)[0]),x.attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)))):x.remove(),this.options["draw-size-bubbles"]){var S=this.nodeBubbleSize(t);e.selectAll("circle").data([S]).enter().append("circle").attr("r",function(U){return U}),this.shown_font_size>=5&&(g=g.attr("dx",U=>(U.text_align=="end"?-1:1)*((this.alignTips()?0:S)+this.shown_font_size*.33)))}else this.shown_font_size>=5&&(g=g.attr("dx",a=>(a.text_align=="end"?-1:1)*this.shown_font_size*.33));if(!c){let a=e.selectAll("circle").data([t]).enter().append("circle"),U=this.node_circle_size()(t);U>0?a.merge(a).attr("r",W=>Math.min(this.shown_font_size*.75,U)).on("click",W=>{this.handle_node_click(t,W)}):a.remove()}return this.node_styler&&this.node_styler(e,t),t}function uF(){let e=this.phylotree.nodes.descendants();for(let t=e.length-1;t>=0;t-=1)Sl(e[t])?e[t].hasHiddenNodes=e[t].notshown:e[t].hasHiddenNodes=e[t].children.reduce(function(n,c){return c.notshown||n},!1);return this}function cF(e){const t=this.internalNames();return t?typeof t=="function"?t(e):t:!1}function hF(e){return arguments.length?(typeof e=="string"&&e=="equal"?this.nodeSpan=function(t){return 1}:this.nodeSpan=e,this):this.nodeSpan}function AF(e){let t=jo[Sl(e)?"node":"internal-node"];return w2(e)&&(t+=" "+jo["tagged-node"]),S2(e,this.selection_attribute_name)&&(t+=" "+jo["selected-node"]),e.parent||(t+=" "+jo["root-node"]),(up(e)||I2(e))&&(t+=" "+jo["collapsed-node"]),t}function Ev(e){return!(e.hidden||e.notshown)}function t5(e){return e.notshown}function I2(e){return e.hasHiddenNodes||!1}function up(e){return e.collapsed||!1}function i5(e){return[e.node,e["internal-node"],e["collapsed-node"],e["tagged-node"],e["root-node"]].reduce(function(t,n,c,g){return t+="g."+n+(c<g.length-1?",":"")},"")}function fF(e,t){this.phylotree.clearInternalNodes(t);for(var n=this.phylotree.nodes.descendants().length-1;n>=0;n--){var c=this.phylotree.nodes.descendants()[n];Sl(c)||S2(c,this.selection_attribute_name)||(c[this.selection_attribute_name]=e(c.children))}this.modifySelection((g,x)=>Sl(g.target)?g.target[this.selection_attribute_name]:g.target[this.selection_attribute_name])}function n5(e){return e=e.data,Sl(e)?e.name||"":this.showInternalName(e)?e.name:""}function dF(e){return arguments.length?(this._nodeLabel=e||n5,this.update(),this):this._nodeLabel}const pF=Object.freeze(Object.defineProperty({__proto__:null,defNodeLabel:n5,drawNode:lF,hasHiddenNodes:I2,internalLabel:fF,isNodeCollapsed:up,nodeCssSelectors:i5,nodeLabel:dF,nodeNotshown:t5,nodeSpan:hF,nodeVisible:Ev,reclassNode:AF,shiftTip:oF,showInternalName:cF,updateHasHiddenNodes:uF},Symbol.toStringTag,{value:"Module"}));function r5(e){return[e.clade].reduce(function(t,n,c,g){return t+="path."+n+(c<g.length-1?",":"")},"")}function mF(e){let t=this.svg.selectAll("."+this.css_classes["tree-container"]);var n=0;let c=t.selectAll(r5(this.css_classes)).data(this.phylotree.nodes.descendants().filter(up),function(S){return S.id||(S.id=++n)}),g=function(){},x=void 0;this.radial()?(g=dv().curve(Nb).y(function(S){return S[0]}).x(function(S){return S[1]}),x=function(S,a,U,W,he){return a?[U.screen_y+(S[0]-W)/50,U.screen_x+(S[1]-he)/50]:[U.screen_y,U.screen_x]}):(g=dv().y(function(S){return S[0]}).x(function(S){return S[1]}).curve(Nb),x=function(S,a,U,W,he){return a?[U.screen_y+(S[0]-W)/50,U.screen_x+(S[1]-he)/50]:[U.screen_y,U.screen_x]}),c.exit().each(function(S){S.collapsed_clade=null}).remove(),e?c.enter().insert("path",":first-child").attr("class",this.css_classes.clade).merge(c).attr("d",function(S){if(S.collapsed_clade)return S.collapsed_clade;let a=S.collapsed[0][0],U=S.collapsed[0][1];return g(S.collapsed.map(function(W,he){return x(W,he,S,a,U)}))}).attr("d",function(S){return S.collapsed_clade=g(S.collapsed)}):c.enter().insert("path",":first-child").attr("class",this.css_classes.clade).merge(c).attr("d",function(S){return S.collapsed_clade?S.collapsed_clade:S.collapsed_clade=g(S.collapsed)})}const gF=Object.freeze(Object.defineProperty({__proto__:null,cladeCssSelectors:r5,updateCollapsedClades:mF},Symbol.toStringTag,{value:"Module"}));function _F(e,t,n){e=dl(e),e=e.attr("class",S=>this.reclassEdge(S)).on("click",S=>{this.modifySelection([t.target],this.selection_attribute_name),this.update()});let c=this.draw_branch([t.source,t.target]);n&&e.datum().existing_path&&(e=e.attr("d",function(S){return S.existing_path})),e=e.attr("d",c),t.existing_path=c;var g=this.phylotree.branch_length_accessor(t.target);if(g!==void 0){var x=e.selectAll("title");x.empty()&&(x=e.append("title")),x.text("Length = "+g)}else e.selectAll("title").remove();return this.edge_styler&&this.edge_styler(e,t,n),this.phylotree}function yF(e){let t=jo.branch;return w2(e)&&(t+=" "+jo["tagged-branch"]),S2(e,this.selection_attribute_name)&&(t+=" "+jo["selected-branch"]),t}function vF(){this.links.forEach(e=>{e.target.data.annotation&&(e.target[e.target.data.annotation]=e.target.data.annotation)})}function xF(){if(this.links.forEach(e=>{e[this.selection_attribute_name]=e.target[this.selection_attribute_name]||!1,e.tag=e.target.tag||!1}),this.countHandler()){let e={};e[this.selection_attribute_name]=this.links.reduce((t,n)=>t+(n[this.selection_attribute_name]?1:0),0),e.tagged=this.links.reduce(function(t,n){return t+(w2(n)?1:0)},0),this.countUpdate(this,e,this.countHandler())}}function Cv(e){return!(e.target.hidden||e.target.notshown)}function Tv(e){return[e.branch,e["selected-branch"],e["tagged-branch"]].reduce(function(t,n,c,g){return t+="path."+n+(c<g.length-1?",":"")},"")}function bF(e,t){return this.edge_placer(e,t)}const wF=Object.freeze(Object.defineProperty({__proto__:null,drawEdge:_F,edgeCssSelectors:Tv,edgeVisible:Cv,initializeEdgeLabels:vF,placeAlongAnEdge:bF,reclassEdge:yF,syncEdgeLabels:xF},Symbol.toStringTag,{value:"Module"}));let u1="phylotree.event";function SF(e){if(e.collapsed){e.collapsed=!1;let t=function(n){Sl(n)||n.collapsed||n.children.forEach(t),n.hidden=!1};t(e)}else e.collapsed=!0;return this.placenodes(),this}function IF(e,t,n){let c=this.size;if(this.radial()){let g=this.pad_width(),x=this.options["top-bottom-spacing"]!="fit-to-size"?this.pad_height():0;c=[c[1]+2*g,c[0]+2*g+x],t&&t.selectAll("."+jo["tree-container"]).attr("transform","translate ("+g+","+(g+x)+")")}else c=[c[0]+(this.options["top-bottom-spacing"]!="fit-to-size"?this.pad_height():0),c[1]+(this.options["left-right-spacing"]!="fit-to-size"?this.pad_width():0)];return t&&(n&&(t=t.transition(100)),t.attr("height",c[0]).attr("width",c[1])),this.size=c,c}function EF(e,t){t=t||"y_scaled",t in this&&(this[t]*=e)}function kv(e){var t=new CustomEvent(u1,{detail:["refresh",e]});document.dispatchEvent(t)}function s5(e,t){var n=new CustomEvent(u1,{detail:["countUpdate",t,e.countHandler()]});document.dispatchEvent(n)}function CF(e){var t=new CustomEvent(u1,{detail:["layout",e,e.layoutHandler()]});document.dispatchEvent(t)}function a5(e){switch(e.detail[0]){case"refresh":e.detail[1].refresh();break;case"countUpdate":e.detail[2](e.detail[1]);break;case"layout":e.detail[2](e.detail[1])}return!0}function o5(){document.addEventListener(u1,a5,!1)}function TF(e){return e&&(e[0]!==null||e[1]!==null)?"translate ("+(e[0]!==null?e[0]:0)+","+(e[1]!==null?e[1]:0)+") ":""}function kF(e){return e!==null?"rotate ("+e+") ":""}const MF=Object.freeze(Object.defineProperty({__proto__:null,countUpdate:s5,d3PhylotreeAddEventListener:o5,d3PhylotreeEventListener:a5,d3PhylotreeSvgRotate:kF,d3PhylotreeSvgTranslate:TF,d3PhylotreeTriggerLayout:CF,rescale:EF,resizeSvg:IF,toggleCollapse:SF,triggerRefresh:kv},Symbol.toStringTag,{value:"Module"}));let tw="d3_layout_phylotree_context_menu";function PF(e,t,n,c,g){let x=dl(t).select("#"+tw);if(x.empty()&&(x=dl(t).append("div").attr("id",tw).attr("class","dropdown-menu").attr("role","menu")),x.selectAll("a").remove(),x.selectAll("h6").remove(),x.selectAll("div").remove(),e){if(!V_([!!e.menu_items,c.hide,c.selectable,c.collapsible])||!c["show-menu"])return;Sl(e)||(c.collapsible&&(x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text(up(e)?"Expand Subtree":"Collapse Subtree").on("click",W=>{x.style("display","none"),this.toggleCollapse(e).update()}),c.selectable&&(x.append("div").attr("class","dropdown-divider"),x.append("h6").attr("class","dropdown-header").text("Toggle selection"))),c.selectable&&(x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("All descendant branches").on("click",function(W){x.style("display","none"),n.modifySelection(n.selectAllDescendants(e,!0,!0))}),x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("All terminal branches").on("click",function(W){x.style("display","none"),n.modifySelection(n.selectAllDescendants(e,!0,!1))}),x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("All internal branches").on("click",function(W){x.style("display","none"),n.modifySelection(n.selectAllDescendants(e,!1,!0))}))),e.parent&&(c.selectable&&(x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Incident branch").on("click",function(W){x.style("display","none"),n.modifySelection([e])}),x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Path to root").on("click",W=>{x.style("display","none"),this.modifySelection(this.phylotree.pathToRoot(e))}),(c.reroot||c.hide)&&x.append("div").attr("class","dropdown-divider")),c.reroot&&x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Reroot on this node").on("click",W=>{x.style("display","none"),this.phylotree.reroot(e),this.update()}),c.hide&&x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Hide this "+(Sl(e)?"node":"subtree")).on("click",W=>{x.style("display","none"),this.modifySelection([e],"notshown",!0,!0).updateHasHiddenNodes().update()})),I2(e)&&x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Show all descendant nodes").on("click",function(W){x.style("display","none"),n.modifySelection(n.selectAllDescendants(e,!0,!0),"notshown",!0,!0,"false").updateHasHiddenNodes().update()});var S=[];if("menu_items"in e&&typeof e.menu_items=="object"&&e.menu_items.forEach(function(W){W.length==3&&(!W[2]||W[2](e))&&S.push([W[0],W[1]])}),S.length){const W=[c.hide,c.selectable,c.collapsible];V_(W)&&x.append("div").attr("class","dropdown-divider"),S.forEach(function(he){x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text(he[0](e)).on("click",nf(he[1],e))})}let U=document.querySelector(t).getBoundingClientRect();x.style("position","absolute").style("left",""+(g.clientX-U.x+12)+"px").style("top",""+(g.clientY-U.y)+"px").style("display","block")}else x.style("display","none")}function DF(e,t,n,c){"menu_items"in e||(e.menu_items=[]),e.menu_items.some(function(g){return g[0]==t&&g[1]==n&&g[2]==c})||e.menu_items.push([t,n,c])}function LF(e,t,n,c,g){if(t=t||this.selection_attribute_name,g=g||"toggle",this.options["restricted-selectable"].length)if(JA(pu(Iv),e))e=Iv[e];else return;if((this.options["restricted-selectable"]||this.options.selectable)&&!this.options["binary-selectable"]){var x=!1;typeof e=="function"?this.links.forEach(function(a){let U=e(a);a[t]=a[t]||!1,a[t]!=U&&(a[t]=U,x=!0,a.target[t]=U)}):(e.forEach(function(a){var U;switch(g){case"true":U=!0;break;case"false":U=!1;break;default:U=!a[t];break}a[t]!=U&&(a[t]=U,x=!0)}),this.links.forEach(function(a){a[t]=a.target[t]}));var S;x&&(c||kv(this),this.countHandler&&(S={},S[t]=this.links.reduce(function(a,U){return a+(U[t]?1:0)},0),s5(this,S,this.countHandler)),n&&this.placenodes())}else this.options["binary-selectable"]&&(typeof e=="function"?this.links.forEach(function(a){var U=e(a);a[t]=a[t]||!1,a[t]!=U&&(a[t]=U,x=!0,a.target[t]=U),this.options["attribute-list"].forEach(function(W){W!=t&&a[t]===!0&&(a[W]=!1,a.target[W]=!1)})}):(e.forEach(function(a){var U;U=!a[t],a[t]!=U&&(a[t]=U,x=!0)}),this.links.forEach(function(a){a[t]=a.target[t],this.options["attribute-list"].forEach(function(U){U!=t&&a[t]!==!0&&(a[U]=!1,a.target[U]=!1)})})),x&&(c||kv(this),this.countHandler()&&(S={},S[t]=this.links.reduce(function(a,U){return a+(U[t]?1:0)},0),this.countUpdate(this,S,this.countHandler())),n&&this.placenodes()));return this.selectionCallback&&t!="tag"&&this.selectionCallback(this.getSelection()),this.refresh(),this.update(),this}function BF(){return this.nodes.filter(e=>e[this.selection_attribute_name])}function zF(e,t,n){let c=[];function g(x){Sl(x)?t&&x!=e&&c.push(x):(n&&x!=e&&c.push(x),x.children.forEach(g))}return g(e),c}function RF(e){return e?(this.selectionCallback=e,this):this.selectionCallback}const FF=Object.freeze(Object.defineProperty({__proto__:null,addCustomMenu:DF,getSelection:BF,modifySelection:LF,nodeDropdownMenu:PF,selectAllDescendants:zF,selectionCallback:RF},Symbol.toStringTag,{value:"Module"}));function iw(e){return function(){return e}}class gp{constructor(t,n={}){this.css_classes=jo,this.phylotree=t,this.container=n.container,this.separation=function(g,x){return 0},this._nodeLabel=this.defNodeLabel,this.svg=null,this.selectionCallback=null,this.scales=[1,1],this.size=[1,1],this.fixed_width=[14,30],this.scale_bar_font_size=12,this.draw_branch=Jb,this.draw_scale_bar=null,this.edge_placer=ew,this.count_listener_handler=function(){},this.layout_listener_handler=function(){},this.node_styler=void 0,this.edge_styler=void 0,this.selection_attribute_name="selected",this.right_most_leaf=0,this.label_width=0,this.radial_center=0,this.radius=1,this.radius_pad_for_bubbles=0,this.rescale_nodeSpan=1,this.relative_nodeSpan=function(g){return this.nodeSpan(g)/this.rescale_nodeSpan};let c={layout:"left-to-right",logger:console,branches:"step",scaling:!0,bootstrap:!1,"color-fill":!0,"font-size":14,"internal-names":!1,selectable:!0,"restricted-selectable":!1,collapsible:!0,"left-right-spacing":"fixed-step","top-bottom-spacing":"fixed-step","left-offset":0,"show-scale":"top","draw-size-bubbles":!1,"bubble-styler":this.radius_pad_for_bubbles,"binary-selectable":!1,"is-radial":!1,"attribute-list":[],"max-radius":768,"annular-limit":.38196601125010515,compression:.2,"align-tips":!1,"maximum-per-node-spacing":100,"minimum-per-node-spacing":2,"maximum-per-level-spacing":100,"minimum-per-level-spacing":10,node_circle_size:iw(3),transitions:null,brush:!0,reroot:!0,hide:!0,"label-nodes-with-name":!1,zoom:!1,"show-menu":!0,"show-labels":!0,"node-styler":null,"edge-styler":null,"node-span":null};this.ensure_size_is_in_px=function(g){return typeof g=="number"?g+"px":g},this.options=f2(n,c),this.font_size=this.options["font-size"],this.offsets=[0,this.font_size/2],this.shown_font_size=this.font_size,this.width=this.options.width||800,this.height=this.options.height||600,this.node_styler=this.options["node-styler"],this.edge_styler=this.options["edge-styler"],this.nodeSpan=this.options["node-span"],this.nodeSpan||(this.nodeSpan=function(g){return 1}),this.rescale_nodeSpan=this.phylotree.nodes.children.map(g=>{if(Sl(g)||this.showInternalName(g))return this.nodeSpan(g)}).reduce(function(g,x){return Math.min(x,g||1e200)},null)||1,this.initialize_svg(this.container),this.links=this.phylotree.nodes.links(),this.initializeEdgeLabels(),this.update(),o5()}pad_height(){return this.draw_scale_bar?this.scale_bar_font_size+25:0}pad_width(){this.label_width=this._label_width(this.shown_font_size);const t=this.options["show-labels"]?this.label_width:0;return this.offsets[1]+this.options["left-offset"]+t}collapse_node(t){up(t)||(t.collapsed=!0)}set_size(t){if(!arguments.length)return this.size;let n=t;return this.options["top-bottom-spacing"]!="fixed-step"&&(this.size[0]=n[0]),this.options["left-right-spacing"]!="fixed-step"&&(this.size[1]=n[1]),this}initialize_svg(t){return this.svg!==t&&(dl(t).select("svg").remove(),this.svg=FD("svg").attr("width",this.width).attr("height",this.height),this.set_size([this.height,this.width]),this.css_classes["tree-container"]=="phylotree-container"&&(this.svg.selectAll("*").remove(),this.svg.append("defs")),dl(this.container).on("click",n=>{this.handle_node_click(null)},!0)),this}update_layout(t,n){n&&(this.nodes=Kd(t),this.nodes.each(function(c){c.id=null})),this.update(),this.syncEdgeLabels()}update(t){var n=this;this.placenodes(),t=this.transitions(t);let c=0,g=this.svg.selectAll("."+jo["tree-container"]).data([0]);if(g=g.enter().append("g").attr("class",jo["tree-container"]).merge(g).attr("transform",W=>this.d3PhylotreeSvgTranslate([this.offsets[1]+this.options["left-offset"],this.pad_height()])),this.draw_scale_bar){let W=this.svg.selectAll("."+jo["tree-scale-bar"]).data([0]);W.enter().append("g").attr("class",jo["tree-scale-bar"]).style("font-size",this.ensure_size_is_in_px(this.scale_bar_font_size)).merge(W).attr("transform",he=>this.d3PhylotreeSvgTranslate([this.offsets[1]+this.options["left-offset"],this.pad_height()-10])).call(this.draw_scale_bar),W.selectAll("text").style("text-anchor","end")}else this.svg.selectAll("."+jo["tree-scale-bar"]).remove();g=this.svg.selectAll("."+jo["tree-container"]).data([0]),this.updateCollapsedClades(t);let x=g.selectAll(Tv(jo)).data(this.links.filter(Cv),W=>W.target.id||(W.target.id=++c));x.exit().remove(),x=x.enter().insert("path",":first-child").merge(x).each(function(W){n.drawEdge(this,W,t)});let S=g.selectAll(i5(jo)).data(this.phylotree.nodes.descendants().filter(Ev),W=>W.id||(W.id=++c));if(S.exit().remove(),S=S.enter().append("g").attr("class",this.reclassNode).merge(S).attr("transform",W=>{const he=this.options.layout=="right-to-left"&&Sl(W);return W.screen_x=n0(W),W.screen_y=ep(W),this.d3PhylotreeSvgTranslate([he?0:W.screen_x,W.screen_y])}).each(function(W){n.drawNode(this,W,t)}).attr("transform",W=>{if(!lp(W.screen_x)&&!lp(W.screen_y))return"translate("+W.screen_x+","+W.screen_y+")"}),this.options["label-nodes-with-name"]&&(S=S.attr("id",W=>"node-"+W.name)),this.resizeSvg(this.phylotree,this.svg,t),this.options.brush){var a=g.selectAll("."+jo["tree-selection-brush"]).data([0]).enter().insert("g",":first-child").attr("class",jo["tree-selection-brush"]),U=BB().on("brush",(W,he)=>{var ae=W.selection,ce=this.links.filter(Cv),be=ce.filter((Je,st)=>Je.source.screen_x>=ae[0][0]&&Je.source.screen_x<=ae[1][0]&&Je.source.screen_y>=ae[0][1]&&Je.source.screen_y<=ae[1][1]&&Je.target.screen_x>=ae[0][0]&&Je.target.screen_x<=ae[1][0]&&Je.target.screen_y>=ae[0][1]&&Je.target.screen_y<=ae[1][1]).map(Je=>Je.target);this.modifySelection(this.phylotree.links.map(Je=>Je.target),"tag",!1,be.length>0,"false"),this.modifySelection(be,"tag",!1,!1,"true")}).on("end",()=>{});a.call(U)}if(this.syncEdgeLabels(),this.options.zoom){let W=QR().scaleExtent([.1,10]).on("zoom",he=>{dl("."+jo["tree-container"]).attr("transform",ae=>he.transform),dl("."+jo["tree-scale-bar"]).attr("transform",ae=>{let ce=he.transform;return ce.y-=10,ce})});this.svg.call(W)}return this}_handle_single_node_layout(t){let n=this.nodeSpan(t)/this.rescale_nodeSpan;this.x=t.x=this.x+this.separation(this.last_node,t)+(this.last_span+n)*.5,this._extents[1][1]=Math.max(this._extents[1][1],t.y),this._extents[1][0]=Math.min(this._extents[1][0],t.y-n*.5),this.is_under_collapsed_parent?this._extents[0][1]=Math.max(this._extents[0][1],this.save_x+(t.x-this.save_x)*this.options.compression+this.save_span+(n*.5+this.separation(this.last_node,t))*this.options.compression):this._extents[0][1]=Math.max(this._extents[0][1],this.x+n*.5+this.separation(this.last_node,t)),this.last_node=t,this.last_span=n}tree_layout(t){if(t5(t))return;let n=Sl(t);t.text_angle=null,t.text_align=null,t.radius=null,t.angle=null;let c=!1;if(t.parent)if(this.do_scaling){if(c)return 0;if(t.y=this.phylotree.branch_length_accessor(t),typeof t.y>"u")return c=!0,0;t.y+=t.parent.y}else t.y=n?this.max_depth:t.depth;else this.x=0,t.y=0,this.last_node=null,this.last_span=0,this._extents=[[0,0],[0,0]];if(n&&this._handle_single_node_layout(t),!n)if(up(t)&&!this.is_under_collapsed_parent){if(this.save_x=this.x,this.save_span=this.last_span*.5,this.is_under_collapsed_parent=!0,this.process_internal_node(t),this.is_under_collapsed_parent=!1,typeof t.x=="number"){t.x=this.save_x+(t.x-this.save_x)*this.options.compression+this.save_span,t.collapsed=[[t.x,t.y]];var g=x=>{x.hidden=!0,Sl(x)?(this.x=x.x=this.save_x+(x.x-this.save_x)*this.options.compression+this.save_span,t.collapsed.push([x.x,x.y])):x.children.map(g)};this.x=this.save_x,g(t),t.collapsed.splice(1,0,[this.save_x,t.y]),t.collapsed.push([this.x,t.y]),t.collapsed.push([t.x,t.y]),t.hidden=!1}}else this.process_internal_node(t);return t.x}process_internal_node(t){let n=0;if(this.showInternalName(t)){let c=t.children.length/2>>0,g=0,x=!1;for(let S=0;S<t.children.length;S++)typeof this.tree_layout(t.children[S])=="number"&&g++,g>=c&&!x&&(this._handle_single_node_layout(t),x=!0);g==0?(t.notshown=!0,t.x=void 0):x||this._handle_single_node_layout(t)}else t.x=t.children.map(this.tree_layout.bind(this)).reduce((c,g)=>typeof g=="number"?c+g:(n+=1,c),0),n==t.children.length?(t.notshown=!0,t.x=void 0):t.x/=t.children.length-n}do_lr(t){if(this.radial()&&t&&(this.offsets[1]=0),this.options["left-right-spacing"]=="fixed-step")this.size[1]=this.max_depth*this.fixed_width[1],this.scales[1]=(this.size[1]-this.offsets[1]-this.options["left-offset"])/this._extents[1][1],this.label_width=this._label_width(this.shown_font_size),this.radial()&&(this.label_width*=2);else{this.label_width=this._label_width(this.shown_font_size),t=!0;let n=this.size[1]-this.offsets[1]-this.options["left-offset"];n*.5<this.label_width&&(this.shown_font_size*=n*.5/this.label_width,this.label_width=n*.5),this.scales[1]=(this.size[1]-this.offsets[1]-this.options["left-offset"]-this.label_width)/this._extents[1][1]}}placenodes(){this._extents=[[0,0],[0,0]],this.x=0,this.last_span=0,this.last_node=null,this.last_span=0,this.save_x=this.x,this.save_span=this.last_span*.5,this.do_scaling=this.options.scaling;let t=!1;this.is_under_collapsed_parent=!1,this.max_depth=1,this.phylotree.nodes.x=this.tree_layout(this.phylotree.nodes,this.do_scaling),this.max_depth=$M(this.phylotree.nodes.descendants(),c=>c.depth),this.do_scaling&&t&&(this.do_scaling=!1,this.phylotree.nodes.x=this.tree_layout(this.phylotree.nodes));let n=!1;if(this.draw_scale_bar=this.options["show-scale"]&&this.do_scaling,this.offsets[1]=Math.max(this.font_size,-this._extents[1][0]*this.fixed_width[0]),this.options["top-bottom-spacing"]=="fixed-step"?(this.size[0]=this._extents[0][1]*this.fixed_width[0],this.scales[0]=this.fixed_width[0]):(this.scales[0]=(this.size[0]-this.pad_height())/this._extents[0][1],n=!0),this.shown_font_size=Math.min(this.font_size,this.scales[0]),this.radial()){this.draw_branch=nf(Kb,this.radial_center),this.edge_placer=Y9;let c=null,g=null,x=null,S=0,a=this._extents[0][1]*this.scales[0],U=function(ce,be,Je,st,Ye){return Ye=Ye||0,Math.sqrt((be-ce)*(be-ce)+2*(ce+Ye)*(be+Ye)*(1-Math.cos(Je-st)))},W=0;this.phylotree.nodes.each(ce=>{let be=ce.x*this.scales[0];ce.angle=2*Math.PI*be/a,ce.text_angle=ce.angle-Math.PI/2,ce.text_angle=ce.text_angle>0&&ce.text_angle<Math.PI,ce.text_align=ce.text_angle?"end":"start",ce.text_angle=(ce.text_angle?180:0)+ce.angle*180/Math.PI}),this.do_lr(n),this.phylotree.nodes.each(ce=>{ce.radius=ce.y*this.scales[1]/this.size[1],W=Math.max(ce.radius,W)});let he=0;this.phylotree.nodes.each(ce=>{if(!ce.children){let be=ce.x*this.scales[0];if(c!==null){let Je=be-g,st=U(ce.radius,x,ce.angle,c,he),Ye=st>0?Je/st:10*this.options["max-radius"];if(Ye>this.options["max-radius"]){let it=Je/this.options["max-radius"],ct=ce.radius+x,Tt=ce.radius*x-(it*it-(x-ce.radius)*(x-ce.radius))/2/(1-Math.cos(c-ce.angle)),zt=Math.sqrt(ct*ct-4*Tt);he=Math.min(this.options["annular-limit"]*W,(-ct+zt)/2),S=this.options["max-radius"]}else S=Math.max(S,Ye)}c=ce.angle,g=be,x=ce.radius}}),this.radius=Math.min(this.options["max-radius"],Math.max(a/2/Math.PI,S)),n&&(this.radius=Math.min(this.radius,(Math.min(a,this._extents[1][1]*this.scales[1])-this.label_width)*.5-this.radius*he)),this.radial_center=this.radius_pad_for_bubbles=this.radius,this.draw_branch=nf(Kb,this.radial_center);let ae=1;he&&(ae=W/(W+he),this.radius*=ae),this.phylotree.nodes.each(ce=>{if(Yb(ce,this.radius,he,this.radial_center,this.scales,this.size),W=Math.max(W,ce.radius),this.options["draw-size-bubbles"]?this.radius_pad_for_bubbles=Math.max(this.radius_pad_for_bubbles,ce.radius+this.nodeBubbleSize(ce)):this.radius_pad_for_bubbles=Math.max(this.radius_pad_for_bubbles,ce.radius),ce.collapsed){ce.collapsed=ce.collapsed.map(Je=>{let st={};return st.x=Je[0],st.y=Je[1],st=Yb(st,this.radius,he,this.radial_center,this.scales,this.size),[st.x,st.y]});let be=ce.collapsed[1];ce.collapsed=ce.collapsed.filter(function(Je,st){return st<3||st>ce.collapsed.length-4?!0:Math.sqrt(Math.pow(Je[0]-be[0],2)+Math.pow(Je[1]-be[1],2))>3?(be=Je,!0):!1})}}),this.size[0]=this.radial_center+this.radius/ae,this.size[1]=this.radial_center+this.radius/ae}else this.do_lr(),this.draw_branch=Jb,this.edge_placer=ew,this.right_most_leaf=0,this.phylotree.nodes.each(c=>{if(c.x*=this.scales[0],c.y*=this.scales[1]*.8,this.options.layout=="right-to-left"&&(c.y=this._extents[1][1]*this.scales[1]-c.y),Sl(c)&&(this.right_most_leaf=Math.max(this.right_most_leaf,c.y+this.nodeBubbleSize(c))),c.collapsed){c.collapsed.forEach(x=>{x[0]*=this.scales[0],x[1]*=this.scales[1]*.8});let g=c.collapsed[1][0];c.collapsed=c.collapsed.filter(function(x,S){return S<3||S>c.collapsed.length-4?!0:x[0]-g>3?(g=x[0],!0):!1})}});if(this.draw_scale_bar){let c,g;if(this.radial()){if(g=Math.min(this.radius/5,50),c=Math.pow(10,Math.ceil(Math.log(this._extents[1][1]*g/this.radius)/Math.log(10))),g=c*(this.radius/this._extents[1][1]),g<30){let a=Math.ceil(30/g);g*=a,c*=a}}else c=this._extents[1][1],g=this.size[1]-this.offsets[1]-this.options["left-offset"]-this.shown_font_size;let x=NS().domain([0,c]).range([0,g]),S=t2(".2f");if(this.draw_scale_bar=nP().scale(x).tickFormat(function(a){return a===0?"":S(a)}),this.radial())this.draw_scale_bar.tickValues([c]);else{let a=function(W,he){return he?Math.round(W*(he=Math.pow(10,he)))/he:Math.round(W)},U=x.ticks();U=U.length>1?U[1]:U[0],this.draw_scale_bar.ticks(Math.min(10,a(g/(this.shown_font_size*S(U).length*2),0)))}}else this.draw_scale_bar=null;return this}spacing_x(t,n){return arguments.length?(this.fixed_width[0]!=t&&t>=this.options["minimum-per-node-spacing"]&&t<=this.options["maximum-per-node-spacing"]&&(this.fixed_width[0]=t,n||this.placenodes()),this):this.fixed_width[0]}spacing_y(t,n){return arguments.length?(this.fixed_width[1]!=t&&t>=this.options["minimum-per-level-spacing"]&&t<=this.options["maximum-per-level-spacing"]&&(this.fixed_width[1]=t,n||this.placenodes()),this):this.fixed_width[1]}_label_width(t){t=t||this.shown_font_size;let n=0;return this.phylotree.nodes.descendants().filter(Ev).forEach(c=>{let g=12+this._nodeLabel(c).length*t*.8;c.angle!==null&&(g*=Math.max(Math.abs(Math.cos(c.angle)),Math.abs(Math.sin(c.angle)))),n=Math.max(g,n)}),n}font_size(t){return arguments.length?(this.font_size=t===void 0?12:t,this):this.font_size}scale_bar_font_size(t){return arguments.length?(this.scale_bar_font_size=t===void 0?12:t,this):this.scale_bar_font_size}node_circle_size(t,n){return arguments.length?(this.options.node_circle_size=iw(t===void 0?3:t),this):this.options.node_circle_size}css(t){if(arguments.length===0)return this.css_classes;if(arguments.length>2){var n={};return n[t[0]]=t[1],this.css(n)}for(var c in jo)c in t&&t[c]!=jo[c]&&(jo[c]=t[c]);return this}transitions(t){return t!==void 0?t:this.options.transitions!==null?this.options.transitions:this.phylotree.nodes.descendants().length<=300}css_classes(t,n){if(!arguments.length)return this.css_classes;let c=!1;for(var g in jo)g in t&&t[g]!=this.css_classes[g]&&(c=!0,this.css_classes[g]=t[g]);return n&&c&&this.layout(),this}layout(t){return this.svg?(this.svg.selectAll("."+this.css_classes["tree-container"]+",."+this.css_classes["tree-scale-bar"]+",."+this.css_classes["tree-selection-brush"]),this.d3PhylotreeTriggerLayout(this),this.update()):(this.d3PhylotreeTriggerLayout(this),this)}handle_node_click(t,n){this.nodeDropdownMenu(t,this.container,this,this.options,n)}refresh(){if(this.svg){let n=this.svg.selectAll("."+this.css_classes["tree-container"]).selectAll(Tv(this.css_classes)).attr("class",this.reclassEdge.bind(this));this.edge_styler&&n.each(c=>{this.edge_styler(dl(this),c)})}return this}countHandler(t){return arguments.length?(this.count_listener_handler=t,this):this.count_listener_handler}style_nodes(t){return arguments.length?(this.node_styler=t,this):this.node_styler}style_edges(t){return arguments.length?(this.edge_styler=t.bind(this),this):this.edge_styler}itemSelected(t,n){return t[n]||!1}show(){return this.svg.node()}}fA(gp.prototype,gF);fA(gp.prototype,pF);fA(gp.prototype,wF);fA(gp.prototype,MF);fA(gp.prototype,FF);fA(gp.prototype,aF);function OF(e,t,n){return this.nodes.sum(function(c){return c.value}).sort(e),this.display&&(this.display.update_layout(this.nodes),this.display.update()),this}function NF(e){var t;return e=e.map(function(n){return typeof n=="string"?n:n.data.name}),this.traverse_and_compute(function(n){n.children?n.parent?(n.data.mrca=W4(...n.descendants().map(c=>c.data.mrca)),!t&&n.data.mrca.length==e.length&&(t=n)):t||(t=n):n.data.mrca=$4([n.data.name],e)}),t}let Ru=class{constructor(e,t={}){this.newick_string="",this.nodes=[],this.links=[],this.parsed_tags=[],this.partitions=[],this.branch_length_accessor=Sv,this.branch_length=Sv,this.logger=t.logger||console,this.selection_attribute_name="selected";var n=t.type||void 0,c=[],g=this;if(s1(n))n in sy?c=sy[n](e,t):g.logger.error("type "+n+" not in registry! Available types are "+pu(sy));else if(nc(n))try{c=n(e,t)}catch{g.logger.error("Could not parse custom format!")}else e.name=="root"?c={json:e,error:null}:typeof e!="string"?c=e:e.contentType=="application/xml"?c=J4(e):(this.newick_string=e,c=Ig(e,t));if(!c.json)g.nodes=[];else{g.nodes=Kd(c.json);let x={};g.nodes.each(S=>{S.data.annotation&&(x[S.data.annotation]=!0)}),g.parsed_tags=Object.keys(x)}return g.links=g.nodes.links(),this.hasBranchLengths()||(console.warn("Phylotree User Warning : NO BRANCH LENGTHS DETECTED, SETTING ALL LENGTHS TO 1"),this.setBranchLength(x=>1)),g}json(e){var t=0;this.traverse_and_compute(function(c){c.json_export_index=t++},e);var n=new Array(t);return t=0,this.traverse_and_compute(function(c){let g=x4(c);delete g.json_export_index,c.parent&&(g.parent=c.parent.json_export_index),c.children&&(g.children=gc(c.children,function(x){return x.json_export_index})),n[t++]=g},e),this.traverse_and_compute(function(c){delete c.json_export_index},e),JSON.stringify(n)}traverse_and_compute(e,t,n,c){t=t||"post-order";function g(a){lp(a)||e5(a,e,c)}function x(a){O9(a,e,c)}function S(a){N9(a,e,c)}return t=="pre-order"?t=x:t=="in-order"?t=S:t=g,t(n||this.nodes),this}get_parsed_tags(){return this.parsed_tags}update(e){this.nodes=e}render(e){return this.display=new gp(this,e),this.display}};Ru.prototype.isLeafNode=Sl;Ru.prototype.selectAllDescendants=Y4;Ru.prototype.mrca=NF;Ru.prototype.hasBranchLengths=U9;Ru.prototype.getBranchLengths=G9;Ru.prototype.branchName=Z9;Ru.prototype.normalizeBranchLengths=H9;Ru.prototype.scaleBranchLengths=j9;Ru.prototype.getNewick=M9;Ru.prototype.resortChildren=OF;Ru.prototype.setBranchLength=q9;Ru.prototype.maxParsimony=R9;Ru.prototype.getTipLengths=z9;Ru.prototype.leftChildRightSibling=V9;fA(Ru.prototype,k9);fA(Ru.prototype,X9);fA(Ru.prototype,L9);QS("%Y%m%d");function VF(e){let t,n,c="Taxa found in this area",g,x,S,a,U,W,he;return{c(){t=Rn("div"),n=Rn("h2"),n.textContent=c,g=Sr(),x=Rn("div"),S=Rn("div"),a=Rn("span"),U=ba(e[4]),this.h()},l(ae){t=Fn(ae,"DIV",{class:!0});var ce=_n(t);n=Fn(ce,"H2",{class:!0,"data-svelte-h":!0}),Qu(n)!=="svelte-bg4wlc"&&(n.textContent=c),g=Ir(ce),x=Fn(ce,"DIV",{id:!0,class:!0});var be=_n(x);S=Fn(be,"DIV",{class:!0,style:!0});var Je=_n(S);a=Fn(Je,"SPAN",{class:!0});var st=_n(a);U=wa(st,e[4]),st.forEach(yi),Je.forEach(yi),be.forEach(yi),ce.forEach(yi),this.h()},h(){Ti(n,"class","svelte-vxmxuk"),Ti(a,"class","svelte-vxmxuk"),Ti(S,"class",W=tp(`tree_tooltip ${e[3]?"shown":"hidden"} ${e[5]?"flip":""}`)+" svelte-vxmxuk"),Ti(S,"style",he=`margin-top: calc(${e[2]}px - 2rem); left: ${e[1]}px;`),Ti(x,"id","tree_container"),Ti(x,"class","svelte-vxmxuk"),Ti(t,"class","phylo-container svelte-vxmxuk")},m(ae,ce){Un(ae,t,ce),qi(t,n),qi(t,g),qi(t,x),qi(x,S),qi(S,a),qi(a,U),e[11](x)},p(ae,[ce]){ce&16&&ql(U,ae[4]),ce&40&&W!==(W=tp(`tree_tooltip ${ae[3]?"shown":"hidden"} ${ae[5]?"flip":""}`)+" svelte-vxmxuk")&&Ti(S,"class",W),ce&6&&he!==(he=`margin-top: calc(${ae[2]}px - 2rem); left: ${ae[1]}px;`)&&Ti(S,"style",he)},i:Oa,o:Oa,d(ae){ae&&yi(t),e[11](null)}}}let ay=2e3,oy=2e3;function UF(e,t,n){let{newick:c}=t,{present:g}=t,{hex_id:x}=t,{clade:S}=t,a,U,W,he,ae=!1,ce="",be=!1;function Je(it){if(!a)return;let ct="(((((((((((Tyrannus_verticalis:4.001433,(Tyrannus_tyrannus:3.53811,Tyrannus_vociferans:3.53811):0.463323):2.959154,(Myiarchus_cinerascens:2.014245,Myiarchus_tyrannulus:2.014245):4.946342):1.597191,((((Empidonax_difficilis:4.450615,((((Empidonax_oberholseri:2.161306,Empidonax_hammondii:2.161306):0.842122,Empidonax_minimus:3.003428):0.213631,Empidonax_wrightii:3.217059):0.929523,Empidonax_traillii:4.146582):0.304032):0.148682,(Contopus_sordidulus:3.526572,Contopus_cooperi:3.526571):1.072725):0.325545,(Sayornis_saya:3.781439,Sayornis_nigricans:3.781439):1.143402):3.069996,Pyrocephalus_rubinus:7.994837):0.56294):19.243085,(((((Chamaea_fasciata:12.429713,((((Riparia_riparia:6.967223,(Tachycineta_thalassina:4.679356,Tachycineta_bicolor:4.679355):2.287867):0.197341,(Stelgidopteryx_serripennis:6.278306,Progne_subis:6.278307):0.886257):0.999496,(Petrochelidon_pyrrhonota:7.596176,Hirundo_rustica:7.596175):0.567883):3.908347,Psaltriparus_minimus:12.072407):0.357305):3.198033,Eremophila_alpestris:15.627745):0.954938,(((Poecile_rufescens:3.381344,(Poecile_gambeli:2.366328,Poecile_atricapillus:2.366328):1.015016):2.5912,(Baeolophus_inornatus:1.885773,Baeolophus_ridgwayi:1.885773):4.086771):6.604761,Auriparus_flaviceps:12.577305):4.005378):1.204803,(((((Cinclus_mexicanus:14.257735,((Turdus_migratorius:9.645123,((Catharus_guttatus:5.110876,Catharus_ustulatus:5.110876):3.731149,Ixoreus_naevius:8.842026):0.803098):2.400322,(Myadestes_townsendi:11.383646,(Sialia_currucoides:3.141333,Sialia_mexicana:3.141332):8.242315):0.661799):2.21229):0.472993,(Sturnus_vulgaris:11.154101,((Mimus_polyglottos:5.122579,Oreoscoptes_montanus:5.12258):1.517727,(Toxostoma_bendirei:4.640856,((Toxostoma_lecontei:2.747447,Toxostoma_crissale:2.747447):0.857103,Toxostoma_redivivum:3.60455):1.036307):1.999449):4.513794):3.576628):2.188836,((((((Campylorhynchus_brunneicapillus:6.585247,Thryomanes_bewickii:6.585247):0.601549,(Troglodytes_aedon:5.644158,Cistothorus_palustris:5.644159):1.542638):0.934231,(Catherpes_mexicanus:6.20663,Salpinctes_obsoletus:6.20663):1.914396):3.05437,((Polioptila_californica:1.690149,Polioptila_melanura:1.690149):1.702386,Polioptila_caerulea:3.392536):7.782861):2.80982,Certhia_americana:13.985217):1.128942,((Sitta_canadensis:6.561379,Sitta_pygmaea:6.56138):1.810662,Sitta_carolinensis:8.37204):6.742118):1.805406):0.407621,(((Bombycilla_garrulus:3.757978,Bombycilla_cedrorum:3.757978):8.174507,Phainopepla_nitens:11.932485):4.887578,Regulus_satrapa:16.820063):0.507124):0.145318,(((((((((Passerina_caerulea:2.570987,Passerina_amoena:2.570987):1.680228,Passerina_cyanea:4.251215):2.855821,((Piranga_ludoviciana:4.343958,Piranga_rubra:4.343958):2.254702,Cardinalis_cardinalis:6.598661):0.508374):0.258533,Pheucticus_melanocephalus:7.365567):1.805195,(((((((Euphagus_cyanocephalus:4.083924,(Molothrus_aeneus:1.212313,Molothrus_ater:1.212313):2.871611):0.187559,(Agelaius_phoeniceus:3.000792,Agelaius_tricolor:3.000792):1.270691):2.148377,(Icterus_cucullatus:4.501935,(Icterus_parisorum:3.486088,Icterus_galbula:3.486089):1.015845):1.917926):0.524545,(Sturnella_neglecta:6.36353,Xanthocephalus_xanthocephalus:6.36353):0.580875):0.481912,Icteria_virens:7.426317):0.371308,((((((((Setophaga_townsendi:0.205227,Setophaga_occidentalis:0.205227):0.950551,Setophaga_nigrescens:1.155778):0.925938,(Setophaga_coronata:1.835635,Setophaga_palmarum:1.835635):0.246081):0.150194,Setophaga_petechia:2.231909):0.420317,Setophaga_ruticilla:2.652226):1.343903,(Cardellina_rubrifrons:2.573805,Cardellina_pusilla:2.573805):1.422325):0.307199,(Geothlypis_trichas:3.17745,Geothlypis_tolmiei:3.17745):1.125879):0.24755,(Parkesia_noveboracensis:3.921106,Mniotilta_varia:3.921106):0.629773):3.246746):0.860785,((Ammodramus_savannarum:7.22603,((Spizella_atrogularis:3.327185,(Spizella_breweri:2.319898,Spizella_passerina:2.319898):1.007287):3.419478,((Calamospiza_melanocorys:5.462612,Amphispiza_bilineata:5.462613):0.473245,Chondestes_grammacus:5.935857):0.810805):0.479369):0.284235,(((Pooecetes_gramineus:4.482169,(((Melospiza_lincolnii:1.264886,Melospiza_georgiana:1.264886):0.837596,Melospiza_melodia:2.102483):1.773568,Passerculus_sandwichensis:3.876051):0.606118):1.04583,((Pipilo_maculatus:2.033152,Pipilo_chlorurus:2.033153):2.918452,((Melozone_aberti:0.89701,Melozone_crissalis:0.89701):3.214586,Aimophila_ruficeps:4.111597):0.840007):0.576396):0.208553,(Junco_hyemalis:4.32944,(Zonotrichia_albicollis:1.482363,(Zonotrichia_atricapilla:0.331305,Zonotrichia_leucophrys:0.331305):1.151058):2.847076):1.407113):1.773713):1.148145):0.512351):0.561069,Calcarius_lapponicus:9.731831):1.359019,(((Spinus_pinus:3.142395,(Spinus_tristis:2.540467,(Spinus_psaltria:1.162173,Spinus_lawrencei:1.162173):1.378294):0.601928):1.6301,(Loxia_leucoptera:1.210478,Loxia_curvirostra:1.210477):3.562017):2.7703,(Leucosticte_tephrocotis:6.423852,Pinicola_enucleator:6.423852):1.11894):3.548056):0.547327,(Anthus_rubescens:5.935911,Anthus_spragueii:5.935912):5.702265):0.415079,Passer_domesticus:12.053257):5.419249):0.314981):2.469957,((Vireo_gilvus:3.302798,(((Vireo_cassinii:0.402464,Vireo_plumbeus:0.402464):1.942187,(Vireo_vicinior:2.056349,Vireo_huttoni:2.056349):0.288302):0.466454,Vireo_bellii:2.811106):0.491692):12.019837,(Lanius_ludovicianus:11.409307,(((((Corvus_corax:4.701119,Corvus_brachyrhynchos:4.701119):1.990164,Nucifraga_columbiana:6.691283):1.298672,Pica_hudsonia:7.989953):0.514906,((Gymnorhinus_cyanocephalus:6.126222,Aphelocoma_californica:6.126222):0.683341,Cyanocitta_stelleri:6.809564):1.695297):0.40107,Perisoreus_canadensis:8.905929):2.503378):3.913326):4.934811):7.543419):10.368133,(Brotogeris_chiriri:10.109007,(Amazona_finschi:1.862114,Amazona_viridigenalis:1.862114):8.246892):28.059987):0.875789,((Falco_mexicanus:3.250519,Falco_peregrinus:3.250519):1.551005,(Falco_columbarius:4.340078,Falco_sparverius:4.340078):0.461445):34.243259):18.167212,(((((((Sphyrapicus_ruber:0.691321,Sphyrapicus_nuchalis:0.691321):4.673796,Sphyrapicus_thyroideus:5.365118):3.383365,(Melanerpes_uropygialis:7.684308,(Melanerpes_formicivorus:7.035306,Melanerpes_lewis:7.035306):0.649002):1.064176):0.729339,Picoides_arcticus:9.477822):26.111884,Megaceryle_alcyon:35.589708):21.232651,(((((Megascops_kennicottii:9.535534,Bubo_virginianus:9.535534):0.399666,(Strix_nebulosa:8.157754,(Strix_varia:6.649511,Strix_occidentalis:6.649511):1.508244):1.777446):0.688896,(Asio_otus:6.154249,Asio_flammeus:6.154249):4.469847):2.862398,(((Glaucidium_gnoma:10.483593,Athene_cunicularia:10.483593):0.73703,Aegolius_acadicus:11.220624):0.978771,Micrathene_whitneyi:12.199394):1.2871):8.747286,Tyto_alba:22.233781):34.588578):0.214221,((((Aquila_chrysaetos:7.964539,((((((Buteo_swainsoni:1.391803,(Buteo_albonotatus:1.258194,(Buteo_regalis:0.408815,Buteo_lagopus:0.408815):0.84938):0.13361):0.246285,Buteo_jamaicensis:1.638089):0.602243,Buteo_lineatus:2.240332):1.894991,Parabuteo_unicinctus:4.135322):2.246454,Haliaeetus_leucocephalus:6.381778):0.568816,(Accipiter_striatus:5.309671,Accipiter_cooperii:5.30967):1.640922):1.013948):2.988594,Elanus_leucurus:10.953135):1.124614,Pandion_haliaetus:12.07775):4.511346,((Coragyps_atratus:3.554197,Gymnogyps_californianus:3.554197):2.188988,Cathartes_aura:5.743185):10.84591):40.447484):0.175416):0.552342,(((((((((((Calidris_bairdii:4.228354,Calidris_melanotos:4.228355):0.721063,Calidris_mauri:4.949417):0.597188,(Calidris_alba:4.799257,Calidris_minutilla:4.799257):0.747348):0.928535,(Calidris_ptilocnemis:4.342482,Calidris_alpina:4.342482):2.132658):1.149079,Calidris_canutus:7.62422):3.509313,(Arenaria_interpres:3.533248,Arenaria_melanocephala:3.533248):7.600284):1.234303,((Gallinago_delicata:10.711284,(Limnodromus_griseus:5.529963,Limnodromus_scolopaceus:5.529963):5.181322):1.375692,(((Tringa_solitaria:7.846535,((Tringa_melanoleuca:6.221306,(Tringa_flavipes:5.250045,Tringa_semipalmata:5.250045):0.971262):0.372349,Tringa_incana:6.593656):1.252879):2.273961,Phalaropus_fulicarius:10.120496):0.508933,Actitis_macularius:10.629429):1.457548):0.280858):0.808214,Limosa_fedoa:13.176049):0.875709,(Numenius_americanus:7.01717,Numenius_phaeopus:7.01717):7.034588):7.503049,((((((Chlidonias_niger:4.717037,((Sterna_hirundo:3.62124,Sterna_forsteri:3.62124):0.268369,(Thalasseus_elegans:1.230911,Thalasseus_maximus:1.230912):2.658698):0.827428):0.955816,(Gelochelidon_nilotica:4.350884,Hydroprogne_caspia:4.350884):1.321968):1.505717,Sternula_antillarum:7.178569):4.533572,Rynchops_niger:11.712141):0.654253,(((((((Larus_hyperboreus:0.185546,Larus_glaucoides:0.185546):0.003055,Larus_glaucescens:0.188601):0.263007,Larus_californicus:0.451609):0.374466,Larus_occidentalis:0.826074):0.18028,Larus_delawarensis:1.006355):0.196994,Larus_heermanni:1.203348):3.257797,(Xema_sabini:3.479007,Rissa_tridactyla:3.479007):0.982139):7.905248):0.839622,((((Cerorhinca_monocerata:4.962971,Fratercula_cirrhata:4.962971):4.069719,Ptychoramphus_aleuticus:9.03269):0.727745,(((Uria_aalge:7.923653,(Synthliboramphus_antiquus:3.720373,(Synthliboramphus_hypoleucus:0.671056,Synthliboramphus_craveri:0.671056):3.049317):4.20328):0.407386,Cepphus_columba:8.331039):0.426139,Brachyramphus_marmoratus:8.757178):1.003257):1.771281,Stercorarius_pomarinus:11.531716):1.6743):8.348792):1.743606,(((Charadrius_montanus:9.995173,(Charadrius_semipalmatus:6.536113,Charadrius_vociferus:6.536113):3.45906):1.702327,Recurvirostra_americana:11.697501):0.798071,((Pluvialis_fulva:2.455897,Pluvialis_dominica:2.455897):1.178289,Pluvialis_squatarola:3.634185):8.861386):10.802842):34.465924):0.473736,((((Columbina_inca:3.404918,Columbina_passerina:3.404918):8.482142,((Zenaida_asiatica:6.129893,Zenaida_macroura:6.129893):3.814154,Patagioenas_fasciata:9.944047):1.943014):22.893088,(Podilymbus_podiceps:7.533322,(((Podiceps_auritus:3.080437,Podiceps_grisegena:3.080437):1.451611,Podiceps_nigricollis:4.532048):0.835204,(Aechmophorus_clarkii:0.649792,Aechmophorus_occidentalis:0.649792):4.71746):2.166071):27.246826):0.63047,(((Cypseloides_niger:10.552193,(Aeronautes_saxatalis:7.70865,Chaetura_vauxi:7.708649):2.843543):21.460899,(Archilochus_alexandri:4.492772,(((Selasphorus_sasin:1.25153,(Selasphorus_calliope:0.828849,Selasphorus_rufus:0.828849):0.422681):0.256848,Selasphorus_platycercus:1.508378):0.915832,(Calypte_anna:1.752307,Calypte_costae:1.752307):0.671904):2.068562):27.52032):2.173856,(Phalaenoptilus_nuttallii:9.381208,(Chordeiles_acutipennis:4.827009,Chordeiles_minor:4.827009):4.554198):24.805739):1.223671):22.827456):3.416457,(((((((((Botaurus_lentiginosus:7.844435,Ixobrychus_exilis:7.844434):4.109641,((((Bubulcus_ibis:5.166884,Ardea_alba:5.166884):0.893851,Ardea_herodias:6.060735):2.772452,Nycticorax_nycticorax:8.833187):0.574409,(Egretta_caerulea:4.018093,Egretta_thula:4.018093):5.389502):2.546481):12.342126,(Pelecanus_erythrorhynchos:4.196515,Pelecanus_occidentalis:4.196516):20.099686):1.029739,Plegadis_chihi:25.325942):23.512005,Fregata_magnificens:48.837946):1.031774,Mycteria_americana:49.869719):10.866735,(((Pterodroma_cookii:8.933823,Puffinus_opisthomelas:8.933826):0.331096,Fulmarus_glacialis:9.26492):3.849296,((Phoebastria_immutabilis:1.85668,Phoebastria_nigripes:1.85668):0.562903,Phoebastria_albatrus:2.419582):10.694634):47.622239):0.137649,((Gavia_immer:1.471913,Gavia_pacifica:1.471913):4.785063,Gavia_stellata:6.256976):54.617128):0.372954,((Coccyzus_americanus:20.634502,Geococcyx_californianus:20.634503):10.43379,(((Fulica_americana:5.83685,Gallinula_galeata:5.836849):3.314091,Porzana_carolina:9.15094):2.511697,(Laterallus_jamaicensis:11.336317,Rallus_limicola:11.336317):0.32632):19.405654):30.178765):0.407474):2.979476,((((((Anas_platyrhynchos:3.223317,Anas_acuta:3.223318):2.598536,((Aythya_marila:0.342269,Aythya_affinis:0.342269):1.154018,((Aythya_americana:0.805757,Aythya_collaris:0.805757):0.461603,Aythya_valisineria:1.26736):0.228926):4.325566):1.213051,(Aix_sponsa:6.70241,((((Bucephala_albeola:3.701376,(Bucephala_clangula:1.11771,Bucephala_islandica:1.11771):2.583666):1.514894,((Mergus_merganser:1.873201,Mergus_serrator:1.873201):1.916388,Lophodytes_cucullatus:3.789589):1.426681):0.502879,Melanitta_perspicillata:5.719149):0.771899,Histrionicus_histrionicus:6.491048):0.211362):0.332494):2.655406,(((((Branta_hutchinsii:0.999185,Branta_canadensis:0.999184):2.080501,Branta_bernicla:3.079685):1.059406,Anser_albifrons:4.13909):2.225437,(Cygnus_columbianus:0.874443,Cygnus_buccinator:0.874443):5.490085):2.888657,Oxyura_jamaicensis:9.253185):0.437126):3.174907,Dendrocygna_bicolor:12.865217):41.141001,((((((Lagopus_leucura:4.060241,Centrocercus_urophasianus:4.06024):1.450073,Bonasa_umbellus:5.510314):1.796859,Meleagris_gallopavo:7.307173):0.657843,Phasianus_colchicus:7.965017):3.942481,Alectoris_chukar:11.907496):3.85599,((Callipepla_californica:0.906981,Callipepla_gambelii:0.906981):6.06878,Oreortyx_pictus:6.975761):8.787725):38.242733):10.627788);",Tt=new Ru(ct),zt=Tt.render({height:oy,width:ay,"left-right-spacing":"fit-to-size","top-bottom-spacing":"fit-to-size","is-radial":!0,brush:!1,collapsible:!1,selectable:!1,reroot:!1,hide:!1,container:"#tree_container"});console.log(zt),console.log(Tt.display),zt.update();let Rt=Tt.display.show();Rt.querySelectorAll(".node-circle").forEach(Oe=>Oe.attr("r",0)),Rt.setAttribute("width",ay),Rt.setAttribute("height",oy),Rt.setAttribute("viewBox",`0 0 ${ay/4} ${oy/4}`),console.log(Rt),a.appendChild(Rt),console.log(a.querySelectorAll(".node-circle")),a.querySelectorAll(".node-circle").forEach(Oe=>{Oe.addEventListener("mouseover",jt=>{console.log(jt),console.log(document.querySelector("#tree_container"));let at=document.querySelector("#tree_container").clientWidth;n(5,be=!1),W>at/2&&n(5,be=!0),n(3,ae=!0),n(4,ce=jt.target.attributes.title.value)}),Oe.addEventListener("mouseout",jt=>{n(3,ae=!1)})}),Rt.addEventListener("mousemove",Oe=>{console.log(Oe),Oe.target.localName==="svg"&&(n(1,W=Oe.layerX),n(2,he=Oe.layerY))})}async function st(it){return it}bc(async()=>{st(S).then(it=>Je()).then(()=>console.log("built node map"))});function Ye(it){ua[it?"unshift":"push"](()=>{a=it,n(0,a)})}return e.$$set=it=>{"newick"in it&&n(6,c=it.newick),"present"in it&&n(7,g=it.present),"hex_id"in it&&n(8,x=it.hex_id),"clade"in it&&n(9,S=it.clade)},e.$$.update=()=>{e.$$.dirty&577&&c&&a&&Je(),e.$$.dirty&1152&&g&&!U&&st(g)},[a,W,he,ae,ce,be,c,g,x,S,U,Ye]}class GF extends fo{constructor(t){super(),po(this,t,UF,VF,Va,{newick:6,present:7,hex_id:8,clade:9})}}function nw(e){let t;return{c(){t=Rn("div"),this.h()},l(n){t=Fn(n,"DIV",{class:!0}),_n(t).forEach(yi),this.h()},h(){Ti(t,"class","mdc-button__touch")},m(n,c){Un(n,t,c)},d(n){n&&yi(t)}}}function qF(e){let t,n,c,g;const x=e[28].default,S=Hl(x,e,e[30],null);let a=e[6]&&nw();return{c(){t=Rn("div"),n=Sr(),S&&S.c(),a&&a.c(),c=xs(),this.h()},l(U){t=Fn(U,"DIV",{class:!0}),_n(t).forEach(yi),n=Ir(U),S&&S.l(U),a&&a.l(U),c=xs(),this.h()},h(){Ti(t,"class","mdc-button__ripple")},m(U,W){Un(U,t,W),Un(U,n,W),S&&S.m(U,W),a&&a.m(U,W),Un(U,c,W),g=!0},p(U,W){S&&S.p&&(!g||W[0]&1073741824)&&jl(S,x,U,U[30],g?Ql(x,U[30],W,null):Zl(U[30]),null),U[6]?a||(a=nw(),a.c(),a.m(c.parentNode,c)):a&&(a.d(1),a=null)},i(U){g||(Wi(S,U),g=!0)},o(U){tn(S,U),g=!1},d(U){U&&(yi(t),yi(n),yi(c)),S&&S.d(U),a&&a.d(U)}}}function HF(e){let t,n,c;const g=[{tag:e[10]},{use:[[Xd,{ripple:e[3],unbounded:!1,color:e[4],disabled:!!e[23].disabled,addClass:e[19],removeClass:e[20],addStyle:e[21]}],e[17],...e[0]]},{class:Ts({[e[1]]:!0,"mdc-button":!0,"mdc-button--raised":e[5]==="raised","mdc-button--unelevated":e[5]==="unelevated","mdc-button--outlined":e[5]==="outlined","smui-button--color-secondary":e[4]==="secondary","mdc-button--touch":e[6],"mdc-card__action":e[18]==="card:action","mdc-card__action--button":e[18]==="card:action","mdc-dialog__button":e[18]==="dialog:action","mdc-top-app-bar__navigation-icon":e[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":e[18]==="top-app-bar:action","mdc-snackbar__action":e[18]==="snackbar:actions","mdc-banner__secondary-action":e[18]==="banner"&&e[8],"mdc-banner__primary-action":e[18]==="banner"&&!e[8],"mdc-tooltip__action":e[18]==="tooltip:rich-actions",...e[12]})},{style:Object.entries(e[13]).map(ly).concat([e[2]]).join(" ")},e[16],e[15],e[14],{href:e[7]},e[23]];var x=e[9];function S(a,U){let W={$$slots:{default:[qF]},$$scope:{ctx:a}};if(U!==void 0&&U[0]&12580351)W=ma(g,[U[0]&1024&&{tag:a[10]},U[0]&12189721&&{use:[[Xd,{ripple:a[3],unbounded:!1,color:a[4],disabled:!!a[23].disabled,addClass:a[19],removeClass:a[20],addStyle:a[21]}],a[17],...a[0]]},U[0]&266610&&{class:Ts({[a[1]]:!0,"mdc-button":!0,"mdc-button--raised":a[5]==="raised","mdc-button--unelevated":a[5]==="unelevated","mdc-button--outlined":a[5]==="outlined","smui-button--color-secondary":a[4]==="secondary","mdc-button--touch":a[6],"mdc-card__action":a[18]==="card:action","mdc-card__action--button":a[18]==="card:action","mdc-dialog__button":a[18]==="dialog:action","mdc-top-app-bar__navigation-icon":a[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":a[18]==="top-app-bar:action","mdc-snackbar__action":a[18]==="snackbar:actions","mdc-banner__secondary-action":a[18]==="banner"&&a[8],"mdc-banner__primary-action":a[18]==="banner"&&!a[8],"mdc-tooltip__action":a[18]==="tooltip:rich-actions",...a[12]})},U[0]&8196&&{style:Object.entries(a[13]).map(ly).concat([a[2]]).join(" ")},U[0]&65536&&Os(a[16]),U[0]&32768&&Os(a[15]),U[0]&16384&&Os(a[14]),U[0]&128&&{href:a[7]},U[0]&8388608&&Os(a[23])]);else for(let he=0;he<g.length;he+=1)W=_r(W,g[he]);return{props:W}}return x&&(t=ef(x,S(e)),e[29](t),t.$on("click",e[22])),{c(){t&&Jr(t.$$.fragment),n=xs()},l(a){t&&vs(t.$$.fragment,a),n=xs()},m(a,U){t&&es(t,a,U),Un(a,n,U),c=!0},p(a,U){if(U[0]&512&&x!==(x=a[9])){if(t){Eo();const W=t;tn(W.$$.fragment,1,0,()=>{ts(W,1)}),Co()}x?(t=ef(x,S(a,U)),a[29](t),t.$on("click",a[22]),Jr(t.$$.fragment),Wi(t.$$.fragment,1),es(t,n.parentNode,n)):t=null}else if(x){const W=U[0]&12580351?ma(g,[U[0]&1024&&{tag:a[10]},U[0]&12189721&&{use:[[Xd,{ripple:a[3],unbounded:!1,color:a[4],disabled:!!a[23].disabled,addClass:a[19],removeClass:a[20],addStyle:a[21]}],a[17],...a[0]]},U[0]&266610&&{class:Ts({[a[1]]:!0,"mdc-button":!0,"mdc-button--raised":a[5]==="raised","mdc-button--unelevated":a[5]==="unelevated","mdc-button--outlined":a[5]==="outlined","smui-button--color-secondary":a[4]==="secondary","mdc-button--touch":a[6],"mdc-card__action":a[18]==="card:action","mdc-card__action--button":a[18]==="card:action","mdc-dialog__button":a[18]==="dialog:action","mdc-top-app-bar__navigation-icon":a[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":a[18]==="top-app-bar:action","mdc-snackbar__action":a[18]==="snackbar:actions","mdc-banner__secondary-action":a[18]==="banner"&&a[8],"mdc-banner__primary-action":a[18]==="banner"&&!a[8],"mdc-tooltip__action":a[18]==="tooltip:rich-actions",...a[12]})},U[0]&8196&&{style:Object.entries(a[13]).map(ly).concat([a[2]]).join(" ")},U[0]&65536&&Os(a[16]),U[0]&32768&&Os(a[15]),U[0]&16384&&Os(a[14]),U[0]&128&&{href:a[7]},U[0]&8388608&&Os(a[23])]):{};U[0]&1073741888&&(W.$$scope={dirty:U,ctx:a}),t.$set(W)}},i(a){c||(t&&Wi(t.$$.fragment,a),c=!0)},o(a){t&&tn(t.$$.fragment,a),c=!1},d(a){a&&yi(n),e[29](null),t&&ts(t,a)}}}const ly=([e,t])=>`${e}: ${t};`;function jF(e,t,n){let c,g,x;const S=["use","class","style","ripple","color","variant","touch","href","action","defaultAction","secondary","component","tag","getElement"];let a=Ao(t,S),{$$slots:U={},$$scope:W}=t;const he=Ic(xc());let{use:ae=[]}=t,{class:ce=""}=t,{style:be=""}=t,{ripple:Je=!0}=t,{color:st="primary"}=t,{variant:Ye="text"}=t,{touch:it=!1}=t,{href:ct=void 0}=t,{action:Tt="close"}=t,{defaultAction:zt=!1}=t,{secondary:Rt=!1}=t,Oe,jt={},at={},_t=Cu("SMUI:button:context"),{component:mt=tf}=t,{tag:xt=mt===tf?ct==null?"button":"a":void 0}=t,bt=a.disabled;du("SMUI:label:context","button"),du("SMUI:icon:context","button");function lt(Ot){jt[Ot]||n(12,jt[Ot]=!0,jt)}function $e(Ot){(!(Ot in jt)||jt[Ot])&&n(12,jt[Ot]=!1,jt)}function pt(Ot,gi){at[Ot]!=gi&&(gi===""||gi==null?(delete at[Ot],n(13,at)):n(13,at[Ot]=gi,at))}function ut(){_t==="banner"&&au(Nt(),Rt?"SMUIBannerButton:secondaryActionClick":"SMUIBannerButton:primaryActionClick")}function Nt(){return Oe.getElement()}function Bt(Ot){ua[Ot?"unshift":"push"](()=>{Oe=Ot,n(11,Oe)})}return e.$$set=Ot=>{n(31,t=_r(_r({},t),ic(Ot))),n(23,a=Ao(t,S)),"use"in Ot&&n(0,ae=Ot.use),"class"in Ot&&n(1,ce=Ot.class),"style"in Ot&&n(2,be=Ot.style),"ripple"in Ot&&n(3,Je=Ot.ripple),"color"in Ot&&n(4,st=Ot.color),"variant"in Ot&&n(5,Ye=Ot.variant),"touch"in Ot&&n(6,it=Ot.touch),"href"in Ot&&n(7,ct=Ot.href),"action"in Ot&&n(24,Tt=Ot.action),"defaultAction"in Ot&&n(25,zt=Ot.defaultAction),"secondary"in Ot&&n(8,Rt=Ot.secondary),"component"in Ot&&n(9,mt=Ot.component),"tag"in Ot&&n(10,xt=Ot.tag),"$$scope"in Ot&&n(30,W=Ot.$$scope)},e.$$.update=()=>{if(n(16,c=_t==="dialog:action"&&Tt!=null?{"data-mdc-dialog-action":Tt}:{action:t.action}),n(15,g=_t==="dialog:action"&&zt?{"data-mdc-dialog-button-default":""}:{default:t.default}),n(14,x=_t==="banner"?{}:{secondary:t.secondary}),bt!==a.disabled){const Ot=Nt();"blur"in Ot&&Ot.blur(),n(27,bt=a.disabled)}},t=ic(t),[ae,ce,be,Je,st,Ye,it,ct,Rt,mt,xt,Oe,jt,at,x,g,c,he,_t,lt,$e,pt,ut,a,Tt,zt,Nt,bt,U,Bt,W]}class ZF extends fo{constructor(t){super(),po(this,t,jF,HF,Va,{use:0,class:1,style:2,ripple:3,color:4,variant:5,touch:6,href:7,action:24,defaultAction:25,secondary:8,component:9,tag:10,getElement:26},null,[-1,-1])}get getElement(){return this.$$.ctx[26]}}function QF(e){let t,n,c;const g=e[2].default,x=Hl(g,e,e[1],null);return{c(){t=Rn("div"),x&&x.c(),this.h()},l(S){t=Fn(S,"DIV",{class:!0});var a=_n(t);x&&x.l(a),a.forEach(yi),this.h()},h(){Ti(t,"class",n="s-app theme--"+e[0])},m(S,a){Un(S,t,a),x&&x.m(t,null),c=!0},p(S,[a]){x&&x.p&&(!c||a&2)&&jl(x,g,S,S[1],c?Ql(g,S[1],a,null):Zl(S[1]),null),(!c||a&1&&n!==(n="s-app theme--"+S[0]))&&Ti(t,"class",n)},i(S){c||(Wi(x,S),c=!0)},o(S){tn(x,S),c=!1},d(S){S&&yi(t),x&&x.d(S)}}}function WF(e,t,n){let{$$slots:c={},$$scope:g}=t,{theme:x="light"}=t;return e.$$set=S=>{"theme"in S&&n(0,x=S.theme),"$$scope"in S&&n(1,g=S.$$scope)},[x,g,c]}class $F extends fo{constructor(t){super(),po(this,t,WF,QF,Va,{theme:0})}}function XF(e){return e.split(" ").map(t=>/^(lighten|darken|accent)-/.test(t)?`text-${t}`:`${t}-text`)}function rw(e,t){if(/^(#|rgb|hsl|currentColor)/.test(t))return e.style.color=t,!1;if(t.startsWith("--"))return e.style.color=`var(${t})`,!1;const n=XF(t);return e.classList.add(...n),n}const YF=(e,t)=>{let n;return typeof t=="string"&&(n=rw(e,t)),{update(c){n?e.classList.remove(...n):e.style.color=null,typeof c=="string"&&(n=rw(e,c))}}};let sw=36,KF="";for(;sw--;)KF+=sw.toString(36);function aw(e){let t,n=[{class:"underlay"},e[9],{"stroke-dashoffset":"0"}],c={};for(let g=0;g<n.length;g+=1)c=_r(c,n[g]);return{c(){t=Ra("circle"),this.h()},l(g){t=Fa(g,"circle",{class:!0,"stroke-dashoffset":!0}),_n(t).forEach(yi),this.h()},h(){A_(t,c),em(t,"svelte-kiaiot",!0)},m(g,x){Un(g,t,x)},p(g,x){em(t,"svelte-kiaiot",!0)},d(g){g&&yi(t)}}}function JF(e){let t,n,c,g,x,S,a,U,W,he,ae,ce=!e[1]&&aw(e),be=[{class:"overlay"},e[9],{"stroke-dashoffset":e[8]}],Je={};for(let it=0;it<be.length;it+=1)Je=_r(Je,be[it]);const st=e[12].default,Ye=Hl(st,e,e[11],null);return{c(){t=Rn("div"),n=Ra("svg"),ce&&ce.c(),c=Ra("circle"),g=Sr(),x=Rn("div"),Ye&&Ye.c(),this.h()},l(it){t=Fn(it,"DIV",{role:!0,"aria-valuemin":!0,"aria-valuemax":!0,"aria-valuenow":!0,class:!0,style:!0});var ct=_n(t);n=Fa(ct,"svg",{xmlns:!0,viewBox:!0,style:!0,class:!0});var Tt=_n(n);ce&&ce.l(Tt),c=Fa(Tt,"circle",{class:!0,"stroke-dashoffset":!0}),_n(c).forEach(yi),Tt.forEach(yi),g=Ir(ct),x=Fn(ct,"DIV",{class:!0});var zt=_n(x);Ye&&Ye.l(zt),zt.forEach(yi),ct.forEach(yi),this.h()},h(){A_(c,Je),em(c,"svelte-kiaiot",!0),Ti(n,"xmlns","http://www.w3.org/2000/svg"),Ti(n,"viewBox",e[7]+`
    `+e[7]+`
    `+2*e[7]+`
    `+2*e[7]),Ly(n,"transform","rotate("+e[3]+"deg)"),Ti(n,"class","svelte-kiaiot"),Ti(x,"class","s-progress-circular__content svelte-kiaiot"),Ti(t,"role","progressbar"),Ti(t,"aria-valuemin","0"),Ti(t,"aria-valuemax","100"),Ti(t,"aria-valuenow",e[5]),Ti(t,"class",S="s-progress-circular "+e[0]+" svelte-kiaiot"),Ti(t,"style",a="width:"+e[4]+"px;height:"+e[4]+"px;"+e[6]),em(t,"indeterminate",e[1])},m(it,ct){Un(it,t,ct),qi(t,n),ce&&ce.m(n,null),qi(n,c),qi(t,g),qi(t,x),Ye&&Ye.m(x,null),W=!0,he||(ae=Io(U=YF.call(null,t,e[2])),he=!0)},p(it,[ct]){it[1]?ce&&(ce.d(1),ce=null):ce?ce.p(it,ct):(ce=aw(it),ce.c(),ce.m(n,c)),em(c,"svelte-kiaiot",!0),(!W||ct&8)&&Ly(n,"transform","rotate("+it[3]+"deg)"),Ye&&Ye.p&&(!W||ct&2048)&&jl(Ye,st,it,it[11],W?Ql(st,it[11],ct,null):Zl(it[11]),null),(!W||ct&32)&&Ti(t,"aria-valuenow",it[5]),(!W||ct&1&&S!==(S="s-progress-circular "+it[0]+" svelte-kiaiot"))&&Ti(t,"class",S),(!W||ct&80&&a!==(a="width:"+it[4]+"px;height:"+it[4]+"px;"+it[6]))&&Ti(t,"style",a),U&&Eu(U.update)&&ct&4&&U.update.call(null,it[2]),(!W||ct&3)&&em(t,"indeterminate",it[1])},i(it){W||(Wi(Ye,it),W=!0)},o(it){tn(Ye,it),W=!1},d(it){it&&yi(t),ce&&ce.d(),Ye&&Ye.d(it),he=!1,ae()}}}const uy=20;function eO(e,t,n){let{$$slots:c={},$$scope:g}=t,{class:x=""}=t,{indeterminate:S=!1}=t,{color:a="secondary"}=t,{rotate:U=0}=t,{size:W=32}=t,{value:he=0}=t,{width:ae=4}=t,{style:ce=""}=t;const be=2*3.1416*uy,Je=uy/(1-Number(ae)/+W),st=Number(ae)/+W*Je*2,Ye=(100-he)/100*be,it={fill:"transparent",cx:2*Je,cy:2*Je,r:uy,"stroke-width":st,"stroke-dasharray":be};return e.$$set=ct=>{"class"in ct&&n(0,x=ct.class),"indeterminate"in ct&&n(1,S=ct.indeterminate),"color"in ct&&n(2,a=ct.color),"rotate"in ct&&n(3,U=ct.rotate),"size"in ct&&n(4,W=ct.size),"value"in ct&&n(5,he=ct.value),"width"in ct&&n(10,ae=ct.width),"style"in ct&&n(6,ce=ct.style),"$$scope"in ct&&n(11,g=ct.$$scope)},[x,S,a,U,W,he,ce,Je,Ye,it,ae,g,c]}class tO extends fo{constructor(t){super(),po(this,t,eO,JF,Va,{class:0,indeterminate:1,color:2,rotate:3,size:4,value:5,width:10,style:6})}}function iO(e){let t,n;return t=new tO({props:{size:50,indeterminate:!0,color:p_()[500]}}),{c(){Jr(t.$$.fragment)},l(c){vs(t.$$.fragment,c)},m(c,g){es(t,c,g),n=!0},p:Oa,i(c){n||(Wi(t.$$.fragment,c),n=!0)},o(c){tn(t.$$.fragment,c),n=!1},d(c){ts(t,c)}}}function ow(e){let t,n;return{c(){t=Rn("h3"),n=ba(e[0]),this.h()},l(c){t=Fn(c,"H3",{class:!0});var g=_n(t);n=wa(g,e[0]),g.forEach(yi),this.h()},h(){Ti(t,"class","svelte-10jlhi")},m(c,g){Un(c,t,g),qi(t,n)},p(c,g){g&1&&ql(n,c[0])},d(c){c&&yi(t)}}}function nO(e){let t,n,c,g;n=new $F({props:{$$slots:{default:[iO]},$$scope:{ctx:e}}});let x=e[0]&&ow(e);return{c(){t=Rn("div"),Jr(n.$$.fragment),c=Sr(),x&&x.c(),this.h()},l(S){t=Fn(S,"DIV",{class:!0});var a=_n(t);vs(n.$$.fragment,a),c=Ir(a),x&&x.l(a),a.forEach(yi),this.h()},h(){Ti(t,"class","loading-container svelte-10jlhi")},m(S,a){Un(S,t,a),es(n,t,null),qi(t,c),x&&x.m(t,null),g=!0},p(S,[a]){const U={};a&2&&(U.$$scope={dirty:a,ctx:S}),n.$set(U),S[0]?x?x.p(S,a):(x=ow(S),x.c(),x.m(t,null)):x&&(x.d(1),x=null)},i(S){g||(Wi(n.$$.fragment,S),g=!0)},o(S){tn(n.$$.fragment,S),g=!1},d(S){S&&yi(t),ts(n),x&&x.d()}}}function rO(e,t,n){let{message:c}=t;return e.$$set=g=>{"message"in g&&n(0,c=g.message)},[c]}class l5 extends fo{constructor(t){super(),po(this,t,rO,nO,Va,{message:0})}}function lw(e,t,n){const c=e.slice();return c[16]=t[n],c}function uw(e,t,n){const c=e.slice();return c[16]=t[n],c}function cw(e,t,n){const c=e.slice();return c[16]=t[n],c}function sO(e){let t=e[16].name+"",n;return{c(){n=ba(t)},l(c){n=wa(c,t)},m(c,g){Un(c,n,g)},p(c,g){g&16&&t!==(t=c[16].name+"")&&ql(n,t)},d(c){c&&yi(n)}}}function hw(e){let t,n;return t=new Sm({props:{value:e[16],$$slots:{default:[sO]},$$scope:{ctx:e}}}),{c(){Jr(t.$$.fragment)},l(c){vs(t.$$.fragment,c)},m(c,g){es(t,c,g),n=!0},p(c,g){const x={};g&16&&(x.value=c[16]),g&8388624&&(x.$$scope={dirty:g,ctx:c}),t.$set(x)},i(c){n||(Wi(t.$$.fragment,c),n=!0)},o(c){tn(t.$$.fragment,c),n=!1},d(c){ts(t,c)}}}function aO(e){let t,n,c=yc(e[4]),g=[];for(let S=0;S<c.length;S+=1)g[S]=hw(cw(e,c,S));const x=S=>tn(g[S],1,1,()=>{g[S]=null});return{c(){for(let S=0;S<g.length;S+=1)g[S].c();t=xs()},l(S){for(let a=0;a<g.length;a+=1)g[a].l(S);t=xs()},m(S,a){for(let U=0;U<g.length;U+=1)g[U]&&g[U].m(S,a);Un(S,t,a),n=!0},p(S,a){if(a&16){c=yc(S[4]);let U;for(U=0;U<c.length;U+=1){const W=cw(S,c,U);g[U]?(g[U].p(W,a),Wi(g[U],1)):(g[U]=hw(W),g[U].c(),Wi(g[U],1),g[U].m(t.parentNode,t))}for(Eo(),U=c.length;U<g.length;U+=1)x(U);Co()}},i(S){if(!n){for(let a=0;a<c.length;a+=1)Wi(g[a]);n=!0}},o(S){g=g.filter(Boolean);for(let a=0;a<g.length;a+=1)tn(g[a]);n=!1},d(S){S&&yi(t),G0(g,S)}}}function Aw(e){var be,Je,st,Ye,it,ct;let t,n,c,g=((Je=(be=e[0])==null?void 0:be.next)==null?void 0:Je.name)+"",x,S,a,U,W,he,ae=((Ye=(st=e[0])==null?void 0:st.next)==null?void 0:Ye.options.length)>0&&fw(e),ce=((ct=(it=e[0])==null?void 0:it.next)==null?void 0:ct.options.length)==0&&pw();return{c(){t=Rn("div"),n=Rn("h2"),c=ba("Select which "),x=ba(g),S=ba(" to use"),a=Sr(),ae&&ae.c(),U=Sr(),ce&&ce.c(),this.h()},l(Tt){t=Fn(Tt,"DIV",{class:!0});var zt=_n(t);n=Fn(zt,"H2",{class:!0});var Rt=_n(n);c=wa(Rt,"Select which "),x=wa(Rt,g),S=wa(Rt," to use"),Rt.forEach(yi),a=Ir(zt),ae&&ae.l(zt),U=Ir(zt),ce&&ce.l(zt),zt.forEach(yi),this.h()},h(){var Tt;Ti(n,"class","svelte-wgfovm"),Ti(t,"class",W=tp(`step ${!((Tt=e[0])!=null&&Tt.next)||!e[3]&&"grayed"}`)+" svelte-wgfovm")},m(Tt,zt){Un(Tt,t,zt),qi(t,n),qi(n,c),qi(n,x),qi(n,S),qi(t,a),ae&&ae.m(t,null),qi(t,U),ce&&ce.m(t,null),he=!0},p(Tt,zt){var Rt,Oe,jt,at,_t,mt,xt;(!he||zt&1)&&g!==(g=((Oe=(Rt=Tt[0])==null?void 0:Rt.next)==null?void 0:Oe.name)+"")&&ql(x,g),((at=(jt=Tt[0])==null?void 0:jt.next)==null?void 0:at.options.length)>0?ae?(ae.p(Tt,zt),zt&1&&Wi(ae,1)):(ae=fw(Tt),ae.c(),Wi(ae,1),ae.m(t,U)):ae&&(Eo(),tn(ae,1,1,()=>{ae=null}),Co()),((mt=(_t=Tt[0])==null?void 0:_t.next)==null?void 0:mt.options.length)==0?ce?zt&1&&Wi(ce,1):(ce=pw(),ce.c(),Wi(ce,1),ce.m(t,null)):ce&&(Eo(),tn(ce,1,1,()=>{ce=null}),Co()),(!he||zt&9&&W!==(W=tp(`step ${!((xt=Tt[0])!=null&&xt.next)||!Tt[3]&&"grayed"}`)+" svelte-wgfovm"))&&Ti(t,"class",W)},i(Tt){he||(Wi(ae),Wi(ce),he=!0)},o(Tt){tn(ae),tn(ce),he=!1},d(Tt){Tt&&yi(t),ae&&ae.d(),ce&&ce.d()}}}function fw(e){let t,n,c;function g(S){e[10](S)}let x={class:"shaped",variant:"filled",$$slots:{default:[lO]},$$scope:{ctx:e}};return e[1]!==void 0&&(x.value=e[1]),t=new um({props:x}),ua.push(()=>i0(t,"value",g)),{c(){Jr(t.$$.fragment)},l(S){vs(t.$$.fragment,S)},m(S,a){es(t,S,a),c=!0},p(S,a){const U={};a&8388609&&(U.$$scope={dirty:a,ctx:S}),!n&&a&2&&(n=!0,U.value=S[1],t0(()=>n=!1)),t.$set(U)},i(S){c||(Wi(t.$$.fragment,S),c=!0)},o(S){tn(t.$$.fragment,S),c=!1},d(S){ts(t,S)}}}function oO(e){let t=e[16].name+"",n;return{c(){n=ba(t)},l(c){n=wa(c,t)},m(c,g){Un(c,n,g)},p(c,g){g&1&&t!==(t=c[16].name+"")&&ql(n,t)},d(c){c&&yi(n)}}}function dw(e){let t,n;return t=new Sm({props:{value:e[16],$$slots:{default:[oO]},$$scope:{ctx:e}}}),{c(){Jr(t.$$.fragment)},l(c){vs(t.$$.fragment,c)},m(c,g){es(t,c,g),n=!0},p(c,g){const x={};g&1&&(x.value=c[16]),g&8388609&&(x.$$scope={dirty:g,ctx:c}),t.$set(x)},i(c){n||(Wi(t.$$.fragment,c),n=!0)},o(c){tn(t.$$.fragment,c),n=!1},d(c){ts(t,c)}}}function lO(e){var S,a;let t,n,c=yc((a=(S=e[0])==null?void 0:S.next)==null?void 0:a.options),g=[];for(let U=0;U<c.length;U+=1)g[U]=dw(uw(e,c,U));const x=U=>tn(g[U],1,1,()=>{g[U]=null});return{c(){for(let U=0;U<g.length;U+=1)g[U].c();t=xs()},l(U){for(let W=0;W<g.length;W+=1)g[W].l(U);t=xs()},m(U,W){for(let he=0;he<g.length;he+=1)g[he]&&g[he].m(U,W);Un(U,t,W),n=!0},p(U,W){var he,ae;if(W&1){c=yc((ae=(he=U[0])==null?void 0:he.next)==null?void 0:ae.options);let ce;for(ce=0;ce<c.length;ce+=1){const be=uw(U,c,ce);g[ce]?(g[ce].p(be,W),Wi(g[ce],1)):(g[ce]=dw(be),g[ce].c(),Wi(g[ce],1),g[ce].m(t.parentNode,t))}for(Eo(),ce=c.length;ce<g.length;ce+=1)x(ce);Co()}},i(U){if(!n){for(let W=0;W<c.length;W+=1)Wi(g[W]);n=!0}},o(U){g=g.filter(Boolean);for(let W=0;W<g.length;W+=1)tn(g[W]);n=!1},d(U){U&&yi(t),G0(g,U)}}}function pw(e){let t,n;return t=new l5({}),{c(){Jr(t.$$.fragment)},l(c){vs(t.$$.fragment,c)},m(c,g){es(t,c,g),n=!0},i(c){n||(Wi(t.$$.fragment,c),n=!0)},o(c){tn(t.$$.fragment,c),n=!1},d(c){ts(t,c)}}}function uO(e){let t=e[16]+"",n;return{c(){n=ba(t)},l(c){n=wa(c,t)},m(c,g){Un(c,n,g)},p:Oa,d(c){c&&yi(n)}}}function mw(e){let t,n;return t=new Sm({props:{value:e[16],$$slots:{default:[uO]},$$scope:{ctx:e}}}),{c(){Jr(t.$$.fragment)},l(c){vs(t.$$.fragment,c)},m(c,g){es(t,c,g),n=!0},p(c,g){const x={};g&8388608&&(x.$$scope={dirty:g,ctx:c}),t.$set(x)},i(c){n||(Wi(t.$$.fragment,c),n=!0)},o(c){tn(t.$$.fragment,c),n=!1},d(c){ts(t,c)}}}function cO(e){let t,n,c=yc(e[5]),g=[];for(let S=0;S<c.length;S+=1)g[S]=mw(lw(e,c,S));const x=S=>tn(g[S],1,1,()=>{g[S]=null});return{c(){for(let S=0;S<g.length;S+=1)g[S].c();t=xs()},l(S){for(let a=0;a<g.length;a+=1)g[a].l(S);t=xs()},m(S,a){for(let U=0;U<g.length;U+=1)g[U]&&g[U].m(S,a);Un(S,t,a),n=!0},p(S,a){if(a&32){c=yc(S[5]);let U;for(U=0;U<c.length;U+=1){const W=lw(S,c,U);g[U]?(g[U].p(W,a),Wi(g[U],1)):(g[U]=mw(W),g[U].c(),Wi(g[U],1),g[U].m(t.parentNode,t))}for(Eo(),U=c.length;U<g.length;U+=1)x(U);Co()}},i(S){if(!n){for(let a=0;a<c.length;a+=1)Wi(g[a]);n=!0}},o(S){g=g.filter(Boolean);for(let a=0;a<g.length;a+=1)tn(g[a]);n=!1},d(S){S&&yi(t),G0(g,S)}}}function hO(e){let t=e[0]?"Build":"Select a null model",n;return{c(){n=ba(t)},l(c){n=wa(c,t)},m(c,g){Un(c,n,g)},p(c,g){g&1&&t!==(t=c[0]?"Build":"Select a null model")&&ql(n,t)},d(c){c&&yi(n)}}}function AO(e){let t,n;return t=new oC({props:{$$slots:{default:[hO]},$$scope:{ctx:e}}}),{c(){Jr(t.$$.fragment)},l(c){vs(t.$$.fragment,c)},m(c,g){es(t,c,g),n=!0},p(c,g){const x={};g&8388609&&(x.$$scope={dirty:g,ctx:c}),t.$set(x)},i(c){n||(Wi(t.$$.fragment,c),n=!0)},o(c){tn(t.$$.fragment,c),n=!1},d(c){ts(t,c)}}}function fO(e){var lt;let t,n,c,g,x,S,a,U="Select a null model",W,he,ae,ce,be,Je,st,Ye="Select a different region to compare",it,ct,Tt,zt,Rt,Oe,jt;c=new v3({});function at($e){e[9]($e)}let _t={class:"shaped",variant:"filled",$$slots:{default:[aO]},$$scope:{ctx:e}};e[0]!==void 0&&(_t.value=e[0]),he=new um({props:_t}),ua.push(()=>i0(he,"value",at));let mt=((lt=e[0])==null?void 0:lt.next)&&Aw(e);function xt($e){e[11]($e)}let bt={class:"shaped",variant:"filled",$$slots:{default:[cO]},$$scope:{ctx:e}};return e[2]!==void 0&&(bt.value=e[2]),ct=new um({props:bt}),ua.push(()=>i0(ct,"value",xt)),Oe=new ZF({props:{class:"theme-button",variant:"raised",disabled:!e[0],$$slots:{default:[AO]},$$scope:{ctx:e}}}),Oe.$on("click",e[12]),{c(){t=Rn("div"),n=Rn("div"),Jr(c.$$.fragment),g=Sr(),x=Rn("div"),S=Rn("div"),a=Rn("h2"),a.textContent=U,W=Sr(),Jr(he.$$.fragment),ce=Sr(),mt&&mt.c(),be=Sr(),Je=Rn("div"),st=Rn("h2"),st.textContent=Ye,it=Sr(),Jr(ct.$$.fragment),Rt=Sr(),Jr(Oe.$$.fragment),this.h()},l($e){t=Fn($e,"DIV",{class:!0});var pt=_n(t);n=Fn(pt,"DIV",{class:!0});var ut=_n(n);vs(c.$$.fragment,ut),ut.forEach(yi),g=Ir(pt),x=Fn(pt,"DIV",{class:!0});var Nt=_n(x);S=Fn(Nt,"DIV",{class:!0});var Bt=_n(S);a=Fn(Bt,"H2",{class:!0,"data-svelte-h":!0}),Qu(a)!=="svelte-1vw7qz9"&&(a.textContent=U),W=Ir(Bt),vs(he.$$.fragment,Bt),Bt.forEach(yi),ce=Ir(Nt),mt&&mt.l(Nt),be=Ir(Nt),Je=Fn(Nt,"DIV",{class:!0});var Ot=_n(Je);st=Fn(Ot,"H2",{class:!0,"data-svelte-h":!0}),Qu(st)!=="svelte-1y5wjwe"&&(st.textContent=Ye),it=Ir(Ot),vs(ct.$$.fragment,Ot),Ot.forEach(yi),Rt=Ir(Nt),vs(Oe.$$.fragment,Nt),Nt.forEach(yi),pt.forEach(yi),this.h()},h(){Ti(n,"class","logo svelte-wgfovm"),Ti(a,"class","svelte-wgfovm"),Ti(S,"class","step svelte-wgfovm"),Ti(st,"class","svelte-wgfovm"),Ti(Je,"class",zt=tp(`step ${!e[0]&&"grayed"}`)+" svelte-wgfovm"),Ti(x,"class","steps svelte-wgfovm"),Ti(t,"class","builder svelte-wgfovm")},m($e,pt){Un($e,t,pt),qi(t,n),es(c,n,null),qi(t,g),qi(t,x),qi(x,S),qi(S,a),qi(S,W),es(he,S,null),qi(x,ce),mt&&mt.m(x,null),qi(x,be),qi(x,Je),qi(Je,st),qi(Je,it),es(ct,Je,null),qi(x,Rt),es(Oe,x,null),jt=!0},p($e,[pt]){var Ot;const ut={};pt&8388624&&(ut.$$scope={dirty:pt,ctx:$e}),!ae&&pt&1&&(ae=!0,ut.value=$e[0],t0(()=>ae=!1)),he.$set(ut),(Ot=$e[0])!=null&&Ot.next?mt?(mt.p($e,pt),pt&1&&Wi(mt,1)):(mt=Aw($e),mt.c(),Wi(mt,1),mt.m(x,be)):mt&&(Eo(),tn(mt,1,1,()=>{mt=null}),Co());const Nt={};pt&8388608&&(Nt.$$scope={dirty:pt,ctx:$e}),!Tt&&pt&4&&(Tt=!0,Nt.value=$e[2],t0(()=>Tt=!1)),ct.$set(Nt),(!jt||pt&1&&zt!==(zt=tp(`step ${!$e[0]&&"grayed"}`)+" svelte-wgfovm"))&&Ti(Je,"class",zt);const Bt={};pt&1&&(Bt.disabled=!$e[0]),pt&8388609&&(Bt.$$scope={dirty:pt,ctx:$e}),Oe.$set(Bt)},i($e){jt||(Wi(c.$$.fragment,$e),Wi(he.$$.fragment,$e),Wi(mt),Wi(ct.$$.fragment,$e),Wi(Oe.$$.fragment,$e),jt=!0)},o($e){tn(c.$$.fragment,$e),tn(he.$$.fragment,$e),tn(mt),tn(ct.$$.fragment,$e),tn(Oe.$$.fragment,$e),jt=!1},d($e){$e&&yi(t),ts(c),ts(he),mt&&mt.d(),ts(ct),ts(Oe)}}}function dO(e,t,n){let c;Bu(e,Kp,ct=>n(8,c=ct));let{showEcoregions:g}=t,x=!1,{nullRegion:S}=t;const a=[{name:"All of California",type:"CALIFORNIA",next:null},{name:"By Ecoregion",type:"ECOREGION",next:{name:"ecoregion",options:[{name:"Ecoregion 1"},{name:"Ecoregion 2"},{name:"Ecoregion 3"}]}},{name:"Surface",next:"object"}];let{subNullRegion:U}=t,{altRegion:W}=t;const he=a;function ae(){if(!c.querySourceFeatures)return;let ct=c.querySourceFeatures("ecoregions"),Tt=[];for(let zt of ct)if(Tt.filter(Rt=>Rt.ids.includes(zt.id)).length==0){let Rt=`${zt.properties.US_L3NAME}`,Oe=Tt.filter(jt=>jt.name===Rt)[0];!Oe||(Oe==null?void 0:Oe.length)==0?Tt.push({ids:[zt.id],name:`${zt.properties.US_L3NAME}`,type:"ECOREGION",value:`${zt.properties.US_L3CODE}`}):Oe.ids=[...Oe.ids,zt.id]}Tt=Tt.sort((zt,Rt)=>zt.name.localeCompare(Rt.name)),n(4,a[1].next.options=Tt,a),n(3,x=!0)}function ce(ct){if(!ct)return;let Tt=c.querySourceFeatures("ecoregions");for(let zt of Tt)c.setFeatureState({source:"ecoregions",id:zt.id},{hover:!1});for(let zt of ct.ids)c.setFeatureState({source:"ecoregions",id:zt},{hover:!0})}async function be(){$_.set({type:S.type,sub:U})}bc(()=>{ae()});function Je(ct){S=ct,n(0,S)}function st(ct){U=ct,n(1,U)}function Ye(ct){W=ct,n(2,W)}const it=()=>be();return e.$$set=ct=>{"showEcoregions"in ct&&n(7,g=ct.showEcoregions),"nullRegion"in ct&&n(0,S=ct.nullRegion),"subNullRegion"in ct&&n(1,U=ct.subNullRegion),"altRegion"in ct&&n(2,W=ct.altRegion)},e.$$.update=()=>{var ct;e.$$.dirty&256&&c&&ae(),e.$$.dirty&129&&(S&&((ct=S.next)==null?void 0:ct.name)==="ecoregion"?g(!0):g(!1)),e.$$.dirty&2&&ce(U)},[S,U,W,x,a,he,be,g,c,Je,st,Ye,it]}class pO extends fo{constructor(t){super(),po(this,t,dO,fO,Va,{showEcoregions:7,nullRegion:0,subNullRegion:1,altRegion:2})}}function mO(e){let t,n,c,g='<td class="svelte-123tfyw">Hex</td> <td class="svelte-123tfyw">Tree Size</td> <td class="svelte-123tfyw">PD</td> <td class="svelte-123tfyw">MPD</td> <td class="svelte-123tfyw">MNTD</td>',x,S,a,U=e[0].hex+"",W,he,ae,ce=(e[1](e[0].properties.tree_sizes)??"Unknown")+"",be,Je,st,Ye=(e[1](e[0].properties.pd)??"Unknown")+"",it,ct,Tt,zt=(e[1](e[0].properties.mpd)??"Unknown")+"",Rt,Oe,jt,at=(e[1](e[0].properties.mntd)??"Unknown")+"",_t;return{c(){t=Rn("div"),n=Rn("table"),c=Rn("thead"),c.innerHTML=g,x=Sr(),S=Rn("tr"),a=Rn("td"),W=ba(U),he=Sr(),ae=Rn("td"),be=ba(ce),Je=Sr(),st=Rn("td"),it=ba(Ye),ct=Sr(),Tt=Rn("td"),Rt=ba(zt),Oe=Sr(),jt=Rn("td"),_t=ba(at),this.h()},l(mt){t=Fn(mt,"DIV",{class:!0});var xt=_n(t);n=Fn(xt,"TABLE",{});var bt=_n(n);c=Fn(bt,"THEAD",{class:!0,"data-svelte-h":!0}),Qu(c)!=="svelte-i8fsz9"&&(c.innerHTML=g),x=Ir(bt),S=Fn(bt,"TR",{class:!0});var lt=_n(S);a=Fn(lt,"TD",{class:!0});var $e=_n(a);W=wa($e,U),$e.forEach(yi),he=Ir(lt),ae=Fn(lt,"TD",{class:!0});var pt=_n(ae);be=wa(pt,ce),pt.forEach(yi),Je=Ir(lt),st=Fn(lt,"TD",{class:!0});var ut=_n(st);it=wa(ut,Ye),ut.forEach(yi),ct=Ir(lt),Tt=Fn(lt,"TD",{class:!0});var Nt=_n(Tt);Rt=wa(Nt,zt),Nt.forEach(yi),Oe=Ir(lt),jt=Fn(lt,"TD",{class:!0});var Bt=_n(jt);_t=wa(Bt,at),Bt.forEach(yi),lt.forEach(yi),bt.forEach(yi),xt.forEach(yi),this.h()},h(){Ti(c,"class","svelte-123tfyw"),Ti(a,"class","svelte-123tfyw"),Ti(ae,"class","svelte-123tfyw"),Ti(st,"class","svelte-123tfyw"),Ti(Tt,"class","svelte-123tfyw"),Ti(jt,"class","svelte-123tfyw"),Ti(S,"class","mono svelte-123tfyw"),Ti(t,"class","summary-container svelte-123tfyw")},m(mt,xt){Un(mt,t,xt),qi(t,n),qi(n,c),qi(n,x),qi(n,S),qi(S,a),qi(a,W),qi(S,he),qi(S,ae),qi(ae,be),qi(S,Je),qi(S,st),qi(st,it),qi(S,ct),qi(S,Tt),qi(Tt,Rt),qi(S,Oe),qi(S,jt),qi(jt,_t)},p(mt,[xt]){xt&1&&U!==(U=mt[0].hex+"")&&ql(W,U),xt&1&&ce!==(ce=(mt[1](mt[0].properties.tree_sizes)??"Unknown")+"")&&ql(be,ce),xt&1&&Ye!==(Ye=(mt[1](mt[0].properties.pd)??"Unknown")+"")&&ql(it,Ye),xt&1&&zt!==(zt=(mt[1](mt[0].properties.mpd)??"Unknown")+"")&&ql(Rt,zt),xt&1&&at!==(at=(mt[1](mt[0].properties.mntd)??"Unknown")+"")&&ql(_t,at)},i:Oa,o:Oa,d(mt){mt&&yi(t)}}}const gw=3;function gO(e,t,n){let{data:c}=t;const g=x=>Math.round(x*10**gw)/10**gw;return e.$$set=x=>{"data"in x&&n(0,c=x.data)},[c,g]}class _O extends fo{constructor(t){super(),po(this,t,gO,mO,Va,{data:0})}}function yO(e){let t,n,c,g,x,S='<strong class="svelte-1b48uq5">PH</strong>ylogenetic <strong class="svelte-1b48uq5">A</strong>nalysis at <strong class="svelte-1b48uq5">S</strong>peedy <strong class="svelte-1b48uq5">T</strong>ime',a,U,W="To start, set the options at the top right to the metric and taxon you want to look at.",he,ae,ce="This is a description of the program for users to be able to read in lieu of specific metrics so that we don't have a big white space when users start the application. This way we can describe useful information and context about the project at the right time, while also making the most of the whitespace on the page. This description should change once we decide exactly what information we want to convey to the user and finalize certain UX flows that are in development.",be;return c=new v3({}),{c(){t=Rn("div"),n=Rn("h1"),Jr(c.$$.fragment),g=Sr(),x=Rn("h3"),x.innerHTML=S,a=Sr(),U=Rn("p"),U.textContent=W,he=Sr(),ae=Rn("p"),ae.textContent=ce,this.h()},l(Je){t=Fn(Je,"DIV",{class:!0});var st=_n(t);n=Fn(st,"H1",{});var Ye=_n(n);vs(c.$$.fragment,Ye),Ye.forEach(yi),g=Ir(st),x=Fn(st,"H3",{class:!0,"data-svelte-h":!0}),Qu(x)!=="svelte-12h6mrz"&&(x.innerHTML=S),a=Ir(st),U=Fn(st,"P",{"data-svelte-h":!0}),Qu(U)!=="svelte-4cip2g"&&(U.textContent=W),he=Ir(st),ae=Fn(st,"P",{"data-svelte-h":!0}),Qu(ae)!=="svelte-1icmnw4"&&(ae.textContent=ce),st.forEach(yi),this.h()},h(){Ti(x,"class","svelte-1b48uq5"),Ti(t,"class","about svelte-1b48uq5")},m(Je,st){Un(Je,t,st),qi(t,n),es(c,n,null),qi(t,g),qi(t,x),qi(t,a),qi(t,U),qi(t,he),qi(t,ae),be=!0},p:Oa,i(Je){be||(Wi(c.$$.fragment,Je),be=!0)},o(Je){tn(c.$$.fragment,Je),be=!1},d(Je){Je&&yi(t),ts(c)}}}class vO extends fo{constructor(t){super(),po(this,t,null,yO,Va,{})}}function _w(e,t,n){const c=e.slice();return c[20]=t[n],c}function yw(e,t,n){const c=e.slice();return c[20]=t[n],c}function xO(e,t,n){const c=e.slice();return c[20]=t[n],c}function vw(e){let t,n,c,g,x,S,a,U,W,he,ae,ce,be,Je,st,Ye,it,ct;function Tt(lt){e[15](lt)}let zt={class:"shaped",variant:"outlined",$$slots:{default:[SO]},$$scope:{ctx:e}};e[0]!==void 0&&(zt.value=e[0]),g=new um({props:zt}),ua.push(()=>i0(g,"value",Tt)),g.$on("change",e[16]);function Rt(lt){e[17](lt)}let Oe={class:"shaped",variant:"outlined",$$slots:{default:[EO]},$$scope:{ctx:e}};e[1]!==void 0&&(Oe.value=e[1]),a=new um({props:Oe}),ua.push(()=>i0(a,"value",Rt));function jt(lt){e[18](lt)}let at={class:"shaped",variant:"outlined",$$slots:{default:[TO]},$$scope:{ctx:e}};e[11]!==void 0&&(at.value=e[11]),he=new um({props:at}),ua.push(()=>i0(he,"value",jt));let _t=e[9]&&ww(e),mt=!e[7]&&Sw(),xt=!e[9]&&Iw(),bt=e[9]&&Ew(e);return{c(){t=Rn("div"),n=Rn("div"),c=ba(`Testing
                `),Jr(g.$$.fragment),S=ba(`
                of
                `),Jr(a.$$.fragment),W=ba(`
                at the
                `),Jr(he.$$.fragment),ce=ba(`
                level`),be=Sr(),_t&&_t.c(),Je=Sr(),mt&&mt.c(),st=Sr(),xt&&xt.c(),Ye=Sr(),bt&&bt.c(),it=xs(),this.h()},l(lt){t=Fn(lt,"DIV",{class:!0});var $e=_n(t);n=Fn($e,"DIV",{class:!0});var pt=_n(n);c=wa(pt,`Testing
                `),vs(g.$$.fragment,pt),S=wa(pt,`
                of
                `),vs(a.$$.fragment,pt),W=wa(pt,`
                at the
                `),vs(he.$$.fragment,pt),ce=wa(pt,`
                level`),pt.forEach(yi),be=Ir($e),_t&&_t.l($e),$e.forEach(yi),Je=Ir(lt),mt&&mt.l(lt),st=Ir(lt),xt&&xt.l(lt),Ye=Ir(lt),bt&&bt.l(lt),it=xs(),this.h()},h(){Ti(n,"class","test svelte-8myhro"),Ti(t,"class","header svelte-8myhro")},m(lt,$e){Un(lt,t,$e),qi(t,n),qi(n,c),es(g,n,null),qi(n,S),es(a,n,null),qi(n,W),es(he,n,null),qi(n,ce),qi(t,be),_t&&_t.m(t,null),Un(lt,Je,$e),mt&&mt.m(lt,$e),Un(lt,st,$e),xt&&xt.m(lt,$e),Un(lt,Ye,$e),bt&&bt.m(lt,$e),Un(lt,it,$e),ct=!0},p(lt,$e){const pt={};$e&134217728&&(pt.$$scope={dirty:$e,ctx:lt}),!x&&$e&1&&(x=!0,pt.value=lt[0],t0(()=>x=!1)),g.$set(pt);const ut={};$e&134217744&&(ut.$$scope={dirty:$e,ctx:lt}),!U&&$e&2&&(U=!0,ut.value=lt[1],t0(()=>U=!1)),a.$set(ut);const Nt={};$e&134217760&&(Nt.$$scope={dirty:$e,ctx:lt}),!ae&&$e&2048&&(ae=!0,Nt.value=lt[11],t0(()=>ae=!1)),he.$set(Nt),lt[9]?_t?_t.p(lt,$e):(_t=ww(lt),_t.c(),_t.m(t,null)):_t&&(_t.d(1),_t=null),lt[7]?mt&&(Eo(),tn(mt,1,1,()=>{mt=null}),Co()):mt?$e&128&&Wi(mt,1):(mt=Sw(),mt.c(),Wi(mt,1),mt.m(st.parentNode,st)),lt[9]?xt&&(Eo(),tn(xt,1,1,()=>{xt=null}),Co()):xt?$e&512&&Wi(xt,1):(xt=Iw(),xt.c(),Wi(xt,1),xt.m(Ye.parentNode,Ye)),lt[9]?bt?(bt.p(lt,$e),$e&512&&Wi(bt,1)):(bt=Ew(lt),bt.c(),Wi(bt,1),bt.m(it.parentNode,it)):bt&&(Eo(),tn(bt,1,1,()=>{bt=null}),Co())},i(lt){ct||(Wi(g.$$.fragment,lt),Wi(a.$$.fragment,lt),Wi(he.$$.fragment,lt),Wi(mt),Wi(xt),Wi(bt),ct=!0)},o(lt){tn(g.$$.fragment,lt),tn(a.$$.fragment,lt),tn(he.$$.fragment,lt),tn(mt),tn(xt),tn(bt),ct=!1},d(lt){lt&&(yi(t),yi(Je),yi(st),yi(Ye),yi(it)),ts(g),ts(a),ts(he),_t&&_t.d(),mt&&mt.d(lt),xt&&xt.d(lt),bt&&bt.d(lt)}}}function bO(e){let t;return{c(){t=ba(e[20])},l(n){t=wa(n,e[20])},m(n,c){Un(n,t,c)},p:Oa,d(n){n&&yi(t)}}}function wO(e){let t,n;return t=new Sm({props:{value:e[20],$$slots:{default:[bO]},$$scope:{ctx:e}}}),{c(){Jr(t.$$.fragment)},l(c){vs(t.$$.fragment,c)},m(c,g){es(t,c,g),n=!0},p(c,g){const x={};g&134217728&&(x.$$scope={dirty:g,ctx:c}),t.$set(x)},i(c){n||(Wi(t.$$.fragment,c),n=!0)},o(c){tn(t.$$.fragment,c),n=!1},d(c){ts(t,c)}}}function SO(e){let t,n,c=yc(m_),g=[];for(let x=0;x<c.length;x+=1)g[x]=wO(xO(e,c,x));return{c(){for(let x=0;x<g.length;x+=1)g[x].c();t=xs()},l(x){for(let S=0;S<g.length;S+=1)g[S].l(x);t=xs()},m(x,S){for(let a=0;a<g.length;a+=1)g[a]&&g[a].m(x,S);Un(x,t,S),n=!0},p:Oa,i(x){if(!n){for(let S=0;S<c.length;S+=1)Wi(g[S]);n=!0}},o(x){g=g.filter(Boolean);for(let S=0;S<g.length;S+=1)tn(g[S]);n=!1},d(x){x&&yi(t),G0(g,x)}}}function IO(e){let t=e[20]+"",n;return{c(){n=ba(t)},l(c){n=wa(c,t)},m(c,g){Un(c,n,g)},p(c,g){g&16&&t!==(t=c[20]+"")&&ql(n,t)},d(c){c&&yi(n)}}}function xw(e){let t,n;return t=new Sm({props:{value:e[20],$$slots:{default:[IO]},$$scope:{ctx:e}}}),{c(){Jr(t.$$.fragment)},l(c){vs(t.$$.fragment,c)},m(c,g){es(t,c,g),n=!0},p(c,g){const x={};g&16&&(x.value=c[20]),g&134217744&&(x.$$scope={dirty:g,ctx:c}),t.$set(x)},i(c){n||(Wi(t.$$.fragment,c),n=!0)},o(c){tn(t.$$.fragment,c),n=!1},d(c){ts(t,c)}}}function EO(e){let t,n,c=yc(e[4]),g=[];for(let S=0;S<c.length;S+=1)g[S]=xw(yw(e,c,S));const x=S=>tn(g[S],1,1,()=>{g[S]=null});return{c(){for(let S=0;S<g.length;S+=1)g[S].c();t=xs()},l(S){for(let a=0;a<g.length;a+=1)g[a].l(S);t=xs()},m(S,a){for(let U=0;U<g.length;U+=1)g[U]&&g[U].m(S,a);Un(S,t,a),n=!0},p(S,a){if(a&16){c=yc(S[4]);let U;for(U=0;U<c.length;U+=1){const W=yw(S,c,U);g[U]?(g[U].p(W,a),Wi(g[U],1)):(g[U]=xw(W),g[U].c(),Wi(g[U],1),g[U].m(t.parentNode,t))}for(Eo(),U=c.length;U<g.length;U+=1)x(U);Co()}},i(S){if(!n){for(let a=0;a<c.length;a+=1)Wi(g[a]);n=!0}},o(S){g=g.filter(Boolean);for(let a=0;a<g.length;a+=1)tn(g[a]);n=!1},d(S){S&&yi(t),G0(g,S)}}}function CO(e){let t=e[20]+"",n;return{c(){n=ba(t)},l(c){n=wa(c,t)},m(c,g){Un(c,n,g)},p(c,g){g&32&&t!==(t=c[20]+"")&&ql(n,t)},d(c){c&&yi(n)}}}function bw(e){let t,n;return t=new Sm({props:{value:e[20],$$slots:{default:[CO]},$$scope:{ctx:e}}}),{c(){Jr(t.$$.fragment)},l(c){vs(t.$$.fragment,c)},m(c,g){es(t,c,g),n=!0},p(c,g){const x={};g&32&&(x.value=c[20]),g&134217760&&(x.$$scope={dirty:g,ctx:c}),t.$set(x)},i(c){n||(Wi(t.$$.fragment,c),n=!0)},o(c){tn(t.$$.fragment,c),n=!1},d(c){ts(t,c)}}}function TO(e){let t,n,c=yc(e[5]),g=[];for(let S=0;S<c.length;S+=1)g[S]=bw(_w(e,c,S));const x=S=>tn(g[S],1,1,()=>{g[S]=null});return{c(){for(let S=0;S<g.length;S+=1)g[S].c();t=xs()},l(S){for(let a=0;a<g.length;a+=1)g[a].l(S);t=xs()},m(S,a){for(let U=0;U<g.length;U+=1)g[U]&&g[U].m(S,a);Un(S,t,a),n=!0},p(S,a){if(a&32){c=yc(S[5]);let U;for(U=0;U<c.length;U+=1){const W=_w(S,c,U);g[U]?(g[U].p(W,a),Wi(g[U],1)):(g[U]=bw(W),g[U].c(),Wi(g[U],1),g[U].m(t.parentNode,t))}for(Eo(),U=c.length;U<g.length;U+=1)x(U);Co()}},i(S){if(!n){for(let a=0;a<c.length;a+=1)Wi(g[a]);n=!0}},o(S){g=g.filter(Boolean);for(let a=0;a<g.length;a+=1)tn(g[a]);n=!1},d(S){S&&yi(t),G0(g,S)}}}function ww(e){let t,n,c="x",g,x;return{c(){t=Rn("div"),n=Rn("button"),n.textContent=c,this.h()},l(S){t=Fn(S,"DIV",{class:!0});var a=_n(t);n=Fn(a,"BUTTON",{class:!0,"data-svelte-h":!0}),Qu(n)!=="svelte-1iv3129"&&(n.textContent=c),a.forEach(yi),this.h()},h(){Ti(n,"class","svelte-8myhro"),Ti(t,"class","close svelte-8myhro")},m(S,a){Un(S,t,a),qi(t,n),g||(x=Gl(n,"click",e[19]),g=!0)},p:Oa,d(S){S&&yi(t),g=!1,x()}}}function Sw(e){let t,n,c;return n=new l5({props:{message:"Building model..."}}),{c(){t=Rn("div"),Jr(n.$$.fragment),this.h()},l(g){t=Fn(g,"DIV",{class:!0});var x=_n(t);vs(n.$$.fragment,x),x.forEach(yi),this.h()},h(){Ti(t,"class","load svelte-8myhro")},m(g,x){Un(g,t,x),es(n,t,null),c=!0},i(g){c||(Wi(n.$$.fragment,g),c=!0)},o(g){tn(n.$$.fragment,g),c=!1},d(g){g&&yi(t),ts(n)}}}function Iw(e){let t,n;return t=new vO({}),{c(){Jr(t.$$.fragment)},l(c){vs(t.$$.fragment,c)},m(c,g){es(t,c,g),n=!0},i(c){n||(Wi(t.$$.fragment,c),n=!0)},o(c){tn(t.$$.fragment,c),n=!1},d(c){ts(t,c)}}}function Ew(e){var a,U,W,he,ae,ce,be,Je,st;let t,n,c,g,x,S;return t=new _O({props:{data:e[8]}}),c=new GM({props:{colorScheme:e[2],metric:e[0],point:[[(U=(a=e[8])==null?void 0:a.properties)==null?void 0:U.tree_sizes,(W=e[8])==null?void 0:W.properties[e[0]]]]}}),x=new GF({props:{clade:e[1],present:(ae=(he=e[8])==null?void 0:he.properties)==null?void 0:ae.present,newick:(be=(ce=e[8])==null?void 0:ce.properties)==null?void 0:be.tree,hex_id:(st=(Je=e[8])==null?void 0:Je.properties)==null?void 0:st.id}}),{c(){Jr(t.$$.fragment),n=Sr(),Jr(c.$$.fragment),g=Sr(),Jr(x.$$.fragment)},l(Ye){vs(t.$$.fragment,Ye),n=Ir(Ye),vs(c.$$.fragment,Ye),g=Ir(Ye),vs(x.$$.fragment,Ye)},m(Ye,it){es(t,Ye,it),Un(Ye,n,it),es(c,Ye,it),Un(Ye,g,it),es(x,Ye,it),S=!0},p(Ye,it){var Rt,Oe,jt,at,_t,mt,xt,bt,lt;const ct={};it&256&&(ct.data=Ye[8]),t.$set(ct);const Tt={};it&4&&(Tt.colorScheme=Ye[2]),it&1&&(Tt.metric=Ye[0]),it&257&&(Tt.point=[[(Oe=(Rt=Ye[8])==null?void 0:Rt.properties)==null?void 0:Oe.tree_sizes,(jt=Ye[8])==null?void 0:jt.properties[Ye[0]]]]),c.$set(Tt);const zt={};it&2&&(zt.clade=Ye[1]),it&256&&(zt.present=(_t=(at=Ye[8])==null?void 0:at.properties)==null?void 0:_t.present),it&256&&(zt.newick=(xt=(mt=Ye[8])==null?void 0:mt.properties)==null?void 0:xt.tree),it&256&&(zt.hex_id=(lt=(bt=Ye[8])==null?void 0:bt.properties)==null?void 0:lt.id),x.$set(zt)},i(Ye){S||(Wi(t.$$.fragment,Ye),Wi(c.$$.fragment,Ye),Wi(x.$$.fragment,Ye),S=!0)},o(Ye){tn(t.$$.fragment,Ye),tn(c.$$.fragment,Ye),tn(x.$$.fragment,Ye),S=!1},d(Ye){Ye&&(yi(n),yi(g)),ts(t,Ye),ts(c,Ye),ts(x,Ye)}}}function Cw(e){let t,n;return t=new pO({props:{showEcoregions:e[6]}}),{c(){Jr(t.$$.fragment)},l(c){vs(t.$$.fragment,c)},m(c,g){es(t,c,g),n=!0},p(c,g){const x={};g&64&&(x.showEcoregions=c[6]),t.$set(x)},i(c){n||(Wi(t.$$.fragment,c),n=!0)},o(c){tn(t.$$.fragment,c),n=!1},d(c){ts(t,c)}}}function kO(e){let t,n,c,g=e[10]&&vw(e),x=!e[10]&&Cw(e);return{c(){t=Rn("div"),g&&g.c(),n=Sr(),x&&x.c(),this.h()},l(S){t=Fn(S,"DIV",{class:!0});var a=_n(t);g&&g.l(a),n=Ir(a),x&&x.l(a),a.forEach(yi),this.h()},h(){Ti(t,"class",tp("modal")+" svelte-8myhro")},m(S,a){Un(S,t,a),g&&g.m(t,null),qi(t,n),x&&x.m(t,null),c=!0},p(S,[a]){S[10]?g?(g.p(S,a),a&1024&&Wi(g,1)):(g=vw(S),g.c(),Wi(g,1),g.m(t,n)):g&&(Eo(),tn(g,1,1,()=>{g=null}),Co()),S[10]?x&&(Eo(),tn(x,1,1,()=>{x=null}),Co()):x?(x.p(S,a),a&1024&&Wi(x,1)):(x=Cw(S),x.c(),Wi(x,1),x.m(t,null))},i(S){c||(Wi(g),Wi(x),c=!0)},o(S){tn(g),tn(x),c=!1},d(S){S&&yi(t),g&&g.d(),x&&x.d()}}}function MO(e,t,n){let c,g,x;Bu(e,hg,jt=>n(8,c=jt)),Bu(e,$_,jt=>n(10,g=jt)),Bu(e,Oy,jt=>n(11,x=jt));let{metric:S}=t,{colorScheme:a}=t,{updateMetricLayer:U}=t,{clade:W}=t,{updateClade:he}=t,{clades:ae}=t,{visualLayers:ce}=t,{isBuilt:be}=t,{showEcoregions:Je}=t,{isFinishedBuilding:st}=t,Ye;const it=jt=>{n(9,Ye=(jt==null?void 0:jt.properties)&&(jt==null?void 0:jt.properties[S])!==-1)};function ct(jt){S=jt,n(0,S)}const Tt=()=>U(S);function zt(jt){W=jt,n(1,W)}function Rt(jt){x=jt,Oy.set(x)}const Oe=()=>{it(null),hg.set(null),console.log(c)};return e.$$set=jt=>{"metric"in jt&&n(0,S=jt.metric),"colorScheme"in jt&&n(2,a=jt.colorScheme),"updateMetricLayer"in jt&&n(3,U=jt.updateMetricLayer),"clade"in jt&&n(1,W=jt.clade),"updateClade"in jt&&n(13,he=jt.updateClade),"clades"in jt&&n(4,ae=jt.clades),"visualLayers"in jt&&n(5,ce=jt.visualLayers),"isBuilt"in jt&&n(14,be=jt.isBuilt),"showEcoregions"in jt&&n(6,Je=jt.showEcoregions),"isFinishedBuilding"in jt&&n(7,st=jt.isFinishedBuilding)},e.$$.update=()=>{e.$$.dirty&256&&it(c),e.$$.dirty&8194&&he(W),e.$$.dirty&9&&U(S)},[S,W,a,U,ae,ce,Je,st,c,Ye,g,x,it,he,be,ct,Tt,zt,Rt,Oe]}class PO extends fo{constructor(t){super(),po(this,t,MO,kO,Va,{metric:0,colorScheme:2,updateMetricLayer:3,clade:1,updateClade:13,clades:4,visualLayers:5,isBuilt:14,showEcoregions:6,isFinishedBuilding:7})}}var DO={exports:{}};(function(e,t){(function(n,c){e.exports=c()})(Jf,function(){var n,c,g;function x(a,U){if(!n)n=U;else if(!c)c=U;else{var W="var sharedChunk = {}; ("+n+")(sharedChunk); ("+c+")(sharedChunk);",he={};n(he),g=U(he),typeof window<"u"&&(g.workerUrl=window.URL.createObjectURL(new Blob([W],{type:"text/javascript"})))}}x(["exports"],function(a){function U(f,u,p,I){return new(p||(p=Promise))(function(L,G){function Q(_e){try{Ae(I.next(_e))}catch(Le){G(Le)}}function re(_e){try{Ae(I.throw(_e))}catch(Le){G(Le)}}function Ae(_e){var Le;_e.done?L(_e.value):(Le=_e.value,Le instanceof p?Le:new p(function(qe){qe(Le)})).then(Q,re)}Ae((I=I.apply(f,u||[])).next())})}function W(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}typeof SuppressedError=="function"&&SuppressedError;var he=ae;function ae(f,u){this.x=f,this.y=u}ae.prototype={clone:function(){return new ae(this.x,this.y)},add:function(f){return this.clone()._add(f)},sub:function(f){return this.clone()._sub(f)},multByPoint:function(f){return this.clone()._multByPoint(f)},divByPoint:function(f){return this.clone()._divByPoint(f)},mult:function(f){return this.clone()._mult(f)},div:function(f){return this.clone()._div(f)},rotate:function(f){return this.clone()._rotate(f)},rotateAround:function(f,u){return this.clone()._rotateAround(f,u)},matMult:function(f){return this.clone()._matMult(f)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(f){return this.x===f.x&&this.y===f.y},dist:function(f){return Math.sqrt(this.distSqr(f))},distSqr:function(f){var u=f.x-this.x,p=f.y-this.y;return u*u+p*p},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(f){return Math.atan2(this.y-f.y,this.x-f.x)},angleWith:function(f){return this.angleWithSep(f.x,f.y)},angleWithSep:function(f,u){return Math.atan2(this.x*u-this.y*f,this.x*f+this.y*u)},_matMult:function(f){var u=f[2]*this.x+f[3]*this.y;return this.x=f[0]*this.x+f[1]*this.y,this.y=u,this},_add:function(f){return this.x+=f.x,this.y+=f.y,this},_sub:function(f){return this.x-=f.x,this.y-=f.y,this},_mult:function(f){return this.x*=f,this.y*=f,this},_div:function(f){return this.x/=f,this.y/=f,this},_multByPoint:function(f){return this.x*=f.x,this.y*=f.y,this},_divByPoint:function(f){return this.x/=f.x,this.y/=f.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var f=this.y;return this.y=this.x,this.x=-f,this},_rotate:function(f){var u=Math.cos(f),p=Math.sin(f),I=p*this.x+u*this.y;return this.x=u*this.x-p*this.y,this.y=I,this},_rotateAround:function(f,u){var p=Math.cos(f),I=Math.sin(f),L=u.y+I*(this.x-u.x)+p*(this.y-u.y);return this.x=u.x+p*(this.x-u.x)-I*(this.y-u.y),this.y=L,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ae.convert=function(f){return f instanceof ae?f:Array.isArray(f)?new ae(f[0],f[1]):f};var ce=W(he),be=Je;function Je(f,u,p,I){this.cx=3*f,this.bx=3*(p-f)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(I-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=f,this.p1y=u,this.p2x=p,this.p2y=I}Je.prototype={sampleCurveX:function(f){return((this.ax*f+this.bx)*f+this.cx)*f},sampleCurveY:function(f){return((this.ay*f+this.by)*f+this.cy)*f},sampleCurveDerivativeX:function(f){return(3*this.ax*f+2*this.bx)*f+this.cx},solveCurveX:function(f,u){if(u===void 0&&(u=1e-6),f<0)return 0;if(f>1)return 1;for(var p=f,I=0;I<8;I++){var L=this.sampleCurveX(p)-f;if(Math.abs(L)<u)return p;var G=this.sampleCurveDerivativeX(p);if(Math.abs(G)<1e-6)break;p-=L/G}var Q=0,re=1;for(p=f,I=0;I<20&&(L=this.sampleCurveX(p),!(Math.abs(L-f)<u));I++)f>L?Q=p:re=p,p=.5*(re-Q)+Q;return p},solve:function(f,u){return this.sampleCurveY(this.solveCurveX(f,u))}};var st=W(be);let Ye,it;function ct(){return Ye==null&&(Ye=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ye}function Tt(){if(it==null&&(it=!1,ct())){const u=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(u){for(let I=0;I<5*5;I++){const L=4*I;u.fillStyle=`rgb(${L},${L+1},${L+2})`,u.fillRect(I%5,Math.floor(I/5),1,1)}const p=u.getImageData(0,0,5,5).data;for(let I=0;I<5*5*4;I++)if(I%4!=3&&p[I]!==I){it=!0;break}}}return it||!1}function zt(f,u,p,I){const L=new st(f,u,p,I);return function(G){return L.solve(G)}}const Rt=zt(.25,.1,.25,1);function Oe(f,u,p){return Math.min(p,Math.max(u,f))}function jt(f,u,p){const I=p-u,L=((f-u)%I+I)%I+u;return L===u?p:L}function at(f,...u){for(const p of u)for(const I in p)f[I]=p[I];return f}let _t=1;function mt(f,u,p){const I={};for(const L in f)I[L]=u.call(p||this,f[L],L,f);return I}function xt(f,u,p){const I={};for(const L in f)u.call(p||this,f[L],L,f)&&(I[L]=f[L]);return I}function bt(f){return Array.isArray(f)?f.map(bt):typeof f=="object"&&f?mt(f,bt):f}const lt={};function $e(f){lt[f]||(typeof console<"u"&&console.warn(f),lt[f]=!0)}function pt(f,u,p){return(p.y-f.y)*(u.x-f.x)>(u.y-f.y)*(p.x-f.x)}function ut(f){let u=0;for(let p,I,L=0,G=f.length,Q=G-1;L<G;Q=L++)p=f[L],I=f[Q],u+=(I.x-p.x)*(p.y+I.y);return u}function Nt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let Bt=null;function Ot(f){return typeof ImageBitmap<"u"&&f instanceof ImageBitmap}const gi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Ii(f,u,p,I,L){return U(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const G=new VideoFrame(f,{timestamp:0});try{const Q=G==null?void 0:G.format;if(!Q||!Q.startsWith("BGR")&&!Q.startsWith("RGB"))throw new Error(`Unrecognized format ${Q}`);const re=Q.startsWith("BGR"),Ae=new Uint8ClampedArray(I*L*4);if(yield G.copyTo(Ae,function(_e,Le,qe,tt,ft){const gt=4*Math.max(-Le,0),Mt=(Math.max(0,qe)-qe)*tt*4+gt,Pt=4*tt,Lt=Math.max(0,Le),ei=Math.max(0,qe);return{rect:{x:Lt,y:ei,width:Math.min(_e.width,Le+tt)-Lt,height:Math.min(_e.height,qe+ft)-ei},layout:[{offset:Mt,stride:Pt}]}}(f,u,p,I,L)),re)for(let _e=0;_e<Ae.length;_e+=4){const Le=Ae[_e];Ae[_e]=Ae[_e+2],Ae[_e+2]=Le}return Ae}finally{G.close()}})}let Ci,Ri,Ki,Hi;const Ni={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f){const u=requestAnimationFrame(f);return{cancel:()=>cancelAnimationFrame(u)}},getImageData(f,u=0){return this.getImageCanvasContext(f).getImageData(-u,-u,f.width+2*u,f.height+2*u)},getImageCanvasContext(f){const u=window.document.createElement("canvas"),p=u.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return u.width=f.width,u.height=f.height,p.drawImage(f,0,0,f.width,f.height),p},resolveURL:f=>(Ki||(Ki=document.createElement("a")),Ki.href=f,Ki.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Hi==null&&(Hi=matchMedia("(prefers-reduced-motion: reduce)")),Hi.matches)}},nn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class vn extends Error{constructor(u,p,I,L){super(`AJAXError: ${p} (${u}): ${I}`),this.status=u,this.statusText=p,this.url=I,this.body=L}}const Ei=Nt()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,mi=f=>nn.REGISTERED_PROTOCOLS[f.substring(0,f.indexOf("://"))];function zi(f,u){const p=new AbortController,I=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,cache:f.cache,referrer:Ei(),signal:p.signal});let L=!1,G=!1;return f.type==="json"&&I.headers.set("Accept","application/json"),G||fetch(I).then(Q=>Q.ok?(re=>{(f.type==="arrayBuffer"||f.type==="image"?re.arrayBuffer():f.type==="json"?re.json():re.text()).then(Ae=>{G||(L=!0,u(null,Ae,re.headers.get("Cache-Control"),re.headers.get("Expires")))}).catch(Ae=>{G||u(new Error(Ae.message))})})(Q):Q.blob().then(re=>u(new vn(Q.status,Q.statusText,f.url,re)))).catch(Q=>{Q.code!==20&&u(new Error(Q.message))}),{cancel:()=>{G=!0,L||p.abort()}}}const Oi=function(f,u){if(/:\/\//.test(f.url)&&!/^https?:|^file:/.test(f.url)){if(Nt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u);if(!Nt())return(mi(f.url)||zi)(f,u)}if(!(/^file:/.test(p=f.url)||/^file:/.test(Ei())&&!/^\w+:/.test(p))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return zi(f,u);if(Nt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u,void 0,!0)}var p;return function(I,L){const G=new XMLHttpRequest;G.open(I.method||"GET",I.url,!0),I.type!=="arrayBuffer"&&I.type!=="image"||(G.responseType="arraybuffer");for(const Q in I.headers)G.setRequestHeader(Q,I.headers[Q]);return I.type==="json"&&(G.responseType="text",G.setRequestHeader("Accept","application/json")),G.withCredentials=I.credentials==="include",G.onerror=()=>{L(new Error(G.statusText))},G.onload=()=>{if((G.status>=200&&G.status<300||G.status===0)&&G.response!==null){let Q=G.response;if(I.type==="json")try{Q=JSON.parse(G.response)}catch(re){return L(re)}L(null,Q,G.getResponseHeader("Cache-Control"),G.getResponseHeader("Expires"))}else{const Q=new Blob([G.response],{type:G.getResponseHeader("Content-Type")});L(new vn(G.status,G.statusText,I.url,Q))}},G.send(I.body),{cancel:()=>G.abort()}}(f,u)},xn=function(f,u){return Oi(at(f,{type:"arrayBuffer"}),u)};function bn(f){if(!f||f.indexOf("://")<=0||f.indexOf("data:image/")===0||f.indexOf("blob:")===0)return!0;const u=new URL(f),p=window.location;return u.protocol===p.protocol&&u.host===p.host}function Yt(f,u,p){p[f]&&p[f].indexOf(u)!==-1||(p[f]=p[f]||[],p[f].push(u))}function rn(f,u,p){if(p&&p[f]){const I=p[f].indexOf(u);I!==-1&&p[f].splice(I,1)}}class Xt{constructor(u,p={}){at(this,p),this.type=u}}class Ji extends Xt{constructor(u,p={}){super("error",at({error:u},p))}}class mr{on(u,p){return this._listeners=this._listeners||{},Yt(u,p,this._listeners),this}off(u,p){return rn(u,p,this._listeners),rn(u,p,this._oneTimeListeners),this}once(u,p){return p?(this._oneTimeListeners=this._oneTimeListeners||{},Yt(u,p,this._oneTimeListeners),this):new Promise(I=>this.once(u,I))}fire(u,p){typeof u=="string"&&(u=new Xt(u,p||{}));const I=u.type;if(this.listens(I)){u.target=this;const L=this._listeners&&this._listeners[I]?this._listeners[I].slice():[];for(const re of L)re.call(this,u);const G=this._oneTimeListeners&&this._oneTimeListeners[I]?this._oneTimeListeners[I].slice():[];for(const re of G)rn(I,re,this._oneTimeListeners),re.call(this,u);const Q=this._eventedParent;Q&&(at(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),Q.fire(u))}else u instanceof Ji&&console.error(u.error);return this}listens(u){return this._listeners&&this._listeners[u]&&this._listeners[u].length>0||this._oneTimeListeners&&this._oneTimeListeners[u]&&this._oneTimeListeners[u].length>0||this._eventedParent&&this._eventedParent.listens(u)}setEventedParent(u,p){return this._eventedParent=u,this._eventedParentData=p,this}}var ci={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const sn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function lr(f,u){const p={};for(const I in f)I!=="ref"&&(p[I]=f[I]);return sn.forEach(I=>{I in u&&(p[I]=u[I])}),p}function On(f,u){if(Array.isArray(f)){if(!Array.isArray(u)||f.length!==u.length)return!1;for(let p=0;p<f.length;p++)if(!On(f[p],u[p]))return!1;return!0}if(typeof f=="object"&&f!==null&&u!==null){if(typeof u!="object"||Object.keys(f).length!==Object.keys(u).length)return!1;for(const p in f)if(!On(f[p],u[p]))return!1;return!0}return f===u}const Gn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function pn(f,u,p){p.push({command:Gn.addSource,args:[f,u[f]]})}function v(f,u,p){u.push({command:Gn.removeSource,args:[f]}),p[f]=!0}function k(f,u,p,I){v(f,p,I),pn(f,u,p)}function V(f,u,p){let I;for(I in f[p])if(Object.prototype.hasOwnProperty.call(f[p],I)&&I!=="data"&&!On(f[p][I],u[p][I]))return!1;for(I in u[p])if(Object.prototype.hasOwnProperty.call(u[p],I)&&I!=="data"&&!On(f[p][I],u[p][I]))return!1;return!0}function Y(f,u,p,I,L,G){let Q;for(Q in u=u||{},f=f||{})Object.prototype.hasOwnProperty.call(f,Q)&&(On(f[Q],u[Q])||p.push({command:G,args:[I,Q,u[Q],L]}));for(Q in u)Object.prototype.hasOwnProperty.call(u,Q)&&!Object.prototype.hasOwnProperty.call(f,Q)&&(On(f[Q],u[Q])||p.push({command:G,args:[I,Q,u[Q],L]}))}function te(f){return f.id}function fe(f,u){return f[u.id]=u,f}class ve{constructor(u,p,I,L){this.message=(u?`${u}: `:"")+I,L&&(this.identifier=L),p!=null&&p.__line__&&(this.line=p.__line__)}}function Ie(f,...u){for(const p of u)for(const I in p)f[I]=p[I];return f}class Ee extends Error{constructor(u,p){super(p),this.message=p,this.key=u}}class ze{constructor(u,p=[]){this.parent=u,this.bindings={};for(const[I,L]of p)this.bindings[I]=L}concat(u){return new ze(this,u)}get(u){if(this.bindings[u])return this.bindings[u];if(this.parent)return this.parent.get(u);throw new Error(`${u} not found in scope.`)}has(u){return!!this.bindings[u]||!!this.parent&&this.parent.has(u)}}const Qe={kind:"null"},He={kind:"number"},Ze={kind:"string"},Ue={kind:"boolean"},dt={kind:"color"},rt={kind:"object"},Me={kind:"value"},se={kind:"collator"},ne={kind:"formatted"},$={kind:"padding"},ie={kind:"resolvedImage"},de={kind:"variableAnchorOffsetCollection"};function ye(f,u){return{kind:"array",itemType:f,N:u}}function ge(f){if(f.kind==="array"){const u=ge(f.itemType);return typeof f.N=="number"?`array<${u}, ${f.N}>`:f.itemType.kind==="value"?"array":`array<${u}>`}return f.kind}const Pe=[Qe,He,Ze,Ue,dt,ne,rt,ye(Me),$,ie,de];function Fe(f,u){if(u.kind==="error")return null;if(f.kind==="array"){if(u.kind==="array"&&(u.N===0&&u.itemType.kind==="value"||!Fe(f.itemType,u.itemType))&&(typeof f.N!="number"||f.N===u.N))return null}else{if(f.kind===u.kind)return null;if(f.kind==="value"){for(const p of Pe)if(!Fe(p,u))return null}}return`Expected ${ge(f)} but found ${ge(u)} instead.`}function Ve(f,u){return u.some(p=>p.kind===f.kind)}function Xe(f,u){return u.some(p=>p==="null"?f===null:p==="array"?Array.isArray(f):p==="object"?f&&!Array.isArray(f)&&typeof f=="object":p===typeof f)}function Ke(f,u){return f.kind==="array"&&u.kind==="array"?f.itemType.kind===u.itemType.kind&&typeof f.N=="number":f.kind===u.kind}const De=.96422,Ge=.82521,At=4/29,kt=6/29,o=3*kt*kt,ke=kt*kt*kt,oi=Math.PI/180,fi=180/Math.PI;function Ai(f){return(f%=360)<0&&(f+=360),f}function ti([f,u,p,I]){let L,G;const Q=Bi((.2225045*(f=li(f))+.7168786*(u=li(u))+.0606169*(p=li(p)))/1);f===u&&u===p?L=G=Q:(L=Bi((.4360747*f+.3850649*u+.1430804*p)/De),G=Bi((.0139322*f+.0971045*u+.7141733*p)/Ge));const re=116*Q-16;return[re<0?0:re,500*(L-Q),200*(Q-G),I]}function li(f){return f<=.04045?f/12.92:Math.pow((f+.055)/1.055,2.4)}function Bi(f){return f>ke?Math.pow(f,1/3):f/o+At}function vi([f,u,p,I]){let L=(f+16)/116,G=isNaN(u)?L:L+u/500,Q=isNaN(p)?L:L-p/200;return L=1*Jt(L),G=De*Jt(G),Q=Ge*Jt(Q),[bi(3.1338561*G-1.6168667*L-.4906146*Q),bi(-.9787684*G+1.9161415*L+.033454*Q),bi(.0719453*G-.2289914*L+1.4052427*Q),I]}function bi(f){return(f=f<=.00304?12.92*f:1.055*Math.pow(f,1/2.4)-.055)<0?0:f>1?1:f}function Jt(f){return f>kt?f*f*f:o*(f-At)}function wn(f){return parseInt(f.padEnd(2,f),16)/255}function ar(f,u){return mn(u?f/100:f,0,1)}function mn(f,u,p){return Math.min(Math.max(u,f),p)}function Hn(f){return!f.some(Number.isNaN)}const jr={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class ji{constructor(u,p,I,L=1,G=!0){this.r=u,this.g=p,this.b=I,this.a=L,G||(this.r*=L,this.g*=L,this.b*=L,L||this.overwriteGetter("rgb",[u,p,I,L]))}static parse(u){if(u instanceof ji)return u;if(typeof u!="string")return;const p=function(I){if((I=I.toLowerCase().trim())==="transparent")return[0,0,0,0];const L=jr[I];if(L){const[Q,re,Ae]=L;return[Q/255,re/255,Ae/255,1]}if(I.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(I)){const Q=I.length<6?1:2;let re=1;return[wn(I.slice(re,re+=Q)),wn(I.slice(re,re+=Q)),wn(I.slice(re,re+=Q)),wn(I.slice(re,re+Q)||"ff")]}if(I.startsWith("rgb")){const Q=I.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(Q){const[re,Ae,_e,Le,qe,tt,ft,gt,Mt,Pt,Lt,ei]=Q,Ht=[Le||" ",ft||" ",Pt].join("");if(Ht==="  "||Ht==="  /"||Ht===",,"||Ht===",,,"){const Qt=[_e,tt,Mt].join(""),hi=Qt==="%%%"?100:Qt===""?255:0;if(hi){const _i=[mn(+Ae/hi,0,1),mn(+qe/hi,0,1),mn(+gt/hi,0,1),Lt?ar(+Lt,ei):1];if(Hn(_i))return _i}}return}}const G=I.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(G){const[Q,re,Ae,_e,Le,qe,tt,ft,gt]=G,Mt=[Ae||" ",Le||" ",tt].join("");if(Mt==="  "||Mt==="  /"||Mt===",,"||Mt===",,,"){const Pt=[+re,mn(+_e,0,100),mn(+qe,0,100),ft?ar(+ft,gt):1];if(Hn(Pt))return function([Lt,ei,Ht,Qt]){function hi(_i){const Xi=(_i+Lt/30)%12,Sn=ei*Math.min(Ht,1-Ht);return Ht-Sn*Math.max(-1,Math.min(Xi-3,9-Xi,1))}return Lt=Ai(Lt),ei/=100,Ht/=100,[hi(0),hi(8),hi(4),Qt]}(Pt)}}}(u);return p?new ji(...p,!1):void 0}get rgb(){const{r:u,g:p,b:I,a:L}=this,G=L||1/0;return this.overwriteGetter("rgb",[u/G,p/G,I/G,L])}get hcl(){return this.overwriteGetter("hcl",function(u){const[p,I,L,G]=ti(u),Q=Math.sqrt(I*I+L*L);return[Math.round(1e4*Q)?Ai(Math.atan2(L,I)*fi):NaN,Q,p,G]}(this.rgb))}get lab(){return this.overwriteGetter("lab",ti(this.rgb))}overwriteGetter(u,p){return Object.defineProperty(this,u,{value:p}),p}toString(){const[u,p,I,L]=this.rgb;return`rgba(${[u,p,I].map(G=>Math.round(255*G)).join(",")},${L})`}}ji.black=new ji(0,0,0,1),ji.white=new ji(1,1,1,1),ji.transparent=new ji(0,0,0,0),ji.red=new ji(1,0,0,1);class ur{constructor(u,p,I){this.sensitivity=u?p?"variant":"case":p?"accent":"base",this.locale=I,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(u,p){return this.collator.compare(u,p)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Vn{constructor(u,p,I,L,G){this.text=u,this.image=p,this.scale=I,this.fontStack=L,this.textColor=G}}class Wt{constructor(u){this.sections=u}static fromString(u){return new Wt([new Vn(u,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(u=>u.text.length!==0||u.image&&u.image.name.length!==0)}static factory(u){return u instanceof Wt?u:Wt.fromString(u)}toString(){return this.sections.length===0?"":this.sections.map(u=>u.text).join("")}}class Yi{constructor(u){this.values=u.slice()}static parse(u){if(u instanceof Yi)return u;if(typeof u=="number")return new Yi([u,u,u,u]);if(Array.isArray(u)&&!(u.length<1||u.length>4)){for(const p of u)if(typeof p!="number")return;switch(u.length){case 1:u=[u[0],u[0],u[0],u[0]];break;case 2:u=[u[0],u[1],u[0],u[1]];break;case 3:u=[u[0],u[1],u[2],u[1]]}return new Yi(u)}}toString(){return JSON.stringify(this.values)}}const Ut=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Tn{constructor(u){this.values=u.slice()}static parse(u){if(u instanceof Tn)return u;if(Array.isArray(u)&&!(u.length<1)&&u.length%2==0){for(let p=0;p<u.length;p+=2){const I=u[p],L=u[p+1];if(typeof I!="string"||!Ut.has(I)||!Array.isArray(L)||L.length!==2||typeof L[0]!="number"||typeof L[1]!="number")return}return new Tn(u)}}toString(){return JSON.stringify(this.values)}}class cr{constructor(u){this.name=u.name,this.available=u.available}toString(){return this.name}static fromString(u){return u?new cr({name:u,available:!1}):null}}function Vs(f,u,p,I){return typeof f=="number"&&f>=0&&f<=255&&typeof u=="number"&&u>=0&&u<=255&&typeof p=="number"&&p>=0&&p<=255?I===void 0||typeof I=="number"&&I>=0&&I<=1?null:`Invalid rgba value [${[f,u,p,I].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof I=="number"?[f,u,p,I]:[f,u,p]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ur(f){if(f===null||typeof f=="string"||typeof f=="boolean"||typeof f=="number"||f instanceof ji||f instanceof ur||f instanceof Wt||f instanceof Yi||f instanceof Tn||f instanceof cr)return!0;if(Array.isArray(f)){for(const u of f)if(!Ur(u))return!1;return!0}if(typeof f=="object"){for(const u in f)if(!Ur(f[u]))return!1;return!0}return!1}function Vt(f){if(f===null)return Qe;if(typeof f=="string")return Ze;if(typeof f=="boolean")return Ue;if(typeof f=="number")return He;if(f instanceof ji)return dt;if(f instanceof ur)return se;if(f instanceof Wt)return ne;if(f instanceof Yi)return $;if(f instanceof Tn)return de;if(f instanceof cr)return ie;if(Array.isArray(f)){const u=f.length;let p;for(const I of f){const L=Vt(I);if(p){if(p===L)continue;p=Me;break}p=L}return ye(p||Me,u)}return rt}function hr(f){const u=typeof f;return f===null?"":u==="string"||u==="number"||u==="boolean"?String(f):f instanceof ji||f instanceof Wt||f instanceof Yi||f instanceof Tn||f instanceof cr?f.toString():JSON.stringify(f)}class Dt{constructor(u,p){this.type=u,this.value=p}static parse(u,p){if(u.length!==2)return p.error(`'literal' expression requires exactly one argument, but found ${u.length-1} instead.`);if(!Ur(u[1]))return p.error("invalid value");const I=u[1];let L=Vt(I);const G=p.expectedType;return L.kind!=="array"||L.N!==0||!G||G.kind!=="array"||typeof G.N=="number"&&G.N!==0||(L=G),new Dt(L,I)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Fr{constructor(u){this.name="ExpressionEvaluationError",this.message=u}toJSON(){return this.message}}const Us={string:Ze,number:He,boolean:Ue,object:rt};class ca{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");let I,L=1;const G=u[0];if(G==="array"){let re,Ae;if(u.length>2){const _e=u[1];if(typeof _e!="string"||!(_e in Us)||_e==="object")return p.error('The item type argument of "array" must be one of string, number, boolean',1);re=Us[_e],L++}else re=Me;if(u.length>3){if(u[2]!==null&&(typeof u[2]!="number"||u[2]<0||u[2]!==Math.floor(u[2])))return p.error('The length argument to "array" must be a positive integer literal',2);Ae=u[2],L++}I=ye(re,Ae)}else{if(!Us[G])throw new Error(`Types doesn't contain name = ${G}`);I=Us[G]}const Q=[];for(;L<u.length;L++){const re=p.parse(u[L],L,Me);if(!re)return null;Q.push(re)}return new ca(I,Q)}evaluate(u){for(let p=0;p<this.args.length;p++){const I=this.args[p].evaluate(u);if(!Fe(this.type,Vt(I)))return I;if(p===this.args.length-1)throw new Fr(`Expected value to be of type ${ge(this.type)}, but found ${ge(Vt(I))} instead.`)}throw new Error}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const Dr={"to-boolean":Ue,"to-color":dt,"to-number":He,"to-string":Ze};class Ua{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");const I=u[0];if(!Dr[I])throw new Error(`Can't parse ${I} as it is not part of the known types`);if((I==="to-boolean"||I==="to-string")&&u.length!==2)return p.error("Expected one argument.");const L=Dr[I],G=[];for(let Q=1;Q<u.length;Q++){const re=p.parse(u[Q],Q,Me);if(!re)return null;G.push(re)}return new Ua(L,G)}evaluate(u){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(u);case"color":{let p,I;for(const L of this.args){if(p=L.evaluate(u),I=null,p instanceof ji)return p;if(typeof p=="string"){const G=u.parseColor(p);if(G)return G}else if(Array.isArray(p)&&(I=p.length<3||p.length>4?`Invalid rbga value ${JSON.stringify(p)}: expected an array containing either three or four numeric values.`:Vs(p[0],p[1],p[2],p[3]),!I))return new ji(p[0]/255,p[1]/255,p[2]/255,p[3])}throw new Fr(I||`Could not parse color from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"padding":{let p;for(const I of this.args){p=I.evaluate(u);const L=Yi.parse(p);if(L)return L}throw new Fr(`Could not parse padding from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"variableAnchorOffsetCollection":{let p;for(const I of this.args){p=I.evaluate(u);const L=Tn.parse(p);if(L)return L}throw new Fr(`Could not parse variableAnchorOffsetCollection from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"number":{let p=null;for(const I of this.args){if(p=I.evaluate(u),p===null)return 0;const L=Number(p);if(!isNaN(L))return L}throw new Fr(`Could not convert ${JSON.stringify(p)} to number.`)}case"formatted":return Wt.fromString(hr(this.args[0].evaluate(u)));case"resolvedImage":return cr.fromString(hr(this.args[0].evaluate(u)));default:return hr(this.args[0].evaluate(u))}}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const Fo=["Unknown","Point","LineString","Polygon"];class Ga{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Fo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(u){let p=this._parseColorCache[u];return p||(p=this._parseColorCache[u]=ji.parse(u)),p}}class Xs{constructor(u,p,I=[],L,G=new ze,Q=[]){this.registry=u,this.path=I,this.key=I.map(re=>`[${re}]`).join(""),this.scope=G,this.errors=Q,this.expectedType=L,this._isConstant=p}parse(u,p,I,L,G={}){return p?this.concat(p,I,L)._parse(u,G):this._parse(u,G)}_parse(u,p){function I(L,G,Q){return Q==="assert"?new ca(G,[L]):Q==="coerce"?new Ua(G,[L]):L}if(u!==null&&typeof u!="string"&&typeof u!="boolean"&&typeof u!="number"||(u=["literal",u]),Array.isArray(u)){if(u.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const L=u[0];if(typeof L!="string")return this.error(`Expression name must be a string, but found ${typeof L} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const G=this.registry[L];if(G){let Q=G.parse(u,this);if(!Q)return null;if(this.expectedType){const re=this.expectedType,Ae=Q.type;if(re.kind!=="string"&&re.kind!=="number"&&re.kind!=="boolean"&&re.kind!=="object"&&re.kind!=="array"||Ae.kind!=="value")if(re.kind!=="color"&&re.kind!=="formatted"&&re.kind!=="resolvedImage"||Ae.kind!=="value"&&Ae.kind!=="string")if(re.kind!=="padding"||Ae.kind!=="value"&&Ae.kind!=="number"&&Ae.kind!=="array")if(re.kind!=="variableAnchorOffsetCollection"||Ae.kind!=="value"&&Ae.kind!=="array"){if(this.checkSubtype(re,Ae))return null}else Q=I(Q,re,p.typeAnnotation||"coerce");else Q=I(Q,re,p.typeAnnotation||"coerce");else Q=I(Q,re,p.typeAnnotation||"coerce");else Q=I(Q,re,p.typeAnnotation||"assert")}if(!(Q instanceof Dt)&&Q.type.kind!=="resolvedImage"&&this._isConstant(Q)){const re=new Ga;try{Q=new Dt(Q.type,Q.evaluate(re))}catch(Ae){return this.error(Ae.message),null}}return Q}return this.error(`Unknown expression "${L}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(u===void 0?"'undefined' value invalid. Use null instead.":typeof u=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof u} instead.`)}concat(u,p,I){const L=typeof u=="number"?this.path.concat(u):this.path,G=I?this.scope.concat(I):this.scope;return new Xs(this.registry,this._isConstant,L,p||null,G,this.errors)}error(u,...p){const I=`${this.key}${p.map(L=>`[${L}]`).join("")}`;this.errors.push(new Ee(I,u))}checkSubtype(u,p){const I=Fe(u,p);return I&&this.error(I),I}}class Qn{constructor(u,p,I){this.type=se,this.locale=I,this.caseSensitive=u,this.diacriticSensitive=p}static parse(u,p){if(u.length!==2)return p.error("Expected one argument.");const I=u[1];if(typeof I!="object"||Array.isArray(I))return p.error("Collator options argument must be an object.");const L=p.parse(I["case-sensitive"]!==void 0&&I["case-sensitive"],1,Ue);if(!L)return null;const G=p.parse(I["diacritic-sensitive"]!==void 0&&I["diacritic-sensitive"],1,Ue);if(!G)return null;let Q=null;return I.locale&&(Q=p.parse(I.locale,1,Ze),!Q)?null:new Qn(L,G,Q)}evaluate(u){return new ur(this.caseSensitive.evaluate(u),this.diacriticSensitive.evaluate(u),this.locale?this.locale.evaluate(u):null)}eachChild(u){u(this.caseSensitive),u(this.diacriticSensitive),this.locale&&u(this.locale)}outputDefined(){return!1}}const aa=8192;function hs(f,u){f[0]=Math.min(f[0],u[0]),f[1]=Math.min(f[1],u[1]),f[2]=Math.max(f[2],u[0]),f[3]=Math.max(f[3],u[1])}function qa(f,u){return!(f[0]<=u[0]||f[2]>=u[2]||f[1]<=u[1]||f[3]>=u[3])}function al(f,u){const p=(180+f[0])/360,I=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f[1]*Math.PI/360)))/360,L=Math.pow(2,u.z);return[Math.round(p*L*aa),Math.round(I*L*aa)]}function ol(f,u,p){const I=f[0]-u[0],L=f[1]-u[1],G=f[0]-p[0],Q=f[1]-p[1];return I*Q-G*L==0&&I*G<=0&&L*Q<=0}function no(f,u){let p=!1;for(let Q=0,re=u.length;Q<re;Q++){const Ae=u[Q];for(let _e=0,Le=Ae.length;_e<Le-1;_e++){if(ol(f,Ae[_e],Ae[_e+1]))return!1;(L=Ae[_e])[1]>(I=f)[1]!=(G=Ae[_e+1])[1]>I[1]&&I[0]<(G[0]-L[0])*(I[1]-L[1])/(G[1]-L[1])+L[0]&&(p=!p)}}var I,L,G;return p}function Ha(f,u){for(let p=0;p<u.length;p++)if(no(f,u[p]))return!0;return!1}function N(f,u,p,I){const L=I[0]-p[0],G=I[1]-p[1],Q=(f[0]-p[0])*G-L*(f[1]-p[1]),re=(u[0]-p[0])*G-L*(u[1]-p[1]);return Q>0&&re<0||Q<0&&re>0}function xe(f,u,p){for(const _e of p)for(let Le=0;Le<_e.length-1;++Le)if((re=[(Q=_e[Le+1])[0]-(G=_e[Le])[0],Q[1]-G[1]])[0]*(Ae=[(L=u)[0]-(I=f)[0],L[1]-I[1]])[1]-re[1]*Ae[0]!=0&&N(I,L,G,Q)&&N(G,Q,I,L))return!0;var I,L,G,Q,re,Ae;return!1}function nt(f,u){for(let p=0;p<f.length;++p)if(!no(f[p],u))return!1;for(let p=0;p<f.length-1;++p)if(xe(f[p],f[p+1],u))return!1;return!0}function It(f,u){for(let p=0;p<u.length;p++)if(nt(f,u[p]))return!0;return!1}function $t(f,u,p){const I=[];for(let L=0;L<f.length;L++){const G=[];for(let Q=0;Q<f[L].length;Q++){const re=al(f[L][Q],p);hs(u,re),G.push(re)}I.push(G)}return I}function wi(f,u,p){const I=[];for(let L=0;L<f.length;L++){const G=$t(f[L],u,p);I.push(G)}return I}function Di(f,u,p,I){if(f[0]<p[0]||f[0]>p[2]){const L=.5*I;let G=f[0]-p[0]>L?-I:p[0]-f[0]>L?I:0;G===0&&(G=f[0]-p[2]>L?-I:p[2]-f[0]>L?I:0),f[0]+=G}hs(u,f)}function hn(f,u,p,I){const L=Math.pow(2,I.z)*aa,G=[I.x*aa,I.y*aa],Q=[];for(const re of f)for(const Ae of re){const _e=[Ae.x+G[0],Ae.y+G[1]];Di(_e,u,p,L),Q.push(_e)}return Q}function dn(f,u,p,I){const L=Math.pow(2,I.z)*aa,G=[I.x*aa,I.y*aa],Q=[];for(const Ae of f){const _e=[];for(const Le of Ae){const qe=[Le.x+G[0],Le.y+G[1]];hs(u,qe),_e.push(qe)}Q.push(_e)}if(u[2]-u[0]<=L/2){(re=u)[0]=re[1]=1/0,re[2]=re[3]=-1/0;for(const Ae of Q)for(const _e of Ae)Di(_e,u,p,L)}var re;return Q}class rr{constructor(u,p){this.type=Ue,this.geojson=u,this.geometries=p}static parse(u,p){if(u.length!==2)return p.error(`'within' expression requires exactly one argument, but found ${u.length-1} instead.`);if(Ur(u[1])){const I=u[1];if(I.type==="FeatureCollection")for(let L=0;L<I.features.length;++L){const G=I.features[L].geometry.type;if(G==="Polygon"||G==="MultiPolygon")return new rr(I,I.features[L].geometry)}else if(I.type==="Feature"){const L=I.geometry.type;if(L==="Polygon"||L==="MultiPolygon")return new rr(I,I.geometry)}else if(I.type==="Polygon"||I.type==="MultiPolygon")return new rr(I,I)}return p.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(u){if(u.geometry()!=null&&u.canonicalID()!=null){if(u.geometryType()==="Point")return function(p,I){const L=[1/0,1/0,-1/0,-1/0],G=[1/0,1/0,-1/0,-1/0],Q=p.canonicalID();if(I.type==="Polygon"){const re=$t(I.coordinates,G,Q),Ae=hn(p.geometry(),L,G,Q);if(!qa(L,G))return!1;for(const _e of Ae)if(!no(_e,re))return!1}if(I.type==="MultiPolygon"){const re=wi(I.coordinates,G,Q),Ae=hn(p.geometry(),L,G,Q);if(!qa(L,G))return!1;for(const _e of Ae)if(!Ha(_e,re))return!1}return!0}(u,this.geometries);if(u.geometryType()==="LineString")return function(p,I){const L=[1/0,1/0,-1/0,-1/0],G=[1/0,1/0,-1/0,-1/0],Q=p.canonicalID();if(I.type==="Polygon"){const re=$t(I.coordinates,G,Q),Ae=dn(p.geometry(),L,G,Q);if(!qa(L,G))return!1;for(const _e of Ae)if(!nt(_e,re))return!1}if(I.type==="MultiPolygon"){const re=wi(I.coordinates,G,Q),Ae=dn(p.geometry(),L,G,Q);if(!qa(L,G))return!1;for(const _e of Ae)if(!It(_e,re))return!1}return!0}(u,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Ar{constructor(u,p){this.type=p.type,this.name=u,this.boundExpression=p}static parse(u,p){if(u.length!==2||typeof u[1]!="string")return p.error("'var' expression requires exactly one string literal argument.");const I=u[1];return p.scope.has(I)?new Ar(I,p.scope.get(I)):p.error(`Unknown variable "${I}". Make sure "${I}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(u){return this.boundExpression.evaluate(u)}eachChild(){}outputDefined(){return!1}}class Or{constructor(u,p,I,L){this.name=u,this.type=p,this._evaluate=I,this.args=L}evaluate(u){return this._evaluate(u,this.args)}eachChild(u){this.args.forEach(u)}outputDefined(){return!1}static parse(u,p){const I=u[0],L=Or.definitions[I];if(!L)return p.error(`Unknown expression "${I}". If you wanted a literal array, use ["literal", [...]].`,0);const G=Array.isArray(L)?L[0]:L.type,Q=Array.isArray(L)?[[L[1],L[2]]]:L.overloads,re=Q.filter(([_e])=>!Array.isArray(_e)||_e.length===u.length-1);let Ae=null;for(const[_e,Le]of re){Ae=new Xs(p.registry,ja,p.path,null,p.scope);const qe=[];let tt=!1;for(let ft=1;ft<u.length;ft++){const gt=u[ft],Mt=Array.isArray(_e)?_e[ft-1]:_e.type,Pt=Ae.parse(gt,1+qe.length,Mt);if(!Pt){tt=!0;break}qe.push(Pt)}if(!tt)if(Array.isArray(_e)&&_e.length!==qe.length)Ae.error(`Expected ${_e.length} arguments, but found ${qe.length} instead.`);else{for(let ft=0;ft<qe.length;ft++){const gt=Array.isArray(_e)?_e[ft]:_e.type,Mt=qe[ft];Ae.concat(ft+1).checkSubtype(gt,Mt.type)}if(Ae.errors.length===0)return new Or(I,G,Le,qe)}}if(re.length===1)p.errors.push(...Ae.errors);else{const _e=(re.length?re:Q).map(([qe])=>{return tt=qe,Array.isArray(tt)?`(${tt.map(ge).join(", ")})`:`(${ge(tt.type)}...)`;var tt}).join(" | "),Le=[];for(let qe=1;qe<u.length;qe++){const tt=p.parse(u[qe],1+Le.length);if(!tt)return null;Le.push(ge(tt.type))}p.error(`Expected arguments of type ${_e}, but found (${Le.join(", ")}) instead.`)}return null}static register(u,p){Or.definitions=p;for(const I in p)u[I]=Or}}function ja(f){if(f instanceof Ar)return ja(f.boundExpression);if(f instanceof Or&&f.name==="error"||f instanceof Qn||f instanceof rr)return!1;const u=f instanceof Ua||f instanceof ca;let p=!0;return f.eachChild(I=>{p=u?p&&ja(I):p&&I instanceof Dt}),!!p&&Za(f)&&pl(f,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Za(f){if(f instanceof Or&&(f.name==="get"&&f.args.length===1||f.name==="feature-state"||f.name==="has"&&f.args.length===1||f.name==="properties"||f.name==="geometry-type"||f.name==="id"||/^filter-/.test(f.name))||f instanceof rr)return!1;let u=!0;return f.eachChild(p=>{u&&!Za(p)&&(u=!1)}),u}function Qa(f){if(f instanceof Or&&f.name==="feature-state")return!1;let u=!0;return f.eachChild(p=>{u&&!Qa(p)&&(u=!1)}),u}function pl(f,u){if(f instanceof Or&&u.indexOf(f.name)>=0)return!1;let p=!0;return f.eachChild(I=>{p&&!pl(I,u)&&(p=!1)}),p}function Gr(f,u){const p=f.length-1;let I,L,G=0,Q=p,re=0;for(;G<=Q;)if(re=Math.floor((G+Q)/2),I=f[re],L=f[re+1],I<=u){if(re===p||u<L)return re;G=re+1}else{if(!(I>u))throw new Fr("Input is not a number.");Q=re-1}return 0}class ir{constructor(u,p,I){this.type=u,this.input=p,this.labels=[],this.outputs=[];for(const[L,G]of I)this.labels.push(L),this.outputs.push(G)}static parse(u,p){if(u.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return p.error("Expected an even number of arguments.");const I=p.parse(u[1],1,He);if(!I)return null;const L=[];let G=null;p.expectedType&&p.expectedType.kind!=="value"&&(G=p.expectedType);for(let Q=1;Q<u.length;Q+=2){const re=Q===1?-1/0:u[Q],Ae=u[Q+1],_e=Q,Le=Q+1;if(typeof re!="number")return p.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',_e);if(L.length&&L[L.length-1][0]>=re)return p.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',_e);const qe=p.parse(Ae,Le,G);if(!qe)return null;G=G||qe.type,L.push([re,qe])}return new ir(G,I,L)}evaluate(u){const p=this.labels,I=this.outputs;if(p.length===1)return I[0].evaluate(u);const L=this.input.evaluate(u);if(L<=p[0])return I[0].evaluate(u);const G=p.length;return L>=p[G-1]?I[G-1].evaluate(u):I[Gr(p,L)].evaluate(u)}eachChild(u){u(this.input);for(const p of this.outputs)u(p)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function Er(f,u,p){return f+p*(u-f)}function Lr(f,u,p){return f.map((I,L)=>Er(I,u[L],p))}const Zs={number:Er,color:function(f,u,p,I="rgb"){switch(I){case"rgb":{const[L,G,Q,re]=Lr(f.rgb,u.rgb,p);return new ji(L,G,Q,re,!1)}case"hcl":{const[L,G,Q,re]=f.hcl,[Ae,_e,Le,qe]=u.hcl;let tt,ft;if(isNaN(L)||isNaN(Ae))isNaN(L)?isNaN(Ae)?tt=NaN:(tt=Ae,Q!==1&&Q!==0||(ft=_e)):(tt=L,Le!==1&&Le!==0||(ft=G));else{let ei=Ae-L;Ae>L&&ei>180?ei-=360:Ae<L&&L-Ae>180&&(ei+=360),tt=L+p*ei}const[gt,Mt,Pt,Lt]=function([ei,Ht,Qt,hi]){return ei=isNaN(ei)?0:ei*oi,vi([Qt,Math.cos(ei)*Ht,Math.sin(ei)*Ht,hi])}([tt,ft??Er(G,_e,p),Er(Q,Le,p),Er(re,qe,p)]);return new ji(gt,Mt,Pt,Lt,!1)}case"lab":{const[L,G,Q,re]=vi(Lr(f.lab,u.lab,p));return new ji(L,G,Q,re,!1)}}},array:Lr,padding:function(f,u,p){return new Yi(Lr(f.values,u.values,p))},variableAnchorOffsetCollection:function(f,u,p){const I=f.values,L=u.values;if(I.length!==L.length)throw new Fr(`Cannot interpolate values of different length. from: ${f.toString()}, to: ${u.toString()}`);const G=[];for(let Q=0;Q<I.length;Q+=2){if(I[Q]!==L[Q])throw new Fr(`Cannot interpolate values containing mismatched anchors. from[${Q}]: ${I[Q]}, to[${Q}]: ${L[Q]}`);G.push(I[Q]);const[re,Ae]=I[Q+1],[_e,Le]=L[Q+1];G.push([Er(re,_e,p),Er(Ae,Le,p)])}return new Tn(G)}};class xr{constructor(u,p,I,L,G){this.type=u,this.operator=p,this.interpolation=I,this.input=L,this.labels=[],this.outputs=[];for(const[Q,re]of G)this.labels.push(Q),this.outputs.push(re)}static interpolationFactor(u,p,I,L){let G=0;if(u.name==="exponential")G=Ks(p,u.base,I,L);else if(u.name==="linear")G=Ks(p,1,I,L);else if(u.name==="cubic-bezier"){const Q=u.controlPoints;G=new st(Q[0],Q[1],Q[2],Q[3]).solve(Ks(p,1,I,L))}return G}static parse(u,p){let[I,L,G,...Q]=u;if(!Array.isArray(L)||L.length===0)return p.error("Expected an interpolation type expression.",1);if(L[0]==="linear")L={name:"linear"};else if(L[0]==="exponential"){const _e=L[1];if(typeof _e!="number")return p.error("Exponential interpolation requires a numeric base.",1,1);L={name:"exponential",base:_e}}else{if(L[0]!=="cubic-bezier")return p.error(`Unknown interpolation type ${String(L[0])}`,1,0);{const _e=L.slice(1);if(_e.length!==4||_e.some(Le=>typeof Le!="number"||Le<0||Le>1))return p.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);L={name:"cubic-bezier",controlPoints:_e}}}if(u.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return p.error("Expected an even number of arguments.");if(G=p.parse(G,2,He),!G)return null;const re=[];let Ae=null;I==="interpolate-hcl"||I==="interpolate-lab"?Ae=dt:p.expectedType&&p.expectedType.kind!=="value"&&(Ae=p.expectedType);for(let _e=0;_e<Q.length;_e+=2){const Le=Q[_e],qe=Q[_e+1],tt=_e+3,ft=_e+4;if(typeof Le!="number")return p.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',tt);if(re.length&&re[re.length-1][0]>=Le)return p.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',tt);const gt=p.parse(qe,ft,Ae);if(!gt)return null;Ae=Ae||gt.type,re.push([Le,gt])}return Ke(Ae,He)||Ke(Ae,dt)||Ke(Ae,$)||Ke(Ae,de)||Ke(Ae,ye(He))?new xr(Ae,I,L,G,re):p.error(`Type ${ge(Ae)} is not interpolatable.`)}evaluate(u){const p=this.labels,I=this.outputs;if(p.length===1)return I[0].evaluate(u);const L=this.input.evaluate(u);if(L<=p[0])return I[0].evaluate(u);const G=p.length;if(L>=p[G-1])return I[G-1].evaluate(u);const Q=Gr(p,L),re=xr.interpolationFactor(this.interpolation,L,p[Q],p[Q+1]),Ae=I[Q].evaluate(u),_e=I[Q+1].evaluate(u);switch(this.operator){case"interpolate":return Zs[this.type.kind](Ae,_e,re);case"interpolate-hcl":return Zs.color(Ae,_e,re,"hcl");case"interpolate-lab":return Zs.color(Ae,_e,re,"lab")}}eachChild(u){u(this.input);for(const p of this.outputs)u(p)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function Ks(f,u,p,I){const L=I-p,G=f-p;return L===0?0:u===1?G/L:(Math.pow(u,G)-1)/(Math.pow(u,L)-1)}class Br{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expectected at least one argument.");let I=null;const L=p.expectedType;L&&L.kind!=="value"&&(I=L);const G=[];for(const re of u.slice(1)){const Ae=p.parse(re,1+G.length,I,void 0,{typeAnnotation:"omit"});if(!Ae)return null;I=I||Ae.type,G.push(Ae)}if(!I)throw new Error("No output type");const Q=L&&G.some(re=>Fe(L,re.type));return new Br(Q?Me:I,G)}evaluate(u){let p,I=null,L=0;for(const G of this.args)if(L++,I=G.evaluate(u),I&&I instanceof cr&&!I.available&&(p||(p=I.name),I=null,L===this.args.length&&(I=p)),I!==null)break;return I}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}class To{constructor(u,p){this.type=p.type,this.bindings=[].concat(u),this.result=p}evaluate(u){return this.result.evaluate(u)}eachChild(u){for(const p of this.bindings)u(p[1]);u(this.result)}static parse(u,p){if(u.length<4)return p.error(`Expected at least 3 arguments, but found ${u.length-1} instead.`);const I=[];for(let G=1;G<u.length-1;G+=2){const Q=u[G];if(typeof Q!="string")return p.error(`Expected string, but found ${typeof Q} instead.`,G);if(/[^a-zA-Z0-9_]/.test(Q))return p.error("Variable names must contain only alphanumeric characters or '_'.",G);const re=p.parse(u[G+1],G+1);if(!re)return null;I.push([Q,re])}const L=p.parse(u[u.length-1],u.length-1,p.expectedType,I);return L?new To(I,L):null}outputDefined(){return this.result.outputDefined()}}class Zo{constructor(u,p,I){this.type=u,this.index=p,this.input=I}static parse(u,p){if(u.length!==3)return p.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const I=p.parse(u[1],1,He),L=p.parse(u[2],2,ye(p.expectedType||Me));return I&&L?new Zo(L.type.itemType,I,L):null}evaluate(u){const p=this.index.evaluate(u),I=this.input.evaluate(u);if(p<0)throw new Fr(`Array index out of bounds: ${p} < 0.`);if(p>=I.length)throw new Fr(`Array index out of bounds: ${p} > ${I.length-1}.`);if(p!==Math.floor(p))throw new Fr(`Array index must be an integer, but found ${p} instead.`);return I[p]}eachChild(u){u(this.index),u(this.input)}outputDefined(){return!1}}class Bs{constructor(u,p){this.type=Ue,this.needle=u,this.haystack=p}static parse(u,p){if(u.length!==3)return p.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const I=p.parse(u[1],1,Me),L=p.parse(u[2],2,Me);return I&&L?Ve(I.type,[Ue,Ze,He,Qe,Me])?new Bs(I,L):p.error(`Expected first argument to be of type boolean, string, number or null, but found ${ge(I.type)} instead`):null}evaluate(u){const p=this.needle.evaluate(u),I=this.haystack.evaluate(u);if(!I)return!1;if(!Xe(p,["boolean","string","number","null"]))throw new Fr(`Expected first argument to be of type boolean, string, number or null, but found ${ge(Vt(p))} instead.`);if(!Xe(I,["string","array"]))throw new Fr(`Expected second argument to be of type array or string, but found ${ge(Vt(I))} instead.`);return I.indexOf(p)>=0}eachChild(u){u(this.needle),u(this.haystack)}outputDefined(){return!0}}class Il{constructor(u,p,I){this.type=He,this.needle=u,this.haystack=p,this.fromIndex=I}static parse(u,p){if(u.length<=2||u.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const I=p.parse(u[1],1,Me),L=p.parse(u[2],2,Me);if(!I||!L)return null;if(!Ve(I.type,[Ue,Ze,He,Qe,Me]))return p.error(`Expected first argument to be of type boolean, string, number or null, but found ${ge(I.type)} instead`);if(u.length===4){const G=p.parse(u[3],3,He);return G?new Il(I,L,G):null}return new Il(I,L)}evaluate(u){const p=this.needle.evaluate(u),I=this.haystack.evaluate(u);if(!Xe(p,["boolean","string","number","null"]))throw new Fr(`Expected first argument to be of type boolean, string, number or null, but found ${ge(Vt(p))} instead.`);if(!Xe(I,["string","array"]))throw new Fr(`Expected second argument to be of type array or string, but found ${ge(Vt(I))} instead.`);if(this.fromIndex){const L=this.fromIndex.evaluate(u);return I.indexOf(p,L)}return I.indexOf(p)}eachChild(u){u(this.needle),u(this.haystack),this.fromIndex&&u(this.fromIndex)}outputDefined(){return!1}}class mo{constructor(u,p,I,L,G,Q){this.inputType=u,this.type=p,this.input=I,this.cases=L,this.outputs=G,this.otherwise=Q}static parse(u,p){if(u.length<5)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if(u.length%2!=1)return p.error("Expected an even number of arguments.");let I,L;p.expectedType&&p.expectedType.kind!=="value"&&(L=p.expectedType);const G={},Q=[];for(let _e=2;_e<u.length-1;_e+=2){let Le=u[_e];const qe=u[_e+1];Array.isArray(Le)||(Le=[Le]);const tt=p.concat(_e);if(Le.length===0)return tt.error("Expected at least one branch label.");for(const gt of Le){if(typeof gt!="number"&&typeof gt!="string")return tt.error("Branch labels must be numbers or strings.");if(typeof gt=="number"&&Math.abs(gt)>Number.MAX_SAFE_INTEGER)return tt.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof gt=="number"&&Math.floor(gt)!==gt)return tt.error("Numeric branch labels must be integer values.");if(I){if(tt.checkSubtype(I,Vt(gt)))return null}else I=Vt(gt);if(G[String(gt)]!==void 0)return tt.error("Branch labels must be unique.");G[String(gt)]=Q.length}const ft=p.parse(qe,_e,L);if(!ft)return null;L=L||ft.type,Q.push(ft)}const re=p.parse(u[1],1,Me);if(!re)return null;const Ae=p.parse(u[u.length-1],u.length-1,L);return Ae?re.type.kind!=="value"&&p.concat(1).checkSubtype(I,re.type)?null:new mo(I,L,re,G,Q,Ae):null}evaluate(u){const p=this.input.evaluate(u);return(Vt(p)===this.inputType&&this.outputs[this.cases[p]]||this.otherwise).evaluate(u)}eachChild(u){u(this.input),this.outputs.forEach(u),u(this.otherwise)}outputDefined(){return this.outputs.every(u=>u.outputDefined())&&this.otherwise.outputDefined()}}class Qo{constructor(u,p,I){this.type=u,this.branches=p,this.otherwise=I}static parse(u,p){if(u.length<4)return p.error(`Expected at least 3 arguments, but found only ${u.length-1}.`);if(u.length%2!=0)return p.error("Expected an odd number of arguments.");let I;p.expectedType&&p.expectedType.kind!=="value"&&(I=p.expectedType);const L=[];for(let Q=1;Q<u.length-1;Q+=2){const re=p.parse(u[Q],Q,Ue);if(!re)return null;const Ae=p.parse(u[Q+1],Q+1,I);if(!Ae)return null;L.push([re,Ae]),I=I||Ae.type}const G=p.parse(u[u.length-1],u.length-1,I);if(!G)return null;if(!I)throw new Error("Can't infer output type");return new Qo(I,L,G)}evaluate(u){for(const[p,I]of this.branches)if(p.evaluate(u))return I.evaluate(u);return this.otherwise.evaluate(u)}eachChild(u){for(const[p,I]of this.branches)u(p),u(I);u(this.otherwise)}outputDefined(){return this.branches.every(([u,p])=>p.outputDefined())&&this.otherwise.outputDefined()}}class ha{constructor(u,p,I,L){this.type=u,this.input=p,this.beginIndex=I,this.endIndex=L}static parse(u,p){if(u.length<=2||u.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const I=p.parse(u[1],1,Me),L=p.parse(u[2],2,He);if(!I||!L)return null;if(!Ve(I.type,[ye(Me),Ze,Me]))return p.error(`Expected first argument to be of type array or string, but found ${ge(I.type)} instead`);if(u.length===4){const G=p.parse(u[3],3,He);return G?new ha(I.type,I,L,G):null}return new ha(I.type,I,L)}evaluate(u){const p=this.input.evaluate(u),I=this.beginIndex.evaluate(u);if(!Xe(p,["string","array"]))throw new Fr(`Expected first argument to be of type array or string, but found ${ge(Vt(p))} instead.`);if(this.endIndex){const L=this.endIndex.evaluate(u);return p.slice(I,L)}return p.slice(I)}eachChild(u){u(this.input),u(this.beginIndex),this.endIndex&&u(this.endIndex)}outputDefined(){return!1}}function Ys(f,u){return f==="=="||f==="!="?u.kind==="boolean"||u.kind==="string"||u.kind==="number"||u.kind==="null"||u.kind==="value":u.kind==="string"||u.kind==="number"||u.kind==="value"}function El(f,u,p,I){return I.compare(u,p)===0}function Wa(f,u,p){const I=f!=="=="&&f!=="!=";return class u5{constructor(G,Q,re){this.type=Ue,this.lhs=G,this.rhs=Q,this.collator=re,this.hasUntypedArgument=G.type.kind==="value"||Q.type.kind==="value"}static parse(G,Q){if(G.length!==3&&G.length!==4)return Q.error("Expected two or three arguments.");const re=G[0];let Ae=Q.parse(G[1],1,Me);if(!Ae)return null;if(!Ys(re,Ae.type))return Q.concat(1).error(`"${re}" comparisons are not supported for type '${ge(Ae.type)}'.`);let _e=Q.parse(G[2],2,Me);if(!_e)return null;if(!Ys(re,_e.type))return Q.concat(2).error(`"${re}" comparisons are not supported for type '${ge(_e.type)}'.`);if(Ae.type.kind!==_e.type.kind&&Ae.type.kind!=="value"&&_e.type.kind!=="value")return Q.error(`Cannot compare types '${ge(Ae.type)}' and '${ge(_e.type)}'.`);I&&(Ae.type.kind==="value"&&_e.type.kind!=="value"?Ae=new ca(_e.type,[Ae]):Ae.type.kind!=="value"&&_e.type.kind==="value"&&(_e=new ca(Ae.type,[_e])));let Le=null;if(G.length===4){if(Ae.type.kind!=="string"&&_e.type.kind!=="string"&&Ae.type.kind!=="value"&&_e.type.kind!=="value")return Q.error("Cannot use collator to compare non-string types.");if(Le=Q.parse(G[3],3,se),!Le)return null}return new u5(Ae,_e,Le)}evaluate(G){const Q=this.lhs.evaluate(G),re=this.rhs.evaluate(G);if(I&&this.hasUntypedArgument){const Ae=Vt(Q),_e=Vt(re);if(Ae.kind!==_e.kind||Ae.kind!=="string"&&Ae.kind!=="number")throw new Fr(`Expected arguments for "${f}" to be (string, string) or (number, number), but found (${Ae.kind}, ${_e.kind}) instead.`)}if(this.collator&&!I&&this.hasUntypedArgument){const Ae=Vt(Q),_e=Vt(re);if(Ae.kind!=="string"||_e.kind!=="string")return u(G,Q,re)}return this.collator?p(G,Q,re,this.collator.evaluate(G)):u(G,Q,re)}eachChild(G){G(this.lhs),G(this.rhs),this.collator&&G(this.collator)}outputDefined(){return!0}}}const Ma=Wa("==",function(f,u,p){return u===p},El),ml=Wa("!=",function(f,u,p){return u!==p},function(f,u,p,I){return!El(0,u,p,I)}),Cl=Wa("<",function(f,u,p){return u<p},function(f,u,p,I){return I.compare(u,p)<0}),mu=Wa(">",function(f,u,p){return u>p},function(f,u,p,I){return I.compare(u,p)>0}),As=Wa("<=",function(f,u,p){return u<=p},function(f,u,p,I){return I.compare(u,p)<=0}),ac=Wa(">=",function(f,u,p){return u>=p},function(f,u,p,I){return I.compare(u,p)>=0});class ro{constructor(u,p,I,L,G){this.type=Ze,this.number=u,this.locale=p,this.currency=I,this.minFractionDigits=L,this.maxFractionDigits=G}static parse(u,p){if(u.length!==3)return p.error("Expected two arguments.");const I=p.parse(u[1],1,He);if(!I)return null;const L=u[2];if(typeof L!="object"||Array.isArray(L))return p.error("NumberFormat options argument must be an object.");let G=null;if(L.locale&&(G=p.parse(L.locale,1,Ze),!G))return null;let Q=null;if(L.currency&&(Q=p.parse(L.currency,1,Ze),!Q))return null;let re=null;if(L["min-fraction-digits"]&&(re=p.parse(L["min-fraction-digits"],1,He),!re))return null;let Ae=null;return L["max-fraction-digits"]&&(Ae=p.parse(L["max-fraction-digits"],1,He),!Ae)?null:new ro(I,G,Q,re,Ae)}evaluate(u){return new Intl.NumberFormat(this.locale?this.locale.evaluate(u):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(u):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(u):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(u):void 0}).format(this.number.evaluate(u))}eachChild(u){u(this.number),this.locale&&u(this.locale),this.currency&&u(this.currency),this.minFractionDigits&&u(this.minFractionDigits),this.maxFractionDigits&&u(this.maxFractionDigits)}outputDefined(){return!1}}class so{constructor(u){this.type=ne,this.sections=u}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");const I=u[1];if(!Array.isArray(I)&&typeof I=="object")return p.error("First argument must be an image or text section.");const L=[];let G=!1;for(let Q=1;Q<=u.length-1;++Q){const re=u[Q];if(G&&typeof re=="object"&&!Array.isArray(re)){G=!1;let Ae=null;if(re["font-scale"]&&(Ae=p.parse(re["font-scale"],1,He),!Ae))return null;let _e=null;if(re["text-font"]&&(_e=p.parse(re["text-font"],1,ye(Ze)),!_e))return null;let Le=null;if(re["text-color"]&&(Le=p.parse(re["text-color"],1,dt),!Le))return null;const qe=L[L.length-1];qe.scale=Ae,qe.font=_e,qe.textColor=Le}else{const Ae=p.parse(u[Q],1,Me);if(!Ae)return null;const _e=Ae.type.kind;if(_e!=="string"&&_e!=="value"&&_e!=="null"&&_e!=="resolvedImage")return p.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");G=!0,L.push({content:Ae,scale:null,font:null,textColor:null})}}return new so(L)}evaluate(u){return new Wt(this.sections.map(p=>{const I=p.content.evaluate(u);return Vt(I)===ie?new Vn("",I,null,null,null):new Vn(hr(I),null,p.scale?p.scale.evaluate(u):null,p.font?p.font.evaluate(u).join(","):null,p.textColor?p.textColor.evaluate(u):null)}))}eachChild(u){for(const p of this.sections)u(p.content),p.scale&&u(p.scale),p.font&&u(p.font),p.textColor&&u(p.textColor)}outputDefined(){return!1}}class Wl{constructor(u){this.type=ie,this.input=u}static parse(u,p){if(u.length!==2)return p.error("Expected two arguments.");const I=p.parse(u[1],1,Ze);return I?new Wl(I):p.error("No image name provided.")}evaluate(u){const p=this.input.evaluate(u),I=cr.fromString(p);return I&&u.availableImages&&(I.available=u.availableImages.indexOf(p)>-1),I}eachChild(u){u(this.input)}outputDefined(){return!1}}class Oo{constructor(u){this.type=He,this.input=u}static parse(u,p){if(u.length!==2)return p.error(`Expected 1 argument, but found ${u.length-1} instead.`);const I=p.parse(u[1],1);return I?I.type.kind!=="array"&&I.type.kind!=="string"&&I.type.kind!=="value"?p.error(`Expected argument of type string or array, but found ${ge(I.type)} instead.`):new Oo(I):null}evaluate(u){const p=this.input.evaluate(u);if(typeof p=="string"||Array.isArray(p))return p.length;throw new Fr(`Expected value to be of type string or array, but found ${ge(Vt(p))} instead.`)}eachChild(u){u(this.input)}outputDefined(){return!1}}const Wo={"==":Ma,"!=":ml,">":mu,"<":Cl,">=":ac,"<=":As,array:ca,at:Zo,boolean:ca,case:Qo,coalesce:Br,collator:Qn,format:so,image:Wl,in:Bs,"index-of":Il,interpolate:xr,"interpolate-hcl":xr,"interpolate-lab":xr,length:Oo,let:To,literal:Dt,match:mo,number:ca,"number-format":ro,object:ca,slice:ha,step:ir,string:ca,"to-boolean":Ua,"to-color":Ua,"to-number":Ua,"to-string":Ua,var:Ar,within:rr};function ko(f,[u,p,I,L]){u=u.evaluate(f),p=p.evaluate(f),I=I.evaluate(f);const G=L?L.evaluate(f):1,Q=Vs(u,p,I,G);if(Q)throw new Fr(Q);return new ji(u/255,p/255,I/255,G,!1)}function Gs(f,u){return f in u}function $o(f,u){const p=u[f];return p===void 0?null:p}function Xo(f){return{type:f}}function Yo(f){return{result:"success",value:f}}function Sa(f){return{result:"error",value:f}}function $a(f){return f["property-type"]==="data-driven"||f["property-type"]==="cross-faded-data-driven"}function ks(f){return!!f.expression&&f.expression.parameters.indexOf("zoom")>-1}function gu(f){return!!f.expression&&f.expression.interpolated}function Cr(f){return f instanceof Number?"number":f instanceof String?"string":f instanceof Boolean?"boolean":Array.isArray(f)?"array":f===null?"null":typeof f}function $n(f){return typeof f=="object"&&f!==null&&!Array.isArray(f)}function Ko(f){return f}function zr(f,u){const p=u.type==="color",I=f.stops&&typeof f.stops[0][0]=="object",L=I||!(I||f.property!==void 0),G=f.type||(gu(u)?"exponential":"interval");if(p||u.type==="padding"){const Le=p?ji.parse:Yi.parse;(f=Ie({},f)).stops&&(f.stops=f.stops.map(qe=>[qe[0],Le(qe[1])])),f.default=Le(f.default?f.default:u.default)}if(f.colorSpace&&(Q=f.colorSpace)!=="rgb"&&Q!=="hcl"&&Q!=="lab")throw new Error(`Unknown color space: "${f.colorSpace}"`);var Q;let re,Ae,_e;if(G==="exponential")re=Mo;else if(G==="interval")re=fr;else if(G==="categorical"){re=is,Ae=Object.create(null);for(const Le of f.stops)Ae[Le[0]]=Le[1];_e=typeof f.stops[0][0]}else{if(G!=="identity")throw new Error(`Unknown function type "${G}"`);re=qn}if(I){const Le={},qe=[];for(let gt=0;gt<f.stops.length;gt++){const Mt=f.stops[gt],Pt=Mt[0].zoom;Le[Pt]===void 0&&(Le[Pt]={zoom:Pt,type:f.type,property:f.property,default:f.default,stops:[]},qe.push(Pt)),Le[Pt].stops.push([Mt[0].value,Mt[1]])}const tt=[];for(const gt of qe)tt.push([Le[gt].zoom,zr(Le[gt],u)]);const ft={name:"linear"};return{kind:"composite",interpolationType:ft,interpolationFactor:xr.interpolationFactor.bind(void 0,ft),zoomStops:tt.map(gt=>gt[0]),evaluate:({zoom:gt},Mt)=>Mo({stops:tt,base:f.base},u,gt).evaluate(gt,Mt)}}if(L){const Le=G==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:Le,interpolationFactor:xr.interpolationFactor.bind(void 0,Le),zoomStops:f.stops.map(qe=>qe[0]),evaluate:({zoom:qe})=>re(f,u,qe,Ae,_e)}}return{kind:"source",evaluate(Le,qe){const tt=qe&&qe.properties?qe.properties[f.property]:void 0;return tt===void 0?Xa(f.default,u.default):re(f,u,tt,Ae,_e)}}}function Xa(f,u,p){return f!==void 0?f:u!==void 0?u:p!==void 0?p:void 0}function is(f,u,p,I,L){return Xa(typeof p===L?I[p]:void 0,f.default,u.default)}function fr(f,u,p){if(Cr(p)!=="number")return Xa(f.default,u.default);const I=f.stops.length;if(I===1||p<=f.stops[0][0])return f.stops[0][1];if(p>=f.stops[I-1][0])return f.stops[I-1][1];const L=Gr(f.stops.map(G=>G[0]),p);return f.stops[L][1]}function Mo(f,u,p){const I=f.base!==void 0?f.base:1;if(Cr(p)!=="number")return Xa(f.default,u.default);const L=f.stops.length;if(L===1||p<=f.stops[0][0])return f.stops[0][1];if(p>=f.stops[L-1][0])return f.stops[L-1][1];const G=Gr(f.stops.map(Le=>Le[0]),p),Q=function(Le,qe,tt,ft){const gt=ft-tt,Mt=Le-tt;return gt===0?0:qe===1?Mt/gt:(Math.pow(qe,Mt)-1)/(Math.pow(qe,gt)-1)}(p,I,f.stops[G][0],f.stops[G+1][0]),re=f.stops[G][1],Ae=f.stops[G+1][1],_e=Zs[u.type]||Ko;return typeof re.evaluate=="function"?{evaluate(...Le){const qe=re.evaluate.apply(void 0,Le),tt=Ae.evaluate.apply(void 0,Le);if(qe!==void 0&&tt!==void 0)return _e(qe,tt,Q,f.colorSpace)}}:_e(re,Ae,Q,f.colorSpace)}function qn(f,u,p){switch(u.type){case"color":p=ji.parse(p);break;case"formatted":p=Wt.fromString(p.toString());break;case"resolvedImage":p=cr.fromString(p.toString());break;case"padding":p=Yi.parse(p);break;default:Cr(p)===u.type||u.type==="enum"&&u.values[p]||(p=void 0)}return Xa(p,f.default,u.default)}Or.register(Wo,{error:[{kind:"error"},[Ze],(f,[u])=>{throw new Fr(u.evaluate(f))}],typeof:[Ze,[Me],(f,[u])=>ge(Vt(u.evaluate(f)))],"to-rgba":[ye(He,4),[dt],(f,[u])=>{const[p,I,L,G]=u.evaluate(f).rgb;return[255*p,255*I,255*L,G]}],rgb:[dt,[He,He,He],ko],rgba:[dt,[He,He,He,He],ko],has:{type:Ue,overloads:[[[Ze],(f,[u])=>Gs(u.evaluate(f),f.properties())],[[Ze,rt],(f,[u,p])=>Gs(u.evaluate(f),p.evaluate(f))]]},get:{type:Me,overloads:[[[Ze],(f,[u])=>$o(u.evaluate(f),f.properties())],[[Ze,rt],(f,[u,p])=>$o(u.evaluate(f),p.evaluate(f))]]},"feature-state":[Me,[Ze],(f,[u])=>$o(u.evaluate(f),f.featureState||{})],properties:[rt,[],f=>f.properties()],"geometry-type":[Ze,[],f=>f.geometryType()],id:[Me,[],f=>f.id()],zoom:[He,[],f=>f.globals.zoom],"heatmap-density":[He,[],f=>f.globals.heatmapDensity||0],"line-progress":[He,[],f=>f.globals.lineProgress||0],accumulated:[Me,[],f=>f.globals.accumulated===void 0?null:f.globals.accumulated],"+":[He,Xo(He),(f,u)=>{let p=0;for(const I of u)p+=I.evaluate(f);return p}],"*":[He,Xo(He),(f,u)=>{let p=1;for(const I of u)p*=I.evaluate(f);return p}],"-":{type:He,overloads:[[[He,He],(f,[u,p])=>u.evaluate(f)-p.evaluate(f)],[[He],(f,[u])=>-u.evaluate(f)]]},"/":[He,[He,He],(f,[u,p])=>u.evaluate(f)/p.evaluate(f)],"%":[He,[He,He],(f,[u,p])=>u.evaluate(f)%p.evaluate(f)],ln2:[He,[],()=>Math.LN2],pi:[He,[],()=>Math.PI],e:[He,[],()=>Math.E],"^":[He,[He,He],(f,[u,p])=>Math.pow(u.evaluate(f),p.evaluate(f))],sqrt:[He,[He],(f,[u])=>Math.sqrt(u.evaluate(f))],log10:[He,[He],(f,[u])=>Math.log(u.evaluate(f))/Math.LN10],ln:[He,[He],(f,[u])=>Math.log(u.evaluate(f))],log2:[He,[He],(f,[u])=>Math.log(u.evaluate(f))/Math.LN2],sin:[He,[He],(f,[u])=>Math.sin(u.evaluate(f))],cos:[He,[He],(f,[u])=>Math.cos(u.evaluate(f))],tan:[He,[He],(f,[u])=>Math.tan(u.evaluate(f))],asin:[He,[He],(f,[u])=>Math.asin(u.evaluate(f))],acos:[He,[He],(f,[u])=>Math.acos(u.evaluate(f))],atan:[He,[He],(f,[u])=>Math.atan(u.evaluate(f))],min:[He,Xo(He),(f,u)=>Math.min(...u.map(p=>p.evaluate(f)))],max:[He,Xo(He),(f,u)=>Math.max(...u.map(p=>p.evaluate(f)))],abs:[He,[He],(f,[u])=>Math.abs(u.evaluate(f))],round:[He,[He],(f,[u])=>{const p=u.evaluate(f);return p<0?-Math.round(-p):Math.round(p)}],floor:[He,[He],(f,[u])=>Math.floor(u.evaluate(f))],ceil:[He,[He],(f,[u])=>Math.ceil(u.evaluate(f))],"filter-==":[Ue,[Ze,Me],(f,[u,p])=>f.properties()[u.value]===p.value],"filter-id-==":[Ue,[Me],(f,[u])=>f.id()===u.value],"filter-type-==":[Ue,[Ze],(f,[u])=>f.geometryType()===u.value],"filter-<":[Ue,[Ze,Me],(f,[u,p])=>{const I=f.properties()[u.value],L=p.value;return typeof I==typeof L&&I<L}],"filter-id-<":[Ue,[Me],(f,[u])=>{const p=f.id(),I=u.value;return typeof p==typeof I&&p<I}],"filter->":[Ue,[Ze,Me],(f,[u,p])=>{const I=f.properties()[u.value],L=p.value;return typeof I==typeof L&&I>L}],"filter-id->":[Ue,[Me],(f,[u])=>{const p=f.id(),I=u.value;return typeof p==typeof I&&p>I}],"filter-<=":[Ue,[Ze,Me],(f,[u,p])=>{const I=f.properties()[u.value],L=p.value;return typeof I==typeof L&&I<=L}],"filter-id-<=":[Ue,[Me],(f,[u])=>{const p=f.id(),I=u.value;return typeof p==typeof I&&p<=I}],"filter->=":[Ue,[Ze,Me],(f,[u,p])=>{const I=f.properties()[u.value],L=p.value;return typeof I==typeof L&&I>=L}],"filter-id->=":[Ue,[Me],(f,[u])=>{const p=f.id(),I=u.value;return typeof p==typeof I&&p>=I}],"filter-has":[Ue,[Me],(f,[u])=>u.value in f.properties()],"filter-has-id":[Ue,[],f=>f.id()!==null&&f.id()!==void 0],"filter-type-in":[Ue,[ye(Ze)],(f,[u])=>u.value.indexOf(f.geometryType())>=0],"filter-id-in":[Ue,[ye(Me)],(f,[u])=>u.value.indexOf(f.id())>=0],"filter-in-small":[Ue,[Ze,ye(Me)],(f,[u,p])=>p.value.indexOf(f.properties()[u.value])>=0],"filter-in-large":[Ue,[Ze,ye(Me)],(f,[u,p])=>function(I,L,G,Q){for(;G<=Q;){const re=G+Q>>1;if(L[re]===I)return!0;L[re]>I?Q=re-1:G=re+1}return!1}(f.properties()[u.value],p.value,0,p.value.length-1)],all:{type:Ue,overloads:[[[Ue,Ue],(f,[u,p])=>u.evaluate(f)&&p.evaluate(f)],[Xo(Ue),(f,u)=>{for(const p of u)if(!p.evaluate(f))return!1;return!0}]]},any:{type:Ue,overloads:[[[Ue,Ue],(f,[u,p])=>u.evaluate(f)||p.evaluate(f)],[Xo(Ue),(f,u)=>{for(const p of u)if(p.evaluate(f))return!0;return!1}]]},"!":[Ue,[Ue],(f,[u])=>!u.evaluate(f)],"is-supported-script":[Ue,[Ze],(f,[u])=>{const p=f.globals&&f.globals.isSupportedScript;return!p||p(u.evaluate(f))}],upcase:[Ze,[Ze],(f,[u])=>u.evaluate(f).toUpperCase()],downcase:[Ze,[Ze],(f,[u])=>u.evaluate(f).toLowerCase()],concat:[Ze,Xo(Me),(f,u)=>u.map(p=>hr(p.evaluate(f))).join("")],"resolved-locale":[Ze,[se],(f,[u])=>u.evaluate(f).resolvedLocale()]});class Ol{constructor(u,p){var I;this.expression=u,this._warningHistory={},this._evaluator=new Ga,this._defaultValue=p?(I=p).type==="color"&&$n(I.default)?new ji(0,0,0,0):I.type==="color"?ji.parse(I.default)||null:I.type==="padding"?Yi.parse(I.default)||null:I.type==="variableAnchorOffsetCollection"?Tn.parse(I.default)||null:I.default===void 0?null:I.default:null,this._enumValues=p&&p.type==="enum"?p.values:null}evaluateWithoutErrorHandling(u,p,I,L,G,Q){return this._evaluator.globals=u,this._evaluator.feature=p,this._evaluator.featureState=I,this._evaluator.canonical=L,this._evaluator.availableImages=G||null,this._evaluator.formattedSection=Q,this.expression.evaluate(this._evaluator)}evaluate(u,p,I,L,G,Q){this._evaluator.globals=u,this._evaluator.feature=p||null,this._evaluator.featureState=I||null,this._evaluator.canonical=L,this._evaluator.availableImages=G||null,this._evaluator.formattedSection=Q||null;try{const re=this.expression.evaluate(this._evaluator);if(re==null||typeof re=="number"&&re!=re)return this._defaultValue;if(this._enumValues&&!(re in this._enumValues))throw new Fr(`Expected value to be one of ${Object.keys(this._enumValues).map(Ae=>JSON.stringify(Ae)).join(", ")}, but found ${JSON.stringify(re)} instead.`);return re}catch(re){return this._warningHistory[re.message]||(this._warningHistory[re.message]=!0,typeof console<"u"&&console.warn(re.message)),this._defaultValue}}}function ns(f){return Array.isArray(f)&&f.length>0&&typeof f[0]=="string"&&f[0]in Wo}function Zr(f,u){const p=new Xs(Wo,ja,[],u?function(L){const G={color:dt,string:Ze,number:He,enum:Ze,boolean:Ue,formatted:ne,padding:$,resolvedImage:ie,variableAnchorOffsetCollection:de};return L.type==="array"?ye(G[L.value]||Me,L.length):G[L.type]}(u):void 0),I=p.parse(f,void 0,void 0,void 0,u&&u.type==="string"?{typeAnnotation:"coerce"}:void 0);return I?Yo(new Ol(I,u)):Sa(p.errors)}class Ms{constructor(u,p){this.kind=u,this._styleExpression=p,this.isStateDependent=u!=="constant"&&!Qa(p.expression)}evaluateWithoutErrorHandling(u,p,I,L,G,Q){return this._styleExpression.evaluateWithoutErrorHandling(u,p,I,L,G,Q)}evaluate(u,p,I,L,G,Q){return this._styleExpression.evaluate(u,p,I,L,G,Q)}}class Mr{constructor(u,p,I,L){this.kind=u,this.zoomStops=I,this._styleExpression=p,this.isStateDependent=u!=="camera"&&!Qa(p.expression),this.interpolationType=L}evaluateWithoutErrorHandling(u,p,I,L,G,Q){return this._styleExpression.evaluateWithoutErrorHandling(u,p,I,L,G,Q)}evaluate(u,p,I,L,G,Q){return this._styleExpression.evaluate(u,p,I,L,G,Q)}interpolationFactor(u,p,I){return this.interpolationType?xr.interpolationFactor(this.interpolationType,u,p,I):0}}function nr(f,u){const p=Zr(f,u);if(p.result==="error")return p;const I=p.value.expression,L=Za(I);if(!L&&!$a(u))return Sa([new Ee("","data expressions not supported")]);const G=pl(I,["zoom"]);if(!G&&!ks(u))return Sa([new Ee("","zoom expressions not supported")]);const Q=Xr(I);return Q||G?Q instanceof Ee?Sa([Q]):Q instanceof xr&&!gu(u)?Sa([new Ee("",'"interpolate" expressions cannot be used with this property')]):Yo(Q?new Mr(L?"camera":"composite",p.value,Q.labels,Q instanceof xr?Q.interpolation:void 0):new Ms(L?"constant":"source",p.value)):Sa([new Ee("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ll{constructor(u,p){this._parameters=u,this._specification=p,Ie(this,zr(this._parameters,this._specification))}static deserialize(u){return new ll(u._parameters,u._specification)}static serialize(u){return{_parameters:u._parameters,_specification:u._specification}}}function Xr(f){let u=null;if(f instanceof To)u=Xr(f.result);else if(f instanceof Br){for(const p of f.args)if(u=Xr(p),u)break}else(f instanceof ir||f instanceof xr)&&f.input instanceof Or&&f.input.name==="zoom"&&(u=f);return u instanceof Ee||f.eachChild(p=>{const I=Xr(p);I instanceof Ee?u=I:!u&&I?u=new Ee("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):u&&I&&u!==I&&(u=new Ee("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),u}function Po(f){if(f===!0||f===!1)return!0;if(!Array.isArray(f)||f.length===0)return!1;switch(f[0]){case"has":return f.length>=2&&f[1]!=="$id"&&f[1]!=="$type";case"in":return f.length>=3&&(typeof f[1]!="string"||Array.isArray(f[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return f.length!==3||Array.isArray(f[1])||Array.isArray(f[2]);case"any":case"all":for(const u of f.slice(1))if(!Po(u)&&typeof u!="boolean")return!1;return!0;default:return!0}}const ul={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Qr(f){if(f==null)return{filter:()=>!0,needGeometry:!1};Po(f)||(f=Tl(f));const u=Zr(f,ul);if(u.result==="error")throw new Error(u.value.map(p=>`${p.key}: ${p.message}`).join(", "));return{filter:(p,I,L)=>u.value.evaluate(p,I,{},L),needGeometry:Ia(f)}}function ds(f,u){return f<u?-1:f>u?1:0}function Ia(f){if(!Array.isArray(f))return!1;if(f[0]==="within")return!0;for(let u=1;u<f.length;u++)if(Ia(f[u]))return!0;return!1}function Tl(f){if(!f)return!0;const u=f[0];return f.length<=1?u!=="any":u==="=="?Do(f[1],f[2],"=="):u==="!="?Js(Do(f[1],f[2],"==")):u==="<"||u===">"||u==="<="||u===">="?Do(f[1],f[2],u):u==="any"?(p=f.slice(1),["any"].concat(p.map(Tl))):u==="all"?["all"].concat(f.slice(1).map(Tl)):u==="none"?["all"].concat(f.slice(1).map(Tl).map(Js)):u==="in"?kl(f[1],f.slice(2)):u==="!in"?Js(kl(f[1],f.slice(2))):u==="has"?go(f[1]):u==="!has"?Js(go(f[1])):u!=="within"||f;var p}function Do(f,u,p){switch(f){case"$type":return[`filter-type-${p}`,u];case"$id":return[`filter-id-${p}`,u];default:return[`filter-${p}`,f,u]}}function kl(f,u){if(u.length===0)return!1;switch(f){case"$type":return["filter-type-in",["literal",u]];case"$id":return["filter-id-in",["literal",u]];default:return u.length>200&&!u.some(p=>typeof p!=typeof u[0])?["filter-in-large",f,["literal",u.sort(ds)]]:["filter-in-small",f,["literal",u]]}}function go(f){switch(f){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",f]}}function Js(f){return["!",f]}function qs(f){const u=typeof f;if(u==="number"||u==="boolean"||u==="string"||f==null)return JSON.stringify(f);if(Array.isArray(f)){let L="[";for(const G of f)L+=`${qs(G)},`;return`${L}]`}const p=Object.keys(f).sort();let I="{";for(let L=0;L<p.length;L++)I+=`${JSON.stringify(p[L])}:${qs(f[p[L]])},`;return`${I}}`}function Ya(f){let u="";for(const p of sn)u+=`/${qs(f[p])}`;return u}function Jo(f){const u=f.value;return u?[new ve(f.key,u,"constants have been deprecated as of v8")]:[]}function Yr(f){return f instanceof Number||f instanceof String||f instanceof Boolean?f.valueOf():f}function gr(f){if(Array.isArray(f))return f.map(gr);if(f instanceof Object&&!(f instanceof Number||f instanceof String||f instanceof Boolean)){const u={};for(const p in f)u[p]=gr(f[p]);return u}return Yr(f)}function Nr(f){const u=f.key,p=f.value,I=f.valueSpec||{},L=f.objectElementValidators||{},G=f.style,Q=f.styleSpec,re=f.validateSpec;let Ae=[];const _e=Cr(p);if(_e!=="object")return[new ve(u,p,`object expected, ${_e} found`)];for(const Le in p){const qe=Le.split(".")[0],tt=I[qe]||I["*"];let ft;if(L[qe])ft=L[qe];else if(I[qe])ft=re;else if(L["*"])ft=L["*"];else{if(!I["*"]){Ae.push(new ve(u,p[Le],`unknown property "${Le}"`));continue}ft=re}Ae=Ae.concat(ft({key:(u&&`${u}.`)+Le,value:p[Le],valueSpec:tt,style:G,styleSpec:Q,object:p,objectKey:Le,validateSpec:re},p))}for(const Le in I)L[Le]||I[Le].required&&I[Le].default===void 0&&p[Le]===void 0&&Ae.push(new ve(u,p,`missing required property "${Le}"`));return Ae}function Aa(f){const u=f.value,p=f.valueSpec,I=f.style,L=f.styleSpec,G=f.key,Q=f.arrayElementValidator||f.validateSpec;if(Cr(u)!=="array")return[new ve(G,u,`array expected, ${Cr(u)} found`)];if(p.length&&u.length!==p.length)return[new ve(G,u,`array length ${p.length} expected, length ${u.length} found`)];if(p["min-length"]&&u.length<p["min-length"])return[new ve(G,u,`array length at least ${p["min-length"]} expected, length ${u.length} found`)];let re={type:p.value,values:p.values};L.$version<7&&(re.function=p.function),Cr(p.value)==="object"&&(re=p.value);let Ae=[];for(let _e=0;_e<u.length;_e++)Ae=Ae.concat(Q({array:u,arrayIndex:_e,value:u[_e],valueSpec:re,validateSpec:f.validateSpec,style:I,styleSpec:L,key:`${G}[${_e}]`}));return Ae}function _o(f){const u=f.key,p=f.value,I=f.valueSpec;let L=Cr(p);return L==="number"&&p!=p&&(L="NaN"),L!=="number"?[new ve(u,p,`number expected, ${L} found`)]:"minimum"in I&&p<I.minimum?[new ve(u,p,`${p} is less than the minimum value ${I.minimum}`)]:"maximum"in I&&p>I.maximum?[new ve(u,p,`${p} is greater than the maximum value ${I.maximum}`)]:[]}function ea(f){const u=f.valueSpec,p=Yr(f.value.type);let I,L,G,Q={};const re=p!=="categorical"&&f.value.property===void 0,Ae=!re,_e=Cr(f.value.stops)==="array"&&Cr(f.value.stops[0])==="array"&&Cr(f.value.stops[0][0])==="object",Le=Nr({key:f.key,value:f.value,valueSpec:f.styleSpec.function,validateSpec:f.validateSpec,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(ft){if(p==="identity")return[new ve(ft.key,ft.value,'identity function may not have a "stops" property')];let gt=[];const Mt=ft.value;return gt=gt.concat(Aa({key:ft.key,value:Mt,valueSpec:ft.valueSpec,validateSpec:ft.validateSpec,style:ft.style,styleSpec:ft.styleSpec,arrayElementValidator:qe})),Cr(Mt)==="array"&&Mt.length===0&&gt.push(new ve(ft.key,Mt,"array must have at least one stop")),gt},default:function(ft){return ft.validateSpec({key:ft.key,value:ft.value,valueSpec:u,validateSpec:ft.validateSpec,style:ft.style,styleSpec:ft.styleSpec})}}});return p==="identity"&&re&&Le.push(new ve(f.key,f.value,'missing required property "property"')),p==="identity"||f.value.stops||Le.push(new ve(f.key,f.value,'missing required property "stops"')),p==="exponential"&&f.valueSpec.expression&&!gu(f.valueSpec)&&Le.push(new ve(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(Ae&&!$a(f.valueSpec)?Le.push(new ve(f.key,f.value,"property functions not supported")):re&&!ks(f.valueSpec)&&Le.push(new ve(f.key,f.value,"zoom functions not supported"))),p!=="categorical"&&!_e||f.value.property!==void 0||Le.push(new ve(f.key,f.value,'"property" property is required')),Le;function qe(ft){let gt=[];const Mt=ft.value,Pt=ft.key;if(Cr(Mt)!=="array")return[new ve(Pt,Mt,`array expected, ${Cr(Mt)} found`)];if(Mt.length!==2)return[new ve(Pt,Mt,`array length 2 expected, length ${Mt.length} found`)];if(_e){if(Cr(Mt[0])!=="object")return[new ve(Pt,Mt,`object expected, ${Cr(Mt[0])} found`)];if(Mt[0].zoom===void 0)return[new ve(Pt,Mt,"object stop key must have zoom")];if(Mt[0].value===void 0)return[new ve(Pt,Mt,"object stop key must have value")];if(G&&G>Yr(Mt[0].zoom))return[new ve(Pt,Mt[0].zoom,"stop zoom values must appear in ascending order")];Yr(Mt[0].zoom)!==G&&(G=Yr(Mt[0].zoom),L=void 0,Q={}),gt=gt.concat(Nr({key:`${Pt}[0]`,value:Mt[0],valueSpec:{zoom:{}},validateSpec:ft.validateSpec,style:ft.style,styleSpec:ft.styleSpec,objectElementValidators:{zoom:_o,value:tt}}))}else gt=gt.concat(tt({key:`${Pt}[0]`,value:Mt[0],valueSpec:{},validateSpec:ft.validateSpec,style:ft.style,styleSpec:ft.styleSpec},Mt));return ns(gr(Mt[1]))?gt.concat([new ve(`${Pt}[1]`,Mt[1],"expressions are not allowed in function stops.")]):gt.concat(ft.validateSpec({key:`${Pt}[1]`,value:Mt[1],valueSpec:u,validateSpec:ft.validateSpec,style:ft.style,styleSpec:ft.styleSpec}))}function tt(ft,gt){const Mt=Cr(ft.value),Pt=Yr(ft.value),Lt=ft.value!==null?ft.value:gt;if(I){if(Mt!==I)return[new ve(ft.key,Lt,`${Mt} stop domain type must match previous stop domain type ${I}`)]}else I=Mt;if(Mt!=="number"&&Mt!=="string"&&Mt!=="boolean")return[new ve(ft.key,Lt,"stop domain value must be a number, string, or boolean")];if(Mt!=="number"&&p!=="categorical"){let ei=`number expected, ${Mt} found`;return $a(u)&&p===void 0&&(ei+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ve(ft.key,Lt,ei)]}return p!=="categorical"||Mt!=="number"||isFinite(Pt)&&Math.floor(Pt)===Pt?p!=="categorical"&&Mt==="number"&&L!==void 0&&Pt<L?[new ve(ft.key,Lt,"stop domain values must appear in ascending order")]:(L=Pt,p==="categorical"&&Pt in Q?[new ve(ft.key,Lt,"stop domain values must be unique")]:(Q[Pt]=!0,[])):[new ve(ft.key,Lt,`integer expected, found ${Pt}`)]}}function Ea(f){const u=(f.expressionContext==="property"?nr:Zr)(gr(f.value),f.valueSpec);if(u.result==="error")return u.value.map(I=>new ve(`${f.key}${I.key}`,f.value,I.message));const p=u.value.expression||u.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!p.outputDefined())return[new ve(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!Qa(p))return[new ve(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter"&&!Qa(p))return[new ve(f.key,f.value,'"feature-state" data expressions are not supported with filters.')];if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!pl(p,["zoom","feature-state"]))return[new ve(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!Za(p))return[new ve(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Pa(f){const u=f.key,p=f.value,I=f.valueSpec,L=[];return Array.isArray(I.values)?I.values.indexOf(Yr(p))===-1&&L.push(new ve(u,p,`expected one of [${I.values.join(", ")}], ${JSON.stringify(p)} found`)):Object.keys(I.values).indexOf(Yr(p))===-1&&L.push(new ve(u,p,`expected one of [${Object.keys(I.values).join(", ")}], ${JSON.stringify(p)} found`)),L}function Ka(f){return Po(gr(f.value))?Ea(Ie({},f,{expressionContext:"filter",valueSpec:{value:"boolean"}})):cl(f)}function cl(f){const u=f.value,p=f.key;if(Cr(u)!=="array")return[new ve(p,u,`array expected, ${Cr(u)} found`)];const I=f.styleSpec;let L,G=[];if(u.length<1)return[new ve(p,u,"filter array must have at least 1 element")];switch(G=G.concat(Pa({key:`${p}[0]`,value:u[0],valueSpec:I.filter_operator,style:f.style,styleSpec:f.styleSpec})),Yr(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&Yr(u[1])==="$type"&&G.push(new ve(p,u,`"$type" cannot be use with operator "${u[0]}"`));case"==":case"!=":u.length!==3&&G.push(new ve(p,u,`filter array for operator "${u[0]}" must have 3 elements`));case"in":case"!in":u.length>=2&&(L=Cr(u[1]),L!=="string"&&G.push(new ve(`${p}[1]`,u[1],`string expected, ${L} found`)));for(let Q=2;Q<u.length;Q++)L=Cr(u[Q]),Yr(u[1])==="$type"?G=G.concat(Pa({key:`${p}[${Q}]`,value:u[Q],valueSpec:I.geometry_type,style:f.style,styleSpec:f.styleSpec})):L!=="string"&&L!=="number"&&L!=="boolean"&&G.push(new ve(`${p}[${Q}]`,u[Q],`string, number, or boolean expected, ${L} found`));break;case"any":case"all":case"none":for(let Q=1;Q<u.length;Q++)G=G.concat(cl({key:`${p}[${Q}]`,value:u[Q],style:f.style,styleSpec:f.styleSpec}));break;case"has":case"!has":L=Cr(u[1]),u.length!==2?G.push(new ve(p,u,`filter array for "${u[0]}" operator must have 2 elements`)):L!=="string"&&G.push(new ve(`${p}[1]`,u[1],`string expected, ${L} found`));break;case"within":L=Cr(u[1]),u.length!==2?G.push(new ve(p,u,`filter array for "${u[0]}" operator must have 2 elements`)):L!=="object"&&G.push(new ve(`${p}[1]`,u[1],`object expected, ${L} found`))}return G}function lu(f,u){const p=f.key,I=f.validateSpec,L=f.style,G=f.styleSpec,Q=f.value,re=f.objectKey,Ae=G[`${u}_${f.layerType}`];if(!Ae)return[];const _e=re.match(/^(.*)-transition$/);if(u==="paint"&&_e&&Ae[_e[1]]&&Ae[_e[1]].transition)return I({key:p,value:Q,valueSpec:G.transition,style:L,styleSpec:G});const Le=f.valueSpec||Ae[re];if(!Le)return[new ve(p,Q,`unknown property "${re}"`)];let qe;if(Cr(Q)==="string"&&$a(Le)&&!Le.tokens&&(qe=/^{([^}]+)}$/.exec(Q)))return[new ve(p,Q,`"${re}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(qe[1])} }\`.`)];const tt=[];return f.layerType==="symbol"&&(re==="text-field"&&L&&!L.glyphs&&tt.push(new ve(p,Q,'use of "text-field" requires a style "glyphs" property')),re==="text-font"&&$n(gr(Q))&&Yr(Q.type)==="identity"&&tt.push(new ve(p,Q,'"text-font" does not support identity functions'))),tt.concat(I({key:f.key,value:Q,valueSpec:Le,style:L,styleSpec:G,expressionContext:"property",propertyType:u,propertyKey:re}))}function gl(f){return lu(f,"paint")}function ao(f){return lu(f,"layout")}function pi(f){let u=[];const p=f.value,I=f.key,L=f.style,G=f.styleSpec;p.type||p.ref||u.push(new ve(I,p,'either "type" or "ref" is required'));let Q=Yr(p.type);const re=Yr(p.ref);if(p.id){const Ae=Yr(p.id);for(let _e=0;_e<f.arrayIndex;_e++){const Le=L.layers[_e];Yr(Le.id)===Ae&&u.push(new ve(I,p.id,`duplicate layer id "${p.id}", previously used at line ${Le.id.__line__}`))}}if("ref"in p){let Ae;["type","source","source-layer","filter","layout"].forEach(_e=>{_e in p&&u.push(new ve(I,p[_e],`"${_e}" is prohibited for ref layers`))}),L.layers.forEach(_e=>{Yr(_e.id)===re&&(Ae=_e)}),Ae?Ae.ref?u.push(new ve(I,p.ref,"ref cannot reference another ref layer")):Q=Yr(Ae.type):u.push(new ve(I,p.ref,`ref layer "${re}" not found`))}else if(Q!=="background")if(p.source){const Ae=L.sources&&L.sources[p.source],_e=Ae&&Yr(Ae.type);Ae?_e==="vector"&&Q==="raster"?u.push(new ve(I,p.source,`layer "${p.id}" requires a raster source`)):_e!=="raster-dem"&&Q==="hillshade"?u.push(new ve(I,p.source,`layer "${p.id}" requires a raster-dem source`)):_e==="raster"&&Q!=="raster"?u.push(new ve(I,p.source,`layer "${p.id}" requires a vector source`)):_e!=="vector"||p["source-layer"]?_e==="raster-dem"&&Q!=="hillshade"?u.push(new ve(I,p.source,"raster-dem source can only be used with layer type 'hillshade'.")):Q!=="line"||!p.paint||!p.paint["line-gradient"]||_e==="geojson"&&Ae.lineMetrics||u.push(new ve(I,p,`layer "${p.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):u.push(new ve(I,p,`layer "${p.id}" must specify a "source-layer"`)):u.push(new ve(I,p.source,`source "${p.source}" not found`))}else u.push(new ve(I,p,'missing required property "source"'));return u=u.concat(Nr({key:I,value:p,valueSpec:G.layer,style:f.style,styleSpec:f.styleSpec,validateSpec:f.validateSpec,objectElementValidators:{"*":()=>[],type:()=>f.validateSpec({key:`${I}.type`,value:p.type,valueSpec:G.layer.type,style:f.style,styleSpec:f.styleSpec,validateSpec:f.validateSpec,object:p,objectKey:"type"}),filter:Ka,layout:Ae=>Nr({layer:p,key:Ae.key,value:Ae.value,style:Ae.style,styleSpec:Ae.styleSpec,validateSpec:Ae.validateSpec,objectElementValidators:{"*":_e=>ao(Ie({layerType:Q},_e))}}),paint:Ae=>Nr({layer:p,key:Ae.key,value:Ae.value,style:Ae.style,styleSpec:Ae.styleSpec,validateSpec:Ae.validateSpec,objectElementValidators:{"*":_e=>gl(Ie({layerType:Q},_e))}})}})),u}function Vi(f){const u=f.value,p=f.key,I=Cr(u);return I!=="string"?[new ve(p,u,`string expected, ${I} found`)]:[]}const Pi={promoteId:function({key:f,value:u}){if(Cr(u)==="string")return Vi({key:f,value:u});{const p=[];for(const I in u)p.push(...Vi({key:`${f}.${I}`,value:u[I]}));return p}}};function Ft(f){const u=f.value,p=f.key,I=f.styleSpec,L=f.style,G=f.validateSpec;if(!u.type)return[new ve(p,u,'"type" is required')];const Q=Yr(u.type);let re;switch(Q){case"vector":case"raster":return re=Nr({key:p,value:u,valueSpec:I[`source_${Q.replace("-","_")}`],style:f.style,styleSpec:I,objectElementValidators:Pi,validateSpec:G}),re;case"raster-dem":return re=function(Ae){var _e;const Le=(_e=Ae.sourceName)!==null&&_e!==void 0?_e:"",qe=Ae.value,tt=Ae.styleSpec,ft=tt.source_raster_dem,gt=Ae.style;let Mt=[];const Pt=Cr(qe);if(qe===void 0)return Mt;if(Pt!=="object")return Mt.push(new ve("source_raster_dem",qe,`object expected, ${Pt} found`)),Mt;const Lt=Yr(qe.encoding)==="custom",ei=["redFactor","greenFactor","blueFactor","baseShift"],Ht=Ae.value.encoding?`"${Ae.value.encoding}"`:"Default";for(const Qt in qe)!Lt&&ei.includes(Qt)?Mt.push(new ve(Qt,qe[Qt],`In "${Le}": "${Qt}" is only valid when "encoding" is set to "custom". ${Ht} encoding found`)):ft[Qt]?Mt=Mt.concat(Ae.validateSpec({key:Qt,value:qe[Qt],valueSpec:ft[Qt],validateSpec:Ae.validateSpec,style:gt,styleSpec:tt})):Mt.push(new ve(Qt,qe[Qt],`unknown property "${Qt}"`));return Mt}({sourceName:p,value:u,style:f.style,styleSpec:I,validateSpec:G}),re;case"geojson":if(re=Nr({key:p,value:u,valueSpec:I.source_geojson,style:L,styleSpec:I,validateSpec:G,objectElementValidators:Pi}),u.cluster)for(const Ae in u.clusterProperties){const[_e,Le]=u.clusterProperties[Ae],qe=typeof _e=="string"?[_e,["accumulated"],["get",Ae]]:_e;re.push(...Ea({key:`${p}.${Ae}.map`,value:Le,validateSpec:G,expressionContext:"cluster-map"})),re.push(...Ea({key:`${p}.${Ae}.reduce`,value:qe,validateSpec:G,expressionContext:"cluster-reduce"}))}return re;case"video":return Nr({key:p,value:u,valueSpec:I.source_video,style:L,validateSpec:G,styleSpec:I});case"image":return Nr({key:p,value:u,valueSpec:I.source_image,style:L,validateSpec:G,styleSpec:I});case"canvas":return[new ve(p,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Pa({key:`${p}.type`,value:u.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:L,validateSpec:G,styleSpec:I})}}function ni(f){const u=f.value,p=f.styleSpec,I=p.light,L=f.style;let G=[];const Q=Cr(u);if(u===void 0)return G;if(Q!=="object")return G=G.concat([new ve("light",u,`object expected, ${Q} found`)]),G;for(const re in u){const Ae=re.match(/^(.*)-transition$/);G=G.concat(Ae&&I[Ae[1]]&&I[Ae[1]].transition?f.validateSpec({key:re,value:u[re],valueSpec:p.transition,validateSpec:f.validateSpec,style:L,styleSpec:p}):I[re]?f.validateSpec({key:re,value:u[re],valueSpec:I[re],validateSpec:f.validateSpec,style:L,styleSpec:p}):[new ve(re,u[re],`unknown property "${re}"`)])}return G}function xi(f){const u=f.value,p=f.styleSpec,I=p.terrain,L=f.style;let G=[];const Q=Cr(u);if(u===void 0)return G;if(Q!=="object")return G=G.concat([new ve("terrain",u,`object expected, ${Q} found`)]),G;for(const re in u)G=G.concat(I[re]?f.validateSpec({key:re,value:u[re],valueSpec:I[re],validateSpec:f.validateSpec,style:L,styleSpec:p}):[new ve(re,u[re],`unknown property "${re}"`)]);return G}function Fi(f){let u=[];const p=f.value,I=f.key;if(Array.isArray(p)){const L=[],G=[];for(const Q in p)p[Q].id&&L.includes(p[Q].id)&&u.push(new ve(I,p,`all the sprites' ids must be unique, but ${p[Q].id} is duplicated`)),L.push(p[Q].id),p[Q].url&&G.includes(p[Q].url)&&u.push(new ve(I,p,`all the sprites' URLs must be unique, but ${p[Q].url} is duplicated`)),G.push(p[Q].url),u=u.concat(Nr({key:`${I}[${Q}]`,value:p[Q],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:f.validateSpec}));return u}return Vi({key:I,value:p})}const Ln={"*":()=>[],array:Aa,boolean:function(f){const u=f.value,p=f.key,I=Cr(u);return I!=="boolean"?[new ve(p,u,`boolean expected, ${I} found`)]:[]},number:_o,color:function(f){const u=f.key,p=f.value,I=Cr(p);return I!=="string"?[new ve(u,p,`color expected, ${I} found`)]:ji.parse(String(p))?[]:[new ve(u,p,`color expected, "${p}" found`)]},constants:Jo,enum:Pa,filter:Ka,function:ea,layer:pi,object:Nr,source:Ft,light:ni,terrain:xi,string:Vi,formatted:function(f){return Vi(f).length===0?[]:Ea(f)},resolvedImage:function(f){return Vi(f).length===0?[]:Ea(f)},padding:function(f){const u=f.key,p=f.value;if(Cr(p)==="array"){if(p.length<1||p.length>4)return[new ve(u,p,`padding requires 1 to 4 values; ${p.length} values found`)];const I={type:"number"};let L=[];for(let G=0;G<p.length;G++)L=L.concat(f.validateSpec({key:`${u}[${G}]`,value:p[G],validateSpec:f.validateSpec,valueSpec:I}));return L}return _o({key:u,value:p,valueSpec:{}})},variableAnchorOffsetCollection:function(f){const u=f.key,p=f.value,I=Cr(p),L=f.styleSpec;if(I!=="array"||p.length<1||p.length%2!=0)return[new ve(u,p,"variableAnchorOffsetCollection requires a non-empty array of even length")];let G=[];for(let Q=0;Q<p.length;Q+=2)G=G.concat(Pa({key:`${u}[${Q}]`,value:p[Q],valueSpec:L.layout_symbol["text-anchor"]})),G=G.concat(Aa({key:`${u}[${Q+1}]`,value:p[Q+1],valueSpec:{length:2,value:"number"},validateSpec:f.validateSpec,style:f.style,styleSpec:L}));return G},sprite:Fi};function jn(f){const u=f.value,p=f.valueSpec,I=f.styleSpec;return f.validateSpec=jn,p.expression&&$n(Yr(u))?ea(f):p.expression&&ns(gr(u))?Ea(f):p.type&&Ln[p.type]?Ln[p.type](f):Nr(Ie({},f,{valueSpec:p.type?I[p.type]:p}))}function or(f){const u=f.value,p=f.key,I=Vi(f);return I.length||(u.indexOf("{fontstack}")===-1&&I.push(new ve(p,u,'"glyphs" url must include a "{fontstack}" token')),u.indexOf("{range}")===-1&&I.push(new ve(p,u,'"glyphs" url must include a "{range}" token'))),I}function Xn(f,u=ci){let p=[];return p=p.concat(jn({key:"",value:f,valueSpec:u.$root,styleSpec:u,style:f,validateSpec:jn,objectElementValidators:{glyphs:or,"*":()=>[]}})),f.constants&&(p=p.concat(Jo({key:"constants",value:f.constants,style:f,styleSpec:u,validateSpec:jn}))),Ps(p)}function Hs(f){return function(u){return f({...u,validateSpec:jn})}}function Ps(f){return[].concat(f).sort((u,p)=>u.line-p.line)}function ps(f){return function(...u){return Ps(f.apply(this,u))}}Xn.source=ps(Hs(Ft)),Xn.sprite=ps(Hs(Fi)),Xn.glyphs=ps(Hs(or)),Xn.light=ps(Hs(ni)),Xn.terrain=ps(Hs(xi)),Xn.layer=ps(Hs(pi)),Xn.filter=ps(Hs(Ka)),Xn.paintProperty=ps(Hs(gl)),Xn.layoutProperty=ps(Hs(ao));const Ja=Xn,yo=Ja.light,os=Ja.paintProperty,$u=Ja.layoutProperty;function Fu(f,u){let p=!1;if(u&&u.length)for(const I of u)f.fire(new Ji(new Error(I.message))),p=!0;return p}class vo{constructor(u,p,I){const L=this.cells=[];if(u instanceof ArrayBuffer){this.arrayBuffer=u;const Q=new Int32Array(this.arrayBuffer);u=Q[0],this.d=(p=Q[1])+2*(I=Q[2]);for(let Ae=0;Ae<this.d*this.d;Ae++){const _e=Q[3+Ae],Le=Q[3+Ae+1];L.push(_e===Le?null:Q.subarray(_e,Le))}const re=Q[3+L.length+1];this.keys=Q.subarray(Q[3+L.length],re),this.bboxes=Q.subarray(re),this.insert=this._insertReadonly}else{this.d=p+2*I;for(let Q=0;Q<this.d*this.d;Q++)L.push([]);this.keys=[],this.bboxes=[]}this.n=p,this.extent=u,this.padding=I,this.scale=p/u,this.uid=0;const G=I/p*u;this.min=-G,this.max=u+G}insert(u,p,I,L,G){this._forEachCell(p,I,L,G,this._insertCell,this.uid++,void 0,void 0),this.keys.push(u),this.bboxes.push(p),this.bboxes.push(I),this.bboxes.push(L),this.bboxes.push(G)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(u,p,I,L,G,Q){this.cells[G].push(Q)}query(u,p,I,L,G){const Q=this.min,re=this.max;if(u<=Q&&p<=Q&&re<=I&&re<=L&&!G)return Array.prototype.slice.call(this.keys);{const Ae=[];return this._forEachCell(u,p,I,L,this._queryCell,Ae,{},G),Ae}}_queryCell(u,p,I,L,G,Q,re,Ae){const _e=this.cells[G];if(_e!==null){const Le=this.keys,qe=this.bboxes;for(let tt=0;tt<_e.length;tt++){const ft=_e[tt];if(re[ft]===void 0){const gt=4*ft;(Ae?Ae(qe[gt+0],qe[gt+1],qe[gt+2],qe[gt+3]):u<=qe[gt+2]&&p<=qe[gt+3]&&I>=qe[gt+0]&&L>=qe[gt+1])?(re[ft]=!0,Q.push(Le[ft])):re[ft]=!1}}}}_forEachCell(u,p,I,L,G,Q,re,Ae){const _e=this._convertToCellCoord(u),Le=this._convertToCellCoord(p),qe=this._convertToCellCoord(I),tt=this._convertToCellCoord(L);for(let ft=_e;ft<=qe;ft++)for(let gt=Le;gt<=tt;gt++){const Mt=this.d*gt+ft;if((!Ae||Ae(this._convertFromCellCoord(ft),this._convertFromCellCoord(gt),this._convertFromCellCoord(ft+1),this._convertFromCellCoord(gt+1)))&&G.call(this,u,p,I,L,Mt,Q,re,Ae))return}}_convertFromCellCoord(u){return(u-this.padding)/this.scale}_convertToCellCoord(u){return Math.max(0,Math.min(this.d-1,Math.floor(u*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const u=this.cells,p=3+this.cells.length+1+1;let I=0;for(let Q=0;Q<this.cells.length;Q++)I+=this.cells[Q].length;const L=new Int32Array(p+I+this.keys.length+this.bboxes.length);L[0]=this.extent,L[1]=this.n,L[2]=this.padding;let G=p;for(let Q=0;Q<u.length;Q++){const re=u[Q];L[3+Q]=G,L.set(re,G),G+=re.length}return L[3+u.length]=G,L.set(this.keys,G),G+=this.keys.length,L[3+u.length+1]=G,L.set(this.bboxes,G),G+=this.bboxes.length,L.buffer}static serialize(u,p){const I=u.toArrayBuffer();return p&&p.push(I),{buffer:I}}static deserialize(u){return new vo(u.buffer)}}const Ml={};function Pn(f,u,p={}){if(Ml[f])throw new Error(`${f} is already registered.`);Object.defineProperty(u,"_classRegistryKey",{value:f,writeable:!1}),Ml[f]={klass:u,omit:p.omit||[],shallow:p.shallow||[]}}Pn("Object",Object),Pn("TransferableGridIndex",vo),Pn("Color",ji),Pn("Error",Error),Pn("AJAXError",vn),Pn("ResolvedImage",cr),Pn("StylePropertyFunction",ll),Pn("StyleExpression",Ol,{omit:["_evaluator"]}),Pn("ZoomDependentExpression",Mr),Pn("ZoomConstantExpression",Ms),Pn("CompoundExpression",Or,{omit:["_evaluate"]});for(const f in Wo)Wo[f]._classRegistryKey||Pn(`Expression_${f}`,Wo[f]);function Da(f){return f&&typeof ArrayBuffer<"u"&&(f instanceof ArrayBuffer||f.constructor&&f.constructor.name==="ArrayBuffer")}function In(f,u){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob)return f;if(Da(f)||Ot(f))return u&&u.push(f),f;if(ArrayBuffer.isView(f)){const p=f;return u&&u.push(p.buffer),p}if(f instanceof ImageData)return u&&u.push(f.data.buffer),f;if(Array.isArray(f)){const p=[];for(const I of f)p.push(In(I,u));return p}if(typeof f=="object"){const p=f.constructor,I=p._classRegistryKey;if(!I)throw new Error("can't serialize object of unregistered class");if(!Ml[I])throw new Error(`${I} is not registered.`);const L=p.serialize?p.serialize(f,u):{};if(p.serialize){if(u&&L===u[u.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const G in f){if(!f.hasOwnProperty(G)||Ml[I].omit.indexOf(G)>=0)continue;const Q=f[G];L[G]=Ml[I].shallow.indexOf(G)>=0?Q:In(Q,u)}f instanceof Error&&(L.message=f.message)}if(L.$name)throw new Error("$name property is reserved for worker serialization logic.");return I!=="Object"&&(L.$name=I),L}throw new Error("can't serialize object of type "+typeof f)}function No(f){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob||Da(f)||Ot(f)||ArrayBuffer.isView(f)||f instanceof ImageData)return f;if(Array.isArray(f))return f.map(No);if(typeof f=="object"){const u=f.$name||"Object";if(!Ml[u])throw new Error(`can't deserialize unregistered class ${u}`);const{klass:p}=Ml[u];if(!p)throw new Error(`can't deserialize unregistered class ${u}`);if(p.deserialize)return p.deserialize(f);const I=Object.create(p.prototype);for(const L of Object.keys(f)){if(L==="$name")continue;const G=f[L];I[L]=Ml[u].shallow.indexOf(L)>=0?G:No(G)}return I}throw new Error("can't deserialize object of type "+typeof f)}class Nl{constructor(){this.first=!0}update(u,p){const I=Math.floor(u);return this.first?(this.first=!1,this.lastIntegerZoom=I,this.lastIntegerZoomTime=0,this.lastZoom=u,this.lastFloorZoom=I,!0):(this.lastFloorZoom>I?(this.lastIntegerZoom=I+1,this.lastIntegerZoomTime=p):this.lastFloorZoom<I&&(this.lastIntegerZoom=I,this.lastIntegerZoomTime=p),u!==this.lastZoom&&(this.lastZoom=u,this.lastFloorZoom=I,!0))}}const En={"Latin-1 Supplement":f=>f>=128&&f<=255,Arabic:f=>f>=1536&&f<=1791,"Arabic Supplement":f=>f>=1872&&f<=1919,"Arabic Extended-A":f=>f>=2208&&f<=2303,"Hangul Jamo":f=>f>=4352&&f<=4607,"Unified Canadian Aboriginal Syllabics":f=>f>=5120&&f<=5759,Khmer:f=>f>=6016&&f<=6143,"Unified Canadian Aboriginal Syllabics Extended":f=>f>=6320&&f<=6399,"General Punctuation":f=>f>=8192&&f<=8303,"Letterlike Symbols":f=>f>=8448&&f<=8527,"Number Forms":f=>f>=8528&&f<=8591,"Miscellaneous Technical":f=>f>=8960&&f<=9215,"Control Pictures":f=>f>=9216&&f<=9279,"Optical Character Recognition":f=>f>=9280&&f<=9311,"Enclosed Alphanumerics":f=>f>=9312&&f<=9471,"Geometric Shapes":f=>f>=9632&&f<=9727,"Miscellaneous Symbols":f=>f>=9728&&f<=9983,"Miscellaneous Symbols and Arrows":f=>f>=11008&&f<=11263,"CJK Radicals Supplement":f=>f>=11904&&f<=12031,"Kangxi Radicals":f=>f>=12032&&f<=12255,"Ideographic Description Characters":f=>f>=12272&&f<=12287,"CJK Symbols and Punctuation":f=>f>=12288&&f<=12351,Hiragana:f=>f>=12352&&f<=12447,Katakana:f=>f>=12448&&f<=12543,Bopomofo:f=>f>=12544&&f<=12591,"Hangul Compatibility Jamo":f=>f>=12592&&f<=12687,Kanbun:f=>f>=12688&&f<=12703,"Bopomofo Extended":f=>f>=12704&&f<=12735,"CJK Strokes":f=>f>=12736&&f<=12783,"Katakana Phonetic Extensions":f=>f>=12784&&f<=12799,"Enclosed CJK Letters and Months":f=>f>=12800&&f<=13055,"CJK Compatibility":f=>f>=13056&&f<=13311,"CJK Unified Ideographs Extension A":f=>f>=13312&&f<=19903,"Yijing Hexagram Symbols":f=>f>=19904&&f<=19967,"CJK Unified Ideographs":f=>f>=19968&&f<=40959,"Yi Syllables":f=>f>=40960&&f<=42127,"Yi Radicals":f=>f>=42128&&f<=42191,"Hangul Jamo Extended-A":f=>f>=43360&&f<=43391,"Hangul Syllables":f=>f>=44032&&f<=55215,"Hangul Jamo Extended-B":f=>f>=55216&&f<=55295,"Private Use Area":f=>f>=57344&&f<=63743,"CJK Compatibility Ideographs":f=>f>=63744&&f<=64255,"Arabic Presentation Forms-A":f=>f>=64336&&f<=65023,"Vertical Forms":f=>f>=65040&&f<=65055,"CJK Compatibility Forms":f=>f>=65072&&f<=65103,"Small Form Variants":f=>f>=65104&&f<=65135,"Arabic Presentation Forms-B":f=>f>=65136&&f<=65279,"Halfwidth and Fullwidth Forms":f=>f>=65280&&f<=65519};function $l(f){for(const u of f)if(uu(u.charCodeAt(0)))return!0;return!1}function Cn(f){for(const u of f)if(!_l(u.charCodeAt(0)))return!1;return!0}function _l(f){return!(En.Arabic(f)||En["Arabic Supplement"](f)||En["Arabic Extended-A"](f)||En["Arabic Presentation Forms-A"](f)||En["Arabic Presentation Forms-B"](f))}function uu(f){return!(f!==746&&f!==747&&(f<4352||!(En["Bopomofo Extended"](f)||En.Bopomofo(f)||En["CJK Compatibility Forms"](f)&&!(f>=65097&&f<=65103)||En["CJK Compatibility Ideographs"](f)||En["CJK Compatibility"](f)||En["CJK Radicals Supplement"](f)||En["CJK Strokes"](f)||!(!En["CJK Symbols and Punctuation"](f)||f>=12296&&f<=12305||f>=12308&&f<=12319||f===12336)||En["CJK Unified Ideographs Extension A"](f)||En["CJK Unified Ideographs"](f)||En["Enclosed CJK Letters and Months"](f)||En["Hangul Compatibility Jamo"](f)||En["Hangul Jamo Extended-A"](f)||En["Hangul Jamo Extended-B"](f)||En["Hangul Jamo"](f)||En["Hangul Syllables"](f)||En.Hiragana(f)||En["Ideographic Description Characters"](f)||En.Kanbun(f)||En["Kangxi Radicals"](f)||En["Katakana Phonetic Extensions"](f)||En.Katakana(f)&&f!==12540||!(!En["Halfwidth and Fullwidth Forms"](f)||f===65288||f===65289||f===65293||f>=65306&&f<=65310||f===65339||f===65341||f===65343||f>=65371&&f<=65503||f===65507||f>=65512&&f<=65519)||!(!En["Small Form Variants"](f)||f>=65112&&f<=65118||f>=65123&&f<=65126)||En["Unified Canadian Aboriginal Syllabics"](f)||En["Unified Canadian Aboriginal Syllabics Extended"](f)||En["Vertical Forms"](f)||En["Yijing Hexagram Symbols"](f)||En["Yi Syllables"](f)||En["Yi Radicals"](f))))}function Ou(f){return!(uu(f)||function(u){return!!(En["Latin-1 Supplement"](u)&&(u===167||u===169||u===174||u===177||u===188||u===189||u===190||u===215||u===247)||En["General Punctuation"](u)&&(u===8214||u===8224||u===8225||u===8240||u===8241||u===8251||u===8252||u===8258||u===8263||u===8264||u===8265||u===8273)||En["Letterlike Symbols"](u)||En["Number Forms"](u)||En["Miscellaneous Technical"](u)&&(u>=8960&&u<=8967||u>=8972&&u<=8991||u>=8996&&u<=9e3||u===9003||u>=9085&&u<=9114||u>=9150&&u<=9165||u===9167||u>=9169&&u<=9179||u>=9186&&u<=9215)||En["Control Pictures"](u)&&u!==9251||En["Optical Character Recognition"](u)||En["Enclosed Alphanumerics"](u)||En["Geometric Shapes"](u)||En["Miscellaneous Symbols"](u)&&!(u>=9754&&u<=9759)||En["Miscellaneous Symbols and Arrows"](u)&&(u>=11026&&u<=11055||u>=11088&&u<=11097||u>=11192&&u<=11243)||En["CJK Symbols and Punctuation"](u)||En.Katakana(u)||En["Private Use Area"](u)||En["CJK Compatibility Forms"](u)||En["Small Form Variants"](u)||En["Halfwidth and Fullwidth Forms"](u)||u===8734||u===8756||u===8757||u>=9984&&u<=10087||u>=10102&&u<=10131||u===65532||u===65533)}(f))}function Vl(f){return f>=1424&&f<=2303||En["Arabic Presentation Forms-A"](f)||En["Arabic Presentation Forms-B"](f)}function yl(f,u){return!(!u&&Vl(f)||f>=2304&&f<=3583||f>=3840&&f<=4255||En.Khmer(f))}function ta(f){for(const u of f)if(Vl(u.charCodeAt(0)))return!0;return!1}const oc="deferred",Xu="loading",Xl="loaded";let ms=null,_a="unavailable",el=null;const _u=function(f){f&&typeof f=="string"&&f.indexOf("NetworkError")>-1&&(_a="error"),ms&&ms(f)};function Nu(){cu.fire(new Xt("pluginStateChange",{pluginStatus:_a,pluginURL:el}))}const cu=new mr,Vu=function(){return _a},yr=function(){if(_a!==oc||!el)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");_a=Xu,Nu(),el&&xn({url:el},f=>{f?_u(f):(_a=Xl,Nu())})},gs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>_a===Xl||gs.applyArabicShaping!=null,isLoading:()=>_a===Xu,setState(f){if(!Nt())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");_a=f.pluginStatus,el=f.pluginURL},isParsed(){if(!Nt())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return gs.applyArabicShaping!=null&&gs.processBidirectionalText!=null&&gs.processStyledBidirectionalText!=null},getPluginURL(){if(!Nt())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return el}};class gn{constructor(u,p){this.zoom=u,p?(this.now=p.now,this.fadeDuration=p.fadeDuration,this.zoomHistory=p.zoomHistory,this.transition=p.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Nl,this.transition={})}isSupportedScript(u){return function(p,I){for(const L of p)if(!yl(L.charCodeAt(0),I))return!1;return!0}(u,gs.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const u=this.zoom,p=u-Math.floor(u),I=this.crossFadingFactor();return u>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:p+(1-p)*I}:{fromScale:.5,toScale:1,t:1-(1-I)*p}}}class Zn{constructor(u,p){this.property=u,this.value=p,this.expression=function(I,L){if($n(I))return new ll(I,L);if(ns(I)){const G=nr(I,L);if(G.result==="error")throw new Error(G.value.map(Q=>`${Q.key}: ${Q.message}`).join(", "));return G.value}{let G=I;return L.type==="color"&&typeof I=="string"?G=ji.parse(I):L.type!=="padding"||typeof I!="number"&&!Array.isArray(I)?L.type==="variableAnchorOffsetCollection"&&Array.isArray(I)&&(G=Tn.parse(I)):G=Yi.parse(I),{kind:"constant",evaluate:()=>G}}}(p===void 0?u.specification.default:p,u.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(u,p,I){return this.property.possiblyEvaluate(this,u,p,I)}}class Jn{constructor(u){this.property=u,this.value=new Zn(u,void 0)}transitioned(u,p){return new Tu(this.property,this.value,p,at({},u.transition,this.transition),u.now)}untransitioned(){return new Tu(this.property,this.value,null,{},0)}}class tl{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitionablePropertyValues)}getValue(u){return bt(this._values[u].value.value)}setValue(u,p){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new Jn(this._values[u].property)),this._values[u].value=new Zn(this._values[u].property,p===null?void 0:bt(p))}getTransition(u){return bt(this._values[u].transition)}setTransition(u,p){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new Jn(this._values[u].property)),this._values[u].transition=bt(p)||void 0}serialize(){const u={};for(const p of Object.keys(this._values)){const I=this.getValue(p);I!==void 0&&(u[p]=I);const L=this.getTransition(p);L!==void 0&&(u[`${p}-transition`]=L)}return u}transitioned(u,p){const I=new oa(this._properties);for(const L of Object.keys(this._values))I._values[L]=this._values[L].transitioned(u,p._values[L]);return I}untransitioned(){const u=new oa(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].untransitioned();return u}}class Tu{constructor(u,p,I,L,G){this.property=u,this.value=p,this.begin=G+L.delay||0,this.end=this.begin+L.duration||0,u.specification.transition&&(L.delay||L.duration)&&(this.prior=I)}possiblyEvaluate(u,p,I){const L=u.now||0,G=this.value.possiblyEvaluate(u,p,I),Q=this.prior;if(Q){if(L>this.end)return this.prior=null,G;if(this.value.isDataDriven())return this.prior=null,G;if(L<this.begin)return Q.possiblyEvaluate(u,p,I);{const re=(L-this.begin)/(this.end-this.begin);return this.property.interpolate(Q.possiblyEvaluate(u,p,I),G,function(Ae){if(Ae<=0)return 0;if(Ae>=1)return 1;const _e=Ae*Ae,Le=_e*Ae;return 4*(Ae<.5?Le:3*(Ae-_e)+Le-.75)}(re))}}return G}}class oa{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitioningPropertyValues)}possiblyEvaluate(u,p,I){const L=new Lo(this._properties);for(const G of Object.keys(this._values))L._values[G]=this._values[G].possiblyEvaluate(u,p,I);return L}hasTransition(){for(const u of Object.keys(this._values))if(this._values[u].prior)return!0;return!1}}class yu{constructor(u){this._properties=u,this._values=Object.create(u.defaultPropertyValues)}hasValue(u){return this._values[u].value!==void 0}getValue(u){return bt(this._values[u].value)}setValue(u,p){this._values[u]=new Zn(this._values[u].property,p===null?void 0:bt(p))}serialize(){const u={};for(const p of Object.keys(this._values)){const I=this.getValue(p);I!==void 0&&(u[p]=I)}return u}possiblyEvaluate(u,p,I){const L=new Lo(this._properties);for(const G of Object.keys(this._values))L._values[G]=this._values[G].possiblyEvaluate(u,p,I);return L}}class bs{constructor(u,p,I){this.property=u,this.value=p,this.parameters=I}isConstant(){return this.value.kind==="constant"}constantOr(u){return this.value.kind==="constant"?this.value.value:u}evaluate(u,p,I,L){return this.property.evaluate(this.value,this.parameters,u,p,I,L)}}class Lo{constructor(u){this._properties=u,this._values=Object.create(u.defaultPossiblyEvaluatedValues)}get(u){return this._values[u]}}class ki{constructor(u){this.specification=u}possiblyEvaluate(u,p){if(u.isDataDriven())throw new Error("Value should not be data driven");return u.expression.evaluate(p)}interpolate(u,p,I){const L=Zs[this.specification.type];return L?L(u,p,I):u}}class Li{constructor(u,p){this.specification=u,this.overrides=p}possiblyEvaluate(u,p,I,L){return new bs(this,u.expression.kind==="constant"||u.expression.kind==="camera"?{kind:"constant",value:u.expression.evaluate(p,null,{},I,L)}:u.expression,p)}interpolate(u,p,I){if(u.value.kind!=="constant"||p.value.kind!=="constant")return u;if(u.value.value===void 0||p.value.value===void 0)return new bs(this,{kind:"constant",value:void 0},u.parameters);const L=Zs[this.specification.type];if(L){const G=L(u.value.value,p.value.value,I);return new bs(this,{kind:"constant",value:G},u.parameters)}return u}evaluate(u,p,I,L,G,Q){return u.kind==="constant"?u.value:u.evaluate(p,I,L,G,Q)}}class ws extends Li{possiblyEvaluate(u,p,I,L){if(u.value===void 0)return new bs(this,{kind:"constant",value:void 0},p);if(u.expression.kind==="constant"){const G=u.expression.evaluate(p,null,{},I,L),Q=u.property.specification.type==="resolvedImage"&&typeof G!="string"?G.name:G,re=this._calculate(Q,Q,Q,p);return new bs(this,{kind:"constant",value:re},p)}if(u.expression.kind==="camera"){const G=this._calculate(u.expression.evaluate({zoom:p.zoom-1}),u.expression.evaluate({zoom:p.zoom}),u.expression.evaluate({zoom:p.zoom+1}),p);return new bs(this,{kind:"constant",value:G},p)}return new bs(this,u.expression,p)}evaluate(u,p,I,L,G,Q){if(u.kind==="source"){const re=u.evaluate(p,I,L,G,Q);return this._calculate(re,re,re,p)}return u.kind==="composite"?this._calculate(u.evaluate({zoom:Math.floor(p.zoom)-1},I,L),u.evaluate({zoom:Math.floor(p.zoom)},I,L),u.evaluate({zoom:Math.floor(p.zoom)+1},I,L),p):u.value}_calculate(u,p,I,L){return L.zoom>L.zoomHistory.lastIntegerZoom?{from:u,to:p}:{from:I,to:p}}interpolate(u){return u}}class vu{constructor(u){this.specification=u}possiblyEvaluate(u,p,I,L){if(u.value!==void 0){if(u.expression.kind==="constant"){const G=u.expression.evaluate(p,null,{},I,L);return this._calculate(G,G,G,p)}return this._calculate(u.expression.evaluate(new gn(Math.floor(p.zoom-1),p)),u.expression.evaluate(new gn(Math.floor(p.zoom),p)),u.expression.evaluate(new gn(Math.floor(p.zoom+1),p)),p)}}_calculate(u,p,I,L){return L.zoom>L.zoomHistory.lastIntegerZoom?{from:u,to:p}:{from:I,to:p}}interpolate(u){return u}}class Vo{constructor(u){this.specification=u}possiblyEvaluate(u,p,I,L){return!!u.expression.evaluate(p,null,{},I,L)}interpolate(){return!1}}class fs{constructor(u){this.properties=u,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const p in u){const I=u[p];I.specification.overridable&&this.overridableProperties.push(p);const L=this.defaultPropertyValues[p]=new Zn(I,void 0),G=this.defaultTransitionablePropertyValues[p]=new Jn(I);this.defaultTransitioningPropertyValues[p]=G.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=L.possiblyEvaluate({})}}}Pn("DataDrivenProperty",Li),Pn("DataConstantProperty",ki),Pn("CrossFadedDataDrivenProperty",ws),Pn("CrossFadedProperty",vu),Pn("ColorRampProperty",Vo);const hl="-transition";class Ds extends mr{constructor(u,p){if(super(),this.id=u.id,this.type=u.type,this._featureFilter={filter:()=>!0,needGeometry:!1},u.type!=="custom"&&(this.metadata=u.metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,u.type!=="background"&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),p.layout&&(this._unevaluatedLayout=new yu(p.layout)),p.paint)){this._transitionablePaint=new tl(p.paint);for(const I in u.paint)this.setPaintProperty(I,u.paint[I],{validate:!1});for(const I in u.layout)this.setLayoutProperty(I,u.layout[I],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Lo(p.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(u){return u==="visibility"?this.visibility:this._unevaluatedLayout.getValue(u)}setLayoutProperty(u,p,I={}){p!=null&&this._validate($u,`layers.${this.id}.layout.${u}`,u,p,I)||(u!=="visibility"?this._unevaluatedLayout.setValue(u,p):this.visibility=p)}getPaintProperty(u){return u.endsWith(hl)?this._transitionablePaint.getTransition(u.slice(0,-11)):this._transitionablePaint.getValue(u)}setPaintProperty(u,p,I={}){if(p!=null&&this._validate(os,`layers.${this.id}.paint.${u}`,u,p,I))return!1;if(u.endsWith(hl))return this._transitionablePaint.setTransition(u.slice(0,-11),p||void 0),!1;{const L=this._transitionablePaint._values[u],G=L.property.specification["property-type"]==="cross-faded-data-driven",Q=L.value.isDataDriven(),re=L.value;this._transitionablePaint.setValue(u,p),this._handleSpecialPaintPropertyUpdate(u);const Ae=this._transitionablePaint._values[u].value;return Ae.isDataDriven()||Q||G||this._handleOverridablePaintPropertyUpdate(u,re,Ae)}}_handleSpecialPaintPropertyUpdate(u){}_handleOverridablePaintPropertyUpdate(u,p,I){return!1}isHidden(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||this.visibility==="none"}updateTransitions(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(u,p){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,p)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,p)}serialize(){const u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),xt(u,(p,I)=>!(p===void 0||I==="layout"&&!Object.keys(p).length||I==="paint"&&!Object.keys(p).length))}_validate(u,p,I,L,G={}){return(!G||G.validate!==!1)&&Fu(this,u.call(Ja,{key:p,layerType:this.type,objectKey:I,value:L,styleSpec:ci,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const u in this.paint._values){const p=this.paint.get(u);if(p instanceof bs&&$a(p.property.specification)&&(p.value.kind==="source"||p.value.kind==="composite")&&p.value.isStateDependent)return!0}return!1}}const C={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class D{constructor(u,p){this._structArray=u,this._pos1=p*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class z{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(u,p){return u._trim(),p&&(u.isTransferred=!0,p.push(u.arrayBuffer)),{length:u.length,arrayBuffer:u.arrayBuffer}}static deserialize(u){const p=Object.create(this.prototype);return p.arrayBuffer=u.arrayBuffer,p.length=u.length,p.capacity=u.arrayBuffer.byteLength/p.bytesPerElement,p._refreshViews(),p}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(u){this.reserve(u),this.length=u}reserve(u){if(u>this.capacity){this.capacity=Math.max(u,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const p=this.uint8;this._refreshViews(),p&&this.uint8.set(p)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function R(f,u=1){let p=0,I=0;return{members:f.map(L=>{const G=C[L.type].BYTES_PER_ELEMENT,Q=p=ee(p,Math.max(u,G)),re=L.components||1;return I=Math.max(I,G),p+=G*re,{name:L.name,type:L.type,components:re,offset:Q}}),size:ee(p,Math.max(I,u)),alignment:u}}function ee(f,u){return Math.ceil(f/u)*u}class le extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p){const I=this.length;return this.resize(I+1),this.emplace(I,u,p)}emplace(u,p,I){const L=2*u;return this.int16[L+0]=p,this.int16[L+1]=I,u}}le.prototype.bytesPerElement=4,Pn("StructArrayLayout2i4",le);class oe extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,I){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,I)}emplace(u,p,I,L){const G=3*u;return this.int16[G+0]=p,this.int16[G+1]=I,this.int16[G+2]=L,u}}oe.prototype.bytesPerElement=6,Pn("StructArrayLayout3i6",oe);class we extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,I,L){const G=this.length;return this.resize(G+1),this.emplace(G,u,p,I,L)}emplace(u,p,I,L,G){const Q=4*u;return this.int16[Q+0]=p,this.int16[Q+1]=I,this.int16[Q+2]=L,this.int16[Q+3]=G,u}}we.prototype.bytesPerElement=8,Pn("StructArrayLayout4i8",we);class We extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,I,L,G,Q){const re=this.length;return this.resize(re+1),this.emplace(re,u,p,I,L,G,Q)}emplace(u,p,I,L,G,Q,re){const Ae=6*u;return this.int16[Ae+0]=p,this.int16[Ae+1]=I,this.int16[Ae+2]=L,this.int16[Ae+3]=G,this.int16[Ae+4]=Q,this.int16[Ae+5]=re,u}}We.prototype.bytesPerElement=12,Pn("StructArrayLayout2i4i12",We);class yt extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,I,L,G,Q){const re=this.length;return this.resize(re+1),this.emplace(re,u,p,I,L,G,Q)}emplace(u,p,I,L,G,Q,re){const Ae=4*u,_e=8*u;return this.int16[Ae+0]=p,this.int16[Ae+1]=I,this.uint8[_e+4]=L,this.uint8[_e+5]=G,this.uint8[_e+6]=Q,this.uint8[_e+7]=re,u}}yt.prototype.bytesPerElement=8,Pn("StructArrayLayout2i4ub8",yt);class Ct extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p){const I=this.length;return this.resize(I+1),this.emplace(I,u,p)}emplace(u,p,I){const L=2*u;return this.float32[L+0]=p,this.float32[L+1]=I,u}}Ct.prototype.bytesPerElement=8,Pn("StructArrayLayout2f8",Ct);class ri extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,I,L,G,Q,re,Ae,_e,Le){const qe=this.length;return this.resize(qe+1),this.emplace(qe,u,p,I,L,G,Q,re,Ae,_e,Le)}emplace(u,p,I,L,G,Q,re,Ae,_e,Le,qe){const tt=10*u;return this.uint16[tt+0]=p,this.uint16[tt+1]=I,this.uint16[tt+2]=L,this.uint16[tt+3]=G,this.uint16[tt+4]=Q,this.uint16[tt+5]=re,this.uint16[tt+6]=Ae,this.uint16[tt+7]=_e,this.uint16[tt+8]=Le,this.uint16[tt+9]=qe,u}}ri.prototype.bytesPerElement=20,Pn("StructArrayLayout10ui20",ri);class Gt extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,I,L,G,Q,re,Ae,_e,Le,qe,tt){const ft=this.length;return this.resize(ft+1),this.emplace(ft,u,p,I,L,G,Q,re,Ae,_e,Le,qe,tt)}emplace(u,p,I,L,G,Q,re,Ae,_e,Le,qe,tt,ft){const gt=12*u;return this.int16[gt+0]=p,this.int16[gt+1]=I,this.int16[gt+2]=L,this.int16[gt+3]=G,this.uint16[gt+4]=Q,this.uint16[gt+5]=re,this.uint16[gt+6]=Ae,this.uint16[gt+7]=_e,this.int16[gt+8]=Le,this.int16[gt+9]=qe,this.int16[gt+10]=tt,this.int16[gt+11]=ft,u}}Gt.prototype.bytesPerElement=24,Pn("StructArrayLayout4i4ui4i24",Gt);class Zt extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,I){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,I)}emplace(u,p,I,L){const G=3*u;return this.float32[G+0]=p,this.float32[G+1]=I,this.float32[G+2]=L,u}}Zt.prototype.bytesPerElement=12,Pn("StructArrayLayout3f12",Zt);class Z extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.uint32[1*u+0]=p,u}}Z.prototype.bytesPerElement=4,Pn("StructArrayLayout1ul4",Z);class A extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,I,L,G,Q,re,Ae,_e){const Le=this.length;return this.resize(Le+1),this.emplace(Le,u,p,I,L,G,Q,re,Ae,_e)}emplace(u,p,I,L,G,Q,re,Ae,_e,Le){const qe=10*u,tt=5*u;return this.int16[qe+0]=p,this.int16[qe+1]=I,this.int16[qe+2]=L,this.int16[qe+3]=G,this.int16[qe+4]=Q,this.int16[qe+5]=re,this.uint32[tt+3]=Ae,this.uint16[qe+8]=_e,this.uint16[qe+9]=Le,u}}A.prototype.bytesPerElement=20,Pn("StructArrayLayout6i1ul2ui20",A);class E extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,I,L,G,Q){const re=this.length;return this.resize(re+1),this.emplace(re,u,p,I,L,G,Q)}emplace(u,p,I,L,G,Q,re){const Ae=6*u;return this.int16[Ae+0]=p,this.int16[Ae+1]=I,this.int16[Ae+2]=L,this.int16[Ae+3]=G,this.int16[Ae+4]=Q,this.int16[Ae+5]=re,u}}E.prototype.bytesPerElement=12,Pn("StructArrayLayout2i2i2i12",E);class F extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,I,L,G){const Q=this.length;return this.resize(Q+1),this.emplace(Q,u,p,I,L,G)}emplace(u,p,I,L,G,Q){const re=4*u,Ae=8*u;return this.float32[re+0]=p,this.float32[re+1]=I,this.float32[re+2]=L,this.int16[Ae+6]=G,this.int16[Ae+7]=Q,u}}F.prototype.bytesPerElement=16,Pn("StructArrayLayout2f1f2i16",F);class O extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,I,L){const G=this.length;return this.resize(G+1),this.emplace(G,u,p,I,L)}emplace(u,p,I,L,G){const Q=12*u,re=3*u;return this.uint8[Q+0]=p,this.uint8[Q+1]=I,this.float32[re+1]=L,this.float32[re+2]=G,u}}O.prototype.bytesPerElement=12,Pn("StructArrayLayout2ub2f12",O);class y extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,I){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,I)}emplace(u,p,I,L){const G=3*u;return this.uint16[G+0]=p,this.uint16[G+1]=I,this.uint16[G+2]=L,u}}y.prototype.bytesPerElement=6,Pn("StructArrayLayout3ui6",y);class s extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,I,L,G,Q,re,Ae,_e,Le,qe,tt,ft,gt,Mt,Pt,Lt){const ei=this.length;return this.resize(ei+1),this.emplace(ei,u,p,I,L,G,Q,re,Ae,_e,Le,qe,tt,ft,gt,Mt,Pt,Lt)}emplace(u,p,I,L,G,Q,re,Ae,_e,Le,qe,tt,ft,gt,Mt,Pt,Lt,ei){const Ht=24*u,Qt=12*u,hi=48*u;return this.int16[Ht+0]=p,this.int16[Ht+1]=I,this.uint16[Ht+2]=L,this.uint16[Ht+3]=G,this.uint32[Qt+2]=Q,this.uint32[Qt+3]=re,this.uint32[Qt+4]=Ae,this.uint16[Ht+10]=_e,this.uint16[Ht+11]=Le,this.uint16[Ht+12]=qe,this.float32[Qt+7]=tt,this.float32[Qt+8]=ft,this.uint8[hi+36]=gt,this.uint8[hi+37]=Mt,this.uint8[hi+38]=Pt,this.uint32[Qt+10]=Lt,this.int16[Ht+22]=ei,u}}s.prototype.bytesPerElement=48,Pn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",s);class i extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,I,L,G,Q,re,Ae,_e,Le,qe,tt,ft,gt,Mt,Pt,Lt,ei,Ht,Qt,hi,_i,Xi,Sn,ln,on,fn,zn){const an=this.length;return this.resize(an+1),this.emplace(an,u,p,I,L,G,Q,re,Ae,_e,Le,qe,tt,ft,gt,Mt,Pt,Lt,ei,Ht,Qt,hi,_i,Xi,Sn,ln,on,fn,zn)}emplace(u,p,I,L,G,Q,re,Ae,_e,Le,qe,tt,ft,gt,Mt,Pt,Lt,ei,Ht,Qt,hi,_i,Xi,Sn,ln,on,fn,zn,an){const $i=32*u,Dn=16*u;return this.int16[$i+0]=p,this.int16[$i+1]=I,this.int16[$i+2]=L,this.int16[$i+3]=G,this.int16[$i+4]=Q,this.int16[$i+5]=re,this.int16[$i+6]=Ae,this.int16[$i+7]=_e,this.uint16[$i+8]=Le,this.uint16[$i+9]=qe,this.uint16[$i+10]=tt,this.uint16[$i+11]=ft,this.uint16[$i+12]=gt,this.uint16[$i+13]=Mt,this.uint16[$i+14]=Pt,this.uint16[$i+15]=Lt,this.uint16[$i+16]=ei,this.uint16[$i+17]=Ht,this.uint16[$i+18]=Qt,this.uint16[$i+19]=hi,this.uint16[$i+20]=_i,this.uint16[$i+21]=Xi,this.uint16[$i+22]=Sn,this.uint32[Dn+12]=ln,this.float32[Dn+13]=on,this.float32[Dn+14]=fn,this.uint16[$i+30]=zn,this.uint16[$i+31]=an,u}}i.prototype.bytesPerElement=64,Pn("StructArrayLayout8i15ui1ul2f2ui64",i);class r extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.float32[1*u+0]=p,u}}r.prototype.bytesPerElement=4,Pn("StructArrayLayout1f4",r);class l extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,I){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,I)}emplace(u,p,I,L){const G=3*u;return this.uint16[6*u+0]=p,this.float32[G+1]=I,this.float32[G+2]=L,u}}l.prototype.bytesPerElement=12,Pn("StructArrayLayout1ui2f12",l);class d extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,I){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,I)}emplace(u,p,I,L){const G=4*u;return this.uint32[2*u+0]=p,this.uint16[G+2]=I,this.uint16[G+3]=L,u}}d.prototype.bytesPerElement=8,Pn("StructArrayLayout1ul2ui8",d);class _ extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p){const I=this.length;return this.resize(I+1),this.emplace(I,u,p)}emplace(u,p,I){const L=2*u;return this.uint16[L+0]=p,this.uint16[L+1]=I,u}}_.prototype.bytesPerElement=4,Pn("StructArrayLayout2ui4",_);class w extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.uint16[1*u+0]=p,u}}w.prototype.bytesPerElement=2,Pn("StructArrayLayout1ui2",w);class T extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,I,L){const G=this.length;return this.resize(G+1),this.emplace(G,u,p,I,L)}emplace(u,p,I,L,G){const Q=4*u;return this.float32[Q+0]=p,this.float32[Q+1]=I,this.float32[Q+2]=L,this.float32[Q+3]=G,u}}T.prototype.bytesPerElement=16,Pn("StructArrayLayout4f16",T);class B extends D{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ce(this.anchorPointX,this.anchorPointY)}}B.prototype.size=20;class j extends A{get(u){return new B(this,u)}}Pn("CollisionBoxArray",j);class X extends D{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(u){this._structArray.uint8[this._pos1+37]=u}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(u){this._structArray.uint8[this._pos1+38]=u}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(u){this._structArray.uint32[this._pos4+10]=u}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}X.prototype.size=48;class ue extends s{get(u){return new X(this,u)}}Pn("PlacedSymbolArray",ue);class Se extends D{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(u){this._structArray.uint32[this._pos4+12]=u}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Se.prototype.size=64;class Te extends i{get(u){return new Se(this,u)}}Pn("SymbolInstanceArray",Te);class Re extends r{getoffsetX(u){return this.float32[1*u+0]}}Pn("GlyphOffsetArray",Re);class Be extends oe{getx(u){return this.int16[3*u+0]}gety(u){return this.int16[3*u+1]}gettileUnitDistanceFromAnchor(u){return this.int16[3*u+2]}}Pn("SymbolLineVertexArray",Be);class et extends D{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}et.prototype.size=12;class vt extends l{get(u){return new et(this,u)}}Pn("TextAnchorOffsetArray",vt);class ot extends D{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ot.prototype.size=8;class ht extends d{get(u){return new ot(this,u)}}Pn("FeatureIndexArray",ht);class Et extends le{}class wt extends le{}class si extends le{}class Kt extends We{}class ii extends yt{}class ai extends Ct{}class Zi extends ri{}class Qi extends Gt{}class Si extends Zt{}class Ui extends Z{}class Gi extends E{}class un extends O{}class Bn extends y{}class en extends _{}const kn=R([{name:"a_pos",components:2,type:"Int16"}],4),{members:vr}=kn;class er{constructor(u=[]){this.segments=u}prepareSegment(u,p,I,L){let G=this.segments[this.segments.length-1];return u>er.MAX_VERTEX_ARRAY_LENGTH&&$e(`Max vertices per segment is ${er.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${u}`),(!G||G.vertexLength+u>er.MAX_VERTEX_ARRAY_LENGTH||G.sortKey!==L)&&(G={vertexOffset:p.length,primitiveOffset:I.length,vertexLength:0,primitiveLength:0},L!==void 0&&(G.sortKey=L),this.segments.push(G)),G}get(){return this.segments}destroy(){for(const u of this.segments)for(const p in u.vaos)u.vaos[p].destroy()}static simpleSegment(u,p,I,L){return new er([{vertexOffset:u,primitiveOffset:p,vertexLength:I,primitiveLength:L,vaos:{},sortKey:0}])}}function Ca(f,u){return 256*(f=Oe(Math.floor(f),0,255))+Oe(Math.floor(u),0,255)}er.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Pn("SegmentVector",er);const fa=R([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var zs={exports:{}},oo={exports:{}};oo.exports=function(f,u){var p,I,L,G,Q,re,Ae,_e;for(I=f.length-(p=3&f.length),L=u,Q=3432918353,re=461845907,_e=0;_e<I;)Ae=255&f.charCodeAt(_e)|(255&f.charCodeAt(++_e))<<8|(255&f.charCodeAt(++_e))<<16|(255&f.charCodeAt(++_e))<<24,++_e,L=27492+(65535&(G=5*(65535&(L=(L^=Ae=(65535&(Ae=(Ae=(65535&Ae)*Q+(((Ae>>>16)*Q&65535)<<16)&4294967295)<<15|Ae>>>17))*re+(((Ae>>>16)*re&65535)<<16)&4294967295)<<13|L>>>19))+((5*(L>>>16)&65535)<<16)&4294967295))+((58964+(G>>>16)&65535)<<16);switch(Ae=0,p){case 3:Ae^=(255&f.charCodeAt(_e+2))<<16;case 2:Ae^=(255&f.charCodeAt(_e+1))<<8;case 1:L^=Ae=(65535&(Ae=(Ae=(65535&(Ae^=255&f.charCodeAt(_e)))*Q+(((Ae>>>16)*Q&65535)<<16)&4294967295)<<15|Ae>>>17))*re+(((Ae>>>16)*re&65535)<<16)&4294967295}return L^=f.length,L=2246822507*(65535&(L^=L>>>16))+((2246822507*(L>>>16)&65535)<<16)&4294967295,L=3266489909*(65535&(L^=L>>>13))+((3266489909*(L>>>16)&65535)<<16)&4294967295,(L^=L>>>16)>>>0};var lo=oo.exports,qr={exports:{}};qr.exports=function(f,u){for(var p,I=f.length,L=u^I,G=0;I>=4;)p=1540483477*(65535&(p=255&f.charCodeAt(G)|(255&f.charCodeAt(++G))<<8|(255&f.charCodeAt(++G))<<16|(255&f.charCodeAt(++G))<<24))+((1540483477*(p>>>16)&65535)<<16),L=1540483477*(65535&L)+((1540483477*(L>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),I-=4,++G;switch(I){case 3:L^=(255&f.charCodeAt(G+2))<<16;case 2:L^=(255&f.charCodeAt(G+1))<<8;case 1:L=1540483477*(65535&(L^=255&f.charCodeAt(G)))+((1540483477*(L>>>16)&65535)<<16)}return L=1540483477*(65535&(L^=L>>>13))+((1540483477*(L>>>16)&65535)<<16),(L^=L>>>15)>>>0};var ya=lo,xo=qr.exports;zs.exports=ya,zs.exports.murmur3=ya,zs.exports.murmur2=xo;var bo=W(zs.exports);class Qs{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(u,p,I,L){this.ids.push(rs(u)),this.positions.push(p,I,L)}getPositions(u){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const p=rs(u);let I=0,L=this.ids.length-1;for(;I<L;){const Q=I+L>>1;this.ids[Q]>=p?L=Q:I=Q+1}const G=[];for(;this.ids[I]===p;)G.push({index:this.positions[3*I],start:this.positions[3*I+1],end:this.positions[3*I+2]}),I++;return G}static serialize(u,p){const I=new Float64Array(u.ids),L=new Uint32Array(u.positions);return ss(I,L,0,I.length-1),p&&p.push(I.buffer,L.buffer),{ids:I,positions:L}}static deserialize(u){const p=new Qs;return p.ids=u.ids,p.positions=u.positions,p.indexed=!0,p}}function rs(f){const u=+f;return!isNaN(u)&&u<=Number.MAX_SAFE_INTEGER?u:bo(String(f))}function ss(f,u,p,I){for(;p<I;){const L=f[p+I>>1];let G=p-1,Q=I+1;for(;;){do G++;while(f[G]<L);do Q--;while(f[Q]>L);if(G>=Q)break;Rr(f,G,Q),Rr(u,3*G,3*Q),Rr(u,3*G+1,3*Q+1),Rr(u,3*G+2,3*Q+2)}Q-p<I-Q?(ss(f,u,p,Q),p=Q+1):(ss(f,u,Q+1,I),I=Q)}}function Rr(f,u,p){const I=f[u];f[u]=f[p],f[p]=I}Pn("FeaturePositionMap",Qs);class Ss{constructor(u,p){this.gl=u.gl,this.location=p}}class Ws extends Ss{constructor(u,p){super(u,p),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class Bo extends Ss{constructor(u,p){super(u,p),this.current=[0,0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))}}class Uo extends Ss{constructor(u,p){super(u,p),this.current=ji.transparent}set(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))}}const Go=new Float32Array(16);function Ec(f){return[Ca(255*f.r,255*f.g),Ca(255*f.b,255*f.a)]}class $s{constructor(u,p,I){this.value=u,this.uniformNames=p.map(L=>`u_${L}`),this.type=I}setUniform(u,p,I){u.set(I.constantOr(this.value))}getBinding(u,p,I){return this.type==="color"?new Uo(u,p):new Ws(u,p)}}class Yl{constructor(u,p){this.uniformNames=p.map(I=>`u_${I}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(u,p){this.pixelRatioFrom=p.pixelRatio,this.pixelRatioTo=u.pixelRatio,this.patternFrom=p.tlbr,this.patternTo=u.tlbr}setUniform(u,p,I,L){const G=L==="u_pattern_to"?this.patternTo:L==="u_pattern_from"?this.patternFrom:L==="u_pixel_ratio_to"?this.pixelRatioTo:L==="u_pixel_ratio_from"?this.pixelRatioFrom:null;G&&u.set(G)}getBinding(u,p,I){return I.substr(0,9)==="u_pattern"?new Bo(u,p):new Ws(u,p)}}class hu{constructor(u,p,I,L){this.expression=u,this.type=I,this.maxValue=0,this.paintVertexAttributes=p.map(G=>({name:`a_${G}`,type:"Float32",components:I==="color"?2:1,offset:0})),this.paintVertexArray=new L}populatePaintArray(u,p,I,L,G){const Q=this.paintVertexArray.length,re=this.expression.evaluate(new gn(0),p,{},L,[],G);this.paintVertexArray.resize(u),this._setPaintValue(Q,u,re)}updatePaintArray(u,p,I,L){const G=this.expression.evaluate({zoom:0},I,L);this._setPaintValue(u,p,G)}_setPaintValue(u,p,I){if(this.type==="color"){const L=Ec(I);for(let G=u;G<p;G++)this.paintVertexArray.emplace(G,L[0],L[1])}else{for(let L=u;L<p;L++)this.paintVertexArray.emplace(L,I);this.maxValue=Math.max(this.maxValue,Math.abs(I))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class il{constructor(u,p,I,L,G,Q){this.expression=u,this.uniformNames=p.map(re=>`u_${re}_t`),this.type=I,this.useIntegerZoom=L,this.zoom=G,this.maxValue=0,this.paintVertexAttributes=p.map(re=>({name:`a_${re}`,type:"Float32",components:I==="color"?4:2,offset:0})),this.paintVertexArray=new Q}populatePaintArray(u,p,I,L,G){const Q=this.expression.evaluate(new gn(this.zoom),p,{},L,[],G),re=this.expression.evaluate(new gn(this.zoom+1),p,{},L,[],G),Ae=this.paintVertexArray.length;this.paintVertexArray.resize(u),this._setPaintValue(Ae,u,Q,re)}updatePaintArray(u,p,I,L){const G=this.expression.evaluate({zoom:this.zoom},I,L),Q=this.expression.evaluate({zoom:this.zoom+1},I,L);this._setPaintValue(u,p,G,Q)}_setPaintValue(u,p,I,L){if(this.type==="color"){const G=Ec(I),Q=Ec(L);for(let re=u;re<p;re++)this.paintVertexArray.emplace(re,G[0],G[1],Q[0],Q[1])}else{for(let G=u;G<p;G++)this.paintVertexArray.emplace(G,I,L);this.maxValue=Math.max(this.maxValue,Math.abs(I),Math.abs(L))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(u,p){const I=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,L=Oe(this.expression.interpolationFactor(I,this.zoom,this.zoom+1),0,1);u.set(L)}getBinding(u,p,I){return new Ws(u,p)}}class vl{constructor(u,p,I,L,G,Q){this.expression=u,this.type=p,this.useIntegerZoom=I,this.zoom=L,this.layerId=Q,this.zoomInPaintVertexArray=new G,this.zoomOutPaintVertexArray=new G}populatePaintArray(u,p,I){const L=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(u),this.zoomOutPaintVertexArray.resize(u),this._setPaintValues(L,u,p.patterns&&p.patterns[this.layerId],I)}updatePaintArray(u,p,I,L,G){this._setPaintValues(u,p,I.patterns&&I.patterns[this.layerId],G)}_setPaintValues(u,p,I,L){if(!L||!I)return;const{min:G,mid:Q,max:re}=I,Ae=L[G],_e=L[Q],Le=L[re];if(Ae&&_e&&Le)for(let qe=u;qe<p;qe++)this.zoomInPaintVertexArray.emplace(qe,_e.tl[0],_e.tl[1],_e.br[0],_e.br[1],Ae.tl[0],Ae.tl[1],Ae.br[0],Ae.br[1],_e.pixelRatio,Ae.pixelRatio),this.zoomOutPaintVertexArray.emplace(qe,_e.tl[0],_e.tl[1],_e.br[0],_e.br[1],Le.tl[0],Le.tl[1],Le.br[0],Le.br[1],_e.pixelRatio,Le.pixelRatio)}upload(u){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=u.createVertexBuffer(this.zoomInPaintVertexArray,fa.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=u.createVertexBuffer(this.zoomOutPaintVertexArray,fa.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Pl{constructor(u,p,I){this.binders={},this._buffers=[];const L=[];for(const G in u.paint._values){if(!I(G))continue;const Q=u.paint.get(G);if(!(Q instanceof bs&&$a(Q.property.specification)))continue;const re=af(G,u.type),Ae=Q.value,_e=Q.property.specification.type,Le=Q.property.useIntegerZoom,qe=Q.property.specification["property-type"],tt=qe==="cross-faded"||qe==="cross-faded-data-driven";if(Ae.kind==="constant")this.binders[G]=tt?new Yl(Ae.value,re):new $s(Ae.value,re,_e),L.push(`/u_${G}`);else if(Ae.kind==="source"||tt){const ft=Vh(G,_e,"source");this.binders[G]=tt?new vl(Ae,_e,Le,p,ft,u.id):new hu(Ae,re,_e,ft),L.push(`/a_${G}`)}else{const ft=Vh(G,_e,"composite");this.binders[G]=new il(Ae,re,_e,Le,p,ft),L.push(`/z_${G}`)}}this.cacheKey=L.sort().join("")}getMaxValue(u){const p=this.binders[u];return p instanceof hu||p instanceof il?p.maxValue:0}populatePaintArrays(u,p,I,L,G){for(const Q in this.binders){const re=this.binders[Q];(re instanceof hu||re instanceof il||re instanceof vl)&&re.populatePaintArray(u,p,I,L,G)}}setConstantPatternPositions(u,p){for(const I in this.binders){const L=this.binders[I];L instanceof Yl&&L.setConstantPatternPositions(u,p)}}updatePaintArrays(u,p,I,L,G){let Q=!1;for(const re in u){const Ae=p.getPositions(re);for(const _e of Ae){const Le=I.feature(_e.index);for(const qe in this.binders){const tt=this.binders[qe];if((tt instanceof hu||tt instanceof il||tt instanceof vl)&&tt.expression.isStateDependent===!0){const ft=L.paint.get(qe);tt.expression=ft.value,tt.updatePaintArray(_e.start,_e.end,Le,u[re],G),Q=!0}}}}return Q}defines(){const u=[];for(const p in this.binders){const I=this.binders[p];(I instanceof $s||I instanceof Yl)&&u.push(...I.uniformNames.map(L=>`#define HAS_UNIFORM_${L}`))}return u}getBinderAttributes(){const u=[];for(const p in this.binders){const I=this.binders[p];if(I instanceof hu||I instanceof il)for(let L=0;L<I.paintVertexAttributes.length;L++)u.push(I.paintVertexAttributes[L].name);else if(I instanceof vl)for(let L=0;L<fa.members.length;L++)u.push(fa.members[L].name)}return u}getBinderUniforms(){const u=[];for(const p in this.binders){const I=this.binders[p];if(I instanceof $s||I instanceof Yl||I instanceof il)for(const L of I.uniformNames)u.push(L)}return u}getPaintVertexBuffers(){return this._buffers}getUniforms(u,p){const I=[];for(const L in this.binders){const G=this.binders[L];if(G instanceof $s||G instanceof Yl||G instanceof il){for(const Q of G.uniformNames)if(p[Q]){const re=G.getBinding(u,p[Q],Q);I.push({name:Q,property:L,binding:re})}}}return I}setUniforms(u,p,I,L){for(const{name:G,property:Q,binding:re}of p)this.binders[Q].setUniform(re,L,I.get(Q),G)}updatePaintBuffers(u){this._buffers=[];for(const p in this.binders){const I=this.binders[p];if(u&&I instanceof vl){const L=u.fromScale===2?I.zoomInPaintVertexBuffer:I.zoomOutPaintVertexBuffer;L&&this._buffers.push(L)}else(I instanceof hu||I instanceof il)&&I.paintVertexBuffer&&this._buffers.push(I.paintVertexBuffer)}}upload(u){for(const p in this.binders){const I=this.binders[p];(I instanceof hu||I instanceof il||I instanceof vl)&&I.upload(u)}this.updatePaintBuffers()}destroy(){for(const u in this.binders){const p=this.binders[u];(p instanceof hu||p instanceof il||p instanceof vl)&&p.destroy()}}}class Au{constructor(u,p,I=()=>!0){this.programConfigurations={};for(const L of u)this.programConfigurations[L.id]=new Pl(L,p,I);this.needsUpload=!1,this._featureMap=new Qs,this._bufferOffset=0}populatePaintArrays(u,p,I,L,G,Q){for(const re in this.programConfigurations)this.programConfigurations[re].populatePaintArrays(u,p,L,G,Q);p.id!==void 0&&this._featureMap.add(p.id,I,this._bufferOffset,u),this._bufferOffset=u,this.needsUpload=!0}updatePaintArrays(u,p,I,L){for(const G of I)this.needsUpload=this.programConfigurations[G.id].updatePaintArrays(u,this._featureMap,p,G,L)||this.needsUpload}get(u){return this.programConfigurations[u]}upload(u){if(this.needsUpload){for(const p in this.programConfigurations)this.programConfigurations[p].upload(u);this.needsUpload=!1}}destroy(){for(const u in this.programConfigurations)this.programConfigurations[u].destroy()}}function af(f,u){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[f]||[f.replace(`${u}-`,"").replace(/-/g,"_")]}function Vh(f,u,p){const I={color:{source:Ct,composite:T},number:{source:r,composite:Ct}},L=function(G){return{"line-pattern":{source:Zi,composite:Zi},"fill-pattern":{source:Zi,composite:Zi},"fill-extrusion-pattern":{source:Zi,composite:Zi}}[G]}(f);return L&&L[p]||I[u][p]}Pn("ConstantBinder",$s),Pn("CrossFadedConstantBinder",Yl),Pn("SourceExpressionBinder",hu),Pn("CrossFadedCompositeBinder",vl),Pn("CompositeExpressionBinder",il),Pn("ProgramConfiguration",Pl,{omit:["_buffers"]}),Pn("ProgramConfigurationSet",Au);const La=8192,pA=Math.pow(2,14)-1,yh=-pA-1;function Uh(f){const u=La/f.extent,p=f.loadGeometry();for(let I=0;I<p.length;I++){const L=p[I];for(let G=0;G<L.length;G++){const Q=L[G],re=Math.round(Q.x*u),Ae=Math.round(Q.y*u);Q.x=Oe(re,yh,pA),Q.y=Oe(Ae,yh,pA),(re<Q.x||re>Q.x+1||Ae<Q.y||Ae>Q.y+1)&&$e("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return p}function Cc(f,u){return{type:f.type,id:f.id,properties:f.properties,geometry:u?Uh(f):[]}}function Gh(f,u,p,I,L){f.emplaceBack(2*u+(I+1)/2,2*p+(L+1)/2)}class h0{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new wt,this.indexArray=new Bn,this.segments=new er,this.programConfigurations=new Au(u.layers,u.zoom),this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,I){const L=this.layers[0],G=[];let Q=null,re=!1;L.type==="circle"&&(Q=L.layout.get("circle-sort-key"),re=!Q.isConstant());for(const{feature:Ae,id:_e,index:Le,sourceLayerIndex:qe}of u){const tt=this.layers[0]._featureFilter.needGeometry,ft=Cc(Ae,tt);if(!this.layers[0]._featureFilter.filter(new gn(this.zoom),ft,I))continue;const gt=re?Q.evaluate(ft,{},I):void 0,Mt={id:_e,properties:Ae.properties,type:Ae.type,sourceLayerIndex:qe,index:Le,geometry:tt?ft.geometry:Uh(Ae),patterns:{},sortKey:gt};G.push(Mt)}re&&G.sort((Ae,_e)=>Ae.sortKey-_e.sortKey);for(const Ae of G){const{geometry:_e,index:Le,sourceLayerIndex:qe}=Ae,tt=u[Le].feature;this.addFeature(Ae,_e,Le,I),p.featureIndex.insert(tt,_e,Le,qe,this.index)}}update(u,p,I){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,I)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,vr),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(u,p,I,L){for(const G of p)for(const Q of G){const re=Q.x,Ae=Q.y;if(re<0||re>=La||Ae<0||Ae>=La)continue;const _e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,u.sortKey),Le=_e.vertexLength;Gh(this.layoutVertexArray,re,Ae,-1,-1),Gh(this.layoutVertexArray,re,Ae,1,-1),Gh(this.layoutVertexArray,re,Ae,1,1),Gh(this.layoutVertexArray,re,Ae,-1,1),this.indexArray.emplaceBack(Le,Le+1,Le+2),this.indexArray.emplaceBack(Le,Le+3,Le+2),_e.vertexLength+=4,_e.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,I,{},L)}}function Xc(f,u){for(let p=0;p<f.length;p++)if(Yu(u,f[p]))return!0;for(let p=0;p<u.length;p++)if(Yu(f,u[p]))return!0;return!!Yc(f,u)}function _p(f,u,p){return!!Yu(f,u)||!!lf(u,f,p)}function qh(f,u){if(f.length===1)return Kl(u,f[0]);for(let p=0;p<u.length;p++){const I=u[p];for(let L=0;L<I.length;L++)if(Yu(f,I[L]))return!0}for(let p=0;p<f.length;p++)if(Kl(u,f[p]))return!0;for(let p=0;p<u.length;p++)if(Yc(f,u[p]))return!0;return!1}function of(f,u,p){if(f.length>1){if(Yc(f,u))return!0;for(let I=0;I<u.length;I++)if(lf(u[I],f,p))return!0}for(let I=0;I<f.length;I++)if(lf(f[I],u,p))return!0;return!1}function Yc(f,u){if(f.length===0||u.length===0)return!1;for(let p=0;p<f.length-1;p++){const I=f[p],L=f[p+1];for(let G=0;G<u.length-1;G++)if(yp(I,L,u[G],u[G+1]))return!0}return!1}function yp(f,u,p,I){return pt(f,p,I)!==pt(u,p,I)&&pt(f,u,p)!==pt(f,u,I)}function lf(f,u,p){const I=p*p;if(u.length===1)return f.distSqr(u[0])<I;for(let L=1;L<u.length;L++)if(j0(f,u[L-1],u[L])<I)return!0;return!1}function j0(f,u,p){const I=u.distSqr(p);if(I===0)return f.distSqr(u);const L=((f.x-u.x)*(p.x-u.x)+(f.y-u.y)*(p.y-u.y))/I;return f.distSqr(L<0?u:L>1?p:p.sub(u)._mult(L)._add(u))}function Kl(f,u){let p,I,L,G=!1;for(let Q=0;Q<f.length;Q++){p=f[Q];for(let re=0,Ae=p.length-1;re<p.length;Ae=re++)I=p[re],L=p[Ae],I.y>u.y!=L.y>u.y&&u.x<(L.x-I.x)*(u.y-I.y)/(L.y-I.y)+I.x&&(G=!G)}return G}function Yu(f,u){let p=!1;for(let I=0,L=f.length-1;I<f.length;L=I++){const G=f[I],Q=f[L];G.y>u.y!=Q.y>u.y&&u.x<(Q.x-G.x)*(u.y-G.y)/(Q.y-G.y)+G.x&&(p=!p)}return p}function Z0(f,u,p){const I=p[0],L=p[2];if(f.x<I.x&&u.x<I.x||f.x>L.x&&u.x>L.x||f.y<I.y&&u.y<I.y||f.y>L.y&&u.y>L.y)return!1;const G=pt(f,u,p[0]);return G!==pt(f,u,p[1])||G!==pt(f,u,p[2])||G!==pt(f,u,p[3])}function vh(f,u,p){const I=u.paint.get(f).value;return I.kind==="constant"?I.value:p.programConfigurations.get(u.id).getMaxValue(f)}function Kc(f){return Math.sqrt(f[0]*f[0]+f[1]*f[1])}function mA(f,u,p,I,L){if(!u[0]&&!u[1])return f;const G=ce.convert(u)._mult(L);p==="viewport"&&G._rotate(-I);const Q=[];for(let re=0;re<f.length;re++)Q.push(f[re].sub(G));return Q}let uf,A0;Pn("CircleBucket",h0,{omit:["layers"]});var _s={get paint(){return A0=A0||new fs({"circle-radius":new Li(ci.paint_circle["circle-radius"]),"circle-color":new Li(ci.paint_circle["circle-color"]),"circle-blur":new Li(ci.paint_circle["circle-blur"]),"circle-opacity":new Li(ci.paint_circle["circle-opacity"]),"circle-translate":new ki(ci.paint_circle["circle-translate"]),"circle-translate-anchor":new ki(ci.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ki(ci.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ki(ci.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Li(ci.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Li(ci.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Li(ci.paint_circle["circle-stroke-opacity"])})},get layout(){return uf=uf||new fs({"circle-sort-key":new Li(ci.layout_circle["circle-sort-key"])})}},Jl=1e-6,Hh=typeof Float32Array<"u"?Float32Array:Array;function jh(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function cf(f,u,p){var I=u[0],L=u[1],G=u[2],Q=u[3],re=u[4],Ae=u[5],_e=u[6],Le=u[7],qe=u[8],tt=u[9],ft=u[10],gt=u[11],Mt=u[12],Pt=u[13],Lt=u[14],ei=u[15],Ht=p[0],Qt=p[1],hi=p[2],_i=p[3];return f[0]=Ht*I+Qt*re+hi*qe+_i*Mt,f[1]=Ht*L+Qt*Ae+hi*tt+_i*Pt,f[2]=Ht*G+Qt*_e+hi*ft+_i*Lt,f[3]=Ht*Q+Qt*Le+hi*gt+_i*ei,f[4]=(Ht=p[4])*I+(Qt=p[5])*re+(hi=p[6])*qe+(_i=p[7])*Mt,f[5]=Ht*L+Qt*Ae+hi*tt+_i*Pt,f[6]=Ht*G+Qt*_e+hi*ft+_i*Lt,f[7]=Ht*Q+Qt*Le+hi*gt+_i*ei,f[8]=(Ht=p[8])*I+(Qt=p[9])*re+(hi=p[10])*qe+(_i=p[11])*Mt,f[9]=Ht*L+Qt*Ae+hi*tt+_i*Pt,f[10]=Ht*G+Qt*_e+hi*ft+_i*Lt,f[11]=Ht*Q+Qt*Le+hi*gt+_i*ei,f[12]=(Ht=p[12])*I+(Qt=p[13])*re+(hi=p[14])*qe+(_i=p[15])*Mt,f[13]=Ht*L+Qt*Ae+hi*tt+_i*Pt,f[14]=Ht*G+Qt*_e+hi*ft+_i*Lt,f[15]=Ht*Q+Qt*Le+hi*gt+_i*ei,f}Math.hypot||(Math.hypot=function(){for(var f=0,u=arguments.length;u--;)f+=arguments[u]*arguments[u];return Math.sqrt(f)});var gA,Q0=cf;function Dl(f,u,p){var I=u[0],L=u[1],G=u[2],Q=u[3];return f[0]=p[0]*I+p[4]*L+p[8]*G+p[12]*Q,f[1]=p[1]*I+p[5]*L+p[9]*G+p[13]*Q,f[2]=p[2]*I+p[6]*L+p[10]*G+p[14]*Q,f[3]=p[3]*I+p[7]*L+p[11]*G+p[15]*Q,f}gA=new Hh(4),Hh!=Float32Array&&(gA[0]=0,gA[1]=0,gA[2]=0,gA[3]=0);class Uu extends Ds{constructor(u){super(u,_s)}createBucket(u){return new h0(u)}queryRadius(u){const p=u;return vh("circle-radius",this,p)+vh("circle-stroke-width",this,p)+Kc(this.paint.get("circle-translate"))}queryIntersectsFeature(u,p,I,L,G,Q,re,Ae){const _e=mA(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),Q.angle,re),Le=this.paint.get("circle-radius").evaluate(p,I)+this.paint.get("circle-stroke-width").evaluate(p,I),qe=this.paint.get("circle-pitch-alignment")==="map",tt=qe?_e:function(gt,Mt){return gt.map(Pt=>_A(Pt,Mt))}(_e,Ae),ft=qe?Le*re:Le;for(const gt of L)for(const Mt of gt){const Pt=qe?Mt:_A(Mt,Ae);let Lt=ft;const ei=Dl([],[Mt.x,Mt.y,0,1],Ae);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Lt*=ei[3]/Q.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Lt*=Q.cameraToCenterDistance/ei[3]),_p(tt,Pt,Lt))return!0}return!1}}function _A(f,u){const p=Dl([],[f.x,f.y,0,1],u);return new ce(p[0]/p[3],p[1]/p[3])}class f0 extends h0{}let d0;Pn("HeatmapBucket",f0,{omit:["layers"]});var vp={get paint(){return d0=d0||new fs({"heatmap-radius":new Li(ci.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Li(ci.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ki(ci.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Vo(ci.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ki(ci.paint_heatmap["heatmap-opacity"])})}};function xu(f,{width:u,height:p},I,L){if(L){if(L instanceof Uint8ClampedArray)L=new Uint8Array(L.buffer);else if(L.length!==u*p*I)throw new RangeError(`mismatched image size. expected: ${L.length} but got: ${u*p*I}`)}else L=new Uint8Array(u*p*I);return f.width=u,f.height=p,f.data=L,f}function Jc(f,{width:u,height:p},I){if(u===f.width&&p===f.height)return;const L=xu({},{width:u,height:p},I);hf(f,L,{x:0,y:0},{x:0,y:0},{width:Math.min(f.width,u),height:Math.min(f.height,p)},I),f.width=u,f.height=p,f.data=L.data}function hf(f,u,p,I,L,G){if(L.width===0||L.height===0)return u;if(L.width>f.width||L.height>f.height||p.x>f.width-L.width||p.y>f.height-L.height)throw new RangeError("out of range source coordinates for image copy");if(L.width>u.width||L.height>u.height||I.x>u.width-L.width||I.y>u.height-L.height)throw new RangeError("out of range destination coordinates for image copy");const Q=f.data,re=u.data;if(Q===re)throw new Error("srcData equals dstData, so image is already copied");for(let Ae=0;Ae<L.height;Ae++){const _e=((p.y+Ae)*f.width+p.x)*G,Le=((I.y+Ae)*u.width+I.x)*G;for(let qe=0;qe<L.width*G;qe++)re[Le+qe]=Q[_e+qe]}return u}class xh{constructor(u,p){xu(this,u,1,p)}resize(u){Jc(this,u,1)}clone(){return new xh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,p,I,L,G){hf(u,p,I,L,G,1)}}class Ll{constructor(u,p){xu(this,u,4,p)}resize(u){Jc(this,u,4)}replace(u,p){p?this.data.set(u):this.data=u instanceof Uint8ClampedArray?new Uint8Array(u.buffer):u}clone(){return new Ll({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,p,I,L,G){hf(u,p,I,L,G,4)}}function p0(f){const u={},p=f.resolution||256,I=f.clips?f.clips.length:1,L=f.image||new Ll({width:p,height:I});if(Math.log(p)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${p}`);const G=(Q,re,Ae)=>{u[f.evaluationKey]=Ae;const _e=f.expression.evaluate(u);L.data[Q+re+0]=Math.floor(255*_e.r/_e.a),L.data[Q+re+1]=Math.floor(255*_e.g/_e.a),L.data[Q+re+2]=Math.floor(255*_e.b/_e.a),L.data[Q+re+3]=Math.floor(255*_e.a)};if(f.clips)for(let Q=0,re=0;Q<I;++Q,re+=4*p)for(let Ae=0,_e=0;Ae<p;Ae++,_e+=4){const Le=Ae/(p-1),{start:qe,end:tt}=f.clips[Q];G(re,_e,qe*(1-Le)+tt*Le)}else for(let Q=0,re=0;Q<p;Q++,re+=4)G(0,re,Q/(p-1));return L}Pn("AlphaImage",xh),Pn("RGBAImage",Ll);class eh extends Ds{createBucket(u){return new f0(u)}constructor(u){super(u,vp),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=p0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Zh;var W0={get paint(){return Zh=Zh||new fs({"hillshade-illumination-direction":new ki(ci.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ki(ci.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ki(ci.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ki(ci.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ki(ci.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ki(ci.paint_hillshade["hillshade-accent-color"])})}};class $0 extends Ds{constructor(u){super(u,W0)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const bh=R([{name:"a_pos",components:2,type:"Int16"}],4),{members:Tm}=bh;var Tc={exports:{}};function Af(f,u,p){p=p||2;var I,L,G,Q,re,Ae,_e,Le=u&&u.length,qe=Le?u[0]*p:f.length,tt=X0(f,0,qe,p,!0),ft=[];if(!tt||tt.next===tt.prev)return ft;if(Le&&(tt=function(Mt,Pt,Lt,ei){var Ht,Qt,hi,_i=[];for(Ht=0,Qt=Pt.length;Ht<Qt;Ht++)(hi=X0(Mt,Pt[Ht]*ei,Ht<Qt-1?Pt[Ht+1]*ei:Mt.length,ei,!1))===hi.next&&(hi.steiner=!0),_i.push(uc(hi));for(_i.sort(xp),Ht=0;Ht<_i.length;Ht++)Lt=pf(_i[Ht],Lt);return Lt}(f,u,tt,p)),f.length>80*p){I=G=f[0],L=Q=f[1];for(var gt=p;gt<qe;gt+=p)(re=f[gt])<I&&(I=re),(Ae=f[gt+1])<L&&(L=Ae),re>G&&(G=re),Ae>Q&&(Q=Ae);_e=(_e=Math.max(G-I,Q-L))!==0?32767/_e:0}return ff(tt,ft,p,I,L,_e,0),ft}function X0(f,u,p,I,L){var G,Q;if(L===xA(f,u,p,I)>0)for(G=u;G<p;G+=I)Q=wh(G,f[G],f[G+1],Q);else for(G=p-I;G>=u;G-=I)Q=wh(G,f[G],f[G+1],Q);return Q&&cc(Q,Q.next)&&(vf(Q),Q=Q.next),Q}function lc(f,u){if(!f)return f;u||(u=f);var p,I=f;do if(p=!1,I.steiner||!cc(I,I.next)&&Ba(I.prev,I,I.next)!==0)I=I.next;else{if(vf(I),(I=u=I.prev)===I.next)break;p=!0}while(p||I!==u);return u}function ff(f,u,p,I,L,G,Q){if(f){!Q&&G&&function(Le,qe,tt,ft){var gt=Le;do gt.z===0&&(gt.z=xl(gt.x,gt.y,qe,tt,ft)),gt.prevZ=gt.prev,gt.nextZ=gt.next,gt=gt.next;while(gt!==Le);gt.prevZ.nextZ=null,gt.prevZ=null,function(Mt){var Pt,Lt,ei,Ht,Qt,hi,_i,Xi,Sn=1;do{for(Lt=Mt,Mt=null,Qt=null,hi=0;Lt;){for(hi++,ei=Lt,_i=0,Pt=0;Pt<Sn&&(_i++,ei=ei.nextZ);Pt++);for(Xi=Sn;_i>0||Xi>0&&ei;)_i!==0&&(Xi===0||!ei||Lt.z<=ei.z)?(Ht=Lt,Lt=Lt.nextZ,_i--):(Ht=ei,ei=ei.nextZ,Xi--),Qt?Qt.nextZ=Ht:Mt=Ht,Ht.prevZ=Qt,Qt=Ht;Lt=ei}Qt.nextZ=null,Sn*=2}while(hi>1)}(gt)}(f,I,L,G);for(var re,Ae,_e=f;f.prev!==f.next;)if(re=f.prev,Ae=f.next,G?km(f,I,L,G):yA(f))u.push(re.i/p|0),u.push(f.i/p|0),u.push(Ae.i/p|0),vf(f),f=Ae.next,_e=Ae.next;else if((f=Ae)===_e){Q?Q===1?ff(f=zo(lc(f),u,p),u,p,I,L,G,2):Q===2&&df(f,u,p,I,L,G):ff(lc(f),u,p,I,L,G,1);break}}}function yA(f){var u=f.prev,p=f,I=f.next;if(Ba(u,p,I)>=0)return!1;for(var L=u.x,G=p.x,Q=I.x,re=u.y,Ae=p.y,_e=I.y,Le=L<G?L<Q?L:Q:G<Q?G:Q,qe=re<Ae?re<_e?re:_e:Ae<_e?Ae:_e,tt=L>G?L>Q?L:Q:G>Q?G:Q,ft=re>Ae?re>_e?re:_e:Ae>_e?Ae:_e,gt=I.next;gt!==u;){if(gt.x>=Le&&gt.x<=tt&&gt.y>=qe&&gt.y<=ft&&Qh(L,re,G,Ae,Q,_e,gt.x,gt.y)&&Ba(gt.prev,gt,gt.next)>=0)return!1;gt=gt.next}return!0}function km(f,u,p,I){var L=f.prev,G=f,Q=f.next;if(Ba(L,G,Q)>=0)return!1;for(var re=L.x,Ae=G.x,_e=Q.x,Le=L.y,qe=G.y,tt=Q.y,ft=re<Ae?re<_e?re:_e:Ae<_e?Ae:_e,gt=Le<qe?Le<tt?Le:tt:qe<tt?qe:tt,Mt=re>Ae?re>_e?re:_e:Ae>_e?Ae:_e,Pt=Le>qe?Le>tt?Le:tt:qe>tt?qe:tt,Lt=xl(ft,gt,u,p,I),ei=xl(Mt,Pt,u,p,I),Ht=f.prevZ,Qt=f.nextZ;Ht&&Ht.z>=Lt&&Qt&&Qt.z<=ei;){if(Ht.x>=ft&&Ht.x<=Mt&&Ht.y>=gt&&Ht.y<=Pt&&Ht!==L&&Ht!==Q&&Qh(re,Le,Ae,qe,_e,tt,Ht.x,Ht.y)&&Ba(Ht.prev,Ht,Ht.next)>=0||(Ht=Ht.prevZ,Qt.x>=ft&&Qt.x<=Mt&&Qt.y>=gt&&Qt.y<=Pt&&Qt!==L&&Qt!==Q&&Qh(re,Le,Ae,qe,_e,tt,Qt.x,Qt.y)&&Ba(Qt.prev,Qt,Qt.next)>=0))return!1;Qt=Qt.nextZ}for(;Ht&&Ht.z>=Lt;){if(Ht.x>=ft&&Ht.x<=Mt&&Ht.y>=gt&&Ht.y<=Pt&&Ht!==L&&Ht!==Q&&Qh(re,Le,Ae,qe,_e,tt,Ht.x,Ht.y)&&Ba(Ht.prev,Ht,Ht.next)>=0)return!1;Ht=Ht.prevZ}for(;Qt&&Qt.z<=ei;){if(Qt.x>=ft&&Qt.x<=Mt&&Qt.y>=gt&&Qt.y<=Pt&&Qt!==L&&Qt!==Q&&Qh(re,Le,Ae,qe,_e,tt,Qt.x,Qt.y)&&Ba(Qt.prev,Qt,Qt.next)>=0)return!1;Qt=Qt.nextZ}return!0}function zo(f,u,p){var I=f;do{var L=I.prev,G=I.next.next;!cc(L,G)&&m0(L,I,I.next,G)&&kc(L,G)&&kc(G,L)&&(u.push(L.i/p|0),u.push(I.i/p|0),u.push(G.i/p|0),vf(I),vf(I.next),I=f=G),I=I.next}while(I!==f);return lc(I)}function df(f,u,p,I,L,G){var Q=f;do{for(var re=Q.next.next;re!==Q.prev;){if(Q.i!==re.i&&gf(Q,re)){var Ae=Wh(Q,re);return Q=lc(Q,Q.next),Ae=lc(Ae,Ae.next),ff(Q,u,p,I,L,G,0),void ff(Ae,u,p,I,L,G,0)}re=re.next}Q=Q.next}while(Q!==f)}function xp(f,u){return f.x-u.x}function pf(f,u){var p=function(L,G){var Q,re=G,Ae=L.x,_e=L.y,Le=-1/0;do{if(_e<=re.y&&_e>=re.next.y&&re.next.y!==re.y){var qe=re.x+(_e-re.y)*(re.next.x-re.x)/(re.next.y-re.y);if(qe<=Ae&&qe>Le&&(Le=qe,Q=re.x<re.next.x?re:re.next,qe===Ae))return Q}re=re.next}while(re!==G);if(!Q)return null;var tt,ft=Q,gt=Q.x,Mt=Q.y,Pt=1/0;re=Q;do Ae>=re.x&&re.x>=gt&&Ae!==re.x&&Qh(_e<Mt?Ae:Le,_e,gt,Mt,_e<Mt?Le:Ae,_e,re.x,re.y)&&(tt=Math.abs(_e-re.y)/(Ae-re.x),kc(re,L)&&(tt<Pt||tt===Pt&&(re.x>Q.x||re.x===Q.x&&mf(Q,re)))&&(Q=re,Pt=tt)),re=re.next;while(re!==ft);return Q}(f,u);if(!p)return u;var I=Wh(p,f);return lc(I,I.next),lc(p,p.next)}function mf(f,u){return Ba(f.prev,f,u.prev)<0&&Ba(u.next,f,f.next)<0}function xl(f,u,p,I,L){return(f=1431655765&((f=858993459&((f=252645135&((f=16711935&((f=(f-p)*L|0)|f<<8))|f<<4))|f<<2))|f<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-I)*L|0)|u<<8))|u<<4))|u<<2))|u<<1))<<1}function uc(f){var u=f,p=f;do(u.x<p.x||u.x===p.x&&u.y<p.y)&&(p=u),u=u.next;while(u!==f);return p}function Qh(f,u,p,I,L,G,Q,re){return(L-Q)*(u-re)>=(f-Q)*(G-re)&&(f-Q)*(I-re)>=(p-Q)*(u-re)&&(p-Q)*(G-re)>=(L-Q)*(I-re)}function gf(f,u){return f.next.i!==u.i&&f.prev.i!==u.i&&!function(p,I){var L=p;do{if(L.i!==p.i&&L.next.i!==p.i&&L.i!==I.i&&L.next.i!==I.i&&m0(L,L.next,p,I))return!0;L=L.next}while(L!==p);return!1}(f,u)&&(kc(f,u)&&kc(u,f)&&function(p,I){var L=p,G=!1,Q=(p.x+I.x)/2,re=(p.y+I.y)/2;do L.y>re!=L.next.y>re&&L.next.y!==L.y&&Q<(L.next.x-L.x)*(re-L.y)/(L.next.y-L.y)+L.x&&(G=!G),L=L.next;while(L!==p);return G}(f,u)&&(Ba(f.prev,f,u.prev)||Ba(f,u.prev,u))||cc(f,u)&&Ba(f.prev,f,f.next)>0&&Ba(u.prev,u,u.next)>0)}function Ba(f,u,p){return(u.y-f.y)*(p.x-u.x)-(u.x-f.x)*(p.y-u.y)}function cc(f,u){return f.x===u.x&&f.y===u.y}function m0(f,u,p,I){var L=yf(Ba(f,u,p)),G=yf(Ba(f,u,I)),Q=yf(Ba(p,I,f)),re=yf(Ba(p,I,u));return L!==G&&Q!==re||!(L!==0||!_f(f,p,u))||!(G!==0||!_f(f,I,u))||!(Q!==0||!_f(p,f,I))||!(re!==0||!_f(p,u,I))}function _f(f,u,p){return u.x<=Math.max(f.x,p.x)&&u.x>=Math.min(f.x,p.x)&&u.y<=Math.max(f.y,p.y)&&u.y>=Math.min(f.y,p.y)}function yf(f){return f>0?1:f<0?-1:0}function kc(f,u){return Ba(f.prev,f,f.next)<0?Ba(f,u,f.next)>=0&&Ba(f,f.prev,u)>=0:Ba(f,u,f.prev)<0||Ba(f,f.next,u)<0}function Wh(f,u){var p=new vA(f.i,f.x,f.y),I=new vA(u.i,u.x,u.y),L=f.next,G=u.prev;return f.next=u,u.prev=f,p.next=L,L.prev=p,I.next=p,p.prev=I,G.next=I,I.prev=G,I}function wh(f,u,p,I){var L=new vA(f,u,p);return I?(L.next=I.next,L.prev=I,I.next.prev=L,I.next=L):(L.prev=L,L.next=L),L}function vf(f){f.next.prev=f.prev,f.prev.next=f.next,f.prevZ&&(f.prevZ.nextZ=f.nextZ),f.nextZ&&(f.nextZ.prevZ=f.prevZ)}function vA(f,u,p){this.i=f,this.x=u,this.y=p,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function xA(f,u,p,I){for(var L=0,G=u,Q=p-I;G<p;G+=I)L+=(f[Q]-f[G])*(f[G+1]+f[Q+1]),Q=G;return L}Tc.exports=Af,Tc.exports.default=Af,Af.deviation=function(f,u,p,I){var L=u&&u.length,G=Math.abs(xA(f,0,L?u[0]*p:f.length,p));if(L)for(var Q=0,re=u.length;Q<re;Q++)G-=Math.abs(xA(f,u[Q]*p,Q<re-1?u[Q+1]*p:f.length,p));var Ae=0;for(Q=0;Q<I.length;Q+=3){var _e=I[Q]*p,Le=I[Q+1]*p,qe=I[Q+2]*p;Ae+=Math.abs((f[_e]-f[qe])*(f[Le+1]-f[_e+1])-(f[_e]-f[Le])*(f[qe+1]-f[_e+1]))}return G===0&&Ae===0?0:Math.abs((Ae-G)/G)},Af.flatten=function(f){for(var u=f[0][0].length,p={vertices:[],holes:[],dimensions:u},I=0,L=0;L<f.length;L++){for(var G=0;G<f[L].length;G++)for(var Q=0;Q<u;Q++)p.vertices.push(f[L][G][Q]);L>0&&p.holes.push(I+=f[L-1].length)}return p};var $h=W(Tc.exports);function Y0(f,u,p,I,L){bA(f,u,p||0,I||f.length-1,L||g0)}function bA(f,u,p,I,L){for(;I>p;){if(I-p>600){var G=I-p+1,Q=u-p+1,re=Math.log(G),Ae=.5*Math.exp(2*re/3),_e=.5*Math.sqrt(re*Ae*(G-Ae)/G)*(Q-G/2<0?-1:1);bA(f,u,Math.max(p,Math.floor(u-Q*Ae/G+_e)),Math.min(I,Math.floor(u+(G-Q)*Ae/G+_e)),L)}var Le=f[u],qe=p,tt=I;for(Xh(f,p,u),L(f[I],Le)>0&&Xh(f,p,I);qe<tt;){for(Xh(f,qe,tt),qe++,tt--;L(f[qe],Le)<0;)qe++;for(;L(f[tt],Le)>0;)tt--}L(f[p],Le)===0?Xh(f,p,tt):Xh(f,++tt,I),tt<=u&&(p=tt+1),u<=tt&&(I=tt-1)}}function Xh(f,u,p){var I=f[u];f[u]=f[p],f[p]=I}function g0(f,u){return f<u?-1:f>u?1:0}function K0(f,u){const p=f.length;if(p<=1)return[f];const I=[];let L,G;for(let Q=0;Q<p;Q++){const re=ut(f[Q]);re!==0&&(f[Q].area=Math.abs(re),G===void 0&&(G=re<0),G===re<0?(L&&I.push(L),L=[f[Q]]):L.push(f[Q]))}if(L&&I.push(L),u>1)for(let Q=0;Q<I.length;Q++)I[Q].length<=u||(Y0(I[Q],u,1,I[Q].length-1,bp),I[Q]=I[Q].slice(0,u));return I}function bp(f,u){return u.area-f.area}function wA(f,u,p){const I=p.patternDependencies;let L=!1;for(const G of u){const Q=G.paint.get(`${f}-pattern`);Q.isConstant()||(L=!0);const re=Q.constantOr(null);re&&(L=!0,I[re.to]=!0,I[re.from]=!0)}return L}function hc(f,u,p,I,L){const G=L.patternDependencies;for(const Q of u){const re=Q.paint.get(`${f}-pattern`).value;if(re.kind!=="constant"){let Ae=re.evaluate({zoom:I-1},p,{},L.availableImages),_e=re.evaluate({zoom:I},p,{},L.availableImages),Le=re.evaluate({zoom:I+1},p,{},L.availableImages);Ae=Ae&&Ae.name?Ae.name:Ae,_e=_e&&_e.name?_e.name:_e,Le=Le&&Le.name?Le.name:Le,G[Ae]=!0,G[_e]=!0,G[Le]=!0,p.patterns[Q.id]={min:Ae,mid:_e,max:Le}}}return p}class xf{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new si,this.indexArray=new Bn,this.indexArray2=new en,this.programConfigurations=new Au(u.layers,u.zoom),this.segments=new er,this.segments2=new er,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,I){this.hasPattern=wA("fill",this.layers,p);const L=this.layers[0].layout.get("fill-sort-key"),G=!L.isConstant(),Q=[];for(const{feature:re,id:Ae,index:_e,sourceLayerIndex:Le}of u){const qe=this.layers[0]._featureFilter.needGeometry,tt=Cc(re,qe);if(!this.layers[0]._featureFilter.filter(new gn(this.zoom),tt,I))continue;const ft=G?L.evaluate(tt,{},I,p.availableImages):void 0,gt={id:Ae,properties:re.properties,type:re.type,sourceLayerIndex:Le,index:_e,geometry:qe?tt.geometry:Uh(re),patterns:{},sortKey:ft};Q.push(gt)}G&&Q.sort((re,Ae)=>re.sortKey-Ae.sortKey);for(const re of Q){const{geometry:Ae,index:_e,sourceLayerIndex:Le}=re;if(this.hasPattern){const qe=hc("fill",this.layers,re,this.zoom,p);this.patternFeatures.push(qe)}else this.addFeature(re,Ae,_e,I,{});p.featureIndex.insert(u[_e].feature,Ae,_e,Le,this.index)}}update(u,p,I){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,I)}addFeatures(u,p,I){for(const L of this.patternFeatures)this.addFeature(L,L.geometry,L.index,p,I)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,Tm),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.indexBuffer2=u.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(u,p,I,L,G){for(const Q of K0(p,500)){let re=0;for(const ft of Q)re+=ft.length;const Ae=this.segments.prepareSegment(re,this.layoutVertexArray,this.indexArray),_e=Ae.vertexLength,Le=[],qe=[];for(const ft of Q){if(ft.length===0)continue;ft!==Q[0]&&qe.push(Le.length/2);const gt=this.segments2.prepareSegment(ft.length,this.layoutVertexArray,this.indexArray2),Mt=gt.vertexLength;this.layoutVertexArray.emplaceBack(ft[0].x,ft[0].y),this.indexArray2.emplaceBack(Mt+ft.length-1,Mt),Le.push(ft[0].x),Le.push(ft[0].y);for(let Pt=1;Pt<ft.length;Pt++)this.layoutVertexArray.emplaceBack(ft[Pt].x,ft[Pt].y),this.indexArray2.emplaceBack(Mt+Pt-1,Mt+Pt),Le.push(ft[Pt].x),Le.push(ft[Pt].y);gt.vertexLength+=ft.length,gt.primitiveLength+=ft.length}const tt=$h(Le,qe);for(let ft=0;ft<tt.length;ft+=3)this.indexArray.emplaceBack(_e+tt[ft],_e+tt[ft+1],_e+tt[ft+2]);Ae.vertexLength+=re,Ae.primitiveLength+=tt.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,I,G,L)}}let J0,Sh;Pn("FillBucket",xf,{omit:["layers","patternFeatures"]});var th={get paint(){return Sh=Sh||new fs({"fill-antialias":new ki(ci.paint_fill["fill-antialias"]),"fill-opacity":new Li(ci.paint_fill["fill-opacity"]),"fill-color":new Li(ci.paint_fill["fill-color"]),"fill-outline-color":new Li(ci.paint_fill["fill-outline-color"]),"fill-translate":new ki(ci.paint_fill["fill-translate"]),"fill-translate-anchor":new ki(ci.paint_fill["fill-translate-anchor"]),"fill-pattern":new ws(ci.paint_fill["fill-pattern"])})},get layout(){return J0=J0||new fs({"fill-sort-key":new Li(ci.layout_fill["fill-sort-key"])})}};class wp extends Ds{constructor(u){super(u,th)}recalculate(u,p){super.recalculate(u,p);const I=this.paint._values["fill-outline-color"];I.value.kind==="constant"&&I.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new xf(u)}queryRadius(){return Kc(this.paint.get("fill-translate"))}queryIntersectsFeature(u,p,I,L,G,Q,re){return qh(mA(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),Q.angle,re),L)}isTileClipped(){return!0}}const Sp=R([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Ip=R([{name:"a_centroid",components:2,type:"Int16"}],4),{members:ed}=Sp;var Ih={},Mm=he,Mc=Eh;function Eh(f,u,p,I,L){this.properties={},this.extent=p,this.type=0,this._pbf=f,this._geometry=-1,this._keys=I,this._values=L,f.readFields(bf,this,u)}function bf(f,u,p){f==1?u.id=p.readVarint():f==2?function(I,L){for(var G=I.readVarint()+I.pos;I.pos<G;){var Q=L._keys[I.readVarint()],re=L._values[I.readVarint()];L.properties[Q]=re}}(p,u):f==3?u.type=p.readVarint():f==4&&(u._geometry=p.pos)}function Yh(f){for(var u,p,I=0,L=0,G=f.length,Q=G-1;L<G;Q=L++)I+=((p=f[Q]).x-(u=f[L]).x)*(u.y+p.y);return I}Eh.types=["Unknown","Point","LineString","Polygon"],Eh.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var u,p=f.readVarint()+f.pos,I=1,L=0,G=0,Q=0,re=[];f.pos<p;){if(L<=0){var Ae=f.readVarint();I=7&Ae,L=Ae>>3}if(L--,I===1||I===2)G+=f.readSVarint(),Q+=f.readSVarint(),I===1&&(u&&re.push(u),u=[]),u.push(new Mm(G,Q));else{if(I!==7)throw new Error("unknown command "+I);u&&u.push(u[0].clone())}}return u&&re.push(u),re},Eh.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var u=f.readVarint()+f.pos,p=1,I=0,L=0,G=0,Q=1/0,re=-1/0,Ae=1/0,_e=-1/0;f.pos<u;){if(I<=0){var Le=f.readVarint();p=7&Le,I=Le>>3}if(I--,p===1||p===2)(L+=f.readSVarint())<Q&&(Q=L),L>re&&(re=L),(G+=f.readSVarint())<Ae&&(Ae=G),G>_e&&(_e=G);else if(p!==7)throw new Error("unknown command "+p)}return[Q,Ae,re,_e]},Eh.prototype.toGeoJSON=function(f,u,p){var I,L,G=this.extent*Math.pow(2,p),Q=this.extent*f,re=this.extent*u,Ae=this.loadGeometry(),_e=Eh.types[this.type];function Le(ft){for(var gt=0;gt<ft.length;gt++){var Mt=ft[gt];ft[gt]=[360*(Mt.x+Q)/G-180,360/Math.PI*Math.atan(Math.exp((180-360*(Mt.y+re)/G)*Math.PI/180))-90]}}switch(this.type){case 1:var qe=[];for(I=0;I<Ae.length;I++)qe[I]=Ae[I][0];Le(Ae=qe);break;case 2:for(I=0;I<Ae.length;I++)Le(Ae[I]);break;case 3:for(Ae=function(ft){var gt=ft.length;if(gt<=1)return[ft];for(var Mt,Pt,Lt=[],ei=0;ei<gt;ei++){var Ht=Yh(ft[ei]);Ht!==0&&(Pt===void 0&&(Pt=Ht<0),Pt===Ht<0?(Mt&&Lt.push(Mt),Mt=[ft[ei]]):Mt.push(ft[ei]))}return Mt&&Lt.push(Mt),Lt}(Ae),I=0;I<Ae.length;I++)for(L=0;L<Ae[I].length;L++)Le(Ae[I][L])}Ae.length===1?Ae=Ae[0]:_e="Multi"+_e;var tt={type:"Feature",geometry:{type:_e,coordinates:Ae},properties:this.properties};return"id"in this&&(tt.id=this.id),tt};var SA=Mc,Kh=Tr;function Tr(f,u){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=f,this._keys=[],this._values=[],this._features=[],f.readFields(wf,this,u),this.length=this._features.length}function wf(f,u,p){f===15?u.version=p.readVarint():f===1?u.name=p.readString():f===5?u.extent=p.readVarint():f===2?u._features.push(p.pos):f===3?u._keys.push(p.readString()):f===4&&u._values.push(function(I){for(var L=null,G=I.readVarint()+I.pos;I.pos<G;){var Q=I.readVarint()>>3;L=Q===1?I.readString():Q===2?I.readFloat():Q===3?I.readDouble():Q===4?I.readVarint64():Q===5?I.readVarint():Q===6?I.readSVarint():Q===7?I.readBoolean():null}return L}(p))}Tr.prototype.feature=function(f){if(f<0||f>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[f];var u=this._pbf.readVarint()+this._pbf.pos;return new SA(this._pbf,u,this.extent,this._keys,this._values)};var td=Kh;function Jh(f,u,p){if(f===3){var I=new td(p,p.readVarint()+p.pos);I.length&&(u[I.name]=I)}}Ih.VectorTile=function(f,u){this.layers=f.readFields(Jh,{},u)},Ih.VectorTileFeature=Mc,Ih.VectorTileLayer=Kh;const Sf=Ih.VectorTileFeature.types,IA=Math.pow(2,13);function EA(f,u,p,I,L,G,Q,re){f.emplaceBack(u,p,2*Math.floor(I*IA)+Q,L*IA*2,G*IA*2,Math.round(re))}class Ul{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new Kt,this.centroidVertexArray=new Et,this.indexArray=new Bn,this.programConfigurations=new Au(u.layers,u.zoom),this.segments=new er,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,I){this.features=[],this.hasPattern=wA("fill-extrusion",this.layers,p);for(const{feature:L,id:G,index:Q,sourceLayerIndex:re}of u){const Ae=this.layers[0]._featureFilter.needGeometry,_e=Cc(L,Ae);if(!this.layers[0]._featureFilter.filter(new gn(this.zoom),_e,I))continue;const Le={id:G,sourceLayerIndex:re,index:Q,geometry:Ae?_e.geometry:Uh(L),properties:L.properties,type:L.type,patterns:{}};this.hasPattern?this.features.push(hc("fill-extrusion",this.layers,Le,this.zoom,p)):this.addFeature(Le,Le.geometry,Q,I,{}),p.featureIndex.insert(L,Le.geometry,Q,re,this.index,!0)}}addFeatures(u,p,I){for(const L of this.features){const{geometry:G}=L;this.addFeature(L,G,L.index,p,I)}}update(u,p,I){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,I)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,ed),this.centroidVertexBuffer=u.createVertexBuffer(this.centroidVertexArray,Ip.members,!0),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(u,p,I,L,G){const Q={x:0,y:0,vertexCount:0};for(const re of K0(p,500)){let Ae=0;for(const gt of re)Ae+=gt.length;let _e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const gt of re){if(gt.length===0||Dm(gt))continue;let Mt=0;for(let Pt=0;Pt<gt.length;Pt++){const Lt=gt[Pt];if(Pt>=1){const ei=gt[Pt-1];if(!Pm(Lt,ei)){_e.vertexLength+4>er.MAX_VERTEX_ARRAY_LENGTH&&(_e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ht=Lt.sub(ei)._perp()._unit(),Qt=ei.dist(Lt);Mt+Qt>32768&&(Mt=0),EA(this.layoutVertexArray,Lt.x,Lt.y,Ht.x,Ht.y,0,0,Mt),EA(this.layoutVertexArray,Lt.x,Lt.y,Ht.x,Ht.y,0,1,Mt),Q.x+=2*Lt.x,Q.y+=2*Lt.y,Q.vertexCount+=2,Mt+=Qt,EA(this.layoutVertexArray,ei.x,ei.y,Ht.x,Ht.y,0,0,Mt),EA(this.layoutVertexArray,ei.x,ei.y,Ht.x,Ht.y,0,1,Mt),Q.x+=2*ei.x,Q.y+=2*ei.y,Q.vertexCount+=2;const hi=_e.vertexLength;this.indexArray.emplaceBack(hi,hi+2,hi+1),this.indexArray.emplaceBack(hi+1,hi+2,hi+3),_e.vertexLength+=4,_e.primitiveLength+=2}}}}if(_e.vertexLength+Ae>er.MAX_VERTEX_ARRAY_LENGTH&&(_e=this.segments.prepareSegment(Ae,this.layoutVertexArray,this.indexArray)),Sf[u.type]!=="Polygon")continue;const Le=[],qe=[],tt=_e.vertexLength;for(const gt of re)if(gt.length!==0){gt!==re[0]&&qe.push(Le.length/2);for(let Mt=0;Mt<gt.length;Mt++){const Pt=gt[Mt];EA(this.layoutVertexArray,Pt.x,Pt.y,0,0,1,1,0),Q.x+=Pt.x,Q.y+=Pt.y,Q.vertexCount+=1,Le.push(Pt.x),Le.push(Pt.y)}}const ft=$h(Le,qe);for(let gt=0;gt<ft.length;gt+=3)this.indexArray.emplaceBack(tt+ft[gt],tt+ft[gt+2],tt+ft[gt+1]);_e.primitiveLength+=ft.length/3,_e.vertexLength+=Ae}for(let re=0;re<Q.vertexCount;re++)this.centroidVertexArray.emplaceBack(Math.floor(Q.x/Q.vertexCount),Math.floor(Q.y/Q.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,I,G,L)}}function Pm(f,u){return f.x===u.x&&(f.x<0||f.x>La)||f.y===u.y&&(f.y<0||f.y>La)}function Dm(f){return f.every(u=>u.x<0)||f.every(u=>u.x>La)||f.every(u=>u.y<0)||f.every(u=>u.y>La)}let id;Pn("FillExtrusionBucket",Ul,{omit:["layers","features"]});var Lm={get paint(){return id=id||new fs({"fill-extrusion-opacity":new ki(ci["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Li(ci["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ki(ci["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ki(ci["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ws(ci["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Li(ci["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Li(ci["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ki(ci["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class nd extends Ds{constructor(u){super(u,Lm)}createBucket(u){return new Ul(u)}queryRadius(){return Kc(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(u,p,I,L,G,Q,re,Ae){const _e=mA(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),Q.angle,re),Le=this.paint.get("fill-extrusion-height").evaluate(p,I),qe=this.paint.get("fill-extrusion-base").evaluate(p,I),tt=function(gt,Mt,Pt,Lt){const ei=[];for(const Ht of gt){const Qt=[Ht.x,Ht.y,0,1];Dl(Qt,Qt,Mt),ei.push(new ce(Qt[0]/Qt[3],Qt[1]/Qt[3]))}return ei}(_e,Ae),ft=function(gt,Mt,Pt,Lt){const ei=[],Ht=[],Qt=Lt[8]*Mt,hi=Lt[9]*Mt,_i=Lt[10]*Mt,Xi=Lt[11]*Mt,Sn=Lt[8]*Pt,ln=Lt[9]*Pt,on=Lt[10]*Pt,fn=Lt[11]*Pt;for(const zn of gt){const an=[],$i=[];for(const Dn of zn){const Nn=Dn.x,pr=Dn.y,Vr=Lt[0]*Nn+Lt[4]*pr+Lt[12],Hr=Lt[1]*Nn+Lt[5]*pr+Lt[13],Rs=Lt[2]*Nn+Lt[6]*pr+Lt[14],Ta=Lt[3]*Nn+Lt[7]*pr+Lt[15],ia=Rs+_i,as=Ta+Xi,Wn=Vr+Sn,Is=Hr+ln,tr=Rs+on,na=Ta+fn,Ls=new ce((Vr+Qt)/as,(Hr+hi)/as);Ls.z=ia/as,an.push(Ls);const Kn=new ce(Wn/na,Is/na);Kn.z=tr/na,$i.push(Kn)}ei.push(an),Ht.push($i)}return[ei,Ht]}(L,qe,Le,Ae);return function(gt,Mt,Pt){let Lt=1/0;qh(Pt,Mt)&&(Lt=rd(Pt,Mt[0]));for(let ei=0;ei<Mt.length;ei++){const Ht=Mt[ei],Qt=gt[ei];for(let hi=0;hi<Ht.length-1;hi++){const _i=Ht[hi],Xi=[_i,Ht[hi+1],Qt[hi+1],Qt[hi],_i];Xc(Pt,Xi)&&(Lt=Math.min(Lt,rd(Pt,Xi)))}}return Lt!==1/0&&Lt}(ft[0],ft[1],tt)}}function eA(f,u){return f.x*u.x+f.y*u.y}function rd(f,u){if(f.length===1){let p=0;const I=u[p++];let L;for(;!L||I.equals(L);)if(L=u[p++],!L)return 1/0;for(;p<u.length;p++){const G=u[p],Q=f[0],re=L.sub(I),Ae=G.sub(I),_e=Q.sub(I),Le=eA(re,re),qe=eA(re,Ae),tt=eA(Ae,Ae),ft=eA(_e,re),gt=eA(_e,Ae),Mt=Le*tt-qe*qe,Pt=(tt*ft-qe*gt)/Mt,Lt=(Le*gt-qe*ft)/Mt,ei=I.z*(1-Pt-Lt)+L.z*Pt+G.z*Lt;if(isFinite(ei))return ei}return 1/0}{let p=1/0;for(const I of u)p=Math.min(p,I.z);return p}}const Ep=R([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Pc}=Ep,bu=R([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:CA}=bu,Bm=Ih.VectorTileFeature.types,_0=Math.cos(Math.PI/180*37.5),Cp=Math.pow(2,14)/.5;class sd{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(p=>{this.gradients[p.id]={}}),this.layoutVertexArray=new ii,this.layoutVertexArray2=new ai,this.indexArray=new Bn,this.programConfigurations=new Au(u.layers,u.zoom),this.segments=new er,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,I){this.hasPattern=wA("line",this.layers,p);const L=this.layers[0].layout.get("line-sort-key"),G=!L.isConstant(),Q=[];for(const{feature:re,id:Ae,index:_e,sourceLayerIndex:Le}of u){const qe=this.layers[0]._featureFilter.needGeometry,tt=Cc(re,qe);if(!this.layers[0]._featureFilter.filter(new gn(this.zoom),tt,I))continue;const ft=G?L.evaluate(tt,{},I):void 0,gt={id:Ae,properties:re.properties,type:re.type,sourceLayerIndex:Le,index:_e,geometry:qe?tt.geometry:Uh(re),patterns:{},sortKey:ft};Q.push(gt)}G&&Q.sort((re,Ae)=>re.sortKey-Ae.sortKey);for(const re of Q){const{geometry:Ae,index:_e,sourceLayerIndex:Le}=re;if(this.hasPattern){const qe=hc("line",this.layers,re,this.zoom,p);this.patternFeatures.push(qe)}else this.addFeature(re,Ae,_e,I,{});p.featureIndex.insert(u[_e].feature,Ae,_e,Le,this.index)}}update(u,p,I){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,I)}addFeatures(u,p,I){for(const L of this.patternFeatures)this.addFeature(L,L.geometry,L.index,p,I)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=u.createVertexBuffer(this.layoutVertexArray2,CA)),this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,Pc),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(u){if(u.properties&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_end"))return{start:+u.properties.mapbox_clip_start,end:+u.properties.mapbox_clip_end}}addFeature(u,p,I,L,G){const Q=this.layers[0].layout,re=Q.get("line-join").evaluate(u,{}),Ae=Q.get("line-cap"),_e=Q.get("line-miter-limit"),Le=Q.get("line-round-limit");this.lineClips=this.lineFeatureClips(u);for(const qe of p)this.addLine(qe,u,re,Ae,_e,Le);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,I,G,L)}addLine(u,p,I,L,G,Q){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Lt=0;Lt<u.length-1;Lt++)this.totalDistance+=u[Lt].dist(u[Lt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const re=Bm[p.type]==="Polygon";let Ae=u.length;for(;Ae>=2&&u[Ae-1].equals(u[Ae-2]);)Ae--;let _e=0;for(;_e<Ae-1&&u[_e].equals(u[_e+1]);)_e++;if(Ae<(re?3:2))return;I==="bevel"&&(G=1.05);const Le=this.overscaling<=16?15*La/(512*this.overscaling):0,qe=this.segments.prepareSegment(10*Ae,this.layoutVertexArray,this.indexArray);let tt,ft,gt,Mt,Pt;this.e1=this.e2=-1,re&&(tt=u[Ae-2],Pt=u[_e].sub(tt)._unit()._perp());for(let Lt=_e;Lt<Ae;Lt++){if(gt=Lt===Ae-1?re?u[_e+1]:void 0:u[Lt+1],gt&&u[Lt].equals(gt))continue;Pt&&(Mt=Pt),tt&&(ft=tt),tt=u[Lt],Pt=gt?gt.sub(tt)._unit()._perp():Mt,Mt=Mt||Pt;let ei=Mt.add(Pt);ei.x===0&&ei.y===0||ei._unit();const Ht=Mt.x*Pt.x+Mt.y*Pt.y,Qt=ei.x*Pt.x+ei.y*Pt.y,hi=Qt!==0?1/Qt:1/0,_i=2*Math.sqrt(2-2*Qt),Xi=Qt<_0&&ft&&gt,Sn=Mt.x*Pt.y-Mt.y*Pt.x>0;if(Xi&&Lt>_e){const fn=tt.dist(ft);if(fn>2*Le){const zn=tt.sub(tt.sub(ft)._mult(Le/fn)._round());this.updateDistance(ft,zn),this.addCurrentVertex(zn,Mt,0,0,qe),ft=zn}}const ln=ft&&gt;let on=ln?I:re?"butt":L;if(ln&&on==="round"&&(hi<Q?on="miter":hi<=2&&(on="fakeround")),on==="miter"&&hi>G&&(on="bevel"),on==="bevel"&&(hi>2&&(on="flipbevel"),hi<G&&(on="miter")),ft&&this.updateDistance(ft,tt),on==="miter")ei._mult(hi),this.addCurrentVertex(tt,ei,0,0,qe);else if(on==="flipbevel"){if(hi>100)ei=Pt.mult(-1);else{const fn=hi*Mt.add(Pt).mag()/Mt.sub(Pt).mag();ei._perp()._mult(fn*(Sn?-1:1))}this.addCurrentVertex(tt,ei,0,0,qe),this.addCurrentVertex(tt,ei.mult(-1),0,0,qe)}else if(on==="bevel"||on==="fakeround"){const fn=-Math.sqrt(hi*hi-1),zn=Sn?fn:0,an=Sn?0:fn;if(ft&&this.addCurrentVertex(tt,Mt,zn,an,qe),on==="fakeround"){const $i=Math.round(180*_i/Math.PI/20);for(let Dn=1;Dn<$i;Dn++){let Nn=Dn/$i;if(Nn!==.5){const Vr=Nn-.5;Nn+=Nn*Vr*(Nn-1)*((1.0904+Ht*(Ht*(3.55645-1.43519*Ht)-3.2452))*Vr*Vr+(.848013+Ht*(.215638*Ht-1.06021)))}const pr=Pt.sub(Mt)._mult(Nn)._add(Mt)._unit()._mult(Sn?-1:1);this.addHalfVertex(tt,pr.x,pr.y,!1,Sn,0,qe)}}gt&&this.addCurrentVertex(tt,Pt,-zn,-an,qe)}else if(on==="butt")this.addCurrentVertex(tt,ei,0,0,qe);else if(on==="square"){const fn=ft?1:-1;this.addCurrentVertex(tt,ei,fn,fn,qe)}else on==="round"&&(ft&&(this.addCurrentVertex(tt,Mt,0,0,qe),this.addCurrentVertex(tt,Mt,1,1,qe,!0)),gt&&(this.addCurrentVertex(tt,Pt,-1,-1,qe,!0),this.addCurrentVertex(tt,Pt,0,0,qe)));if(Xi&&Lt<Ae-1){const fn=tt.dist(gt);if(fn>2*Le){const zn=tt.add(gt.sub(tt)._mult(Le/fn)._round());this.updateDistance(tt,zn),this.addCurrentVertex(zn,Pt,0,0,qe),tt=zn}}}}addCurrentVertex(u,p,I,L,G,Q=!1){const re=p.y*L-p.x,Ae=-p.y-p.x*L;this.addHalfVertex(u,p.x+p.y*I,p.y-p.x*I,Q,!1,I,G),this.addHalfVertex(u,re,Ae,Q,!0,-L,G),this.distance>Cp/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(u,p,I,L,G,Q))}addHalfVertex({x:u,y:p},I,L,G,Q,re,Ae){const _e=.5*(this.lineClips?this.scaledDistance*(Cp-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((u<<1)+(G?1:0),(p<<1)+(Q?1:0),Math.round(63*I)+128,Math.round(63*L)+128,1+(re===0?0:re<0?-1:1)|(63&_e)<<2,_e>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Le=Ae.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Le),Ae.primitiveLength++),Q?this.e2=Le:this.e1=Le}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(u,p){this.distance+=u.dist(p),this.updateScaledDistance()}}let TA,y0;Pn("LineBucket",sd,{omit:["layers","patternFeatures"]});var ad={get paint(){return y0=y0||new fs({"line-opacity":new Li(ci.paint_line["line-opacity"]),"line-color":new Li(ci.paint_line["line-color"]),"line-translate":new ki(ci.paint_line["line-translate"]),"line-translate-anchor":new ki(ci.paint_line["line-translate-anchor"]),"line-width":new Li(ci.paint_line["line-width"]),"line-gap-width":new Li(ci.paint_line["line-gap-width"]),"line-offset":new Li(ci.paint_line["line-offset"]),"line-blur":new Li(ci.paint_line["line-blur"]),"line-dasharray":new vu(ci.paint_line["line-dasharray"]),"line-pattern":new ws(ci.paint_line["line-pattern"]),"line-gradient":new Vo(ci.paint_line["line-gradient"])})},get layout(){return TA=TA||new fs({"line-cap":new ki(ci.layout_line["line-cap"]),"line-join":new Li(ci.layout_line["line-join"]),"line-miter-limit":new ki(ci.layout_line["line-miter-limit"]),"line-round-limit":new ki(ci.layout_line["line-round-limit"]),"line-sort-key":new Li(ci.layout_line["line-sort-key"])})}};class zm extends Li{possiblyEvaluate(u,p){return p=new gn(Math.floor(p.zoom),{now:p.now,fadeDuration:p.fadeDuration,zoomHistory:p.zoomHistory,transition:p.transition}),super.possiblyEvaluate(u,p)}evaluate(u,p,I,L){return p=at({},p,{zoom:Math.floor(p.zoom)}),super.evaluate(u,p,I,L)}}let Ch;class Al extends Ds{constructor(u){super(u,ad),this.gradientVersion=0,Ch||(Ch=new zm(ad.paint.properties["line-width"].specification),Ch.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){const p=this.gradientExpression();this.stepInterpolant=!!function(I){return I._styleExpression!==void 0}(p)&&p._styleExpression.expression instanceof ir,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(u,p){super.recalculate(u,p),this.paint._values["line-floorwidth"]=Ch.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new sd(u)}queryRadius(u){const p=u,I=od(vh("line-width",this,p),vh("line-gap-width",this,p)),L=vh("line-offset",this,p);return I/2+Math.abs(L)+Kc(this.paint.get("line-translate"))}queryIntersectsFeature(u,p,I,L,G,Q,re){const Ae=mA(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),Q.angle,re),_e=re/2*od(this.paint.get("line-width").evaluate(p,I),this.paint.get("line-gap-width").evaluate(p,I)),Le=this.paint.get("line-offset").evaluate(p,I);return Le&&(L=function(qe,tt){const ft=[];for(let gt=0;gt<qe.length;gt++){const Mt=qe[gt],Pt=[];for(let Lt=0;Lt<Mt.length;Lt++){const ei=Mt[Lt-1],Ht=Mt[Lt],Qt=Mt[Lt+1],hi=Lt===0?new ce(0,0):Ht.sub(ei)._unit()._perp(),_i=Lt===Mt.length-1?new ce(0,0):Qt.sub(Ht)._unit()._perp(),Xi=hi._add(_i)._unit(),Sn=Xi.x*_i.x+Xi.y*_i.y;Sn!==0&&Xi._mult(1/Sn),Pt.push(Xi._mult(tt)._add(Ht))}ft.push(Pt)}return ft}(L,Le*re)),function(qe,tt,ft){for(let gt=0;gt<tt.length;gt++){const Mt=tt[gt];if(qe.length>=3){for(let Pt=0;Pt<Mt.length;Pt++)if(Yu(qe,Mt[Pt]))return!0}if(of(qe,Mt,ft))return!0}return!1}(Ae,L,_e)}isTileClipped(){return!0}}function od(f,u){return u>0?u+2*f:f}const ld=R([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ud=R([{name:"a_projected_pos",components:3,type:"Float32"}],4);R([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const da=R([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);R([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const kA=R([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),cd=R([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function MA(f,u,p){return f.sections.forEach(I=>{I.text=function(L,G,Q){const re=G.layout.get("text-transform").evaluate(Q,{});return re==="uppercase"?L=L.toLocaleUpperCase():re==="lowercase"&&(L=L.toLocaleLowerCase()),gs.applyArabicShaping&&(L=gs.applyArabicShaping(L)),L}(I.text,u,p)}),f}R([{name:"triangle",components:3,type:"Uint16"}]),R([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),R([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),R([{type:"Float32",name:"offsetX"}]),R([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),R([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const wu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var eo=24,v0=ys,If=function(f,u,p,I,L){var G,Q,re=8*L-I-1,Ae=(1<<re)-1,_e=Ae>>1,Le=-7,qe=p?L-1:0,tt=p?-1:1,ft=f[u+qe];for(qe+=tt,G=ft&(1<<-Le)-1,ft>>=-Le,Le+=re;Le>0;G=256*G+f[u+qe],qe+=tt,Le-=8);for(Q=G&(1<<-Le)-1,G>>=-Le,Le+=I;Le>0;Q=256*Q+f[u+qe],qe+=tt,Le-=8);if(G===0)G=1-_e;else{if(G===Ae)return Q?NaN:1/0*(ft?-1:1);Q+=Math.pow(2,I),G-=_e}return(ft?-1:1)*Q*Math.pow(2,G-I)},hd=function(f,u,p,I,L,G){var Q,re,Ae,_e=8*G-L-1,Le=(1<<_e)-1,qe=Le>>1,tt=L===23?Math.pow(2,-24)-Math.pow(2,-77):0,ft=I?0:G-1,gt=I?1:-1,Mt=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(re=isNaN(u)?1:0,Q=Le):(Q=Math.floor(Math.log(u)/Math.LN2),u*(Ae=Math.pow(2,-Q))<1&&(Q--,Ae*=2),(u+=Q+qe>=1?tt/Ae:tt*Math.pow(2,1-qe))*Ae>=2&&(Q++,Ae/=2),Q+qe>=Le?(re=0,Q=Le):Q+qe>=1?(re=(u*Ae-1)*Math.pow(2,L),Q+=qe):(re=u*Math.pow(2,qe-1)*Math.pow(2,L),Q=0));L>=8;f[p+ft]=255&re,ft+=gt,re/=256,L-=8);for(Q=Q<<L|re,_e+=L;_e>0;f[p+ft]=255&Q,ft+=gt,Q/=256,_e-=8);f[p+ft-gt]|=128*Mt};function ys(f){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(f)?f:new Uint8Array(f||0),this.pos=0,this.type=0,this.length=this.buf.length}ys.Varint=0,ys.Fixed64=1,ys.Bytes=2,ys.Fixed32=5;var ih=4294967296,Tp=1/ih,Ad=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function nh(f){return f.type===ys.Bytes?f.readVarint()+f.pos:f.pos+1}function PA(f,u,p){return p?4294967296*u+(f>>>0):4294967296*(u>>>0)+(f>>>0)}function kp(f,u,p){var I=u<=16383?1:u<=2097151?2:u<=268435455?3:Math.floor(Math.log(u)/(7*Math.LN2));p.realloc(I);for(var L=p.pos-1;L>=f;L--)p.buf[L+I]=p.buf[L]}function x0(f,u){for(var p=0;p<f.length;p++)u.writeVarint(f[p])}function DA(f,u){for(var p=0;p<f.length;p++)u.writeSVarint(f[p])}function Mp(f,u){for(var p=0;p<f.length;p++)u.writeFloat(f[p])}function fd(f,u){for(var p=0;p<f.length;p++)u.writeDouble(f[p])}function dd(f,u){for(var p=0;p<f.length;p++)u.writeBoolean(f[p])}function Rm(f,u){for(var p=0;p<f.length;p++)u.writeFixed32(f[p])}function Fm(f,u){for(var p=0;p<f.length;p++)u.writeSFixed32(f[p])}function Om(f,u){for(var p=0;p<f.length;p++)u.writeFixed64(f[p])}function pd(f,u){for(var p=0;p<f.length;p++)u.writeSFixed64(f[p])}function LA(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+16777216*f[u+3]}function fl(f,u,p){f[p]=u,f[p+1]=u>>>8,f[p+2]=u>>>16,f[p+3]=u>>>24}function b0(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+(f[u+3]<<24)}ys.prototype={destroy:function(){this.buf=null},readFields:function(f,u,p){for(p=p||this.length;this.pos<p;){var I=this.readVarint(),L=I>>3,G=this.pos;this.type=7&I,f(L,u,this),this.pos===G&&this.skip(I)}return u},readMessage:function(f,u){return this.readFields(f,u,this.readVarint()+this.pos)},readFixed32:function(){var f=LA(this.buf,this.pos);return this.pos+=4,f},readSFixed32:function(){var f=b0(this.buf,this.pos);return this.pos+=4,f},readFixed64:function(){var f=LA(this.buf,this.pos)+LA(this.buf,this.pos+4)*ih;return this.pos+=8,f},readSFixed64:function(){var f=LA(this.buf,this.pos)+b0(this.buf,this.pos+4)*ih;return this.pos+=8,f},readFloat:function(){var f=If(this.buf,this.pos,!0,23,4);return this.pos+=4,f},readDouble:function(){var f=If(this.buf,this.pos,!0,52,8);return this.pos+=8,f},readVarint:function(f){var u,p,I=this.buf;return u=127&(p=I[this.pos++]),p<128?u:(u|=(127&(p=I[this.pos++]))<<7,p<128?u:(u|=(127&(p=I[this.pos++]))<<14,p<128?u:(u|=(127&(p=I[this.pos++]))<<21,p<128?u:function(L,G,Q){var re,Ae,_e=Q.buf;if(re=(112&(Ae=_e[Q.pos++]))>>4,Ae<128||(re|=(127&(Ae=_e[Q.pos++]))<<3,Ae<128)||(re|=(127&(Ae=_e[Q.pos++]))<<10,Ae<128)||(re|=(127&(Ae=_e[Q.pos++]))<<17,Ae<128)||(re|=(127&(Ae=_e[Q.pos++]))<<24,Ae<128)||(re|=(1&(Ae=_e[Q.pos++]))<<31,Ae<128))return PA(L,re,G);throw new Error("Expected varint not more than 10 bytes")}(u|=(15&(p=I[this.pos]))<<28,f,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var f=this.readVarint();return f%2==1?(f+1)/-2:f/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var f=this.readVarint()+this.pos,u=this.pos;return this.pos=f,f-u>=12&&Ad?function(p,I,L){return Ad.decode(p.subarray(I,L))}(this.buf,u,f):function(p,I,L){for(var G="",Q=I;Q<L;){var re,Ae,_e,Le=p[Q],qe=null,tt=Le>239?4:Le>223?3:Le>191?2:1;if(Q+tt>L)break;tt===1?Le<128&&(qe=Le):tt===2?(192&(re=p[Q+1]))==128&&(qe=(31&Le)<<6|63&re)<=127&&(qe=null):tt===3?(Ae=p[Q+2],(192&(re=p[Q+1]))==128&&(192&Ae)==128&&((qe=(15&Le)<<12|(63&re)<<6|63&Ae)<=2047||qe>=55296&&qe<=57343)&&(qe=null)):tt===4&&(Ae=p[Q+2],_e=p[Q+3],(192&(re=p[Q+1]))==128&&(192&Ae)==128&&(192&_e)==128&&((qe=(15&Le)<<18|(63&re)<<12|(63&Ae)<<6|63&_e)<=65535||qe>=1114112)&&(qe=null)),qe===null?(qe=65533,tt=1):qe>65535&&(qe-=65536,G+=String.fromCharCode(qe>>>10&1023|55296),qe=56320|1023&qe),G+=String.fromCharCode(qe),Q+=tt}return G}(this.buf,u,f)},readBytes:function(){var f=this.readVarint()+this.pos,u=this.buf.subarray(this.pos,f);return this.pos=f,u},readPackedVarint:function(f,u){if(this.type!==ys.Bytes)return f.push(this.readVarint(u));var p=nh(this);for(f=f||[];this.pos<p;)f.push(this.readVarint(u));return f},readPackedSVarint:function(f){if(this.type!==ys.Bytes)return f.push(this.readSVarint());var u=nh(this);for(f=f||[];this.pos<u;)f.push(this.readSVarint());return f},readPackedBoolean:function(f){if(this.type!==ys.Bytes)return f.push(this.readBoolean());var u=nh(this);for(f=f||[];this.pos<u;)f.push(this.readBoolean());return f},readPackedFloat:function(f){if(this.type!==ys.Bytes)return f.push(this.readFloat());var u=nh(this);for(f=f||[];this.pos<u;)f.push(this.readFloat());return f},readPackedDouble:function(f){if(this.type!==ys.Bytes)return f.push(this.readDouble());var u=nh(this);for(f=f||[];this.pos<u;)f.push(this.readDouble());return f},readPackedFixed32:function(f){if(this.type!==ys.Bytes)return f.push(this.readFixed32());var u=nh(this);for(f=f||[];this.pos<u;)f.push(this.readFixed32());return f},readPackedSFixed32:function(f){if(this.type!==ys.Bytes)return f.push(this.readSFixed32());var u=nh(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed32());return f},readPackedFixed64:function(f){if(this.type!==ys.Bytes)return f.push(this.readFixed64());var u=nh(this);for(f=f||[];this.pos<u;)f.push(this.readFixed64());return f},readPackedSFixed64:function(f){if(this.type!==ys.Bytes)return f.push(this.readSFixed64());var u=nh(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed64());return f},skip:function(f){var u=7&f;if(u===ys.Varint)for(;this.buf[this.pos++]>127;);else if(u===ys.Bytes)this.pos=this.readVarint()+this.pos;else if(u===ys.Fixed32)this.pos+=4;else{if(u!==ys.Fixed64)throw new Error("Unimplemented type: "+u);this.pos+=8}},writeTag:function(f,u){this.writeVarint(f<<3|u)},realloc:function(f){for(var u=this.length||16;u<this.pos+f;)u*=2;if(u!==this.length){var p=new Uint8Array(u);p.set(this.buf),this.buf=p,this.length=u}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(f){this.realloc(4),fl(this.buf,f,this.pos),this.pos+=4},writeSFixed32:function(f){this.realloc(4),fl(this.buf,f,this.pos),this.pos+=4},writeFixed64:function(f){this.realloc(8),fl(this.buf,-1&f,this.pos),fl(this.buf,Math.floor(f*Tp),this.pos+4),this.pos+=8},writeSFixed64:function(f){this.realloc(8),fl(this.buf,-1&f,this.pos),fl(this.buf,Math.floor(f*Tp),this.pos+4),this.pos+=8},writeVarint:function(f){(f=+f||0)>268435455||f<0?function(u,p){var I,L;if(u>=0?(I=u%4294967296|0,L=u/4294967296|0):(L=~(-u/4294967296),4294967295^(I=~(-u%4294967296))?I=I+1|0:(I=0,L=L+1|0)),u>=18446744073709552e3||u<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");p.realloc(10),function(G,Q,re){re.buf[re.pos++]=127&G|128,G>>>=7,re.buf[re.pos++]=127&G|128,G>>>=7,re.buf[re.pos++]=127&G|128,G>>>=7,re.buf[re.pos++]=127&G|128,re.buf[re.pos]=127&(G>>>=7)}(I,0,p),function(G,Q){var re=(7&G)<<4;Q.buf[Q.pos++]|=re|((G>>>=3)?128:0),G&&(Q.buf[Q.pos++]=127&G|((G>>>=7)?128:0),G&&(Q.buf[Q.pos++]=127&G|((G>>>=7)?128:0),G&&(Q.buf[Q.pos++]=127&G|((G>>>=7)?128:0),G&&(Q.buf[Q.pos++]=127&G|((G>>>=7)?128:0),G&&(Q.buf[Q.pos++]=127&G)))))}(L,p)}(f,this):(this.realloc(4),this.buf[this.pos++]=127&f|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=f>>>7&127))))},writeSVarint:function(f){this.writeVarint(f<0?2*-f-1:2*f)},writeBoolean:function(f){this.writeVarint(!!f)},writeString:function(f){f=String(f),this.realloc(4*f.length),this.pos++;var u=this.pos;this.pos=function(I,L,G){for(var Q,re,Ae=0;Ae<L.length;Ae++){if((Q=L.charCodeAt(Ae))>55295&&Q<57344){if(!re){Q>56319||Ae+1===L.length?(I[G++]=239,I[G++]=191,I[G++]=189):re=Q;continue}if(Q<56320){I[G++]=239,I[G++]=191,I[G++]=189,re=Q;continue}Q=re-55296<<10|Q-56320|65536,re=null}else re&&(I[G++]=239,I[G++]=191,I[G++]=189,re=null);Q<128?I[G++]=Q:(Q<2048?I[G++]=Q>>6|192:(Q<65536?I[G++]=Q>>12|224:(I[G++]=Q>>18|240,I[G++]=Q>>12&63|128),I[G++]=Q>>6&63|128),I[G++]=63&Q|128)}return G}(this.buf,f,this.pos);var p=this.pos-u;p>=128&&kp(u,p,this),this.pos=u-1,this.writeVarint(p),this.pos+=p},writeFloat:function(f){this.realloc(4),hd(this.buf,f,this.pos,!0,23,4),this.pos+=4},writeDouble:function(f){this.realloc(8),hd(this.buf,f,this.pos,!0,52,8),this.pos+=8},writeBytes:function(f){var u=f.length;this.writeVarint(u),this.realloc(u);for(var p=0;p<u;p++)this.buf[this.pos++]=f[p]},writeRawMessage:function(f,u){this.pos++;var p=this.pos;f(u,this);var I=this.pos-p;I>=128&&kp(p,I,this),this.pos=p-1,this.writeVarint(I),this.pos+=I},writeMessage:function(f,u,p){this.writeTag(f,ys.Bytes),this.writeRawMessage(u,p)},writePackedVarint:function(f,u){u.length&&this.writeMessage(f,x0,u)},writePackedSVarint:function(f,u){u.length&&this.writeMessage(f,DA,u)},writePackedBoolean:function(f,u){u.length&&this.writeMessage(f,dd,u)},writePackedFloat:function(f,u){u.length&&this.writeMessage(f,Mp,u)},writePackedDouble:function(f,u){u.length&&this.writeMessage(f,fd,u)},writePackedFixed32:function(f,u){u.length&&this.writeMessage(f,Rm,u)},writePackedSFixed32:function(f,u){u.length&&this.writeMessage(f,Fm,u)},writePackedFixed64:function(f,u){u.length&&this.writeMessage(f,Om,u)},writePackedSFixed64:function(f,u){u.length&&this.writeMessage(f,pd,u)},writeBytesField:function(f,u){this.writeTag(f,ys.Bytes),this.writeBytes(u)},writeFixed32Field:function(f,u){this.writeTag(f,ys.Fixed32),this.writeFixed32(u)},writeSFixed32Field:function(f,u){this.writeTag(f,ys.Fixed32),this.writeSFixed32(u)},writeFixed64Field:function(f,u){this.writeTag(f,ys.Fixed64),this.writeFixed64(u)},writeSFixed64Field:function(f,u){this.writeTag(f,ys.Fixed64),this.writeSFixed64(u)},writeVarintField:function(f,u){this.writeTag(f,ys.Varint),this.writeVarint(u)},writeSVarintField:function(f,u){this.writeTag(f,ys.Varint),this.writeSVarint(u)},writeStringField:function(f,u){this.writeTag(f,ys.Bytes),this.writeString(u)},writeFloatField:function(f,u){this.writeTag(f,ys.Fixed32),this.writeFloat(u)},writeDoubleField:function(f,u){this.writeTag(f,ys.Fixed64),this.writeDouble(u)},writeBooleanField:function(f,u){this.writeVarintField(f,!!u)}};var w0=W(v0);const Dc=3;function BA(f,u,p){f===1&&p.readMessage(Ef,u)}function Ef(f,u,p){if(f===3){const{id:I,bitmap:L,width:G,height:Q,left:re,top:Ae,advance:_e}=p.readMessage(zA,{});u.push({id:I,bitmap:new xh({width:G+2*Dc,height:Q+2*Dc},L),metrics:{width:G,height:Q,left:re,top:Ae,advance:_e}})}}function zA(f,u,p){f===1?u.id=p.readVarint():f===2?u.bitmap=p.readBytes():f===3?u.width=p.readVarint():f===4?u.height=p.readVarint():f===5?u.left=p.readSVarint():f===6?u.top=p.readSVarint():f===7&&(u.advance=p.readVarint())}const Cf=Dc;function Tf(f){let u=0,p=0;for(const Q of f)u+=Q.w*Q.h,p=Math.max(p,Q.w);f.sort((Q,re)=>re.h-Q.h);const I=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(u/.95)),p),h:1/0}];let L=0,G=0;for(const Q of f)for(let re=I.length-1;re>=0;re--){const Ae=I[re];if(!(Q.w>Ae.w||Q.h>Ae.h)){if(Q.x=Ae.x,Q.y=Ae.y,G=Math.max(G,Q.y+Q.h),L=Math.max(L,Q.x+Q.w),Q.w===Ae.w&&Q.h===Ae.h){const _e=I.pop();re<I.length&&(I[re]=_e)}else Q.h===Ae.h?(Ae.x+=Q.w,Ae.w-=Q.w):Q.w===Ae.w?(Ae.y+=Q.h,Ae.h-=Q.h):(I.push({x:Ae.x+Q.w,y:Ae.y,w:Ae.w-Q.w,h:Q.h}),Ae.y+=Q.h,Ae.h-=Q.h);break}}return{w:L,h:G,fill:u/(L*G)||0}}const Su=1;class S0{constructor(u,{pixelRatio:p,version:I,stretchX:L,stretchY:G,content:Q}){this.paddedRect=u,this.pixelRatio=p,this.stretchX=L,this.stretchY=G,this.content=Q,this.version=I}get tl(){return[this.paddedRect.x+Su,this.paddedRect.y+Su]}get br(){return[this.paddedRect.x+this.paddedRect.w-Su,this.paddedRect.y+this.paddedRect.h-Su]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Su)/this.pixelRatio,(this.paddedRect.h-2*Su)/this.pixelRatio]}}class ku{constructor(u,p){const I={},L={};this.haveRenderCallbacks=[];const G=[];this.addImages(u,I,G),this.addImages(p,L,G);const{w:Q,h:re}=Tf(G),Ae=new Ll({width:Q||1,height:re||1});for(const _e in u){const Le=u[_e],qe=I[_e].paddedRect;Ll.copy(Le.data,Ae,{x:0,y:0},{x:qe.x+Su,y:qe.y+Su},Le.data)}for(const _e in p){const Le=p[_e],qe=L[_e].paddedRect,tt=qe.x+Su,ft=qe.y+Su,gt=Le.data.width,Mt=Le.data.height;Ll.copy(Le.data,Ae,{x:0,y:0},{x:tt,y:ft},Le.data),Ll.copy(Le.data,Ae,{x:0,y:Mt-1},{x:tt,y:ft-1},{width:gt,height:1}),Ll.copy(Le.data,Ae,{x:0,y:0},{x:tt,y:ft+Mt},{width:gt,height:1}),Ll.copy(Le.data,Ae,{x:gt-1,y:0},{x:tt-1,y:ft},{width:1,height:Mt}),Ll.copy(Le.data,Ae,{x:0,y:0},{x:tt+gt,y:ft},{width:1,height:Mt})}this.image=Ae,this.iconPositions=I,this.patternPositions=L}addImages(u,p,I){for(const L in u){const G=u[L],Q={x:0,y:0,w:G.data.width+2*Su,h:G.data.height+2*Su};I.push(Q),p[L]=new S0(Q,G),G.hasRenderCallback&&this.haveRenderCallbacks.push(L)}}patchUpdatedImages(u,p){u.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const I in u.updatedImages)this.patchUpdatedImage(this.iconPositions[I],u.getImage(I),p),this.patchUpdatedImage(this.patternPositions[I],u.getImage(I),p)}patchUpdatedImage(u,p,I){if(!u||!p||u.version===p.version)return;u.version=p.version;const[L,G]=u.tl;I.update(p.data,void 0,{x:L,y:G})}}var Th;Pn("ImagePosition",S0),Pn("ImageAtlas",ku),a.ai=void 0,(Th=a.ai||(a.ai={}))[Th.none=0]="none",Th[Th.horizontal=1]="horizontal",Th[Th.vertical=2]="vertical",Th[Th.horizontalOnly=3]="horizontalOnly";const RA=-17;class FA{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(u,p){const I=new FA;return I.scale=u||1,I.fontStack=p,I}static forImage(u){const p=new FA;return p.imageName=u,p}}class rh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(u,p){const I=new rh;for(let L=0;L<u.sections.length;L++){const G=u.sections[L];G.image?I.addImageSection(G):I.addTextSection(G,p)}return I}length(){return this.text.length}getSection(u){return this.sections[this.sectionIndex[u]]}getSectionIndex(u){return this.sectionIndex[u]}getCharCode(u){return this.text.charCodeAt(u)}verticalizePunctuation(){this.text=function(u){let p="";for(let I=0;I<u.length;I++){const L=u.charCodeAt(I+1)||null,G=u.charCodeAt(I-1)||null;p+=L&&Ou(L)&&!wu[u[I+1]]||G&&Ou(G)&&!wu[u[I-1]]||!wu[u[I]]?u[I]:wu[u[I]]}return p}(this.text)}trim(){let u=0;for(let I=0;I<this.text.length&&I0[this.text.charCodeAt(I)];I++)u++;let p=this.text.length;for(let I=this.text.length-1;I>=0&&I>=u&&I0[this.text.charCodeAt(I)];I--)p--;this.text=this.text.substring(u,p),this.sectionIndex=this.sectionIndex.slice(u,p)}substring(u,p){const I=new rh;return I.text=this.text.substring(u,p),I.sectionIndex=this.sectionIndex.slice(u,p),I.sections=this.sections,I}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((u,p)=>Math.max(u,this.sections[p].scale),0)}addTextSection(u,p){this.text+=u.text,this.sections.push(FA.forText(u.scale,u.fontStack||p));const I=this.sections.length-1;for(let L=0;L<u.text.length;++L)this.sectionIndex.push(I)}addImageSection(u){const p=u.image?u.image.name:"";if(p.length===0)return void $e("Can't add FormattedSection with an empty image.");const I=this.getNextImageSectionCharCode();I?(this.text+=String.fromCharCode(I),this.sections.push(FA.forImage(p)),this.sectionIndex.push(this.sections.length-1)):$e("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function OA(f,u,p,I,L,G,Q,re,Ae,_e,Le,qe,tt,ft,gt,Mt){const Pt=rh.fromFeature(f,L);let Lt;qe===a.ai.vertical&&Pt.verticalizePunctuation();const{processBidirectionalText:ei,processStyledBidirectionalText:Ht}=gs;if(ei&&Pt.sections.length===1){Lt=[];const _i=ei(Pt.toString(),kf(Pt,_e,G,u,I,ft,gt));for(const Xi of _i){const Sn=new rh;Sn.text=Xi,Sn.sections=Pt.sections;for(let ln=0;ln<Xi.length;ln++)Sn.sectionIndex.push(0);Lt.push(Sn)}}else if(Ht){Lt=[];const _i=Ht(Pt.text,Pt.sectionIndex,kf(Pt,_e,G,u,I,ft,gt));for(const Xi of _i){const Sn=new rh;Sn.text=Xi[0],Sn.sectionIndex=Xi[1],Sn.sections=Pt.sections,Lt.push(Sn)}}else Lt=function(_i,Xi){const Sn=[],ln=_i.text;let on=0;for(const fn of Xi)Sn.push(_i.substring(on,fn)),on=fn;return on<ln.length&&Sn.push(_i.substring(on,ln.length)),Sn}(Pt,kf(Pt,_e,G,u,I,ft,gt));const Qt=[],hi={positionedLines:Qt,text:Pt.toString(),top:Le[1],bottom:Le[1],left:Le[0],right:Le[0],writingMode:qe,iconsInText:!1,verticalizable:!1};return function(_i,Xi,Sn,ln,on,fn,zn,an,$i,Dn,Nn,pr){let Vr=0,Hr=RA,Rs=0,Ta=0;const ia=an==="right"?1:an==="left"?0:.5;let as=0;for(const Ls of on){Ls.trim();const Kn=Ls.getMaxScale(),za=(Kn-1)*eo,to={positionedGlyphs:[],lineOffset:0};_i.positionedLines[as]=to;const va=to.positionedGlyphs;let qo=0;if(!Ls.length()){Hr+=fn,++as;continue}for(let ra=0;ra<Ls.length();ra++){const wr=Ls.getSection(ra),wo=Ls.getSectionIndex(ra),nl=Ls.getCharCode(ra);let rl=0,Pu=null,Gu=null,zl=null,Fc=eo;const qu=!($i===a.ai.horizontal||!Nn&&!uu(nl)||Nn&&(I0[nl]||(Wn=nl,En.Arabic(Wn)||En["Arabic Supplement"](Wn)||En["Arabic Extended-A"](Wn)||En["Arabic Presentation Forms-A"](Wn)||En["Arabic Presentation Forms-B"](Wn))));if(wr.imageName){const Hu=ln[wr.imageName];if(!Hu)continue;zl=wr.imageName,_i.iconsInText=_i.iconsInText||!0,Gu=Hu.paddedRect;const eu=Hu.displaySize;wr.scale=wr.scale*eo/pr,Pu={width:eu[0],height:eu[1],left:Su,top:-Cf,advance:qu?eu[1]:eu[0]},rl=za+(eo-eu[1]*wr.scale),Fc=Pu.advance;const ch=qu?eu[0]*wr.scale-eo*Kn:eu[1]*wr.scale-eo*Kn;ch>0&&ch>qo&&(qo=ch)}else{const Hu=Sn[wr.fontStack],eu=Hu&&Hu[nl];if(eu&&eu.rect)Gu=eu.rect,Pu=eu.metrics;else{const ch=Xi[wr.fontStack],sA=ch&&ch[nl];if(!sA)continue;Pu=sA.metrics}rl=(Kn-wr.scale)*eo}qu?(_i.verticalizable=!0,va.push({glyph:nl,imageName:zl,x:Vr,y:Hr+rl,vertical:qu,scale:wr.scale,fontStack:wr.fontStack,sectionIndex:wo,metrics:Pu,rect:Gu}),Vr+=Fc*wr.scale+Dn):(va.push({glyph:nl,imageName:zl,x:Vr,y:Hr+rl,vertical:qu,scale:wr.scale,fontStack:wr.fontStack,sectionIndex:wo,metrics:Pu,rect:Gu}),Vr+=Pu.advance*wr.scale+Dn)}va.length!==0&&(Rs=Math.max(Vr-Dn,Rs),Vm(va,0,va.length-1,ia,qo)),Vr=0;const uo=fn*Kn+qo;to.lineOffset=Math.max(qo,za),Hr+=uo,Ta=Math.max(uo,Ta),++as}var Wn;const Is=Hr-RA,{horizontalAlign:tr,verticalAlign:na}=_d(zn);(function(Ls,Kn,za,to,va,qo,uo,ra,wr){const wo=(Kn-za)*va;let nl=0;nl=qo!==uo?-ra*to-RA:(-to*wr+.5)*uo;for(const rl of Ls)for(const Pu of rl.positionedGlyphs)Pu.x+=wo,Pu.y+=nl})(_i.positionedLines,ia,tr,na,Rs,Ta,fn,Is,on.length),_i.top+=-na*Is,_i.bottom=_i.top+Is,_i.left+=-tr*Rs,_i.right=_i.left+Rs}(hi,u,p,I,Lt,Q,re,Ae,qe,_e,tt,Mt),!function(_i){for(const Xi of _i)if(Xi.positionedGlyphs.length!==0)return!1;return!0}(Qt)&&hi}const I0={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Nm={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function md(f,u,p,I,L,G){if(u.imageName){const Q=I[u.imageName];return Q?Q.displaySize[0]*u.scale*eo/G+L:0}{const Q=p[u.fontStack],re=Q&&Q[f];return re?re.metrics.advance*u.scale+L:0}}function kh(f,u,p,I){const L=Math.pow(f-u,2);return I?f<u?L/2:2*L:L+Math.abs(p)*p}function Lc(f,u,p){let I=0;return f===10&&(I-=1e4),p&&(I+=150),f!==40&&f!==65288||(I+=50),u!==41&&u!==65289||(I+=50),I}function sh(f,u,p,I,L,G){let Q=null,re=kh(u,p,L,G);for(const Ae of I){const _e=kh(u-Ae.x,p,L,G)+Ae.badness;_e<=re&&(Q=Ae,re=_e)}return{index:f,x:u,priorBreak:Q,badness:re}}function gd(f){return f?gd(f.priorBreak).concat(f.index):[]}function kf(f,u,p,I,L,G,Q){if(G!=="point")return[];if(!f)return[];const re=[],Ae=function(tt,ft,gt,Mt,Pt,Lt){let ei=0;for(let Ht=0;Ht<tt.length();Ht++){const Qt=tt.getSection(Ht);ei+=md(tt.getCharCode(Ht),Qt,Mt,Pt,ft,Lt)}return ei/Math.max(1,Math.ceil(ei/gt))}(f,u,p,I,L,Q),_e=f.text.indexOf("")>=0;let Le=0;for(let tt=0;tt<f.length();tt++){const ft=f.getSection(tt),gt=f.getCharCode(tt);if(I0[gt]||(Le+=md(gt,ft,I,L,u,Q)),tt<f.length()-1){const Mt=!((qe=gt)<11904||!(En["Bopomofo Extended"](qe)||En.Bopomofo(qe)||En["CJK Compatibility Forms"](qe)||En["CJK Compatibility Ideographs"](qe)||En["CJK Compatibility"](qe)||En["CJK Radicals Supplement"](qe)||En["CJK Strokes"](qe)||En["CJK Symbols and Punctuation"](qe)||En["CJK Unified Ideographs Extension A"](qe)||En["CJK Unified Ideographs"](qe)||En["Enclosed CJK Letters and Months"](qe)||En["Halfwidth and Fullwidth Forms"](qe)||En.Hiragana(qe)||En["Ideographic Description Characters"](qe)||En["Kangxi Radicals"](qe)||En["Katakana Phonetic Extensions"](qe)||En.Katakana(qe)||En["Vertical Forms"](qe)||En["Yi Radicals"](qe)||En["Yi Syllables"](qe)));(Nm[gt]||Mt||ft.imageName)&&re.push(sh(tt+1,Le,Ae,re,Lc(gt,f.getCharCode(tt+1),Mt&&_e),!1))}}var qe;return gd(sh(f.length(),Le,Ae,re,0,!0))}function _d(f){let u=.5,p=.5;switch(f){case"right":case"top-right":case"bottom-right":u=1;break;case"left":case"top-left":case"bottom-left":u=0}switch(f){case"bottom":case"bottom-right":case"bottom-left":p=1;break;case"top":case"top-right":case"top-left":p=0}return{horizontalAlign:u,verticalAlign:p}}function Vm(f,u,p,I,L){if(!I&&!L)return;const G=f[p],Q=(f[p].x+G.metrics.advance*G.scale)*I;for(let re=u;re<=p;re++)f[re].x-=Q,f[re].y+=L}function E0(f,u,p){const{horizontalAlign:I,verticalAlign:L}=_d(p),G=u[0]-f.displaySize[0]*I,Q=u[1]-f.displaySize[1]*L;return{image:f,top:Q,bottom:Q+f.displaySize[1],left:G,right:G+f.displaySize[0]}}function C0(f,u,p,I,L,G){const Q=f.image;let re;if(Q.content){const Pt=Q.content,Lt=Q.pixelRatio||1;re=[Pt[0]/Lt,Pt[1]/Lt,Q.displaySize[0]-Pt[2]/Lt,Q.displaySize[1]-Pt[3]/Lt]}const Ae=u.left*G,_e=u.right*G;let Le,qe,tt,ft;p==="width"||p==="both"?(ft=L[0]+Ae-I[3],qe=L[0]+_e+I[1]):(ft=L[0]+(Ae+_e-Q.displaySize[0])/2,qe=ft+Q.displaySize[0]);const gt=u.top*G,Mt=u.bottom*G;return p==="height"||p==="both"?(Le=L[1]+gt-I[0],tt=L[1]+Mt+I[2]):(Le=L[1]+(gt+Mt-Q.displaySize[1])/2,tt=Le+Q.displaySize[1]),{image:Q,top:Le,right:qe,bottom:tt,left:ft,collisionPadding:re}}const Mf=255,Ku=128,Bc=Mf*Ku;function tA(f,u){const{expression:p}=u;if(p.kind==="constant")return{kind:"constant",layoutSize:p.evaluate(new gn(f+1))};if(p.kind==="source")return{kind:"source"};{const{zoomStops:I,interpolationType:L}=p;let G=0;for(;G<I.length&&I[G]<=f;)G++;G=Math.max(0,G-1);let Q=G;for(;Q<I.length&&I[Q]<f+1;)Q++;Q=Math.min(I.length-1,Q);const re=I[G],Ae=I[Q];return p.kind==="composite"?{kind:"composite",minZoom:re,maxZoom:Ae,interpolationType:L}:{kind:"camera",minZoom:re,maxZoom:Ae,minSize:p.evaluate(new gn(re)),maxSize:p.evaluate(new gn(Ae)),interpolationType:L}}}function T0(f,u,p){let I="never";const L=f.get(u);return L?I=L:f.get(p)&&(I="always"),I}const Pp=Ih.VectorTileFeature.types,yd=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Pf(f,u,p,I,L,G,Q,re,Ae,_e,Le,qe,tt){const ft=re?Math.min(Bc,Math.round(re[0])):0,gt=re?Math.min(Bc,Math.round(re[1])):0;f.emplaceBack(u,p,Math.round(32*I),Math.round(32*L),G,Q,(ft<<1)+(Ae?1:0),gt,16*_e,16*Le,256*qe,256*tt)}function NA(f,u,p){f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p)}function Dp(f){for(const u of f.sections)if(ta(u.text))return!0;return!1}class vd{constructor(u){this.layoutVertexArray=new Qi,this.indexArray=new Bn,this.programConfigurations=u,this.segments=new er,this.dynamicLayoutVertexArray=new Si,this.opacityVertexArray=new Ui,this.hasVisibleVertices=!1,this.placedSymbolArray=new ue}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(u,p,I,L){this.isEmpty()||(I&&(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,ld.members),this.indexBuffer=u.createIndexBuffer(this.indexArray,p),this.dynamicLayoutVertexBuffer=u.createVertexBuffer(this.dynamicLayoutVertexArray,ud.members,!0),this.opacityVertexBuffer=u.createVertexBuffer(this.opacityVertexArray,yd,!0),this.opacityVertexBuffer.itemSize=1),(I||L)&&this.programConfigurations.upload(u))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Pn("SymbolBuffers",vd);class xd{constructor(u,p,I){this.layoutVertexArray=new u,this.layoutAttributes=p,this.indexArray=new I,this.segments=new er,this.collisionVertexArray=new un}upload(u){this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=u.createVertexBuffer(this.collisionVertexArray,da.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Pn("CollisionBuffers",xd);class ah{constructor(u){this.collisionBoxArray=u.collisionBoxArray,this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(Q=>Q.id),this.index=u.index,this.pixelRatio=u.pixelRatio,this.sourceLayerIndex=u.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=jh([]),this.placementViewportMatrix=jh([]);const p=this.layers[0]._unevaluatedLayout._values;this.textSizeData=tA(this.zoom,p["text-size"]),this.iconSizeData=tA(this.zoom,p["icon-size"]);const I=this.layers[0].layout,L=I.get("symbol-sort-key"),G=I.get("symbol-z-order");this.canOverlap=T0(I,"text-overlap","text-allow-overlap")!=="never"||T0(I,"icon-overlap","icon-allow-overlap")!=="never"||I.get("text-ignore-placement")||I.get("icon-ignore-placement"),this.sortFeaturesByKey=G!=="viewport-y"&&!L.isConstant(),this.sortFeaturesByY=(G==="viewport-y"||G==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,I.get("symbol-placement")==="point"&&(this.writingModes=I.get("text-writing-mode").map(Q=>a.ai[Q])),this.stateDependentLayerIds=this.layers.filter(Q=>Q.isStateDependent()).map(Q=>Q.id),this.sourceID=u.sourceID}createArrays(){this.text=new vd(new Au(this.layers,this.zoom,u=>/^text/.test(u))),this.icon=new vd(new Au(this.layers,this.zoom,u=>/^icon/.test(u))),this.glyphOffsetArray=new Re,this.lineVertexArray=new Be,this.symbolInstances=new Te,this.textAnchorOffsets=new vt}calculateGlyphDependencies(u,p,I,L,G){for(let Q=0;Q<u.length;Q++)if(p[u.charCodeAt(Q)]=!0,(I||L)&&G){const re=wu[u.charAt(Q)];re&&(p[re.charCodeAt(0)]=!0)}}populate(u,p,I){const L=this.layers[0],G=L.layout,Q=G.get("text-font"),re=G.get("text-field"),Ae=G.get("icon-image"),_e=(re.value.kind!=="constant"||re.value.value instanceof Wt&&!re.value.value.isEmpty()||re.value.value.toString().length>0)&&(Q.value.kind!=="constant"||Q.value.value.length>0),Le=Ae.value.kind!=="constant"||!!Ae.value.value||Object.keys(Ae.parameters).length>0,qe=G.get("symbol-sort-key");if(this.features=[],!_e&&!Le)return;const tt=p.iconDependencies,ft=p.glyphDependencies,gt=p.availableImages,Mt=new gn(this.zoom);for(const{feature:Pt,id:Lt,index:ei,sourceLayerIndex:Ht}of u){const Qt=L._featureFilter.needGeometry,hi=Cc(Pt,Qt);if(!L._featureFilter.filter(Mt,hi,I))continue;let _i,Xi;if(Qt||(hi.geometry=Uh(Pt)),_e){const ln=L.getValueAndResolveTokens("text-field",hi,I,gt),on=Wt.factory(ln);Dp(on)&&(this.hasRTLText=!0),(!this.hasRTLText||Vu()==="unavailable"||this.hasRTLText&&gs.isParsed())&&(_i=MA(on,L,hi))}if(Le){const ln=L.getValueAndResolveTokens("icon-image",hi,I,gt);Xi=ln instanceof cr?ln:cr.fromString(ln)}if(!_i&&!Xi)continue;const Sn=this.sortFeaturesByKey?qe.evaluate(hi,{},I):void 0;if(this.features.push({id:Lt,text:_i,icon:Xi,index:ei,sourceLayerIndex:Ht,geometry:hi.geometry,properties:Pt.properties,type:Pp[Pt.type],sortKey:Sn}),Xi&&(tt[Xi.name]=!0),_i){const ln=Q.evaluate(hi,{},I).join(","),on=G.get("text-rotation-alignment")!=="viewport"&&G.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(a.ai.vertical)>=0;for(const fn of _i.sections)if(fn.image)tt[fn.image.name]=!0;else{const zn=$l(_i.toString()),an=fn.fontStack||ln,$i=ft[an]=ft[an]||{};this.calculateGlyphDependencies(fn.text,$i,on,this.allowVerticalPlacement,zn)}}}G.get("symbol-placement")==="line"&&(this.features=function(Pt){const Lt={},ei={},Ht=[];let Qt=0;function hi(ln){Ht.push(Pt[ln]),Qt++}function _i(ln,on,fn){const zn=ei[ln];return delete ei[ln],ei[on]=zn,Ht[zn].geometry[0].pop(),Ht[zn].geometry[0]=Ht[zn].geometry[0].concat(fn[0]),zn}function Xi(ln,on,fn){const zn=Lt[on];return delete Lt[on],Lt[ln]=zn,Ht[zn].geometry[0].shift(),Ht[zn].geometry[0]=fn[0].concat(Ht[zn].geometry[0]),zn}function Sn(ln,on,fn){const zn=fn?on[0][on[0].length-1]:on[0][0];return`${ln}:${zn.x}:${zn.y}`}for(let ln=0;ln<Pt.length;ln++){const on=Pt[ln],fn=on.geometry,zn=on.text?on.text.toString():null;if(!zn){hi(ln);continue}const an=Sn(zn,fn),$i=Sn(zn,fn,!0);if(an in ei&&$i in Lt&&ei[an]!==Lt[$i]){const Dn=Xi(an,$i,fn),Nn=_i(an,$i,Ht[Dn].geometry);delete Lt[an],delete ei[$i],ei[Sn(zn,Ht[Nn].geometry,!0)]=Nn,Ht[Dn].geometry=null}else an in ei?_i(an,$i,fn):$i in Lt?Xi(an,$i,fn):(hi(ln),Lt[an]=Qt-1,ei[$i]=Qt-1)}return Ht.filter(ln=>ln.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Pt,Lt)=>Pt.sortKey-Lt.sortKey)}update(u,p,I){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(u,p,this.layers,I),this.icon.programConfigurations.updatePaintArrays(u,p,this.layers,I))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(u){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(u),this.iconCollisionBox.upload(u)),this.text.upload(u,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(u,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(u,p){const I=this.lineVertexArray.length;if(u.segment!==void 0){let L=u.dist(p[u.segment+1]),G=u.dist(p[u.segment]);const Q={};for(let re=u.segment+1;re<p.length;re++)Q[re]={x:p[re].x,y:p[re].y,tileUnitDistanceFromAnchor:L},re<p.length-1&&(L+=p[re+1].dist(p[re]));for(let re=u.segment||0;re>=0;re--)Q[re]={x:p[re].x,y:p[re].y,tileUnitDistanceFromAnchor:G},re>0&&(G+=p[re-1].dist(p[re]));for(let re=0;re<p.length;re++){const Ae=Q[re];this.lineVertexArray.emplaceBack(Ae.x,Ae.y,Ae.tileUnitDistanceFromAnchor)}}return{lineStartIndex:I,lineLength:this.lineVertexArray.length-I}}addSymbols(u,p,I,L,G,Q,re,Ae,_e,Le,qe,tt){const ft=u.indexArray,gt=u.layoutVertexArray,Mt=u.segments.prepareSegment(4*p.length,gt,ft,this.canOverlap?Q.sortKey:void 0),Pt=this.glyphOffsetArray.length,Lt=Mt.vertexLength,ei=this.allowVerticalPlacement&&re===a.ai.vertical?Math.PI/2:0,Ht=Q.text&&Q.text.sections;for(let Qt=0;Qt<p.length;Qt++){const{tl:hi,tr:_i,bl:Xi,br:Sn,tex:ln,pixelOffsetTL:on,pixelOffsetBR:fn,minFontScaleX:zn,minFontScaleY:an,glyphOffset:$i,isSDF:Dn,sectionIndex:Nn}=p[Qt],pr=Mt.vertexLength,Vr=$i[1];Pf(gt,Ae.x,Ae.y,hi.x,Vr+hi.y,ln.x,ln.y,I,Dn,on.x,on.y,zn,an),Pf(gt,Ae.x,Ae.y,_i.x,Vr+_i.y,ln.x+ln.w,ln.y,I,Dn,fn.x,on.y,zn,an),Pf(gt,Ae.x,Ae.y,Xi.x,Vr+Xi.y,ln.x,ln.y+ln.h,I,Dn,on.x,fn.y,zn,an),Pf(gt,Ae.x,Ae.y,Sn.x,Vr+Sn.y,ln.x+ln.w,ln.y+ln.h,I,Dn,fn.x,fn.y,zn,an),NA(u.dynamicLayoutVertexArray,Ae,ei),ft.emplaceBack(pr,pr+1,pr+2),ft.emplaceBack(pr+1,pr+2,pr+3),Mt.vertexLength+=4,Mt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack($i[0]),Qt!==p.length-1&&Nn===p[Qt+1].sectionIndex||u.programConfigurations.populatePaintArrays(gt.length,Q,Q.index,{},tt,Ht&&Ht[Nn])}u.placedSymbolArray.emplaceBack(Ae.x,Ae.y,Pt,this.glyphOffsetArray.length-Pt,Lt,_e,Le,Ae.segment,I?I[0]:0,I?I[1]:0,L[0],L[1],re,0,!1,0,qe)}_addCollisionDebugVertex(u,p,I,L,G,Q){return p.emplaceBack(0,0),u.emplaceBack(I.x,I.y,L,G,Math.round(Q.x),Math.round(Q.y))}addCollisionDebugVertices(u,p,I,L,G,Q,re){const Ae=G.segments.prepareSegment(4,G.layoutVertexArray,G.indexArray),_e=Ae.vertexLength,Le=G.layoutVertexArray,qe=G.collisionVertexArray,tt=re.anchorX,ft=re.anchorY;this._addCollisionDebugVertex(Le,qe,Q,tt,ft,new ce(u,p)),this._addCollisionDebugVertex(Le,qe,Q,tt,ft,new ce(I,p)),this._addCollisionDebugVertex(Le,qe,Q,tt,ft,new ce(I,L)),this._addCollisionDebugVertex(Le,qe,Q,tt,ft,new ce(u,L)),Ae.vertexLength+=4;const gt=G.indexArray;gt.emplaceBack(_e,_e+1),gt.emplaceBack(_e+1,_e+2),gt.emplaceBack(_e+2,_e+3),gt.emplaceBack(_e+3,_e),Ae.primitiveLength+=4}addDebugCollisionBoxes(u,p,I,L){for(let G=u;G<p;G++){const Q=this.collisionBoxArray.get(G);this.addCollisionDebugVertices(Q.x1,Q.y1,Q.x2,Q.y2,L?this.textCollisionBox:this.iconCollisionBox,Q.anchorPoint,I)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new xd(Gi,kA.members,en),this.iconCollisionBox=new xd(Gi,kA.members,en);for(let u=0;u<this.symbolInstances.length;u++){const p=this.symbolInstances.get(u);this.addDebugCollisionBoxes(p.textBoxStartIndex,p.textBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.iconBoxStartIndex,p.iconBoxEndIndex,p,!1),this.addDebugCollisionBoxes(p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p,!1)}}_deserializeCollisionBoxesForSymbol(u,p,I,L,G,Q,re,Ae,_e){const Le={};for(let qe=p;qe<I;qe++){const tt=u.get(qe);Le.textBox={x1:tt.x1,y1:tt.y1,x2:tt.x2,y2:tt.y2,anchorPointX:tt.anchorPointX,anchorPointY:tt.anchorPointY},Le.textFeatureIndex=tt.featureIndex;break}for(let qe=L;qe<G;qe++){const tt=u.get(qe);Le.verticalTextBox={x1:tt.x1,y1:tt.y1,x2:tt.x2,y2:tt.y2,anchorPointX:tt.anchorPointX,anchorPointY:tt.anchorPointY},Le.verticalTextFeatureIndex=tt.featureIndex;break}for(let qe=Q;qe<re;qe++){const tt=u.get(qe);Le.iconBox={x1:tt.x1,y1:tt.y1,x2:tt.x2,y2:tt.y2,anchorPointX:tt.anchorPointX,anchorPointY:tt.anchorPointY},Le.iconFeatureIndex=tt.featureIndex;break}for(let qe=Ae;qe<_e;qe++){const tt=u.get(qe);Le.verticalIconBox={x1:tt.x1,y1:tt.y1,x2:tt.x2,y2:tt.y2,anchorPointX:tt.anchorPointX,anchorPointY:tt.anchorPointY},Le.verticalIconFeatureIndex=tt.featureIndex;break}return Le}deserializeCollisionBoxes(u){this.collisionArrays=[];for(let p=0;p<this.symbolInstances.length;p++){const I=this.symbolInstances.get(p);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(u,I.textBoxStartIndex,I.textBoxEndIndex,I.verticalTextBoxStartIndex,I.verticalTextBoxEndIndex,I.iconBoxStartIndex,I.iconBoxEndIndex,I.verticalIconBoxStartIndex,I.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(u,p){const I=u.placedSymbolArray.get(p),L=I.vertexStartIndex+4*I.numGlyphs;for(let G=I.vertexStartIndex;G<L;G+=4)u.indexArray.emplaceBack(G,G+1,G+2),u.indexArray.emplaceBack(G+1,G+2,G+3)}getSortedSymbolIndexes(u){if(this.sortedAngle===u&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const p=Math.sin(u),I=Math.cos(u),L=[],G=[],Q=[];for(let re=0;re<this.symbolInstances.length;++re){Q.push(re);const Ae=this.symbolInstances.get(re);L.push(0|Math.round(p*Ae.anchorX+I*Ae.anchorY)),G.push(Ae.featureIndex)}return Q.sort((re,Ae)=>L[re]-L[Ae]||G[Ae]-G[re]),Q}addToSortKeyRanges(u,p){const I=this.sortKeyRanges[this.sortKeyRanges.length-1];I&&I.sortKey===p?I.symbolInstanceEnd=u+1:this.sortKeyRanges.push({sortKey:p,symbolInstanceStart:u,symbolInstanceEnd:u+1})}sortFeatures(u){if(this.sortFeaturesByY&&this.sortedAngle!==u&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(u),this.sortedAngle=u,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const p of this.symbolInstanceIndexes){const I=this.symbolInstances.get(p);this.featureSortOrder.push(I.featureIndex),[I.rightJustifiedTextSymbolIndex,I.centerJustifiedTextSymbolIndex,I.leftJustifiedTextSymbolIndex].forEach((L,G,Q)=>{L>=0&&Q.indexOf(L)===G&&this.addIndicesForPlacedSymbol(this.text,L)}),I.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,I.verticalPlacedTextSymbolIndex),I.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,I.placedIconSymbolIndex),I.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,I.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let bd,Lp;Pn("SymbolBucket",ah,{omit:["layers","collisionBoxArray","features","compareText"]}),ah.MAX_GLYPHS=65535,ah.addDynamicAttributes=NA;var wd={get paint(){return Lp=Lp||new fs({"icon-opacity":new Li(ci.paint_symbol["icon-opacity"]),"icon-color":new Li(ci.paint_symbol["icon-color"]),"icon-halo-color":new Li(ci.paint_symbol["icon-halo-color"]),"icon-halo-width":new Li(ci.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Li(ci.paint_symbol["icon-halo-blur"]),"icon-translate":new ki(ci.paint_symbol["icon-translate"]),"icon-translate-anchor":new ki(ci.paint_symbol["icon-translate-anchor"]),"text-opacity":new Li(ci.paint_symbol["text-opacity"]),"text-color":new Li(ci.paint_symbol["text-color"],{runtimeType:dt,getOverride:f=>f.textColor,hasOverride:f=>!!f.textColor}),"text-halo-color":new Li(ci.paint_symbol["text-halo-color"]),"text-halo-width":new Li(ci.paint_symbol["text-halo-width"]),"text-halo-blur":new Li(ci.paint_symbol["text-halo-blur"]),"text-translate":new ki(ci.paint_symbol["text-translate"]),"text-translate-anchor":new ki(ci.paint_symbol["text-translate-anchor"])})},get layout(){return bd=bd||new fs({"symbol-placement":new ki(ci.layout_symbol["symbol-placement"]),"symbol-spacing":new ki(ci.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ki(ci.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Li(ci.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ki(ci.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ki(ci.layout_symbol["icon-allow-overlap"]),"icon-overlap":new ki(ci.layout_symbol["icon-overlap"]),"icon-ignore-placement":new ki(ci.layout_symbol["icon-ignore-placement"]),"icon-optional":new ki(ci.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ki(ci.layout_symbol["icon-rotation-alignment"]),"icon-size":new Li(ci.layout_symbol["icon-size"]),"icon-text-fit":new ki(ci.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ki(ci.layout_symbol["icon-text-fit-padding"]),"icon-image":new Li(ci.layout_symbol["icon-image"]),"icon-rotate":new Li(ci.layout_symbol["icon-rotate"]),"icon-padding":new Li(ci.layout_symbol["icon-padding"]),"icon-keep-upright":new ki(ci.layout_symbol["icon-keep-upright"]),"icon-offset":new Li(ci.layout_symbol["icon-offset"]),"icon-anchor":new Li(ci.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ki(ci.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ki(ci.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ki(ci.layout_symbol["text-rotation-alignment"]),"text-field":new Li(ci.layout_symbol["text-field"]),"text-font":new Li(ci.layout_symbol["text-font"]),"text-size":new Li(ci.layout_symbol["text-size"]),"text-max-width":new Li(ci.layout_symbol["text-max-width"]),"text-line-height":new ki(ci.layout_symbol["text-line-height"]),"text-letter-spacing":new Li(ci.layout_symbol["text-letter-spacing"]),"text-justify":new Li(ci.layout_symbol["text-justify"]),"text-radial-offset":new Li(ci.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ki(ci.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Li(ci.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Li(ci.layout_symbol["text-anchor"]),"text-max-angle":new ki(ci.layout_symbol["text-max-angle"]),"text-writing-mode":new ki(ci.layout_symbol["text-writing-mode"]),"text-rotate":new Li(ci.layout_symbol["text-rotate"]),"text-padding":new ki(ci.layout_symbol["text-padding"]),"text-keep-upright":new ki(ci.layout_symbol["text-keep-upright"]),"text-transform":new Li(ci.layout_symbol["text-transform"]),"text-offset":new Li(ci.layout_symbol["text-offset"]),"text-allow-overlap":new ki(ci.layout_symbol["text-allow-overlap"]),"text-overlap":new ki(ci.layout_symbol["text-overlap"]),"text-ignore-placement":new ki(ci.layout_symbol["text-ignore-placement"]),"text-optional":new ki(ci.layout_symbol["text-optional"])})}};class Bp{constructor(u){if(u.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=u.property.overrides?u.property.overrides.runtimeType:Qe,this.defaultValue=u}evaluate(u){if(u.formattedSection){const p=this.defaultValue.property.overrides;if(p&&p.hasOverride(u.formattedSection))return p.getOverride(u.formattedSection)}return u.feature&&u.featureState?this.defaultValue.evaluate(u.feature,u.featureState):this.defaultValue.property.specification.default}eachChild(u){this.defaultValue.isConstant()||u(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Pn("FormatSectionOverride",Bp,{omit:["defaultValue"]});class VA extends Ds{constructor(u){super(u,wd)}recalculate(u,p){if(super.recalculate(u,p),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const I=this.layout.get("text-writing-mode");if(I){const L=[];for(const G of I)L.indexOf(G)<0&&L.push(G);this.layout._values["text-writing-mode"]=L}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(u,p,I,L){const G=this.layout.get(u).evaluate(p,{},I,L),Q=this._unevaluatedLayout._values[u];return Q.isDataDriven()||ns(Q.value)||!G?G:function(re,Ae){return Ae.replace(/{([^{}]+)}/g,(_e,Le)=>re&&Le in re?String(re[Le]):"")}(p.properties,G)}createBucket(u){return new ah(u)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const u of wd.paint.overridableProperties){if(!VA.hasPaintOverride(this.layout,u))continue;const p=this.paint.get(u),I=new Bp(p),L=new Ol(I,p.property.specification);let G=null;G=p.value.kind==="constant"||p.value.kind==="source"?new Ms("source",L):new Mr("composite",L,p.value.zoomStops),this.paint._values[u]=new bs(p.property,G,p.parameters)}}_handleOverridablePaintPropertyUpdate(u,p,I){return!(!this.layout||p.isDataDriven()||I.isDataDriven())&&VA.hasPaintOverride(this.layout,u)}static hasPaintOverride(u,p){const I=u.get("text-field"),L=wd.paint.properties[p];let G=!1;const Q=re=>{for(const Ae of re)if(L.overrides&&L.overrides.hasOverride(Ae))return void(G=!0)};if(I.value.kind==="constant"&&I.value.value instanceof Wt)Q(I.value.value.sections);else if(I.value.kind==="source"){const re=_e=>{G||(_e instanceof Dt&&Vt(_e.value)===ne?Q(_e.value.sections):_e instanceof so?Q(_e.sections):_e.eachChild(re))},Ae=I.value;Ae._styleExpression&&re(Ae._styleExpression.expression)}return G}}let oh;var zp={get paint(){return oh=oh||new fs({"background-color":new ki(ci.paint_background["background-color"]),"background-pattern":new vu(ci.paint_background["background-pattern"]),"background-opacity":new ki(ci.paint_background["background-opacity"])})}};class Rp extends Ds{constructor(u){super(u,zp)}}let Sd;var Id={get paint(){return Sd=Sd||new fs({"raster-opacity":new ki(ci.paint_raster["raster-opacity"]),"raster-hue-rotate":new ki(ci.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ki(ci.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ki(ci.paint_raster["raster-brightness-max"]),"raster-saturation":new ki(ci.paint_raster["raster-saturation"]),"raster-contrast":new ki(ci.paint_raster["raster-contrast"]),"raster-resampling":new ki(ci.paint_raster["raster-resampling"]),"raster-fade-duration":new ki(ci.paint_raster["raster-fade-duration"])})}};class Fp extends Ds{constructor(u){super(u,Id)}}class UA extends Ds{constructor(u){super(u,{}),this.onAdd=p=>{this.implementation.onAdd&&this.implementation.onAdd(p,p.painter.context.gl)},this.onRemove=p=>{this.implementation.onRemove&&this.implementation.onRemove(p,p.painter.context.gl)},this.implementation=u}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class k0{constructor(u){this._callback=u,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const M0=63710088e-1;class zc{constructor(u,p){if(isNaN(u)||isNaN(p))throw new Error(`Invalid LngLat object: (${u}, ${p})`);if(this.lng=+u,this.lat=+p,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new zc(jt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(u){const p=Math.PI/180,I=this.lat*p,L=u.lat*p,G=Math.sin(I)*Math.sin(L)+Math.cos(I)*Math.cos(L)*Math.cos((u.lng-this.lng)*p);return M0*Math.acos(Math.min(G,1))}static convert(u){if(u instanceof zc)return u;if(Array.isArray(u)&&(u.length===2||u.length===3))return new zc(Number(u[0]),Number(u[1]));if(!Array.isArray(u)&&typeof u=="object"&&u!==null)return new zc(Number("lng"in u?u.lng:u.lon),Number(u.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Ed=2*Math.PI*M0;function Mu(f){return Ed*Math.cos(f*Math.PI/180)}function GA(f){return(180+f)/360}function Cd(f){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f*Math.PI/360)))/360}function Td(f,u){return f/Mu(u)}function kd(f){return 360*f-180}function P0(f){return 360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90}class Df{constructor(u,p,I=0){this.x=+u,this.y=+p,this.z=+I}static fromLngLat(u,p=0){const I=zc.convert(u);return new Df(GA(I.lng),Cd(I.lat),Td(p,I.lat))}toLngLat(){return new zc(kd(this.x),P0(this.y))}toAltitude(){return this.z*Mu(P0(this.y))}meterInMercatorCoordinateUnits(){return 1/Ed*(u=P0(this.y),1/Math.cos(u*Math.PI/180));var u}}function Md(f,u,p){var I=2*Math.PI*6378137/256/Math.pow(2,p);return[f*I-2*Math.PI*6378137/2,u*I-2*Math.PI*6378137/2]}class Pd{constructor(u,p,I){if(u<0||u>25||I<0||I>=Math.pow(2,u)||p<0||p>=Math.pow(2,u))throw new Error(`x=${p}, y=${I}, z=${u} outside of bounds. 0<=x<${Math.pow(2,u)}, 0<=y<${Math.pow(2,u)} 0<=z<=25 `);this.z=u,this.x=p,this.y=I,this.key=qA(0,u,u,p,I)}equals(u){return this.z===u.z&&this.x===u.x&&this.y===u.y}url(u,p,I){const L=(Q=this.y,re=this.z,Ae=Md(256*(G=this.x),256*(Q=Math.pow(2,re)-Q-1),re),_e=Md(256*(G+1),256*(Q+1),re),Ae[0]+","+Ae[1]+","+_e[0]+","+_e[1]);var G,Q,re,Ae,_e;const Le=function(qe,tt,ft){let gt,Mt="";for(let Pt=qe;Pt>0;Pt--)gt=1<<Pt-1,Mt+=(tt&gt?1:0)+(ft&gt?2:0);return Mt}(this.z,this.x,this.y);return u[(this.x+this.y)%u.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(I==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,p>1?"@2x":"").replace(/{quadkey}/g,Le).replace(/{bbox-epsg-3857}/g,L)}isChildOf(u){const p=this.z-u.z;return p>0&&u.x===this.x>>p&&u.y===this.y>>p}getTilePoint(u){const p=Math.pow(2,this.z);return new ce((u.x*p-this.x)*La,(u.y*p-this.y)*La)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Dd{constructor(u,p){this.wrap=u,this.canonical=p,this.key=qA(u,p.z,p.z,p.x,p.y)}}class bl{constructor(u,p,I,L,G){if(u<I)throw new Error(`overscaledZ should be >= z; overscaledZ = ${u}; z = ${I}`);this.overscaledZ=u,this.wrap=p,this.canonical=new Pd(I,+L,+G),this.key=qA(p,u,I,L,G)}clone(){return new bl(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(u){return this.overscaledZ===u.overscaledZ&&this.wrap===u.wrap&&this.canonical.equals(u.canonical)}scaledTo(u){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-u;return u>this.canonical.z?new bl(u,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new bl(u,this.wrap,u,this.canonical.x>>p,this.canonical.y>>p)}calculateScaledKey(u,p){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const I=this.canonical.z-u;return u>this.canonical.z?qA(this.wrap*+p,u,this.canonical.z,this.canonical.x,this.canonical.y):qA(this.wrap*+p,u,u,this.canonical.x>>I,this.canonical.y>>I)}isChildOf(u){if(u.wrap!==this.wrap)return!1;const p=this.canonical.z-u.canonical.z;return u.overscaledZ===0||u.overscaledZ<this.overscaledZ&&u.canonical.x===this.canonical.x>>p&&u.canonical.y===this.canonical.y>>p}children(u){if(this.overscaledZ>=u)return[new bl(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const p=this.canonical.z+1,I=2*this.canonical.x,L=2*this.canonical.y;return[new bl(p,this.wrap,p,I,L),new bl(p,this.wrap,p,I+1,L),new bl(p,this.wrap,p,I,L+1),new bl(p,this.wrap,p,I+1,L+1)]}isLessThan(u){return this.wrap<u.wrap||!(this.wrap>u.wrap)&&(this.overscaledZ<u.overscaledZ||!(this.overscaledZ>u.overscaledZ)&&(this.canonical.x<u.canonical.x||!(this.canonical.x>u.canonical.x)&&this.canonical.y<u.canonical.y))}wrapped(){return new bl(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(u){return new bl(this.overscaledZ,u,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Dd(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(u){return this.canonical.getTilePoint(new Df(u.x-this.wrap,u.y))}}function qA(f,u,p,I,L){(f*=2)<0&&(f=-1*f-1);const G=1<<p;return(G*G*f+G*L+I).toString(36)+p.toString(36)+u.toString(36)}Pn("CanonicalTileID",Pd),Pn("OverscaledTileID",bl,{omit:["posMatrix"]});class D0{constructor(u,p,I,L=1,G=1,Q=1,re=0){if(this.uid=u,p.height!==p.width)throw new RangeError("DEM tiles must be square");if(I&&!["mapbox","terrarium","custom"].includes(I))return void $e(`"${I}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=p.height;const Ae=this.dim=p.height-2;switch(this.data=new Uint32Array(p.data.buffer),I){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=L,this.greenFactor=G,this.blueFactor=Q,this.baseShift=re;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let _e=0;_e<Ae;_e++)this.data[this._idx(-1,_e)]=this.data[this._idx(0,_e)],this.data[this._idx(Ae,_e)]=this.data[this._idx(Ae-1,_e)],this.data[this._idx(_e,-1)]=this.data[this._idx(_e,0)],this.data[this._idx(_e,Ae)]=this.data[this._idx(_e,Ae-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(Ae,-1)]=this.data[this._idx(Ae-1,0)],this.data[this._idx(-1,Ae)]=this.data[this._idx(0,Ae-1)],this.data[this._idx(Ae,Ae)]=this.data[this._idx(Ae-1,Ae-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let _e=0;_e<Ae;_e++)for(let Le=0;Le<Ae;Le++){const qe=this.get(_e,Le);qe>this.max&&(this.max=qe),qe<this.min&&(this.min=qe)}}get(u,p){const I=new Uint8Array(this.data.buffer),L=4*this._idx(u,p);return this.unpack(I[L],I[L+1],I[L+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(u,p){if(u<-1||u>=this.dim+1||p<-1||p>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(p+1)*this.stride+(u+1)}unpack(u,p,I){return u*this.redFactor+p*this.greenFactor+I*this.blueFactor-this.baseShift}getPixels(){return new Ll({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(u,p,I){if(this.dim!==u.dim)throw new Error("dem dimension mismatch");let L=p*this.dim,G=p*this.dim+this.dim,Q=I*this.dim,re=I*this.dim+this.dim;switch(p){case-1:L=G-1;break;case 1:G=L+1}switch(I){case-1:Q=re-1;break;case 1:re=Q+1}const Ae=-p*this.dim,_e=-I*this.dim;for(let Le=Q;Le<re;Le++)for(let qe=L;qe<G;qe++)this.data[this._idx(qe,Le)]=u.data[this._idx(qe+Ae,Le+_e)]}}Pn("DEMData",D0);class L0{constructor(u){this._stringToNumber={},this._numberToString=[];for(let p=0;p<u.length;p++){const I=u[p];this._stringToNumber[I]=p,this._numberToString[p]=I}}encode(u){return this._stringToNumber[u]}decode(u){if(u>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${u} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[u]}}class Ld{constructor(u,p,I,L,G){this.type="Feature",this._vectorTileFeature=u,u._z=p,u._x=I,u._y=L,this.properties=u.properties,this.id=G}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(u){this._geometry=u}toJSON(){const u={geometry:this.geometry};for(const p in this)p!=="_geometry"&&p!=="_vectorTileFeature"&&(u[p]=this[p]);return u}}class Op{constructor(u,p){this.tileID=u,this.x=u.canonical.x,this.y=u.canonical.y,this.z=u.canonical.z,this.grid=new vo(La,16,0),this.grid3D=new vo(La,16,0),this.featureIndexArray=new ht,this.promoteId=p}insert(u,p,I,L,G,Q){const re=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(I,L,G);const Ae=Q?this.grid3D:this.grid;for(let _e=0;_e<p.length;_e++){const Le=p[_e],qe=[1/0,1/0,-1/0,-1/0];for(let tt=0;tt<Le.length;tt++){const ft=Le[tt];qe[0]=Math.min(qe[0],ft.x),qe[1]=Math.min(qe[1],ft.y),qe[2]=Math.max(qe[2],ft.x),qe[3]=Math.max(qe[3],ft.y)}qe[0]<La&&qe[1]<La&&qe[2]>=0&&qe[3]>=0&&Ae.insert(re,qe[0],qe[1],qe[2],qe[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Ih.VectorTile(new w0(this.rawTileData)).layers,this.sourceLayerCoder=new L0(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(u,p,I,L){this.loadVTLayers();const G=u.params||{},Q=La/u.tileSize/u.scale,re=Qr(G.filter),Ae=u.queryGeometry,_e=u.queryPadding*Q,Le=Bd(Ae),qe=this.grid.query(Le.minX-_e,Le.minY-_e,Le.maxX+_e,Le.maxY+_e),tt=Bd(u.cameraQueryGeometry),ft=this.grid3D.query(tt.minX-_e,tt.minY-_e,tt.maxX+_e,tt.maxY+_e,(Pt,Lt,ei,Ht)=>function(Qt,hi,_i,Xi,Sn){for(const on of Qt)if(hi<=on.x&&_i<=on.y&&Xi>=on.x&&Sn>=on.y)return!0;const ln=[new ce(hi,_i),new ce(hi,Sn),new ce(Xi,Sn),new ce(Xi,_i)];if(Qt.length>2){for(const on of ln)if(Yu(Qt,on))return!0}for(let on=0;on<Qt.length-1;on++)if(Z0(Qt[on],Qt[on+1],ln))return!0;return!1}(u.cameraQueryGeometry,Pt-_e,Lt-_e,ei+_e,Ht+_e));for(const Pt of ft)qe.push(Pt);qe.sort(lh);const gt={};let Mt;for(let Pt=0;Pt<qe.length;Pt++){const Lt=qe[Pt];if(Lt===Mt)continue;Mt=Lt;const ei=this.featureIndexArray.get(Lt);let Ht=null;this.loadMatchingFeature(gt,ei.bucketIndex,ei.sourceLayerIndex,ei.featureIndex,re,G.layers,G.availableImages,p,I,L,(Qt,hi,_i)=>(Ht||(Ht=Uh(Qt)),hi.queryIntersectsFeature(Ae,Qt,_i,Ht,this.z,u.transform,Q,u.pixelPosMatrix)))}return gt}loadMatchingFeature(u,p,I,L,G,Q,re,Ae,_e,Le,qe){const tt=this.bucketLayerIDs[p];if(Q&&!function(Pt,Lt){for(let ei=0;ei<Pt.length;ei++)if(Lt.indexOf(Pt[ei])>=0)return!0;return!1}(Q,tt))return;const ft=this.sourceLayerCoder.decode(I),gt=this.vtLayers[ft].feature(L);if(G.needGeometry){const Pt=Cc(gt,!0);if(!G.filter(new gn(this.tileID.overscaledZ),Pt,this.tileID.canonical))return}else if(!G.filter(new gn(this.tileID.overscaledZ),gt))return;const Mt=this.getId(gt,ft);for(let Pt=0;Pt<tt.length;Pt++){const Lt=tt[Pt];if(Q&&Q.indexOf(Lt)<0)continue;const ei=Ae[Lt];if(!ei)continue;let Ht={};Mt&&Le&&(Ht=Le.getState(ei.sourceLayer||"_geojsonTileLayer",Mt));const Qt=at({},_e[Lt]);Qt.paint=Np(Qt.paint,ei.paint,gt,Ht,re),Qt.layout=Np(Qt.layout,ei.layout,gt,Ht,re);const hi=!qe||qe(gt,ei,Ht);if(!hi)continue;const _i=new Ld(gt,this.z,this.x,this.y,Mt);_i.layer=Qt;let Xi=u[Lt];Xi===void 0&&(Xi=u[Lt]=[]),Xi.push({featureIndex:L,feature:_i,intersectionZ:hi})}}lookupSymbolFeatures(u,p,I,L,G,Q,re,Ae){const _e={};this.loadVTLayers();const Le=Qr(G);for(const qe of u)this.loadMatchingFeature(_e,I,L,qe,Le,Q,re,Ae,p);return _e}hasLayer(u){for(const p of this.bucketLayerIDs)for(const I of p)if(u===I)return!0;return!1}getId(u,p){let I=u.id;return this.promoteId&&(I=u.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[p]],typeof I=="boolean"&&(I=Number(I))),I}}function Np(f,u,p,I,L){return mt(f,(G,Q)=>{const re=u instanceof Lo?u.get(Q):null;return re&&re.evaluate?re.evaluate(p,I,L):re})}function Bd(f){let u=1/0,p=1/0,I=-1/0,L=-1/0;for(const G of f)u=Math.min(u,G.x),p=Math.min(p,G.y),I=Math.max(I,G.x),L=Math.max(L,G.y);return{minX:u,minY:p,maxX:I,maxY:L}}function lh(f,u){return u-f}function zd(f,u,p,I,L){const G=[];for(let Q=0;Q<f.length;Q++){const re=f[Q];let Ae;for(let _e=0;_e<re.length-1;_e++){let Le=re[_e],qe=re[_e+1];Le.x<u&&qe.x<u||(Le.x<u?Le=new ce(u,Le.y+(u-Le.x)/(qe.x-Le.x)*(qe.y-Le.y))._round():qe.x<u&&(qe=new ce(u,Le.y+(u-Le.x)/(qe.x-Le.x)*(qe.y-Le.y))._round()),Le.y<p&&qe.y<p||(Le.y<p?Le=new ce(Le.x+(p-Le.y)/(qe.y-Le.y)*(qe.x-Le.x),p)._round():qe.y<p&&(qe=new ce(Le.x+(p-Le.y)/(qe.y-Le.y)*(qe.x-Le.x),p)._round()),Le.x>=I&&qe.x>=I||(Le.x>=I?Le=new ce(I,Le.y+(I-Le.x)/(qe.x-Le.x)*(qe.y-Le.y))._round():qe.x>=I&&(qe=new ce(I,Le.y+(I-Le.x)/(qe.x-Le.x)*(qe.y-Le.y))._round()),Le.y>=L&&qe.y>=L||(Le.y>=L?Le=new ce(Le.x+(L-Le.y)/(qe.y-Le.y)*(qe.x-Le.x),L)._round():qe.y>=L&&(qe=new ce(Le.x+(L-Le.y)/(qe.y-Le.y)*(qe.x-Le.x),L)._round()),Ae&&Le.equals(Ae[Ae.length-1])||(Ae=[Le],G.push(Ae)),Ae.push(qe)))))}}return G}Pn("FeatureIndex",Op,{omit:["rawTileData","sourceLayerCoder"]});class Ac extends ce{constructor(u,p,I,L){super(u,p),this.angle=I,L!==void 0&&(this.segment=L)}clone(){return new Ac(this.x,this.y,this.angle,this.segment)}}function Rd(f,u,p,I,L){if(u.segment===void 0||p===0)return!0;let G=u,Q=u.segment+1,re=0;for(;re>-p/2;){if(Q--,Q<0)return!1;re-=f[Q].dist(G),G=f[Q]}re+=f[Q].dist(f[Q+1]),Q++;const Ae=[];let _e=0;for(;re<p/2;){const Le=f[Q],qe=f[Q+1];if(!qe)return!1;let tt=f[Q-1].angleTo(Le)-Le.angleTo(qe);for(tt=Math.abs((tt+3*Math.PI)%(2*Math.PI)-Math.PI),Ae.push({distance:re,angleDelta:tt}),_e+=tt;re-Ae[0].distance>I;)_e-=Ae.shift().angleDelta;if(_e>L)return!1;Q++,re+=Le.dist(qe)}return!0}function Lf(f){let u=0;for(let p=0;p<f.length-1;p++)u+=f[p].dist(f[p+1]);return u}function Bf(f,u,p){return f?.6*u*p:0}function zf(f,u){return Math.max(f?f.right-f.left:0,u?u.right-u.left:0)}function Um(f,u,p,I,L,G){const Q=Bf(p,L,G),re=zf(p,I)*G;let Ae=0;const _e=Lf(f)/2;for(let Le=0;Le<f.length-1;Le++){const qe=f[Le],tt=f[Le+1],ft=qe.dist(tt);if(Ae+ft>_e){const gt=(_e-Ae)/ft,Mt=Zs.number(qe.x,tt.x,gt),Pt=Zs.number(qe.y,tt.y,gt),Lt=new Ac(Mt,Pt,tt.angleTo(qe),Le);return Lt._round(),!Q||Rd(f,Lt,re,Q,u)?Lt:void 0}Ae+=ft}}function Gm(f,u,p,I,L,G,Q,re,Ae){const _e=Bf(I,G,Q),Le=zf(I,L),qe=Le*Q,tt=f[0].x===0||f[0].x===Ae||f[0].y===0||f[0].y===Ae;return u-qe<u/4&&(u=qe+u/4),Vp(f,tt?u/2*re%u:(Le/2+2*G)*Q*re%u,u,_e,p,qe,tt,!1,Ae)}function Vp(f,u,p,I,L,G,Q,re,Ae){const _e=G/2,Le=Lf(f);let qe=0,tt=u-p,ft=[];for(let gt=0;gt<f.length-1;gt++){const Mt=f[gt],Pt=f[gt+1],Lt=Mt.dist(Pt),ei=Pt.angleTo(Mt);for(;tt+p<qe+Lt;){tt+=p;const Ht=(tt-qe)/Lt,Qt=Zs.number(Mt.x,Pt.x,Ht),hi=Zs.number(Mt.y,Pt.y,Ht);if(Qt>=0&&Qt<Ae&&hi>=0&&hi<Ae&&tt-_e>=0&&tt+_e<=Le){const _i=new Ac(Qt,hi,ei,gt);_i._round(),I&&!Rd(f,_i,G,I,L)||ft.push(_i)}}qe+=Lt}return re||ft.length||Q||(ft=Vp(f,qe/2,p,I,L,G,Q,!0,Ae)),ft}Pn("Anchor",Ac);const HA=Su;function iA(f,u,p,I){const L=[],G=f.image,Q=G.pixelRatio,re=G.paddedRect.w-2*HA,Ae=G.paddedRect.h-2*HA,_e=f.right-f.left,Le=f.bottom-f.top,qe=G.stretchX||[[0,re]],tt=G.stretchY||[[0,Ae]],ft=(fn,zn)=>fn+zn[1]-zn[0],gt=qe.reduce(ft,0),Mt=tt.reduce(ft,0),Pt=re-gt,Lt=Ae-Mt;let ei=0,Ht=gt,Qt=0,hi=Mt,_i=0,Xi=Pt,Sn=0,ln=Lt;if(G.content&&I){const fn=G.content;ei=Ro(qe,0,fn[0]),Qt=Ro(tt,0,fn[1]),Ht=Ro(qe,fn[0],fn[2]),hi=Ro(tt,fn[1],fn[3]),_i=fn[0]-ei,Sn=fn[1]-Qt,Xi=fn[2]-fn[0]-Ht,ln=fn[3]-fn[1]-hi}const on=(fn,zn,an,$i)=>{const Dn=nA(fn.stretch-ei,Ht,_e,f.left),Nn=jA(fn.fixed-_i,Xi,fn.stretch,gt),pr=nA(zn.stretch-Qt,hi,Le,f.top),Vr=jA(zn.fixed-Sn,ln,zn.stretch,Mt),Hr=nA(an.stretch-ei,Ht,_e,f.left),Rs=jA(an.fixed-_i,Xi,an.stretch,gt),Ta=nA($i.stretch-Qt,hi,Le,f.top),ia=jA($i.fixed-Sn,ln,$i.stretch,Mt),as=new ce(Dn,pr),Wn=new ce(Hr,pr),Is=new ce(Hr,Ta),tr=new ce(Dn,Ta),na=new ce(Nn/Q,Vr/Q),Ls=new ce(Rs/Q,ia/Q),Kn=u*Math.PI/180;if(Kn){const va=Math.sin(Kn),qo=Math.cos(Kn),uo=[qo,-va,va,qo];as._matMult(uo),Wn._matMult(uo),tr._matMult(uo),Is._matMult(uo)}const za=fn.stretch+fn.fixed,to=zn.stretch+zn.fixed;return{tl:as,tr:Wn,bl:tr,br:Is,tex:{x:G.paddedRect.x+HA+za,y:G.paddedRect.y+HA+to,w:an.stretch+an.fixed-za,h:$i.stretch+$i.fixed-to},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:na,pixelOffsetBR:Ls,minFontScaleX:Xi/Q/_e,minFontScaleY:ln/Q/Le,isSDF:p}};if(I&&(G.stretchX||G.stretchY)){const fn=uh(qe,Pt,gt),zn=uh(tt,Lt,Mt);for(let an=0;an<fn.length-1;an++){const $i=fn[an],Dn=fn[an+1];for(let Nn=0;Nn<zn.length-1;Nn++)L.push(on($i,zn[Nn],Dn,zn[Nn+1]))}}else L.push(on({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:re+1},{fixed:0,stretch:Ae+1}));return L}function Ro(f,u,p){let I=0;for(const L of f)I+=Math.max(u,Math.min(p,L[1]))-Math.max(u,Math.min(p,L[0]));return I}function uh(f,u,p){const I=[{fixed:-HA,stretch:0}];for(const[L,G]of f){const Q=I[I.length-1];I.push({fixed:L-Q.stretch,stretch:Q.stretch}),I.push({fixed:L-Q.stretch,stretch:Q.stretch+(G-L)})}return I.push({fixed:u+HA,stretch:p}),I}function nA(f,u,p,I){return f/u*p+I}function jA(f,u,p,I){return f-u*p/I}class rA{constructor(u,p,I,L,G,Q,re,Ae,_e,Le){if(this.boxStartIndex=u.length,_e){let qe=Q.top,tt=Q.bottom;const ft=Q.collisionPadding;ft&&(qe-=ft[1],tt+=ft[3]);let gt=tt-qe;gt>0&&(gt=Math.max(10,gt),this.circleDiameter=gt)}else{let qe=Q.top*re-Ae[0],tt=Q.bottom*re+Ae[2],ft=Q.left*re-Ae[3],gt=Q.right*re+Ae[1];const Mt=Q.collisionPadding;if(Mt&&(ft-=Mt[0]*re,qe-=Mt[1]*re,gt+=Mt[2]*re,tt+=Mt[3]*re),Le){const Pt=new ce(ft,qe),Lt=new ce(gt,qe),ei=new ce(ft,tt),Ht=new ce(gt,tt),Qt=Le*Math.PI/180;Pt._rotate(Qt),Lt._rotate(Qt),ei._rotate(Qt),Ht._rotate(Qt),ft=Math.min(Pt.x,Lt.x,ei.x,Ht.x),gt=Math.max(Pt.x,Lt.x,ei.x,Ht.x),qe=Math.min(Pt.y,Lt.y,ei.y,Ht.y),tt=Math.max(Pt.y,Lt.y,ei.y,Ht.y)}u.emplaceBack(p.x,p.y,ft,qe,gt,tt,I,L,G)}this.boxEndIndex=u.length}}class B0{constructor(u=[],p=Up){if(this.data=u,this.length=this.data.length,this.compare=p,this.length>0)for(let I=(this.length>>1)-1;I>=0;I--)this._down(I)}push(u){this.data.push(u),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const u=this.data[0],p=this.data.pop();return this.length--,this.length>0&&(this.data[0]=p,this._down(0)),u}peek(){return this.data[0]}_up(u){const{data:p,compare:I}=this,L=p[u];for(;u>0;){const G=u-1>>1,Q=p[G];if(I(L,Q)>=0)break;p[u]=Q,u=G}p[u]=L}_down(u){const{data:p,compare:I}=this,L=this.length>>1,G=p[u];for(;u<L;){let Q=1+(u<<1),re=p[Q];const Ae=Q+1;if(Ae<this.length&&I(p[Ae],re)<0&&(Q=Ae,re=p[Ae]),I(re,G)>=0)break;p[u]=re,u=Q}p[u]=G}}function Up(f,u){return f<u?-1:f>u?1:0}function Fd(f,u=1,p=!1){let I=1/0,L=1/0,G=-1/0,Q=-1/0;const re=f[0];for(let ft=0;ft<re.length;ft++){const gt=re[ft];(!ft||gt.x<I)&&(I=gt.x),(!ft||gt.y<L)&&(L=gt.y),(!ft||gt.x>G)&&(G=gt.x),(!ft||gt.y>Q)&&(Q=gt.y)}const Ae=Math.min(G-I,Q-L);let _e=Ae/2;const Le=new B0([],Od);if(Ae===0)return new ce(I,L);for(let ft=I;ft<G;ft+=Ae)for(let gt=L;gt<Q;gt+=Ae)Le.push(new ZA(ft+_e,gt+_e,_e,f));let qe=function(ft){let gt=0,Mt=0,Pt=0;const Lt=ft[0];for(let ei=0,Ht=Lt.length,Qt=Ht-1;ei<Ht;Qt=ei++){const hi=Lt[ei],_i=Lt[Qt],Xi=hi.x*_i.y-_i.x*hi.y;Mt+=(hi.x+_i.x)*Xi,Pt+=(hi.y+_i.y)*Xi,gt+=3*Xi}return new ZA(Mt/gt,Pt/gt,0,ft)}(f),tt=Le.length;for(;Le.length;){const ft=Le.pop();(ft.d>qe.d||!qe.d)&&(qe=ft,p&&console.log("found best %d after %d probes",Math.round(1e4*ft.d)/1e4,tt)),ft.max-qe.d<=u||(_e=ft.h/2,Le.push(new ZA(ft.p.x-_e,ft.p.y-_e,_e,f)),Le.push(new ZA(ft.p.x+_e,ft.p.y-_e,_e,f)),Le.push(new ZA(ft.p.x-_e,ft.p.y+_e,_e,f)),Le.push(new ZA(ft.p.x+_e,ft.p.y+_e,_e,f)),tt+=4)}return p&&(console.log(`num probes: ${tt}`),console.log(`best distance: ${qe.d}`)),qe.p}function Od(f,u){return u.max-f.max}function ZA(f,u,p,I){this.p=new ce(f,u),this.h=p,this.d=function(L,G){let Q=!1,re=1/0;for(let Ae=0;Ae<G.length;Ae++){const _e=G[Ae];for(let Le=0,qe=_e.length,tt=qe-1;Le<qe;tt=Le++){const ft=_e[Le],gt=_e[tt];ft.y>L.y!=gt.y>L.y&&L.x<(gt.x-ft.x)*(L.y-ft.y)/(gt.y-ft.y)+ft.x&&(Q=!Q),re=Math.min(re,j0(L,ft,gt))}}return(Q?1:-1)*Math.sqrt(re)}(this.p,I),this.max=this.d+this.h*Math.SQRT2}var Bl;a.aq=void 0,(Bl=a.aq||(a.aq={}))[Bl.center=1]="center",Bl[Bl.left=2]="left",Bl[Bl.right=3]="right",Bl[Bl.top=4]="top",Bl[Bl.bottom=5]="bottom",Bl[Bl["top-left"]=6]="top-left",Bl[Bl["top-right"]=7]="top-right",Bl[Bl["bottom-left"]=8]="bottom-left",Bl[Bl["bottom-right"]=9]="bottom-right";const Rc=7,Mh=Number.POSITIVE_INFINITY;function QA(f,u){return u[1]!==Mh?function(p,I,L){let G=0,Q=0;switch(I=Math.abs(I),L=Math.abs(L),p){case"top-right":case"top-left":case"top":Q=L-Rc;break;case"bottom-right":case"bottom-left":case"bottom":Q=-L+Rc}switch(p){case"top-right":case"bottom-right":case"right":G=-I;break;case"top-left":case"bottom-left":case"left":G=I}return[G,Q]}(f,u[0],u[1]):function(p,I){let L=0,G=0;I<0&&(I=0);const Q=I/Math.SQRT2;switch(p){case"top-right":case"top-left":G=Q-Rc;break;case"bottom-right":case"bottom-left":G=-Q+Rc;break;case"bottom":G=-I+Rc;break;case"top":G=I-Rc}switch(p){case"top-right":case"bottom-right":L=-Q;break;case"top-left":case"bottom-left":L=Q;break;case"left":L=I;break;case"right":L=-I}return[L,G]}(f,u[0])}function WA(f,u,p){var I;const L=f.layout,G=(I=L.get("text-variable-anchor-offset"))===null||I===void 0?void 0:I.evaluate(u,{},p);if(G){const re=G.values,Ae=[];for(let _e=0;_e<re.length;_e+=2){const Le=Ae[_e]=re[_e],qe=re[_e+1].map(tt=>tt*eo);Le.startsWith("top")?qe[1]-=Rc:Le.startsWith("bottom")&&(qe[1]+=Rc),Ae[_e+1]=qe}return new Tn(Ae)}const Q=L.get("text-variable-anchor");if(Q){let re;re=f._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[L.get("text-radial-offset").evaluate(u,{},p)*eo,Mh]:L.get("text-offset").evaluate(u,{},p).map(_e=>_e*eo);const Ae=[];for(const _e of Q)Ae.push(_e,QA(_e,re));return new Tn(Ae)}return null}function Rf(f){switch(f){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function z0(f,u,p,I,L,G,Q,re,Ae,_e,Le){let qe=G.textMaxSize.evaluate(u,{});qe===void 0&&(qe=Q);const tt=f.layers[0].layout,ft=tt.get("icon-offset").evaluate(u,{},Le),gt=Of(p.horizontal),Mt=Q/24,Pt=f.tilePixelRatio*Mt,Lt=f.tilePixelRatio*qe/24,ei=f.tilePixelRatio*re,Ht=f.tilePixelRatio*tt.get("symbol-spacing"),Qt=tt.get("text-padding")*f.tilePixelRatio,hi=function($i,Dn,Nn,pr=1){const Vr=$i.get("icon-padding").evaluate(Dn,{},Nn),Hr=Vr&&Vr.values;return[Hr[0]*pr,Hr[1]*pr,Hr[2]*pr,Hr[3]*pr]}(tt,u,Le,f.tilePixelRatio),_i=tt.get("text-max-angle")/180*Math.PI,Xi=tt.get("text-rotation-alignment")!=="viewport"&&tt.get("symbol-placement")!=="point",Sn=tt.get("icon-rotation-alignment")==="map"&&tt.get("symbol-placement")!=="point",ln=tt.get("symbol-placement"),on=Ht/2,fn=tt.get("icon-text-fit");let zn;I&&fn!=="none"&&(f.allowVerticalPlacement&&p.vertical&&(zn=C0(I,p.vertical,fn,tt.get("icon-text-fit-padding"),ft,Mt)),gt&&(I=C0(I,gt,fn,tt.get("icon-text-fit-padding"),ft,Mt)));const an=($i,Dn)=>{Dn.x<0||Dn.x>=La||Dn.y<0||Dn.y>=La||function(Nn,pr,Vr,Hr,Rs,Ta,ia,as,Wn,Is,tr,na,Ls,Kn,za,to,va,qo,uo,ra,wr,wo,nl,rl,Pu){const Gu=Nn.addToLineVertexArray(pr,Vr);let zl,Fc,qu,Hu,eu=0,ch=0,sA=0,qp=0,Nd=-1,Vd=-1;const co={};let So=bo("");if(Nn.allowVerticalPlacement&&Hr.vertical){const Iu=as.layout.get("text-rotate").evaluate(wr,{},rl)+90;qu=new rA(Wn,pr,Is,tr,na,Hr.vertical,Ls,Kn,za,Iu),ia&&(Hu=new rA(Wn,pr,Is,tr,na,ia,va,qo,za,Iu))}if(Rs){const Iu=as.layout.get("icon-rotate").evaluate(wr,{}),dc=as.layout.get("icon-text-fit")!=="none",Oc=iA(Rs,Iu,nl,dc),hh=ia?iA(ia,Iu,nl,dc):void 0;Fc=new rA(Wn,pr,Is,tr,na,Rs,va,qo,!1,Iu),eu=4*Oc.length;const qf=Nn.iconSizeData;let Dh=null;qf.kind==="source"?(Dh=[Ku*as.layout.get("icon-size").evaluate(wr,{})],Dh[0]>Bc&&$e(`${Nn.layerIds[0]}: Value for "icon-size" is >= ${Mf}. Reduce your "icon-size".`)):qf.kind==="composite"&&(Dh=[Ku*wo.compositeIconSizes[0].evaluate(wr,{},rl),Ku*wo.compositeIconSizes[1].evaluate(wr,{},rl)],(Dh[0]>Bc||Dh[1]>Bc)&&$e(`${Nn.layerIds[0]}: Value for "icon-size" is >= ${Mf}. Reduce your "icon-size".`)),Nn.addSymbols(Nn.icon,Oc,Dh,ra,uo,wr,a.ai.none,pr,Gu.lineStartIndex,Gu.lineLength,-1,rl),Nd=Nn.icon.placedSymbolArray.length-1,hh&&(ch=4*hh.length,Nn.addSymbols(Nn.icon,hh,Dh,ra,uo,wr,a.ai.vertical,pr,Gu.lineStartIndex,Gu.lineLength,-1,rl),Vd=Nn.icon.placedSymbolArray.length-1)}const Gf=Object.keys(Hr.horizontal);for(const Iu of Gf){const dc=Hr.horizontal[Iu];if(!zl){So=bo(dc.text);const hh=as.layout.get("text-rotate").evaluate(wr,{},rl);zl=new rA(Wn,pr,Is,tr,na,dc,Ls,Kn,za,hh)}const Oc=dc.positionedLines.length===1;if(sA+=Ff(Nn,pr,dc,Ta,as,za,wr,to,Gu,Hr.vertical?a.ai.horizontal:a.ai.horizontalOnly,Oc?Gf:[Iu],co,Nd,wo,rl),Oc)break}Hr.vertical&&(qp+=Ff(Nn,pr,Hr.vertical,Ta,as,za,wr,to,Gu,a.ai.vertical,["vertical"],co,Vd,wo,rl));const Hp=zl?zl.boxStartIndex:Nn.collisionBoxArray.length,qm=zl?zl.boxEndIndex:Nn.collisionBoxArray.length,jp=qu?qu.boxStartIndex:Nn.collisionBoxArray.length,Hm=qu?qu.boxEndIndex:Nn.collisionBoxArray.length,tu=Fc?Fc.boxStartIndex:Nn.collisionBoxArray.length,ju=Fc?Fc.boxEndIndex:Nn.collisionBoxArray.length,Ph=Hu?Hu.boxStartIndex:Nn.collisionBoxArray.length,fc=Hu?Hu.boxEndIndex:Nn.collisionBoxArray.length;let iu=-1;const Zu=(Iu,dc)=>Iu&&Iu.circleDiameter?Math.max(Iu.circleDiameter,dc):dc;iu=Zu(zl,iu),iu=Zu(qu,iu),iu=Zu(Fc,iu),iu=Zu(Hu,iu);const jm=iu>-1?1:0;jm&&(iu*=Pu/eo),Nn.glyphOffsetArray.length>=ah.MAX_GLYPHS&&$e("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),wr.sortKey!==void 0&&Nn.addToSortKeyRanges(Nn.symbolInstances.length,wr.sortKey);const Fg=WA(as,wr,rl),[v1,x1]=function(Iu,dc){const Oc=Iu.length,hh=dc==null?void 0:dc.values;if((hh==null?void 0:hh.length)>0)for(let qf=0;qf<hh.length;qf+=2){const Dh=hh[qf+1];Iu.emplaceBack(a.aq[hh[qf]],Dh[0],Dh[1])}return[Oc,Iu.length]}(Nn.textAnchorOffsets,Fg);Nn.symbolInstances.emplaceBack(pr.x,pr.y,co.right>=0?co.right:-1,co.center>=0?co.center:-1,co.left>=0?co.left:-1,co.vertical||-1,Nd,Vd,So,Hp,qm,jp,Hm,tu,ju,Ph,fc,Is,sA,qp,eu,ch,jm,0,Ls,iu,v1,x1)}(f,Dn,$i,p,I,L,zn,f.layers[0],f.collisionBoxArray,u.index,u.sourceLayerIndex,f.index,Pt,[Qt,Qt,Qt,Qt],Xi,Ae,ei,hi,Sn,ft,u,G,_e,Le,Q)};if(ln==="line")for(const $i of zd(u.geometry,0,0,La,La)){const Dn=Gm($i,Ht,_i,p.vertical||gt,I,24,Lt,f.overscaling,La);for(const Nn of Dn)gt&&Nf(f,gt.text,on,Nn)||an($i,Nn)}else if(ln==="line-center"){for(const $i of u.geometry)if($i.length>1){const Dn=Um($i,_i,p.vertical||gt,I,24,Lt);Dn&&an($i,Dn)}}else if(u.type==="Polygon")for(const $i of K0(u.geometry,0)){const Dn=Fd($i,16);an($i[0],new Ac(Dn.x,Dn.y,0))}else if(u.type==="LineString")for(const $i of u.geometry)an($i,new Ac($i[0].x,$i[0].y,0));else if(u.type==="Point")for(const $i of u.geometry)for(const Dn of $i)an([Dn],new Ac(Dn.x,Dn.y,0))}function Ff(f,u,p,I,L,G,Q,re,Ae,_e,Le,qe,tt,ft,gt){const Mt=function(ei,Ht,Qt,hi,_i,Xi,Sn,ln){const on=hi.layout.get("text-rotate").evaluate(Xi,{})*Math.PI/180,fn=[];for(const zn of Ht.positionedLines)for(const an of zn.positionedGlyphs){if(!an.rect)continue;const $i=an.rect||{};let Dn=Cf+1,Nn=!0,pr=1,Vr=0;const Hr=(_i||ln)&&an.vertical,Rs=an.metrics.advance*an.scale/2;if(ln&&Ht.verticalizable&&(Vr=zn.lineOffset/2-(an.imageName?-(eo-an.metrics.width*an.scale)/2:(an.scale-1)*eo)),an.imageName){const ra=Sn[an.imageName];Nn=ra.sdf,pr=ra.pixelRatio,Dn=Su/pr}const Ta=_i?[an.x+Rs,an.y]:[0,0];let ia=_i?[0,0]:[an.x+Rs+Qt[0],an.y+Qt[1]-Vr],as=[0,0];Hr&&(as=ia,ia=[0,0]);const Wn=an.metrics.isDoubleResolution?2:1,Is=(an.metrics.left-Dn)*an.scale-Rs+ia[0],tr=(-an.metrics.top-Dn)*an.scale+ia[1],na=Is+$i.w/Wn*an.scale/pr,Ls=tr+$i.h/Wn*an.scale/pr,Kn=new ce(Is,tr),za=new ce(na,tr),to=new ce(Is,Ls),va=new ce(na,Ls);if(Hr){const ra=new ce(-Rs,Rs-RA),wr=-Math.PI/2,wo=eo/2-Rs,nl=new ce(5-RA-wo,-(an.imageName?wo:0)),rl=new ce(...as);Kn._rotateAround(wr,ra)._add(nl)._add(rl),za._rotateAround(wr,ra)._add(nl)._add(rl),to._rotateAround(wr,ra)._add(nl)._add(rl),va._rotateAround(wr,ra)._add(nl)._add(rl)}if(on){const ra=Math.sin(on),wr=Math.cos(on),wo=[wr,-ra,ra,wr];Kn._matMult(wo),za._matMult(wo),to._matMult(wo),va._matMult(wo)}const qo=new ce(0,0),uo=new ce(0,0);fn.push({tl:Kn,tr:za,bl:to,br:va,tex:$i,writingMode:Ht.writingMode,glyphOffset:Ta,sectionIndex:an.sectionIndex,isSDF:Nn,pixelOffsetTL:qo,pixelOffsetBR:uo,minFontScaleX:0,minFontScaleY:0})}return fn}(0,p,re,L,G,Q,I,f.allowVerticalPlacement),Pt=f.textSizeData;let Lt=null;Pt.kind==="source"?(Lt=[Ku*L.layout.get("text-size").evaluate(Q,{})],Lt[0]>Bc&&$e(`${f.layerIds[0]}: Value for "text-size" is >= ${Mf}. Reduce your "text-size".`)):Pt.kind==="composite"&&(Lt=[Ku*ft.compositeTextSizes[0].evaluate(Q,{},gt),Ku*ft.compositeTextSizes[1].evaluate(Q,{},gt)],(Lt[0]>Bc||Lt[1]>Bc)&&$e(`${f.layerIds[0]}: Value for "text-size" is >= ${Mf}. Reduce your "text-size".`)),f.addSymbols(f.text,Mt,Lt,re,G,Q,_e,u,Ae.lineStartIndex,Ae.lineLength,tt,gt);for(const ei of Le)qe[ei]=f.text.placedSymbolArray.length-1;return 4*Mt.length}function Of(f){for(const u in f)return f[u];return null}function Nf(f,u,p,I){const L=f.compareText;if(u in L){const G=L[u];for(let Q=G.length-1;Q>=0;Q--)if(I.dist(G[Q])<p)return!0}else L[u]=[];return L[u].push(I),!1}const R0=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Vf{static from(u){if(!(u instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[p,I]=new Uint8Array(u,0,2);if(p!==219)throw new Error("Data does not appear to be in a KDBush format.");const L=I>>4;if(L!==1)throw new Error(`Got v${L} data when expected v1.`);const G=R0[15&I];if(!G)throw new Error("Unrecognized array type.");const[Q]=new Uint16Array(u,2,1),[re]=new Uint32Array(u,4,1);return new Vf(re,Q,G,u)}constructor(u,p=64,I=Float64Array,L){if(isNaN(u)||u<0)throw new Error(`Unpexpected numItems value: ${u}.`);this.numItems=+u,this.nodeSize=Math.min(Math.max(+p,2),65535),this.ArrayType=I,this.IndexArrayType=u<65536?Uint16Array:Uint32Array;const G=R0.indexOf(this.ArrayType),Q=2*u*this.ArrayType.BYTES_PER_ELEMENT,re=u*this.IndexArrayType.BYTES_PER_ELEMENT,Ae=(8-re%8)%8;if(G<0)throw new Error(`Unexpected typed array class: ${I}.`);L&&L instanceof ArrayBuffer?(this.data=L,this.ids=new this.IndexArrayType(this.data,8,u),this.coords=new this.ArrayType(this.data,8+re+Ae,2*u),this._pos=2*u,this._finished=!0):(this.data=new ArrayBuffer(8+Q+re+Ae),this.ids=new this.IndexArrayType(this.data,8,u),this.coords=new this.ArrayType(this.data,8+re+Ae,2*u),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+G]),new Uint16Array(this.data,2,1)[0]=p,new Uint32Array(this.data,4,1)[0]=u)}add(u,p){const I=this._pos>>1;return this.ids[I]=I,this.coords[this._pos++]=u,this.coords[this._pos++]=p,I}finish(){const u=this._pos>>1;if(u!==this.numItems)throw new Error(`Added ${u} items when expected ${this.numItems}.`);return Uf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(u,p,I,L){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:G,coords:Q,nodeSize:re}=this,Ae=[0,G.length-1,0],_e=[];for(;Ae.length;){const Le=Ae.pop()||0,qe=Ae.pop()||0,tt=Ae.pop()||0;if(qe-tt<=re){for(let Pt=tt;Pt<=qe;Pt++){const Lt=Q[2*Pt],ei=Q[2*Pt+1];Lt>=u&&Lt<=I&&ei>=p&&ei<=L&&_e.push(G[Pt])}continue}const ft=tt+qe>>1,gt=Q[2*ft],Mt=Q[2*ft+1];gt>=u&&gt<=I&&Mt>=p&&Mt<=L&&_e.push(G[ft]),(Le===0?u<=gt:p<=Mt)&&(Ae.push(tt),Ae.push(ft-1),Ae.push(1-Le)),(Le===0?I>=gt:L>=Mt)&&(Ae.push(ft+1),Ae.push(qe),Ae.push(1-Le))}return _e}within(u,p,I){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:L,coords:G,nodeSize:Q}=this,re=[0,L.length-1,0],Ae=[],_e=I*I;for(;re.length;){const Le=re.pop()||0,qe=re.pop()||0,tt=re.pop()||0;if(qe-tt<=Q){for(let Pt=tt;Pt<=qe;Pt++)b(G[2*Pt],G[2*Pt+1],u,p)<=_e&&Ae.push(L[Pt]);continue}const ft=tt+qe>>1,gt=G[2*ft],Mt=G[2*ft+1];b(gt,Mt,u,p)<=_e&&Ae.push(L[ft]),(Le===0?u-I<=gt:p-I<=Mt)&&(re.push(tt),re.push(ft-1),re.push(1-Le)),(Le===0?u+I>=gt:p+I>=Mt)&&(re.push(ft+1),re.push(qe),re.push(1-Le))}return Ae}}function Uf(f,u,p,I,L,G){if(L-I<=p)return;const Q=I+L>>1;Gp(f,u,Q,I,L,G),Uf(f,u,p,I,Q-1,1-G),Uf(f,u,p,Q+1,L,1-G)}function Gp(f,u,p,I,L,G){for(;L>I;){if(L-I>600){const _e=L-I+1,Le=p-I+1,qe=Math.log(_e),tt=.5*Math.exp(2*qe/3),ft=.5*Math.sqrt(qe*tt*(_e-tt)/_e)*(Le-_e/2<0?-1:1);Gp(f,u,p,Math.max(I,Math.floor(p-Le*tt/_e+ft)),Math.min(L,Math.floor(p+(_e-Le)*tt/_e+ft)),G)}const Q=u[2*p+G];let re=I,Ae=L;for(m(f,u,I,p),u[2*L+G]>Q&&m(f,u,I,L);re<Ae;){for(m(f,u,re,Ae),re++,Ae--;u[2*re+G]<Q;)re++;for(;u[2*Ae+G]>Q;)Ae--}u[2*I+G]===Q?m(f,u,I,Ae):(Ae++,m(f,u,Ae,L)),Ae<=p&&(I=Ae+1),p<=Ae&&(L=Ae-1)}}function m(f,u,p,I){h(f,p,I),h(u,2*p,2*I),h(u,2*p+1,2*I+1)}function h(f,u,p){const I=f[u];f[u]=f[p],f[p]=I}function b(f,u,p,I){const L=f-p,G=u-I;return L*L+G*G}var M;a.bh=void 0,(M=a.bh||(a.bh={})).create="create",M.load="load",M.fullLoad="fullLoad";let q=null,K=[];const J=1e3/60,me="loadTime",Ce="fullLoadTime",Ne={mark(f){performance.mark(f)},frame(f){const u=f;q!=null&&K.push(u-q),q=u},clearMetrics(){q=null,K=[],performance.clearMeasures(me),performance.clearMeasures(Ce);for(const f in a.bh)performance.clearMarks(a.bh[f])},getPerformanceMetrics(){performance.measure(me,a.bh.create,a.bh.load),performance.measure(Ce,a.bh.create,a.bh.fullLoad);const f=performance.getEntriesByName(me)[0].duration,u=performance.getEntriesByName(Ce)[0].duration,p=K.length,I=1/(K.reduce((G,Q)=>G+Q,0)/p/1e3),L=K.filter(G=>G>J).reduce((G,Q)=>G+(Q-J)/J,0);return{loadTime:f,fullLoadTime:u,fps:I,percentDroppedFrames:L/(p+L)*100,totalFrames:p}}};a.$=function(f,u,p){var I,L,G,Q,re,Ae,_e,Le,qe,tt,ft,gt,Mt=p[0],Pt=p[1],Lt=p[2];return u===f?(f[12]=u[0]*Mt+u[4]*Pt+u[8]*Lt+u[12],f[13]=u[1]*Mt+u[5]*Pt+u[9]*Lt+u[13],f[14]=u[2]*Mt+u[6]*Pt+u[10]*Lt+u[14],f[15]=u[3]*Mt+u[7]*Pt+u[11]*Lt+u[15]):(L=u[1],G=u[2],Q=u[3],re=u[4],Ae=u[5],_e=u[6],Le=u[7],qe=u[8],tt=u[9],ft=u[10],gt=u[11],f[0]=I=u[0],f[1]=L,f[2]=G,f[3]=Q,f[4]=re,f[5]=Ae,f[6]=_e,f[7]=Le,f[8]=qe,f[9]=tt,f[10]=ft,f[11]=gt,f[12]=I*Mt+re*Pt+qe*Lt+u[12],f[13]=L*Mt+Ae*Pt+tt*Lt+u[13],f[14]=G*Mt+_e*Pt+ft*Lt+u[14],f[15]=Q*Mt+Le*Pt+gt*Lt+u[15]),f},a.A=Hh,a.B=Zs,a.C=class{constructor(f,u,p){this.receive=I=>{const L=I.data,G=L.id;if(G&&(!L.targetMapId||this.mapId===L.targetMapId))if(L.type==="<cancel>"){delete this.tasks[G];const Q=this.cancelCallbacks[G];delete this.cancelCallbacks[G],Q&&Q()}else Nt()||L.mustQueue?(this.tasks[G]=L,this.taskQueue.push(G),this.invoker.trigger()):this.processTask(G,L)},this.process=()=>{if(!this.taskQueue.length)return;const I=this.taskQueue.shift(),L=this.tasks[I];delete this.tasks[I],this.taskQueue.length&&this.invoker.trigger(),L&&this.processTask(I,L)},this.target=f,this.parent=u,this.mapId=p,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new k0(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Nt()?f:window}send(f,u,p,I,L=!1){const G=Math.round(1e18*Math.random()).toString(36).substring(0,10);p&&(this.callbacks[G]=p);const Q=[],re={id:G,type:f,hasCallback:!!p,targetMapId:I,mustQueue:L,sourceMapId:this.mapId,data:In(u,Q)};return this.target.postMessage(re,{transfer:Q}),{cancel:()=>{p&&delete this.callbacks[G],this.target.postMessage({id:G,type:"<cancel>",targetMapId:I,sourceMapId:this.mapId})}}}processTask(f,u){if(u.type==="<response>"){const p=this.callbacks[f];delete this.callbacks[f],p&&(u.error?p(No(u.error)):p(null,No(u.data)))}else{let p=!1;const I=[],L=u.hasCallback?(re,Ae)=>{p=!0,delete this.cancelCallbacks[f];const _e={id:f,type:"<response>",sourceMapId:this.mapId,error:re?In(re):null,data:In(Ae,I)};this.target.postMessage(_e,{transfer:I})}:re=>{p=!0};let G=null;const Q=No(u.data);if(this.parent[u.type])G=this.parent[u.type](u.sourceMapId,Q,L);else if("getWorkerSource"in this.parent){const re=u.type.split(".");G=this.parent.getWorkerSource(u.sourceMapId,re[0],Q.source)[re[1]](Q,L)}else L(new Error(`Could not find function ${u.type}`));!p&&G&&G.cancel&&(this.cancelCallbacks[f]=G.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.D=ki,a.E=mr,a.F=function(f,u){const p={};for(let I=0;I<u.length;I++){const L=u[I];L in f&&(p[L]=f[L])}return p},a.G=GA,a.H=Cd,a.I=S0,a.J=ct,a.K=Tt,a.L=zc,a.M=Ii,a.N=La,a.O=bl,a.P=ce,a.Q=R,a.R=Ll,a.S=er,a.T=tl,a.U=Df,a.V=class extends we{},a.W=Pd,a.X=function(f,u){const p=window.document.createElement("video");p.muted=!0,p.onloadstart=function(){u(null,p)};for(let I=0;I<f.length;I++){const L=window.document.createElement("source");bn(f[I])||(p.crossOrigin="Anonymous"),L.src=f[I],p.appendChild(L)}return{cancel:()=>{}}},a.Y=ve,a.Z=function(){var f=new Hh(16);return Hh!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0),f[0]=1,f[5]=1,f[10]=1,f[15]=1,f},a._=U,a.a=Ot,a.a$=class extends w{},a.a0=function(f,u,p){var I=p[0],L=p[1],G=p[2];return f[0]=u[0]*I,f[1]=u[1]*I,f[2]=u[2]*I,f[3]=u[3]*I,f[4]=u[4]*L,f[5]=u[5]*L,f[6]=u[6]*L,f[7]=u[7]*L,f[8]=u[8]*G,f[9]=u[9]*G,f[10]=u[10]*G,f[11]=u[11]*G,f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},a.a1=cf,a.a2=function(){return _t++},a.a3=j,a.a4=ah,a.a5=function(){gs.isLoading()||gs.isLoaded()||Vu()!=="deferred"||yr()},a.a6=Qr,a.a7=Cc,a.a8=gn,a.a9=Ld,a.aA=_u,a.aB=function(f){f=f.slice();const u=Object.create(null);for(let p=0;p<f.length;p++)u[f[p].id]=f[p];for(let p=0;p<f.length;p++)"ref"in f[p]&&(f[p]=lr(f[p],u[f[p].ref]));return f},a.aC=function(f){if(f.type==="custom")return new UA(f);switch(f.type){case"background":return new Rp(f);case"circle":return new Uu(f);case"fill":return new wp(f);case"fill-extrusion":return new nd(f);case"heatmap":return new eh(f);case"hillshade":return new $0(f);case"line":return new Al(f);case"raster":return new Fp(f);case"symbol":return new VA(f)}},a.aD=bt,a.aE=function(f,u){if(!f)return[{command:Gn.setStyle,args:[u]}];let p=[];try{if(!On(f.version,u.version))return[{command:Gn.setStyle,args:[u]}];On(f.center,u.center)||p.push({command:Gn.setCenter,args:[u.center]}),On(f.zoom,u.zoom)||p.push({command:Gn.setZoom,args:[u.zoom]}),On(f.bearing,u.bearing)||p.push({command:Gn.setBearing,args:[u.bearing]}),On(f.pitch,u.pitch)||p.push({command:Gn.setPitch,args:[u.pitch]}),On(f.sprite,u.sprite)||p.push({command:Gn.setSprite,args:[u.sprite]}),On(f.glyphs,u.glyphs)||p.push({command:Gn.setGlyphs,args:[u.glyphs]}),On(f.transition,u.transition)||p.push({command:Gn.setTransition,args:[u.transition]}),On(f.light,u.light)||p.push({command:Gn.setLight,args:[u.light]});const I={},L=[];(function(Q,re,Ae,_e){let Le;for(Le in re=re||{},Q=Q||{})Object.prototype.hasOwnProperty.call(Q,Le)&&(Object.prototype.hasOwnProperty.call(re,Le)||v(Le,Ae,_e));for(Le in re)Object.prototype.hasOwnProperty.call(re,Le)&&(Object.prototype.hasOwnProperty.call(Q,Le)?On(Q[Le],re[Le])||(Q[Le].type==="geojson"&&re[Le].type==="geojson"&&V(Q,re,Le)?Ae.push({command:Gn.setGeoJSONSourceData,args:[Le,re[Le].data]}):k(Le,re,Ae,_e)):pn(Le,re,Ae))})(f.sources,u.sources,L,I);const G=[];f.layers&&f.layers.forEach(Q=>{I[Q.source]?p.push({command:Gn.removeLayer,args:[Q.id]}):G.push(Q)}),p=p.concat(L),function(Q,re,Ae){re=re||[];const _e=(Q=Q||[]).map(te),Le=re.map(te),qe=Q.reduce(fe,{}),tt=re.reduce(fe,{}),ft=_e.slice(),gt=Object.create(null);let Mt,Pt,Lt,ei,Ht,Qt,hi;for(Mt=0,Pt=0;Mt<_e.length;Mt++)Lt=_e[Mt],Object.prototype.hasOwnProperty.call(tt,Lt)?Pt++:(Ae.push({command:Gn.removeLayer,args:[Lt]}),ft.splice(ft.indexOf(Lt,Pt),1));for(Mt=0,Pt=0;Mt<Le.length;Mt++)Lt=Le[Le.length-1-Mt],ft[ft.length-1-Mt]!==Lt&&(Object.prototype.hasOwnProperty.call(qe,Lt)?(Ae.push({command:Gn.removeLayer,args:[Lt]}),ft.splice(ft.lastIndexOf(Lt,ft.length-Pt),1)):Pt++,Qt=ft[ft.length-Mt],Ae.push({command:Gn.addLayer,args:[tt[Lt],Qt]}),ft.splice(ft.length-Mt,0,Lt),gt[Lt]=!0);for(Mt=0;Mt<Le.length;Mt++)if(Lt=Le[Mt],ei=qe[Lt],Ht=tt[Lt],!gt[Lt]&&!On(ei,Ht))if(On(ei.source,Ht.source)&&On(ei["source-layer"],Ht["source-layer"])&&On(ei.type,Ht.type)){for(hi in Y(ei.layout,Ht.layout,Ae,Lt,null,Gn.setLayoutProperty),Y(ei.paint,Ht.paint,Ae,Lt,null,Gn.setPaintProperty),On(ei.filter,Ht.filter)||Ae.push({command:Gn.setFilter,args:[Lt,Ht.filter]}),On(ei.minzoom,Ht.minzoom)&&On(ei.maxzoom,Ht.maxzoom)||Ae.push({command:Gn.setLayerZoomRange,args:[Lt,Ht.minzoom,Ht.maxzoom]}),ei)Object.prototype.hasOwnProperty.call(ei,hi)&&hi!=="layout"&&hi!=="paint"&&hi!=="filter"&&hi!=="metadata"&&hi!=="minzoom"&&hi!=="maxzoom"&&(hi.indexOf("paint.")===0?Y(ei[hi],Ht[hi],Ae,Lt,hi.slice(6),Gn.setPaintProperty):On(ei[hi],Ht[hi])||Ae.push({command:Gn.setLayerProperty,args:[Lt,hi,Ht[hi]]}));for(hi in Ht)Object.prototype.hasOwnProperty.call(Ht,hi)&&!Object.prototype.hasOwnProperty.call(ei,hi)&&hi!=="layout"&&hi!=="paint"&&hi!=="filter"&&hi!=="metadata"&&hi!=="minzoom"&&hi!=="maxzoom"&&(hi.indexOf("paint.")===0?Y(ei[hi],Ht[hi],Ae,Lt,hi.slice(6),Gn.setPaintProperty):On(ei[hi],Ht[hi])||Ae.push({command:Gn.setLayerProperty,args:[Lt,hi,Ht[hi]]}))}else Ae.push({command:Gn.removeLayer,args:[Lt]}),Qt=ft[ft.lastIndexOf(Lt)+1],Ae.push({command:Gn.addLayer,args:[Ht,Qt]})}(G,u.layers,p)}catch(I){console.warn("Unable to compute style diff:",I),p=[{command:Gn.setStyle,args:[u]}]}return p},a.aF=function(f){const u=[],p=f.id;return p===void 0&&u.push({message:`layers.${p}: missing required property "id"`}),f.render===void 0&&u.push({message:`layers.${p}: missing required method "render"`}),f.renderingMode&&f.renderingMode!=="2d"&&f.renderingMode!=="3d"&&u.push({message:`layers.${p}: property "renderingMode" must be either "2d" or "3d"`}),u},a.aG=function f(u,p){if(Array.isArray(u)){if(!Array.isArray(p)||u.length!==p.length)return!1;for(let I=0;I<u.length;I++)if(!f(u[I],p[I]))return!1;return!0}if(typeof u=="object"&&u!==null&&p!==null){if(typeof p!="object"||Object.keys(u).length!==Object.keys(p).length)return!1;for(const I in u)if(!f(u[I],p[I]))return!1;return!0}return u===p},a.aH=mt,a.aI=xt,a.aJ=cu,a.aK=function(f){return f({pluginStatus:_a,pluginURL:el}),cu.on("pluginStateChange",f),f},a.aL=class extends Ss{constructor(f,u){super(f,u),this.current=0}set(f){this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}},a.aM=Ws,a.aN=class extends Ss{constructor(f,u){super(f,u),this.current=Go}set(f){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let u=1;u<16;u++)if(f[u]!==this.current[u]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}},a.aO=Bo,a.aP=class extends Ss{constructor(f,u){super(f,u),this.current=[0,0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2]))}},a.aQ=class extends Ss{constructor(f,u){super(f,u),this.current=[0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1]))}},a.aR=Uo,a.aS=function(f,u,p,I,L,G,Q){var re=1/(u-p),Ae=1/(I-L),_e=1/(G-Q);return f[0]=-2*re,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=-2*Ae,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=2*_e,f[11]=0,f[12]=(u+p)*re,f[13]=(L+I)*Ae,f[14]=(Q+G)*_e,f[15]=1,f},a.aT=ji,a.aU=Q0,a.aV=class extends F{},a.aW=cd,a.aX=class extends y{},a.aY=function(f){return f<=1?1:Math.pow(2,Math.ceil(Math.log(f)/Math.LN2))},a.aZ=p0,a.a_=Et,a.aa=function(f){const u={};if(f.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(p,I,L,G)=>{const Q=L||G;return u[I]=!Q||Q.toLowerCase(),""}),u["max-age"]){const p=parseInt(u["max-age"],10);isNaN(p)?delete u["max-age"]:u["max-age"]=p}return u},a.ab=function(f,u){const p=[];for(const I in f)I in u||p.push(I);return p},a.ac=function(f){if(Bt==null){const u=f.navigator?f.navigator.userAgent:null;Bt=!!f.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return Bt},a.ad=Oe,a.ae=function(f,u,p){var I=Math.sin(p),L=Math.cos(p),G=u[0],Q=u[1],re=u[2],Ae=u[3],_e=u[4],Le=u[5],qe=u[6],tt=u[7];return u!==f&&(f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[0]=G*L+_e*I,f[1]=Q*L+Le*I,f[2]=re*L+qe*I,f[3]=Ae*L+tt*I,f[4]=_e*L-G*I,f[5]=Le*L-Q*I,f[6]=qe*L-re*I,f[7]=tt*L-Ae*I,f},a.af=function(f){var u=new Hh(16);return u[0]=f[0],u[1]=f[1],u[2]=f[2],u[3]=f[3],u[4]=f[4],u[5]=f[5],u[6]=f[6],u[7]=f[7],u[8]=f[8],u[9]=f[9],u[10]=f[10],u[11]=f[11],u[12]=f[12],u[13]=f[13],u[14]=f[14],u[15]=f[15],u},a.ag=Dl,a.ah=function(f,u){let p=0,I=0;if(f.kind==="constant")I=f.layoutSize;else if(f.kind!=="source"){const{interpolationType:L,minZoom:G,maxZoom:Q}=f,re=L?Oe(xr.interpolationFactor(L,u,G,Q),0,1):0;f.kind==="camera"?I=Zs.number(f.minSize,f.maxSize,re):p=re}return{uSizeT:p,uSize:I}},a.aj=function(f,{uSize:u,uSizeT:p},{lowerSize:I,upperSize:L}){return f.kind==="source"?I/Ku:f.kind==="composite"?Zs.number(I/Ku,L/Ku,p):u},a.ak=NA,a.al=function(f,u,p,I){const L=u.y-f.y,G=u.x-f.x,Q=I.y-p.y,re=I.x-p.x,Ae=Q*G-re*L;if(Ae===0)return null;const _e=(re*(f.y-p.y)-Q*(f.x-p.x))/Ae;return new ce(f.x+_e*G,f.y+_e*L)},a.am=zd,a.an=Xc,a.ao=jh,a.ap=eo,a.ar=T0,a.as=function(f,u){var p=u[0],I=u[1],L=u[2],G=u[3],Q=u[4],re=u[5],Ae=u[6],_e=u[7],Le=u[8],qe=u[9],tt=u[10],ft=u[11],gt=u[12],Mt=u[13],Pt=u[14],Lt=u[15],ei=p*re-I*Q,Ht=p*Ae-L*Q,Qt=p*_e-G*Q,hi=I*Ae-L*re,_i=I*_e-G*re,Xi=L*_e-G*Ae,Sn=Le*Mt-qe*gt,ln=Le*Pt-tt*gt,on=Le*Lt-ft*gt,fn=qe*Pt-tt*Mt,zn=qe*Lt-ft*Mt,an=tt*Lt-ft*Pt,$i=ei*an-Ht*zn+Qt*fn+hi*on-_i*ln+Xi*Sn;return $i?(f[0]=(re*an-Ae*zn+_e*fn)*($i=1/$i),f[1]=(L*zn-I*an-G*fn)*$i,f[2]=(Mt*Xi-Pt*_i+Lt*hi)*$i,f[3]=(tt*_i-qe*Xi-ft*hi)*$i,f[4]=(Ae*on-Q*an-_e*ln)*$i,f[5]=(p*an-L*on+G*ln)*$i,f[6]=(Pt*Qt-gt*Xi-Lt*Ht)*$i,f[7]=(Le*Xi-tt*Qt+ft*Ht)*$i,f[8]=(Q*zn-re*on+_e*Sn)*$i,f[9]=(I*on-p*zn-G*Sn)*$i,f[10]=(gt*_i-Mt*Qt+Lt*ei)*$i,f[11]=(qe*Qt-Le*_i-ft*ei)*$i,f[12]=(re*ln-Q*fn-Ae*Sn)*$i,f[13]=(p*fn-I*ln+L*Sn)*$i,f[14]=(Mt*Ht-gt*hi-Pt*ei)*$i,f[15]=(Le*hi-qe*Ht+tt*ei)*$i,f):null},a.at=Rf,a.au=_d,a.av=Vf,a.aw=function(){const f={},u=ci.$version;for(const p in ci.$root){const I=ci.$root[p];if(I.required){let L=null;L=p==="version"?u:I.type==="array"?[]:{},L!=null&&(f[p]=L)}}return f},a.ax=Gn,a.ay=Nl,a.az=Ei,a.b=function(f,u){const p=new Blob([new Uint8Array(f)],{type:"image/png"});createImageBitmap(p).then(I=>{u(null,I)}).catch(I=>{u(new Error(`Could not load image because of ${I.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},a.b0=Bn,a.b1=function(f,u){var p=f[0],I=f[1],L=f[2],G=f[3],Q=f[4],re=f[5],Ae=f[6],_e=f[7],Le=f[8],qe=f[9],tt=f[10],ft=f[11],gt=f[12],Mt=f[13],Pt=f[14],Lt=f[15],ei=u[0],Ht=u[1],Qt=u[2],hi=u[3],_i=u[4],Xi=u[5],Sn=u[6],ln=u[7],on=u[8],fn=u[9],zn=u[10],an=u[11],$i=u[12],Dn=u[13],Nn=u[14],pr=u[15];return Math.abs(p-ei)<=Jl*Math.max(1,Math.abs(p),Math.abs(ei))&&Math.abs(I-Ht)<=Jl*Math.max(1,Math.abs(I),Math.abs(Ht))&&Math.abs(L-Qt)<=Jl*Math.max(1,Math.abs(L),Math.abs(Qt))&&Math.abs(G-hi)<=Jl*Math.max(1,Math.abs(G),Math.abs(hi))&&Math.abs(Q-_i)<=Jl*Math.max(1,Math.abs(Q),Math.abs(_i))&&Math.abs(re-Xi)<=Jl*Math.max(1,Math.abs(re),Math.abs(Xi))&&Math.abs(Ae-Sn)<=Jl*Math.max(1,Math.abs(Ae),Math.abs(Sn))&&Math.abs(_e-ln)<=Jl*Math.max(1,Math.abs(_e),Math.abs(ln))&&Math.abs(Le-on)<=Jl*Math.max(1,Math.abs(Le),Math.abs(on))&&Math.abs(qe-fn)<=Jl*Math.max(1,Math.abs(qe),Math.abs(fn))&&Math.abs(tt-zn)<=Jl*Math.max(1,Math.abs(tt),Math.abs(zn))&&Math.abs(ft-an)<=Jl*Math.max(1,Math.abs(ft),Math.abs(an))&&Math.abs(gt-$i)<=Jl*Math.max(1,Math.abs(gt),Math.abs($i))&&Math.abs(Mt-Dn)<=Jl*Math.max(1,Math.abs(Mt),Math.abs(Dn))&&Math.abs(Pt-Nn)<=Jl*Math.max(1,Math.abs(Pt),Math.abs(Nn))&&Math.abs(Lt-pr)<=Jl*Math.max(1,Math.abs(Lt),Math.abs(pr))},a.b2=function(f,u){return f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[4]=u[4],f[5]=u[5],f[6]=u[6],f[7]=u[7],f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},a.b3=function(f,u,p){return f[0]=u[0]*p[0],f[1]=u[1]*p[1],f[2]=u[2]*p[2],f[3]=u[3]*p[3],f},a.b4=function(f,u){return f[0]*u[0]+f[1]*u[1]+f[2]*u[2]+f[3]*u[3]},a.b5=jt,a.b6=Dd,a.b7=Td,a.b8=function(f,u,p,I,L){var G,Q=1/Math.tan(u/2);return f[0]=Q/p,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=Q,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=-1,f[12]=0,f[13]=0,f[15]=0,L!=null&&L!==1/0?(f[10]=(L+I)*(G=1/(I-L)),f[14]=2*L*I*G):(f[10]=-1,f[14]=-2*I),f},a.b9=function(f,u,p){var I=Math.sin(p),L=Math.cos(p),G=u[4],Q=u[5],re=u[6],Ae=u[7],_e=u[8],Le=u[9],qe=u[10],tt=u[11];return u!==f&&(f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[4]=G*L+_e*I,f[5]=Q*L+Le*I,f[6]=re*L+qe*I,f[7]=Ae*L+tt*I,f[8]=_e*L-G*I,f[9]=Le*L-Q*I,f[10]=qe*L-re*I,f[11]=tt*L-Ae*I,f},a.bA=he,a.bB=v0,a.bC=Zr,a.bD=gs,a.ba=zt,a.bb=Rt,a.bc=function(f,u){return f[0]=u[0],f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=u[1],f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=u[2],f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f},a.bd=class extends oe{},a.be=M0,a.bf=kd,a.bg=Ne,a.bi=vn,a.bj=function(f,u,p=!1){if(_a===oc||_a===Xu||_a===Xl)throw new Error("setRTLTextPlugin cannot be called multiple times.");el=Ni.resolveURL(f),_a=oc,ms=u,Nu(),p||yr()},a.bk=Vu,a.bl=function(f,u){const p={};for(let L=0;L<f.length;L++){const G=u&&u[f[L].id]||Ya(f[L]);u&&(u[f[L].id]=G);let Q=p[G];Q||(Q=p[G]=[]),Q.push(f[L])}const I=[];for(const L in p)I.push(p[L]);return I},a.bm=Pn,a.bn=L0,a.bo=Op,a.bp=ku,a.bq=function(f){f.bucket.createArrays(),f.bucket.tilePixelRatio=La/(512*f.bucket.overscaling),f.bucket.compareText={},f.bucket.iconsNeedLinear=!1;const u=f.bucket.layers[0],p=u.layout,I=u._unevaluatedLayout._values,L={layoutIconSize:I["icon-size"].possiblyEvaluate(new gn(f.bucket.zoom+1),f.canonical),layoutTextSize:I["text-size"].possiblyEvaluate(new gn(f.bucket.zoom+1),f.canonical),textMaxSize:I["text-size"].possiblyEvaluate(new gn(18))};if(f.bucket.textSizeData.kind==="composite"){const{minZoom:_e,maxZoom:Le}=f.bucket.textSizeData;L.compositeTextSizes=[I["text-size"].possiblyEvaluate(new gn(_e),f.canonical),I["text-size"].possiblyEvaluate(new gn(Le),f.canonical)]}if(f.bucket.iconSizeData.kind==="composite"){const{minZoom:_e,maxZoom:Le}=f.bucket.iconSizeData;L.compositeIconSizes=[I["icon-size"].possiblyEvaluate(new gn(_e),f.canonical),I["icon-size"].possiblyEvaluate(new gn(Le),f.canonical)]}const G=p.get("text-line-height")*eo,Q=p.get("text-rotation-alignment")!=="viewport"&&p.get("symbol-placement")!=="point",re=p.get("text-keep-upright"),Ae=p.get("text-size");for(const _e of f.bucket.features){const Le=p.get("text-font").evaluate(_e,{},f.canonical).join(","),qe=Ae.evaluate(_e,{},f.canonical),tt=L.layoutTextSize.evaluate(_e,{},f.canonical),ft=L.layoutIconSize.evaluate(_e,{},f.canonical),gt={horizontal:{},vertical:void 0},Mt=_e.text;let Pt,Lt=[0,0];if(Mt){const Qt=Mt.toString(),hi=p.get("text-letter-spacing").evaluate(_e,{},f.canonical)*eo,_i=Cn(Qt)?hi:0,Xi=p.get("text-anchor").evaluate(_e,{},f.canonical),Sn=WA(u,_e,f.canonical);if(!Sn){const an=p.get("text-radial-offset").evaluate(_e,{},f.canonical);Lt=an?QA(Xi,[an*eo,Mh]):p.get("text-offset").evaluate(_e,{},f.canonical).map($i=>$i*eo)}let ln=Q?"center":p.get("text-justify").evaluate(_e,{},f.canonical);const on=p.get("symbol-placement"),fn=on==="point"?p.get("text-max-width").evaluate(_e,{},f.canonical)*eo:0,zn=()=>{f.bucket.allowVerticalPlacement&&$l(Qt)&&(gt.vertical=OA(Mt,f.glyphMap,f.glyphPositions,f.imagePositions,Le,fn,G,Xi,"left",_i,Lt,a.ai.vertical,!0,on,tt,qe))};if(!Q&&Sn){const an=new Set;if(ln==="auto")for(let Dn=0;Dn<Sn.values.length;Dn+=2)an.add(Rf(Sn.values[Dn]));else an.add(ln);let $i=!1;for(const Dn of an)if(!gt.horizontal[Dn])if($i)gt.horizontal[Dn]=gt.horizontal[0];else{const Nn=OA(Mt,f.glyphMap,f.glyphPositions,f.imagePositions,Le,fn,G,"center",Dn,_i,Lt,a.ai.horizontal,!1,on,tt,qe);Nn&&(gt.horizontal[Dn]=Nn,$i=Nn.positionedLines.length===1)}zn()}else{ln==="auto"&&(ln=Rf(Xi));const an=OA(Mt,f.glyphMap,f.glyphPositions,f.imagePositions,Le,fn,G,Xi,ln,_i,Lt,a.ai.horizontal,!1,on,tt,qe);an&&(gt.horizontal[ln]=an),zn(),$l(Qt)&&Q&&re&&(gt.vertical=OA(Mt,f.glyphMap,f.glyphPositions,f.imagePositions,Le,fn,G,Xi,ln,_i,Lt,a.ai.vertical,!1,on,tt,qe))}}let ei=!1;if(_e.icon&&_e.icon.name){const Qt=f.imageMap[_e.icon.name];Qt&&(Pt=E0(f.imagePositions[_e.icon.name],p.get("icon-offset").evaluate(_e,{},f.canonical),p.get("icon-anchor").evaluate(_e,{},f.canonical)),ei=!!Qt.sdf,f.bucket.sdfIcons===void 0?f.bucket.sdfIcons=ei:f.bucket.sdfIcons!==ei&&$e("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Qt.pixelRatio!==f.bucket.pixelRatio||p.get("icon-rotate").constantOr(1)!==0)&&(f.bucket.iconsNeedLinear=!0))}const Ht=Of(gt.horizontal)||gt.vertical;f.bucket.iconsInText=!!Ht&&Ht.iconsInText,(Ht||Pt)&&z0(f.bucket,_e,gt,Pt,f.imageMap,L,tt,ft,Lt,ei,f.canonical)}f.showCollisionBoxes&&f.bucket.generateCollisionDebugBuffers()},a.br=sd,a.bs=xf,a.bt=Ul,a.bu=class{constructor(f){this._marks={start:[f.url,"start"].join("#"),end:[f.url,"end"].join("#"),measure:f.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let f=performance.getEntriesByName(this._marks.measure);return f.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),f=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),f}},a.bv=w0,a.bw=Ih,a.bx=function(f,u,p,I,L){return U(this,void 0,void 0,function*(){if(Tt())try{return yield Ii(f,u,p,I,L)}catch{}return function(G,Q,re,Ae,_e){const Le=G.width,qe=G.height;Ci&&Ri||(Ci=new OffscreenCanvas(Le,qe),Ri=Ci.getContext("2d",{willReadFrequently:!0})),Ci.width=Le,Ci.height=qe,Ri.drawImage(G,0,0,Le,qe);const tt=Ri.getImageData(Q,re,Ae,_e);return Ri.clearRect(0,0,Le,qe),tt.data}(f,u,p,I,L)})},a.by=D0,a.bz=W,a.c=nn,a.d=function(f,u){const p=new Image;p.onload=()=>{u(null,p),URL.revokeObjectURL(p.src),p.onload=null,window.requestAnimationFrame(()=>{p.src=gi})},p.onerror=()=>u(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const I=new Blob([new Uint8Array(f)],{type:"image/png"});p.src=f.byteLength?URL.createObjectURL(I):gi},a.e=at,a.f=function(f,u){return Oi(at(f,{type:"json"}),u)},a.g=mi,a.h=Ni,a.i=Nt,a.j=Ji,a.k=Xt,a.l=xn,a.m=Oi,a.n=function(f){return new w0(f).readFields(BA,[])},a.o=function(f,u,p){if(!f.length)return p(null,[]);let I=f.length;const L=new Array(f.length);let G=null;f.forEach((Q,re)=>{u(Q,(Ae,_e)=>{Ae&&(G=Ae),L[re]=_e,--I==0&&p(G,L)})})},a.p=Tf,a.q=xh,a.r=fs,a.s=bn,a.t=yo,a.u=En,a.v=ci,a.w=$e,a.x=Fu,a.y=Ja,a.z=function([f,u,p]){return u+=90,u*=Math.PI/180,p*=Math.PI/180,{x:f*Math.cos(u)*Math.sin(p),y:f*Math.sin(u)*Math.sin(p),z:f*Math.cos(p)}}}),x(["./shared"],function(a){class U{constructor($){this.keyCache={},$&&this.replace($)}replace($){this._layerConfigs={},this._layers={},this.update($,[])}update($,ie){for(const ye of $){this._layerConfigs[ye.id]=ye;const ge=this._layers[ye.id]=a.aC(ye);ge._featureFilter=a.a6(ge.filter),this.keyCache[ye.id]&&delete this.keyCache[ye.id]}for(const ye of ie)delete this.keyCache[ye],delete this._layerConfigs[ye],delete this._layers[ye];this.familiesBySource={};const de=a.bl(Object.values(this._layerConfigs),this.keyCache);for(const ye of de){const ge=ye.map(De=>this._layers[De.id]),Pe=ge[0];if(Pe.visibility==="none")continue;const Fe=Pe.source||"";let Ve=this.familiesBySource[Fe];Ve||(Ve=this.familiesBySource[Fe]={});const Xe=Pe.sourceLayer||"_geojsonTileLayer";let Ke=Ve[Xe];Ke||(Ke=Ve[Xe]=[]),Ke.push(ge)}}}class W{constructor($){const ie={},de=[];for(const Fe in $){const Ve=$[Fe],Xe=ie[Fe]={};for(const Ke in Ve){const De=Ve[+Ke];if(!De||De.bitmap.width===0||De.bitmap.height===0)continue;const Ge={x:0,y:0,w:De.bitmap.width+2,h:De.bitmap.height+2};de.push(Ge),Xe[Ke]={rect:Ge,metrics:De.metrics}}}const{w:ye,h:ge}=a.p(de),Pe=new a.q({width:ye||1,height:ge||1});for(const Fe in $){const Ve=$[Fe];for(const Xe in Ve){const Ke=Ve[+Xe];if(!Ke||Ke.bitmap.width===0||Ke.bitmap.height===0)continue;const De=ie[Fe][Xe].rect;a.q.copy(Ke.bitmap,Pe,{x:0,y:0},{x:De.x+1,y:De.y+1},Ke.bitmap)}}this.image=Pe,this.positions=ie}}a.bm("GlyphAtlas",W);class he{constructor($){this.tileID=new a.O($.tileID.overscaledZ,$.tileID.wrap,$.tileID.canonical.z,$.tileID.canonical.x,$.tileID.canonical.y),this.uid=$.uid,this.zoom=$.zoom,this.pixelRatio=$.pixelRatio,this.tileSize=$.tileSize,this.source=$.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=$.showCollisionBoxes,this.collectResourceTiming=!!$.collectResourceTiming,this.returnDependencies=!!$.returnDependencies,this.promoteId=$.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse($,ie,de,ye,ge){this.status="parsing",this.data=$,this.collisionBoxArray=new a.a3;const Pe=new a.bn(Object.keys($.layers).sort()),Fe=new a.bo(this.tileID,this.promoteId);Fe.bucketLayerIDs=[];const Ve={},Xe={featureIndex:Fe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:de},Ke=ie.familiesBySource[this.source];for(const ti in Ke){const li=$.layers[ti];if(!li)continue;li.version===1&&a.w(`Vector tile source "${this.source}" layer "${ti}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Bi=Pe.encode(ti),vi=[];for(let bi=0;bi<li.length;bi++){const Jt=li.feature(bi),wn=Fe.getId(Jt,ti);vi.push({feature:Jt,id:wn,index:bi,sourceLayerIndex:Bi})}for(const bi of Ke[ti]){const Jt=bi[0];Jt.source!==this.source&&a.w(`layer.source = ${Jt.source} does not equal this.source = ${this.source}`),Jt.minzoom&&this.zoom<Math.floor(Jt.minzoom)||Jt.maxzoom&&this.zoom>=Jt.maxzoom||Jt.visibility!=="none"&&(ae(bi,this.zoom,de),(Ve[Jt.id]=Jt.createBucket({index:Fe.bucketLayerIDs.length,layers:bi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Bi,sourceID:this.source})).populate(vi,Xe,this.tileID.canonical),Fe.bucketLayerIDs.push(bi.map(wn=>wn.id)))}}let De,Ge,At,kt;const o=a.aH(Xe.glyphDependencies,ti=>Object.keys(ti).map(Number));this.inFlightDependencies.forEach(ti=>ti==null?void 0:ti.cancel()),this.inFlightDependencies=[];const ke=++this.dependencySentinel;Object.keys(o).length?this.inFlightDependencies.push(ye.send("getGlyphs",{uid:this.uid,stacks:o,source:this.source,tileID:this.tileID,type:"glyphs"},(ti,li)=>{ke===this.dependencySentinel&&(De||(De=ti,Ge=li,Ai.call(this)))})):Ge={};const oi=Object.keys(Xe.iconDependencies);oi.length?this.inFlightDependencies.push(ye.send("getImages",{icons:oi,source:this.source,tileID:this.tileID,type:"icons"},(ti,li)=>{ke===this.dependencySentinel&&(De||(De=ti,At=li,Ai.call(this)))})):At={};const fi=Object.keys(Xe.patternDependencies);function Ai(){if(De)return ge(De);if(Ge&&At&&kt){const ti=new W(Ge),li=new a.bp(At,kt);for(const Bi in Ve){const vi=Ve[Bi];vi instanceof a.a4?(ae(vi.layers,this.zoom,de),a.bq({bucket:vi,glyphMap:Ge,glyphPositions:ti.positions,imageMap:At,imagePositions:li.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):vi.hasPattern&&(vi instanceof a.br||vi instanceof a.bs||vi instanceof a.bt)&&(ae(vi.layers,this.zoom,de),vi.addFeatures(Xe,this.tileID.canonical,li.patternPositions))}this.status="done",ge(null,{buckets:Object.values(Ve).filter(Bi=>!Bi.isEmpty()),featureIndex:Fe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ti.image,imageAtlas:li,glyphMap:this.returnDependencies?Ge:null,iconMap:this.returnDependencies?At:null,glyphPositions:this.returnDependencies?ti.positions:null})}}fi.length?this.inFlightDependencies.push(ye.send("getImages",{icons:fi,source:this.source,tileID:this.tileID,type:"patterns"},(ti,li)=>{ke===this.dependencySentinel&&(De||(De=ti,kt=li,Ai.call(this)))})):kt={},Ai.call(this)}}function ae(ne,$,ie){const de=new a.a8($);for(const ye of ne)ye.recalculate(de,ie)}function ce(ne,$){const ie=a.l(ne.request,(de,ye,ge,Pe)=>{if(de)$(de);else if(ye)try{const Fe=new a.bw.VectorTile(new a.bv(ye));$(null,{vectorTile:Fe,rawData:ye,cacheControl:ge,expires:Pe})}catch(Fe){const Ve=new Uint8Array(ye);let Xe=`Unable to parse the tile at ${ne.request.url}, `;Xe+=Ve[0]===31&&Ve[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Fe.messge}`,$(new Error(Xe))}});return()=>{ie.cancel(),$()}}class be{constructor($,ie,de,ye){this.actor=$,this.layerIndex=ie,this.availableImages=de,this.loadVectorData=ye||ce,this.fetching={},this.loading={},this.loaded={}}loadTile($,ie){const de=$.uid;this.loading||(this.loading={});const ye=!!($&&$.request&&$.request.collectResourceTiming)&&new a.bu($.request),ge=this.loading[de]=new he($);ge.abort=this.loadVectorData($,(Pe,Fe)=>{if(delete this.loading[de],Pe||!Fe)return ge.status="done",this.loaded[de]=ge,ie(Pe);const Ve=Fe.rawData,Xe={};Fe.expires&&(Xe.expires=Fe.expires),Fe.cacheControl&&(Xe.cacheControl=Fe.cacheControl);const Ke={};if(ye){const De=ye.finish();De&&(Ke.resourceTiming=JSON.parse(JSON.stringify(De)))}ge.vectorTile=Fe.vectorTile,ge.parse(Fe.vectorTile,this.layerIndex,this.availableImages,this.actor,(De,Ge)=>{if(delete this.fetching[de],De||!Ge)return ie(De);ie(null,a.e({rawTileData:Ve.slice(0)},Ge,Xe,Ke))}),this.loaded=this.loaded||{},this.loaded[de]=ge,this.fetching[de]={rawTileData:Ve,cacheControl:Xe,resourceTiming:Ke}})}reloadTile($,ie){const de=this.loaded,ye=$.uid;if(de&&de[ye]){const ge=de[ye];ge.showCollisionBoxes=$.showCollisionBoxes,ge.status==="parsing"?ge.parse(ge.vectorTile,this.layerIndex,this.availableImages,this.actor,(Pe,Fe)=>{if(Pe||!Fe)return ie(Pe,Fe);let Ve;if(this.fetching[ye]){const{rawTileData:Xe,cacheControl:Ke,resourceTiming:De}=this.fetching[ye];delete this.fetching[ye],Ve=a.e({rawTileData:Xe.slice(0)},Fe,Ke,De)}else Ve=Fe;ie(null,Ve)}):ge.status==="done"&&(ge.vectorTile?ge.parse(ge.vectorTile,this.layerIndex,this.availableImages,this.actor,ie):ie())}}abortTile($,ie){const de=this.loading,ye=$.uid;de&&de[ye]&&de[ye].abort&&(de[ye].abort(),delete de[ye]),ie()}removeTile($,ie){const de=this.loaded,ye=$.uid;de&&de[ye]&&delete de[ye],ie()}}class Je{constructor(){this.loaded={}}loadTile($,ie){return a._(this,void 0,void 0,function*(){const{uid:de,encoding:ye,rawImageData:ge,redFactor:Pe,greenFactor:Fe,blueFactor:Ve,baseShift:Xe}=$,Ke=ge.width+2,De=ge.height+2,Ge=a.a(ge)?new a.R({width:Ke,height:De},yield a.bx(ge,-1,-1,Ke,De)):ge,At=new a.by(de,Ge,ye,Pe,Fe,Ve,Xe);this.loaded=this.loaded||{},this.loaded[de]=At,ie(null,At)})}removeTile($){const ie=this.loaded,de=$.uid;ie&&ie[de]&&delete ie[de]}}function st(ne,$){if(ne.length!==0){Ye(ne[0],$);for(var ie=1;ie<ne.length;ie++)Ye(ne[ie],!$)}}function Ye(ne,$){for(var ie=0,de=0,ye=0,ge=ne.length,Pe=ge-1;ye<ge;Pe=ye++){var Fe=(ne[ye][0]-ne[Pe][0])*(ne[Pe][1]+ne[ye][1]),Ve=ie+Fe;de+=Math.abs(ie)>=Math.abs(Fe)?ie-Ve+Fe:Fe-Ve+ie,ie=Ve}ie+de>=0!=!!$&&ne.reverse()}var it=a.bz(function ne($,ie){var de,ye=$&&$.type;if(ye==="FeatureCollection")for(de=0;de<$.features.length;de++)ne($.features[de],ie);else if(ye==="GeometryCollection")for(de=0;de<$.geometries.length;de++)ne($.geometries[de],ie);else if(ye==="Feature")ne($.geometry,ie);else if(ye==="Polygon")st($.coordinates,ie);else if(ye==="MultiPolygon")for(de=0;de<$.coordinates.length;de++)st($.coordinates[de],ie);return $});const ct=a.bw.VectorTileFeature.prototype.toGeoJSON;var Tt={exports:{}},zt=a.bA,Rt=a.bw.VectorTileFeature,Oe=jt;function jt(ne,$){this.options=$||{},this.features=ne,this.length=ne.length}function at(ne,$){this.id=typeof ne.id=="number"?ne.id:void 0,this.type=ne.type,this.rawGeometry=ne.type===1?[ne.geometry]:ne.geometry,this.properties=ne.tags,this.extent=$||4096}jt.prototype.feature=function(ne){return new at(this.features[ne],this.options.extent)},at.prototype.loadGeometry=function(){var ne=this.rawGeometry;this.geometry=[];for(var $=0;$<ne.length;$++){for(var ie=ne[$],de=[],ye=0;ye<ie.length;ye++)de.push(new zt(ie[ye][0],ie[ye][1]));this.geometry.push(de)}return this.geometry},at.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ne=this.geometry,$=1/0,ie=-1/0,de=1/0,ye=-1/0,ge=0;ge<ne.length;ge++)for(var Pe=ne[ge],Fe=0;Fe<Pe.length;Fe++){var Ve=Pe[Fe];$=Math.min($,Ve.x),ie=Math.max(ie,Ve.x),de=Math.min(de,Ve.y),ye=Math.max(ye,Ve.y)}return[$,de,ie,ye]},at.prototype.toGeoJSON=Rt.prototype.toGeoJSON;var _t=a.bB,mt=Oe;function xt(ne){var $=new _t;return function(ie,de){for(var ye in ie.layers)de.writeMessage(3,bt,ie.layers[ye])}(ne,$),$.finish()}function bt(ne,$){var ie;$.writeVarintField(15,ne.version||1),$.writeStringField(1,ne.name||""),$.writeVarintField(5,ne.extent||4096);var de={keys:[],values:[],keycache:{},valuecache:{}};for(ie=0;ie<ne.length;ie++)de.feature=ne.feature(ie),$.writeMessage(2,lt,de);var ye=de.keys;for(ie=0;ie<ye.length;ie++)$.writeStringField(3,ye[ie]);var ge=de.values;for(ie=0;ie<ge.length;ie++)$.writeMessage(4,Bt,ge[ie])}function lt(ne,$){var ie=ne.feature;ie.id!==void 0&&$.writeVarintField(1,ie.id),$.writeMessage(2,$e,ne),$.writeVarintField(3,ie.type),$.writeMessage(4,Nt,ie)}function $e(ne,$){var ie=ne.feature,de=ne.keys,ye=ne.values,ge=ne.keycache,Pe=ne.valuecache;for(var Fe in ie.properties){var Ve=ie.properties[Fe],Xe=ge[Fe];if(Ve!==null){Xe===void 0&&(de.push(Fe),ge[Fe]=Xe=de.length-1),$.writeVarint(Xe);var Ke=typeof Ve;Ke!=="string"&&Ke!=="boolean"&&Ke!=="number"&&(Ve=JSON.stringify(Ve));var De=Ke+":"+Ve,Ge=Pe[De];Ge===void 0&&(ye.push(Ve),Pe[De]=Ge=ye.length-1),$.writeVarint(Ge)}}}function pt(ne,$){return($<<3)+(7&ne)}function ut(ne){return ne<<1^ne>>31}function Nt(ne,$){for(var ie=ne.loadGeometry(),de=ne.type,ye=0,ge=0,Pe=ie.length,Fe=0;Fe<Pe;Fe++){var Ve=ie[Fe],Xe=1;de===1&&(Xe=Ve.length),$.writeVarint(pt(1,Xe));for(var Ke=de===3?Ve.length-1:Ve.length,De=0;De<Ke;De++){De===1&&de!==1&&$.writeVarint(pt(2,Ke-1));var Ge=Ve[De].x-ye,At=Ve[De].y-ge;$.writeVarint(ut(Ge)),$.writeVarint(ut(At)),ye+=Ge,ge+=At}de===3&&$.writeVarint(pt(7,1))}}function Bt(ne,$){var ie=typeof ne;ie==="string"?$.writeStringField(1,ne):ie==="boolean"?$.writeBooleanField(7,ne):ie==="number"&&(ne%1!=0?$.writeDoubleField(3,ne):ne<0?$.writeSVarintField(6,ne):$.writeVarintField(5,ne))}Tt.exports=xt,Tt.exports.fromVectorTileJs=xt,Tt.exports.fromGeojsonVt=function(ne,$){$=$||{};var ie={};for(var de in ne)ie[de]=new mt(ne[de].features,$),ie[de].name=de,ie[de].version=$.version,ie[de].extent=$.extent;return xt({layers:ie})},Tt.exports.GeoJSONWrapper=mt;var Ot=a.bz(Tt.exports);const gi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ne=>ne},Ii=Math.fround||(Ci=new Float32Array(1),ne=>(Ci[0]=+ne,Ci[0]));var Ci;const Ri=3,Ki=5,Hi=6;class Ni{constructor($){this.options=Object.assign(Object.create(gi),$),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load($){const{log:ie,minZoom:de,maxZoom:ye}=this.options;ie&&console.time("total time");const ge=`prepare ${$.length} points`;ie&&console.time(ge),this.points=$;const Pe=[];for(let Ve=0;Ve<$.length;Ve++){const Xe=$[Ve];if(!Xe.geometry)continue;const[Ke,De]=Xe.geometry.coordinates,Ge=Ii(Ei(Ke)),At=Ii(mi(De));Pe.push(Ge,At,1/0,Ve,-1,1),this.options.reduce&&Pe.push(0)}let Fe=this.trees[ye+1]=this._createTree(Pe);ie&&console.timeEnd(ge);for(let Ve=ye;Ve>=de;Ve--){const Xe=+Date.now();Fe=this.trees[Ve]=this._createTree(this._cluster(Fe,Ve)),ie&&console.log("z%d: %d clusters in %dms",Ve,Fe.numItems,+Date.now()-Xe)}return ie&&console.timeEnd("total time"),this}getClusters($,ie){let de=(($[0]+180)%360+360)%360-180;const ye=Math.max(-90,Math.min(90,$[1]));let ge=$[2]===180?180:(($[2]+180)%360+360)%360-180;const Pe=Math.max(-90,Math.min(90,$[3]));if($[2]-$[0]>=360)de=-180,ge=180;else if(de>ge){const De=this.getClusters([de,ye,180,Pe],ie),Ge=this.getClusters([-180,ye,ge,Pe],ie);return De.concat(Ge)}const Fe=this.trees[this._limitZoom(ie)],Ve=Fe.range(Ei(de),mi(Pe),Ei(ge),mi(ye)),Xe=Fe.data,Ke=[];for(const De of Ve){const Ge=this.stride*De;Ke.push(Xe[Ge+Ki]>1?nn(Xe,Ge,this.clusterProps):this.points[Xe[Ge+Ri]])}return Ke}getChildren($){const ie=this._getOriginId($),de=this._getOriginZoom($),ye="No cluster with the specified id.",ge=this.trees[de];if(!ge)throw new Error(ye);const Pe=ge.data;if(ie*this.stride>=Pe.length)throw new Error(ye);const Fe=this.options.radius/(this.options.extent*Math.pow(2,de-1)),Ve=ge.within(Pe[ie*this.stride],Pe[ie*this.stride+1],Fe),Xe=[];for(const Ke of Ve){const De=Ke*this.stride;Pe[De+4]===$&&Xe.push(Pe[De+Ki]>1?nn(Pe,De,this.clusterProps):this.points[Pe[De+Ri]])}if(Xe.length===0)throw new Error(ye);return Xe}getLeaves($,ie,de){const ye=[];return this._appendLeaves(ye,$,ie=ie||10,de=de||0,0),ye}getTile($,ie,de){const ye=this.trees[this._limitZoom($)],ge=Math.pow(2,$),{extent:Pe,radius:Fe}=this.options,Ve=Fe/Pe,Xe=(de-Ve)/ge,Ke=(de+1+Ve)/ge,De={features:[]};return this._addTileFeatures(ye.range((ie-Ve)/ge,Xe,(ie+1+Ve)/ge,Ke),ye.data,ie,de,ge,De),ie===0&&this._addTileFeatures(ye.range(1-Ve/ge,Xe,1,Ke),ye.data,ge,de,ge,De),ie===ge-1&&this._addTileFeatures(ye.range(0,Xe,Ve/ge,Ke),ye.data,-1,de,ge,De),De.features.length?De:null}getClusterExpansionZoom($){let ie=this._getOriginZoom($)-1;for(;ie<=this.options.maxZoom;){const de=this.getChildren($);if(ie++,de.length!==1)break;$=de[0].properties.cluster_id}return ie}_appendLeaves($,ie,de,ye,ge){const Pe=this.getChildren(ie);for(const Fe of Pe){const Ve=Fe.properties;if(Ve&&Ve.cluster?ge+Ve.point_count<=ye?ge+=Ve.point_count:ge=this._appendLeaves($,Ve.cluster_id,de,ye,ge):ge<ye?ge++:$.push(Fe),$.length===de)break}return ge}_createTree($){const ie=new a.av($.length/this.stride|0,this.options.nodeSize,Float32Array);for(let de=0;de<$.length;de+=this.stride)ie.add($[de],$[de+1]);return ie.finish(),ie.data=$,ie}_addTileFeatures($,ie,de,ye,ge,Pe){for(const Fe of $){const Ve=Fe*this.stride,Xe=ie[Ve+Ki]>1;let Ke,De,Ge;if(Xe)Ke=vn(ie,Ve,this.clusterProps),De=ie[Ve],Ge=ie[Ve+1];else{const o=this.points[ie[Ve+Ri]];Ke=o.properties;const[ke,oi]=o.geometry.coordinates;De=Ei(ke),Ge=mi(oi)}const At={type:1,geometry:[[Math.round(this.options.extent*(De*ge-de)),Math.round(this.options.extent*(Ge*ge-ye))]],tags:Ke};let kt;kt=Xe||this.options.generateId?ie[Ve+Ri]:this.points[ie[Ve+Ri]].id,kt!==void 0&&(At.id=kt),Pe.features.push(At)}}_limitZoom($){return Math.max(this.options.minZoom,Math.min(Math.floor(+$),this.options.maxZoom+1))}_cluster($,ie){const{radius:de,extent:ye,reduce:ge,minPoints:Pe}=this.options,Fe=de/(ye*Math.pow(2,ie)),Ve=$.data,Xe=[],Ke=this.stride;for(let De=0;De<Ve.length;De+=Ke){if(Ve[De+2]<=ie)continue;Ve[De+2]=ie;const Ge=Ve[De],At=Ve[De+1],kt=$.within(Ve[De],Ve[De+1],Fe),o=Ve[De+Ki];let ke=o;for(const oi of kt){const fi=oi*Ke;Ve[fi+2]>ie&&(ke+=Ve[fi+Ki])}if(ke>o&&ke>=Pe){let oi,fi=Ge*o,Ai=At*o,ti=-1;const li=((De/Ke|0)<<5)+(ie+1)+this.points.length;for(const Bi of kt){const vi=Bi*Ke;if(Ve[vi+2]<=ie)continue;Ve[vi+2]=ie;const bi=Ve[vi+Ki];fi+=Ve[vi]*bi,Ai+=Ve[vi+1]*bi,Ve[vi+4]=li,ge&&(oi||(oi=this._map(Ve,De,!0),ti=this.clusterProps.length,this.clusterProps.push(oi)),ge(oi,this._map(Ve,vi)))}Ve[De+4]=li,Xe.push(fi/ke,Ai/ke,1/0,li,-1,ke),ge&&Xe.push(ti)}else{for(let oi=0;oi<Ke;oi++)Xe.push(Ve[De+oi]);if(ke>1)for(const oi of kt){const fi=oi*Ke;if(!(Ve[fi+2]<=ie)){Ve[fi+2]=ie;for(let Ai=0;Ai<Ke;Ai++)Xe.push(Ve[fi+Ai])}}}}return Xe}_getOriginId($){return $-this.points.length>>5}_getOriginZoom($){return($-this.points.length)%32}_map($,ie,de){if($[ie+Ki]>1){const Pe=this.clusterProps[$[ie+Hi]];return de?Object.assign({},Pe):Pe}const ye=this.points[$[ie+Ri]].properties,ge=this.options.map(ye);return de&&ge===ye?Object.assign({},ge):ge}}function nn(ne,$,ie){return{type:"Feature",id:ne[$+Ri],properties:vn(ne,$,ie),geometry:{type:"Point",coordinates:[(de=ne[$],360*(de-.5)),zi(ne[$+1])]}};var de}function vn(ne,$,ie){const de=ne[$+Ki],ye=de>=1e4?`${Math.round(de/1e3)}k`:de>=1e3?Math.round(de/100)/10+"k":de,ge=ne[$+Hi],Pe=ge===-1?{}:Object.assign({},ie[ge]);return Object.assign(Pe,{cluster:!0,cluster_id:ne[$+Ri],point_count:de,point_count_abbreviated:ye})}function Ei(ne){return ne/360+.5}function mi(ne){const $=Math.sin(ne*Math.PI/180),ie=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return ie<0?0:ie>1?1:ie}function zi(ne){const $=(180-360*ne)*Math.PI/180;return 360*Math.atan(Math.exp($))/Math.PI-90}function Oi(ne,$,ie,de){for(var ye,ge=de,Pe=ie-$>>1,Fe=ie-$,Ve=ne[$],Xe=ne[$+1],Ke=ne[ie],De=ne[ie+1],Ge=$+3;Ge<ie;Ge+=3){var At=xn(ne[Ge],ne[Ge+1],Ve,Xe,Ke,De);if(At>ge)ye=Ge,ge=At;else if(At===ge){var kt=Math.abs(Ge-Pe);kt<Fe&&(ye=Ge,Fe=kt)}}ge>de&&(ye-$>3&&Oi(ne,$,ye,de),ne[ye+2]=ge,ie-ye>3&&Oi(ne,ye,ie,de))}function xn(ne,$,ie,de,ye,ge){var Pe=ye-ie,Fe=ge-de;if(Pe!==0||Fe!==0){var Ve=((ne-ie)*Pe+($-de)*Fe)/(Pe*Pe+Fe*Fe);Ve>1?(ie=ye,de=ge):Ve>0&&(ie+=Pe*Ve,de+=Fe*Ve)}return(Pe=ne-ie)*Pe+(Fe=$-de)*Fe}function bn(ne,$,ie,de){var ye={id:ne===void 0?null:ne,type:$,geometry:ie,tags:de,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ge){var Pe=ge.geometry,Fe=ge.type;if(Fe==="Point"||Fe==="MultiPoint"||Fe==="LineString")Yt(ge,Pe);else if(Fe==="Polygon"||Fe==="MultiLineString")for(var Ve=0;Ve<Pe.length;Ve++)Yt(ge,Pe[Ve]);else if(Fe==="MultiPolygon")for(Ve=0;Ve<Pe.length;Ve++)for(var Xe=0;Xe<Pe[Ve].length;Xe++)Yt(ge,Pe[Ve][Xe])}(ye),ye}function Yt(ne,$){for(var ie=0;ie<$.length;ie+=3)ne.minX=Math.min(ne.minX,$[ie]),ne.minY=Math.min(ne.minY,$[ie+1]),ne.maxX=Math.max(ne.maxX,$[ie]),ne.maxY=Math.max(ne.maxY,$[ie+1])}function rn(ne,$,ie,de){if($.geometry){var ye=$.geometry.coordinates,ge=$.geometry.type,Pe=Math.pow(ie.tolerance/((1<<ie.maxZoom)*ie.extent),2),Fe=[],Ve=$.id;if(ie.promoteId?Ve=$.properties[ie.promoteId]:ie.generateId&&(Ve=de||0),ge==="Point")Xt(ye,Fe);else if(ge==="MultiPoint")for(var Xe=0;Xe<ye.length;Xe++)Xt(ye[Xe],Fe);else if(ge==="LineString")Ji(ye,Fe,Pe,!1);else if(ge==="MultiLineString"){if(ie.lineMetrics){for(Xe=0;Xe<ye.length;Xe++)Ji(ye[Xe],Fe=[],Pe,!1),ne.push(bn(Ve,"LineString",Fe,$.properties));return}mr(ye,Fe,Pe,!1)}else if(ge==="Polygon")mr(ye,Fe,Pe,!0);else{if(ge!=="MultiPolygon"){if(ge==="GeometryCollection"){for(Xe=0;Xe<$.geometry.geometries.length;Xe++)rn(ne,{id:Ve,geometry:$.geometry.geometries[Xe],properties:$.properties},ie,de);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Xe=0;Xe<ye.length;Xe++){var Ke=[];mr(ye[Xe],Ke,Pe,!0),Fe.push(Ke)}}ne.push(bn(Ve,ge,Fe,$.properties))}}function Xt(ne,$){$.push(ci(ne[0])),$.push(sn(ne[1])),$.push(0)}function Ji(ne,$,ie,de){for(var ye,ge,Pe=0,Fe=0;Fe<ne.length;Fe++){var Ve=ci(ne[Fe][0]),Xe=sn(ne[Fe][1]);$.push(Ve),$.push(Xe),$.push(0),Fe>0&&(Pe+=de?(ye*Xe-Ve*ge)/2:Math.sqrt(Math.pow(Ve-ye,2)+Math.pow(Xe-ge,2))),ye=Ve,ge=Xe}var Ke=$.length-3;$[2]=1,Oi($,0,Ke,ie),$[Ke+2]=1,$.size=Math.abs(Pe),$.start=0,$.end=$.size}function mr(ne,$,ie,de){for(var ye=0;ye<ne.length;ye++){var ge=[];Ji(ne[ye],ge,ie,de),$.push(ge)}}function ci(ne){return ne/360+.5}function sn(ne){var $=Math.sin(ne*Math.PI/180),ie=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return ie<0?0:ie>1?1:ie}function lr(ne,$,ie,de,ye,ge,Pe,Fe){if(de/=$,ge>=(ie/=$)&&Pe<de)return ne;if(Pe<ie||ge>=de)return null;for(var Ve=[],Xe=0;Xe<ne.length;Xe++){var Ke=ne[Xe],De=Ke.geometry,Ge=Ke.type,At=ye===0?Ke.minX:Ke.minY,kt=ye===0?Ke.maxX:Ke.maxY;if(At>=ie&&kt<de)Ve.push(Ke);else if(!(kt<ie||At>=de)){var o=[];if(Ge==="Point"||Ge==="MultiPoint")On(De,o,ie,de,ye);else if(Ge==="LineString")Gn(De,o,ie,de,ye,!1,Fe.lineMetrics);else if(Ge==="MultiLineString")v(De,o,ie,de,ye,!1);else if(Ge==="Polygon")v(De,o,ie,de,ye,!0);else if(Ge==="MultiPolygon")for(var ke=0;ke<De.length;ke++){var oi=[];v(De[ke],oi,ie,de,ye,!0),oi.length&&o.push(oi)}if(o.length){if(Fe.lineMetrics&&Ge==="LineString"){for(ke=0;ke<o.length;ke++)Ve.push(bn(Ke.id,Ge,o[ke],Ke.tags));continue}Ge!=="LineString"&&Ge!=="MultiLineString"||(o.length===1?(Ge="LineString",o=o[0]):Ge="MultiLineString"),Ge!=="Point"&&Ge!=="MultiPoint"||(Ge=o.length===3?"Point":"MultiPoint"),Ve.push(bn(Ke.id,Ge,o,Ke.tags))}}}return Ve.length?Ve:null}function On(ne,$,ie,de,ye){for(var ge=0;ge<ne.length;ge+=3){var Pe=ne[ge+ye];Pe>=ie&&Pe<=de&&($.push(ne[ge]),$.push(ne[ge+1]),$.push(ne[ge+2]))}}function Gn(ne,$,ie,de,ye,ge,Pe){for(var Fe,Ve,Xe=pn(ne),Ke=ye===0?V:Y,De=ne.start,Ge=0;Ge<ne.length-3;Ge+=3){var At=ne[Ge],kt=ne[Ge+1],o=ne[Ge+2],ke=ne[Ge+3],oi=ne[Ge+4],fi=ye===0?At:kt,Ai=ye===0?ke:oi,ti=!1;Pe&&(Fe=Math.sqrt(Math.pow(At-ke,2)+Math.pow(kt-oi,2))),fi<ie?Ai>ie&&(Ve=Ke(Xe,At,kt,ke,oi,ie),Pe&&(Xe.start=De+Fe*Ve)):fi>de?Ai<de&&(Ve=Ke(Xe,At,kt,ke,oi,de),Pe&&(Xe.start=De+Fe*Ve)):k(Xe,At,kt,o),Ai<ie&&fi>=ie&&(Ve=Ke(Xe,At,kt,ke,oi,ie),ti=!0),Ai>de&&fi<=de&&(Ve=Ke(Xe,At,kt,ke,oi,de),ti=!0),!ge&&ti&&(Pe&&(Xe.end=De+Fe*Ve),$.push(Xe),Xe=pn(ne)),Pe&&(De+=Fe)}var li=ne.length-3;At=ne[li],kt=ne[li+1],o=ne[li+2],(fi=ye===0?At:kt)>=ie&&fi<=de&&k(Xe,At,kt,o),li=Xe.length-3,ge&&li>=3&&(Xe[li]!==Xe[0]||Xe[li+1]!==Xe[1])&&k(Xe,Xe[0],Xe[1],Xe[2]),Xe.length&&$.push(Xe)}function pn(ne){var $=[];return $.size=ne.size,$.start=ne.start,$.end=ne.end,$}function v(ne,$,ie,de,ye,ge){for(var Pe=0;Pe<ne.length;Pe++)Gn(ne[Pe],$,ie,de,ye,ge,!1)}function k(ne,$,ie,de){ne.push($),ne.push(ie),ne.push(de)}function V(ne,$,ie,de,ye,ge){var Pe=(ge-$)/(de-$);return ne.push(ge),ne.push(ie+(ye-ie)*Pe),ne.push(1),Pe}function Y(ne,$,ie,de,ye,ge){var Pe=(ge-ie)/(ye-ie);return ne.push($+(de-$)*Pe),ne.push(ge),ne.push(1),Pe}function te(ne,$){for(var ie=[],de=0;de<ne.length;de++){var ye,ge=ne[de],Pe=ge.type;if(Pe==="Point"||Pe==="MultiPoint"||Pe==="LineString")ye=fe(ge.geometry,$);else if(Pe==="MultiLineString"||Pe==="Polygon"){ye=[];for(var Fe=0;Fe<ge.geometry.length;Fe++)ye.push(fe(ge.geometry[Fe],$))}else if(Pe==="MultiPolygon")for(ye=[],Fe=0;Fe<ge.geometry.length;Fe++){for(var Ve=[],Xe=0;Xe<ge.geometry[Fe].length;Xe++)Ve.push(fe(ge.geometry[Fe][Xe],$));ye.push(Ve)}ie.push(bn(ge.id,Pe,ye,ge.tags))}return ie}function fe(ne,$){var ie=[];ie.size=ne.size,ne.start!==void 0&&(ie.start=ne.start,ie.end=ne.end);for(var de=0;de<ne.length;de+=3)ie.push(ne[de]+$,ne[de+1],ne[de+2]);return ie}function ve(ne,$){if(ne.transformed)return ne;var ie,de,ye,ge=1<<ne.z,Pe=ne.x,Fe=ne.y;for(ie=0;ie<ne.features.length;ie++){var Ve=ne.features[ie],Xe=Ve.geometry,Ke=Ve.type;if(Ve.geometry=[],Ke===1)for(de=0;de<Xe.length;de+=2)Ve.geometry.push(Ie(Xe[de],Xe[de+1],$,ge,Pe,Fe));else for(de=0;de<Xe.length;de++){var De=[];for(ye=0;ye<Xe[de].length;ye+=2)De.push(Ie(Xe[de][ye],Xe[de][ye+1],$,ge,Pe,Fe));Ve.geometry.push(De)}}return ne.transformed=!0,ne}function Ie(ne,$,ie,de,ye,ge){return[Math.round(ie*(ne*de-ye)),Math.round(ie*($*de-ge))]}function Ee(ne,$,ie,de,ye){for(var ge=$===ye.maxZoom?0:ye.tolerance/((1<<$)*ye.extent),Pe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ie,y:de,z:$,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Fe=0;Fe<ne.length;Fe++){Pe.numFeatures++,ze(Pe,ne[Fe],ge,ye);var Ve=ne[Fe].minX,Xe=ne[Fe].minY,Ke=ne[Fe].maxX,De=ne[Fe].maxY;Ve<Pe.minX&&(Pe.minX=Ve),Xe<Pe.minY&&(Pe.minY=Xe),Ke>Pe.maxX&&(Pe.maxX=Ke),De>Pe.maxY&&(Pe.maxY=De)}return Pe}function ze(ne,$,ie,de){var ye=$.geometry,ge=$.type,Pe=[];if(ge==="Point"||ge==="MultiPoint")for(var Fe=0;Fe<ye.length;Fe+=3)Pe.push(ye[Fe]),Pe.push(ye[Fe+1]),ne.numPoints++,ne.numSimplified++;else if(ge==="LineString")Qe(Pe,ye,ne,ie,!1,!1);else if(ge==="MultiLineString"||ge==="Polygon")for(Fe=0;Fe<ye.length;Fe++)Qe(Pe,ye[Fe],ne,ie,ge==="Polygon",Fe===0);else if(ge==="MultiPolygon")for(var Ve=0;Ve<ye.length;Ve++){var Xe=ye[Ve];for(Fe=0;Fe<Xe.length;Fe++)Qe(Pe,Xe[Fe],ne,ie,!0,Fe===0)}if(Pe.length){var Ke=$.tags||null;if(ge==="LineString"&&de.lineMetrics){for(var De in Ke={},$.tags)Ke[De]=$.tags[De];Ke.mapbox_clip_start=ye.start/ye.size,Ke.mapbox_clip_end=ye.end/ye.size}var Ge={geometry:Pe,type:ge==="Polygon"||ge==="MultiPolygon"?3:ge==="LineString"||ge==="MultiLineString"?2:1,tags:Ke};$.id!==null&&(Ge.id=$.id),ne.features.push(Ge)}}function Qe(ne,$,ie,de,ye,ge){var Pe=de*de;if(de>0&&$.size<(ye?Pe:de))ie.numPoints+=$.length/3;else{for(var Fe=[],Ve=0;Ve<$.length;Ve+=3)(de===0||$[Ve+2]>Pe)&&(ie.numSimplified++,Fe.push($[Ve]),Fe.push($[Ve+1])),ie.numPoints++;ye&&function(Xe,Ke){for(var De=0,Ge=0,At=Xe.length,kt=At-2;Ge<At;kt=Ge,Ge+=2)De+=(Xe[Ge]-Xe[kt])*(Xe[Ge+1]+Xe[kt+1]);if(De>0===Ke)for(Ge=0,At=Xe.length;Ge<At/2;Ge+=2){var o=Xe[Ge],ke=Xe[Ge+1];Xe[Ge]=Xe[At-2-Ge],Xe[Ge+1]=Xe[At-1-Ge],Xe[At-2-Ge]=o,Xe[At-1-Ge]=ke}}(Fe,ge),ne.push(Fe)}}function He(ne,$){var ie=($=this.options=function(ye,ge){for(var Pe in ge)ye[Pe]=ge[Pe];return ye}(Object.create(this.options),$)).debug;if(ie&&console.time("preprocess data"),$.maxZoom<0||$.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if($.promoteId&&$.generateId)throw new Error("promoteId and generateId cannot be used together.");var de=function(ye,ge){var Pe=[];if(ye.type==="FeatureCollection")for(var Fe=0;Fe<ye.features.length;Fe++)rn(Pe,ye.features[Fe],ge,Fe);else rn(Pe,ye.type==="Feature"?ye:{geometry:ye},ge);return Pe}(ne,$);this.tiles={},this.tileCoords=[],ie&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",$.indexMaxZoom,$.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),de=function(ye,ge){var Pe=ge.buffer/ge.extent,Fe=ye,Ve=lr(ye,1,-1-Pe,Pe,0,-1,2,ge),Xe=lr(ye,1,1-Pe,2+Pe,0,-1,2,ge);return(Ve||Xe)&&(Fe=lr(ye,1,-Pe,1+Pe,0,-1,2,ge)||[],Ve&&(Fe=te(Ve,1).concat(Fe)),Xe&&(Fe=Fe.concat(te(Xe,-1)))),Fe}(de,$),de.length&&this.splitTile(de,0,0,0),ie&&(de.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ze(ne,$,ie){return 32*((1<<ne)*ie+$)+ne}function Ue(ne,$){return $?ne.properties[$]:ne.id}function dt(ne,$){if(ne==null)return!0;if(ne.type==="Feature")return Ue(ne,$)!=null;if(ne.type==="FeatureCollection"){const ie=new Set;for(const de of ne.features){const ye=Ue(de,$);if(ye==null||ie.has(ye))return!1;ie.add(ye)}return!0}return!1}function rt(ne,$){const ie=new Map;if(ne!=null)if(ne.type==="Feature")ie.set(Ue(ne,$),ne);else for(const de of ne.features)ie.set(Ue(de,$),de);return ie}He.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},He.prototype.splitTile=function(ne,$,ie,de,ye,ge,Pe){for(var Fe=[ne,$,ie,de],Ve=this.options,Xe=Ve.debug;Fe.length;){de=Fe.pop(),ie=Fe.pop(),$=Fe.pop(),ne=Fe.pop();var Ke=1<<$,De=Ze($,ie,de),Ge=this.tiles[De];if(!Ge&&(Xe>1&&console.time("creation"),Ge=this.tiles[De]=Ee(ne,$,ie,de,Ve),this.tileCoords.push({z:$,x:ie,y:de}),Xe)){Xe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",$,ie,de,Ge.numFeatures,Ge.numPoints,Ge.numSimplified),console.timeEnd("creation"));var At="z"+$;this.stats[At]=(this.stats[At]||0)+1,this.total++}if(Ge.source=ne,ye){if($===Ve.maxZoom||$===ye)continue;var kt=1<<ye-$;if(ie!==Math.floor(ge/kt)||de!==Math.floor(Pe/kt))continue}else if($===Ve.indexMaxZoom||Ge.numPoints<=Ve.indexMaxPoints)continue;if(Ge.source=null,ne.length!==0){Xe>1&&console.time("clipping");var o,ke,oi,fi,Ai,ti,li=.5*Ve.buffer/Ve.extent,Bi=.5-li,vi=.5+li,bi=1+li;o=ke=oi=fi=null,Ai=lr(ne,Ke,ie-li,ie+vi,0,Ge.minX,Ge.maxX,Ve),ti=lr(ne,Ke,ie+Bi,ie+bi,0,Ge.minX,Ge.maxX,Ve),ne=null,Ai&&(o=lr(Ai,Ke,de-li,de+vi,1,Ge.minY,Ge.maxY,Ve),ke=lr(Ai,Ke,de+Bi,de+bi,1,Ge.minY,Ge.maxY,Ve),Ai=null),ti&&(oi=lr(ti,Ke,de-li,de+vi,1,Ge.minY,Ge.maxY,Ve),fi=lr(ti,Ke,de+Bi,de+bi,1,Ge.minY,Ge.maxY,Ve),ti=null),Xe>1&&console.timeEnd("clipping"),Fe.push(o||[],$+1,2*ie,2*de),Fe.push(ke||[],$+1,2*ie,2*de+1),Fe.push(oi||[],$+1,2*ie+1,2*de),Fe.push(fi||[],$+1,2*ie+1,2*de+1)}}},He.prototype.getTile=function(ne,$,ie){var de=this.options,ye=de.extent,ge=de.debug;if(ne<0||ne>24)return null;var Pe=1<<ne,Fe=Ze(ne,$=($%Pe+Pe)%Pe,ie);if(this.tiles[Fe])return ve(this.tiles[Fe],ye);ge>1&&console.log("drilling down to z%d-%d-%d",ne,$,ie);for(var Ve,Xe=ne,Ke=$,De=ie;!Ve&&Xe>0;)Xe--,Ke=Math.floor(Ke/2),De=Math.floor(De/2),Ve=this.tiles[Ze(Xe,Ke,De)];return Ve&&Ve.source?(ge>1&&console.log("found parent tile z%d-%d-%d",Xe,Ke,De),ge>1&&console.time("drilling down"),this.splitTile(Ve.source,Xe,Ke,De,ne,$,ie),ge>1&&console.timeEnd("drilling down"),this.tiles[Fe]?ve(this.tiles[Fe],ye):null):null};class Me extends be{constructor($,ie,de,ye){super($,ie,de),this._dataUpdateable=new Map,this.loadGeoJSON=(ge,Pe)=>{const{promoteId:Fe}=ge;if(ge.request)return a.f(ge.request,(Ve,Xe,Ke,De)=>{this._dataUpdateable=dt(Xe,Fe)?rt(Xe,Fe):void 0,Pe(Ve,Xe,Ke,De)});if(typeof ge.data=="string")try{const Ve=JSON.parse(ge.data);this._dataUpdateable=dt(Ve,Fe)?rt(Ve,Fe):void 0,Pe(null,Ve)}catch{Pe(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`))}else ge.dataDiff?this._dataUpdateable?(function(Ve,Xe,Ke){var De,Ge,At,kt;if(Xe.removeAll&&Ve.clear(),Xe.remove)for(const o of Xe.remove)Ve.delete(o);if(Xe.add)for(const o of Xe.add){const ke=Ue(o,Ke);ke!=null&&Ve.set(ke,o)}if(Xe.update)for(const o of Xe.update){let ke=Ve.get(o.id);if(ke==null)continue;const oi=!o.removeAllProperties&&(((De=o.removeProperties)===null||De===void 0?void 0:De.length)>0||((Ge=o.addOrUpdateProperties)===null||Ge===void 0?void 0:Ge.length)>0);if((o.newGeometry||o.removeAllProperties||oi)&&(ke=Object.assign({},ke),Ve.set(o.id,ke),oi&&(ke.properties=Object.assign({},ke.properties))),o.newGeometry&&(ke.geometry=o.newGeometry),o.removeAllProperties)ke.properties={};else if(((At=o.removeProperties)===null||At===void 0?void 0:At.length)>0)for(const fi of o.removeProperties)Object.prototype.hasOwnProperty.call(ke.properties,fi)&&delete ke.properties[fi];if(((kt=o.addOrUpdateProperties)===null||kt===void 0?void 0:kt.length)>0)for(const{key:fi,value:Ai}of o.addOrUpdateProperties)ke.properties[fi]=Ai}}(this._dataUpdateable,ge.dataDiff,Fe),Pe(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):Pe(new Error(`Cannot update existing geojson data in ${ge.source}`)):Pe(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,ye&&(this.loadGeoJSON=ye)}loadGeoJSONTile($,ie){const de=$.tileID.canonical;if(!this._geoJSONIndex)return ie(null,null);const ye=this._geoJSONIndex.getTile(de.z,de.x,de.y);if(!ye)return ie(null,null);const ge=new class{constructor(Fe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.N,this.length=Fe.length,this._features=Fe}feature(Fe){return new class{constructor(Ve){this._feature=Ve,this.extent=a.N,this.type=Ve.type,this.properties=Ve.tags,"id"in Ve&&!isNaN(Ve.id)&&(this.id=parseInt(Ve.id,10))}loadGeometry(){if(this._feature.type===1){const Ve=[];for(const Xe of this._feature.geometry)Ve.push([new a.P(Xe[0],Xe[1])]);return Ve}{const Ve=[];for(const Xe of this._feature.geometry){const Ke=[];for(const De of Xe)Ke.push(new a.P(De[0],De[1]));Ve.push(Ke)}return Ve}}toGeoJSON(Ve,Xe,Ke){return ct.call(this,Ve,Xe,Ke)}}(this._features[Fe])}}(ye.features);let Pe=Ot(ge);Pe.byteOffset===0&&Pe.byteLength===Pe.buffer.byteLength||(Pe=new Uint8Array(Pe)),ie(null,{vectorTile:ge,rawData:Pe.buffer})}loadData($,ie){var de;(de=this._pendingRequest)===null||de===void 0||de.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const ye=!!($&&$.request&&$.request.collectResourceTiming)&&new a.bu($.request);this._pendingCallback=ie,this._pendingRequest=this.loadGeoJSON($,(ge,Pe)=>{if(delete this._pendingCallback,delete this._pendingRequest,ge||!Pe)return ie(ge);if(typeof Pe!="object")return ie(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`));{it(Pe,!0);try{if($.filter){const Ve=a.bC($.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ve.result==="error")throw new Error(Ve.value.map(Ke=>`${Ke.key}: ${Ke.message}`).join(", "));Pe={type:"FeatureCollection",features:Pe.features.filter(Ke=>Ve.value.evaluate({zoom:0},Ke))}}this._geoJSONIndex=$.cluster?new Ni(function({superclusterOptions:Ve,clusterProperties:Xe}){if(!Xe||!Ve)return Ve;const Ke={},De={},Ge={accumulated:null,zoom:0},At={properties:null},kt=Object.keys(Xe);for(const o of kt){const[ke,oi]=Xe[o],fi=a.bC(oi),Ai=a.bC(typeof ke=="string"?[ke,["accumulated"],["get",o]]:ke);Ke[o]=fi.value,De[o]=Ai.value}return Ve.map=o=>{At.properties=o;const ke={};for(const oi of kt)ke[oi]=Ke[oi].evaluate(Ge,At);return ke},Ve.reduce=(o,ke)=>{At.properties=ke;for(const oi of kt)Ge.accumulated=o[oi],o[oi]=De[oi].evaluate(Ge,At)},Ve}($)).load(Pe.features):function(Ve,Xe){return new He(Ve,Xe)}(Pe,$.geojsonVtOptions)}catch(Ve){return ie(Ve)}this.loaded={};const Fe={};if(ye){const Ve=ye.finish();Ve&&(Fe.resourceTiming={},Fe.resourceTiming[$.source]=JSON.parse(JSON.stringify(Ve)))}ie(null,Fe)}})}reloadTile($,ie){const de=this.loaded;return de&&de[$.uid]?super.reloadTile($,ie):this.loadTile($,ie)}removeSource($,ie){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ie()}getClusterExpansionZoom($,ie){try{ie(null,this._geoJSONIndex.getClusterExpansionZoom($.clusterId))}catch(de){ie(de)}}getClusterChildren($,ie){try{ie(null,this._geoJSONIndex.getChildren($.clusterId))}catch(de){ie(de)}}getClusterLeaves($,ie){try{ie(null,this._geoJSONIndex.getLeaves($.clusterId,$.limit,$.offset))}catch(de){ie(de)}}}class se{constructor($){this.self=$,this.actor=new a.C($,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:be,geojson:Me},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ie,de)=>{if(this.workerSourceTypes[ie])throw new Error(`Worker source with name "${ie}" already registered.`);this.workerSourceTypes[ie]=de},this.self.registerRTLTextPlugin=ie=>{if(a.bD.isParsed())throw new Error("RTL text plugin already registered.");a.bD.applyArabicShaping=ie.applyArabicShaping,a.bD.processBidirectionalText=ie.processBidirectionalText,a.bD.processStyledBidirectionalText=ie.processStyledBidirectionalText}}setReferrer($,ie){this.referrer=ie}setImages($,ie,de){this.availableImages[$]=ie;for(const ye in this.workerSources[$]){const ge=this.workerSources[$][ye];for(const Pe in ge)ge[Pe].availableImages=ie}de()}setLayers($,ie,de){this.getLayerIndex($).replace(ie),de()}updateLayers($,ie,de){this.getLayerIndex($).update(ie.layers,ie.removedIds),de()}loadTile($,ie,de){this.getWorkerSource($,ie.type,ie.source).loadTile(ie,de)}loadDEMTile($,ie,de){this.getDEMWorkerSource($,ie.source).loadTile(ie,de)}reloadTile($,ie,de){this.getWorkerSource($,ie.type,ie.source).reloadTile(ie,de)}abortTile($,ie,de){this.getWorkerSource($,ie.type,ie.source).abortTile(ie,de)}removeTile($,ie,de){this.getWorkerSource($,ie.type,ie.source).removeTile(ie,de)}removeDEMTile($,ie){this.getDEMWorkerSource($,ie.source).removeTile(ie)}removeSource($,ie,de){if(!this.workerSources[$]||!this.workerSources[$][ie.type]||!this.workerSources[$][ie.type][ie.source])return;const ye=this.workerSources[$][ie.type][ie.source];delete this.workerSources[$][ie.type][ie.source],ye.removeSource!==void 0?ye.removeSource(ie,de):de()}loadWorkerSource($,ie,de){try{this.self.importScripts(ie.url),de()}catch(ye){de(ye.toString())}}syncRTLPluginState($,ie,de){try{a.bD.setState(ie);const ye=a.bD.getPluginURL();if(a.bD.isLoaded()&&!a.bD.isParsed()&&ye!=null){this.self.importScripts(ye);const ge=a.bD.isParsed();de(ge?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ye}`),ge)}}catch(ye){de(ye.toString())}}getAvailableImages($){let ie=this.availableImages[$];return ie||(ie=[]),ie}getLayerIndex($){let ie=this.layerIndexes[$];return ie||(ie=this.layerIndexes[$]=new U),ie}getWorkerSource($,ie,de){return this.workerSources[$]||(this.workerSources[$]={}),this.workerSources[$][ie]||(this.workerSources[$][ie]={}),this.workerSources[$][ie][de]||(this.workerSources[$][ie][de]=new this.workerSourceTypes[ie]({send:(ye,ge,Pe)=>{this.actor.send(ye,ge,Pe,$)}},this.getLayerIndex($),this.getAvailableImages($))),this.workerSources[$][ie][de]}getDEMWorkerSource($,ie){return this.demWorkerSources[$]||(this.demWorkerSources[$]={}),this.demWorkerSources[$][ie]||(this.demWorkerSources[$][ie]=new Je),this.demWorkerSources[$][ie]}}return a.i()&&(self.worker=new se(self)),se}),x(["./shared"],function(a){var U="3.6.2";class W{static testProp(A){if(!W.docStyle)return A[0];for(let E=0;E<A.length;E++)if(A[E]in W.docStyle)return A[E];return A[0]}static create(A,E,F){const O=window.document.createElement(A);return E!==void 0&&(O.className=E),F&&F.appendChild(O),O}static createNS(A,E){return window.document.createElementNS(A,E)}static disableDrag(){W.docStyle&&W.selectProp&&(W.userSelect=W.docStyle[W.selectProp],W.docStyle[W.selectProp]="none")}static enableDrag(){W.docStyle&&W.selectProp&&(W.docStyle[W.selectProp]=W.userSelect)}static setTransform(A,E){A.style[W.transformProp]=E}static addEventListener(A,E,F,O={}){A.addEventListener(E,F,"passive"in O?O:O.capture)}static removeEventListener(A,E,F,O={}){A.removeEventListener(E,F,"passive"in O?O:O.capture)}static suppressClickInternal(A){A.preventDefault(),A.stopPropagation(),window.removeEventListener("click",W.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",W.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",W.suppressClickInternal,!0)},0)}static mousePos(A,E){const F=A.getBoundingClientRect();return new a.P(E.clientX-F.left-A.clientLeft,E.clientY-F.top-A.clientTop)}static touchPos(A,E){const F=A.getBoundingClientRect(),O=[];for(let y=0;y<E.length;y++)O.push(new a.P(E[y].clientX-F.left-A.clientLeft,E[y].clientY-F.top-A.clientTop));return O}static mouseButton(A){return A.button}static remove(A){A.parentNode&&A.parentNode.removeChild(A)}}W.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,W.selectProp=W.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),W.transformProp=W.testProp(["transform","WebkitTransform"]);const he={supported:!1,testSupport:function(Z){!be&&ce&&(Je?st(Z):ae=Z)}};let ae,ce,be=!1,Je=!1;function st(Z){const A=Z.createTexture();Z.bindTexture(Z.TEXTURE_2D,A);try{if(Z.texImage2D(Z.TEXTURE_2D,0,Z.RGBA,Z.RGBA,Z.UNSIGNED_BYTE,ce),Z.isContextLost())return;he.supported=!0}catch{}Z.deleteTexture(A),be=!0}var Ye,it;typeof document<"u"&&(ce=document.createElement("img"),ce.onload=function(){ae&&st(ae),ae=null,Je=!0},ce.onerror=function(){be=!0,ae=null},ce.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(Z){let A,E,F,O;Z.resetRequestQueue=()=>{A=[],E=0,F=0,O={}},Z.addThrottleControl=l=>{const d=F++;return O[d]=l,d},Z.removeThrottleControl=l=>{delete O[l],i()},Z.getImage=(l,d,_=!0)=>{he.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*");const w={requestParameters:l,supportImageRefresh:_,callback:d,cancelled:!1,completed:!1,cancel:()=>{w.completed||w.cancelled||(w.cancelled=!0,w.innerRequest&&(w.innerRequest.cancel(),E--),i())}};return A.push(w),i(),w};const y=l=>{const{requestParameters:d,supportImageRefresh:_,callback:w}=l;return a.e(d,{type:"image"}),(_!==!1||a.i()||a.g(d.url)||d.headers&&!Object.keys(d.headers).reduce((T,B)=>T&&B==="accept",!0)?a.m:r)(d,(T,B,j,X)=>{s(l,w,T,B,j,X)})},s=(l,d,_,w,T,B)=>{_?d(_):w instanceof HTMLImageElement||a.a(w)?d(null,w):w&&((j,X)=>{typeof createImageBitmap=="function"?a.b(j,X):a.d(j,X)})(w,(j,X)=>{j!=null?d(j):X!=null&&d(null,X,{cacheControl:T,expires:B})}),l.cancelled||(l.completed=!0,E--,i())},i=()=>{const l=(()=>{const d=Object.keys(O);let _=!1;if(d.length>0){for(const w of d)if(_=O[w](),_)break}return _})()?a.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let d=E;d<l&&A.length>0;d++){const _=A.shift();if(_.cancelled){d--;continue}const w=y(_);E++,_.innerRequest=w}},r=(l,d)=>{const _=new Image,w=l.url;let T=!1;const B=l.credentials;return B&&B==="include"?_.crossOrigin="use-credentials":(B&&B==="same-origin"||!a.s(w))&&(_.crossOrigin="anonymous"),_.fetchPriority="high",_.onload=()=>{d(null,_),_.onerror=_.onload=null},_.onerror=()=>{T||d(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),_.onerror=_.onload=null},_.src=w,{cancel:()=>{T=!0,_.src=""}}}}(Ye||(Ye={})),Ye.resetRequestQueue(),function(Z){Z.Glyphs="Glyphs",Z.Image="Image",Z.Source="Source",Z.SpriteImage="SpriteImage",Z.SpriteJSON="SpriteJSON",Z.Style="Style",Z.Tile="Tile",Z.Unknown="Unknown"}(it||(it={}));class ct{constructor(A){this._transformRequestFn=A}transformRequest(A,E){return this._transformRequestFn&&this._transformRequestFn(A,E)||{url:A}}normalizeSpriteURL(A,E,F){const O=function(y){const s=y.match(Tt);if(!s)throw new Error(`Unable to parse URL "${y}"`);return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}(A);return O.path+=`${E}${F}`,function(y){const s=y.params.length?`?${y.params.join("&")}`:"";return`${y.protocol}://${y.authority}${y.path}${s}`}(O)}setTransformRequest(A){this._transformRequestFn=A}}const Tt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function zt(Z){var A=new a.A(3);return A[0]=Z[0],A[1]=Z[1],A[2]=Z[2],A}var Rt,Oe=function(Z,A,E){return Z[0]=A[0]-E[0],Z[1]=A[1]-E[1],Z[2]=A[2]-E[2],Z};Rt=new a.A(3),a.A!=Float32Array&&(Rt[0]=0,Rt[1]=0,Rt[2]=0);var jt=function(Z){var A=Z[0],E=Z[1];return A*A+E*E};function at(Z){const A=[];if(typeof Z=="string")A.push({id:"default",url:Z});else if(Z&&Z.length>0){const E=[];for(const{id:F,url:O}of Z){const y=`${F}${O}`;E.indexOf(y)===-1&&(E.push(y),A.push({id:F,url:O}))}}return A}function _t(Z,A,E,F,O){if(F)return void Z(F);if(O!==Object.values(A).length||O!==Object.values(E).length)return;const y={};for(const s in A){y[s]={};const i=a.h.getImageCanvasContext(E[s]),r=A[s];for(const l in r){const{width:d,height:_,x:w,y:T,sdf:B,pixelRatio:j,stretchX:X,stretchY:ue,content:Se}=r[l];y[s][l]={data:null,pixelRatio:j,sdf:B,stretchX:X,stretchY:ue,content:Se,spriteData:{width:d,height:_,x:w,y:T,context:i}}}}Z(null,y)}(function(){var Z=new a.A(2);a.A!=Float32Array&&(Z[0]=0,Z[1]=0)})();class mt{constructor(A,E,F,O){this.context=A,this.format=F,this.texture=A.gl.createTexture(),this.update(E,O)}update(A,E,F){const{width:O,height:y}=A,s=!(this.size&&this.size[0]===O&&this.size[1]===y||F),{context:i}=this,{gl:r}=i;if(this.useMipmap=!!(E&&E.useMipmap),r.bindTexture(r.TEXTURE_2D,this.texture),i.pixelStoreUnpackFlipY.set(!1),i.pixelStoreUnpack.set(1),i.pixelStoreUnpackPremultiplyAlpha.set(this.format===r.RGBA&&(!E||E.premultiply!==!1)),s)this.size=[O,y],A instanceof HTMLImageElement||A instanceof HTMLCanvasElement||A instanceof HTMLVideoElement||A instanceof ImageData||a.a(A)?r.texImage2D(r.TEXTURE_2D,0,this.format,this.format,r.UNSIGNED_BYTE,A):r.texImage2D(r.TEXTURE_2D,0,this.format,O,y,0,this.format,r.UNSIGNED_BYTE,A.data);else{const{x:l,y:d}=F||{x:0,y:0};A instanceof HTMLImageElement||A instanceof HTMLCanvasElement||A instanceof HTMLVideoElement||A instanceof ImageData||a.a(A)?r.texSubImage2D(r.TEXTURE_2D,0,l,d,r.RGBA,r.UNSIGNED_BYTE,A):r.texSubImage2D(r.TEXTURE_2D,0,l,d,O,y,r.RGBA,r.UNSIGNED_BYTE,A.data)}this.useMipmap&&this.isSizePowerOfTwo()&&r.generateMipmap(r.TEXTURE_2D)}bind(A,E,F){const{context:O}=this,{gl:y}=O;y.bindTexture(y.TEXTURE_2D,this.texture),F!==y.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(F=y.LINEAR),A!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,A),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,F||A),this.filter=A),E!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,E),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,E),this.wrap=E)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:A}=this.context;A.deleteTexture(this.texture),this.texture=null}}function xt(Z){const{userImage:A}=Z;return!!(A&&A.render&&A.render())&&(Z.data.replace(new Uint8Array(A.data.buffer)),!0)}class bt extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(A){if(this.loaded!==A&&(this.loaded=A,A)){for(const{ids:E,callback:F}of this.requestors)this._notify(E,F);this.requestors=[]}}getImage(A){const E=this.images[A];if(E&&!E.data&&E.spriteData){const F=E.spriteData;E.data=new a.R({width:F.width,height:F.height},F.context.getImageData(F.x,F.y,F.width,F.height).data),E.spriteData=null}return E}addImage(A,E){if(this.images[A])throw new Error(`Image id ${A} already exist, use updateImage instead`);this._validate(A,E)&&(this.images[A]=E)}_validate(A,E){let F=!0;const O=E.data||E.spriteData;return this._validateStretch(E.stretchX,O&&O.width)||(this.fire(new a.j(new Error(`Image "${A}" has invalid "stretchX" value`))),F=!1),this._validateStretch(E.stretchY,O&&O.height)||(this.fire(new a.j(new Error(`Image "${A}" has invalid "stretchY" value`))),F=!1),this._validateContent(E.content,E)||(this.fire(new a.j(new Error(`Image "${A}" has invalid "content" value`))),F=!1),F}_validateStretch(A,E){if(!A)return!0;let F=0;for(const O of A){if(O[0]<F||O[1]<O[0]||E<O[1])return!1;F=O[1]}return!0}_validateContent(A,E){if(!A)return!0;if(A.length!==4)return!1;const F=E.spriteData,O=F&&F.width||E.data.width,y=F&&F.height||E.data.height;return!(A[0]<0||O<A[0]||A[1]<0||y<A[1]||A[2]<0||O<A[2]||A[3]<0||y<A[3]||A[2]<A[0]||A[3]<A[1])}updateImage(A,E,F=!0){const O=this.getImage(A);if(F&&(O.data.width!==E.data.width||O.data.height!==E.data.height))throw new Error(`size mismatch between old image (${O.data.width}x${O.data.height}) and new image (${E.data.width}x${E.data.height}).`);E.version=O.version+1,this.images[A]=E,this.updatedImages[A]=!0}removeImage(A){const E=this.images[A];delete this.images[A],delete this.patterns[A],E.userImage&&E.userImage.onRemove&&E.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(A,E){let F=!0;if(!this.isLoaded())for(const O of A)this.images[O]||(F=!1);this.isLoaded()||F?this._notify(A,E):this.requestors.push({ids:A,callback:E})}_notify(A,E){const F={};for(const O of A){let y=this.getImage(O);y||(this.fire(new a.k("styleimagemissing",{id:O})),y=this.getImage(O)),y?F[O]={data:y.data.clone(),pixelRatio:y.pixelRatio,sdf:y.sdf,version:y.version,stretchX:y.stretchX,stretchY:y.stretchY,content:y.content,hasRenderCallback:!!(y.userImage&&y.userImage.render)}:a.w(`Image "${O}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}E(null,F)}getPixelSize(){const{width:A,height:E}=this.atlasImage;return{width:A,height:E}}getPattern(A){const E=this.patterns[A],F=this.getImage(A);if(!F)return null;if(E&&E.position.version===F.version)return E.position;if(E)E.position.version=F.version;else{const O={w:F.data.width+2,h:F.data.height+2,x:0,y:0},y=new a.I(O,F);this.patterns[A]={bin:O,position:y}}return this._updatePatternAtlas(),this.patterns[A].position}bind(A){const E=A.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new mt(A,this.atlasImage,E.RGBA),this.atlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE)}_updatePatternAtlas(){const A=[];for(const y in this.patterns)A.push(this.patterns[y].bin);const{w:E,h:F}=a.p(A),O=this.atlasImage;O.resize({width:E||1,height:F||1});for(const y in this.patterns){const{bin:s}=this.patterns[y],i=s.x+1,r=s.y+1,l=this.getImage(y).data,d=l.width,_=l.height;a.R.copy(l,O,{x:0,y:0},{x:i,y:r},{width:d,height:_}),a.R.copy(l,O,{x:0,y:_-1},{x:i,y:r-1},{width:d,height:1}),a.R.copy(l,O,{x:0,y:0},{x:i,y:r+_},{width:d,height:1}),a.R.copy(l,O,{x:d-1,y:0},{x:i-1,y:r},{width:1,height:_}),a.R.copy(l,O,{x:0,y:0},{x:i+d,y:r},{width:1,height:_})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(A){for(const E of A){if(this.callbackDispatchedThisFrame[E])continue;this.callbackDispatchedThisFrame[E]=!0;const F=this.getImage(E);F||a.w(`Image with ID: "${E}" was not found`),xt(F)&&this.updateImage(E,F)}}}const lt=1e20;function $e(Z,A,E,F,O,y,s,i,r){for(let l=A;l<A+F;l++)pt(Z,E*y+l,y,O,s,i,r);for(let l=E;l<E+O;l++)pt(Z,l*y+A,1,F,s,i,r)}function pt(Z,A,E,F,O,y,s){y[0]=0,s[0]=-lt,s[1]=lt,O[0]=Z[A];for(let i=1,r=0,l=0;i<F;i++){O[i]=Z[A+i*E];const d=i*i;do{const _=y[r];l=(O[i]-O[_]+d-_*_)/(i-_)/2}while(l<=s[r]&&--r>-1);r++,y[r]=i,s[r]=l,s[r+1]=lt}for(let i=0,r=0;i<F;i++){for(;s[r+1]<i;)r++;const l=y[r],d=i-l;Z[A+i*E]=O[l]+d*d}}class ut{constructor(A,E){this.requestManager=A,this.localIdeographFontFamily=E,this.entries={}}setURL(A){this.url=A}getGlyphs(A,E){const F=[];for(const O in A)for(const y of A[O])F.push({stack:O,id:y});a.o(F,({stack:O,id:y},s)=>{let i=this.entries[O];i||(i=this.entries[O]={glyphs:{},requests:{},ranges:{}});let r=i.glyphs[y];if(r!==void 0)return void s(null,{stack:O,id:y,glyph:r});if(r=this._tinySDF(i,O,y),r)return i.glyphs[y]=r,void s(null,{stack:O,id:y,glyph:r});const l=Math.floor(y/256);if(256*l>65535)return void s(new Error("glyphs > 65535 not supported"));if(i.ranges[l])return void s(null,{stack:O,id:y,glyph:r});if(!this.url)return void s(new Error("glyphsUrl is not set"));let d=i.requests[l];d||(d=i.requests[l]=[],ut.loadGlyphRange(O,l,this.url,this.requestManager,(_,w)=>{if(w){for(const T in w)this._doesCharSupportLocalGlyph(+T)||(i.glyphs[+T]=w[+T]);i.ranges[l]=!0}for(const T of d)T(_,w);delete i.requests[l]})),d.push((_,w)=>{_?s(_):w&&s(null,{stack:O,id:y,glyph:w[y]||null})})},(O,y)=>{if(O)E(O);else if(y){const s={};for(const{stack:i,id:r,glyph:l}of y)(s[i]||(s[i]={}))[r]=l&&{id:l.id,bitmap:l.bitmap.clone(),metrics:l.metrics};E(null,s)}})}_doesCharSupportLocalGlyph(A){return!!this.localIdeographFontFamily&&(a.u["CJK Unified Ideographs"](A)||a.u["Hangul Syllables"](A)||a.u.Hiragana(A)||a.u.Katakana(A))}_tinySDF(A,E,F){const O=this.localIdeographFontFamily;if(!O||!this._doesCharSupportLocalGlyph(F))return;let y=A.tinySDF;if(!y){let i="400";/bold/i.test(E)?i="900":/medium/i.test(E)?i="500":/light/i.test(E)&&(i="200"),y=A.tinySDF=new ut.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:O,fontWeight:i})}const s=y.draw(String.fromCharCode(F));return{id:F,bitmap:new a.q({width:s.width||60,height:s.height||60},s.data),metrics:{width:s.glyphWidth/2||24,height:s.glyphHeight/2||24,left:s.glyphLeft/2+.5||0,top:s.glyphTop/2-27.5||-8,advance:s.glyphAdvance/2||24,isDoubleResolution:!0}}}}ut.loadGlyphRange=function(Z,A,E,F,O){const y=256*A,s=y+255,i=F.transformRequest(E.replace("{fontstack}",Z).replace("{range}",`${y}-${s}`),it.Glyphs);a.l(i,(r,l)=>{if(r)O(r);else if(l){const d={};for(const _ of a.n(l))d[_.id]=_;O(null,d)}})},ut.TinySDF=class{constructor({fontSize:Z=24,buffer:A=3,radius:E=8,cutoff:F=.25,fontFamily:O="sans-serif",fontWeight:y="normal",fontStyle:s="normal"}={}){this.buffer=A,this.cutoff=F,this.radius=E;const i=this.size=Z+4*A,r=this._createCanvas(i),l=this.ctx=r.getContext("2d",{willReadFrequently:!0});l.font=`${s} ${y} ${Z}px ${O}`,l.textBaseline="alphabetic",l.textAlign="left",l.fillStyle="black",this.gridOuter=new Float64Array(i*i),this.gridInner=new Float64Array(i*i),this.f=new Float64Array(i),this.z=new Float64Array(i+1),this.v=new Uint16Array(i)}_createCanvas(Z){const A=document.createElement("canvas");return A.width=A.height=Z,A}draw(Z){const{width:A,actualBoundingBoxAscent:E,actualBoundingBoxDescent:F,actualBoundingBoxLeft:O,actualBoundingBoxRight:y}=this.ctx.measureText(Z),s=Math.ceil(E),i=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-O))),r=Math.min(this.size-this.buffer,s+Math.ceil(F)),l=i+2*this.buffer,d=r+2*this.buffer,_=Math.max(l*d,0),w=new Uint8ClampedArray(_),T={data:w,width:l,height:d,glyphWidth:i,glyphHeight:r,glyphTop:s,glyphLeft:0,glyphAdvance:A};if(i===0||r===0)return T;const{ctx:B,buffer:j,gridInner:X,gridOuter:ue}=this;B.clearRect(j,j,i,r),B.fillText(Z,j,j+s);const Se=B.getImageData(j,j,i,r);ue.fill(lt,0,_),X.fill(0,0,_);for(let Te=0;Te<r;Te++)for(let Re=0;Re<i;Re++){const Be=Se.data[4*(Te*i+Re)+3]/255;if(Be===0)continue;const et=(Te+j)*l+Re+j;if(Be===1)ue[et]=0,X[et]=lt;else{const vt=.5-Be;ue[et]=vt>0?vt*vt:0,X[et]=vt<0?vt*vt:0}}$e(ue,0,0,l,d,l,this.f,this.v,this.z),$e(X,j,j,i,r,l,this.f,this.v,this.z);for(let Te=0;Te<_;Te++){const Re=Math.sqrt(ue[Te])-Math.sqrt(X[Te]);w[Te]=Math.round(255-255*(Re/this.radius+this.cutoff))}return T}};class Nt{constructor(){this.specification=a.v.light.position}possiblyEvaluate(A,E){return a.z(A.expression.evaluate(E))}interpolate(A,E,F){return{x:a.B.number(A.x,E.x,F),y:a.B.number(A.y,E.y,F),z:a.B.number(A.z,E.z,F)}}}let Bt;class Ot extends a.E{constructor(A){super(),Bt=Bt||new a.r({anchor:new a.D(a.v.light.anchor),position:new Nt,color:new a.D(a.v.light.color),intensity:new a.D(a.v.light.intensity)}),this._transitionable=new a.T(Bt),this.setLight(A),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(A,E={}){if(!this._validate(a.t,A,E))for(const F in A){const O=A[F];F.endsWith("-transition")?this._transitionable.setTransition(F.slice(0,-11),O):this._transitionable.setValue(F,O)}}updateTransitions(A){this._transitioning=this._transitionable.transitioned(A,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(A){this.properties=this._transitioning.possiblyEvaluate(A)}_validate(A,E,F){return(!F||F.validate!==!1)&&a.x(this,A.call(a.y,a.e({value:E,style:{glyphs:!0,sprite:!0},styleSpec:a.v})))}}class gi{constructor(A,E){this.width=A,this.height=E,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(A,E){const F=A.join(",")+String(E);return this.dashEntry[F]||(this.dashEntry[F]=this.addDash(A,E)),this.dashEntry[F]}getDashRanges(A,E,F){const O=[];let y=A.length%2==1?-A[A.length-1]*F:0,s=A[0]*F,i=!0;O.push({left:y,right:s,isDash:i,zeroLength:A[0]===0});let r=A[0];for(let l=1;l<A.length;l++){i=!i;const d=A[l];y=r*F,r+=d,s=r*F,O.push({left:y,right:s,isDash:i,zeroLength:d===0})}return O}addRoundDash(A,E,F){const O=E/2;for(let y=-F;y<=F;y++){const s=this.width*(this.nextRow+F+y);let i=0,r=A[i];for(let l=0;l<this.width;l++){l/r.right>1&&(r=A[++i]);const d=Math.abs(l-r.left),_=Math.abs(l-r.right),w=Math.min(d,_);let T;const B=y/F*(O+1);if(r.isDash){const j=O-Math.abs(B);T=Math.sqrt(w*w+j*j)}else T=O-Math.sqrt(w*w+B*B);this.data[s+l]=Math.max(0,Math.min(255,T+128))}}}addRegularDash(A){for(let i=A.length-1;i>=0;--i){const r=A[i],l=A[i+1];r.zeroLength?A.splice(i,1):l&&l.isDash===r.isDash&&(l.left=r.left,A.splice(i,1))}const E=A[0],F=A[A.length-1];E.isDash===F.isDash&&(E.left=F.left-this.width,F.right=E.right+this.width);const O=this.width*this.nextRow;let y=0,s=A[y];for(let i=0;i<this.width;i++){i/s.right>1&&(s=A[++y]);const r=Math.abs(i-s.left),l=Math.abs(i-s.right),d=Math.min(r,l);this.data[O+i]=Math.max(0,Math.min(255,(s.isDash?d:-d)+128))}}addDash(A,E){const F=E?7:0,O=2*F+1;if(this.nextRow+O>this.height)return a.w("LineAtlas out of space"),null;let y=0;for(let i=0;i<A.length;i++)y+=A[i];if(y!==0){const i=this.width/y,r=this.getDashRanges(A,this.width,i);E?this.addRoundDash(r,i,F):this.addRegularDash(r)}const s={y:(this.nextRow+F+.5)/this.height,height:2*F/this.height,width:y};return this.nextRow+=O,this.dirty=!0,s}bind(A){const E=A.gl;this.texture?(E.bindTexture(E.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,E.texSubImage2D(E.TEXTURE_2D,0,0,0,this.width,this.height,E.ALPHA,E.UNSIGNED_BYTE,this.data))):(this.texture=E.createTexture(),E.bindTexture(E.TEXTURE_2D,this.texture),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,E.REPEAT),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,E.REPEAT),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,E.LINEAR),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,E.LINEAR),E.texImage2D(E.TEXTURE_2D,0,E.ALPHA,this.width,this.height,0,E.ALPHA,E.UNSIGNED_BYTE,this.data))}}class Ii{constructor(A,E,F){this.workerPool=A,this.actors=[],this.currentActor=0,this.id=F;const O=this.workerPool.acquire(F);for(let y=0;y<O.length;y++){const s=new a.C(O[y],E,F);s.name=`Worker ${y}`,this.actors.push(s)}if(!this.actors.length)throw new Error("No actors found")}broadcast(A,E,F){a.o(this.actors,(O,y)=>{O.send(A,E,y)},F=F||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(A=!0){this.actors.forEach(E=>{E.remove()}),this.actors=[],A&&this.workerPool.release(this.id)}}function Ci(Z,A,E){const F=function(O,y){if(O)return E(O);if(y){const s=a.F(a.e(y,Z),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);y.vector_layers&&(s.vectorLayers=y.vector_layers,s.vectorLayerIds=s.vectorLayers.map(i=>i.id)),E(null,s)}};return Z.url?a.f(A.transformRequest(Z.url,it.Source),F):a.h.frame(()=>F(null,Z))}class Ri{constructor(A,E){A&&(E?this.setSouthWest(A).setNorthEast(E):Array.isArray(A)&&(A.length===4?this.setSouthWest([A[0],A[1]]).setNorthEast([A[2],A[3]]):this.setSouthWest(A[0]).setNorthEast(A[1])))}setNorthEast(A){return this._ne=A instanceof a.L?new a.L(A.lng,A.lat):a.L.convert(A),this}setSouthWest(A){return this._sw=A instanceof a.L?new a.L(A.lng,A.lat):a.L.convert(A),this}extend(A){const E=this._sw,F=this._ne;let O,y;if(A instanceof a.L)O=A,y=A;else{if(!(A instanceof Ri))return Array.isArray(A)?A.length===4||A.every(Array.isArray)?this.extend(Ri.convert(A)):this.extend(a.L.convert(A)):A&&("lng"in A||"lon"in A)&&"lat"in A?this.extend(a.L.convert(A)):this;if(O=A._sw,y=A._ne,!O||!y)return this}return E||F?(E.lng=Math.min(O.lng,E.lng),E.lat=Math.min(O.lat,E.lat),F.lng=Math.max(y.lng,F.lng),F.lat=Math.max(y.lat,F.lat)):(this._sw=new a.L(O.lng,O.lat),this._ne=new a.L(y.lng,y.lat)),this}getCenter(){return new a.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.L(this.getWest(),this.getNorth())}getSouthEast(){return new a.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(A){const{lng:E,lat:F}=a.L.convert(A);let O=this._sw.lng<=E&&E<=this._ne.lng;return this._sw.lng>this._ne.lng&&(O=this._sw.lng>=E&&E>=this._ne.lng),this._sw.lat<=F&&F<=this._ne.lat&&O}static convert(A){return A instanceof Ri?A:A&&new Ri(A)}static fromLngLat(A,E=0){const F=360*E/40075017,O=F/Math.cos(Math.PI/180*A.lat);return new Ri(new a.L(A.lng-O,A.lat-F),new a.L(A.lng+O,A.lat+F))}}class Ki{constructor(A,E,F){this.bounds=Ri.convert(this.validateBounds(A)),this.minzoom=E||0,this.maxzoom=F||24}validateBounds(A){return Array.isArray(A)&&A.length===4?[Math.max(-180,A[0]),Math.max(-90,A[1]),Math.min(180,A[2]),Math.min(90,A[3])]:[-180,-90,180,90]}contains(A){const E=Math.pow(2,A.z),F=Math.floor(a.G(this.bounds.getWest())*E),O=Math.floor(a.H(this.bounds.getNorth())*E),y=Math.ceil(a.G(this.bounds.getEast())*E),s=Math.ceil(a.H(this.bounds.getSouth())*E);return A.x>=F&&A.x<y&&A.y>=O&&A.y<s}}class Hi extends a.E{constructor(A,E,F,O){if(super(),this.load=()=>{this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Ci(this._options,this.map._requestManager,(y,s)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),y?this.fire(new a.j(y)):s&&(a.e(this,s),s.bounds&&(this.tileBounds=new Ki(s.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>a.e({},this._options),this.id=A,this.dispatcher=F,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.F(E,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},E),this._collectResourceTiming=E.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(O)}loaded(){return this._loaded}hasTile(A){return!this.tileBounds||this.tileBounds.contains(A.canonical)}onAdd(A){this.map=A,this.load()}setSourceProperty(A){this._tileJSONRequest&&this._tileJSONRequest.cancel(),A(),this.load()}setTiles(A){return this.setSourceProperty(()=>{this._options.tiles=A}),this}setUrl(A){return this.setSourceProperty(()=>{this.url=A,this._options.url=A}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(A,E){const F=A.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),O={request:this.map._requestManager.transformRequest(F,it.Tile),uid:A.uid,tileID:A.tileID,zoom:A.tileID.overscaledZ,tileSize:this.tileSize*A.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function y(s,i){return delete A.request,A.aborted?E(null):s&&s.status!==404?E(s):(i&&i.resourceTiming&&(A.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&i&&A.setExpiryData(i),A.loadVectorData(i,this.map.painter),E(null),void(A.reloadCallback&&(this.loadTile(A,A.reloadCallback),A.reloadCallback=null)))}O.request.collectResourceTiming=this._collectResourceTiming,A.actor&&A.state!=="expired"?A.state==="loading"?A.reloadCallback=E:A.request=A.actor.send("reloadTile",O,y.bind(this)):(A.actor=this.dispatcher.getActor(),A.request=A.actor.send("loadTile",O,y.bind(this)))}abortTile(A){A.request&&(A.request.cancel(),delete A.request),A.actor&&A.actor.send("abortTile",{uid:A.uid,type:this.type,source:this.id},void 0)}unloadTile(A){A.unloadVectorData(),A.actor&&A.actor.send("removeTile",{uid:A.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class Ni extends a.E{constructor(A,E,F,O){super(),this.id=A,this.dispatcher=F,this.setEventedParent(O),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},E),a.e(this,a.F(E,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Ci(this._options,this.map._requestManager,(A,E)=>{this._tileJSONRequest=null,this._loaded=!0,A?this.fire(new a.j(A)):E&&(a.e(this,E),E.bounds&&(this.tileBounds=new Ki(E.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(A){this.map=A,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(A){this._tileJSONRequest&&this._tileJSONRequest.cancel(),A(),this.load()}setTiles(A){return this.setSourceProperty(()=>{this._options.tiles=A}),this}serialize(){return a.e({},this._options)}hasTile(A){return!this.tileBounds||this.tileBounds.contains(A.canonical)}loadTile(A,E){const F=A.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);A.request=Ye.getImage(this.map._requestManager.transformRequest(F,it.Tile),(O,y,s)=>{if(delete A.request,A.aborted)A.state="unloaded",E(null);else if(O)A.state="errored",E(O);else if(y){this.map._refreshExpiredTiles&&s&&A.setExpiryData(s);const i=this.map.painter.context,r=i.gl;A.texture=this.map.painter.getTileTexture(y.width),A.texture?A.texture.update(y,{useMipmap:!0}):(A.texture=new mt(i,y,r.RGBA,{useMipmap:!0}),A.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE,r.LINEAR_MIPMAP_NEAREST),i.extTextureFilterAnisotropic&&r.texParameterf(r.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax)),A.state="loaded",E(null)}},this.map._refreshExpiredTiles)}abortTile(A,E){A.request&&(A.request.cancel(),delete A.request),E()}unloadTile(A,E){A.texture&&this.map.painter.saveTileTexture(A.texture),E()}hasTransition(){return!1}}class nn extends Ni{constructor(A,E,F,O){super(A,E,F,O),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},E),this.encoding=E.encoding||"mapbox",this.redFactor=E.redFactor,this.greenFactor=E.greenFactor,this.blueFactor=E.blueFactor,this.baseShift=E.baseShift}loadTile(A,E){const F=A.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),O=this.map._requestManager.transformRequest(F,it.Tile);function y(s,i){s&&(A.state="errored",E(s)),i&&(A.dem=i,A.needsHillshadePrepare=!0,A.needsTerrainPrepare=!0,A.state="loaded",E(null))}A.neighboringTiles=this._getNeighboringTiles(A.tileID),A.request=Ye.getImage(O,(s,i,r)=>a._(this,void 0,void 0,function*(){if(delete A.request,A.aborted)A.state="unloaded",E(null);else if(s)A.state="errored",E(s);else if(i){this.map._refreshExpiredTiles&&A.setExpiryData(r);const l=a.a(i)&&a.J()?i:yield function(_){return a._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&a.K()){const w=_.width+2,T=_.height+2;try{return new a.R({width:w,height:T},yield a.M(_,-1,-1,w,T))}catch{}}return a.h.getImageData(_,1)})}(i),d={uid:A.uid,coord:A.tileID,source:this.id,rawImageData:l,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};A.actor&&A.state!=="expired"||(A.actor=this.dispatcher.getActor(),A.actor.send("loadDEMTile",d,y))}}),this.map._refreshExpiredTiles)}_getNeighboringTiles(A){const E=A.canonical,F=Math.pow(2,E.z),O=(E.x-1+F)%F,y=E.x===0?A.wrap-1:A.wrap,s=(E.x+1+F)%F,i=E.x+1===F?A.wrap+1:A.wrap,r={};return r[new a.O(A.overscaledZ,y,E.z,O,E.y).key]={backfilled:!1},r[new a.O(A.overscaledZ,i,E.z,s,E.y).key]={backfilled:!1},E.y>0&&(r[new a.O(A.overscaledZ,y,E.z,O,E.y-1).key]={backfilled:!1},r[new a.O(A.overscaledZ,A.wrap,E.z,E.x,E.y-1).key]={backfilled:!1},r[new a.O(A.overscaledZ,i,E.z,s,E.y-1).key]={backfilled:!1}),E.y+1<F&&(r[new a.O(A.overscaledZ,y,E.z,O,E.y+1).key]={backfilled:!1},r[new a.O(A.overscaledZ,A.wrap,E.z,E.x,E.y+1).key]={backfilled:!1},r[new a.O(A.overscaledZ,i,E.z,s,E.y+1).key]={backfilled:!1}),r}unloadTile(A){A.demTexture&&this.map.painter.saveTileTexture(A.demTexture),A.fbo&&(A.fbo.destroy(),delete A.fbo),A.dem&&delete A.dem,delete A.neighboringTiles,A.state="unloaded",A.actor&&A.actor.send("removeDEMTile",{uid:A.uid,source:this.id})}}class vn extends a.E{constructor(A,E,F,O){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>a.e({},this._options,{type:this.type,data:this._data}),this.id=A,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=F.getActor(),this.setEventedParent(O),this._data=E.data,this._options=a.e({},E),this._collectResourceTiming=E.collectResourceTiming,E.maxzoom!==void 0&&(this.maxzoom=E.maxzoom),E.type&&(this.type=E.type),E.attribution&&(this.attribution=E.attribution),this.promoteId=E.promoteId;const y=a.N/this.tileSize;this.workerOptions=a.e({source:this.id,cluster:E.cluster||!1,geojsonVtOptions:{buffer:(E.buffer!==void 0?E.buffer:128)*y,tolerance:(E.tolerance!==void 0?E.tolerance:.375)*y,extent:a.N,maxZoom:this.maxzoom,lineMetrics:E.lineMetrics||!1,generateId:E.generateId||!1},superclusterOptions:{maxZoom:E.clusterMaxZoom!==void 0?E.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,E.clusterMinPoints||2),extent:a.N,radius:(E.clusterRadius||50)*y,log:!1,generateId:E.generateId||!1},clusterProperties:E.clusterProperties,filter:E.filter},E.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(A){this.map=A,this.load()}setData(A){return this._data=A,this._updateWorkerData(),this}updateData(A){return this._updateWorkerData(A),this}setClusterOptions(A){return this.workerOptions.cluster=A.cluster,A&&(A.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=A.clusterRadius),A.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=A.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(A,E){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:A,source:this.id},E),this}getClusterChildren(A,E){return this.actor.send("geojson.getClusterChildren",{clusterId:A,source:this.id},E),this}getClusterLeaves(A,E,F,O){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:A,limit:E,offset:F},O),this}_updateWorkerData(A){const E=a.e({},this.workerOptions);A?E.dataDiff=A:typeof this._data=="string"?(E.request=this.map._requestManager.transformRequest(a.h.resolveURL(this._data),it.Source),E.request.collectResourceTiming=this._collectResourceTiming):E.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new a.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,E,(F,O)=>{if(this._pendingLoads--,this._removed||O&&O.abandoned)return void this.fire(new a.k("dataabort",{dataType:"source"}));let y=null;if(O&&O.resourceTiming&&O.resourceTiming[this.id]&&(y=O.resourceTiming[this.id].slice(0)),F)return void this.fire(new a.j(F));const s={dataType:"source"};this._collectResourceTiming&&y&&y.length>0&&a.e(s,{resourceTiming:y}),this.fire(new a.k("data",Object.assign(Object.assign({},s),{sourceDataType:"metadata"}))),this.fire(new a.k("data",Object.assign(Object.assign({},s),{sourceDataType:"content"})))})}loaded(){return this._pendingLoads===0}loadTile(A,E){const F=A.actor?"reloadTile":"loadTile";A.actor=this.actor;const O={type:this.type,uid:A.uid,tileID:A.tileID,zoom:A.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};A.request=this.actor.send(F,O,(y,s)=>(delete A.request,A.unloadVectorData(),A.aborted?E(null):y?E(y):(A.loadVectorData(s,this.map.painter,F==="reloadTile"),E(null))))}abortTile(A){A.request&&(A.request.cancel(),delete A.request),A.aborted=!0}unloadTile(A){A.unloadVectorData(),this.actor.send("removeTile",{uid:A.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var Ei=a.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class mi extends a.E{constructor(A,E,F,O){super(),this.load=(y,s)=>{this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=Ye.getImage(this.map._requestManager.transformRequest(this.url,it.Image),(i,r)=>{this._request=null,this._loaded=!0,i?this.fire(new a.j(i)):r&&(this.image=r,y&&(this.coordinates=y),s&&s(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const y=this.map.painter.context,s=y.gl;this.boundsBuffer||(this.boundsBuffer=y.createVertexBuffer(this._boundsArray,Ei.members)),this.boundsSegments||(this.boundsSegments=a.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new mt(y,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let i=!1;for(const r in this.tiles){const l=this.tiles[r];l.state!=="loaded"&&(l.state="loaded",l.texture=this.texture,i=!0)}i&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=A,this.dispatcher=F,this.coordinates=E.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(O),this.options=E}loaded(){return this._loaded}updateImage(A){return A.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=A.url,this.load(A.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(A){this.map=A,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(A){this.coordinates=A;const E=A.map(a.U.fromLngLat);this.tileID=function(O){let y=1/0,s=1/0,i=-1/0,r=-1/0;for(const w of O)y=Math.min(y,w.x),s=Math.min(s,w.y),i=Math.max(i,w.x),r=Math.max(r,w.y);const l=Math.max(i-y,r-s),d=Math.max(0,Math.floor(-Math.log(l)/Math.LN2)),_=Math.pow(2,d);return new a.W(d,Math.floor((y+i)/2*_),Math.floor((s+r)/2*_))}(E),this.minzoom=this.maxzoom=this.tileID.z;const F=E.map(O=>this.tileID.getTilePoint(O)._round());return this._boundsArray=new a.V,this._boundsArray.emplaceBack(F[0].x,F[0].y,0,0),this._boundsArray.emplaceBack(F[1].x,F[1].y,a.N,0),this._boundsArray.emplaceBack(F[3].x,F[3].y,0,a.N),this._boundsArray.emplaceBack(F[2].x,F[2].y,a.N,a.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(A,E){this.tileID&&this.tileID.equals(A.tileID.canonical)?(this.tiles[String(A.tileID.wrap)]=A,A.buckets={},E(null)):(A.state="errored",E(null))}hasTransition(){return!1}}class zi extends mi{constructor(A,E,F,O){super(A,E,F,O),this.load=()=>{this._loaded=!1;const y=this.options;this.urls=[];for(const s of y.urls)this.urls.push(this.map._requestManager.transformRequest(s,it.Source).url);a.X(this.urls,(s,i)=>{this._loaded=!0,s?this.fire(new a.j(s)):i&&(this.video=i,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const y=this.map.painter.context,s=y.gl;this.boundsBuffer||(this.boundsBuffer=y.createVertexBuffer(this._boundsArray,Ei.members)),this.boundsSegments||(this.boundsSegments=a.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new mt(y,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let i=!1;for(const r in this.tiles){const l=this.tiles[r];l.state!=="loaded"&&(l.state="loaded",l.texture=this.texture,i=!0)}i&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=E}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(A){if(this.video){const E=this.video.seekable;A<E.start(0)||A>E.end(0)?this.fire(new a.j(new a.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${E.start(0)} and ${E.end(0)}-second mark.`))):this.video.currentTime=A}}getVideo(){return this.video}onAdd(A){this.map||(this.map=A,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class Oi extends mi{constructor(A,E,F,O){super(A,E,F,O),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let y=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,y=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,y=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context,i=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,Ei.members)),this.boundsSegments||(this.boundsSegments=a.S.simpleSegment(0,0,4,2)),this.texture?(y||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new mt(s,this.canvas,i.RGBA,{premultiply:!0});let r=!1;for(const l in this.tiles){const d=this.tiles[l];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture,r=!0)}r&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),E.coordinates?Array.isArray(E.coordinates)&&E.coordinates.length===4&&!E.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(s=>typeof s!="number"))||this.fire(new a.j(new a.Y(`sources.${A}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.j(new a.Y(`sources.${A}`,null,'missing required property "coordinates"'))),E.animate&&typeof E.animate!="boolean"&&this.fire(new a.j(new a.Y(`sources.${A}`,null,'optional "animate" property must be a boolean value'))),E.canvas?typeof E.canvas=="string"||E.canvas instanceof HTMLCanvasElement||this.fire(new a.j(new a.Y(`sources.${A}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.j(new a.Y(`sources.${A}`,null,'missing required property "canvas"'))),this.options=E,this.animate=E.animate===void 0||E.animate}getCanvas(){return this.canvas}onAdd(A){this.map=A,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const A of[this.canvas.width,this.canvas.height])if(isNaN(A)||A<=0)return!0;return!1}}const xn={},bn=Z=>{switch(Z){case"geojson":return vn;case"image":return mi;case"raster":return Ni;case"raster-dem":return nn;case"vector":return Hi;case"video":return zi;case"canvas":return Oi}return xn[Z]};function Yt(Z,A){const E=a.Z();return a.$(E,E,[1,1,0]),a.a0(E,E,[.5*Z.width,.5*Z.height,1]),a.a1(E,E,Z.calculatePosMatrix(A.toUnwrapped()))}function rn(Z,A,E,F,O,y){const s=function(_,w,T){if(_)for(const B of _){const j=w[B];if(j&&j.source===T&&j.type==="fill-extrusion")return!0}else for(const B in w){const j=w[B];if(j.source===T&&j.type==="fill-extrusion")return!0}return!1}(O&&O.layers,A,Z.id),i=y.maxPitchScaleFactor(),r=Z.tilesIn(F,i,s);r.sort(Xt);const l=[];for(const _ of r)l.push({wrappedTileID:_.tileID.wrapped().key,queryResults:_.tile.queryRenderedFeatures(A,E,Z._state,_.queryGeometry,_.cameraQueryGeometry,_.scale,O,y,i,Yt(Z.transform,_.tileID))});const d=function(_){const w={},T={};for(const B of _){const j=B.queryResults,X=B.wrappedTileID,ue=T[X]=T[X]||{};for(const Se in j){const Te=j[Se],Re=ue[Se]=ue[Se]||{},Be=w[Se]=w[Se]||[];for(const et of Te)Re[et.featureIndex]||(Re[et.featureIndex]=!0,Be.push(et))}}return w}(l);for(const _ in d)d[_].forEach(w=>{const T=w.feature,B=Z.getFeatureState(T.layer["source-layer"],T.id);T.source=T.layer.source,T.layer["source-layer"]&&(T.sourceLayer=T.layer["source-layer"]),T.state=B});return d}function Xt(Z,A){const E=Z.tileID,F=A.tileID;return E.overscaledZ-F.overscaledZ||E.canonical.y-F.canonical.y||E.wrap-F.wrap||E.canonical.x-F.canonical.x}class Ji{constructor(A,E){this.timeAdded=0,this.fadeEndTime=0,this.tileID=A,this.uid=a.a2(),this.uses=0,this.tileSize=E,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(A){const E=A+this.timeAdded;E<this.fadeEndTime||(this.fadeEndTime=E)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(A){this.demTexture&&A.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(A,E,F){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",A){A.featureIndex&&(this.latestFeatureIndex=A.featureIndex,A.rawTileData?(this.latestRawTileData=A.rawTileData,this.latestFeatureIndex.rawTileData=A.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=A.collisionBoxArray,this.buckets=function(O,y){const s={};if(!y)return s;for(const i of O){const r=i.layerIds.map(l=>y.getLayer(l)).filter(Boolean);if(r.length!==0){i.layers=r,i.stateDependentLayerIds&&(i.stateDependentLayers=i.stateDependentLayerIds.map(l=>r.filter(d=>d.id===l)[0]));for(const l of r)s[l.id]=i}}return s}(A.buckets,E.style),this.hasSymbolBuckets=!1;for(const O in this.buckets){const y=this.buckets[O];if(y instanceof a.a4){if(this.hasSymbolBuckets=!0,!F)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const O in this.buckets){const y=this.buckets[O];if(y instanceof a.a4&&y.hasRTLText){this.hasRTLText=!0,a.a5();break}}this.queryPadding=0;for(const O in this.buckets){const y=this.buckets[O];this.queryPadding=Math.max(this.queryPadding,E.style.getLayer(O).queryRadius(y))}A.imageAtlas&&(this.imageAtlas=A.imageAtlas),A.glyphAtlasImage&&(this.glyphAtlasImage=A.glyphAtlasImage)}else this.collisionBoxArray=new a.a3}unloadVectorData(){for(const A in this.buckets)this.buckets[A].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(A){return this.buckets[A.id]}upload(A){for(const F in this.buckets){const O=this.buckets[F];O.uploadPending()&&O.upload(A)}const E=A.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new mt(A,this.imageAtlas.image,E.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new mt(A,this.glyphAtlasImage,E.ALPHA),this.glyphAtlasImage=null)}prepare(A){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(A,this.imageAtlasTexture)}queryRenderedFeatures(A,E,F,O,y,s,i,r,l,d){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:O,cameraQueryGeometry:y,scale:s,tileSize:this.tileSize,pixelPosMatrix:d,transform:r,params:i,queryPadding:this.queryPadding*l},A,E,F):{}}querySourceFeatures(A,E){const F=this.latestFeatureIndex;if(!F||!F.rawTileData)return;const O=F.loadVTLayers(),y=E&&E.sourceLayer?E.sourceLayer:"",s=O._geojsonTileLayer||O[y];if(!s)return;const i=a.a6(E&&E.filter),{z:r,x:l,y:d}=this.tileID.canonical,_={z:r,x:l,y:d};for(let w=0;w<s.length;w++){const T=s.feature(w);if(i.needGeometry){const X=a.a7(T,!0);if(!i.filter(new a.a8(this.tileID.overscaledZ),X,this.tileID.canonical))continue}else if(!i.filter(new a.a8(this.tileID.overscaledZ),T))continue;const B=F.getId(T,y),j=new a.a9(T,r,l,d,B);j.tile=_,A.push(j)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(A){const E=this.expirationTime;if(A.cacheControl){const F=a.aa(A.cacheControl);F["max-age"]&&(this.expirationTime=Date.now()+1e3*F["max-age"])}else A.expires&&(this.expirationTime=new Date(A.expires).getTime());if(this.expirationTime){const F=Date.now();let O=!1;if(this.expirationTime>F)O=!1;else if(E)if(this.expirationTime<E)O=!0;else{const y=this.expirationTime-E;y?this.expirationTime=F+Math.max(y,3e4):O=!0}else O=!0;O?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(A,E){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(A).length===0)return;const F=this.latestFeatureIndex.loadVTLayers();for(const O in this.buckets){if(!E.style.hasLayer(O))continue;const y=this.buckets[O],s=y.layers[0].sourceLayer||"_geojsonTileLayer",i=F[s],r=A[s];if(!i||!r||Object.keys(r).length===0)continue;y.update(r,i,this.imageAtlas&&this.imageAtlas.patternPositions||{});const l=E&&E.style&&E.style.getLayer(O);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(A){this.symbolFadeHoldUntil=a.h.now()+A}setDependencies(A,E){const F={};for(const O of E)F[O]=!0;this.dependencies[A]=F}hasDependency(A,E){for(const F of A){const O=this.dependencies[F];if(O){for(const y of E)if(O[y])return!0}}return!1}}class mr{constructor(A,E){this.max=A,this.onRemove=E,this.reset()}reset(){for(const A in this.data)for(const E of this.data[A])E.timeout&&clearTimeout(E.timeout),this.onRemove(E.value);return this.data={},this.order=[],this}add(A,E,F){const O=A.wrapped().key;this.data[O]===void 0&&(this.data[O]=[]);const y={value:E,timeout:void 0};if(F!==void 0&&(y.timeout=setTimeout(()=>{this.remove(A,y)},F)),this.data[O].push(y),this.order.push(O),this.order.length>this.max){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}has(A){return A.wrapped().key in this.data}getAndRemove(A){return this.has(A)?this._getAndRemoveByKey(A.wrapped().key):null}_getAndRemoveByKey(A){const E=this.data[A].shift();return E.timeout&&clearTimeout(E.timeout),this.data[A].length===0&&delete this.data[A],this.order.splice(this.order.indexOf(A),1),E.value}getByKey(A){const E=this.data[A];return E?E[0].value:null}get(A){return this.has(A)?this.data[A.wrapped().key][0].value:null}remove(A,E){if(!this.has(A))return this;const F=A.wrapped().key,O=E===void 0?0:this.data[F].indexOf(E),y=this.data[F][O];return this.data[F].splice(O,1),y.timeout&&clearTimeout(y.timeout),this.data[F].length===0&&delete this.data[F],this.onRemove(y.value),this.order.splice(this.order.indexOf(F),1),this}setMaxSize(A){for(this.max=A;this.order.length>this.max;){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}filter(A){const E=[];for(const F in this.data)for(const O of this.data[F])A(O.value)||E.push(O);for(const F of E)this.remove(F.value.tileID,F)}}class ci{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(A,E,F){const O=String(E);if(this.stateChanges[A]=this.stateChanges[A]||{},this.stateChanges[A][O]=this.stateChanges[A][O]||{},a.e(this.stateChanges[A][O],F),this.deletedStates[A]===null){this.deletedStates[A]={};for(const y in this.state[A])y!==O&&(this.deletedStates[A][y]=null)}else if(this.deletedStates[A]&&this.deletedStates[A][O]===null){this.deletedStates[A][O]={};for(const y in this.state[A][O])F[y]||(this.deletedStates[A][O][y]=null)}else for(const y in F)this.deletedStates[A]&&this.deletedStates[A][O]&&this.deletedStates[A][O][y]===null&&delete this.deletedStates[A][O][y]}removeFeatureState(A,E,F){if(this.deletedStates[A]===null)return;const O=String(E);if(this.deletedStates[A]=this.deletedStates[A]||{},F&&E!==void 0)this.deletedStates[A][O]!==null&&(this.deletedStates[A][O]=this.deletedStates[A][O]||{},this.deletedStates[A][O][F]=null);else if(E!==void 0)if(this.stateChanges[A]&&this.stateChanges[A][O])for(F in this.deletedStates[A][O]={},this.stateChanges[A][O])this.deletedStates[A][O][F]=null;else this.deletedStates[A][O]=null;else this.deletedStates[A]=null}getState(A,E){const F=String(E),O=a.e({},(this.state[A]||{})[F],(this.stateChanges[A]||{})[F]);if(this.deletedStates[A]===null)return{};if(this.deletedStates[A]){const y=this.deletedStates[A][E];if(y===null)return{};for(const s in y)delete O[s]}return O}initializeTileState(A,E){A.setFeatureState(this.state,E)}coalesceChanges(A,E){const F={};for(const O in this.stateChanges){this.state[O]=this.state[O]||{};const y={};for(const s in this.stateChanges[O])this.state[O][s]||(this.state[O][s]={}),a.e(this.state[O][s],this.stateChanges[O][s]),y[s]=this.state[O][s];F[O]=y}for(const O in this.deletedStates){this.state[O]=this.state[O]||{};const y={};if(this.deletedStates[O]===null)for(const s in this.state[O])y[s]={},this.state[O][s]={};else for(const s in this.deletedStates[O]){if(this.deletedStates[O][s]===null)this.state[O][s]={};else for(const i of Object.keys(this.deletedStates[O][s]))delete this.state[O][s][i];y[s]=this.state[O][s]}F[O]=F[O]||{},a.e(F[O],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(F).length!==0)for(const O in A)A[O].setFeatureState(F,E)}}class sn extends a.E{constructor(A,E,F){super(),this.id=A,this.dispatcher=F,this.on("data",O=>{O.dataType==="source"&&O.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&O.dataType==="source"&&O.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((O,y,s,i)=>{const r=new(bn(y.type))(O,y,s,i);if(r.id!==O)throw new Error(`Expected Source id to be ${O} instead of ${r.id}`);return r})(A,E,F,this),this._tiles={},this._cache=new mr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ci,this._didEmitContent=!1,this._updated=!1}onAdd(A){this.map=A,this._maxTileCacheSize=A?A._maxTileCacheSize:null,this._maxTileCacheZoomLevels=A?A._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(A)}onRemove(A){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(A)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const A in this._tiles){const E=this._tiles[A];if(E.state!=="loaded"&&E.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const A=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,A&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(A,E){return this._source.loadTile(A,E)}_unloadTile(A){if(this._source.unloadTile)return this._source.unloadTile(A,()=>{})}_abortTile(A){this._source.abortTile&&this._source.abortTile(A,()=>{}),this._source.fire(new a.k("dataabort",{tile:A,coord:A.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(A){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const E in this._tiles){const F=this._tiles[E];F.upload(A),F.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(A=>A.tileID).sort(lr).map(A=>A.key)}getRenderableIds(A){const E=[];for(const F in this._tiles)this._isIdRenderable(F,A)&&E.push(this._tiles[F]);return A?E.sort((F,O)=>{const y=F.tileID,s=O.tileID,i=new a.P(y.canonical.x,y.canonical.y)._rotate(this.transform.angle),r=new a.P(s.canonical.x,s.canonical.y)._rotate(this.transform.angle);return y.overscaledZ-s.overscaledZ||r.y-i.y||r.x-i.x}).map(F=>F.tileID.key):E.map(F=>F.tileID).sort(lr).map(F=>F.key)}hasRenderableParent(A){const E=this.findLoadedParent(A,0);return!!E&&this._isIdRenderable(E.tileID.key)}_isIdRenderable(A,E){return this._tiles[A]&&this._tiles[A].hasData()&&!this._coveredTiles[A]&&(E||!this._tiles[A].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const A in this._tiles)this._tiles[A].state!=="errored"&&this._reloadTile(A,"reloading")}}_reloadTile(A,E){const F=this._tiles[A];F&&(F.state!=="loading"&&(F.state=E),this._loadTile(F,this._tileLoaded.bind(this,F,A,E)))}_tileLoaded(A,E,F,O){if(O)return A.state="errored",void(O.status!==404?this._source.fire(new a.j(O,{tile:A})):this.update(this.transform,this.terrain));A.timeAdded=a.h.now(),F==="expired"&&(A.refreshedUponExpiration=!0),this._setTileReloadTimer(E,A),this.getSource().type==="raster-dem"&&A.dem&&this._backfillDEM(A),this._state.initializeTileState(A,this.map?this.map.painter:null),A.aborted||this._source.fire(new a.k("data",{dataType:"source",tile:A,coord:A.tileID}))}_backfillDEM(A){const E=this.getRenderableIds();for(let O=0;O<E.length;O++){const y=E[O];if(A.neighboringTiles&&A.neighboringTiles[y]){const s=this.getTileByID(y);F(A,s),F(s,A)}}function F(O,y){O.needsHillshadePrepare=!0,O.needsTerrainPrepare=!0;let s=y.tileID.canonical.x-O.tileID.canonical.x;const i=y.tileID.canonical.y-O.tileID.canonical.y,r=Math.pow(2,O.tileID.canonical.z),l=y.tileID.key;s===0&&i===0||Math.abs(i)>1||(Math.abs(s)>1&&(Math.abs(s+r)===1?s+=r:Math.abs(s-r)===1&&(s-=r)),y.dem&&O.dem&&(O.dem.backfillBorder(y.dem,s,i),O.neighboringTiles&&O.neighboringTiles[l]&&(O.neighboringTiles[l].backfilled=!0)))}}getTile(A){return this.getTileByID(A.key)}getTileByID(A){return this._tiles[A]}_retainLoadedChildren(A,E,F,O){for(const y in this._tiles){let s=this._tiles[y];if(O[y]||!s.hasData()||s.tileID.overscaledZ<=E||s.tileID.overscaledZ>F)continue;let i=s.tileID;for(;s&&s.tileID.overscaledZ>E+1;){const l=s.tileID.scaledTo(s.tileID.overscaledZ-1);s=this._tiles[l.key],s&&s.hasData()&&(i=l)}let r=i;for(;r.overscaledZ>E;)if(r=r.scaledTo(r.overscaledZ-1),A[r.key]){O[i.key]=i;break}}}findLoadedParent(A,E){if(A.key in this._loadedParentTiles){const F=this._loadedParentTiles[A.key];return F&&F.tileID.overscaledZ>=E?F:null}for(let F=A.overscaledZ-1;F>=E;F--){const O=A.scaledTo(F),y=this._getLoadedTile(O);if(y)return y}}_getLoadedTile(A){const E=this._tiles[A.key];return E&&E.hasData()?E:this._cache.getByKey(A.wrapped().key)}updateCacheSize(A){const E=Math.ceil(A.width/this._source.tileSize)+1,F=Math.ceil(A.height/this._source.tileSize)+1,O=Math.floor(E*F*(this._maxTileCacheZoomLevels===null?a.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,O):O;this._cache.setMaxSize(y)}handleWrapJump(A){const E=Math.round((A-(this._prevLng===void 0?A:this._prevLng))/360);if(this._prevLng=A,E){const F={};for(const O in this._tiles){const y=this._tiles[O];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+E),F[y.tileID.key]=y}this._tiles=F;for(const O in this._timers)clearTimeout(this._timers[O]),delete this._timers[O];for(const O in this._tiles)this._setTileReloadTimer(O,this._tiles[O])}}update(A,E){if(this.transform=A,this.terrain=E,!this._sourceLoaded||this._paused)return;let F;this.updateCacheSize(A),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?F=A.getVisibleUnwrappedCoordinates(this._source.tileID).map(d=>new a.O(d.canonical.z,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y)):(F=A.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:E}),this._source.hasTile&&(F=F.filter(d=>this._source.hasTile(d)))):F=[];const O=A.coveringZoomLevel(this._source),y=Math.max(O-sn.maxOverzooming,this._source.minzoom),s=Math.max(O+sn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const d={};for(const _ of F)if(_.canonical.z>this._source.minzoom){const w=_.scaledTo(_.canonical.z-1);d[w.key]=w;const T=_.scaledTo(Math.max(this._source.minzoom,Math.min(_.canonical.z,5)));d[T.key]=T}F=F.concat(Object.values(d))}const i=F.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,i&&this.fire(new a.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const r=this._updateRetainedTiles(F,O);if(On(this._source.type)){const d={},_={},w=Object.keys(r),T=a.h.now();for(const B of w){const j=r[B],X=this._tiles[B];if(!X||X.fadeEndTime!==0&&X.fadeEndTime<=T)continue;const ue=this.findLoadedParent(j,y);ue&&(this._addTile(ue.tileID),d[ue.tileID.key]=ue.tileID),_[B]=j}this._retainLoadedChildren(_,O,s,r);for(const B in d)r[B]||(this._coveredTiles[B]=!0,r[B]=d[B]);if(E){const B={},j={};for(const X of F)this._tiles[X.key].hasData()?B[X.key]=X:j[X.key]=X;for(const X in j){const ue=j[X].children(this._source.maxzoom);this._tiles[ue[0].key]&&this._tiles[ue[1].key]&&this._tiles[ue[2].key]&&this._tiles[ue[3].key]&&(B[ue[0].key]=r[ue[0].key]=ue[0],B[ue[1].key]=r[ue[1].key]=ue[1],B[ue[2].key]=r[ue[2].key]=ue[2],B[ue[3].key]=r[ue[3].key]=ue[3],delete j[X])}for(const X in j){const ue=this.findLoadedParent(j[X],this._source.minzoom);if(ue){B[ue.tileID.key]=r[ue.tileID.key]=ue.tileID;for(const Se in B)B[Se].isChildOf(ue.tileID)&&delete B[Se]}}for(const X in this._tiles)B[X]||(this._coveredTiles[X]=!0)}}for(const d in r)this._tiles[d].clearFadeHold();const l=a.ab(this._tiles,r);for(const d of l){const _=this._tiles[d];_.hasSymbolBuckets&&!_.holdingForFade()?_.setHoldDuration(this.map._fadeDuration):_.hasSymbolBuckets&&!_.symbolFadeFinished()||this._removeTile(d)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const A in this._tiles)this._tiles[A].holdingForFade()&&this._removeTile(A)}_updateRetainedTiles(A,E){const F={},O={},y=Math.max(E-sn.maxOverzooming,this._source.minzoom),s=Math.max(E+sn.maxUnderzooming,this._source.minzoom),i={};for(const r of A){const l=this._addTile(r);F[r.key]=r,l.hasData()||E<this._source.maxzoom&&(i[r.key]=r)}this._retainLoadedChildren(i,E,s,F);for(const r of A){let l=this._tiles[r.key];if(l.hasData())continue;if(E+1>this._source.maxzoom){const _=r.children(this._source.maxzoom)[0],w=this.getTile(_);if(w&&w.hasData()){F[_.key]=_;continue}}else{const _=r.children(this._source.maxzoom);if(F[_[0].key]&&F[_[1].key]&&F[_[2].key]&&F[_[3].key])continue}let d=l.wasRequested();for(let _=r.overscaledZ-1;_>=y;--_){const w=r.scaledTo(_);if(O[w.key])break;if(O[w.key]=!0,l=this.getTile(w),!l&&d&&(l=this._addTile(w)),l){const T=l.hasData();if((d||T)&&(F[w.key]=w),d=l.wasRequested(),T)break}}}return F}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const A in this._tiles){const E=[];let F,O=this._tiles[A].tileID;for(;O.overscaledZ>0;){if(O.key in this._loadedParentTiles){F=this._loadedParentTiles[O.key];break}E.push(O.key);const y=O.scaledTo(O.overscaledZ-1);if(F=this._getLoadedTile(y),F)break;O=y}for(const y of E)this._loadedParentTiles[y]=F}}_addTile(A){let E=this._tiles[A.key];if(E)return E;E=this._cache.getAndRemove(A),E&&(this._setTileReloadTimer(A.key,E),E.tileID=A,this._state.initializeTileState(E,this.map?this.map.painter:null),this._cacheTimers[A.key]&&(clearTimeout(this._cacheTimers[A.key]),delete this._cacheTimers[A.key],this._setTileReloadTimer(A.key,E)));const F=E;return E||(E=new Ji(A,this._source.tileSize*A.overscaleFactor()),this._loadTile(E,this._tileLoaded.bind(this,E,A.key,E.state))),E.uses++,this._tiles[A.key]=E,F||this._source.fire(new a.k("dataloading",{tile:E,coord:E.tileID,dataType:"source"})),E}_setTileReloadTimer(A,E){A in this._timers&&(clearTimeout(this._timers[A]),delete this._timers[A]);const F=E.getExpiryTimeout();F&&(this._timers[A]=setTimeout(()=>{this._reloadTile(A,"expired"),delete this._timers[A]},F))}_removeTile(A){const E=this._tiles[A];E&&(E.uses--,delete this._tiles[A],this._timers[A]&&(clearTimeout(this._timers[A]),delete this._timers[A]),E.uses>0||(E.hasData()&&E.state!=="reloading"?this._cache.add(E.tileID,E,E.getExpiryTimeout()):(E.aborted=!0,this._abortTile(E),this._unloadTile(E))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const A in this._tiles)this._removeTile(A);this._cache.reset()}tilesIn(A,E,F){const O=[],y=this.transform;if(!y)return O;const s=F?y.getCameraQueryGeometry(A):A,i=A.map(B=>y.pointCoordinate(B,this.terrain)),r=s.map(B=>y.pointCoordinate(B,this.terrain)),l=this.getIds();let d=1/0,_=1/0,w=-1/0,T=-1/0;for(const B of r)d=Math.min(d,B.x),_=Math.min(_,B.y),w=Math.max(w,B.x),T=Math.max(T,B.y);for(let B=0;B<l.length;B++){const j=this._tiles[l[B]];if(j.holdingForFade())continue;const X=j.tileID,ue=Math.pow(2,y.zoom-j.tileID.overscaledZ),Se=E*j.queryPadding*a.N/j.tileSize/ue,Te=[X.getTilePoint(new a.U(d,_)),X.getTilePoint(new a.U(w,T))];if(Te[0].x-Se<a.N&&Te[0].y-Se<a.N&&Te[1].x+Se>=0&&Te[1].y+Se>=0){const Re=i.map(et=>X.getTilePoint(et)),Be=r.map(et=>X.getTilePoint(et));O.push({tile:j,tileID:X,queryGeometry:Re,cameraQueryGeometry:Be,scale:ue})}}return O}getVisibleCoordinates(A){const E=this.getRenderableIds(A).map(F=>this._tiles[F].tileID);for(const F of E)F.posMatrix=this.transform.calculatePosMatrix(F.toUnwrapped());return E}hasTransition(){if(this._source.hasTransition())return!0;if(On(this._source.type)){const A=a.h.now();for(const E in this._tiles)if(this._tiles[E].fadeEndTime>=A)return!0}return!1}setFeatureState(A,E,F){this._state.updateState(A=A||"_geojsonTileLayer",E,F)}removeFeatureState(A,E,F){this._state.removeFeatureState(A=A||"_geojsonTileLayer",E,F)}getFeatureState(A,E){return this._state.getState(A=A||"_geojsonTileLayer",E)}setDependencies(A,E,F){const O=this._tiles[A];O&&O.setDependencies(E,F)}reloadTilesForDependencies(A,E){for(const F in this._tiles)this._tiles[F].hasDependency(A,E)&&this._reloadTile(F,"reloading");this._cache.filter(F=>!F.hasDependency(A,E))}}function lr(Z,A){const E=Math.abs(2*Z.wrap)-+(Z.wrap<0),F=Math.abs(2*A.wrap)-+(A.wrap<0);return Z.overscaledZ-A.overscaledZ||F-E||A.canonical.y-Z.canonical.y||A.canonical.x-Z.canonical.x}function On(Z){return Z==="raster"||Z==="image"||Z==="video"}sn.maxOverzooming=10,sn.maxUnderzooming=3;const Gn="mapboxgl_preloaded_worker_pool";class pn{constructor(){this.active={}}acquire(A){if(!this.workers)for(this.workers=[];this.workers.length<pn.workerCount;)this.workers.push(new Worker(a.c.WORKER_URL));return this.active[A]=!0,this.workers.slice()}release(A){delete this.active[A],this.numActive()===0&&(this.workers.forEach(E=>{E.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Gn]}numActive(){return Object.keys(this.active).length}}const v=Math.floor(a.h.hardwareConcurrency/2);let k;function V(){return k||(k=new pn),k}pn.workerCount=a.ac(globalThis)?Math.max(Math.min(v,3),1):1;class Y{constructor(A,E){this.reset(A,E)}reset(A,E){this.points=A||[],this._distances=[0];for(let F=1;F<this.points.length;F++)this._distances[F]=this._distances[F-1]+this.points[F].dist(this.points[F-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(E||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(A){if(this.points.length===1)return this.points[0];A=a.ad(A,0,1);let E=1,F=this._distances[E];const O=A*this.paddedLength+this.padding;for(;F<O&&E<this._distances.length;)F=this._distances[++E];const y=E-1,s=this._distances[y],i=F-s,r=i>0?(O-s)/i:0;return this.points[y].mult(1-r).add(this.points[E].mult(r))}}function te(Z,A){let E=!0;return Z==="always"||Z!=="never"&&A!=="never"||(E=!1),E}class fe{constructor(A,E,F){const O=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(A/F),this.yCellCount=Math.ceil(E/F);for(let s=0;s<this.xCellCount*this.yCellCount;s++)O.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=A,this.height=E,this.xScale=this.xCellCount/A,this.yScale=this.yCellCount/E,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(A,E,F,O,y){this._forEachCell(E,F,O,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(A),this.bboxes.push(E),this.bboxes.push(F),this.bboxes.push(O),this.bboxes.push(y)}insertCircle(A,E,F,O){this._forEachCell(E-O,F-O,E+O,F+O,this._insertCircleCell,this.circleUid++),this.circleKeys.push(A),this.circles.push(E),this.circles.push(F),this.circles.push(O)}_insertBoxCell(A,E,F,O,y,s){this.boxCells[y].push(s)}_insertCircleCell(A,E,F,O,y,s){this.circleCells[y].push(s)}_query(A,E,F,O,y,s,i){if(F<0||A>this.width||O<0||E>this.height)return[];const r=[];if(A<=0&&E<=0&&this.width<=F&&this.height<=O){if(y)return[{key:null,x1:A,y1:E,x2:F,y2:O}];for(let l=0;l<this.boxKeys.length;l++)r.push({key:this.boxKeys[l],x1:this.bboxes[4*l],y1:this.bboxes[4*l+1],x2:this.bboxes[4*l+2],y2:this.bboxes[4*l+3]});for(let l=0;l<this.circleKeys.length;l++){const d=this.circles[3*l],_=this.circles[3*l+1],w=this.circles[3*l+2];r.push({key:this.circleKeys[l],x1:d-w,y1:_-w,x2:d+w,y2:_+w})}}else this._forEachCell(A,E,F,O,this._queryCell,r,{hitTest:y,overlapMode:s,seenUids:{box:{},circle:{}}},i);return r}query(A,E,F,O){return this._query(A,E,F,O,!1,null)}hitTest(A,E,F,O,y,s){return this._query(A,E,F,O,!0,y,s).length>0}hitTestCircle(A,E,F,O,y){const s=A-F,i=A+F,r=E-F,l=E+F;if(i<0||s>this.width||l<0||r>this.height)return!1;const d=[];return this._forEachCell(s,r,i,l,this._queryCellCircle,d,{hitTest:!0,overlapMode:O,circle:{x:A,y:E,radius:F},seenUids:{box:{},circle:{}}},y),d.length>0}_queryCell(A,E,F,O,y,s,i,r){const{seenUids:l,hitTest:d,overlapMode:_}=i,w=this.boxCells[y];if(w!==null){const B=this.bboxes;for(const j of w)if(!l.box[j]){l.box[j]=!0;const X=4*j,ue=this.boxKeys[j];if(A<=B[X+2]&&E<=B[X+3]&&F>=B[X+0]&&O>=B[X+1]&&(!r||r(ue))&&(!d||!te(_,ue.overlapMode))&&(s.push({key:ue,x1:B[X],y1:B[X+1],x2:B[X+2],y2:B[X+3]}),d))return!0}}const T=this.circleCells[y];if(T!==null){const B=this.circles;for(const j of T)if(!l.circle[j]){l.circle[j]=!0;const X=3*j,ue=this.circleKeys[j];if(this._circleAndRectCollide(B[X],B[X+1],B[X+2],A,E,F,O)&&(!r||r(ue))&&(!d||!te(_,ue.overlapMode))){const Se=B[X],Te=B[X+1],Re=B[X+2];if(s.push({key:ue,x1:Se-Re,y1:Te-Re,x2:Se+Re,y2:Te+Re}),d)return!0}}}return!1}_queryCellCircle(A,E,F,O,y,s,i,r){const{circle:l,seenUids:d,overlapMode:_}=i,w=this.boxCells[y];if(w!==null){const B=this.bboxes;for(const j of w)if(!d.box[j]){d.box[j]=!0;const X=4*j,ue=this.boxKeys[j];if(this._circleAndRectCollide(l.x,l.y,l.radius,B[X+0],B[X+1],B[X+2],B[X+3])&&(!r||r(ue))&&!te(_,ue.overlapMode))return s.push(!0),!0}}const T=this.circleCells[y];if(T!==null){const B=this.circles;for(const j of T)if(!d.circle[j]){d.circle[j]=!0;const X=3*j,ue=this.circleKeys[j];if(this._circlesCollide(B[X],B[X+1],B[X+2],l.x,l.y,l.radius)&&(!r||r(ue))&&!te(_,ue.overlapMode))return s.push(!0),!0}}}_forEachCell(A,E,F,O,y,s,i,r){const l=this._convertToXCellCoord(A),d=this._convertToYCellCoord(E),_=this._convertToXCellCoord(F),w=this._convertToYCellCoord(O);for(let T=l;T<=_;T++)for(let B=d;B<=w;B++)if(y.call(this,A,E,F,O,this.xCellCount*B+T,s,i,r))return}_convertToXCellCoord(A){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(A*this.xScale)))}_convertToYCellCoord(A){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(A*this.yScale)))}_circlesCollide(A,E,F,O,y,s){const i=O-A,r=y-E,l=F+s;return l*l>i*i+r*r}_circleAndRectCollide(A,E,F,O,y,s,i){const r=(s-O)/2,l=Math.abs(A-(O+r));if(l>r+F)return!1;const d=(i-y)/2,_=Math.abs(E-(y+d));if(_>d+F)return!1;if(l<=r||_<=d)return!0;const w=l-r,T=_-d;return w*w+T*T<=F*F}}function ve(Z,A,E,F,O){const y=a.Z();return A?(a.a0(y,y,[1/O,1/O,1]),E||a.ae(y,y,F.angle)):a.a1(y,F.labelPlaneMatrix,Z),y}function Ie(Z,A,E,F,O){if(A){const y=a.af(Z);return a.a0(y,y,[O,O,1]),E||a.ae(y,y,-F.angle),y}return F.glCoordMatrix}function Ee(Z,A,E){let F;E?(F=[Z.x,Z.y,E(Z.x,Z.y),1],a.ag(F,F,A)):(F=[Z.x,Z.y,0,1],ye(F,F,A));const O=F[3];return{point:new a.P(F[0]/O,F[1]/O),signedDistanceFromCamera:O}}function ze(Z,A){return .5+Z/A*.5}function Qe(Z,A){const E=Z[0]/Z[3],F=Z[1]/Z[3];return E>=-A[0]&&E<=A[0]&&F>=-A[1]&&F<=A[1]}function He(Z,A,E,F,O,y,s,i,r,l){const d=F?Z.textSizeData:Z.iconSizeData,_=a.ah(d,E.transform.zoom),w=[256/E.width*2+1,256/E.height*2+1],T=F?Z.text.dynamicLayoutVertexArray:Z.icon.dynamicLayoutVertexArray;T.clear();const B=Z.lineVertexArray,j=F?Z.text.placedSymbolArray:Z.icon.placedSymbolArray,X=E.transform.width/E.transform.height;let ue=!1;for(let Se=0;Se<j.length;Se++){const Te=j.get(Se);if(Te.hidden||Te.writingMode===a.ai.vertical&&!ue){de(Te.numGlyphs,T);continue}let Re;if(ue=!1,l?(Re=[Te.anchorX,Te.anchorY,l(Te.anchorX,Te.anchorY),1],a.ag(Re,Re,A)):(Re=[Te.anchorX,Te.anchorY,0,1],ye(Re,Re,A)),!Qe(Re,w)){de(Te.numGlyphs,T);continue}const Be=ze(E.transform.cameraToCenterDistance,Re[3]),et=a.aj(d,_,Te),vt=s?et/Be:et*Be,ot=new a.P(Te.anchorX,Te.anchorY),ht=Ee(ot,O,l).point,Et={projections:{},offsets:{}},wt=dt(Te,vt,!1,i,A,O,y,Z.glyphOffsetArray,B,T,ht,ot,Et,X,r,l);ue=wt.useVertical,(wt.notEnoughRoom||ue||wt.needsFlipping&&dt(Te,vt,!0,i,A,O,y,Z.glyphOffsetArray,B,T,ht,ot,Et,X,r,l).notEnoughRoom)&&de(Te.numGlyphs,T)}F?Z.text.dynamicLayoutVertexBuffer.updateData(T):Z.icon.dynamicLayoutVertexBuffer.updateData(T)}function Ze(Z,A,E,F,O,y,s,i,r,l,d,_,w){const T=i.glyphStartIndex+i.numGlyphs,B=i.lineStartIndex,j=i.lineStartIndex+i.lineLength,X=A.getoffsetX(i.glyphStartIndex),ue=A.getoffsetX(T-1),Se=$(Z*X,E,F,O,y,s,i.segment,B,j,r,l,d,_,w);if(!Se)return null;const Te=$(Z*ue,E,F,O,y,s,i.segment,B,j,r,l,d,_,w);return Te?{first:Se,last:Te}:null}function Ue(Z,A,E,F){return Z===a.ai.horizontal&&Math.abs(E.y-A.y)>Math.abs(E.x-A.x)*F?{useVertical:!0}:(Z===a.ai.vertical?A.y<E.y:A.x>E.x)?{needsFlipping:!0}:null}function dt(Z,A,E,F,O,y,s,i,r,l,d,_,w,T,B,j){const X=A/24,ue=Z.lineOffsetX*X,Se=Z.lineOffsetY*X;let Te;if(Z.numGlyphs>1){const Re=Z.glyphStartIndex+Z.numGlyphs,Be=Z.lineStartIndex,et=Z.lineStartIndex+Z.lineLength,vt=Ze(X,i,ue,Se,E,d,_,Z,r,y,w,B,j);if(!vt)return{notEnoughRoom:!0};const ot=Ee(vt.first.point,s,j).point,ht=Ee(vt.last.point,s,j).point;if(F&&!E){const Et=Ue(Z.writingMode,ot,ht,T);if(Et)return Et}Te=[vt.first];for(let Et=Z.glyphStartIndex+1;Et<Re-1;Et++)Te.push($(X*i.getoffsetX(Et),ue,Se,E,d,_,Z.segment,Be,et,r,y,w,B,j));Te.push(vt.last)}else{if(F&&!E){const Be=Ee(_,O,j).point,et=Z.lineStartIndex+Z.segment+1,vt=new a.P(r.getx(et),r.gety(et)),ot=Ee(vt,O,j),ht=ot.signedDistanceFromCamera>0?ot.point:rt(_,vt,Be,1,O,j),Et=Ue(Z.writingMode,Be,ht,T);if(Et)return Et}const Re=$(X*i.getoffsetX(Z.glyphStartIndex),ue,Se,E,d,_,Z.segment,Z.lineStartIndex,Z.lineStartIndex+Z.lineLength,r,y,w,B,j);if(!Re)return{notEnoughRoom:!0};Te=[Re]}for(const Re of Te)a.ak(l,Re.point,Re.angle);return{}}function rt(Z,A,E,F,O,y){const s=Ee(Z.add(Z.sub(A)._unit()),O,y).point,i=E.sub(s);return E.add(i._mult(F/i.mag()))}function Me(Z,A){const{projectionCache:E,lineVertexArray:F,labelPlaneMatrix:O,tileAnchorPoint:y,distanceFromAnchor:s,getElevation:i,previousVertex:r,direction:l,absOffsetX:d}=A;if(E.projections[Z])return E.projections[Z];const _=new a.P(F.getx(Z),F.gety(Z)),w=Ee(_,O,i);if(w.signedDistanceFromCamera>0)return E.projections[Z]=w.point,w.point;const T=Z-l;return rt(s===0?y:new a.P(F.getx(T),F.gety(T)),_,r,d-s+1,O,i)}function se(Z,A,E){return Z._unit()._perp()._mult(A*E)}function ne(Z,A,E,F,O,y,s,i){const{projectionCache:r,direction:l}=i;if(r.offsets[Z])return r.offsets[Z];const d=E.add(A);if(Z+l<F||Z+l>=O)return r.offsets[Z]=d,d;const _=Me(Z+l,i),w=se(_.sub(E),s,l),T=E.add(w),B=_.add(w);return r.offsets[Z]=a.al(y,d,T,B)||d,r.offsets[Z]}function $(Z,A,E,F,O,y,s,i,r,l,d,_,w,T){const B=F?Z-A:Z+A;let j=B>0?1:-1,X=0;F&&(j*=-1,X=Math.PI),j<0&&(X+=Math.PI);let ue,Se,Te=j>0?i+s:i+s+1,Re=O,Be=O,et=0,vt=0;const ot=Math.abs(B),ht=[];let Et;for(;et+vt<=ot;){if(Te+=j,Te<i||Te>=r)return null;et+=vt,Be=Re,Se=ue;const Kt={projectionCache:_,lineVertexArray:l,labelPlaneMatrix:d,tileAnchorPoint:y,distanceFromAnchor:et,getElevation:T,previousVertex:Be,direction:j,absOffsetX:ot};if(Re=Me(Te,Kt),E===0)ht.push(Be),Et=Re.sub(Be);else{let ii;const ai=Re.sub(Be);ii=ai.mag()===0?se(Me(Te+j,Kt).sub(Re),E,j):se(ai,E,j),Se||(Se=Be.add(ii)),ue=ne(Te,ii,Re,i,r,Se,E,Kt),ht.push(Se),Et=ue.sub(Se)}vt=Et.mag()}const wt=Et._mult((ot-et)/vt)._add(Se||Be),si=X+Math.atan2(Re.y-Be.y,Re.x-Be.x);return ht.push(wt),{point:wt,angle:w?si:0,path:ht}}const ie=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function de(Z,A){for(let E=0;E<Z;E++){const F=A.length;A.resize(F+4),A.float32.set(ie,3*F)}}function ye(Z,A,E){const F=A[0],O=A[1];return Z[0]=E[0]*F+E[4]*O+E[12],Z[1]=E[1]*F+E[5]*O+E[13],Z[3]=E[3]*F+E[7]*O+E[15],Z}const ge=100;class Pe{constructor(A,E=new fe(A.width+200,A.height+200,25),F=new fe(A.width+200,A.height+200,25)){this.transform=A,this.grid=E,this.ignoredGrid=F,this.pitchfactor=Math.cos(A._pitch)*A.cameraToCenterDistance,this.screenRightBoundary=A.width+ge,this.screenBottomBoundary=A.height+ge,this.gridRightBoundary=A.width+200,this.gridBottomBoundary=A.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(A,E,F,O,y,s){const i=this.projectAndGetPerspectiveRatio(O,A.anchorPointX,A.anchorPointY,s),r=F*i.perspectiveRatio,l=A.x1*r+i.point.x,d=A.y1*r+i.point.y,_=A.x2*r+i.point.x,w=A.y2*r+i.point.y;return!this.isInsideGrid(l,d,_,w)||E!=="always"&&this.grid.hitTest(l,d,_,w,E,y)||i.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[l,d,_,w],offscreen:this.isOffscreen(l,d,_,w)}}placeCollisionCircles(A,E,F,O,y,s,i,r,l,d,_,w,T,B){const j=[],X=new a.P(E.anchorX,E.anchorY),ue=Ee(X,s,B),Se=ze(this.transform.cameraToCenterDistance,ue.signedDistanceFromCamera),Te=(d?y/Se:y*Se)/a.ap,Re=Ee(X,i,B).point,Be=Ze(Te,O,E.lineOffsetX*Te,E.lineOffsetY*Te,!1,Re,X,E,F,i,{projections:{},offsets:{}},!1,B);let et=!1,vt=!1,ot=!0;if(Be){const ht=.5*w*Se+T,Et=new a.P(-100,-100),wt=new a.P(this.screenRightBoundary,this.screenBottomBoundary),si=new Y,Kt=Be.first,ii=Be.last;let ai=[];for(let Si=Kt.path.length-1;Si>=1;Si--)ai.push(Kt.path[Si]);for(let Si=1;Si<ii.path.length;Si++)ai.push(ii.path[Si]);const Zi=2.5*ht;if(r){const Si=ai.map(Ui=>Ee(Ui,r,B));ai=Si.some(Ui=>Ui.signedDistanceFromCamera<=0)?[]:Si.map(Ui=>Ui.point)}let Qi=[];if(ai.length>0){const Si=ai[0].clone(),Ui=ai[0].clone();for(let Gi=1;Gi<ai.length;Gi++)Si.x=Math.min(Si.x,ai[Gi].x),Si.y=Math.min(Si.y,ai[Gi].y),Ui.x=Math.max(Ui.x,ai[Gi].x),Ui.y=Math.max(Ui.y,ai[Gi].y);Qi=Si.x>=Et.x&&Ui.x<=wt.x&&Si.y>=Et.y&&Ui.y<=wt.y?[ai]:Ui.x<Et.x||Si.x>wt.x||Ui.y<Et.y||Si.y>wt.y?[]:a.am([ai],Et.x,Et.y,wt.x,wt.y)}for(const Si of Qi){si.reset(Si,.25*ht);let Ui=0;Ui=si.length<=.5*ht?1:Math.ceil(si.paddedLength/Zi)+1;for(let Gi=0;Gi<Ui;Gi++){const un=Gi/Math.max(Ui-1,1),Bn=si.lerp(un),en=Bn.x+ge,kn=Bn.y+ge;j.push(en,kn,ht,0);const vr=en-ht,er=kn-ht,Ca=en+ht,fa=kn+ht;if(ot=ot&&this.isOffscreen(vr,er,Ca,fa),vt=vt||this.isInsideGrid(vr,er,Ca,fa),A!=="always"&&this.grid.hitTestCircle(en,kn,ht,A,_)&&(et=!0,!l))return{circles:[],offscreen:!1,collisionDetected:et}}}}return{circles:!l&&et||!vt||Se<this.perspectiveRatioCutoff?[]:j,offscreen:ot,collisionDetected:et}}queryRenderedSymbols(A){if(A.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const E=[];let F=1/0,O=1/0,y=-1/0,s=-1/0;for(const d of A){const _=new a.P(d.x+ge,d.y+ge);F=Math.min(F,_.x),O=Math.min(O,_.y),y=Math.max(y,_.x),s=Math.max(s,_.y),E.push(_)}const i=this.grid.query(F,O,y,s).concat(this.ignoredGrid.query(F,O,y,s)),r={},l={};for(const d of i){const _=d.key;if(r[_.bucketInstanceId]===void 0&&(r[_.bucketInstanceId]={}),r[_.bucketInstanceId][_.featureIndex])continue;const w=[new a.P(d.x1,d.y1),new a.P(d.x2,d.y1),new a.P(d.x2,d.y2),new a.P(d.x1,d.y2)];a.an(E,w)&&(r[_.bucketInstanceId][_.featureIndex]=!0,l[_.bucketInstanceId]===void 0&&(l[_.bucketInstanceId]=[]),l[_.bucketInstanceId].push(_.featureIndex))}return l}insertCollisionBox(A,E,F,O,y,s){(F?this.ignoredGrid:this.grid).insert({bucketInstanceId:O,featureIndex:y,collisionGroupID:s,overlapMode:E},A[0],A[1],A[2],A[3])}insertCollisionCircles(A,E,F,O,y,s){const i=F?this.ignoredGrid:this.grid,r={bucketInstanceId:O,featureIndex:y,collisionGroupID:s,overlapMode:E};for(let l=0;l<A.length;l+=4)i.insertCircle(r,A[l],A[l+1],A[l+2])}projectAndGetPerspectiveRatio(A,E,F,O){let y;return O?(y=[E,F,O(E,F),1],a.ag(y,y,A)):(y=[E,F,0,1],ye(y,y,A)),{point:new a.P((y[0]/y[3]+1)/2*this.transform.width+ge,(-y[1]/y[3]+1)/2*this.transform.height+ge),perspectiveRatio:.5+this.transform.cameraToCenterDistance/y[3]*.5}}isOffscreen(A,E,F,O){return F<ge||A>=this.screenRightBoundary||O<ge||E>this.screenBottomBoundary}isInsideGrid(A,E,F,O){return F>=0&&A<this.gridRightBoundary&&O>=0&&E<this.gridBottomBoundary}getViewportMatrix(){const A=a.ao([]);return a.$(A,A,[-100,-100,0]),A}}function Fe(Z,A,E){return A*(a.N/(Z.tileSize*Math.pow(2,E-Z.tileID.overscaledZ)))}class Ve{constructor(A,E,F,O){this.opacity=A?Math.max(0,Math.min(1,A.opacity+(A.placed?E:-E))):O&&F?1:0,this.placed=F}isHidden(){return this.opacity===0&&!this.placed}}class Xe{constructor(A,E,F,O,y){this.text=new Ve(A?A.text:null,E,F,y),this.icon=new Ve(A?A.icon:null,E,O,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ke{constructor(A,E,F){this.text=A,this.icon=E,this.skipFade=F}}class De{constructor(){this.invProjMatrix=a.Z(),this.viewportMatrix=a.Z(),this.circles=[]}}class Ge{constructor(A,E,F,O,y){this.bucketInstanceId=A,this.featureIndex=E,this.sourceLayerIndex=F,this.bucketIndex=O,this.tileID=y}}class At{constructor(A){this.crossSourceCollisions=A,this.maxGroupID=0,this.collisionGroups={}}get(A){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[A]){const E=++this.maxGroupID;this.collisionGroups[A]={ID:E,predicate:F=>F.collisionGroupID===E}}return this.collisionGroups[A]}}function kt(Z,A,E,F,O){const{horizontalAlign:y,verticalAlign:s}=a.au(Z);return new a.P(-(y-.5)*A+F[0]*O,-(s-.5)*E+F[1]*O)}function o(Z,A,E,F,O,y){const{x1:s,x2:i,y1:r,y2:l,anchorPointX:d,anchorPointY:_}=Z,w=new a.P(A,E);return F&&w._rotate(O?y:-y),{x1:s+w.x,y1:r+w.y,x2:i+w.x,y2:l+w.y,anchorPointX:d,anchorPointY:_}}class ke{constructor(A,E,F,O,y){this.transform=A.clone(),this.terrain=E,this.collisionIndex=new Pe(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=F,this.retainedQueryData={},this.collisionGroups=new At(O),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(A,E,F,O){const y=F.getBucket(E),s=F.latestFeatureIndex;if(!y||!s||E.id!==y.layerIds[0])return;const i=F.collisionBoxArray,r=y.layers[0].layout,l=Math.pow(2,this.transform.zoom-F.tileID.overscaledZ),d=F.tileSize/a.N,_=this.transform.calculatePosMatrix(F.tileID.toUnwrapped()),w=r.get("text-pitch-alignment")==="map",T=r.get("text-rotation-alignment")==="map",B=Fe(F,1,this.transform.zoom),j=ve(_,w,T,this.transform,B);let X=null;if(w){const Se=Ie(_,w,T,this.transform,B);X=a.a1([],this.transform.labelPlaneMatrix,Se)}this.retainedQueryData[y.bucketInstanceId]=new Ge(y.bucketInstanceId,s,y.sourceLayerIndex,y.index,F.tileID);const ue={bucket:y,layout:r,posMatrix:_,textLabelPlaneMatrix:j,labelToScreenMatrix:X,scale:l,textPixelRatio:d,holdingForFade:F.holdingForFade(),collisionBoxArray:i,partiallyEvaluatedTextSize:a.ah(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(O)for(const Se of y.sortKeyRanges){const{sortKey:Te,symbolInstanceStart:Re,symbolInstanceEnd:Be}=Se;A.push({sortKey:Te,symbolInstanceStart:Re,symbolInstanceEnd:Be,parameters:ue})}else A.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:ue})}attemptAnchorPlacement(A,E,F,O,y,s,i,r,l,d,_,w,T,B,j,X){const ue=a.aq[A.textAnchor],Se=[A.textOffset0,A.textOffset1],Te=kt(ue,F,O,Se,y),Re=this.collisionIndex.placeCollisionBox(o(E,Te.x,Te.y,s,i,this.transform.angle),_,r,l,d.predicate,X);if((!j||this.collisionIndex.placeCollisionBox(o(j,Te.x,Te.y,s,i,this.transform.angle),_,r,l,d.predicate,X).box.length!==0)&&Re.box.length>0){let Be;if(this.prevPlacement&&this.prevPlacement.variableOffsets[w.crossTileID]&&this.prevPlacement.placements[w.crossTileID]&&this.prevPlacement.placements[w.crossTileID].text&&(Be=this.prevPlacement.variableOffsets[w.crossTileID].anchor),w.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[w.crossTileID]={textOffset:Se,width:F,height:O,anchor:ue,textBoxScale:y,prevAnchor:Be},this.markUsedJustification(T,ue,w,B),T.allowVerticalPlacement&&(this.markUsedOrientation(T,B,w),this.placedOrientations[w.crossTileID]=B),{shift:Te,placedGlyphBoxes:Re}}}placeLayerBucketPart(A,E,F){const{bucket:O,layout:y,posMatrix:s,textLabelPlaneMatrix:i,labelToScreenMatrix:r,textPixelRatio:l,holdingForFade:d,collisionBoxArray:_,partiallyEvaluatedTextSize:w,collisionGroup:T}=A.parameters,B=y.get("text-optional"),j=y.get("icon-optional"),X=a.ar(y,"text-overlap","text-allow-overlap"),ue=X==="always",Se=a.ar(y,"icon-overlap","icon-allow-overlap"),Te=Se==="always",Re=y.get("text-rotation-alignment")==="map",Be=y.get("text-pitch-alignment")==="map",et=y.get("icon-text-fit")!=="none",vt=y.get("symbol-z-order")==="viewport-y",ot=ue&&(Te||!O.hasIconData()||j),ht=Te&&(ue||!O.hasTextData()||B);!O.collisionArrays&&_&&O.deserializeCollisionBoxes(_);const Et=this.retainedQueryData[O.bucketInstanceId].tileID,wt=this.terrain?(Kt,ii)=>this.terrain.getElevation(Et,Kt,ii):null,si=(Kt,ii)=>{var ai,Zi;if(E[Kt.crossTileID])return;if(d)return void(this.placements[Kt.crossTileID]=new Ke(!1,!1,!1));let Qi=!1,Si=!1,Ui=!0,Gi=null,un={box:null,offscreen:null},Bn={box:null,offscreen:null},en=null,kn=null,vr=null,er=0,Ca=0,fa=0;ii.textFeatureIndex?er=ii.textFeatureIndex:Kt.useRuntimeCollisionCircles&&(er=Kt.featureIndex),ii.verticalTextFeatureIndex&&(Ca=ii.verticalTextFeatureIndex);const zs=ii.textBox;if(zs){const qr=Qs=>{let rs=a.ai.horizontal;if(O.allowVerticalPlacement&&!Qs&&this.prevPlacement){const ss=this.prevPlacement.placedOrientations[Kt.crossTileID];ss&&(this.placedOrientations[Kt.crossTileID]=ss,rs=ss,this.markUsedOrientation(O,rs,Kt))}return rs},ya=(Qs,rs)=>{if(O.allowVerticalPlacement&&Kt.numVerticalGlyphVertices>0&&ii.verticalTextBox){for(const ss of O.writingModes)if(ss===a.ai.vertical?(un=rs(),Bn=un):un=Qs(),un&&un.box&&un.box.length)break}else un=Qs()},xo=Kt.textAnchorOffsetStartIndex,bo=Kt.textAnchorOffsetEndIndex;if(bo===xo){const Qs=(rs,ss)=>{const Rr=this.collisionIndex.placeCollisionBox(rs,X,l,s,T.predicate,wt);return Rr&&Rr.box&&Rr.box.length&&(this.markUsedOrientation(O,ss,Kt),this.placedOrientations[Kt.crossTileID]=ss),Rr};ya(()=>Qs(zs,a.ai.horizontal),()=>{const rs=ii.verticalTextBox;return O.allowVerticalPlacement&&Kt.numVerticalGlyphVertices>0&&rs?Qs(rs,a.ai.vertical):{box:null,offscreen:null}}),qr(un&&un.box&&un.box.length)}else{let Qs=a.aq[(Zi=(ai=this.prevPlacement)===null||ai===void 0?void 0:ai.variableOffsets[Kt.crossTileID])===null||Zi===void 0?void 0:Zi.anchor];const rs=(Rr,Ss,Ws)=>{const Bo=Rr.x2-Rr.x1,Uo=Rr.y2-Rr.y1,Go=Kt.textBoxScale,Ec=et&&Se==="never"?Ss:null;let $s={box:[],offscreen:!1},Yl=X==="never"?1:2,hu="never";Qs&&Yl++;for(let il=0;il<Yl;il++){for(let vl=xo;vl<bo;vl++){const Pl=O.textAnchorOffsets.get(vl);if(Qs&&Pl.textAnchor!==Qs)continue;const Au=this.attemptAnchorPlacement(Pl,Rr,Bo,Uo,Go,Re,Be,l,s,T,hu,Kt,O,Ws,Ec,wt);if(Au&&($s=Au.placedGlyphBoxes,$s&&$s.box&&$s.box.length))return Qi=!0,Gi=Au.shift,$s}Qs?Qs=null:hu=X}return $s};ya(()=>rs(zs,ii.iconBox,a.ai.horizontal),()=>{const Rr=ii.verticalTextBox;return O.allowVerticalPlacement&&!(un&&un.box&&un.box.length)&&Kt.numVerticalGlyphVertices>0&&Rr?rs(Rr,ii.verticalIconBox,a.ai.vertical):{box:null,offscreen:null}}),un&&(Qi=un.box,Ui=un.offscreen);const ss=qr(un&&un.box);if(!Qi&&this.prevPlacement){const Rr=this.prevPlacement.variableOffsets[Kt.crossTileID];Rr&&(this.variableOffsets[Kt.crossTileID]=Rr,this.markUsedJustification(O,Rr.anchor,Kt,ss))}}}if(en=un,Qi=en&&en.box&&en.box.length>0,Ui=en&&en.offscreen,Kt.useRuntimeCollisionCircles){const qr=O.text.placedSymbolArray.get(Kt.centerJustifiedTextSymbolIndex),ya=a.aj(O.textSizeData,w,qr),xo=y.get("text-padding");kn=this.collisionIndex.placeCollisionCircles(X,qr,O.lineVertexArray,O.glyphOffsetArray,ya,s,i,r,F,Be,T.predicate,Kt.collisionCircleDiameter,xo,wt),kn.circles.length&&kn.collisionDetected&&!F&&a.w("Collisions detected, but collision boxes are not shown"),Qi=ue||kn.circles.length>0&&!kn.collisionDetected,Ui=Ui&&kn.offscreen}if(ii.iconFeatureIndex&&(fa=ii.iconFeatureIndex),ii.iconBox){const qr=ya=>{const xo=et&&Gi?o(ya,Gi.x,Gi.y,Re,Be,this.transform.angle):ya;return this.collisionIndex.placeCollisionBox(xo,Se,l,s,T.predicate,wt)};Bn&&Bn.box&&Bn.box.length&&ii.verticalIconBox?(vr=qr(ii.verticalIconBox),Si=vr.box.length>0):(vr=qr(ii.iconBox),Si=vr.box.length>0),Ui=Ui&&vr.offscreen}const oo=B||Kt.numHorizontalGlyphVertices===0&&Kt.numVerticalGlyphVertices===0,lo=j||Kt.numIconVertices===0;if(oo||lo?lo?oo||(Si=Si&&Qi):Qi=Si&&Qi:Si=Qi=Si&&Qi,Qi&&en&&en.box&&this.collisionIndex.insertCollisionBox(en.box,X,y.get("text-ignore-placement"),O.bucketInstanceId,Bn&&Bn.box&&Ca?Ca:er,T.ID),Si&&vr&&this.collisionIndex.insertCollisionBox(vr.box,Se,y.get("icon-ignore-placement"),O.bucketInstanceId,fa,T.ID),kn&&(Qi&&this.collisionIndex.insertCollisionCircles(kn.circles,X,y.get("text-ignore-placement"),O.bucketInstanceId,er,T.ID),F)){const qr=O.bucketInstanceId;let ya=this.collisionCircleArrays[qr];ya===void 0&&(ya=this.collisionCircleArrays[qr]=new De);for(let xo=0;xo<kn.circles.length;xo+=4)ya.circles.push(kn.circles[xo+0]),ya.circles.push(kn.circles[xo+1]),ya.circles.push(kn.circles[xo+2]),ya.circles.push(kn.collisionDetected?1:0)}if(Kt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(O.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Kt.crossTileID]=new Ke(Qi||ot,Si||ht,Ui||O.justReloaded),E[Kt.crossTileID]=!0};if(vt){if(A.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Kt=O.getSortedSymbolIndexes(this.transform.angle);for(let ii=Kt.length-1;ii>=0;--ii){const ai=Kt[ii];si(O.symbolInstances.get(ai),O.collisionArrays[ai])}}else for(let Kt=A.symbolInstanceStart;Kt<A.symbolInstanceEnd;Kt++)si(O.symbolInstances.get(Kt),O.collisionArrays[Kt]);if(F&&O.bucketInstanceId in this.collisionCircleArrays){const Kt=this.collisionCircleArrays[O.bucketInstanceId];a.as(Kt.invProjMatrix,s),Kt.viewportMatrix=this.collisionIndex.getViewportMatrix()}O.justReloaded=!1}markUsedJustification(A,E,F,O){let y;y=O===a.ai.vertical?F.verticalPlacedTextSymbolIndex:{left:F.leftJustifiedTextSymbolIndex,center:F.centerJustifiedTextSymbolIndex,right:F.rightJustifiedTextSymbolIndex}[a.at(E)];const s=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex,F.verticalPlacedTextSymbolIndex];for(const i of s)i>=0&&(A.text.placedSymbolArray.get(i).crossTileID=y>=0&&i!==y?0:F.crossTileID)}markUsedOrientation(A,E,F){const O=E===a.ai.horizontal||E===a.ai.horizontalOnly?E:0,y=E===a.ai.vertical?E:0,s=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex];for(const i of s)A.text.placedSymbolArray.get(i).placedOrientation=O;F.verticalPlacedTextSymbolIndex&&(A.text.placedSymbolArray.get(F.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(A){this.commitTime=A,this.zoomAtLastRecencyCheck=this.transform.zoom;const E=this.prevPlacement;let F=!1;this.prevZoomAdjustment=E?E.zoomAdjustment(this.transform.zoom):0;const O=E?E.symbolFadeChange(A):1,y=E?E.opacities:{},s=E?E.variableOffsets:{},i=E?E.placedOrientations:{};for(const r in this.placements){const l=this.placements[r],d=y[r];d?(this.opacities[r]=new Xe(d,O,l.text,l.icon),F=F||l.text!==d.text.placed||l.icon!==d.icon.placed):(this.opacities[r]=new Xe(null,O,l.text,l.icon,l.skipFade),F=F||l.text||l.icon)}for(const r in y){const l=y[r];if(!this.opacities[r]){const d=new Xe(l,O,!1,!1);d.isHidden()||(this.opacities[r]=d,F=F||l.text.placed||l.icon.placed)}}for(const r in s)this.variableOffsets[r]||!this.opacities[r]||this.opacities[r].isHidden()||(this.variableOffsets[r]=s[r]);for(const r in i)this.placedOrientations[r]||!this.opacities[r]||this.opacities[r].isHidden()||(this.placedOrientations[r]=i[r]);if(E&&E.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");F?this.lastPlacementChangeTime=A:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=E?E.lastPlacementChangeTime:A)}updateLayerOpacities(A,E){const F={};for(const O of E){const y=O.getBucket(A);y&&O.latestFeatureIndex&&A.id===y.layerIds[0]&&this.updateBucketOpacities(y,F,O.collisionBoxArray)}}updateBucketOpacities(A,E,F){A.hasTextData()&&(A.text.opacityVertexArray.clear(),A.text.hasVisibleVertices=!1),A.hasIconData()&&(A.icon.opacityVertexArray.clear(),A.icon.hasVisibleVertices=!1),A.hasIconCollisionBoxData()&&A.iconCollisionBox.collisionVertexArray.clear(),A.hasTextCollisionBoxData()&&A.textCollisionBox.collisionVertexArray.clear();const O=A.layers[0],y=O.layout,s=new Xe(null,0,!1,!1,!0),i=y.get("text-allow-overlap"),r=y.get("icon-allow-overlap"),l=O._unevaluatedLayout.hasValue("text-variable-anchor")||O._unevaluatedLayout.hasValue("text-variable-anchor-offset"),d=y.get("text-rotation-alignment")==="map",_=y.get("text-pitch-alignment")==="map",w=y.get("icon-text-fit")!=="none",T=new Xe(null,0,i&&(r||!A.hasIconData()||y.get("icon-optional")),r&&(i||!A.hasTextData()||y.get("text-optional")),!0);!A.collisionArrays&&F&&(A.hasIconCollisionBoxData()||A.hasTextCollisionBoxData())&&A.deserializeCollisionBoxes(F);const B=(j,X,ue)=>{for(let Se=0;Se<X/4;Se++)j.opacityVertexArray.emplaceBack(ue);j.hasVisibleVertices=j.hasVisibleVertices||ue!==wn};for(let j=0;j<A.symbolInstances.length;j++){const X=A.symbolInstances.get(j),{numHorizontalGlyphVertices:ue,numVerticalGlyphVertices:Se,crossTileID:Te}=X;let Re=this.opacities[Te];E[Te]?Re=s:Re||(Re=T,this.opacities[Te]=Re),E[Te]=!0;const Be=X.numIconVertices>0,et=this.placedOrientations[X.crossTileID],vt=et===a.ai.vertical,ot=et===a.ai.horizontal||et===a.ai.horizontalOnly;if(ue>0||Se>0){const ht=Jt(Re.text);B(A.text,ue,vt?wn:ht),B(A.text,Se,ot?wn:ht);const Et=Re.text.isHidden();[X.rightJustifiedTextSymbolIndex,X.centerJustifiedTextSymbolIndex,X.leftJustifiedTextSymbolIndex].forEach(Kt=>{Kt>=0&&(A.text.placedSymbolArray.get(Kt).hidden=Et||vt?1:0)}),X.verticalPlacedTextSymbolIndex>=0&&(A.text.placedSymbolArray.get(X.verticalPlacedTextSymbolIndex).hidden=Et||ot?1:0);const wt=this.variableOffsets[X.crossTileID];wt&&this.markUsedJustification(A,wt.anchor,X,et);const si=this.placedOrientations[X.crossTileID];si&&(this.markUsedJustification(A,"left",X,si),this.markUsedOrientation(A,si,X))}if(Be){const ht=Jt(Re.icon),Et=!(w&&X.verticalPlacedIconSymbolIndex&&vt);X.placedIconSymbolIndex>=0&&(B(A.icon,X.numIconVertices,Et?ht:wn),A.icon.placedSymbolArray.get(X.placedIconSymbolIndex).hidden=Re.icon.isHidden()),X.verticalPlacedIconSymbolIndex>=0&&(B(A.icon,X.numVerticalIconVertices,Et?wn:ht),A.icon.placedSymbolArray.get(X.verticalPlacedIconSymbolIndex).hidden=Re.icon.isHidden())}if(A.hasIconCollisionBoxData()||A.hasTextCollisionBoxData()){const ht=A.collisionArrays[j];if(ht){let Et=new a.P(0,0);if(ht.textBox||ht.verticalTextBox){let si=!0;if(l){const Kt=this.variableOffsets[Te];Kt?(Et=kt(Kt.anchor,Kt.width,Kt.height,Kt.textOffset,Kt.textBoxScale),d&&Et._rotate(_?this.transform.angle:-this.transform.angle)):si=!1}ht.textBox&&oi(A.textCollisionBox.collisionVertexArray,Re.text.placed,!si||vt,Et.x,Et.y),ht.verticalTextBox&&oi(A.textCollisionBox.collisionVertexArray,Re.text.placed,!si||ot,Et.x,Et.y)}const wt=!!(!ot&&ht.verticalIconBox);ht.iconBox&&oi(A.iconCollisionBox.collisionVertexArray,Re.icon.placed,wt,w?Et.x:0,w?Et.y:0),ht.verticalIconBox&&oi(A.iconCollisionBox.collisionVertexArray,Re.icon.placed,!wt,w?Et.x:0,w?Et.y:0)}}}if(A.sortFeatures(this.transform.angle),this.retainedQueryData[A.bucketInstanceId]&&(this.retainedQueryData[A.bucketInstanceId].featureSortOrder=A.featureSortOrder),A.hasTextData()&&A.text.opacityVertexBuffer&&A.text.opacityVertexBuffer.updateData(A.text.opacityVertexArray),A.hasIconData()&&A.icon.opacityVertexBuffer&&A.icon.opacityVertexBuffer.updateData(A.icon.opacityVertexArray),A.hasIconCollisionBoxData()&&A.iconCollisionBox.collisionVertexBuffer&&A.iconCollisionBox.collisionVertexBuffer.updateData(A.iconCollisionBox.collisionVertexArray),A.hasTextCollisionBoxData()&&A.textCollisionBox.collisionVertexBuffer&&A.textCollisionBox.collisionVertexBuffer.updateData(A.textCollisionBox.collisionVertexArray),A.text.opacityVertexArray.length!==A.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${A.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${A.text.layoutVertexArray.length}) / 4`);if(A.icon.opacityVertexArray.length!==A.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${A.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${A.icon.layoutVertexArray.length}) / 4`);if(A.bucketInstanceId in this.collisionCircleArrays){const j=this.collisionCircleArrays[A.bucketInstanceId];A.placementInvProjMatrix=j.invProjMatrix,A.placementViewportMatrix=j.viewportMatrix,A.collisionCircleArray=j.circles,delete this.collisionCircleArrays[A.bucketInstanceId]}}symbolFadeChange(A){return this.fadeDuration===0?1:(A-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(A){return Math.max(0,(this.transform.zoom-A)/1.5)}hasTransitions(A){return this.stale||A-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(A,E){const F=this.zoomAtLastRecencyCheck===E?1-this.zoomAdjustment(E):1;return this.zoomAtLastRecencyCheck=E,this.commitTime+this.fadeDuration*F>A}setStale(){this.stale=!0}}function oi(Z,A,E,F,O){Z.emplaceBack(A?1:0,E?1:0,F||0,O||0),Z.emplaceBack(A?1:0,E?1:0,F||0,O||0),Z.emplaceBack(A?1:0,E?1:0,F||0,O||0),Z.emplaceBack(A?1:0,E?1:0,F||0,O||0)}const fi=Math.pow(2,25),Ai=Math.pow(2,24),ti=Math.pow(2,17),li=Math.pow(2,16),Bi=Math.pow(2,9),vi=Math.pow(2,8),bi=Math.pow(2,1);function Jt(Z){if(Z.opacity===0&&!Z.placed)return 0;if(Z.opacity===1&&Z.placed)return 4294967295;const A=Z.placed?1:0,E=Math.floor(127*Z.opacity);return E*fi+A*Ai+E*ti+A*li+E*Bi+A*vi+E*bi+A}const wn=0;class ar{constructor(A){this._sortAcrossTiles=A.layout.get("symbol-z-order")!=="viewport-y"&&!A.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(A,E,F,O,y){const s=this._bucketParts;for(;this._currentTileIndex<A.length;)if(E.getBucketParts(s,O,A[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,s.sort((i,r)=>i.sortKey-r.sortKey));this._currentPartIndex<s.length;)if(E.placeLayerBucketPart(s[this._currentPartIndex],this._seenCrossTileIDs,F),this._currentPartIndex++,y())return!0;return!1}}class mn{constructor(A,E,F,O,y,s,i,r){this.placement=new ke(A,E,s,i,r),this._currentPlacementIndex=F.length-1,this._forceFullPlacement=O,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(A,E,F){const O=a.h.now(),y=()=>!this._forceFullPlacement&&a.h.now()-O>2;for(;this._currentPlacementIndex>=0;){const s=E[A[this._currentPlacementIndex]],i=this.placement.collisionIndex.transform.zoom;if(s.type==="symbol"&&(!s.minzoom||s.minzoom<=i)&&(!s.maxzoom||s.maxzoom>i)){if(this._inProgressLayer||(this._inProgressLayer=new ar(s)),this._inProgressLayer.continuePlacement(F[s.source],this.placement,this._showCollisionBoxes,s,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(A){return this.placement.commit(A),this.placement}}const Hn=512/a.N/2;class jr{constructor(A,E,F){this.tileID=A,this.bucketInstanceId=F,this._symbolsByKey={};const O=new Map;for(let y=0;y<E.length;y++){const s=E.get(y),i=s.key,r=O.get(i);r?r.push(s):O.set(i,[s])}for(const[y,s]of O){const i={positions:s.map(r=>({x:Math.floor(r.anchorX*Hn),y:Math.floor(r.anchorY*Hn)})),crossTileIDs:s.map(r=>r.crossTileID)};if(i.positions.length>128){const r=new a.av(i.positions.length,16,Uint16Array);for(const{x:l,y:d}of i.positions)r.add(l,d);r.finish(),delete i.positions,i.index=r}this._symbolsByKey[y]=i}}getScaledCoordinates(A,E){const{x:F,y:O,z:y}=this.tileID.canonical,{x:s,y:i,z:r}=E.canonical,l=Hn/Math.pow(2,r-y),d=(i*a.N+A.anchorY)*l,_=O*a.N*Hn;return{x:Math.floor((s*a.N+A.anchorX)*l-F*a.N*Hn),y:Math.floor(d-_)}}findMatches(A,E,F){const O=this.tileID.canonical.z<E.canonical.z?1:Math.pow(2,this.tileID.canonical.z-E.canonical.z);for(let y=0;y<A.length;y++){const s=A.get(y);if(s.crossTileID)continue;const i=this._symbolsByKey[s.key];if(!i)continue;const r=this.getScaledCoordinates(s,E);if(i.index){const l=i.index.range(r.x-O,r.y-O,r.x+O,r.y+O).sort();for(const d of l){const _=i.crossTileIDs[d];if(!F[_]){F[_]=!0,s.crossTileID=_;break}}}else if(i.positions)for(let l=0;l<i.positions.length;l++){const d=i.positions[l],_=i.crossTileIDs[l];if(Math.abs(d.x-r.x)<=O&&Math.abs(d.y-r.y)<=O&&!F[_]){F[_]=!0,s.crossTileID=_;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:A})=>A)}}class ji{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ur{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(A){const E=Math.round((A-this.lng)/360);if(E!==0)for(const F in this.indexes){const O=this.indexes[F],y={};for(const s in O){const i=O[s];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+E),y[i.tileID.key]=i}this.indexes[F]=y}this.lng=A}addBucket(A,E,F){if(this.indexes[A.overscaledZ]&&this.indexes[A.overscaledZ][A.key]){if(this.indexes[A.overscaledZ][A.key].bucketInstanceId===E.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(A.overscaledZ,this.indexes[A.overscaledZ][A.key])}for(let y=0;y<E.symbolInstances.length;y++)E.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[A.overscaledZ]||(this.usedCrossTileIDs[A.overscaledZ]={});const O=this.usedCrossTileIDs[A.overscaledZ];for(const y in this.indexes){const s=this.indexes[y];if(Number(y)>A.overscaledZ)for(const i in s){const r=s[i];r.tileID.isChildOf(A)&&r.findMatches(E.symbolInstances,A,O)}else{const i=s[A.scaledTo(Number(y)).key];i&&i.findMatches(E.symbolInstances,A,O)}}for(let y=0;y<E.symbolInstances.length;y++){const s=E.symbolInstances.get(y);s.crossTileID||(s.crossTileID=F.generate(),O[s.crossTileID]=!0)}return this.indexes[A.overscaledZ]===void 0&&(this.indexes[A.overscaledZ]={}),this.indexes[A.overscaledZ][A.key]=new jr(A,E.symbolInstances,E.bucketInstanceId),!0}removeBucketCrossTileIDs(A,E){for(const F of E.getCrossTileIDsLists())for(const O of F)delete this.usedCrossTileIDs[A][O]}removeStaleBuckets(A){let E=!1;for(const F in this.indexes){const O=this.indexes[F];for(const y in O)A[O[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(F,O[y]),delete O[y],E=!0)}return E}}class Vn{constructor(){this.layerIndexes={},this.crossTileIDs=new ji,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(A,E,F){let O=this.layerIndexes[A.id];O===void 0&&(O=this.layerIndexes[A.id]=new ur);let y=!1;const s={};O.handleWrapJump(F);for(const i of E){const r=i.getBucket(A);r&&A.id===r.layerIds[0]&&(r.bucketInstanceId||(r.bucketInstanceId=++this.maxBucketInstanceId),O.addBucket(i.tileID,r,this.crossTileIDs)&&(y=!0),s[r.bucketInstanceId]=!0)}return O.removeStaleBuckets(s)&&(y=!0),y}pruneUnusedLayers(A){const E={};A.forEach(F=>{E[F]=!0});for(const F in this.layerIndexes)E[F]||delete this.layerIndexes[F]}}const Wt=(Z,A)=>a.x(Z,A&&A.filter(E=>E.identifier!=="source.canvas")),Yi=a.F(a.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Ut=a.F(a.ax,["setCenter","setZoom","setBearing","setPitch"]),Tn=a.aw();class cr extends a.E{constructor(A,E={}){super(),this.map=A,this.dispatcher=new Ii(V(),this,A._getMapId()),this.imageManager=new bt,this.imageManager.setEventedParent(this),this.glyphManager=new ut(A._requestManager,E.localIdeographFontFamily),this.lineAtlas=new gi(256,512),this.crossTileSymbolIndex=new Vn,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.az());const F=this;this._rtlTextPluginCallback=cr.registerForPluginStateChange(O=>{F.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:O.pluginStatus,pluginURL:O.pluginURL},(y,s)=>{if(a.aA(y),s&&s.every(i=>i))for(const i in F.sourceCaches){const r=F.sourceCaches[i].getSource().type;r!=="vector"&&r!=="geojson"||F.sourceCaches[i].reload()}})}),this.on("data",O=>{if(O.dataType!=="source"||O.sourceDataType!=="metadata")return;const y=this.sourceCaches[O.sourceId];if(!y)return;const s=y.getSource();if(s&&s.vectorLayerIds)for(const i in this._layers){const r=this._layers[i];r.source===s.id&&this._validateLayer(r)}})}loadURL(A,E={},F){this.fire(new a.k("dataloading",{dataType:"style"})),E.validate=typeof E.validate!="boolean"||E.validate;const O=this.map._requestManager.transformRequest(A,it.Style);this._request=a.f(O,(y,s)=>{this._request=null,y?this.fire(new a.j(y)):s&&this._load(s,E,F)})}loadJSON(A,E={},F){this.fire(new a.k("dataloading",{dataType:"style"})),this._request=a.h.frame(()=>{this._request=null,E.validate=E.validate!==!1,this._load(A,E,F)})}loadEmpty(){this.fire(new a.k("dataloading",{dataType:"style"})),this._load(Tn,{validate:!1})}_load(A,E,F){var O;const y=E.transformStyle?E.transformStyle(F,A):A;if(!E.validate||!Wt(this,a.y(y))){this._loaded=!0,this.stylesheet=y;for(const s in y.sources)this.addSource(s,y.sources[s],{validate:!1});y.sprite?this._loadSprite(y.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(y.glyphs),this._createLayers(),this.light=new Ot(this.stylesheet.light),this.map.setTerrain((O=this.stylesheet.terrain)!==null&&O!==void 0?O:null),this.fire(new a.k("data",{dataType:"style"})),this.fire(new a.k("style.load"))}}_createLayers(){const A=a.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",A),this._order=A.map(E=>E.id),this._layers={},this._serializedLayers=null;for(const E of A){const F=a.aC(E);F.setEventedParent(this,{layer:{id:E.id}}),this._layers[E.id]=F}}_loadSprite(A,E=!1,F=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(O,y,s,i){const r=at(O),l=r.length,d=s>1?"@2x":"",_={},w={},T={};for(const{id:B,url:j}of r){const X=y.transformRequest(y.normalizeSpriteURL(j,d,".json"),it.SpriteJSON),ue=`${B}_${X.url}`;_[ue]=a.f(X,(Re,Be)=>{delete _[ue],w[B]=Be,_t(i,w,T,Re,l)});const Se=y.transformRequest(y.normalizeSpriteURL(j,d,".png"),it.SpriteImage),Te=`${B}_${Se.url}`;_[Te]=Ye.getImage(Se,(Re,Be)=>{delete _[Te],T[B]=Be,_t(i,w,T,Re,l)})}return{cancel(){for(const B of Object.values(_))B.cancel()}}}(A,this.map._requestManager,this.map.getPixelRatio(),(O,y)=>{if(this._spriteRequest=null,O)this.fire(new a.j(O));else if(y)for(const s in y){this._spritesImagesIds[s]=[];const i=this._spritesImagesIds[s]?this._spritesImagesIds[s].filter(r=>!(r in y)):[];for(const r of i)this.imageManager.removeImage(r),this._changedImages[r]=!0;for(const r in y[s]){const l=s==="default"?r:`${s}:${r}`;this._spritesImagesIds[s].push(l),l in this.imageManager.images?this.imageManager.updateImage(l,y[s][r],!1):this.imageManager.addImage(l,y[s][r]),E&&(this._changedImages[l]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),E&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"})),F&&F(O)})}_unloadSprite(){for(const A of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(A),this._changedImages[A]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}_validateLayer(A){const E=this.sourceCaches[A.source];if(!E)return;const F=A.sourceLayer;if(!F)return;const O=E.getSource();(O.type==="geojson"||O.vectorLayerIds&&O.vectorLayerIds.indexOf(F)===-1)&&this.fire(new a.j(new Error(`Source layer "${F}" does not exist on source "${O.id}" as specified by style layer "${A.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const A in this.sourceCaches)if(!this.sourceCaches[A].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(A){const E=this._serializedAllLayers();if(!A||A.length===0)return Object.values(E);const F=[];for(const O of A)E[O]&&F.push(E[O]);return F}_serializedAllLayers(){let A=this._serializedLayers;if(A)return A;A=this._serializedLayers={};const E=Object.keys(this._layers);for(const F of E){const O=this._layers[F];O.type!=="custom"&&(A[F]=O.serialize())}return A}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const A in this.sourceCaches)if(this.sourceCaches[A].hasTransition())return!0;for(const A in this._layers)if(this._layers[A].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(A){if(!this._loaded)return;const E=this._changed;if(this._changed){const O=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(O.length||y.length)&&this._updateWorkerLayers(O,y);for(const s in this._updatedSources){const i=this._updatedSources[s];if(i==="reload")this._reloadSource(s);else{if(i!=="clear")throw new Error(`Invalid action ${i}`);this._clearSource(s)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const s in this._updatedPaintProps)this._layers[s].updateTransitions(A);this.light.updateTransitions(A),this._resetUpdates()}const F={};for(const O in this.sourceCaches){const y=this.sourceCaches[O];F[O]=y.used,y.used=!1}for(const O of this._order){const y=this._layers[O];y.recalculate(A,this._availableImages),!y.isHidden(A.zoom)&&y.source&&(this.sourceCaches[y.source].used=!0)}for(const O in F){const y=this.sourceCaches[O];F[O]!==y.used&&y.fire(new a.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:O}))}this.light.recalculate(A),this.z=A.zoom,E&&this.fire(new a.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const A=Object.keys(this._changedImages);if(A.length){for(const E in this.sourceCaches)this.sourceCaches[E].reloadTilesForDependencies(["icons","patterns"],A);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const A in this.sourceCaches)this.sourceCaches[A].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(A,E){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(A),removedIds:E})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(A,E={}){this._checkLoaded();const F=this.serialize();if(A=E.transformStyle?E.transformStyle(F,A):A,Wt(this,a.y(A)))return!1;(A=a.aD(A)).layers=a.aB(A.layers);const O=a.aE(F,A).filter(s=>!(s.command in Ut));if(O.length===0)return!1;const y=O.filter(s=>!(s.command in Yi));if(y.length>0)throw new Error(`Unimplemented: ${y.map(s=>s.command).join(", ")}.`);for(const s of O)s.command!=="setTransition"&&this[s.command].apply(this,s.args);return this.stylesheet=A,this._serializedLayers=null,!0}addImage(A,E){if(this.getImage(A))return this.fire(new a.j(new Error(`An image named "${A}" already exists.`)));this.imageManager.addImage(A,E),this._afterImageUpdated(A)}updateImage(A,E){this.imageManager.updateImage(A,E)}getImage(A){return this.imageManager.getImage(A)}removeImage(A){if(!this.getImage(A))return this.fire(new a.j(new Error(`An image named "${A}" does not exist.`)));this.imageManager.removeImage(A),this._afterImageUpdated(A)}_afterImageUpdated(A){this._availableImages=this.imageManager.listImages(),this._changedImages[A]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(A,E,F={}){if(this._checkLoaded(),this.sourceCaches[A]!==void 0)throw new Error(`Source "${A}" already exists.`);if(!E.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(E).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(E.type)>=0&&this._validate(a.y.source,`sources.${A}`,E,null,F))return;this.map&&this.map._collectResourceTiming&&(E.collectResourceTiming=!0);const O=this.sourceCaches[A]=new sn(A,E,this.dispatcher);O.style=this,O.setEventedParent(this,()=>({isSourceLoaded:O.loaded(),source:O.serialize(),sourceId:A})),O.onAdd(this.map),this._changed=!0}removeSource(A){if(this._checkLoaded(),this.sourceCaches[A]===void 0)throw new Error("There is no source with this ID");for(const F in this._layers)if(this._layers[F].source===A)return this.fire(new a.j(new Error(`Source "${A}" cannot be removed while layer "${F}" is using it.`)));const E=this.sourceCaches[A];delete this.sourceCaches[A],delete this._updatedSources[A],E.fire(new a.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:A})),E.setEventedParent(null),E.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(A,E){if(this._checkLoaded(),this.sourceCaches[A]===void 0)throw new Error(`There is no source with this ID=${A}`);const F=this.sourceCaches[A].getSource();if(F.type!=="geojson")throw new Error(`geojsonSource.type is ${F.type}, which is !== 'geojson`);F.setData(E),this._changed=!0}getSource(A){return this.sourceCaches[A]&&this.sourceCaches[A].getSource()}addLayer(A,E,F={}){this._checkLoaded();const O=A.id;if(this.getLayer(O))return void this.fire(new a.j(new Error(`Layer "${O}" already exists on this map.`)));let y;if(A.type==="custom"){if(Wt(this,a.aF(A)))return;y=a.aC(A)}else{if("source"in A&&typeof A.source=="object"&&(this.addSource(O,A.source),A=a.aD(A),A=a.e(A,{source:O})),this._validate(a.y.layer,`layers.${O}`,A,{arrayIndex:-1},F))return;y=a.aC(A),this._validateLayer(y),y.setEventedParent(this,{layer:{id:O}})}const s=E?this._order.indexOf(E):this._order.length;if(E&&s===-1)this.fire(new a.j(new Error(`Cannot add layer "${O}" before non-existing layer "${E}".`)));else{if(this._order.splice(s,0,O),this._layerOrderChanged=!0,this._layers[O]=y,this._removedLayers[O]&&y.source&&y.type!=="custom"){const i=this._removedLayers[O];delete this._removedLayers[O],i.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(A,E){if(this._checkLoaded(),this._changed=!0,!this._layers[A])return void this.fire(new a.j(new Error(`The layer '${A}' does not exist in the map's style and cannot be moved.`)));if(A===E)return;const F=this._order.indexOf(A);this._order.splice(F,1);const O=E?this._order.indexOf(E):this._order.length;E&&O===-1?this.fire(new a.j(new Error(`Cannot move layer "${A}" before non-existing layer "${E}".`))):(this._order.splice(O,0,A),this._layerOrderChanged=!0)}removeLayer(A){this._checkLoaded();const E=this._layers[A];if(!E)return void this.fire(new a.j(new Error(`Cannot remove non-existing layer "${A}".`)));E.setEventedParent(null);const F=this._order.indexOf(A);this._order.splice(F,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[A]=E,delete this._layers[A],this._serializedLayers&&delete this._serializedLayers[A],delete this._updatedLayers[A],delete this._updatedPaintProps[A],E.onRemove&&E.onRemove(this.map)}getLayer(A){return this._layers[A]}getLayersOrder(){return[...this._order]}hasLayer(A){return A in this._layers}setLayerZoomRange(A,E,F){this._checkLoaded();const O=this.getLayer(A);O?O.minzoom===E&&O.maxzoom===F||(E!=null&&(O.minzoom=E),F!=null&&(O.maxzoom=F),this._updateLayer(O)):this.fire(new a.j(new Error(`Cannot set the zoom range of non-existing layer "${A}".`)))}setFilter(A,E,F={}){this._checkLoaded();const O=this.getLayer(A);if(O){if(!a.aG(O.filter,E))return E==null?(O.filter=void 0,void this._updateLayer(O)):void(this._validate(a.y.filter,`layers.${O.id}.filter`,E,null,F)||(O.filter=a.aD(E),this._updateLayer(O)))}else this.fire(new a.j(new Error(`Cannot filter non-existing layer "${A}".`)))}getFilter(A){return a.aD(this.getLayer(A).filter)}setLayoutProperty(A,E,F,O={}){this._checkLoaded();const y=this.getLayer(A);y?a.aG(y.getLayoutProperty(E),F)||(y.setLayoutProperty(E,F,O),this._updateLayer(y)):this.fire(new a.j(new Error(`Cannot style non-existing layer "${A}".`)))}getLayoutProperty(A,E){const F=this.getLayer(A);if(F)return F.getLayoutProperty(E);this.fire(new a.j(new Error(`Cannot get style of non-existing layer "${A}".`)))}setPaintProperty(A,E,F,O={}){this._checkLoaded();const y=this.getLayer(A);y?a.aG(y.getPaintProperty(E),F)||(y.setPaintProperty(E,F,O)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[A]=!0):this.fire(new a.j(new Error(`Cannot style non-existing layer "${A}".`)))}getPaintProperty(A,E){return this.getLayer(A).getPaintProperty(E)}setFeatureState(A,E){this._checkLoaded();const F=A.source,O=A.sourceLayer,y=this.sourceCaches[F];if(y===void 0)return void this.fire(new a.j(new Error(`The source '${F}' does not exist in the map's style.`)));const s=y.getSource().type;s==="geojson"&&O?this.fire(new a.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):s!=="vector"||O?(A.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),y.setFeatureState(O,A.id,E)):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(A,E){this._checkLoaded();const F=A.source,O=this.sourceCaches[F];if(O===void 0)return void this.fire(new a.j(new Error(`The source '${F}' does not exist in the map's style.`)));const y=O.getSource().type,s=y==="vector"?A.sourceLayer:void 0;y!=="vector"||s?E&&typeof A.id!="string"&&typeof A.id!="number"?this.fire(new a.j(new Error("A feature id is required to remove its specific state property."))):O.removeFeatureState(s,A.id,E):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(A){this._checkLoaded();const E=A.source,F=A.sourceLayer,O=this.sourceCaches[E];if(O!==void 0)return O.getSource().type!=="vector"||F?(A.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),O.getFeatureState(F,A.id)):void this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.j(new Error(`The source '${E}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const A=a.aH(this.sourceCaches,y=>y.serialize()),E=this._serializeByIds(this._order),F=this.map.getTerrain()||void 0,O=this.stylesheet;return a.aI({version:O.version,name:O.name,metadata:O.metadata,light:O.light,center:O.center,zoom:O.zoom,bearing:O.bearing,pitch:O.pitch,sprite:O.sprite,glyphs:O.glyphs,transition:O.transition,sources:A,layers:E,terrain:F},y=>y!==void 0)}_updateLayer(A){this._updatedLayers[A.id]=!0,A.source&&!this._updatedSources[A.source]&&this.sourceCaches[A.source].getSource().type!=="raster"&&(this._updatedSources[A.source]="reload",this.sourceCaches[A.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(A){const E=s=>this._layers[s].type==="fill-extrusion",F={},O=[];for(let s=this._order.length-1;s>=0;s--){const i=this._order[s];if(E(i)){F[i]=s;for(const r of A){const l=r[i];if(l)for(const d of l)O.push(d)}}}O.sort((s,i)=>i.intersectionZ-s.intersectionZ);const y=[];for(let s=this._order.length-1;s>=0;s--){const i=this._order[s];if(E(i))for(let r=O.length-1;r>=0;r--){const l=O[r].feature;if(F[l.layer.id]<s)break;y.push(l),O.pop()}else for(const r of A){const l=r[i];if(l)for(const d of l)y.push(d.feature)}}return y}queryRenderedFeatures(A,E,F){E&&E.filter&&this._validate(a.y.filter,"queryRenderedFeatures.filter",E.filter,null,E);const O={};if(E&&E.layers){if(!Array.isArray(E.layers))return this.fire(new a.j(new Error("parameters.layers must be an Array."))),[];for(const i of E.layers){const r=this._layers[i];if(!r)return this.fire(new a.j(new Error(`The layer '${i}' does not exist in the map's style and cannot be queried for features.`))),[];O[r.source]=!0}}const y=[];E.availableImages=this._availableImages;const s=this._serializedAllLayers();for(const i in this.sourceCaches)E.layers&&!O[i]||y.push(rn(this.sourceCaches[i],this._layers,s,A,E,F));return this.placement&&y.push(function(i,r,l,d,_,w,T){const B={},j=w.queryRenderedSymbols(d),X=[];for(const ue of Object.keys(j).map(Number))X.push(T[ue]);X.sort(Xt);for(const ue of X){const Se=ue.featureIndex.lookupSymbolFeatures(j[ue.bucketInstanceId],r,ue.bucketIndex,ue.sourceLayerIndex,_.filter,_.layers,_.availableImages,i);for(const Te in Se){const Re=B[Te]=B[Te]||[],Be=Se[Te];Be.sort((et,vt)=>{const ot=ue.featureSortOrder;if(ot){const ht=ot.indexOf(et.featureIndex);return ot.indexOf(vt.featureIndex)-ht}return vt.featureIndex-et.featureIndex});for(const et of Be)Re.push(et)}}for(const ue in B)B[ue].forEach(Se=>{const Te=Se.feature,Re=l[i[ue].source].getFeatureState(Te.layer["source-layer"],Te.id);Te.source=Te.layer.source,Te.layer["source-layer"]&&(Te.sourceLayer=Te.layer["source-layer"]),Te.state=Re});return B}(this._layers,s,this.sourceCaches,A,E,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(A,E){E&&E.filter&&this._validate(a.y.filter,"querySourceFeatures.filter",E.filter,null,E);const F=this.sourceCaches[A];return F?function(O,y){const s=O.getRenderableIds().map(l=>O.getTileByID(l)),i=[],r={};for(let l=0;l<s.length;l++){const d=s[l],_=d.tileID.canonical.key;r[_]||(r[_]=!0,d.querySourceFeatures(i,y))}return i}(F,E):[]}addSourceType(A,E,F){return bn(A)?F(new Error(`A source type called "${A}" already exists.`)):(((O,y)=>{xn[O]=y})(A,E),E.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:A,url:E.workerSourceURL},F):F(null,null))}getLight(){return this.light.getLight()}setLight(A,E={}){this._checkLoaded();const F=this.light.getLight();let O=!1;for(const s in A)if(!a.aG(A[s],F[s])){O=!0;break}if(!O)return;const y={now:a.h.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(A,E),this.light.updateTransitions(y)}_validate(A,E,F,O,y={}){return(!y||y.validate!==!1)&&Wt(this,A.call(a.y,a.e({key:E,style:this.serialize(),value:F,styleSpec:a.v},O)))}_remove(A=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(const E in this._layers)this._layers[E].setEventedParent(null);for(const E in this.sourceCaches){const F=this.sourceCaches[E];F.setEventedParent(null),F.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(A)}_clearSource(A){this.sourceCaches[A].clearTiles()}_reloadSource(A){this.sourceCaches[A].resume(),this.sourceCaches[A].reload()}_updateSources(A){for(const E in this.sourceCaches)this.sourceCaches[E].update(A,this.map.terrain)}_generateCollisionBoxes(){for(const A in this.sourceCaches)this._reloadSource(A)}_updatePlacement(A,E,F,O,y=!1){let s=!1,i=!1;const r={};for(const l of this._order){const d=this._layers[l];if(d.type!=="symbol")continue;if(!r[d.source]){const w=this.sourceCaches[d.source];r[d.source]=w.getRenderableIds(!0).map(T=>w.getTileByID(T)).sort((T,B)=>B.tileID.overscaledZ-T.tileID.overscaledZ||(T.tileID.isLessThan(B.tileID)?-1:1))}const _=this.crossTileSymbolIndex.addLayer(d,r[d.source],A.center.lng);s=s||_}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||F===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.h.now(),A.zoom))&&(this.pauseablePlacement=new mn(A,this.map.terrain,this._order,y,E,F,O,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,r),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.h.now()),i=!0),s&&this.pauseablePlacement.placement.setStale()),i||s)for(const l of this._order){const d=this._layers[l];d.type==="symbol"&&this.placement.updateLayerOpacities(d,r[d.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.h.now())}_releaseSymbolFadeTiles(){for(const A in this.sourceCaches)this.sourceCaches[A].releaseSymbolFadeTiles()}getImages(A,E,F){this.imageManager.getImages(E.icons,F),this._updateTilesForChangedImages();const O=this.sourceCaches[E.source];O&&O.setDependencies(E.tileID.key,E.type,E.icons)}getGlyphs(A,E,F){this.glyphManager.getGlyphs(E.stacks,F);const O=this.sourceCaches[E.source];O&&O.setDependencies(E.tileID.key,E.type,[""])}getResource(A,E,F){return a.m(E,F)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(A,E={}){this._checkLoaded(),A&&this._validate(a.y.glyphs,"glyphs",A,null,E)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=A,this.glyphManager.entries={},this.glyphManager.setURL(A))}addSprite(A,E,F={},O){this._checkLoaded();const y=[{id:A,url:E}],s=[...at(this.stylesheet.sprite),...y];this._validate(a.y.sprite,"sprite",s,null,F)||(this.stylesheet.sprite=s,this._loadSprite(y,!0,O))}removeSprite(A){this._checkLoaded();const E=at(this.stylesheet.sprite);if(E.find(F=>F.id===A)){if(this._spritesImagesIds[A])for(const F of this._spritesImagesIds[A])this.imageManager.removeImage(F),this._changedImages[F]=!0;E.splice(E.findIndex(F=>F.id===A),1),this.stylesheet.sprite=E.length>0?E:void 0,delete this._spritesImagesIds[A],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}else this.fire(new a.j(new Error(`Sprite "${A}" doesn't exists on this map.`)))}getSprite(){return at(this.stylesheet.sprite)}setSprite(A,E={},F){this._checkLoaded(),A&&this._validate(a.y.sprite,"sprite",A,null,E)||(this.stylesheet.sprite=A,A?this._loadSprite(A,!0,F):(this._unloadSprite(),F&&F(null)))}}cr.registerForPluginStateChange=a.aK;var Vs=a.Q([{name:"a_pos",type:"Int16",components:2}]),Ur="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Vt={prelude:hr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:hr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:hr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:hr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:hr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:hr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:hr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:hr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:hr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:hr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:hr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:hr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:hr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:hr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:hr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:hr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:hr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:hr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:hr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:hr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:hr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:hr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:hr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:hr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:hr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:hr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:hr("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Ur),terrainDepth:hr("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Ur),terrainCoords:hr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Ur)};function hr(Z,A){const E=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,F=A.match(/attribute ([\w]+) ([\w]+)/g),O=Z.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=A.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),s=y?y.concat(O):O,i={};return{fragmentSource:Z=Z.replace(E,(r,l,d,_,w)=>(i[w]=!0,l==="define"?`
#ifndef HAS_UNIFORM_u_${w}
varying ${d} ${_} ${w};
#else
uniform ${d} ${_} u_${w};
#endif
`:`
#ifdef HAS_UNIFORM_u_${w}
    ${d} ${_} ${w} = u_${w};
#endif
`)),vertexSource:A=A.replace(E,(r,l,d,_,w)=>{const T=_==="float"?"vec2":"vec4",B=w.match(/color/)?"color":T;return i[w]?l==="define"?`
#ifndef HAS_UNIFORM_u_${w}
uniform lowp float u_${w}_t;
attribute ${d} ${T} a_${w};
varying ${d} ${_} ${w};
#else
uniform ${d} ${_} u_${w};
#endif
`:B==="vec4"?`
#ifndef HAS_UNIFORM_u_${w}
    ${w} = a_${w};
#else
    ${d} ${_} ${w} = u_${w};
#endif
`:`
#ifndef HAS_UNIFORM_u_${w}
    ${w} = unpack_mix_${B}(a_${w}, u_${w}_t);
#else
    ${d} ${_} ${w} = u_${w};
#endif
`:l==="define"?`
#ifndef HAS_UNIFORM_u_${w}
uniform lowp float u_${w}_t;
attribute ${d} ${T} a_${w};
#else
uniform ${d} ${_} u_${w};
#endif
`:B==="vec4"?`
#ifndef HAS_UNIFORM_u_${w}
    ${d} ${_} ${w} = a_${w};
#else
    ${d} ${_} ${w} = u_${w};
#endif
`:`
#ifndef HAS_UNIFORM_u_${w}
    ${d} ${_} ${w} = unpack_mix_${B}(a_${w}, u_${w}_t);
#else
    ${d} ${_} ${w} = u_${w};
#endif
`}),staticAttributes:F,staticUniforms:s}}class Dt{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(A,E,F,O,y,s,i,r,l){this.context=A;let d=this.boundPaintVertexBuffers.length!==O.length;for(let _=0;!d&&_<O.length;_++)this.boundPaintVertexBuffers[_]!==O[_]&&(d=!0);!this.vao||this.boundProgram!==E||this.boundLayoutVertexBuffer!==F||d||this.boundIndexBuffer!==y||this.boundVertexOffset!==s||this.boundDynamicVertexBuffer!==i||this.boundDynamicVertexBuffer2!==r||this.boundDynamicVertexBuffer3!==l?this.freshBind(E,F,O,y,s,i,r,l):(A.bindVertexArray.set(this.vao),i&&i.bind(),y&&y.dynamicDraw&&y.bind(),r&&r.bind(),l&&l.bind())}freshBind(A,E,F,O,y,s,i,r){const l=A.numAttributes,d=this.context,_=d.gl;this.vao&&this.destroy(),this.vao=d.createVertexArray(),d.bindVertexArray.set(this.vao),this.boundProgram=A,this.boundLayoutVertexBuffer=E,this.boundPaintVertexBuffers=F,this.boundIndexBuffer=O,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=s,this.boundDynamicVertexBuffer2=i,this.boundDynamicVertexBuffer3=r,E.enableAttributes(_,A);for(const w of F)w.enableAttributes(_,A);s&&s.enableAttributes(_,A),i&&i.enableAttributes(_,A),r&&r.enableAttributes(_,A),E.bind(),E.setVertexAttribPointers(_,A,y);for(const w of F)w.bind(),w.setVertexAttribPointers(_,A,y);s&&(s.bind(),s.setVertexAttribPointers(_,A,y)),O&&O.bind(),i&&(i.bind(),i.setVertexAttribPointers(_,A,y)),r&&(r.bind(),r.setVertexAttribPointers(_,A,y)),d.currentNumAttributes=l}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Fr(Z){const A=[];for(let E=0;E<Z.length;E++){if(Z[E]===null)continue;const F=Z[E].split(" ");A.push(F.pop())}return A}class Us{constructor(A,E,F,O,y,s){const i=A.gl;this.program=i.createProgram();const r=Fr(E.staticAttributes),l=F?F.getBinderAttributes():[],d=r.concat(l),_=Vt.prelude.staticUniforms?Fr(Vt.prelude.staticUniforms):[],w=E.staticUniforms?Fr(E.staticUniforms):[],T=F?F.getBinderUniforms():[],B=_.concat(w).concat(T),j=[];for(const et of B)j.indexOf(et)<0&&j.push(et);const X=F?F.defines():[];y&&X.push("#define OVERDRAW_INSPECTOR;"),s&&X.push("#define TERRAIN3D;");const ue=X.concat(Vt.prelude.fragmentSource,E.fragmentSource).join(`
`),Se=X.concat(Vt.prelude.vertexSource,E.vertexSource).join(`
`),Te=i.createShader(i.FRAGMENT_SHADER);if(i.isContextLost())return void(this.failedToCreate=!0);if(i.shaderSource(Te,ue),i.compileShader(Te),!i.getShaderParameter(Te,i.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${i.getShaderInfoLog(Te)}`);i.attachShader(this.program,Te);const Re=i.createShader(i.VERTEX_SHADER);if(i.isContextLost())return void(this.failedToCreate=!0);if(i.shaderSource(Re,Se),i.compileShader(Re),!i.getShaderParameter(Re,i.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${i.getShaderInfoLog(Re)}`);i.attachShader(this.program,Re),this.attributes={};const Be={};this.numAttributes=d.length;for(let et=0;et<this.numAttributes;et++)d[et]&&(i.bindAttribLocation(this.program,et,d[et]),this.attributes[d[et]]=et);if(i.linkProgram(this.program),!i.getProgramParameter(this.program,i.LINK_STATUS))throw new Error(`Program failed to link: ${i.getProgramInfoLog(this.program)}`);i.deleteShader(Re),i.deleteShader(Te);for(let et=0;et<j.length;et++){const vt=j[et];if(vt&&!Be[vt]){const ot=i.getUniformLocation(this.program,vt);ot&&(Be[vt]=ot)}}this.fixedUniforms=O(A,Be),this.terrainUniforms=((et,vt)=>({u_depth:new a.aL(et,vt.u_depth),u_terrain:new a.aL(et,vt.u_terrain),u_terrain_dim:new a.aM(et,vt.u_terrain_dim),u_terrain_matrix:new a.aN(et,vt.u_terrain_matrix),u_terrain_unpack:new a.aO(et,vt.u_terrain_unpack),u_terrain_exaggeration:new a.aM(et,vt.u_terrain_exaggeration)}))(A,Be),this.binderUniforms=F?F.getUniforms(A,Be):[]}draw(A,E,F,O,y,s,i,r,l,d,_,w,T,B,j,X,ue,Se){const Te=A.gl;if(this.failedToCreate)return;if(A.program.set(this.program),A.setDepthMode(F),A.setStencilMode(O),A.setColorMode(y),A.setCullFace(s),r){A.activeTexture.set(Te.TEXTURE2),Te.bindTexture(Te.TEXTURE_2D,r.depthTexture),A.activeTexture.set(Te.TEXTURE3),Te.bindTexture(Te.TEXTURE_2D,r.texture);for(const Be in this.terrainUniforms)this.terrainUniforms[Be].set(r[Be])}for(const Be in this.fixedUniforms)this.fixedUniforms[Be].set(i[Be]);j&&j.setUniforms(A,this.binderUniforms,T,{zoom:B});let Re=0;switch(E){case Te.LINES:Re=2;break;case Te.TRIANGLES:Re=3;break;case Te.LINE_STRIP:Re=1}for(const Be of w.get()){const et=Be.vaos||(Be.vaos={});(et[l]||(et[l]=new Dt)).bind(A,this,d,j?j.getPaintVertexBuffers():[],_,Be.vertexOffset,X,ue,Se),Te.drawElements(E,Be.primitiveLength*Re,Te.UNSIGNED_SHORT,Be.primitiveOffset*Re*2)}}}function ca(Z,A,E){const F=1/Fe(E,1,A.transform.tileZoom),O=Math.pow(2,E.tileID.overscaledZ),y=E.tileSize*Math.pow(2,A.transform.tileZoom)/O,s=y*(E.tileID.canonical.x+E.tileID.wrap*O),i=y*E.tileID.canonical.y;return{u_image:0,u_texsize:E.imageAtlasTexture.size,u_scale:[F,Z.fromScale,Z.toScale],u_fade:Z.t,u_pixel_coord_upper:[s>>16,i>>16],u_pixel_coord_lower:[65535&s,65535&i]}}const Dr=(Z,A,E,F)=>{const O=A.style.light,y=O.properties.get("position"),s=[y.x,y.y,y.z],i=function(){var l=new a.A(9);return a.A!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}();O.properties.get("anchor")==="viewport"&&function(l,d){var _=Math.sin(d),w=Math.cos(d);l[0]=w,l[1]=_,l[2]=0,l[3]=-_,l[4]=w,l[5]=0,l[6]=0,l[7]=0,l[8]=1}(i,-A.transform.angle),function(l,d,_){var w=d[0],T=d[1],B=d[2];l[0]=w*_[0]+T*_[3]+B*_[6],l[1]=w*_[1]+T*_[4]+B*_[7],l[2]=w*_[2]+T*_[5]+B*_[8]}(s,s,i);const r=O.properties.get("color");return{u_matrix:Z,u_lightpos:s,u_lightintensity:O.properties.get("intensity"),u_lightcolor:[r.r,r.g,r.b],u_vertical_gradient:+E,u_opacity:F}},Ua=(Z,A,E,F,O,y,s)=>a.e(Dr(Z,A,E,F),ca(y,A,s),{u_height_factor:-Math.pow(2,O.overscaledZ)/s.tileSize/8}),Fo=Z=>({u_matrix:Z}),Ga=(Z,A,E,F)=>a.e(Fo(Z),ca(E,A,F)),Xs=(Z,A)=>({u_matrix:Z,u_world:A}),Qn=(Z,A,E,F,O)=>a.e(Ga(Z,A,E,F),{u_world:O}),aa=(Z,A,E,F)=>{const O=Z.transform;let y,s;if(F.paint.get("circle-pitch-alignment")==="map"){const i=Fe(E,1,O.zoom);y=!0,s=[i,i]}else y=!1,s=O.pixelsToGLUnits;return{u_camera_to_center_distance:O.cameraToCenterDistance,u_scale_with_map:+(F.paint.get("circle-pitch-scale")==="map"),u_matrix:Z.translatePosMatrix(A.posMatrix,E,F.paint.get("circle-translate"),F.paint.get("circle-translate-anchor")),u_pitch_with_map:+y,u_device_pixel_ratio:Z.pixelRatio,u_extrude_scale:s}},hs=(Z,A,E)=>{const F=Fe(E,1,A.zoom),O=Math.pow(2,A.zoom-E.tileID.overscaledZ),y=E.tileID.overscaleFactor();return{u_matrix:Z,u_camera_to_center_distance:A.cameraToCenterDistance,u_pixels_to_tile_units:F,u_extrude_scale:[A.pixelsToGLUnits[0]/(F*O),A.pixelsToGLUnits[1]/(F*O)],u_overscale_factor:y}},qa=(Z,A,E=1)=>({u_matrix:Z,u_color:A,u_overlay:0,u_overlay_scale:E}),al=Z=>({u_matrix:Z}),ol=(Z,A,E,F)=>({u_matrix:Z,u_extrude_scale:Fe(A,1,E),u_intensity:F});function no(Z,A){const E=Math.pow(2,A.canonical.z),F=A.canonical.y;return[new a.U(0,F/E).toLngLat().lat,new a.U(0,(F+1)/E).toLngLat().lat]}const Ha=(Z,A,E,F)=>{const O=Z.transform;return{u_matrix:$t(Z,A,E,F),u_ratio:1/Fe(A,1,O.zoom),u_device_pixel_ratio:Z.pixelRatio,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]]}},N=(Z,A,E,F,O)=>a.e(Ha(Z,A,E,O),{u_image:0,u_image_height:F}),xe=(Z,A,E,F,O)=>{const y=Z.transform,s=It(A,y);return{u_matrix:$t(Z,A,E,O),u_texsize:A.imageAtlasTexture.size,u_ratio:1/Fe(A,1,y.zoom),u_device_pixel_ratio:Z.pixelRatio,u_image:0,u_scale:[s,F.fromScale,F.toScale],u_fade:F.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},nt=(Z,A,E,F,O,y)=>{const s=Z.lineAtlas,i=It(A,Z.transform),r=E.layout.get("line-cap")==="round",l=s.getDash(F.from,r),d=s.getDash(F.to,r),_=l.width*O.fromScale,w=d.width*O.toScale;return a.e(Ha(Z,A,E,y),{u_patternscale_a:[i/_,-l.height/2],u_patternscale_b:[i/w,-d.height/2],u_sdfgamma:s.width/(256*Math.min(_,w)*Z.pixelRatio)/2,u_image:0,u_tex_y_a:l.y,u_tex_y_b:d.y,u_mix:O.t})};function It(Z,A){return 1/Fe(Z,1,A.tileZoom)}function $t(Z,A,E,F){return Z.translatePosMatrix(F?F.posMatrix:A.tileID.posMatrix,A,E.paint.get("line-translate"),E.paint.get("line-translate-anchor"))}const wi=(Z,A,E,F,O)=>{return{u_matrix:Z,u_tl_parent:A,u_scale_parent:E,u_buffer_scale:1,u_fade_t:F.mix,u_opacity:F.opacity*O.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:O.paint.get("raster-brightness-min"),u_brightness_high:O.paint.get("raster-brightness-max"),u_saturation_factor:(s=O.paint.get("raster-saturation"),s>0?1-1/(1.001-s):-s),u_contrast_factor:(y=O.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:Di(O.paint.get("raster-hue-rotate"))};var y,s};function Di(Z){Z*=Math.PI/180;const A=Math.sin(Z),E=Math.cos(Z);return[(2*E+1)/3,(-Math.sqrt(3)*A-E+1)/3,(Math.sqrt(3)*A-E+1)/3]}const hn=(Z,A,E,F,O,y,s,i,r,l)=>{const d=O.transform;return{u_is_size_zoom_constant:+(Z==="constant"||Z==="source"),u_is_size_feature_constant:+(Z==="constant"||Z==="camera"),u_size_t:A?A.uSizeT:0,u_size:A?A.uSize:0,u_camera_to_center_distance:d.cameraToCenterDistance,u_pitch:d.pitch/360*2*Math.PI,u_rotate_symbol:+E,u_aspect_ratio:d.width/d.height,u_fade_change:O.options.fadeDuration?O.symbolFadeChange:1,u_matrix:y,u_label_plane_matrix:s,u_coord_matrix:i,u_is_text:+r,u_pitch_with_map:+F,u_texsize:l,u_texture:0}},dn=(Z,A,E,F,O,y,s,i,r,l,d)=>{const _=O.transform;return a.e(hn(Z,A,E,F,O,y,s,i,r,l),{u_gamma_scale:F?Math.cos(_._pitch)*_.cameraToCenterDistance:1,u_device_pixel_ratio:O.pixelRatio,u_is_halo:+d})},rr=(Z,A,E,F,O,y,s,i,r,l)=>a.e(dn(Z,A,E,F,O,y,s,i,!0,r,!0),{u_texsize_icon:l,u_texture_icon:1}),Ar=(Z,A,E)=>({u_matrix:Z,u_opacity:A,u_color:E}),Or=(Z,A,E,F,O,y)=>a.e(function(s,i,r,l){const d=r.imageManager.getPattern(s.from.toString()),_=r.imageManager.getPattern(s.to.toString()),{width:w,height:T}=r.imageManager.getPixelSize(),B=Math.pow(2,l.tileID.overscaledZ),j=l.tileSize*Math.pow(2,r.transform.tileZoom)/B,X=j*(l.tileID.canonical.x+l.tileID.wrap*B),ue=j*l.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:d.tl,u_pattern_br_a:d.br,u_pattern_tl_b:_.tl,u_pattern_br_b:_.br,u_texsize:[w,T],u_mix:i.t,u_pattern_size_a:d.displaySize,u_pattern_size_b:_.displaySize,u_scale_a:i.fromScale,u_scale_b:i.toScale,u_tile_units_to_pixels:1/Fe(l,1,r.transform.tileZoom),u_pixel_coord_upper:[X>>16,ue>>16],u_pixel_coord_lower:[65535&X,65535&ue]}}(F,y,E,O),{u_matrix:Z,u_opacity:A}),ja={fillExtrusion:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_lightpos:new a.aP(Z,A.u_lightpos),u_lightintensity:new a.aM(Z,A.u_lightintensity),u_lightcolor:new a.aP(Z,A.u_lightcolor),u_vertical_gradient:new a.aM(Z,A.u_vertical_gradient),u_opacity:new a.aM(Z,A.u_opacity)}),fillExtrusionPattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_lightpos:new a.aP(Z,A.u_lightpos),u_lightintensity:new a.aM(Z,A.u_lightintensity),u_lightcolor:new a.aP(Z,A.u_lightcolor),u_vertical_gradient:new a.aM(Z,A.u_vertical_gradient),u_height_factor:new a.aM(Z,A.u_height_factor),u_image:new a.aL(Z,A.u_image),u_texsize:new a.aQ(Z,A.u_texsize),u_pixel_coord_upper:new a.aQ(Z,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Z,A.u_pixel_coord_lower),u_scale:new a.aP(Z,A.u_scale),u_fade:new a.aM(Z,A.u_fade),u_opacity:new a.aM(Z,A.u_opacity)}),fill:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix)}),fillPattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_image:new a.aL(Z,A.u_image),u_texsize:new a.aQ(Z,A.u_texsize),u_pixel_coord_upper:new a.aQ(Z,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Z,A.u_pixel_coord_lower),u_scale:new a.aP(Z,A.u_scale),u_fade:new a.aM(Z,A.u_fade)}),fillOutline:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_world:new a.aQ(Z,A.u_world)}),fillOutlinePattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_world:new a.aQ(Z,A.u_world),u_image:new a.aL(Z,A.u_image),u_texsize:new a.aQ(Z,A.u_texsize),u_pixel_coord_upper:new a.aQ(Z,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Z,A.u_pixel_coord_lower),u_scale:new a.aP(Z,A.u_scale),u_fade:new a.aM(Z,A.u_fade)}),circle:(Z,A)=>({u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_scale_with_map:new a.aL(Z,A.u_scale_with_map),u_pitch_with_map:new a.aL(Z,A.u_pitch_with_map),u_extrude_scale:new a.aQ(Z,A.u_extrude_scale),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_matrix:new a.aN(Z,A.u_matrix)}),collisionBox:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_pixels_to_tile_units:new a.aM(Z,A.u_pixels_to_tile_units),u_extrude_scale:new a.aQ(Z,A.u_extrude_scale),u_overscale_factor:new a.aM(Z,A.u_overscale_factor)}),collisionCircle:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_inv_matrix:new a.aN(Z,A.u_inv_matrix),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_viewport_size:new a.aQ(Z,A.u_viewport_size)}),debug:(Z,A)=>({u_color:new a.aR(Z,A.u_color),u_matrix:new a.aN(Z,A.u_matrix),u_overlay:new a.aL(Z,A.u_overlay),u_overlay_scale:new a.aM(Z,A.u_overlay_scale)}),clippingMask:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix)}),heatmap:(Z,A)=>({u_extrude_scale:new a.aM(Z,A.u_extrude_scale),u_intensity:new a.aM(Z,A.u_intensity),u_matrix:new a.aN(Z,A.u_matrix)}),heatmapTexture:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_world:new a.aQ(Z,A.u_world),u_image:new a.aL(Z,A.u_image),u_color_ramp:new a.aL(Z,A.u_color_ramp),u_opacity:new a.aM(Z,A.u_opacity)}),hillshade:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_image:new a.aL(Z,A.u_image),u_latrange:new a.aQ(Z,A.u_latrange),u_light:new a.aQ(Z,A.u_light),u_shadow:new a.aR(Z,A.u_shadow),u_highlight:new a.aR(Z,A.u_highlight),u_accent:new a.aR(Z,A.u_accent)}),hillshadePrepare:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_image:new a.aL(Z,A.u_image),u_dimension:new a.aQ(Z,A.u_dimension),u_zoom:new a.aM(Z,A.u_zoom),u_unpack:new a.aO(Z,A.u_unpack)}),line:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_ratio:new a.aM(Z,A.u_ratio),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_units_to_pixels:new a.aQ(Z,A.u_units_to_pixels)}),lineGradient:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_ratio:new a.aM(Z,A.u_ratio),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_units_to_pixels:new a.aQ(Z,A.u_units_to_pixels),u_image:new a.aL(Z,A.u_image),u_image_height:new a.aM(Z,A.u_image_height)}),linePattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_texsize:new a.aQ(Z,A.u_texsize),u_ratio:new a.aM(Z,A.u_ratio),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_image:new a.aL(Z,A.u_image),u_units_to_pixels:new a.aQ(Z,A.u_units_to_pixels),u_scale:new a.aP(Z,A.u_scale),u_fade:new a.aM(Z,A.u_fade)}),lineSDF:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_ratio:new a.aM(Z,A.u_ratio),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_units_to_pixels:new a.aQ(Z,A.u_units_to_pixels),u_patternscale_a:new a.aQ(Z,A.u_patternscale_a),u_patternscale_b:new a.aQ(Z,A.u_patternscale_b),u_sdfgamma:new a.aM(Z,A.u_sdfgamma),u_image:new a.aL(Z,A.u_image),u_tex_y_a:new a.aM(Z,A.u_tex_y_a),u_tex_y_b:new a.aM(Z,A.u_tex_y_b),u_mix:new a.aM(Z,A.u_mix)}),raster:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_tl_parent:new a.aQ(Z,A.u_tl_parent),u_scale_parent:new a.aM(Z,A.u_scale_parent),u_buffer_scale:new a.aM(Z,A.u_buffer_scale),u_fade_t:new a.aM(Z,A.u_fade_t),u_opacity:new a.aM(Z,A.u_opacity),u_image0:new a.aL(Z,A.u_image0),u_image1:new a.aL(Z,A.u_image1),u_brightness_low:new a.aM(Z,A.u_brightness_low),u_brightness_high:new a.aM(Z,A.u_brightness_high),u_saturation_factor:new a.aM(Z,A.u_saturation_factor),u_contrast_factor:new a.aM(Z,A.u_contrast_factor),u_spin_weights:new a.aP(Z,A.u_spin_weights)}),symbolIcon:(Z,A)=>({u_is_size_zoom_constant:new a.aL(Z,A.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aL(Z,A.u_is_size_feature_constant),u_size_t:new a.aM(Z,A.u_size_t),u_size:new a.aM(Z,A.u_size),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_pitch:new a.aM(Z,A.u_pitch),u_rotate_symbol:new a.aL(Z,A.u_rotate_symbol),u_aspect_ratio:new a.aM(Z,A.u_aspect_ratio),u_fade_change:new a.aM(Z,A.u_fade_change),u_matrix:new a.aN(Z,A.u_matrix),u_label_plane_matrix:new a.aN(Z,A.u_label_plane_matrix),u_coord_matrix:new a.aN(Z,A.u_coord_matrix),u_is_text:new a.aL(Z,A.u_is_text),u_pitch_with_map:new a.aL(Z,A.u_pitch_with_map),u_texsize:new a.aQ(Z,A.u_texsize),u_texture:new a.aL(Z,A.u_texture)}),symbolSDF:(Z,A)=>({u_is_size_zoom_constant:new a.aL(Z,A.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aL(Z,A.u_is_size_feature_constant),u_size_t:new a.aM(Z,A.u_size_t),u_size:new a.aM(Z,A.u_size),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_pitch:new a.aM(Z,A.u_pitch),u_rotate_symbol:new a.aL(Z,A.u_rotate_symbol),u_aspect_ratio:new a.aM(Z,A.u_aspect_ratio),u_fade_change:new a.aM(Z,A.u_fade_change),u_matrix:new a.aN(Z,A.u_matrix),u_label_plane_matrix:new a.aN(Z,A.u_label_plane_matrix),u_coord_matrix:new a.aN(Z,A.u_coord_matrix),u_is_text:new a.aL(Z,A.u_is_text),u_pitch_with_map:new a.aL(Z,A.u_pitch_with_map),u_texsize:new a.aQ(Z,A.u_texsize),u_texture:new a.aL(Z,A.u_texture),u_gamma_scale:new a.aM(Z,A.u_gamma_scale),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_is_halo:new a.aL(Z,A.u_is_halo)}),symbolTextAndIcon:(Z,A)=>({u_is_size_zoom_constant:new a.aL(Z,A.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aL(Z,A.u_is_size_feature_constant),u_size_t:new a.aM(Z,A.u_size_t),u_size:new a.aM(Z,A.u_size),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_pitch:new a.aM(Z,A.u_pitch),u_rotate_symbol:new a.aL(Z,A.u_rotate_symbol),u_aspect_ratio:new a.aM(Z,A.u_aspect_ratio),u_fade_change:new a.aM(Z,A.u_fade_change),u_matrix:new a.aN(Z,A.u_matrix),u_label_plane_matrix:new a.aN(Z,A.u_label_plane_matrix),u_coord_matrix:new a.aN(Z,A.u_coord_matrix),u_is_text:new a.aL(Z,A.u_is_text),u_pitch_with_map:new a.aL(Z,A.u_pitch_with_map),u_texsize:new a.aQ(Z,A.u_texsize),u_texsize_icon:new a.aQ(Z,A.u_texsize_icon),u_texture:new a.aL(Z,A.u_texture),u_texture_icon:new a.aL(Z,A.u_texture_icon),u_gamma_scale:new a.aM(Z,A.u_gamma_scale),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_is_halo:new a.aL(Z,A.u_is_halo)}),background:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_opacity:new a.aM(Z,A.u_opacity),u_color:new a.aR(Z,A.u_color)}),backgroundPattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_opacity:new a.aM(Z,A.u_opacity),u_image:new a.aL(Z,A.u_image),u_pattern_tl_a:new a.aQ(Z,A.u_pattern_tl_a),u_pattern_br_a:new a.aQ(Z,A.u_pattern_br_a),u_pattern_tl_b:new a.aQ(Z,A.u_pattern_tl_b),u_pattern_br_b:new a.aQ(Z,A.u_pattern_br_b),u_texsize:new a.aQ(Z,A.u_texsize),u_mix:new a.aM(Z,A.u_mix),u_pattern_size_a:new a.aQ(Z,A.u_pattern_size_a),u_pattern_size_b:new a.aQ(Z,A.u_pattern_size_b),u_scale_a:new a.aM(Z,A.u_scale_a),u_scale_b:new a.aM(Z,A.u_scale_b),u_pixel_coord_upper:new a.aQ(Z,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Z,A.u_pixel_coord_lower),u_tile_units_to_pixels:new a.aM(Z,A.u_tile_units_to_pixels)}),terrain:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_texture:new a.aL(Z,A.u_texture),u_ele_delta:new a.aM(Z,A.u_ele_delta)}),terrainDepth:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_ele_delta:new a.aM(Z,A.u_ele_delta)}),terrainCoords:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_texture:new a.aL(Z,A.u_texture),u_terrain_coords_id:new a.aM(Z,A.u_terrain_coords_id),u_ele_delta:new a.aM(Z,A.u_ele_delta)})};class Za{constructor(A,E,F){this.context=A;const O=A.gl;this.buffer=O.createBuffer(),this.dynamicDraw=!!F,this.context.unbindVAO(),A.bindElementBuffer.set(this.buffer),O.bufferData(O.ELEMENT_ARRAY_BUFFER,E.arrayBuffer,this.dynamicDraw?O.DYNAMIC_DRAW:O.STATIC_DRAW),this.dynamicDraw||delete E.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(A){const E=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),E.bufferSubData(E.ELEMENT_ARRAY_BUFFER,0,A.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Qa={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class pl{constructor(A,E,F,O){this.length=E.length,this.attributes=F,this.itemSize=E.bytesPerElement,this.dynamicDraw=O,this.context=A;const y=A.gl;this.buffer=y.createBuffer(),A.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,E.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete E.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(A){if(A.length!==this.length)throw new Error(`Length of new data is ${A.length}, which doesn't match current length of ${this.length}`);const E=this.context.gl;this.bind(),E.bufferSubData(E.ARRAY_BUFFER,0,A.arrayBuffer)}enableAttributes(A,E){for(let F=0;F<this.attributes.length;F++){const O=E.attributes[this.attributes[F].name];O!==void 0&&A.enableVertexAttribArray(O)}}setVertexAttribPointers(A,E,F){for(let O=0;O<this.attributes.length;O++){const y=this.attributes[O],s=E.attributes[y.name];s!==void 0&&A.vertexAttribPointer(s,y.components,A[Qa[y.type]],!1,this.itemSize,y.offset+this.itemSize*(F||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Gr=new WeakMap;function ir(Z){var A;if(Gr.has(Z))return Gr.get(Z);{const E=(A=Z.getParameter(Z.VERSION))===null||A===void 0?void 0:A.startsWith("WebGL 2.0");return Gr.set(Z,E),E}}class Er{constructor(A){this.gl=A.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(A){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Lr extends Er{getDefault(){return a.aT.transparent}set(A){const E=this.current;(A.r!==E.r||A.g!==E.g||A.b!==E.b||A.a!==E.a||this.dirty)&&(this.gl.clearColor(A.r,A.g,A.b,A.a),this.current=A,this.dirty=!1)}}class Zs extends Er{getDefault(){return 1}set(A){(A!==this.current||this.dirty)&&(this.gl.clearDepth(A),this.current=A,this.dirty=!1)}}class xr extends Er{getDefault(){return 0}set(A){(A!==this.current||this.dirty)&&(this.gl.clearStencil(A),this.current=A,this.dirty=!1)}}class Ks extends Er{getDefault(){return[!0,!0,!0,!0]}set(A){const E=this.current;(A[0]!==E[0]||A[1]!==E[1]||A[2]!==E[2]||A[3]!==E[3]||this.dirty)&&(this.gl.colorMask(A[0],A[1],A[2],A[3]),this.current=A,this.dirty=!1)}}class Br extends Er{getDefault(){return!0}set(A){(A!==this.current||this.dirty)&&(this.gl.depthMask(A),this.current=A,this.dirty=!1)}}class To extends Er{getDefault(){return 255}set(A){(A!==this.current||this.dirty)&&(this.gl.stencilMask(A),this.current=A,this.dirty=!1)}}class Zo extends Er{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(A){const E=this.current;(A.func!==E.func||A.ref!==E.ref||A.mask!==E.mask||this.dirty)&&(this.gl.stencilFunc(A.func,A.ref,A.mask),this.current=A,this.dirty=!1)}}class Bs extends Er{getDefault(){const A=this.gl;return[A.KEEP,A.KEEP,A.KEEP]}set(A){const E=this.current;(A[0]!==E[0]||A[1]!==E[1]||A[2]!==E[2]||this.dirty)&&(this.gl.stencilOp(A[0],A[1],A[2]),this.current=A,this.dirty=!1)}}class Il extends Er{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;A?E.enable(E.STENCIL_TEST):E.disable(E.STENCIL_TEST),this.current=A,this.dirty=!1}}class mo extends Er{getDefault(){return[0,1]}set(A){const E=this.current;(A[0]!==E[0]||A[1]!==E[1]||this.dirty)&&(this.gl.depthRange(A[0],A[1]),this.current=A,this.dirty=!1)}}class Qo extends Er{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;A?E.enable(E.DEPTH_TEST):E.disable(E.DEPTH_TEST),this.current=A,this.dirty=!1}}class ha extends Er{getDefault(){return this.gl.LESS}set(A){(A!==this.current||this.dirty)&&(this.gl.depthFunc(A),this.current=A,this.dirty=!1)}}class Ys extends Er{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;A?E.enable(E.BLEND):E.disable(E.BLEND),this.current=A,this.dirty=!1}}class El extends Er{getDefault(){const A=this.gl;return[A.ONE,A.ZERO]}set(A){const E=this.current;(A[0]!==E[0]||A[1]!==E[1]||this.dirty)&&(this.gl.blendFunc(A[0],A[1]),this.current=A,this.dirty=!1)}}class Wa extends Er{getDefault(){return a.aT.transparent}set(A){const E=this.current;(A.r!==E.r||A.g!==E.g||A.b!==E.b||A.a!==E.a||this.dirty)&&(this.gl.blendColor(A.r,A.g,A.b,A.a),this.current=A,this.dirty=!1)}}class Ma extends Er{getDefault(){return this.gl.FUNC_ADD}set(A){(A!==this.current||this.dirty)&&(this.gl.blendEquation(A),this.current=A,this.dirty=!1)}}class ml extends Er{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;A?E.enable(E.CULL_FACE):E.disable(E.CULL_FACE),this.current=A,this.dirty=!1}}class Cl extends Er{getDefault(){return this.gl.BACK}set(A){(A!==this.current||this.dirty)&&(this.gl.cullFace(A),this.current=A,this.dirty=!1)}}class mu extends Er{getDefault(){return this.gl.CCW}set(A){(A!==this.current||this.dirty)&&(this.gl.frontFace(A),this.current=A,this.dirty=!1)}}class As extends Er{getDefault(){return null}set(A){(A!==this.current||this.dirty)&&(this.gl.useProgram(A),this.current=A,this.dirty=!1)}}class ac extends Er{getDefault(){return this.gl.TEXTURE0}set(A){(A!==this.current||this.dirty)&&(this.gl.activeTexture(A),this.current=A,this.dirty=!1)}}class ro extends Er{getDefault(){const A=this.gl;return[0,0,A.drawingBufferWidth,A.drawingBufferHeight]}set(A){const E=this.current;(A[0]!==E[0]||A[1]!==E[1]||A[2]!==E[2]||A[3]!==E[3]||this.dirty)&&(this.gl.viewport(A[0],A[1],A[2],A[3]),this.current=A,this.dirty=!1)}}class so extends Er{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.bindFramebuffer(E.FRAMEBUFFER,A),this.current=A,this.dirty=!1}}class Wl extends Er{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.bindRenderbuffer(E.RENDERBUFFER,A),this.current=A,this.dirty=!1}}class Oo extends Er{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.bindTexture(E.TEXTURE_2D,A),this.current=A,this.dirty=!1}}class Wo extends Er{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.bindBuffer(E.ARRAY_BUFFER,A),this.current=A,this.dirty=!1}}class ko extends Er{getDefault(){return null}set(A){const E=this.gl;E.bindBuffer(E.ELEMENT_ARRAY_BUFFER,A),this.current=A,this.dirty=!1}}class Gs extends Er{getDefault(){return null}set(A){var E;if(A===this.current&&!this.dirty)return;const F=this.gl;ir(F)?F.bindVertexArray(A):(E=F.getExtension("OES_vertex_array_object"))===null||E===void 0||E.bindVertexArrayOES(A),this.current=A,this.dirty=!1}}class $o extends Er{getDefault(){return 4}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.pixelStorei(E.UNPACK_ALIGNMENT,A),this.current=A,this.dirty=!1}}class Xo extends Er{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.pixelStorei(E.UNPACK_PREMULTIPLY_ALPHA_WEBGL,A),this.current=A,this.dirty=!1}}class Yo extends Er{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,A),this.current=A,this.dirty=!1}}class Sa extends Er{constructor(A,E){super(A),this.context=A,this.parent=E}getDefault(){return null}}class $a extends Sa{setDirty(){this.dirty=!0}set(A){if(A===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const E=this.gl;E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_2D,A,0),this.current=A,this.dirty=!1}}class ks extends Sa{set(A){if(A===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const E=this.gl;E.framebufferRenderbuffer(E.FRAMEBUFFER,E.DEPTH_ATTACHMENT,E.RENDERBUFFER,A),this.current=A,this.dirty=!1}}class gu extends Sa{set(A){if(A===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const E=this.gl;E.framebufferRenderbuffer(E.FRAMEBUFFER,E.DEPTH_STENCIL_ATTACHMENT,E.RENDERBUFFER,A),this.current=A,this.dirty=!1}}class Cr{constructor(A,E,F,O,y){this.context=A,this.width=E,this.height=F;const s=A.gl,i=this.framebuffer=s.createFramebuffer();if(this.colorAttachment=new $a(A,i),O)this.depthAttachment=y?new gu(A,i):new ks(A,i);else if(y)throw new Error("Stencil cannot be setted without depth");if(s.checkFramebufferStatus(s.FRAMEBUFFER)!==s.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const A=this.context.gl,E=this.colorAttachment.get();if(E&&A.deleteTexture(E),this.depthAttachment){const F=this.depthAttachment.get();F&&A.deleteRenderbuffer(F)}A.deleteFramebuffer(this.framebuffer)}}class $n{constructor(A,E,F){this.blendFunction=A,this.blendColor=E,this.mask=F}}$n.Replace=[1,0],$n.disabled=new $n($n.Replace,a.aT.transparent,[!1,!1,!1,!1]),$n.unblended=new $n($n.Replace,a.aT.transparent,[!0,!0,!0,!0]),$n.alphaBlended=new $n([1,771],a.aT.transparent,[!0,!0,!0,!0]);class Ko{constructor(A){var E,F;if(this.gl=A,this.clearColor=new Lr(this),this.clearDepth=new Zs(this),this.clearStencil=new xr(this),this.colorMask=new Ks(this),this.depthMask=new Br(this),this.stencilMask=new To(this),this.stencilFunc=new Zo(this),this.stencilOp=new Bs(this),this.stencilTest=new Il(this),this.depthRange=new mo(this),this.depthTest=new Qo(this),this.depthFunc=new ha(this),this.blend=new Ys(this),this.blendFunc=new El(this),this.blendColor=new Wa(this),this.blendEquation=new Ma(this),this.cullFace=new ml(this),this.cullFaceSide=new Cl(this),this.frontFace=new mu(this),this.program=new As(this),this.activeTexture=new ac(this),this.viewport=new ro(this),this.bindFramebuffer=new so(this),this.bindRenderbuffer=new Wl(this),this.bindTexture=new Oo(this),this.bindVertexBuffer=new Wo(this),this.bindElementBuffer=new ko(this),this.bindVertexArray=new Gs(this),this.pixelStoreUnpack=new $o(this),this.pixelStoreUnpackPremultiplyAlpha=new Xo(this),this.pixelStoreUnpackFlipY=new Yo(this),this.extTextureFilterAnisotropic=A.getExtension("EXT_texture_filter_anisotropic")||A.getExtension("MOZ_EXT_texture_filter_anisotropic")||A.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=A.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=A.getParameter(A.MAX_TEXTURE_SIZE),ir(A)){this.HALF_FLOAT=A.HALF_FLOAT;const O=A.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(E=A.RGBA16F)!==null&&E!==void 0?E:O==null?void 0:O.RGBA16F_EXT,this.RGB16F=(F=A.RGB16F)!==null&&F!==void 0?F:O==null?void 0:O.RGB16F_EXT,A.getExtension("EXT_color_buffer_float")}else{A.getExtension("EXT_color_buffer_half_float"),A.getExtension("OES_texture_half_float_linear");const O=A.getExtension("OES_texture_half_float");this.HALF_FLOAT=O==null?void 0:O.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(A,E){return new Za(this,A,E)}createVertexBuffer(A,E,F){return new pl(this,A,E,F)}createRenderbuffer(A,E,F){const O=this.gl,y=O.createRenderbuffer();return this.bindRenderbuffer.set(y),O.renderbufferStorage(O.RENDERBUFFER,A,E,F),this.bindRenderbuffer.set(null),y}createFramebuffer(A,E,F,O){return new Cr(this,A,E,F,O)}clear({color:A,depth:E,stencil:F}){const O=this.gl;let y=0;A&&(y|=O.COLOR_BUFFER_BIT,this.clearColor.set(A),this.colorMask.set([!0,!0,!0,!0])),E!==void 0&&(y|=O.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(E),this.depthMask.set(!0)),F!==void 0&&(y|=O.STENCIL_BUFFER_BIT,this.clearStencil.set(F),this.stencilMask.set(255)),O.clear(y)}setCullFace(A){A.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(A.mode),this.frontFace.set(A.frontFace))}setDepthMode(A){A.func!==this.gl.ALWAYS||A.mask?(this.depthTest.set(!0),this.depthFunc.set(A.func),this.depthMask.set(A.mask),this.depthRange.set(A.range)):this.depthTest.set(!1)}setStencilMode(A){A.test.func!==this.gl.ALWAYS||A.mask?(this.stencilTest.set(!0),this.stencilMask.set(A.mask),this.stencilOp.set([A.fail,A.depthFail,A.pass]),this.stencilFunc.set({func:A.test.func,ref:A.ref,mask:A.test.mask})):this.stencilTest.set(!1)}setColorMode(A){a.aG(A.blendFunction,$n.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(A.blendFunction),this.blendColor.set(A.blendColor)),this.colorMask.set(A.mask)}createVertexArray(){var A;return ir(this.gl)?this.gl.createVertexArray():(A=this.gl.getExtension("OES_vertex_array_object"))===null||A===void 0?void 0:A.createVertexArrayOES()}deleteVertexArray(A){var E;return ir(this.gl)?this.gl.deleteVertexArray(A):(E=this.gl.getExtension("OES_vertex_array_object"))===null||E===void 0?void 0:E.deleteVertexArrayOES(A)}unbindVAO(){this.bindVertexArray.set(null)}}class zr{constructor(A,E,F){this.func=A,this.mask=E,this.range=F}}zr.ReadOnly=!1,zr.ReadWrite=!0,zr.disabled=new zr(519,zr.ReadOnly,[0,1]);const Xa=7680;class is{constructor(A,E,F,O,y,s){this.test=A,this.ref=E,this.mask=F,this.fail=O,this.depthFail=y,this.pass=s}}is.disabled=new is({func:519,mask:0},0,0,Xa,Xa,Xa);class fr{constructor(A,E,F){this.enable=A,this.mode=E,this.frontFace=F}}let Mo;function qn(Z,A,E,F,O,y,s){const i=Z.context,r=i.gl,l=Z.useProgram("collisionBox"),d=[];let _=0,w=0;for(let Te=0;Te<F.length;Te++){const Re=F[Te],Be=A.getTile(Re),et=Be.getBucket(E);if(!et)continue;let vt=Re.posMatrix;O[0]===0&&O[1]===0||(vt=Z.translatePosMatrix(Re.posMatrix,Be,O,y));const ot=s?et.textCollisionBox:et.iconCollisionBox,ht=et.collisionCircleArray;if(ht.length>0){const Et=a.Z(),wt=vt;a.aU(Et,et.placementInvProjMatrix,Z.transform.glCoordMatrix),a.aU(Et,Et,et.placementViewportMatrix),d.push({circleArray:ht,circleOffset:w,transform:wt,invTransform:Et,coord:Re}),_+=ht.length/4,w=_}ot&&l.draw(i,r.LINES,zr.disabled,is.disabled,Z.colorModeForRenderPass(),fr.disabled,hs(vt,Z.transform,Be),Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(Re),E.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,null,Z.transform.zoom,null,null,ot.collisionVertexBuffer)}if(!s||!d.length)return;const T=Z.useProgram("collisionCircle"),B=new a.aV;B.resize(4*_),B._trim();let j=0;for(const Te of d)for(let Re=0;Re<Te.circleArray.length/4;Re++){const Be=4*Re,et=Te.circleArray[Be+0],vt=Te.circleArray[Be+1],ot=Te.circleArray[Be+2],ht=Te.circleArray[Be+3];B.emplace(j++,et,vt,ot,ht,0),B.emplace(j++,et,vt,ot,ht,1),B.emplace(j++,et,vt,ot,ht,2),B.emplace(j++,et,vt,ot,ht,3)}(!Mo||Mo.length<2*_)&&(Mo=function(Te){const Re=2*Te,Be=new a.aX;Be.resize(Re),Be._trim();for(let et=0;et<Re;et++){const vt=6*et;Be.uint16[vt+0]=4*et+0,Be.uint16[vt+1]=4*et+1,Be.uint16[vt+2]=4*et+2,Be.uint16[vt+3]=4*et+2,Be.uint16[vt+4]=4*et+3,Be.uint16[vt+5]=4*et+0}return Be}(_));const X=i.createIndexBuffer(Mo,!0),ue=i.createVertexBuffer(B,a.aW.members,!0);for(const Te of d){const Re={u_matrix:Te.transform,u_inv_matrix:Te.invTransform,u_camera_to_center_distance:(Se=Z.transform).cameraToCenterDistance,u_viewport_size:[Se.width,Se.height]};T.draw(i,r.TRIANGLES,zr.disabled,is.disabled,Z.colorModeForRenderPass(),fr.disabled,Re,Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(Te.coord),E.id,ue,X,a.S.simpleSegment(0,2*Te.circleOffset,Te.circleArray.length,Te.circleArray.length/2),null,Z.transform.zoom,null,null,null)}var Se;ue.destroy(),X.destroy()}fr.disabled=new fr(!1,1029,2305),fr.backCCW=new fr(!0,1029,2305);const Ol=a.ao(new Float32Array(16));function ns(Z,A,E,F,O,y){const{horizontalAlign:s,verticalAlign:i}=a.au(Z);return new a.P((-(s-.5)*A/O+F[0])*y,(-(i-.5)*E/O+F[1])*y)}function Zr(Z,A,E,F,O,y,s,i,r,l,d){const _=Z.text.placedSymbolArray,w=Z.text.dynamicLayoutVertexArray,T=Z.icon.dynamicLayoutVertexArray,B={};w.clear();for(let j=0;j<_.length;j++){const X=_.get(j),ue=X.hidden||!X.crossTileID||Z.allowVerticalPlacement&&!X.placedOrientation?null:F[X.crossTileID];if(ue){const Se=new a.P(X.anchorX,X.anchorY),Te=Ee(Se,E?s:y,d),Re=ze(O.cameraToCenterDistance,Te.signedDistanceFromCamera);let Be=a.aj(Z.textSizeData,r,X)*Re/a.ap;E&&(Be*=Z.tilePixelRatio/i);const{width:et,height:vt,anchor:ot,textOffset:ht,textBoxScale:Et}=ue,wt=ns(ot,et,vt,ht,Et,Be),si=E?Ee(Se.add(wt),y,d).point:Te.point.add(A?wt.rotate(-O.angle):wt),Kt=Z.allowVerticalPlacement&&X.placedOrientation===a.ai.vertical?Math.PI/2:0;for(let ii=0;ii<X.numGlyphs;ii++)a.ak(w,si,Kt);l&&X.associatedIconIndex>=0&&(B[X.associatedIconIndex]={shiftedAnchor:si,angle:Kt})}else de(X.numGlyphs,w)}if(l){T.clear();const j=Z.icon.placedSymbolArray;for(let X=0;X<j.length;X++){const ue=j.get(X);if(ue.hidden)de(ue.numGlyphs,T);else{const Se=B[X];if(Se)for(let Te=0;Te<ue.numGlyphs;Te++)a.ak(T,Se.shiftedAnchor,Se.angle);else de(ue.numGlyphs,T)}}Z.icon.dynamicLayoutVertexBuffer.updateData(T)}Z.text.dynamicLayoutVertexBuffer.updateData(w)}function Ms(Z,A,E){return E.iconsInText&&A?"symbolTextAndIcon":Z?"symbolSDF":"symbolIcon"}function Mr(Z,A,E,F,O,y,s,i,r,l,d,_){const w=Z.context,T=w.gl,B=Z.transform,j=i==="map",X=r==="map",ue=i!=="viewport"&&E.layout.get("symbol-placement")!=="point",Se=j&&!X&&!ue,Te=!E.layout.get("symbol-sort-key").isConstant();let Re=!1;const Be=Z.depthModeForSublayer(0,zr.ReadOnly),et=E._unevaluatedLayout.hasValue("text-variable-anchor")||E._unevaluatedLayout.hasValue("text-variable-anchor-offset"),vt=[];for(const ot of F){const ht=A.getTile(ot),Et=ht.getBucket(E);if(!Et)continue;const wt=O?Et.text:Et.icon;if(!wt||!wt.segments.get().length||!wt.hasVisibleVertices)continue;const si=wt.programConfigurations.get(E.id),Kt=O||Et.sdfIcons,ii=O?Et.textSizeData:Et.iconSizeData,ai=X||B.pitch!==0,Zi=Z.useProgram(Ms(Kt,O,Et),si),Qi=a.ah(ii,B.zoom),Si=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(ot);let Ui,Gi,un,Bn,en=[0,0],kn=null;if(O)Gi=ht.glyphAtlasTexture,un=T.LINEAR,Ui=ht.glyphAtlasTexture.size,Et.iconsInText&&(en=ht.imageAtlasTexture.size,kn=ht.imageAtlasTexture,Bn=ai||Z.options.rotating||Z.options.zooming||ii.kind==="composite"||ii.kind==="camera"?T.LINEAR:T.NEAREST);else{const Qs=E.layout.get("icon-size").constantOr(0)!==1||Et.iconsNeedLinear;Gi=ht.imageAtlasTexture,un=Kt||Z.options.rotating||Z.options.zooming||Qs||ai?T.LINEAR:T.NEAREST,Ui=ht.imageAtlasTexture.size}const vr=Fe(ht,1,Z.transform.zoom),er=ve(ot.posMatrix,X,j,Z.transform,vr),Ca=Ie(ot.posMatrix,X,j,Z.transform,vr),fa=et&&Et.hasTextData(),zs=E.layout.get("icon-text-fit")!=="none"&&fa&&Et.hasIconData();if(ue){const Qs=Z.style.map.terrain?(ss,Rr)=>Z.style.map.terrain.getElevation(ot,ss,Rr):null,rs=E.layout.get("text-rotation-alignment")==="map";He(Et,ot.posMatrix,Z,O,er,Ca,X,l,rs,Qs)}const oo=Z.translatePosMatrix(ot.posMatrix,ht,y,s),lo=ue||O&&et||zs?Ol:er,qr=Z.translatePosMatrix(Ca,ht,y,s,!0),ya=Kt&&E.paint.get(O?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let xo;xo=Kt?Et.iconsInText?rr(ii.kind,Qi,Se,X,Z,oo,lo,qr,Ui,en):dn(ii.kind,Qi,Se,X,Z,oo,lo,qr,O,Ui,!0):hn(ii.kind,Qi,Se,X,Z,oo,lo,qr,O,Ui);const bo={program:Zi,buffers:wt,uniformValues:xo,atlasTexture:Gi,atlasTextureIcon:kn,atlasInterpolation:un,atlasInterpolationIcon:Bn,isSDF:Kt,hasHalo:ya};if(Te&&Et.canOverlap){Re=!0;const Qs=wt.segments.get();for(const rs of Qs)vt.push({segments:new a.S([rs]),sortKey:rs.sortKey,state:bo,terrainData:Si})}else vt.push({segments:wt.segments,sortKey:0,state:bo,terrainData:Si})}Re&&vt.sort((ot,ht)=>ot.sortKey-ht.sortKey);for(const ot of vt){const ht=ot.state;if(w.activeTexture.set(T.TEXTURE0),ht.atlasTexture.bind(ht.atlasInterpolation,T.CLAMP_TO_EDGE),ht.atlasTextureIcon&&(w.activeTexture.set(T.TEXTURE1),ht.atlasTextureIcon&&ht.atlasTextureIcon.bind(ht.atlasInterpolationIcon,T.CLAMP_TO_EDGE)),ht.isSDF){const Et=ht.uniformValues;ht.hasHalo&&(Et.u_is_halo=1,nr(ht.buffers,ot.segments,E,Z,ht.program,Be,d,_,Et,ot.terrainData)),Et.u_is_halo=0}nr(ht.buffers,ot.segments,E,Z,ht.program,Be,d,_,ht.uniformValues,ot.terrainData)}}function nr(Z,A,E,F,O,y,s,i,r,l){const d=F.context;O.draw(d,d.gl.TRIANGLES,y,s,i,fr.disabled,r,l,E.id,Z.layoutVertexBuffer,Z.indexBuffer,A,E.paint,F.transform.zoom,Z.programConfigurations.get(E.id),Z.dynamicLayoutVertexBuffer,Z.opacityVertexBuffer)}function ll(Z,A,E,F,O){if(!E||!F||!F.imageAtlas)return;const y=F.imageAtlas.patternPositions;let s=y[E.to.toString()],i=y[E.from.toString()];if(!s&&i&&(s=i),!i&&s&&(i=s),!s||!i){const r=O.getPaintProperty(A);s=y[r],i=y[r]}s&&i&&Z.setConstantPatternPositions(s,i)}function Xr(Z,A,E,F,O,y,s){const i=Z.context.gl,r="fill-pattern",l=E.paint.get(r),d=l&&l.constantOr(1),_=E.getCrossfadeParameters();let w,T,B,j,X;s?(T=d&&!E.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",w=i.LINES):(T=d?"fillPattern":"fill",w=i.TRIANGLES);const ue=l.constantOr(null);for(const Se of F){const Te=A.getTile(Se);if(d&&!Te.patternsLoaded())continue;const Re=Te.getBucket(E);if(!Re)continue;const Be=Re.programConfigurations.get(E.id),et=Z.useProgram(T,Be),vt=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(Se);d&&(Z.context.activeTexture.set(i.TEXTURE0),Te.imageAtlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE),Be.updatePaintBuffers(_)),ll(Be,r,ue,Te,E);const ot=vt?Se:null,ht=Z.translatePosMatrix(ot?ot.posMatrix:Se.posMatrix,Te,E.paint.get("fill-translate"),E.paint.get("fill-translate-anchor"));if(s){j=Re.indexBuffer2,X=Re.segments2;const Et=[i.drawingBufferWidth,i.drawingBufferHeight];B=T==="fillOutlinePattern"&&d?Qn(ht,Z,_,Te,Et):Xs(ht,Et)}else j=Re.indexBuffer,X=Re.segments,B=d?Ga(ht,Z,_,Te):Fo(ht);et.draw(Z.context,w,O,Z.stencilModeForClipping(Se),y,fr.disabled,B,vt,E.id,Re.layoutVertexBuffer,j,X,E.paint,Z.transform.zoom,Be)}}function Po(Z,A,E,F,O,y,s){const i=Z.context,r=i.gl,l="fill-extrusion-pattern",d=E.paint.get(l),_=d.constantOr(1),w=E.getCrossfadeParameters(),T=E.paint.get("fill-extrusion-opacity"),B=d.constantOr(null);for(const j of F){const X=A.getTile(j),ue=X.getBucket(E);if(!ue)continue;const Se=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(j),Te=ue.programConfigurations.get(E.id),Re=Z.useProgram(_?"fillExtrusionPattern":"fillExtrusion",Te);_&&(Z.context.activeTexture.set(r.TEXTURE0),X.imageAtlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE),Te.updatePaintBuffers(w)),ll(Te,l,B,X,E);const Be=Z.translatePosMatrix(j.posMatrix,X,E.paint.get("fill-extrusion-translate"),E.paint.get("fill-extrusion-translate-anchor")),et=E.paint.get("fill-extrusion-vertical-gradient"),vt=_?Ua(Be,Z,et,T,j,w,X):Dr(Be,Z,et,T);Re.draw(i,i.gl.TRIANGLES,O,y,s,fr.backCCW,vt,Se,E.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,E.paint,Z.transform.zoom,Te,Z.style.map.terrain&&ue.centroidVertexBuffer)}}function ul(Z,A,E,F,O,y,s){const i=Z.context,r=i.gl,l=E.fbo;if(!l)return;const d=Z.useProgram("hillshade"),_=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(A);i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,l.colorAttachment.get()),d.draw(i,r.TRIANGLES,O,y,s,fr.disabled,((w,T,B,j)=>{const X=B.paint.get("hillshade-shadow-color"),ue=B.paint.get("hillshade-highlight-color"),Se=B.paint.get("hillshade-accent-color");let Te=B.paint.get("hillshade-illumination-direction")*(Math.PI/180);B.paint.get("hillshade-illumination-anchor")==="viewport"&&(Te-=w.transform.angle);const Re=!w.options.moving;return{u_matrix:j?j.posMatrix:w.transform.calculatePosMatrix(T.tileID.toUnwrapped(),Re),u_image:0,u_latrange:no(0,T.tileID),u_light:[B.paint.get("hillshade-exaggeration"),Te],u_shadow:X,u_highlight:ue,u_accent:Se}})(Z,E,F,_?A:null),_,F.id,Z.rasterBoundsBuffer,Z.quadTriangleIndexBuffer,Z.rasterBoundsSegments)}function Qr(Z,A,E,F,O,y){const s=Z.context,i=s.gl,r=A.dem;if(r&&r.data){const l=r.dim,d=r.stride,_=r.getPixels();if(s.activeTexture.set(i.TEXTURE1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),A.demTexture=A.demTexture||Z.getTileTexture(d),A.demTexture){const T=A.demTexture;T.update(_,{premultiply:!1}),T.bind(i.NEAREST,i.CLAMP_TO_EDGE)}else A.demTexture=new mt(s,_,i.RGBA,{premultiply:!1}),A.demTexture.bind(i.NEAREST,i.CLAMP_TO_EDGE);s.activeTexture.set(i.TEXTURE0);let w=A.fbo;if(!w){const T=new mt(s,{width:l,height:l,data:null},i.RGBA);T.bind(i.LINEAR,i.CLAMP_TO_EDGE),w=A.fbo=s.createFramebuffer(l,l,!0,!1),w.colorAttachment.set(T.texture)}s.bindFramebuffer.set(w.framebuffer),s.viewport.set([0,0,l,l]),Z.useProgram("hillshadePrepare").draw(s,i.TRIANGLES,F,O,y,fr.disabled,((T,B)=>{const j=B.stride,X=a.Z();return a.aS(X,0,a.N,-a.N,0,0,1),a.$(X,X,[0,-a.N,0]),{u_matrix:X,u_image:1,u_dimension:[j,j],u_zoom:T.overscaledZ,u_unpack:B.getUnpackVector()}})(A.tileID,r),null,E.id,Z.rasterBoundsBuffer,Z.quadTriangleIndexBuffer,Z.rasterBoundsSegments),A.needsHillshadePrepare=!1}}function ds(Z,A,E,F,O,y){const s=F.paint.get("raster-fade-duration");if(!y&&s>0){const i=a.h.now(),r=(i-Z.timeAdded)/s,l=A?(i-A.timeAdded)/s:-1,d=E.getSource(),_=O.coveringZoomLevel({tileSize:d.tileSize,roundZoom:d.roundZoom}),w=!A||Math.abs(A.tileID.overscaledZ-_)>Math.abs(Z.tileID.overscaledZ-_),T=w&&Z.refreshedUponExpiration?1:a.ad(w?r:1-l,0,1);return Z.refreshedUponExpiration&&r>=1&&(Z.refreshedUponExpiration=!1),A?{opacity:1,mix:1-T}:{opacity:T,mix:0}}return{opacity:1,mix:0}}const Ia=new a.aT(1,0,0,1),Tl=new a.aT(0,1,0,1),Do=new a.aT(0,0,1,1),kl=new a.aT(1,0,1,1),go=new a.aT(0,1,1,1);function Js(Z,A,E,F){Ya(Z,0,A+E/2,Z.transform.width,E,F)}function qs(Z,A,E,F){Ya(Z,A-E/2,0,E,Z.transform.height,F)}function Ya(Z,A,E,F,O,y){const s=Z.context,i=s.gl;i.enable(i.SCISSOR_TEST),i.scissor(A*Z.pixelRatio,E*Z.pixelRatio,F*Z.pixelRatio,O*Z.pixelRatio),s.clear({color:y}),i.disable(i.SCISSOR_TEST)}function Jo(Z,A,E){const F=Z.context,O=F.gl,y=E.posMatrix,s=Z.useProgram("debug"),i=zr.disabled,r=is.disabled,l=Z.colorModeForRenderPass(),d="$debug",_=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(E);F.activeTexture.set(O.TEXTURE0);const w=A.getTileByID(E.key).latestRawTileData,T=Math.floor((w&&w.byteLength||0)/1024),B=A.getTile(E).tileSize,j=512/Math.min(B,512)*(E.overscaledZ/Z.transform.zoom)*.5;let X=E.canonical.toString();E.overscaledZ!==E.canonical.z&&(X+=` => ${E.overscaledZ}`),function(ue,Se){ue.initDebugOverlayCanvas();const Te=ue.debugOverlayCanvas,Re=ue.context.gl,Be=ue.debugOverlayCanvas.getContext("2d");Be.clearRect(0,0,Te.width,Te.height),Be.shadowColor="white",Be.shadowBlur=2,Be.lineWidth=1.5,Be.strokeStyle="white",Be.textBaseline="top",Be.font="bold 36px Open Sans, sans-serif",Be.fillText(Se,5,5),Be.strokeText(Se,5,5),ue.debugOverlayTexture.update(Te),ue.debugOverlayTexture.bind(Re.LINEAR,Re.CLAMP_TO_EDGE)}(Z,`${X} ${T}kB`),s.draw(F,O.TRIANGLES,i,r,$n.alphaBlended,fr.disabled,qa(y,a.aT.transparent,j),null,d,Z.debugBuffer,Z.quadTriangleIndexBuffer,Z.debugSegments),s.draw(F,O.LINE_STRIP,i,r,l,fr.disabled,qa(y,a.aT.red),_,d,Z.debugBuffer,Z.tileBorderIndexBuffer,Z.debugSegments)}function Yr(Z,A,E){const F=Z.context,O=F.gl,y=Z.colorModeForRenderPass(),s=new zr(O.LEQUAL,zr.ReadWrite,Z.depthRangeFor3D),i=Z.useProgram("terrain"),r=A.getTerrainMesh();F.bindFramebuffer.set(null),F.viewport.set([0,0,Z.width,Z.height]);for(const l of E){const d=Z.renderToTexture.getTexture(l),_=A.getTerrainData(l.tileID);F.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,d.texture);const w={u_matrix:Z.transform.calculatePosMatrix(l.tileID.toUnwrapped()),u_texture:0,u_ele_delta:A.getMeshFrameDelta(Z.transform.zoom)};i.draw(F,O.TRIANGLES,s,is.disabled,y,fr.backCCW,w,_,"terrain",r.vertexBuffer,r.indexBuffer,r.segments)}}class gr{constructor(A,E){this.context=new Ko(A),this.transform=E,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.Z(),renderTime:0},this.setup(),this.numSublayers=sn.maxUnderzooming+sn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Vn}resize(A,E,F){if(this.width=Math.floor(A*F),this.height=Math.floor(E*F),this.pixelRatio=F,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const O of this.style._order)this.style._layers[O].resize()}setup(){const A=this.context,E=new a.a_;E.emplaceBack(0,0),E.emplaceBack(a.N,0),E.emplaceBack(0,a.N),E.emplaceBack(a.N,a.N),this.tileExtentBuffer=A.createVertexBuffer(E,Vs.members),this.tileExtentSegments=a.S.simpleSegment(0,0,4,2);const F=new a.a_;F.emplaceBack(0,0),F.emplaceBack(a.N,0),F.emplaceBack(0,a.N),F.emplaceBack(a.N,a.N),this.debugBuffer=A.createVertexBuffer(F,Vs.members),this.debugSegments=a.S.simpleSegment(0,0,4,5);const O=new a.V;O.emplaceBack(0,0,0,0),O.emplaceBack(a.N,0,a.N,0),O.emplaceBack(0,a.N,0,a.N),O.emplaceBack(a.N,a.N,a.N,a.N),this.rasterBoundsBuffer=A.createVertexBuffer(O,Ei.members),this.rasterBoundsSegments=a.S.simpleSegment(0,0,4,2);const y=new a.a_;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=A.createVertexBuffer(y,Vs.members),this.viewportSegments=a.S.simpleSegment(0,0,4,2);const s=new a.a$;s.emplaceBack(0),s.emplaceBack(1),s.emplaceBack(3),s.emplaceBack(2),s.emplaceBack(0),this.tileBorderIndexBuffer=A.createIndexBuffer(s);const i=new a.b0;i.emplaceBack(0,1,2),i.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=A.createIndexBuffer(i);const r=this.context.gl;this.stencilClearMode=new is({func:r.ALWAYS,mask:0},0,255,r.ZERO,r.ZERO,r.ZERO)}clearStencil(){const A=this.context,E=A.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const F=a.Z();a.aS(F,0,this.width,this.height,0,0,1),a.a0(F,F,[E.drawingBufferWidth,E.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(A,E.TRIANGLES,zr.disabled,this.stencilClearMode,$n.disabled,fr.disabled,al(F),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(A,E){if(this.currentStencilSource===A.source||!A.isTileClipped()||!E||!E.length)return;this.currentStencilSource=A.source;const F=this.context,O=F.gl;this.nextStencilID+E.length>256&&this.clearStencil(),F.setColorMode($n.disabled),F.setDepthMode(zr.disabled);const y=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const s of E){const i=this._tileClippingMaskIDs[s.key]=this.nextStencilID++,r=this.style.map.terrain&&this.style.map.terrain.getTerrainData(s);y.draw(F,O.TRIANGLES,zr.disabled,new is({func:O.ALWAYS,mask:0},i,255,O.KEEP,O.KEEP,O.REPLACE),$n.disabled,fr.disabled,al(s.posMatrix),r,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const A=this.nextStencilID++,E=this.context.gl;return new is({func:E.NOTEQUAL,mask:255},A,255,E.KEEP,E.KEEP,E.REPLACE)}stencilModeForClipping(A){const E=this.context.gl;return new is({func:E.EQUAL,mask:255},this._tileClippingMaskIDs[A.key],0,E.KEEP,E.KEEP,E.REPLACE)}stencilConfigForOverlap(A){const E=this.context.gl,F=A.sort((s,i)=>i.overscaledZ-s.overscaledZ),O=F[F.length-1].overscaledZ,y=F[0].overscaledZ-O+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const s={};for(let i=0;i<y;i++)s[i+O]=new is({func:E.GEQUAL,mask:255},i+this.nextStencilID,255,E.KEEP,E.KEEP,E.REPLACE);return this.nextStencilID+=y,[s,F]}return[{[O]:is.disabled},F]}colorModeForRenderPass(){const A=this.context.gl;return this._showOverdrawInspector?new $n([A.CONSTANT_COLOR,A.ONE],new a.aT(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?$n.unblended:$n.alphaBlended}depthModeForSublayer(A,E,F){if(!this.opaquePassEnabledForLayer())return zr.disabled;const O=1-((1+this.currentLayer)*this.numSublayers+A)*this.depthEpsilon;return new zr(F||this.context.gl.LEQUAL,E,[O,O])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(A,E){this.style=A,this.options=E,this.lineAtlas=A.lineAtlas,this.imageManager=A.imageManager,this.glyphManager=A.glyphManager,this.symbolFadeChange=A.placement.symbolFadeChange(a.h.now()),this.imageManager.beginFrame();const F=this.style._order,O=this.style.sourceCaches,y={},s={},i={};for(const r in O){const l=O[r];l.used&&l.prepare(this.context),y[r]=l.getVisibleCoordinates(),s[r]=y[r].slice().reverse(),i[r]=l.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let r=0;r<F.length;r++)if(this.style._layers[F[r]].is3D()){this.opaquePassCutoff=r;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const r=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!a.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||r.length)&&(a.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(l,d){const _=l.context,w=_.gl,T=$n.unblended,B=new zr(w.LEQUAL,zr.ReadWrite,[0,1]),j=d.getTerrainMesh(),X=d.sourceCache.getRenderableTiles(),ue=l.useProgram("terrainDepth");_.bindFramebuffer.set(d.getFramebuffer("depth").framebuffer),_.viewport.set([0,0,l.width/devicePixelRatio,l.height/devicePixelRatio]),_.clear({color:a.aT.transparent,depth:1});for(const Se of X){const Te=d.getTerrainData(Se.tileID),Re={u_matrix:l.transform.calculatePosMatrix(Se.tileID.toUnwrapped()),u_ele_delta:d.getMeshFrameDelta(l.transform.zoom)};ue.draw(_,w.TRIANGLES,B,is.disabled,T,fr.backCCW,Re,Te,"terrain",j.vertexBuffer,j.indexBuffer,j.segments)}_.bindFramebuffer.set(null),_.viewport.set([0,0,l.width,l.height])}(this,this.style.map.terrain),function(l,d){const _=l.context,w=_.gl,T=$n.unblended,B=new zr(w.LEQUAL,zr.ReadWrite,[0,1]),j=d.getTerrainMesh(),X=d.getCoordsTexture(),ue=d.sourceCache.getRenderableTiles(),Se=l.useProgram("terrainCoords");_.bindFramebuffer.set(d.getFramebuffer("coords").framebuffer),_.viewport.set([0,0,l.width/devicePixelRatio,l.height/devicePixelRatio]),_.clear({color:a.aT.transparent,depth:1}),d.coordsIndex=[];for(const Te of ue){const Re=d.getTerrainData(Te.tileID);_.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,X.texture);const Be={u_matrix:l.transform.calculatePosMatrix(Te.tileID.toUnwrapped()),u_terrain_coords_id:(255-d.coordsIndex.length)/255,u_texture:0,u_ele_delta:d.getMeshFrameDelta(l.transform.zoom)};Se.draw(_,w.TRIANGLES,B,is.disabled,T,fr.backCCW,Be,Re,"terrain",j.vertexBuffer,j.indexBuffer,j.segments),d.coordsIndex.push(Te.tileID.key)}_.bindFramebuffer.set(null),_.viewport.set([0,0,l.width,l.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const r of F){const l=this.style._layers[r];if(!l.hasOffscreenPass()||l.isHidden(this.transform.zoom))continue;const d=s[l.source];(l.type==="custom"||d.length)&&this.renderLayer(this,O[l.source],l,d)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:E.showOverdrawInspector?a.aT.black:a.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=E.showOverdrawInspector,this.depthRangeFor3D=[0,1-(A._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=F.length-1;this.currentLayer>=0;this.currentLayer--){const r=this.style._layers[F[this.currentLayer]],l=O[r.source],d=y[r.source];this._renderTileClippingMasks(r,d),this.renderLayer(this,l,r,d)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<F.length;this.currentLayer++){const r=this.style._layers[F[this.currentLayer]],l=O[r.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(r))continue;const d=(r.type==="symbol"?i:s)[r.source];this._renderTileClippingMasks(r,y[r.source]),this.renderLayer(this,l,r,d)}if(this.options.showTileBoundaries){const r=function(l,d){let _=null;const w=Object.values(l._layers).flatMap(X=>X.source&&!X.isHidden(d)?[l.sourceCaches[X.source]]:[]),T=w.filter(X=>X.getSource().type==="vector"),B=w.filter(X=>X.getSource().type!=="vector"),j=X=>{(!_||_.getSource().maxzoom<X.getSource().maxzoom)&&(_=X)};return T.forEach(X=>j(X)),_||B.forEach(X=>j(X)),_}(this.style,this.transform.zoom);r&&function(l,d,_){for(let w=0;w<_.length;w++)Jo(l,d,_[w])}(this,r,r.getVisibleCoordinates())}this.options.showPadding&&function(r){const l=r.transform.padding;Js(r,r.transform.height-(l.top||0),3,Ia),Js(r,l.bottom||0,3,Tl),qs(r,l.left||0,3,Do),qs(r,r.transform.width-(l.right||0),3,kl);const d=r.transform.centerPoint;(function(_,w,T,B){Ya(_,w-1,T-10,2,20,B),Ya(_,w-10,T-1,20,2,B)})(r,d.x,r.transform.height-d.y,go)}(this),this.context.setDefault()}renderLayer(A,E,F,O){if(!F.isHidden(this.transform.zoom)&&(F.type==="background"||F.type==="custom"||(O||[]).length))switch(this.id=F.id,F.type){case"symbol":(function(y,s,i,r,l){if(y.renderPass!=="translucent")return;const d=is.disabled,_=y.colorModeForRenderPass();(i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(w,T,B,j,X,ue,Se){const Te=T.transform,Re=X==="map",Be=ue==="map";for(const et of w){const vt=j.getTile(et),ot=vt.getBucket(B);if(!ot||!ot.text||!ot.text.segments.get().length)continue;const ht=a.ah(ot.textSizeData,Te.zoom),Et=Fe(vt,1,T.transform.zoom),wt=ve(et.posMatrix,Be,Re,T.transform,Et),si=B.layout.get("icon-text-fit")!=="none"&&ot.hasIconData();if(ht){const Kt=Math.pow(2,Te.zoom-vt.tileID.overscaledZ);Zr(ot,Re,Be,Se,Te,wt,et.posMatrix,Kt,ht,si,T.style.map.terrain?(ii,ai)=>T.style.map.terrain.getElevation(et,ii,ai):null)}}}(r,y,i,s,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),l),i.paint.get("icon-opacity").constantOr(1)!==0&&Mr(y,s,i,r,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),d,_),i.paint.get("text-opacity").constantOr(1)!==0&&Mr(y,s,i,r,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),d,_),s.map.showCollisionBoxes&&(qn(y,s,i,r,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),qn(y,s,i,r,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))})(A,E,F,O,this.style.placement.variableOffsets);break;case"circle":(function(y,s,i,r){if(y.renderPass!=="translucent")return;const l=i.paint.get("circle-opacity"),d=i.paint.get("circle-stroke-width"),_=i.paint.get("circle-stroke-opacity"),w=!i.layout.get("circle-sort-key").isConstant();if(l.constantOr(1)===0&&(d.constantOr(1)===0||_.constantOr(1)===0))return;const T=y.context,B=T.gl,j=y.depthModeForSublayer(0,zr.ReadOnly),X=is.disabled,ue=y.colorModeForRenderPass(),Se=[];for(let Te=0;Te<r.length;Te++){const Re=r[Te],Be=s.getTile(Re),et=Be.getBucket(i);if(!et)continue;const vt=et.programConfigurations.get(i.id),ot=y.useProgram("circle",vt),ht=et.layoutVertexBuffer,Et=et.indexBuffer,wt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Re),si={programConfiguration:vt,program:ot,layoutVertexBuffer:ht,indexBuffer:Et,uniformValues:aa(y,Re,Be,i),terrainData:wt};if(w){const Kt=et.segments.get();for(const ii of Kt)Se.push({segments:new a.S([ii]),sortKey:ii.sortKey,state:si})}else Se.push({segments:et.segments,sortKey:0,state:si})}w&&Se.sort((Te,Re)=>Te.sortKey-Re.sortKey);for(const Te of Se){const{programConfiguration:Re,program:Be,layoutVertexBuffer:et,indexBuffer:vt,uniformValues:ot,terrainData:ht}=Te.state;Be.draw(T,B.TRIANGLES,j,X,ue,fr.disabled,ot,ht,i.id,et,vt,Te.segments,i.paint,y.transform.zoom,Re)}})(A,E,F,O);break;case"heatmap":(function(y,s,i,r){if(i.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){const l=y.context,d=l.gl,_=is.disabled,w=new $n([d.ONE,d.ONE],a.aT.transparent,[!0,!0,!0,!0]);(function(T,B,j){const X=T.gl;T.activeTexture.set(X.TEXTURE1),T.viewport.set([0,0,B.width/4,B.height/4]);let ue=j.heatmapFbo;if(ue)X.bindTexture(X.TEXTURE_2D,ue.colorAttachment.get()),T.bindFramebuffer.set(ue.framebuffer);else{const Se=X.createTexture();X.bindTexture(X.TEXTURE_2D,Se),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MAG_FILTER,X.LINEAR),ue=j.heatmapFbo=T.createFramebuffer(B.width/4,B.height/4,!1,!1),function(Te,Re,Be,et){var vt,ot;const ht=Te.gl,Et=(vt=Te.HALF_FLOAT)!==null&&vt!==void 0?vt:ht.UNSIGNED_BYTE,wt=(ot=Te.RGBA16F)!==null&&ot!==void 0?ot:ht.RGBA;ht.texImage2D(ht.TEXTURE_2D,0,wt,Re.width/4,Re.height/4,0,ht.RGBA,Et,null),et.colorAttachment.set(Be)}(T,B,Se,ue)}})(l,y,i),l.clear({color:a.aT.transparent});for(let T=0;T<r.length;T++){const B=r[T];if(s.hasRenderableParent(B))continue;const j=s.getTile(B),X=j.getBucket(i);if(!X)continue;const ue=X.programConfigurations.get(i.id),Se=y.useProgram("heatmap",ue),{zoom:Te}=y.transform;Se.draw(l,d.TRIANGLES,zr.disabled,_,w,fr.disabled,ol(B.posMatrix,j,Te,i.paint.get("heatmap-intensity")),null,i.id,X.layoutVertexBuffer,X.indexBuffer,X.segments,i.paint,y.transform.zoom,ue)}l.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(l,d){const _=l.context,w=_.gl,T=d.heatmapFbo;if(!T)return;_.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,T.colorAttachment.get()),_.activeTexture.set(w.TEXTURE1);let B=d.colorRampTexture;B||(B=d.colorRampTexture=new mt(_,d.colorRamp,w.RGBA)),B.bind(w.LINEAR,w.CLAMP_TO_EDGE),l.useProgram("heatmapTexture").draw(_,w.TRIANGLES,zr.disabled,is.disabled,l.colorModeForRenderPass(),fr.disabled,((j,X,ue,Se)=>{const Te=a.Z();a.aS(Te,0,j.width,j.height,0,0,1);const Re=j.context.gl;return{u_matrix:Te,u_world:[Re.drawingBufferWidth,Re.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:X.paint.get("heatmap-opacity")}})(l,d),null,d.id,l.viewportBuffer,l.quadTriangleIndexBuffer,l.viewportSegments,d.paint,l.transform.zoom)}(y,i))})(A,E,F,O);break;case"line":(function(y,s,i,r){if(y.renderPass!=="translucent")return;const l=i.paint.get("line-opacity"),d=i.paint.get("line-width");if(l.constantOr(1)===0||d.constantOr(1)===0)return;const _=y.depthModeForSublayer(0,zr.ReadOnly),w=y.colorModeForRenderPass(),T=i.paint.get("line-dasharray"),B=i.paint.get("line-pattern"),j=B.constantOr(1),X=i.paint.get("line-gradient"),ue=i.getCrossfadeParameters(),Se=j?"linePattern":T?"lineSDF":X?"lineGradient":"line",Te=y.context,Re=Te.gl;let Be=!0;for(const et of r){const vt=s.getTile(et);if(j&&!vt.patternsLoaded())continue;const ot=vt.getBucket(i);if(!ot)continue;const ht=ot.programConfigurations.get(i.id),Et=y.context.program.get(),wt=y.useProgram(Se,ht),si=Be||wt.program!==Et,Kt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(et),ii=B.constantOr(null);if(ii&&vt.imageAtlas){const Qi=vt.imageAtlas,Si=Qi.patternPositions[ii.to.toString()],Ui=Qi.patternPositions[ii.from.toString()];Si&&Ui&&ht.setConstantPatternPositions(Si,Ui)}const ai=Kt?et:null,Zi=j?xe(y,vt,i,ue,ai):T?nt(y,vt,i,T,ue,ai):X?N(y,vt,i,ot.lineClipsArray.length,ai):Ha(y,vt,i,ai);if(j)Te.activeTexture.set(Re.TEXTURE0),vt.imageAtlasTexture.bind(Re.LINEAR,Re.CLAMP_TO_EDGE),ht.updatePaintBuffers(ue);else if(T&&(si||y.lineAtlas.dirty))Te.activeTexture.set(Re.TEXTURE0),y.lineAtlas.bind(Te);else if(X){const Qi=ot.gradients[i.id];let Si=Qi.texture;if(i.gradientVersion!==Qi.version){let Ui=256;if(i.stepInterpolant){const Gi=s.getSource().maxzoom,un=et.canonical.z===Gi?Math.ceil(1<<y.transform.maxZoom-et.canonical.z):1;Ui=a.ad(a.aY(ot.maxLineLength/a.N*1024*un),256,Te.maxTextureSize)}Qi.gradient=a.aZ({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:Ui,image:Qi.gradient||void 0,clips:ot.lineClipsArray}),Qi.texture?Qi.texture.update(Qi.gradient):Qi.texture=new mt(Te,Qi.gradient,Re.RGBA),Qi.version=i.gradientVersion,Si=Qi.texture}Te.activeTexture.set(Re.TEXTURE0),Si.bind(i.stepInterpolant?Re.NEAREST:Re.LINEAR,Re.CLAMP_TO_EDGE)}wt.draw(Te,Re.TRIANGLES,_,y.stencilModeForClipping(et),w,fr.disabled,Zi,Kt,i.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,i.paint,y.transform.zoom,ht,ot.layoutVertexBuffer2),Be=!1}})(A,E,F,O);break;case"fill":(function(y,s,i,r){const l=i.paint.get("fill-color"),d=i.paint.get("fill-opacity");if(d.constantOr(1)===0)return;const _=y.colorModeForRenderPass(),w=i.paint.get("fill-pattern"),T=y.opaquePassEnabledForLayer()&&!w.constantOr(1)&&l.constantOr(a.aT.transparent).a===1&&d.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===T){const B=y.depthModeForSublayer(1,y.renderPass==="opaque"?zr.ReadWrite:zr.ReadOnly);Xr(y,s,i,r,B,_,!1)}if(y.renderPass==="translucent"&&i.paint.get("fill-antialias")){const B=y.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,zr.ReadOnly);Xr(y,s,i,r,B,_,!0)}})(A,E,F,O);break;case"fill-extrusion":(function(y,s,i,r){const l=i.paint.get("fill-extrusion-opacity");if(l!==0&&y.renderPass==="translucent"){const d=new zr(y.context.gl.LEQUAL,zr.ReadWrite,y.depthRangeFor3D);if(l!==1||i.paint.get("fill-extrusion-pattern").constantOr(1))Po(y,s,i,r,d,is.disabled,$n.disabled),Po(y,s,i,r,d,y.stencilModeFor3D(),y.colorModeForRenderPass());else{const _=y.colorModeForRenderPass();Po(y,s,i,r,d,is.disabled,_)}}})(A,E,F,O);break;case"hillshade":(function(y,s,i,r){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const l=y.context,d=y.depthModeForSublayer(0,zr.ReadOnly),_=y.colorModeForRenderPass(),[w,T]=y.renderPass==="translucent"?y.stencilConfigForOverlap(r):[{},r];for(const B of T){const j=s.getTile(B);j.needsHillshadePrepare!==void 0&&j.needsHillshadePrepare&&y.renderPass==="offscreen"?Qr(y,j,i,d,is.disabled,_):y.renderPass==="translucent"&&ul(y,B,j,i,d,w[B.overscaledZ],_)}l.viewport.set([0,0,y.width,y.height])})(A,E,F,O);break;case"raster":(function(y,s,i,r){if(y.renderPass!=="translucent"||i.paint.get("raster-opacity")===0||!r.length)return;const l=y.context,d=l.gl,_=s.getSource(),w=y.useProgram("raster"),T=y.colorModeForRenderPass(),[B,j]=_ instanceof mi?[{},r]:y.stencilConfigForOverlap(r),X=j[j.length-1].overscaledZ,ue=!y.options.moving;for(const Se of j){const Te=y.depthModeForSublayer(Se.overscaledZ-X,i.paint.get("raster-opacity")===1?zr.ReadWrite:zr.ReadOnly,d.LESS),Re=s.getTile(Se);Re.registerFadeDuration(i.paint.get("raster-fade-duration"));const Be=s.findLoadedParent(Se,0),et=ds(Re,Be,s,i,y.transform,y.style.map.terrain);let vt,ot;const ht=i.paint.get("raster-resampling")==="nearest"?d.NEAREST:d.LINEAR;l.activeTexture.set(d.TEXTURE0),Re.texture.bind(ht,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),l.activeTexture.set(d.TEXTURE1),Be?(Be.texture.bind(ht,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),vt=Math.pow(2,Be.tileID.overscaledZ-Re.tileID.overscaledZ),ot=[Re.tileID.canonical.x*vt%1,Re.tileID.canonical.y*vt%1]):Re.texture.bind(ht,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST);const Et=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Se),wt=Et?Se:null,si=wt?wt.posMatrix:y.transform.calculatePosMatrix(Se.toUnwrapped(),ue),Kt=wi(si,ot||[0,0],vt||1,et,i);_ instanceof mi?w.draw(l,d.TRIANGLES,Te,is.disabled,T,fr.disabled,Kt,Et,i.id,_.boundsBuffer,y.quadTriangleIndexBuffer,_.boundsSegments):w.draw(l,d.TRIANGLES,Te,B[Se.overscaledZ],T,fr.disabled,Kt,Et,i.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}})(A,E,F,O);break;case"background":(function(y,s,i,r){const l=i.paint.get("background-color"),d=i.paint.get("background-opacity");if(d===0)return;const _=y.context,w=_.gl,T=y.transform,B=T.tileSize,j=i.paint.get("background-pattern");if(y.isPatternMissing(j))return;const X=!j&&l.a===1&&d===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==X)return;const ue=is.disabled,Se=y.depthModeForSublayer(0,X==="opaque"?zr.ReadWrite:zr.ReadOnly),Te=y.colorModeForRenderPass(),Re=y.useProgram(j?"backgroundPattern":"background"),Be=r||T.coveringTiles({tileSize:B,terrain:y.style.map.terrain});j&&(_.activeTexture.set(w.TEXTURE0),y.imageManager.bind(y.context));const et=i.getCrossfadeParameters();for(const vt of Be){const ot=r?vt.posMatrix:y.transform.calculatePosMatrix(vt.toUnwrapped()),ht=j?Or(ot,d,y,j,{tileID:vt,tileSize:B},et):Ar(ot,d,l),Et=y.style.map.terrain&&y.style.map.terrain.getTerrainData(vt);Re.draw(_,w.TRIANGLES,Se,ue,Te,fr.disabled,ht,Et,i.id,y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}})(A,0,F,O);break;case"custom":(function(y,s,i){const r=y.context,l=i.implementation;if(y.renderPass==="offscreen"){const d=l.prerender;d&&(y.setCustomLayerDefaults(),r.setColorMode(y.colorModeForRenderPass()),d.call(l,r.gl,y.transform.customLayerMatrix()),r.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),r.setColorMode(y.colorModeForRenderPass()),r.setStencilMode(is.disabled);const d=l.renderingMode==="3d"?new zr(y.context.gl.LEQUAL,zr.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,zr.ReadOnly);r.setDepthMode(d),l.render(r.gl,y.transform.customLayerMatrix()),r.setDirty(),y.setBaseState(),r.bindFramebuffer.set(null)}})(A,0,F)}}translatePosMatrix(A,E,F,O,y){if(!F[0]&&!F[1])return A;const s=y?O==="map"?this.transform.angle:0:O==="viewport"?-this.transform.angle:0;if(s){const l=Math.sin(s),d=Math.cos(s);F=[F[0]*d-F[1]*l,F[0]*l+F[1]*d]}const i=[y?F[0]:Fe(E,F[0],this.transform.zoom),y?F[1]:Fe(E,F[1],this.transform.zoom),0],r=new Float32Array(16);return a.$(r,A,i),r}saveTileTexture(A){const E=this._tileTextures[A.size[0]];E?E.push(A):this._tileTextures[A.size[0]]=[A]}getTileTexture(A){const E=this._tileTextures[A];return E&&E.length>0?E.pop():null}isPatternMissing(A){if(!A)return!1;if(!A.from||!A.to)return!0;const E=this.imageManager.getPattern(A.from.toString()),F=this.imageManager.getPattern(A.to.toString());return!E||!F}useProgram(A,E){this.cache=this.cache||{};const F=A+(E?E.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[F]||(this.cache[F]=new Us(this.context,Vt[A],E,ja[A],this._showOverdrawInspector,this.style.map.terrain)),this.cache[F]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const A=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(A.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new mt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:A,drawingBufferHeight:E}=this.context.gl;return this.width!==A||this.height!==E}}class Nr{constructor(A,E){this.points=A,this.planes=E}static fromInvProjectionMatrix(A,E,F){const O=Math.pow(2,F),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(i=>{const r=1/(i=a.ag([],i,A))[3]/E*O;return a.b3(i,i,[r,r,1/i[3],r])}),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(i=>{const r=function(w,T){var B=T[0],j=T[1],X=T[2],ue=B*B+j*j+X*X;return ue>0&&(ue=1/Math.sqrt(ue)),w[0]=T[0]*ue,w[1]=T[1]*ue,w[2]=T[2]*ue,w}([],function(w,T,B){var j=T[0],X=T[1],ue=T[2],Se=B[0],Te=B[1],Re=B[2];return w[0]=X*Re-ue*Te,w[1]=ue*Se-j*Re,w[2]=j*Te-X*Se,w}([],Oe([],y[i[0]],y[i[1]]),Oe([],y[i[2]],y[i[1]]))),l=-((d=r)[0]*(_=y[i[1]])[0]+d[1]*_[1]+d[2]*_[2]);var d,_;return r.concat(l)});return new Nr(y,s)}}class Aa{constructor(A,E){this.min=A,this.max=E,this.center=function(F,O,y){return F[0]=.5*O[0],F[1]=.5*O[1],F[2]=.5*O[2],F}([],function(F,O,y){return F[0]=O[0]+y[0],F[1]=O[1]+y[1],F[2]=O[2]+y[2],F}([],this.min,this.max))}quadrant(A){const E=[A%2==0,A<2],F=zt(this.min),O=zt(this.max);for(let y=0;y<E.length;y++)F[y]=E[y]?this.min[y]:this.center[y],O[y]=E[y]?this.center[y]:this.max[y];return O[2]=this.max[2],new Aa(F,O)}distanceX(A){return Math.max(Math.min(this.max[0],A[0]),this.min[0])-A[0]}distanceY(A){return Math.max(Math.min(this.max[1],A[1]),this.min[1])-A[1]}intersects(A){const E=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let F=!0;for(let O=0;O<A.planes.length;O++){const y=A.planes[O];let s=0;for(let i=0;i<E.length;i++)a.b4(y,E[i])>=0&&s++;if(s===0)return 0;s!==E.length&&(F=!1)}if(F)return 2;for(let O=0;O<3;O++){let y=Number.MAX_VALUE,s=-Number.MAX_VALUE;for(let i=0;i<A.points.length;i++){const r=A.points[i][O]-this.min[O];y=Math.min(y,r),s=Math.max(s,r)}if(s<0||y>this.max[O]-this.min[O])return 0}return 1}}class _o{constructor(A=0,E=0,F=0,O=0){if(isNaN(A)||A<0||isNaN(E)||E<0||isNaN(F)||F<0||isNaN(O)||O<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=A,this.bottom=E,this.left=F,this.right=O}interpolate(A,E,F){return E.top!=null&&A.top!=null&&(this.top=a.B.number(A.top,E.top,F)),E.bottom!=null&&A.bottom!=null&&(this.bottom=a.B.number(A.bottom,E.bottom,F)),E.left!=null&&A.left!=null&&(this.left=a.B.number(A.left,E.left,F)),E.right!=null&&A.right!=null&&(this.right=a.B.number(A.right,E.right,F)),this}getCenter(A,E){const F=a.ad((this.left+A-this.right)/2,0,A),O=a.ad((this.top+E-this.bottom)/2,0,E);return new a.P(F,O)}equals(A){return this.top===A.top&&this.bottom===A.bottom&&this.left===A.left&&this.right===A.right}clone(){return new _o(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class ea{constructor(A,E,F,O,y){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=y===void 0||!!y,this._minZoom=A||0,this._maxZoom=E||22,this._minPitch=F??0,this._maxPitch=O??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new _o,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const A=new ea(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return A.apply(this),A}apply(A){this.tileSize=A.tileSize,this.latRange=A.latRange,this.width=A.width,this.height=A.height,this._center=A._center,this._elevation=A._elevation,this._minEleveationForCurrentTile=A._minEleveationForCurrentTile,this.zoom=A.zoom,this.angle=A.angle,this._fov=A._fov,this._pitch=A._pitch,this._unmodified=A._unmodified,this._edgeInsets=A._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(A){this._minZoom!==A&&(this._minZoom=A,this.zoom=Math.max(this.zoom,A))}get maxZoom(){return this._maxZoom}set maxZoom(A){this._maxZoom!==A&&(this._maxZoom=A,this.zoom=Math.min(this.zoom,A))}get minPitch(){return this._minPitch}set minPitch(A){this._minPitch!==A&&(this._minPitch=A,this.pitch=Math.max(this.pitch,A))}get maxPitch(){return this._maxPitch}set maxPitch(A){this._maxPitch!==A&&(this._maxPitch=A,this.pitch=Math.min(this.pitch,A))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(A){A===void 0?A=!0:A===null&&(A=!1),this._renderWorldCopies=A}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(A){const E=-a.b5(A,-180,180)*Math.PI/180;this.angle!==E&&(this._unmodified=!1,this.angle=E,this._calcMatrices(),this.rotationMatrix=function(){var F=new a.A(4);return a.A!=Float32Array&&(F[1]=0,F[2]=0),F[0]=1,F[3]=1,F}(),function(F,O,y){var s=O[0],i=O[1],r=O[2],l=O[3],d=Math.sin(y),_=Math.cos(y);F[0]=s*_+r*d,F[1]=i*_+l*d,F[2]=s*-d+r*_,F[3]=i*-d+l*_}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(A){const E=a.ad(A,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==E&&(this._unmodified=!1,this._pitch=E,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(A){A=Math.max(.01,Math.min(60,A)),this._fov!==A&&(this._unmodified=!1,this._fov=A/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(A){const E=Math.min(Math.max(A,this.minZoom),this.maxZoom);this._zoom!==E&&(this._unmodified=!1,this._zoom=E,this.tileZoom=Math.max(0,Math.floor(E)),this.scale=this.zoomScale(E),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(A){A.lat===this._center.lat&&A.lng===this._center.lng||(this._unmodified=!1,this._center=A,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(A){A!==this._elevation&&(this._elevation=A,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(A){this._edgeInsets.equals(A)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,A,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(A){return this._edgeInsets.equals(A)}interpolatePadding(A,E,F){this._unmodified=!1,this._edgeInsets.interpolate(A,E,F),this._constrain(),this._calcMatrices()}coveringZoomLevel(A){const E=(A.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/A.tileSize));return Math.max(0,E)}getVisibleUnwrappedCoordinates(A){const E=[new a.b6(0,A)];if(this._renderWorldCopies){const F=this.pointCoordinate(new a.P(0,0)),O=this.pointCoordinate(new a.P(this.width,0)),y=this.pointCoordinate(new a.P(this.width,this.height)),s=this.pointCoordinate(new a.P(0,this.height)),i=Math.floor(Math.min(F.x,O.x,y.x,s.x)),r=Math.floor(Math.max(F.x,O.x,y.x,s.x)),l=1;for(let d=i-l;d<=r+l;d++)d!==0&&E.push(new a.b6(d,A))}return E}coveringTiles(A){var E,F;let O=this.coveringZoomLevel(A);const y=O;if(A.minzoom!==void 0&&O<A.minzoom)return[];A.maxzoom!==void 0&&O>A.maxzoom&&(O=A.maxzoom);const s=this.pointCoordinate(this.getCameraPoint()),i=a.U.fromLngLat(this.center),r=Math.pow(2,O),l=[r*s.x,r*s.y,0],d=[r*i.x,r*i.y,0],_=Nr.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,O);let w=A.minzoom||0;!A.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(w=O);const T=A.terrain?2/Math.min(this.tileSize,A.tileSize)*this.tileSize:3,B=Te=>({aabb:new Aa([Te*r,0,0],[(Te+1)*r,r,0]),zoom:0,x:0,y:0,wrap:Te,fullyVisible:!1}),j=[],X=[],ue=O,Se=A.reparseOverscaled?y:O;if(this._renderWorldCopies)for(let Te=1;Te<=3;Te++)j.push(B(-Te)),j.push(B(Te));for(j.push(B(0));j.length>0;){const Te=j.pop(),Re=Te.x,Be=Te.y;let et=Te.fullyVisible;if(!et){const wt=Te.aabb.intersects(_);if(wt===0)continue;et=wt===2}const vt=A.terrain?l:d,ot=Te.aabb.distanceX(vt),ht=Te.aabb.distanceY(vt),Et=Math.max(Math.abs(ot),Math.abs(ht));if(Te.zoom===ue||Et>T+(1<<ue-Te.zoom)-2&&Te.zoom>=w){const wt=ue-Te.zoom,si=l[0]-.5-(Re<<wt),Kt=l[1]-.5-(Be<<wt);X.push({tileID:new a.O(Te.zoom===ue?Se:Te.zoom,Te.wrap,Te.zoom,Re,Be),distanceSq:jt([d[0]-.5-Re,d[1]-.5-Be]),tileDistanceToCamera:Math.sqrt(si*si+Kt*Kt)})}else for(let wt=0;wt<4;wt++){const si=(Re<<1)+wt%2,Kt=(Be<<1)+(wt>>1),ii=Te.zoom+1;let ai=Te.aabb.quadrant(wt);if(A.terrain){const Zi=new a.O(ii,Te.wrap,ii,si,Kt),Qi=A.terrain.getMinMaxElevation(Zi),Si=(E=Qi.minElevation)!==null&&E!==void 0?E:this.elevation,Ui=(F=Qi.maxElevation)!==null&&F!==void 0?F:this.elevation;ai=new Aa([ai.min[0],ai.min[1],Si],[ai.max[0],ai.max[1],Ui])}j.push({aabb:ai,zoom:ii,x:si,y:Kt,wrap:Te.wrap,fullyVisible:et})}}return X.sort((Te,Re)=>Te.distanceSq-Re.distanceSq).map(Te=>Te.tileID)}resize(A,E){this.width=A,this.height=E,this.pixelsToGLUnits=[2/A,-2/E],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(A){return Math.pow(2,A)}scaleZoom(A){return Math.log(A)/Math.LN2}project(A){const E=a.ad(A.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.P(a.G(A.lng)*this.worldSize,a.H(E)*this.worldSize)}unproject(A){return new a.U(A.x/this.worldSize,A.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(A){const E=this.pointLocation(this.centerPoint,A),F=A.getElevationForLngLatZoom(E,this.tileZoom);if(!(this.elevation-F))return;const O=this.getCameraPosition(),y=a.U.fromLngLat(O.lngLat,O.altitude),s=a.U.fromLngLat(E,F),i=y.x-s.x,r=y.y-s.y,l=y.z-s.z,d=Math.sqrt(i*i+r*r+l*l),_=this.scaleZoom(this.cameraToCenterDistance/d/this.tileSize);this._elevation=F,this._center=E,this.zoom=_}setLocationAtPoint(A,E){const F=this.pointCoordinate(E),O=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(A),s=new a.U(y.x-(F.x-O.x),y.y-(F.y-O.y));this.center=this.coordinateLocation(s),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(A,E){return E?this.coordinatePoint(this.locationCoordinate(A),E.getElevationForLngLatZoom(A,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(A))}pointLocation(A,E){return this.coordinateLocation(this.pointCoordinate(A,E))}locationCoordinate(A){return a.U.fromLngLat(A)}coordinateLocation(A){return A&&A.toLngLat()}pointCoordinate(A,E){if(E){const w=E.pointCoordinate(A);if(w!=null)return w}const F=[A.x,A.y,0,1],O=[A.x,A.y,1,1];a.ag(F,F,this.pixelMatrixInverse),a.ag(O,O,this.pixelMatrixInverse);const y=F[3],s=O[3],i=F[1]/y,r=O[1]/s,l=F[2]/y,d=O[2]/s,_=l===d?0:(0-l)/(d-l);return new a.U(a.B.number(F[0]/y,O[0]/s,_)/this.worldSize,a.B.number(i,r,_)/this.worldSize)}coordinatePoint(A,E=0,F=this.pixelMatrix){const O=[A.x*this.worldSize,A.y*this.worldSize,E,1];return a.ag(O,O,F),new a.P(O[0]/O[3],O[1]/O[3])}getBounds(){const A=Math.max(0,this.height/2-this.getHorizon());return new Ri().extend(this.pointLocation(new a.P(0,A))).extend(this.pointLocation(new a.P(this.width,A))).extend(this.pointLocation(new a.P(this.width,this.height))).extend(this.pointLocation(new a.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Ri([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(A){A?(this.lngRange=[A.getWest(),A.getEast()],this.latRange=[A.getSouth(),A.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(A,E=!1){const F=A.key,O=E?this._alignedPosMatrixCache:this._posMatrixCache;if(O[F])return O[F];const y=A.canonical,s=this.worldSize/this.zoomScale(y.z),i=y.x+Math.pow(2,y.z)*A.wrap,r=a.ao(new Float64Array(16));return a.$(r,r,[i*s,y.y*s,0]),a.a0(r,r,[s/a.N,s/a.N,1]),a.a1(r,E?this.alignedProjMatrix:this.projMatrix,r),O[F]=new Float32Array(r),O[F]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let A,E,F,O,y=-90,s=90,i=-180,r=180;const l=this.size,d=this._unmodified;if(this.latRange){const T=this.latRange;y=a.H(T[1])*this.worldSize,s=a.H(T[0])*this.worldSize,A=s-y<l.y?l.y/(s-y):0}if(this.lngRange){const T=this.lngRange;i=a.b5(a.G(T[0])*this.worldSize,0,this.worldSize),r=a.b5(a.G(T[1])*this.worldSize,0,this.worldSize),r<i&&(r+=this.worldSize),E=r-i<l.x?l.x/(r-i):0}const _=this.point,w=Math.max(E||0,A||0);if(w)return this.center=this.unproject(new a.P(E?(r+i)/2:_.x,A?(s+y)/2:_.y)),this.zoom+=this.scaleZoom(w),this._unmodified=d,void(this._constraining=!1);if(this.latRange){const T=_.y,B=l.y/2;T-B<y&&(O=y+B),T+B>s&&(O=s-B)}if(this.lngRange){const T=(i+r)/2,B=a.b5(_.x,T-this.worldSize/2,T+this.worldSize/2),j=l.x/2;B-j<i&&(F=i+j),B+j>r&&(F=r-j)}F===void 0&&O===void 0||(this.center=this.unproject(new a.P(F!==void 0?F:_.x,O!==void 0?O:_.y)).wrap()),this._unmodified=d,this._constraining=!1}_calcMatrices(){if(!this.height)return;const A=this.centerOffset,E=this.point.x,F=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=a.b7(1,this.center.lat)*this.worldSize;let O=a.ao(new Float64Array(16));a.a0(O,O,[this.width/2,-this.height/2,1]),a.$(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=a.ao(new Float64Array(16)),a.a0(O,O,[1,-1,1]),a.$(O,O,[-1,-1,0]),a.a0(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O;const y=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),s=Math.min(this.elevation,this._minEleveationForCurrentTile),i=y-s*this._pixelPerMeter/Math.cos(this._pitch),r=s<0?i:y,l=Math.PI/2+this._pitch,d=this._fov*(.5+A.y/this.height),_=Math.sin(d)*r/Math.sin(a.ad(Math.PI-l-d,.01,Math.PI-.01)),w=this.getHorizon(),T=2*Math.atan(w/this.cameraToCenterDistance)*(.5+A.y/(2*w)),B=Math.sin(T)*r/Math.sin(a.ad(Math.PI-l-T,.01,Math.PI-.01)),j=Math.min(_,B),X=1.01*(Math.cos(Math.PI/2-this._pitch)*j+r),ue=this.height/50;O=new Float64Array(16),a.b8(O,this._fov,this.width/this.height,ue,X),O[8]=2*-A.x/this.width,O[9]=2*A.y/this.height,a.a0(O,O,[1,-1,1]),a.$(O,O,[0,0,-this.cameraToCenterDistance]),a.b9(O,O,this._pitch),a.ae(O,O,this.angle),a.$(O,O,[-E,-F,0]),this.mercatorMatrix=a.a0([],O,[this.worldSize,this.worldSize,this.worldSize]),a.a0(O,O,[1,1,this._pixelPerMeter]),this.pixelMatrix=a.a1(new Float64Array(16),this.labelPlaneMatrix,O),a.$(O,O,[0,0,-this.elevation]),this.projMatrix=O,this.invProjMatrix=a.as([],O),this.pixelMatrix3D=a.a1(new Float64Array(16),this.labelPlaneMatrix,O);const Se=this.width%2/2,Te=this.height%2/2,Re=Math.cos(this.angle),Be=Math.sin(this.angle),et=E-Math.round(E)+Re*Se+Be*Te,vt=F-Math.round(F)+Re*Te+Be*Se,ot=new Float64Array(O);if(a.$(ot,ot,[et>.5?et-1:et,vt>.5?vt-1:vt,0]),this.alignedProjMatrix=ot,O=a.as(new Float64Array(16),this.pixelMatrix),!O)throw new Error("failed to invert matrix");this.pixelMatrixInverse=O,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const A=this.pointCoordinate(new a.P(0,0)),E=[A.x*this.worldSize,A.y*this.worldSize,0,1];return a.ag(E,E,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const A=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,A))}getCameraQueryGeometry(A){const E=this.getCameraPoint();if(A.length===1)return[A[0],E];{let F=E.x,O=E.y,y=E.x,s=E.y;for(const i of A)F=Math.min(F,i.x),O=Math.min(O,i.y),y=Math.max(y,i.x),s=Math.max(s,i.y);return[new a.P(F,O),new a.P(y,O),new a.P(y,s),new a.P(F,s),new a.P(F,O)]}}}function Ea(Z,A){let E,F=!1,O=null,y=null;const s=()=>{O=null,F&&(Z.apply(y,E),O=setTimeout(s,A),F=!1)};return(...i)=>(F=!0,y=this,E=i,O||s(),O)}class Pa{constructor(A){this._getCurrentHash=()=>{const E=window.location.hash.replace("#","");if(this._hashName){let F;return E.split("&").map(O=>O.split("=")).forEach(O=>{O[0]===this._hashName&&(F=O)}),(F&&F[1]||"").split("/")}return E.split("/")},this._onHashChange=()=>{const E=this._getCurrentHash();if(E.length>=3&&!E.some(F=>isNaN(F))){const F=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(E[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+E[2],+E[1]],zoom:+E[0],bearing:F,pitch:+(E[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const E=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,E)}catch{}},this._updateHash=Ea(this._updateHashUnthrottled,300),this._hashName=A&&encodeURIComponent(A)}addTo(A){return this._map=A,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(A){const E=this._map.getCenter(),F=Math.round(100*this._map.getZoom())/100,O=Math.ceil((F*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,O),s=Math.round(E.lng*y)/y,i=Math.round(E.lat*y)/y,r=this._map.getBearing(),l=this._map.getPitch();let d="";if(d+=A?`/${s}/${i}/${F}`:`${F}/${i}/${s}`,(r||l)&&(d+="/"+Math.round(10*r)/10),l&&(d+=`/${Math.round(l)}`),this._hashName){const _=this._hashName;let w=!1;const T=window.location.hash.slice(1).split("&").map(B=>{const j=B.split("=")[0];return j===_?(w=!0,`${j}=${d}`):B}).filter(B=>B);return w||T.push(`${_}=${d}`),`#${T.join("&")}`}return`#${d}`}}const Ka={linearity:.3,easing:a.ba(0,0,.3,1)},cl=a.e({deceleration:2500,maxSpeed:1400},Ka),lu=a.e({deceleration:20,maxSpeed:1400},Ka),gl=a.e({deceleration:1e3,maxSpeed:360},Ka),ao=a.e({deceleration:1e3,maxSpeed:90},Ka);class pi{constructor(A){this._map=A,this.clear()}clear(){this._inertiaBuffer=[]}record(A){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.h.now(),settings:A})}_drainInertiaBuffer(){const A=this._inertiaBuffer,E=a.h.now();for(;A.length>0&&E-A[0].time>160;)A.shift()}_onMoveEnd(A){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const E={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)E.zoom+=y.zoomDelta||0,E.bearing+=y.bearingDelta||0,E.pitch+=y.pitchDelta||0,y.panDelta&&E.pan._add(y.panDelta),y.around&&(E.around=y.around),y.pinchAround&&(E.pinchAround=y.pinchAround);const F=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,O={};if(E.pan.mag()){const y=Pi(E.pan.mag(),F,a.e({},cl,A||{}));O.offset=E.pan.mult(y.amount/E.pan.mag()),O.center=this._map.transform.center,Vi(O,y)}if(E.zoom){const y=Pi(E.zoom,F,lu);O.zoom=this._map.transform.zoom+y.amount,Vi(O,y)}if(E.bearing){const y=Pi(E.bearing,F,gl);O.bearing=this._map.transform.bearing+a.ad(y.amount,-179,179),Vi(O,y)}if(E.pitch){const y=Pi(E.pitch,F,ao);O.pitch=this._map.transform.pitch+y.amount,Vi(O,y)}if(O.zoom||O.bearing){const y=E.pinchAround===void 0?E.around:E.pinchAround;O.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),a.e(O,{noMoveStart:!0})}}function Vi(Z,A){(!Z.duration||Z.duration<A.duration)&&(Z.duration=A.duration,Z.easing=A.easing)}function Pi(Z,A,E){const{maxSpeed:F,linearity:O,deceleration:y}=E,s=a.ad(Z*O/(A/1e3),-F,F),i=Math.abs(s)/(y*O);return{easing:E.easing,duration:1e3*i,amount:s*(i/2)}}class Ft extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(A,E,F,O={}){const y=W.mousePos(E.getCanvasContainer(),F),s=E.unproject(y);super(A,a.e({point:y,lngLat:s,originalEvent:F},O)),this._defaultPrevented=!1,this.target=E}}class ni extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(A,E,F){const O=A==="touchend"?F.changedTouches:F.touches,y=W.touchPos(E.getCanvasContainer(),O),s=y.map(r=>E.unproject(r)),i=y.reduce((r,l,d,_)=>r.add(l.div(_.length)),new a.P(0,0));super(A,{points:y,point:i,lngLats:s,lngLat:E.unproject(i),originalEvent:F}),this._defaultPrevented=!1}}class xi extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(A,E,F){super(A,{originalEvent:F}),this._defaultPrevented=!1}}class Fi{constructor(A,E){this._map=A,this._clickTolerance=E.clickTolerance}reset(){delete this._mousedownPos}wheel(A){return this._firePreventable(new xi(A.type,this._map,A))}mousedown(A,E){return this._mousedownPos=E,this._firePreventable(new Ft(A.type,this._map,A))}mouseup(A){this._map.fire(new Ft(A.type,this._map,A))}click(A,E){this._mousedownPos&&this._mousedownPos.dist(E)>=this._clickTolerance||this._map.fire(new Ft(A.type,this._map,A))}dblclick(A){return this._firePreventable(new Ft(A.type,this._map,A))}mouseover(A){this._map.fire(new Ft(A.type,this._map,A))}mouseout(A){this._map.fire(new Ft(A.type,this._map,A))}touchstart(A){return this._firePreventable(new ni(A.type,this._map,A))}touchmove(A){this._map.fire(new ni(A.type,this._map,A))}touchend(A){this._map.fire(new ni(A.type,this._map,A))}touchcancel(A){this._map.fire(new ni(A.type,this._map,A))}_firePreventable(A){if(this._map.fire(A),A.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ln{constructor(A){this._map=A}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(A){this._map.fire(new Ft(A.type,this._map,A))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ft("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(A){this._delayContextMenu?this._contextMenuEvent=A:this._ignoreContextMenu||this._map.fire(new Ft(A.type,this._map,A)),this._map.listens("contextmenu")&&A.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class jn{constructor(A){this._map=A}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(A){return this.transform.pointLocation(a.P.convert(A),this._map.terrain)}}class or{constructor(A,E){this._map=A,this._tr=new jn(A),this._el=A.getCanvasContainer(),this._container=A.getContainer(),this._clickTolerance=E.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(A,E){this.isEnabled()&&A.shiftKey&&A.button===0&&(W.disableDrag(),this._startPos=this._lastPos=E,this._active=!0)}mousemoveWindow(A,E){if(!this._active)return;const F=E;if(this._lastPos.equals(F)||!this._box&&F.dist(this._startPos)<this._clickTolerance)return;const O=this._startPos;this._lastPos=F,this._box||(this._box=W.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",A));const y=Math.min(O.x,F.x),s=Math.max(O.x,F.x),i=Math.min(O.y,F.y),r=Math.max(O.y,F.y);W.setTransform(this._box,`translate(${y}px,${i}px)`),this._box.style.width=s-y+"px",this._box.style.height=r-i+"px"}mouseupWindow(A,E){if(!this._active||A.button!==0)return;const F=this._startPos,O=E;if(this.reset(),W.suppressClick(),F.x!==O.x||F.y!==O.y)return this._map.fire(new a.k("boxzoomend",{originalEvent:A})),{cameraAnimation:y=>y.fitScreenCoordinates(F,O,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",A)}keydown(A){this._active&&A.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",A))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(W.remove(this._box),this._box=null),W.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(A,E){return this._map.fire(new a.k(A,{originalEvent:E}))}}function Xn(Z,A){if(Z.length!==A.length)throw new Error(`The number of touches and points are not equal - touches ${Z.length}, points ${A.length}`);const E={};for(let F=0;F<Z.length;F++)E[Z[F].identifier]=A[F];return E}class Hs{constructor(A){this.reset(),this.numTouches=A.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(A,E,F){(this.centroid||F.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=A.timeStamp),F.length===this.numTouches&&(this.centroid=function(O){const y=new a.P(0,0);for(const s of O)y._add(s);return y.div(O.length)}(E),this.touches=Xn(F,E)))}touchmove(A,E,F){if(this.aborted||!this.centroid)return;const O=Xn(F,E);for(const y in this.touches){const s=O[y];(!s||s.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(A,E,F){if((!this.centroid||A.timeStamp-this.startTime>500)&&(this.aborted=!0),F.length===0){const O=!this.aborted&&this.centroid;if(this.reset(),O)return O}}}class Ps{constructor(A){this.singleTap=new Hs(A),this.numTaps=A.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(A,E,F){this.singleTap.touchstart(A,E,F)}touchmove(A,E,F){this.singleTap.touchmove(A,E,F)}touchend(A,E,F){const O=this.singleTap.touchend(A,E,F);if(O){const y=A.timeStamp-this.lastTime<500,s=!this.lastTap||this.lastTap.dist(O)<30;if(y&&s||this.reset(),this.count++,this.lastTime=A.timeStamp,this.lastTap=O,this.count===this.numTaps)return this.reset(),O}}}class ps{constructor(A){this._tr=new jn(A),this._zoomIn=new Ps({numTouches:1,numTaps:2}),this._zoomOut=new Ps({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(A,E,F){this._zoomIn.touchstart(A,E,F),this._zoomOut.touchstart(A,E,F)}touchmove(A,E,F){this._zoomIn.touchmove(A,E,F),this._zoomOut.touchmove(A,E,F)}touchend(A,E,F){const O=this._zoomIn.touchend(A,E,F),y=this._zoomOut.touchend(A,E,F),s=this._tr;return O?(this._active=!0,A.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:i=>i.easeTo({duration:300,zoom:s.zoom+1,around:s.unproject(O)},{originalEvent:A})}):y?(this._active=!0,A.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:i=>i.easeTo({duration:300,zoom:s.zoom-1,around:s.unproject(y)},{originalEvent:A})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ja{constructor(A){this._enabled=!!A.enable,this._moveStateManager=A.moveStateManager,this._clickTolerance=A.clickTolerance||1,this._moveFunction=A.move,this._activateOnStart=!!A.activateOnStart,A.assignEvents(this),this.reset()}reset(A){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(A)}_move(...A){const E=this._moveFunction(...A);if(E.bearingDelta||E.pitchDelta||E.around||E.panDelta)return this._active=!0,E}dragStart(A,E){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(A)&&(this._moveStateManager.startMove(A),this._lastPoint=E.length?E[0]:E,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(A,E){if(!this.isEnabled())return;const F=this._lastPoint;if(!F)return;if(A.preventDefault(),!this._moveStateManager.isValidMoveEvent(A))return void this.reset(A);const O=E.length?E[0]:E;return!this._moved&&O.dist(F)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=O,this._move(F,O))}dragEnd(A){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(A)&&(this._moved&&W.suppressClick(),this.reset(A))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const yo={0:1,2:2};class os{constructor(A){this._correctEvent=A.checkCorrectEvent}startMove(A){const E=W.mouseButton(A);this._eventButton=E}endMove(A){delete this._eventButton}isValidStartEvent(A){return this._correctEvent(A)}isValidMoveEvent(A){return!function(E,F){const O=yo[F];return E.buttons===void 0||(E.buttons&O)!==O}(A,this._eventButton)}isValidEndEvent(A){return W.mouseButton(A)===this._eventButton}}class $u{constructor(){this._firstTouch=void 0}_isOneFingerTouch(A){return A.targetTouches.length===1}_isSameTouchEvent(A){return A.targetTouches[0].identifier===this._firstTouch}startMove(A){this._firstTouch=A.targetTouches[0].identifier}endMove(A){delete this._firstTouch}isValidStartEvent(A){return this._isOneFingerTouch(A)}isValidMoveEvent(A){return this._isOneFingerTouch(A)&&this._isSameTouchEvent(A)}isValidEndEvent(A){return this._isOneFingerTouch(A)&&this._isSameTouchEvent(A)}}const Fu=Z=>{Z.mousedown=Z.dragStart,Z.mousemoveWindow=Z.dragMove,Z.mouseup=Z.dragEnd,Z.contextmenu=function(A){A.preventDefault()}},vo=({enable:Z,clickTolerance:A,bearingDegreesPerPixelMoved:E=.8})=>{const F=new os({checkCorrectEvent:O=>W.mouseButton(O)===0&&O.ctrlKey||W.mouseButton(O)===2});return new Ja({clickTolerance:A,move:(O,y)=>({bearingDelta:(y.x-O.x)*E}),moveStateManager:F,enable:Z,assignEvents:Fu})},Ml=({enable:Z,clickTolerance:A,pitchDegreesPerPixelMoved:E=-.5})=>{const F=new os({checkCorrectEvent:O=>W.mouseButton(O)===0&&O.ctrlKey||W.mouseButton(O)===2});return new Ja({clickTolerance:A,move:(O,y)=>({pitchDelta:(y.y-O.y)*E}),moveStateManager:F,enable:Z,assignEvents:Fu})};class Pn{constructor(A,E){this._minTouches=A.cooperativeGestures?2:1,this._clickTolerance=A.clickTolerance||1,this._map=E,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(A,E,F){return this._calculateTransform(A,E,F)}touchmove(A,E,F){if(this._map._cooperativeGestures&&(this._minTouches===2&&F.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(A,!1,F.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(F.length<this._minTouches))return A.preventDefault(),this._calculateTransform(A,E,F)}touchend(A,E,F){this._calculateTransform(A,E,F),this._active&&F.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(A,E,F){F.length>0&&(this._active=!0);const O=Xn(F,E),y=new a.P(0,0),s=new a.P(0,0);let i=0;for(const l in O){const d=O[l],_=this._touches[l];_&&(y._add(d),s._add(d.sub(_)),i++,O[l]=d)}if(this._touches=O,i<this._minTouches||!s.mag())return;const r=s.div(i);return this._sum._add(r),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(i),panDelta:r}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Da{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(A,E,F){this._firstTwoTouches||F.length<2||(this._firstTwoTouches=[F[0].identifier,F[1].identifier],this._start([E[0],E[1]]))}touchmove(A,E,F){if(!this._firstTwoTouches)return;A.preventDefault();const[O,y]=this._firstTwoTouches,s=In(F,E,O),i=In(F,E,y);if(!s||!i)return;const r=this._aroundCenter?null:s.add(i).div(2);return this._move([s,i],r,A)}touchend(A,E,F){if(!this._firstTwoTouches)return;const[O,y]=this._firstTwoTouches,s=In(F,E,O),i=In(F,E,y);s&&i||(this._active&&W.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(A){this._enabled=!0,this._aroundCenter=!!A&&A.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function In(Z,A,E){for(let F=0;F<Z.length;F++)if(Z[F].identifier===E)return A[F]}function No(Z,A){return Math.log(Z/A)/Math.LN2}class Nl extends Da{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(A){this._startDistance=this._distance=A[0].dist(A[1])}_move(A,E){const F=this._distance;if(this._distance=A[0].dist(A[1]),this._active||!(Math.abs(No(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:No(this._distance,F),pinchAround:E}}}function En(Z,A){return 180*Z.angleWith(A)/Math.PI}class $l extends Da{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(A){this._startVector=this._vector=A[0].sub(A[1]),this._minDiameter=A[0].dist(A[1])}_move(A,E){const F=this._vector;if(this._vector=A[0].sub(A[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:En(this._vector,F),pinchAround:E}}_isBelowThreshold(A){this._minDiameter=Math.min(this._minDiameter,A.mag());const E=25/(Math.PI*this._minDiameter)*360,F=En(A,this._startVector);return Math.abs(F)<E}}function Cn(Z){return Math.abs(Z.y)>Math.abs(Z.x)}class _l extends Da{constructor(A){super(),this._map=A}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(A,E,F){super.touchstart(A,E,F),this._currentTouchCount=F.length}_start(A){this._lastPoints=A,Cn(A[0].sub(A[1]))&&(this._valid=!1)}_move(A,E,F){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const O=A[0].sub(this._lastPoints[0]),y=A[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(O,y,F.timeStamp),this._valid?(this._lastPoints=A,this._active=!0,{pitchDelta:(O.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(A,E,F){if(this._valid!==void 0)return this._valid;const O=A.mag()>=2,y=E.mag()>=2;if(!O&&!y)return;if(!O||!y)return this._firstMove===void 0&&(this._firstMove=F),F-this._firstMove<100&&void 0;const s=A.y>0==E.y>0;return Cn(A)&&Cn(E)&&s}}const uu={panStep:100,bearingStep:15,pitchStep:10};class Ou{constructor(A){this._tr=new jn(A);const E=uu;this._panStep=E.panStep,this._bearingStep=E.bearingStep,this._pitchStep=E.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(A){if(A.altKey||A.ctrlKey||A.metaKey)return;let E=0,F=0,O=0,y=0,s=0;switch(A.keyCode){case 61:case 107:case 171:case 187:E=1;break;case 189:case 109:case 173:E=-1;break;case 37:A.shiftKey?F=-1:(A.preventDefault(),y=-1);break;case 39:A.shiftKey?F=1:(A.preventDefault(),y=1);break;case 38:A.shiftKey?O=1:(A.preventDefault(),s=-1);break;case 40:A.shiftKey?O=-1:(A.preventDefault(),s=1);break;default:return}return this._rotationDisabled&&(F=0,O=0),{cameraAnimation:i=>{const r=this._tr;i.easeTo({duration:300,easeId:"keyboardHandler",easing:Vl,zoom:E?Math.round(r.zoom)+E*(A.shiftKey?2:1):r.zoom,bearing:r.bearing+F*this._bearingStep,pitch:r.pitch+O*this._pitchStep,offset:[-y*this._panStep,-s*this._panStep],center:r.center},{originalEvent:A})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Vl(Z){return Z*(2-Z)}const yl=4.000244140625;class ta{constructor(A,E){this._onTimeout=F=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(F)},this._map=A,this._tr=new jn(A),this._el=A.getCanvasContainer(),this._triggerRenderFrame=E,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(A){this._defaultZoomRate=A}setWheelZoomRate(A){this._wheelZoomRate=A}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(A){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!A&&A.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(A){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!A[this._map._metaKey])return;A.preventDefault()}let E=A.deltaMode===WheelEvent.DOM_DELTA_LINE?40*A.deltaY:A.deltaY;const F=a.h.now(),O=F-(this._lastWheelEventTime||0);this._lastWheelEventTime=F,E!==0&&E%yl==0?this._type="wheel":E!==0&&Math.abs(E)<4?this._type="trackpad":O>400?(this._type=null,this._lastValue=E,this._timeout=setTimeout(this._onTimeout,40,A)):this._type||(this._type=Math.abs(O*E)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,E+=this._lastValue)),A.shiftKey&&E&&(E/=4),this._type&&(this._lastWheelEvent=A,this._delta-=E,this._active||this._start(A)),A.preventDefault()}_start(A){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const E=W.mousePos(this._el,A),F=this._tr;this._around=a.L.convert(this._aroundCenter?F.center:F.unproject(E)),this._aroundPoint=F.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const A=this._tr.transform;if(this._delta!==0){const i=this._type==="wheel"&&Math.abs(this._delta)>yl?this._wheelZoomRate:this._defaultZoomRate;let r=2/(1+Math.exp(-Math.abs(this._delta*i)));this._delta<0&&r!==0&&(r=1/r);const l=typeof this._targetZoom=="number"?A.zoomScale(this._targetZoom):A.scale;this._targetZoom=Math.min(A.maxZoom,Math.max(A.minZoom,A.scaleZoom(l*r))),this._type==="wheel"&&(this._startZoom=A.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const E=typeof this._targetZoom=="number"?this._targetZoom:A.zoom,F=this._startZoom,O=this._easing;let y,s=!1;if(this._type==="wheel"&&F&&O){const i=Math.min((a.h.now()-this._lastWheelEventTime)/200,1),r=O(i);y=a.B.number(F,E,r),i<1?this._frameId||(this._frameId=!0):s=!0}else y=E,s=!0;return this._active=!0,s&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!s,zoomDelta:y-A.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(A){let E=a.bb;if(this._prevEase){const F=this._prevEase,O=(a.h.now()-F.start)/F.duration,y=F.easing(O+.01)-F.easing(O),s=.27/Math.sqrt(y*y+1e-4)*.01,i=Math.sqrt(.0729-s*s);E=a.ba(s,i,.25,1)}return this._prevEase={start:a.h.now(),duration:A,easing:E},E}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class oc{constructor(A,E){this._clickZoom=A,this._tapZoom=E}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Xu{constructor(A){this._tr=new jn(A),this.reset()}reset(){this._active=!1}dblclick(A,E){return A.preventDefault(),{cameraAnimation:F=>{F.easeTo({duration:300,zoom:this._tr.zoom+(A.shiftKey?-1:1),around:this._tr.unproject(E)},{originalEvent:A})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xl{constructor(){this._tap=new Ps({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(A,E,F){if(!this._swipePoint)if(this._tapTime){const O=E[0],y=A.timeStamp-this._tapTime<500,s=this._tapPoint.dist(O)<30;y&&s?F.length>0&&(this._swipePoint=O,this._swipeTouch=F[0].identifier):this.reset()}else this._tap.touchstart(A,E,F)}touchmove(A,E,F){if(this._tapTime){if(this._swipePoint){if(F[0].identifier!==this._swipeTouch)return;const O=E[0],y=O.y-this._swipePoint.y;return this._swipePoint=O,A.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(A,E,F)}touchend(A,E,F){if(this._tapTime)this._swipePoint&&F.length===0&&this.reset();else{const O=this._tap.touchend(A,E,F);O&&(this._tapTime=A.timeStamp,this._tapPoint=O)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ms{constructor(A,E,F){this._el=A,this._mousePan=E,this._touchPan=F}enable(A){this._inertiaOptions=A||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class _a{constructor(A,E,F){this._pitchWithRotate=A.pitchWithRotate,this._mouseRotate=E,this._mousePitch=F}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class el{constructor(A,E,F,O){this._el=A,this._touchZoom=E,this._touchRotate=F,this._tapDragZoom=O,this._rotationDisabled=!1,this._enabled=!0}enable(A){this._touchZoom.enable(A),this._rotationDisabled||this._touchRotate.enable(A),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const _u=Z=>Z.zoom||Z.drag||Z.pitch||Z.rotate;class Nu extends a.k{}function cu(Z){return Z.panDelta&&Z.panDelta.mag()||Z.zoomDelta||Z.bearingDelta||Z.pitchDelta}class Vu{constructor(A,E){this.handleWindowEvent=O=>{this.handleEvent(O,`${O.type}Window`)},this.handleEvent=(O,y)=>{if(O.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const s=O.type==="renderFrame"?void 0:O,i={needsRenderFrame:!1},r={},l={},d=O.touches,_=d?this._getMapTouches(d):void 0,w=_?W.touchPos(this._el,_):W.mousePos(this._el,O);for(const{handlerName:j,handler:X,allowed:ue}of this._handlers){if(!X.isEnabled())continue;let Se;this._blockedByActive(l,ue,j)?X.reset():X[y||O.type]&&(Se=X[y||O.type](O,w,_),this.mergeHandlerResult(i,r,Se,j,s),Se&&Se.needsRenderFrame&&this._triggerRenderFrame()),(Se||X.isActive())&&(l[j]=X)}const T={};for(const j in this._previousActiveHandlers)l[j]||(T[j]=s);this._previousActiveHandlers=l,(Object.keys(T).length||cu(i))&&(this._changes.push([i,r,T]),this._triggerRenderFrame()),(Object.keys(l).length||cu(i))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:B}=i;B&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],B(this._map))},this._map=A,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new pi(A),this._bearingSnap=E.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(E);const F=this._el;this._listeners=[[F,"touchstart",{passive:!0}],[F,"touchmove",{passive:!1}],[F,"touchend",void 0],[F,"touchcancel",void 0],[F,"mousedown",void 0],[F,"mousemove",void 0],[F,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[F,"mouseover",void 0],[F,"mouseout",void 0],[F,"dblclick",void 0],[F,"click",void 0],[F,"keydown",{capture:!1}],[F,"keyup",void 0],[F,"wheel",{passive:!1}],[F,"contextmenu",void 0],[window,"blur",void 0]];for(const[O,y,s]of this._listeners)W.addEventListener(O,y,O===document?this.handleWindowEvent:this.handleEvent,s)}destroy(){for(const[A,E,F]of this._listeners)W.removeEventListener(A,E,A===document?this.handleWindowEvent:this.handleEvent,F)}_addDefaultHandlers(A){const E=this._map,F=E.getCanvasContainer();this._add("mapEvent",new Fi(E,A));const O=E.boxZoom=new or(E,A);this._add("boxZoom",O),A.interactive&&A.boxZoom&&O.enable();const y=new ps(E),s=new Xu(E);E.doubleClickZoom=new oc(s,y),this._add("tapZoom",y),this._add("clickZoom",s),A.interactive&&A.doubleClickZoom&&E.doubleClickZoom.enable();const i=new Xl;this._add("tapDragZoom",i);const r=E.touchPitch=new _l(E);this._add("touchPitch",r),A.interactive&&A.touchPitch&&E.touchPitch.enable(A.touchPitch);const l=vo(A),d=Ml(A);E.dragRotate=new _a(A,l,d),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",d,["mouseRotate"]),A.interactive&&A.dragRotate&&E.dragRotate.enable();const _=(({enable:ue,clickTolerance:Se})=>{const Te=new os({checkCorrectEvent:Re=>W.mouseButton(Re)===0&&!Re.ctrlKey});return new Ja({clickTolerance:Se,move:(Re,Be)=>({around:Be,panDelta:Be.sub(Re)}),activateOnStart:!0,moveStateManager:Te,enable:ue,assignEvents:Fu})})(A),w=new Pn(A,E);E.dragPan=new ms(F,_,w),this._add("mousePan",_),this._add("touchPan",w,["touchZoom","touchRotate"]),A.interactive&&A.dragPan&&E.dragPan.enable(A.dragPan);const T=new $l,B=new Nl;E.touchZoomRotate=new el(F,B,T,i),this._add("touchRotate",T,["touchPan","touchZoom"]),this._add("touchZoom",B,["touchPan","touchRotate"]),A.interactive&&A.touchZoomRotate&&E.touchZoomRotate.enable(A.touchZoomRotate);const j=E.scrollZoom=new ta(E,()=>this._triggerRenderFrame());this._add("scrollZoom",j,["mousePan"]),A.interactive&&A.scrollZoom&&E.scrollZoom.enable(A.scrollZoom);const X=E.keyboard=new Ou(E);this._add("keyboard",X),A.interactive&&A.keyboard&&E.keyboard.enable(),this._add("blockableMapEvent",new Ln(E))}_add(A,E,F){this._handlers.push({handlerName:A,handler:E,allowed:F}),this._handlersById[A]=E}stop(A){if(!this._updatingCamera){for(const{handler:E}of this._handlers)E.reset();this._inertia.clear(),this._fireEvents({},{},A),this._changes=[]}}isActive(){for(const{handler:A}of this._handlers)if(A.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!_u(this._eventsInProgress)||this.isZooming()}_blockedByActive(A,E,F){for(const O in A)if(O!==F&&(!E||E.indexOf(O)<0))return!0;return!1}_getMapTouches(A){const E=[];for(const F of A)this._el.contains(F.target)&&E.push(F);return E}mergeHandlerResult(A,E,F,O,y){if(!F)return;a.e(A,F);const s={handlerName:O,originalEvent:F.originalEvent||y};F.zoomDelta!==void 0&&(E.zoom=s),F.panDelta!==void 0&&(E.drag=s),F.pitchDelta!==void 0&&(E.pitch=s),F.bearingDelta!==void 0&&(E.rotate=s)}_applyChanges(){const A={},E={},F={};for(const[O,y,s]of this._changes)O.panDelta&&(A.panDelta=(A.panDelta||new a.P(0,0))._add(O.panDelta)),O.zoomDelta&&(A.zoomDelta=(A.zoomDelta||0)+O.zoomDelta),O.bearingDelta&&(A.bearingDelta=(A.bearingDelta||0)+O.bearingDelta),O.pitchDelta&&(A.pitchDelta=(A.pitchDelta||0)+O.pitchDelta),O.around!==void 0&&(A.around=O.around),O.pinchAround!==void 0&&(A.pinchAround=O.pinchAround),O.noInertia&&(A.noInertia=O.noInertia),a.e(E,y),a.e(F,s);this._updateMapTransform(A,E,F),this._changes=[]}_updateMapTransform(A,E,F){const O=this._map,y=O._getTransformForUpdate(),s=O.terrain;if(!(cu(A)||s&&this._terrainMovement))return this._fireEvents(E,F,!0);let{panDelta:i,zoomDelta:r,bearingDelta:l,pitchDelta:d,around:_,pinchAround:w}=A;w!==void 0&&(_=w),O._stop(!0),_=_||O.transform.centerPoint;const T=y.pointLocation(i?_.sub(i):_);l&&(y.bearing+=l),d&&(y.pitch+=d),r&&(y.zoom+=r),s?this._terrainMovement||!E.drag&&!E.zoom?E.drag&&this._terrainMovement?y.center=y.pointLocation(y.centerPoint.sub(i)):y.setLocationAtPoint(T,_):(this._terrainMovement=!0,this._map._elevationFreeze=!0,y.setLocationAtPoint(T,_),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,y.recalculateZoom(O.terrain)})):y.setLocationAtPoint(T,_),O._applyUpdatedTransform(y),this._map._update(),A.noInertia||this._inertia.record(A),this._fireEvents(E,F,!0)}_fireEvents(A,E,F){const O=_u(this._eventsInProgress),y=_u(A),s={};for(const d in A){const{originalEvent:_}=A[d];this._eventsInProgress[d]||(s[`${d}start`]=_),this._eventsInProgress[d]=A[d]}!O&&y&&this._fireEvent("movestart",y.originalEvent);for(const d in s)this._fireEvent(d,s[d]);y&&this._fireEvent("move",y.originalEvent);for(const d in A){const{originalEvent:_}=A[d];this._fireEvent(d,_)}const i={};let r;for(const d in this._eventsInProgress){const{handlerName:_,originalEvent:w}=this._eventsInProgress[d];this._handlersById[_].isActive()||(delete this._eventsInProgress[d],r=E[_]||w,i[`${d}end`]=r)}for(const d in i)this._fireEvent(d,i[d]);const l=_u(this._eventsInProgress);if(F&&(O||y)&&!l){this._updatingCamera=!0;const d=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),_=w=>w!==0&&-this._bearingSnap<w&&w<this._bearingSnap;!d||!d.essential&&a.h.prefersReducedMotion?(this._map.fire(new a.k("moveend",{originalEvent:r})),_(this._map.getBearing())&&this._map.resetNorth()):(_(d.bearing||this._map.getBearing())&&(d.bearing=0),d.freezeElevation=!0,this._map.easeTo(d,{originalEvent:r})),this._updatingCamera=!1}}_fireEvent(A,E){this._map.fire(new a.k(A,E?{originalEvent:E}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(A=>{delete this._frameId,this.handleEvent(new Nu("renderFrame",{timeStamp:A})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class yr extends a.E{constructor(A,E){super(),this._renderFrameCallback=()=>{const F=Math.min((a.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(F)),F<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=A,this._bearingSnap=E.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new a.L(this.transform.center.lng,this.transform.center.lat)}setCenter(A,E){return this.jumpTo({center:A},E)}panBy(A,E,F){return A=a.P.convert(A).mult(-1),this.panTo(this.transform.center,a.e({offset:A},E),F)}panTo(A,E,F){return this.easeTo(a.e({center:A},E),F)}getZoom(){return this.transform.zoom}setZoom(A,E){return this.jumpTo({zoom:A},E),this}zoomTo(A,E,F){return this.easeTo(a.e({zoom:A},E),F)}zoomIn(A,E){return this.zoomTo(this.getZoom()+1,A,E),this}zoomOut(A,E){return this.zoomTo(this.getZoom()-1,A,E),this}getBearing(){return this.transform.bearing}setBearing(A,E){return this.jumpTo({bearing:A},E),this}getPadding(){return this.transform.padding}setPadding(A,E){return this.jumpTo({padding:A},E),this}rotateTo(A,E,F){return this.easeTo(a.e({bearing:A},E),F)}resetNorth(A,E){return this.rotateTo(0,a.e({duration:1e3},A),E),this}resetNorthPitch(A,E){return this.easeTo(a.e({bearing:0,pitch:0,duration:1e3},A),E),this}snapToNorth(A,E){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(A,E):this}getPitch(){return this.transform.pitch}setPitch(A,E){return this.jumpTo({pitch:A},E),this}cameraForBounds(A,E){A=Ri.convert(A);const F=E&&E.bearing||0;return this._cameraForBoxAndBearing(A.getNorthWest(),A.getSouthEast(),F,E)}_cameraForBoxAndBearing(A,E,F,O){const y={top:0,bottom:0,right:0,left:0};if(typeof(O=a.e({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},O)).padding=="number"){const Be=O.padding;O.padding={top:Be,bottom:Be,right:Be,left:Be}}O.padding=a.e(y,O.padding);const s=this.transform,i=s.padding,r=s.project(a.L.convert(A)),l=s.project(a.L.convert(E)),d=r.rotate(-F*Math.PI/180),_=l.rotate(-F*Math.PI/180),w=new a.P(Math.max(d.x,_.x),Math.max(d.y,_.y)),T=new a.P(Math.min(d.x,_.x),Math.min(d.y,_.y)),B=w.sub(T),j=(s.width-(i.left+i.right+O.padding.left+O.padding.right))/B.x,X=(s.height-(i.top+i.bottom+O.padding.top+O.padding.bottom))/B.y;if(X<0||j<0)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ue=Math.min(s.scaleZoom(s.scale*Math.min(j,X)),O.maxZoom),Se=a.P.convert(O.offset),Te=new a.P((O.padding.left-O.padding.right)/2,(O.padding.top-O.padding.bottom)/2).rotate(F*Math.PI/180),Re=Se.add(Te).mult(s.scale/s.zoomScale(ue));return{center:s.unproject(r.add(l).div(2).sub(Re)),zoom:ue,bearing:F}}fitBounds(A,E,F){return this._fitInternal(this.cameraForBounds(A,E),E,F)}fitScreenCoordinates(A,E,F,O,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.P.convert(A)),this.transform.pointLocation(a.P.convert(E)),F,O),O,y)}_fitInternal(A,E,F){return A?(delete(E=a.e(A,E)).padding,E.linear?this.easeTo(E,F):this.flyTo(E,F)):this}jumpTo(A,E){this.stop();const F=this._getTransformForUpdate();let O=!1,y=!1,s=!1;return"zoom"in A&&F.zoom!==+A.zoom&&(O=!0,F.zoom=+A.zoom),A.center!==void 0&&(F.center=a.L.convert(A.center)),"bearing"in A&&F.bearing!==+A.bearing&&(y=!0,F.bearing=+A.bearing),"pitch"in A&&F.pitch!==+A.pitch&&(s=!0,F.pitch=+A.pitch),A.padding==null||F.isPaddingEqual(A.padding)||(F.padding=A.padding),this._applyUpdatedTransform(F),this.fire(new a.k("movestart",E)).fire(new a.k("move",E)),O&&this.fire(new a.k("zoomstart",E)).fire(new a.k("zoom",E)).fire(new a.k("zoomend",E)),y&&this.fire(new a.k("rotatestart",E)).fire(new a.k("rotate",E)).fire(new a.k("rotateend",E)),s&&this.fire(new a.k("pitchstart",E)).fire(new a.k("pitch",E)).fire(new a.k("pitchend",E)),this.fire(new a.k("moveend",E))}calculateCameraOptionsFromTo(A,E,F,O=0){const y=a.U.fromLngLat(A,E),s=a.U.fromLngLat(F,O),i=s.x-y.x,r=s.y-y.y,l=s.z-y.z,d=Math.hypot(i,r,l);if(d===0)throw new Error("Can't calculate camera options with same From and To");const _=Math.hypot(i,r),w=this.transform.scaleZoom(this.transform.cameraToCenterDistance/d/this.transform.tileSize),T=180*Math.atan2(i,-r)/Math.PI;let B=180*Math.acos(_/d)/Math.PI;return B=l<0?90-B:90+B,{center:s.toLngLat(),zoom:w,pitch:B,bearing:T}}easeTo(A,E){this._stop(!1,A.easeId),((A=a.e({offset:[0,0],duration:500,easing:a.bb},A)).animate===!1||!A.essential&&a.h.prefersReducedMotion)&&(A.duration=0);const F=this._getTransformForUpdate(),O=this.getZoom(),y=this.getBearing(),s=this.getPitch(),i=this.getPadding(),r="zoom"in A?+A.zoom:O,l="bearing"in A?this._normalizeBearing(A.bearing,y):y,d="pitch"in A?+A.pitch:s,_="padding"in A?A.padding:F.padding,w=a.P.convert(A.offset);let T=F.centerPoint.add(w);const B=F.pointLocation(T),j=a.L.convert(A.center||B);this._normalizeCenter(j);const X=F.project(B),ue=F.project(j).sub(X),Se=F.zoomScale(r-O);let Te,Re;A.around&&(Te=a.L.convert(A.around),Re=F.locationPoint(Te));const Be={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||r!==O,this._rotating=this._rotating||y!==l,this._pitching=this._pitching||d!==s,this._padding=!F.isPaddingEqual(_),this._easeId=A.easeId,this._prepareEase(E,A.noMoveStart,Be),this.terrain&&this._prepareElevation(j),this._ease(et=>{if(this._zooming&&(F.zoom=a.B.number(O,r,et)),this._rotating&&(F.bearing=a.B.number(y,l,et)),this._pitching&&(F.pitch=a.B.number(s,d,et)),this._padding&&(F.interpolatePadding(i,_,et),T=F.centerPoint.add(w)),this.terrain&&!A.freezeElevation&&this._updateElevation(et),Te)F.setLocationAtPoint(Te,Re);else{const vt=F.zoomScale(F.zoom-O),ot=r>O?Math.min(2,Se):Math.max(.5,Se),ht=Math.pow(ot,1-et),Et=F.unproject(X.add(ue.mult(et*ht)).mult(vt));F.setLocationAtPoint(F.renderWorldCopies?Et.wrap():Et,T)}this._applyUpdatedTransform(F),this._fireMoveEvents(E)},et=>{this.terrain&&this._finalizeElevation(),this._afterEase(E,et)},A),this}_prepareEase(A,E,F={}){this._moving=!0,E||F.moving||this.fire(new a.k("movestart",A)),this._zooming&&!F.zooming&&this.fire(new a.k("zoomstart",A)),this._rotating&&!F.rotating&&this.fire(new a.k("rotatestart",A)),this._pitching&&!F.pitching&&this.fire(new a.k("pitchstart",A))}_prepareElevation(A){this._elevationCenter=A,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(A,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(A){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const E=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(A<1&&E!==this._elevationTarget){const F=this._elevationTarget-this._elevationStart;this._elevationStart+=A*(F-(E-(F*A+this._elevationStart))/(1-A)),this._elevationTarget=E}this.transform.elevation=a.B.number(this._elevationStart,this._elevationTarget,A)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(A){if(!this.transformCameraUpdate)return;const E=A.clone(),{center:F,zoom:O,pitch:y,bearing:s,elevation:i}=this.transformCameraUpdate(E);F&&(E.center=F),O!==void 0&&(E.zoom=O),y!==void 0&&(E.pitch=y),s!==void 0&&(E.bearing=s),i!==void 0&&(E.elevation=i),this.transform.apply(E)}_fireMoveEvents(A){this.fire(new a.k("move",A)),this._zooming&&this.fire(new a.k("zoom",A)),this._rotating&&this.fire(new a.k("rotate",A)),this._pitching&&this.fire(new a.k("pitch",A))}_afterEase(A,E){if(this._easeId&&E&&this._easeId===E)return;delete this._easeId;const F=this._zooming,O=this._rotating,y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,F&&this.fire(new a.k("zoomend",A)),O&&this.fire(new a.k("rotateend",A)),y&&this.fire(new a.k("pitchend",A)),this.fire(new a.k("moveend",A))}flyTo(A,E){if(!A.essential&&a.h.prefersReducedMotion){const ai=a.F(A,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ai,E)}this.stop(),A=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.bb},A);const F=this._getTransformForUpdate(),O=this.getZoom(),y=this.getBearing(),s=this.getPitch(),i=this.getPadding(),r="zoom"in A?a.ad(+A.zoom,F.minZoom,F.maxZoom):O,l="bearing"in A?this._normalizeBearing(A.bearing,y):y,d="pitch"in A?+A.pitch:s,_="padding"in A?A.padding:F.padding,w=F.zoomScale(r-O),T=a.P.convert(A.offset);let B=F.centerPoint.add(T);const j=F.pointLocation(B),X=a.L.convert(A.center||j);this._normalizeCenter(X);const ue=F.project(j),Se=F.project(X).sub(ue);let Te=A.curve;const Re=Math.max(F.width,F.height),Be=Re/w,et=Se.mag();if("minZoom"in A){const ai=a.ad(Math.min(A.minZoom,O,r),F.minZoom,F.maxZoom),Zi=Re/F.zoomScale(ai-O);Te=Math.sqrt(Zi/et*2)}const vt=Te*Te;function ot(ai){const Zi=(Be*Be-Re*Re+(ai?-1:1)*vt*vt*et*et)/(2*(ai?Be:Re)*vt*et);return Math.log(Math.sqrt(Zi*Zi+1)-Zi)}function ht(ai){return(Math.exp(ai)-Math.exp(-ai))/2}function Et(ai){return(Math.exp(ai)+Math.exp(-ai))/2}const wt=ot(!1);let si=function(ai){return Et(wt)/Et(wt+Te*ai)},Kt=function(ai){return Re*((Et(wt)*(ht(Zi=wt+Te*ai)/Et(Zi))-ht(wt))/vt)/et;var Zi},ii=(ot(!0)-wt)/Te;if(Math.abs(et)<1e-6||!isFinite(ii)){if(Math.abs(Re-Be)<1e-6)return this.easeTo(A,E);const ai=Be<Re?-1:1;ii=Math.abs(Math.log(Be/Re))/Te,Kt=function(){return 0},si=function(Zi){return Math.exp(ai*Te*Zi)}}return A.duration="duration"in A?+A.duration:1e3*ii/("screenSpeed"in A?+A.screenSpeed/Te:+A.speed),A.maxDuration&&A.duration>A.maxDuration&&(A.duration=0),this._zooming=!0,this._rotating=y!==l,this._pitching=d!==s,this._padding=!F.isPaddingEqual(_),this._prepareEase(E,!1),this.terrain&&this._prepareElevation(X),this._ease(ai=>{const Zi=ai*ii,Qi=1/si(Zi);F.zoom=ai===1?r:O+F.scaleZoom(Qi),this._rotating&&(F.bearing=a.B.number(y,l,ai)),this._pitching&&(F.pitch=a.B.number(s,d,ai)),this._padding&&(F.interpolatePadding(i,_,ai),B=F.centerPoint.add(T)),this.terrain&&!A.freezeElevation&&this._updateElevation(ai);const Si=ai===1?X:F.unproject(ue.add(Se.mult(Kt(Zi))).mult(Qi));F.setLocationAtPoint(F.renderWorldCopies?Si.wrap():Si,B),this._applyUpdatedTransform(F),this._fireMoveEvents(E)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(E)},A),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(A,E){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const F=this._onEaseEnd;delete this._onEaseEnd,F.call(this,E)}if(!A){const F=this.handlers;F&&F.stop(!1)}return this}_ease(A,E,F){F.animate===!1||F.duration===0?(A(1),E()):(this._easeStart=a.h.now(),this._easeOptions=F,this._onEaseFrame=A,this._onEaseEnd=E,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(A,E){A=a.b5(A,-180,180);const F=Math.abs(A-E);return Math.abs(A-360-E)<F&&(A-=360),Math.abs(A+360-E)<F&&(A+=360),A}_normalizeCenter(A){const E=this.transform;if(!E.renderWorldCopies||E.lngRange)return;const F=A.lng-E.center.lng;A.lng+=F>180?-360:F<-180?360:0}queryTerrainElevation(A){return this.terrain?this.terrain.getElevationForLngLatZoom(a.L.convert(A),this.transform.tileZoom)-this.transform.elevation:null}}class gs{constructor(A={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=E=>{!E||E.sourceDataType!=="metadata"&&E.sourceDataType!=="visibility"&&E.dataType!=="style"&&E.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=A}getDefaultPosition(){return"bottom-right"}onAdd(A){return this._map=A,this._compact=this.options&&this.options.compact,this._container=W.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=W.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=W.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){W.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(A,E){const F=this._map._getUIString(`AttributionControl.${E}`);A.title=F,A.setAttribute("aria-label",F)}_updateAttributions(){if(!this._map.style)return;let A=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?A=A.concat(this.options.customAttribution.map(O=>typeof O!="string"?"":O)):typeof this.options.customAttribution=="string"&&A.push(this.options.customAttribution)),this._map.style.stylesheet){const O=this._map.style.stylesheet;this.styleOwner=O.owner,this.styleId=O.id}const E=this._map.style.sourceCaches;for(const O in E){const y=E[O];if(y.used||y.usedForTerrain){const s=y.getSource();s.attribution&&A.indexOf(s.attribution)<0&&A.push(s.attribution)}}A=A.filter(O=>String(O).trim()),A.sort((O,y)=>O.length-y.length),A=A.filter((O,y)=>{for(let s=y+1;s<A.length;s++)if(A[s].indexOf(O)>=0)return!1;return!0});const F=A.join(" | ");F!==this._attribHTML&&(this._attribHTML=F,A.length?(this._innerContainer.innerHTML=F,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class gn{constructor(A={}){this._updateCompact=()=>{const E=this._container.children;if(E.length){const F=E[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&F.classList.add("maplibregl-compact"):F.classList.remove("maplibregl-compact")}},this.options=A}getDefaultPosition(){return"bottom-left"}onAdd(A){this._map=A,this._compact=this.options&&this.options.compact,this._container=W.create("div","maplibregl-ctrl");const E=W.create("a","maplibregl-ctrl-logo");return E.target="_blank",E.rel="noopener nofollow",E.href="https://maplibre.org/",E.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),E.setAttribute("rel","noopener nofollow"),this._container.appendChild(E),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){W.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Zn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(A){const E=++this._id;return this._queue.push({callback:A,id:E,cancelled:!1}),E}remove(A){const E=this._currentlyRunning,F=E?this._queue.concat(E):this._queue;for(const O of F)if(O.id===A)return void(O.cancelled=!0)}run(A=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const E=this._currentlyRunning=this._queue;this._queue=[];for(const F of E)if(!F.cancelled&&(F.callback(A),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Jn={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var tl=a.Q([{name:"a_pos3d",type:"Int16",components:3}]);class Tu extends a.E{constructor(A){super(),this.sourceCache=A,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,A.usedForTerrain=!0,A.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(A,E){this.sourceCache.update(A,E),this._renderableTilesKeys=[];const F={};for(const O of A.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:E}))F[O.key]=!0,this._renderableTilesKeys.push(O.key),this._tiles[O.key]||(O.posMatrix=new Float64Array(16),a.aS(O.posMatrix,0,a.N,0,a.N,0,1),this._tiles[O.key]=new Ji(O,this.tileSize));for(const O in this._tiles)F[O]||delete this._tiles[O]}freeRtt(A){for(const E in this._tiles){const F=this._tiles[E];(!A||F.tileID.equals(A)||F.tileID.isChildOf(A)||A.isChildOf(F.tileID))&&(F.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(A=>this.getTileByID(A))}getTileByID(A){return this._tiles[A]}getTerrainCoords(A){const E={};for(const F of this._renderableTilesKeys){const O=this._tiles[F].tileID;if(O.canonical.equals(A.canonical)){const y=A.clone();y.posMatrix=new Float64Array(16),a.aS(y.posMatrix,0,a.N,0,a.N,0,1),E[F]=y}else if(O.canonical.isChildOf(A.canonical)){const y=A.clone();y.posMatrix=new Float64Array(16);const s=O.canonical.z-A.canonical.z,i=O.canonical.x-(O.canonical.x>>s<<s),r=O.canonical.y-(O.canonical.y>>s<<s),l=a.N>>s;a.aS(y.posMatrix,0,l,0,l,0,1),a.$(y.posMatrix,y.posMatrix,[-i*l,-r*l,0]),E[F]=y}else if(A.canonical.isChildOf(O.canonical)){const y=A.clone();y.posMatrix=new Float64Array(16);const s=A.canonical.z-O.canonical.z,i=A.canonical.x-(A.canonical.x>>s<<s),r=A.canonical.y-(A.canonical.y>>s<<s),l=a.N>>s;a.aS(y.posMatrix,0,a.N,0,a.N,0,1),a.$(y.posMatrix,y.posMatrix,[i*l,r*l,0]),a.a0(y.posMatrix,y.posMatrix,[1/2**s,1/2**s,0]),E[F]=y}}return E}getSourceTile(A,E){const F=this.sourceCache._source;let O=A.overscaledZ-this.deltaZoom;if(O>F.maxzoom&&(O=F.maxzoom),O<F.minzoom)return null;this._sourceTileCache[A.key]||(this._sourceTileCache[A.key]=A.scaledTo(O).key);let y=this.sourceCache.getTileByID(this._sourceTileCache[A.key]);if((!y||!y.dem)&&E)for(;O>=F.minzoom&&(!y||!y.dem);)y=this.sourceCache.getTileByID(A.scaledTo(O--).key);return y}tilesAfterTime(A=Date.now()){return Object.values(this._tiles).filter(E=>E.timeAdded>=A)}}class oa{constructor(A,E,F){this.painter=A,this.sourceCache=new Tu(E),this.options=F,this.exaggeration=typeof F.exaggeration=="number"?F.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(A,E,F,O=a.N){var y;if(!(E>=0&&E<O&&F>=0&&F<O))return 0;const s=this.getTerrainData(A),i=(y=s.tile)===null||y===void 0?void 0:y.dem;if(!i)return 0;const r=function(B,j,X){var ue=j[0],Se=j[1];return B[0]=X[0]*ue+X[4]*Se+X[12],B[1]=X[1]*ue+X[5]*Se+X[13],B}([],[E/O*a.N,F/O*a.N],s.u_terrain_matrix),l=[r[0]*i.dim,r[1]*i.dim],d=Math.floor(l[0]),_=Math.floor(l[1]),w=l[0]-d,T=l[1]-_;return i.get(d,_)*(1-w)*(1-T)+i.get(d+1,_)*w*(1-T)+i.get(d,_+1)*(1-w)*T+i.get(d+1,_+1)*w*T}getElevationForLngLatZoom(A,E){const{tileID:F,mercatorX:O,mercatorY:y}=this._getOverscaledTileIDFromLngLatZoom(A,E);return this.getElevation(F,O%a.N,y%a.N,a.N)}getElevation(A,E,F,O=a.N){return this.getDEMElevation(A,E,F,O)*this.exaggeration}getTerrainData(A){if(!this._emptyDemTexture){const O=this.painter.context,y=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new mt(O,y,O.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new mt(O,new a.R({width:1,height:1}),O.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(O.gl.NEAREST,O.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.ao([])}const E=this.sourceCache.getSourceTile(A,!0);if(E&&E.dem&&(!E.demTexture||E.needsTerrainPrepare)){const O=this.painter.context;E.demTexture=this.painter.getTileTexture(E.dem.stride),E.demTexture?E.demTexture.update(E.dem.getPixels(),{premultiply:!1}):E.demTexture=new mt(O,E.dem.getPixels(),O.gl.RGBA,{premultiply:!1}),E.demTexture.bind(O.gl.NEAREST,O.gl.CLAMP_TO_EDGE),E.needsTerrainPrepare=!1}const F=E&&E+E.tileID.key+A.key;if(F&&!this._demMatrixCache[F]){const O=this.sourceCache.sourceCache._source.maxzoom;let y=A.canonical.z-E.tileID.canonical.z;A.overscaledZ>A.canonical.z&&(A.canonical.z>=O?y=A.canonical.z-O:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const s=A.canonical.x-(A.canonical.x>>y<<y),i=A.canonical.y-(A.canonical.y>>y<<y),r=a.bc(new Float64Array(16),[1/(a.N<<y),1/(a.N<<y),0]);a.$(r,r,[s*a.N,i*a.N,0]),this._demMatrixCache[A.key]={matrix:r,coord:A}}return{u_depth:2,u_terrain:3,u_terrain_dim:E&&E.dem&&E.dem.dim||1,u_terrain_matrix:F?this._demMatrixCache[A.key].matrix:this._emptyDemMatrix,u_terrain_unpack:E&&E.dem&&E.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(E&&E.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:E}}getFramebuffer(A){const E=this.painter,F=E.width/devicePixelRatio,O=E.height/devicePixelRatio;return!this._fbo||this._fbo.width===F&&this._fbo.height===O||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new mt(E.context,{width:F,height:O,data:null},E.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(E.context.gl.NEAREST,E.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new mt(E.context,{width:F,height:O,data:null},E.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(E.context.gl.NEAREST,E.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=E.context.createFramebuffer(F,O,!0,!1),this._fbo.depthAttachment.set(E.context.createRenderbuffer(E.context.gl.DEPTH_COMPONENT16,F,O))),this._fbo.colorAttachment.set(A==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const A=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const E=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,s=0;y<this._coordsTextureSize;y++)for(let i=0;i<this._coordsTextureSize;i++,s+=4)E[s+0]=255&i,E[s+1]=255&y,E[s+2]=i>>8<<4|y>>8,E[s+3]=0;const F=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(E.buffer)),O=new mt(A,F,A.gl.RGBA,{premultiply:!1});return O.bind(A.gl.NEAREST,A.gl.CLAMP_TO_EDGE),this._coordsTexture=O,O}pointCoordinate(A){const E=new Uint8Array(4),F=this.painter.context,O=F.gl;F.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),O.readPixels(A.x,this.painter.height/devicePixelRatio-A.y-1,1,1,O.RGBA,O.UNSIGNED_BYTE,E),F.bindFramebuffer.set(null);const y=E[0]+(E[2]>>4<<8),s=E[1]+((15&E[2])<<8),i=this.coordsIndex[255-E[3]],r=i&&this.sourceCache.getTileByID(i);if(!r)return null;const l=this._coordsTextureSize,d=(1<<r.tileID.canonical.z)*l;return new a.U(this._allowMercatorOverflow(A,(r.tileID.canonical.x*l+y)/d),(r.tileID.canonical.y*l+s)/d,this.getElevation(r.tileID,y,s,l))}getTerrainMesh(){if(this._mesh)return this._mesh;const A=this.painter.context,E=new a.bd,F=new a.b0,O=this.meshSize,y=a.N/O,s=O*O;for(let _=0;_<=O;_++)for(let w=0;w<=O;w++)E.emplaceBack(w*y,_*y,0);for(let _=0;_<s;_+=O+1)for(let w=0;w<O;w++)F.emplaceBack(w+_,O+w+_+1,O+w+_+2),F.emplaceBack(w+_,O+w+_+2,w+_+1);const i=E.length,r=i+2*(O+1);for(const _ of[0,1])for(let w=0;w<=O;w++)for(const T of[0,1])E.emplaceBack(w*y,_*a.N,T);for(let _=0;_<2*O;_+=2)F.emplaceBack(r+_,r+_+1,r+_+3),F.emplaceBack(r+_,r+_+3,r+_+2),F.emplaceBack(i+_,i+_+3,i+_+1),F.emplaceBack(i+_,i+_+2,i+_+3);const l=E.length,d=l+2*(O+1);for(const _ of[0,1])for(let w=0;w<=O;w++)for(const T of[0,1])E.emplaceBack(_*a.N,w*y,T);for(let _=0;_<2*O;_+=2)F.emplaceBack(l+_,l+_+1,l+_+3),F.emplaceBack(l+_,l+_+3,l+_+2),F.emplaceBack(d+_,d+_+3,d+_+1),F.emplaceBack(d+_,d+_+2,d+_+3);return this._mesh={indexBuffer:A.createIndexBuffer(F),vertexBuffer:A.createVertexBuffer(E,tl.members),segments:a.S.simpleSegment(0,0,E.length,F.length)},this._mesh}getMeshFrameDelta(A){return 2*Math.PI*a.be/Math.pow(2,A)/5}getMinTileElevationForLngLatZoom(A,E){var F;const{tileID:O}=this._getOverscaledTileIDFromLngLatZoom(A,E);return(F=this.getMinMaxElevation(O).minElevation)!==null&&F!==void 0?F:0}getMinMaxElevation(A){const E=this.getTerrainData(A).tile,F={minElevation:null,maxElevation:null};return E&&E.dem&&(F.minElevation=E.dem.min*this.exaggeration,F.maxElevation=E.dem.max*this.exaggeration),F}_getOverscaledTileIDFromLngLatZoom(A,E){const F=a.U.fromLngLat(A.wrap()),O=(1<<E)*a.N,y=F.x*O,s=F.y*O,i=Math.floor(y/a.N),r=Math.floor(s/a.N);return{tileID:new a.O(E,0,E,i,r),mercatorX:y,mercatorY:s}}_allowMercatorOverflow(A,E){const F=A.x<this.painter.width/2;let O=a.bf(E);const y=this.painter.transform.center.lng;return F&&Math.sign(O)>0&&Math.sign(y)<0||!F&&Math.sign(O)<0&&Math.sign(y)>0?(O=360*Math.sign(y)+O,a.G(O)):E}}class yu{constructor(A,E,F){this._context=A,this._size=E,this._tileSize=F,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const A of this._objects)A.texture.destroy(),A.fbo.destroy()}_createObject(A){const E=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),F=new mt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return F.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),E.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),E.colorAttachment.set(F.texture),{id:A,fbo:E,texture:F,stamp:-1,inUse:!1}}getObjectForId(A){return this._objects[A]}useObject(A){A.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(E=>A.id!==E),this._recentlyUsed.push(A.id)}stampObject(A){A.stamp=++this._stamp}getOrCreateFreeObject(){for(const E of this._recentlyUsed)if(!this._objects[E].inUse)return this._objects[E];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const A=this._createObject(this._objects.length);return this._objects.push(A),A}freeObject(A){A.inUse=!1}freeAllObjects(){for(const A of this._objects)this.freeObject(A)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(A=>!A.inUse)===!1}}const bs={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Lo{constructor(A,E){this.painter=A,this.terrain=E,this.pool=new yu(A.context,30,E.sourceCache.tileSize*E.qualityFactor)}destruct(){this.pool.destruct()}getTexture(A){return this.pool.getObjectForId(A.rtt[this._stacks.length-1].id).texture}prepareForRender(A,E){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=A._order.filter(F=>!A._layers[F].isHidden(E)),this._coordsDescendingInv={};for(const F in A.sourceCaches){this._coordsDescendingInv[F]={};const O=A.sourceCaches[F].getVisibleCoordinates();for(const y of O){const s=this.terrain.sourceCache.getTerrainCoords(y);for(const i in s)this._coordsDescendingInv[F][i]||(this._coordsDescendingInv[F][i]=[]),this._coordsDescendingInv[F][i].push(s[i])}}this._coordsDescendingInvStr={};for(const F of A._order){const O=A._layers[F],y=O.source;if(bs[O.type]&&!this._coordsDescendingInvStr[y]){this._coordsDescendingInvStr[y]={};for(const s in this._coordsDescendingInv[y])this._coordsDescendingInvStr[y][s]=this._coordsDescendingInv[y][s].map(i=>i.key).sort().join()}}for(const F of this._renderableTiles)for(const O in this._coordsDescendingInvStr){const y=this._coordsDescendingInvStr[O][F.tileID.key];y&&y!==F.rttCoords[O]&&(F.rtt=[])}}renderLayer(A){if(A.isHidden(this.painter.transform.zoom))return!1;const E=A.type,F=this.painter,O=this._renderableLayerIds[this._renderableLayerIds.length-1]===A.id;if(bs[E]&&(this._prevType&&bs[this._prevType]||this._stacks.push([]),this._prevType=E,this._stacks[this._stacks.length-1].push(A.id),!O))return!0;if(bs[this._prevType]||bs[E]&&O){this._prevType=E;const y=this._stacks.length-1,s=this._stacks[y]||[];for(const i of this._renderableTiles){if(this.pool.isFull()&&(Yr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(i),i.rtt[y]){const l=this.pool.getObjectForId(i.rtt[y].id);if(l.stamp===i.rtt[y].stamp){this.pool.useObject(l);continue}}const r=this.pool.getOrCreateFreeObject();this.pool.useObject(r),this.pool.stampObject(r),i.rtt[y]={id:r.id,stamp:r.stamp},F.context.bindFramebuffer.set(r.fbo.framebuffer),F.context.clear({color:a.aT.transparent,stencil:0}),F.currentStencilSource=void 0;for(let l=0;l<s.length;l++){const d=F.style._layers[s[l]],_=d.source?this._coordsDescendingInv[d.source][i.tileID.key]:[i.tileID];F.context.viewport.set([0,0,r.fbo.width,r.fbo.height]),F._renderTileClippingMasks(d,_),F.renderLayer(F,F.style.sourceCaches[d.source],d,_),d.source&&(i.rttCoords[d.source]=this._coordsDescendingInvStr[d.source][i.tileID.key])}}return Yr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),bs[E]}return!1}}const ki=U,Li={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},ws=Z=>{Z.touchstart=Z.dragStart,Z.touchmoveWindow=Z.dragMove,Z.touchend=Z.dragEnd},vu={showCompass:!0,showZoom:!0,visualizePitch:!1};class Vo{constructor(A,E,F=!1){this.mousedown=s=>{this.startMouse(a.e({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),W.mousePos(this.element,s)),W.addEventListener(window,"mousemove",this.mousemove),W.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=s=>{this.moveMouse(s,W.mousePos(this.element,s))},this.mouseup=s=>{this.mouseRotate.dragEnd(s),this.mousePitch&&this.mousePitch.dragEnd(s),this.offTemp()},this.touchstart=s=>{s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=W.touchPos(this.element,s.targetTouches)[0],this.startTouch(s,this._startPos),W.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),W.addEventListener(window,"touchend",this.touchend))},this.touchmove=s=>{s.targetTouches.length!==1?this.reset():(this._lastPos=W.touchPos(this.element,s.targetTouches)[0],this.moveTouch(s,this._lastPos))},this.touchend=s=>{s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const O=A.dragRotate._mouseRotate.getClickTolerance(),y=A.dragRotate._mousePitch.getClickTolerance();this.element=E,this.mouseRotate=vo({clickTolerance:O,enable:!0}),this.touchRotate=(({enable:s,clickTolerance:i,bearingDegreesPerPixelMoved:r=.8})=>{const l=new $u;return new Ja({clickTolerance:i,move:(d,_)=>({bearingDelta:(_.x-d.x)*r}),moveStateManager:l,enable:s,assignEvents:ws})})({clickTolerance:O,enable:!0}),this.map=A,F&&(this.mousePitch=Ml({clickTolerance:y,enable:!0}),this.touchPitch=(({enable:s,clickTolerance:i,pitchDegreesPerPixelMoved:r=-.5})=>{const l=new $u;return new Ja({clickTolerance:i,move:(d,_)=>({pitchDelta:(_.y-d.y)*r}),moveStateManager:l,enable:s,assignEvents:ws})})({clickTolerance:y,enable:!0})),W.addEventListener(E,"mousedown",this.mousedown),W.addEventListener(E,"touchstart",this.touchstart,{passive:!1}),W.addEventListener(E,"touchcancel",this.reset)}startMouse(A,E){this.mouseRotate.dragStart(A,E),this.mousePitch&&this.mousePitch.dragStart(A,E),W.disableDrag()}startTouch(A,E){this.touchRotate.dragStart(A,E),this.touchPitch&&this.touchPitch.dragStart(A,E),W.disableDrag()}moveMouse(A,E){const F=this.map,{bearingDelta:O}=this.mouseRotate.dragMove(A,E)||{};if(O&&F.setBearing(F.getBearing()+O),this.mousePitch){const{pitchDelta:y}=this.mousePitch.dragMove(A,E)||{};y&&F.setPitch(F.getPitch()+y)}}moveTouch(A,E){const F=this.map,{bearingDelta:O}=this.touchRotate.dragMove(A,E)||{};if(O&&F.setBearing(F.getBearing()+O),this.touchPitch){const{pitchDelta:y}=this.touchPitch.dragMove(A,E)||{};y&&F.setPitch(F.getPitch()+y)}}off(){const A=this.element;W.removeEventListener(A,"mousedown",this.mousedown),W.removeEventListener(A,"touchstart",this.touchstart,{passive:!1}),W.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),W.removeEventListener(window,"touchend",this.touchend),W.removeEventListener(A,"touchcancel",this.reset),this.offTemp()}offTemp(){W.enableDrag(),W.removeEventListener(window,"mousemove",this.mousemove),W.removeEventListener(window,"mouseup",this.mouseup),W.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),W.removeEventListener(window,"touchend",this.touchend)}}let fs;function hl(Z,A,E){if(Z=new a.L(Z.lng,Z.lat),A){const F=new a.L(Z.lng-360,Z.lat),O=new a.L(Z.lng+360,Z.lat),y=E.locationPoint(Z).distSqr(A);E.locationPoint(F).distSqr(A)<y?Z=F:E.locationPoint(O).distSqr(A)<y&&(Z=O)}for(;Math.abs(Z.lng-E.center.lng)>180;){const F=E.locationPoint(Z);if(F.x>=0&&F.y>=0&&F.x<=E.width&&F.y<=E.height)break;Z.lng>E.center.lng?Z.lng-=360:Z.lng+=360}return Z}const Ds={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function C(Z,A,E){const F=Z.classList;for(const O in Ds)F.remove(`maplibregl-${E}-anchor-${O}`);F.add(`maplibregl-${E}-anchor-${A}`)}class D extends a.E{constructor(A){if(super(),this._onKeyPress=E=>{const F=E.code,O=E.charCode||E.keyCode;F!=="Space"&&F!=="Enter"&&O!==32&&O!==13||this.togglePopup()},this._onMapClick=E=>{const F=E.originalEvent.target,O=this._element;this._popup&&(F===O||O.contains(F))&&this.togglePopup()},this._update=E=>{if(!this._map)return;const F=this._map.loaded()&&!this._map.isMoving();((E==null?void 0:E.type)==="terrain"||(E==null?void 0:E.type)==="render"&&!F)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=hl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let O="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?O=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(O=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y=`rotateX(${this._map.getPitch()}deg)`),E&&E.type!=="moveend"||(this._pos=this._pos.round()),W.setTransform(this._element,`${Ds[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${O}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const s=this._map.unproject(this._pos),i=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=s.distanceTo(this._lngLat)>20*i?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=E=>{if(!this._isDragging){const F=this._clickTolerance||this._map._clickTolerance;this._isDragging=E.point.dist(this._pointerdownPos)>=F}this._isDragging&&(this._pos=E.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.k("dragstart"))),this.fire(new a.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.k("dragend")),this._state="inactive"},this._addDragHandler=E=>{this._element.contains(E.originalEvent.target)&&(E.preventDefault(),this._positionDelta=E.point.sub(this._pos).add(this._offset),this._pointerdownPos=E.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=A&&A.anchor||"center",this._color=A&&A.color||"#3FB1CE",this._scale=A&&A.scale||1,this._draggable=A&&A.draggable||!1,this._clickTolerance=A&&A.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=A&&A.rotation||0,this._rotationAlignment=A&&A.rotationAlignment||"auto",this._pitchAlignment=A&&A.pitchAlignment&&A.pitchAlignment!=="auto"?A.pitchAlignment:this._rotationAlignment,A&&A.element)this._element=A.element,this._offset=a.P.convert(A&&A.offset||[0,0]);else{this._defaultMarker=!0,this._element=W.create("div"),this._element.setAttribute("aria-label","Map marker");const E=W.createNS("http://www.w3.org/2000/svg","svg"),F=41,O=27;E.setAttributeNS(null,"display","block"),E.setAttributeNS(null,"height",`${F}px`),E.setAttributeNS(null,"width",`${O}px`),E.setAttributeNS(null,"viewBox",`0 0 ${O} ${F}`);const y=W.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");const s=W.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");const i=W.createNS("http://www.w3.org/2000/svg","g");i.setAttributeNS(null,"transform","translate(3.0, 29.0)"),i.setAttributeNS(null,"fill","#000000");const r=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ue of r){const Se=W.createNS("http://www.w3.org/2000/svg","ellipse");Se.setAttributeNS(null,"opacity","0.04"),Se.setAttributeNS(null,"cx","10.5"),Se.setAttributeNS(null,"cy","5.80029008"),Se.setAttributeNS(null,"rx",ue.rx),Se.setAttributeNS(null,"ry",ue.ry),i.appendChild(Se)}const l=W.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"fill",this._color);const d=W.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),l.appendChild(d);const _=W.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"opacity","0.25"),_.setAttributeNS(null,"fill","#000000");const w=W.createNS("http://www.w3.org/2000/svg","path");w.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),_.appendChild(w);const T=W.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(6.0, 7.0)"),T.setAttributeNS(null,"fill","#FFFFFF");const B=W.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"transform","translate(8.0, 8.0)");const j=W.createNS("http://www.w3.org/2000/svg","circle");j.setAttributeNS(null,"fill","#000000"),j.setAttributeNS(null,"opacity","0.25"),j.setAttributeNS(null,"cx","5.5"),j.setAttributeNS(null,"cy","5.5"),j.setAttributeNS(null,"r","5.4999962");const X=W.createNS("http://www.w3.org/2000/svg","circle");X.setAttributeNS(null,"fill","#FFFFFF"),X.setAttributeNS(null,"cx","5.5"),X.setAttributeNS(null,"cy","5.5"),X.setAttributeNS(null,"r","5.4999962"),B.appendChild(j),B.appendChild(X),s.appendChild(i),s.appendChild(l),s.appendChild(_),s.appendChild(T),s.appendChild(B),E.appendChild(s),E.setAttributeNS(null,"height",F*this._scale+"px"),E.setAttributeNS(null,"width",O*this._scale+"px"),this._element.appendChild(E),this._offset=a.P.convert(A&&A.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",E=>{E.preventDefault()}),this._element.addEventListener("mousedown",E=>{E.preventDefault()}),C(this._element,this._anchor,"marker"),A&&A.className)for(const E of A.className.split(" "))this._element.classList.add(E);this._popup=null}addTo(A){return this.remove(),this._map=A,A.getCanvasContainer().appendChild(this._element),A.on("move",this._update),A.on("moveend",this._update),A.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),W.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(A){return this._lngLat=a.L.convert(A),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(A){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),A){if(!("offset"in A.options)){const O=Math.abs(13.5)/Math.SQRT2;A.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[O,-1*(38.1-13.5+O)],"bottom-right":[-O,-1*(38.1-13.5+O)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=A,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const A=this._popup;return A?(A.isOpen()?A.remove():A.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(A){return this._offset=a.P.convert(A),this._update(),this}addClassName(A){this._element.classList.add(A)}removeClassName(A){this._element.classList.remove(A)}toggleClassName(A){return this._element.classList.toggle(A)}setDraggable(A){return this._draggable=!!A,this._map&&(A?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(A){return this._rotation=A||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(A){return this._rotationAlignment=A||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(A){return this._pitchAlignment=A&&A!=="auto"?A:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const z={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let R=0,ee=!1;const le={maxWidth:100,unit:"metric"};function oe(Z,A,E){const F=E&&E.maxWidth||100,O=Z._container.clientHeight/2,y=Z.unproject([0,O]),s=Z.unproject([F,O]),i=y.distanceTo(s);if(E&&E.unit==="imperial"){const r=3.2808*i;r>5280?we(A,F,r/5280,Z._getUIString("ScaleControl.Miles")):we(A,F,r,Z._getUIString("ScaleControl.Feet"))}else E&&E.unit==="nautical"?we(A,F,i/1852,Z._getUIString("ScaleControl.NauticalMiles")):i>=1e3?we(A,F,i/1e3,Z._getUIString("ScaleControl.Kilometers")):we(A,F,i,Z._getUIString("ScaleControl.Meters"))}function we(Z,A,E,F){const O=function(y){const s=Math.pow(10,`${Math.floor(y)}`.length-1);let i=y/s;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:i>=1?1:function(r){const l=Math.pow(10,Math.ceil(-Math.log(r)/Math.LN10));return Math.round(r*l)/l}(i),s*i}(E);Z.style.width=A*(O/E)+"px",Z.innerHTML=`${O}&nbsp;${F}`}const We={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},yt=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ct(Z){if(Z){if(typeof Z=="number"){const A=Math.round(Math.abs(Z)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,Z),"top-left":new a.P(A,A),"top-right":new a.P(-A,A),bottom:new a.P(0,-Z),"bottom-left":new a.P(A,-A),"bottom-right":new a.P(-A,-A),left:new a.P(Z,0),right:new a.P(-Z,0)}}if(Z instanceof a.P||Array.isArray(Z)){const A=a.P.convert(Z);return{center:A,top:A,"top-left":A,"top-right":A,bottom:A,"bottom-left":A,"bottom-right":A,left:A,right:A}}return{center:a.P.convert(Z.center||[0,0]),top:a.P.convert(Z.top||[0,0]),"top-left":a.P.convert(Z["top-left"]||[0,0]),"top-right":a.P.convert(Z["top-right"]||[0,0]),bottom:a.P.convert(Z.bottom||[0,0]),"bottom-left":a.P.convert(Z["bottom-left"]||[0,0]),"bottom-right":a.P.convert(Z["bottom-right"]||[0,0]),left:a.P.convert(Z.left||[0,0]),right:a.P.convert(Z.right||[0,0])}}return Ct(new a.P(0,0))}const ri={extend:(Z,...A)=>a.e(Z,...A),run(Z){Z()},logToElement(Z,A=!1,E="log"){const F=window.document.getElementById(E);F&&(A&&(F.innerHTML=""),F.innerHTML+=`<br>${Z}`)}},Gt=U;class Zt{static get version(){return Gt}static get workerCount(){return pn.workerCount}static set workerCount(A){pn.workerCount=A}static get maxParallelImageRequests(){return a.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(A){a.c.MAX_PARALLEL_IMAGE_REQUESTS=A}static get workerUrl(){return a.c.WORKER_URL}static set workerUrl(A){a.c.WORKER_URL=A}static addProtocol(A,E){a.c.REGISTERED_PROTOCOLS[A]=E}static removeProtocol(A){delete a.c.REGISTERED_PROTOCOLS[A]}}return Zt.Map=class extends yr{constructor(Z){if(a.bg.mark(a.bh.create),(Z=a.e({},Li,Z)).minZoom!=null&&Z.maxZoom!=null&&Z.minZoom>Z.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(Z.minPitch!=null&&Z.maxPitch!=null&&Z.minPitch>Z.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(Z.minPitch!=null&&Z.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(Z.maxPitch!=null&&Z.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new ea(Z.minZoom,Z.maxZoom,Z.minPitch,Z.maxPitch,Z.renderWorldCopies),{bearingSnap:Z.bearingSnap}),this._cooperativeGesturesOnWheel=A=>{this._onCooperativeGesture(A,A[this._metaKey],1)},this._contextLost=A=>{A.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.k("webglcontextlost",{originalEvent:A}))},this._contextRestored=A=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.k("webglcontextrestored",{originalEvent:A}))},this._onMapScroll=A=>{if(A.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=Z.interactive,this._cooperativeGestures=Z.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=Z.maxTileCacheSize,this._maxTileCacheZoomLevels=Z.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=Z.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=Z.preserveDrawingBuffer,this._antialias=Z.antialias,this._trackResize=Z.trackResize,this._bearingSnap=Z.bearingSnap,this._refreshExpiredTiles=Z.refreshExpiredTiles,this._fadeDuration=Z.fadeDuration,this._crossSourceCollisions=Z.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=Z.collectResourceTiming,this._renderTaskQueue=new Zn,this._controls=[],this._mapId=a.a2(),this._locale=a.e({},Jn,Z.locale),this._clickTolerance=Z.clickTolerance,this._overridePixelRatio=Z.pixelRatio,this._maxCanvasSize=Z.maxCanvasSize,this.transformCameraUpdate=Z.transformCameraUpdate,this._imageQueueHandle=Ye.addThrottleControl(()=>this.isMoving()),this._requestManager=new ct(Z.transformRequest),typeof Z.container=="string"){if(this._container=document.getElementById(Z.container),!this._container)throw new Error(`Container '${Z.container}' not found.`)}else{if(!(Z.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=Z.container}if(Z.maxBounds&&this.setMaxBounds(Z.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let A=!1;const E=Ea(F=>{this._trackResize&&!this._removed&&this.resize(F)._update()},50);this._resizeObserver=new ResizeObserver(F=>{A?E(F):A=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Vu(this,Z),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=Z.hash&&new Pa(typeof Z.hash=="string"&&Z.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:Z.center,zoom:Z.zoom,bearing:Z.bearing,pitch:Z.pitch}),Z.bounds&&(this.resize(),this.fitBounds(Z.bounds,a.e({},Z.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=Z.localIdeographFontFamily,this._validateStyle=Z.validateStyle,Z.style&&this.setStyle(Z.style,{localIdeographFontFamily:Z.localIdeographFontFamily}),Z.attributionControl&&this.addControl(new gs({customAttribution:Z.customAttribution})),Z.maplibreLogo&&this.addControl(new gn,Z.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",A=>{this._update(A.dataType==="style"),this.fire(new a.k(`${A.dataType}data`,A))}),this.on("dataloading",A=>{this.fire(new a.k(`${A.dataType}dataloading`,A))}),this.on("dataabort",A=>{this.fire(new a.k("sourcedataabort",A))})}_getMapId(){return this._mapId}addControl(Z,A){if(A===void 0&&(A=Z.getDefaultPosition?Z.getDefaultPosition():"top-right"),!Z||!Z.onAdd)return this.fire(new a.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const E=Z.onAdd(this);this._controls.push(Z);const F=this._controlPositions[A];return A.indexOf("bottom")!==-1?F.insertBefore(E,F.firstChild):F.appendChild(E),this}removeControl(Z){if(!Z||!Z.onRemove)return this.fire(new a.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const A=this._controls.indexOf(Z);return A>-1&&this._controls.splice(A,1),Z.onRemove(this),this}hasControl(Z){return this._controls.indexOf(Z)>-1}calculateCameraOptionsFromTo(Z,A,E,F){return F==null&&this.terrain&&(F=this.terrain.getElevationForLngLatZoom(E,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(Z,A,E,F)}resize(Z){var A;const E=this._containerDimensions(),F=E[0],O=E[1],y=this._getClampedPixelRatio(F,O);if(this._resizeCanvas(F,O,y),this.painter.resize(F,O,y),this.painter.overLimit()){const i=this.painter.context.gl;this._maxCanvasSize=[i.drawingBufferWidth,i.drawingBufferHeight];const r=this._getClampedPixelRatio(F,O);this._resizeCanvas(F,O,r),this.painter.resize(F,O,r)}this.transform.resize(F,O),(A=this._requestedCameraState)===null||A===void 0||A.resize(F,O);const s=!this._moving;return s&&(this.stop(),this.fire(new a.k("movestart",Z)).fire(new a.k("move",Z))),this.fire(new a.k("resize",Z)),s&&this.fire(new a.k("moveend",Z)),this}_getClampedPixelRatio(Z,A){const{0:E,1:F}=this._maxCanvasSize,O=this.getPixelRatio(),y=Z*O,s=A*O;return Math.min(y>E?E/y:1,s>F?F/s:1)*O}getPixelRatio(){var Z;return(Z=this._overridePixelRatio)!==null&&Z!==void 0?Z:devicePixelRatio}setPixelRatio(Z){this._overridePixelRatio=Z,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(Z){return this.transform.setMaxBounds(Ri.convert(Z)),this._update()}setMinZoom(Z){if((Z=Z??-2)>=-2&&Z<=this.transform.maxZoom)return this.transform.minZoom=Z,this._update(),this.getZoom()<Z&&this.setZoom(Z),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(Z){if((Z=Z??22)>=this.transform.minZoom)return this.transform.maxZoom=Z,this._update(),this.getZoom()>Z&&this.setZoom(Z),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(Z){if((Z=Z??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(Z>=0&&Z<=this.transform.maxPitch)return this.transform.minPitch=Z,this._update(),this.getPitch()<Z&&this.setPitch(Z),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(Z){if((Z=Z??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(Z>=this.transform.minPitch)return this.transform.maxPitch=Z,this._update(),this.getPitch()>Z&&this.setPitch(Z),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(Z){return this.transform.renderWorldCopies=Z,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(Z){return this._cooperativeGestures=Z,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(Z){return this.transform.locationPoint(a.L.convert(Z),this.style&&this.terrain)}unproject(Z){return this.transform.pointLocation(a.P.convert(Z),this.terrain)}isMoving(){var Z;return this._moving||((Z=this.handlers)===null||Z===void 0?void 0:Z.isMoving())}isZooming(){var Z;return this._zooming||((Z=this.handlers)===null||Z===void 0?void 0:Z.isZooming())}isRotating(){var Z;return this._rotating||((Z=this.handlers)===null||Z===void 0?void 0:Z.isRotating())}_createDelegatedListener(Z,A,E){if(Z==="mouseenter"||Z==="mouseover"){let F=!1;return{layer:A,listener:E,delegates:{mousemove:y=>{const s=this.getLayer(A)?this.queryRenderedFeatures(y.point,{layers:[A]}):[];s.length?F||(F=!0,E.call(this,new Ft(Z,this,y.originalEvent,{features:s}))):F=!1},mouseout:()=>{F=!1}}}}if(Z==="mouseleave"||Z==="mouseout"){let F=!1;return{layer:A,listener:E,delegates:{mousemove:s=>{(this.getLayer(A)?this.queryRenderedFeatures(s.point,{layers:[A]}):[]).length?F=!0:F&&(F=!1,E.call(this,new Ft(Z,this,s.originalEvent)))},mouseout:s=>{F&&(F=!1,E.call(this,new Ft(Z,this,s.originalEvent)))}}}}{const F=O=>{const y=this.getLayer(A)?this.queryRenderedFeatures(O.point,{layers:[A]}):[];y.length&&(O.features=y,E.call(this,O),delete O.features)};return{layer:A,listener:E,delegates:{[Z]:F}}}}on(Z,A,E){if(E===void 0)return super.on(Z,A);const F=this._createDelegatedListener(Z,A,E);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[Z]=this._delegatedListeners[Z]||[],this._delegatedListeners[Z].push(F);for(const O in F.delegates)this.on(O,F.delegates[O]);return this}once(Z,A,E){if(E===void 0)return super.once(Z,A);const F=this._createDelegatedListener(Z,A,E);for(const O in F.delegates)this.once(O,F.delegates[O]);return this}off(Z,A,E){return E===void 0?super.off(Z,A):(this._delegatedListeners&&this._delegatedListeners[Z]&&(F=>{const O=this._delegatedListeners[Z];for(let y=0;y<O.length;y++){const s=O[y];if(s.layer===A&&s.listener===E){for(const i in s.delegates)this.off(i,s.delegates[i]);return O.splice(y,1),this}}})(),this)}queryRenderedFeatures(Z,A){if(!this.style)return[];let E;const F=Z instanceof a.P||Array.isArray(Z),O=F?Z:[[0,0],[this.transform.width,this.transform.height]];if(A=A||(F?{}:Z)||{},O instanceof a.P||typeof O[0]=="number")E=[a.P.convert(O)];else{const y=a.P.convert(O[0]),s=a.P.convert(O[1]);E=[y,new a.P(s.x,y.y),s,new a.P(y.x,s.y),y]}return this.style.queryRenderedFeatures(E,A,this.transform)}querySourceFeatures(Z,A){return this.style.querySourceFeatures(Z,A)}setStyle(Z,A){return(A=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},A)).diff!==!1&&A.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&Z?(this._diffStyle(Z,A),this):(this._localIdeographFontFamily=A.localIdeographFontFamily,this._updateStyle(Z,A))}setTransformRequest(Z){return this._requestManager.setTransformRequest(Z),this}_getUIString(Z){const A=this._locale[Z];if(A==null)throw new Error(`Missing UI string '${Z}'`);return A}_updateStyle(Z,A){if(A.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(Z,A));const E=this.style&&A.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!Z)),Z?(this.style=new cr(this,A||{}),this.style.setEventedParent(this,{style:this.style}),typeof Z=="string"?this.style.loadURL(Z,A,E):this.style.loadJSON(Z,A,E),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new cr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(Z,A){if(typeof Z=="string"){const E=this._requestManager.transformRequest(Z,it.Style);a.f(E,(F,O)=>{F?this.fire(new a.j(F)):O&&this._updateDiff(O,A)})}else typeof Z=="object"&&this._updateDiff(Z,A)}_updateDiff(Z,A){try{this.style.setState(Z,A)&&this._update(!0)}catch(E){a.w(`Unable to perform style diff: ${E.message||E.error||E}.  Rebuilding the style from scratch.`),this._updateStyle(Z,A)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(Z,A){return this._lazyInitEmptyStyle(),this.style.addSource(Z,A),this._update(!0)}isSourceLoaded(Z){const A=this.style&&this.style.sourceCaches[Z];if(A!==void 0)return A.loaded();this.fire(new a.j(new Error(`There is no source with ID '${Z}'`)))}setTerrain(Z){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),Z){const A=this.style.sourceCaches[Z.source];if(!A)throw new Error(`cannot load terrain, because there exists no source with ID: ${Z.source}`);for(const E in this.style._layers){const F=this.style._layers[E];F.type==="hillshade"&&F.source===Z.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new oa(this.painter,A,Z),this.painter.renderToTexture=new Lo(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=E=>{E.dataType==="style"?this.terrain.sourceCache.freeRtt():E.dataType==="source"&&E.tile&&(E.sourceId!==Z.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(E.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new a.k("terrain",{terrain:Z})),this}getTerrain(){var Z,A;return(A=(Z=this.terrain)===null||Z===void 0?void 0:Z.options)!==null&&A!==void 0?A:null}areTilesLoaded(){const Z=this.style&&this.style.sourceCaches;for(const A in Z){const E=Z[A]._tiles;for(const F in E){const O=E[F];if(O.state!=="loaded"&&O.state!=="errored")return!1}}return!0}addSourceType(Z,A,E){return this._lazyInitEmptyStyle(),this.style.addSourceType(Z,A,E)}removeSource(Z){return this.style.removeSource(Z),this._update(!0)}getSource(Z){return this.style.getSource(Z)}addImage(Z,A,E={}){const{pixelRatio:F=1,sdf:O=!1,stretchX:y,stretchY:s,content:i}=E;if(this._lazyInitEmptyStyle(),!(A instanceof HTMLImageElement||a.a(A))){if(A.width===void 0||A.height===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:r,height:l,data:d}=A,_=A;return this.style.addImage(Z,{data:new a.R({width:r,height:l},new Uint8Array(d)),pixelRatio:F,stretchX:y,stretchY:s,content:i,sdf:O,version:0,userImage:_}),_.onAdd&&_.onAdd(this,Z),this}}{const{width:r,height:l,data:d}=a.h.getImageData(A);this.style.addImage(Z,{data:new a.R({width:r,height:l},d),pixelRatio:F,stretchX:y,stretchY:s,content:i,sdf:O,version:0})}}updateImage(Z,A){const E=this.style.getImage(Z);if(!E)return this.fire(new a.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const F=A instanceof HTMLImageElement||a.a(A)?a.h.getImageData(A):A,{width:O,height:y,data:s}=F;if(O===void 0||y===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(O!==E.data.width||y!==E.data.height)return this.fire(new a.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const i=!(A instanceof HTMLImageElement||a.a(A));return E.data.replace(s,i),this.style.updateImage(Z,E),this}getImage(Z){return this.style.getImage(Z)}hasImage(Z){return Z?!!this.style.getImage(Z):(this.fire(new a.j(new Error("Missing required image id"))),!1)}removeImage(Z){this.style.removeImage(Z)}loadImage(Z,A){Ye.getImage(this._requestManager.transformRequest(Z,it.Image),A)}listImages(){return this.style.listImages()}addLayer(Z,A){return this._lazyInitEmptyStyle(),this.style.addLayer(Z,A),this._update(!0)}moveLayer(Z,A){return this.style.moveLayer(Z,A),this._update(!0)}removeLayer(Z){return this.style.removeLayer(Z),this._update(!0)}getLayer(Z){return this.style.getLayer(Z)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(Z,A,E){return this.style.setLayerZoomRange(Z,A,E),this._update(!0)}setFilter(Z,A,E={}){return this.style.setFilter(Z,A,E),this._update(!0)}getFilter(Z){return this.style.getFilter(Z)}setPaintProperty(Z,A,E,F={}){return this.style.setPaintProperty(Z,A,E,F),this._update(!0)}getPaintProperty(Z,A){return this.style.getPaintProperty(Z,A)}setLayoutProperty(Z,A,E,F={}){return this.style.setLayoutProperty(Z,A,E,F),this._update(!0)}getLayoutProperty(Z,A){return this.style.getLayoutProperty(Z,A)}setGlyphs(Z,A={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(Z,A),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(Z,A,E={}){return this._lazyInitEmptyStyle(),this.style.addSprite(Z,A,E,F=>{F||this._update(!0)}),this}removeSprite(Z){return this._lazyInitEmptyStyle(),this.style.removeSprite(Z),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(Z,A={}){return this._lazyInitEmptyStyle(),this.style.setSprite(Z,A,E=>{E||this._update(!0)}),this}setLight(Z,A={}){return this._lazyInitEmptyStyle(),this.style.setLight(Z,A),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(Z,A){return this.style.setFeatureState(Z,A),this._update()}removeFeatureState(Z,A){return this.style.removeFeatureState(Z,A),this._update()}getFeatureState(Z){return this.style.getFeatureState(Z)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let Z=0,A=0;return this._container&&(Z=this._container.clientWidth||400,A=this._container.clientHeight||300),[Z,A]}_setupContainer(){const Z=this._container;Z.classList.add("maplibregl-map");const A=this._canvasContainer=W.create("div","maplibregl-canvas-container",Z);this._interactive&&A.classList.add("maplibregl-interactive"),this._canvas=W.create("canvas","maplibregl-canvas",A),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const E=this._containerDimensions(),F=this._getClampedPixelRatio(E[0],E[1]);this._resizeCanvas(E[0],E[1],F);const O=this._controlContainer=W.create("div","maplibregl-control-container",Z),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(s=>{y[s]=W.create("div",`maplibregl-ctrl-${s} `,O)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=W.create("div","maplibregl-cooperative-gesture-screen",this._container);let Z=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(Z=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${Z}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){W.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(Z,A,E){this._canvas.width=Math.floor(E*Z),this._canvas.height=Math.floor(E*A),this._canvas.style.width=`${Z}px`,this._canvas.style.height=`${A}px`}_setupPainter(){const Z={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let A=null;this._canvas.addEventListener("webglcontextcreationerror",F=>{A={requestedAttributes:Z},F&&(A.statusMessage=F.statusMessage,A.type=F.type)},{once:!0});const E=this._canvas.getContext("webgl2",Z)||this._canvas.getContext("webgl",Z);if(!E){const F="Failed to initialize WebGL";throw A?(A.message=F,new Error(JSON.stringify(A))):new Error(F)}this.painter=new gr(E,this.transform),he.testSupport(E)}_onCooperativeGesture(Z,A,E){return!A&&E<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(Z){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||Z,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(Z){return this._update(),this._renderTaskQueue.add(Z)}_cancelRenderFrame(Z){this._renderTaskQueue.remove(Z)}_render(Z){const A=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(Z),this._removed)return;let E=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,y=a.h.now();this.style.zoomHistory.update(O,y);const s=new a.a8(O,{now:y,fadeDuration:A,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),i=s.crossFadingFactor();i===1&&i===this._crossFadingFactor||(E=!0,this._crossFadingFactor=i),this.style.update(s)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,A,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:A,showPadding:this.showPadding}),this.fire(new a.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.bg.mark(a.bh.load),this.fire(new a.k("load"))),this.style&&(this.style.hasTransitions()||E)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const F=this._sourcesDirty||this._styleDirty||this._placementDirty;return F||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.k("idle")),!this._loaded||this._fullyLoaded||F||(this._fullyLoaded=!0,a.bg.mark(a.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var Z;this._hash&&this._hash.remove();for(const E of this._controls)E.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Ye.removeThrottleControl(this._imageQueueHandle),(Z=this._resizeObserver)===null||Z===void 0||Z.disconnect();const A=this.painter.context.gl.getExtension("WEBGL_lose_context");A&&A.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),W.remove(this._canvasContainer),W.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),a.bg.clearMetrics(),this._removed=!0,this.fire(new a.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=a.h.frame(Z=>{a.bg.frame(Z),this._frame=null,this._render(Z)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(Z){this._showTileBoundaries!==Z&&(this._showTileBoundaries=Z,this._update())}get showPadding(){return!!this._showPadding}set showPadding(Z){this._showPadding!==Z&&(this._showPadding=Z,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(Z){this._showCollisionBoxes!==Z&&(this._showCollisionBoxes=Z,Z?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(Z){this._showOverdrawInspector!==Z&&(this._showOverdrawInspector=Z,this._update())}get repaint(){return!!this._repaint}set repaint(Z){this._repaint!==Z&&(this._repaint=Z,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(Z){this._vertices=Z,this._update()}get version(){return ki}getCameraTargetElevation(){return this.transform.elevation}},Zt.NavigationControl=class{constructor(Z){this._updateZoomButtons=()=>{const A=this._map.getZoom(),E=A===this._map.getMaxZoom(),F=A===this._map.getMinZoom();this._zoomInButton.disabled=E,this._zoomOutButton.disabled=F,this._zoomInButton.setAttribute("aria-disabled",E.toString()),this._zoomOutButton.setAttribute("aria-disabled",F.toString())},this._rotateCompassArrow=()=>{const A=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=A},this._setButtonTitle=(A,E)=>{const F=this._map._getUIString(`NavigationControl.${E}`);A.title=F,A.setAttribute("aria-label",F)},this.options=a.e({},vu,Z),this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",A=>A.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",A=>this._map.zoomIn({},{originalEvent:A})),W.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",A=>this._map.zoomOut({},{originalEvent:A})),W.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",A=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:A}):this._map.resetNorth({},{originalEvent:A})}),this._compassIcon=W.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(Z){return this._map=Z,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Vo(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){W.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(Z,A){const E=W.create("button",Z,this._container);return E.type="button",E.addEventListener("click",A),E}},Zt.GeolocateControl=class extends a.E{constructor(Z){super(),this._onSuccess=A=>{if(this._map){if(this._isOutOfMapMaxBounds(A))return this._setErrorState(),this.fire(new a.k("outofmaxbounds",A)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=A,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(A),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(A),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.k("geolocate",A)),this._finish()}},this._updateCamera=A=>{const E=new a.L(A.coords.longitude,A.coords.latitude),F=A.coords.accuracy,O=this._map.getBearing(),y=a.e({bearing:O},this.options.fitBoundsOptions),s=Ri.fromLngLat(E,F);this._map.fitBounds(s,y,{geolocateSource:!0})},this._updateMarker=A=>{if(A){const E=new a.L(A.coords.longitude,A.coords.latitude);this._accuracyCircleMarker.setLngLat(E).addTo(this._map),this._userLocationDotMarker.setLngLat(E).addTo(this._map),this._accuracy=A.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=A=>{if(this._map){if(this.options.trackUserLocation)if(A.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const E=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=E,this._geolocateButton.setAttribute("aria-label",E),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(A.code===3&&ee)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.k("error",A)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=A=>{if(this._map){if(this._container.addEventListener("contextmenu",E=>E.preventDefault()),this._geolocateButton=W.create("button","maplibregl-ctrl-geolocate",this._container),W.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",A===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const E=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=E,this._geolocateButton.setAttribute("aria-label",E)}else{const E=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=E,this._geolocateButton.setAttribute("aria-label",E)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=W.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new D({element:this._dotElement}),this._circleElement=W.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new D({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",E=>{E.geolocateSource||this._watchState!=="ACTIVE_LOCK"||E.originalEvent&&E.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.k("trackuserlocationend")))})}},this.options=a.e({},z,Z)}onAdd(Z){return this._map=Z,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(A,E=!1){fs===void 0||E?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(F=>{fs=F.state!=="denied",A(fs)}).catch(()=>{fs=!!window.navigator.geolocation,A(fs)}):(fs=!!window.navigator.geolocation,A(fs)):A(fs)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),W.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,R=0,ee=!1}_isOutOfMapMaxBounds(Z){const A=this._map.getMaxBounds(),E=Z.coords;return A&&(E.longitude<A.getWest()||E.longitude>A.getEast()||E.latitude<A.getSouth()||E.latitude>A.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const Z=this._map.getBounds(),A=Z.getSouthEast(),E=Z.getNorthEast(),F=A.distanceTo(E),O=Math.ceil(this._accuracy/(F/this._map._container.clientHeight)*2);this._circleElement.style.width=`${O}px`,this._circleElement.style.height=`${O}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":R--,ee=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let Z;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),R++,R>1?(Z={maximumAge:6e5,timeout:0},ee=!0):(Z=this.options.positionOptions,ee=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,Z)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},Zt.AttributionControl=gs,Zt.LogoControl=gn,Zt.ScaleControl=class{constructor(Z){this._onMove=()=>{oe(this._map,this._container,this.options)},this.setUnit=A=>{this.options.unit=A,oe(this._map,this._container,this.options)},this.options=a.e({},le,Z)}getDefaultPosition(){return"bottom-left"}onAdd(Z){return this._map=Z,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-scale",Z.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){W.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},Zt.FullscreenControl=class extends a.E{constructor(Z={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,Z&&Z.container&&(Z.container instanceof HTMLElement?this._container=Z.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(Z){return this._map=Z,this._container||(this._container=this._map.getContainer()),this._controlContainer=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){W.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const Z=this._fullscreenButton=W.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);W.create("span","maplibregl-ctrl-icon",Z).setAttribute("aria-hidden","true"),Z.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const Z=this._getTitle();this._fullscreenButton.setAttribute("aria-label",Z),this._fullscreenButton.title=Z}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new a.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},Zt.TerrainControl=class{constructor(Z){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=Z}onAdd(Z){return this._map=Z,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=W.create("button","maplibregl-ctrl-terrain",this._container),W.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){W.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},Zt.Popup=class extends a.E{constructor(Z){super(),this.remove=()=>(this._content&&W.remove(this._content),this._container&&(W.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.k("close")),this),this._onMouseUp=A=>{this._update(A.point)},this._onMouseMove=A=>{this._update(A.point)},this._onDrag=A=>{this._update(A.point)},this._update=A=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=W.create("div","maplibregl-popup",this._map.getContainer()),this._tip=W.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const s of this.options.className.split(" "))this._container.classList.add(s);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=hl(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!A)return;const E=this._pos=this._trackPointer&&A?A:this._map.project(this._lngLat);let F=this.options.anchor;const O=Ct(this.options.offset);if(!F){const s=this._container.offsetWidth,i=this._container.offsetHeight;let r;r=E.y+O.bottom.y<i?["top"]:E.y>this._map.transform.height-i?["bottom"]:[],E.x<s/2?r.push("left"):E.x>this._map.transform.width-s/2&&r.push("right"),F=r.length===0?"bottom":r.join("-")}const y=E.add(O[F]).round();W.setTransform(this._container,`${Ds[F]} translate(${y.x}px,${y.y}px)`),C(this._container,F,"popup")},this._onClose=()=>{this.remove()},this.options=a.e(Object.create(We),Z)}addTo(Z){return this._map&&this.remove(),this._map=Z,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(Z){return this._lngLat=a.L.convert(Z),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(Z){return this.setDOMContent(document.createTextNode(Z))}setHTML(Z){const A=document.createDocumentFragment(),E=document.createElement("body");let F;for(E.innerHTML=Z;F=E.firstChild,F;)A.appendChild(F);return this.setDOMContent(A)}getMaxWidth(){var Z;return(Z=this._container)===null||Z===void 0?void 0:Z.style.maxWidth}setMaxWidth(Z){return this.options.maxWidth=Z,this._update(),this}setDOMContent(Z){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=W.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(Z),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(Z){this._container&&this._container.classList.add(Z)}removeClassName(Z){this._container&&this._container.classList.remove(Z)}setOffset(Z){return this.options.offset=Z,this._update(),this}toggleClassName(Z){if(this._container)return this._container.classList.toggle(Z)}_createCloseButton(){this.options.closeButton&&(this._closeButton=W.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const Z=this._container.querySelector(yt);Z&&Z.focus()}},Zt.Marker=D,Zt.Style=cr,Zt.LngLat=a.L,Zt.LngLatBounds=Ri,Zt.Point=a.P,Zt.MercatorCoordinate=a.U,Zt.Evented=a.E,Zt.AJAXError=a.bi,Zt.config=a.c,Zt.CanvasSource=Oi,Zt.GeoJSONSource=vn,Zt.ImageSource=mi,Zt.RasterDEMTileSource=nn,Zt.RasterTileSource=Ni,Zt.VectorTileSource=Hi,Zt.VideoSource=zi,Zt.setRTLTextPlugin=a.bj,Zt.getRTLTextPluginStatus=a.bk,Zt.prewarm=function(){V().acquire(Gn)},Zt.clearPrewarmedResources=function(){const Z=k;Z&&(Z.isPreloaded()&&Z.numActive()===1?(Z.release(Gn),k=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},ri.extend(Zt,{isSafari:a.ac,getPerformanceMetrics:a.bg.getPerformanceMetrics}),Zt});var S=g;return S})})(DO);var Rg=Uint8Array,c5=Uint16Array,LO=Int32Array,BO=new Rg([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),zO=new Rg([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),h5=function(e,t){for(var n=new c5(31),c=0;c<31;++c)n[c]=t+=1<<e[c-1];for(var g=new LO(n[30]),c=1;c<30;++c)for(var x=n[c];x<n[c+1];++x)g[x]=x-n[c]<<5|c;return{b:n,r:g}},A5=h5(BO,2),RO=A5.b,FO=A5.r;RO[28]=258,FO[258]=28;h5(zO,0);var OO=new c5(32768);for(io=0;io<32768;++io)$f=(io&43690)>>1|(io&21845)<<1,$f=($f&52428)>>2|($f&13107)<<2,$f=($f&61680)>>4|($f&3855)<<4,OO[io]=(($f&65280)>>8|($f&255)<<8)>>1;var $f,io,c1=new Rg(288);for(io=0;io<144;++io)c1[io]=8;var io;for(io=144;io<256;++io)c1[io]=9;var io;for(io=256;io<280;++io)c1[io]=7;var io;for(io=280;io<288;++io)c1[io]=8;var io,NO=new Rg(32);for(io=0;io<32;++io)NO[io]=5;var io,VO=new Rg(0),UO=typeof TextDecoder<"u"&&new TextDecoder,GO=0;try{UO.decode(VO,{stream:!0}),GO=1}catch{}var E2={exports:{}},qO=jO,HO={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function jO(e){if(!e||!e.type)return null;var t=HO[e.type];if(!t)return null;if(t==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]};if(t==="feature")return{type:"FeatureCollection",features:[e]};if(t==="featurecollection")return e}function u_(e){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.reduce(function(t,n){return t.concat(u_(n))},[]),e;case"Feature":return e.geometry?u_(e.geometry).map(function(t){var n={type:"Feature",properties:JSON.parse(JSON.stringify(e.properties)),geometry:t};return e.id!==void 0&&(n.id=e.id),n}):[e];case"MultiPoint":return e.coordinates.map(function(t){return{type:"Point",coordinates:t}});case"MultiPolygon":return e.coordinates.map(function(t){return{type:"Polygon",coordinates:t}});case"MultiLineString":return e.coordinates.map(function(t){return{type:"LineString",coordinates:t}});case"GeometryCollection":return e.geometries.map(u_).reduce(function(t,n){return t.concat(n)},[]);case"Point":case"Polygon":case"LineString":return[e]}}const ZO=Object.freeze(Object.defineProperty({__proto__:null,default:u_},Symbol.toStringTag,{value:"Module"})),QO=Rv(ZO);var WO=function(t){return n(t);function n(c){return Array.isArray(c)&&c.length&&typeof c[0]=="number"?[c]:c.reduce(function(g,x){return Array.isArray(x)&&Array.isArray(x[0])?g.concat(n(x)):(g.push(x),g)},[])}},$O=qO,c_=QO,XO=WO;c_ instanceof Function||(c_=c_.default);var YO=function(e){if(!e)return[];var t=c_($O(e)),n=[];return t.features.forEach(function(c){c.geometry&&(n=n.concat(XO(c.geometry.coordinates)))}),n};function Im(e){return Object.prototype.toString.call(e)}function KO(e){return Im(e)==="[object Date]"}function JO(e){return Im(e)==="[object RegExp]"}function eN(e){return Im(e)==="[object Error]"}function tN(e){return Im(e)==="[object Boolean]"}function iN(e){return Im(e)==="[object Number]"}function nN(e){return Im(e)==="[object String]"}var f5=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function h1(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n++)t(e[n],n,e)}var rN=Object.keys||function(t){var n=[];for(var c in t)n.push(c);return n},sN=Object.prototype.propertyIsEnumerable,Tw=Object.getOwnPropertySymbols;function A1(e){var t=rN(e);if(Tw)for(var n=Tw(e),c=0;c<n.length;c++)sN.call(e,n[c])&&t.push(n[c]);return t}var f1=Object.prototype.hasOwnProperty||function(e,t){return t in e};function d5(e){if(typeof e=="object"&&e!==null){var t;if(f5(e))t=[];else if(KO(e))t=new Date(e.getTime?e.getTime():e);else if(JO(e))t=new RegExp(e);else if(eN(e))t={message:e.message};else if(tN(e)||iN(e)||nN(e))t=Object(e);else if(Object.create&&Object.getPrototypeOf)t=Object.create(Object.getPrototypeOf(e));else if(e.constructor===Object)t={};else{var n=e.constructor&&e.constructor.prototype||e.__proto__||{},c=function(){};c.prototype=n,t=new c}return h1(A1(e),function(g){t[g]=e[g]}),t}return e}function p5(e,t,n){var c=[],g=[],x=!0;return function S(a){var U=n?d5(a):a,W={},he=!0,ae={node:U,node_:a,path:[].concat(c),parent:g[g.length-1],parents:g,key:c[c.length-1],isRoot:c.length===0,level:c.length,circular:null,update:function(Je,st){ae.isRoot||(ae.parent.node[ae.key]=Je),ae.node=Je,st&&(he=!1)},delete:function(Je){delete ae.parent.node[ae.key],Je&&(he=!1)},remove:function(Je){f5(ae.parent.node)?ae.parent.node.splice(ae.key,1):delete ae.parent.node[ae.key],Je&&(he=!1)},keys:null,before:function(Je){W.before=Je},after:function(Je){W.after=Je},pre:function(Je){W.pre=Je},post:function(Je){W.post=Je},stop:function(){x=!1},block:function(){he=!1}};if(!x)return ae;function ce(){if(typeof ae.node=="object"&&ae.node!==null){(!ae.keys||ae.node_!==ae.node)&&(ae.keys=A1(ae.node)),ae.isLeaf=ae.keys.length===0;for(var Je=0;Je<g.length;Je++)if(g[Je].node_===a){ae.circular=g[Je];break}}else ae.isLeaf=!0,ae.keys=null;ae.notLeaf=!ae.isLeaf,ae.notRoot=!ae.isRoot}ce();var be=t.call(ae,ae.node);return be!==void 0&&ae.update&&ae.update(be),W.before&&W.before.call(ae,ae.node),he&&(typeof ae.node=="object"&&ae.node!==null&&!ae.circular&&(g.push(ae),ce(),h1(ae.keys,function(Je,st){c.push(Je),W.pre&&W.pre.call(ae,ae.node[Je],Je);var Ye=S(ae.node[Je]);n&&f1.call(ae.node,Je)&&(ae.node[Je]=Ye.node),Ye.isLast=st===ae.keys.length-1,Ye.isFirst=st===0,W.post&&W.post.call(ae,Ye),c.pop()}),g.pop()),W.after&&W.after.call(ae,ae.node)),ae}(e).node}function Oh(e){this.value=e}Oh.prototype.get=function(e){for(var t=this.value,n=0;n<e.length;n++){var c=e[n];if(!t||!f1.call(t,c))return;t=t[c]}return t};Oh.prototype.has=function(e){for(var t=this.value,n=0;n<e.length;n++){var c=e[n];if(!t||!f1.call(t,c))return!1;t=t[c]}return!0};Oh.prototype.set=function(e,t){for(var n=this.value,c=0;c<e.length-1;c++){var g=e[c];f1.call(n,g)||(n[g]={}),n=n[g]}return n[e[c]]=t,t};Oh.prototype.map=function(e){return p5(this.value,e,!0)};Oh.prototype.forEach=function(e){return this.value=p5(this.value,e,!1),this.value};Oh.prototype.reduce=function(e,t){var n=arguments.length===1,c=n?this.value:t;return this.forEach(function(g){(!this.isRoot||!n)&&(c=e.call(this,c,g))}),c};Oh.prototype.paths=function(){var e=[];return this.forEach(function(){e.push(this.path)}),e};Oh.prototype.nodes=function(){var e=[];return this.forEach(function(){e.push(this.node)}),e};Oh.prototype.clone=function(){var e=[],t=[];return function n(c){for(var g=0;g<e.length;g++)if(e[g]===c)return t[g];if(typeof c=="object"&&c!==null){var x=d5(c);return e.push(c),t.push(x),h1(A1(c),function(S){x[S]=n(c[S])}),e.pop(),t.pop(),x}return c}(this.value)};function m5(e){return new Oh(e)}h1(A1(Oh.prototype),function(e){m5[e]=function(t){var n=[].slice.call(arguments,1),c=new Oh(t);return c[e].apply(c,n)}});var aN=m5,oN=vc;function vc(e){if(!(this instanceof vc))return new vc(e);this._bbox=e||[1/0,1/0,-1/0,-1/0],this._valid=!!e}vc.prototype.include=function(e){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[0]),this._bbox[3]=Math.max(this._bbox[3],e[1]),this};vc.prototype.equals=function(e){var t;return e instanceof vc?t=e.bbox():t=e,this._bbox[0]==t[0]&&this._bbox[1]==t[1]&&this._bbox[2]==t[2]&&this._bbox[3]==t[3]};vc.prototype.center=function(e){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null};vc.prototype.union=function(e){this._valid=!0;var t;return e instanceof vc?t=e.bbox():t=e,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[2]),this._bbox[3]=Math.max(this._bbox[3],t[3]),this};vc.prototype.bbox=function(){return this._valid?this._bbox:null};vc.prototype.contains=function(e){if(!e)return this._fastContains();if(!this._valid)return null;var t=e[0],n=e[1];return this._bbox[0]<=t&&this._bbox[1]<=n&&this._bbox[2]>=t&&this._bbox[3]>=n};vc.prototype.intersect=function(e){if(!this._valid)return null;var t;return e instanceof vc?t=e.bbox():t=e,!(this._bbox[0]>t[2]||this._bbox[2]<t[0]||this._bbox[3]<t[1]||this._bbox[1]>t[3])};vc.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var e="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",e)};vc.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var lN=YO,uN=aN,cN=oN,g5={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},hN=Object.keys(g5);E2.exports=function(e){return C2(e).bbox()};E2.exports.polygon=function(e){return C2(e).polygon()};E2.exports.bboxify=function(e){return uN(e).map(function(t){if(t){var n=hN.some(function(c){return t[c]?g5[c].indexOf(t.type)!==-1:!1});n&&(t.bbox=C2(t).bbox(),this.update(t))}})};function C2(e){for(var t=cN(),n=lN(e),c=0;c<n.length;c++)t.include(n[c]);return t}var Mn=function(e){e=e||{};var t=typeof e<"u"?e:{},n={},c;for(c in t)t.hasOwnProperty(c)&&(n[c]=t[c]);var g="";function x(De){return t.locateFile?t.locateFile(De,g):g+De}var S;document.currentScript&&(g=document.currentScript.src),g.indexOf("blob:")!==0?g=g.substr(0,g.lastIndexOf("/")+1):g="",S=function(Ge,At,kt){var o=new XMLHttpRequest;o.open("GET",Ge,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status==200||o.status==0&&o.response){At(o.response);return}var oi=dt(Ge);if(oi){At(oi.buffer);return}kt()},o.onerror=kt,o.send(null)};var a=t.print||console.log.bind(console),U=t.printErr||console.warn.bind(console);for(c in n)n.hasOwnProperty(c)&&(t[c]=n[c]);n=null,t.arguments&&t.arguments;var W=0,he=function(De){W=De},ae=function(){return W},ce=8;function be(De,Ge,At,kt){switch(At=At||"i8",At.charAt(At.length-1)==="*"&&(At="i32"),At){case"i1":bt[De>>0]=Ge;break;case"i8":bt[De>>0]=Ge;break;case"i16":$e[De>>1]=Ge;break;case"i32":pt[De>>2]=Ge;break;case"i64":pn=[Ge>>>0,(Gn=Ge,+xn(Gn)>=1?Gn>0?(rn(+Yt(Gn/4294967296),4294967295)|0)>>>0:~~+bn((Gn-+(~~Gn>>>0))/4294967296)>>>0:0)],pt[De>>2]=pn[0],pt[De+4>>2]=pn[1];break;case"float":ut[De>>2]=Ge;break;case"double":Nt[De>>3]=Ge;break;default:Ke("invalid type for setValue: "+At)}}function Je(De,Ge,At){switch(Ge=Ge||"i8",Ge.charAt(Ge.length-1)==="*"&&(Ge="i32"),Ge){case"i1":return bt[De>>0];case"i8":return bt[De>>0];case"i16":return $e[De>>1];case"i32":return pt[De>>2];case"i64":return pt[De>>2];case"float":return ut[De>>2];case"double":return Nt[De>>3];default:Ke("invalid type for getValue: "+Ge)}return null}var st=!1;function Ye(De,Ge){De||Ke("Assertion failed: "+Ge)}function it(De){var Ge=t["_"+De];return Ye(Ge,"Cannot call unknown function "+De+", make sure it is exported"),Ge}function ct(De,Ge,At,kt,o){var ke={string:function(bi){var Jt=0;if(bi!=null&&bi!==0){var wn=(bi.length<<2)+1;Jt=$(wn),at(bi,Jt,wn)}return Jt},array:function(bi){var Jt=$(bi.length);return _t(bi,Jt),Jt}};function oi(bi){return Ge==="string"?Oe(bi):Ge==="boolean"?!!bi:bi}var fi=it(De),Ai=[],ti=0;if(kt)for(var li=0;li<kt.length;li++){var Bi=ke[At[li]];Bi?(ti===0&&(ti=de()),Ai[li]=Bi(kt[li])):Ai[li]=kt[li]}var vi=fi.apply(null,Ai);return vi=oi(vi),ti!==0&&ie(ti),vi}function Tt(De,Ge,At,kt){At=At||[];var o=At.every(function(oi){return oi==="number"}),ke=Ge!=="string";return ke&&o&&!kt?it(De):function(){return ct(De,Ge,At,arguments)}}var zt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Rt(De,Ge,At){for(var kt=Ge+At,o=Ge;De[o]&&!(o>=kt);)++o;if(o-Ge>16&&De.subarray&&zt)return zt.decode(De.subarray(Ge,o));for(var ke="";Ge<o;){var oi=De[Ge++];if(!(oi&128)){ke+=String.fromCharCode(oi);continue}var fi=De[Ge++]&63;if((oi&224)==192){ke+=String.fromCharCode((oi&31)<<6|fi);continue}var Ai=De[Ge++]&63;if((oi&240)==224?oi=(oi&15)<<12|fi<<6|Ai:oi=(oi&7)<<18|fi<<12|Ai<<6|De[Ge++]&63,oi<65536)ke+=String.fromCharCode(oi);else{var ti=oi-65536;ke+=String.fromCharCode(55296|ti>>10,56320|ti&1023)}}return ke}function Oe(De,Ge){return De?Rt(lt,De,Ge):""}function jt(De,Ge,At,kt){if(!(kt>0))return 0;for(var o=At,ke=At+kt-1,oi=0;oi<De.length;++oi){var fi=De.charCodeAt(oi);if(fi>=55296&&fi<=57343){var Ai=De.charCodeAt(++oi);fi=65536+((fi&1023)<<10)|Ai&1023}if(fi<=127){if(At>=ke)break;Ge[At++]=fi}else if(fi<=2047){if(At+1>=ke)break;Ge[At++]=192|fi>>6,Ge[At++]=128|fi&63}else if(fi<=65535){if(At+2>=ke)break;Ge[At++]=224|fi>>12,Ge[At++]=128|fi>>6&63,Ge[At++]=128|fi&63}else{if(At+3>=ke)break;Ge[At++]=240|fi>>18,Ge[At++]=128|fi>>12&63,Ge[At++]=128|fi>>6&63,Ge[At++]=128|fi&63}}return Ge[At]=0,At-o}function at(De,Ge,At){return jt(De,lt,Ge,At)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function _t(De,Ge){bt.set(De,Ge)}function mt(De,Ge){return De%Ge>0&&(De+=Ge-De%Ge),De}var xt,bt,lt,$e,pt,ut,Nt;function Bt(De){xt=De,t.HEAP8=bt=new Int8Array(De),t.HEAP16=$e=new Int16Array(De),t.HEAP32=pt=new Int32Array(De),t.HEAPU8=lt=new Uint8Array(De),t.HEAPU16=new Uint16Array(De),t.HEAPU32=new Uint32Array(De),t.HEAPF32=ut=new Float32Array(De),t.HEAPF64=Nt=new Float64Array(De)}var Ot=5266928,gi=24016,Ii=t.TOTAL_MEMORY||33554432;t.buffer?xt=t.buffer:xt=new ArrayBuffer(Ii),Ii=xt.byteLength,Bt(xt),pt[gi>>2]=Ot;function Ci(De){for(;De.length>0;){var Ge=De.shift();if(typeof Ge=="function"){Ge();continue}var At=Ge.func;typeof At=="number"?Ge.arg===void 0?t.dynCall_v(At):t.dynCall_vi(At,Ge.arg):At(Ge.arg===void 0?null:Ge.arg)}}var Ri=[],Ki=[],Hi=[],Ni=[];function nn(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)zi(t.preRun.shift());Ci(Ri)}function vn(){Ci(Ki)}function Ei(){Ci(Hi)}function mi(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)Oi(t.postRun.shift());Ci(Ni)}function zi(De){Ri.unshift(De)}function Oi(De){Ni.unshift(De)}var xn=Math.abs,bn=Math.ceil,Yt=Math.floor,rn=Math.min,Xt=0,Ji=null;function mr(De){Xt++,t.monitorRunDependencies&&t.monitorRunDependencies(Xt)}function ci(De){if(Xt--,t.monitorRunDependencies&&t.monitorRunDependencies(Xt),Xt==0&&Ji){var Ge=Ji;Ji=null,Ge()}}t.preloadedImages={},t.preloadedAudios={};var sn=null,lr="data:application/octet-stream;base64,";function On(De){return String.prototype.startsWith?De.startsWith(lr):De.indexOf(lr)===0}var Gn,pn;sn="data:application/octet-stream;base64,AAAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAABAAAAAMAAAAGAAAABQAAAAIAAAAAAAAAAgAAAAMAAAABAAAABAAAAAYAAAAAAAAABQAAAAMAAAAGAAAABAAAAAUAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAABAAAABQAAAAIAAAAAAAAAAQAAAAMAAAAGAAAABAAAAAYAAAAAAAAABQAAAAIAAAABAAAABAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABgAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAAAAAAABgAAAAAAAAADAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAUAAAAEAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAEAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAUAAAACAAAABAAAAAMAAAAIAAAAAQAAAAcAAAAGAAAACQAAAAAAAAADAAAAAgAAAAIAAAAGAAAACgAAAAsAAAAAAAAAAQAAAAUAAAADAAAADQAAAAEAAAAHAAAABAAAAAwAAAAAAAAABAAAAH8AAAAPAAAACAAAAAMAAAAAAAAADAAAAAUAAAACAAAAEgAAAAoAAAAIAAAAAAAAABAAAAAGAAAADgAAAAsAAAARAAAAAQAAAAkAAAACAAAABwAAABUAAAAJAAAAEwAAAAMAAAANAAAAAQAAAAgAAAAFAAAAFgAAABAAAAAEAAAAAAAAAA8AAAAJAAAAEwAAAA4AAAAUAAAAAQAAAAcAAAAGAAAACgAAAAsAAAAYAAAAFwAAAAUAAAACAAAAEgAAAAsAAAARAAAAFwAAABkAAAACAAAABgAAAAoAAAAMAAAAHAAAAA0AAAAaAAAABAAAAA8AAAADAAAADQAAABoAAAAVAAAAHQAAAAMAAAAMAAAABwAAAA4AAAB/AAAAEQAAABsAAAAJAAAAFAAAAAYAAAAPAAAAFgAAABwAAAAfAAAABAAAAAgAAAAMAAAAEAAAABIAAAAhAAAAHgAAAAgAAAAFAAAAFgAAABEAAAALAAAADgAAAAYAAAAjAAAAGQAAABsAAAASAAAAGAAAAB4AAAAgAAAABQAAAAoAAAAQAAAAEwAAACIAAAAUAAAAJAAAAAcAAAAVAAAACQAAABQAAAAOAAAAEwAAAAkAAAAoAAAAGwAAACQAAAAVAAAAJgAAABMAAAAiAAAADQAAAB0AAAAHAAAAFgAAABAAAAApAAAAIQAAAA8AAAAIAAAAHwAAABcAAAAYAAAACwAAAAoAAAAnAAAAJQAAABkAAAAYAAAAfwAAACAAAAAlAAAACgAAABcAAAASAAAAGQAAABcAAAARAAAACwAAAC0AAAAnAAAAIwAAABoAAAAqAAAAHQAAACsAAAAMAAAAHAAAAA0AAAAbAAAAKAAAACMAAAAuAAAADgAAABQAAAARAAAAHAAAAB8AAAAqAAAALAAAAAwAAAAPAAAAGgAAAB0AAAArAAAAJgAAAC8AAAANAAAAGgAAABUAAAAeAAAAIAAAADAAAAAyAAAAEAAAABIAAAAhAAAAHwAAACkAAAAsAAAANQAAAA8AAAAWAAAAHAAAACAAAAAeAAAAGAAAABIAAAA0AAAAMgAAACUAAAAhAAAAHgAAADEAAAAwAAAAFgAAABAAAAApAAAAIgAAABMAAAAmAAAAFQAAADYAAAAkAAAAMwAAACMAAAAuAAAALQAAADgAAAARAAAAGwAAABkAAAAkAAAAFAAAACIAAAATAAAANwAAACgAAAA2AAAAJQAAACcAAAA0AAAAOQAAABgAAAAXAAAAIAAAACYAAAB/AAAAIgAAADMAAAAdAAAALwAAABUAAAAnAAAAJQAAABkAAAAXAAAAOwAAADkAAAAtAAAAKAAAABsAAAAkAAAAFAAAADwAAAAuAAAANwAAACkAAAAxAAAANQAAAD0AAAAWAAAAIQAAAB8AAAAqAAAAOgAAACsAAAA+AAAAHAAAACwAAAAaAAAAKwAAAD4AAAAvAAAAQAAAABoAAAAqAAAAHQAAACwAAAA1AAAAOgAAAEEAAAAcAAAAHwAAACoAAAAtAAAAJwAAACMAAAAZAAAAPwAAADsAAAA4AAAALgAAADwAAAA4AAAARAAAABsAAAAoAAAAIwAAAC8AAAAmAAAAKwAAAB0AAABFAAAAMwAAAEAAAAAwAAAAMQAAAB4AAAAhAAAAQwAAAEIAAAAyAAAAMQAAAH8AAAA9AAAAQgAAACEAAAAwAAAAKQAAADIAAAAwAAAAIAAAAB4AAABGAAAAQwAAADQAAAAzAAAARQAAADYAAABHAAAAJgAAAC8AAAAiAAAANAAAADkAAABGAAAASgAAACAAAAAlAAAAMgAAADUAAAA9AAAAQQAAAEsAAAAfAAAAKQAAACwAAAA2AAAARwAAADcAAABJAAAAIgAAADMAAAAkAAAANwAAACgAAAA2AAAAJAAAAEgAAAA8AAAASQAAADgAAABEAAAAPwAAAE0AAAAjAAAALgAAAC0AAAA5AAAAOwAAAEoAAABOAAAAJQAAACcAAAA0AAAAOgAAAH8AAAA+AAAATAAAACwAAABBAAAAKgAAADsAAAA/AAAATgAAAE8AAAAnAAAALQAAADkAAAA8AAAASAAAAEQAAABQAAAAKAAAADcAAAAuAAAAPQAAADUAAAAxAAAAKQAAAFEAAABLAAAAQgAAAD4AAAArAAAAOgAAACoAAABSAAAAQAAAAEwAAAA/AAAAfwAAADgAAAAtAAAATwAAADsAAABNAAAAQAAAAC8AAAA+AAAAKwAAAFQAAABFAAAAUgAAAEEAAAA6AAAANQAAACwAAABWAAAATAAAAEsAAABCAAAAQwAAAFEAAABVAAAAMQAAADAAAAA9AAAAQwAAAEIAAAAyAAAAMAAAAFcAAABVAAAARgAAAEQAAAA4AAAAPAAAAC4AAABaAAAATQAAAFAAAABFAAAAMwAAAEAAAAAvAAAAWQAAAEcAAABUAAAARgAAAEMAAAA0AAAAMgAAAFMAAABXAAAASgAAAEcAAABZAAAASQAAAFsAAAAzAAAARQAAADYAAABIAAAAfwAAAEkAAAA3AAAAUAAAADwAAABYAAAASQAAAFsAAABIAAAAWAAAADYAAABHAAAANwAAAEoAAABOAAAAUwAAAFwAAAA0AAAAOQAAAEYAAABLAAAAQQAAAD0AAAA1AAAAXgAAAFYAAABRAAAATAAAAFYAAABSAAAAYAAAADoAAABBAAAAPgAAAE0AAAA/AAAARAAAADgAAABdAAAATwAAAFoAAABOAAAASgAAADsAAAA5AAAAXwAAAFwAAABPAAAATwAAAE4AAAA/AAAAOwAAAF0AAABfAAAATQAAAFAAAABEAAAASAAAADwAAABjAAAAWgAAAFgAAABRAAAAVQAAAF4AAABlAAAAPQAAAEIAAABLAAAAUgAAAGAAAABUAAAAYgAAAD4AAABMAAAAQAAAAFMAAAB/AAAASgAAAEYAAABkAAAAVwAAAFwAAABUAAAARQAAAFIAAABAAAAAYQAAAFkAAABiAAAAVQAAAFcAAABlAAAAZgAAAEIAAABDAAAAUQAAAFYAAABMAAAASwAAAEEAAABoAAAAYAAAAF4AAABXAAAAUwAAAGYAAABkAAAAQwAAAEYAAABVAAAAWAAAAEgAAABbAAAASQAAAGMAAABQAAAAaQAAAFkAAABhAAAAWwAAAGcAAABFAAAAVAAAAEcAAABaAAAATQAAAFAAAABEAAAAagAAAF0AAABjAAAAWwAAAEkAAABZAAAARwAAAGkAAABYAAAAZwAAAFwAAABTAAAATgAAAEoAAABsAAAAZAAAAF8AAABdAAAATwAAAFoAAABNAAAAbQAAAF8AAABqAAAAXgAAAFYAAABRAAAASwAAAGsAAABoAAAAZQAAAF8AAABcAAAATwAAAE4AAABtAAAAbAAAAF0AAABgAAAAaAAAAGIAAABuAAAATAAAAFYAAABSAAAAYQAAAH8AAABiAAAAVAAAAGcAAABZAAAAbwAAAGIAAABuAAAAYQAAAG8AAABSAAAAYAAAAFQAAABjAAAAUAAAAGkAAABYAAAAagAAAFoAAABxAAAAZAAAAGYAAABTAAAAVwAAAGwAAAByAAAAXAAAAGUAAABmAAAAawAAAHAAAABRAAAAVQAAAF4AAABmAAAAZQAAAFcAAABVAAAAcgAAAHAAAABkAAAAZwAAAFsAAABhAAAAWQAAAHQAAABpAAAAbwAAAGgAAABrAAAAbgAAAHMAAABWAAAAXgAAAGAAAABpAAAAWAAAAGcAAABbAAAAcQAAAGMAAAB0AAAAagAAAF0AAABjAAAAWgAAAHUAAABtAAAAcQAAAGsAAAB/AAAAZQAAAF4AAABzAAAAaAAAAHAAAABsAAAAZAAAAF8AAABcAAAAdgAAAHIAAABtAAAAbQAAAGwAAABdAAAAXwAAAHUAAAB2AAAAagAAAG4AAABiAAAAaAAAAGAAAAB3AAAAbwAAAHMAAABvAAAAYQAAAG4AAABiAAAAdAAAAGcAAAB3AAAAcAAAAGsAAABmAAAAZQAAAHgAAABzAAAAcgAAAHEAAABjAAAAdAAAAGkAAAB1AAAAagAAAHkAAAByAAAAcAAAAGQAAABmAAAAdgAAAHgAAABsAAAAcwAAAG4AAABrAAAAaAAAAHgAAAB3AAAAcAAAAHQAAABnAAAAdwAAAG8AAABxAAAAaQAAAHkAAAB1AAAAfwAAAG0AAAB2AAAAcQAAAHkAAABqAAAAdgAAAHgAAABsAAAAcgAAAHUAAAB5AAAAbQAAAHcAAABvAAAAcwAAAG4AAAB5AAAAdAAAAHgAAAB4AAAAcwAAAHIAAABwAAAAeQAAAHcAAAB2AAAAeQAAAHQAAAB4AAAAdwAAAHUAAABxAAAAdgAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAQAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAADAAAABQAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAgAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAABQAAAAUAAAAAAAAAAAAAAP////8BAAAAAAAAAAMAAAAEAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAQAAAP//////////AQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAIAAAAAAAAAAAAAAAEAAAACAAAABgAAAAQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAoAAAACAAAAAAAAAAAAAAABAAAAAQAAAAUAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAAAAAAAAAAAAAEAAAADAAAABwAAAAYAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAJAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAAAAAAAAAAABAAAACwAAAA8AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAgAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAAAAAAAAAAABAAAADAAAABAAAAAMAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAEAAAAKAAAAEwAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAA0AAAARAAAADQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAAAAAAAAAAAAAEAAAAOAAAAEgAAAA8AAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAAAAAABAAAA//////////8TAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABIAAAAAAAAAGAAAAAAAAAAhAAAAAAAAAB4AAAAAAAAAIAAAAAMAAAAxAAAAAQAAADAAAAADAAAAMgAAAAMAAAAIAAAAAAAAAAUAAAAFAAAACgAAAAUAAAAWAAAAAAAAABAAAAAAAAAAEgAAAAAAAAApAAAAAQAAACEAAAAAAAAAHgAAAAAAAAAEAAAAAAAAAAAAAAAFAAAAAgAAAAUAAAAPAAAAAQAAAAgAAAAAAAAABQAAAAUAAAAfAAAAAQAAABYAAAAAAAAAEAAAAAAAAAACAAAAAAAAAAYAAAAAAAAADgAAAAAAAAAKAAAAAAAAAAsAAAAAAAAAEQAAAAMAAAAYAAAAAQAAABcAAAADAAAAGQAAAAMAAAAAAAAAAAAAAAEAAAAFAAAACQAAAAUAAAAFAAAAAAAAAAIAAAAAAAAABgAAAAAAAAASAAAAAQAAAAoAAAAAAAAACwAAAAAAAAAEAAAAAQAAAAMAAAAFAAAABwAAAAUAAAAIAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAQAAAAAQAAAAUAAAAAAAAAAgAAAAAAAAAHAAAAAAAAABUAAAAAAAAAJgAAAAAAAAAJAAAAAAAAABMAAAAAAAAAIgAAAAMAAAAOAAAAAQAAABQAAAADAAAAJAAAAAMAAAADAAAAAAAAAA0AAAAFAAAAHQAAAAUAAAABAAAAAAAAAAcAAAAAAAAAFQAAAAAAAAAGAAAAAQAAAAkAAAAAAAAAEwAAAAAAAAAEAAAAAgAAAAwAAAAFAAAAGgAAAAUAAAAAAAAAAQAAAAMAAAAAAAAADQAAAAUAAAACAAAAAQAAAAEAAAAAAAAABwAAAAAAAAAaAAAAAAAAACoAAAAAAAAAOgAAAAAAAAAdAAAAAAAAACsAAAAAAAAAPgAAAAMAAAAmAAAAAQAAAC8AAAADAAAAQAAAAAMAAAAMAAAAAAAAABwAAAAFAAAALAAAAAUAAAANAAAAAAAAABoAAAAAAAAAKgAAAAAAAAAVAAAAAQAAAB0AAAAAAAAAKwAAAAAAAAAEAAAAAwAAAA8AAAAFAAAAHwAAAAUAAAADAAAAAQAAAAwAAAAAAAAAHAAAAAUAAAAHAAAAAQAAAA0AAAAAAAAAGgAAAAAAAAAfAAAAAAAAACkAAAAAAAAAMQAAAAAAAAAsAAAAAAAAADUAAAAAAAAAPQAAAAMAAAA6AAAAAQAAAEEAAAADAAAASwAAAAMAAAAPAAAAAAAAABYAAAAFAAAAIQAAAAUAAAAcAAAAAAAAAB8AAAAAAAAAKQAAAAAAAAAqAAAAAQAAACwAAAAAAAAANQAAAAAAAAAEAAAABAAAAAgAAAAFAAAAEAAAAAUAAAAMAAAAAQAAAA8AAAAAAAAAFgAAAAUAAAAaAAAAAQAAABwAAAAAAAAAHwAAAAAAAAAyAAAAAAAAADAAAAAAAAAAMQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAIQAAAAMAAAAYAAAAAwAAABIAAAADAAAAEAAAAAMAAABGAAAAAAAAAEMAAAAAAAAAQgAAAAMAAAA0AAAAAwAAADIAAAAAAAAAMAAAAAAAAAAlAAAAAwAAACAAAAAAAAAAHgAAAAMAAABTAAAAAAAAAFcAAAADAAAAVQAAAAMAAABKAAAAAwAAAEYAAAAAAAAAQwAAAAAAAAA5AAAAAQAAADQAAAADAAAAMgAAAAAAAAAZAAAAAAAAABcAAAAAAAAAGAAAAAMAAAARAAAAAAAAAAsAAAADAAAACgAAAAMAAAAOAAAAAwAAAAYAAAADAAAAAgAAAAMAAAAtAAAAAAAAACcAAAAAAAAAJQAAAAMAAAAjAAAAAwAAABkAAAAAAAAAFwAAAAAAAAAbAAAAAwAAABEAAAAAAAAACwAAAAMAAAA/AAAAAAAAADsAAAADAAAAOQAAAAMAAAA4AAAAAwAAAC0AAAAAAAAAJwAAAAAAAAAuAAAAAwAAACMAAAADAAAAGQAAAAAAAAAkAAAAAAAAABQAAAAAAAAADgAAAAMAAAAiAAAAAAAAABMAAAADAAAACQAAAAMAAAAmAAAAAwAAABUAAAADAAAABwAAAAMAAAA3AAAAAAAAACgAAAAAAAAAGwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAFAAAAAAAAAAzAAAAAwAAACIAAAAAAAAAEwAAAAMAAABIAAAAAAAAADwAAAADAAAALgAAAAMAAABJAAAAAwAAADcAAAAAAAAAKAAAAAAAAABHAAAAAwAAADYAAAADAAAAJAAAAAAAAABAAAAAAAAAAC8AAAAAAAAAJgAAAAMAAAA+AAAAAAAAACsAAAADAAAAHQAAAAMAAAA6AAAAAwAAACoAAAADAAAAGgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAMwAAAAMAAABSAAAAAwAAAEAAAAAAAAAALwAAAAAAAABMAAAAAwAAAD4AAAAAAAAAKwAAAAMAAABhAAAAAAAAAFkAAAADAAAARwAAAAMAAABiAAAAAwAAAFQAAAAAAAAARQAAAAAAAABgAAAAAwAAAFIAAAADAAAAQAAAAAAAAABLAAAAAAAAAEEAAAAAAAAAOgAAAAMAAAA9AAAAAAAAADUAAAADAAAALAAAAAMAAAAxAAAAAwAAACkAAAADAAAAHwAAAAMAAABeAAAAAAAAAFYAAAAAAAAATAAAAAMAAABRAAAAAwAAAEsAAAAAAAAAQQAAAAAAAABCAAAAAwAAAD0AAAAAAAAANQAAAAMAAABrAAAAAAAAAGgAAAADAAAAYAAAAAMAAABlAAAAAwAAAF4AAAAAAAAAVgAAAAAAAABVAAAAAwAAAFEAAAADAAAASwAAAAAAAAA5AAAAAAAAADsAAAAAAAAAPwAAAAMAAABKAAAAAAAAAE4AAAADAAAATwAAAAMAAABTAAAAAwAAAFwAAAADAAAAXwAAAAMAAAAlAAAAAAAAACcAAAADAAAALQAAAAMAAAA0AAAAAAAAADkAAAAAAAAAOwAAAAAAAABGAAAAAwAAAEoAAAAAAAAATgAAAAMAAAAYAAAAAAAAABcAAAADAAAAGQAAAAMAAAAgAAAAAwAAACUAAAAAAAAAJwAAAAMAAAAyAAAAAwAAADQAAAAAAAAAOQAAAAAAAAAuAAAAAAAAADwAAAAAAAAASAAAAAMAAAA4AAAAAAAAAEQAAAADAAAAUAAAAAMAAAA/AAAAAwAAAE0AAAADAAAAWgAAAAMAAAAbAAAAAAAAACgAAAADAAAANwAAAAMAAAAjAAAAAAAAAC4AAAAAAAAAPAAAAAAAAAAtAAAAAwAAADgAAAAAAAAARAAAAAMAAAAOAAAAAAAAABQAAAADAAAAJAAAAAMAAAARAAAAAwAAABsAAAAAAAAAKAAAAAMAAAAZAAAAAwAAACMAAAAAAAAALgAAAAAAAABHAAAAAAAAAFkAAAAAAAAAYQAAAAMAAABJAAAAAAAAAFsAAAADAAAAZwAAAAMAAABIAAAAAwAAAFgAAAADAAAAaQAAAAMAAAAzAAAAAAAAAEUAAAADAAAAVAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAWQAAAAAAAAA3AAAAAwAAAEkAAAAAAAAAWwAAAAMAAAAmAAAAAAAAAC8AAAADAAAAQAAAAAMAAAAiAAAAAwAAADMAAAAAAAAARQAAAAMAAAAkAAAAAwAAADYAAAAAAAAARwAAAAAAAABgAAAAAAAAAGgAAAAAAAAAawAAAAMAAABiAAAAAAAAAG4AAAADAAAAcwAAAAMAAABhAAAAAwAAAG8AAAADAAAAdwAAAAMAAABMAAAAAAAAAFYAAAADAAAAXgAAAAMAAABSAAAAAAAAAGAAAAAAAAAAaAAAAAAAAABUAAAAAwAAAGIAAAAAAAAAbgAAAAMAAAA6AAAAAAAAAEEAAAADAAAASwAAAAMAAAA+AAAAAwAAAEwAAAAAAAAAVgAAAAMAAABAAAAAAwAAAFIAAAAAAAAAYAAAAAAAAABVAAAAAAAAAFcAAAAAAAAAUwAAAAMAAABlAAAAAAAAAGYAAAADAAAAZAAAAAMAAABrAAAAAwAAAHAAAAADAAAAcgAAAAMAAABCAAAAAAAAAEMAAAADAAAARgAAAAMAAABRAAAAAAAAAFUAAAAAAAAAVwAAAAAAAABeAAAAAwAAAGUAAAAAAAAAZgAAAAMAAAAxAAAAAAAAADAAAAADAAAAMgAAAAMAAAA9AAAAAwAAAEIAAAAAAAAAQwAAAAMAAABLAAAAAwAAAFEAAAAAAAAAVQAAAAAAAABfAAAAAAAAAFwAAAAAAAAAUwAAAAAAAABPAAAAAAAAAE4AAAAAAAAASgAAAAMAAAA/AAAAAQAAADsAAAADAAAAOQAAAAMAAABtAAAAAAAAAGwAAAAAAAAAZAAAAAUAAABdAAAAAQAAAF8AAAAAAAAAXAAAAAAAAABNAAAAAQAAAE8AAAAAAAAATgAAAAAAAAB1AAAABAAAAHYAAAAFAAAAcgAAAAUAAABqAAAAAQAAAG0AAAAAAAAAbAAAAAAAAABaAAAAAQAAAF0AAAABAAAAXwAAAAAAAABaAAAAAAAAAE0AAAAAAAAAPwAAAAAAAABQAAAAAAAAAEQAAAAAAAAAOAAAAAMAAABIAAAAAQAAADwAAAADAAAALgAAAAMAAABqAAAAAAAAAF0AAAAAAAAATwAAAAUAAABjAAAAAQAAAFoAAAAAAAAATQAAAAAAAABYAAAAAQAAAFAAAAAAAAAARAAAAAAAAAB1AAAAAwAAAG0AAAAFAAAAXwAAAAUAAABxAAAAAQAAAGoAAAAAAAAAXQAAAAAAAABpAAAAAQAAAGMAAAABAAAAWgAAAAAAAABpAAAAAAAAAFgAAAAAAAAASAAAAAAAAABnAAAAAAAAAFsAAAAAAAAASQAAAAMAAABhAAAAAQAAAFkAAAADAAAARwAAAAMAAABxAAAAAAAAAGMAAAAAAAAAUAAAAAUAAAB0AAAAAQAAAGkAAAAAAAAAWAAAAAAAAABvAAAAAQAAAGcAAAAAAAAAWwAAAAAAAAB1AAAAAgAAAGoAAAAFAAAAWgAAAAUAAAB5AAAAAQAAAHEAAAAAAAAAYwAAAAAAAAB3AAAAAQAAAHQAAAABAAAAaQAAAAAAAAB3AAAAAAAAAG8AAAAAAAAAYQAAAAAAAABzAAAAAAAAAG4AAAAAAAAAYgAAAAMAAABrAAAAAQAAAGgAAAADAAAAYAAAAAMAAAB5AAAAAAAAAHQAAAAAAAAAZwAAAAUAAAB4AAAAAQAAAHcAAAAAAAAAbwAAAAAAAABwAAAAAQAAAHMAAAAAAAAAbgAAAAAAAAB1AAAAAQAAAHEAAAAFAAAAaQAAAAUAAAB2AAAAAQAAAHkAAAAAAAAAdAAAAAAAAAByAAAAAQAAAHgAAAABAAAAdwAAAAAAAAByAAAAAAAAAHAAAAAAAAAAawAAAAAAAABkAAAAAAAAAGYAAAAAAAAAZQAAAAMAAABTAAAAAQAAAFcAAAADAAAAVQAAAAMAAAB2AAAAAAAAAHgAAAAAAAAAcwAAAAUAAABsAAAAAQAAAHIAAAAAAAAAcAAAAAAAAABcAAAAAQAAAGQAAAAAAAAAZgAAAAAAAAB1AAAAAAAAAHkAAAAFAAAAdwAAAAUAAABtAAAAAQAAAHYAAAAAAAAAeAAAAAAAAABfAAAAAQAAAGwAAAABAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB+ogX28rbpPxqumpJv+fM/165tC4ns9D+XaEnTqUsEQFrOtNlC4PA/3U+0XG6P9b9TdUUBxTTjP4PUp8ex1ty/B1rD/EN43z+lcDi6LLrZP/a45NWEHMY/oJ5ijLDZ+j/xw3rjxWPjP2B8A46ioQdAotff3wla2z+FMSpA1jj+v6b5Y1mtPbS/cIu8K0F457/2esiyJpDNv98k5Ts2NeA/pvljWa09tD88ClUJ60MDQPZ6yLImkM0/4ONKxa0UBcD2uOTVhBzGv5G7JRxGave/8cN648Vj47+HCwtkjAXIv6LX398JWtu/qyheaCAL9D9TdUUBxTTjv4gyTxslhwVAB1rD/EN4378EH/28teoFwH6iBfbytum/F6ztFYdK/r/Xrm0Liez0vwcS6wNGWeO/Ws602ULg8L9TCtRLiLT8P8pi5RexJsw/BlIKPVwR5T95Wyu0/QjnP5PjoT7YYcu/mBhKZ6zrwj8wRYS7NebuP3qW6geh+Ls/SLrixebL3r+pcyymN9XrPwmkNHp7xec/GWNMZVAA17+82s+x2BLiPwn2ytbJ9ek/LgEH1sMS1j8yp/2LhTfeP+SnWwtQBbu/d38gkp5X7z8ytsuHaADGPzUYObdf1+m/7IauECWhwz+cjSACjzniP76Z+wUhN9K/1+GEKzup67+/GYr/04baPw6idWOvsuc/ZedTWsRa5b/EJQOuRzi0v/OncYhHPes/h49PixY53j+i8wWfC03Nvw2idWOvsue/ZedTWsRa5T/EJQOuRzi0P/KncYhHPeu/iY9PixY53r+i8wWfC03NP9anWwtQBbs/d38gkp5X778ytsuHaADGvzUYObdf1+k/74auECWhw7+cjSACjzniv8CZ+wUhN9I/1uGEKzup6z+/GYr/04bavwmkNHp7xee/F2NMZVAA1z+82s+x2BLivwr2ytbJ9em/KwEH1sMS1r8yp/2LhTfev81i5RexJsy/BlIKPVwR5b95Wyu0/Qjnv5DjoT7YYcs/nBhKZ6zrwr8wRYS7Nebuv3OW6geh+Lu/SLrixebL3j+pcyymN9Xrv8rHIFfWehZAMBwUdlo0DECTUc17EOb2PxpVB1SWChdAzjbhb9pTDUDQhmdvECX5P9FlMKCC9+g/IIAzjELgE0DajDngMv8GQFhWDmDPjNs/y1guLh96EkAxPi8k7DIEQJCc4URlhRhA3eLKKLwkEECqpNAyTBD/P6xpjXcDiwVAFtl//cQm4z+Ibt3XKiYTQM7mCLUb3QdAoM1t8yVv7D8aLZv2Nk8UQEAJPV5nQwxAtSsfTCoE9z9TPjXLXIIWQBVanC5W9AtAYM3d7Adm9j++5mQz1FoWQBUThyaVBghAwH5muQsV7T89Q1qv82MUQJoWGOfNuBdAzrkClkmwDkDQjKq77t37Py+g0dtitsE/ZwAMTwVPEUBojepluNwBQGYbtuW+t9w/HNWIJs6MEkDTNuQUSlgEQKxktPP5TcQ/ixbLB8JjEUCwuWjXMQYCQAS/R09FkRdAowpiZjhhDkB7LmlczD/7P01iQmhhsAVAnrtTwDy84z/Z6jfQ2TgTQChOCXMnWwpAhrW3daoz8z/HYJvVPI4VQLT3ik5FcA5Angi7LOZd+z+NNVzDy5gXQBXdvVTFUA1AYNMgOeYe+T8+qHXGCwkXQKQTOKwa5AJA8gFVoEMW0T+FwzJyttIRQAEAAAD/////BwAAAP////8xAAAA/////1cBAAD/////YQkAAP////+nQQAA/////5HLAQD/////95AMAP/////B9lcAAAAAAAAAAAAAAAAAAgAAAP////8OAAAA/////2IAAAD/////rgIAAP/////CEgAA/////06DAAD/////IpcDAP/////uIRkA/////4LtrwAAAAAAAAAAAAAAAAAAAAAAAgAAAP//////////AQAAAAMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////wIAAAD//////////wEAAAAAAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA/////////////////////wEAAAD///////////////8CAAAA////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD///////////////////////////////8CAAAA////////////////AQAAAP////////////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAAAQAAAP//////////AgAAAP//////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAAEAAAD//////////wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAgAAAAAAAAACAAAAAQAAAAEAAAACAAAAAgAAAAAAAAAFAAAABQAAAAAAAAACAAAAAgAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACAAAAAAAAAAUAAAAGAAAAAAAAAAIAAAACAAAAAwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAAAAAAAgAAAAEAAAADAAAAAgAAAAIAAAAAAAAABQAAAAcAAAAAAAAAAgAAAAIAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAACAAAAAQAAAAQAAAACAAAAAgAAAAAAAAAFAAAACAAAAAAAAAACAAAAAgAAAAMAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAUAAAAJAAAAAAAAAAIAAAACAAAAAwAAAAUAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAIAAAACAAAAAAAAAAMAAAAOAAAAAgAAAAAAAAACAAAAAwAAAAAAAAAAAAAAAgAAAAIAAAADAAAABgAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAgAAAAIAAAAAAAAAAwAAAAoAAAACAAAAAAAAAAIAAAADAAAAAQAAAAAAAAACAAAAAgAAAAMAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAgAAAAAAAAADAAAACwAAAAIAAAAAAAAAAgAAAAMAAAACAAAAAAAAAAIAAAACAAAAAwAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAACAAAAAAAAAAMAAAAMAAAAAgAAAAAAAAACAAAAAwAAAAMAAAAAAAAAAgAAAAIAAAADAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAIAAAAAAAAAAwAAAA0AAAACAAAAAAAAAAIAAAADAAAABAAAAAAAAAACAAAAAgAAAAMAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAgAAAAAAAAADAAAABgAAAAIAAAAAAAAAAgAAAAMAAAAPAAAAAAAAAAIAAAACAAAAAwAAAAsAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAIAAAACAAAAAAAAAAMAAAAHAAAAAgAAAAAAAAACAAAAAwAAABAAAAAAAAAAAgAAAAIAAAADAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAIAAAAAAAAAAwAAAAgAAAACAAAAAAAAAAIAAAADAAAAEQAAAAAAAAACAAAAAgAAAAMAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAACAAAAAgAAAAAAAAADAAAACQAAAAIAAAAAAAAAAgAAAAMAAAASAAAAAAAAAAIAAAACAAAAAwAAAA4AAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAACAAAAAAAAAAMAAAAFAAAAAgAAAAAAAAACAAAAAwAAABMAAAAAAAAAAgAAAAIAAAADAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAgAAAAAAAAACAAAAAQAAABMAAAACAAAAAgAAAAAAAAAFAAAACgAAAAAAAAACAAAAAgAAAAMAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABEAAAACAAAAAAAAAAIAAAABAAAADwAAAAIAAAACAAAAAAAAAAUAAAALAAAAAAAAAAIAAAACAAAAAwAAABEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAIAAAAAAAAAAgAAAAEAAAAQAAAAAgAAAAIAAAAAAAAABQAAAAwAAAAAAAAAAgAAAAIAAAADAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAACAAAAAQAAABEAAAACAAAAAgAAAAAAAAAFAAAADQAAAAAAAAACAAAAAgAAAAMAAAATAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAACAAAAAAAAAAIAAAABAAAAEgAAAAIAAAACAAAAAAAAAAUAAAAOAAAAAAAAAAIAAAACAAAAAwAAAAIAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAEAAAAAAAAAAgAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAMuhRbbsNlBBYqHW9OmHIkF9XBuqnS31QAK37uYhNMhAOSo3UUupm0DC+6pc6JxvQHV9eseEEEJAzURsCyqlFEB8BQ4NMJjnPyy3tBoS97o/xawXQznRjj89J2K2CZxhP6vX43RIIDQ/S8isgygEBz+LvFHQkmzaPjFFFO7wMq4+AADMLkTtjkIAAOgkJqxhQgAAU7B0MjRCAADwpBcVB0IAAACYP2HaQQAAAIn/Ja5BzczM4Eg6gUHNzMxMU7BTQTMzMzNfgCZBAAAAAEi3+UAAAAAAwGPNQDMzMzMzy6BAmpmZmZkxc0AzMzMzM/NFQDMzMzMzMxlAzczMzMzM7D+ygXSx2U6RQKimJOvQKnpA23hmONTHY0A/AGcxyudNQNb3K647mzZA+S56rrwWIUAm4kUQ+9UJQKre9hGzh/M/BLvoy9WG3T+LmqMf8VHGP2m3nYNV37A/gbFHcyeCmT+cBPWBckiDP61tZACjKW0/q2RbYVUYVj8uDypVyLNAP6jGS5cA5zBBwcqhBdCNGUEGEhQ/JVEDQT6WPnRbNO1AB/AWSJgT1kDfUWNCNLDAQNk+5C33OqlAchWL34QSk0DKvtDIrNV8QNF0G3kFzGVASSeWhBl6UED+/0mNGuk4QGjA/dm/1CJALPLPMql6DEDSHoDrwpP1P2jouzWST+A/egAAAAAAAABKAwAAAAAAAPoWAAAAAAAAyqAAAAAAAAB6ZQQAAAAAAErGHgAAAAAA+mvXAAAAAADK8+MFAAAAAHqqOykAAAAASqmhIAEAAAD6oGvkBwAAAMpm8T43AAAAes+ZuIIBAABKrDQMkwoAAPq1cFUFSgAAyvkUViUGAgAAAAAAAwAAAAYAAAACAAAABQAAAAEAAAAEAAAAAAAAAAAAAAAFAAAAAwAAAAEAAAAGAAAABAAAAAIAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAA/////wAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAAABAAAAAAAAAAAAAAD/////AAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAAAAABAAEAAAEBAAAAAAABAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAHAAAABwAAAAEAAAACAAAABAAAAAMAAAAAAAAAAAAAAAcAAAADAAAAAQAAAAIAAAAFAAAABAAAAAAAAAAAAAAAYWxnb3MuYwBfcG9seWZpbGxJbnRlcm5hbABhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0dlb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9HZW9Cb3VuZGFyeQBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGgzVG9Mb2NhbElqawBiYXNlQ2VsbCAhPSBvcmlnaW5CYXNlQ2VsbAAhKG9yaWdpbk9uUGVudCAmJiBpbmRleE9uUGVudCkAcGVudGFnb25Sb3RhdGlvbnMgPj0gMABkaXJlY3Rpb25Sb3RhdGlvbnMgPj0gMABiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvSDMAIV9pc0Jhc2VDZWxsUGVudGFnb24oYmFzZUNlbGwpAGJhc2VDZWxsUm90YXRpb25zID49IDAAd2l0aGluUGVudGFnb25Sb3RhdGlvbnMgPj0gMABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var v=24032;function k(De){return De}function V(De){var Ge=/\b__Z[\w\d_]+/g;return De.replace(Ge,function(At){var kt=At;return At===kt?At:kt+" ["+At+"]"})}function Y(){var De=new Error;if(!De.stack){try{throw new Error(0)}catch(Ge){De=Ge}if(!De.stack)return"(no stack trace available)"}return De.stack.toString()}function te(){var De=Y();return t.extraStackTrace&&(De+=`
`+t.extraStackTrace()),V(De)}function fe(De,Ge,At,kt){Ke("Assertion failed: "+Oe(De)+", at: "+[Ge?Oe(Ge):"unknown filename",At,kt?Oe(kt):"unknown function"])}function ve(){return bt.length}function Ie(De,Ge,At){lt.set(lt.subarray(Ge,Ge+At),De)}function Ee(De){return t.___errno_location&&(pt[t.___errno_location()>>2]=De),De}function ze(De){Ke("OOM")}function Qe(De){try{var Ge=new ArrayBuffer(De);return Ge.byteLength!=De?void 0:(new Int8Array(Ge).set(bt),ne(Ge),Bt(Ge),1)}catch{}}function He(De){var Ge=ve(),At=16777216,kt=2147483648-At;if(De>kt)return!1;for(var o=16777216,ke=Math.max(Ge,o);ke<De;)ke<=536870912?ke=mt(2*ke,At):ke=Math.min(mt((3*ke+2147483648)/4,At),kt);var oi=Qe(ke);return!!oi}var Ze=typeof atob=="function"?atob:function(De){var Ge="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",At="",kt,o,ke,oi,fi,Ai,ti,li=0;De=De.replace(/[^A-Za-z0-9\+\/\=]/g,"");do oi=Ge.indexOf(De.charAt(li++)),fi=Ge.indexOf(De.charAt(li++)),Ai=Ge.indexOf(De.charAt(li++)),ti=Ge.indexOf(De.charAt(li++)),kt=oi<<2|fi>>4,o=(fi&15)<<4|Ai>>2,ke=(Ai&3)<<6|ti,At=At+String.fromCharCode(kt),Ai!==64&&(At=At+String.fromCharCode(o)),ti!==64&&(At=At+String.fromCharCode(ke));while(li<De.length);return At};function Ue(De){try{for(var Ge=Ze(De),At=new Uint8Array(Ge.length),kt=0;kt<Ge.length;++kt)At[kt]=Ge.charCodeAt(kt);return At}catch{throw new Error("Converting base64 string to bytes failed.")}}function dt(De){if(On(De))return Ue(De.slice(lr.length))}var rt={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Me={a:Ke,b:he,c:ae,d:fe,e:Ee,f:ve,g:Ie,h:He,i:ze,j:k,k:V,l:Qe,m:Y,n:te,o:v,p:gi},se=function(De,Ge,At){"almost asm";var kt=new De.Int8Array(At),o=new De.Int32Array(At);new De.Uint8Array(At),new De.Float32Array(At);var ke=new De.Float64Array(At),oi=Ge.p|0,fi=De.Math.floor,Ai=De.Math.abs,ti=De.Math.sqrt,li=De.Math.pow,Bi=De.Math.cos,vi=De.Math.sin,bi=De.Math.tan,Jt=De.Math.acos,wn=De.Math.asin,ar=De.Math.atan,mn=De.Math.atan2,Hn=De.Math.ceil,jr=De.Math.imul,ji=De.Math.min,ur=De.Math.clz32,Vn=Ge.b,Wt=Ge.c,Yi=Ge.d,Ut=Ge.e,Tn=Ge.f,cr=Ge.g,Vs=Ge.h,Ur=Ge.i,Vt=24048;function hr(C){return kt=new Int8Array(C),o=new Int32Array(C),ke=new Float64Array(C),At=C,!0}function Dt(C){C=C|0;var D=0;return D=Vt,Vt=Vt+C|0,Vt=Vt+15&-16,D|0}function Fr(){return Vt|0}function Us(C){C=C|0,Vt=C}function ca(C,D){C=C|0,Vt=C}function Dr(C){return C=C|0,(jr(C*3|0,C+1|0)|0)+1|0}function Ua(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0;Ga(C,D,z,R,0)|0&&(le=(jr(z*3|0,z+1|0)|0)+1|0,fs(R|0,0,le<<3|0)|0,ee=tl(le,4)|0,ee&&(Xs(C,D,z,R,ee,le,0),Jn(ee)))}function Fo(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0;if(Ga(C,D,z,R,ee)|0){if(le=(jr(z*3|0,z+1|0)|0)+1|0,fs(R|0,0,le<<3|0)|0,ee|0){fs(ee|0,0,le<<2|0)|0,Xs(C,D,z,R,ee,le,0);return}ee=tl(le,4)|0,ee&&(Xs(C,D,z,R,ee,le,0),Jn(ee))}}function Ga(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0,Zt=0;if(Zt=Vt,Vt=Vt+16|0,Gt=Zt,le=R,o[le>>2]=C,o[le+4>>2]=D,le=(ee|0)!=0,le&&(o[ee>>2]=0),ds(C,D)|0)return Gt=1,Vt=Zt,Gt|0;o[Gt>>2]=0;e:do if((z|0)>=1)if(le)for(yt=0,Ct=1,ri=1,oe=0,le=C;;){if(!(oe|yt)){if(le=Qn(le,D,4,Gt)|0,D=Wt()|0,(le|0)==0&(D|0)==0){le=2;break e}if(ds(le,D)|0){le=1;break e}}if(le=Qn(le,D,o[16+(yt<<2)>>2]|0,Gt)|0,D=Wt()|0,(le|0)==0&(D|0)==0){le=2;break e}if(C=R+(ri<<3)|0,o[C>>2]=le,o[C+4>>2]=D,o[ee+(ri<<2)>>2]=Ct,oe=oe+1|0,C=(oe|0)==(Ct|0),we=yt+1|0,We=(we|0)==6,ds(le,D)|0){le=1;break e}if(Ct=Ct+(We&C&1)|0,(Ct|0)>(z|0)){le=0;break}else yt=C?We?0:we:yt,ri=ri+1|0,oe=C?0:oe}else for(yt=0,Ct=1,ri=1,oe=0,le=C;;){if(!(oe|yt)){if(le=Qn(le,D,4,Gt)|0,D=Wt()|0,(le|0)==0&(D|0)==0){le=2;break e}if(ds(le,D)|0){le=1;break e}}if(le=Qn(le,D,o[16+(yt<<2)>>2]|0,Gt)|0,D=Wt()|0,(le|0)==0&(D|0)==0){le=2;break e}if(C=R+(ri<<3)|0,o[C>>2]=le,o[C+4>>2]=D,oe=oe+1|0,C=(oe|0)==(Ct|0),we=yt+1|0,We=(we|0)==6,ds(le,D)|0){le=1;break e}if(Ct=Ct+(We&C&1)|0,(Ct|0)>(z|0)){le=0;break}else yt=C?We?0:we:yt,ri=ri+1|0,oe=C?0:oe}else le=0;while(!1);return Gt=le,Vt=Zt,Gt|0}function Xs(C,D,z,R,ee,le,oe){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0,le=le|0,oe=oe|0;var we=0,We=0,yt=0,Ct=0,ri=0,Gt=0,Zt=0;if(ri=Vt,Vt=Vt+16|0,Ct=ri,(C|0)==0&(D|0)==0){Vt=ri;return}if(we=Lo(C|0,D|0,le|0,((le|0)<0)<<31>>31|0)|0,Wt()|0,We=R+(we<<3)|0,Gt=We,Zt=o[Gt>>2]|0,Gt=o[Gt+4>>2]|0,yt=(Zt|0)==(C|0)&(Gt|0)==(D|0),!((Zt|0)==0&(Gt|0)==0|yt))do we=(we+1|0)%(le|0)|0,We=R+(we<<3)|0,Zt=We,Gt=o[Zt>>2]|0,Zt=o[Zt+4>>2]|0,yt=(Gt|0)==(C|0)&(Zt|0)==(D|0);while(!((Gt|0)==0&(Zt|0)==0|yt));if(we=ee+(we<<2)|0,yt&&(o[we>>2]|0)<=(oe|0)){Vt=ri;return}if(Zt=We,o[Zt>>2]=C,o[Zt+4>>2]=D,o[we>>2]=oe,(oe|0)>=(z|0)){Vt=ri;return}Zt=oe+1|0,o[Ct>>2]=0,Gt=Qn(C,D,2,Ct)|0,Xs(Gt,Wt()|0,z,R,ee,le,Zt),o[Ct>>2]=0,Gt=Qn(C,D,3,Ct)|0,Xs(Gt,Wt()|0,z,R,ee,le,Zt),o[Ct>>2]=0,Gt=Qn(C,D,1,Ct)|0,Xs(Gt,Wt()|0,z,R,ee,le,Zt),o[Ct>>2]=0,Gt=Qn(C,D,5,Ct)|0,Xs(Gt,Wt()|0,z,R,ee,le,Zt),o[Ct>>2]=0,Gt=Qn(C,D,4,Ct)|0,Xs(Gt,Wt()|0,z,R,ee,le,Zt),o[Ct>>2]=0,Gt=Qn(C,D,6,Ct)|0,Xs(Gt,Wt()|0,z,R,ee,le,Zt),Vt=ri}function Qn(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0,Zt=0;if((o[R>>2]|0)>0){ee=0;do z=ha(z)|0,ee=ee+1|0;while((ee|0)<(o[R>>2]|0))}we=ki(C|0,D|0,45)|0,Wt()|0,We=we&127,le=Js(C,D)|0,ee=ki(C|0,D|0,52)|0,Wt()|0,ee=ee&15;e:do if(!ee)oe=6;else for(;;){if(ri=(15-ee|0)*3|0,Gt=ki(C|0,D|0,ri|0)|0,Wt()|0,Gt=Gt&7,Zt=(Nr(ee)|0)==0,ee=ee+-1|0,Ct=Li(7,0,ri|0)|0,D=D&~(Wt()|0),ri=Li(o[(Zt?464:48)+(Gt*28|0)+(z<<2)>>2]|0,0,ri|0)|0,yt=Wt()|0,z=o[(Zt?672:256)+(Gt*28|0)+(z<<2)>>2]|0,C=ri|C&~Ct,D=yt|D,!z){z=0;break e}if(!ee){oe=6;break}}while(!1);(oe|0)==6&&(Zt=o[880+(We*28|0)+(z<<2)>>2]|0,Gt=Li(Zt|0,0,45)|0,C=Gt|C,D=Wt()|0|D&-1040385,z=o[4304+(We*28|0)+(z<<2)>>2]|0,(Zt&127|0)==127&&(Zt=Li(o[880+(We*28|0)+20>>2]|0,0,45)|0,D=Wt()|0|D&-1040385,z=o[4304+(We*28|0)+20>>2]|0,C=Ya(Zt|C,D)|0,D=Wt()|0,o[R>>2]=(o[R>>2]|0)+1)),oe=ki(C|0,D|0,45)|0,Wt()|0,oe=oe&127;e:do if(N(oe)|0){t:do if((Js(C,D)|0)==1){if((We|0)!=(oe|0))if(Di(oe,o[7728+(We*28|0)>>2]|0)|0){C=Yr(C,D)|0,le=1,D=Wt()|0;break}else{C=Ya(C,D)|0,le=1,D=Wt()|0;break}switch(le|0){case 5:{C=Yr(C,D)|0,D=Wt()|0,o[R>>2]=(o[R>>2]|0)+5,le=0;break t}case 3:{C=Ya(C,D)|0,D=Wt()|0,o[R>>2]=(o[R>>2]|0)+1,le=0;break t}default:return Gt=0,Zt=0,Vn(Gt|0),Zt|0}}else le=0;while(!1);if((z|0)>0){ee=0;do C=qs(C,D)|0,D=Wt()|0,ee=ee+1|0;while((ee|0)!=(z|0))}if((We|0)!=(oe|0)){if(!(xe(oe)|0)){if((le|0)!=0|(Js(C,D)|0)!=5)break;o[R>>2]=(o[R>>2]|0)+1;break}switch(we&127){case 8:case 118:break e}(Js(C,D)|0)!=3&&(o[R>>2]=(o[R>>2]|0)+1)}}else if((z|0)>0){ee=0;do C=Ya(C,D)|0,D=Wt()|0,ee=ee+1|0;while((ee|0)!=(z|0))}while(!1);return o[R>>2]=((o[R>>2]|0)+z|0)%6|0,Gt=D,Zt=C,Vn(Gt|0),Zt|0}function aa(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0;if(ri=Vt,Vt=Vt+16|0,Ct=ri,!z)return Ct=R,o[Ct>>2]=C,o[Ct+4>>2]=D,Ct=0,Vt=ri,Ct|0;o[Ct>>2]=0;e:do if(ds(C,D)|0)C=1;else{if(le=(z|0)>0,le){ee=0,yt=C;do{if(yt=Qn(yt,D,4,Ct)|0,D=Wt()|0,(yt|0)==0&(D|0)==0){C=2;break e}if(ee=ee+1|0,ds(yt,D)|0){C=1;break e}}while((ee|0)<(z|0));if(We=R,o[We>>2]=yt,o[We+4>>2]=D,We=z+-1|0,le){le=0,oe=1,ee=yt,C=D;do{if(ee=Qn(ee,C,2,Ct)|0,C=Wt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(we=R+(oe<<3)|0,o[we>>2]=ee,o[we+4>>2]=C,oe=oe+1|0,ds(ee,C)|0){C=1;break e}le=le+1|0}while((le|0)<(z|0));we=0,le=oe;do{if(ee=Qn(ee,C,3,Ct)|0,C=Wt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(oe=R+(le<<3)|0,o[oe>>2]=ee,o[oe+4>>2]=C,le=le+1|0,ds(ee,C)|0){C=1;break e}we=we+1|0}while((we|0)<(z|0));oe=0;do{if(ee=Qn(ee,C,1,Ct)|0,C=Wt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(we=R+(le<<3)|0,o[we>>2]=ee,o[we+4>>2]=C,le=le+1|0,ds(ee,C)|0){C=1;break e}oe=oe+1|0}while((oe|0)<(z|0));oe=0;do{if(ee=Qn(ee,C,5,Ct)|0,C=Wt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(we=R+(le<<3)|0,o[we>>2]=ee,o[we+4>>2]=C,le=le+1|0,ds(ee,C)|0){C=1;break e}oe=oe+1|0}while((oe|0)<(z|0));oe=0;do{if(ee=Qn(ee,C,4,Ct)|0,C=Wt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(we=R+(le<<3)|0,o[we>>2]=ee,o[we+4>>2]=C,le=le+1|0,ds(ee,C)|0){C=1;break e}oe=oe+1|0}while((oe|0)<(z|0));for(oe=0;;){if(ee=Qn(ee,C,6,Ct)|0,C=Wt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if((oe|0)!=(We|0))if(we=R+(le<<3)|0,o[we>>2]=ee,o[we+4>>2]=C,!(ds(ee,C)|0))le=le+1|0;else{C=1;break e}if(oe=oe+1|0,(oe|0)>=(z|0)){oe=yt,le=D;break}}}else oe=yt,ee=yt,le=D,C=D}else oe=R,o[oe>>2]=C,o[oe+4>>2]=D,oe=C,ee=C,le=D,C=D;C=((oe|0)!=(ee|0)|(le|0)!=(C|0))&1}while(!1);return Ct=C,Vt=ri,Ct|0}function hs(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0;if(le=Vt,Vt=Vt+48|0,ee=le+8|0,R=le,we=C,oe=o[we+4>>2]|0,z=R,o[z>>2]=o[we>>2],o[z+4>>2]=oe,Pn(R,ee),ee=Za(ee,D)|0,D=o[R>>2]|0,R=o[C+8>>2]|0,(R|0)<=0)return we=D,oe=(ee|0)<(we|0),we=oe?we:ee,we=we+12|0,Vt=le,we|0;z=o[C+12>>2]|0,C=0;do D=(o[z+(C<<3)>>2]|0)+D|0,C=C+1|0;while((C|0)<(R|0));return we=(ee|0)<(D|0),we=we?D:ee,we=we+12|0,Vt=le,we|0}function qa(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0;if(we=Vt,Vt=Vt+48|0,R=we+8|0,ee=we,!(al(C,D,z)|0)){Vt=we;return}if(We=C,le=o[We+4>>2]|0,oe=ee,o[oe>>2]=o[We>>2],o[oe+4>>2]=le,Pn(ee,R),oe=Za(R,D)|0,D=o[ee>>2]|0,le=o[C+8>>2]|0,(le|0)>0){ee=o[C+12>>2]|0,R=0;do D=(o[ee+(R<<3)>>2]|0)+D|0,R=R+1|0;while((R|0)!=(le|0))}if(D=(oe|0)<(D|0)?D:oe,(D|0)<=-12){Vt=we;return}We=D+11|0,fs(z|0,0,(((We|0)>0?We:0)<<3)+8|0)|0,Vt=we}function al(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0,ue=0,Se=0;if(Se=Vt,Vt=Vt+112|0,B=Se+80|0,We=Se+72|0,j=Se,X=Se+56|0,yt=C+8|0,ue=Zn((o[yt>>2]<<5)+32|0)|0,ue||Yi(22848,22448,800,22456),Da(C,ue),le=C,R=o[le+4>>2]|0,we=We,o[we>>2]=o[le>>2],o[we+4>>2]=R,Pn(We,B),we=Za(B,D)|0,R=o[We>>2]|0,le=o[yt>>2]|0,(le|0)>0){oe=o[C+12>>2]|0,ee=0;do R=(o[oe+(ee<<3)>>2]|0)+R|0,ee=ee+1|0;while((ee|0)!=(le|0))}if(we=(we|0)<(R|0)?R:we,T=we+12|0,ee=tl(T,8)|0,Ct=tl(T,8)|0,o[B>>2]=0,_=C,w=o[_+4>>2]|0,R=We,o[R>>2]=o[_>>2],o[R+4>>2]=w,R=ol(We,T,D,B,ee,Ct)|0,R|0)return Jn(ee),Jn(Ct),Jn(ue),ue=R,Vt=Se,ue|0;e:do if((o[yt>>2]|0)>0){for(le=C+12|0,R=0;oe=ol((o[le>>2]|0)+(R<<3)|0,T,D,B,ee,Ct)|0,R=R+1|0,!(oe|0);)if((R|0)>=(o[yt>>2]|0))break e;return Jn(ee),Jn(Ct),Jn(ue),ue=oe,Vt=Se,ue|0}while(!1);(we|0)>-12&&fs(Ct|0,0,((T|0)>1?T:1)<<3|0)|0;e:do if((o[B>>2]|0)>0){w=((T|0)<0)<<31>>31,s=ee,i=Ct,r=ee,l=ee,d=Ct,_=ee,R=ee,E=ee,F=Ct,O=Ct,y=Ct,ee=Ct;t:for(;;){for(A=o[B>>2]|0,Zt=0,Z=0,le=0;;){oe=j,we=oe+56|0;do o[oe>>2]=0,oe=oe+4|0;while((oe|0)<(we|0));if(D=s+(Zt<<3)|0,We=o[D>>2]|0,D=o[D+4>>2]|0,Ga(We,D,1,j,0)|0){oe=j,we=oe+56|0;do o[oe>>2]=0,oe=oe+4|0;while((oe|0)<(we|0));oe=tl(7,4)|0,oe|0&&(Xs(We,D,1,j,oe,7,0),Jn(oe))}Gt=0;do{ri=j+(Gt<<3)|0,Ct=o[ri>>2]|0,ri=o[ri+4>>2]|0;i:do if(!((Ct|0)==0&(ri|0)==0)){if(We=Lo(Ct|0,ri|0,T|0,w|0)|0,Wt()|0,oe=z+(We<<3)|0,we=oe,D=o[we>>2]|0,we=o[we+4>>2]|0,!((D|0)==0&(we|0)==0))for(yt=0;;){if((yt|0)>(T|0))break t;if((D|0)==(Ct|0)&(we|0)==(ri|0))break i;if(We=(We+1|0)%(T|0)|0,oe=z+(We<<3)|0,we=oe,D=o[we>>2]|0,we=o[we+4>>2]|0,(D|0)==0&(we|0)==0)break;yt=yt+1|0}(Ct|0)==0&(ri|0)==0||(Ea(Ct,ri,X),In(C,ue,X)|0&&(yt=oe,o[yt>>2]=Ct,o[yt+4>>2]=ri,yt=i+(le<<3)|0,o[yt>>2]=Ct,o[yt+4>>2]=ri,le=le+1|0))}while(!1);Gt=Gt+1|0}while(Gt>>>0<7);if(Z=Z+1|0,(Z|0)>=(A|0))break;Zt=Zt+1|0}if((A|0)>0&&fs(r|0,0,A<<3|0)|0,o[B>>2]=le,(le|0)>0)Ct=ee,ri=y,Gt=_,Zt=O,Z=F,A=i,ee=E,y=R,O=l,F=r,E=Ct,R=ri,_=d,d=Gt,l=Zt,r=Z,i=s,s=A;else break e}return Jn(l),Jn(d),Jn(ue),ue=-1,Vt=Se,ue|0}else R=Ct;while(!1);return Jn(ue),Jn(ee),Jn(R),ue=0,Vt=Se,ue|0}function ol(C,D,z,R,ee,le){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0,le=le|0;var oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0,B=0;if(w=Vt,Vt=Vt+48|0,r=w+32|0,l=w+16|0,d=w,oe=o[C>>2]|0,(oe|0)<=0)return _=0,Vt=w,_|0;F=C+4|0,O=r+8|0,y=l+8|0,s=d+8|0,i=((D|0)<0)<<31>>31,E=0;e:for(;;){we=o[F>>2]|0,Z=we+(E<<4)|0,o[r>>2]=o[Z>>2],o[r+4>>2]=o[Z+4>>2],o[r+8>>2]=o[Z+8>>2],o[r+12>>2]=o[Z+12>>2],(E|0)==(oe+-1|0)?(o[l>>2]=o[we>>2],o[l+4>>2]=o[we+4>>2],o[l+8>>2]=o[we+8>>2],o[l+12>>2]=o[we+12>>2]):(Z=we+(E+1<<4)|0,o[l>>2]=o[Z>>2],o[l+4>>2]=o[Z+4>>2],o[l+8>>2]=o[Z+8>>2],o[l+12>>2]=o[Z+12>>2]),Z=Qa(r,l,z)|0;t:do if((Z|0)>0){A=+(Z|0),Zt=0;i:for(;;){B=+(Z-Zt|0),T=+(Zt|0),ke[d>>3]=+ke[r>>3]*B/A+ +ke[l>>3]*T/A,ke[s>>3]=+ke[O>>3]*B/A+ +ke[y>>3]*T/A,ri=Aa(d,z)|0,Gt=Wt()|0,we=Lo(ri|0,Gt|0,D|0,i|0)|0,Wt()|0,oe=le+(we<<3)|0,We=oe,yt=o[We>>2]|0,We=o[We+4>>2]|0;n:do if((yt|0)==0&(We|0)==0)_=14;else for(Ct=0;;){if((Ct|0)>(D|0)){oe=1;break n}if((yt|0)==(ri|0)&(We|0)==(Gt|0)){oe=7;break n}if(we=(we+1|0)%(D|0)|0,oe=le+(we<<3)|0,We=oe,yt=o[We>>2]|0,We=o[We+4>>2]|0,(yt|0)==0&(We|0)==0){_=14;break}else Ct=Ct+1|0}while(!1);switch((_|0)==14&&(_=0,(ri|0)==0&(Gt|0)==0?oe=7:(o[oe>>2]=ri,o[oe+4>>2]=Gt,oe=o[R>>2]|0,Ct=ee+(oe<<3)|0,o[Ct>>2]=ri,o[Ct+4>>2]=Gt,o[R>>2]=oe+1,oe=0)),oe&7){case 7:case 0:break;default:break i}if(Zt=Zt+1|0,(Z|0)<=(Zt|0)){_=8;break t}}if(oe|0){oe=-1,_=20;break e}}else _=8;while(!1);if((_|0)==8&&(_=0),E=E+1|0,oe=o[C>>2]|0,(E|0)>=(oe|0)){oe=0,_=20;break}}return(_|0)==20?(Vt=w,oe|0):0}function no(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0;if(yt=Vt,Vt=Vt+176|0,We=yt,(D|0)<1){ms(z,0,0),Vt=yt;return}oe=C,oe=ki(o[oe>>2]|0,o[oe+4>>2]|0,52)|0,Wt()|0,ms(z,(D|0)>6?D:6,oe&15),oe=0;do{if(R=C+(oe<<3)|0,Pa(o[R>>2]|0,o[R+4>>2]|0,We),R=o[We>>2]|0,(R|0)>0){we=0;do le=We+8+(we<<4)|0,we=we+1|0,R=We+8+(((we|0)%(R|0)|0)<<4)|0,ee=cu(z,R,le)|0,ee?_u(z,ee)|0:Nu(z,le,R)|0,R=o[We>>2]|0;while((we|0)<(R|0))}oe=oe+1|0}while((oe|0)!=(D|0));Vt=yt}function Ha(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0;if(le=Vt,Vt=Vt+32|0,R=le,ee=le+16|0,no(C,D,ee),o[z>>2]=0,o[z+4>>2]=0,o[z+8>>2]=0,C=el(ee)|0,!C){Xn(z)|0,_a(ee),Vt=le;return}do{D=Ln(z)|0;do jn(D,C)|0,oe=C+16|0,o[R>>2]=o[oe>>2],o[R+4>>2]=o[oe+4>>2],o[R+8>>2]=o[oe+8>>2],o[R+12>>2]=o[oe+12>>2],_u(ee,C)|0,C=Vu(ee,R)|0;while(C|0);C=el(ee)|0}while(C|0);Xn(z)|0,_a(ee),Vt=le}function N(C){return C=C|0,o[7728+(C*28|0)+16>>2]|0}function xe(C){return C=C|0,(C|0)==4|(C|0)==117|0}function nt(C){return C=C|0,o[11152+((o[C>>2]|0)*216|0)+((o[C+4>>2]|0)*72|0)+((o[C+8>>2]|0)*24|0)+(o[C+12>>2]<<3)>>2]|0}function It(C){return C=C|0,o[11152+((o[C>>2]|0)*216|0)+((o[C+4>>2]|0)*72|0)+((o[C+8>>2]|0)*24|0)+(o[C+12>>2]<<3)+4>>2]|0}function $t(C,D){C=C|0,D=D|0,C=7728+(C*28|0)|0,o[D>>2]=o[C>>2],o[D+4>>2]=o[C+4>>2],o[D+8>>2]=o[C+8>>2],o[D+12>>2]=o[C+12>>2]}function wi(C,D){C=C|0,D=D|0;var z=0,R=0;if(D>>>0>20)return D=-1,D|0;do if((o[11152+(D*216|0)>>2]|0)!=(C|0))if((o[11152+(D*216|0)+8>>2]|0)!=(C|0))if((o[11152+(D*216|0)+16>>2]|0)!=(C|0))if((o[11152+(D*216|0)+24>>2]|0)!=(C|0))if((o[11152+(D*216|0)+32>>2]|0)!=(C|0))if((o[11152+(D*216|0)+40>>2]|0)!=(C|0))if((o[11152+(D*216|0)+48>>2]|0)!=(C|0))if((o[11152+(D*216|0)+56>>2]|0)!=(C|0))if((o[11152+(D*216|0)+64>>2]|0)!=(C|0))if((o[11152+(D*216|0)+72>>2]|0)!=(C|0))if((o[11152+(D*216|0)+80>>2]|0)!=(C|0))if((o[11152+(D*216|0)+88>>2]|0)!=(C|0))if((o[11152+(D*216|0)+96>>2]|0)!=(C|0))if((o[11152+(D*216|0)+104>>2]|0)!=(C|0))if((o[11152+(D*216|0)+112>>2]|0)!=(C|0))if((o[11152+(D*216|0)+120>>2]|0)!=(C|0))if((o[11152+(D*216|0)+128>>2]|0)!=(C|0))if((o[11152+(D*216|0)+136>>2]|0)==(C|0))C=2,z=1,R=2;else{if((o[11152+(D*216|0)+144>>2]|0)==(C|0)){C=0,z=2,R=0;break}if((o[11152+(D*216|0)+152>>2]|0)==(C|0)){C=0,z=2,R=1;break}if((o[11152+(D*216|0)+160>>2]|0)==(C|0)){C=0,z=2,R=2;break}if((o[11152+(D*216|0)+168>>2]|0)==(C|0)){C=1,z=2,R=0;break}if((o[11152+(D*216|0)+176>>2]|0)==(C|0)){C=1,z=2,R=1;break}if((o[11152+(D*216|0)+184>>2]|0)==(C|0)){C=1,z=2,R=2;break}if((o[11152+(D*216|0)+192>>2]|0)==(C|0)){C=2,z=2,R=0;break}if((o[11152+(D*216|0)+200>>2]|0)==(C|0)){C=2,z=2,R=1;break}if((o[11152+(D*216|0)+208>>2]|0)==(C|0)){C=2,z=2,R=2;break}else C=-1;return C|0}else C=2,z=1,R=1;else C=2,z=1,R=0;else C=1,z=1,R=2;else C=1,z=1,R=1;else C=1,z=1,R=0;else C=0,z=1,R=2;else C=0,z=1,R=1;else C=0,z=1,R=0;else C=2,z=0,R=2;else C=2,z=0,R=1;else C=2,z=0,R=0;else C=1,z=0,R=2;else C=1,z=0,R=1;else C=1,z=0,R=0;else C=0,z=0,R=2;else C=0,z=0,R=1;else C=0,z=0,R=0;while(!1);return D=o[11152+(D*216|0)+(z*72|0)+(C*24|0)+(R<<3)+4>>2]|0,D|0}function Di(C,D){return C=C|0,D=D|0,(o[7728+(C*28|0)+20>>2]|0)==(D|0)?(D=1,D|0):(D=(o[7728+(C*28|0)+24>>2]|0)==(D|0),D|0)}function hn(C,D){return C=C|0,D=D|0,o[880+(C*28|0)+(D<<2)>>2]|0}function dn(C,D){return C=C|0,D=D|0,(o[880+(C*28|0)>>2]|0)==(D|0)?(D=0,D|0):(o[880+(C*28|0)+4>>2]|0)==(D|0)?(D=1,D|0):(o[880+(C*28|0)+8>>2]|0)==(D|0)?(D=2,D|0):(o[880+(C*28|0)+12>>2]|0)==(D|0)?(D=3,D|0):(o[880+(C*28|0)+16>>2]|0)==(D|0)?(D=4,D|0):(o[880+(C*28|0)+20>>2]|0)==(D|0)?(D=5,D|0):((o[880+(C*28|0)+24>>2]|0)==(D|0)?6:7)|0}function rr(){return 122}function Ar(C){C=C|0;var D=0,z=0,R=0;D=0;do Li(D|0,0,45)|0,R=Wt()|0|134225919,z=C+(D<<3)|0,o[z>>2]=-1,o[z+4>>2]=R,D=D+1|0;while((D|0)!=122)}function Or(C){return C=C|0,+ke[C+16>>3]<+ke[C+24>>3]|0}function ja(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;return z=+ke[D>>3],!(z>=+ke[C+8>>3])||!(z<=+ke[C>>3])?(D=0,D|0):(R=+ke[C+16>>3],z=+ke[C+24>>3],ee=+ke[D+8>>3],D=ee>=z,C=ee<=R&1,R<z?D&&(C=1):D||(C=0),D=(C|0)!=0,D|0)}function Za(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0;oe=Vt,Vt=Vt+288|0,z=oe+264|0,R=oe+96|0,ee=oe,le=ee,we=le+96|0;do o[le>>2]=0,le=le+4|0;while((le|0)<(we|0));return gl(D,ee),le=ee,we=o[le>>2]|0,le=o[le+4>>2]|0,Ea(we,le,z),Pa(we,le,R),We=+ks(z,R+8|0),ke[z>>3]=+ke[C>>3],le=z+8|0,ke[le>>3]=+ke[C+16>>3],ke[R>>3]=+ke[C+8>>3],we=R+8|0,ke[we>>3]=+ke[C+24>>3],yt=+ks(z,R),we=~~+Hn(+(yt*yt/+ws(+ +Ai(+((+ke[le>>3]-+ke[we>>3])/(+ke[z>>3]-+ke[R>>3]))),3)/(We*(We*2.59807621135)*.8))),Vt=oe,(we|0?we:1)|0}function Qa(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0;we=Vt,Vt=Vt+288|0,R=we+264|0,ee=we+96|0,le=we,oe=le,We=oe+96|0;do o[oe>>2]=0,oe=oe+4|0;while((oe|0)<(We|0));return gl(z,le),We=le,oe=o[We>>2]|0,We=o[We+4>>2]|0,Ea(oe,We,R),Pa(oe,We,ee),yt=+ks(R,ee+8|0),We=~~+Hn(+(+ks(C,D)/(yt*2))),Vt=we,(We|0?We:1)|0}function pl(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0,o[C>>2]=D,o[C+4>>2]=z,o[C+8>>2]=R}function Gr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0;ri=D+8|0,o[ri>>2]=0,We=+ke[C>>3],oe=+Ai(+We),yt=+ke[C+8>>3],we=+Ai(+yt)/.8660254037844386,oe=oe+we*.5,z=~~oe,C=~~we,oe=oe-+(z|0),we=we-+(C|0);do if(oe<.5)if(oe<.3333333333333333)if(o[D>>2]=z,we<(oe+1)*.5){o[D+4>>2]=C;break}else{C=C+1|0,o[D+4>>2]=C;break}else if(Gt=1-oe,C=(!(we<Gt)&1)+C|0,o[D+4>>2]=C,Gt<=we&we<oe*2){z=z+1|0,o[D>>2]=z;break}else{o[D>>2]=z;break}else{if(!(oe<.6666666666666666))if(z=z+1|0,o[D>>2]=z,we<oe*.5){o[D+4>>2]=C;break}else{C=C+1|0,o[D+4>>2]=C;break}if(we<1-oe){if(o[D+4>>2]=C,oe*2+-1<we){o[D>>2]=z;break}}else C=C+1|0,o[D+4>>2]=C;z=z+1|0,o[D>>2]=z}while(!1);do if(We<0)if(C&1){Ct=(C+1|0)/2|0,Ct=oa(z|0,((z|0)<0)<<31>>31|0,Ct|0,((Ct|0)<0)<<31>>31|0)|0,z=~~(+(z|0)-((+(Ct>>>0)+4294967296*+(Wt()|0))*2+1)),o[D>>2]=z;break}else{Ct=(C|0)/2|0,Ct=oa(z|0,((z|0)<0)<<31>>31|0,Ct|0,((Ct|0)<0)<<31>>31|0)|0,z=~~(+(z|0)-(+(Ct>>>0)+4294967296*+(Wt()|0))*2),o[D>>2]=z;break}while(!1);Ct=D+4|0,yt<0&&(z=z-((C<<1|1|0)/2|0)|0,o[D>>2]=z,C=0-C|0,o[Ct>>2]=C),R=C-z|0,(z|0)<0?(ee=0-z|0,o[Ct>>2]=R,o[ri>>2]=ee,o[D>>2]=0,C=R,z=0):ee=0,(C|0)<0&&(z=z-C|0,o[D>>2]=z,ee=ee-C|0,o[ri>>2]=ee,o[Ct>>2]=0,C=0),le=z-ee|0,R=C-ee|0,(ee|0)<0&&(o[D>>2]=le,o[Ct>>2]=R,o[ri>>2]=0,C=R,z=le,ee=0),R=(C|0)<(z|0)?C:z,R=(ee|0)<(R|0)?ee:R,!((R|0)<=0)&&(o[D>>2]=z-R,o[Ct>>2]=C-R,o[ri>>2]=ee-R)}function ir(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0;D=o[C>>2]|0,oe=C+4|0,z=o[oe>>2]|0,(D|0)<0&&(z=z-D|0,o[oe>>2]=z,le=C+8|0,o[le>>2]=(o[le>>2]|0)-D,o[C>>2]=0,D=0),(z|0)<0?(D=D-z|0,o[C>>2]=D,le=C+8|0,ee=(o[le>>2]|0)-z|0,o[le>>2]=ee,o[oe>>2]=0,z=0):(ee=C+8|0,le=ee,ee=o[ee>>2]|0),(ee|0)<0&&(D=D-ee|0,o[C>>2]=D,z=z-ee|0,o[oe>>2]=z,o[le>>2]=0,ee=0),R=(z|0)<(D|0)?z:D,R=(ee|0)<(R|0)?ee:R,!((R|0)<=0)&&(o[C>>2]=D-R,o[oe>>2]=z-R,o[le>>2]=ee-R)}function Er(C,D){C=C|0,D=D|0;var z=0,R=0;R=o[C+8>>2]|0,z=+((o[C+4>>2]|0)-R|0),ke[D>>3]=+((o[C>>2]|0)-R|0)-z*.5,ke[D+8>>3]=z*.8660254037844386}function Lr(C,D,z){C=C|0,D=D|0,z=z|0,o[z>>2]=(o[D>>2]|0)+(o[C>>2]|0),o[z+4>>2]=(o[D+4>>2]|0)+(o[C+4>>2]|0),o[z+8>>2]=(o[D+8>>2]|0)+(o[C+8>>2]|0)}function Zs(C,D,z){C=C|0,D=D|0,z=z|0,o[z>>2]=(o[C>>2]|0)-(o[D>>2]|0),o[z+4>>2]=(o[C+4>>2]|0)-(o[D+4>>2]|0),o[z+8>>2]=(o[C+8>>2]|0)-(o[D+8>>2]|0)}function xr(C,D){C=C|0,D=D|0;var z=0,R=0;z=jr(o[C>>2]|0,D)|0,o[C>>2]=z,z=C+4|0,R=jr(o[z>>2]|0,D)|0,o[z>>2]=R,C=C+8|0,D=jr(o[C>>2]|0,D)|0,o[C>>2]=D}function Ks(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;oe=o[C>>2]|0,we=(oe|0)<0,R=(o[C+4>>2]|0)-(we?oe:0)|0,le=(R|0)<0,ee=(le?0-R|0:0)+((o[C+8>>2]|0)-(we?oe:0))|0,z=(ee|0)<0,C=z?0:ee,D=(le?0:R)-(z?ee:0)|0,ee=(we?0:oe)-(le?R:0)-(z?ee:0)|0,z=(D|0)<(ee|0)?D:ee,z=(C|0)<(z|0)?C:z,R=(z|0)>0,C=C-(R?z:0)|0,D=D-(R?z:0)|0;e:do switch(ee-(R?z:0)|0){case 0:switch(D|0){case 0:return we=C|0?(C|0)==1?1:7:0,we|0;case 1:return we=C|0?(C|0)==1?3:7:2,we|0;default:break e}case 1:switch(D|0){case 0:return we=C|0?(C|0)==1?5:7:4,we|0;case 1:{if(!C)C=6;else break e;return C|0}default:break e}}while(!1);return we=7,we|0}function Br(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;oe=C+8|0,z=o[oe>>2]|0,D=(o[C>>2]|0)-z|0,we=C+4|0,z=(o[we>>2]|0)-z|0,R=gn(+((D*3|0)-z|0)/7)|0,o[C>>2]=R,D=gn(+((z<<1)+D|0)/7)|0,o[we>>2]=D,o[oe>>2]=0,z=D-R|0,(R|0)<0?(le=0-R|0,o[we>>2]=z,o[oe>>2]=le,o[C>>2]=0,D=z,R=0,z=le):z=0,(D|0)<0&&(R=R-D|0,o[C>>2]=R,z=z-D|0,o[oe>>2]=z,o[we>>2]=0,D=0),le=R-z|0,ee=D-z|0,(z|0)<0?(o[C>>2]=le,o[we>>2]=ee,o[oe>>2]=0,D=ee,ee=le,z=0):ee=R,R=(D|0)<(ee|0)?D:ee,R=(z|0)<(R|0)?z:R,!((R|0)<=0)&&(o[C>>2]=ee-R,o[we>>2]=D-R,o[oe>>2]=z-R)}function To(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;oe=C+8|0,z=o[oe>>2]|0,D=(o[C>>2]|0)-z|0,we=C+4|0,z=(o[we>>2]|0)-z|0,R=gn(+((D<<1)+z|0)/7)|0,o[C>>2]=R,D=gn(+((z*3|0)-D|0)/7)|0,o[we>>2]=D,o[oe>>2]=0,z=D-R|0,(R|0)<0?(le=0-R|0,o[we>>2]=z,o[oe>>2]=le,o[C>>2]=0,D=z,R=0,z=le):z=0,(D|0)<0&&(R=R-D|0,o[C>>2]=R,z=z-D|0,o[oe>>2]=z,o[we>>2]=0,D=0),le=R-z|0,ee=D-z|0,(z|0)<0?(o[C>>2]=le,o[we>>2]=ee,o[oe>>2]=0,D=ee,ee=le,z=0):ee=R,R=(D|0)<(ee|0)?D:ee,R=(z|0)<(R|0)?z:R,!((R|0)<=0)&&(o[C>>2]=ee-R,o[we>>2]=D-R,o[oe>>2]=z-R)}function Zo(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;D=o[C>>2]|0,oe=C+4|0,z=o[oe>>2]|0,we=C+8|0,R=o[we>>2]|0,ee=z+(D*3|0)|0,o[C>>2]=ee,z=R+(z*3|0)|0,o[oe>>2]=z,D=(R*3|0)+D|0,o[we>>2]=D,R=z-ee|0,(ee|0)<0?(D=D-ee|0,o[oe>>2]=R,o[we>>2]=D,o[C>>2]=0,z=R,R=0):R=ee,(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[we>>2]=D,o[oe>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[oe>>2]=ee,o[we>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[oe>>2]=ee-z,o[we>>2]=D-z)}function Bs(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;ee=o[C>>2]|0,oe=C+4|0,D=o[oe>>2]|0,we=C+8|0,z=o[we>>2]|0,R=(D*3|0)+ee|0,ee=z+(ee*3|0)|0,o[C>>2]=ee,o[oe>>2]=R,D=(z*3|0)+D|0,o[we>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[oe>>2]=z,o[we>>2]=D,o[C>>2]=0,ee=0):z=R,(z|0)<0&&(ee=ee-z|0,o[C>>2]=ee,D=D-z|0,o[we>>2]=D,o[oe>>2]=0,z=0),le=ee-D|0,R=z-D|0,(D|0)<0?(o[C>>2]=le,o[oe>>2]=R,o[we>>2]=0,ee=le,D=0):R=z,z=(R|0)<(ee|0)?R:ee,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=ee-z,o[oe>>2]=R-z,o[we>>2]=D-z)}function Il(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0;(D+-1|0)>>>0>=6||(ee=(o[15472+(D*12|0)>>2]|0)+(o[C>>2]|0)|0,o[C>>2]=ee,we=C+4|0,R=(o[15472+(D*12|0)+4>>2]|0)+(o[we>>2]|0)|0,o[we>>2]=R,oe=C+8|0,D=(o[15472+(D*12|0)+8>>2]|0)+(o[oe>>2]|0)|0,o[oe>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[we>>2]=z,o[oe>>2]=D,o[C>>2]=0,R=0):(z=R,R=ee),(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[oe>>2]=D,o[we>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[we>>2]=ee,o[oe>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[we>>2]=ee-z,o[oe>>2]=D-z))}function mo(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;ee=o[C>>2]|0,oe=C+4|0,D=o[oe>>2]|0,we=C+8|0,z=o[we>>2]|0,R=D+ee|0,ee=z+ee|0,o[C>>2]=ee,o[oe>>2]=R,D=z+D|0,o[we>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[oe>>2]=z,o[we>>2]=D,o[C>>2]=0,R=0):(z=R,R=ee),(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[we>>2]=D,o[oe>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[oe>>2]=ee,o[we>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[oe>>2]=ee-z,o[we>>2]=D-z)}function Qo(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;D=o[C>>2]|0,oe=C+4|0,R=o[oe>>2]|0,we=C+8|0,z=o[we>>2]|0,ee=R+D|0,o[C>>2]=ee,R=z+R|0,o[oe>>2]=R,D=z+D|0,o[we>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[oe>>2]=z,o[we>>2]=D,o[C>>2]=0,R=0):(z=R,R=ee),(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[we>>2]=D,o[oe>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[oe>>2]=ee,o[we>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[oe>>2]=ee-z,o[we>>2]=D-z)}function ha(C){switch(C=C|0,C|0){case 1:{C=5;break}case 5:{C=4;break}case 4:{C=6;break}case 6:{C=2;break}case 2:{C=3;break}case 3:{C=1;break}}return C|0}function Ys(C){switch(C=C|0,C|0){case 1:{C=3;break}case 3:{C=2;break}case 2:{C=6;break}case 6:{C=4;break}case 4:{C=5;break}case 5:{C=1;break}}return C|0}function El(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;D=o[C>>2]|0,oe=C+4|0,z=o[oe>>2]|0,we=C+8|0,R=o[we>>2]|0,ee=z+(D<<1)|0,o[C>>2]=ee,z=R+(z<<1)|0,o[oe>>2]=z,D=(R<<1)+D|0,o[we>>2]=D,R=z-ee|0,(ee|0)<0?(D=D-ee|0,o[oe>>2]=R,o[we>>2]=D,o[C>>2]=0,z=R,R=0):R=ee,(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[we>>2]=D,o[oe>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[oe>>2]=ee,o[we>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[oe>>2]=ee-z,o[we>>2]=D-z)}function Wa(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;ee=o[C>>2]|0,oe=C+4|0,D=o[oe>>2]|0,we=C+8|0,z=o[we>>2]|0,R=(D<<1)+ee|0,ee=z+(ee<<1)|0,o[C>>2]=ee,o[oe>>2]=R,D=(z<<1)+D|0,o[we>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[oe>>2]=z,o[we>>2]=D,o[C>>2]=0,ee=0):z=R,(z|0)<0&&(ee=ee-z|0,o[C>>2]=ee,D=D-z|0,o[we>>2]=D,o[oe>>2]=0,z=0),le=ee-D|0,R=z-D|0,(D|0)<0?(o[C>>2]=le,o[oe>>2]=R,o[we>>2]=0,ee=le,D=0):R=z,z=(R|0)<(ee|0)?R:ee,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=ee-z,o[oe>>2]=R-z,o[we>>2]=D-z)}function Ma(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0;return oe=(o[C>>2]|0)-(o[D>>2]|0)|0,we=(oe|0)<0,R=(o[C+4>>2]|0)-(o[D+4>>2]|0)-(we?oe:0)|0,le=(R|0)<0,ee=(we?0-oe|0:0)+(o[C+8>>2]|0)-(o[D+8>>2]|0)+(le?0-R|0:0)|0,C=(ee|0)<0,D=C?0:ee,z=(le?0:R)-(C?ee:0)|0,ee=(we?0:oe)-(le?R:0)-(C?ee:0)|0,C=(z|0)<(ee|0)?z:ee,C=(D|0)<(C|0)?D:C,R=(C|0)>0,D=D-(R?C:0)|0,z=z-(R?C:0)|0,C=ee-(R?C:0)|0,C=(C|0)>-1?C:0-C|0,z=(z|0)>-1?z:0-z|0,D=(D|0)>-1?D:0-D|0,D=(z|0)>(D|0)?z:D,((C|0)>(D|0)?C:D)|0}function ml(C,D){C=C|0,D=D|0;var z=0;z=o[C+8>>2]|0,o[D>>2]=(o[C>>2]|0)-z,o[D+4>>2]=(o[C+4>>2]|0)-z}function Cl(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0;R=o[C>>2]|0,o[D>>2]=R,C=o[C+4>>2]|0,oe=D+4|0,o[oe>>2]=C,we=D+8|0,o[we>>2]=0,z=C-R|0,(R|0)<0?(C=0-R|0,o[oe>>2]=z,o[we>>2]=C,o[D>>2]=0,R=0):(z=C,C=0),(z|0)<0&&(R=R-z|0,o[D>>2]=R,C=C-z|0,o[we>>2]=C,o[oe>>2]=0,z=0),le=R-C|0,ee=z-C|0,(C|0)<0?(o[D>>2]=le,o[oe>>2]=ee,o[we>>2]=0,z=ee,ee=le,C=0):ee=R,R=(z|0)<(ee|0)?z:ee,R=(C|0)<(R|0)?C:R,!((R|0)<=0)&&(o[D>>2]=ee-R,o[oe>>2]=z-R,o[we>>2]=C-R)}function mu(C){C=C|0;var D=0,z=0,R=0,ee=0;D=C+8|0,ee=o[D>>2]|0,z=ee-(o[C>>2]|0)|0,o[C>>2]=z,R=C+4|0,C=(o[R>>2]|0)-ee|0,o[R>>2]=C,o[D>>2]=0-(C+z)}function As(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;z=o[C>>2]|0,D=0-z|0,o[C>>2]=D,oe=C+8|0,o[oe>>2]=0,we=C+4|0,R=o[we>>2]|0,ee=R+z|0,(z|0)>0?(o[we>>2]=ee,o[oe>>2]=z,o[C>>2]=0,D=0,R=ee):z=0,(R|0)<0?(le=D-R|0,o[C>>2]=le,z=z-R|0,o[oe>>2]=z,o[we>>2]=0,ee=le-z|0,D=0-z|0,(z|0)<0?(o[C>>2]=ee,o[we>>2]=D,o[oe>>2]=0,R=D,z=0):(R=0,ee=le)):ee=D,D=(R|0)<(ee|0)?R:ee,D=(z|0)<(D|0)?z:D,!((D|0)<=0)&&(o[C>>2]=ee-D,o[we>>2]=R-D,o[oe>>2]=z-D)}function ac(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;R=Vt,Vt=Vt+16|0,ee=R,ro(C,D,z,ee),Gr(ee,z+4|0),Vt=R}function ro(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,We=0;if(We=Vt,Vt=Vt+32|0,le=We,oc(C,le),o[z>>2]=0,ee=+ta(15888,le),oe=+ta(15912,le),oe<ee&&(o[z>>2]=1,ee=oe),oe=+ta(15936,le),oe<ee&&(o[z>>2]=2,ee=oe),oe=+ta(15960,le),oe<ee&&(o[z>>2]=3,ee=oe),oe=+ta(15984,le),oe<ee&&(o[z>>2]=4,ee=oe),oe=+ta(16008,le),oe<ee&&(o[z>>2]=5,ee=oe),oe=+ta(16032,le),oe<ee&&(o[z>>2]=6,ee=oe),oe=+ta(16056,le),oe<ee&&(o[z>>2]=7,ee=oe),oe=+ta(16080,le),oe<ee&&(o[z>>2]=8,ee=oe),oe=+ta(16104,le),oe<ee&&(o[z>>2]=9,ee=oe),oe=+ta(16128,le),oe<ee&&(o[z>>2]=10,ee=oe),oe=+ta(16152,le),oe<ee&&(o[z>>2]=11,ee=oe),oe=+ta(16176,le),oe<ee&&(o[z>>2]=12,ee=oe),oe=+ta(16200,le),oe<ee&&(o[z>>2]=13,ee=oe),oe=+ta(16224,le),oe<ee&&(o[z>>2]=14,ee=oe),oe=+ta(16248,le),oe<ee&&(o[z>>2]=15,ee=oe),oe=+ta(16272,le),oe<ee&&(o[z>>2]=16,ee=oe),oe=+ta(16296,le),oe<ee&&(o[z>>2]=17,ee=oe),oe=+ta(16320,le),oe<ee&&(o[z>>2]=18,ee=oe),oe=+ta(16344,le),oe<ee&&(o[z>>2]=19,ee=oe),oe=+Jt(+(1-ee*.5)),oe<1e-16){o[R>>2]=0,o[R+4>>2]=0,o[R+8>>2]=0,o[R+12>>2]=0,Vt=We;return}if(z=o[z>>2]|0,ee=+ke[16368+(z*24|0)>>3],ee=+Yo(ee-+Yo(+Cr(15568+(z<<4)|0,C))),Nr(D)|0?we=+Yo(ee+-.3334731722518321):we=ee,ee=+bi(+oe)/.381966011250105,(D|0)>0){le=0;do ee=ee*2.6457513110645907,le=le+1|0;while((le|0)!=(D|0))}oe=+Bi(+we)*ee,ke[R>>3]=oe,we=+vi(+we)*ee,ke[R+8>>3]=we,Vt=We}function so(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0;if(le=+Ou(C),le<1e-16){D=15568+(D<<4)|0,o[ee>>2]=o[D>>2],o[ee+4>>2]=o[D+4>>2],o[ee+8>>2]=o[D+8>>2],o[ee+12>>2]=o[D+12>>2];return}if(oe=+mn(+ +ke[C+8>>3],+ +ke[C>>3]),(z|0)>0){C=0;do le=le/2.6457513110645907,C=C+1|0;while((C|0)!=(z|0))}R?(le=le/3,z=(Nr(z)|0)==0,le=+ar(+((z?le:le/2.6457513110645907)*.381966011250105))):(le=+ar(+(le*.381966011250105)),Nr(z)|0&&(oe=+Yo(oe+.3334731722518321))),$n(15568+(D<<4)|0,+Yo(+ke[16368+(D*24|0)>>3]-oe),le,ee)}function Wl(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;R=Vt,Vt=Vt+16|0,ee=R,Er(C+4|0,ee),so(ee,o[C>>2]|0,D,0,z),Vt=R}function Oo(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0,ue=0,Se=0;if(X=Vt,Vt=Vt+272|0,le=X+256|0,O=X+240|0,T=X,B=X+224|0,j=X+208|0,y=X+176|0,s=X+160|0,i=X+192|0,r=X+144|0,l=X+128|0,d=X+112|0,_=X+96|0,w=X+80|0,o[le>>2]=D,o[O>>2]=o[C>>2],o[O+4>>2]=o[C+4>>2],o[O+8>>2]=o[C+8>>2],o[O+12>>2]=o[C+12>>2],Wo(O,le,T),o[ee>>2]=0,O=R+z+((R|0)==5&1)|0,(O|0)<=(z|0)){Vt=X;return}We=o[le>>2]|0,yt=B+4|0,Ct=y+4|0,ri=z+5|0,Gt=16848+(We<<2)|0,Zt=16928+(We<<2)|0,Z=l+8|0,A=d+8|0,E=_+8|0,F=j+4|0,we=z;e:for(;;){oe=T+(((we|0)%5|0)<<4)|0,o[j>>2]=o[oe>>2],o[j+4>>2]=o[oe+4>>2],o[j+8>>2]=o[oe+8>>2],o[j+12>>2]=o[oe+12>>2];do;while((ko(j,We,0,1)|0)==2);if((we|0)>(z|0)&(Nr(D)|0)!=0){if(o[y>>2]=o[j>>2],o[y+4>>2]=o[j+4>>2],o[y+8>>2]=o[j+8>>2],o[y+12>>2]=o[j+12>>2],Er(yt,s),R=o[y>>2]|0,le=o[17008+(R*80|0)+(o[B>>2]<<2)>>2]|0,o[y>>2]=o[18608+(R*80|0)+(le*20|0)>>2],oe=o[18608+(R*80|0)+(le*20|0)+16>>2]|0,(oe|0)>0){C=0;do mo(Ct),C=C+1|0;while((C|0)<(oe|0))}switch(oe=18608+(R*80|0)+(le*20|0)+4|0,o[i>>2]=o[oe>>2],o[i+4>>2]=o[oe+4>>2],o[i+8>>2]=o[oe+8>>2],xr(i,(o[Gt>>2]|0)*3|0),Lr(Ct,i,Ct),ir(Ct),Er(Ct,r),ue=+(o[Zt>>2]|0),ke[l>>3]=ue*3,ke[Z>>3]=0,Se=ue*-1.5,ke[d>>3]=Se,ke[A>>3]=ue*2.598076211353316,ke[_>>3]=Se,ke[E>>3]=ue*-2.598076211353316,o[17008+((o[y>>2]|0)*80|0)+(o[j>>2]<<2)>>2]|0){case 1:{C=d,R=l;break}case 3:{C=_,R=d;break}case 2:{C=l,R=_;break}default:{C=12;break e}}Vl(s,r,R,C,w),so(w,o[y>>2]|0,We,1,ee+8+(o[ee>>2]<<4)|0),o[ee>>2]=(o[ee>>2]|0)+1}if((we|0)<(ri|0)&&(Er(F,y),so(y,o[j>>2]|0,We,1,ee+8+(o[ee>>2]<<4)|0),o[ee>>2]=(o[ee>>2]|0)+1),o[B>>2]=o[j>>2],o[B+4>>2]=o[j+4>>2],o[B+8>>2]=o[j+8>>2],o[B+12>>2]=o[j+12>>2],we=we+1|0,(we|0)>=(O|0)){C=3;break}}if((C|0)==3){Vt=X;return}else(C|0)==12&&Yi(22474,22521,581,22531)}function Wo(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0;We=Vt,Vt=Vt+128|0,R=We+64|0,ee=We,le=R,oe=20208,we=le+60|0;do o[le>>2]=o[oe>>2],le=le+4|0,oe=oe+4|0;while((le|0)<(we|0));le=ee,oe=20272,we=le+60|0;do o[le>>2]=o[oe>>2],le=le+4|0,oe=oe+4|0;while((le|0)<(we|0));we=(Nr(o[D>>2]|0)|0)==0,R=we?R:ee,ee=C+4|0,El(ee),Wa(ee),Nr(o[D>>2]|0)|0&&(Bs(ee),o[D>>2]=(o[D>>2]|0)+1),o[z>>2]=o[C>>2],D=z+4|0,Lr(ee,R,D),ir(D),o[z+16>>2]=o[C>>2],D=z+20|0,Lr(ee,R+12|0,D),ir(D),o[z+32>>2]=o[C>>2],D=z+36|0,Lr(ee,R+24|0,D),ir(D),o[z+48>>2]=o[C>>2],D=z+52|0,Lr(ee,R+36|0,D),ir(D),o[z+64>>2]=o[C>>2],z=z+68|0,Lr(ee,R+48|0,z),ir(z),Vt=We}function ko(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0,Zt=0,Z=0;if(Z=Vt,Vt=Vt+32|0,Gt=Z+12|0,we=Z,Zt=C+4|0,ri=o[16928+(D<<2)>>2]|0,Ct=(R|0)!=0,ri=Ct?ri*3|0:ri,ee=o[Zt>>2]|0,yt=C+8|0,oe=o[yt>>2]|0,Ct){if(le=C+12|0,R=o[le>>2]|0,ee=oe+ee+R|0,(ee|0)==(ri|0))return Zt=1,Vt=Z,Zt|0;We=le}else We=C+12|0,R=o[We>>2]|0,ee=oe+ee+R|0;if((ee|0)<=(ri|0))return Zt=0,Vt=Z,Zt|0;do if((R|0)>0){if(R=o[C>>2]|0,(oe|0)>0){le=18608+(R*80|0)+60|0,R=C;break}R=18608+(R*80|0)+40|0,z?(pl(Gt,ri,0,0),Zs(Zt,Gt,we),Qo(we),Lr(we,Gt,Zt),le=R,R=C):(le=R,R=C)}else le=18608+((o[C>>2]|0)*80|0)+20|0,R=C;while(!1);if(o[R>>2]=o[le>>2],ee=le+16|0,(o[ee>>2]|0)>0){R=0;do mo(Zt),R=R+1|0;while((R|0)<(o[ee>>2]|0))}return C=le+4|0,o[Gt>>2]=o[C>>2],o[Gt+4>>2]=o[C+4>>2],o[Gt+8>>2]=o[C+8>>2],D=o[16848+(D<<2)>>2]|0,xr(Gt,Ct?D*3|0:D),Lr(Zt,Gt,Zt),ir(Zt),Ct?R=((o[yt>>2]|0)+(o[Zt>>2]|0)+(o[We>>2]|0)|0)==(ri|0)?1:2:R=2,Zt=R,Vt=Z,Zt|0}function Gs(C,D){C=C|0,D=D|0;var z=0;do z=ko(C,D,0,1)|0;while((z|0)==2);return z|0}function $o(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0;if(_=Vt,Vt=Vt+240|0,le=_+224|0,i=_+208|0,r=_,l=_+192|0,d=_+176|0,E=_+160|0,F=_+144|0,O=_+128|0,y=_+112|0,s=_+96|0,o[le>>2]=D,o[i>>2]=o[C>>2],o[i+4>>2]=o[C+4>>2],o[i+8>>2]=o[C+8>>2],o[i+12>>2]=o[C+12>>2],Xo(i,le,r),o[ee>>2]=0,A=R+z+((R|0)==6&1)|0,(A|0)<=(z|0)){Vt=_;return}We=o[le>>2]|0,yt=z+6|0,Ct=16928+(We<<2)|0,ri=F+8|0,Gt=O+8|0,Zt=y+8|0,Z=l+4|0,oe=0,we=z,R=-1;e:for(;;){if(le=(we|0)%6|0,C=r+(le<<4)|0,o[l>>2]=o[C>>2],o[l+4>>2]=o[C+4>>2],o[l+8>>2]=o[C+8>>2],o[l+12>>2]=o[C+12>>2],C=oe,oe=ko(l,We,0,1)|0,(we|0)>(z|0)&(Nr(D)|0)!=0&&(C|0)!=1&&(o[l>>2]|0)!=(R|0)){switch(Er(r+(((le+5|0)%6|0)<<4)+4|0,d),Er(r+(le<<4)+4|0,E),w=+(o[Ct>>2]|0),ke[F>>3]=w*3,ke[ri>>3]=0,T=w*-1.5,ke[O>>3]=T,ke[Gt>>3]=w*2.598076211353316,ke[y>>3]=T,ke[Zt>>3]=w*-2.598076211353316,le=o[i>>2]|0,o[17008+(le*80|0)+(((R|0)==(le|0)?o[l>>2]|0:R)<<2)>>2]|0){case 1:{C=O,R=F;break}case 3:{C=y,R=O;break}case 2:{C=F,R=y;break}default:{C=8;break e}}Vl(d,E,R,C,s),!(yl(d,s)|0)&&!(yl(E,s)|0)&&(so(s,o[i>>2]|0,We,1,ee+8+(o[ee>>2]<<4)|0),o[ee>>2]=(o[ee>>2]|0)+1)}if((we|0)<(yt|0)&&(Er(Z,d),so(d,o[l>>2]|0,We,1,ee+8+(o[ee>>2]<<4)|0),o[ee>>2]=(o[ee>>2]|0)+1),we=we+1|0,(we|0)>=(A|0)){C=3;break}else R=o[l>>2]|0}if((C|0)==3){Vt=_;return}else(C|0)==8&&Yi(22557,22521,746,22602)}function Xo(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0;We=Vt,Vt=Vt+160|0,R=We+80|0,ee=We,le=R,oe=20336,we=le+72|0;do o[le>>2]=o[oe>>2],le=le+4|0,oe=oe+4|0;while((le|0)<(we|0));le=ee,oe=20416,we=le+72|0;do o[le>>2]=o[oe>>2],le=le+4|0,oe=oe+4|0;while((le|0)<(we|0));we=(Nr(o[D>>2]|0)|0)==0,R=we?R:ee,ee=C+4|0,El(ee),Wa(ee),Nr(o[D>>2]|0)|0&&(Bs(ee),o[D>>2]=(o[D>>2]|0)+1),o[z>>2]=o[C>>2],D=z+4|0,Lr(ee,R,D),ir(D),o[z+16>>2]=o[C>>2],D=z+20|0,Lr(ee,R+12|0,D),ir(D),o[z+32>>2]=o[C>>2],D=z+36|0,Lr(ee,R+24|0,D),ir(D),o[z+48>>2]=o[C>>2],D=z+52|0,Lr(ee,R+36|0,D),ir(D),o[z+64>>2]=o[C>>2],D=z+68|0,Lr(ee,R+48|0,D),ir(D),o[z+80>>2]=o[C>>2],z=z+84|0,Lr(ee,R+60|0,z),ir(z),Vt=We}function Yo(C){C=+C;var D=0;return D=C<0?C+6.283185307179586:C,+(C>=6.283185307179586?D+-6.283185307179586:D)}function Sa(C,D){return C=C|0,D=D|0,+Ai(+(+ke[C>>3]-+ke[D>>3]))<17453292519943298e-27?(D=+Ai(+(+ke[C+8>>3]-+ke[D+8>>3]))<17453292519943298e-27,D|0):(D=0,D|0)}function $a(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0;return ee=+ke[D>>3],R=+ke[C>>3],le=+vi(+((ee-R)*.5)),z=+vi(+((+ke[D+8>>3]-+ke[C+8>>3])*.5)),z=le*le+z*(+Bi(+ee)*+Bi(+R)*z),+(+mn(+ +ti(+z),+ +ti(+(1-z)))*2)}function ks(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0;return ee=+ke[D>>3],R=+ke[C>>3],le=+vi(+((ee-R)*.5)),z=+vi(+((+ke[D+8>>3]-+ke[C+8>>3])*.5)),z=le*le+z*(+Bi(+ee)*+Bi(+R)*z),+(+mn(+ +ti(+z),+ +ti(+(1-z)))*2*6371.007180918475)}function gu(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0;return ee=+ke[D>>3],R=+ke[C>>3],le=+vi(+((ee-R)*.5)),z=+vi(+((+ke[D+8>>3]-+ke[C+8>>3])*.5)),z=le*le+z*(+Bi(+ee)*+Bi(+R)*z),+(+mn(+ +ti(+z),+ +ti(+(1-z)))*2*6371.007180918475*1e3)}function Cr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0;return le=+ke[D>>3],R=+Bi(+le),ee=+ke[D+8>>3]-+ke[C+8>>3],oe=R*+vi(+ee),z=+ke[C>>3],+ +mn(+oe,+(+vi(+le)*+Bi(+z)-+Bi(+ee)*(R*+vi(+z))))}function $n(C,D,z,R){C=C|0,D=+D,z=+z,R=R|0;var ee=0,le=0,oe=0,we=0;if(z<1e-16){o[R>>2]=o[C>>2],o[R+4>>2]=o[C+4>>2],o[R+8>>2]=o[C+8>>2],o[R+12>>2]=o[C+12>>2];return}le=D<0?D+6.283185307179586:D,le=D>=6.283185307179586?le+-6.283185307179586:le;do if(le<1e-16)D=+ke[C>>3]+z,ke[R>>3]=D,ee=R;else{if(ee=+Ai(+(le+-3.141592653589793))<1e-16,D=+ke[C>>3],ee){D=D-z,ke[R>>3]=D,ee=R;break}if(oe=+Bi(+z),z=+vi(+z),D=oe*+vi(+D)+ +Bi(+le)*(z*+Bi(+D)),D=D>1?1:D,D=+wn(+(D<-1?-1:D)),ke[R>>3]=D,+Ai(+(D+-1.5707963267948966))<1e-16){ke[R>>3]=1.5707963267948966,ke[R+8>>3]=0;return}if(+Ai(+(D+1.5707963267948966))<1e-16){ke[R>>3]=-1.5707963267948966,ke[R+8>>3]=0;return}if(we=+Bi(+D),le=z*+vi(+le)/we,z=+ke[C>>3],D=(oe-+vi(+D)*+vi(+z))/+Bi(+z)/we,oe=le>1?1:le,D=D>1?1:D,D=+ke[C+8>>3]+ +mn(+(oe<-1?-1:oe),+(D<-1?-1:D)),D>3.141592653589793)do D=D+-6.283185307179586;while(D>3.141592653589793);if(D<-3.141592653589793)do D=D+6.283185307179586;while(D<-3.141592653589793);ke[R+8>>3]=D;return}while(!1);if(+Ai(+(D+-1.5707963267948966))<1e-16){ke[ee>>3]=1.5707963267948966,ke[R+8>>3]=0;return}if(+Ai(+(D+1.5707963267948966))<1e-16){ke[ee>>3]=-1.5707963267948966,ke[R+8>>3]=0;return}if(D=+ke[C+8>>3],D>3.141592653589793)do D=D+-6.283185307179586;while(D>3.141592653589793);if(D<-3.141592653589793)do D=D+6.283185307179586;while(D<-3.141592653589793);ke[R+8>>3]=D}function Ko(C){return C=C|0,+ +ke[20496+(C<<3)>>3]}function zr(C){return C=C|0,+ +ke[20624+(C<<3)>>3]}function Xa(C){return C=C|0,+ +ke[20752+(C<<3)>>3]}function is(C){return C=C|0,+ +ke[20880+(C<<3)>>3]}function fr(C){C=C|0;var D=0;return D=21008+(C<<3)|0,C=o[D>>2]|0,Vn(o[D+4>>2]|0),C|0}function Mo(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0;return Gt=+ke[D>>3],Ct=+ke[C>>3],We=+vi(+((Gt-Ct)*.5)),le=+ke[D+8>>3],yt=+ke[C+8>>3],oe=+vi(+((le-yt)*.5)),we=+Bi(+Ct),ri=+Bi(+Gt),oe=We*We+oe*(ri*we*oe),oe=+mn(+ +ti(+oe),+ +ti(+(1-oe)))*2,We=+ke[z>>3],Gt=+vi(+((We-Gt)*.5)),R=+ke[z+8>>3],le=+vi(+((R-le)*.5)),ee=+Bi(+We),le=Gt*Gt+le*(ri*ee*le),le=+mn(+ +ti(+le),+ +ti(+(1-le)))*2,We=+vi(+((Ct-We)*.5)),R=+vi(+((yt-R)*.5)),R=We*We+R*(we*ee*R),R=+mn(+ +ti(+R),+ +ti(+(1-R)))*2,ee=(oe+le+R)*.5,+(+ar(+ +ti(+(+bi(+(ee*.5))*+bi(+((ee-oe)*.5))*+bi(+((ee-le)*.5))*+bi(+((ee-R)*.5)))))*4)}function qn(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0;if(le=Vt,Vt=Vt+192|0,R=le+168|0,ee=le,Ea(C,D,R),Pa(C,D,ee),D=o[ee>>2]|0,(D|0)<=0)return z=0,Vt=le,+z;if(z=+Mo(ee+8|0,ee+8+(((D|0)!=1&1)<<4)|0,R)+0,(D|0)==1)return Vt=le,+z;C=1;do oe=C,C=C+1|0,z=z+ +Mo(ee+8+(oe<<4)|0,ee+8+(((C|0)%(D|0)|0)<<4)|0,R);while((C|0)<(D|0));return Vt=le,+z}function Ol(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0;if(le=Vt,Vt=Vt+192|0,R=le+168|0,ee=le,Ea(C,D,R),Pa(C,D,ee),D=o[ee>>2]|0,(D|0)>0){if(z=+Mo(ee+8|0,ee+8+(((D|0)!=1&1)<<4)|0,R)+0,(D|0)!=1){C=1;do oe=C,C=C+1|0,z=z+ +Mo(ee+8+(oe<<4)|0,ee+8+(((C|0)%(D|0)|0)<<4)|0,R);while((C|0)<(D|0))}}else z=0;return Vt=le,+(z*6371.007180918475*6371.007180918475)}function ns(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0;if(le=Vt,Vt=Vt+192|0,R=le+168|0,ee=le,Ea(C,D,R),Pa(C,D,ee),D=o[ee>>2]|0,(D|0)>0){if(z=+Mo(ee+8|0,ee+8+(((D|0)!=1&1)<<4)|0,R)+0,(D|0)!=1){C=1;do oe=C,C=C+1|0,z=z+ +Mo(ee+8+(oe<<4)|0,ee+8+(((C|0)%(D|0)|0)<<4)|0,R);while((C|0)<(D|0))}}else z=0;return Vt=le,+(z*6371.007180918475*6371.007180918475*1e3*1e3)}function Zr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0;if(oe=Vt,Vt=Vt+176|0,le=oe,Fi(C,D,le),C=o[le>>2]|0,(C|0)<=1)return ee=0,Vt=oe,+ee;D=C+-1|0,C=0,z=0,R=+ke[le+8>>3],ee=+ke[le+16>>3];do C=C+1|0,We=R,R=+ke[le+8+(C<<4)>>3],yt=+vi(+((R-We)*.5)),we=ee,ee=+ke[le+8+(C<<4)+8>>3],we=+vi(+((ee-we)*.5)),we=yt*yt+we*(+Bi(+R)*+Bi(+We)*we),z=z+ +mn(+ +ti(+we),+ +ti(+(1-we)))*2;while((C|0)<(D|0));return Vt=oe,+z}function Ms(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0;if(oe=Vt,Vt=Vt+176|0,le=oe,Fi(C,D,le),C=o[le>>2]|0,(C|0)<=1)return ee=0,Vt=oe,+ee;D=C+-1|0,C=0,z=0,R=+ke[le+8>>3],ee=+ke[le+16>>3];do C=C+1|0,We=R,R=+ke[le+8+(C<<4)>>3],yt=+vi(+((R-We)*.5)),we=ee,ee=+ke[le+8+(C<<4)+8>>3],we=+vi(+((ee-we)*.5)),we=yt*yt+we*(+Bi(+We)*+Bi(+R)*we),z=z+ +mn(+ +ti(+we),+ +ti(+(1-we)))*2;while((C|0)!=(D|0));return yt=z*6371.007180918475,Vt=oe,+yt}function Mr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0;if(oe=Vt,Vt=Vt+176|0,le=oe,Fi(C,D,le),C=o[le>>2]|0,(C|0)<=1)return ee=0,Vt=oe,+ee;D=C+-1|0,C=0,z=0,R=+ke[le+8>>3],ee=+ke[le+16>>3];do C=C+1|0,We=R,R=+ke[le+8+(C<<4)>>3],yt=+vi(+((R-We)*.5)),we=ee,ee=+ke[le+8+(C<<4)+8>>3],we=+vi(+((ee-we)*.5)),we=yt*yt+we*(+Bi(+We)*+Bi(+R)*we),z=z+ +mn(+ +ti(+we),+ +ti(+(1-we)))*2;while((C|0)!=(D|0));return yt=z*6371.007180918475*1e3,Vt=oe,+yt}function nr(C,D){return C=C|0,D=D|0,D=ki(C|0,D|0,52)|0,Wt()|0,D&15|0}function ll(C,D){return C=C|0,D=D|0,D=ki(C|0,D|0,45)|0,Wt()|0,D&127|0}function Xr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0;if(!(!0&(D&-16777216|0)==134217728)||(oe=ki(C|0,D|0,45)|0,Wt()|0,oe=oe&127,oe>>>0>121))return D=0,D|0;z=ki(C|0,D|0,52)|0,Wt()|0,z=z&15;do if(z|0){for(ee=1,R=0;;){if(le=ki(C|0,D|0,(15-ee|0)*3|0)|0,Wt()|0,le=le&7,(le|0)!=0&(R^1))if((le|0)==1&(N(oe)|0)!=0){we=0,R=13;break}else R=1;if((le|0)==7){we=0,R=13;break}if(ee>>>0<z>>>0)ee=ee+1|0;else{R=9;break}}if((R|0)==9){if((z|0)==15)we=1;else break;return we|0}else if((R|0)==13)return we|0}while(!1);for(;;){if(we=ki(C|0,D|0,(14-z|0)*3|0)|0,Wt()|0,!((we&7|0)==7&!0)){we=0,R=13;break}if(z>>>0<14)z=z+1|0;else{we=1,R=13;break}}return(R|0)==13?we|0:0}function Po(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;if(R=ki(C|0,D|0,52)|0,Wt()|0,R=R&15,(R|0)>=(z|0)){if((R|0)!=(z|0))if(z>>>0<=15){if(ee=Li(z|0,0,52)|0,C=ee|C,D=Wt()|0|D&-15728641,(R|0)>(z|0))do ee=Li(7,0,(14-z|0)*3|0)|0,z=z+1|0,C=ee|C,D=Wt()|0|D;while((z|0)<(R|0))}else D=0,C=0}else D=0,C=0;return Vn(D|0),C|0}function ul(C,D,z){return C=C|0,D=D|0,z=z|0,C=ki(C|0,D|0,52)|0,Wt()|0,C=C&15,(z|0)<16&(C|0)<=(z|0)?(z=vo(7,z-C|0)|0,z|0):(z=0,z|0)}function Qr(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,We=0,yt=0,Ct=0;if(oe=ki(C|0,D|0,52)|0,Wt()|0,oe=oe&15,!!((z|0)<16&(oe|0)<=(z|0))){if((oe|0)==(z|0)){z=R,o[z>>2]=C,o[z+4>>2]=D;return}if(We=vo(7,z-oe|0)|0,yt=(We|0)/7|0,we=ki(C|0,D|0,45)|0,Wt()|0,!(N(we&127)|0))le=0;else{e:do if(!oe)ee=0;else for(le=1;;){if(ee=ki(C|0,D|0,(15-le|0)*3|0)|0,Wt()|0,ee=ee&7,ee|0)break e;if(le>>>0<oe>>>0)le=le+1|0;else{ee=0;break}}while(!1);le=(ee|0)==0}if(Ct=Li(oe+1|0,0,52)|0,ee=Wt()|0|D&-15728641,we=(14-oe|0)*3|0,D=Li(7,0,we|0)|0,D=(Ct|C)&~D,oe=ee&~(Wt()|0),Qr(D,oe,z,R),ee=R+(yt<<3)|0,!le){Ct=Li(1,0,we|0)|0,Qr(Ct|D,Wt()|0|oe,z,ee),Ct=ee+(yt<<3)|0,We=Li(2,0,we|0)|0,Qr(We|D,Wt()|0|oe,z,Ct),Ct=Ct+(yt<<3)|0,We=Li(3,0,we|0)|0,Qr(We|D,Wt()|0|oe,z,Ct),Ct=Ct+(yt<<3)|0,We=Li(4,0,we|0)|0,Qr(We|D,Wt()|0|oe,z,Ct),Ct=Ct+(yt<<3)|0,We=Li(5,0,we|0)|0,Qr(We|D,Wt()|0|oe,z,Ct),We=Li(6,0,we|0)|0,Qr(We|D,Wt()|0|oe,z,Ct+(yt<<3)|0);return}le=ee+(yt<<3)|0,(We|0)>6&&(We=ee+8|0,Ct=(le>>>0>We>>>0?le:We)+-1+(0-ee)|0,fs(ee|0,0,Ct+8&-8|0)|0,ee=We+(Ct>>>3<<3)|0),Ct=Li(2,0,we|0)|0,Qr(Ct|D,Wt()|0|oe,z,ee),Ct=ee+(yt<<3)|0,We=Li(3,0,we|0)|0,Qr(We|D,Wt()|0|oe,z,Ct),Ct=Ct+(yt<<3)|0,We=Li(4,0,we|0)|0,Qr(We|D,Wt()|0|oe,z,Ct),Ct=Ct+(yt<<3)|0,We=Li(5,0,we|0)|0,Qr(We|D,Wt()|0|oe,z,Ct),We=Li(6,0,we|0)|0,Qr(We|D,Wt()|0|oe,z,Ct+(yt<<3)|0)}}function ds(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;if(ee=ki(C|0,D|0,45)|0,Wt()|0,!(N(ee&127)|0))return ee=0,ee|0;ee=ki(C|0,D|0,52)|0,Wt()|0,ee=ee&15;e:do if(!ee)z=0;else for(R=1;;){if(z=ki(C|0,D|0,(15-R|0)*3|0)|0,Wt()|0,z=z&7,z|0)break e;if(R>>>0<ee>>>0)R=R+1|0;else{z=0;break}}while(!1);return ee=(z|0)==0&1,ee|0}function Ia(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;if(R=ki(C|0,D|0,52)|0,Wt()|0,R=R&15,(z|0)<16&(R|0)<=(z|0)){if((R|0)!=(z|0)&&(ee=Li(z|0,0,52)|0,C=ee|C,D=Wt()|0|D&-15728641,(R|0)<(z|0)))do ee=Li(7,0,(14-R|0)*3|0)|0,R=R+1|0,C=C&~ee,D=D&~(Wt()|0);while((R|0)<(z|0))}else D=0,C=0;return Vn(D|0),C|0}function Tl(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0;if(!z)return l=0,l|0;if(ee=C,R=o[ee>>2]|0,ee=o[ee+4>>2]|0,!0&(ee&15728640|0)==0){if((z|0)<=0||(l=D,o[l>>2]=R,o[l+4>>2]=ee,(z|0)==1))return l=0,l|0;R=1;do i=C+(R<<3)|0,r=o[i+4>>2]|0,l=D+(R<<3)|0,o[l>>2]=o[i>>2],o[l+4>>2]=r,R=R+1|0;while((R|0)!=(z|0));return R=0,R|0}if(i=z<<3,r=Zn(i)|0,!r)return l=-3,l|0;if(Vo(r|0,C|0,i|0)|0,s=tl(z,8)|0,!s)return Jn(r),l=-3,l|0;R=z;e:for(;;){oe=r,Ct=o[oe>>2]|0,oe=o[oe+4>>2]|0,O=ki(Ct|0,oe|0,52)|0,Wt()|0,O=O&15,y=O+-1|0,F=(R|0)>0;t:do if(F){if(E=((R|0)<0)<<31>>31,Z=Li(y|0,0,52)|0,A=Wt()|0,y>>>0>15)for(ee=0,C=Ct,z=oe;;){if(!((C|0)==0&(z|0)==0)){if(le=ki(C|0,z|0,52)|0,Wt()|0,le=le&15,we=(le|0)<(y|0),le=(le|0)==(y|0),yt=we?0:le?C:0,C=we?0:le?z:0,z=Lo(yt|0,C|0,R|0,E|0)|0,Wt()|0,le=s+(z<<3)|0,we=le,We=o[we>>2]|0,we=o[we+4>>2]|0,(We|0)==0&(we|0)==0)z=yt;else for(Z=0,Zt=z,Gt=we,z=yt;;){if((Z|0)>(R|0)){l=41;break e}if((We|0)==(z|0)&(Gt&-117440513|0)==(C|0)){yt=ki(We|0,Gt|0,56)|0,Wt()|0,yt=yt&7,ri=yt+1|0,A=ki(We|0,Gt|0,45)|0,Wt()|0;i:do if(!(N(A&127)|0))we=7;else{if(We=ki(We|0,Gt|0,52)|0,Wt()|0,We=We&15,!We){we=6;break}for(we=1;;){if(A=Li(7,0,(15-we|0)*3|0)|0,!((A&z|0)==0&((Wt()|0)&C|0)==0)){we=7;break i}if(we>>>0<We>>>0)we=we+1|0;else{we=6;break}}}while(!1);if((yt+2|0)>>>0>we>>>0){l=51;break e}A=Li(ri|0,0,56)|0,C=Wt()|0|C&-117440513,we=le,o[we>>2]=0,o[we+4>>2]=0,we=Zt,z=A|z}else we=(Zt+1|0)%(R|0)|0;if(le=s+(we<<3)|0,Gt=le,We=o[Gt>>2]|0,Gt=o[Gt+4>>2]|0,(We|0)==0&(Gt|0)==0)break;Z=Z+1|0,Zt=we}A=le,o[A>>2]=z,o[A+4>>2]=C}if(ee=ee+1|0,(ee|0)>=(R|0))break t;z=r+(ee<<3)|0,C=o[z>>2]|0,z=o[z+4>>2]|0}for(ee=0,C=Ct,z=oe;;){if(!((C|0)==0&(z|0)==0)){if(we=ki(C|0,z|0,52)|0,Wt()|0,we=we&15,(we|0)>=(y|0)){if((we|0)!=(y|0)&&(C=C|Z,z=z&-15728641|A,we>>>0>=O>>>0)){le=y;do Zt=Li(7,0,(14-le|0)*3|0)|0,le=le+1|0,C=Zt|C,z=Wt()|0|z;while(le>>>0<we>>>0)}}else C=0,z=0;if(we=Lo(C|0,z|0,R|0,E|0)|0,Wt()|0,le=s+(we<<3)|0,We=le,yt=o[We>>2]|0,We=o[We+4>>2]|0,!((yt|0)==0&(We|0)==0))for(Zt=0;;){if((Zt|0)>(R|0)){l=41;break e}if((yt|0)==(C|0)&(We&-117440513|0)==(z|0)){ri=ki(yt|0,We|0,56)|0,Wt()|0,ri=ri&7,Gt=ri+1|0,d=ki(yt|0,We|0,45)|0,Wt()|0;i:do if(!(N(d&127)|0))We=7;else{if(yt=ki(yt|0,We|0,52)|0,Wt()|0,yt=yt&15,!yt){We=6;break}for(We=1;;){if(d=Li(7,0,(15-We|0)*3|0)|0,!((d&C|0)==0&((Wt()|0)&z|0)==0)){We=7;break i}if(We>>>0<yt>>>0)We=We+1|0;else{We=6;break}}}while(!1);if((ri+2|0)>>>0>We>>>0){l=51;break e}d=Li(Gt|0,0,56)|0,z=Wt()|0|z&-117440513,Gt=le,o[Gt>>2]=0,o[Gt+4>>2]=0,C=d|C}else we=(we+1|0)%(R|0)|0;if(le=s+(we<<3)|0,We=le,yt=o[We>>2]|0,We=o[We+4>>2]|0,(yt|0)==0&(We|0)==0)break;Zt=Zt+1|0}d=le,o[d>>2]=C,o[d+4>>2]=z}if(ee=ee+1|0,(ee|0)>=(R|0))break t;z=r+(ee<<3)|0,C=o[z>>2]|0,z=o[z+4>>2]|0}}while(!1);if((R+5|0)>>>0<11){l=99;break}if(A=tl((R|0)/6|0,8)|0,!A){l=58;break}t:do if(F){Zt=0,Gt=0;do{if(we=s+(Zt<<3)|0,C=we,ee=o[C>>2]|0,C=o[C+4>>2]|0,!((ee|0)==0&(C|0)==0)){We=ki(ee|0,C|0,56)|0,Wt()|0,We=We&7,z=We+1|0,yt=C&-117440513,d=ki(ee|0,C|0,45)|0,Wt()|0;i:do if(N(d&127)|0){if(ri=ki(ee|0,C|0,52)|0,Wt()|0,ri=ri&15,ri|0)for(le=1;;){if(d=Li(7,0,(15-le|0)*3|0)|0,!((ee&d|0)==0&(yt&(Wt()|0)|0)==0))break i;if(le>>>0<ri>>>0)le=le+1|0;else break}C=Li(z|0,0,56)|0,ee=C|ee,C=Wt()|0|yt,z=we,o[z>>2]=ee,o[z+4>>2]=C,z=We+2|0}while(!1);(z|0)==7&&(d=A+(Gt<<3)|0,o[d>>2]=ee,o[d+4>>2]=C&-117440513,Gt=Gt+1|0)}Zt=Zt+1|0}while((Zt|0)!=(R|0));if(F){if(Z=((R|0)<0)<<31>>31,ri=Li(y|0,0,52)|0,Zt=Wt()|0,y>>>0>15)for(C=0,ee=0;;){do if(!((Ct|0)==0&(oe|0)==0)){for(We=ki(Ct|0,oe|0,52)|0,Wt()|0,We=We&15,le=(We|0)<(y|0),We=(We|0)==(y|0),we=le?0:We?Ct:0,We=le?0:We?oe:0,le=Lo(we|0,We|0,R|0,Z|0)|0,Wt()|0,z=0;;){if((z|0)>(R|0)){l=98;break e}if(d=s+(le<<3)|0,yt=o[d+4>>2]|0,(yt&-117440513|0)==(We|0)&&(o[d>>2]|0)==(we|0)){l=70;break}if(le=(le+1|0)%(R|0)|0,d=s+(le<<3)|0,(o[d>>2]|0)==(we|0)&&(o[d+4>>2]|0)==(We|0))break;z=z+1|0}if((l|0)==70&&(l=0,!0&(yt&117440512|0)==100663296))break;d=D+(ee<<3)|0,o[d>>2]=Ct,o[d+4>>2]=oe,ee=ee+1|0}while(!1);if(C=C+1|0,(C|0)>=(R|0)){R=Gt;break t}oe=r+(C<<3)|0,Ct=o[oe>>2]|0,oe=o[oe+4>>2]|0}for(C=0,ee=0;;){do if(!((Ct|0)==0&(oe|0)==0)){if(We=ki(Ct|0,oe|0,52)|0,Wt()|0,We=We&15,(We|0)>=(y|0))if((We|0)!=(y|0))if(z=Ct|ri,le=oe&-15728641|Zt,We>>>0<O>>>0)We=le;else{we=y;do d=Li(7,0,(14-we|0)*3|0)|0,we=we+1|0,z=d|z,le=Wt()|0|le;while(we>>>0<We>>>0);We=le}else z=Ct,We=oe;else z=0,We=0;for(we=Lo(z|0,We|0,R|0,Z|0)|0,Wt()|0,le=0;;){if((le|0)>(R|0)){l=98;break e}if(d=s+(we<<3)|0,yt=o[d+4>>2]|0,(yt&-117440513|0)==(We|0)&&(o[d>>2]|0)==(z|0)){l=93;break}if(we=(we+1|0)%(R|0)|0,d=s+(we<<3)|0,(o[d>>2]|0)==(z|0)&&(o[d+4>>2]|0)==(We|0))break;le=le+1|0}if((l|0)==93&&(l=0,!0&(yt&117440512|0)==100663296))break;d=D+(ee<<3)|0,o[d>>2]=Ct,o[d+4>>2]=oe,ee=ee+1|0}while(!1);if(C=C+1|0,(C|0)>=(R|0)){R=Gt;break t}oe=r+(C<<3)|0,Ct=o[oe>>2]|0,oe=o[oe+4>>2]|0}}else ee=0,R=Gt}else ee=0,R=0;while(!1);if(fs(s|0,0,i|0)|0,Vo(r|0,A|0,R<<3|0)|0,Jn(A),R)D=D+(ee<<3)|0;else break}return(l|0)==41?(Jn(r),Jn(s),d=-1,d|0):(l|0)==51?(Jn(r),Jn(s),d=-2,d|0):(l|0)==58?(Jn(r),Jn(s),d=-3,d|0):(l|0)==98?(Jn(A),Jn(r),Jn(s),d=-1,d|0):((l|0)==99&&Vo(D|0,r|0,R<<3|0)|0,Jn(r),Jn(s),d=0,d|0)}function Do(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,We=0,yt=0,Ct=0;if((D|0)<=0)return ee=0,ee|0;if((ee|0)>=16){for(le=0;;){if(Ct=C+(le<<3)|0,!((o[Ct>>2]|0)==0&(o[Ct+4>>2]|0)==0)){le=14;break}if(le=le+1|0,(le|0)>=(D|0)){oe=0,le=16;break}}if((le|0)==14)return((R|0)>0?-2:-1)|0;if((le|0)==16)return oe|0}le=0,Ct=0;e:for(;;){yt=C+(Ct<<3)|0,we=yt,oe=o[we>>2]|0,we=o[we+4>>2]|0;do if(!((oe|0)==0&(we|0)==0)){if((le|0)>=(R|0)){oe=-1,le=16;break e}if(We=ki(oe|0,we|0,52)|0,Wt()|0,We=We&15,(We|0)>(ee|0)){oe=-2,le=16;break e}if((We|0)==(ee|0)){yt=z+(le<<3)|0,o[yt>>2]=oe,o[yt+4>>2]=we,le=le+1|0;break}if(oe=(vo(7,ee-We|0)|0)+le|0,(oe|0)>(R|0)){oe=-1,le=16;break e}Qr(o[yt>>2]|0,o[yt+4>>2]|0,ee,z+(le<<3)|0),le=oe}while(!1);if(Ct=Ct+1|0,(Ct|0)>=(D|0)){oe=0,le=16;break}}return(le|0)==16?oe|0:0}function kl(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0;if((D|0)<=0)return z=0,z|0;if((z|0)>=16){for(R=0;;){if(oe=C+(R<<3)|0,!((o[oe>>2]|0)==0&(o[oe+4>>2]|0)==0)){R=-1,ee=13;break}if(R=R+1|0,(R|0)>=(D|0)){R=0,ee=13;break}}if((ee|0)==13)return R|0}R=0,oe=0;e:for(;;){ee=C+(oe<<3)|0,le=o[ee>>2]|0,ee=o[ee+4>>2]|0;do if(!((le|0)==0&(ee|0)==0)){if(ee=ki(le|0,ee|0,52)|0,Wt()|0,ee=ee&15,(ee|0)>(z|0)){R=-1,ee=13;break e}if((ee|0)==(z|0)){R=R+1|0;break}else{R=(vo(7,z-ee|0)|0)+R|0;break}}while(!1);if(oe=oe+1|0,(oe|0)>=(D|0)){ee=13;break}}return(ee|0)==13?R|0:0}function go(C,D){return C=C|0,D=D|0,D=ki(C|0,D|0,52)|0,Wt()|0,D&1|0}function Js(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;if(ee=ki(C|0,D|0,52)|0,Wt()|0,ee=ee&15,!ee)return ee=0,ee|0;for(R=1;;){if(z=ki(C|0,D|0,(15-R|0)*3|0)|0,Wt()|0,z=z&7,z|0){R=5;break}if(R>>>0<ee>>>0)R=R+1|0;else{z=0,R=5;break}}return(R|0)==5?z|0:0}function qs(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0;if(We=ki(C|0,D|0,52)|0,Wt()|0,We=We&15,!We)return we=D,We=C,Vn(we|0),We|0;for(we=1,z=0;;){le=(15-we|0)*3|0,R=Li(7,0,le|0)|0,ee=Wt()|0,oe=ki(C|0,D|0,le|0)|0,Wt()|0,le=Li(ha(oe&7)|0,0,le|0)|0,oe=Wt()|0,C=le|C&~R,D=oe|D&~ee;e:do if(!z)if((le&R|0)==0&(oe&ee|0)==0)z=0;else if(R=ki(C|0,D|0,52)|0,Wt()|0,R=R&15,!R)z=1;else{z=1;t:for(;;){switch(oe=ki(C|0,D|0,(15-z|0)*3|0)|0,Wt()|0,oe&7){case 1:break t;case 0:break;default:{z=1;break e}}if(z>>>0<R>>>0)z=z+1|0;else{z=1;break e}}for(z=1;;)if(oe=(15-z|0)*3|0,ee=ki(C|0,D|0,oe|0)|0,Wt()|0,le=Li(7,0,oe|0)|0,D=D&~(Wt()|0),oe=Li(ha(ee&7)|0,0,oe|0)|0,C=C&~le|oe,D=D|(Wt()|0),z>>>0<R>>>0)z=z+1|0;else{z=1;break}}while(!1);if(we>>>0<We>>>0)we=we+1|0;else break}return Vn(D|0),C|0}function Ya(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0;if(R=ki(C|0,D|0,52)|0,Wt()|0,R=R&15,!R)return z=D,R=C,Vn(z|0),R|0;for(z=1;le=(15-z|0)*3|0,oe=ki(C|0,D|0,le|0)|0,Wt()|0,ee=Li(7,0,le|0)|0,D=D&~(Wt()|0),le=Li(ha(oe&7)|0,0,le|0)|0,C=le|C&~ee,D=Wt()|0|D,z>>>0<R>>>0;)z=z+1|0;return Vn(D|0),C|0}function Jo(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0;if(We=ki(C|0,D|0,52)|0,Wt()|0,We=We&15,!We)return we=D,We=C,Vn(we|0),We|0;for(we=1,z=0;;){le=(15-we|0)*3|0,R=Li(7,0,le|0)|0,ee=Wt()|0,oe=ki(C|0,D|0,le|0)|0,Wt()|0,le=Li(Ys(oe&7)|0,0,le|0)|0,oe=Wt()|0,C=le|C&~R,D=oe|D&~ee;e:do if(!z)if((le&R|0)==0&(oe&ee|0)==0)z=0;else if(R=ki(C|0,D|0,52)|0,Wt()|0,R=R&15,!R)z=1;else{z=1;t:for(;;){switch(oe=ki(C|0,D|0,(15-z|0)*3|0)|0,Wt()|0,oe&7){case 1:break t;case 0:break;default:{z=1;break e}}if(z>>>0<R>>>0)z=z+1|0;else{z=1;break e}}for(z=1;;)if(ee=(15-z|0)*3|0,le=Li(7,0,ee|0)|0,oe=D&~(Wt()|0),D=ki(C|0,D|0,ee|0)|0,Wt()|0,D=Li(Ys(D&7)|0,0,ee|0)|0,C=C&~le|D,D=oe|(Wt()|0),z>>>0<R>>>0)z=z+1|0;else{z=1;break}}while(!1);if(we>>>0<We>>>0)we=we+1|0;else break}return Vn(D|0),C|0}function Yr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0;if(R=ki(C|0,D|0,52)|0,Wt()|0,R=R&15,!R)return z=D,R=C,Vn(z|0),R|0;for(z=1;oe=(15-z|0)*3|0,le=Li(7,0,oe|0)|0,ee=D&~(Wt()|0),D=ki(C|0,D|0,oe|0)|0,Wt()|0,D=Li(Ys(D&7)|0,0,oe|0)|0,C=D|C&~le,D=Wt()|0|ee,z>>>0<R>>>0;)z=z+1|0;return Vn(D|0),C|0}function gr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0,Ct=0;if(We=Vt,Vt=Vt+64|0,we=We+40|0,R=We+24|0,ee=We+12|0,le=We,Li(D|0,0,52)|0,z=Wt()|0|134225919,!D)return(o[C+4>>2]|0)>2||(o[C+8>>2]|0)>2||(o[C+12>>2]|0)>2?(oe=0,we=0,Vn(oe|0),Vt=We,we|0):(Li(nt(C)|0,0,45)|0,oe=Wt()|0|z,we=-1,Vn(oe|0),Vt=We,we|0);if(o[we>>2]=o[C>>2],o[we+4>>2]=o[C+4>>2],o[we+8>>2]=o[C+8>>2],o[we+12>>2]=o[C+12>>2],oe=we+4|0,(D|0)>0)for(C=-1;o[R>>2]=o[oe>>2],o[R+4>>2]=o[oe+4>>2],o[R+8>>2]=o[oe+8>>2],D&1?(Br(oe),o[ee>>2]=o[oe>>2],o[ee+4>>2]=o[oe+4>>2],o[ee+8>>2]=o[oe+8>>2],Zo(ee)):(To(oe),o[ee>>2]=o[oe>>2],o[ee+4>>2]=o[oe+4>>2],o[ee+8>>2]=o[oe+8>>2],Bs(ee)),Zs(R,ee,le),ir(le),Ct=(15-D|0)*3|0,yt=Li(7,0,Ct|0)|0,z=z&~(Wt()|0),Ct=Li(Ks(le)|0,0,Ct|0)|0,C=Ct|C&~yt,z=Wt()|0|z,(D|0)>1;)D=D+-1|0;else C=-1;e:do if((o[oe>>2]|0)<=2&&(o[we+8>>2]|0)<=2&&(o[we+12>>2]|0)<=2){if(R=nt(we)|0,D=Li(R|0,0,45)|0,D=D|C,C=Wt()|0|z&-1040385,le=It(we)|0,!(N(R)|0)){if((le|0)<=0)break;for(ee=0;;){if(R=ki(D|0,C|0,52)|0,Wt()|0,R=R&15,R)for(z=1;Ct=(15-z|0)*3|0,we=ki(D|0,C|0,Ct|0)|0,Wt()|0,yt=Li(7,0,Ct|0)|0,C=C&~(Wt()|0),Ct=Li(ha(we&7)|0,0,Ct|0)|0,D=D&~yt|Ct,C=C|(Wt()|0),z>>>0<R>>>0;)z=z+1|0;if(ee=ee+1|0,(ee|0)==(le|0))break e}}ee=ki(D|0,C|0,52)|0,Wt()|0,ee=ee&15;t:do if(ee){z=1;i:for(;;){switch(Ct=ki(D|0,C|0,(15-z|0)*3|0)|0,Wt()|0,Ct&7){case 1:break i;case 0:break;default:break t}if(z>>>0<ee>>>0)z=z+1|0;else break t}if(Di(R,o[we>>2]|0)|0)for(z=1;we=(15-z|0)*3|0,yt=Li(7,0,we|0)|0,Ct=C&~(Wt()|0),C=ki(D|0,C|0,we|0)|0,Wt()|0,C=Li(Ys(C&7)|0,0,we|0)|0,D=D&~yt|C,C=Ct|(Wt()|0),z>>>0<ee>>>0;)z=z+1|0;else for(z=1;Ct=(15-z|0)*3|0,we=ki(D|0,C|0,Ct|0)|0,Wt()|0,yt=Li(7,0,Ct|0)|0,C=C&~(Wt()|0),Ct=Li(ha(we&7)|0,0,Ct|0)|0,D=D&~yt|Ct,C=C|(Wt()|0),z>>>0<ee>>>0;)z=z+1|0}while(!1);if((le|0)>0){z=0;do D=qs(D,C)|0,C=Wt()|0,z=z+1|0;while((z|0)!=(le|0))}}else D=0,C=0;while(!1);return yt=C,Ct=D,Vn(yt|0),Vt=We,Ct|0}function Nr(C){return C=C|0,(C|0)%2|0|0}function Aa(C,D){C=C|0,D=D|0;var z=0,R=0;return R=Vt,Vt=Vt+16|0,z=R,D>>>0<=15&&(o[C+4>>2]&2146435072|0)!=2146435072&&(o[C+8+4>>2]&2146435072|0)!=2146435072?(ac(C,D,z),D=gr(z,D)|0,C=Wt()|0):(C=0,D=0),Vn(C|0),Vt=R,D|0}function _o(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0;if(ee=z+4|0,le=ki(C|0,D|0,52)|0,Wt()|0,le=le&15,oe=ki(C|0,D|0,45)|0,Wt()|0,R=(le|0)==0,N(oe&127)|0){if(R)return oe=1,oe|0;R=1}else{if(R)return oe=0,oe|0;!(o[ee>>2]|0)&&!(o[z+8>>2]|0)?R=(o[z+12>>2]|0)!=0&1:R=1}for(z=1;z&1?Zo(ee):Bs(ee),oe=ki(C|0,D|0,(15-z|0)*3|0)|0,Wt()|0,Il(ee,oe&7),z>>>0<le>>>0;)z=z+1|0;return R|0}function ea(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0,Ct=0;Ct=Vt,Vt=Vt+16|0,We=Ct,yt=ki(C|0,D|0,45)|0,Wt()|0,yt=yt&127;e:do if(N(yt)|0&&(le=ki(C|0,D|0,52)|0,Wt()|0,le=le&15,(le|0)!=0)){R=1;t:for(;;){switch(we=ki(C|0,D|0,(15-R|0)*3|0)|0,Wt()|0,we&7){case 5:break t;case 0:break;default:{R=D;break e}}if(R>>>0<le>>>0)R=R+1|0;else{R=D;break e}}for(ee=1,R=D;D=(15-ee|0)*3|0,oe=Li(7,0,D|0)|0,we=R&~(Wt()|0),R=ki(C|0,R|0,D|0)|0,Wt()|0,R=Li(Ys(R&7)|0,0,D|0)|0,C=C&~oe|R,R=we|(Wt()|0),ee>>>0<le>>>0;)ee=ee+1|0}else R=D;while(!1);if(we=7728+(yt*28|0)|0,o[z>>2]=o[we>>2],o[z+4>>2]=o[we+4>>2],o[z+8>>2]=o[we+8>>2],o[z+12>>2]=o[we+12>>2],!(_o(C,R,z)|0)){Vt=Ct;return}if(oe=z+4|0,o[We>>2]=o[oe>>2],o[We+4>>2]=o[oe+4>>2],o[We+8>>2]=o[oe+8>>2],le=ki(C|0,R|0,52)|0,Wt()|0,we=le&15,le&1?(Bs(oe),le=we+1|0):le=we,!(N(yt)|0))R=0;else{e:do if(!we)R=0;else for(D=1;;){if(ee=ki(C|0,R|0,(15-D|0)*3|0)|0,Wt()|0,ee=ee&7,ee|0){R=ee;break e}if(D>>>0<we>>>0)D=D+1|0;else{R=0;break}}while(!1);R=(R|0)==4&1}if(!(ko(z,le,R,0)|0))(le|0)!=(we|0)&&(o[oe>>2]=o[We>>2],o[oe+4>>2]=o[We+4>>2],o[oe+8>>2]=o[We+8>>2]);else{if(N(yt)|0)do;while(ko(z,le,0,0)|0);(le|0)!=(we|0)&&To(oe)}Vt=Ct}function Ea(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;R=Vt,Vt=Vt+16|0,ee=R,ea(C,D,ee),D=ki(C|0,D|0,52)|0,Wt()|0,Wl(ee,D&15,z),Vt=R}function Pa(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0;oe=Vt,Vt=Vt+16|0,le=oe,ea(C,D,le),R=ki(C|0,D|0,45)|0,Wt()|0,R=(N(R&127)|0)==0,ee=ki(C|0,D|0,52)|0,Wt()|0,ee=ee&15;e:do if(!R){if(ee|0)for(R=1;;){if(we=Li(7,0,(15-R|0)*3|0)|0,!((we&C|0)==0&((Wt()|0)&D|0)==0))break e;if(R>>>0<ee>>>0)R=R+1|0;else break}Oo(le,ee,0,5,z),Vt=oe;return}while(!1);$o(le,ee,0,6,z),Vt=oe}function Ka(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;if(R=ki(C|0,D|0,45)|0,Wt()|0,!(N(R&127)|0))return R=2,R|0;if(R=ki(C|0,D|0,52)|0,Wt()|0,R=R&15,!R)return R=5,R|0;for(z=1;;){if(ee=Li(7,0,(15-z|0)*3|0)|0,!((ee&C|0)==0&((Wt()|0)&D|0)==0)){z=2,C=6;break}if(z>>>0<R>>>0)z=z+1|0;else{z=5,C=6;break}}return(C|0)==6?z|0:0}function cl(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0;ri=Vt,Vt=Vt+128|0,yt=ri+112|0,le=ri+96|0,Ct=ri,ee=ki(C|0,D|0,52)|0,Wt()|0,we=ee&15,o[yt>>2]=we,oe=ki(C|0,D|0,45)|0,Wt()|0,oe=oe&127;e:do if(N(oe)|0){if(we|0)for(R=1;;){if(We=Li(7,0,(15-R|0)*3|0)|0,!((We&C|0)==0&((Wt()|0)&D|0)==0)){ee=0;break e}if(R>>>0<we>>>0)R=R+1|0;else break}if(ee&1)ee=1;else{We=Li(we+1|0,0,52)|0,Ct=Wt()|0|D&-15728641,yt=Li(7,0,(14-we|0)*3|0)|0,cl((We|C)&~yt,Ct&~(Wt()|0),z),Vt=ri;return}}else ee=0;while(!1);ea(C,D,le),ee?(Wo(le,yt,Ct),We=5):(Xo(le,yt,Ct),We=6);e:do if(N(oe)|0)if(!we)R=20;else for(R=1;;){if(oe=Li(7,0,(15-R|0)*3|0)|0,!((oe&C|0)==0&((Wt()|0)&D|0)==0)){R=8;break e}if(R>>>0<we>>>0)R=R+1|0;else{R=20;break}}else R=8;while(!1);if(fs(z|0,-1,R|0)|0,ee){ee=0;do{for(le=Ct+(ee<<4)|0,Gs(le,o[yt>>2]|0)|0,le=o[le>>2]|0,R=0;oe=z+(R<<2)|0,we=o[oe>>2]|0,!((we|0)==-1|(we|0)==(le|0));)R=R+1|0;o[oe>>2]=le,ee=ee+1|0}while((ee|0)!=(We|0))}else{ee=0;do{for(le=Ct+(ee<<4)|0,ko(le,o[yt>>2]|0,0,1)|0,le=o[le>>2]|0,R=0;oe=z+(R<<2)|0,we=o[oe>>2]|0,!((we|0)==-1|(we|0)==(le|0));)R=R+1|0;o[oe>>2]=le,ee=ee+1|0}while((ee|0)!=(We|0))}Vt=ri}function lu(){return 12}function gl(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0;if(Li(C|0,0,52)|0,we=Wt()|0|134225919,(C|0)<1){R=0,z=0;do N(R)|0&&(Li(R|0,0,45)|0,oe=we|(Wt()|0),C=D+(z<<3)|0,o[C>>2]=-1,o[C+4>>2]=oe,z=z+1|0),R=R+1|0;while((R|0)!=122);return}oe=0,z=0;do{if(N(oe)|0){for(Li(oe|0,0,45)|0,R=1,ee=-1,le=we|(Wt()|0);We=Li(7,0,(15-R|0)*3|0)|0,ee=ee&~We,le=le&~(Wt()|0),(R|0)!=(C|0);)R=R+1|0;We=D+(z<<3)|0,o[We>>2]=ee,o[We+4>>2]=le,z=z+1|0}oe=oe+1|0}while((oe|0)!=122)}function ao(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,We=0,yt=0;if(we=Vt,Vt=Vt+64|0,oe=we,(C|0)==(z|0)&(D|0)==(R|0)|(!1|(D&2013265920|0)!=134217728|(!1|(R&2013265920|0)!=134217728))||(ee=ki(C|0,D|0,52)|0,Wt()|0,ee=ee&15,le=ki(z|0,R|0,52)|0,Wt()|0,(ee|0)!=(le&15|0)))return oe=0,Vt=we,oe|0;if(le=ee+-1|0,ee>>>0>1&&(yt=Po(C,D,le)|0,We=Wt()|0,le=Po(z,R,le)|0,(yt|0)==(le|0)&(We|0)==(Wt()|0))&&(le=(ee^15)*3|0,ee=ki(C|0,D|0,le|0)|0,Wt()|0,ee=ee&7,le=ki(z|0,R|0,le|0)|0,Wt()|0,le=le&7,(ee|0)==0|(le|0)==0||(o[21136+(ee<<2)>>2]|0)==(le|0)||(o[21168+(ee<<2)>>2]|0)==(le|0)))return yt=1,Vt=we,yt|0;ee=oe,le=ee+56|0;do o[ee>>2]=0,ee=ee+4|0;while((ee|0)<(le|0));return Ua(C,D,1,oe),yt=oe,!((o[yt>>2]|0)==(z|0)&&(o[yt+4>>2]|0)==(R|0))&&(yt=oe+8|0,!((o[yt>>2]|0)==(z|0)&&(o[yt+4>>2]|0)==(R|0)))&&(yt=oe+16|0,!((o[yt>>2]|0)==(z|0)&&(o[yt+4>>2]|0)==(R|0)))&&(yt=oe+24|0,!((o[yt>>2]|0)==(z|0)&&(o[yt+4>>2]|0)==(R|0)))&&(yt=oe+32|0,!((o[yt>>2]|0)==(z|0)&&(o[yt+4>>2]|0)==(R|0)))&&(yt=oe+40|0,!((o[yt>>2]|0)==(z|0)&&(o[yt+4>>2]|0)==(R|0)))?(ee=oe+48|0,ee=((o[ee>>2]|0)==(z|0)?(o[ee+4>>2]|0)==(R|0):0)&1):ee=1,yt=ee,Vt=we,yt|0}function pi(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,We=0,yt=0,Ct=0;if(yt=Vt,Vt=Vt+16|0,oe=yt,!(ao(C,D,z,R)|0))return we=0,We=0,Vn(we|0),Vt=yt,We|0;for(we=D&-2130706433,ee=(ds(C,D)|0)==0,ee=ee?1:2;o[oe>>2]=0,Ct=Qn(C,D,ee,oe)|0,le=ee+1|0,!((Ct|0)==(z|0)&(Wt()|0)==(R|0));)if(le>>>0<7)ee=le;else{ee=0,C=0,We=6;break}return(We|0)==6?(Vn(ee|0),Vt=yt,C|0):(Ct=Li(ee|0,0,56)|0,We=we|(Wt()|0)|268435456,Ct=C|Ct,Vn(We|0),Vt=yt,Ct|0)}function Vi(C,D){C=C|0,D=D|0;var z=0;return z=!0&(D&2013265920|0)==268435456,Vn((z?D&-2130706433|134217728:0)|0),(z?C:0)|0}function Pi(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;return R=Vt,Vt=Vt+16|0,z=R,!0&(D&2013265920|0)==268435456?(ee=ki(C|0,D|0,56)|0,Wt()|0,o[z>>2]=0,z=Qn(C,D&-2130706433|134217728,ee&7,z)|0,D=Wt()|0,Vn(D|0),Vt=R,z|0):(D=0,z=0,Vn(D|0),Vt=R,z|0)}function Ft(C,D){C=C|0,D=D|0;var z=0;if(!(!0&(D&2013265920|0)==268435456))return z=0,z|0;switch(z=ki(C|0,D|0,56)|0,Wt()|0,z&7){case 0:case 7:return z=0,z|0}return z=D&-2130706433|134217728,!0&(D&117440512|0)==16777216&(ds(C,z)|0)!=0?(z=0,z|0):(z=Xr(C,z)|0,z|0)}function ni(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0;le=Vt,Vt=Vt+16|0,R=le,oe=!0&(D&2013265920|0)==268435456,ee=D&-2130706433|134217728,we=z,o[we>>2]=oe?C:0,o[we+4>>2]=oe?ee:0,oe?(D=ki(C|0,D|0,56)|0,Wt()|0,o[R>>2]=0,C=Qn(C,ee,D&7,R)|0,D=Wt()|0):(C=0,D=0),we=z+8|0,o[we>>2]=C,o[we+4>>2]=D,Vt=le}function xi(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;ee=(ds(C,D)|0)==0,D=D&-2130706433,R=z,o[R>>2]=ee?C:0,o[R+4>>2]=ee?D|285212672:0,R=z+8|0,o[R>>2]=C,o[R+4>>2]=D|301989888,R=z+16|0,o[R>>2]=C,o[R+4>>2]=D|318767104,R=z+24|0,o[R>>2]=C,o[R+4>>2]=D|335544320,R=z+32|0,o[R>>2]=C,o[R+4>>2]=D|352321536,z=z+40|0,o[z>>2]=C,o[z+4>>2]=D|369098752}function Fi(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0;if(oe=Vt,Vt=Vt+16|0,le=oe,R=ki(C|0,D|0,56)|0,Wt()|0,we=!0&(D&2013265920|0)==268435456,ee=we?C:0,C=we?D&-2130706433|134217728:0,D=Xl(ee,C,R&7)|0,(D|0)==-1){o[z>>2]=0,Vt=oe;return}ea(ee,C,le),R=ki(ee|0,C|0,52)|0,Wt()|0,R=R&15,ds(ee,C)|0?Oo(le,R,D,2,z):$o(le,R,D,2,z),Vt=oe}function Ln(C){C=C|0;var D=0,z=0,R=0;return D=tl(1,12)|0,D||Yi(22691,22646,49,22704),z=C+4|0,R=o[z>>2]|0,R|0?(R=R+8|0,o[R>>2]=D,o[z>>2]=D,D|0):(o[C>>2]|0&&Yi(22721,22646,61,22744),R=C,o[R>>2]=D,o[z>>2]=D,D|0)}function jn(C,D){C=C|0,D=D|0;var z=0,R=0;return R=Zn(24)|0,R||Yi(22758,22646,78,22772),o[R>>2]=o[D>>2],o[R+4>>2]=o[D+4>>2],o[R+8>>2]=o[D+8>>2],o[R+12>>2]=o[D+12>>2],o[R+16>>2]=0,D=C+4|0,z=o[D>>2]|0,z|0?(o[z+16>>2]=R,o[D>>2]=R,R|0):(o[C>>2]|0&&Yi(22787,22646,82,22772),o[C>>2]=R,o[D>>2]=R,R|0)}function or(C){C=C|0;var D=0,z=0,R=0,ee=0;if(C)for(R=1;;){if(D=o[C>>2]|0,D|0)do{if(z=o[D>>2]|0,z|0)do ee=z,z=o[z+16>>2]|0,Jn(ee);while(z|0);ee=D,D=o[D+8>>2]|0,Jn(ee)}while(D|0);if(D=C,C=o[C+8>>2]|0,R||Jn(D),C)R=0;else break}}function Xn(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0,ue=0,Se=0;if(ee=C+8|0,o[ee>>2]|0)return Se=1,Se|0;if(R=o[C>>2]|0,!R)return Se=0,Se|0;D=R,z=0;do z=z+1|0,D=o[D+8>>2]|0;while(D|0);if(z>>>0<2)return Se=0,Se|0;X=Zn(z<<2)|0,X||Yi(22807,22646,317,22826),j=Zn(z<<5)|0,j||Yi(22848,22646,321,22826),o[C>>2]=0,r=C+4|0,o[r>>2]=0,o[ee>>2]=0,z=0,B=0,i=0,ri=0;e:for(;;){if(Ct=o[R>>2]|0,Ct){le=0,oe=Ct;do{if(We=+ke[oe+8>>3],D=oe,oe=o[oe+16>>2]|0,yt=(oe|0)==0,ee=yt?Ct:oe,we=+ke[ee+8>>3],+Ai(+(We-we))>3.141592653589793){Se=14;break}le=le+(we-We)*(+ke[D>>3]+ +ke[ee>>3])}while(!yt);if((Se|0)==14){Se=0,le=0,D=Ct;do s=+ke[D+8>>3],T=D+16|0,w=o[T>>2]|0,w=w|0?w:Ct,y=+ke[w+8>>3],le=le+(+ke[D>>3]+ +ke[w>>3])*((y<0?y+6.283185307179586:y)-(s<0?s+6.283185307179586:s)),D=o[(D|0?T:R)>>2]|0;while(D|0)}le>0?(o[X+(B<<2)>>2]=R,B=B+1|0,ee=i,D=ri):Se=19}else Se=19;if((Se|0)==19){Se=0;do if(z){if(D=z+8|0,o[D>>2]|0){Se=21;break e}if(z=tl(1,12)|0,!z){Se=23;break e}o[D>>2]=z,ee=z+4|0,oe=z,D=ri}else if(ri){ee=r,oe=ri+8|0,D=R,z=C;break}else if(o[C>>2]|0){Se=27;break e}else{ee=r,oe=C,D=R,z=C;break}while(!1);if(o[oe>>2]=R,o[ee>>2]=R,oe=j+(i<<5)|0,yt=o[R>>2]|0,yt){for(Ct=j+(i<<5)+8|0,ke[Ct>>3]=17976931348623157e292,ri=j+(i<<5)+24|0,ke[ri>>3]=17976931348623157e292,ke[oe>>3]=-17976931348623157e292,Gt=j+(i<<5)+16|0,ke[Gt>>3]=-17976931348623157e292,F=17976931348623157e292,O=-17976931348623157e292,ee=0,Zt=yt,We=17976931348623157e292,A=17976931348623157e292,E=-17976931348623157e292,we=-17976931348623157e292;le=+ke[Zt>>3],s=+ke[Zt+8>>3],Zt=o[Zt+16>>2]|0,Z=(Zt|0)==0,y=+ke[(Z?yt:Zt)+8>>3],le<We&&(ke[Ct>>3]=le,We=le),s<A&&(ke[ri>>3]=s,A=s),le>E?ke[oe>>3]=le:le=E,s>we&&(ke[Gt>>3]=s,we=s),F=s>0&s<F?s:F,O=s<0&s>O?s:O,ee=ee|+Ai(+(s-y))>3.141592653589793,!Z;)E=le;ee&&(ke[Gt>>3]=O,ke[ri>>3]=F)}else o[oe>>2]=0,o[oe+4>>2]=0,o[oe+8>>2]=0,o[oe+12>>2]=0,o[oe+16>>2]=0,o[oe+20>>2]=0,o[oe+24>>2]=0,o[oe+28>>2]=0;ee=i+1|0}if(T=R+8|0,R=o[T>>2]|0,o[T>>2]=0,R)i=ee,ri=D;else{Se=45;break}}if((Se|0)==21)Yi(22624,22646,35,22658);else if((Se|0)==23)Yi(22678,22646,37,22658);else if((Se|0)==27)Yi(22721,22646,61,22744);else if((Se|0)==45){e:do if((B|0)>0){for(T=(ee|0)==0,_=ee<<2,w=(C|0)==0,d=0,D=0;;){if(l=o[X+(d<<2)>>2]|0,T)Se=73;else{if(i=Zn(_)|0,!i){Se=50;break}if(r=Zn(_)|0,!r){Se=52;break}t:do if(w)z=0;else{for(ee=0,z=0,oe=C;R=j+(ee<<5)|0,Hs(o[oe>>2]|0,R,o[l>>2]|0)|0?(o[i+(z<<2)>>2]=oe,o[r+(z<<2)>>2]=R,Z=z+1|0):Z=z,oe=o[oe+8>>2]|0,oe;)ee=ee+1|0,z=Z;if((Z|0)>0)if(R=o[i>>2]|0,(Z|0)==1)z=R;else for(Gt=0,Zt=-1,z=R,ri=R;;){for(yt=o[ri>>2]|0,R=0,oe=0;ee=o[o[i+(oe<<2)>>2]>>2]|0,(ee|0)==(yt|0)?Ct=R:Ct=R+((Hs(ee,o[r+(oe<<2)>>2]|0,o[yt>>2]|0)|0)&1)|0,oe=oe+1|0,(oe|0)!=(Z|0);)R=Ct;if(ee=(Ct|0)>(Zt|0),z=ee?ri:z,R=Gt+1|0,(R|0)==(Z|0))break t;Gt=R,Zt=ee?Ct:Zt,ri=o[i+(R<<2)>>2]|0}else z=0}while(!1);if(Jn(i),Jn(r),z){if(ee=z+4|0,R=o[ee>>2]|0,R)z=R+8|0;else if(o[z>>2]|0){Se=70;break}o[z>>2]=l,o[ee>>2]=l}else Se=73}if((Se|0)==73){if(Se=0,D=o[l>>2]|0,D|0)do r=D,D=o[D+16>>2]|0,Jn(r);while(D|0);Jn(l),D=2}if(d=d+1|0,(d|0)>=(B|0)){ue=D;break e}}(Se|0)==50?Yi(22863,22646,249,22882):(Se|0)==52?Yi(22901,22646,252,22882):(Se|0)==70&&Yi(22721,22646,61,22744)}else ue=0;while(!1);return Jn(X),Jn(j),Se=ue,Se|0}return 0}function Hs(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0,Ct=0;if(!(ja(D,z)|0)||(D=Or(D)|0,yt=+ke[z>>3],R=+ke[z+8>>3],R=D&R<0?R+6.283185307179586:R,C=o[C>>2]|0,!C))return C=0,C|0;if(D){D=0,z=C;e:for(;;){for(;oe=+ke[z>>3],We=+ke[z+8>>3],z=z+16|0,Ct=o[z>>2]|0,Ct=Ct|0?Ct:C,le=+ke[Ct>>3],ee=+ke[Ct+8>>3],oe>le?(we=oe,oe=We):(we=le,le=oe,oe=ee,ee=We),!!(yt<le|yt>we);)if(z=o[z>>2]|0,!z){z=22;break e}if(We=ee<0?ee+6.283185307179586:ee,oe=oe<0?oe+6.283185307179586:oe,R=oe==R|We==R?R+-2220446049250313e-31:R,We=We+(yt-le)/(we-le)*(oe-We),(We<0?We+6.283185307179586:We)>R&&(D=D^1),z=o[z>>2]|0,!z){z=22;break}}if((z|0)==22)return D|0}else{D=0,z=C;e:for(;;){for(;oe=+ke[z>>3],We=+ke[z+8>>3],z=z+16|0,Ct=o[z>>2]|0,Ct=Ct|0?Ct:C,le=+ke[Ct>>3],ee=+ke[Ct+8>>3],oe>le?(we=oe,oe=We):(we=le,le=oe,oe=ee,ee=We),!!(yt<le|yt>we);)if(z=o[z>>2]|0,!z){z=22;break e}if(R=oe==R|ee==R?R+-2220446049250313e-31:R,ee+(yt-le)/(we-le)*(oe-ee)>R&&(D=D^1),z=o[z>>2]|0,!z){z=22;break}}if((z|0)==22)return D|0}return 0}function Ps(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0;if(O=Vt,Vt=Vt+32|0,F=O+16|0,E=O,le=ki(C|0,D|0,52)|0,Wt()|0,le=le&15,Zt=ki(z|0,R|0,52)|0,Wt()|0,(le|0)!=(Zt&15|0))return F=1,Vt=O,F|0;if(yt=ki(C|0,D|0,45)|0,Wt()|0,yt=yt&127,Ct=ki(z|0,R|0,45)|0,Wt()|0,Ct=Ct&127,Zt=(yt|0)!=(Ct|0),Zt){if(we=dn(yt,Ct)|0,(we|0)==7)return F=2,Vt=O,F|0;We=dn(Ct,yt)|0,(We|0)==7?Yi(22925,22949,151,22959):(Z=we,oe=We)}else Z=0,oe=0;ri=N(yt)|0,Gt=N(Ct)|0,o[F>>2]=0,o[F+4>>2]=0,o[F+8>>2]=0,o[F+12>>2]=0;do if(Z){if(Ct=o[4304+(yt*28|0)+(Z<<2)>>2]|0,we=(Ct|0)>0,Gt)if(we){yt=0,We=z,we=R;do We=Jo(We,we)|0,we=Wt()|0,oe=Ys(oe)|0,(oe|0)==1&&(oe=Ys(1)|0),yt=yt+1|0;while((yt|0)!=(Ct|0));Ct=oe,yt=We,We=we}else Ct=oe,yt=z,We=R;else if(we){yt=0,We=z,we=R;do We=Yr(We,we)|0,we=Wt()|0,oe=Ys(oe)|0,yt=yt+1|0;while((yt|0)!=(Ct|0));Ct=oe,yt=We,We=we}else Ct=oe,yt=z,We=R;if(_o(yt,We,F)|0,Zt||Yi(22972,22949,181,22959),we=(ri|0)!=0,oe=(Gt|0)!=0,we&oe&&Yi(22999,22949,182,22959),we){if(oe=Js(C,D)|0,kt[22032+(oe*7|0)+Z>>0]|0){le=3;break}We=o[21200+(oe*28|0)+(Z<<2)>>2]|0,yt=We,A=26}else if(oe){if(oe=Js(yt,We)|0,kt[22032+(oe*7|0)+Ct>>0]|0){le=4;break}yt=0,We=o[21200+(Ct*28|0)+(oe<<2)>>2]|0,A=26}else oe=0;if((A|0)==26)if((We|0)<=-1&&Yi(23030,22949,212,22959),(yt|0)<=-1&&Yi(23053,22949,213,22959),(We|0)>0){we=F+4|0,oe=0;do Qo(we),oe=oe+1|0;while((oe|0)!=(We|0));oe=yt}else oe=yt;if(o[E>>2]=0,o[E+4>>2]=0,o[E+8>>2]=0,Il(E,Z),le|0)for(;Nr(le)|0?Zo(E):Bs(E),(le|0)>1;)le=le+-1|0;if((oe|0)>0){le=0;do Qo(E),le=le+1|0;while((le|0)!=(oe|0))}A=F+4|0,Lr(A,E,A),ir(A),A=50}else if(_o(z,R,F)|0,(ri|0)!=0&(Gt|0)!=0)if((Ct|0)!=(yt|0)&&Yi(23077,22949,243,22959),oe=Js(C,D)|0,le=Js(z,R)|0,kt[22032+(oe*7|0)+le>>0]|0)le=5;else if(oe=o[21200+(oe*28|0)+(le<<2)>>2]|0,(oe|0)>0){we=F+4|0,le=0;do Qo(we),le=le+1|0;while((le|0)!=(oe|0));A=50}else A=50;else A=50;while(!1);return(A|0)==50&&(le=F+4|0,o[ee>>2]=o[le>>2],o[ee+4>>2]=o[le+4>>2],o[ee+8>>2]=o[le+8>>2],le=0),F=le,Vt=O,F|0}function ps(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0;if(Z=Vt,Vt=Vt+48|0,oe=Z+36|0,we=Z+24|0,We=Z+12|0,yt=Z,le=ki(C|0,D|0,52)|0,Wt()|0,le=le&15,Gt=ki(C|0,D|0,45)|0,Wt()|0,Gt=Gt&127,Ct=N(Gt)|0,Li(le|0,0,52)|0,E=Wt()|0|134225919,A=R,o[A>>2]=-1,o[A+4>>2]=E,!le)return(o[z>>2]|0)>1||(o[z+4>>2]|0)>1||(o[z+8>>2]|0)>1||(ee=hn(Gt,Ks(z)|0)|0,(ee|0)==127)?(E=1,Vt=Z,E|0):(Zt=Li(ee|0,0,45)|0,A=Wt()|0,Gt=R,A=o[Gt+4>>2]&-1040385|A,E=R,o[E>>2]=o[Gt>>2]|Zt,o[E+4>>2]=A,E=0,Vt=Z,E|0);for(o[oe>>2]=o[z>>2],o[oe+4>>2]=o[z+4>>2],o[oe+8>>2]=o[z+8>>2];o[we>>2]=o[oe>>2],o[we+4>>2]=o[oe+4>>2],o[we+8>>2]=o[oe+8>>2],Nr(le)|0?(Br(oe),o[We>>2]=o[oe>>2],o[We+4>>2]=o[oe+4>>2],o[We+8>>2]=o[oe+8>>2],Zo(We)):(To(oe),o[We>>2]=o[oe>>2],o[We+4>>2]=o[oe+4>>2],o[We+8>>2]=o[oe+8>>2],Bs(We)),Zs(we,We,yt),ir(yt),A=R,F=o[A>>2]|0,A=o[A+4>>2]|0,O=(15-le|0)*3|0,z=Li(7,0,O|0)|0,A=A&~(Wt()|0),O=Li(Ks(yt)|0,0,O|0)|0,A=Wt()|0|A,E=R,o[E>>2]=O|F&~z,o[E+4>>2]=A,(le|0)>1;)le=le+-1|0;e:do if((o[oe>>2]|0)<=1&&(o[oe+4>>2]|0)<=1&&(o[oe+8>>2]|0)<=1){le=Ks(oe)|0,we=hn(Gt,le)|0,(we|0)==127?yt=0:yt=N(we)|0;t:do if(le){if(Ct){if(oe=21408+((Js(C,D)|0)*28|0)+(le<<2)|0,oe=o[oe>>2]|0,(oe|0)>0){z=0;do le=ha(le)|0,z=z+1|0;while((z|0)!=(oe|0))}if((le|0)==1){ee=3;break e}z=hn(Gt,le)|0,(z|0)==127&&Yi(23104,22949,376,23134),N(z)|0?Yi(23147,22949,377,23134):(Zt=oe,ri=le,ee=z)}else Zt=0,ri=le,ee=we;if(We=o[4304+(Gt*28|0)+(ri<<2)>>2]|0,(We|0)<=-1&&Yi(23178,22949,384,23134),!yt){if((Zt|0)<=-1&&Yi(23030,22949,417,23134),Zt|0){oe=R,le=0,z=o[oe>>2]|0,oe=o[oe+4>>2]|0;do z=Ya(z,oe)|0,oe=Wt()|0,O=R,o[O>>2]=z,o[O+4>>2]=oe,le=le+1|0;while((le|0)<(Zt|0))}if((We|0)<=0){le=54;break}for(oe=R,le=0,z=o[oe>>2]|0,oe=o[oe+4>>2]|0;;)if(z=Ya(z,oe)|0,oe=Wt()|0,O=R,o[O>>2]=z,o[O+4>>2]=oe,le=le+1|0,(le|0)==(We|0)){le=54;break t}}if(we=dn(ee,Gt)|0,(we|0)==7&&Yi(22925,22949,393,23134),le=R,z=o[le>>2]|0,le=o[le+4>>2]|0,(We|0)>0){oe=0;do z=Ya(z,le)|0,le=Wt()|0,O=R,o[O>>2]=z,o[O+4>>2]=le,oe=oe+1|0;while((oe|0)!=(We|0))}if(z=Js(z,le)|0,O=xe(ee)|0,z=o[(O?21824:21616)+(we*28|0)+(z<<2)>>2]|0,(z|0)<=-1&&Yi(23030,22949,412,23134),!z)le=54;else{we=R,le=0,oe=o[we>>2]|0,we=o[we+4>>2]|0;do oe=qs(oe,we)|0,we=Wt()|0,O=R,o[O>>2]=oe,o[O+4>>2]=we,le=le+1|0;while((le|0)<(z|0));le=54}}else if((Ct|0)!=0&(yt|0)!=0)if(O=Js(C,D)|0,le=R,le=21408+(O*28|0)+((Js(o[le>>2]|0,o[le+4>>2]|0)|0)<<2)|0,le=o[le>>2]|0,(le|0)<=-1&&Yi(23201,22949,433,23134),!le)ee=we,le=55;else{oe=R,ee=0,z=o[oe>>2]|0,oe=o[oe+4>>2]|0;do z=Ya(z,oe)|0,oe=Wt()|0,O=R,o[O>>2]=z,o[O+4>>2]=oe,ee=ee+1|0;while((ee|0)<(le|0));ee=we,le=54}else ee=we,le=54;while(!1);if((le|0)==54&&yt&&(le=55),(le|0)==55&&(O=R,(Js(o[O>>2]|0,o[O+4>>2]|0)|0)==1)){ee=4;break}O=R,E=o[O>>2]|0,O=o[O+4>>2]&-1040385,F=Li(ee|0,0,45)|0,O=O|(Wt()|0),ee=R,o[ee>>2]=E|F,o[ee+4>>2]=O,ee=0}else ee=2;while(!1);return O=ee,Vt=Z,O|0}function Ja(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0;return oe=Vt,Vt=Vt+16|0,le=oe,C=Ps(C,D,z,R,le)|0,C||(ml(le,ee),C=0),Vt=oe,C|0}function yo(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0;return ee=Vt,Vt=Vt+16|0,le=ee,Cl(z,le),R=ps(C,D,le,R)|0,Vt=ee,R|0}function os(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0;return oe=Vt,Vt=Vt+32|0,ee=oe+12|0,le=oe,!(Ps(C,D,C,D,ee)|0)&&!(Ps(C,D,z,R,le)|0)?C=Ma(ee,le)|0:C=-1,Vt=oe,C|0}function $u(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0;return oe=Vt,Vt=Vt+32|0,ee=oe+12|0,le=oe,!(Ps(C,D,C,D,ee)|0)&&!(Ps(C,D,z,R,le)|0)?C=Ma(ee,le)|0:C=-1,Vt=oe,(C>>>31^1)+C|0}function Fu(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0;if(i=Vt,Vt=Vt+48|0,le=i+24|0,oe=i+12|0,s=i,!(Ps(C,D,C,D,le)|0)&&!(Ps(C,D,z,R,oe)|0)){if(y=Ma(le,oe)|0,(y|0)<0)return s=y,Vt=i,s|0;for(o[le>>2]=0,o[le+4>>2]=0,o[le+8>>2]=0,o[oe>>2]=0,o[oe+4>>2]=0,o[oe+8>>2]=0,Ps(C,D,C,D,le)|0,Ps(C,D,z,R,oe)|0,mu(le),mu(oe),y?(Ct=o[le>>2]|0,Zt=+(y|0),E=le+4|0,ri=o[E>>2]|0,F=le+8|0,Gt=o[F>>2]|0,O=le,z=Ct,R=ri,le=Gt,Z=+((o[oe>>2]|0)-Ct|0)/Zt,A=+((o[oe+4>>2]|0)-ri|0)/Zt,Zt=+((o[oe+8>>2]|0)-Gt|0)/Zt):(R=le+4|0,Gt=le+8|0,E=R,F=Gt,O=le,z=o[le>>2]|0,R=o[R>>2]|0,le=o[Gt>>2]|0,Z=0,A=0,Zt=0),o[s>>2]=z,Gt=s+4|0,o[Gt>>2]=R,ri=s+8|0,o[ri>>2]=le,Ct=0;;){We=+(Ct|0),r=Z*We+ +(z|0),we=A*We+ +(o[E>>2]|0),We=Zt*We+ +(o[F>>2]|0),R=~~+vu(+r),oe=~~+vu(+we),z=~~+vu(+We),r=+Ai(+(+(R|0)-r)),we=+Ai(+(+(oe|0)-we)),We=+Ai(+(+(z|0)-We));do if(r>we&r>We)R=0-(oe+z)|0,le=oe;else if(yt=0-R|0,we>We){le=yt-z|0;break}else{le=oe,z=yt-oe|0;break}while(!1);if(o[s>>2]=R,o[Gt>>2]=le,o[ri>>2]=z,As(s),ps(C,D,s,ee+(Ct<<3)|0)|0,(Ct|0)==(y|0))break;Ct=Ct+1|0,z=o[O>>2]|0}return s=0,Vt=i,s|0}return s=-1,Vt=i,s|0}function vo(C,D){C=C|0,D=D|0;var z=0;if(!D)return z=1,z|0;z=C,C=1;do C=jr(D&1|0?z:1,C)|0,D=D>>1,z=jr(z,z)|0;while(D|0);return C|0}function Ml(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0;if(!(ja(D,z)|0)||(D=Or(D)|0,Gt=+ke[z>>3],R=+ke[z+8>>3],R=D&R<0?R+6.283185307179586:R,ri=o[C>>2]|0,(ri|0)<=0))return ri=0,ri|0;if(Ct=o[C+4>>2]|0,D){D=0,z=-1,C=0;e:for(;;){for(yt=C;oe=+ke[Ct+(yt<<4)>>3],We=+ke[Ct+(yt<<4)+8>>3],C=(z+2|0)%(ri|0)|0,le=+ke[Ct+(C<<4)>>3],ee=+ke[Ct+(C<<4)+8>>3],oe>le?(we=oe,oe=We):(we=le,le=oe,oe=ee,ee=We),!!(Gt<le|Gt>we);)if(z=yt+1|0,(z|0)<(ri|0))C=yt,yt=z,z=C;else{z=22;break e}if(We=ee<0?ee+6.283185307179586:ee,oe=oe<0?oe+6.283185307179586:oe,R=oe==R|We==R?R+-2220446049250313e-31:R,We=We+(Gt-le)/(we-le)*(oe-We),(We<0?We+6.283185307179586:We)>R&&(D=D^1),C=yt+1|0,(C|0)>=(ri|0)){z=22;break}else z=yt}if((z|0)==22)return D|0}else{D=0,z=-1,C=0;e:for(;;){for(yt=C;oe=+ke[Ct+(yt<<4)>>3],We=+ke[Ct+(yt<<4)+8>>3],C=(z+2|0)%(ri|0)|0,le=+ke[Ct+(C<<4)>>3],ee=+ke[Ct+(C<<4)+8>>3],oe>le?(we=oe,oe=We):(we=le,le=oe,oe=ee,ee=We),!!(Gt<le|Gt>we);)if(z=yt+1|0,(z|0)<(ri|0))C=yt,yt=z,z=C;else{z=22;break e}if(R=oe==R|ee==R?R+-2220446049250313e-31:R,ee+(Gt-le)/(we-le)*(oe-ee)>R&&(D=D^1),C=yt+1|0,(C|0)>=(ri|0)){z=22;break}else z=yt}if((z|0)==22)return D|0}return 0}function Pn(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0;if(Z=o[C>>2]|0,!Z){o[D>>2]=0,o[D+4>>2]=0,o[D+8>>2]=0,o[D+12>>2]=0,o[D+16>>2]=0,o[D+20>>2]=0,o[D+24>>2]=0,o[D+28>>2]=0;return}if(A=D+8|0,ke[A>>3]=17976931348623157e292,E=D+24|0,ke[E>>3]=17976931348623157e292,ke[D>>3]=-17976931348623157e292,F=D+16|0,ke[F>>3]=-17976931348623157e292,!((Z|0)<=0)){for(Gt=o[C+4>>2]|0,yt=17976931348623157e292,Ct=-17976931348623157e292,ri=0,C=-1,le=17976931348623157e292,oe=17976931348623157e292,We=-17976931348623157e292,R=-17976931348623157e292,Zt=0;z=+ke[Gt+(Zt<<4)>>3],we=+ke[Gt+(Zt<<4)+8>>3],C=C+2|0,ee=+ke[Gt+(((C|0)==(Z|0)?0:C)<<4)+8>>3],z<le&&(ke[A>>3]=z,le=z),we<oe&&(ke[E>>3]=we,oe=we),z>We?ke[D>>3]=z:z=We,we>R&&(ke[F>>3]=we,R=we),yt=we>0&we<yt?we:yt,Ct=we<0&we>Ct?we:Ct,ri=ri|+Ai(+(we-ee))>3.141592653589793,C=Zt+1|0,(C|0)!=(Z|0);)O=Zt,We=z,Zt=C,C=O;ri&&(ke[F>>3]=Ct,ke[E>>3]=yt)}}function Da(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0;if(Z=o[C>>2]|0,Z){if(A=D+8|0,ke[A>>3]=17976931348623157e292,E=D+24|0,ke[E>>3]=17976931348623157e292,ke[D>>3]=-17976931348623157e292,F=D+16|0,ke[F>>3]=-17976931348623157e292,(Z|0)>0){for(ee=o[C+4>>2]|0,Gt=17976931348623157e292,Zt=-17976931348623157e292,R=0,z=-1,We=17976931348623157e292,yt=17976931348623157e292,ri=-17976931348623157e292,oe=-17976931348623157e292,O=0;le=+ke[ee+(O<<4)>>3],Ct=+ke[ee+(O<<4)+8>>3],r=z+2|0,we=+ke[ee+(((r|0)==(Z|0)?0:r)<<4)+8>>3],le<We&&(ke[A>>3]=le,We=le),Ct<yt&&(ke[E>>3]=Ct,yt=Ct),le>ri?ke[D>>3]=le:le=ri,Ct>oe&&(ke[F>>3]=Ct,oe=Ct),Gt=Ct>0&Ct<Gt?Ct:Gt,Zt=Ct<0&Ct>Zt?Ct:Zt,R=R|+Ai(+(Ct-we))>3.141592653589793,z=O+1|0,(z|0)!=(Z|0);)r=O,ri=le,O=z,z=r;R&&(ke[F>>3]=Zt,ke[E>>3]=Gt)}}else o[D>>2]=0,o[D+4>>2]=0,o[D+8>>2]=0,o[D+12>>2]=0,o[D+16>>2]=0,o[D+20>>2]=0,o[D+24>>2]=0,o[D+28>>2]=0;if(r=C+8|0,z=o[r>>2]|0,!((z|0)<=0)){i=C+12|0,s=0;do if(ee=o[i>>2]|0,R=s,s=s+1|0,E=D+(s<<5)|0,F=o[ee+(R<<3)>>2]|0,F){if(O=D+(s<<5)+8|0,ke[O>>3]=17976931348623157e292,C=D+(s<<5)+24|0,ke[C>>3]=17976931348623157e292,ke[E>>3]=-17976931348623157e292,y=D+(s<<5)+16|0,ke[y>>3]=-17976931348623157e292,(F|0)>0){for(Z=o[ee+(R<<3)+4>>2]|0,Gt=17976931348623157e292,Zt=-17976931348623157e292,ee=0,R=-1,A=0,We=17976931348623157e292,yt=17976931348623157e292,Ct=-17976931348623157e292,oe=-17976931348623157e292;le=+ke[Z+(A<<4)>>3],ri=+ke[Z+(A<<4)+8>>3],R=R+2|0,we=+ke[Z+(((R|0)==(F|0)?0:R)<<4)+8>>3],le<We&&(ke[O>>3]=le,We=le),ri<yt&&(ke[C>>3]=ri,yt=ri),le>Ct?ke[E>>3]=le:le=Ct,ri>oe&&(ke[y>>3]=ri,oe=ri),Gt=ri>0&ri<Gt?ri:Gt,Zt=ri<0&ri>Zt?ri:Zt,ee=ee|+Ai(+(ri-we))>3.141592653589793,R=A+1|0,(R|0)!=(F|0);)l=A,A=R,Ct=le,R=l;ee&&(ke[y>>3]=Zt,ke[C>>3]=Gt)}}else o[E>>2]=0,o[E+4>>2]=0,o[E+8>>2]=0,o[E+12>>2]=0,o[E+16>>2]=0,o[E+20>>2]=0,o[E+24>>2]=0,o[E+28>>2]=0,z=o[r>>2]|0;while((s|0)<(z|0))}}function In(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0;if(!(Ml(C,D,z)|0))return ee=0,ee|0;if(ee=C+8|0,(o[ee>>2]|0)<=0)return ee=1,ee|0;for(R=C+12|0,C=0;;){if(le=C,C=C+1|0,Ml((o[R>>2]|0)+(le<<3)|0,D+(C<<5)|0,z)|0){C=0,R=6;break}if((C|0)>=(o[ee>>2]|0)){C=1,R=6;break}}return(R|0)==6?C|0:0}function No(){return 8}function Nl(){return 16}function En(){return 168}function $l(){return 8}function Cn(){return 16}function _l(){return 12}function uu(){return 8}function Ou(C){C=C|0;var D=0,z=0;return z=+ke[C>>3],D=+ke[C+8>>3],+ +ti(+(z*z+D*D))}function Vl(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0;yt=+ke[C>>3],We=+ke[D>>3]-yt,we=+ke[C+8>>3],oe=+ke[D+8>>3]-we,ri=+ke[z>>3],le=+ke[R>>3]-ri,Gt=+ke[z+8>>3],Ct=+ke[R+8>>3]-Gt,le=(le*(we-Gt)-(yt-ri)*Ct)/(We*Ct-oe*le),ke[ee>>3]=yt+We*le,ke[ee+8>>3]=we+oe*le}function yl(C,D){return C=C|0,D=D|0,+ke[C>>3]!=+ke[D>>3]?(D=0,D|0):(D=+ke[C+8>>3]==+ke[D+8>>3],D|0)}function ta(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;return ee=+ke[C>>3]-+ke[D>>3],R=+ke[C+8>>3]-+ke[D+8>>3],z=+ke[C+16>>3]-+ke[D+16>>3],+(ee*ee+R*R+z*z)}function oc(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;z=+ke[C>>3],R=+Bi(+z),z=+vi(+z),ke[D+16>>3]=z,z=+ke[C+8>>3],ee=R*+Bi(+z),ke[D>>3]=ee,z=R*+vi(+z),ke[D+8>>3]=z}function Xu(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0;if(yt=Vt,Vt=Vt+32|0,ee=yt+16|0,le=yt,ea(C,D,ee),oe=ll(C,D)|0,We=Js(C,D)|0,$t(oe,le),D=wi(oe,o[ee>>2]|0)|0,!(N(oe)|0))return We=D,Vt=yt,We|0;do switch(oe|0){case 4:{C=0,z=14;break}case 14:{C=1,z=14;break}case 24:{C=2,z=14;break}case 38:{C=3,z=14;break}case 49:{C=4,z=14;break}case 58:{C=5,z=14;break}case 63:{C=6,z=14;break}case 72:{C=7,z=14;break}case 83:{C=8,z=14;break}case 97:{C=9,z=14;break}case 107:{C=10,z=14;break}case 117:{C=11,z=14;break}default:we=0,R=0}while(!1);return(z|0)==14&&(we=o[22096+(C*24|0)+8>>2]|0,R=o[22096+(C*24|0)+16>>2]|0),C=o[ee>>2]|0,(C|0)!=(o[le>>2]|0)&&(oe=xe(oe)|0,C=o[ee>>2]|0,oe|(C|0)==(R|0)&&(D=(D+1|0)%6|0)),(We|0)==3&(C|0)==(R|0)?(We=(D+5|0)%6|0,Vt=yt,We|0):(We|0)==5&(C|0)==(we|0)?(We=(D+1|0)%6|0,Vt=yt,We|0):(We=D,Vt=yt,We|0)}function Xl(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;return R=ds(C,D)|0,(z+-1|0)>>>0>5||(ee=(R|0)!=0,(z|0)==1&ee)?(z=-1,z|0):(R=Xu(C,D)|0,ee?(z=(5-R+(o[22384+(z<<2)>>2]|0)|0)%5|0,z|0):(z=(6-R+(o[22416+(z<<2)>>2]|0)|0)%6|0,z|0))}function ms(C,D,z){C=C|0,D=D|0,z=z|0;var R=0;(D|0)>0?(R=tl(D,4)|0,o[C>>2]=R,R||Yi(23230,23253,40,23267)):o[C>>2]=0,o[C+4>>2]=D,o[C+8>>2]=0,o[C+12>>2]=z}function _a(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;ee=C+4|0,le=C+12|0,oe=C+8|0;e:for(;;){for(z=o[ee>>2]|0,D=0;;){if((D|0)>=(z|0))break e;if(R=o[C>>2]|0,we=o[R+(D<<2)>>2]|0,!we)D=D+1|0;else break}D=R+(~~(+Ai(+(+li(10,+ +(15-(o[le>>2]|0)|0))*(+ke[we>>3]+ +ke[we+8>>3])))%+(z|0))>>>0<<2)|0,z=o[D>>2]|0;t:do if(z|0){if(R=we+32|0,(z|0)==(we|0))o[D>>2]=o[R>>2];else{if(z=z+32|0,D=o[z>>2]|0,!D)break;for(;(D|0)!=(we|0);)if(z=D+32|0,D=o[z>>2]|0,!D)break t;o[z>>2]=o[R>>2]}Jn(we),o[oe>>2]=(o[oe>>2]|0)+-1}while(!1)}Jn(o[C>>2]|0)}function el(C){C=C|0;var D=0,z=0,R=0;for(R=o[C+4>>2]|0,z=0;;){if((z|0)>=(R|0)){D=0,z=4;break}if(D=o[(o[C>>2]|0)+(z<<2)>>2]|0,!D)z=z+1|0;else{z=4;break}}return(z|0)==4?D|0:0}function _u(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0;if(z=~~(+Ai(+(+li(10,+ +(15-(o[C+12>>2]|0)|0))*(+ke[D>>3]+ +ke[D+8>>3])))%+(o[C+4>>2]|0))>>>0,z=(o[C>>2]|0)+(z<<2)|0,R=o[z>>2]|0,!R)return le=1,le|0;le=D+32|0;do if((R|0)!=(D|0)){if(z=o[R+32>>2]|0,!z)return le=1,le|0;for(ee=z;;){if((ee|0)==(D|0)){ee=8;break}if(z=o[ee+32>>2]|0,z)R=ee,ee=z;else{z=1,ee=10;break}}if((ee|0)==8){o[R+32>>2]=o[le>>2];break}else if((ee|0)==10)return z|0}else o[z>>2]=o[le>>2];while(!1);return Jn(D),le=C+8|0,o[le>>2]=(o[le>>2]|0)+-1,le=0,le|0}function Nu(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0;le=Zn(40)|0,le||Yi(23283,23253,98,23296),o[le>>2]=o[D>>2],o[le+4>>2]=o[D+4>>2],o[le+8>>2]=o[D+8>>2],o[le+12>>2]=o[D+12>>2],ee=le+16|0,o[ee>>2]=o[z>>2],o[ee+4>>2]=o[z+4>>2],o[ee+8>>2]=o[z+8>>2],o[ee+12>>2]=o[z+12>>2],o[le+32>>2]=0,ee=~~(+Ai(+(+li(10,+ +(15-(o[C+12>>2]|0)|0))*(+ke[D>>3]+ +ke[D+8>>3])))%+(o[C+4>>2]|0))>>>0,ee=(o[C>>2]|0)+(ee<<2)|0,R=o[ee>>2]|0;do if(!R)o[ee>>2]=le;else{for(;!(Sa(R,D)|0&&Sa(R+16|0,z)|0);)if(ee=o[R+32>>2]|0,R=ee|0?ee:R,!(o[R+32>>2]|0)){oe=10;break}if((oe|0)==10){o[R+32>>2]=le;break}return Jn(le),oe=R,oe|0}while(!1);return oe=C+8|0,o[oe>>2]=(o[oe>>2]|0)+1,oe=le,oe|0}function cu(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;if(ee=~~(+Ai(+(+li(10,+ +(15-(o[C+12>>2]|0)|0))*(+ke[D>>3]+ +ke[D+8>>3])))%+(o[C+4>>2]|0))>>>0,ee=o[(o[C>>2]|0)+(ee<<2)>>2]|0,!ee)return z=0,z|0;if(!z){for(C=ee;;){if(Sa(C,D)|0){R=10;break}if(C=o[C+32>>2]|0,!C){C=0,R=10;break}}if((R|0)==10)return C|0}for(C=ee;;){if(Sa(C,D)|0&&Sa(C+16|0,z)|0){R=10;break}if(C=o[C+32>>2]|0,!C){C=0,R=10;break}}return(R|0)==10?C|0:0}function Vu(C,D){C=C|0,D=D|0;var z=0;if(z=~~(+Ai(+(+li(10,+ +(15-(o[C+12>>2]|0)|0))*(+ke[D>>3]+ +ke[D+8>>3])))%+(o[C+4>>2]|0))>>>0,C=o[(o[C>>2]|0)+(z<<2)>>2]|0,!C)return z=0,z|0;for(;;){if(Sa(C,D)|0){D=5;break}if(C=o[C+32>>2]|0,!C){C=0,D=5;break}}return(D|0)==5?C|0:0}function yr(){return 23312}function gs(C){return C=+C,+ +hl(+C)}function gn(C){return C=+C,~~+gs(C)|0}function Zn(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0;i=Vt,Vt=Vt+16|0,Gt=i;do if(C>>>0<245){if(yt=C>>>0<11?16:C+11&-8,C=yt>>>3,ri=o[5829]|0,z=ri>>>C,z&3|0)return D=(z&1^1)+C|0,C=23356+(D<<1<<2)|0,z=C+8|0,R=o[z>>2]|0,ee=R+8|0,le=o[ee>>2]|0,(le|0)==(C|0)?o[5829]=ri&~(1<<D):(o[le+12>>2]=C,o[z>>2]=le),s=D<<3,o[R+4>>2]=s|3,s=R+s+4|0,o[s>>2]=o[s>>2]|1,s=ee,Vt=i,s|0;if(Ct=o[5831]|0,yt>>>0>Ct>>>0){if(z|0)return D=2<<C,D=z<<C&(D|0-D),D=(D&0-D)+-1|0,we=D>>>12&16,D=D>>>we,z=D>>>5&8,D=D>>>z,le=D>>>2&4,D=D>>>le,C=D>>>1&2,D=D>>>C,R=D>>>1&1,R=(z|we|le|C|R)+(D>>>R)|0,D=23356+(R<<1<<2)|0,C=D+8|0,le=o[C>>2]|0,we=le+8|0,z=o[we>>2]|0,(z|0)==(D|0)?(C=ri&~(1<<R),o[5829]=C):(o[z+12>>2]=D,o[C>>2]=z,C=ri),s=R<<3,oe=s-yt|0,o[le+4>>2]=yt|3,ee=le+yt|0,o[ee+4>>2]=oe|1,o[le+s>>2]=oe,Ct|0&&(R=o[5834]|0,D=Ct>>>3,z=23356+(D<<1<<2)|0,D=1<<D,C&D?(C=z+8|0,D=o[C>>2]|0):(o[5829]=C|D,D=z,C=z+8|0),o[C>>2]=R,o[D+12>>2]=R,o[R+8>>2]=D,o[R+12>>2]=z),o[5831]=oe,o[5834]=ee,s=we,Vt=i,s|0;if(le=o[5830]|0,le){for(z=(le&0-le)+-1|0,ee=z>>>12&16,z=z>>>ee,R=z>>>5&8,z=z>>>R,oe=z>>>2&4,z=z>>>oe,we=z>>>1&2,z=z>>>we,We=z>>>1&1,We=o[23620+((R|ee|oe|we|We)+(z>>>We)<<2)>>2]|0,z=We,we=We,We=(o[We+4>>2]&-8)-yt|0;C=o[z+16>>2]|0,!(!C&&(C=o[z+20>>2]|0,!C));)oe=(o[C+4>>2]&-8)-yt|0,ee=oe>>>0<We>>>0,z=C,we=ee?C:we,We=ee?oe:We;if(oe=we+yt|0,oe>>>0>we>>>0){ee=o[we+24>>2]|0,D=o[we+12>>2]|0;do if((D|0)==(we|0)){if(C=we+20|0,D=o[C>>2]|0,!D&&(C=we+16|0,D=o[C>>2]|0,!D)){z=0;break}for(;;)if(R=D+20|0,z=o[R>>2]|0,z)D=z,C=R;else if(R=D+16|0,z=o[R>>2]|0,z)D=z,C=R;else break;o[C>>2]=0,z=D}else z=o[we+8>>2]|0,o[z+12>>2]=D,o[D+8>>2]=z,z=D;while(!1);do if(ee|0){if(D=o[we+28>>2]|0,C=23620+(D<<2)|0,(we|0)==(o[C>>2]|0)){if(o[C>>2]=z,!z){o[5830]=le&~(1<<D);break}}else if(s=ee+16|0,o[((o[s>>2]|0)==(we|0)?s:ee+20|0)>>2]=z,!z)break;o[z+24>>2]=ee,D=o[we+16>>2]|0,D|0&&(o[z+16>>2]=D,o[D+24>>2]=z),D=o[we+20>>2]|0,D|0&&(o[z+20>>2]=D,o[D+24>>2]=z)}while(!1);return We>>>0<16?(s=We+yt|0,o[we+4>>2]=s|3,s=we+s+4|0,o[s>>2]=o[s>>2]|1):(o[we+4>>2]=yt|3,o[oe+4>>2]=We|1,o[oe+We>>2]=We,Ct|0&&(R=o[5834]|0,D=Ct>>>3,z=23356+(D<<1<<2)|0,D=1<<D,D&ri?(C=z+8|0,D=o[C>>2]|0):(o[5829]=D|ri,D=z,C=z+8|0),o[C>>2]=R,o[D+12>>2]=R,o[R+8>>2]=D,o[R+12>>2]=z),o[5831]=We,o[5834]=oe),s=we+8|0,Vt=i,s|0}else ri=yt}else ri=yt}else ri=yt}else if(C>>>0<=4294967231)if(C=C+11|0,yt=C&-8,R=o[5830]|0,R){ee=0-yt|0,C=C>>>8,C?yt>>>0>16777215?We=31:(ri=(C+1048320|0)>>>16&8,A=C<<ri,we=(A+520192|0)>>>16&4,A=A<<we,We=(A+245760|0)>>>16&2,We=14-(we|ri|We)+(A<<We>>>15)|0,We=yt>>>(We+7|0)&1|We<<1):We=0,z=o[23620+(We<<2)>>2]|0;e:do if(!z)z=0,C=0,A=61;else for(C=0,we=yt<<((We|0)==31?0:25-(We>>>1)|0),le=0;;){if(oe=(o[z+4>>2]&-8)-yt|0,oe>>>0<ee>>>0)if(oe)C=z,ee=oe;else{C=z,ee=0,A=65;break e}if(A=o[z+20>>2]|0,z=o[z+16+(we>>>31<<2)>>2]|0,le=(A|0)==0|(A|0)==(z|0)?le:A,z)we=we<<1;else{z=le,A=61;break}}while(!1);if((A|0)==61){if((z|0)==0&(C|0)==0){if(C=2<<We,C=(C|0-C)&R,!C){ri=yt;break}ri=(C&0-C)+-1|0,oe=ri>>>12&16,ri=ri>>>oe,le=ri>>>5&8,ri=ri>>>le,we=ri>>>2&4,ri=ri>>>we,We=ri>>>1&2,ri=ri>>>We,z=ri>>>1&1,C=0,z=o[23620+((le|oe|we|We|z)+(ri>>>z)<<2)>>2]|0}z?A=65:(we=C,oe=ee)}if((A|0)==65)for(le=z;;)if(ri=(o[le+4>>2]&-8)-yt|0,z=ri>>>0<ee>>>0,ee=z?ri:ee,C=z?le:C,z=o[le+16>>2]|0,z||(z=o[le+20>>2]|0),z)le=z;else{we=C,oe=ee;break}if(we|0&&oe>>>0<((o[5831]|0)-yt|0)>>>0&&(Ct=we+yt|0,Ct>>>0>we>>>0)){le=o[we+24>>2]|0,D=o[we+12>>2]|0;do if((D|0)==(we|0)){if(C=we+20|0,D=o[C>>2]|0,!D&&(C=we+16|0,D=o[C>>2]|0,!D)){D=0;break}for(;;)if(ee=D+20|0,z=o[ee>>2]|0,z)D=z,C=ee;else if(ee=D+16|0,z=o[ee>>2]|0,z)D=z,C=ee;else break;o[C>>2]=0}else s=o[we+8>>2]|0,o[s+12>>2]=D,o[D+8>>2]=s;while(!1);do if(le){if(C=o[we+28>>2]|0,z=23620+(C<<2)|0,(we|0)==(o[z>>2]|0)){if(o[z>>2]=D,!D){R=R&~(1<<C),o[5830]=R;break}}else if(s=le+16|0,o[((o[s>>2]|0)==(we|0)?s:le+20|0)>>2]=D,!D)break;o[D+24>>2]=le,C=o[we+16>>2]|0,C|0&&(o[D+16>>2]=C,o[C+24>>2]=D),C=o[we+20>>2]|0,C&&(o[D+20>>2]=C,o[C+24>>2]=D)}while(!1);e:do if(oe>>>0<16)s=oe+yt|0,o[we+4>>2]=s|3,s=we+s+4|0,o[s>>2]=o[s>>2]|1;else{if(o[we+4>>2]=yt|3,o[Ct+4>>2]=oe|1,o[Ct+oe>>2]=oe,D=oe>>>3,oe>>>0<256){z=23356+(D<<1<<2)|0,C=o[5829]|0,D=1<<D,C&D?(C=z+8|0,D=o[C>>2]|0):(o[5829]=C|D,D=z,C=z+8|0),o[C>>2]=Ct,o[D+12>>2]=Ct,o[Ct+8>>2]=D,o[Ct+12>>2]=z;break}if(D=oe>>>8,D?oe>>>0>16777215?z=31:(y=(D+1048320|0)>>>16&8,s=D<<y,O=(s+520192|0)>>>16&4,s=s<<O,z=(s+245760|0)>>>16&2,z=14-(O|y|z)+(s<<z>>>15)|0,z=oe>>>(z+7|0)&1|z<<1):z=0,D=23620+(z<<2)|0,o[Ct+28>>2]=z,C=Ct+16|0,o[C+4>>2]=0,o[C>>2]=0,C=1<<z,!(R&C)){o[5830]=R|C,o[D>>2]=Ct,o[Ct+24>>2]=D,o[Ct+12>>2]=Ct,o[Ct+8>>2]=Ct;break}D=o[D>>2]|0;t:do if((o[D+4>>2]&-8|0)!=(oe|0)){for(R=oe<<((z|0)==31?0:25-(z>>>1)|0);z=D+16+(R>>>31<<2)|0,C=o[z>>2]|0,!!C;)if((o[C+4>>2]&-8|0)==(oe|0)){D=C;break t}else R=R<<1,D=C;o[z>>2]=Ct,o[Ct+24>>2]=D,o[Ct+12>>2]=Ct,o[Ct+8>>2]=Ct;break e}while(!1);y=D+8|0,s=o[y>>2]|0,o[s+12>>2]=Ct,o[y>>2]=Ct,o[Ct+8>>2]=s,o[Ct+12>>2]=D,o[Ct+24>>2]=0}while(!1);return s=we+8|0,Vt=i,s|0}else ri=yt}else ri=yt;else ri=-1;while(!1);if(z=o[5831]|0,z>>>0>=ri>>>0)return D=z-ri|0,C=o[5834]|0,D>>>0>15?(s=C+ri|0,o[5834]=s,o[5831]=D,o[s+4>>2]=D|1,o[C+z>>2]=D,o[C+4>>2]=ri|3):(o[5831]=0,o[5834]=0,o[C+4>>2]=z|3,s=C+z+4|0,o[s>>2]=o[s>>2]|1),s=C+8|0,Vt=i,s|0;if(oe=o[5832]|0,oe>>>0>ri>>>0)return O=oe-ri|0,o[5832]=O,s=o[5835]|0,y=s+ri|0,o[5835]=y,o[y+4>>2]=O|1,o[s+4>>2]=ri|3,s=s+8|0,Vt=i,s|0;if(o[5947]|0?C=o[5949]|0:(o[5949]=4096,o[5948]=4096,o[5950]=-1,o[5951]=-1,o[5952]=0,o[5940]=0,o[5947]=Gt&-16^1431655768,C=4096),we=ri+48|0,We=ri+47|0,le=C+We|0,ee=0-C|0,yt=le&ee,yt>>>0<=ri>>>0||(C=o[5939]|0,C|0&&(Ct=o[5937]|0,Gt=Ct+yt|0,Gt>>>0<=Ct>>>0|Gt>>>0>C>>>0)))return s=0,Vt=i,s|0;e:do if(o[5940]&4)D=0,A=143;else{z=o[5835]|0;t:do if(z){for(R=23764;Gt=o[R>>2]|0,!(Gt>>>0<=z>>>0&&(Gt+(o[R+4>>2]|0)|0)>>>0>z>>>0);)if(C=o[R+8>>2]|0,C)R=C;else{A=128;break t}if(D=le-oe&ee,D>>>0<2147483647)if(C=Ds(D|0)|0,(C|0)==((o[R>>2]|0)+(o[R+4>>2]|0)|0)){if((C|0)!=-1){oe=D,le=C,A=145;break e}}else R=C,A=136;else D=0}else A=128;while(!1);do if((A|0)==128)if(z=Ds(0)|0,(z|0)!=-1&&(D=z,Zt=o[5948]|0,Z=Zt+-1|0,D=(Z&D|0?(Z+D&0-Zt)-D|0:0)+yt|0,Zt=o[5937]|0,Z=D+Zt|0,D>>>0>ri>>>0&D>>>0<2147483647)){if(Gt=o[5939]|0,Gt|0&&Z>>>0<=Zt>>>0|Z>>>0>Gt>>>0){D=0;break}if(C=Ds(D|0)|0,(C|0)==(z|0)){oe=D,le=z,A=145;break e}else R=C,A=136}else D=0;while(!1);do if((A|0)==136){if(z=0-D|0,!(we>>>0>D>>>0&(D>>>0<2147483647&(R|0)!=-1)))if((R|0)==-1){D=0;break}else{oe=D,le=R,A=145;break e}if(C=o[5949]|0,C=We-D+C&0-C,C>>>0>=2147483647){oe=D,le=R,A=145;break e}if((Ds(C|0)|0)==-1){Ds(z|0)|0,D=0;break}else{oe=C+D|0,le=R,A=145;break e}}while(!1);o[5940]=o[5940]|4,A=143}while(!1);if((A|0)==143&&yt>>>0<2147483647&&(O=Ds(yt|0)|0,Z=Ds(0)|0,E=Z-O|0,F=E>>>0>(ri+40|0)>>>0,!((O|0)==-1|F^1|O>>>0<Z>>>0&((O|0)!=-1&(Z|0)!=-1)^1))&&(oe=F?E:D,le=O,A=145),(A|0)==145){D=(o[5937]|0)+oe|0,o[5937]=D,D>>>0>(o[5938]|0)>>>0&&(o[5938]=D),We=o[5835]|0;e:do if(We){for(D=23764;;){if(C=o[D>>2]|0,z=o[D+4>>2]|0,(le|0)==(C+z|0)){A=154;break}if(R=o[D+8>>2]|0,R)D=R;else break}if((A|0)==154&&(y=D+4|0,(o[D+12>>2]&8|0)==0)&&le>>>0>We>>>0&C>>>0<=We>>>0){o[y>>2]=z+oe,s=(o[5832]|0)+oe|0,O=We+8|0,O=O&7|0?0-O&7:0,y=We+O|0,O=s-O|0,o[5835]=y,o[5832]=O,o[y+4>>2]=O|1,o[We+s+4>>2]=40,o[5836]=o[5951];break}for(le>>>0<(o[5833]|0)>>>0&&(o[5833]=le),z=le+oe|0,D=23764;;){if((o[D>>2]|0)==(z|0)){A=162;break}if(C=o[D+8>>2]|0,C)D=C;else break}if((A|0)==162&&!(o[D+12>>2]&8|0)){o[D>>2]=le,Ct=D+4|0,o[Ct>>2]=(o[Ct>>2]|0)+oe,Ct=le+8|0,Ct=le+(Ct&7|0?0-Ct&7:0)|0,D=z+8|0,D=z+(D&7|0?0-D&7:0)|0,yt=Ct+ri|0,we=D-Ct-ri|0,o[Ct+4>>2]=ri|3;t:do if((We|0)==(D|0))s=(o[5832]|0)+we|0,o[5832]=s,o[5835]=yt,o[yt+4>>2]=s|1;else{if((o[5834]|0)==(D|0)){s=(o[5831]|0)+we|0,o[5831]=s,o[5834]=yt,o[yt+4>>2]=s|1,o[yt+s>>2]=s;break}if(C=o[D+4>>2]|0,(C&3|0)==1){oe=C&-8,R=C>>>3;i:do if(C>>>0<256)if(C=o[D+8>>2]|0,z=o[D+12>>2]|0,(z|0)==(C|0)){o[5829]=o[5829]&~(1<<R);break}else{o[C+12>>2]=z,o[z+8>>2]=C;break}else{le=o[D+24>>2]|0,C=o[D+12>>2]|0;do if((C|0)==(D|0)){if(z=D+16|0,R=z+4|0,C=o[R>>2]|0,C)z=R;else if(C=o[z>>2]|0,!C){C=0;break}for(;;)if(ee=C+20|0,R=o[ee>>2]|0,R)C=R,z=ee;else if(ee=C+16|0,R=o[ee>>2]|0,R)C=R,z=ee;else break;o[z>>2]=0}else s=o[D+8>>2]|0,o[s+12>>2]=C,o[C+8>>2]=s;while(!1);if(!le)break;z=o[D+28>>2]|0,R=23620+(z<<2)|0;do if((o[R>>2]|0)!=(D|0)){if(s=le+16|0,o[((o[s>>2]|0)==(D|0)?s:le+20|0)>>2]=C,!C)break i}else{if(o[R>>2]=C,C|0)break;o[5830]=o[5830]&~(1<<z);break i}while(!1);if(o[C+24>>2]=le,z=D+16|0,R=o[z>>2]|0,R|0&&(o[C+16>>2]=R,o[R+24>>2]=C),z=o[z+4>>2]|0,!z)break;o[C+20>>2]=z,o[z+24>>2]=C}while(!1);D=D+oe|0,ee=oe+we|0}else ee=we;if(D=D+4|0,o[D>>2]=o[D>>2]&-2,o[yt+4>>2]=ee|1,o[yt+ee>>2]=ee,D=ee>>>3,ee>>>0<256){z=23356+(D<<1<<2)|0,C=o[5829]|0,D=1<<D,C&D?(C=z+8|0,D=o[C>>2]|0):(o[5829]=C|D,D=z,C=z+8|0),o[C>>2]=yt,o[D+12>>2]=yt,o[yt+8>>2]=D,o[yt+12>>2]=z;break}D=ee>>>8;do if(!D)R=0;else{if(ee>>>0>16777215){R=31;break}y=(D+1048320|0)>>>16&8,s=D<<y,O=(s+520192|0)>>>16&4,s=s<<O,R=(s+245760|0)>>>16&2,R=14-(O|y|R)+(s<<R>>>15)|0,R=ee>>>(R+7|0)&1|R<<1}while(!1);if(D=23620+(R<<2)|0,o[yt+28>>2]=R,C=yt+16|0,o[C+4>>2]=0,o[C>>2]=0,C=o[5830]|0,z=1<<R,!(C&z)){o[5830]=C|z,o[D>>2]=yt,o[yt+24>>2]=D,o[yt+12>>2]=yt,o[yt+8>>2]=yt;break}D=o[D>>2]|0;i:do if((o[D+4>>2]&-8|0)!=(ee|0)){for(R=ee<<((R|0)==31?0:25-(R>>>1)|0);z=D+16+(R>>>31<<2)|0,C=o[z>>2]|0,!!C;)if((o[C+4>>2]&-8|0)==(ee|0)){D=C;break i}else R=R<<1,D=C;o[z>>2]=yt,o[yt+24>>2]=D,o[yt+12>>2]=yt,o[yt+8>>2]=yt;break t}while(!1);y=D+8|0,s=o[y>>2]|0,o[s+12>>2]=yt,o[y>>2]=yt,o[yt+8>>2]=s,o[yt+12>>2]=D,o[yt+24>>2]=0}while(!1);return s=Ct+8|0,Vt=i,s|0}for(D=23764;C=o[D>>2]|0,!(C>>>0<=We>>>0&&(s=C+(o[D+4>>2]|0)|0,s>>>0>We>>>0));)D=o[D+8>>2]|0;ee=s+-47|0,C=ee+8|0,C=ee+(C&7|0?0-C&7:0)|0,ee=We+16|0,C=C>>>0<ee>>>0?We:C,D=C+8|0,z=oe+-40|0,O=le+8|0,O=O&7|0?0-O&7:0,y=le+O|0,O=z-O|0,o[5835]=y,o[5832]=O,o[y+4>>2]=O|1,o[le+z+4>>2]=40,o[5836]=o[5951],z=C+4|0,o[z>>2]=27,o[D>>2]=o[5941],o[D+4>>2]=o[5942],o[D+8>>2]=o[5943],o[D+12>>2]=o[5944],o[5941]=le,o[5942]=oe,o[5944]=0,o[5943]=D,D=C+24|0;do y=D,D=D+4|0,o[D>>2]=7;while((y+8|0)>>>0<s>>>0);if((C|0)!=(We|0)){if(le=C-We|0,o[z>>2]=o[z>>2]&-2,o[We+4>>2]=le|1,o[C>>2]=le,D=le>>>3,le>>>0<256){z=23356+(D<<1<<2)|0,C=o[5829]|0,D=1<<D,C&D?(C=z+8|0,D=o[C>>2]|0):(o[5829]=C|D,D=z,C=z+8|0),o[C>>2]=We,o[D+12>>2]=We,o[We+8>>2]=D,o[We+12>>2]=z;break}if(D=le>>>8,D?le>>>0>16777215?R=31:(y=(D+1048320|0)>>>16&8,s=D<<y,O=(s+520192|0)>>>16&4,s=s<<O,R=(s+245760|0)>>>16&2,R=14-(O|y|R)+(s<<R>>>15)|0,R=le>>>(R+7|0)&1|R<<1):R=0,z=23620+(R<<2)|0,o[We+28>>2]=R,o[We+20>>2]=0,o[ee>>2]=0,D=o[5830]|0,C=1<<R,!(D&C)){o[5830]=D|C,o[z>>2]=We,o[We+24>>2]=z,o[We+12>>2]=We,o[We+8>>2]=We;break}D=o[z>>2]|0;t:do if((o[D+4>>2]&-8|0)!=(le|0)){for(R=le<<((R|0)==31?0:25-(R>>>1)|0);z=D+16+(R>>>31<<2)|0,C=o[z>>2]|0,!!C;)if((o[C+4>>2]&-8|0)==(le|0)){D=C;break t}else R=R<<1,D=C;o[z>>2]=We,o[We+24>>2]=D,o[We+12>>2]=We,o[We+8>>2]=We;break e}while(!1);y=D+8|0,s=o[y>>2]|0,o[s+12>>2]=We,o[y>>2]=We,o[We+8>>2]=s,o[We+12>>2]=D,o[We+24>>2]=0}}else s=o[5833]|0,(s|0)==0|le>>>0<s>>>0&&(o[5833]=le),o[5941]=le,o[5942]=oe,o[5944]=0,o[5838]=o[5947],o[5837]=-1,o[5842]=23356,o[5841]=23356,o[5844]=23364,o[5843]=23364,o[5846]=23372,o[5845]=23372,o[5848]=23380,o[5847]=23380,o[5850]=23388,o[5849]=23388,o[5852]=23396,o[5851]=23396,o[5854]=23404,o[5853]=23404,o[5856]=23412,o[5855]=23412,o[5858]=23420,o[5857]=23420,o[5860]=23428,o[5859]=23428,o[5862]=23436,o[5861]=23436,o[5864]=23444,o[5863]=23444,o[5866]=23452,o[5865]=23452,o[5868]=23460,o[5867]=23460,o[5870]=23468,o[5869]=23468,o[5872]=23476,o[5871]=23476,o[5874]=23484,o[5873]=23484,o[5876]=23492,o[5875]=23492,o[5878]=23500,o[5877]=23500,o[5880]=23508,o[5879]=23508,o[5882]=23516,o[5881]=23516,o[5884]=23524,o[5883]=23524,o[5886]=23532,o[5885]=23532,o[5888]=23540,o[5887]=23540,o[5890]=23548,o[5889]=23548,o[5892]=23556,o[5891]=23556,o[5894]=23564,o[5893]=23564,o[5896]=23572,o[5895]=23572,o[5898]=23580,o[5897]=23580,o[5900]=23588,o[5899]=23588,o[5902]=23596,o[5901]=23596,o[5904]=23604,o[5903]=23604,s=oe+-40|0,O=le+8|0,O=O&7|0?0-O&7:0,y=le+O|0,O=s-O|0,o[5835]=y,o[5832]=O,o[y+4>>2]=O|1,o[le+s+4>>2]=40,o[5836]=o[5951];while(!1);if(D=o[5832]|0,D>>>0>ri>>>0)return O=D-ri|0,o[5832]=O,s=o[5835]|0,y=s+ri|0,o[5835]=y,o[y+4>>2]=O|1,o[s+4>>2]=ri|3,s=s+8|0,Vt=i,s|0}return s=yr()|0,o[s>>2]=12,s=0,Vt=i,s|0}function Jn(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0,We=0;if(C){z=C+-8|0,ee=o[5833]|0,C=o[C+-4>>2]|0,D=C&-8,We=z+D|0;do if(C&1)we=z,oe=z;else{if(R=o[z>>2]|0,!(C&3)||(oe=z+(0-R)|0,le=R+D|0,oe>>>0<ee>>>0))return;if((o[5834]|0)==(oe|0)){if(C=We+4|0,D=o[C>>2]|0,(D&3|0)!=3){we=oe,D=le;break}o[5831]=le,o[C>>2]=D&-2,o[oe+4>>2]=le|1,o[oe+le>>2]=le;return}if(z=R>>>3,R>>>0<256)if(C=o[oe+8>>2]|0,D=o[oe+12>>2]|0,(D|0)==(C|0)){o[5829]=o[5829]&~(1<<z),we=oe,D=le;break}else{o[C+12>>2]=D,o[D+8>>2]=C,we=oe,D=le;break}ee=o[oe+24>>2]|0,C=o[oe+12>>2]|0;do if((C|0)==(oe|0)){if(D=oe+16|0,z=D+4|0,C=o[z>>2]|0,C)D=z;else if(C=o[D>>2]|0,!C){C=0;break}for(;;)if(R=C+20|0,z=o[R>>2]|0,z)C=z,D=R;else if(R=C+16|0,z=o[R>>2]|0,z)C=z,D=R;else break;o[D>>2]=0}else we=o[oe+8>>2]|0,o[we+12>>2]=C,o[C+8>>2]=we;while(!1);if(ee){if(D=o[oe+28>>2]|0,z=23620+(D<<2)|0,(o[z>>2]|0)==(oe|0)){if(o[z>>2]=C,!C){o[5830]=o[5830]&~(1<<D),we=oe,D=le;break}}else if(we=ee+16|0,o[((o[we>>2]|0)==(oe|0)?we:ee+20|0)>>2]=C,!C){we=oe,D=le;break}o[C+24>>2]=ee,D=oe+16|0,z=o[D>>2]|0,z|0&&(o[C+16>>2]=z,o[z+24>>2]=C),D=o[D+4>>2]|0,D?(o[C+20>>2]=D,o[D+24>>2]=C,we=oe,D=le):(we=oe,D=le)}else we=oe,D=le}while(!1);if(!(oe>>>0>=We>>>0)&&(C=We+4|0,R=o[C>>2]|0,!!(R&1))){if(R&2)o[C>>2]=R&-2,o[we+4>>2]=D|1,o[oe+D>>2]=D,ee=D;else{if((o[5835]|0)==(We|0)){if(We=(o[5832]|0)+D|0,o[5832]=We,o[5835]=we,o[we+4>>2]=We|1,(we|0)!=(o[5834]|0))return;o[5834]=0,o[5831]=0;return}if((o[5834]|0)==(We|0)){We=(o[5831]|0)+D|0,o[5831]=We,o[5834]=oe,o[we+4>>2]=We|1,o[oe+We>>2]=We;return}ee=(R&-8)+D|0,z=R>>>3;do if(R>>>0<256)if(D=o[We+8>>2]|0,C=o[We+12>>2]|0,(C|0)==(D|0)){o[5829]=o[5829]&~(1<<z);break}else{o[D+12>>2]=C,o[C+8>>2]=D;break}else{le=o[We+24>>2]|0,C=o[We+12>>2]|0;do if((C|0)==(We|0)){if(D=We+16|0,z=D+4|0,C=o[z>>2]|0,C)D=z;else if(C=o[D>>2]|0,!C){z=0;break}for(;;)if(R=C+20|0,z=o[R>>2]|0,z)C=z,D=R;else if(R=C+16|0,z=o[R>>2]|0,z)C=z,D=R;else break;o[D>>2]=0,z=C}else z=o[We+8>>2]|0,o[z+12>>2]=C,o[C+8>>2]=z,z=C;while(!1);if(le|0){if(C=o[We+28>>2]|0,D=23620+(C<<2)|0,(o[D>>2]|0)==(We|0)){if(o[D>>2]=z,!z){o[5830]=o[5830]&~(1<<C);break}}else if(R=le+16|0,o[((o[R>>2]|0)==(We|0)?R:le+20|0)>>2]=z,!z)break;o[z+24>>2]=le,C=We+16|0,D=o[C>>2]|0,D|0&&(o[z+16>>2]=D,o[D+24>>2]=z),C=o[C+4>>2]|0,C|0&&(o[z+20>>2]=C,o[C+24>>2]=z)}}while(!1);if(o[we+4>>2]=ee|1,o[oe+ee>>2]=ee,(we|0)==(o[5834]|0)){o[5831]=ee;return}}if(C=ee>>>3,ee>>>0<256){z=23356+(C<<1<<2)|0,D=o[5829]|0,C=1<<C,D&C?(D=z+8|0,C=o[D>>2]|0):(o[5829]=D|C,C=z,D=z+8|0),o[D>>2]=we,o[C+12>>2]=we,o[we+8>>2]=C,o[we+12>>2]=z;return}C=ee>>>8,C?ee>>>0>16777215?R=31:(oe=(C+1048320|0)>>>16&8,We=C<<oe,le=(We+520192|0)>>>16&4,We=We<<le,R=(We+245760|0)>>>16&2,R=14-(le|oe|R)+(We<<R>>>15)|0,R=ee>>>(R+7|0)&1|R<<1):R=0,C=23620+(R<<2)|0,o[we+28>>2]=R,o[we+20>>2]=0,o[we+16>>2]=0,D=o[5830]|0,z=1<<R;e:do if(!(D&z))o[5830]=D|z,o[C>>2]=we,o[we+24>>2]=C,o[we+12>>2]=we,o[we+8>>2]=we;else{C=o[C>>2]|0;t:do if((o[C+4>>2]&-8|0)!=(ee|0)){for(R=ee<<((R|0)==31?0:25-(R>>>1)|0);z=C+16+(R>>>31<<2)|0,D=o[z>>2]|0,!!D;)if((o[D+4>>2]&-8|0)==(ee|0)){C=D;break t}else R=R<<1,C=D;o[z>>2]=we,o[we+24>>2]=C,o[we+12>>2]=we,o[we+8>>2]=we;break e}while(!1);oe=C+8|0,We=o[oe>>2]|0,o[We+12>>2]=we,o[oe>>2]=we,o[we+8>>2]=We,o[we+12>>2]=C,o[we+24>>2]=0}while(!1);if(We=(o[5837]|0)+-1|0,o[5837]=We,!(We|0)){for(C=23772;C=o[C>>2]|0,C;)C=C+8|0;o[5837]=-1}}}}function tl(C,D){C=C|0,D=D|0;var z=0;return C?(z=jr(D,C)|0,(D|C)>>>0>65535&&(z=((z>>>0)/(C>>>0)|0|0)==(D|0)?z:-1)):z=0,C=Zn(z)|0,!C||!(o[C+-4>>2]&3)||fs(C|0,0,z|0)|0,C|0}function Tu(C,D,z,R){return C=C|0,D=D|0,z=z|0,R=R|0,z=C+z>>>0,Vn(D+R+(z>>>0<C>>>0|0)>>>0|0),z|0|0}function oa(C,D,z,R){return C=C|0,D=D|0,z=z|0,R=R|0,R=D-R-(z>>>0>C>>>0|0)>>>0,Vn(R|0),C-z>>>0|0|0}function yu(C){return C=C|0,(C?31-(ur(C^C-1)|0)|0:32)|0}function bs(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,We=0,yt=0,Ct=0,ri=0,Gt=0,Zt=0,Z=0;if(Ct=C,We=D,yt=We,oe=z,Gt=R,we=Gt,!yt)return le=(ee|0)!=0,we?le?(o[ee>>2]=C|0,o[ee+4>>2]=D&0,Gt=0,ee=0,Vn(Gt|0),ee|0):(Gt=0,ee=0,Vn(Gt|0),ee|0):(le&&(o[ee>>2]=(Ct>>>0)%(oe>>>0),o[ee+4>>2]=0),Gt=0,ee=(Ct>>>0)/(oe>>>0)>>>0,Vn(Gt|0),ee|0);le=(we|0)==0;do if(oe){if(!le){if(le=(ur(we|0)|0)-(ur(yt|0)|0)|0,le>>>0<=31){ri=le+1|0,we=31-le|0,D=le-31>>31,oe=ri,C=Ct>>>(ri>>>0)&D|yt<<we,D=yt>>>(ri>>>0)&D,le=0,we=Ct<<we;break}return ee?(o[ee>>2]=C|0,o[ee+4>>2]=We|D&0,Gt=0,ee=0,Vn(Gt|0),ee|0):(Gt=0,ee=0,Vn(Gt|0),ee|0)}if(le=oe-1|0,le&oe|0){we=(ur(oe|0)|0)+33-(ur(yt|0)|0)|0,Z=64-we|0,ri=32-we|0,We=ri>>31,Zt=we-32|0,D=Zt>>31,oe=we,C=ri-1>>31&yt>>>(Zt>>>0)|(yt<<ri|Ct>>>(we>>>0))&D,D=D&yt>>>(we>>>0),le=Ct<<Z&We,we=(yt<<Z|Ct>>>(Zt>>>0))&We|Ct<<ri&we-33>>31;break}return ee|0&&(o[ee>>2]=le&Ct,o[ee+4>>2]=0),(oe|0)==1?(Zt=We|D&0,Z=C|0|0,Vn(Zt|0),Z|0):(Z=yu(oe|0)|0,Zt=yt>>>(Z>>>0)|0,Z=yt<<32-Z|Ct>>>(Z>>>0)|0,Vn(Zt|0),Z|0)}else{if(le)return ee|0&&(o[ee>>2]=(yt>>>0)%(oe>>>0),o[ee+4>>2]=0),Zt=0,Z=(yt>>>0)/(oe>>>0)>>>0,Vn(Zt|0),Z|0;if(!Ct)return ee|0&&(o[ee>>2]=0,o[ee+4>>2]=(yt>>>0)%(we>>>0)),Zt=0,Z=(yt>>>0)/(we>>>0)>>>0,Vn(Zt|0),Z|0;if(le=we-1|0,!(le&we))return ee|0&&(o[ee>>2]=C|0,o[ee+4>>2]=le&yt|D&0),Zt=0,Z=yt>>>((yu(we|0)|0)>>>0),Vn(Zt|0),Z|0;if(le=(ur(we|0)|0)-(ur(yt|0)|0)|0,le>>>0<=30){D=le+1|0,we=31-le|0,oe=D,C=yt<<we|Ct>>>(D>>>0),D=yt>>>(D>>>0),le=0,we=Ct<<we;break}return ee?(o[ee>>2]=C|0,o[ee+4>>2]=We|D&0,Zt=0,Z=0,Vn(Zt|0),Z|0):(Zt=0,Z=0,Vn(Zt|0),Z|0)}while(!1);if(!oe)yt=we,We=0,we=0;else{ri=z|0|0,Ct=Gt|R&0,yt=Tu(ri|0,Ct|0,-1,-1)|0,z=Wt()|0,We=we,we=0;do R=We,We=le>>>31|We<<1,le=we|le<<1,R=C<<1|R>>>31|0,Gt=C>>>31|D<<1|0,oa(yt|0,z|0,R|0,Gt|0)|0,Z=Wt()|0,Zt=Z>>31|((Z|0)<0?-1:0)<<1,we=Zt&1,C=oa(R|0,Gt|0,Zt&ri|0,(((Z|0)<0?-1:0)>>31|((Z|0)<0?-1:0)<<1)&Ct|0)|0,D=Wt()|0,oe=oe-1|0;while(oe|0);yt=We,We=0}return oe=0,ee|0&&(o[ee>>2]=C,o[ee+4>>2]=D),Zt=(le|0)>>>31|(yt|oe)<<1|(oe<<1|le>>>31)&0|We,Z=(le<<1|0)&-2|we,Vn(Zt|0),Z|0}function Lo(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0;return le=Vt,Vt=Vt+16|0,ee=le|0,bs(C,D,z,R,ee)|0,Vt=le,Vn(o[ee+4>>2]|0),o[ee>>2]|0|0}function ki(C,D,z){return C=C|0,D=D|0,z=z|0,(z|0)<32?(Vn(D>>>z|0),C>>>z|(D&(1<<z)-1)<<32-z):(Vn(0),D>>>z-32|0)}function Li(C,D,z){return C=C|0,D=D|0,z=z|0,(z|0)<32?(Vn(D<<z|(C&(1<<z)-1<<32-z)>>>32-z|0),C<<z):(Vn(C<<z-32|0),0)}function ws(C,D){return C=+C,D=+D,C!=C?+D:D!=D?+C:+ji(+C,+D)}function vu(C){return C=+C,C>=0?+fi(C+.5):+Hn(C-.5)}function Vo(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0;if((z|0)>=8192)return cr(C|0,D|0,z|0)|0,C|0;if(le=C|0,ee=C+z|0,(C&3)==(D&3)){for(;C&3;){if(!z)return le|0;kt[C>>0]=kt[D>>0]|0,C=C+1|0,D=D+1|0,z=z-1|0}for(z=ee&-4|0,R=z-64|0;(C|0)<=(R|0);)o[C>>2]=o[D>>2],o[C+4>>2]=o[D+4>>2],o[C+8>>2]=o[D+8>>2],o[C+12>>2]=o[D+12>>2],o[C+16>>2]=o[D+16>>2],o[C+20>>2]=o[D+20>>2],o[C+24>>2]=o[D+24>>2],o[C+28>>2]=o[D+28>>2],o[C+32>>2]=o[D+32>>2],o[C+36>>2]=o[D+36>>2],o[C+40>>2]=o[D+40>>2],o[C+44>>2]=o[D+44>>2],o[C+48>>2]=o[D+48>>2],o[C+52>>2]=o[D+52>>2],o[C+56>>2]=o[D+56>>2],o[C+60>>2]=o[D+60>>2],C=C+64|0,D=D+64|0;for(;(C|0)<(z|0);)o[C>>2]=o[D>>2],C=C+4|0,D=D+4|0}else for(z=ee-4|0;(C|0)<(z|0);)kt[C>>0]=kt[D>>0]|0,kt[C+1>>0]=kt[D+1>>0]|0,kt[C+2>>0]=kt[D+2>>0]|0,kt[C+3>>0]=kt[D+3>>0]|0,C=C+4|0,D=D+4|0;for(;(C|0)<(ee|0);)kt[C>>0]=kt[D>>0]|0,C=C+1|0,D=D+1|0;return le|0}function fs(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0;if(le=C+z|0,D=D&255,(z|0)>=67){for(;C&3;)kt[C>>0]=D,C=C+1|0;for(R=le&-4|0,oe=D|D<<8|D<<16|D<<24,ee=R-64|0;(C|0)<=(ee|0);)o[C>>2]=oe,o[C+4>>2]=oe,o[C+8>>2]=oe,o[C+12>>2]=oe,o[C+16>>2]=oe,o[C+20>>2]=oe,o[C+24>>2]=oe,o[C+28>>2]=oe,o[C+32>>2]=oe,o[C+36>>2]=oe,o[C+40>>2]=oe,o[C+44>>2]=oe,o[C+48>>2]=oe,o[C+52>>2]=oe,o[C+56>>2]=oe,o[C+60>>2]=oe,C=C+64|0;for(;(C|0)<(R|0);)o[C>>2]=oe,C=C+4|0}for(;(C|0)<(le|0);)kt[C>>0]=D,C=C+1|0;return le-z|0}function hl(C){return C=+C,C>=0?+fi(C+.5):+Hn(C-.5)}function Ds(C){C=C|0;var D=0,z=0,R=0;return R=Tn()|0,z=o[oi>>2]|0,D=z+C|0,(C|0)>0&(D|0)<(z|0)|(D|0)<0?(Ur(D|0)|0,Ut(12),-1):(D|0)>(R|0)&&!(Vs(D|0)|0)?(Ut(12),-1):(o[oi>>2]=D,z|0)}return{___uremdi3:Lo,_bitshift64Lshr:ki,_bitshift64Shl:Li,_calloc:tl,_cellAreaKm2:Ol,_cellAreaM2:ns,_cellAreaRads2:qn,_compact:Tl,_destroyLinkedPolygon:or,_edgeLengthKm:Xa,_edgeLengthM:is,_emscripten_replace_memory:hr,_exactEdgeLengthKm:Ms,_exactEdgeLengthM:Mr,_exactEdgeLengthRads:Zr,_experimentalH3ToLocalIj:Ja,_experimentalLocalIjToH3:yo,_free:Jn,_geoToH3:Aa,_getDestinationH3IndexFromUnidirectionalEdge:Pi,_getH3IndexesFromUnidirectionalEdge:ni,_getH3UnidirectionalEdge:pi,_getH3UnidirectionalEdgeBoundary:Fi,_getH3UnidirectionalEdgesFromHexagon:xi,_getOriginH3IndexFromUnidirectionalEdge:Vi,_getPentagonIndexes:gl,_getRes0Indexes:Ar,_h3Distance:os,_h3GetBaseCell:ll,_h3GetFaces:cl,_h3GetResolution:nr,_h3IndexesAreNeighbors:ao,_h3IsPentagon:ds,_h3IsResClassIII:go,_h3IsValid:Xr,_h3Line:Fu,_h3LineSize:$u,_h3SetToLinkedGeo:Ha,_h3ToCenterChild:Ia,_h3ToChildren:Qr,_h3ToGeo:Ea,_h3ToGeoBoundary:Pa,_h3ToParent:Po,_h3UnidirectionalEdgeIsValid:Ft,_hexAreaKm2:Ko,_hexAreaM2:zr,_hexRing:aa,_i64Subtract:oa,_kRing:Ua,_kRingDistances:Fo,_llvm_minnum_f64:ws,_llvm_round_f64:vu,_malloc:Zn,_maxFaceCount:Ka,_maxH3ToChildrenSize:ul,_maxKringSize:Dr,_maxPolyfillSize:hs,_maxUncompactSize:kl,_memcpy:Vo,_memset:fs,_numHexagons:fr,_pentagonIndexCount:lu,_pointDistKm:ks,_pointDistM:gu,_pointDistRads:$a,_polyfill:qa,_res0IndexCount:rr,_round:hl,_sbrk:Ds,_sizeOfCoordIJ:uu,_sizeOfGeoBoundary:En,_sizeOfGeoCoord:Nl,_sizeOfGeoPolygon:Cn,_sizeOfGeofence:$l,_sizeOfH3Index:No,_sizeOfLinkedGeoPolygon:_l,_uncompact:Do,establishStackSpace:ca,stackAlloc:Dt,stackRestore:Us,stackSave:Fr}}(rt,Me,xt);t.___uremdi3=se.___uremdi3,t._bitshift64Lshr=se._bitshift64Lshr,t._bitshift64Shl=se._bitshift64Shl,t._calloc=se._calloc,t._cellAreaKm2=se._cellAreaKm2,t._cellAreaM2=se._cellAreaM2,t._cellAreaRads2=se._cellAreaRads2,t._compact=se._compact,t._destroyLinkedPolygon=se._destroyLinkedPolygon,t._edgeLengthKm=se._edgeLengthKm,t._edgeLengthM=se._edgeLengthM;var ne=t._emscripten_replace_memory=se._emscripten_replace_memory;t._exactEdgeLengthKm=se._exactEdgeLengthKm,t._exactEdgeLengthM=se._exactEdgeLengthM,t._exactEdgeLengthRads=se._exactEdgeLengthRads,t._experimentalH3ToLocalIj=se._experimentalH3ToLocalIj,t._experimentalLocalIjToH3=se._experimentalLocalIjToH3,t._free=se._free,t._geoToH3=se._geoToH3,t._getDestinationH3IndexFromUnidirectionalEdge=se._getDestinationH3IndexFromUnidirectionalEdge,t._getH3IndexesFromUnidirectionalEdge=se._getH3IndexesFromUnidirectionalEdge,t._getH3UnidirectionalEdge=se._getH3UnidirectionalEdge,t._getH3UnidirectionalEdgeBoundary=se._getH3UnidirectionalEdgeBoundary,t._getH3UnidirectionalEdgesFromHexagon=se._getH3UnidirectionalEdgesFromHexagon,t._getOriginH3IndexFromUnidirectionalEdge=se._getOriginH3IndexFromUnidirectionalEdge,t._getPentagonIndexes=se._getPentagonIndexes,t._getRes0Indexes=se._getRes0Indexes,t._h3Distance=se._h3Distance,t._h3GetBaseCell=se._h3GetBaseCell,t._h3GetFaces=se._h3GetFaces,t._h3GetResolution=se._h3GetResolution,t._h3IndexesAreNeighbors=se._h3IndexesAreNeighbors,t._h3IsPentagon=se._h3IsPentagon,t._h3IsResClassIII=se._h3IsResClassIII,t._h3IsValid=se._h3IsValid,t._h3Line=se._h3Line,t._h3LineSize=se._h3LineSize,t._h3SetToLinkedGeo=se._h3SetToLinkedGeo,t._h3ToCenterChild=se._h3ToCenterChild,t._h3ToChildren=se._h3ToChildren,t._h3ToGeo=se._h3ToGeo,t._h3ToGeoBoundary=se._h3ToGeoBoundary,t._h3ToParent=se._h3ToParent,t._h3UnidirectionalEdgeIsValid=se._h3UnidirectionalEdgeIsValid,t._hexAreaKm2=se._hexAreaKm2,t._hexAreaM2=se._hexAreaM2,t._hexRing=se._hexRing,t._i64Subtract=se._i64Subtract,t._kRing=se._kRing,t._kRingDistances=se._kRingDistances,t._llvm_minnum_f64=se._llvm_minnum_f64,t._llvm_round_f64=se._llvm_round_f64,t._malloc=se._malloc,t._maxFaceCount=se._maxFaceCount,t._maxH3ToChildrenSize=se._maxH3ToChildrenSize,t._maxKringSize=se._maxKringSize,t._maxPolyfillSize=se._maxPolyfillSize,t._maxUncompactSize=se._maxUncompactSize,t._memcpy=se._memcpy,t._memset=se._memset,t._numHexagons=se._numHexagons,t._pentagonIndexCount=se._pentagonIndexCount,t._pointDistKm=se._pointDistKm,t._pointDistM=se._pointDistM,t._pointDistRads=se._pointDistRads,t._polyfill=se._polyfill,t._res0IndexCount=se._res0IndexCount,t._round=se._round,t._sbrk=se._sbrk,t._sizeOfCoordIJ=se._sizeOfCoordIJ,t._sizeOfGeoBoundary=se._sizeOfGeoBoundary,t._sizeOfGeoCoord=se._sizeOfGeoCoord,t._sizeOfGeoPolygon=se._sizeOfGeoPolygon,t._sizeOfGeofence=se._sizeOfGeofence,t._sizeOfH3Index=se._sizeOfH3Index,t._sizeOfLinkedGeoPolygon=se._sizeOfLinkedGeoPolygon,t._uncompact=se._uncompact,t.establishStackSpace=se.establishStackSpace;var $=t.stackAlloc=se.stackAlloc,ie=t.stackRestore=se.stackRestore,de=t.stackSave=se.stackSave;if(t.asm=se,t.cwrap=Tt,t.setValue=be,t.getValue=Je,t.getTempRet0=ae,sn){On(sn)||(sn=x(sn));{mr();var ye=function(De){De.byteLength&&(De=new Uint8Array(De)),lt.set(De,ce),t.memoryInitializerRequest&&delete t.memoryInitializerRequest.response,ci()},ge=function(){S(sn,ye,function(){throw"could not load memory initializer "+sn})},Pe=dt(sn);if(Pe)ye(Pe.buffer);else if(t.memoryInitializerRequest){var Fe=function(){var De=t.memoryInitializerRequest,Ge=De.response;if(De.status!==200&&De.status!==0){var At=dt(t.memoryInitializerRequestURL);if(At)Ge=At.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+De.status+", retrying "+sn),ge();return}}ye(Ge)};t.memoryInitializerRequest.response?setTimeout(Fe,0):t.memoryInitializerRequest.addEventListener("load",Fe)}else ge()}}var Ve;Ji=function De(){Ve||Xe(),Ve||(Ji=De)};function Xe(De){if(Xt>0||(nn(),Xt>0))return;function Ge(){Ve||(Ve=!0,!st&&(vn(),Ei(),t.onRuntimeInitialized&&t.onRuntimeInitialized(),mi()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),Ge()},1)):Ge()}t.run=Xe;function Ke(De){throw t.onAbort&&t.onAbort(De),De+="",a(De),U(De),st=!0,"abort("+De+"). Build with -s ASSERTIONS=1 for more info."}if(t.abort=Ke,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return Xe(),e}(typeof Mn=="object"?Mn:{}),Pr="number",Jm=Pr,ls=Pr,Fs=Pr,Vc=Pr,xa=Pr,AN=[["sizeOfH3Index",Pr],["sizeOfGeoCoord",Pr],["sizeOfGeoBoundary",Pr],["sizeOfGeoPolygon",Pr],["sizeOfGeofence",Pr],["sizeOfLinkedGeoPolygon",Pr],["sizeOfCoordIJ",Pr],["h3IsValid",Jm,[ls,Fs]],["geoToH3",ls,[Pr,Pr,Vc]],["h3ToGeo",null,[ls,Fs,xa]],["h3ToGeoBoundary",null,[ls,Fs,xa]],["maxKringSize",Pr,[Pr]],["kRing",null,[ls,Fs,Pr,xa]],["kRingDistances",null,[ls,Fs,Pr,xa,xa]],["hexRing",null,[ls,Fs,Pr,xa]],["maxPolyfillSize",Pr,[xa,Vc]],["polyfill",null,[xa,Vc,xa]],["h3SetToLinkedGeo",null,[xa,Pr,xa]],["destroyLinkedPolygon",null,[xa]],["compact",Pr,[xa,xa,Pr]],["uncompact",Pr,[xa,Pr,xa,Pr,Vc]],["maxUncompactSize",Pr,[xa,Pr,Vc]],["h3IsPentagon",Jm,[ls,Fs]],["h3IsResClassIII",Jm,[ls,Fs]],["h3GetBaseCell",Pr,[ls,Fs]],["h3GetResolution",Pr,[ls,Fs]],["maxFaceCount",Pr,[ls,Fs]],["h3GetFaces",null,[ls,Fs,xa]],["h3ToParent",ls,[ls,Fs,Vc]],["h3ToChildren",null,[ls,Fs,Vc,xa]],["h3ToCenterChild",ls,[ls,Fs,Vc]],["maxH3ToChildrenSize",Pr,[ls,Fs,Vc]],["h3IndexesAreNeighbors",Jm,[ls,Fs,ls,Fs]],["getH3UnidirectionalEdge",ls,[ls,Fs,ls,Fs]],["getOriginH3IndexFromUnidirectionalEdge",ls,[ls,Fs]],["getDestinationH3IndexFromUnidirectionalEdge",ls,[ls,Fs]],["h3UnidirectionalEdgeIsValid",Jm,[ls,Fs]],["getH3IndexesFromUnidirectionalEdge",null,[ls,Fs,xa]],["getH3UnidirectionalEdgesFromHexagon",null,[ls,Fs,xa]],["getH3UnidirectionalEdgeBoundary",null,[ls,Fs,xa]],["h3Distance",Pr,[ls,Fs,ls,Fs]],["h3Line",Pr,[ls,Fs,ls,Fs,xa]],["h3LineSize",Pr,[ls,Fs,ls,Fs]],["experimentalH3ToLocalIj",Pr,[ls,Fs,ls,Fs,xa]],["experimentalLocalIjToH3",Pr,[ls,Fs,xa,xa]],["hexAreaM2",Pr,[Vc]],["hexAreaKm2",Pr,[Vc]],["edgeLengthM",Pr,[Vc]],["edgeLengthKm",Pr,[Vc]],["pointDistM",Pr,[xa,xa]],["pointDistKm",Pr,[xa,xa]],["pointDistRads",Pr,[xa,xa]],["cellAreaM2",Pr,[ls,Fs]],["cellAreaKm2",Pr,[ls,Fs]],["cellAreaRads2",Pr,[ls,Fs]],["exactEdgeLengthM",Pr,[ls,Fs]],["exactEdgeLengthKm",Pr,[ls,Fs]],["exactEdgeLengthRads",Pr,[ls,Fs]],["numHexagons",Pr,[Vc]],["getRes0Indexes",null,[xa]],["res0IndexCount",Pr],["getPentagonIndexes",null,[Pr,xa]],["pentagonIndexCount",Pr]],sr={};AN.forEach(function(t){sr[t[0]]=Mn.cwrap.apply(Mn,t)});var rm=16,_c=4,kw=4,U0=8,rc=sr.sizeOfH3Index(),d1=sr.sizeOfGeoCoord(),_5=sr.sizeOfGeoBoundary(),fN=sr.sizeOfGeoPolygon(),Ag=sr.sizeOfGeofence(),dN=sr.sizeOfLinkedGeoPolygon(),y5=sr.sizeOfCoordIJ(),qc={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function Em(e){if(typeof e!="number"||e<0||e>15||Math.floor(e)!==e)throw new Error("Invalid resolution: "+e)}var pN=/[^0-9a-fA-F]/;function ga(e){if(Array.isArray(e)&&e.length===2&&Number.isInteger(e[0])&&Number.isInteger(e[1]))return e;if(typeof e!="string"||pN.test(e))return[0,0];var t=parseInt(e.substring(0,e.length-8),rm),n=parseInt(e.substring(e.length-8),rm);return[n,t]}function Mw(e){if(e>=0)return e.toString(rm);e=e&2147483647;var t=v5(8,e.toString(rm)),n=(parseInt(t[0],rm)+8).toString(rm);return t=n+t.substring(1),t}function p1(e,t){return Mw(t)+v5(8,Mw(e))}function v5(e,t){for(var n=e-t.length,c="",g=0;g<n;g++)c+="0";return c=c+t,c}function Pw(e,t,n){for(var c=e.length,g=Mn._calloc(c,d1),x=n?1:0,S=n?0:1,a=0;a<c*2;a+=2)Mn.HEAPF64.set([e[a/2][x],e[a/2][S]].map(m1),g/U0+a);return Mn.HEAPU32.set([c,g],t/_c),t}function mN(e,t){var n=e.length-1,c=Mn._calloc(fN),g=0,x=g+Ag,S=x+_c;Pw(e[0],c+g,t);var a;if(n>0){a=Mn._calloc(n,Ag);for(var U=0;U<n;U++)Pw(e[U+1],a+Ag*U,t)}return Mn.setValue(c+x,n,"i32"),Mn.setValue(c+S,a,"i32"),c}function gN(e){var t=0,n=t+Ag,c=n+_c,g=_c;Mn._free(Mn.getValue(e+t+g,"i8*"));var x=Mn.getValue(e+n,"i32");if(x>0){for(var S=Mn.getValue(e+c,"i32"),a=0;a<x;a++)Mn._free(Mn.getValue(S+Ag*a+g,"i8*"));Mn._free(S)}Mn._free(e)}function x5(e){var t=Mn.getTempRet0();return[e,t]}function Cm(e){var t=x5(e),n=t[0],c=t[1];return c?p1(n,c):null}function b5(e,t){t===void 0&&(t=0);var n=Mn.getValue(e+_c*t*2,"i32"),c=Mn.getValue(e+_c*(t*2+1),"i32");return c?p1(n,c):null}function _N(e,t,n){Mn.HEAPU32.set(ga(e),t/_c+2*n)}function dA(e,t){for(var n=[],c=0;c<t;c++){var g=b5(e,c);g!==null&&n.push(g)}return n}function T2(e,t){for(var n=t.length,c=0;c<n;c++)_N(t[c],e,c)}function Dw(e,t){var n=Mn._calloc(1,d1);return Mn.HEAPF64.set([e,t].map(m1),n/U0),n}function q_(e){return E5(Mn.getValue(e,"double"))}function k2(e){return[q_(e),q_(e+U0)]}function w5(e){return[q_(e+U0),q_(e)]}function S5(e,t,n){for(var c=Mn.getValue(e,"i32"),g=e+U0,x=[],S=t?w5:k2,a=0;a<c*2;a+=2)x.push(S(g+U0*a));return n&&x.push(x[0]),x}function yN(e,t){for(var n=[],c=t?w5:k2,g,x,S,a;e;){for(n.push(g=[]),x=Mn.getValue(e,"i8*");x;){for(g.push(S=[]),a=Mn.getValue(x,"i8*");a;)S.push(c(a)),a=Mn.getValue(a+U0*2,"i8*");t&&S.push(S[0]),x=Mn.getValue(x+kw*2,"i8*")}e=Mn.getValue(e+kw*2,"i8*")}return n}function vN(e){return{i:Mn.getValue(e,"i32"),j:Mn.getValue(e+_c,"i32")}}function xN(e,t){var n=t.i,c=t.j;Mn.setValue(e,n,"i32"),Mn.setValue(e+_c,c,"i32")}function bN(e,t){for(var n=[],c=0;c<t;c++){var g=Mn.getValue(e+_c*c,"i32");g>=0&&n.push(g)}return n}function I5(e){var t=ga(e),n=t[0],c=t[1];return!!sr.h3IsValid(n,c)}function wN(e){var t=ga(e),n=t[0],c=t[1];return!!sr.h3IsPentagon(n,c)}function SN(e){var t=ga(e),n=t[0],c=t[1];return!!sr.h3IsResClassIII(n,c)}function IN(e){var t=ga(e),n=t[0],c=t[1];return sr.h3GetBaseCell(n,c)}function EN(e){var t=ga(e),n=t[0],c=t[1],g=sr.maxFaceCount(n,c),x=Mn._malloc(_c*g);sr.h3GetFaces(n,c,x);var S=bN(x,g);return Mn._free(x),S}function CN(e){var t=ga(e),n=t[0],c=t[1];return sr.h3IsValid(n,c)?sr.h3GetResolution(n,c):-1}function TN(e,t,n){var c=Mn._malloc(d1);Mn.HEAPF64.set([e,t].map(m1),c/U0);var g=Cm(sr.geoToH3(c,n));return Mn._free(c),g}function kN(e){var t=Mn._malloc(d1),n=ga(e),c=n[0],g=n[1];sr.h3ToGeo(c,g,t);var x=k2(t);return Mn._free(t),x}function MN(e,t){var n=Mn._malloc(_5),c=ga(e),g=c[0],x=c[1];sr.h3ToGeoBoundary(g,x,n);var S=S5(n,t,t);return Mn._free(n),S}function PN(e,t){var n=ga(e),c=n[0],g=n[1];return Cm(sr.h3ToParent(c,g,t))}function DN(e,t){if(!I5(e))return[];var n=ga(e),c=n[0],g=n[1],x=sr.maxH3ToChildrenSize(c,g,t),S=Mn._calloc(x,rc);sr.h3ToChildren(c,g,t,S);var a=dA(S,x);return Mn._free(S),a}function LN(e,t){var n=ga(e),c=n[0],g=n[1];return Cm(sr.h3ToCenterChild(c,g,t))}function BN(e,t){var n=ga(e),c=n[0],g=n[1],x=sr.maxKringSize(t),S=Mn._calloc(x,rc);sr.kRing(c,g,t,S);var a=dA(S,x);return Mn._free(S),a}function zN(e,t){var n=ga(e),c=n[0],g=n[1],x=sr.maxKringSize(t),S=Mn._calloc(x,rc),a=Mn._calloc(x,_c);sr.kRingDistances(c,g,t,S,a);for(var U=[],W=0;W<t+1;W++)U.push([]);for(var he=0;he<x*2;he+=2){var ae=Mn.getValue(S+_c*he,"i32"),ce=Mn.getValue(S+_c*(he+1),"i32"),be=Mn.getValue(a+_c*(he/2),"i32");(ae!==0||ce!==0)&&U[be].push(p1(ae,ce))}return Mn._free(S),Mn._free(a),U}function RN(e,t){var n=t===0?1:6*t,c=Mn._calloc(n,rc),g=sr.hexRing.apply(sr,ga(e).concat([t],[c]));if(g!==0)throw Mn._free(c),new Error("Failed to get hexRing (encountered a pentagon?)");var x=dA(c,n);return Mn._free(c),x}function FN(e,t,n){if(Em(t),n=!!n,e.length===0||e[0].length===0)return[];typeof e[0][0]=="number"&&(e=[e]);var c=mN(e,n),g=sr.maxPolyfillSize(c,t),x=Mn._calloc(g,rc);sr.polyfill(c,t,x);var S=dA(x,g);return Mn._free(x),gN(c),S}function ON(e,t){if(!e||!e.length)return[];var n=e.length,c=Mn._calloc(n,rc);T2(c,e);var g=Mn._calloc(dN),x=g;sr.h3SetToLinkedGeo(c,n,g);var S=yN(g,t);return sr.destroyLinkedPolygon(x),Mn._free(x),Mn._free(c),S}function NN(e){if(!e||!e.length)return[];var t=e.length,n=Mn._calloc(t,rc);T2(n,e);var c=Mn._calloc(t,rc),g=sr.compact(n,c,t);if(g!==0)throw Mn._free(n),Mn._free(c),new Error("Failed to compact, malformed input data (duplicate hexagons?)");var x=dA(c,t);return Mn._free(n),Mn._free(c),x}function VN(e,t){if(Em(t),!e||!e.length)return[];var n=e.length,c=Mn._calloc(n,rc);T2(c,e);var g=sr.maxUncompactSize(c,n,t),x=Mn._calloc(g,rc),S=sr.uncompact(c,n,x,g,t);if(S!==0)throw Mn._free(c),Mn._free(x),new Error("Failed to uncompact (bad resolution?)");var a=dA(x,g);return Mn._free(c),Mn._free(x),a}function UN(e,t){var n=ga(e),c=n[0],g=n[1],x=ga(t),S=x[0],a=x[1];return!!sr.h3IndexesAreNeighbors(c,g,S,a)}function GN(e,t){var n=ga(e),c=n[0],g=n[1],x=ga(t),S=x[0],a=x[1];return Cm(sr.getH3UnidirectionalEdge(c,g,S,a))}function qN(e){var t=ga(e),n=t[0],c=t[1];return Cm(sr.getOriginH3IndexFromUnidirectionalEdge(n,c))}function HN(e){var t=ga(e),n=t[0],c=t[1];return Cm(sr.getDestinationH3IndexFromUnidirectionalEdge(n,c))}function jN(e){var t=ga(e),n=t[0],c=t[1];return!!sr.h3UnidirectionalEdgeIsValid(n,c)}function ZN(e){var t=ga(e),n=t[0],c=t[1],g=2,x=Mn._calloc(g,rc);sr.getH3IndexesFromUnidirectionalEdge(n,c,x);var S=dA(x,g);return Mn._free(x),S}function QN(e){var t=ga(e),n=t[0],c=t[1],g=6,x=Mn._calloc(g,rc);sr.getH3UnidirectionalEdgesFromHexagon(n,c,x);var S=dA(x,g);return Mn._free(x),S}function WN(e,t){var n=Mn._malloc(_5),c=ga(e),g=c[0],x=c[1];sr.getH3UnidirectionalEdgeBoundary(g,x,n);var S=S5(n,t);return Mn._free(n),S}function $N(e,t){var n=ga(e),c=n[0],g=n[1],x=ga(t),S=x[0],a=x[1];return sr.h3Distance(c,g,S,a)}function XN(e,t){var n=ga(e),c=n[0],g=n[1],x=ga(t),S=x[0],a=x[1],U=sr.h3LineSize(c,g,S,a);if(U<0)throw new Error("Line cannot be calculated");var W=Mn._calloc(U,rc);sr.h3Line(c,g,S,a,W);var he=dA(W,U);return Mn._free(W),he}function YN(e,t){var n=Mn._malloc(y5),c=sr.experimentalH3ToLocalIj.apply(sr,ga(e).concat(ga(t),[n])),g=vN(n);switch(Mn._free(n),c){case 0:return g;case 1:throw new Error("Incompatible origin and index.");case 2:default:throw new Error("Local IJ coordinates undefined for this origin and index pair. The index may be too far from the origin.");case 3:case 4:case 5:throw new Error("Encountered possible pentagon distortion")}}function KN(e,t){if(!t||typeof t.i!="number"||typeof t.j!="number")throw new Error("Coordinates must be provided as an {i, j} object");var n=Mn._malloc(y5),c=Mn._malloc(rc);xN(n,t);var g=sr.experimentalLocalIjToH3.apply(sr,ga(e).concat([n],[c])),x=b5(c);if(Mn._free(n),Mn._free(c),g!==0)throw new Error("Index not defined for this origin and IJ coordinates pair. IJ coordinates may be too far from origin, or a pentagon distortion was encountered.");return x}function JN(e,t,n){var c=Dw(e[0],e[1]),g=Dw(t[0],t[1]),x;switch(n){case qc.m:x=sr.pointDistM(c,g);break;case qc.km:x=sr.pointDistKm(c,g);break;case qc.rads:x=sr.pointDistRads(c,g);break;default:x=null}if(Mn._free(c),Mn._free(g),x===null)throw new Error("Unknown unit: "+n);return x}function eV(e,t){var n=ga(e),c=n[0],g=n[1];switch(t){case qc.m2:return sr.cellAreaM2(c,g);case qc.km2:return sr.cellAreaKm2(c,g);case qc.rads2:return sr.cellAreaRads2(c,g);default:throw new Error("Unknown unit: "+t)}}function tV(e,t){var n=ga(e),c=n[0],g=n[1];switch(t){case qc.m:return sr.exactEdgeLengthM(c,g);case qc.km:return sr.exactEdgeLengthKm(c,g);case qc.rads:return sr.exactEdgeLengthRads(c,g);default:throw new Error("Unknown unit: "+t)}}function iV(e,t){switch(Em(e),t){case qc.m2:return sr.hexAreaM2(e);case qc.km2:return sr.hexAreaKm2(e);default:throw new Error("Unknown unit: "+t)}}function nV(e,t){switch(Em(e),t){case qc.m:return sr.edgeLengthM(e);case qc.km:return sr.edgeLengthKm(e);default:throw new Error("Unknown unit: "+t)}}function rV(e){Em(e);var t=x5(sr.numHexagons(e)),n=t[0],c=t[1];return c?c*Math.pow(2,32)+n:n}function sV(){var e=sr.res0IndexCount(),t=Mn._malloc(rc*e);sr.getRes0Indexes(t);var n=dA(t,e);return Mn._free(t),n}function aV(e){Em(e);var t=sr.pentagonIndexCount(),n=Mn._malloc(rc*t);sr.getPentagonIndexes(e,n);var c=dA(n,t);return Mn._free(n),c}function m1(e){return e*Math.PI/180}function E5(e){return e*180/Math.PI}const oV=Object.freeze(Object.defineProperty({__proto__:null,UNITS:qc,cellArea:eV,compact:NN,degsToRads:m1,edgeLength:nV,exactEdgeLength:tV,experimentalH3ToLocalIj:YN,experimentalLocalIjToH3:KN,geoToH3:TN,getDestinationH3IndexFromUnidirectionalEdge:HN,getH3IndexesFromUnidirectionalEdge:ZN,getH3UnidirectionalEdge:GN,getH3UnidirectionalEdgeBoundary:WN,getH3UnidirectionalEdgesFromHexagon:QN,getOriginH3IndexFromUnidirectionalEdge:qN,getPentagonIndexes:aV,getRes0Indexes:sV,h3Distance:$N,h3GetBaseCell:IN,h3GetFaces:EN,h3GetResolution:CN,h3IndexToSplitLong:ga,h3IndexesAreNeighbors:UN,h3IsPentagon:wN,h3IsResClassIII:SN,h3IsValid:I5,h3Line:XN,h3SetToMultiPolygon:ON,h3ToCenterChild:LN,h3ToChildren:DN,h3ToGeo:kN,h3ToGeoBoundary:MN,h3ToParent:PN,h3UnidirectionalEdgeIsValid:jN,hexArea:iV,hexRing:RN,kRing:BN,kRingDistances:zN,numHexagons:rV,pointDist:JN,polyfill:FN,radsToDegs:E5,splitLongToh3Index:p1,uncompact:VN},Symbol.toStringTag,{value:"Module"})),lV=Rv(oV);var Eg=lV,g1="Feature",C5="FeatureCollection",H_="Polygon",M2="MultiPolygon";function T5(e){for(var t=null,n=0;n<e.length;n++)if(t!==null)for(var c=0;c<e[n].length;c++)t.push(e[n][c]);else t=e[n];return Array.from(new Set(t))}function uV(e){for(var t=0,n=0,c=0,g=e[0],x=0;x<g.length;x++)t+=g[x][0],n+=g[x][1],c++;return[t/c,n/c]}function cV(e,t){var n=e.features;if(!n)throw new Error("No features found");return T5(n.map(function(c){return k5(c,t)}))}function k5(e,t,n){n===void 0&&(n={});var c=e.type,g=e.geometry,x=g&&g.type;if(c===C5)return cV(e,t);if(c!==g1)throw new Error("Unhandled type: "+c);if(x!==H_&&x!==M2)throw new Error("Unhandled geometry type: "+x);var S=x===H_?[g.coordinates]:g.coordinates;return T5(S.map(function(a){var U=Eg.polyfill(a,t,!0);if(U.length||!n.ensureOutput)return U;var W=uV(a),he=W[0],ae=W[1];return[Eg.geoToH3(ae,he,t)]}))}function M5(e,t){t===void 0&&(t={});var n=[Eg.h3ToGeoBoundary(e,!0)];return{type:g1,id:e,properties:t,geometry:{type:H_,coordinates:n}}}function hV(e,t){t===void 0&&(t={});var n=Eg.h3SetToMultiPolygon(e,!0),c=n.length>1,g=c?M2:H_,x=c?n:n[0]||[];return{type:g1,properties:t,geometry:{type:g,coordinates:x}}}function AV(e,t){t===void 0&&(t={});var n=e.map(function(c){return[Eg.h3ToGeoBoundary(c,{geoJson:!0})]});return{type:g1,properties:t,geometry:{type:M2,coordinates:n}}}function fV(e,t){for(var n=[],c=0;c<e.length;c++){var g=e[c],x=t?t(g):{};n.push(M5(g,x))}return{type:C5,features:n}}var dV={featureToH3Set:k5,h3ToFeature:M5,h3SetToFeature:hV,h3SetToMultiPolygonFeature:AV,h3SetToFeatureCollection:fV},pV=dV,ka=function(e){e=e||{};var t=typeof e<"u"?e:{},n={},c;for(c in t)t.hasOwnProperty(c)&&(n[c]=t[c]);var g="";function x(De){return t.locateFile?t.locateFile(De,g):g+De}var S;typeof document<"u"&&document.currentScript&&(g=document.currentScript.src),g.indexOf("blob:")!==0?g=g.substr(0,g.lastIndexOf("/")+1):g="",S=function(Ge,At,kt){var o=new XMLHttpRequest;o.open("GET",Ge,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status==200||o.status==0&&o.response){At(o.response);return}var oi=dt(Ge);if(oi){At(oi.buffer);return}kt()},o.onerror=kt,o.send(null)};var a=t.print||console.log.bind(console),U=t.printErr||console.warn.bind(console);for(c in n)n.hasOwnProperty(c)&&(t[c]=n[c]);n=null,t.arguments&&t.arguments;var W=0,he=function(De){W=De},ae=function(){return W},ce=8;function be(De,Ge,At,kt){switch(At=At||"i8",At.charAt(At.length-1)==="*"&&(At="i32"),At){case"i1":bt[De>>0]=Ge;break;case"i8":bt[De>>0]=Ge;break;case"i16":$e[De>>1]=Ge;break;case"i32":pt[De>>2]=Ge;break;case"i64":pn=[Ge>>>0,(Gn=Ge,+xn(Gn)>=1?Gn>0?(rn(+Yt(Gn/4294967296),4294967295)|0)>>>0:~~+bn((Gn-+(~~Gn>>>0))/4294967296)>>>0:0)],pt[De>>2]=pn[0],pt[De+4>>2]=pn[1];break;case"float":ut[De>>2]=Ge;break;case"double":Nt[De>>3]=Ge;break;default:Ke("invalid type for setValue: "+At)}}function Je(De,Ge,At){switch(Ge=Ge||"i8",Ge.charAt(Ge.length-1)==="*"&&(Ge="i32"),Ge){case"i1":return bt[De>>0];case"i8":return bt[De>>0];case"i16":return $e[De>>1];case"i32":return pt[De>>2];case"i64":return pt[De>>2];case"float":return ut[De>>2];case"double":return Nt[De>>3];default:Ke("invalid type for getValue: "+Ge)}return null}var st=!1;function Ye(De,Ge){De||Ke("Assertion failed: "+Ge)}function it(De){var Ge=t["_"+De];return Ye(Ge,"Cannot call unknown function "+De+", make sure it is exported"),Ge}function ct(De,Ge,At,kt,o){var ke={string:function(bi){var Jt=0;if(bi!=null&&bi!==0){var wn=(bi.length<<2)+1;Jt=$(wn),at(bi,Jt,wn)}return Jt},array:function(bi){var Jt=$(bi.length);return _t(bi,Jt),Jt}};function oi(bi){return Ge==="string"?Oe(bi):Ge==="boolean"?!!bi:bi}var fi=it(De),Ai=[],ti=0;if(kt)for(var li=0;li<kt.length;li++){var Bi=ke[At[li]];Bi?(ti===0&&(ti=de()),Ai[li]=Bi(kt[li])):Ai[li]=kt[li]}var vi=fi.apply(null,Ai);return vi=oi(vi),ti!==0&&ie(ti),vi}function Tt(De,Ge,At,kt){At=At||[];var o=At.every(function(oi){return oi==="number"}),ke=Ge!=="string";return ke&&o&&!kt?it(De):function(){return ct(De,Ge,At,arguments)}}var zt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Rt(De,Ge,At){for(var kt=Ge+At,o=Ge;De[o]&&!(o>=kt);)++o;if(o-Ge>16&&De.subarray&&zt)return zt.decode(De.subarray(Ge,o));for(var ke="";Ge<o;){var oi=De[Ge++];if(!(oi&128)){ke+=String.fromCharCode(oi);continue}var fi=De[Ge++]&63;if((oi&224)==192){ke+=String.fromCharCode((oi&31)<<6|fi);continue}var Ai=De[Ge++]&63;if((oi&240)==224?oi=(oi&15)<<12|fi<<6|Ai:oi=(oi&7)<<18|fi<<12|Ai<<6|De[Ge++]&63,oi<65536)ke+=String.fromCharCode(oi);else{var ti=oi-65536;ke+=String.fromCharCode(55296|ti>>10,56320|ti&1023)}}return ke}function Oe(De,Ge){return De?Rt(lt,De,Ge):""}function jt(De,Ge,At,kt){if(!(kt>0))return 0;for(var o=At,ke=At+kt-1,oi=0;oi<De.length;++oi){var fi=De.charCodeAt(oi);if(fi>=55296&&fi<=57343){var Ai=De.charCodeAt(++oi);fi=65536+((fi&1023)<<10)|Ai&1023}if(fi<=127){if(At>=ke)break;Ge[At++]=fi}else if(fi<=2047){if(At+1>=ke)break;Ge[At++]=192|fi>>6,Ge[At++]=128|fi&63}else if(fi<=65535){if(At+2>=ke)break;Ge[At++]=224|fi>>12,Ge[At++]=128|fi>>6&63,Ge[At++]=128|fi&63}else{if(At+3>=ke)break;Ge[At++]=240|fi>>18,Ge[At++]=128|fi>>12&63,Ge[At++]=128|fi>>6&63,Ge[At++]=128|fi&63}}return Ge[At]=0,At-o}function at(De,Ge,At){return jt(De,lt,Ge,At)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function _t(De,Ge){bt.set(De,Ge)}function mt(De,Ge){return De%Ge>0&&(De+=Ge-De%Ge),De}var xt,bt,lt,$e,pt,ut,Nt;function Bt(De){xt=De,t.HEAP8=bt=new Int8Array(De),t.HEAP16=$e=new Int16Array(De),t.HEAP32=pt=new Int32Array(De),t.HEAPU8=lt=new Uint8Array(De),t.HEAPU16=new Uint16Array(De),t.HEAPU32=new Uint32Array(De),t.HEAPF32=ut=new Float32Array(De),t.HEAPF64=Nt=new Float64Array(De)}var Ot=5267040,gi=24128,Ii=t.TOTAL_MEMORY||33554432;t.buffer?xt=t.buffer:xt=new ArrayBuffer(Ii),Ii=xt.byteLength,Bt(xt),pt[gi>>2]=Ot;function Ci(De){for(;De.length>0;){var Ge=De.shift();if(typeof Ge=="function"){Ge();continue}var At=Ge.func;typeof At=="number"?Ge.arg===void 0?t.dynCall_v(At):t.dynCall_vi(At,Ge.arg):At(Ge.arg===void 0?null:Ge.arg)}}var Ri=[],Ki=[],Hi=[],Ni=[];function nn(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)zi(t.preRun.shift());Ci(Ri)}function vn(){Ci(Ki)}function Ei(){Ci(Hi)}function mi(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)Oi(t.postRun.shift());Ci(Ni)}function zi(De){Ri.unshift(De)}function Oi(De){Ni.unshift(De)}var xn=Math.abs,bn=Math.ceil,Yt=Math.floor,rn=Math.min,Xt=0,Ji=null;function mr(De){Xt++,t.monitorRunDependencies&&t.monitorRunDependencies(Xt)}function ci(De){if(Xt--,t.monitorRunDependencies&&t.monitorRunDependencies(Xt),Xt==0&&Ji){var Ge=Ji;Ji=null,Ge()}}t.preloadedImages={},t.preloadedAudios={};var sn=null,lr="data:application/octet-stream;base64,";function On(De){return String.prototype.startsWith?De.startsWith(lr):De.indexOf(lr)===0}var Gn,pn;sn="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var v=24144;function k(De){return De}function V(De){var Ge=/\b__Z[\w\d_]+/g;return De.replace(Ge,function(At){var kt=At;return At===kt?At:kt+" ["+At+"]"})}function Y(){var De=new Error;if(!De.stack){try{throw new Error(0)}catch(Ge){De=Ge}if(!De.stack)return"(no stack trace available)"}return De.stack.toString()}function te(){var De=Y();return t.extraStackTrace&&(De+=`
`+t.extraStackTrace()),V(De)}function fe(De,Ge,At,kt){Ke("Assertion failed: "+Oe(De)+", at: "+[Ge?Oe(Ge):"unknown filename",At,kt?Oe(kt):"unknown function"])}function ve(){return bt.length}function Ie(De,Ge,At){lt.set(lt.subarray(Ge,Ge+At),De)}function Ee(De){return t.___errno_location&&(pt[t.___errno_location()>>2]=De),De}function ze(De){Ke("OOM")}function Qe(De){try{var Ge=new ArrayBuffer(De);return Ge.byteLength!=De?void 0:(new Int8Array(Ge).set(bt),ne(Ge),Bt(Ge),1)}catch{}}function He(De){var Ge=ve(),At=16777216,kt=2147483648-At;if(De>kt)return!1;for(var o=16777216,ke=Math.max(Ge,o);ke<De;)ke<=536870912?ke=mt(2*ke,At):ke=Math.min(mt((3*ke+2147483648)/4,At),kt);var oi=Qe(ke);return!!oi}var Ze=typeof atob=="function"?atob:function(De){var Ge="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",At="",kt,o,ke,oi,fi,Ai,ti,li=0;De=De.replace(/[^A-Za-z0-9\+\/\=]/g,"");do oi=Ge.indexOf(De.charAt(li++)),fi=Ge.indexOf(De.charAt(li++)),Ai=Ge.indexOf(De.charAt(li++)),ti=Ge.indexOf(De.charAt(li++)),kt=oi<<2|fi>>4,o=(fi&15)<<4|Ai>>2,ke=(Ai&3)<<6|ti,At=At+String.fromCharCode(kt),Ai!==64&&(At=At+String.fromCharCode(o)),ti!==64&&(At=At+String.fromCharCode(ke));while(li<De.length);return At};function Ue(De){try{for(var Ge=Ze(De),At=new Uint8Array(Ge.length),kt=0;kt<Ge.length;++kt)At[kt]=Ge.charCodeAt(kt);return At}catch{throw new Error("Converting base64 string to bytes failed.")}}function dt(De){if(On(De))return Ue(De.slice(lr.length))}var rt={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Me={a:Ke,b:he,c:ae,d:fe,e:Ee,f:ve,g:Ie,h:He,i:ze,j:k,k:V,l:Qe,m:Y,n:te,o:v,p:gi},se=function(De,Ge,At){"almost asm";var kt=new De.Int8Array(At),o=new De.Int32Array(At);new De.Uint8Array(At),new De.Float32Array(At);var ke=new De.Float64Array(At),oi=Ge.o|0,fi=Ge.p|0,Ai=De.Math.floor,ti=De.Math.abs,li=De.Math.sqrt,Bi=De.Math.pow,vi=De.Math.cos,bi=De.Math.sin,Jt=De.Math.tan,wn=De.Math.acos,ar=De.Math.asin,mn=De.Math.atan,Hn=De.Math.atan2,jr=De.Math.ceil,ji=De.Math.imul,ur=De.Math.min,Vn=De.Math.max,Wt=De.Math.clz32,Yi=Ge.b,Ut=Ge.c,Tn=Ge.d,cr=Ge.e,Vs=Ge.f,Ur=Ge.g,Vt=Ge.h,hr=Ge.i,Dt=24160;function Fr(i){return kt=new Int8Array(i),o=new Int32Array(i),ke=new Float64Array(i),At=i,!0}function Us(i){i=i|0;var r=0;return r=Dt,Dt=Dt+i|0,Dt=Dt+15&-16,r|0}function ca(){return Dt|0}function Dr(i){i=i|0,Dt=i}function Ua(i,r){i=i|0,Dt=i}function Fo(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;return(i|0)<0?(r=2,r|0):(i|0)>13780509?(r=or(15,r)|0,r|0):(l=((i|0)<0)<<31>>31,_=We(i|0,l|0,3,0)|0,d=Ut()|0,l=z(i|0,l|0,1,0)|0,l=We(_|0,d|0,l|0,Ut()|0)|0,l=z(l|0,Ut()|0,1,0)|0,i=Ut()|0,o[r>>2]=l,o[r+4>>2]=i,r=0,r|0)}function Ga(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,Xs(i,r,l,d,0)|0}function Xs(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0;if(j=Dt,Dt=Dt+16|0,T=j,!(Qn(i,r,l,d,_)|0))return d=0,Dt=j,d|0;do if((l|0)>=0){if((l|0)>13780509){if(w=or(15,T)|0,w|0)break;B=T,T=o[B>>2]|0,B=o[B+4>>2]|0}else w=((l|0)<0)<<31>>31,X=We(l|0,w|0,3,0)|0,B=Ut()|0,w=z(l|0,w|0,1,0)|0,w=We(X|0,B|0,w|0,Ut()|0)|0,w=z(w|0,Ut()|0,1,0)|0,B=Ut()|0,o[T>>2]=w,o[T+4>>2]=B,T=w;if(O(d|0,0,T<<3|0)|0,_|0){O(_|0,0,T<<2|0)|0,w=aa(i,r,l,d,_,T,B,0)|0;break}w=D(T,4)|0,w?(X=aa(i,r,l,d,w,T,B,0)|0,C(w),w=X):w=13}else w=2;while(!1);return X=w,Dt=j,X|0}function Qn(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0,et=0;if(et=Dt,Dt=Dt+16|0,Re=et,Be=et+8|0,Te=Re,o[Te>>2]=i,o[Te+4>>2]=r,(l|0)<0)return Be=2,Dt=et,Be|0;if(w=d,o[w>>2]=i,o[w+4>>2]=r,w=(_|0)!=0,w&&(o[_>>2]=0),Mr(i,r)|0)return Be=9,Dt=et,Be|0;o[Be>>2]=0;e:do if((l|0)>=1)if(w)for(ue=1,X=0,Se=0,Te=1,w=i;;){if(!(X|Se)){if(w=hs(w,r,4,Be,Re)|0,w|0)break e;if(r=Re,w=o[r>>2]|0,r=o[r+4>>2]|0,Mr(w,r)|0){w=9;break e}}if(w=hs(w,r,o[22384+(Se<<2)>>2]|0,Be,Re)|0,w|0)break e;if(r=Re,w=o[r>>2]|0,r=o[r+4>>2]|0,i=d+(ue<<3)|0,o[i>>2]=w,o[i+4>>2]=r,o[_+(ue<<2)>>2]=Te,i=X+1|0,T=(i|0)==(Te|0),B=Se+1|0,j=(B|0)==6,Mr(w,r)|0){w=9;break e}if(Te=Te+(j&T&1)|0,(Te|0)>(l|0)){w=0;break}else ue=ue+1|0,X=T?0:i,Se=T?j?0:B:Se}else for(ue=1,X=0,Se=0,Te=1,w=i;;){if(!(X|Se)){if(w=hs(w,r,4,Be,Re)|0,w|0)break e;if(r=Re,w=o[r>>2]|0,r=o[r+4>>2]|0,Mr(w,r)|0){w=9;break e}}if(w=hs(w,r,o[22384+(Se<<2)>>2]|0,Be,Re)|0,w|0)break e;if(r=Re,w=o[r>>2]|0,r=o[r+4>>2]|0,i=d+(ue<<3)|0,o[i>>2]=w,o[i+4>>2]=r,i=X+1|0,T=(i|0)==(Te|0),B=Se+1|0,j=(B|0)==6,Mr(w,r)|0){w=9;break e}if(Te=Te+(j&T&1)|0,(Te|0)>(l|0)){w=0;break}else ue=ue+1|0,X=T?0:i,Se=T?j?0:B:Se}else w=0;while(!1);return Be=w,Dt=et,Be|0}function aa(i,r,l,d,_,w,T,B){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0,T=T|0,B=B|0;var j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0,et=0,vt=0,ot=0;if(et=Dt,Dt=Dt+16|0,Re=et+8|0,Be=et,j=Ct(i|0,r|0,w|0,T|0)|0,ue=Ut()|0,Se=d+(j<<3)|0,vt=Se,ot=o[vt>>2]|0,vt=o[vt+4>>2]|0,X=(ot|0)==(i|0)&(vt|0)==(r|0),!((ot|0)==0&(vt|0)==0|X))do j=z(j|0,ue|0,1,0)|0,j=yt(j|0,Ut()|0,w|0,T|0)|0,ue=Ut()|0,Se=d+(j<<3)|0,ot=Se,vt=o[ot>>2]|0,ot=o[ot+4>>2]|0,X=(vt|0)==(i|0)&(ot|0)==(r|0);while(!((vt|0)==0&(ot|0)==0|X));if(j=_+(j<<2)|0,X&&(o[j>>2]|0)<=(B|0)||(ot=Se,o[ot>>2]=i,o[ot+4>>2]=r,o[j>>2]=B,(B|0)>=(l|0)))return ot=0,Dt=et,ot|0;switch(X=B+1|0,o[Re>>2]=0,j=hs(i,r,2,Re,Be)|0,j|0){case 9:{Te=9;break}case 0:{j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,X)|0,j||(Te=9);break}}e:do if((Te|0)==9){switch(o[Re>>2]=0,j=hs(i,r,3,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,X)|0,j|0)break e;break}default:break e}switch(o[Re>>2]=0,j=hs(i,r,1,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,X)|0,j|0)break e;break}default:break e}switch(o[Re>>2]=0,j=hs(i,r,5,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,X)|0,j|0)break e;break}default:break e}switch(o[Re>>2]=0,j=hs(i,r,4,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,X)|0,j|0)break e;break}default:break e}switch(o[Re>>2]=0,j=hs(i,r,6,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,X)|0,j|0)break e;break}default:break e}return ot=0,Dt=et,ot|0}while(!1);return ot=j,Dt=et,ot|0}function hs(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0;if(l>>>0>6)return _=1,_|0;if(Se=(o[d>>2]|0)%6|0,o[d>>2]=Se,(Se|0)>0){w=0;do l=Ma(l)|0,w=w+1|0;while((w|0)<(o[d>>2]|0))}if(Se=Gt(i|0,r|0,45)|0,Ut()|0,ue=Se&127,ue>>>0>121)return _=5,_|0;j=Ia(i,r)|0,w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15;e:do if(!w)X=8;else{for(;;){if(T=(15-w|0)*3|0,B=Gt(i|0,r|0,T|0)|0,Ut()|0,B=B&7,(B|0)==7){r=5;break}if(Be=(qs(w)|0)==0,w=w+-1|0,Te=Zt(7,0,T|0)|0,r=r&~(Ut()|0),Re=Zt(o[(Be?432:16)+(B*28|0)+(l<<2)>>2]|0,0,T|0)|0,T=Ut()|0,l=o[(Be?640:224)+(B*28|0)+(l<<2)>>2]|0,i=Re|i&~Te,r=T|r,!l){l=0;break e}if(!w){X=8;break e}}return r|0}while(!1);(X|0)==8&&(Be=o[848+(ue*28|0)+(l<<2)>>2]|0,Re=Zt(Be|0,0,45)|0,i=Re|i,r=Ut()|0|r&-1040385,l=o[4272+(ue*28|0)+(l<<2)>>2]|0,(Be&127|0)==127&&(Be=Zt(o[848+(ue*28|0)+20>>2]|0,0,45)|0,r=Ut()|0|r&-1040385,l=o[4272+(ue*28|0)+20>>2]|0,i=Do(Be|i,r)|0,r=Ut()|0,o[d>>2]=(o[d>>2]|0)+1)),B=Gt(i|0,r|0,45)|0,Ut()|0,B=B&127;e:do if(nt(B)|0){t:do if((Ia(i,r)|0)==1){if((ue|0)!=(B|0))if(dn(B,o[7696+(ue*28|0)>>2]|0)|0){i=go(i,r)|0,T=1,r=Ut()|0;break}else Tn(23313,22416,436,22424);switch(j|0){case 3:{i=Do(i,r)|0,r=Ut()|0,o[d>>2]=(o[d>>2]|0)+1,T=0;break t}case 5:{i=go(i,r)|0,r=Ut()|0,o[d>>2]=(o[d>>2]|0)+5,T=0;break t}case 0:return Be=9,Be|0;default:return Be=1,Be|0}}else T=0;while(!1);if((l|0)>0){w=0;do i=Tl(i,r)|0,r=Ut()|0,w=w+1|0;while((w|0)!=(l|0))}if((ue|0)!=(B|0)){if(!(It(B)|0)){if((T|0)!=0|(Ia(i,r)|0)!=5)break;o[d>>2]=(o[d>>2]|0)+1;break}switch(Se&127){case 8:case 118:break e}(Ia(i,r)|0)!=3&&(o[d>>2]=(o[d>>2]|0)+1)}}else if((l|0)>0){w=0;do i=Do(i,r)|0,r=Ut()|0,w=w+1|0;while((w|0)!=(l|0))}while(!1);return o[d>>2]=((o[d>>2]|0)+l|0)%6|0,Be=_,o[Be>>2]=i,o[Be+4>>2]=r,Be=0,Be|0}function qa(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0;for(B=Dt,Dt=Dt+16|0,w=B,T=B+8|0,_=(Mr(i,r)|0)==0,_=_?1:2;;){if(o[T>>2]=0,X=(hs(i,r,_,T,w)|0)==0,j=w,X&((o[j>>2]|0)==(l|0)?(o[j+4>>2]|0)==(d|0):0)){i=4;break}if(_=_+1|0,_>>>0>=7){_=7,i=4;break}}return(i|0)==4?(Dt=B,_|0):0}function al(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0;if(Be=Dt,Dt=Dt+16|0,Te=Be,Re=Be+8|0,Se=Te,o[Se>>2]=i,o[Se+4>>2]=r,!l)return Re=d,o[Re>>2]=i,o[Re+4>>2]=r,Re=0,Dt=Be,Re|0;o[Re>>2]=0;e:do if(Mr(i,r)|0)i=9;else{if(w=(l|0)>0,w){_=0,Se=i;do{if(i=hs(Se,r,4,Re,Te)|0,i|0)break e;if(r=Te,Se=o[r>>2]|0,r=o[r+4>>2]|0,_=_+1|0,Mr(Se,r)|0){i=9;break e}}while((_|0)<(l|0));if(ue=d,o[ue>>2]=Se,o[ue+4>>2]=r,ue=l+-1|0,w){X=0,i=1;do{if(_=22384+(X<<2)|0,(X|0)==5)for(T=o[_>>2]|0,w=0,_=i;;){if(i=Te,i=hs(o[i>>2]|0,o[i+4>>2]|0,T,Re,Te)|0,i|0)break e;if((w|0)!=(ue|0))if(j=Te,B=o[j>>2]|0,j=o[j+4>>2]|0,i=d+(_<<3)|0,o[i>>2]=B,o[i+4>>2]=j,!(Mr(B,j)|0))i=_+1|0;else{i=9;break e}else i=_;if(w=w+1|0,(w|0)>=(l|0))break;_=i}else for(T=Te,j=o[_>>2]|0,B=0,_=i,w=o[T>>2]|0,T=o[T+4>>2]|0;;){if(i=hs(w,T,j,Re,Te)|0,i|0)break e;if(T=Te,w=o[T>>2]|0,T=o[T+4>>2]|0,i=d+(_<<3)|0,o[i>>2]=w,o[i+4>>2]=T,i=_+1|0,Mr(w,T)|0){i=9;break e}if(B=B+1|0,(B|0)>=(l|0))break;_=i}X=X+1|0}while(X>>>0<6);i=Te,T=Se,_=o[i>>2]|0,w=r,i=o[i+4>>2]|0}else T=Se,_=Se,w=r,i=r}else T=d,o[T>>2]=i,o[T+4>>2]=r,T=i,_=i,w=r,i=r;i=(T|0)==(_|0)&(w|0)==(i|0)?0:9}while(!1);return Re=i,Dt=Be,Re|0}function ol(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0;if(B=Dt,Dt=Dt+48|0,_=B+16|0,w=B+8|0,T=B,l|0)return T=15,Dt=B,T|0;if(X=i,j=o[X+4>>2]|0,l=w,o[l>>2]=o[X>>2],o[l+4>>2]=j,Ou(w,_),r=pl(_,r,T)|0,!r){if(l=o[w>>2]|0,w=o[i+8>>2]|0,(w|0)>0){_=o[i+12>>2]|0,r=0;do l=(o[_+(r<<3)>>2]|0)+l|0,r=r+1|0;while((r|0)<(w|0))}r=T,_=o[r>>2]|0,r=o[r+4>>2]|0,w=((l|0)<0)<<31>>31,(r|0)<(w|0)|(r|0)==(w|0)&_>>>0<l>>>0?(r=T,o[r>>2]=l,o[r+4>>2]=w,r=w):l=_,j=z(l|0,r|0,12,0)|0,X=Ut()|0,r=T,o[r>>2]=j,o[r+4>>2]=X,r=d,o[r>>2]=j,o[r+4>>2]=X,r=0}return X=r,Dt=B,X|0}function no(i,r,l,d,_,w,T){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0,T=T|0;var B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0,et=0,vt=0,ot=0,ht=0,Et=0,wt=0,si=0,Kt=0,ii=0,ai=0,Zi=0,Qi=0,Si=0,Ui=0,Gi=0,un=0,Bn=0,en=0,kn=0,vr=0,er=0;if(Bn=Dt,Dt=Dt+64|0,Si=Bn+48|0,Ui=Bn+32|0,Gi=Bn+24|0,si=Bn+8|0,Kt=Bn,j=o[i>>2]|0,(j|0)<=0)return un=0,Dt=Bn,un|0;for(ii=i+4|0,ai=Si+8|0,Zi=Ui+8|0,Qi=si+8|0,B=0,Et=0;;){X=o[ii>>2]|0,ht=X+(Et<<4)|0,o[Si>>2]=o[ht>>2],o[Si+4>>2]=o[ht+4>>2],o[Si+8>>2]=o[ht+8>>2],o[Si+12>>2]=o[ht+12>>2],(Et|0)==(j+-1|0)?(o[Ui>>2]=o[X>>2],o[Ui+4>>2]=o[X+4>>2],o[Ui+8>>2]=o[X+8>>2],o[Ui+12>>2]=o[X+12>>2]):(ht=X+(Et+1<<4)|0,o[Ui>>2]=o[ht>>2],o[Ui+4>>2]=o[ht+4>>2],o[Ui+8>>2]=o[ht+8>>2],o[Ui+12>>2]=o[ht+12>>2]),j=Gr(Si,Ui,d,Gi)|0;e:do if(j)X=0,B=j;else if(X=Gi,j=o[X>>2]|0,X=o[X+4>>2]|0,(X|0)>0|(X|0)==0&j>>>0>0){ot=0,ht=0;t:for(;;){if(er=+ke[Si>>3],vt=R(j|0,X|0,ot|0,ht|0)|0,vr=+(vt>>>0)+4294967296*+(Ut()|0),en=+(j>>>0)+4294967296*+(X|0),kn=+(ot>>>0)+4294967296*+(ht|0),ke[si>>3]=er*vr/en+ +ke[Ui>>3]*kn/en,ke[Qi>>3]=+ke[ai>>3]*vr/en+ +ke[Zi>>3]*kn/en,j=Ya(si,d,Kt)|0,j|0){B=j;break}vt=Kt,et=o[vt>>2]|0,vt=o[vt+4>>2]|0,Te=Ct(et|0,vt|0,r|0,l|0)|0,ue=Ut()|0,j=T+(Te<<3)|0,Se=j,X=o[Se>>2]|0,Se=o[Se+4>>2]|0;i:do if((X|0)==0&(Se|0)==0)wt=j,un=16;else for(Re=0,Be=0;;){if((Re|0)>(l|0)|(Re|0)==(l|0)&Be>>>0>r>>>0){B=1;break t}if((X|0)==(et|0)&(Se|0)==(vt|0))break i;if(j=z(Te|0,ue|0,1,0)|0,Te=yt(j|0,Ut()|0,r|0,l|0)|0,ue=Ut()|0,Be=z(Be|0,Re|0,1,0)|0,Re=Ut()|0,j=T+(Te<<3)|0,Se=j,X=o[Se>>2]|0,Se=o[Se+4>>2]|0,(X|0)==0&(Se|0)==0){wt=j,un=16;break}}while(!1);if((un|0)==16&&(un=0,!((et|0)==0&(vt|0)==0))&&(Be=wt,o[Be>>2]=et,o[Be+4>>2]=vt,Be=w+(o[_>>2]<<3)|0,o[Be>>2]=et,o[Be+4>>2]=vt,Be=_,Be=z(o[Be>>2]|0,o[Be+4>>2]|0,1,0)|0,et=Ut()|0,vt=_,o[vt>>2]=Be,o[vt+4>>2]=et),ot=z(ot|0,ht|0,1,0)|0,ht=Ut()|0,X=Gi,j=o[X>>2]|0,X=o[X+4>>2]|0,!((X|0)>(ht|0)|(X|0)==(ht|0)&j>>>0>ot>>>0)){X=1;break e}}X=0}else X=1;while(!1);if(Et=Et+1|0,!X){un=21;break}if(j=o[i>>2]|0,(Et|0)>=(j|0)){B=0,un=21;break}}return(un|0)==21?(Dt=Bn,B|0):0}function Ha(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0,et=0,vt=0,ot=0,ht=0,Et=0,wt=0,si=0,Kt=0,ii=0,ai=0,Zi=0,Qi=0,Si=0,Ui=0,Gi=0,un=0,Bn=0,en=0,kn=0,vr=0;if(vr=Dt,Dt=Dt+112|0,un=vr+80|0,j=vr+72|0,Bn=vr,en=vr+56|0,l|0)return kn=15,Dt=vr,kn|0;if(X=i+8|0,kn=Ds((o[X>>2]<<5)+32|0)|0,!kn)return kn=13,Dt=vr,kn|0;if(Vl(i,kn),Ui=i,Gi=o[Ui+4>>2]|0,l=j,o[l>>2]=o[Ui>>2],o[l+4>>2]=Gi,Ou(j,un),l=pl(un,r,Bn)|0,l)Ui=0,Gi=0;else{if(l=o[j>>2]|0,w=o[X>>2]|0,(w|0)>0){T=o[i+12>>2]|0,_=0;do l=(o[T+(_<<3)>>2]|0)+l|0,_=_+1|0;while((_|0)!=(w|0));_=l}else _=l;l=Bn,w=o[l>>2]|0,l=o[l+4>>2]|0,T=((_|0)<0)<<31>>31,(l|0)<(T|0)|(l|0)==(T|0)&w>>>0<_>>>0?(l=Bn,o[l>>2]=_,o[l+4>>2]=T,l=T):_=w,Ui=z(_|0,l|0,12,0)|0,Gi=Ut()|0,l=Bn,o[l>>2]=Ui,o[l+4>>2]=Gi,l=0}if(l|0)return C(kn),kn=l,Dt=vr,kn|0;if(_=D(Ui,8)|0,!_)return C(kn),kn=13,Dt=vr,kn|0;if(B=D(Ui,8)|0,!B)return C(kn),C(_),kn=13,Dt=vr,kn|0;Qi=un,o[Qi>>2]=0,o[Qi+4>>2]=0,Qi=i,Si=o[Qi+4>>2]|0,l=j,o[l>>2]=o[Qi>>2],o[l+4>>2]=Si,l=no(j,Ui,Gi,r,un,_,B)|0;e:do if(l)C(_),C(B),C(kn);else{t:do if((o[X>>2]|0)>0){for(T=i+12|0,w=0;l=no((o[T>>2]|0)+(w<<3)|0,Ui,Gi,r,un,_,B)|0,w=w+1|0,!(l|0);)if((w|0)>=(o[X>>2]|0))break t;C(_),C(B),C(kn);break e}while(!1);(Gi|0)>0|(Gi|0)==0&Ui>>>0>0&&O(B|0,0,Ui<<3|0)|0,Si=un,Qi=o[Si+4>>2]|0;t:do if((Qi|0)>0|(Qi|0)==0&(o[Si>>2]|0)>>>0>0){ii=_,ai=B,Zi=_,Qi=B,Si=_,l=_,wt=_,si=B,Kt=B,_=B;i:for(;;){for(vt=0,ot=0,ht=0,Et=0,w=0,T=0;;){B=Bn,j=B+56|0;do o[B>>2]=0,B=B+4|0;while((B|0)<(j|0));if(r=ii+(vt<<3)|0,X=o[r>>2]|0,r=o[r+4>>2]|0,Qn(X,r,1,Bn,0)|0){B=Bn,j=B+56|0;do o[B>>2]=0,B=B+4|0;while((B|0)<(j|0));B=D(7,4)|0,B|0&&(aa(X,r,1,Bn,B,7,0,0)|0,C(B))}for(et=0;;){Be=Bn+(et<<3)|0,Re=o[Be>>2]|0,Be=o[Be+4>>2]|0;n:do if((Re|0)==0&(Be|0)==0)B=w,j=T;else{if(ue=Ct(Re|0,Be|0,Ui|0,Gi|0)|0,X=Ut()|0,B=d+(ue<<3)|0,r=B,j=o[r>>2]|0,r=o[r+4>>2]|0,!((j|0)==0&(r|0)==0)){Se=0,Te=0;do{if((Se|0)>(Gi|0)|(Se|0)==(Gi|0)&Te>>>0>Ui>>>0)break i;if((j|0)==(Re|0)&(r|0)==(Be|0)){B=w,j=T;break n}B=z(ue|0,X|0,1,0)|0,ue=yt(B|0,Ut()|0,Ui|0,Gi|0)|0,X=Ut()|0,Te=z(Te|0,Se|0,1,0)|0,Se=Ut()|0,B=d+(ue<<3)|0,r=B,j=o[r>>2]|0,r=o[r+4>>2]|0}while(!((j|0)==0&(r|0)==0))}(Re|0)==0&(Be|0)==0?(B=w,j=T):(gr(Re,Be,en)|0,yl(i,kn,en)|0&&(Te=z(w|0,T|0,1,0)|0,T=Ut()|0,Se=B,o[Se>>2]=Re,o[Se+4>>2]=Be,w=ai+(w<<3)|0,o[w>>2]=Re,o[w+4>>2]=Be,w=Te),B=w,j=T)}while(!1);if(et=et+1|0,et>>>0>=7)break;w=B,T=j}if(vt=z(vt|0,ot|0,1,0)|0,ot=Ut()|0,ht=z(ht|0,Et|0,1,0)|0,Et=Ut()|0,T=un,w=o[T>>2]|0,T=o[T+4>>2]|0,(Et|0)<(T|0)|(Et|0)==(T|0)&ht>>>0<w>>>0)w=B,T=j;else break}if((T|0)>0|(T|0)==0&w>>>0>0){w=0,T=0;do Et=ii+(w<<3)|0,o[Et>>2]=0,o[Et+4>>2]=0,w=z(w|0,T|0,1,0)|0,T=Ut()|0,Et=un,ht=o[Et+4>>2]|0;while((T|0)<(ht|0)|((T|0)==(ht|0)?w>>>0<(o[Et>>2]|0)>>>0:0))}if(Et=un,o[Et>>2]=B,o[Et+4>>2]=j,(j|0)>0|(j|0)==0&B>>>0>0)et=_,vt=Kt,ot=Si,ht=si,Et=ai,_=wt,Kt=l,si=Zi,wt=et,l=vt,Si=Qi,Qi=ot,Zi=ht,ai=ii,ii=Et;else break t}C(Zi),C(Qi),C(kn),l=1;break e}else l=B;while(!1);C(kn),C(_),C(l),l=0}while(!1);return kn=l,Dt=vr,kn|0}function N(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ue=0;if(ue=Dt,Dt=Dt+176|0,j=ue,(r|0)<1)return yu(l,0,0),X=0,Dt=ue,X|0;for(B=i,B=Gt(o[B>>2]|0,o[B+4>>2]|0,52)|0,Ut()|0,yu(l,(r|0)>6?r:6,B&15),B=0;d=i+(B<<3)|0,d=Nr(o[d>>2]|0,o[d+4>>2]|0,j)|0,!(d|0);){if(d=o[j>>2]|0,(d|0)>0){T=0;do w=j+8+(T<<4)|0,T=T+1|0,d=j+8+(((T|0)%(d|0)|0)<<4)|0,_=ws(l,d,w)|0,_?ki(l,_)|0:Li(l,w,d)|0,d=o[j>>2]|0;while((T|0)<(d|0))}if(B=B+1|0,(B|0)>=(r|0)){d=0,X=13;break}}return(X|0)==13?(Dt=ue,d|0):(bs(l),X=d,Dt=ue,X|0)}function xe(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;if(w=Dt,Dt=Dt+32|0,d=w,_=w+16|0,i=N(i,r,_)|0,i|0)return l=i,Dt=w,l|0;if(o[l>>2]=0,o[l+4>>2]=0,o[l+8>>2]=0,i=Lo(_)|0,i|0)do{r=$u(l)|0;do Fu(r,i)|0,T=i+16|0,o[d>>2]=o[T>>2],o[d+4>>2]=o[T+4>>2],o[d+8>>2]=o[T+8>>2],o[d+12>>2]=o[T+12>>2],ki(_,i)|0,i=vu(_,d)|0;while(i|0);i=Lo(_)|0}while(i|0);return bs(_),i=Ml(l)|0,i?(vo(l),T=i,Dt=w,T|0):(T=0,Dt=w,T|0)}function nt(i){return i=i|0,i>>>0>121?(i=0,i|0):(i=o[7696+(i*28|0)+16>>2]|0,i|0)}function It(i){return i=i|0,(i|0)==4|(i|0)==117|0}function $t(i){return i=i|0,o[11120+((o[i>>2]|0)*216|0)+((o[i+4>>2]|0)*72|0)+((o[i+8>>2]|0)*24|0)+(o[i+12>>2]<<3)>>2]|0}function wi(i){return i=i|0,o[11120+((o[i>>2]|0)*216|0)+((o[i+4>>2]|0)*72|0)+((o[i+8>>2]|0)*24|0)+(o[i+12>>2]<<3)+4>>2]|0}function Di(i,r){i=i|0,r=r|0,i=7696+(i*28|0)|0,o[r>>2]=o[i>>2],o[r+4>>2]=o[i+4>>2],o[r+8>>2]=o[i+8>>2],o[r+12>>2]=o[i+12>>2]}function hn(i,r){i=i|0,r=r|0;var l=0,d=0;if(r>>>0>20)return r=-1,r|0;do if((o[11120+(r*216|0)>>2]|0)!=(i|0))if((o[11120+(r*216|0)+8>>2]|0)!=(i|0))if((o[11120+(r*216|0)+16>>2]|0)!=(i|0))if((o[11120+(r*216|0)+24>>2]|0)!=(i|0))if((o[11120+(r*216|0)+32>>2]|0)!=(i|0))if((o[11120+(r*216|0)+40>>2]|0)!=(i|0))if((o[11120+(r*216|0)+48>>2]|0)!=(i|0))if((o[11120+(r*216|0)+56>>2]|0)!=(i|0))if((o[11120+(r*216|0)+64>>2]|0)!=(i|0))if((o[11120+(r*216|0)+72>>2]|0)!=(i|0))if((o[11120+(r*216|0)+80>>2]|0)!=(i|0))if((o[11120+(r*216|0)+88>>2]|0)!=(i|0))if((o[11120+(r*216|0)+96>>2]|0)!=(i|0))if((o[11120+(r*216|0)+104>>2]|0)!=(i|0))if((o[11120+(r*216|0)+112>>2]|0)!=(i|0))if((o[11120+(r*216|0)+120>>2]|0)!=(i|0))if((o[11120+(r*216|0)+128>>2]|0)!=(i|0))if((o[11120+(r*216|0)+136>>2]|0)==(i|0))i=2,l=1,d=2;else{if((o[11120+(r*216|0)+144>>2]|0)==(i|0)){i=0,l=2,d=0;break}if((o[11120+(r*216|0)+152>>2]|0)==(i|0)){i=0,l=2,d=1;break}if((o[11120+(r*216|0)+160>>2]|0)==(i|0)){i=0,l=2,d=2;break}if((o[11120+(r*216|0)+168>>2]|0)==(i|0)){i=1,l=2,d=0;break}if((o[11120+(r*216|0)+176>>2]|0)==(i|0)){i=1,l=2,d=1;break}if((o[11120+(r*216|0)+184>>2]|0)==(i|0)){i=1,l=2,d=2;break}if((o[11120+(r*216|0)+192>>2]|0)==(i|0)){i=2,l=2,d=0;break}if((o[11120+(r*216|0)+200>>2]|0)==(i|0)){i=2,l=2,d=1;break}if((o[11120+(r*216|0)+208>>2]|0)==(i|0)){i=2,l=2,d=2;break}else i=-1;return i|0}else i=2,l=1,d=1;else i=2,l=1,d=0;else i=1,l=1,d=2;else i=1,l=1,d=1;else i=1,l=1,d=0;else i=0,l=1,d=2;else i=0,l=1,d=1;else i=0,l=1,d=0;else i=2,l=0,d=2;else i=2,l=0,d=1;else i=2,l=0,d=0;else i=1,l=0,d=2;else i=1,l=0,d=1;else i=1,l=0,d=0;else i=0,l=0,d=2;else i=0,l=0,d=1;else i=0,l=0,d=0;while(!1);return r=o[11120+(r*216|0)+(l*72|0)+(i*24|0)+(d<<3)+4>>2]|0,r|0}function dn(i,r){return i=i|0,r=r|0,(o[7696+(i*28|0)+20>>2]|0)==(r|0)?(r=1,r|0):(r=(o[7696+(i*28|0)+24>>2]|0)==(r|0),r|0)}function rr(i,r){return i=i|0,r=r|0,o[848+(i*28|0)+(r<<2)>>2]|0}function Ar(i,r){return i=i|0,r=r|0,(o[848+(i*28|0)>>2]|0)==(r|0)?(r=0,r|0):(o[848+(i*28|0)+4>>2]|0)==(r|0)?(r=1,r|0):(o[848+(i*28|0)+8>>2]|0)==(r|0)?(r=2,r|0):(o[848+(i*28|0)+12>>2]|0)==(r|0)?(r=3,r|0):(o[848+(i*28|0)+16>>2]|0)==(r|0)?(r=4,r|0):(o[848+(i*28|0)+20>>2]|0)==(r|0)?(r=5,r|0):((o[848+(i*28|0)+24>>2]|0)==(r|0)?6:7)|0}function Or(){return 122}function ja(i){i=i|0;var r=0,l=0,d=0;r=0;do Zt(r|0,0,45)|0,d=Ut()|0|134225919,l=i+(r<<3)|0,o[l>>2]=-1,o[l+4>>2]=d,r=r+1|0;while((r|0)!=122);return 0}function Za(i){return i=i|0,+ke[i+16>>3]<+ke[i+24>>3]|0}function Qa(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;return l=+ke[r>>3],!(l>=+ke[i+8>>3])||!(l<=+ke[i>>3])?(r=0,r|0):(d=+ke[i+16>>3],l=+ke[i+24>>3],_=+ke[r+8>>3],r=_>=l,i=_<=d&1,d<l?r&&(i=1):r||(i=0),r=(i|0)!=0,r|0)}function pl(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0,et=0,vt=0;Be=Dt,Dt=Dt+288|0,ue=Be+264|0,Se=Be+96|0,X=Be,B=X,j=B+96|0;do o[B>>2]=0,B=B+4|0;while((B|0)<(j|0));return r=Ea(r,X)|0,r|0?(Re=r,Dt=Be,Re|0):(j=X,X=o[j>>2]|0,j=o[j+4>>2]|0,gr(X,j,ue)|0,Nr(X,j,Se)|0,T=+Vi(ue,Se+8|0),ke[ue>>3]=+ke[i>>3],j=ue+8|0,ke[j>>3]=+ke[i+16>>3],ke[Se>>3]=+ke[i+8>>3],X=Se+8|0,ke[X>>3]=+ke[i+24>>3],_=+Vi(ue,Se),vt=+ke[j>>3]-+ke[X>>3],w=+ti(+vt),et=+ke[ue>>3]-+ke[Se>>3],d=+ti(+et),!(vt==0|et==0)&&(vt=+Z(+w,+d),vt=+jr(+(_*_/+A(+(vt/+A(+w,+d)),3)/(T*(T*2.59807621135)*.8))),ke[oi>>3]=vt,Te=~~vt>>>0,Re=+ti(vt)>=1?vt>0?~~+ur(+Ai(vt/4294967296),4294967295)>>>0:~~+jr((vt-+(~~vt>>>0))/4294967296)>>>0:0,(o[oi+4>>2]&2146435072|0)!=2146435072)?(Se=(Te|0)==0&(Re|0)==0,r=l,o[r>>2]=Se?1:Te,o[r+4>>2]=Se?0:Re,r=0):r=1,Re=r,Dt=Be,Re|0)}function Gr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0,ue=0;X=Dt,Dt=Dt+288|0,T=X+264|0,B=X+96|0,j=X,_=j,w=_+96|0;do o[_>>2]=0,_=_+4|0;while((_|0)<(w|0));return l=Ea(l,j)|0,l|0?(d=l,Dt=X,d|0):(l=j,_=o[l>>2]|0,l=o[l+4>>2]|0,gr(_,l,T)|0,Nr(_,l,B)|0,ue=+Vi(T,B+8|0),ue=+jr(+(+Vi(i,r)/(ue*2))),ke[oi>>3]=ue,l=~~ue>>>0,_=+ti(ue)>=1?ue>0?~~+ur(+Ai(ue/4294967296),4294967295)>>>0:~~+jr((ue-+(~~ue>>>0))/4294967296)>>>0:0,(o[oi+4>>2]&2146435072|0)==2146435072?(d=1,Dt=X,d|0):(j=(l|0)==0&(_|0)==0,o[d>>2]=j?1:l,o[d+4>>2]=j?0:_,d=0,Dt=X,d|0))}function ir(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0,o[i>>2]=r,o[i+4>>2]=l,o[i+8>>2]=d}function Er(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0;Se=r+8|0,o[Se>>2]=0,j=+ke[i>>3],T=+ti(+j),X=+ke[i+8>>3],B=+ti(+X)/.8660254037844386,T=T+B*.5,l=~~T,i=~~B,T=T-+(l|0),B=B-+(i|0);do if(T<.5)if(T<.3333333333333333)if(o[r>>2]=l,B<(T+1)*.5){o[r+4>>2]=i;break}else{i=i+1|0,o[r+4>>2]=i;break}else if(Te=1-T,i=(!(B<Te)&1)+i|0,o[r+4>>2]=i,Te<=B&B<T*2){l=l+1|0,o[r>>2]=l;break}else{o[r>>2]=l;break}else{if(!(T<.6666666666666666))if(l=l+1|0,o[r>>2]=l,B<T*.5){o[r+4>>2]=i;break}else{i=i+1|0,o[r+4>>2]=i;break}if(B<1-T){if(o[r+4>>2]=i,T*2+-1<B){o[r>>2]=l;break}}else i=i+1|0,o[r+4>>2]=i;l=l+1|0,o[r>>2]=l}while(!1);do if(j<0)if(i&1){ue=(i+1|0)/2|0,ue=R(l|0,((l|0)<0)<<31>>31|0,ue|0,((ue|0)<0)<<31>>31|0)|0,l=~~(+(l|0)-((+(ue>>>0)+4294967296*+(Ut()|0))*2+1)),o[r>>2]=l;break}else{ue=(i|0)/2|0,ue=R(l|0,((l|0)<0)<<31>>31|0,ue|0,((ue|0)<0)<<31>>31|0)|0,l=~~(+(l|0)-(+(ue>>>0)+4294967296*+(Ut()|0))*2),o[r>>2]=l;break}while(!1);ue=r+4|0,X<0&&(l=l-((i<<1|1|0)/2|0)|0,o[r>>2]=l,i=0-i|0,o[ue>>2]=i),d=i-l|0,(l|0)<0?(_=0-l|0,o[ue>>2]=d,o[Se>>2]=_,o[r>>2]=0,i=d,l=0):_=0,(i|0)<0&&(l=l-i|0,o[r>>2]=l,_=_-i|0,o[Se>>2]=_,o[ue>>2]=0,i=0),w=l-_|0,d=i-_|0,(_|0)<0&&(o[r>>2]=w,o[ue>>2]=d,o[Se>>2]=0,i=d,l=w,_=0),d=(i|0)<(l|0)?i:l,d=(_|0)<(d|0)?_:d,!((d|0)<=0)&&(o[r>>2]=l-d,o[ue>>2]=i-d,o[Se>>2]=_-d)}function Lr(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0;r=o[i>>2]|0,T=i+4|0,l=o[T>>2]|0,(r|0)<0&&(l=l-r|0,o[T>>2]=l,w=i+8|0,o[w>>2]=(o[w>>2]|0)-r,o[i>>2]=0,r=0),(l|0)<0?(r=r-l|0,o[i>>2]=r,w=i+8|0,_=(o[w>>2]|0)-l|0,o[w>>2]=_,o[T>>2]=0,l=0):(_=i+8|0,w=_,_=o[_>>2]|0),(_|0)<0&&(r=r-_|0,o[i>>2]=r,l=l-_|0,o[T>>2]=l,o[w>>2]=0,_=0),d=(l|0)<(r|0)?l:r,d=(_|0)<(d|0)?_:d,!((d|0)<=0)&&(o[i>>2]=r-d,o[T>>2]=l-d,o[w>>2]=_-d)}function Zs(i,r){i=i|0,r=r|0;var l=0,d=0;d=o[i+8>>2]|0,l=+((o[i+4>>2]|0)-d|0),ke[r>>3]=+((o[i>>2]|0)-d|0)-l*.5,ke[r+8>>3]=l*.8660254037844386}function xr(i,r,l){i=i|0,r=r|0,l=l|0,o[l>>2]=(o[r>>2]|0)+(o[i>>2]|0),o[l+4>>2]=(o[r+4>>2]|0)+(o[i+4>>2]|0),o[l+8>>2]=(o[r+8>>2]|0)+(o[i+8>>2]|0)}function Ks(i,r,l){i=i|0,r=r|0,l=l|0,o[l>>2]=(o[i>>2]|0)-(o[r>>2]|0),o[l+4>>2]=(o[i+4>>2]|0)-(o[r+4>>2]|0),o[l+8>>2]=(o[i+8>>2]|0)-(o[r+8>>2]|0)}function Br(i,r){i=i|0,r=r|0;var l=0,d=0;l=ji(o[i>>2]|0,r)|0,o[i>>2]=l,l=i+4|0,d=ji(o[l>>2]|0,r)|0,o[l>>2]=d,i=i+8|0,r=ji(o[i>>2]|0,r)|0,o[i>>2]=r}function To(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=o[i>>2]|0,B=(T|0)<0,d=(o[i+4>>2]|0)-(B?T:0)|0,w=(d|0)<0,_=(w?0-d|0:0)+((o[i+8>>2]|0)-(B?T:0))|0,l=(_|0)<0,i=l?0:_,r=(w?0:d)-(l?_:0)|0,_=(B?0:T)-(w?d:0)-(l?_:0)|0,l=(r|0)<(_|0)?r:_,l=(i|0)<(l|0)?i:l,d=(l|0)>0,i=i-(d?l:0)|0,r=r-(d?l:0)|0;e:do switch(_-(d?l:0)|0){case 0:switch(r|0){case 0:return B=i|0?(i|0)==1?1:7:0,B|0;case 1:return B=i|0?(i|0)==1?3:7:2,B|0;default:break e}case 1:switch(r|0){case 0:return B=i|0?(i|0)==1?5:7:4,B|0;case 1:{if(!i)i=6;else break e;return i|0}default:break e}}while(!1);return B=7,B|0}function Zo(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=i+8|0,_=o[T>>2]|0,w=(o[i>>2]|0)-_|0,B=i+4|0,_=(o[B>>2]|0)-_|0;do if(w>>>0>715827881|_>>>0>715827881){if(l=(w|0)>0,l){if((2147483647-w|0)<(w|0)||(2147483647-(w<<1)|0)<(w|0))return B=1,B|0}else if((-2147483648-w|0)>(w|0)||(-2147483648-(w<<1)|0)>(w|0))return B=1,B|0;if(r=w*3|0,(_|0)>0){if((2147483647-_|0)<(_|0))return B=1,B|0}else if((-2147483648-_|0)>(_|0))return B=1,B|0;if(d=_<<1,(w|0)>-1){if((r|-2147483648|0)>=(_|0))return B=1,B|0}else if((r^-2147483648|0)<(_|0))return B=1,B|0;if(l){if((2147483647-w|0)<(d|0))r=1;else{l=d;break}return r|0}else{if((-2147483648-w|0)>(d|0))r=1;else{l=d;break}return r|0}}else l=_<<1,r=w*3|0;while(!1);d=hl(+(r-_|0)/7)|0,o[i>>2]=d,_=hl(+(l+w|0)/7)|0,o[B>>2]=_,o[T>>2]=0,l=(_|0)<(d|0),r=l?d:_,l=l?_:d;do if((l|0)<0){if((r|0)>0){if((r|-2147483648|0)<(l|0)&((l|0)!=-2147483648&(2147483647-r|0)>=(l|0)))break;Tn(23313,22444,355,22455)}if((l|0)==-2147483648|(-2147483648-r|0)>(l|0)&&Tn(23313,22444,355,22455),(r|0)>-1){if((r|-2147483648|0)<(l|0))break;Tn(23313,22444,355,22455)}else{if((r^-2147483648|0)>=(l|0))break;Tn(23313,22444,355,22455)}}while(!1);return r=_-d|0,(d|0)<0?(l=0-d|0,o[B>>2]=r,o[T>>2]=l,o[i>>2]=0,d=0):(r=_,l=0),(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[T>>2]=l,o[B>>2]=0,r=0),w=d-l|0,_=r-l|0,(l|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,r=_,_=w,l=0):_=d,d=(r|0)<(_|0)?r:_,d=(l|0)<(d|0)?l:d,(d|0)<=0?(B=0,B|0):(o[i>>2]=_-d,o[B>>2]=r-d,o[T>>2]=l-d,B=0,B|0)}function Bs(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=i+8|0,_=o[T>>2]|0,w=(o[i>>2]|0)-_|0,B=i+4|0,_=(o[B>>2]|0)-_|0;do if(w>>>0>715827881|_>>>0>715827881){if(l=(w|0)>0,l){if((2147483647-w|0)<(w|0))return B=1,B|0}else if((-2147483648-w|0)>(w|0))return B=1,B|0;if(r=w<<1,(_|0)>0){if((2147483647-_|0)<(_|0)||(2147483647-(_<<1)|0)<(_|0))return B=1,B|0}else if((-2147483648-_|0)>(_|0)||(-2147483648-(_<<1)|0)>(_|0))return B=1,B|0;if(d=_*3|0,l){if((2147483647-r|0)<(_|0))return B=1,B|0}else if((-2147483648-r|0)>(_|0))return B=1,B|0;if((_|0)>-1){if((d|-2147483648|0)<(w|0)){l=d;break}else r=1;return r|0}else{if((d^-2147483648|0)<(w|0))r=1;else{l=d;break}return r|0}}else l=_*3|0,r=w<<1;while(!1);d=hl(+(r+_|0)/7)|0,o[i>>2]=d,_=hl(+(l-w|0)/7)|0,o[B>>2]=_,o[T>>2]=0,l=(_|0)<(d|0),r=l?d:_,l=l?_:d;do if((l|0)<0){if((r|0)>0){if((r|-2147483648|0)<(l|0)&((l|0)!=-2147483648&(2147483647-r|0)>=(l|0)))break;Tn(23313,22444,404,22469)}if((l|0)==-2147483648|(-2147483648-r|0)>(l|0)&&Tn(23313,22444,404,22469),(r|0)>-1){if((r|-2147483648|0)<(l|0))break;Tn(23313,22444,404,22469)}else{if((r^-2147483648|0)>=(l|0))break;Tn(23313,22444,404,22469)}}while(!1);return r=_-d|0,(d|0)<0?(l=0-d|0,o[B>>2]=r,o[T>>2]=l,o[i>>2]=0,d=0):(r=_,l=0),(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[T>>2]=l,o[B>>2]=0,r=0),w=d-l|0,_=r-l|0,(l|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,r=_,_=w,l=0):_=d,d=(r|0)<(_|0)?r:_,d=(l|0)<(d|0)?l:d,(d|0)<=0?(B=0,B|0):(o[i>>2]=_-d,o[B>>2]=r-d,o[T>>2]=l-d,B=0,B|0)}function Il(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=i+8|0,l=o[T>>2]|0,r=(o[i>>2]|0)-l|0,B=i+4|0,l=(o[B>>2]|0)-l|0,d=hl(+((r*3|0)-l|0)/7)|0,o[i>>2]=d,r=hl(+((l<<1)+r|0)/7)|0,o[B>>2]=r,o[T>>2]=0,l=r-d|0,(d|0)<0?(w=0-d|0,o[B>>2]=l,o[T>>2]=w,o[i>>2]=0,r=l,d=0,l=w):l=0,(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[T>>2]=l,o[B>>2]=0,r=0),w=d-l|0,_=r-l|0,(l|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,r=_,_=w,l=0):_=d,d=(r|0)<(_|0)?r:_,d=(l|0)<(d|0)?l:d,!((d|0)<=0)&&(o[i>>2]=_-d,o[B>>2]=r-d,o[T>>2]=l-d)}function mo(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=i+8|0,l=o[T>>2]|0,r=(o[i>>2]|0)-l|0,B=i+4|0,l=(o[B>>2]|0)-l|0,d=hl(+((r<<1)+l|0)/7)|0,o[i>>2]=d,r=hl(+((l*3|0)-r|0)/7)|0,o[B>>2]=r,o[T>>2]=0,l=r-d|0,(d|0)<0?(w=0-d|0,o[B>>2]=l,o[T>>2]=w,o[i>>2]=0,r=l,d=0,l=w):l=0,(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[T>>2]=l,o[B>>2]=0,r=0),w=d-l|0,_=r-l|0,(l|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,r=_,_=w,l=0):_=d,d=(r|0)<(_|0)?r:_,d=(l|0)<(d|0)?l:d,!((d|0)<=0)&&(o[i>>2]=_-d,o[B>>2]=r-d,o[T>>2]=l-d)}function Qo(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;r=o[i>>2]|0,T=i+4|0,l=o[T>>2]|0,B=i+8|0,d=o[B>>2]|0,_=l+(r*3|0)|0,o[i>>2]=_,l=d+(l*3|0)|0,o[T>>2]=l,r=(d*3|0)+r|0,o[B>>2]=r,d=l-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=d,o[B>>2]=r,o[i>>2]=0,l=d,d=0):d=_,(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=_,o[B>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[T>>2]=_-l,o[B>>2]=r-l)}function ha(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;_=o[i>>2]|0,T=i+4|0,r=o[T>>2]|0,B=i+8|0,l=o[B>>2]|0,d=(r*3|0)+_|0,_=l+(_*3|0)|0,o[i>>2]=_,o[T>>2]=d,r=(l*3|0)+r|0,o[B>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=l,o[B>>2]=r,o[i>>2]=0,_=0):l=d,(l|0)<0&&(_=_-l|0,o[i>>2]=_,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=_-r|0,d=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=d,o[B>>2]=0,_=w,r=0):d=l,l=(d|0)<(_|0)?d:_,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=_-l,o[T>>2]=d-l,o[B>>2]=r-l)}function Ys(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0;(r+-1|0)>>>0>=6||(_=(o[15440+(r*12|0)>>2]|0)+(o[i>>2]|0)|0,o[i>>2]=_,B=i+4|0,d=(o[15440+(r*12|0)+4>>2]|0)+(o[B>>2]|0)|0,o[B>>2]=d,T=i+8|0,r=(o[15440+(r*12|0)+8>>2]|0)+(o[T>>2]|0)|0,o[T>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[B>>2]=l,o[T>>2]=r,o[i>>2]=0,d=0):(l=d,d=_),(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[T>>2]=r,o[B>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[B>>2]=_-l,o[T>>2]=r-l))}function El(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;_=o[i>>2]|0,T=i+4|0,r=o[T>>2]|0,B=i+8|0,l=o[B>>2]|0,d=r+_|0,_=l+_|0,o[i>>2]=_,o[T>>2]=d,r=l+r|0,o[B>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=l,o[B>>2]=r,o[i>>2]=0,d=0):(l=d,d=_),(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=_,o[B>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[T>>2]=_-l,o[B>>2]=r-l)}function Wa(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;r=o[i>>2]|0,T=i+4|0,d=o[T>>2]|0,B=i+8|0,l=o[B>>2]|0,_=d+r|0,o[i>>2]=_,d=l+d|0,o[T>>2]=d,r=l+r|0,o[B>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=l,o[B>>2]=r,o[i>>2]=0,d=0):(l=d,d=_),(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=_,o[B>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[T>>2]=_-l,o[B>>2]=r-l)}function Ma(i){switch(i=i|0,i|0){case 1:{i=5;break}case 5:{i=4;break}case 4:{i=6;break}case 6:{i=2;break}case 2:{i=3;break}case 3:{i=1;break}}return i|0}function ml(i){switch(i=i|0,i|0){case 1:{i=3;break}case 3:{i=2;break}case 2:{i=6;break}case 6:{i=4;break}case 4:{i=5;break}case 5:{i=1;break}}return i|0}function Cl(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;r=o[i>>2]|0,T=i+4|0,l=o[T>>2]|0,B=i+8|0,d=o[B>>2]|0,_=l+(r<<1)|0,o[i>>2]=_,l=d+(l<<1)|0,o[T>>2]=l,r=(d<<1)+r|0,o[B>>2]=r,d=l-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=d,o[B>>2]=r,o[i>>2]=0,l=d,d=0):d=_,(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=_,o[B>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[T>>2]=_-l,o[B>>2]=r-l)}function mu(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;_=o[i>>2]|0,T=i+4|0,r=o[T>>2]|0,B=i+8|0,l=o[B>>2]|0,d=(r<<1)+_|0,_=l+(_<<1)|0,o[i>>2]=_,o[T>>2]=d,r=(l<<1)+r|0,o[B>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=l,o[B>>2]=r,o[i>>2]=0,_=0):l=d,(l|0)<0&&(_=_-l|0,o[i>>2]=_,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=_-r|0,d=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=d,o[B>>2]=0,_=w,r=0):d=l,l=(d|0)<(_|0)?d:_,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=_-l,o[T>>2]=d-l,o[B>>2]=r-l)}function As(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0;return T=(o[i>>2]|0)-(o[r>>2]|0)|0,B=(T|0)<0,d=(o[i+4>>2]|0)-(o[r+4>>2]|0)-(B?T:0)|0,w=(d|0)<0,_=(B?0-T|0:0)+(o[i+8>>2]|0)-(o[r+8>>2]|0)+(w?0-d|0:0)|0,i=(_|0)<0,r=i?0:_,l=(w?0:d)-(i?_:0)|0,_=(B?0:T)-(w?d:0)-(i?_:0)|0,i=(l|0)<(_|0)?l:_,i=(r|0)<(i|0)?r:i,d=(i|0)>0,r=r-(d?i:0)|0,l=l-(d?i:0)|0,i=_-(d?i:0)|0,i=(i|0)>-1?i:0-i|0,l=(l|0)>-1?l:0-l|0,r=(r|0)>-1?r:0-r|0,r=(l|0)>(r|0)?l:r,((i|0)>(r|0)?i:r)|0}function ac(i,r){i=i|0,r=r|0;var l=0;l=o[i+8>>2]|0,o[r>>2]=(o[i>>2]|0)-l,o[r+4>>2]=(o[i+4>>2]|0)-l}function ro(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0;d=o[i>>2]|0,o[r>>2]=d,_=o[i+4>>2]|0,T=r+4|0,o[T>>2]=_,B=r+8|0,o[B>>2]=0,l=(_|0)<(d|0),i=l?d:_,l=l?_:d;do if((l|0)<0){if((i|0)>0){if((i|-2147483648|0)<(l|0)&((l|0)!=-2147483648&(2147483647-i|0)>=(l|0)))break;return i=1,i|0}if((l|0)==-2147483648|(-2147483648-i|0)>(l|0))return r=1,r|0;if((i|0)>-1){if((i|-2147483648|0)<(l|0))break;return i=1,i|0}else{if((i^-2147483648|0)<(l|0))i=1;else break;return i|0}}while(!1);return i=_-d|0,(d|0)<0?(l=0-d|0,o[T>>2]=i,o[B>>2]=l,o[r>>2]=0,d=0):(i=_,l=0),(i|0)<0&&(d=d-i|0,o[r>>2]=d,l=l-i|0,o[B>>2]=l,o[T>>2]=0,i=0),w=d-l|0,_=i-l|0,(l|0)<0?(o[r>>2]=w,o[T>>2]=_,o[B>>2]=0,i=_,_=w,l=0):_=d,d=(i|0)<(_|0)?i:_,d=(l|0)<(d|0)?l:d,(d|0)<=0?(r=0,r|0):(o[r>>2]=_-d,o[T>>2]=i-d,o[B>>2]=l-d,r=0,r|0)}function so(i){i=i|0;var r=0,l=0,d=0,_=0;r=i+8|0,_=o[r>>2]|0,l=_-(o[i>>2]|0)|0,o[i>>2]=l,d=i+4|0,i=(o[d>>2]|0)-_|0,o[d>>2]=i,o[r>>2]=0-(i+l)}function Wl(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;l=o[i>>2]|0,r=0-l|0,o[i>>2]=r,T=i+8|0,o[T>>2]=0,B=i+4|0,d=o[B>>2]|0,_=d+l|0,(l|0)>0?(o[B>>2]=_,o[T>>2]=l,o[i>>2]=0,r=0,d=_):l=0,(d|0)<0?(w=r-d|0,o[i>>2]=w,l=l-d|0,o[T>>2]=l,o[B>>2]=0,_=w-l|0,r=0-l|0,(l|0)<0?(o[i>>2]=_,o[B>>2]=r,o[T>>2]=0,d=r,l=0):(d=0,_=w)):_=r,r=(d|0)<(_|0)?d:_,r=(l|0)<(r|0)?l:r,!((r|0)<=0)&&(o[i>>2]=_-r,o[B>>2]=d-r,o[T>>2]=l-r)}function Oo(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ue=0,Se=0;if(Se=Dt,Dt=Dt+64|0,ue=Se,B=Se+56|0,!(!0&(r&2013265920|0)==134217728&(!0&(d&2013265920|0)==134217728)))return _=5,Dt=Se,_|0;if((i|0)==(l|0)&(r|0)==(d|0))return o[_>>2]=0,_=0,Dt=Se,_|0;if(T=Gt(i|0,r|0,52)|0,Ut()|0,T=T&15,X=Gt(l|0,d|0,52)|0,Ut()|0,(T|0)!=(X&15|0))return _=12,Dt=Se,_|0;if(w=T+-1|0,T>>>0>1){Zr(i,r,w,ue)|0,Zr(l,d,w,B)|0,X=ue,j=o[X>>2]|0,X=o[X+4>>2]|0;e:do if((j|0)==(o[B>>2]|0)&&(X|0)==(o[B+4>>2]|0)){T=(T^15)*3|0,w=Gt(i|0,r|0,T|0)|0,Ut()|0,w=w&7,T=Gt(l|0,d|0,T|0)|0,Ut()|0,T=T&7;do if((w|0)==0|(T|0)==0)o[_>>2]=1,w=0;else if((w|0)==7)w=5;else{if((w|0)==1|(T|0)==1&&Mr(j,X)|0){w=5;break}if((o[15536+(w<<2)>>2]|0)!=(T|0)&&(o[15568+(w<<2)>>2]|0)!=(T|0))break e;o[_>>2]=1,w=0}while(!1);return _=w,Dt=Se,_|0}while(!1)}w=ue,T=w+56|0;do o[w>>2]=0,w=w+4|0;while((w|0)<(T|0));return Ga(i,r,1,ue)|0,r=ue,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0))&&(r=ue+8|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=ue+16|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=ue+24|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=ue+32|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=ue+40|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))?(w=ue+48|0,w=((o[w>>2]|0)==(l|0)?(o[w+4>>2]|0)==(d|0):0)&1):w=1,o[_>>2]=w,_=0,Dt=Se,_|0}function Wo(i,r,l,d,_){return i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,l=qa(i,r,l,d)|0,(l|0)==7?(_=11,_|0):(d=Zt(l|0,0,56)|0,r=r&-2130706433|(Ut()|0)|268435456,o[_>>2]=i|d,o[_+4>>2]=r,_=0,_|0)}function ko(i,r,l){return i=i|0,r=r|0,l=l|0,!0&(r&2013265920|0)==268435456?(o[l>>2]=i,o[l+4>>2]=r&-2130706433|134217728,l=0,l|0):(l=6,l|0)}function Gs(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;return _=Dt,Dt=Dt+16|0,d=_,o[d>>2]=0,!0&(r&2013265920|0)==268435456?(w=Gt(i|0,r|0,56)|0,Ut()|0,d=hs(i,r&-2130706433|134217728,w&7,d,l)|0,Dt=_,d|0):(d=6,Dt=_,d|0)}function $o(i,r){i=i|0,r=r|0;var l=0;switch(l=Gt(i|0,r|0,56)|0,Ut()|0,l&7){case 0:case 7:return l=0,l|0}return l=r&-2130706433|134217728,!(!0&(r&2013265920|0)==268435456)||!0&(r&117440512|0)==16777216&(Mr(i,l)|0)!=0?(l=0,l|0):(l=ns(i,l)|0,l|0)}function Xo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;return _=Dt,Dt=Dt+16|0,d=_,!0&(r&2013265920|0)==268435456?(w=r&-2130706433|134217728,T=l,o[T>>2]=i,o[T+4>>2]=w,o[d>>2]=0,r=Gt(i|0,r|0,56)|0,Ut()|0,d=hs(i,w,r&7,d,l+8|0)|0,Dt=_,d|0):(d=6,Dt=_,d|0)}function Yo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;return _=(Mr(i,r)|0)==0,r=r&-2130706433,d=l,o[d>>2]=_?i:0,o[d+4>>2]=_?r|285212672:0,d=l+8|0,o[d>>2]=i,o[d+4>>2]=r|301989888,d=l+16|0,o[d>>2]=i,o[d+4>>2]=r|318767104,d=l+24|0,o[d>>2]=i,o[d+4>>2]=r|335544320,d=l+32|0,o[d>>2]=i,o[d+4>>2]=r|352321536,l=l+40|0,o[l>>2]=i,o[l+4>>2]=r|369098752,0}function Sa(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;return T=Dt,Dt=Dt+16|0,_=T,w=r&-2130706433|134217728,!0&(r&2013265920|0)==268435456?(d=Gt(i|0,r|0,56)|0,Ut()|0,d=gn(i,w,d&7)|0,(d|0)==-1?(o[l>>2]=0,w=6,Dt=T,w|0):(Yr(i,w,_)|0&&Tn(23313,22484,282,22499),r=Gt(i|0,r|0,52)|0,Ut()|0,r=r&15,Mr(i,w)|0?Ko(_,r,d,2,l):fr(_,r,d,2,l),w=0,Dt=T,w|0)):(w=6,Dt=T,w|0)}function $a(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;d=Dt,Dt=Dt+16|0,_=d,ks(i,r,l,_),Er(_,l+4|0),Dt=d}function ks(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0;if(B=Dt,Dt=Dt+16|0,j=B,gu(i,l,j),w=+wn(+(1-+ke[j>>3]*.5)),w<1e-16){o[d>>2]=0,o[d+4>>2]=0,o[d+8>>2]=0,o[d+12>>2]=0,Dt=B;return}if(j=o[l>>2]|0,_=+ke[15920+(j*24|0)>>3],_=+gl(_-+gl(+Ft(15600+(j<<4)|0,i))),qs(r)|0?T=+gl(_+-.3334731722518321):T=_,_=+Jt(+w)/.381966011250105,(r|0)>0){i=0;do _=_*2.6457513110645907,i=i+1|0;while((i|0)!=(r|0))}w=+vi(+T)*_,ke[d>>3]=w,T=+bi(+T)*_,ke[d+8>>3]=T,Dt=B}function gu(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if(w=Dt,Dt=Dt+32|0,_=w,gs(i,_),o[r>>2]=0,ke[l>>3]=5,d=+yr(16400,_),d<+ke[l>>3]&&(o[r>>2]=0,ke[l>>3]=d),d=+yr(16424,_),d<+ke[l>>3]&&(o[r>>2]=1,ke[l>>3]=d),d=+yr(16448,_),d<+ke[l>>3]&&(o[r>>2]=2,ke[l>>3]=d),d=+yr(16472,_),d<+ke[l>>3]&&(o[r>>2]=3,ke[l>>3]=d),d=+yr(16496,_),d<+ke[l>>3]&&(o[r>>2]=4,ke[l>>3]=d),d=+yr(16520,_),d<+ke[l>>3]&&(o[r>>2]=5,ke[l>>3]=d),d=+yr(16544,_),d<+ke[l>>3]&&(o[r>>2]=6,ke[l>>3]=d),d=+yr(16568,_),d<+ke[l>>3]&&(o[r>>2]=7,ke[l>>3]=d),d=+yr(16592,_),d<+ke[l>>3]&&(o[r>>2]=8,ke[l>>3]=d),d=+yr(16616,_),d<+ke[l>>3]&&(o[r>>2]=9,ke[l>>3]=d),d=+yr(16640,_),d<+ke[l>>3]&&(o[r>>2]=10,ke[l>>3]=d),d=+yr(16664,_),d<+ke[l>>3]&&(o[r>>2]=11,ke[l>>3]=d),d=+yr(16688,_),d<+ke[l>>3]&&(o[r>>2]=12,ke[l>>3]=d),d=+yr(16712,_),d<+ke[l>>3]&&(o[r>>2]=13,ke[l>>3]=d),d=+yr(16736,_),d<+ke[l>>3]&&(o[r>>2]=14,ke[l>>3]=d),d=+yr(16760,_),d<+ke[l>>3]&&(o[r>>2]=15,ke[l>>3]=d),d=+yr(16784,_),d<+ke[l>>3]&&(o[r>>2]=16,ke[l>>3]=d),d=+yr(16808,_),d<+ke[l>>3]&&(o[r>>2]=17,ke[l>>3]=d),d=+yr(16832,_),d<+ke[l>>3]&&(o[r>>2]=18,ke[l>>3]=d),d=+yr(16856,_),!(d<+ke[l>>3])){Dt=w;return}o[r>>2]=19,ke[l>>3]=d,Dt=w}function Cr(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0;if(w=+Nu(i),w<1e-16){r=15600+(r<<4)|0,o[_>>2]=o[r>>2],o[_+4>>2]=o[r+4>>2],o[_+8>>2]=o[r+8>>2],o[_+12>>2]=o[r+12>>2];return}if(T=+Hn(+ +ke[i+8>>3],+ +ke[i>>3]),(l|0)>0){i=0;do w=w/2.6457513110645907,i=i+1|0;while((i|0)!=(l|0))}d?(w=w/3,l=(qs(l)|0)==0,w=+mn(+((l?w:w/2.6457513110645907)*.381966011250105))):(w=+mn(+(w*.381966011250105)),qs(l)|0&&(T=+gl(T+.3334731722518321))),ni(15600+(r<<4)|0,+gl(+ke[15920+(r*24|0)>>3]-T),w,_)}function $n(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;d=Dt,Dt=Dt+16|0,_=d,Zs(i+4|0,_),Cr(_,o[i>>2]|0,r,0,l),Dt=d}function Ko(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0,et=0,vt=0,ot=0,ht=0,Et=0,wt=0,si=0,Kt=0,ii=0,ai=0,Zi=0,Qi=0,Si=0,Ui=0,Gi=0,un=0,Bn=0,en=0;if(un=Dt,Dt=Dt+272|0,w=un+256|0,ht=un+240|0,Si=un,Ui=un+224|0,Gi=un+208|0,Et=un+176|0,wt=un+160|0,si=un+192|0,Kt=un+144|0,ii=un+128|0,ai=un+112|0,Zi=un+96|0,Qi=un+80|0,o[w>>2]=r,o[ht>>2]=o[i>>2],o[ht+4>>2]=o[i+4>>2],o[ht+8>>2]=o[i+8>>2],o[ht+12>>2]=o[i+12>>2],zr(ht,w,Si),o[_>>2]=0,ht=d+l+((d|0)==5&1)|0,(ht|0)<=(l|0)){Dt=un;return}j=o[w>>2]|0,X=Ui+4|0,ue=Et+4|0,Se=l+5|0,Te=16880+(j<<2)|0,Re=16960+(j<<2)|0,Be=ii+8|0,et=ai+8|0,vt=Zi+8|0,ot=Gi+4|0,B=l;e:for(;;){T=Si+(((B|0)%5|0)<<4)|0,o[Gi>>2]=o[T>>2],o[Gi+4>>2]=o[T+4>>2],o[Gi+8>>2]=o[T+8>>2],o[Gi+12>>2]=o[T+12>>2];do;while((Xa(Gi,j,0,1)|0)==2);if((B|0)>(l|0)&(qs(r)|0)!=0){if(o[Et>>2]=o[Gi>>2],o[Et+4>>2]=o[Gi+4>>2],o[Et+8>>2]=o[Gi+8>>2],o[Et+12>>2]=o[Gi+12>>2],Zs(X,wt),d=o[Et>>2]|0,w=o[17040+(d*80|0)+(o[Ui>>2]<<2)>>2]|0,o[Et>>2]=o[18640+(d*80|0)+(w*20|0)>>2],T=o[18640+(d*80|0)+(w*20|0)+16>>2]|0,(T|0)>0){i=0;do El(ue),i=i+1|0;while((i|0)<(T|0))}switch(T=18640+(d*80|0)+(w*20|0)+4|0,o[si>>2]=o[T>>2],o[si+4>>2]=o[T+4>>2],o[si+8>>2]=o[T+8>>2],Br(si,(o[Te>>2]|0)*3|0),xr(ue,si,ue),Lr(ue),Zs(ue,Kt),Bn=+(o[Re>>2]|0),ke[ii>>3]=Bn*3,ke[Be>>3]=0,en=Bn*-1.5,ke[ai>>3]=en,ke[et>>3]=Bn*2.598076211353316,ke[Zi>>3]=en,ke[vt>>3]=Bn*-2.598076211353316,o[17040+((o[Et>>2]|0)*80|0)+(o[Gi>>2]<<2)>>2]|0){case 1:{i=ai,d=ii;break}case 3:{i=Zi,d=ai;break}case 2:{i=ii,d=Zi;break}default:{i=12;break e}}cu(wt,Kt,d,i,Qi),Cr(Qi,o[Et>>2]|0,j,1,_+8+(o[_>>2]<<4)|0),o[_>>2]=(o[_>>2]|0)+1}if((B|0)<(Se|0)&&(Zs(ot,Et),Cr(Et,o[Gi>>2]|0,j,1,_+8+(o[_>>2]<<4)|0),o[_>>2]=(o[_>>2]|0)+1),o[Ui>>2]=o[Gi>>2],o[Ui+4>>2]=o[Gi+4>>2],o[Ui+8>>2]=o[Gi+8>>2],o[Ui+12>>2]=o[Gi+12>>2],B=B+1|0,(B|0)>=(ht|0)){i=3;break}}if((i|0)==3){Dt=un;return}else(i|0)==12&&Tn(22522,22569,571,22579)}function zr(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0;j=Dt,Dt=Dt+128|0,d=j+64|0,_=j,w=d,T=20240,B=w+60|0;do o[w>>2]=o[T>>2],w=w+4|0,T=T+4|0;while((w|0)<(B|0));w=_,T=20304,B=w+60|0;do o[w>>2]=o[T>>2],w=w+4|0,T=T+4|0;while((w|0)<(B|0));B=(qs(o[r>>2]|0)|0)==0,d=B?d:_,_=i+4|0,Cl(_),mu(_),qs(o[r>>2]|0)|0&&(ha(_),o[r>>2]=(o[r>>2]|0)+1),o[l>>2]=o[i>>2],r=l+4|0,xr(_,d,r),Lr(r),o[l+16>>2]=o[i>>2],r=l+20|0,xr(_,d+12|0,r),Lr(r),o[l+32>>2]=o[i>>2],r=l+36|0,xr(_,d+24|0,r),Lr(r),o[l+48>>2]=o[i>>2],r=l+52|0,xr(_,d+36|0,r),Lr(r),o[l+64>>2]=o[i>>2],l=l+68|0,xr(_,d+48|0,l),Lr(l),Dt=j}function Xa(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0;if(Be=Dt,Dt=Dt+32|0,Te=Be+12|0,B=Be,Re=i+4|0,Se=o[16960+(r<<2)>>2]|0,ue=(d|0)!=0,Se=ue?Se*3|0:Se,_=o[Re>>2]|0,X=i+8|0,T=o[X>>2]|0,ue){if(w=i+12|0,d=o[w>>2]|0,_=T+_+d|0,(_|0)==(Se|0))return Re=1,Dt=Be,Re|0;j=w}else j=i+12|0,d=o[j>>2]|0,_=T+_+d|0;if((_|0)<=(Se|0))return Re=0,Dt=Be,Re|0;do if((d|0)>0){if(d=o[i>>2]|0,(T|0)>0){w=18640+(d*80|0)+60|0,d=i;break}d=18640+(d*80|0)+40|0,l?(ir(Te,Se,0,0),Ks(Re,Te,B),Wa(B),xr(B,Te,Re),w=d,d=i):(w=d,d=i)}else w=18640+((o[i>>2]|0)*80|0)+20|0,d=i;while(!1);if(o[d>>2]=o[w>>2],_=w+16|0,(o[_>>2]|0)>0){d=0;do El(Re),d=d+1|0;while((d|0)<(o[_>>2]|0))}return i=w+4|0,o[Te>>2]=o[i>>2],o[Te+4>>2]=o[i+4>>2],o[Te+8>>2]=o[i+8>>2],r=o[16880+(r<<2)>>2]|0,Br(Te,ue?r*3|0:r),xr(Re,Te,Re),Lr(Re),ue?d=((o[X>>2]|0)+(o[Re>>2]|0)+(o[j>>2]|0)|0)==(Se|0)?1:2:d=2,Re=d,Dt=Be,Re|0}function is(i,r){i=i|0,r=r|0;var l=0;do l=Xa(i,r,0,1)|0;while((l|0)==2);return l|0}function fr(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0,et=0,vt=0,ot=0,ht=0,Et=0,wt=0,si=0,Kt=0,ii=0,ai=0,Zi=0,Qi=0,Si=0;if(Zi=Dt,Dt=Dt+240|0,w=Zi+224|0,si=Zi+208|0,Kt=Zi,ii=Zi+192|0,ai=Zi+176|0,vt=Zi+160|0,ot=Zi+144|0,ht=Zi+128|0,Et=Zi+112|0,wt=Zi+96|0,o[w>>2]=r,o[si>>2]=o[i>>2],o[si+4>>2]=o[i+4>>2],o[si+8>>2]=o[i+8>>2],o[si+12>>2]=o[i+12>>2],Mo(si,w,Kt),o[_>>2]=0,et=d+l+((d|0)==6&1)|0,(et|0)<=(l|0)){Dt=Zi;return}j=o[w>>2]|0,X=l+6|0,ue=16960+(j<<2)|0,Se=ot+8|0,Te=ht+8|0,Re=Et+8|0,Be=ii+4|0,T=0,B=l,d=-1;e:for(;;){if(w=(B|0)%6|0,i=Kt+(w<<4)|0,o[ii>>2]=o[i>>2],o[ii+4>>2]=o[i+4>>2],o[ii+8>>2]=o[i+8>>2],o[ii+12>>2]=o[i+12>>2],i=T,T=Xa(ii,j,0,1)|0,(B|0)>(l|0)&(qs(r)|0)!=0&&(i|0)!=1&&(o[ii>>2]|0)!=(d|0)){switch(Zs(Kt+(((w+5|0)%6|0)<<4)+4|0,ai),Zs(Kt+(w<<4)+4|0,vt),Qi=+(o[ue>>2]|0),ke[ot>>3]=Qi*3,ke[Se>>3]=0,Si=Qi*-1.5,ke[ht>>3]=Si,ke[Te>>3]=Qi*2.598076211353316,ke[Et>>3]=Si,ke[Re>>3]=Qi*-2.598076211353316,w=o[si>>2]|0,o[17040+(w*80|0)+(((d|0)==(w|0)?o[ii>>2]|0:d)<<2)>>2]|0){case 1:{i=ht,d=ot;break}case 3:{i=Et,d=ht;break}case 2:{i=ot,d=Et;break}default:{i=8;break e}}cu(ai,vt,d,i,wt),!(Vu(ai,wt)|0)&&!(Vu(vt,wt)|0)&&(Cr(wt,o[si>>2]|0,j,1,_+8+(o[_>>2]<<4)|0),o[_>>2]=(o[_>>2]|0)+1)}if((B|0)<(X|0)&&(Zs(Be,ai),Cr(ai,o[ii>>2]|0,j,1,_+8+(o[_>>2]<<4)|0),o[_>>2]=(o[_>>2]|0)+1),B=B+1|0,(B|0)>=(et|0)){i=3;break}else d=o[ii>>2]|0}if((i|0)==3){Dt=Zi;return}else(i|0)==8&&Tn(22606,22569,736,22651)}function Mo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0;j=Dt,Dt=Dt+160|0,d=j+80|0,_=j,w=d,T=20368,B=w+72|0;do o[w>>2]=o[T>>2],w=w+4|0,T=T+4|0;while((w|0)<(B|0));w=_,T=20448,B=w+72|0;do o[w>>2]=o[T>>2],w=w+4|0,T=T+4|0;while((w|0)<(B|0));B=(qs(o[r>>2]|0)|0)==0,d=B?d:_,_=i+4|0,Cl(_),mu(_),qs(o[r>>2]|0)|0&&(ha(_),o[r>>2]=(o[r>>2]|0)+1),o[l>>2]=o[i>>2],r=l+4|0,xr(_,d,r),Lr(r),o[l+16>>2]=o[i>>2],r=l+20|0,xr(_,d+12|0,r),Lr(r),o[l+32>>2]=o[i>>2],r=l+36|0,xr(_,d+24|0,r),Lr(r),o[l+48>>2]=o[i>>2],r=l+52|0,xr(_,d+36|0,r),Lr(r),o[l+64>>2]=o[i>>2],r=l+68|0,xr(_,d+48|0,r),Lr(r),o[l+80>>2]=o[i>>2],l=l+84|0,xr(_,d+60|0,l),Lr(l),Dt=j}function qn(i,r){return i=i|0,r=r|0,r=Gt(i|0,r|0,52)|0,Ut()|0,r&15|0}function Ol(i,r){return i=i|0,r=r|0,r=Gt(i|0,r|0,45)|0,Ut()|0,r&127|0}function ns(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0;if(!(!0&(r&-16777216|0)==134217728)||(T=Gt(i|0,r|0,45)|0,Ut()|0,T=T&127,T>>>0>121))return r=0,r|0;l=Gt(i|0,r|0,52)|0,Ut()|0,l=l&15;do if(l|0){for(_=1,d=0;;){if(w=Gt(i|0,r|0,(15-_|0)*3|0)|0,Ut()|0,w=w&7,(w|0)!=0&(d^1))if((w|0)==1&(nt(T)|0)!=0){B=0,d=13;break}else d=1;if((w|0)==7){B=0,d=13;break}if(_>>>0<l>>>0)_=_+1|0;else{d=9;break}}if((d|0)==9){if((l|0)==15)B=1;else break;return B|0}else if((d|0)==13)return B|0}while(!1);for(;;){if(B=Gt(i|0,r|0,(14-l|0)*3|0)|0,Ut()|0,!((B&7|0)==7&!0)){B=0,d=13;break}if(l>>>0<14)l=l+1|0;else{B=1,d=13;break}}return(d|0)==13?B|0:0}function Zr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0;if(w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,l>>>0>15)return d=4,d|0;if((w|0)<(l|0))return d=12,d|0;if((w|0)==(l|0))return o[d>>2]=i,o[d+4>>2]=r,d=0,d|0;if(_=Zt(l|0,0,52)|0,_=_|i,i=Ut()|0|r&-15728641,(w|0)>(l|0))do r=Zt(7,0,(14-l|0)*3|0)|0,l=l+1|0,_=r|_,i=Ut()|0|i;while((l|0)<(w|0));return o[d>>2]=_,o[d+4>>2]=i,d=0,d|0}function Ms(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0;if(w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,!((l|0)<16&(w|0)<=(l|0)))return d=4,d|0;_=l-w|0,l=Gt(i|0,r|0,45)|0,Ut()|0;e:do if(!(nt(l&127)|0))l=_l(7,0,_,((_|0)<0)<<31>>31)|0,_=Ut()|0;else{t:do if(w|0){for(l=1;T=Zt(7,0,(15-l|0)*3|0)|0,!!((T&i|0)==0&((Ut()|0)&r|0)==0);)if(l>>>0<w>>>0)l=l+1|0;else break t;l=_l(7,0,_,((_|0)<0)<<31>>31)|0,_=Ut()|0;break e}while(!1);l=_l(7,0,_,((_|0)<0)<<31>>31)|0,l=We(l|0,Ut()|0,5,0)|0,l=z(l|0,Ut()|0,-5,-1)|0,l=oe(l|0,Ut()|0,6,0)|0,l=z(l|0,Ut()|0,1,0)|0,_=Ut()|0}while(!1);return T=d,o[T>>2]=l,o[T+4>>2]=_,T=0,T|0}function Mr(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;if(_=Gt(i|0,r|0,45)|0,Ut()|0,!(nt(_&127)|0))return _=0,_|0;_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15;e:do if(!_)l=0;else for(d=1;;){if(l=Gt(i|0,r|0,(15-d|0)*3|0)|0,Ut()|0,l=l&7,l|0)break e;if(d>>>0<_>>>0)d=d+1|0;else{l=0;break}}while(!1);return _=(l|0)==0&1,_|0}function nr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0;if(T=Dt,Dt=Dt+16|0,w=T,cl(w,i,r,l),r=w,i=o[r>>2]|0,r=o[r+4>>2]|0,(i|0)==0&(r|0)==0)return Dt=T,0;_=0,l=0;do B=d+(_<<3)|0,o[B>>2]=i,o[B+4>>2]=r,_=z(_|0,l|0,1,0)|0,l=Ut()|0,lu(w),B=w,i=o[B>>2]|0,r=o[B+4>>2]|0;while(!((i|0)==0&(r|0)==0));return Dt=T,0}function ll(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,(d|0)<(l|0)?(l=r,d=i,Yi(l|0),d|0):(l=Zt(-1,-1,((d-l|0)*3|0)+3|0)|0,d=Zt(~l|0,~(Ut()|0)|0,(15-d|0)*3|0)|0,l=~(Ut()|0)&r,d=~d&i,Yi(l|0),d|0)}function Xr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0;return _=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15,(l|0)<16&(_|0)<=(l|0)?((_|0)<(l|0)&&(_=Zt(-1,-1,((l+-1-_|0)*3|0)+3|0)|0,_=Zt(~_|0,~(Ut()|0)|0,(15-l|0)*3|0)|0,r=~(Ut()|0)&r,i=~_&i),_=Zt(l|0,0,52)|0,l=r&-15728641|(Ut()|0),o[d>>2]=i|_,o[d+4>>2]=l,d=0,d|0):(d=4,d|0)}function Po(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0,et=0,vt=0,ot=0,ht=0,Et=0,wt=0,si=0,Kt=0,ii=0,ai=0;if((l|0)==0&(d|0)==0)return ii=0,ii|0;if(_=i,w=o[_>>2]|0,_=o[_+4>>2]|0,!0&(_&15728640|0)==0){if(!((d|0)>0|(d|0)==0&l>>>0>0)||(ii=r,o[ii>>2]=w,o[ii+4>>2]=_,(l|0)==1&(d|0)==0))return ii=0,ii|0;_=1;do si=i+(_<<3)|0,Kt=o[si+4>>2]|0,ii=r+(_<<3)|0,o[ii>>2]=o[si>>2],o[ii+4>>2]=Kt,_=_+1|0;while(0<(d|0)|(d|0)==0&_>>>0<l>>>0);return _=0,_|0}if(wt=l<<3,Kt=Ds(wt)|0,!Kt)return ii=13,ii|0;if(F(Kt|0,i|0,wt|0)|0,si=D(l,8)|0,!si)return C(Kt),ii=13,ii|0;e:do if(l|0){t:for(;;){_=Kt,ot=o[_>>2]|0,_=o[_+4>>2]|0,ht=Gt(ot|0,_|0,52)|0,Ut()|0,ht=ht&15,Et=ht+-1|0,vt=(l|0)>0;i:do if((ht|0)!=0&vt){if(Re=((l|0)<0)<<31>>31,Be=Zt(Et|0,0,52)|0,et=Ut()|0,Et>>>0>15){if(!((ot|0)==0&(_|0)==0)){ii=17;break t}for(w=0;;){if(w=w+1|0,(w|0)>=(l|0))break i;if(d=Kt+(w<<3)|0,et=o[d>>2]|0,d=o[d+4>>2]|0,!((et|0)==0&(d|0)==0)){_=d,ii=17;break t}}}for(w=0,i=ot,d=_;;){if(!((i|0)==0&(d|0)==0)){if(!(!0&(d&117440512|0)==0)){ii=22;break t}if(B=Gt(i|0,d|0,52)|0,Ut()|0,B=B&15,(B|0)<(Et|0)){_=12,ii=28;break t}if((B|0)!=(Et|0)&&(i=i|Be,d=d&-15728641|et,B>>>0>=ht>>>0)){T=Et;do Te=Zt(7,0,(14-T|0)*3|0)|0,T=T+1|0,i=Te|i,d=Ut()|0|d;while(T>>>0<B>>>0)}if(T=Ct(i|0,d|0,l|0,Re|0)|0,Ut()|0,X=si+(T<<3)|0,B=X,j=o[B>>2]|0,B=o[B+4>>2]|0,(j|0)==0&(B|0)==0)T=X;else for(Te=0;;){if((Te|0)>(l|0)){ii=32;break t}if((j|0)==(i|0)&(B&-117440513|0)==(d|0)){ue=Gt(j|0,B|0,56)|0,Ut()|0,ue=ue&7,Se=ue+1|0,ai=Gt(j|0,B|0,45)|0,Ut()|0;n:do if(!(nt(ai&127)|0))B=7;else{if(j=Gt(j|0,B|0,52)|0,Ut()|0,j=j&15,!j){B=6;break}for(B=1;;){if(ai=Zt(7,0,(15-B|0)*3|0)|0,!((ai&i|0)==0&((Ut()|0)&d|0)==0)){B=7;break n}if(B>>>0<j>>>0)B=B+1|0;else{B=6;break}}}while(!1);if((ue+2|0)>>>0>B>>>0){ii=42;break t}ai=Zt(Se|0,0,56)|0,d=Ut()|0|d&-117440513,Se=X,o[Se>>2]=0,o[Se+4>>2]=0,i=ai|i}else T=(T+1|0)%(l|0)|0;if(X=si+(T<<3)|0,B=X,j=o[B>>2]|0,B=o[B+4>>2]|0,(j|0)==0&(B|0)==0){T=X;break}else Te=Te+1|0}ai=T,o[ai>>2]=i,o[ai+4>>2]=d}if(w=w+1|0,(w|0)>=(l|0))break i;d=Kt+(w<<3)|0,i=o[d>>2]|0,d=o[d+4>>2]|0}}while(!1);if((l+5|0)>>>0<11){ii=85;break}if(et=D((l|0)/6|0,8)|0,!et){ii=49;break}i:do if(vt){Te=0,Se=0;do{if(B=si+(Te<<3)|0,d=B,w=o[d>>2]|0,d=o[d+4>>2]|0,!((w|0)==0&(d|0)==0)){j=Gt(w|0,d|0,56)|0,Ut()|0,j=j&7,i=j+1|0,X=d&-117440513,ai=Gt(w|0,d|0,45)|0,Ut()|0;n:do if(nt(ai&127)|0){if(ue=Gt(w|0,d|0,52)|0,Ut()|0,ue=ue&15,ue|0)for(T=1;;){if(ai=Zt(7,0,(15-T|0)*3|0)|0,!((w&ai|0)==0&(X&(Ut()|0)|0)==0))break n;if(T>>>0<ue>>>0)T=T+1|0;else break}d=Zt(i|0,0,56)|0,w=d|w,d=Ut()|0|X,i=B,o[i>>2]=w,o[i+4>>2]=d,i=j+2|0}while(!1);(i|0)==7&&(ai=et+(Se<<3)|0,o[ai>>2]=w,o[ai+4>>2]=d&-117440513,Se=Se+1|0)}Te=Te+1|0}while((Te|0)!=(l|0));if(vt){if(Te=((l|0)<0)<<31>>31,Re=Zt(Et|0,0,52)|0,Be=Ut()|0,Et>>>0>15){if(!((ot|0)==0&(_|0)==0)){_=4,ii=84;break t}for(_=0;;){if(_=_+1|0,(_|0)>=(l|0)){w=0,_=Se;break i}if(ai=Kt+(_<<3)|0,!((o[ai>>2]|0)==0&(o[ai+4>>2]|0)==0)){_=4,ii=84;break t}}}for(ue=0,w=0,X=ot;;){do if(!((X|0)==0&(_|0)==0)){if(B=Gt(X|0,_|0,52)|0,Ut()|0,B=B&15,(B|0)<(Et|0)){_=12,ii=84;break t}do if((B|0)==(Et|0))d=X,B=_;else{if(d=X|Re,i=_&-15728641|Be,B>>>0<ht>>>0){B=i;break}T=Et;do ai=Zt(7,0,(14-T|0)*3|0)|0,T=T+1|0,d=ai|d,i=Ut()|0|i;while(T>>>0<B>>>0);B=i}while(!1);for(T=Ct(d|0,B|0,l|0,Te|0)|0,Ut()|0,i=0;;){if((i|0)>(l|0)){ii=77;break t}if(ai=si+(T<<3)|0,j=o[ai+4>>2]|0,(j&-117440513|0)==(B|0)&&(o[ai>>2]|0)==(d|0)){ii=79;break}if(T=(T+1|0)%(l|0)|0,ai=si+(T<<3)|0,(o[ai>>2]|0)==(d|0)&&(o[ai+4>>2]|0)==(B|0))break;i=i+1|0}if((ii|0)==79&&(ii=0,!0&(j&117440512|0)==100663296))break;ai=r+(w<<3)|0,o[ai>>2]=X,o[ai+4>>2]=_,w=w+1|0}while(!1);if(_=ue+1|0,(_|0)>=(l|0)){_=Se;break i}ai=Kt+(_<<3)|0,ue=_,X=o[ai>>2]|0,_=o[ai+4>>2]|0}}else w=0,_=Se}else w=0,_=0;while(!1);if(O(si|0,0,wt|0)|0,F(Kt|0,et|0,_<<3|0)|0,C(et),_)r=r+(w<<3)|0,l=_;else break e}if((ii|0)==17)!0&(_&117440512|0)==0?(_=4,ii=28):ii=22;else if((ii|0)==32)Tn(23313,22674,362,22684);else{if((ii|0)==42)return C(Kt),C(si),ai=10,ai|0;if((ii|0)==49)return C(Kt),C(si),ai=13,ai|0;if((ii|0)==77)Tn(23313,22674,462,22684);else{if((ii|0)==84)return C(et),C(Kt),C(si),ai=_,ai|0;if((ii|0)==85){F(r|0,Kt|0,l<<3|0)|0;break}}}if((ii|0)==22)return C(Kt),C(si),ai=5,ai|0;if((ii|0)==28)return C(Kt),C(si),ai=_,ai|0}while(!1);return C(Kt),C(si),ai=0,ai|0}function ul(i,r,l,d,_,w,T){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0,T=T|0;var B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0,et=0;if(et=Dt,Dt=Dt+16|0,Be=et,!((l|0)>0|(l|0)==0&r>>>0>0))return Be=0,Dt=et,Be|0;if((T|0)>=16)return Be=12,Dt=et,Be|0;Te=0,Re=0,Se=0,B=0;e:for(;;){if(X=i+(Te<<3)|0,j=o[X>>2]|0,X=o[X+4>>2]|0,ue=Gt(j|0,X|0,52)|0,Ut()|0,(ue&15|0)>(T|0)){B=12,j=11;break}if(cl(Be,j,X,T),ue=Be,X=o[ue>>2]|0,ue=o[ue+4>>2]|0,(X|0)==0&(ue|0)==0)j=Se;else{j=Se;do{if(!((B|0)<(w|0)|(B|0)==(w|0)&j>>>0<_>>>0)){j=10;break e}Se=d+(j<<3)|0,o[Se>>2]=X,o[Se+4>>2]=ue,j=z(j|0,B|0,1,0)|0,B=Ut()|0,lu(Be),Se=Be,X=o[Se>>2]|0,ue=o[Se+4>>2]|0}while(!((X|0)==0&(ue|0)==0))}if(Te=z(Te|0,Re|0,1,0)|0,Re=Ut()|0,(Re|0)<(l|0)|(Re|0)==(l|0)&Te>>>0<r>>>0)Se=j;else{B=0,j=11;break}}return(j|0)==10?(Be=14,Dt=et,Be|0):(j|0)==11?(Dt=et,B|0):0}function Qr(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0;Te=Dt,Dt=Dt+16|0,Se=Te;e:do if((l|0)>0|(l|0)==0&r>>>0>0){for(X=0,T=0,w=0,ue=0;;){if(j=i+(X<<3)|0,B=o[j>>2]|0,j=o[j+4>>2]|0,!((B|0)==0&(j|0)==0)&&(j=(Ms(B,j,d,Se)|0)==0,B=Se,T=z(o[B>>2]|0,o[B+4>>2]|0,T|0,w|0)|0,w=Ut()|0,!j)){w=12;break}if(X=z(X|0,ue|0,1,0)|0,ue=Ut()|0,!((ue|0)<(l|0)|(ue|0)==(l|0)&X>>>0<r>>>0))break e}return Dt=Te,w|0}else T=0,w=0;while(!1);return o[_>>2]=T,o[_+4>>2]=w,_=0,Dt=Te,_|0}function ds(i,r){return i=i|0,r=r|0,r=Gt(i|0,r|0,52)|0,Ut()|0,r&1|0}function Ia(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;if(_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15,!_)return _=0,_|0;for(d=1;;){if(l=Gt(i|0,r|0,(15-d|0)*3|0)|0,Ut()|0,l=l&7,l|0){d=5;break}if(d>>>0<_>>>0)d=d+1|0;else{l=0,d=5;break}}return(d|0)==5?l|0:0}function Tl(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0;if(j=Gt(i|0,r|0,52)|0,Ut()|0,j=j&15,!j)return B=r,j=i,Yi(B|0),j|0;for(B=1,l=0;;){w=(15-B|0)*3|0,d=Zt(7,0,w|0)|0,_=Ut()|0,T=Gt(i|0,r|0,w|0)|0,Ut()|0,w=Zt(Ma(T&7)|0,0,w|0)|0,T=Ut()|0,i=w|i&~d,r=T|r&~_;e:do if(!l)if((w&d|0)==0&(T&_|0)==0)l=0;else if(d=Gt(i|0,r|0,52)|0,Ut()|0,d=d&15,!d)l=1;else{l=1;t:for(;;){switch(T=Gt(i|0,r|0,(15-l|0)*3|0)|0,Ut()|0,T&7){case 1:break t;case 0:break;default:{l=1;break e}}if(l>>>0<d>>>0)l=l+1|0;else{l=1;break e}}for(l=1;;)if(T=(15-l|0)*3|0,_=Gt(i|0,r|0,T|0)|0,Ut()|0,w=Zt(7,0,T|0)|0,r=r&~(Ut()|0),T=Zt(Ma(_&7)|0,0,T|0)|0,i=i&~w|T,r=r|(Ut()|0),l>>>0<d>>>0)l=l+1|0;else{l=1;break}}while(!1);if(B>>>0<j>>>0)B=B+1|0;else break}return Yi(r|0),i|0}function Do(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0;if(d=Gt(i|0,r|0,52)|0,Ut()|0,d=d&15,!d)return l=r,d=i,Yi(l|0),d|0;for(l=1;w=(15-l|0)*3|0,T=Gt(i|0,r|0,w|0)|0,Ut()|0,_=Zt(7,0,w|0)|0,r=r&~(Ut()|0),w=Zt(Ma(T&7)|0,0,w|0)|0,i=w|i&~_,r=Ut()|0|r,l>>>0<d>>>0;)l=l+1|0;return Yi(r|0),i|0}function kl(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0;if(j=Gt(i|0,r|0,52)|0,Ut()|0,j=j&15,!j)return B=r,j=i,Yi(B|0),j|0;for(B=1,l=0;;){w=(15-B|0)*3|0,d=Zt(7,0,w|0)|0,_=Ut()|0,T=Gt(i|0,r|0,w|0)|0,Ut()|0,w=Zt(ml(T&7)|0,0,w|0)|0,T=Ut()|0,i=w|i&~d,r=T|r&~_;e:do if(!l)if((w&d|0)==0&(T&_|0)==0)l=0;else if(d=Gt(i|0,r|0,52)|0,Ut()|0,d=d&15,!d)l=1;else{l=1;t:for(;;){switch(T=Gt(i|0,r|0,(15-l|0)*3|0)|0,Ut()|0,T&7){case 1:break t;case 0:break;default:{l=1;break e}}if(l>>>0<d>>>0)l=l+1|0;else{l=1;break e}}for(l=1;;)if(_=(15-l|0)*3|0,w=Zt(7,0,_|0)|0,T=r&~(Ut()|0),r=Gt(i|0,r|0,_|0)|0,Ut()|0,r=Zt(ml(r&7)|0,0,_|0)|0,i=i&~w|r,r=T|(Ut()|0),l>>>0<d>>>0)l=l+1|0;else{l=1;break}}while(!1);if(B>>>0<j>>>0)B=B+1|0;else break}return Yi(r|0),i|0}function go(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0;if(d=Gt(i|0,r|0,52)|0,Ut()|0,d=d&15,!d)return l=r,d=i,Yi(l|0),d|0;for(l=1;T=(15-l|0)*3|0,w=Zt(7,0,T|0)|0,_=r&~(Ut()|0),r=Gt(i|0,r|0,T|0)|0,Ut()|0,r=Zt(ml(r&7)|0,0,T|0)|0,i=r|i&~w,r=Ut()|0|_,l>>>0<d>>>0;)l=l+1|0;return Yi(r|0),i|0}function Js(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0,ue=0;if(j=Dt,Dt=Dt+64|0,B=j+40|0,d=j+24|0,_=j+12|0,w=j,Zt(r|0,0,52)|0,l=Ut()|0|134225919,!r)return(o[i+4>>2]|0)>2||(o[i+8>>2]|0)>2||(o[i+12>>2]|0)>2?(T=0,B=0,Yi(T|0),Dt=j,B|0):(Zt($t(i)|0,0,45)|0,T=Ut()|0|l,B=-1,Yi(T|0),Dt=j,B|0);if(o[B>>2]=o[i>>2],o[B+4>>2]=o[i+4>>2],o[B+8>>2]=o[i+8>>2],o[B+12>>2]=o[i+12>>2],T=B+4|0,(r|0)>0)for(i=-1;o[d>>2]=o[T>>2],o[d+4>>2]=o[T+4>>2],o[d+8>>2]=o[T+8>>2],r&1?(Il(T),o[_>>2]=o[T>>2],o[_+4>>2]=o[T+4>>2],o[_+8>>2]=o[T+8>>2],Qo(_)):(mo(T),o[_>>2]=o[T>>2],o[_+4>>2]=o[T+4>>2],o[_+8>>2]=o[T+8>>2],ha(_)),Ks(d,_,w),Lr(w),ue=(15-r|0)*3|0,X=Zt(7,0,ue|0)|0,l=l&~(Ut()|0),ue=Zt(To(w)|0,0,ue|0)|0,i=ue|i&~X,l=Ut()|0|l,(r|0)>1;)r=r+-1|0;else i=-1;e:do if((o[T>>2]|0)<=2&&(o[B+8>>2]|0)<=2&&(o[B+12>>2]|0)<=2){if(d=$t(B)|0,r=Zt(d|0,0,45)|0,r=r|i,i=Ut()|0|l&-1040385,w=wi(B)|0,!(nt(d)|0)){if((w|0)<=0)break;for(_=0;;){if(d=Gt(r|0,i|0,52)|0,Ut()|0,d=d&15,d)for(l=1;ue=(15-l|0)*3|0,B=Gt(r|0,i|0,ue|0)|0,Ut()|0,X=Zt(7,0,ue|0)|0,i=i&~(Ut()|0),ue=Zt(Ma(B&7)|0,0,ue|0)|0,r=r&~X|ue,i=i|(Ut()|0),l>>>0<d>>>0;)l=l+1|0;if(_=_+1|0,(_|0)==(w|0))break e}}_=Gt(r|0,i|0,52)|0,Ut()|0,_=_&15;t:do if(_){l=1;i:for(;;){switch(ue=Gt(r|0,i|0,(15-l|0)*3|0)|0,Ut()|0,ue&7){case 1:break i;case 0:break;default:break t}if(l>>>0<_>>>0)l=l+1|0;else break t}if(dn(d,o[B>>2]|0)|0)for(l=1;B=(15-l|0)*3|0,X=Zt(7,0,B|0)|0,ue=i&~(Ut()|0),i=Gt(r|0,i|0,B|0)|0,Ut()|0,i=Zt(ml(i&7)|0,0,B|0)|0,r=r&~X|i,i=ue|(Ut()|0),l>>>0<_>>>0;)l=l+1|0;else for(l=1;ue=(15-l|0)*3|0,B=Gt(r|0,i|0,ue|0)|0,Ut()|0,X=Zt(7,0,ue|0)|0,i=i&~(Ut()|0),ue=Zt(Ma(B&7)|0,0,ue|0)|0,r=r&~X|ue,i=i|(Ut()|0),l>>>0<_>>>0;)l=l+1|0}while(!1);if((w|0)>0){l=0;do r=Tl(r,i)|0,i=Ut()|0,l=l+1|0;while((l|0)!=(w|0))}}else r=0,i=0;while(!1);return X=i,ue=r,Yi(X|0),Dt=j,ue|0}function qs(i){return i=i|0,(i|0)%2|0|0}function Ya(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;return _=Dt,Dt=Dt+16|0,d=_,r>>>0>15?(d=4,Dt=_,d|0):(o[i+4>>2]&2146435072|0)==2146435072||(o[i+8+4>>2]&2146435072|0)==2146435072?(d=3,Dt=_,d|0):($a(i,r,d),r=Js(d,r)|0,d=Ut()|0,o[l>>2]=r,o[l+4>>2]=d,(r|0)==0&(d|0)==0&&Tn(23313,22674,786,22697),d=0,Dt=_,d|0)}function Jo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;if(_=l+4|0,w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,T=Gt(i|0,r|0,45)|0,Ut()|0,d=(w|0)==0,nt(T&127)|0){if(d)return T=1,T|0;d=1}else{if(d)return T=0,T|0;!(o[_>>2]|0)&&!(o[l+8>>2]|0)?d=(o[l+12>>2]|0)!=0&1:d=1}for(l=1;l&1?Qo(_):ha(_),T=Gt(i|0,r|0,(15-l|0)*3|0)|0,Ut()|0,Ys(_,T&7),l>>>0<w>>>0;)l=l+1|0;return d|0}function Yr(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ue=0;if(ue=Dt,Dt=Dt+16|0,j=ue,X=Gt(i|0,r|0,45)|0,Ut()|0,X=X&127,X>>>0>121)return o[l>>2]=0,o[l+4>>2]=0,o[l+8>>2]=0,o[l+12>>2]=0,X=5,Dt=ue,X|0;e:do if(nt(X)|0&&(w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,(w|0)!=0)){d=1;t:for(;;){switch(B=Gt(i|0,r|0,(15-d|0)*3|0)|0,Ut()|0,B&7){case 5:break t;case 0:break;default:{d=r;break e}}if(d>>>0<w>>>0)d=d+1|0;else{d=r;break e}}for(_=1,d=r;r=(15-_|0)*3|0,T=Zt(7,0,r|0)|0,B=d&~(Ut()|0),d=Gt(i|0,d|0,r|0)|0,Ut()|0,d=Zt(ml(d&7)|0,0,r|0)|0,i=i&~T|d,d=B|(Ut()|0),_>>>0<w>>>0;)_=_+1|0}else d=r;while(!1);if(B=7696+(X*28|0)|0,o[l>>2]=o[B>>2],o[l+4>>2]=o[B+4>>2],o[l+8>>2]=o[B+8>>2],o[l+12>>2]=o[B+12>>2],!(Jo(i,d,l)|0))return X=0,Dt=ue,X|0;if(T=l+4|0,o[j>>2]=o[T>>2],o[j+4>>2]=o[T+4>>2],o[j+8>>2]=o[T+8>>2],w=Gt(i|0,d|0,52)|0,Ut()|0,B=w&15,w&1?(ha(T),w=B+1|0):w=B,!(nt(X)|0))d=0;else{e:do if(!B)d=0;else for(r=1;;){if(_=Gt(i|0,d|0,(15-r|0)*3|0)|0,Ut()|0,_=_&7,_|0){d=_;break e}if(r>>>0<B>>>0)r=r+1|0;else{d=0;break}}while(!1);d=(d|0)==4&1}if(!(Xa(l,w,d,0)|0))(w|0)!=(B|0)&&(o[T>>2]=o[j>>2],o[T+4>>2]=o[j+4>>2],o[T+8>>2]=o[j+8>>2]);else{if(nt(X)|0)do;while(Xa(l,w,0,0)|0);(w|0)!=(B|0)&&mo(T)}return X=0,Dt=ue,X|0}function gr(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;return w=Dt,Dt=Dt+16|0,d=w,_=Yr(i,r,d)|0,_|0?(Dt=w,_|0):(_=Gt(i|0,r|0,52)|0,Ut()|0,$n(d,_&15,l),_=0,Dt=w,_|0)}function Nr(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0;if(T=Dt,Dt=Dt+16|0,w=T,d=Yr(i,r,w)|0,d|0)return w=d,Dt=T,w|0;d=Gt(i|0,r|0,45)|0,Ut()|0,d=(nt(d&127)|0)==0,_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15;e:do if(!d){if(_|0)for(d=1;;){if(B=Zt(7,0,(15-d|0)*3|0)|0,!((B&i|0)==0&((Ut()|0)&r|0)==0))break e;if(d>>>0<_>>>0)d=d+1|0;else break}return Ko(w,_,0,5,l),B=0,Dt=T,B|0}while(!1);return fr(w,_,0,6,l),B=0,Dt=T,B|0}function Aa(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if(_=Gt(i|0,r|0,45)|0,Ut()|0,!(nt(_&127)|0))return _=2,o[l>>2]=_,0;if(_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15,!_)return _=5,o[l>>2]=_,0;for(d=1;;){if(w=Zt(7,0,(15-d|0)*3|0)|0,!((w&i|0)==0&((Ut()|0)&r|0)==0)){d=2,i=6;break}if(d>>>0<_>>>0)d=d+1|0;else{d=5,i=6;break}}return(i|0)==6&&(o[l>>2]=d),0}function _o(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ue=0,Se=0;Se=Dt,Dt=Dt+128|0,X=Se+112|0,w=Se+96|0,ue=Se,_=Gt(i|0,r|0,52)|0,Ut()|0,B=_&15,o[X>>2]=B,T=Gt(i|0,r|0,45)|0,Ut()|0,T=T&127;e:do if(nt(T)|0){if(B|0)for(d=1;;){if(j=Zt(7,0,(15-d|0)*3|0)|0,!((j&i|0)==0&((Ut()|0)&r|0)==0)){_=0;break e}if(d>>>0<B>>>0)d=d+1|0;else break}if(_&1)_=1;else return j=Zt(B+1|0,0,52)|0,ue=Ut()|0|r&-15728641,X=Zt(7,0,(14-B|0)*3|0)|0,ue=_o((j|i)&~X,ue&~(Ut()|0),l)|0,Dt=Se,ue|0}else _=0;while(!1);if(d=Yr(i,r,w)|0,!d){_?(zr(w,X,ue),j=5):(Mo(w,X,ue),j=6);e:do if(nt(T)|0)if(!B)i=5;else for(d=1;;){if(T=Zt(7,0,(15-d|0)*3|0)|0,!((T&i|0)==0&((Ut()|0)&r|0)==0)){i=2;break e}if(d>>>0<B>>>0)d=d+1|0;else{i=5;break}}else i=2;while(!1);O(l|0,-1,i<<2|0)|0;e:do if(_)for(w=0;;){if(T=ue+(w<<4)|0,is(T,o[X>>2]|0)|0,T=o[T>>2]|0,B=o[l>>2]|0,(B|0)==-1|(B|0)==(T|0))d=l;else{_=0;do{if(_=_+1|0,_>>>0>=i>>>0){d=1;break e}d=l+(_<<2)|0,B=o[d>>2]|0}while(!((B|0)==-1|(B|0)==(T|0)))}if(o[d>>2]=T,w=w+1|0,w>>>0>=j>>>0){d=0;break}}else for(w=0;;){if(T=ue+(w<<4)|0,Xa(T,o[X>>2]|0,0,1)|0,T=o[T>>2]|0,B=o[l>>2]|0,(B|0)==-1|(B|0)==(T|0))d=l;else{_=0;do{if(_=_+1|0,_>>>0>=i>>>0){d=1;break e}d=l+(_<<2)|0,B=o[d>>2]|0}while(!((B|0)==-1|(B|0)==(T|0)))}if(o[d>>2]=T,w=w+1|0,w>>>0>=j>>>0){d=0;break}}while(!1)}return ue=d,Dt=Se,ue|0}function ea(){return 12}function Ea(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0;if(i>>>0>15)return B=4,B|0;if(Zt(i|0,0,52)|0,B=Ut()|0|134225919,!i){l=0,d=0;do nt(d)|0&&(Zt(d|0,0,45)|0,T=B|(Ut()|0),i=r+(l<<3)|0,o[i>>2]=-1,o[i+4>>2]=T,l=l+1|0),d=d+1|0;while((d|0)!=122);return l=0,l|0}l=0,T=0;do{if(nt(T)|0){for(Zt(T|0,0,45)|0,d=1,_=-1,w=B|(Ut()|0);j=Zt(7,0,(15-d|0)*3|0)|0,_=_&~j,w=w&~(Ut()|0),(d|0)!=(i|0);)d=d+1|0;j=r+(l<<3)|0,o[j>>2]=_,o[j+4>>2]=w,l=l+1|0}T=T+1|0}while((T|0)!=122);return l=0,l|0}function Pa(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0,et=0,vt=0,ot=0,ht=0;if(ht=Dt,Dt=Dt+16|0,vt=ht,ot=Gt(i|0,r|0,52)|0,Ut()|0,ot=ot&15,l>>>0>15)return ot=4,Dt=ht,ot|0;if((ot|0)<(l|0))return ot=12,Dt=ht,ot|0;if((ot|0)!=(l|0))if(w=Zt(l|0,0,52)|0,w=w|i,B=Ut()|0|r&-15728641,(ot|0)>(l|0)){j=l;do et=Zt(7,0,(14-j|0)*3|0)|0,j=j+1|0,w=et|w,B=Ut()|0|B;while((j|0)<(ot|0));et=w}else et=w;else et=i,B=r;Be=Gt(et|0,B|0,45)|0,Ut()|0;e:do if(nt(Be&127)|0){if(j=Gt(et|0,B|0,52)|0,Ut()|0,j=j&15,j|0)for(w=1;;){if(Be=Zt(7,0,(15-w|0)*3|0)|0,!((Be&et|0)==0&((Ut()|0)&B|0)==0)){X=33;break e}if(w>>>0<j>>>0)w=w+1|0;else break}if(Be=d,o[Be>>2]=0,o[Be+4>>2]=0,(ot|0)>(l|0)){for(Be=r&-15728641,Re=ot;;){if(Te=Re,Re=Re+-1|0,Re>>>0>15|(ot|0)<(Re|0)){X=19;break}if((ot|0)!=(Re|0))if(w=Zt(Re|0,0,52)|0,w=w|i,j=Ut()|0|Be,(ot|0)<(Te|0))Se=w;else{X=Re;do Se=Zt(7,0,(14-X|0)*3|0)|0,X=X+1|0,w=Se|w,j=Ut()|0|j;while((X|0)<(ot|0));Se=w}else Se=i,j=r;if(ue=Gt(Se|0,j|0,45)|0,Ut()|0,!(nt(ue&127)|0))w=0;else{ue=Gt(Se|0,j|0,52)|0,Ut()|0,ue=ue&15;t:do if(!ue)w=0;else for(X=1;;){if(w=Gt(Se|0,j|0,(15-X|0)*3|0)|0,Ut()|0,w=w&7,w|0)break t;if(X>>>0<ue>>>0)X=X+1|0;else{w=0;break}}while(!1);w=(w|0)==0&1}if(j=Gt(i|0,r|0,(15-Te|0)*3|0)|0,Ut()|0,j=j&7,(j|0)==7){_=5,X=42;break}if(w=(w|0)!=0,(j|0)==1&w){_=5,X=42;break}if(Se=j+(((j|0)!=0&w)<<31>>31)|0,Se|0&&(X=ot-Te|0,X=_l(7,0,X,((X|0)<0)<<31>>31)|0,ue=Ut()|0,w?(w=We(X|0,ue|0,5,0)|0,w=z(w|0,Ut()|0,-5,-1)|0,w=oe(w|0,Ut()|0,6,0)|0,w=z(w|0,Ut()|0,1,0)|0,j=Ut()|0):(w=X,j=ue),Te=Se+-1|0,Te=We(X|0,ue|0,Te|0,((Te|0)<0)<<31>>31|0)|0,Te=z(w|0,j|0,Te|0,Ut()|0)|0,Se=Ut()|0,ue=d,ue=z(Te|0,Se|0,o[ue>>2]|0,o[ue+4>>2]|0)|0,Se=Ut()|0,Te=d,o[Te>>2]=ue,o[Te+4>>2]=Se),(Re|0)<=(l|0)){X=37;break}}if((X|0)==19)Tn(23313,22674,1099,22710);else if((X|0)==37){T=d,_=o[T+4>>2]|0,T=o[T>>2]|0;break}else if((X|0)==42)return Dt=ht,_|0}else _=0,T=0}else X=33;while(!1);e:do if((X|0)==33)if(Be=d,o[Be>>2]=0,o[Be+4>>2]=0,(ot|0)>(l|0)){for(w=ot;;){if(_=Gt(i|0,r|0,(15-w|0)*3|0)|0,Ut()|0,_=_&7,(_|0)==7){_=5;break}if(T=ot-w|0,T=_l(7,0,T,((T|0)<0)<<31>>31)|0,_=We(T|0,Ut()|0,_|0,0)|0,T=Ut()|0,Be=d,T=z(o[Be>>2]|0,o[Be+4>>2]|0,_|0,T|0)|0,_=Ut()|0,Be=d,o[Be>>2]=T,o[Be+4>>2]=_,w=w+-1|0,(w|0)<=(l|0))break e}return Dt=ht,_|0}else _=0,T=0;while(!1);return Ms(et,B,ot,vt)|0&&Tn(23313,22674,1063,22725),ot=vt,vt=o[ot+4>>2]|0,((_|0)>-1|(_|0)==-1&T>>>0>4294967295)&((vt|0)>(_|0)|((vt|0)==(_|0)?(o[ot>>2]|0)>>>0>T>>>0:0))?(ot=0,Dt=ht,ot|0):(Tn(23313,22674,1139,22710),0)}function Ka(i,r,l,d,_,w){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0;var T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0,et=0;if(Se=Dt,Dt=Dt+16|0,T=Se,_>>>0>15)return w=4,Dt=Se,w|0;if(B=Gt(l|0,d|0,52)|0,Ut()|0,B=B&15,(B|0)>(_|0))return w=12,Dt=Se,w|0;if(Ms(l,d,_,T)|0&&Tn(23313,22674,1063,22725),ue=T,X=o[ue+4>>2]|0,!(((r|0)>-1|(r|0)==-1&i>>>0>4294967295)&((X|0)>(r|0)|((X|0)==(r|0)?(o[ue>>2]|0)>>>0>i>>>0:0))))return w=2,Dt=Se,w|0;ue=_-B|0,_=Zt(_|0,0,52)|0,j=Ut()|0|d&-15728641,X=w,o[X>>2]=_|l,o[X+4>>2]=j,X=Gt(l|0,d|0,45)|0,Ut()|0;e:do if(nt(X&127)|0){if(B|0)for(T=1;;){if(X=Zt(7,0,(15-T|0)*3|0)|0,!((X&l|0)==0&((Ut()|0)&d|0)==0))break e;if(T>>>0<B>>>0)T=T+1|0;else break}if((ue|0)<1)return w=0,Dt=Se,w|0;for(X=B^15,d=-1,j=1,T=1;;){B=ue-j|0,B=_l(7,0,B,((B|0)<0)<<31>>31)|0,l=Ut()|0;do if(T)if(T=We(B|0,l|0,5,0)|0,T=z(T|0,Ut()|0,-5,-1)|0,T=oe(T|0,Ut()|0,6,0)|0,_=Ut()|0,(r|0)>(_|0)|(r|0)==(_|0)&i>>>0>T>>>0){r=z(i|0,r|0,-1,-1)|0,r=R(r|0,Ut()|0,T|0,_|0)|0,T=Ut()|0,Te=w,Be=o[Te>>2]|0,Te=o[Te+4>>2]|0,et=(X+d|0)*3|0,Re=Zt(7,0,et|0)|0,Te=Te&~(Ut()|0),d=oe(r|0,T|0,B|0,l|0)|0,i=Ut()|0,_=z(d|0,i|0,2,0)|0,et=Zt(_|0,Ut()|0,et|0)|0,Te=Ut()|0|Te,_=w,o[_>>2]=et|Be&~Re,o[_+4>>2]=Te,i=We(d|0,i|0,B|0,l|0)|0,i=R(r|0,T|0,i|0,Ut()|0)|0,T=0,r=Ut()|0;break}else{et=w,Re=o[et>>2]|0,et=o[et+4>>2]|0,Be=Zt(7,0,(X+d|0)*3|0)|0,et=et&~(Ut()|0),T=w,o[T>>2]=Re&~Be,o[T+4>>2]=et,T=1;break}else Re=w,_=o[Re>>2]|0,Re=o[Re+4>>2]|0,d=(X+d|0)*3|0,Te=Zt(7,0,d|0)|0,Re=Re&~(Ut()|0),et=oe(i|0,r|0,B|0,l|0)|0,T=Ut()|0,d=Zt(et|0,T|0,d|0)|0,Re=Ut()|0|Re,Be=w,o[Be>>2]=d|_&~Te,o[Be+4>>2]=Re,T=We(et|0,T|0,B|0,l|0)|0,i=R(i|0,r|0,T|0,Ut()|0)|0,T=0,r=Ut()|0;while(!1);if((ue|0)>(j|0))d=~j,j=j+1|0;else{r=0;break}}return Dt=Se,r|0}while(!1);if((ue|0)<1)return et=0,Dt=Se,et|0;for(_=B^15,T=1;;)if(Be=ue-T|0,Be=_l(7,0,Be,((Be|0)<0)<<31>>31)|0,et=Ut()|0,j=w,l=o[j>>2]|0,j=o[j+4>>2]|0,B=(_-T|0)*3|0,d=Zt(7,0,B|0)|0,j=j&~(Ut()|0),Te=oe(i|0,r|0,Be|0,et|0)|0,Re=Ut()|0,B=Zt(Te|0,Re|0,B|0)|0,j=Ut()|0|j,X=w,o[X>>2]=B|l&~d,o[X+4>>2]=j,et=We(Te|0,Re|0,Be|0,et|0)|0,i=R(i|0,r|0,et|0,Ut()|0)|0,r=Ut()|0,(ue|0)<=(T|0)){r=0;break}else T=T+1|0;return Dt=Se,r|0}function cl(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0;_=Gt(r|0,l|0,52)|0,Ut()|0,_=_&15,(r|0)==0&(l|0)==0|((d|0)>15|(_|0)>(d|0))?(d=-1,_=-1,r=0,l=0):(w=ll(r,l,_+1|0,d)|0,l=(Ut()|0)&-15728641,r=Zt(d|0,0,52)|0,r=w|r,l=l|(Ut()|0),w=(Mr(r,l)|0)==0,d=w?-1:d),w=i,o[w>>2]=r,o[w+4>>2]=l,o[i+8>>2]=_,o[i+12>>2]=d}function lu(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0;if(l=i,r=o[l>>2]|0,l=o[l+4>>2]|0,!((r|0)==0&(l|0)==0)&&(d=Gt(r|0,l|0,52)|0,Ut()|0,d=d&15,B=Zt(1,0,(d^15)*3|0)|0,r=z(B|0,Ut()|0,r|0,l|0)|0,l=Ut()|0,B=i,o[B>>2]=r,o[B+4>>2]=l,B=i+8|0,T=o[B>>2]|0,!((d|0)<(T|0)))){for(j=i+12|0,w=d;;){if((w|0)==(T|0)){d=5;break}if(X=(w|0)==(o[j>>2]|0),_=(15-w|0)*3|0,d=Gt(r|0,l|0,_|0)|0,Ut()|0,d=d&7,X&((d|0)==1&!0)){d=7;break}if(!((d|0)==7&!0)){d=10;break}if(X=Zt(1,0,_|0)|0,r=z(r|0,l|0,X|0,Ut()|0)|0,l=Ut()|0,X=i,o[X>>2]=r,o[X+4>>2]=l,(w|0)>(T|0))w=w+-1|0;else{d=10;break}}if((d|0)==5){X=i,o[X>>2]=0,o[X+4>>2]=0,o[B>>2]=-1,o[j>>2]=-1;return}else if((d|0)==7){T=Zt(1,0,_|0)|0,T=z(r|0,l|0,T|0,Ut()|0)|0,B=Ut()|0,X=i,o[X>>2]=T,o[X+4>>2]=B,o[j>>2]=w+-1;return}else if((d|0)==10)return}}function gl(i){i=+i;var r=0;return r=i<0?i+6.283185307179586:i,+(i>=6.283185307179586?r+-6.283185307179586:r)}function ao(i,r){return i=i|0,r=r|0,+ti(+(+ke[i>>3]-+ke[r>>3]))<17453292519943298e-27?(r=+ti(+(+ke[i+8>>3]-+ke[r+8>>3]))<17453292519943298e-27,r|0):(r=0,r|0)}function pi(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return _=+ke[r>>3],d=+ke[i>>3],w=+bi(+((_-d)*.5)),l=+bi(+((+ke[r+8>>3]-+ke[i+8>>3])*.5)),l=w*w+l*(+vi(+_)*+vi(+d)*l),+(+Hn(+ +li(+l),+ +li(+(1-l)))*2)}function Vi(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return _=+ke[r>>3],d=+ke[i>>3],w=+bi(+((_-d)*.5)),l=+bi(+((+ke[r+8>>3]-+ke[i+8>>3])*.5)),l=w*w+l*(+vi(+_)*+vi(+d)*l),+(+Hn(+ +li(+l),+ +li(+(1-l)))*2*6371.007180918475)}function Pi(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return _=+ke[r>>3],d=+ke[i>>3],w=+bi(+((_-d)*.5)),l=+bi(+((+ke[r+8>>3]-+ke[i+8>>3])*.5)),l=w*w+l*(+vi(+_)*+vi(+d)*l),+(+Hn(+ +li(+l),+ +li(+(1-l)))*2*6371.007180918475*1e3)}function Ft(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0;return w=+ke[r>>3],d=+vi(+w),_=+ke[r+8>>3]-+ke[i+8>>3],T=d*+bi(+_),l=+ke[i>>3],+ +Hn(+T,+(+bi(+w)*+vi(+l)-+vi(+_)*(d*+bi(+l))))}function ni(i,r,l,d){i=i|0,r=+r,l=+l,d=d|0;var _=0,w=0,T=0,B=0;if(l<1e-16){o[d>>2]=o[i>>2],o[d+4>>2]=o[i+4>>2],o[d+8>>2]=o[i+8>>2],o[d+12>>2]=o[i+12>>2];return}w=r<0?r+6.283185307179586:r,w=r>=6.283185307179586?w+-6.283185307179586:w;do if(w<1e-16)r=+ke[i>>3]+l,ke[d>>3]=r,_=d;else{if(_=+ti(+(w+-3.141592653589793))<1e-16,r=+ke[i>>3],_){r=r-l,ke[d>>3]=r,_=d;break}if(T=+vi(+l),l=+bi(+l),r=T*+bi(+r)+ +vi(+w)*(l*+vi(+r)),r=r>1?1:r,r=+ar(+(r<-1?-1:r)),ke[d>>3]=r,+ti(+(r+-1.5707963267948966))<1e-16){ke[d>>3]=1.5707963267948966,ke[d+8>>3]=0;return}if(+ti(+(r+1.5707963267948966))<1e-16){ke[d>>3]=-1.5707963267948966,ke[d+8>>3]=0;return}if(B=+vi(+r),w=l*+bi(+w)/B,l=+ke[i>>3],r=(T-+bi(+r)*+bi(+l))/+vi(+l)/B,T=w>1?1:w,r=r>1?1:r,r=+ke[i+8>>3]+ +Hn(+(T<-1?-1:T),+(r<-1?-1:r)),r>3.141592653589793)do r=r+-6.283185307179586;while(r>3.141592653589793);if(r<-3.141592653589793)do r=r+6.283185307179586;while(r<-3.141592653589793);ke[d+8>>3]=r;return}while(!1);if(+ti(+(r+-1.5707963267948966))<1e-16){ke[_>>3]=1.5707963267948966,ke[d+8>>3]=0;return}if(+ti(+(r+1.5707963267948966))<1e-16){ke[_>>3]=-1.5707963267948966,ke[d+8>>3]=0;return}if(r=+ke[i+8>>3],r>3.141592653589793)do r=r+-6.283185307179586;while(r>3.141592653589793);if(r<-3.141592653589793)do r=r+6.283185307179586;while(r<-3.141592653589793);ke[d+8>>3]=r}function xi(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(ke[r>>3]=+ke[20528+(i<<3)>>3],r=0,r|0)}function Fi(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(ke[r>>3]=+ke[20656+(i<<3)>>3],r=0,r|0)}function Ln(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(ke[r>>3]=+ke[20784+(i<<3)>>3],r=0,r|0)}function jn(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(ke[r>>3]=+ke[20912+(i<<3)>>3],r=0,r|0)}function or(i,r){i=i|0,r=r|0;var l=0;return i>>>0>15?(r=4,r|0):(l=_l(7,0,i,((i|0)<0)<<31>>31)|0,l=We(l|0,Ut()|0,120,0)|0,i=Ut()|0,o[r>>2]=l|2,o[r+4>>2]=i,r=0,r|0)}function Xn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0;return Te=+ke[r>>3],ue=+ke[i>>3],j=+bi(+((Te-ue)*.5)),w=+ke[r+8>>3],X=+ke[i+8>>3],T=+bi(+((w-X)*.5)),B=+vi(+ue),Se=+vi(+Te),T=j*j+T*(Se*B*T),T=+Hn(+ +li(+T),+ +li(+(1-T)))*2,j=+ke[l>>3],Te=+bi(+((j-Te)*.5)),d=+ke[l+8>>3],w=+bi(+((d-w)*.5)),_=+vi(+j),w=Te*Te+w*(Se*_*w),w=+Hn(+ +li(+w),+ +li(+(1-w)))*2,j=+bi(+((ue-j)*.5)),d=+bi(+((X-d)*.5)),d=j*j+d*(B*_*d),d=+Hn(+ +li(+d),+ +li(+(1-d)))*2,_=(T+w+d)*.5,+(+mn(+ +li(+(+Jt(+(_*.5))*+Jt(+((_-T)*.5))*+Jt(+((_-w)*.5))*+Jt(+((_-d)*.5)))))*4)}function Hs(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0;if(B=Dt,Dt=Dt+192|0,w=B+168|0,T=B,_=gr(i,r,w)|0,_|0)return l=_,Dt=B,l|0;if(Nr(i,r,T)|0&&Tn(23313,22742,386,22751),r=o[T>>2]|0,(r|0)>0){if(d=+Xn(T+8|0,T+8+(((r|0)!=1&1)<<4)|0,w)+0,(r|0)!=1){i=1;do _=i,i=i+1|0,d=d+ +Xn(T+8+(_<<4)|0,T+8+(((i|0)%(r|0)|0)<<4)|0,w);while((i|0)<(r|0))}}else d=0;return ke[l>>3]=d,l=0,Dt=B,l|0}function Ps(i,r,l){return i=i|0,r=r|0,l=l|0,i=Hs(i,r,l)|0,i|0||(ke[l>>3]=+ke[l>>3]*6371.007180918475*6371.007180918475),i|0}function ps(i,r,l){return i=i|0,r=r|0,l=l|0,i=Hs(i,r,l)|0,i|0||(ke[l>>3]=+ke[l>>3]*6371.007180918475*6371.007180918475*1e3*1e3),i|0}function Ja(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ue=0;if(B=Dt,Dt=Dt+176|0,T=B,i=Sa(i,r,T)|0,i|0)return T=i,Dt=B,T|0;if(ke[l>>3]=0,i=o[T>>2]|0,(i|0)<=1)return T=0,Dt=B,T|0;r=i+-1|0,i=0,d=+ke[T+8>>3],_=+ke[T+16>>3],w=0;do i=i+1|0,X=d,d=+ke[T+8+(i<<4)>>3],ue=+bi(+((d-X)*.5)),j=_,_=+ke[T+8+(i<<4)+8>>3],j=+bi(+((_-j)*.5)),j=ue*ue+j*(+vi(+d)*+vi(+X)*j),w=w+ +Hn(+ +li(+j),+ +li(+(1-j)))*2;while((i|0)<(r|0));return ke[l>>3]=w,T=0,Dt=B,T|0}function yo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ue=0;if(B=Dt,Dt=Dt+176|0,T=B,i=Sa(i,r,T)|0,i|0)return T=i,w=+ke[l>>3],w=w*6371.007180918475,ke[l>>3]=w,Dt=B,T|0;if(ke[l>>3]=0,i=o[T>>2]|0,(i|0)<=1)return T=0,w=0,w=w*6371.007180918475,ke[l>>3]=w,Dt=B,T|0;r=i+-1|0,i=0,d=+ke[T+8>>3],_=+ke[T+16>>3],w=0;do i=i+1|0,X=d,d=+ke[T+8+(i<<4)>>3],ue=+bi(+((d-X)*.5)),j=_,_=+ke[T+8+(i<<4)+8>>3],j=+bi(+((_-j)*.5)),j=ue*ue+j*(+vi(+X)*+vi(+d)*j),w=w+ +Hn(+ +li(+j),+ +li(+(1-j)))*2;while((i|0)!=(r|0));return ke[l>>3]=w,T=0,ue=w,ue=ue*6371.007180918475,ke[l>>3]=ue,Dt=B,T|0}function os(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ue=0;if(B=Dt,Dt=Dt+176|0,T=B,i=Sa(i,r,T)|0,i|0)return T=i,w=+ke[l>>3],w=w*6371.007180918475,w=w*1e3,ke[l>>3]=w,Dt=B,T|0;if(ke[l>>3]=0,i=o[T>>2]|0,(i|0)<=1)return T=0,w=0,w=w*6371.007180918475,w=w*1e3,ke[l>>3]=w,Dt=B,T|0;r=i+-1|0,i=0,d=+ke[T+8>>3],_=+ke[T+16>>3],w=0;do i=i+1|0,X=d,d=+ke[T+8+(i<<4)>>3],ue=+bi(+((d-X)*.5)),j=_,_=+ke[T+8+(i<<4)+8>>3],j=+bi(+((_-j)*.5)),j=ue*ue+j*(+vi(+X)*+vi(+d)*j),w=w+ +Hn(+ +li(+j),+ +li(+(1-j)))*2;while((i|0)!=(r|0));return ke[l>>3]=w,T=0,ue=w,ue=ue*6371.007180918475,ue=ue*1e3,ke[l>>3]=ue,Dt=B,T|0}function $u(i){i=i|0;var r=0,l=0,d=0;return r=D(1,12)|0,r||Tn(22832,22787,49,22845),l=i+4|0,d=o[l>>2]|0,d|0?(d=d+8|0,o[d>>2]=r,o[l>>2]=r,r|0):(o[i>>2]|0&&Tn(22862,22787,61,22885),d=i,o[d>>2]=r,o[l>>2]=r,r|0)}function Fu(i,r){i=i|0,r=r|0;var l=0,d=0;return d=Ds(24)|0,d||Tn(22899,22787,78,22913),o[d>>2]=o[r>>2],o[d+4>>2]=o[r+4>>2],o[d+8>>2]=o[r+8>>2],o[d+12>>2]=o[r+12>>2],o[d+16>>2]=0,r=i+4|0,l=o[r>>2]|0,l|0?(o[l+16>>2]=d,o[r>>2]=d,d|0):(o[i>>2]|0&&Tn(22928,22787,82,22913),o[i>>2]=d,o[r>>2]=d,d|0)}function vo(i){i=i|0;var r=0,l=0,d=0,_=0;if(i)for(d=1;;){if(r=o[i>>2]|0,r|0)do{if(l=o[r>>2]|0,l|0)do _=l,l=o[l+16>>2]|0,C(_);while(l|0);_=r,r=o[r+8>>2]|0,C(_)}while(r|0);if(r=i,i=o[i+8>>2]|0,d||C(r),i)d=0;else break}}function Ml(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0,et=0,vt=0,ot=0,ht=0,Et=0,wt=0,si=0,Kt=0,ii=0,ai=0,Zi=0,Qi=0,Si=0,Ui=0,Gi=0,un=0,Bn=0,en=0;if(_=i+8|0,o[_>>2]|0)return en=1,en|0;if(d=o[i>>2]|0,!d)return en=0,en|0;r=d,l=0;do l=l+1|0,r=o[r+8>>2]|0;while(r|0);if(l>>>0<2)return en=0,en|0;un=Ds(l<<2)|0,un||Tn(22948,22787,317,22967),Gi=Ds(l<<5)|0,Gi||Tn(22989,22787,321,22967),o[i>>2]=0,Kt=i+4|0,o[Kt>>2]=0,o[_>>2]=0,l=0,Ui=0,si=0,Se=0;e:for(;;){if(ue=o[d>>2]|0,ue){w=0,T=ue;do{if(j=+ke[T+8>>3],r=T,T=o[T+16>>2]|0,X=(T|0)==0,_=X?ue:T,B=+ke[_+8>>3],+ti(+(j-B))>3.141592653589793){en=14;break}w=w+(B-j)*(+ke[r>>3]+ +ke[_>>3])}while(!X);if((en|0)==14){en=0,w=0,r=ue;do wt=+ke[r+8>>3],Si=r+16|0,Qi=o[Si>>2]|0,Qi=Qi|0?Qi:ue,Et=+ke[Qi+8>>3],w=w+(+ke[r>>3]+ +ke[Qi>>3])*((Et<0?Et+6.283185307179586:Et)-(wt<0?wt+6.283185307179586:wt)),r=o[(r|0?Si:d)>>2]|0;while(r|0)}w>0?(o[un+(Ui<<2)>>2]=d,Ui=Ui+1|0,_=si,r=Se):en=19}else en=19;if((en|0)==19){en=0;do if(l){if(r=l+8|0,o[r>>2]|0){en=21;break e}if(l=D(1,12)|0,!l){en=23;break e}o[r>>2]=l,_=l+4|0,T=l,r=Se}else if(Se){_=Kt,T=Se+8|0,r=d,l=i;break}else if(o[i>>2]|0){en=27;break e}else{_=Kt,T=i,r=d,l=i;break}while(!1);if(o[T>>2]=d,o[_>>2]=d,T=Gi+(si<<5)|0,X=o[d>>2]|0,X){for(ue=Gi+(si<<5)+8|0,ke[ue>>3]=17976931348623157e292,Se=Gi+(si<<5)+24|0,ke[Se>>3]=17976931348623157e292,ke[T>>3]=-17976931348623157e292,Te=Gi+(si<<5)+16|0,ke[Te>>3]=-17976931348623157e292,ot=17976931348623157e292,ht=-17976931348623157e292,_=0,Re=X,j=17976931348623157e292,et=17976931348623157e292,vt=-17976931348623157e292,B=-17976931348623157e292;w=+ke[Re>>3],wt=+ke[Re+8>>3],Re=o[Re+16>>2]|0,Be=(Re|0)==0,Et=+ke[(Be?X:Re)+8>>3],w<j&&(ke[ue>>3]=w,j=w),wt<et&&(ke[Se>>3]=wt,et=wt),w>vt?ke[T>>3]=w:w=vt,wt>B&&(ke[Te>>3]=wt,B=wt),ot=wt>0&wt<ot?wt:ot,ht=wt<0&wt>ht?wt:ht,_=_|+ti(+(wt-Et))>3.141592653589793,!Be;)vt=w;_&&(ke[Te>>3]=ht,ke[Se>>3]=ot)}else o[T>>2]=0,o[T+4>>2]=0,o[T+8>>2]=0,o[T+12>>2]=0,o[T+16>>2]=0,o[T+20>>2]=0,o[T+24>>2]=0,o[T+28>>2]=0;_=si+1|0}if(Si=d+8|0,d=o[Si>>2]|0,o[Si>>2]=0,d)si=_,Se=r;else{en=45;break}}if((en|0)==21)Tn(22765,22787,35,22799);else if((en|0)==23)Tn(22819,22787,37,22799);else if((en|0)==27)Tn(22862,22787,61,22885);else if((en|0)==45){e:do if((Ui|0)>0){for(Si=(_|0)==0,Zi=_<<2,Qi=(i|0)==0,ai=0,r=0;;){if(ii=o[un+(ai<<2)>>2]|0,Si)en=73;else{if(si=Ds(Zi)|0,!si){en=50;break}if(Kt=Ds(Zi)|0,!Kt){en=52;break}t:do if(Qi)l=0;else{for(_=0,l=0,T=i;d=Gi+(_<<5)|0,Pn(o[T>>2]|0,d,o[ii>>2]|0)|0?(o[si+(l<<2)>>2]=T,o[Kt+(l<<2)>>2]=d,Be=l+1|0):Be=l,T=o[T+8>>2]|0,T;)_=_+1|0,l=Be;if((Be|0)>0)if(d=o[si>>2]|0,(Be|0)==1)l=d;else for(Te=0,Re=-1,l=d,Se=d;;){for(X=o[Se>>2]|0,d=0,T=0;_=o[o[si+(T<<2)>>2]>>2]|0,(_|0)==(X|0)?ue=d:ue=d+((Pn(_,o[Kt+(T<<2)>>2]|0,o[X>>2]|0)|0)&1)|0,T=T+1|0,(T|0)!=(Be|0);)d=ue;if(_=(ue|0)>(Re|0),l=_?Se:l,d=Te+1|0,(d|0)==(Be|0))break t;Te=d,Re=_?ue:Re,Se=o[si+(d<<2)>>2]|0}else l=0}while(!1);if(C(si),C(Kt),l){if(_=l+4|0,d=o[_>>2]|0,d)l=d+8|0;else if(o[l>>2]|0){en=70;break}o[l>>2]=ii,o[_>>2]=ii}else en=73}if((en|0)==73){if(en=0,r=o[ii>>2]|0,r|0)do Kt=r,r=o[r+16>>2]|0,C(Kt);while(r|0);C(ii),r=1}if(ai=ai+1|0,(ai|0)>=(Ui|0)){Bn=r;break e}}(en|0)==50?Tn(23004,22787,249,23023):(en|0)==52?Tn(23042,22787,252,23023):(en|0)==70&&Tn(22862,22787,61,22885)}else Bn=0;while(!1);return C(un),C(Gi),en=Bn,en|0}return 0}function Pn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ue=0;if(!(Qa(r,l)|0)||(r=Za(r)|0,d=+ke[l>>3],_=+ke[l+8>>3],_=r&_<0?_+6.283185307179586:_,i=o[i>>2]|0,!i))return i=0,i|0;if(r){r=0,X=_,l=i;e:for(;;){for(;T=+ke[l>>3],_=+ke[l+8>>3],l=l+16|0,ue=o[l>>2]|0,ue=ue|0?ue:i,w=+ke[ue>>3],B=+ke[ue+8>>3],T>w?(j=T,T=B):(j=w,w=T,T=_,_=B),d=d==w|d==j?d+2220446049250313e-31:d,!!(d<w|d>j);)if(l=o[l>>2]|0,!l){l=22;break e}if(B=T<0?T+6.283185307179586:T,T=_<0?_+6.283185307179586:_,X=B==X|T==X?X+-2220446049250313e-31:X,j=B+(T-B)*((d-w)/(j-w)),(j<0?j+6.283185307179586:j)>X&&(r=r^1),l=o[l>>2]|0,!l){l=22;break}}if((l|0)==22)return r|0}else{r=0,X=_,l=i;e:for(;;){for(;T=+ke[l>>3],_=+ke[l+8>>3],l=l+16|0,ue=o[l>>2]|0,ue=ue|0?ue:i,w=+ke[ue>>3],B=+ke[ue+8>>3],T>w?(j=T,T=B):(j=w,w=T,T=_,_=B),d=d==w|d==j?d+2220446049250313e-31:d,!!(d<w|d>j);)if(l=o[l>>2]|0,!l){l=22;break e}if(X=T==X|_==X?X+-2220446049250313e-31:X,T+(_-T)*((d-w)/(j-w))>X&&(r=r^1),l=o[l>>2]|0,!l){l=22;break}}if((l|0)==22)return r|0}return 0}function Da(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0,et=0,vt=0,ot=0,ht=0;if(ht=Dt,Dt=Dt+32|0,ot=ht+16|0,vt=ht,w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,Re=Gt(l|0,d|0,52)|0,Ut()|0,(w|0)!=(Re&15|0))return ot=12,Dt=ht,ot|0;if(X=Gt(i|0,r|0,45)|0,Ut()|0,X=X&127,ue=Gt(l|0,d|0,45)|0,Ut()|0,ue=ue&127,X>>>0>121|ue>>>0>121)return ot=5,Dt=ht,ot|0;if(Re=(X|0)!=(ue|0),Re){if(B=Ar(X,ue)|0,(B|0)==7)return ot=1,Dt=ht,ot|0;j=Ar(ue,X)|0,(j|0)==7?Tn(23066,23090,161,23100):(Be=B,T=j)}else Be=0,T=0;Se=nt(X)|0,Te=nt(ue)|0,o[ot>>2]=0,o[ot+4>>2]=0,o[ot+8>>2]=0,o[ot+12>>2]=0;do if(Be){if(ue=o[4272+(X*28|0)+(Be<<2)>>2]|0,B=(ue|0)>0,Te)if(B){X=0,j=l,B=d;do j=kl(j,B)|0,B=Ut()|0,T=ml(T)|0,(T|0)==1&&(T=ml(1)|0),X=X+1|0;while((X|0)!=(ue|0));ue=T,X=j,j=B}else ue=T,X=l,j=d;else if(B){X=0,j=l,B=d;do j=go(j,B)|0,B=Ut()|0,T=ml(T)|0,X=X+1|0;while((X|0)!=(ue|0));ue=T,X=j,j=B}else ue=T,X=l,j=d;if(Jo(X,j,ot)|0,Re||Tn(23115,23090,191,23100),B=(Se|0)!=0,T=(Te|0)!=0,B&T&&Tn(23142,23090,192,23100),B){if(T=Ia(i,r)|0,(T|0)==7){w=5;break}if(kt[21872+(T*7|0)+Be>>0]|0){w=1;break}j=o[21040+(T*28|0)+(Be<<2)>>2]|0,X=j}else if(T){if(T=Ia(X,j)|0,(T|0)==7){w=5;break}if(kt[21872+(T*7|0)+ue>>0]|0){w=1;break}X=0,j=o[21040+(ue*28|0)+(T<<2)>>2]|0}else X=0,j=0;if((X|j|0)<0)w=5;else{if((j|0)>0){B=ot+4|0,T=0;do Wa(B),T=T+1|0;while((T|0)!=(j|0))}if(o[vt>>2]=0,o[vt+4>>2]=0,o[vt+8>>2]=0,Ys(vt,Be),w|0)for(;qs(w)|0?Qo(vt):ha(vt),(w|0)>1;)w=w+-1|0;if((X|0)>0){w=0;do Wa(vt),w=w+1|0;while((w|0)!=(X|0))}et=ot+4|0,xr(et,vt,et),Lr(et),et=51}}else if(Jo(l,d,ot)|0,(Se|0)!=0&(Te|0)!=0)if((ue|0)!=(X|0)&&Tn(23173,23090,261,23100),T=Ia(i,r)|0,w=Ia(l,d)|0,(T|0)==7|(w|0)==7)w=5;else if(kt[21872+(T*7|0)+w>>0]|0)w=1;else if(T=o[21040+(T*28|0)+(w<<2)>>2]|0,(T|0)>0){B=ot+4|0,w=0;do Wa(B),w=w+1|0;while((w|0)!=(T|0));et=51}else et=51;else et=51;while(!1);return(et|0)==51&&(w=ot+4|0,o[_>>2]=o[w>>2],o[_+4>>2]=o[w+4>>2],o[_+8>>2]=o[w+8>>2],w=0),ot=w,Dt=ht,ot|0}function In(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0,et=0,vt=0,ot=0,ht=0,Et=0;if(et=Dt,Dt=Dt+48|0,X=et+36|0,T=et+24|0,B=et+12|0,j=et,_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15,Te=Gt(i|0,r|0,45)|0,Ut()|0,Te=Te&127,Te>>>0>121)return d=5,Dt=et,d|0;if(ue=nt(Te)|0,Zt(_|0,0,52)|0,vt=Ut()|0|134225919,w=d,o[w>>2]=-1,o[w+4>>2]=vt,!_)return _=To(l)|0,(_|0)==7||(_=rr(Te,_)|0,(_|0)==127)?(vt=1,Dt=et,vt|0):(Re=Zt(_|0,0,45)|0,Be=Ut()|0,Te=d,Be=o[Te+4>>2]&-1040385|Be,vt=d,o[vt>>2]=o[Te>>2]|Re,o[vt+4>>2]=Be,vt=0,Dt=et,vt|0);for(o[X>>2]=o[l>>2],o[X+4>>2]=o[l+4>>2],o[X+8>>2]=o[l+8>>2],l=_;;){if(w=l,l=l+-1|0,o[T>>2]=o[X>>2],o[T+4>>2]=o[X+4>>2],o[T+8>>2]=o[X+8>>2],qs(w)|0){if(_=Zo(X)|0,_|0){l=13;break}o[B>>2]=o[X>>2],o[B+4>>2]=o[X+4>>2],o[B+8>>2]=o[X+8>>2],Qo(B)}else{if(_=Bs(X)|0,_|0){l=13;break}o[B>>2]=o[X>>2],o[B+4>>2]=o[X+4>>2],o[B+8>>2]=o[X+8>>2],ha(B)}if(Ks(T,B,j),Lr(j),_=d,ht=o[_>>2]|0,_=o[_+4>>2]|0,Et=(15-w|0)*3|0,ot=Zt(7,0,Et|0)|0,_=_&~(Ut()|0),Et=Zt(To(j)|0,0,Et|0)|0,_=Ut()|0|_,vt=d,o[vt>>2]=Et|ht&~ot,o[vt+4>>2]=_,(w|0)<=1){l=14;break}}e:do if((l|0)!=13&&(l|0)==14)if((o[X>>2]|0)<=1&&(o[X+4>>2]|0)<=1&&(o[X+8>>2]|0)<=1){l=To(X)|0,_=rr(Te,l)|0,(_|0)==127?j=0:j=nt(_)|0;t:do if(l){if(ue){if(_=Ia(i,r)|0,(_|0)==7){_=5;break e}if(w=o[21248+(_*28|0)+(l<<2)>>2]|0,(w|0)>0){_=l,l=0;do _=Ma(_)|0,l=l+1|0;while((l|0)!=(w|0))}else _=l;if((_|0)==1){_=9;break e}l=rr(Te,_)|0,(l|0)==127&&Tn(23200,23090,411,23230),nt(l)|0?Tn(23245,23090,412,23230):(Be=l,Re=w,Se=_)}else Be=_,Re=0,Se=l;if(B=o[4272+(Te*28|0)+(Se<<2)>>2]|0,(B|0)<=-1&&Tn(23276,23090,419,23230),!j){if((Re|0)<0){_=5;break e}if(Re|0){w=d,_=0,l=o[w>>2]|0,w=o[w+4>>2]|0;do l=Do(l,w)|0,w=Ut()|0,Et=d,o[Et>>2]=l,o[Et+4>>2]=w,_=_+1|0;while((_|0)<(Re|0))}if((B|0)<=0){_=Be,l=58;break}for(w=d,_=0,l=o[w>>2]|0,w=o[w+4>>2]|0;;)if(l=Do(l,w)|0,w=Ut()|0,Et=d,o[Et>>2]=l,o[Et+4>>2]=w,_=_+1|0,(_|0)==(B|0)){_=Be,l=58;break t}}if(T=Ar(Be,Te)|0,(T|0)==7&&Tn(23066,23090,428,23230),_=d,l=o[_>>2]|0,_=o[_+4>>2]|0,(B|0)>0){w=0;do l=Do(l,_)|0,_=Ut()|0,Et=d,o[Et>>2]=l,o[Et+4>>2]=_,w=w+1|0;while((w|0)!=(B|0))}if(_=Ia(l,_)|0,(_|0)==7&&Tn(23313,23090,440,23230),l=It(Be)|0,l=o[(l?21664:21456)+(T*28|0)+(_<<2)>>2]|0,(l|0)<0&&Tn(23313,23090,454,23230),!l)_=Be,l=58;else{T=d,_=0,w=o[T>>2]|0,T=o[T+4>>2]|0;do w=Tl(w,T)|0,T=Ut()|0,Et=d,o[Et>>2]=w,o[Et+4>>2]=T,_=_+1|0;while((_|0)<(l|0));_=Be,l=58}}else if((ue|0)!=0&(j|0)!=0){if(l=Ia(i,r)|0,w=d,w=Ia(o[w>>2]|0,o[w+4>>2]|0)|0,(l|0)==7|(w|0)==7){_=5;break e}if(w=o[21248+(l*28|0)+(w<<2)>>2]|0,(w|0)<0){_=5;break e}if(!w)l=59;else{B=d,l=0,T=o[B>>2]|0,B=o[B+4>>2]|0;do T=Do(T,B)|0,B=Ut()|0,Et=d,o[Et>>2]=T,o[Et+4>>2]=B,l=l+1|0;while((l|0)<(w|0));l=58}}else l=58;while(!1);if((l|0)==58&&j&&(l=59),(l|0)==59&&(Et=d,(Ia(o[Et>>2]|0,o[Et+4>>2]|0)|0)==1)){_=9;break}Et=d,ot=o[Et>>2]|0,Et=o[Et+4>>2]&-1040385,ht=Zt(_|0,0,45)|0,Et=Et|(Ut()|0),_=d,o[_>>2]=ot|ht,o[_+4>>2]=Et,_=0}else _=1;while(!1);return Et=_,Dt=et,Et|0}function No(i,r,l,d,_,w){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0;var T=0,B=0;return B=Dt,Dt=Dt+16|0,T=B,_?i=15:(i=Da(i,r,l,d,T)|0,i||(ac(T,w),i=0)),Dt=B,i|0}function Nl(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0;return T=Dt,Dt=Dt+16|0,w=T,d?l=15:(l=ro(l,w)|0,l||(l=In(i,r,w,_)|0)),Dt=T,l|0}function En(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0;return j=Dt,Dt=Dt+32|0,T=j+12|0,B=j,w=Da(i,r,i,r,T)|0,w|0?(B=w,Dt=j,B|0):(i=Da(i,r,l,d,B)|0,i|0?(B=i,Dt=j,B|0):(T=As(T,B)|0,B=_,o[B>>2]=T,o[B+4>>2]=((T|0)<0)<<31>>31,B=0,Dt=j,B|0))}function $l(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0;return j=Dt,Dt=Dt+32|0,T=j+12|0,B=j,w=Da(i,r,i,r,T)|0,!w&&(w=Da(i,r,l,d,B)|0,!w)?(d=As(T,B)|0,d=z(d|0,((d|0)<0)<<31>>31|0,1,0)|0,T=Ut()|0,B=_,o[B>>2]=d,o[B+4>>2]=T,B=0,Dt=j,B|0):(B=w,Dt=j,B|0)}function Cn(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0,et=0,vt=0,ot=0,ht=0,Et=0,wt=0,si=0,Kt=0,ii=0,ai=0;if(ii=Dt,Dt=Dt+48|0,T=ii+24|0,B=ii+12|0,Kt=ii,w=Da(i,r,i,r,T)|0,!w&&(w=Da(i,r,l,d,B)|0,!w)){wt=As(T,B)|0,si=((wt|0)<0)<<31>>31,o[T>>2]=0,o[T+4>>2]=0,o[T+8>>2]=0,o[B>>2]=0,o[B+4>>2]=0,o[B+8>>2]=0,Da(i,r,i,r,T)|0&&Tn(23313,23090,691,23299),Da(i,r,l,d,B)|0&&Tn(23313,23090,696,23299),so(T),so(B),wt?(Se=o[T>>2]|0,Be=+(wt|0),ot=T+4|0,Te=o[ot>>2]|0,ht=T+8|0,Re=o[ht>>2]|0,Et=T,d=Se,w=Te,l=Re,et=+((o[B>>2]|0)-Se|0)/Be,vt=+((o[B+4>>2]|0)-Te|0)/Be,Be=+((o[B+8>>2]|0)-Re|0)/Be):(w=T+4|0,l=T+8|0,ot=w,ht=l,Et=T,d=o[T>>2]|0,w=o[w>>2]|0,l=o[l>>2]|0,et=0,vt=0,Be=0),o[Kt>>2]=d,Re=Kt+4|0,o[Re>>2]=w,Te=Kt+8|0,o[Te>>2]=l;e:do if((wt|0)<0)w=0;else for(ue=0,Se=0,w=d;;){X=+(Se>>>0)+4294967296*+(ue|0),ai=et*X+ +(w|0),j=vt*X+ +(o[ot>>2]|0),X=Be*X+ +(o[ht>>2]|0),l=~~+E(+ai),T=~~+E(+j),w=~~+E(+X),ai=+ti(+(+(l|0)-ai)),j=+ti(+(+(T|0)-j)),X=+ti(+(+(w|0)-X));do if(ai>j&ai>X)l=0-(T+w)|0,d=T;else if(B=0-l|0,j>X){d=B-w|0;break}else{d=T,w=B-T|0;break}while(!1);if(o[Kt>>2]=l,o[Re>>2]=d,o[Te>>2]=w,Wl(Kt),w=In(i,r,Kt,_+(Se<<3)|0)|0,w|0)break e;if(!((ue|0)<(si|0)|(ue|0)==(si|0)&Se>>>0<wt>>>0)){w=0;break e}w=z(Se|0,ue|0,1,0)|0,B=Ut()|0,ue=B,Se=w,w=o[Et>>2]|0}while(!1);return Kt=w,Dt=ii,Kt|0}return Kt=w,Dt=ii,Kt|0}function _l(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0;if((l|0)==0&(d|0)==0)return _=0,w=1,Yi(_|0),w|0;w=i,_=r,i=1,r=0;do T=(l&1|0)==0&!0,i=We((T?1:w)|0,(T?0:_)|0,i|0,r|0)|0,r=Ut()|0,l=ri(l|0,d|0,1)|0,d=Ut()|0,w=We(w|0,_|0,w|0,_|0)|0,_=Ut()|0;while(!((l|0)==0&(d|0)==0));return Yi(r|0),i|0}function uu(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0;if(!(Qa(r,l)|0)||(r=Za(r)|0,d=+ke[l>>3],_=+ke[l+8>>3],_=r&_<0?_+6.283185307179586:_,Te=o[i>>2]|0,(Te|0)<=0))return Te=0,Te|0;if(Se=o[i+4>>2]|0,r){r=0,ue=_,l=-1,i=0;e:for(;;){for(X=i;T=+ke[Se+(X<<4)>>3],_=+ke[Se+(X<<4)+8>>3],i=(l+2|0)%(Te|0)|0,w=+ke[Se+(i<<4)>>3],B=+ke[Se+(i<<4)+8>>3],T>w?(j=T,T=B):(j=w,w=T,T=_,_=B),d=d==w|d==j?d+2220446049250313e-31:d,!!(d<w|d>j);)if(l=X+1|0,(l|0)>=(Te|0)){l=22;break e}else i=X,X=l,l=i;if(B=T<0?T+6.283185307179586:T,T=_<0?_+6.283185307179586:_,ue=B==ue|T==ue?ue+-2220446049250313e-31:ue,j=B+(T-B)*((d-w)/(j-w)),(j<0?j+6.283185307179586:j)>ue&&(r=r^1),i=X+1|0,(i|0)>=(Te|0)){l=22;break}else l=X}if((l|0)==22)return r|0}else{r=0,ue=_,l=-1,i=0;e:for(;;){for(X=i;T=+ke[Se+(X<<4)>>3],_=+ke[Se+(X<<4)+8>>3],i=(l+2|0)%(Te|0)|0,w=+ke[Se+(i<<4)>>3],B=+ke[Se+(i<<4)+8>>3],T>w?(j=T,T=B):(j=w,w=T,T=_,_=B),d=d==w|d==j?d+2220446049250313e-31:d,!!(d<w|d>j);)if(l=X+1|0,(l|0)>=(Te|0)){l=22;break e}else i=X,X=l,l=i;if(ue=T==ue|_==ue?ue+-2220446049250313e-31:ue,T+(_-T)*((d-w)/(j-w))>ue&&(r=r^1),i=X+1|0,(i|0)>=(Te|0)){l=22;break}else l=X}if((l|0)==22)return r|0}return 0}function Ou(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0,et=0,vt=0,ot=0,ht=0;if(Be=o[i>>2]|0,!Be){o[r>>2]=0,o[r+4>>2]=0,o[r+8>>2]=0,o[r+12>>2]=0,o[r+16>>2]=0,o[r+20>>2]=0,o[r+24>>2]=0,o[r+28>>2]=0;return}if(et=r+8|0,ke[et>>3]=17976931348623157e292,vt=r+24|0,ke[vt>>3]=17976931348623157e292,ke[r>>3]=-17976931348623157e292,ot=r+16|0,ke[ot>>3]=-17976931348623157e292,!((Be|0)<=0)){for(Te=o[i+4>>2]|0,X=17976931348623157e292,ue=-17976931348623157e292,Se=0,i=-1,w=17976931348623157e292,T=17976931348623157e292,j=-17976931348623157e292,d=-17976931348623157e292,Re=0;l=+ke[Te+(Re<<4)>>3],B=+ke[Te+(Re<<4)+8>>3],i=i+2|0,_=+ke[Te+(((i|0)==(Be|0)?0:i)<<4)+8>>3],l<w&&(ke[et>>3]=l,w=l),B<T&&(ke[vt>>3]=B,T=B),l>j?ke[r>>3]=l:l=j,B>d&&(ke[ot>>3]=B,d=B),X=B>0&B<X?B:X,ue=B<0&B>ue?B:ue,Se=Se|+ti(+(B-_))>3.141592653589793,i=Re+1|0,(i|0)!=(Be|0);)ht=Re,j=l,Re=i,i=ht;Se&&(ke[ot>>3]=ue,ke[vt>>3]=X)}}function Vl(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0,et=0,vt=0,ot=0,ht=0,Et=0,wt=0,si=0,Kt=0,ii=0;if(Be=o[i>>2]|0,Be){if(et=r+8|0,ke[et>>3]=17976931348623157e292,vt=r+24|0,ke[vt>>3]=17976931348623157e292,ke[r>>3]=-17976931348623157e292,ot=r+16|0,ke[ot>>3]=-17976931348623157e292,(Be|0)>0){for(_=o[i+4>>2]|0,Te=17976931348623157e292,Re=-17976931348623157e292,d=0,l=-1,j=17976931348623157e292,X=17976931348623157e292,Se=-17976931348623157e292,T=-17976931348623157e292,ht=0;w=+ke[_+(ht<<4)>>3],ue=+ke[_+(ht<<4)+8>>3],Kt=l+2|0,B=+ke[_+(((Kt|0)==(Be|0)?0:Kt)<<4)+8>>3],w<j&&(ke[et>>3]=w,j=w),ue<X&&(ke[vt>>3]=ue,X=ue),w>Se?ke[r>>3]=w:w=Se,ue>T&&(ke[ot>>3]=ue,T=ue),Te=ue>0&ue<Te?ue:Te,Re=ue<0&ue>Re?ue:Re,d=d|+ti(+(ue-B))>3.141592653589793,l=ht+1|0,(l|0)!=(Be|0);)Kt=ht,Se=w,ht=l,l=Kt;d&&(ke[ot>>3]=Re,ke[vt>>3]=Te)}}else o[r>>2]=0,o[r+4>>2]=0,o[r+8>>2]=0,o[r+12>>2]=0,o[r+16>>2]=0,o[r+20>>2]=0,o[r+24>>2]=0,o[r+28>>2]=0;if(Kt=i+8|0,l=o[Kt>>2]|0,!((l|0)<=0)){si=i+12|0,wt=0;do if(_=o[si>>2]|0,d=wt,wt=wt+1|0,vt=r+(wt<<5)|0,ot=o[_+(d<<3)>>2]|0,ot){if(ht=r+(wt<<5)+8|0,ke[ht>>3]=17976931348623157e292,i=r+(wt<<5)+24|0,ke[i>>3]=17976931348623157e292,ke[vt>>3]=-17976931348623157e292,Et=r+(wt<<5)+16|0,ke[Et>>3]=-17976931348623157e292,(ot|0)>0){for(Be=o[_+(d<<3)+4>>2]|0,Te=17976931348623157e292,Re=-17976931348623157e292,_=0,d=-1,et=0,j=17976931348623157e292,X=17976931348623157e292,ue=-17976931348623157e292,T=-17976931348623157e292;w=+ke[Be+(et<<4)>>3],Se=+ke[Be+(et<<4)+8>>3],d=d+2|0,B=+ke[Be+(((d|0)==(ot|0)?0:d)<<4)+8>>3],w<j&&(ke[ht>>3]=w,j=w),Se<X&&(ke[i>>3]=Se,X=Se),w>ue?ke[vt>>3]=w:w=ue,Se>T&&(ke[Et>>3]=Se,T=Se),Te=Se>0&Se<Te?Se:Te,Re=Se<0&Se>Re?Se:Re,_=_|+ti(+(Se-B))>3.141592653589793,d=et+1|0,(d|0)!=(ot|0);)ii=et,et=d,ue=w,d=ii;_&&(ke[Et>>3]=Re,ke[i>>3]=Te)}}else o[vt>>2]=0,o[vt+4>>2]=0,o[vt+8>>2]=0,o[vt+12>>2]=0,o[vt+16>>2]=0,o[vt+20>>2]=0,o[vt+24>>2]=0,o[vt+28>>2]=0,l=o[Kt>>2]|0;while((wt|0)<(l|0))}}function yl(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if(!(uu(i,r,l)|0))return _=0,_|0;if(_=i+8|0,(o[_>>2]|0)<=0)return _=1,_|0;for(d=i+12|0,i=0;;){if(w=i,i=i+1|0,uu((o[d>>2]|0)+(w<<3)|0,r+(i<<5)|0,l)|0){i=0,d=6;break}if((i|0)>=(o[_>>2]|0)){i=1,d=6;break}}return(d|0)==6?i|0:0}function ta(){return 8}function oc(){return 16}function Xu(){return 168}function Xl(){return 8}function ms(){return 16}function _a(){return 12}function el(){return 8}function _u(i){return i=i|0,+(+((o[i>>2]|0)>>>0)+4294967296*+(o[i+4>>2]|0))}function Nu(i){i=i|0;var r=0,l=0;return l=+ke[i>>3],r=+ke[i+8>>3],+ +li(+(l*l+r*r))}function cu(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0;X=+ke[i>>3],j=+ke[r>>3]-X,B=+ke[i+8>>3],T=+ke[r+8>>3]-B,Se=+ke[l>>3],w=+ke[d>>3]-Se,Te=+ke[l+8>>3],ue=+ke[d+8>>3]-Te,w=(w*(B-Te)-(X-Se)*ue)/(j*ue-T*w),ke[_>>3]=X+j*w,ke[_+8>>3]=B+T*w}function Vu(i,r){return i=i|0,r=r|0,+ti(+(+ke[i>>3]-+ke[r>>3]))<11920928955078125e-23?(r=+ti(+(+ke[i+8>>3]-+ke[r+8>>3]))<11920928955078125e-23,r|0):(r=0,r|0)}function yr(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;return _=+ke[i>>3]-+ke[r>>3],d=+ke[i+8>>3]-+ke[r+8>>3],l=+ke[i+16>>3]-+ke[r+16>>3],+(_*_+d*d+l*l)}function gs(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;l=+ke[i>>3],d=+vi(+l),l=+bi(+l),ke[r+16>>3]=l,l=+ke[i+8>>3],_=d*+vi(+l),ke[r>>3]=_,l=d*+bi(+l),ke[r+8>>3]=l}function gn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if(w=Dt,Dt=Dt+16|0,_=w,d=Mr(i,r)|0,(l+-1|0)>>>0>5||(d=(d|0)!=0,(l|0)==1&d))return _=-1,Dt=w,_|0;do if(Zn(i,r,_)|0)d=-1;else if(d){d=((o[21936+(l<<2)>>2]|0)+5-(o[_>>2]|0)|0)%5|0;break}else{d=((o[21968+(l<<2)>>2]|0)+6-(o[_>>2]|0)|0)%6|0;break}while(!1);return _=d,Dt=w,_|0}function Zn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0;if(X=Dt,Dt=Dt+32|0,T=X+16|0,B=X,d=Yr(i,r,T)|0,d|0)return l=d,Dt=X,l|0;w=Ol(i,r)|0,j=Ia(i,r)|0,Di(w,B),d=hn(w,o[T>>2]|0)|0;e:do if(nt(w)|0){do switch(w|0){case 4:{i=0;break}case 14:{i=1;break}case 24:{i=2;break}case 38:{i=3;break}case 49:{i=4;break}case 58:{i=5;break}case 63:{i=6;break}case 72:{i=7;break}case 83:{i=8;break}case 97:{i=9;break}case 107:{i=10;break}case 117:{i=11;break}default:{d=1;break e}}while(!1);if(_=o[22e3+(i*24|0)+8>>2]|0,r=o[22e3+(i*24|0)+16>>2]|0,i=o[T>>2]|0,(i|0)!=(o[B>>2]|0)&&(B=It(w)|0,i=o[T>>2]|0,B|(i|0)==(r|0)&&(d=(d+1|0)%6|0)),(j|0)==3&(i|0)==(r|0)){d=(d+5|0)%6|0,_=22;break}(j|0)==5&(i|0)==(_|0)&&(d=(d+1|0)%6|0),_=22}else _=22;while(!1);return(_|0)==22&&(o[l>>2]=d,d=0),l=d,Dt=X,l|0}function Jn(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0,et=0,vt=0,ot=0,ht=0,Et=0;if(Et=Dt,Dt=Dt+32|0,ht=Et+24|0,vt=Et+20|0,Be=Et+8|0,Re=Et+16|0,Te=Et,j=(Mr(i,r)|0)==0,j=j?6:5,ue=Gt(i|0,r|0,52)|0,Ut()|0,ue=ue&15,j>>>0<=l>>>0)return d=2,Dt=Et,d|0;Se=(ue|0)==0,!Se&&(et=Zt(7,0,(ue^15)*3|0)|0,(et&i|0)==0&((Ut()|0)&r|0)==0)?_=l:w=4;e:do if((w|0)==4){if(_=(Mr(i,r)|0)!=0,((_?4:5)|0)<(l|0)||Zn(i,r,ht)|0||(w=(o[ht>>2]|0)+l|0,_?_=22288+(((w|0)%5|0)<<2)|0:_=22320+(((w|0)%6|0)<<2)|0,et=o[_>>2]|0,(et|0)==7))return d=1,Dt=Et,d|0;o[vt>>2]=0,_=hs(i,r,et,vt,Be)|0;do if(!_){if(B=Be,X=o[B>>2]|0,B=o[B+4>>2]|0,T=B>>>0<r>>>0|(B|0)==(r|0)&X>>>0<i>>>0,w=T?X:i,T=T?B:r,!Se&&(Se=Zt(7,0,(ue^15)*3|0)|0,(X&Se|0)==0&(B&(Ut()|0)|0)==0))_=l;else{if(B=(l+-1+j|0)%(j|0)|0,_=Mr(i,r)|0,(B|0)<0&&Tn(23313,23315,245,23324),j=(_|0)!=0,((j?4:5)|0)<(B|0)&&Tn(23313,23315,245,23324),Zn(i,r,ht)|0&&Tn(23313,23315,245,23324),_=(o[ht>>2]|0)+B|0,j?_=22288+(((_|0)%5|0)<<2)|0:_=22320+(((_|0)%6|0)<<2)|0,B=o[_>>2]|0,(B|0)==7&&Tn(23313,23315,245,23324),o[Re>>2]=0,_=hs(i,r,B,Re,Te)|0,_|0)break;X=Te,j=o[X>>2]|0,X=o[X+4>>2]|0;do if(X>>>0<T>>>0|(X|0)==(T|0)&j>>>0<w>>>0){if(Mr(j,X)|0?w=qa(j,X,i,r)|0:w=o[22384+((((o[Re>>2]|0)+(o[22352+(B<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,_=Mr(j,X)|0,(w+-1|0)>>>0>5){_=-1,w=j,T=X;break}if(_=(_|0)!=0,(w|0)==1&_){_=-1,w=j,T=X;break}do if(Zn(j,X,ht)|0)_=-1;else if(_){_=((o[21936+(w<<2)>>2]|0)+5-(o[ht>>2]|0)|0)%5|0;break}else{_=((o[21968+(w<<2)>>2]|0)+6-(o[ht>>2]|0)|0)%6|0;break}while(!1);w=j,T=X}else _=l;while(!1);B=Be,X=o[B>>2]|0,B=o[B+4>>2]|0}if((w|0)==(X|0)&(T|0)==(B|0)){if(j=(Mr(X,B)|0)!=0,j?i=qa(X,B,i,r)|0:i=o[22384+((((o[vt>>2]|0)+(o[22352+(et<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,_=Mr(X,B)|0,(i+-1|0)>>>0<=5&&(ot=(_|0)!=0,!((i|0)==1&ot)))do if(Zn(X,B,ht)|0)_=-1;else if(ot){_=((o[21936+(i<<2)>>2]|0)+5-(o[ht>>2]|0)|0)%5|0;break}else{_=((o[21968+(i<<2)>>2]|0)+6-(o[ht>>2]|0)|0)%6|0;break}while(!1);else _=-1;_=_+1|0,_=(_|0)==6|j&(_|0)==5?0:_}r=T,i=w;break e}while(!1);return d=_,Dt=Et,d|0}while(!1);return ot=Zt(_|0,0,56)|0,ht=Ut()|0|r&-2130706433|536870912,o[d>>2]=ot|i,o[d+4>>2]=ht,d=0,Dt=Et,d|0}function tl(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;return w=(Mr(i,r)|0)==0,d=Jn(i,r,0,l)|0,_=(d|0)==0,w?!_||(d=Jn(i,r,1,l+8|0)|0,d|0)||(d=Jn(i,r,2,l+16|0)|0,d|0)||(d=Jn(i,r,3,l+24|0)|0,d|0)||(d=Jn(i,r,4,l+32|0)|0,d)?(w=d,w|0):Jn(i,r,5,l+40|0)|0:!_||(d=Jn(i,r,1,l+8|0)|0,d|0)||(d=Jn(i,r,2,l+16|0)|0,d|0)||(d=Jn(i,r,3,l+24|0)|0,d|0)||(d=Jn(i,r,4,l+32|0)|0,d|0)?(w=d,w|0):(w=l+40|0,o[w>>2]=0,o[w+4>>2]=0,w=0,w|0)}function Tu(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0;return j=Dt,Dt=Dt+192|0,_=j,w=j+168|0,T=Gt(i|0,r|0,56)|0,Ut()|0,T=T&7,B=r&-2130706433|134217728,d=Yr(i,B,w)|0,d|0?(B=d,Dt=j,B|0):(r=Gt(i|0,r|0,52)|0,Ut()|0,r=r&15,Mr(i,B)|0?Ko(w,r,T,1,_):fr(w,r,T,1,_),B=_+8|0,o[l>>2]=o[B>>2],o[l+4>>2]=o[B+4>>2],o[l+8>>2]=o[B+8>>2],o[l+12>>2]=o[B+12>>2],B=0,Dt=j,B|0)}function oa(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return _=Dt,Dt=Dt+16|0,l=_,!(!0&(r&2013265920|0)==536870912)||(d=r&-2130706433|134217728,!(ns(i,d)|0))?(d=0,Dt=_,d|0):(w=Gt(i|0,r|0,56)|0,Ut()|0,w=(Jn(i,d,w&7,l)|0)==0,d=l,d=w&((o[d>>2]|0)==(i|0)?(o[d+4>>2]|0)==(r|0):0)&1,Dt=_,d|0)}function yu(i,r,l){i=i|0,r=r|0,l=l|0;var d=0;(r|0)>0?(d=D(r,4)|0,o[i>>2]=d,d||Tn(23337,23360,40,23374)):o[i>>2]=0,o[i+4>>2]=r,o[i+8>>2]=0,o[i+12>>2]=l}function bs(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;_=i+4|0,w=i+12|0,T=i+8|0;e:for(;;){for(l=o[_>>2]|0,r=0;;){if((r|0)>=(l|0))break e;if(d=o[i>>2]|0,B=o[d+(r<<2)>>2]|0,!B)r=r+1|0;else break}r=d+(~~(+ti(+(+Bi(10,+ +(15-(o[w>>2]|0)|0))*(+ke[B>>3]+ +ke[B+8>>3])))%+(l|0))>>>0<<2)|0,l=o[r>>2]|0;t:do if(l|0){if(d=B+32|0,(l|0)==(B|0))o[r>>2]=o[d>>2];else{if(l=l+32|0,r=o[l>>2]|0,!r)break;for(;(r|0)!=(B|0);)if(l=r+32|0,r=o[l>>2]|0,!r)break t;o[l>>2]=o[d>>2]}C(B),o[T>>2]=(o[T>>2]|0)+-1}while(!1)}C(o[i>>2]|0)}function Lo(i){i=i|0;var r=0,l=0,d=0;for(d=o[i+4>>2]|0,l=0;;){if((l|0)>=(d|0)){r=0,l=4;break}if(r=o[(o[i>>2]|0)+(l<<2)>>2]|0,!r)l=l+1|0;else{l=4;break}}return(l|0)==4?r|0:0}function ki(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;if(l=~~(+ti(+(+Bi(10,+ +(15-(o[i+12>>2]|0)|0))*(+ke[r>>3]+ +ke[r+8>>3])))%+(o[i+4>>2]|0))>>>0,l=(o[i>>2]|0)+(l<<2)|0,d=o[l>>2]|0,!d)return w=1,w|0;w=r+32|0;do if((d|0)!=(r|0)){if(l=o[d+32>>2]|0,!l)return w=1,w|0;for(_=l;;){if((_|0)==(r|0)){_=8;break}if(l=o[_+32>>2]|0,l)d=_,_=l;else{l=1,_=10;break}}if((_|0)==8){o[d+32>>2]=o[w>>2];break}else if((_|0)==10)return l|0}else o[l>>2]=o[w>>2];while(!1);return C(r),w=i+8|0,o[w>>2]=(o[w>>2]|0)+-1,w=0,w|0}function Li(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;w=Ds(40)|0,w||Tn(23390,23360,98,23403),o[w>>2]=o[r>>2],o[w+4>>2]=o[r+4>>2],o[w+8>>2]=o[r+8>>2],o[w+12>>2]=o[r+12>>2],_=w+16|0,o[_>>2]=o[l>>2],o[_+4>>2]=o[l+4>>2],o[_+8>>2]=o[l+8>>2],o[_+12>>2]=o[l+12>>2],o[w+32>>2]=0,_=~~(+ti(+(+Bi(10,+ +(15-(o[i+12>>2]|0)|0))*(+ke[r>>3]+ +ke[r+8>>3])))%+(o[i+4>>2]|0))>>>0,_=(o[i>>2]|0)+(_<<2)|0,d=o[_>>2]|0;do if(!d)o[_>>2]=w;else{for(;!(ao(d,r)|0&&ao(d+16|0,l)|0);)if(_=o[d+32>>2]|0,d=_|0?_:d,!(o[d+32>>2]|0)){T=10;break}if((T|0)==10){o[d+32>>2]=w;break}return C(w),T=d,T|0}while(!1);return T=i+8|0,o[T>>2]=(o[T>>2]|0)+1,T=w,T|0}function ws(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;if(_=~~(+ti(+(+Bi(10,+ +(15-(o[i+12>>2]|0)|0))*(+ke[r>>3]+ +ke[r+8>>3])))%+(o[i+4>>2]|0))>>>0,_=o[(o[i>>2]|0)+(_<<2)>>2]|0,!_)return l=0,l|0;if(!l){for(i=_;;){if(ao(i,r)|0){d=10;break}if(i=o[i+32>>2]|0,!i){i=0,d=10;break}}if((d|0)==10)return i|0}for(i=_;;){if(ao(i,r)|0&&ao(i+16|0,l)|0){d=10;break}if(i=o[i+32>>2]|0,!i){i=0,d=10;break}}return(d|0)==10?i|0:0}function vu(i,r){i=i|0,r=r|0;var l=0;if(l=~~(+ti(+(+Bi(10,+ +(15-(o[i+12>>2]|0)|0))*(+ke[r>>3]+ +ke[r+8>>3])))%+(o[i+4>>2]|0))>>>0,i=o[(o[i>>2]|0)+(l<<2)>>2]|0,!i)return l=0,l|0;for(;;){if(ao(i,r)|0){r=5;break}if(i=o[i+32>>2]|0,!i){i=0,r=5;break}}return(r|0)==5?i|0:0}function Vo(){return 23424}function fs(i){return i=+i,+ +y(+i)}function hl(i){return i=+i,~~+fs(i)|0}function Ds(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0,et=0,vt=0,ot=0,ht=0,Et=0,wt=0,si=0;si=Dt,Dt=Dt+16|0,Te=si;do if(i>>>0<245){if(X=i>>>0<11?16:i+11&-8,i=X>>>3,Se=o[5857]|0,l=Se>>>i,l&3|0)return r=(l&1^1)+i|0,i=23468+(r<<1<<2)|0,l=i+8|0,d=o[l>>2]|0,_=d+8|0,w=o[_>>2]|0,(w|0)==(i|0)?o[5857]=Se&~(1<<r):(o[w+12>>2]=i,o[l>>2]=w),wt=r<<3,o[d+4>>2]=wt|3,wt=d+wt+4|0,o[wt>>2]=o[wt>>2]|1,wt=_,Dt=si,wt|0;if(ue=o[5859]|0,X>>>0>ue>>>0){if(l|0)return r=2<<i,r=l<<i&(r|0-r),r=(r&0-r)+-1|0,B=r>>>12&16,r=r>>>B,l=r>>>5&8,r=r>>>l,w=r>>>2&4,r=r>>>w,i=r>>>1&2,r=r>>>i,d=r>>>1&1,d=(l|B|w|i|d)+(r>>>d)|0,r=23468+(d<<1<<2)|0,i=r+8|0,w=o[i>>2]|0,B=w+8|0,l=o[B>>2]|0,(l|0)==(r|0)?(i=Se&~(1<<d),o[5857]=i):(o[l+12>>2]=r,o[i>>2]=l,i=Se),wt=d<<3,T=wt-X|0,o[w+4>>2]=X|3,_=w+X|0,o[_+4>>2]=T|1,o[w+wt>>2]=T,ue|0&&(d=o[5862]|0,r=ue>>>3,l=23468+(r<<1<<2)|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=d,o[r+12>>2]=d,o[d+8>>2]=r,o[d+12>>2]=l),o[5859]=T,o[5862]=_,wt=B,Dt=si,wt|0;if(w=o[5858]|0,w){for(l=(w&0-w)+-1|0,_=l>>>12&16,l=l>>>_,d=l>>>5&8,l=l>>>d,T=l>>>2&4,l=l>>>T,B=l>>>1&2,l=l>>>B,j=l>>>1&1,j=o[23732+((d|_|T|B|j)+(l>>>j)<<2)>>2]|0,l=j,B=j,j=(o[j+4>>2]&-8)-X|0;i=o[l+16>>2]|0,!(!i&&(i=o[l+20>>2]|0,!i));)T=(o[i+4>>2]&-8)-X|0,_=T>>>0<j>>>0,l=i,B=_?i:B,j=_?T:j;if(T=B+X|0,T>>>0>B>>>0){_=o[B+24>>2]|0,r=o[B+12>>2]|0;do if((r|0)==(B|0)){if(i=B+20|0,r=o[i>>2]|0,!r&&(i=B+16|0,r=o[i>>2]|0,!r)){l=0;break}for(;;)if(d=r+20|0,l=o[d>>2]|0,l)r=l,i=d;else if(d=r+16|0,l=o[d>>2]|0,l)r=l,i=d;else break;o[i>>2]=0,l=r}else l=o[B+8>>2]|0,o[l+12>>2]=r,o[r+8>>2]=l,l=r;while(!1);do if(_|0){if(r=o[B+28>>2]|0,i=23732+(r<<2)|0,(B|0)==(o[i>>2]|0)){if(o[i>>2]=l,!l){o[5858]=w&~(1<<r);break}}else if(wt=_+16|0,o[((o[wt>>2]|0)==(B|0)?wt:_+20|0)>>2]=l,!l)break;o[l+24>>2]=_,r=o[B+16>>2]|0,r|0&&(o[l+16>>2]=r,o[r+24>>2]=l),r=o[B+20>>2]|0,r|0&&(o[l+20>>2]=r,o[r+24>>2]=l)}while(!1);return j>>>0<16?(wt=j+X|0,o[B+4>>2]=wt|3,wt=B+wt+4|0,o[wt>>2]=o[wt>>2]|1):(o[B+4>>2]=X|3,o[T+4>>2]=j|1,o[T+j>>2]=j,ue|0&&(d=o[5862]|0,r=ue>>>3,l=23468+(r<<1<<2)|0,r=1<<r,r&Se?(i=l+8|0,r=o[i>>2]|0):(o[5857]=r|Se,r=l,i=l+8|0),o[i>>2]=d,o[r+12>>2]=d,o[d+8>>2]=r,o[d+12>>2]=l),o[5859]=j,o[5862]=T),wt=B+8|0,Dt=si,wt|0}else Se=X}else Se=X}else Se=X}else if(i>>>0<=4294967231)if(i=i+11|0,X=i&-8,d=o[5858]|0,d){_=0-X|0,i=i>>>8,i?X>>>0>16777215?j=31:(Se=(i+1048320|0)>>>16&8,et=i<<Se,B=(et+520192|0)>>>16&4,et=et<<B,j=(et+245760|0)>>>16&2,j=14-(B|Se|j)+(et<<j>>>15)|0,j=X>>>(j+7|0)&1|j<<1):j=0,l=o[23732+(j<<2)>>2]|0;e:do if(!l)l=0,i=0,et=61;else for(i=0,B=X<<((j|0)==31?0:25-(j>>>1)|0),w=0;;){if(T=(o[l+4>>2]&-8)-X|0,T>>>0<_>>>0)if(T)i=l,_=T;else{i=l,_=0,et=65;break e}if(et=o[l+20>>2]|0,l=o[l+16+(B>>>31<<2)>>2]|0,w=(et|0)==0|(et|0)==(l|0)?w:et,l)B=B<<1;else{l=w,et=61;break}}while(!1);if((et|0)==61){if((l|0)==0&(i|0)==0){if(i=2<<j,i=(i|0-i)&d,!i){Se=X;break}Se=(i&0-i)+-1|0,T=Se>>>12&16,Se=Se>>>T,w=Se>>>5&8,Se=Se>>>w,B=Se>>>2&4,Se=Se>>>B,j=Se>>>1&2,Se=Se>>>j,l=Se>>>1&1,i=0,l=o[23732+((w|T|B|j|l)+(Se>>>l)<<2)>>2]|0}l?et=65:(B=i,T=_)}if((et|0)==65)for(w=l;;)if(Se=(o[w+4>>2]&-8)-X|0,l=Se>>>0<_>>>0,_=l?Se:_,i=l?w:i,l=o[w+16>>2]|0,l||(l=o[w+20>>2]|0),l)w=l;else{B=i,T=_;break}if(B|0&&T>>>0<((o[5859]|0)-X|0)>>>0&&(ue=B+X|0,ue>>>0>B>>>0)){w=o[B+24>>2]|0,r=o[B+12>>2]|0;do if((r|0)==(B|0)){if(i=B+20|0,r=o[i>>2]|0,!r&&(i=B+16|0,r=o[i>>2]|0,!r)){r=0;break}for(;;)if(_=r+20|0,l=o[_>>2]|0,l)r=l,i=_;else if(_=r+16|0,l=o[_>>2]|0,l)r=l,i=_;else break;o[i>>2]=0}else wt=o[B+8>>2]|0,o[wt+12>>2]=r,o[r+8>>2]=wt;while(!1);do if(w){if(i=o[B+28>>2]|0,l=23732+(i<<2)|0,(B|0)==(o[l>>2]|0)){if(o[l>>2]=r,!r){d=d&~(1<<i),o[5858]=d;break}}else if(wt=w+16|0,o[((o[wt>>2]|0)==(B|0)?wt:w+20|0)>>2]=r,!r)break;o[r+24>>2]=w,i=o[B+16>>2]|0,i|0&&(o[r+16>>2]=i,o[i+24>>2]=r),i=o[B+20>>2]|0,i&&(o[r+20>>2]=i,o[i+24>>2]=r)}while(!1);e:do if(T>>>0<16)wt=T+X|0,o[B+4>>2]=wt|3,wt=B+wt+4|0,o[wt>>2]=o[wt>>2]|1;else{if(o[B+4>>2]=X|3,o[ue+4>>2]=T|1,o[ue+T>>2]=T,r=T>>>3,T>>>0<256){l=23468+(r<<1<<2)|0,i=o[5857]|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=ue,o[r+12>>2]=ue,o[ue+8>>2]=r,o[ue+12>>2]=l;break}if(r=T>>>8,r?T>>>0>16777215?l=31:(Et=(r+1048320|0)>>>16&8,wt=r<<Et,ht=(wt+520192|0)>>>16&4,wt=wt<<ht,l=(wt+245760|0)>>>16&2,l=14-(ht|Et|l)+(wt<<l>>>15)|0,l=T>>>(l+7|0)&1|l<<1):l=0,r=23732+(l<<2)|0,o[ue+28>>2]=l,i=ue+16|0,o[i+4>>2]=0,o[i>>2]=0,i=1<<l,!(d&i)){o[5858]=d|i,o[r>>2]=ue,o[ue+24>>2]=r,o[ue+12>>2]=ue,o[ue+8>>2]=ue;break}r=o[r>>2]|0;t:do if((o[r+4>>2]&-8|0)!=(T|0)){for(d=T<<((l|0)==31?0:25-(l>>>1)|0);l=r+16+(d>>>31<<2)|0,i=o[l>>2]|0,!!i;)if((o[i+4>>2]&-8|0)==(T|0)){r=i;break t}else d=d<<1,r=i;o[l>>2]=ue,o[ue+24>>2]=r,o[ue+12>>2]=ue,o[ue+8>>2]=ue;break e}while(!1);Et=r+8|0,wt=o[Et>>2]|0,o[wt+12>>2]=ue,o[Et>>2]=ue,o[ue+8>>2]=wt,o[ue+12>>2]=r,o[ue+24>>2]=0}while(!1);return wt=B+8|0,Dt=si,wt|0}else Se=X}else Se=X;else Se=-1;while(!1);if(l=o[5859]|0,l>>>0>=Se>>>0)return r=l-Se|0,i=o[5862]|0,r>>>0>15?(wt=i+Se|0,o[5862]=wt,o[5859]=r,o[wt+4>>2]=r|1,o[i+l>>2]=r,o[i+4>>2]=Se|3):(o[5859]=0,o[5862]=0,o[i+4>>2]=l|3,wt=i+l+4|0,o[wt>>2]=o[wt>>2]|1),wt=i+8|0,Dt=si,wt|0;if(T=o[5860]|0,T>>>0>Se>>>0)return ht=T-Se|0,o[5860]=ht,wt=o[5863]|0,Et=wt+Se|0,o[5863]=Et,o[Et+4>>2]=ht|1,o[wt+4>>2]=Se|3,wt=wt+8|0,Dt=si,wt|0;if(o[5975]|0?i=o[5977]|0:(o[5977]=4096,o[5976]=4096,o[5978]=-1,o[5979]=-1,o[5980]=0,o[5968]=0,o[5975]=Te&-16^1431655768,i=4096),B=Se+48|0,j=Se+47|0,w=i+j|0,_=0-i|0,X=w&_,X>>>0<=Se>>>0||(i=o[5967]|0,i|0&&(ue=o[5965]|0,Te=ue+X|0,Te>>>0<=ue>>>0|Te>>>0>i>>>0)))return wt=0,Dt=si,wt|0;e:do if(o[5968]&4)r=0,et=143;else{l=o[5863]|0;t:do if(l){for(d=23876;Te=o[d>>2]|0,!(Te>>>0<=l>>>0&&(Te+(o[d+4>>2]|0)|0)>>>0>l>>>0);)if(i=o[d+8>>2]|0,i)d=i;else{et=128;break t}if(r=w-T&_,r>>>0<2147483647)if(i=s(r|0)|0,(i|0)==((o[d>>2]|0)+(o[d+4>>2]|0)|0)){if((i|0)!=-1){T=r,w=i,et=145;break e}}else d=i,et=136;else r=0}else et=128;while(!1);do if((et|0)==128)if(l=s(0)|0,(l|0)!=-1&&(r=l,Re=o[5976]|0,Be=Re+-1|0,r=(Be&r|0?(Be+r&0-Re)-r|0:0)+X|0,Re=o[5965]|0,Be=r+Re|0,r>>>0>Se>>>0&r>>>0<2147483647)){if(Te=o[5967]|0,Te|0&&Be>>>0<=Re>>>0|Be>>>0>Te>>>0){r=0;break}if(i=s(r|0)|0,(i|0)==(l|0)){T=r,w=l,et=145;break e}else d=i,et=136}else r=0;while(!1);do if((et|0)==136){if(l=0-r|0,!(B>>>0>r>>>0&(r>>>0<2147483647&(d|0)!=-1)))if((d|0)==-1){r=0;break}else{T=r,w=d,et=145;break e}if(i=o[5977]|0,i=j-r+i&0-i,i>>>0>=2147483647){T=r,w=d,et=145;break e}if((s(i|0)|0)==-1){s(l|0)|0,r=0;break}else{T=i+r|0,w=d,et=145;break e}}while(!1);o[5968]=o[5968]|4,et=143}while(!1);if((et|0)==143&&X>>>0<2147483647&&(ht=s(X|0)|0,Be=s(0)|0,vt=Be-ht|0,ot=vt>>>0>(Se+40|0)>>>0,!((ht|0)==-1|ot^1|ht>>>0<Be>>>0&((ht|0)!=-1&(Be|0)!=-1)^1))&&(T=ot?vt:r,w=ht,et=145),(et|0)==145){r=(o[5965]|0)+T|0,o[5965]=r,r>>>0>(o[5966]|0)>>>0&&(o[5966]=r),j=o[5863]|0;e:do if(j){for(r=23876;;){if(i=o[r>>2]|0,l=o[r+4>>2]|0,(w|0)==(i+l|0)){et=154;break}if(d=o[r+8>>2]|0,d)r=d;else break}if((et|0)==154&&(Et=r+4|0,(o[r+12>>2]&8|0)==0)&&w>>>0>j>>>0&i>>>0<=j>>>0){o[Et>>2]=l+T,wt=(o[5860]|0)+T|0,ht=j+8|0,ht=ht&7|0?0-ht&7:0,Et=j+ht|0,ht=wt-ht|0,o[5863]=Et,o[5860]=ht,o[Et+4>>2]=ht|1,o[j+wt+4>>2]=40,o[5864]=o[5979];break}for(w>>>0<(o[5861]|0)>>>0&&(o[5861]=w),l=w+T|0,r=23876;;){if((o[r>>2]|0)==(l|0)){et=162;break}if(i=o[r+8>>2]|0,i)r=i;else break}if((et|0)==162&&!(o[r+12>>2]&8|0)){o[r>>2]=w,ue=r+4|0,o[ue>>2]=(o[ue>>2]|0)+T,ue=w+8|0,ue=w+(ue&7|0?0-ue&7:0)|0,r=l+8|0,r=l+(r&7|0?0-r&7:0)|0,X=ue+Se|0,B=r-ue-Se|0,o[ue+4>>2]=Se|3;t:do if((j|0)==(r|0))wt=(o[5860]|0)+B|0,o[5860]=wt,o[5863]=X,o[X+4>>2]=wt|1;else{if((o[5862]|0)==(r|0)){wt=(o[5859]|0)+B|0,o[5859]=wt,o[5862]=X,o[X+4>>2]=wt|1,o[X+wt>>2]=wt;break}if(i=o[r+4>>2]|0,(i&3|0)==1){T=i&-8,d=i>>>3;i:do if(i>>>0<256)if(i=o[r+8>>2]|0,l=o[r+12>>2]|0,(l|0)==(i|0)){o[5857]=o[5857]&~(1<<d);break}else{o[i+12>>2]=l,o[l+8>>2]=i;break}else{w=o[r+24>>2]|0,i=o[r+12>>2]|0;do if((i|0)==(r|0)){if(l=r+16|0,d=l+4|0,i=o[d>>2]|0,i)l=d;else if(i=o[l>>2]|0,!i){i=0;break}for(;;)if(_=i+20|0,d=o[_>>2]|0,d)i=d,l=_;else if(_=i+16|0,d=o[_>>2]|0,d)i=d,l=_;else break;o[l>>2]=0}else wt=o[r+8>>2]|0,o[wt+12>>2]=i,o[i+8>>2]=wt;while(!1);if(!w)break;l=o[r+28>>2]|0,d=23732+(l<<2)|0;do if((o[d>>2]|0)!=(r|0)){if(wt=w+16|0,o[((o[wt>>2]|0)==(r|0)?wt:w+20|0)>>2]=i,!i)break i}else{if(o[d>>2]=i,i|0)break;o[5858]=o[5858]&~(1<<l);break i}while(!1);if(o[i+24>>2]=w,l=r+16|0,d=o[l>>2]|0,d|0&&(o[i+16>>2]=d,o[d+24>>2]=i),l=o[l+4>>2]|0,!l)break;o[i+20>>2]=l,o[l+24>>2]=i}while(!1);r=r+T|0,_=T+B|0}else _=B;if(r=r+4|0,o[r>>2]=o[r>>2]&-2,o[X+4>>2]=_|1,o[X+_>>2]=_,r=_>>>3,_>>>0<256){l=23468+(r<<1<<2)|0,i=o[5857]|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=X,o[r+12>>2]=X,o[X+8>>2]=r,o[X+12>>2]=l;break}r=_>>>8;do if(!r)d=0;else{if(_>>>0>16777215){d=31;break}Et=(r+1048320|0)>>>16&8,wt=r<<Et,ht=(wt+520192|0)>>>16&4,wt=wt<<ht,d=(wt+245760|0)>>>16&2,d=14-(ht|Et|d)+(wt<<d>>>15)|0,d=_>>>(d+7|0)&1|d<<1}while(!1);if(r=23732+(d<<2)|0,o[X+28>>2]=d,i=X+16|0,o[i+4>>2]=0,o[i>>2]=0,i=o[5858]|0,l=1<<d,!(i&l)){o[5858]=i|l,o[r>>2]=X,o[X+24>>2]=r,o[X+12>>2]=X,o[X+8>>2]=X;break}r=o[r>>2]|0;i:do if((o[r+4>>2]&-8|0)!=(_|0)){for(d=_<<((d|0)==31?0:25-(d>>>1)|0);l=r+16+(d>>>31<<2)|0,i=o[l>>2]|0,!!i;)if((o[i+4>>2]&-8|0)==(_|0)){r=i;break i}else d=d<<1,r=i;o[l>>2]=X,o[X+24>>2]=r,o[X+12>>2]=X,o[X+8>>2]=X;break t}while(!1);Et=r+8|0,wt=o[Et>>2]|0,o[wt+12>>2]=X,o[Et>>2]=X,o[X+8>>2]=wt,o[X+12>>2]=r,o[X+24>>2]=0}while(!1);return wt=ue+8|0,Dt=si,wt|0}for(r=23876;i=o[r>>2]|0,!(i>>>0<=j>>>0&&(wt=i+(o[r+4>>2]|0)|0,wt>>>0>j>>>0));)r=o[r+8>>2]|0;_=wt+-47|0,i=_+8|0,i=_+(i&7|0?0-i&7:0)|0,_=j+16|0,i=i>>>0<_>>>0?j:i,r=i+8|0,l=T+-40|0,ht=w+8|0,ht=ht&7|0?0-ht&7:0,Et=w+ht|0,ht=l-ht|0,o[5863]=Et,o[5860]=ht,o[Et+4>>2]=ht|1,o[w+l+4>>2]=40,o[5864]=o[5979],l=i+4|0,o[l>>2]=27,o[r>>2]=o[5969],o[r+4>>2]=o[5970],o[r+8>>2]=o[5971],o[r+12>>2]=o[5972],o[5969]=w,o[5970]=T,o[5972]=0,o[5971]=r,r=i+24|0;do Et=r,r=r+4|0,o[r>>2]=7;while((Et+8|0)>>>0<wt>>>0);if((i|0)!=(j|0)){if(w=i-j|0,o[l>>2]=o[l>>2]&-2,o[j+4>>2]=w|1,o[i>>2]=w,r=w>>>3,w>>>0<256){l=23468+(r<<1<<2)|0,i=o[5857]|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=j,o[r+12>>2]=j,o[j+8>>2]=r,o[j+12>>2]=l;break}if(r=w>>>8,r?w>>>0>16777215?d=31:(Et=(r+1048320|0)>>>16&8,wt=r<<Et,ht=(wt+520192|0)>>>16&4,wt=wt<<ht,d=(wt+245760|0)>>>16&2,d=14-(ht|Et|d)+(wt<<d>>>15)|0,d=w>>>(d+7|0)&1|d<<1):d=0,l=23732+(d<<2)|0,o[j+28>>2]=d,o[j+20>>2]=0,o[_>>2]=0,r=o[5858]|0,i=1<<d,!(r&i)){o[5858]=r|i,o[l>>2]=j,o[j+24>>2]=l,o[j+12>>2]=j,o[j+8>>2]=j;break}r=o[l>>2]|0;t:do if((o[r+4>>2]&-8|0)!=(w|0)){for(d=w<<((d|0)==31?0:25-(d>>>1)|0);l=r+16+(d>>>31<<2)|0,i=o[l>>2]|0,!!i;)if((o[i+4>>2]&-8|0)==(w|0)){r=i;break t}else d=d<<1,r=i;o[l>>2]=j,o[j+24>>2]=r,o[j+12>>2]=j,o[j+8>>2]=j;break e}while(!1);Et=r+8|0,wt=o[Et>>2]|0,o[wt+12>>2]=j,o[Et>>2]=j,o[j+8>>2]=wt,o[j+12>>2]=r,o[j+24>>2]=0}}else wt=o[5861]|0,(wt|0)==0|w>>>0<wt>>>0&&(o[5861]=w),o[5969]=w,o[5970]=T,o[5972]=0,o[5866]=o[5975],o[5865]=-1,o[5870]=23468,o[5869]=23468,o[5872]=23476,o[5871]=23476,o[5874]=23484,o[5873]=23484,o[5876]=23492,o[5875]=23492,o[5878]=23500,o[5877]=23500,o[5880]=23508,o[5879]=23508,o[5882]=23516,o[5881]=23516,o[5884]=23524,o[5883]=23524,o[5886]=23532,o[5885]=23532,o[5888]=23540,o[5887]=23540,o[5890]=23548,o[5889]=23548,o[5892]=23556,o[5891]=23556,o[5894]=23564,o[5893]=23564,o[5896]=23572,o[5895]=23572,o[5898]=23580,o[5897]=23580,o[5900]=23588,o[5899]=23588,o[5902]=23596,o[5901]=23596,o[5904]=23604,o[5903]=23604,o[5906]=23612,o[5905]=23612,o[5908]=23620,o[5907]=23620,o[5910]=23628,o[5909]=23628,o[5912]=23636,o[5911]=23636,o[5914]=23644,o[5913]=23644,o[5916]=23652,o[5915]=23652,o[5918]=23660,o[5917]=23660,o[5920]=23668,o[5919]=23668,o[5922]=23676,o[5921]=23676,o[5924]=23684,o[5923]=23684,o[5926]=23692,o[5925]=23692,o[5928]=23700,o[5927]=23700,o[5930]=23708,o[5929]=23708,o[5932]=23716,o[5931]=23716,wt=T+-40|0,ht=w+8|0,ht=ht&7|0?0-ht&7:0,Et=w+ht|0,ht=wt-ht|0,o[5863]=Et,o[5860]=ht,o[Et+4>>2]=ht|1,o[w+wt+4>>2]=40,o[5864]=o[5979];while(!1);if(r=o[5860]|0,r>>>0>Se>>>0)return ht=r-Se|0,o[5860]=ht,wt=o[5863]|0,Et=wt+Se|0,o[5863]=Et,o[Et+4>>2]=ht|1,o[wt+4>>2]=Se|3,wt=wt+8|0,Dt=si,wt|0}return wt=Vo()|0,o[wt>>2]=12,wt=0,Dt=si,wt|0}function C(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0;if(i){l=i+-8|0,_=o[5861]|0,i=o[i+-4>>2]|0,r=i&-8,j=l+r|0;do if(i&1)B=l,T=l;else{if(d=o[l>>2]|0,!(i&3)||(T=l+(0-d)|0,w=d+r|0,T>>>0<_>>>0))return;if((o[5862]|0)==(T|0)){if(i=j+4|0,r=o[i>>2]|0,(r&3|0)!=3){B=T,r=w;break}o[5859]=w,o[i>>2]=r&-2,o[T+4>>2]=w|1,o[T+w>>2]=w;return}if(l=d>>>3,d>>>0<256)if(i=o[T+8>>2]|0,r=o[T+12>>2]|0,(r|0)==(i|0)){o[5857]=o[5857]&~(1<<l),B=T,r=w;break}else{o[i+12>>2]=r,o[r+8>>2]=i,B=T,r=w;break}_=o[T+24>>2]|0,i=o[T+12>>2]|0;do if((i|0)==(T|0)){if(r=T+16|0,l=r+4|0,i=o[l>>2]|0,i)r=l;else if(i=o[r>>2]|0,!i){i=0;break}for(;;)if(d=i+20|0,l=o[d>>2]|0,l)i=l,r=d;else if(d=i+16|0,l=o[d>>2]|0,l)i=l,r=d;else break;o[r>>2]=0}else B=o[T+8>>2]|0,o[B+12>>2]=i,o[i+8>>2]=B;while(!1);if(_){if(r=o[T+28>>2]|0,l=23732+(r<<2)|0,(o[l>>2]|0)==(T|0)){if(o[l>>2]=i,!i){o[5858]=o[5858]&~(1<<r),B=T,r=w;break}}else if(B=_+16|0,o[((o[B>>2]|0)==(T|0)?B:_+20|0)>>2]=i,!i){B=T,r=w;break}o[i+24>>2]=_,r=T+16|0,l=o[r>>2]|0,l|0&&(o[i+16>>2]=l,o[l+24>>2]=i),r=o[r+4>>2]|0,r?(o[i+20>>2]=r,o[r+24>>2]=i,B=T,r=w):(B=T,r=w)}else B=T,r=w}while(!1);if(!(T>>>0>=j>>>0)&&(i=j+4|0,d=o[i>>2]|0,!!(d&1))){if(d&2)o[i>>2]=d&-2,o[B+4>>2]=r|1,o[T+r>>2]=r,_=r;else{if((o[5863]|0)==(j|0)){if(j=(o[5860]|0)+r|0,o[5860]=j,o[5863]=B,o[B+4>>2]=j|1,(B|0)!=(o[5862]|0))return;o[5862]=0,o[5859]=0;return}if((o[5862]|0)==(j|0)){j=(o[5859]|0)+r|0,o[5859]=j,o[5862]=T,o[B+4>>2]=j|1,o[T+j>>2]=j;return}_=(d&-8)+r|0,l=d>>>3;do if(d>>>0<256)if(r=o[j+8>>2]|0,i=o[j+12>>2]|0,(i|0)==(r|0)){o[5857]=o[5857]&~(1<<l);break}else{o[r+12>>2]=i,o[i+8>>2]=r;break}else{w=o[j+24>>2]|0,i=o[j+12>>2]|0;do if((i|0)==(j|0)){if(r=j+16|0,l=r+4|0,i=o[l>>2]|0,i)r=l;else if(i=o[r>>2]|0,!i){l=0;break}for(;;)if(d=i+20|0,l=o[d>>2]|0,l)i=l,r=d;else if(d=i+16|0,l=o[d>>2]|0,l)i=l,r=d;else break;o[r>>2]=0,l=i}else l=o[j+8>>2]|0,o[l+12>>2]=i,o[i+8>>2]=l,l=i;while(!1);if(w|0){if(i=o[j+28>>2]|0,r=23732+(i<<2)|0,(o[r>>2]|0)==(j|0)){if(o[r>>2]=l,!l){o[5858]=o[5858]&~(1<<i);break}}else if(d=w+16|0,o[((o[d>>2]|0)==(j|0)?d:w+20|0)>>2]=l,!l)break;o[l+24>>2]=w,i=j+16|0,r=o[i>>2]|0,r|0&&(o[l+16>>2]=r,o[r+24>>2]=l),i=o[i+4>>2]|0,i|0&&(o[l+20>>2]=i,o[i+24>>2]=l)}}while(!1);if(o[B+4>>2]=_|1,o[T+_>>2]=_,(B|0)==(o[5862]|0)){o[5859]=_;return}}if(i=_>>>3,_>>>0<256){l=23468+(i<<1<<2)|0,r=o[5857]|0,i=1<<i,r&i?(r=l+8|0,i=o[r>>2]|0):(o[5857]=r|i,i=l,r=l+8|0),o[r>>2]=B,o[i+12>>2]=B,o[B+8>>2]=i,o[B+12>>2]=l;return}i=_>>>8,i?_>>>0>16777215?d=31:(T=(i+1048320|0)>>>16&8,j=i<<T,w=(j+520192|0)>>>16&4,j=j<<w,d=(j+245760|0)>>>16&2,d=14-(w|T|d)+(j<<d>>>15)|0,d=_>>>(d+7|0)&1|d<<1):d=0,i=23732+(d<<2)|0,o[B+28>>2]=d,o[B+20>>2]=0,o[B+16>>2]=0,r=o[5858]|0,l=1<<d;e:do if(!(r&l))o[5858]=r|l,o[i>>2]=B,o[B+24>>2]=i,o[B+12>>2]=B,o[B+8>>2]=B;else{i=o[i>>2]|0;t:do if((o[i+4>>2]&-8|0)!=(_|0)){for(d=_<<((d|0)==31?0:25-(d>>>1)|0);l=i+16+(d>>>31<<2)|0,r=o[l>>2]|0,!!r;)if((o[r+4>>2]&-8|0)==(_|0)){i=r;break t}else d=d<<1,i=r;o[l>>2]=B,o[B+24>>2]=i,o[B+12>>2]=B,o[B+8>>2]=B;break e}while(!1);T=i+8|0,j=o[T>>2]|0,o[j+12>>2]=B,o[T>>2]=B,o[B+8>>2]=j,o[B+12>>2]=i,o[B+24>>2]=0}while(!1);if(j=(o[5865]|0)+-1|0,o[5865]=j,!(j|0)){for(i=23884;i=o[i>>2]|0,i;)i=i+8|0;o[5865]=-1}}}}function D(i,r){i=i|0,r=r|0;var l=0;return i?(l=ji(r,i)|0,(r|i)>>>0>65535&&(l=((l>>>0)/(i>>>0)|0|0)==(r|0)?l:-1)):l=0,i=Ds(l)|0,!i||!(o[i+-4>>2]&3)||O(i|0,0,l|0)|0,i|0}function z(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,l=i+l>>>0,Yi(r+d+(l>>>0<i>>>0|0)>>>0|0),l|0|0}function R(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,d=r-d-(l>>>0>i>>>0|0)>>>0,Yi(d|0),i-l>>>0|0|0}function ee(i){return i=i|0,(i?31-(Wt(i^i-1)|0)|0:32)|0}function le(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ue=0,Se=0,Te=0,Re=0,Be=0;if(ue=i,j=r,X=j,T=l,Te=d,B=Te,!X)return w=(_|0)!=0,B?w?(o[_>>2]=i|0,o[_+4>>2]=r&0,Te=0,_=0,Yi(Te|0),_|0):(Te=0,_=0,Yi(Te|0),_|0):(w&&(o[_>>2]=(ue>>>0)%(T>>>0),o[_+4>>2]=0),Te=0,_=(ue>>>0)/(T>>>0)>>>0,Yi(Te|0),_|0);w=(B|0)==0;do if(T){if(!w){if(w=(Wt(B|0)|0)-(Wt(X|0)|0)|0,w>>>0<=31){Se=w+1|0,B=31-w|0,r=w-31>>31,T=Se,i=ue>>>(Se>>>0)&r|X<<B,r=X>>>(Se>>>0)&r,w=0,B=ue<<B;break}return _?(o[_>>2]=i|0,o[_+4>>2]=j|r&0,Te=0,_=0,Yi(Te|0),_|0):(Te=0,_=0,Yi(Te|0),_|0)}if(w=T-1|0,w&T|0){B=(Wt(T|0)|0)+33-(Wt(X|0)|0)|0,Be=64-B|0,Se=32-B|0,j=Se>>31,Re=B-32|0,r=Re>>31,T=B,i=Se-1>>31&X>>>(Re>>>0)|(X<<Se|ue>>>(B>>>0))&r,r=r&X>>>(B>>>0),w=ue<<Be&j,B=(X<<Be|ue>>>(Re>>>0))&j|ue<<Se&B-33>>31;break}return _|0&&(o[_>>2]=w&ue,o[_+4>>2]=0),(T|0)==1?(Re=j|r&0,Be=i|0|0,Yi(Re|0),Be|0):(Be=ee(T|0)|0,Re=X>>>(Be>>>0)|0,Be=X<<32-Be|ue>>>(Be>>>0)|0,Yi(Re|0),Be|0)}else{if(w)return _|0&&(o[_>>2]=(X>>>0)%(T>>>0),o[_+4>>2]=0),Re=0,Be=(X>>>0)/(T>>>0)>>>0,Yi(Re|0),Be|0;if(!ue)return _|0&&(o[_>>2]=0,o[_+4>>2]=(X>>>0)%(B>>>0)),Re=0,Be=(X>>>0)/(B>>>0)>>>0,Yi(Re|0),Be|0;if(w=B-1|0,!(w&B))return _|0&&(o[_>>2]=i|0,o[_+4>>2]=w&X|r&0),Re=0,Be=X>>>((ee(B|0)|0)>>>0),Yi(Re|0),Be|0;if(w=(Wt(B|0)|0)-(Wt(X|0)|0)|0,w>>>0<=30){r=w+1|0,B=31-w|0,T=r,i=X<<B|ue>>>(r>>>0),r=X>>>(r>>>0),w=0,B=ue<<B;break}return _?(o[_>>2]=i|0,o[_+4>>2]=j|r&0,Re=0,Be=0,Yi(Re|0),Be|0):(Re=0,Be=0,Yi(Re|0),Be|0)}while(!1);if(!T)X=B,j=0,B=0;else{Se=l|0|0,ue=Te|d&0,X=z(Se|0,ue|0,-1,-1)|0,l=Ut()|0,j=B,B=0;do d=j,j=w>>>31|j<<1,w=B|w<<1,d=i<<1|d>>>31|0,Te=i>>>31|r<<1|0,R(X|0,l|0,d|0,Te|0)|0,Be=Ut()|0,Re=Be>>31|((Be|0)<0?-1:0)<<1,B=Re&1,i=R(d|0,Te|0,Re&Se|0,(((Be|0)<0?-1:0)>>31|((Be|0)<0?-1:0)<<1)&ue|0)|0,r=Ut()|0,T=T-1|0;while(T|0);X=j,j=0}return T=0,_|0&&(o[_>>2]=i,o[_+4>>2]=r),Re=(w|0)>>>31|(X|T)<<1|(T<<1|w>>>31)&0|j,Be=(w<<1|0)&-2|B,Yi(Re|0),Be|0}function oe(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0;return X=r>>31|((r|0)<0?-1:0)<<1,j=((r|0)<0?-1:0)>>31|((r|0)<0?-1:0)<<1,w=d>>31|((d|0)<0?-1:0)<<1,_=((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1,B=R(X^i|0,j^r|0,X|0,j|0)|0,T=Ut()|0,i=w^X,r=_^j,R((le(B,T,R(w^l|0,_^d|0,w|0,_|0)|0,Ut()|0,0)|0)^i|0,(Ut()|0)^r|0,i|0,r|0)|0}function we(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return w=i&65535,_=r&65535,l=ji(_,w)|0,d=i>>>16,i=(l>>>16)+(ji(_,d)|0)|0,_=r>>>16,r=ji(_,w)|0,Yi((i>>>16)+(ji(_,d)|0)+(((i&65535)+r|0)>>>16)|0),i+r<<16|l&65535|0|0}function We(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0;return _=i,w=l,l=we(_,w)|0,i=Ut()|0,Yi((ji(r,w)|0)+(ji(d,_)|0)+i|i&0|0),l|0|0|0}function yt(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0;return _=Dt,Dt=Dt+16|0,B=_|0,T=r>>31|((r|0)<0?-1:0)<<1,w=((r|0)<0?-1:0)>>31|((r|0)<0?-1:0)<<1,X=d>>31|((d|0)<0?-1:0)<<1,j=((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1,i=R(T^i|0,w^r|0,T|0,w|0)|0,r=Ut()|0,le(i,r,R(X^l|0,j^d|0,X|0,j|0)|0,Ut()|0,B)|0,d=R(o[B>>2]^T|0,o[B+4>>2]^w|0,T|0,w|0)|0,l=Ut()|0,Dt=_,Yi(l|0),d|0}function Ct(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0;return w=Dt,Dt=Dt+16|0,_=w|0,le(i,r,l,d,_)|0,Dt=w,Yi(o[_+4>>2]|0),o[_>>2]|0|0}function ri(i,r,l){return i=i|0,r=r|0,l=l|0,(l|0)<32?(Yi(r>>l|0),i>>>l|(r&(1<<l)-1)<<32-l):(Yi(((r|0)<0?-1:0)|0),r>>l-32|0)}function Gt(i,r,l){return i=i|0,r=r|0,l=l|0,(l|0)<32?(Yi(r>>>l|0),i>>>l|(r&(1<<l)-1)<<32-l):(Yi(0),r>>>l-32|0)}function Zt(i,r,l){return i=i|0,r=r|0,l=l|0,(l|0)<32?(Yi(r<<l|(i&(1<<l)-1<<32-l)>>>32-l|0),i<<l):(Yi(i<<l-32|0),0)}function Z(i,r){return i=+i,r=+r,i!=i?+r:r!=r?+i:+Vn(+i,+r)}function A(i,r){return i=+i,r=+r,i!=i?+r:r!=r?+i:+ur(+i,+r)}function E(i){return i=+i,i>=0?+Ai(i+.5):+jr(i-.5)}function F(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if((l|0)>=8192)return Ur(i|0,r|0,l|0)|0,i|0;if(w=i|0,_=i+l|0,(i&3)==(r&3)){for(;i&3;){if(!l)return w|0;kt[i>>0]=kt[r>>0]|0,i=i+1|0,r=r+1|0,l=l-1|0}for(l=_&-4|0,d=l-64|0;(i|0)<=(d|0);)o[i>>2]=o[r>>2],o[i+4>>2]=o[r+4>>2],o[i+8>>2]=o[r+8>>2],o[i+12>>2]=o[r+12>>2],o[i+16>>2]=o[r+16>>2],o[i+20>>2]=o[r+20>>2],o[i+24>>2]=o[r+24>>2],o[i+28>>2]=o[r+28>>2],o[i+32>>2]=o[r+32>>2],o[i+36>>2]=o[r+36>>2],o[i+40>>2]=o[r+40>>2],o[i+44>>2]=o[r+44>>2],o[i+48>>2]=o[r+48>>2],o[i+52>>2]=o[r+52>>2],o[i+56>>2]=o[r+56>>2],o[i+60>>2]=o[r+60>>2],i=i+64|0,r=r+64|0;for(;(i|0)<(l|0);)o[i>>2]=o[r>>2],i=i+4|0,r=r+4|0}else for(l=_-4|0;(i|0)<(l|0);)kt[i>>0]=kt[r>>0]|0,kt[i+1>>0]=kt[r+1>>0]|0,kt[i+2>>0]=kt[r+2>>0]|0,kt[i+3>>0]=kt[r+3>>0]|0,i=i+4|0,r=r+4|0;for(;(i|0)<(_|0);)kt[i>>0]=kt[r>>0]|0,i=i+1|0,r=r+1|0;return w|0}function O(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;if(w=i+l|0,r=r&255,(l|0)>=67){for(;i&3;)kt[i>>0]=r,i=i+1|0;for(d=w&-4|0,T=r|r<<8|r<<16|r<<24,_=d-64|0;(i|0)<=(_|0);)o[i>>2]=T,o[i+4>>2]=T,o[i+8>>2]=T,o[i+12>>2]=T,o[i+16>>2]=T,o[i+20>>2]=T,o[i+24>>2]=T,o[i+28>>2]=T,o[i+32>>2]=T,o[i+36>>2]=T,o[i+40>>2]=T,o[i+44>>2]=T,o[i+48>>2]=T,o[i+52>>2]=T,o[i+56>>2]=T,o[i+60>>2]=T,i=i+64|0;for(;(i|0)<(d|0);)o[i>>2]=T,i=i+4|0}for(;(i|0)<(w|0);)kt[i>>0]=r,i=i+1|0;return w-l|0}function y(i){return i=+i,i>=0?+Ai(i+.5):+jr(i-.5)}function s(i){i=i|0;var r=0,l=0,d=0;return d=Vs()|0,l=o[fi>>2]|0,r=l+i|0,(i|0)>0&(r|0)<(l|0)|(r|0)<0?(hr(r|0)|0,cr(12),-1):(r|0)>(d|0)&&!(Vt(r|0)|0)?(cr(12),-1):(o[fi>>2]=r,l|0)}return{___divdi3:oe,___muldi3:We,___remdi3:yt,___uremdi3:Ct,_areNeighborCells:Oo,_bitshift64Ashr:ri,_bitshift64Lshr:Gt,_bitshift64Shl:Zt,_calloc:D,_cellAreaKm2:Ps,_cellAreaM2:ps,_cellAreaRads2:Hs,_cellToBoundary:Nr,_cellToCenterChild:Xr,_cellToChildPos:Pa,_cellToChildren:nr,_cellToChildrenSize:Ms,_cellToLatLng:gr,_cellToLocalIj:No,_cellToParent:Zr,_cellToVertex:Jn,_cellToVertexes:tl,_cellsToDirectedEdge:Wo,_cellsToLinkedMultiPolygon:xe,_childPosToCell:Ka,_compactCells:Po,_destroyLinkedMultiPolygon:vo,_directedEdgeToBoundary:Sa,_directedEdgeToCells:Xo,_edgeLengthKm:yo,_edgeLengthM:os,_edgeLengthRads:Ja,_emscripten_replace_memory:Fr,_free:C,_getBaseCellNumber:Ol,_getDirectedEdgeDestination:Gs,_getDirectedEdgeOrigin:ko,_getHexagonAreaAvgKm2:xi,_getHexagonAreaAvgM2:Fi,_getHexagonEdgeLengthAvgKm:Ln,_getHexagonEdgeLengthAvgM:jn,_getIcosahedronFaces:_o,_getNumCells:or,_getPentagons:Ea,_getRes0Cells:ja,_getResolution:qn,_greatCircleDistanceKm:Vi,_greatCircleDistanceM:Pi,_greatCircleDistanceRads:pi,_gridDisk:Ga,_gridDiskDistances:Xs,_gridDistance:En,_gridPathCells:Cn,_gridPathCellsSize:$l,_gridRingUnsafe:al,_i64Add:z,_i64Subtract:R,_isPentagon:Mr,_isResClassIII:ds,_isValidCell:ns,_isValidDirectedEdge:$o,_isValidVertex:oa,_latLngToCell:Ya,_llvm_maxnum_f64:Z,_llvm_minnum_f64:A,_llvm_round_f64:E,_localIjToCell:Nl,_malloc:Ds,_maxFaceCount:Aa,_maxGridDiskSize:Fo,_maxPolygonToCellsSize:ol,_memcpy:F,_memset:O,_originToDirectedEdges:Yo,_pentagonCount:ea,_polygonToCells:Ha,_readInt64AsDoubleFromPointer:_u,_res0CellCount:Or,_round:y,_sbrk:s,_sizeOfCellBoundary:Xu,_sizeOfCoordIJ:el,_sizeOfGeoLoop:Xl,_sizeOfGeoPolygon:ms,_sizeOfH3Index:ta,_sizeOfLatLng:oc,_sizeOfLinkedGeoPolygon:_a,_uncompactCells:ul,_uncompactCellsSize:Qr,_vertexToLatLng:Tu,establishStackSpace:Ua,stackAlloc:Us,stackRestore:Dr,stackSave:ca}}(rt,Me,xt);t.___divdi3=se.___divdi3,t.___muldi3=se.___muldi3,t.___remdi3=se.___remdi3,t.___uremdi3=se.___uremdi3,t._areNeighborCells=se._areNeighborCells,t._bitshift64Ashr=se._bitshift64Ashr,t._bitshift64Lshr=se._bitshift64Lshr,t._bitshift64Shl=se._bitshift64Shl,t._calloc=se._calloc,t._cellAreaKm2=se._cellAreaKm2,t._cellAreaM2=se._cellAreaM2,t._cellAreaRads2=se._cellAreaRads2,t._cellToBoundary=se._cellToBoundary,t._cellToCenterChild=se._cellToCenterChild,t._cellToChildPos=se._cellToChildPos,t._cellToChildren=se._cellToChildren,t._cellToChildrenSize=se._cellToChildrenSize,t._cellToLatLng=se._cellToLatLng,t._cellToLocalIj=se._cellToLocalIj,t._cellToParent=se._cellToParent,t._cellToVertex=se._cellToVertex,t._cellToVertexes=se._cellToVertexes,t._cellsToDirectedEdge=se._cellsToDirectedEdge,t._cellsToLinkedMultiPolygon=se._cellsToLinkedMultiPolygon,t._childPosToCell=se._childPosToCell,t._compactCells=se._compactCells,t._destroyLinkedMultiPolygon=se._destroyLinkedMultiPolygon,t._directedEdgeToBoundary=se._directedEdgeToBoundary,t._directedEdgeToCells=se._directedEdgeToCells,t._edgeLengthKm=se._edgeLengthKm,t._edgeLengthM=se._edgeLengthM,t._edgeLengthRads=se._edgeLengthRads;var ne=t._emscripten_replace_memory=se._emscripten_replace_memory;t._free=se._free,t._getBaseCellNumber=se._getBaseCellNumber,t._getDirectedEdgeDestination=se._getDirectedEdgeDestination,t._getDirectedEdgeOrigin=se._getDirectedEdgeOrigin,t._getHexagonAreaAvgKm2=se._getHexagonAreaAvgKm2,t._getHexagonAreaAvgM2=se._getHexagonAreaAvgM2,t._getHexagonEdgeLengthAvgKm=se._getHexagonEdgeLengthAvgKm,t._getHexagonEdgeLengthAvgM=se._getHexagonEdgeLengthAvgM,t._getIcosahedronFaces=se._getIcosahedronFaces,t._getNumCells=se._getNumCells,t._getPentagons=se._getPentagons,t._getRes0Cells=se._getRes0Cells,t._getResolution=se._getResolution,t._greatCircleDistanceKm=se._greatCircleDistanceKm,t._greatCircleDistanceM=se._greatCircleDistanceM,t._greatCircleDistanceRads=se._greatCircleDistanceRads,t._gridDisk=se._gridDisk,t._gridDiskDistances=se._gridDiskDistances,t._gridDistance=se._gridDistance,t._gridPathCells=se._gridPathCells,t._gridPathCellsSize=se._gridPathCellsSize,t._gridRingUnsafe=se._gridRingUnsafe,t._i64Add=se._i64Add,t._i64Subtract=se._i64Subtract,t._isPentagon=se._isPentagon,t._isResClassIII=se._isResClassIII,t._isValidCell=se._isValidCell,t._isValidDirectedEdge=se._isValidDirectedEdge,t._isValidVertex=se._isValidVertex,t._latLngToCell=se._latLngToCell,t._llvm_maxnum_f64=se._llvm_maxnum_f64,t._llvm_minnum_f64=se._llvm_minnum_f64,t._llvm_round_f64=se._llvm_round_f64,t._localIjToCell=se._localIjToCell,t._malloc=se._malloc,t._maxFaceCount=se._maxFaceCount,t._maxGridDiskSize=se._maxGridDiskSize,t._maxPolygonToCellsSize=se._maxPolygonToCellsSize,t._memcpy=se._memcpy,t._memset=se._memset,t._originToDirectedEdges=se._originToDirectedEdges,t._pentagonCount=se._pentagonCount,t._polygonToCells=se._polygonToCells,t._readInt64AsDoubleFromPointer=se._readInt64AsDoubleFromPointer,t._res0CellCount=se._res0CellCount,t._round=se._round,t._sbrk=se._sbrk,t._sizeOfCellBoundary=se._sizeOfCellBoundary,t._sizeOfCoordIJ=se._sizeOfCoordIJ,t._sizeOfGeoLoop=se._sizeOfGeoLoop,t._sizeOfGeoPolygon=se._sizeOfGeoPolygon,t._sizeOfH3Index=se._sizeOfH3Index,t._sizeOfLatLng=se._sizeOfLatLng,t._sizeOfLinkedGeoPolygon=se._sizeOfLinkedGeoPolygon,t._uncompactCells=se._uncompactCells,t._uncompactCellsSize=se._uncompactCellsSize,t._vertexToLatLng=se._vertexToLatLng,t.establishStackSpace=se.establishStackSpace;var $=t.stackAlloc=se.stackAlloc,ie=t.stackRestore=se.stackRestore,de=t.stackSave=se.stackSave;if(t.asm=se,t.cwrap=Tt,t.setValue=be,t.getValue=Je,sn){On(sn)||(sn=x(sn));{mr();var ye=function(De){De.byteLength&&(De=new Uint8Array(De)),lt.set(De,ce),t.memoryInitializerRequest&&delete t.memoryInitializerRequest.response,ci()},ge=function(){S(sn,ye,function(){throw"could not load memory initializer "+sn})},Pe=dt(sn);if(Pe)ye(Pe.buffer);else if(t.memoryInitializerRequest){var Fe=function(){var De=t.memoryInitializerRequest,Ge=De.response;if(De.status!==200&&De.status!==0){var At=dt(t.memoryInitializerRequestURL);if(At)Ge=At.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+De.status+", retrying "+sn),ge();return}}ye(Ge)};t.memoryInitializerRequest.response?setTimeout(Fe,0):t.memoryInitializerRequest.addEventListener("load",Fe)}else ge()}}var Ve;Ji=function De(){Ve||Xe(),Ve||(Ji=De)};function Xe(De){if(Xt>0||(nn(),Xt>0))return;function Ge(){Ve||(Ve=!0,!st&&(vn(),Ei(),t.onRuntimeInitialized&&t.onRuntimeInitialized(),mi()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),Ge()},1)):Ge()}t.run=Xe;function Ke(De){throw t.onAbort&&t.onAbort(De),De+="",a(De),U(De),st=!0,"abort("+De+"). Build with -s ASSERTIONS=1 for more info."}if(t.abort=Ke,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return Xe(),e}(typeof ka=="object"?ka:{}),Cs="number",Kr=Cs,eg=Cs,us=Cs,cs=Cs,tc=Cs,dr=Cs,mV=[["sizeOfH3Index",Cs],["sizeOfLatLng",Cs],["sizeOfCellBoundary",Cs],["sizeOfGeoLoop",Cs],["sizeOfGeoPolygon",Cs],["sizeOfLinkedGeoPolygon",Cs],["sizeOfCoordIJ",Cs],["readInt64AsDoubleFromPointer",Cs],["isValidCell",eg,[us,cs]],["latLngToCell",Kr,[Cs,Cs,tc,dr]],["cellToLatLng",Kr,[us,cs,dr]],["cellToBoundary",Kr,[us,cs,dr]],["maxGridDiskSize",Kr,[Cs,dr]],["gridDisk",Kr,[us,cs,Cs,dr]],["gridDiskDistances",Kr,[us,cs,Cs,dr,dr]],["gridRingUnsafe",Kr,[us,cs,Cs,dr]],["maxPolygonToCellsSize",Kr,[dr,tc,Cs,dr]],["polygonToCells",Kr,[dr,tc,Cs,dr]],["cellsToLinkedMultiPolygon",Kr,[dr,Cs,dr]],["destroyLinkedMultiPolygon",null,[dr]],["compactCells",Kr,[dr,dr,Cs,Cs]],["uncompactCells",Kr,[dr,Cs,Cs,dr,Cs,tc]],["uncompactCellsSize",Kr,[dr,Cs,Cs,tc,dr]],["isPentagon",eg,[us,cs]],["isResClassIII",eg,[us,cs]],["getBaseCellNumber",Cs,[us,cs]],["getResolution",Cs,[us,cs]],["maxFaceCount",Kr,[us,cs,dr]],["getIcosahedronFaces",Kr,[us,cs,dr]],["cellToParent",Kr,[us,cs,tc,dr]],["cellToChildren",Kr,[us,cs,tc,dr]],["cellToCenterChild",Kr,[us,cs,tc,dr]],["cellToChildrenSize",Kr,[us,cs,tc,dr]],["cellToChildPos",Kr,[us,cs,tc,dr]],["childPosToCell",Kr,[Cs,Cs,us,cs,tc,dr]],["areNeighborCells",Kr,[us,cs,us,cs,dr]],["cellsToDirectedEdge",Kr,[us,cs,us,cs,dr]],["getDirectedEdgeOrigin",Kr,[us,cs,dr]],["getDirectedEdgeDestination",Kr,[us,cs,dr]],["isValidDirectedEdge",eg,[us,cs]],["directedEdgeToCells",Kr,[us,cs,dr]],["originToDirectedEdges",Kr,[us,cs,dr]],["directedEdgeToBoundary",Kr,[us,cs,dr]],["gridDistance",Kr,[us,cs,us,cs,dr]],["gridPathCells",Kr,[us,cs,us,cs,dr]],["gridPathCellsSize",Kr,[us,cs,us,cs,dr]],["cellToLocalIj",Kr,[us,cs,us,cs,Cs,dr]],["localIjToCell",Kr,[us,cs,dr,Cs,dr]],["getHexagonAreaAvgM2",Kr,[tc,dr]],["getHexagonAreaAvgKm2",Kr,[tc,dr]],["getHexagonEdgeLengthAvgM",Kr,[tc,dr]],["getHexagonEdgeLengthAvgKm",Kr,[tc,dr]],["greatCircleDistanceM",Cs,[dr,dr]],["greatCircleDistanceKm",Cs,[dr,dr]],["greatCircleDistanceRads",Cs,[dr,dr]],["cellAreaM2",Kr,[us,cs,dr]],["cellAreaKm2",Kr,[us,cs,dr]],["cellAreaRads2",Kr,[us,cs,dr]],["edgeLengthM",Kr,[us,cs,dr]],["edgeLengthKm",Kr,[us,cs,dr]],["edgeLengthRads",Kr,[us,cs,dr]],["getNumCells",Kr,[tc,dr]],["getRes0Cells",Kr,[dr]],["res0CellCount",Cs],["getPentagons",Kr,[Cs,dr]],["pentagonCount",Cs],["cellToVertex",Kr,[us,cs,Cs,dr]],["cellToVertexes",Kr,[us,cs,dr]],["vertexToLatLng",Kr,[us,cs,dr]],["isValidVertex",eg,[us,cs]]],gV=0,_V=1,yV=2,vV=3,P5=4,xV=5,bV=6,wV=7,SV=8,IV=9,EV=10,CV=11,TV=12,kV=13,MV=14,PV=15,Wu={};Wu[gV]="Success";Wu[_V]="The operation failed but a more specific error is not available";Wu[yV]="Argument was outside of acceptable range";Wu[vV]="Latitude or longitude arguments were outside of acceptable range";Wu[P5]="Resolution argument was outside of acceptable range";Wu[xV]="Cell argument was not valid";Wu[bV]="Directed edge argument was not valid";Wu[wV]="Undirected edge argument was not valid";Wu[SV]="Vertex argument was not valid";Wu[IV]="Pentagon distortion was encountered";Wu[EV]="Duplicate input";Wu[CV]="Cell arguments were not neighbors";Wu[TV]="Cell arguments had incompatible resolutions";Wu[kV]="Memory allocation failed";Wu[MV]="Bounds of provided memory were insufficient";Wu[PV]="Mode or flags argument was not valid";var DV=1e3,D5=1001,L5=1002,_1={};_1[DV]="Unknown unit";_1[D5]="Array length out of bounds";_1[L5]="Got unexpected null value for H3 index";var LV="Unknown error";function B5(e,t,n){var c=n&&"value"in n,g=new Error((e[t]||LV)+" (code: "+t+(c?", value: "+n.value:"")+")");return g.code=t,g}function z5(e,t){var n=arguments.length===2?{value:t}:{};return B5(Wu,e,n)}function R5(e,t){var n=arguments.length===2?{value:t}:{};return B5(_1,e,n)}function j_(e){if(e!==0)throw z5(e)}var gh={};mV.forEach(function(t){gh[t[0]]=ka.cwrap.apply(ka,t)});var sm=16,Cg=4,P2=8,BV=8,Z_=gh.sizeOfH3Index(),D2=gh.sizeOfLatLng();gh.sizeOfCellBoundary();var zV=gh.sizeOfGeoPolygon(),fg=gh.sizeOfGeoLoop();gh.sizeOfLinkedGeoPolygon();gh.sizeOfCoordIJ();function RV(e){if(typeof e!="number"||e<0||e>15||Math.floor(e)!==e)throw z5(P5,e);return e}function FV(e){if(!e)throw R5(L5);return e}var OV=Math.pow(2,32)-1;function NV(e){if(e>OV)throw R5(D5,e);return e}var VV=/[^0-9a-fA-F]/;function UV(e){if(Array.isArray(e)&&e.length===2&&Number.isInteger(e[0])&&Number.isInteger(e[1]))return e;if(typeof e!="string"||VV.test(e))return[0,0];var t=parseInt(e.substring(0,e.length-8),sm),n=parseInt(e.substring(e.length-8),sm);return[n,t]}function Lw(e){if(e>=0)return e.toString(sm);e=e&2147483647;var t=F5(8,e.toString(sm)),n=(parseInt(t[0],sm)+8).toString(sm);return t=n+t.substring(1),t}function GV(e,t){return Lw(t)+F5(8,Lw(e))}function F5(e,t){for(var n=e-t.length,c="",g=0;g<n;g++)c+="0";return c=c+t,c}function Bw(e,t,n){for(var c=e.length,g=ka._calloc(c,D2),x=n?1:0,S=n?0:1,a=0;a<c*2;a+=2)ka.HEAPF64.set([e[a/2][x],e[a/2][S]].map(N5),g/P2+a);return ka.HEAPU32.set([c,g],t/Cg),t}function qV(e,t){var n=e.length-1,c=ka._calloc(zV),g=0,x=g+fg,S=x+Cg;Bw(e[0],c+g,t);var a;if(n>0){a=ka._calloc(n,fg);for(var U=0;U<n;U++)Bw(e[U+1],a+fg*U,t)}return ka.setValue(c+x,n,"i32"),ka.setValue(c+S,a,"i32"),c}function HV(e){var t=0,n=t+fg,c=n+Cg,g=Cg;ka._free(ka.getValue(e+t+g,"i8*"));var x=ka.getValue(e+n,"i32");if(x>0){for(var S=ka.getValue(e+c,"i32"),a=0;a<x;a++)ka._free(ka.getValue(S+fg*a+g,"i8*"));ka._free(S)}ka._free(e)}function O5(e,t){t===void 0&&(t=0);var n=ka.getValue(e+Z_*t,"i32"),c=ka.getValue(e+Z_*t+Cg,"i32");return c?GV(n,c):null}function jV(e){return gh.readInt64AsDoubleFromPointer(e)}function ZV(e,t){for(var n=[],c=0;c<t;c++){var g=O5(e,c);g!==null&&n.push(g)}return n}function zw(e){return XV(ka.getValue(e,"double"))}function QV(e){return[zw(e),zw(e+P2)]}function WV(e,t,n){var c=ka._malloc(D2);ka.HEAPF64.set([e,t].map(N5),c/P2);var g=ka._malloc(Z_);try{return j_(gh.latLngToCell(c,n,g)),FV(O5(g))}finally{ka._free(g),ka._free(c)}}function Rw(e){var t=ka._malloc(D2),n=UV(e),c=n[0],g=n[1];try{return j_(gh.cellToLatLng(c,g,t)),QV(t)}finally{ka._free(t)}}function $V(e,t,n){if(RV(t),n=!!n,e.length===0||e[0].length===0)return[];var c=typeof e[0][0]=="number"?[e]:e,g=qV(c,n),x=ka._malloc(BV);try{j_(gh.maxPolygonToCellsSize(g,t,0,x));var S=NV(jV(x)),a=ka._calloc(S,Z_);try{return j_(gh.polygonToCells(g,t,0,a)),ZV(a,S)}finally{ka._free(a)}}finally{ka._free(x),HV(g)}}function N5(e){return e*Math.PI/180}function XV(e){return e*180/Math.PI}function YV(e,t,n){n===void 0&&(n={});var c={type:"Feature"};return(n.id===0||n.id)&&(c.id=n.id),n.bbox&&(c.bbox=n.bbox),c.properties=t||{},c.geometry=e,c}function KV(e,t){t===void 0&&(t={});var n={type:"FeatureCollection"};return t.id&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.features=e,n}function JV(e,t){if(e.type==="Feature")t(e,0);else if(e.type==="FeatureCollection")for(var n=0;n<e.features.length&&t(e.features[n],n)!==!1;n++);}function eU(e){var t={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return JV(e,function(n){var c,g,x,S;switch((S=n.geometry)===null||S===void 0?void 0:S.type){case"Point":t.MultiPoint.coordinates.push(n.geometry.coordinates),t.MultiPoint.properties.push(n.properties);break;case"MultiPoint":(c=t.MultiPoint.coordinates).push.apply(c,n.geometry.coordinates),t.MultiPoint.properties.push(n.properties);break;case"LineString":t.MultiLineString.coordinates.push(n.geometry.coordinates),t.MultiLineString.properties.push(n.properties);break;case"MultiLineString":(g=t.MultiLineString.coordinates).push.apply(g,n.geometry.coordinates),t.MultiLineString.properties.push(n.properties);break;case"Polygon":t.MultiPolygon.coordinates.push(n.geometry.coordinates),t.MultiPolygon.properties.push(n.properties);break;case"MultiPolygon":(x=t.MultiPolygon.coordinates).push.apply(x,n.geometry.coordinates),t.MultiPolygon.properties.push(n.properties);break}}),KV(Object.keys(t).filter(function(n){return t[n].coordinates.length}).sort().map(function(n){var c={type:n,coordinates:t[n].coordinates},g={collectedProperties:t[n].properties};return YV(c,g)}))}const V5=e=>()=>e,Mv=e=>{const t=e?(n,c)=>c.minus(n).abs().isLessThanOrEqualTo(e):V5(!1);return(n,c)=>t(n,c)?0:n.comparedTo(c)};function tU(e){const t=e?(n,c,g,x,S)=>n.exponentiatedBy(2).isLessThanOrEqualTo(x.minus(c).exponentiatedBy(2).plus(S.minus(g).exponentiatedBy(2)).times(e)):V5(!1);return(n,c,g)=>{const x=n.x,S=n.y,a=g.x,U=g.y,W=S.minus(U).times(c.x.minus(a)).minus(x.minus(a).times(c.y.minus(U)));return t(W,x,S,a,U)?0:W.comparedTo(0)}}var iU=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,cy=Math.ceil,Bh=Math.floor,Uc="[BigNumber Error] ",Fw=Uc+"Number primitive has more than 15 significant digits: ",oA=1e14,Es=14,hy=9007199254740991,Ay=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],N0=1e7,Du=1e9;function U5(e){var t,n,c,g=ct.prototype={constructor:ct,toString:null,valueOf:null},x=new ct(1),S=20,a=4,U=-7,W=21,he=-1e7,ae=1e7,ce=!1,be=1,Je=0,st={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},Ye="0123456789abcdefghijklmnopqrstuvwxyz",it=!0;function ct(at,_t){var mt,xt,bt,lt,$e,pt,ut,Nt,Bt=this;if(!(Bt instanceof ct))return new ct(at,_t);if(_t==null){if(at&&at._isBigNumber===!0){Bt.s=at.s,!at.c||at.e>ae?Bt.c=Bt.e=null:at.e<he?Bt.c=[Bt.e=0]:(Bt.e=at.e,Bt.c=at.c.slice());return}if((pt=typeof at=="number")&&at*0==0){if(Bt.s=1/at<0?(at=-at,-1):1,at===~~at){for(lt=0,$e=at;$e>=10;$e/=10,lt++);lt>ae?Bt.c=Bt.e=null:(Bt.e=lt,Bt.c=[at]);return}Nt=String(at)}else{if(!iU.test(Nt=String(at)))return c(Bt,Nt,pt);Bt.s=Nt.charCodeAt(0)==45?(Nt=Nt.slice(1),-1):1}(lt=Nt.indexOf("."))>-1&&(Nt=Nt.replace(".","")),($e=Nt.search(/e/i))>0?(lt<0&&(lt=$e),lt+=+Nt.slice($e+1),Nt=Nt.substring(0,$e)):lt<0&&(lt=Nt.length)}else{if(Fl(_t,2,Ye.length,"Base"),_t==10&&it)return Bt=new ct(at),Oe(Bt,S+Bt.e+1,a);if(Nt=String(at),pt=typeof at=="number"){if(at*0!=0)return c(Bt,Nt,pt,_t);if(Bt.s=1/at<0?(Nt=Nt.slice(1),-1):1,ct.DEBUG&&Nt.replace(/^0\.0*|\./,"").length>15)throw Error(Fw+at)}else Bt.s=Nt.charCodeAt(0)===45?(Nt=Nt.slice(1),-1):1;for(mt=Ye.slice(0,_t),lt=$e=0,ut=Nt.length;$e<ut;$e++)if(mt.indexOf(xt=Nt.charAt($e))<0){if(xt=="."){if($e>lt){lt=ut;continue}}else if(!bt&&(Nt==Nt.toUpperCase()&&(Nt=Nt.toLowerCase())||Nt==Nt.toLowerCase()&&(Nt=Nt.toUpperCase()))){bt=!0,$e=-1,lt=0;continue}return c(Bt,String(at),pt,_t)}pt=!1,Nt=n(Nt,_t,10,Bt.s),(lt=Nt.indexOf("."))>-1?Nt=Nt.replace(".",""):lt=Nt.length}for($e=0;Nt.charCodeAt($e)===48;$e++);for(ut=Nt.length;Nt.charCodeAt(--ut)===48;);if(Nt=Nt.slice($e,++ut)){if(ut-=$e,pt&&ct.DEBUG&&ut>15&&(at>hy||at!==Bh(at)))throw Error(Fw+Bt.s*at);if((lt=lt-$e-1)>ae)Bt.c=Bt.e=null;else if(lt<he)Bt.c=[Bt.e=0];else{if(Bt.e=lt,Bt.c=[],$e=(lt+1)%Es,lt<0&&($e+=Es),$e<ut){for($e&&Bt.c.push(+Nt.slice(0,$e)),ut-=Es;$e<ut;)Bt.c.push(+Nt.slice($e,$e+=Es));$e=Es-(Nt=Nt.slice($e)).length}else $e-=ut;for(;$e--;Nt+="0");Bt.c.push(+Nt)}}else Bt.c=[Bt.e=0]}ct.clone=U5,ct.ROUND_UP=0,ct.ROUND_DOWN=1,ct.ROUND_CEIL=2,ct.ROUND_FLOOR=3,ct.ROUND_HALF_UP=4,ct.ROUND_HALF_DOWN=5,ct.ROUND_HALF_EVEN=6,ct.ROUND_HALF_CEIL=7,ct.ROUND_HALF_FLOOR=8,ct.EUCLID=9,ct.config=ct.set=function(at){var _t,mt;if(at!=null)if(typeof at=="object"){if(at.hasOwnProperty(_t="DECIMAL_PLACES")&&(mt=at[_t],Fl(mt,0,Du,_t),S=mt),at.hasOwnProperty(_t="ROUNDING_MODE")&&(mt=at[_t],Fl(mt,0,8,_t),a=mt),at.hasOwnProperty(_t="EXPONENTIAL_AT")&&(mt=at[_t],mt&&mt.pop?(Fl(mt[0],-Du,0,_t),Fl(mt[1],0,Du,_t),U=mt[0],W=mt[1]):(Fl(mt,-Du,Du,_t),U=-(W=mt<0?-mt:mt))),at.hasOwnProperty(_t="RANGE"))if(mt=at[_t],mt&&mt.pop)Fl(mt[0],-Du,-1,_t),Fl(mt[1],1,Du,_t),he=mt[0],ae=mt[1];else if(Fl(mt,-Du,Du,_t),mt)he=-(ae=mt<0?-mt:mt);else throw Error(Uc+_t+" cannot be zero: "+mt);if(at.hasOwnProperty(_t="CRYPTO"))if(mt=at[_t],mt===!!mt)if(mt)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))ce=mt;else throw ce=!mt,Error(Uc+"crypto unavailable");else ce=mt;else throw Error(Uc+_t+" not true or false: "+mt);if(at.hasOwnProperty(_t="MODULO_MODE")&&(mt=at[_t],Fl(mt,0,9,_t),be=mt),at.hasOwnProperty(_t="POW_PRECISION")&&(mt=at[_t],Fl(mt,0,Du,_t),Je=mt),at.hasOwnProperty(_t="FORMAT"))if(mt=at[_t],typeof mt=="object")st=mt;else throw Error(Uc+_t+" not an object: "+mt);if(at.hasOwnProperty(_t="ALPHABET"))if(mt=at[_t],typeof mt=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(mt))it=mt.slice(0,10)=="0123456789",Ye=mt;else throw Error(Uc+_t+" invalid: "+mt)}else throw Error(Uc+"Object expected: "+at);return{DECIMAL_PLACES:S,ROUNDING_MODE:a,EXPONENTIAL_AT:[U,W],RANGE:[he,ae],CRYPTO:ce,MODULO_MODE:be,POW_PRECISION:Je,FORMAT:st,ALPHABET:Ye}},ct.isBigNumber=function(at){if(!at||at._isBigNumber!==!0)return!1;if(!ct.DEBUG)return!0;var _t,mt,xt=at.c,bt=at.e,lt=at.s;e:if({}.toString.call(xt)=="[object Array]"){if((lt===1||lt===-1)&&bt>=-Du&&bt<=Du&&bt===Bh(bt)){if(xt[0]===0){if(bt===0&&xt.length===1)return!0;break e}if(_t=(bt+1)%Es,_t<1&&(_t+=Es),String(xt[0]).length==_t){for(_t=0;_t<xt.length;_t++)if(mt=xt[_t],mt<0||mt>=oA||mt!==Bh(mt))break e;if(mt!==0)return!0}}}else if(xt===null&&bt===null&&(lt===null||lt===1||lt===-1))return!0;throw Error(Uc+"Invalid BigNumber: "+at)},ct.maximum=ct.max=function(){return zt(arguments,-1)},ct.minimum=ct.min=function(){return zt(arguments,1)},ct.random=function(){var at=9007199254740992,_t=Math.random()*at&2097151?function(){return Bh(Math.random()*at)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(mt){var xt,bt,lt,$e,pt,ut=0,Nt=[],Bt=new ct(x);if(mt==null?mt=S:Fl(mt,0,Du),$e=cy(mt/Es),ce)if(crypto.getRandomValues){for(xt=crypto.getRandomValues(new Uint32Array($e*=2));ut<$e;)pt=xt[ut]*131072+(xt[ut+1]>>>11),pt>=9e15?(bt=crypto.getRandomValues(new Uint32Array(2)),xt[ut]=bt[0],xt[ut+1]=bt[1]):(Nt.push(pt%1e14),ut+=2);ut=$e/2}else if(crypto.randomBytes){for(xt=crypto.randomBytes($e*=7);ut<$e;)pt=(xt[ut]&31)*281474976710656+xt[ut+1]*1099511627776+xt[ut+2]*4294967296+xt[ut+3]*16777216+(xt[ut+4]<<16)+(xt[ut+5]<<8)+xt[ut+6],pt>=9e15?crypto.randomBytes(7).copy(xt,ut):(Nt.push(pt%1e14),ut+=7);ut=$e/7}else throw ce=!1,Error(Uc+"crypto unavailable");if(!ce)for(;ut<$e;)pt=_t(),pt<9e15&&(Nt[ut++]=pt%1e14);for($e=Nt[--ut],mt%=Es,$e&&mt&&(pt=Ay[Es-mt],Nt[ut]=Bh($e/pt)*pt);Nt[ut]===0;Nt.pop(),ut--);if(ut<0)Nt=[lt=0];else{for(lt=-1;Nt[0]===0;Nt.splice(0,1),lt-=Es);for(ut=1,pt=Nt[0];pt>=10;pt/=10,ut++);ut<Es&&(lt-=Es-ut)}return Bt.e=lt,Bt.c=Nt,Bt}}(),ct.sum=function(){for(var at=1,_t=arguments,mt=new ct(_t[0]);at<_t.length;)mt=mt.plus(_t[at++]);return mt},n=function(){var at="0123456789";function _t(mt,xt,bt,lt){for(var $e,pt=[0],ut,Nt=0,Bt=mt.length;Nt<Bt;){for(ut=pt.length;ut--;pt[ut]*=xt);for(pt[0]+=lt.indexOf(mt.charAt(Nt++)),$e=0;$e<pt.length;$e++)pt[$e]>bt-1&&(pt[$e+1]==null&&(pt[$e+1]=0),pt[$e+1]+=pt[$e]/bt|0,pt[$e]%=bt)}return pt.reverse()}return function(mt,xt,bt,lt,$e){var pt,ut,Nt,Bt,Ot,gi,Ii,Ci,Ri=mt.indexOf("."),Ki=S,Hi=a;for(Ri>=0&&(Bt=Je,Je=0,mt=mt.replace(".",""),Ci=new ct(xt),gi=Ci.pow(mt.length-Ri),Je=Bt,Ci.c=_t(Xf(Lh(gi.c),gi.e,"0"),10,bt,at),Ci.e=Ci.c.length),Ii=_t(mt,xt,bt,$e?(pt=Ye,at):(pt=at,Ye)),Nt=Bt=Ii.length;Ii[--Bt]==0;Ii.pop());if(!Ii[0])return pt.charAt(0);if(Ri<0?--Nt:(gi.c=Ii,gi.e=Nt,gi.s=lt,gi=t(gi,Ci,Ki,Hi,bt),Ii=gi.c,Ot=gi.r,Nt=gi.e),ut=Nt+Ki+1,Ri=Ii[ut],Bt=bt/2,Ot=Ot||ut<0||Ii[ut+1]!=null,Ot=Hi<4?(Ri!=null||Ot)&&(Hi==0||Hi==(gi.s<0?3:2)):Ri>Bt||Ri==Bt&&(Hi==4||Ot||Hi==6&&Ii[ut-1]&1||Hi==(gi.s<0?8:7)),ut<1||!Ii[0])mt=Ot?Xf(pt.charAt(1),-Ki,pt.charAt(0)):pt.charAt(0);else{if(Ii.length=ut,Ot)for(--bt;++Ii[--ut]>bt;)Ii[ut]=0,ut||(++Nt,Ii=[1].concat(Ii));for(Bt=Ii.length;!Ii[--Bt];);for(Ri=0,mt="";Ri<=Bt;mt+=pt.charAt(Ii[Ri++]));mt=Xf(mt,Nt,pt.charAt(0))}return mt}}(),t=function(){function at(xt,bt,lt){var $e,pt,ut,Nt,Bt=0,Ot=xt.length,gi=bt%N0,Ii=bt/N0|0;for(xt=xt.slice();Ot--;)ut=xt[Ot]%N0,Nt=xt[Ot]/N0|0,$e=Ii*ut+Nt*gi,pt=gi*ut+$e%N0*N0+Bt,Bt=(pt/lt|0)+($e/N0|0)+Ii*Nt,xt[Ot]=pt%lt;return Bt&&(xt=[Bt].concat(xt)),xt}function _t(xt,bt,lt,$e){var pt,ut;if(lt!=$e)ut=lt>$e?1:-1;else for(pt=ut=0;pt<lt;pt++)if(xt[pt]!=bt[pt]){ut=xt[pt]>bt[pt]?1:-1;break}return ut}function mt(xt,bt,lt,$e){for(var pt=0;lt--;)xt[lt]-=pt,pt=xt[lt]<bt[lt]?1:0,xt[lt]=pt*$e+xt[lt]-bt[lt];for(;!xt[0]&&xt.length>1;xt.splice(0,1));}return function(xt,bt,lt,$e,pt){var ut,Nt,Bt,Ot,gi,Ii,Ci,Ri,Ki,Hi,Ni,nn,vn,Ei,mi,zi,Oi,xn=xt.s==bt.s?1:-1,bn=xt.c,Yt=bt.c;if(!bn||!bn[0]||!Yt||!Yt[0])return new ct(!xt.s||!bt.s||(bn?Yt&&bn[0]==Yt[0]:!Yt)?NaN:bn&&bn[0]==0||!Yt?xn*0:xn/0);for(Ri=new ct(xn),Ki=Ri.c=[],Nt=xt.e-bt.e,xn=lt+Nt+1,pt||(pt=oA,Nt=zh(xt.e/Es)-zh(bt.e/Es),xn=xn/Es|0),Bt=0;Yt[Bt]==(bn[Bt]||0);Bt++);if(Yt[Bt]>(bn[Bt]||0)&&Nt--,xn<0)Ki.push(1),Ot=!0;else{for(Ei=bn.length,zi=Yt.length,Bt=0,xn+=2,gi=Bh(pt/(Yt[0]+1)),gi>1&&(Yt=at(Yt,gi,pt),bn=at(bn,gi,pt),zi=Yt.length,Ei=bn.length),vn=zi,Hi=bn.slice(0,zi),Ni=Hi.length;Ni<zi;Hi[Ni++]=0);Oi=Yt.slice(),Oi=[0].concat(Oi),mi=Yt[0],Yt[1]>=pt/2&&mi++;do{if(gi=0,ut=_t(Yt,Hi,zi,Ni),ut<0){if(nn=Hi[0],zi!=Ni&&(nn=nn*pt+(Hi[1]||0)),gi=Bh(nn/mi),gi>1)for(gi>=pt&&(gi=pt-1),Ii=at(Yt,gi,pt),Ci=Ii.length,Ni=Hi.length;_t(Ii,Hi,Ci,Ni)==1;)gi--,mt(Ii,zi<Ci?Oi:Yt,Ci,pt),Ci=Ii.length,ut=1;else gi==0&&(ut=gi=1),Ii=Yt.slice(),Ci=Ii.length;if(Ci<Ni&&(Ii=[0].concat(Ii)),mt(Hi,Ii,Ni,pt),Ni=Hi.length,ut==-1)for(;_t(Yt,Hi,zi,Ni)<1;)gi++,mt(Hi,zi<Ni?Oi:Yt,Ni,pt),Ni=Hi.length}else ut===0&&(gi++,Hi=[0]);Ki[Bt++]=gi,Hi[0]?Hi[Ni++]=bn[vn]||0:(Hi=[bn[vn]],Ni=1)}while((vn++<Ei||Hi[0]!=null)&&xn--);Ot=Hi[0]!=null,Ki[0]||Ki.splice(0,1)}if(pt==oA){for(Bt=1,xn=Ki[0];xn>=10;xn/=10,Bt++);Oe(Ri,lt+(Ri.e=Bt+Nt*Es-1)+1,$e,Ot)}else Ri.e=Nt,Ri.r=+Ot;return Ri}}();function Tt(at,_t,mt,xt){var bt,lt,$e,pt,ut;if(mt==null?mt=a:Fl(mt,0,8),!at.c)return at.toString();if(bt=at.c[0],$e=at.e,_t==null)ut=Lh(at.c),ut=xt==1||xt==2&&($e<=U||$e>=W)?Kg(ut,$e):Xf(ut,$e,"0");else if(at=Oe(new ct(at),_t,mt),lt=at.e,ut=Lh(at.c),pt=ut.length,xt==1||xt==2&&(_t<=lt||lt<=U)){for(;pt<_t;ut+="0",pt++);ut=Kg(ut,lt)}else if(_t-=$e,ut=Xf(ut,lt,"0"),lt+1>pt){if(--_t>0)for(ut+=".";_t--;ut+="0");}else if(_t+=lt-pt,_t>0)for(lt+1==pt&&(ut+=".");_t--;ut+="0");return at.s<0&&bt?"-"+ut:ut}function zt(at,_t){for(var mt,xt,bt=1,lt=new ct(at[0]);bt<at.length;bt++)xt=new ct(at[bt]),(!xt.s||(mt=jd(lt,xt))===_t||mt===0&&lt.s===_t)&&(lt=xt);return lt}function Rt(at,_t,mt){for(var xt=1,bt=_t.length;!_t[--bt];_t.pop());for(bt=_t[0];bt>=10;bt/=10,xt++);return(mt=xt+mt*Es-1)>ae?at.c=at.e=null:mt<he?at.c=[at.e=0]:(at.e=mt,at.c=_t),at}c=function(){var at=/^(-?)0([xbo])(?=\w[\w.]*$)/i,_t=/^([^.]+)\.$/,mt=/^\.([^.]+)$/,xt=/^-?(Infinity|NaN)$/,bt=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(lt,$e,pt,ut){var Nt,Bt=pt?$e:$e.replace(bt,"");if(xt.test(Bt))lt.s=isNaN(Bt)?null:Bt<0?-1:1;else{if(!pt&&(Bt=Bt.replace(at,function(Ot,gi,Ii){return Nt=(Ii=Ii.toLowerCase())=="x"?16:Ii=="b"?2:8,!ut||ut==Nt?gi:Ot}),ut&&(Nt=ut,Bt=Bt.replace(_t,"$1").replace(mt,"0.$1")),$e!=Bt))return new ct(Bt,Nt);if(ct.DEBUG)throw Error(Uc+"Not a"+(ut?" base "+ut:"")+" number: "+$e);lt.s=null}lt.c=lt.e=null}}();function Oe(at,_t,mt,xt){var bt,lt,$e,pt,ut,Nt,Bt,Ot=at.c,gi=Ay;if(Ot){e:{for(bt=1,pt=Ot[0];pt>=10;pt/=10,bt++);if(lt=_t-bt,lt<0)lt+=Es,$e=_t,ut=Ot[Nt=0],Bt=Bh(ut/gi[bt-$e-1]%10);else if(Nt=cy((lt+1)/Es),Nt>=Ot.length)if(xt){for(;Ot.length<=Nt;Ot.push(0));ut=Bt=0,bt=1,lt%=Es,$e=lt-Es+1}else break e;else{for(ut=pt=Ot[Nt],bt=1;pt>=10;pt/=10,bt++);lt%=Es,$e=lt-Es+bt,Bt=$e<0?0:Bh(ut/gi[bt-$e-1]%10)}if(xt=xt||_t<0||Ot[Nt+1]!=null||($e<0?ut:ut%gi[bt-$e-1]),xt=mt<4?(Bt||xt)&&(mt==0||mt==(at.s<0?3:2)):Bt>5||Bt==5&&(mt==4||xt||mt==6&&(lt>0?$e>0?ut/gi[bt-$e]:0:Ot[Nt-1])%10&1||mt==(at.s<0?8:7)),_t<1||!Ot[0])return Ot.length=0,xt?(_t-=at.e+1,Ot[0]=gi[(Es-_t%Es)%Es],at.e=-_t||0):Ot[0]=at.e=0,at;if(lt==0?(Ot.length=Nt,pt=1,Nt--):(Ot.length=Nt+1,pt=gi[Es-lt],Ot[Nt]=$e>0?Bh(ut/gi[bt-$e]%gi[$e])*pt:0),xt)for(;;)if(Nt==0){for(lt=1,$e=Ot[0];$e>=10;$e/=10,lt++);for($e=Ot[0]+=pt,pt=1;$e>=10;$e/=10,pt++);lt!=pt&&(at.e++,Ot[0]==oA&&(Ot[0]=1));break}else{if(Ot[Nt]+=pt,Ot[Nt]!=oA)break;Ot[Nt--]=0,pt=1}for(lt=Ot.length;Ot[--lt]===0;Ot.pop());}at.e>ae?at.c=at.e=null:at.e<he&&(at.c=[at.e=0])}return at}function jt(at){var _t,mt=at.e;return mt===null?at.toString():(_t=Lh(at.c),_t=mt<=U||mt>=W?Kg(_t,mt):Xf(_t,mt,"0"),at.s<0?"-"+_t:_t)}return g.absoluteValue=g.abs=function(){var at=new ct(this);return at.s<0&&(at.s=1),at},g.comparedTo=function(at,_t){return jd(this,new ct(at,_t))},g.decimalPlaces=g.dp=function(at,_t){var mt,xt,bt,lt=this;if(at!=null)return Fl(at,0,Du),_t==null?_t=a:Fl(_t,0,8),Oe(new ct(lt),at+lt.e+1,_t);if(!(mt=lt.c))return null;if(xt=((bt=mt.length-1)-zh(this.e/Es))*Es,bt=mt[bt])for(;bt%10==0;bt/=10,xt--);return xt<0&&(xt=0),xt},g.dividedBy=g.div=function(at,_t){return t(this,new ct(at,_t),S,a)},g.dividedToIntegerBy=g.idiv=function(at,_t){return t(this,new ct(at,_t),0,1)},g.exponentiatedBy=g.pow=function(at,_t){var mt,xt,bt,lt,$e,pt,ut,Nt,Bt,Ot=this;if(at=new ct(at),at.c&&!at.isInteger())throw Error(Uc+"Exponent not an integer: "+jt(at));if(_t!=null&&(_t=new ct(_t)),pt=at.e>14,!Ot.c||!Ot.c[0]||Ot.c[0]==1&&!Ot.e&&Ot.c.length==1||!at.c||!at.c[0])return Bt=new ct(Math.pow(+jt(Ot),pt?at.s*(2-Yg(at)):+jt(at))),_t?Bt.mod(_t):Bt;if(ut=at.s<0,_t){if(_t.c?!_t.c[0]:!_t.s)return new ct(NaN);xt=!ut&&Ot.isInteger()&&_t.isInteger(),xt&&(Ot=Ot.mod(_t))}else{if(at.e>9&&(Ot.e>0||Ot.e<-1||(Ot.e==0?Ot.c[0]>1||pt&&Ot.c[1]>=24e7:Ot.c[0]<8e13||pt&&Ot.c[0]<=9999975e7)))return lt=Ot.s<0&&Yg(at)?-0:0,Ot.e>-1&&(lt=1/lt),new ct(ut?1/lt:lt);Je&&(lt=cy(Je/Es+2))}for(pt?(mt=new ct(.5),ut&&(at.s=1),Nt=Yg(at)):(bt=Math.abs(+jt(at)),Nt=bt%2),Bt=new ct(x);;){if(Nt){if(Bt=Bt.times(Ot),!Bt.c)break;lt?Bt.c.length>lt&&(Bt.c.length=lt):xt&&(Bt=Bt.mod(_t))}if(bt){if(bt=Bh(bt/2),bt===0)break;Nt=bt%2}else if(at=at.times(mt),Oe(at,at.e+1,1),at.e>14)Nt=Yg(at);else{if(bt=+jt(at),bt===0)break;Nt=bt%2}Ot=Ot.times(Ot),lt?Ot.c&&Ot.c.length>lt&&(Ot.c.length=lt):xt&&(Ot=Ot.mod(_t))}return xt?Bt:(ut&&(Bt=x.div(Bt)),_t?Bt.mod(_t):lt?Oe(Bt,Je,a,$e):Bt)},g.integerValue=function(at){var _t=new ct(this);return at==null?at=a:Fl(at,0,8),Oe(_t,_t.e+1,at)},g.isEqualTo=g.eq=function(at,_t){return jd(this,new ct(at,_t))===0},g.isFinite=function(){return!!this.c},g.isGreaterThan=g.gt=function(at,_t){return jd(this,new ct(at,_t))>0},g.isGreaterThanOrEqualTo=g.gte=function(at,_t){return(_t=jd(this,new ct(at,_t)))===1||_t===0},g.isInteger=function(){return!!this.c&&zh(this.e/Es)>this.c.length-2},g.isLessThan=g.lt=function(at,_t){return jd(this,new ct(at,_t))<0},g.isLessThanOrEqualTo=g.lte=function(at,_t){return(_t=jd(this,new ct(at,_t)))===-1||_t===0},g.isNaN=function(){return!this.s},g.isNegative=function(){return this.s<0},g.isPositive=function(){return this.s>0},g.isZero=function(){return!!this.c&&this.c[0]==0},g.minus=function(at,_t){var mt,xt,bt,lt,$e=this,pt=$e.s;if(at=new ct(at,_t),_t=at.s,!pt||!_t)return new ct(NaN);if(pt!=_t)return at.s=-_t,$e.plus(at);var ut=$e.e/Es,Nt=at.e/Es,Bt=$e.c,Ot=at.c;if(!ut||!Nt){if(!Bt||!Ot)return Bt?(at.s=-_t,at):new ct(Ot?$e:NaN);if(!Bt[0]||!Ot[0])return Ot[0]?(at.s=-_t,at):new ct(Bt[0]?$e:a==3?-0:0)}if(ut=zh(ut),Nt=zh(Nt),Bt=Bt.slice(),pt=ut-Nt){for((lt=pt<0)?(pt=-pt,bt=Bt):(Nt=ut,bt=Ot),bt.reverse(),_t=pt;_t--;bt.push(0));bt.reverse()}else for(xt=(lt=(pt=Bt.length)<(_t=Ot.length))?pt:_t,pt=_t=0;_t<xt;_t++)if(Bt[_t]!=Ot[_t]){lt=Bt[_t]<Ot[_t];break}if(lt&&(bt=Bt,Bt=Ot,Ot=bt,at.s=-at.s),_t=(xt=Ot.length)-(mt=Bt.length),_t>0)for(;_t--;Bt[mt++]=0);for(_t=oA-1;xt>pt;){if(Bt[--xt]<Ot[xt]){for(mt=xt;mt&&!Bt[--mt];Bt[mt]=_t);--Bt[mt],Bt[xt]+=oA}Bt[xt]-=Ot[xt]}for(;Bt[0]==0;Bt.splice(0,1),--Nt);return Bt[0]?Rt(at,Bt,Nt):(at.s=a==3?-1:1,at.c=[at.e=0],at)},g.modulo=g.mod=function(at,_t){var mt,xt,bt=this;return at=new ct(at,_t),!bt.c||!at.s||at.c&&!at.c[0]?new ct(NaN):!at.c||bt.c&&!bt.c[0]?new ct(bt):(be==9?(xt=at.s,at.s=1,mt=t(bt,at,0,3),at.s=xt,mt.s*=xt):mt=t(bt,at,0,be),at=bt.minus(mt.times(at)),!at.c[0]&&be==1&&(at.s=bt.s),at)},g.multipliedBy=g.times=function(at,_t){var mt,xt,bt,lt,$e,pt,ut,Nt,Bt,Ot,gi,Ii,Ci,Ri,Ki,Hi=this,Ni=Hi.c,nn=(at=new ct(at,_t)).c;if(!Ni||!nn||!Ni[0]||!nn[0])return!Hi.s||!at.s||Ni&&!Ni[0]&&!nn||nn&&!nn[0]&&!Ni?at.c=at.e=at.s=null:(at.s*=Hi.s,!Ni||!nn?at.c=at.e=null:(at.c=[0],at.e=0)),at;for(xt=zh(Hi.e/Es)+zh(at.e/Es),at.s*=Hi.s,ut=Ni.length,Ot=nn.length,ut<Ot&&(Ci=Ni,Ni=nn,nn=Ci,bt=ut,ut=Ot,Ot=bt),bt=ut+Ot,Ci=[];bt--;Ci.push(0));for(Ri=oA,Ki=N0,bt=Ot;--bt>=0;){for(mt=0,gi=nn[bt]%Ki,Ii=nn[bt]/Ki|0,$e=ut,lt=bt+$e;lt>bt;)Nt=Ni[--$e]%Ki,Bt=Ni[$e]/Ki|0,pt=Ii*Nt+Bt*gi,Nt=gi*Nt+pt%Ki*Ki+Ci[lt]+mt,mt=(Nt/Ri|0)+(pt/Ki|0)+Ii*Bt,Ci[lt--]=Nt%Ri;Ci[lt]=mt}return mt?++xt:Ci.splice(0,1),Rt(at,Ci,xt)},g.negated=function(){var at=new ct(this);return at.s=-at.s||null,at},g.plus=function(at,_t){var mt,xt=this,bt=xt.s;if(at=new ct(at,_t),_t=at.s,!bt||!_t)return new ct(NaN);if(bt!=_t)return at.s=-_t,xt.minus(at);var lt=xt.e/Es,$e=at.e/Es,pt=xt.c,ut=at.c;if(!lt||!$e){if(!pt||!ut)return new ct(bt/0);if(!pt[0]||!ut[0])return ut[0]?at:new ct(pt[0]?xt:bt*0)}if(lt=zh(lt),$e=zh($e),pt=pt.slice(),bt=lt-$e){for(bt>0?($e=lt,mt=ut):(bt=-bt,mt=pt),mt.reverse();bt--;mt.push(0));mt.reverse()}for(bt=pt.length,_t=ut.length,bt-_t<0&&(mt=ut,ut=pt,pt=mt,_t=bt),bt=0;_t;)bt=(pt[--_t]=pt[_t]+ut[_t]+bt)/oA|0,pt[_t]=oA===pt[_t]?0:pt[_t]%oA;return bt&&(pt=[bt].concat(pt),++$e),Rt(at,pt,$e)},g.precision=g.sd=function(at,_t){var mt,xt,bt,lt=this;if(at!=null&&at!==!!at)return Fl(at,1,Du),_t==null?_t=a:Fl(_t,0,8),Oe(new ct(lt),at,_t);if(!(mt=lt.c))return null;if(bt=mt.length-1,xt=bt*Es+1,bt=mt[bt]){for(;bt%10==0;bt/=10,xt--);for(bt=mt[0];bt>=10;bt/=10,xt++);}return at&&lt.e+1>xt&&(xt=lt.e+1),xt},g.shiftedBy=function(at){return Fl(at,-hy,hy),this.times("1e"+at)},g.squareRoot=g.sqrt=function(){var at,_t,mt,xt,bt,lt=this,$e=lt.c,pt=lt.s,ut=lt.e,Nt=S+4,Bt=new ct("0.5");if(pt!==1||!$e||!$e[0])return new ct(!pt||pt<0&&(!$e||$e[0])?NaN:$e?lt:1/0);if(pt=Math.sqrt(+jt(lt)),pt==0||pt==1/0?(_t=Lh($e),(_t.length+ut)%2==0&&(_t+="0"),pt=Math.sqrt(+_t),ut=zh((ut+1)/2)-(ut<0||ut%2),pt==1/0?_t="5e"+ut:(_t=pt.toExponential(),_t=_t.slice(0,_t.indexOf("e")+1)+ut),mt=new ct(_t)):mt=new ct(pt+""),mt.c[0]){for(ut=mt.e,pt=ut+Nt,pt<3&&(pt=0);;)if(bt=mt,mt=Bt.times(bt.plus(t(lt,bt,Nt,1))),Lh(bt.c).slice(0,pt)===(_t=Lh(mt.c)).slice(0,pt))if(mt.e<ut&&--pt,_t=_t.slice(pt-3,pt+1),_t=="9999"||!xt&&_t=="4999"){if(!xt&&(Oe(bt,bt.e+S+2,0),bt.times(bt).eq(lt))){mt=bt;break}Nt+=4,pt+=4,xt=1}else{(!+_t||!+_t.slice(1)&&_t.charAt(0)=="5")&&(Oe(mt,mt.e+S+2,1),at=!mt.times(mt).eq(lt));break}}return Oe(mt,mt.e+S+1,a,at)},g.toExponential=function(at,_t){return at!=null&&(Fl(at,0,Du),at++),Tt(this,at,_t,1)},g.toFixed=function(at,_t){return at!=null&&(Fl(at,0,Du),at=at+this.e+1),Tt(this,at,_t)},g.toFormat=function(at,_t,mt){var xt,bt=this;if(mt==null)at!=null&&_t&&typeof _t=="object"?(mt=_t,_t=null):at&&typeof at=="object"?(mt=at,at=_t=null):mt=st;else if(typeof mt!="object")throw Error(Uc+"Argument not an object: "+mt);if(xt=bt.toFixed(at,_t),bt.c){var lt,$e=xt.split("."),pt=+mt.groupSize,ut=+mt.secondaryGroupSize,Nt=mt.groupSeparator||"",Bt=$e[0],Ot=$e[1],gi=bt.s<0,Ii=gi?Bt.slice(1):Bt,Ci=Ii.length;if(ut&&(lt=pt,pt=ut,ut=lt,Ci-=lt),pt>0&&Ci>0){for(lt=Ci%pt||pt,Bt=Ii.substr(0,lt);lt<Ci;lt+=pt)Bt+=Nt+Ii.substr(lt,pt);ut>0&&(Bt+=Nt+Ii.slice(lt)),gi&&(Bt="-"+Bt)}xt=Ot?Bt+(mt.decimalSeparator||"")+((ut=+mt.fractionGroupSize)?Ot.replace(new RegExp("\\d{"+ut+"}\\B","g"),"$&"+(mt.fractionGroupSeparator||"")):Ot):Bt}return(mt.prefix||"")+xt+(mt.suffix||"")},g.toFraction=function(at){var _t,mt,xt,bt,lt,$e,pt,ut,Nt,Bt,Ot,gi,Ii=this,Ci=Ii.c;if(at!=null&&(pt=new ct(at),!pt.isInteger()&&(pt.c||pt.s!==1)||pt.lt(x)))throw Error(Uc+"Argument "+(pt.isInteger()?"out of range: ":"not an integer: ")+jt(pt));if(!Ci)return new ct(Ii);for(_t=new ct(x),Nt=mt=new ct(x),xt=ut=new ct(x),gi=Lh(Ci),lt=_t.e=gi.length-Ii.e-1,_t.c[0]=Ay[($e=lt%Es)<0?Es+$e:$e],at=!at||pt.comparedTo(_t)>0?lt>0?_t:Nt:pt,$e=ae,ae=1/0,pt=new ct(gi),ut.c[0]=0;Bt=t(pt,_t,0,1),bt=mt.plus(Bt.times(xt)),bt.comparedTo(at)!=1;)mt=xt,xt=bt,Nt=ut.plus(Bt.times(bt=Nt)),ut=bt,_t=pt.minus(Bt.times(bt=_t)),pt=bt;return bt=t(at.minus(mt),xt,0,1),ut=ut.plus(bt.times(Nt)),mt=mt.plus(bt.times(xt)),ut.s=Nt.s=Ii.s,lt=lt*2,Ot=t(Nt,xt,lt,a).minus(Ii).abs().comparedTo(t(ut,mt,lt,a).minus(Ii).abs())<1?[Nt,xt]:[ut,mt],ae=$e,Ot},g.toNumber=function(){return+jt(this)},g.toPrecision=function(at,_t){return at!=null&&Fl(at,1,Du),Tt(this,at,_t,2)},g.toString=function(at){var _t,mt=this,xt=mt.s,bt=mt.e;return bt===null?xt?(_t="Infinity",xt<0&&(_t="-"+_t)):_t="NaN":(at==null?_t=bt<=U||bt>=W?Kg(Lh(mt.c),bt):Xf(Lh(mt.c),bt,"0"):at===10&&it?(mt=Oe(new ct(mt),S+bt+1,a),_t=Xf(Lh(mt.c),mt.e,"0")):(Fl(at,2,Ye.length,"Base"),_t=n(Xf(Lh(mt.c),bt,"0"),10,at,xt,!0)),xt<0&&mt.c[0]&&(_t="-"+_t)),_t},g.valueOf=g.toJSON=function(){return jt(this)},g._isBigNumber=!0,g[Symbol.toStringTag]="BigNumber",g[Symbol.for("nodejs.util.inspect.custom")]=g.valueOf,e!=null&&ct.set(e),ct}function zh(e){var t=e|0;return e>0||e===t?t:t-1}function Lh(e){for(var t,n,c=1,g=e.length,x=e[0]+"";c<g;){for(t=e[c++]+"",n=Es-t.length;n--;t="0"+t);x+=t}for(g=x.length;x.charCodeAt(--g)===48;);return x.slice(0,g+1||1)}function jd(e,t){var n,c,g=e.c,x=t.c,S=e.s,a=t.s,U=e.e,W=t.e;if(!S||!a)return null;if(n=g&&!g[0],c=x&&!x[0],n||c)return n?c?0:-a:S;if(S!=a)return S;if(n=S<0,c=U==W,!g||!x)return c?0:!g^n?1:-1;if(!c)return U>W^n?1:-1;for(a=(U=g.length)<(W=x.length)?U:W,S=0;S<a;S++)if(g[S]!=x[S])return g[S]>x[S]^n?1:-1;return U==W?0:U>W^n?1:-1}function Fl(e,t,n,c){if(e<t||e>n||e!==Bh(e))throw Error(Uc+(c||"Argument")+(typeof e=="number"?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function Yg(e){var t=e.c.length-1;return zh(e.e/Es)==t&&e.c[t]%2!=0}function Kg(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function Xf(e,t,n){var c,g;if(t<0){for(g=n+".";++t;g+=n);e=g+e}else if(c=e.length,++t>c){for(g=n,t-=c;--t;g+=n);e+=g}else t<c&&(e=e.slice(0,t)+"."+e.slice(t));return e}var XA=U5();class nU{constructor(t){kr(this,"key");kr(this,"left",null);kr(this,"right",null);this.key=t}}class tg extends nU{constructor(t){super(t)}}class rU{constructor(){kr(this,"size",0);kr(this,"modificationCount",0);kr(this,"splayCount",0)}splay(t){const n=this.root;if(n==null)return this.compare(t,t),-1;let c=null,g=null,x=null,S=null,a=n;const U=this.compare;let W;for(;;)if(W=U(a.key,t),W>0){let he=a.left;if(he==null||(W=U(he.key,t),W>0&&(a.left=he.right,he.right=a,a=he,he=a.left,he==null)))break;c==null?g=a:c.left=a,c=a,a=he}else if(W<0){let he=a.right;if(he==null||(W=U(he.key,t),W<0&&(a.right=he.left,he.left=a,a=he,he=a.right,he==null)))break;x==null?S=a:x.right=a,x=a,a=he}else break;return x!=null&&(x.right=a.left,a.left=S),c!=null&&(c.left=a.right,a.right=g),this.root!==a&&(this.root=a,this.splayCount++),W}splayMin(t){let n=t,c=n.left;for(;c!=null;){const g=c;n.left=g.right,g.right=n,n=g,c=n.left}return n}splayMax(t){let n=t,c=n.right;for(;c!=null;){const g=c;n.right=g.left,g.left=n,n=g,c=n.right}return n}_delete(t){if(this.root==null||this.splay(t)!=0)return null;let c=this.root;const g=c,x=c.left;if(this.size--,x==null)this.root=c.right;else{const S=c.right;c=this.splayMax(x),c.right=S,this.root=c}return this.modificationCount++,g}addNewRoot(t,n){this.size++,this.modificationCount++;const c=this.root;if(c==null){this.root=t;return}n<0?(t.left=c,t.right=c.right,c.right=null):(t.right=c,t.left=c.left,c.left=null),this.root=t}_first(){const t=this.root;return t==null?null:(this.root=this.splayMin(t),this.root)}_last(){const t=this.root;return t==null?null:(this.root=this.splayMax(t),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(t){return this.validKey(t)&&this.splay(t)==0}defaultCompare(){return(t,n)=>t<n?-1:t>n?1:0}wrap(){return{getRoot:()=>this.root,setRoot:t=>{this.root=t},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:t=>{this.splayCount=t},splay:t=>this.splay(t),has:t=>this.has(t)}}}var qU;const am=class am extends rU{constructor(n,c){super();kr(this,"root",null);kr(this,"compare");kr(this,"validKey");kr(this,qU,"[object Set]");this.compare=n??this.defaultCompare(),this.validKey=c??(g=>g!=null&&g!=null)}delete(n){return this.validKey(n)?this._delete(n)!=null:!1}deleteAll(n){for(const c of n)this.delete(c)}forEach(n){const c=this[Symbol.iterator]();let g;for(;g=c.next(),!g.done;)n(g.value,g.value,this)}add(n){const c=this.splay(n);return c!=0&&this.addNewRoot(new tg(n),c),this}addAndReturn(n){const c=this.splay(n);return c!=0&&this.addNewRoot(new tg(n),c),this.root.key}addAll(n){for(const c of n)this.add(c)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(n){if(n==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(n)<0)return this.root.key;let g=this.root.left;if(g==null)return null;let x=g.right;for(;x!=null;)g=x,x=g.right;return g.key}firstAfter(n){if(n==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(n)>0)return this.root.key;let g=this.root.right;if(g==null)return null;let x=g.left;for(;x!=null;)g=x,x=g.left;return g.key}retainAll(n){const c=new am(this.compare,this.validKey),g=this.modificationCount;for(const x of n){if(g!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(x)&&this.splay(x)==0&&c.add(this.root.key)}c.size!=this.size&&(this.root=c.root,this.size=c.size,this.modificationCount++)}lookup(n){return!this.validKey(n)||this.splay(n)!=0?null:this.root.key}intersection(n){const c=new am(this.compare,this.validKey);for(const g of this)n.has(g)&&c.add(g);return c}difference(n){const c=new am(this.compare,this.validKey);for(const g of this)n.has(g)||c.add(g);return c}union(n){const c=this.clone();return c.addAll(n),c}clone(){const n=new am(this.compare,this.validKey);return n.size=this.size,n.root=this.copyNode(this.root),n}copyNode(n){if(n==null)return null;function c(x,S){let a,U;do{if(a=x.left,U=x.right,a!=null){const W=new tg(a.key);S.left=W,c(a,W)}if(U!=null){const W=new tg(U.key);S.right=W,x=U,S=W}}while(U!=null)}const g=new tg(n.key);return c(n,g),g}toSet(){return this.clone()}entries(){return new aU(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[Symbol.iterator](){return new sU(this.wrap())}};qU=Symbol.toStringTag;let bm=am;class G5{constructor(t){kr(this,"tree");kr(this,"path",new Array);kr(this,"modificationCount",null);kr(this,"splayCount");this.tree=t,this.splayCount=t.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const t=this.path[this.path.length-1];return this.getValue(t)}rebuildPath(t){this.path.splice(0,this.path.length),this.tree.splay(t),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(t){for(;t!=null;)this.path.push(t),t=t.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let c=this.tree.getRoot();for(;c!=null;)this.path.push(c),c=c.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let t=this.path[this.path.length-1],n=t.right;if(n!=null){for(;n!=null;)this.path.push(n),n=n.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===t;)t=this.path.pop();return this.path.length>0}}class sU extends G5{getValue(t){return t.key}}class aU extends G5{getValue(t){return[t.key,t.key]}}const oU=e=>e,lU=e=>{if(e){const t=new bm(Mv(e)),n=new bm(Mv(e)),c=(x,S)=>S.addAndReturn(x),g=x=>({x:c(x.x,t),y:c(x.y,n)});return g({x:new XA(0),y:new XA(0)}),g}return oU},Pv=e=>({set:t=>{o0=Pv(t)},reset:()=>Pv(e),compare:Mv(e),snap:lU(e),orient:tU(e)});let o0=Pv();const ig=(e,t)=>e.ll.x.isLessThanOrEqualTo(t.x)&&t.x.isLessThanOrEqualTo(e.ur.x)&&e.ll.y.isLessThanOrEqualTo(t.y)&&t.y.isLessThanOrEqualTo(e.ur.y),Dv=(e,t)=>{if(t.ur.x.isLessThan(e.ll.x)||e.ur.x.isLessThan(t.ll.x)||t.ur.y.isLessThan(e.ll.y)||e.ur.y.isLessThan(t.ll.y))return null;const n=e.ll.x.isLessThan(t.ll.x)?t.ll.x:e.ll.x,c=e.ur.x.isLessThan(t.ur.x)?e.ur.x:t.ur.x,g=e.ll.y.isLessThan(t.ll.y)?t.ll.y:e.ll.y,x=e.ur.y.isLessThan(t.ur.y)?e.ur.y:t.ur.y;return{ll:{x:n,y:g},ur:{x:c,y:x}}},h_=(e,t)=>e.x.times(t.y).minus(e.y.times(t.x)),q5=(e,t)=>e.x.times(t.x).plus(e.y.times(t.y)),Q_=e=>q5(e,e).sqrt(),uU=(e,t,n)=>{const c={x:t.x.minus(e.x),y:t.y.minus(e.y)},g={x:n.x.minus(e.x),y:n.y.minus(e.y)};return h_(g,c).div(Q_(g)).div(Q_(c))},cU=(e,t,n)=>{const c={x:t.x.minus(e.x),y:t.y.minus(e.y)},g={x:n.x.minus(e.x),y:n.y.minus(e.y)};return q5(g,c).div(Q_(g)).div(Q_(c))},Ow=(e,t,n)=>t.y.isZero()?null:{x:e.x.plus(t.x.div(t.y).times(n.minus(e.y))),y:n},Nw=(e,t,n)=>t.x.isZero()?null:{x:n,y:e.y.plus(t.y.div(t.x).times(n.minus(e.x)))},hU=(e,t,n,c)=>{if(t.x.isZero())return Nw(n,c,e.x);if(c.x.isZero())return Nw(e,t,n.x);if(t.y.isZero())return Ow(n,c,e.y);if(c.y.isZero())return Ow(e,t,n.y);const g=h_(t,c);if(g.isZero())return null;const x={x:n.x.minus(e.x),y:n.y.minus(e.y)},S=h_(x,t).div(g),a=h_(x,c).div(g),U=e.x.plus(a.times(t.x)),W=n.x.plus(S.times(c.x)),he=e.y.plus(a.times(t.y)),ae=n.y.plus(S.times(c.y)),ce=U.plus(W).div(2),be=he.plus(ae).div(2);return{x:ce,y:be}};class Fh{constructor(t,n){kr(this,"point");kr(this,"isLeft");kr(this,"segment");kr(this,"otherSE");kr(this,"consumedBy");t.events===void 0?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=n}static compare(t,n){const c=Fh.comparePoints(t.point,n.point);return c!==0?c:(t.point!==n.point&&t.link(n),t.isLeft!==n.isLeft?t.isLeft?1:-1:V0.compare(t.segment,n.segment))}static comparePoints(t,n){return t.x.isLessThan(n.x)?-1:t.x.isGreaterThan(n.x)?1:t.y.isLessThan(n.y)?-1:t.y.isGreaterThan(n.y)?1:0}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const n=t.point.events;for(let c=0,g=n.length;c<g;c++){const x=n[c];this.point.events.push(x),x.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let n=0;n<t;n++){const c=this.point.events[n];if(c.segment.consumedBy===void 0)for(let g=n+1;g<t;g++){const x=this.point.events[g];x.consumedBy===void 0&&c.otherSE.point.events===x.otherSE.point.events&&c.segment.consume(x.segment)}}}getAvailableLinkedEvents(){const t=[];for(let n=0,c=this.point.events.length;n<c;n++){const g=this.point.events[n];g!==this&&!g.segment.ringOut&&g.segment.isInResult()&&t.push(g)}return t}getLeftmostComparator(t){const n=new Map,c=g=>{const x=g.otherSE;n.set(g,{sine:uU(this.point,t.point,x.point),cosine:cU(this.point,t.point,x.point)})};return(g,x)=>{n.has(g)||c(g),n.has(x)||c(x);const{sine:S,cosine:a}=n.get(g),{sine:U,cosine:W}=n.get(x);return S.isGreaterThanOrEqualTo(0)&&U.isGreaterThanOrEqualTo(0)?a.isLessThan(W)?1:a.isGreaterThan(W)?-1:0:S.isLessThan(0)&&U.isLessThan(0)?a.isLessThan(W)?-1:a.isGreaterThan(W)?1:0:U.isLessThan(S)?-1:U.isGreaterThan(S)?1:0}}}let AU=0;class V0{constructor(t,n,c,g){kr(this,"id");kr(this,"leftSE");kr(this,"rightSE");kr(this,"rings");kr(this,"windings");kr(this,"ringOut");kr(this,"consumedBy");kr(this,"prev");kr(this,"_prevInResult");kr(this,"_beforeState");kr(this,"_afterState");kr(this,"_isInResult");this.id=++AU,this.leftSE=t,t.segment=this,t.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=t,this.rings=c,this.windings=g}static compare(t,n){const c=t.leftSE.point.x,g=n.leftSE.point.x,x=t.rightSE.point.x,S=n.rightSE.point.x;if(S.isLessThan(c))return 1;if(x.isLessThan(g))return-1;const a=t.leftSE.point.y,U=n.leftSE.point.y,W=t.rightSE.point.y,he=n.rightSE.point.y;if(c.isLessThan(g)){if(U.isLessThan(a)&&U.isLessThan(W))return 1;if(U.isGreaterThan(a)&&U.isGreaterThan(W))return-1;const ae=t.comparePoint(n.leftSE.point);if(ae<0)return 1;if(ae>0)return-1;const ce=n.comparePoint(t.rightSE.point);return ce!==0?ce:-1}if(c.isGreaterThan(g)){if(a.isLessThan(U)&&a.isLessThan(he))return-1;if(a.isGreaterThan(U)&&a.isGreaterThan(he))return 1;const ae=n.comparePoint(t.leftSE.point);if(ae!==0)return ae;const ce=t.comparePoint(n.rightSE.point);return ce<0?1:ce>0?-1:1}if(a.isLessThan(U))return-1;if(a.isGreaterThan(U))return 1;if(x.isLessThan(S)){const ae=n.comparePoint(t.rightSE.point);if(ae!==0)return ae}if(x.isGreaterThan(S)){const ae=t.comparePoint(n.rightSE.point);if(ae<0)return 1;if(ae>0)return-1}if(!x.eq(S)){const ae=W.minus(a),ce=x.minus(c),be=he.minus(U),Je=S.minus(g);if(ae.isGreaterThan(ce)&&be.isLessThan(Je))return 1;if(ae.isLessThan(ce)&&be.isGreaterThan(Je))return-1}return x.isGreaterThan(S)?1:x.isLessThan(S)||W.isLessThan(he)?-1:W.isGreaterThan(he)?1:t.id<n.id?-1:t.id>n.id?1:0}static fromRing(t,n,c){let g,x,S;const a=Fh.comparePoints(t,n);if(a<0)g=t,x=n,S=1;else if(a>0)g=n,x=t,S=-1;else throw new Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);const U=new Fh(g,!0),W=new Fh(x,!1);return new V0(U,W,[c],[S])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t.isLessThan(n)?t:n},ur:{x:this.rightSE.point.x,y:t.isGreaterThan(n)?t:n}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(t){return t.x.eq(this.leftSE.point.x)&&t.y.eq(this.leftSE.point.y)||t.x.eq(this.rightSE.point.x)&&t.y.eq(this.rightSE.point.y)}comparePoint(t){return o0.orient(this.leftSE.point,t,this.rightSE.point)}getIntersection(t){const n=this.bbox(),c=t.bbox(),g=Dv(n,c);if(g===null)return null;const x=this.leftSE.point,S=this.rightSE.point,a=t.leftSE.point,U=t.rightSE.point,W=ig(n,a)&&this.comparePoint(a)===0,he=ig(c,x)&&t.comparePoint(x)===0,ae=ig(n,U)&&this.comparePoint(U)===0,ce=ig(c,S)&&t.comparePoint(S)===0;if(he&&W)return ce&&!ae?S:!ce&&ae?U:null;if(he)return ae&&x.x.eq(U.x)&&x.y.eq(U.y)?null:x;if(W)return ce&&S.x.eq(a.x)&&S.y.eq(a.y)?null:a;if(ce&&ae)return null;if(ce)return S;if(ae)return U;const be=hU(x,this.vector(),a,t.vector());return be===null||!ig(g,be)?null:o0.snap(be)}split(t){const n=[],c=t.events!==void 0,g=new Fh(t,!0),x=new Fh(t,!1),S=this.rightSE;this.replaceRightSE(x),n.push(x),n.push(g);const a=new V0(g,S,this.rings.slice(),this.windings.slice());return Fh.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),Fh.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),c&&(g.checkForConsuming(),x.checkForConsuming()),n}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let n=0,c=this.windings.length;n<c;n++)this.windings[n]*=-1}consume(t){let n=this,c=t;for(;n.consumedBy;)n=n.consumedBy;for(;c.consumedBy;)c=c.consumedBy;const g=V0.compare(n,c);if(g!==0){if(g>0){const x=n;n=c,c=x}if(n.prev===c){const x=n;n=c,c=x}for(let x=0,S=c.rings.length;x<S;x++){const a=c.rings[x],U=c.windings[x],W=n.rings.indexOf(a);W===-1?(n.rings.push(a),n.windings.push(U)):n.windings[W]+=U}c.rings=null,c.windings=null,c.consumedBy=n,c.leftSE.consumedBy=n.leftSE,c.rightSE.consumedBy=n.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const n=this._afterState.rings,c=this._afterState.windings,g=this._afterState.multiPolys;for(let a=0,U=this.rings.length;a<U;a++){const W=this.rings[a],he=this.windings[a],ae=n.indexOf(W);ae===-1?(n.push(W),c.push(he)):c[ae]+=he}const x=[],S=[];for(let a=0,U=n.length;a<U;a++){if(c[a]===0)continue;const W=n[a],he=W.poly;if(S.indexOf(he)===-1)if(W.isExterior)x.push(he);else{S.indexOf(he)===-1&&S.push(he);const ae=x.indexOf(W.poly);ae!==-1&&x.splice(ae,1)}}for(let a=0,U=x.length;a<U;a++){const W=x[a].multiPoly;g.indexOf(W)===-1&&g.push(W)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const t=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(Lv.type){case"union":{const c=t.length===0,g=n.length===0;this._isInResult=c!==g;break}case"intersection":{let c,g;t.length<n.length?(c=t.length,g=n.length):(c=n.length,g=t.length),this._isInResult=g===Lv.numMultiPolys&&c<g;break}case"xor":{const c=Math.abs(t.length-n.length);this._isInResult=c%2===1;break}case"difference":{const c=g=>g.length===1&&g[0].isSubject;this._isInResult=c(t)!==c(n);break}}return this._isInResult}}class Vw{constructor(t,n,c){kr(this,"poly");kr(this,"isExterior");kr(this,"segments");kr(this,"bbox");if(!Array.isArray(t)||t.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=c,this.segments=[],typeof t[0][0]!="number"||typeof t[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const g=o0.snap({x:new XA(t[0][0]),y:new XA(t[0][1])});this.bbox={ll:{x:g.x,y:g.y},ur:{x:g.x,y:g.y}};let x=g;for(let S=1,a=t.length;S<a;S++){if(typeof t[S][0]!="number"||typeof t[S][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const U=o0.snap({x:new XA(t[S][0]),y:new XA(t[S][1])});U.x.eq(x.x)&&U.y.eq(x.y)||(this.segments.push(V0.fromRing(x,U,this)),U.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=U.x),U.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=U.y),U.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=U.x),U.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=U.y),x=U)}(!g.x.eq(x.x)||!g.y.eq(x.y))&&this.segments.push(V0.fromRing(x,g,this))}getSweepEvents(){const t=[];for(let n=0,c=this.segments.length;n<c;n++){const g=this.segments[n];t.push(g.leftSE),t.push(g.rightSE)}return t}}class fU{constructor(t,n){kr(this,"multiPoly");kr(this,"exteriorRing");kr(this,"interiorRings");kr(this,"bbox");if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Vw(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let c=1,g=t.length;c<g;c++){const x=new Vw(t[c],this,!1);x.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=x.bbox.ll.x),x.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=x.bbox.ll.y),x.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=x.bbox.ur.x),x.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=x.bbox.ur.y),this.interiorRings.push(x)}this.multiPoly=n}getSweepEvents(){const t=this.exteriorRing.getSweepEvents();for(let n=0,c=this.interiorRings.length;n<c;n++){const g=this.interiorRings[n].getSweepEvents();for(let x=0,S=g.length;x<S;x++)t.push(g[x])}return t}}class Uw{constructor(t,n){kr(this,"isSubject");kr(this,"polys");kr(this,"bbox");if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof t[0][0][0]=="number"&&(t=[t])}catch{}this.polys=[],this.bbox={ll:{x:new XA(Number.POSITIVE_INFINITY),y:new XA(Number.POSITIVE_INFINITY)},ur:{x:new XA(Number.NEGATIVE_INFINITY),y:new XA(Number.NEGATIVE_INFINITY)}};for(let c=0,g=t.length;c<g;c++){const x=new fU(t[c],this);x.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=x.bbox.ll.x),x.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=x.bbox.ll.y),x.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=x.bbox.ur.x),x.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=x.bbox.ur.y),this.polys.push(x)}this.isSubject=n}getSweepEvents(){const t=[];for(let n=0,c=this.polys.length;n<c;n++){const g=this.polys[n].getSweepEvents();for(let x=0,S=g.length;x<S;x++)t.push(g[x])}return t}}class W_{constructor(t){kr(this,"events");kr(this,"poly");kr(this,"_isExteriorRing");kr(this,"_enclosingRing");this.events=t;for(let n=0,c=t.length;n<c;n++)t[n].segment.ringOut=this;this.poly=null}static factory(t){const n=[];for(let c=0,g=t.length;c<g;c++){const x=t[c];if(!x.isInResult()||x.ringOut)continue;let S=null,a=x.leftSE,U=x.rightSE;const W=[a],he=a.point,ae=[];for(;S=a,a=U,W.push(a),a.point!==he;)for(;;){const ce=a.getAvailableLinkedEvents();if(ce.length===0){const st=W[0].point,Ye=W[W.length-1].point;throw new Error(`Unable to complete output ring starting at [${st.x}, ${st.y}]. Last matching segment found ends at [${Ye.x}, ${Ye.y}].`)}if(ce.length===1){U=ce[0].otherSE;break}let be=null;for(let st=0,Ye=ae.length;st<Ye;st++)if(ae[st].point===a.point){be=st;break}if(be!==null){const st=ae.splice(be)[0],Ye=W.splice(st.index);Ye.unshift(Ye[0].otherSE),n.push(new W_(Ye.reverse()));continue}ae.push({index:W.length,point:a.point});const Je=a.getLeftmostComparator(S);U=ce.sort(Je)[0].otherSE;break}n.push(new W_(W))}return n}getGeom(){let t=this.events[0].point;const n=[t];for(let W=1,he=this.events.length-1;W<he;W++){const ae=this.events[W].point,ce=this.events[W+1].point;o0.orient(ae,t,ce)!==0&&(n.push(ae),t=ae)}if(n.length===1)return null;const c=n[0],g=n[1];o0.orient(c,t,g)===0&&n.shift(),n.push(n[0]);const x=this.isExteriorRing()?1:-1,S=this.isExteriorRing()?0:n.length-1,a=this.isExteriorRing()?n.length:-1,U=[];for(let W=S;W!=a;W+=x)U.push([n[W].x.toNumber(),n[W].y.toNumber()]);return U}isExteriorRing(){if(this._isExteriorRing===void 0){const t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var g,x;let t=this.events[0];for(let S=1,a=this.events.length;S<a;S++){const U=this.events[S];Fh.compare(t,U)>0&&(t=U)}let n=t.segment.prevInResult(),c=n?n.prevInResult():null;for(;;){if(!n)return null;if(!c)return n.ringOut;if(c.ringOut!==n.ringOut)return((g=c.ringOut)==null?void 0:g.enclosingRing())!==n.ringOut?n.ringOut:(x=n.ringOut)==null?void 0:x.enclosingRing();n=c.prevInResult(),c=n?n.prevInResult():null}}}class Gw{constructor(t){kr(this,"exteriorRing");kr(this,"interiorRings");this.exteriorRing=t,t.poly=this,this.interiorRings=[]}addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){const t=[this.exteriorRing.getGeom()];if(t[0]===null)return null;for(let n=0,c=this.interiorRings.length;n<c;n++){const g=this.interiorRings[n].getGeom();g!==null&&t.push(g)}return t}}class dU{constructor(t){kr(this,"rings");kr(this,"polys");this.rings=t,this.polys=this._composePolys(t)}getGeom(){const t=[];for(let n=0,c=this.polys.length;n<c;n++){const g=this.polys[n].getGeom();g!==null&&t.push(g)}return t}_composePolys(t){var c;const n=[];for(let g=0,x=t.length;g<x;g++){const S=t[g];if(!S.poly)if(S.isExteriorRing())n.push(new Gw(S));else{const a=S.enclosingRing();a!=null&&a.poly||n.push(new Gw(a)),(c=a==null?void 0:a.poly)==null||c.addInterior(S)}}return n}}class pU{constructor(t,n=V0.compare){kr(this,"queue");kr(this,"tree");kr(this,"segments");this.queue=t,this.tree=new bm(n),this.segments=[]}process(t){const n=t.segment,c=[];if(t.consumedBy)return t.isLeft?this.queue.delete(t.otherSE):this.tree.delete(n),c;t.isLeft&&this.tree.add(n);let g=n,x=n;do g=this.tree.lastBefore(g);while(g!=null&&g.consumedBy!=null);do x=this.tree.firstAfter(x);while(x!=null&&x.consumedBy!=null);if(t.isLeft){let S=null;if(g){const U=g.getIntersection(n);if(U!==null&&(n.isAnEndpoint(U)||(S=U),!g.isAnEndpoint(U))){const W=this._splitSafely(g,U);for(let he=0,ae=W.length;he<ae;he++)c.push(W[he])}}let a=null;if(x){const U=x.getIntersection(n);if(U!==null&&(n.isAnEndpoint(U)||(a=U),!x.isAnEndpoint(U))){const W=this._splitSafely(x,U);for(let he=0,ae=W.length;he<ae;he++)c.push(W[he])}}if(S!==null||a!==null){let U=null;S===null?U=a:a===null?U=S:U=Fh.comparePoints(S,a)<=0?S:a,this.queue.delete(n.rightSE),c.push(n.rightSE);const W=n.split(U);for(let he=0,ae=W.length;he<ae;he++)c.push(W[he])}c.length>0?(this.tree.delete(n),c.push(t)):(this.segments.push(n),n.prev=g)}else{if(g&&x){const S=g.getIntersection(x);if(S!==null){if(!g.isAnEndpoint(S)){const a=this._splitSafely(g,S);for(let U=0,W=a.length;U<W;U++)c.push(a[U])}if(!x.isAnEndpoint(S)){const a=this._splitSafely(x,S);for(let U=0,W=a.length;U<W;U++)c.push(a[U])}}}this.tree.delete(n)}return c}_splitSafely(t,n){this.tree.delete(t);const c=t.rightSE;this.queue.delete(c);const g=t.split(n);return g.push(c),t.consumedBy===void 0&&this.tree.add(t),g}}class mU{constructor(){kr(this,"type");kr(this,"numMultiPolys")}run(t,n,c){cg.type=t;const g=[new Uw(n,!0)];for(let he=0,ae=c.length;he<ae;he++)g.push(new Uw(c[he],!1));if(cg.numMultiPolys=g.length,cg.type==="difference"){const he=g[0];let ae=1;for(;ae<g.length;)Dv(g[ae].bbox,he.bbox)!==null?ae++:g.splice(ae,1)}if(cg.type==="intersection")for(let he=0,ae=g.length;he<ae;he++){const ce=g[he];for(let be=he+1,Je=g.length;be<Je;be++)if(Dv(ce.bbox,g[be].bbox)===null)return[]}const x=new bm(Fh.compare);for(let he=0,ae=g.length;he<ae;he++){const ce=g[he].getSweepEvents();for(let be=0,Je=ce.length;be<Je;be++)x.add(ce[be])}const S=new pU(x);let a=null;for(x.size!=0&&(a=x.first(),x.delete(a));a;){const he=S.process(a);for(let ae=0,ce=he.length;ae<ce;ae++){const be=he[ae];be.consumedBy===void 0&&x.add(be)}x.size!=0?(a=x.first(),x.delete(a)):a=null}o0.reset();const U=W_.factory(S.segments);return new dU(U).getGeom()}}const cg=new mU,Lv=cg,gU=(e,...t)=>Lv.run("intersection",e,t);o0.set;var _U={exports:{}},fy,qw;function yU(){return qw||(qw=1,fy=function(t){return function n(c){return arguments.length===0||c!=null&&c["@@functional/placeholder"]===!0?n:t.apply(this,arguments)}}),fy}var dy,Hw;function vU(){if(Hw)return dy;Hw=1;var e=yU();return dy=e(function(n){return n===null?"Null":n===void 0?"Undefined":Object.prototype.toString.call(n).slice(8,-1)}),dy}var py,jw;function L2(){if(jw)return py;jw=1;function e(t){var n=typeof t;return!!t&&(n=="object"||n=="function")}return py=e,py}var my,Zw;function xU(){if(Zw)return my;Zw=1;var e=L2();function t(n){return e(n)?n:Object(n)}return my=t,my}var gy,Qw;function bU(){if(Qw)return gy;Qw=1;var e=xU();function t(n){return function(c,g,x){for(var S=e(c),a=x(c),U=a.length,W=n?U:-1;n?W--:++W<U;){var he=a[W];if(g(S[he],he,S)===!1)break}return c}}return gy=t,gy}var _y,Ww;function wU(){if(Ww)return _y;Ww=1;var e=bU(),t=e();return _y=t,_y}var yy,$w;function SU(){if($w)return yy;$w=1;function e(t){return function(n){return n==null?void 0:n[t]}}return yy=e,yy}var vy,Xw;function IU(){if(Xw)return vy;Xw=1;var e=SU(),t=e("length");return vy=t,vy}var xy,Yw;function B2(){if(Yw)return xy;Yw=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return xy=t,xy}var by,Kw;function EU(){if(Kw)return by;Kw=1;var e=IU(),t=B2();function n(c){return c!=null&&t(e(c))}return by=n,by}var wy,Jw;function y1(){if(Jw)return wy;Jw=1;function e(t){return!!t&&typeof t=="object"}return wy=e,wy}var Sy,e3;function H5(){if(e3)return Sy;e3=1;var e=EU(),t=y1(),n=Object.prototype,c=n.hasOwnProperty,g=n.propertyIsEnumerable;function x(S){return t(S)&&e(S)&&c.call(S,"callee")&&!g.call(S,"callee")}return Sy=x,Sy}var Iy,t3;function CU(){if(t3)return Iy;t3=1;var e=L2(),t="[object Function]",n=Object.prototype,c=n.toString;function g(x){return e(x)&&c.call(x)==t}return Iy=g,Iy}var Ey,i3;function TU(){if(i3)return Ey;i3=1;var e=CU(),t=y1(),n=/^\[object .+?Constructor\]$/,c=Object.prototype,g=Function.prototype.toString,x=c.hasOwnProperty,S=RegExp("^"+g.call(x).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function a(U){return U==null?!1:e(U)?S.test(g.call(U)):t(U)&&n.test(U)}return Ey=a,Ey}var Cy,n3;function kU(){if(n3)return Cy;n3=1;var e=TU();function t(n,c){var g=n==null?void 0:n[c];return e(g)?g:void 0}return Cy=t,Cy}var Ty,r3;function MU(){if(r3)return Ty;r3=1;var e=kU(),t=B2(),n=y1(),c="[object Array]",g=Object.prototype,x=g.toString,S=e(Array,"isArray"),a=S||function(U){return n(U)&&t(U.length)&&x.call(U)==c};return Ty=a,Ty}var ky,s3;function PU(){if(s3)return ky;s3=1;var e=/^\d+$/,t=9007199254740991;function n(c,g){return c=typeof c=="number"||e.test(c)?+c:-1,g=g??t,c>-1&&c%1==0&&c<g}return ky=n,ky}var My,a3;function DU(){if(a3)return My;a3=1;var e=H5(),t=MU(),n=PU(),c=B2(),g=L2(),x=Object.prototype,S=x.hasOwnProperty;function a(U){if(U==null)return[];g(U)||(U=Object(U));var W=U.length;W=W&&c(W)&&(t(U)||e(U))&&W||0;for(var he=U.constructor,ae=-1,ce=typeof he=="function"&&he.prototype===U,be=Array(W),Je=W>0;++ae<W;)be[ae]=ae+"";for(var st in U)!(Je&&n(st,W))&&!(st=="constructor"&&(ce||!S.call(U,st)))&&be.push(st);return be}return My=a,My}var Py,o3;function LU(){if(o3)return Py;o3=1;var e=wU(),t=DU();function n(c,g){return e(c,g,t)}return Py=n,Py}var Dy,l3;function BU(){if(l3)return Dy;l3=1;var e=LU(),t=H5(),n=y1(),c="[object Object]",g=Object.prototype,x=g.hasOwnProperty,S=g.toString;function a(U){var W;if(!(n(U)&&S.call(U)==c&&!t(U))||!x.call(U,"constructor")&&(W=U.constructor,typeof W=="function"&&!(W instanceof W)))return!1;var he;return e(U,function(ae,ce){he=ce}),he===void 0||x.call(U,he)}return Dy=a,Dy}(function(e){e.exports=function(t){var n={};function c(g){if(n[g])return n[g].exports;var x=n[g]={exports:{},id:g,loaded:!1};return t[g].call(x.exports,x,x.exports,c),x.loaded=!0,x.exports}return c.m=t,c.c=n,c.p="/lib/",c(0)}([function(t,n,c){t.exports=c(1)},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.union=c(2).default,n.any=c(12).default,n.nil=c(14).default,n.mapOf=c(16).default,n.arrayOf=c(18).default,n.record=c(20).default,n.optional=c(23).default,n.validate=c(25).default,n.deferred=c(26).default,n.createValidator=c(4).default,n.isValid=c(28).default},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(3),x=S(g);function S(U){return U&&U.__esModule?U:{default:U}}function a(){for(var U=arguments.length,W=Array(U),he=0;he<U;he++)W[he]=arguments[he];return new x.default(W)}},function(t,n,c){var g=function(){function he(ae,ce){for(var be=0;be<ce.length;be++){var Je=ce[be];Je.enumerable=Je.enumerable||!1,Je.configurable=!0,"value"in Je&&(Je.writable=!0),Object.defineProperty(ae,Je.key,Je)}}return function(ae,ce,be){return ce&&he(ae.prototype,ce),be&&he(ae,be),ae}}();Object.defineProperty(n,"__esModule",{value:!0});var x=c(4),S=a(x);c(5),c(6);function a(he){return he&&he.__esModule?he:{default:he}}function U(he,ae){if(!(he instanceof ae))throw new TypeError("Cannot call a class as a function")}var W=function(){function he(ae){U(this,he),this.validators=[];var ce=!0,be=!1,Je=void 0;try{for(var st=ae[Symbol.iterator](),Ye;!(ce=(Ye=st.next()).done);ce=!0){var it=Ye.value;this.validators.push((0,S.default)(it))}}catch(ct){be=!0,Je=ct}finally{try{!ce&&st.return&&st.return()}finally{if(be)throw Je}}}return g(he,[{key:"isValid",value:function(ce){var be=!0,Je=!1,st=void 0;try{for(var Ye=this.validators[Symbol.iterator](),it;!(be=(it=Ye.next()).done);be=!0){var ct=it.value;if(ct.isValid(ce))return!0}}catch(Tt){Je=!0,st=Tt}finally{try{!be&&Ye.return&&Ye.return()}finally{if(Je)throw st}}return!1}},{key:"getValidationResult",value:function(ce){if(this.isValid(ce))return{isValid:"true"};var be=this._getValidationDetails(ce);return{isValid:"false",message:`Value doesn't match any of the expected variants.
Value: `+JSON.stringify(ce)+`
Details: 
`+be.message,score:be.score}}},{key:"_getValidationDetails",value:function(ce){var be=[],Je=!0,st=!1,Ye=void 0;try{for(var it=this.validators[Symbol.iterator](),ct;!(Je=(ct=it.next()).done);Je=!0){var Tt=ct.value;be.push(Tt.getValidationResult(ce))}}catch(Rt){st=!0,Ye=Rt}finally{try{!Je&&it.return&&it.return()}finally{if(st)throw Ye}}be.sort(function(Rt,Oe){return Rt.score<Oe.score?1:Rt.score>Oe.score?-1:0}),be.length>3&&(be.length=3);var zt=be.map(function(Rt){return Rt.message}).join(`
`);return{message:zt,score:be[0].score}}}]),he}();n.default=W},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=st,c(5);var g=c(7),x=be(g),S=c(9),a=be(S),U=c(10),W=be(U),he=c(3);be(he);var ae=c(11),ce=be(ae);function be(Ye){return Ye&&Ye.__esModule?Ye:{default:Ye}}function Je(Ye){return Ye&&typeof Symbol<"u"&&Ye.constructor===Symbol?"symbol":typeof Ye}function st(Ye){if(Ye==null)throw Error("Null cannot be a valid validation descriptor");if(Ye===String)return x.default;if(Ye===Number)return a.default;if(Ye===Boolean)return W.default;if((typeof Ye>"u"?"undefined":Je(Ye))==="object"&&Ye&&typeof Ye.isValid=="function"&&typeof Ye.getValidationResult=="function")return Ye;if(typeof Ye=="string"||typeof Ye=="number"||typeof Ye=="boolean")return new ce.default(Ye);throw new Error("Can't recognize this descriptor: "+Ye)}},function(t,n,c){c(6)},function(t,n){},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),x=S(g);c(6),c(5);function S(U){return U&&U.__esModule?U:{default:U}}var a={isValid:function(W){return typeof W=="string"},getValidationResult:function(W){return a.isValid(W)?{isValid:"true"}:{isValid:"false",message:"String expected, "+(0,x.default)(W)+" given.",score:0}}};n.default=a},function(t,n){t.exports=vU()},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),x=S(g);c(6),c(5);function S(U){return U&&U.__esModule?U:{default:U}}var a={isValid:function(W){return typeof W=="number"},getValidationResult:function(W){return a.isValid(W)?{isValid:"true"}:{isValid:"false",message:"Number expected. '"+(0,x.default)(W)+"' given.",score:0}}};n.default=a},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),x=S(g);c(6),c(5);function S(U){return U&&U.__esModule?U:{default:U}}var a={isValid:function(W){return typeof W=="boolean"},getValidationResult:function(W){return a.isValid(W)?{isValid:"true"}:{isValid:"false",message:"Boolean expected. "+(0,x.default)(W)+" given.",score:0}}};n.default=a},function(t,n,c){var g=function(){function W(he,ae){for(var ce=0;ce<ae.length;ce++){var be=ae[ce];be.enumerable=be.enumerable||!1,be.configurable=!0,"value"in be&&(be.writable=!0),Object.defineProperty(he,be.key,be)}}return function(he,ae,ce){return ae&&W(he.prototype,ae),ce&&W(he,ce),he}}();Object.defineProperty(n,"__esModule",{value:!0});var x=c(4);S(x),c(5),c(6);function S(W){return W&&W.__esModule?W:{default:W}}function a(W,he){if(!(W instanceof he))throw new TypeError("Cannot call a class as a function")}var U=function(){function W(he){a(this,W),this.expectedValue=he}return g(W,[{key:"isValid",value:function(ae){return ae===this.expectedValue}},{key:"getValidationResult",value:function(ae){return this.isValid(ae)?{isValid:"true"}:{isValid:"false",message:"Expected: "+JSON.stringify(this.expectedValue)+". Given: "+ae,score:0}}}]),W}();n.default=U},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(13),x=S(g);function S(a){return a&&a.__esModule?a:{default:a}}n.default=x.default},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8);x(g),c(6),c(5);function x(a){return a&&a.__esModule?a:{default:a}}var S={isValid:function(U){return!0},getValidationResult:function(U){return{isValid:"true"}}};n.default=S},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(15),x=S(g);function S(a){return a&&a.__esModule?a:{default:a}}n.default=x.default},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),x=S(g);c(6),c(5);function S(U){return U&&U.__esModule?U:{default:U}}var a={isValid:function(W){return W==null},getValidationResult:function(W){return a.isValid(W)?{isValid:"true"}:{isValid:"false",message:"Null expected. "+(0,x.default)(W)+" given.",score:0}}};n.default=a},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(17),x=S(g);function S(U){return U&&U.__esModule?U:{default:U}}function a(U){return new x.default(U)}},function(t,n,c){var g=function(){function be(Je,st){for(var Ye=0;Ye<st.length;Ye++){var it=st[Ye];it.enumerable=it.enumerable||!1,it.configurable=!0,"value"in it&&(it.writable=!0),Object.defineProperty(Je,it.key,it)}}return function(Je,st,Ye){return st&&be(Je.prototype,st),Ye&&be(Je,Ye),Je}}();Object.defineProperty(n,"__esModule",{value:!0});var x=c(8),S=W(x),a=c(4),U=W(a);c(6),c(5);function W(be){return be&&be.__esModule?be:{default:be}}function he(be,Je){if(!(be instanceof Je))throw new TypeError("Cannot call a class as a function")}function ae(be){return be&&typeof Symbol<"u"&&be.constructor===Symbol?"symbol":typeof be}var ce=function(){function be(Je){he(this,be),this.validator=(0,U.default)(Je)}return g(be,[{key:"isValid",value:function(st){if(!((typeof st>"u"?"undefined":ae(st))==="object"&&st))return!1;var Ye=Object.keys(st),it=!0,ct=!1,Tt=void 0;try{for(var zt=Ye[Symbol.iterator](),Rt;!(it=(Rt=zt.next()).done);it=!0){var Oe=Rt.value,jt=st[Oe];if(this.validator.isValid(jt)===!1)return!1}}catch(at){ct=!0,Tt=at}finally{try{!it&&zt.return&&zt.return()}finally{if(ct)throw Tt}}return!0}},{key:"getValidationResult",value:function(st){if(!((typeof st>"u"?"undefined":ae(st))==="object"&&st))return{isValid:"false",message:"Object expected. "+(0,S.default)(st)+" given.",score:0};var Ye=Object.keys(st),it=!0,ct=!1,Tt=void 0;try{for(var zt=Ye[Symbol.iterator](),Rt;!(it=(Rt=zt.next()).done);it=!0){var Oe=Rt.value,jt=st[Oe],at=this.validator.getValidationResult(jt);if(at.isValid==="false")return{isValid:"false",message:"Validation failed for key '"+Oe+"': "+at.message,score:1}}}catch(_t){ct=!0,Tt=_t}finally{try{!it&&zt.return&&zt.return()}finally{if(ct)throw Tt}}return{isValid:"true"}}}]),be}();n.default=ce},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(19),x=S(g);function S(U){return U&&U.__esModule?U:{default:U}}function a(U){return new x.default(U)}},function(t,n,c){var g=function(){function ce(be,Je){for(var st=0;st<Je.length;st++){var Ye=Je[st];Ye.enumerable=Ye.enumerable||!1,Ye.configurable=!0,"value"in Ye&&(Ye.writable=!0),Object.defineProperty(be,Ye.key,Ye)}}return function(be,Je,st){return Je&&ce(be.prototype,Je),st&&ce(be,st),be}}();Object.defineProperty(n,"__esModule",{value:!0});var x=c(8),S=W(x),a=c(4),U=W(a);c(6),c(5);function W(ce){return ce&&ce.__esModule?ce:{default:ce}}function he(ce,be){if(!(ce instanceof be))throw new TypeError("Cannot call a class as a function")}var ae=function(){function ce(be){he(this,ce),this.validator=(0,U.default)(be)}return g(ce,[{key:"isValid",value:function(Je){if(!Array.isArray(Je))return!1;var st=!0,Ye=!1,it=void 0;try{for(var ct=Je[Symbol.iterator](),Tt;!(st=(Tt=ct.next()).done);st=!0){var zt=Tt.value;if(this.validator.isValid(zt)===!1)return!1}}catch(Rt){Ye=!0,it=Rt}finally{try{!st&&ct.return&&ct.return()}finally{if(Ye)throw it}}return!0}},{key:"getValidationResult",value:function(Je){if(!Array.isArray(Je))return{isValid:"false",message:"Array expected. "+(0,S.default)(Je)+" given.",score:0};for(var st=0;st<Je.length;st++){var Ye=Je[st],it=this.validator.getValidationResult(Ye);if(it.isValid==="false")return{isValid:"false",message:"Validation failed on item #"+st+": "+it.message,score:1}}return{isValid:"true"}}}]),ce}();n.default=ae},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(21),x=S(g);function S(U){return U&&U.__esModule?U:{default:U}}function a(U){return new x.default(U)}},function(t,n,c){var g=function(){function st(Ye,it){for(var ct=0;ct<it.length;ct++){var Tt=it[ct];Tt.enumerable=Tt.enumerable||!1,Tt.configurable=!0,"value"in Tt&&(Tt.writable=!0),Object.defineProperty(Ye,Tt.key,Tt)}}return function(Ye,it,ct){return it&&st(Ye.prototype,it),ct&&st(Ye,ct),Ye}}();Object.defineProperty(n,"__esModule",{value:!0});var x=c(8),S=ae(x),a=c(22),U=ae(a),W=c(4),he=ae(W);c(5),c(6);function ae(st){return st&&st.__esModule?st:{default:st}}function ce(st,Ye){if(!(st instanceof Ye))throw new TypeError("Cannot call a class as a function")}function be(st){return st&&typeof Symbol<"u"&&st.constructor===Symbol?"symbol":typeof st}var Je=function(){function st(Ye){if(ce(this,st),!((typeof Ye>"u"?"undefined":be(Ye))==="object"&&Ye&&(0,U.default)(Ye)))throw Error("A record must be defined by an object.");this.shape={};var it=!0,ct=!1,Tt=void 0;try{for(var zt=Object.getOwnPropertyNames(Ye)[Symbol.iterator](),Rt;!(it=(Rt=zt.next()).done);it=!0){var Oe=Rt.value;try{this.shape[Oe]=(0,he.default)(Ye[Oe])}catch(_t){var jt=Oe,at=_t.stack;throw _t.originalStack?(at=_t.originalStack,jt+="."+_t.propertyName,_t.propertyName=jt):_t.originalStack=_t.stack,_t.stack="Error defining prop '"+jt+"': "+_t.originalStack,_t}}}catch(_t){ct=!0,Tt=_t}finally{try{!it&&zt.return&&zt.return()}finally{if(ct)throw Tt}}}return g(st,[{key:"isValid",value:function(it){if(!((typeof it>"u"?"undefined":be(it))==="object"&&it))return!1;var ct=!0,Tt=!1,zt=void 0;try{for(var Rt=Object.keys(this.shape)[Symbol.iterator](),Oe;!(ct=(Oe=Rt.next()).done);ct=!0){var jt=Oe.value,at=this.shape[jt];if(at.isValid(it[jt])===!1)return!1}}catch(_t){Tt=!0,zt=_t}finally{try{!ct&&Rt.return&&Rt.return()}finally{if(Tt)throw zt}}return!0}},{key:"getValidationResult",value:function(it){if(!((typeof it>"u"?"undefined":be(it))==="object"&&it))return{isValid:"false",message:"Object expected, "+(0,S.default)(it)+" given.",score:0};var ct=0,Tt=!0,zt=!1,Rt=void 0;try{for(var Oe=Object.keys(this.shape)[Symbol.iterator](),jt;!(Tt=(jt=Oe.next()).done);Tt=!0){var at=jt.value,_t=this.shape[at],mt=_t.getValidationResult(it[at]);if(mt.isValid==="false")return{isValid:"false",message:"Error validating prop "+at+`:
 `+mt.message,score:1+ct};ct++}}catch(xt){zt=!0,Rt=xt}finally{try{!Tt&&Oe.return&&Oe.return()}finally{if(zt)throw Rt}}return{isValid:"true"}}}]),st}();n.default=Je},function(t,n){t.exports=BU()},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(24),x=S(g);function S(U){return U&&U.__esModule?U:{default:U}}function a(U){return new x.default(U)}},function(t,n,c){var g=function(){function he(ae,ce){for(var be=0;be<ce.length;be++){var Je=ce[be];Je.enumerable=Je.enumerable||!1,Je.configurable=!0,"value"in Je&&(Je.writable=!0),Object.defineProperty(ae,Je.key,Je)}}return function(ae,ce,be){return ce&&he(ae.prototype,ce),be&&he(ae,be),ae}}();Object.defineProperty(n,"__esModule",{value:!0});var x=c(4),S=a(x);c(6),c(5);function a(he){return he&&he.__esModule?he:{default:he}}function U(he,ae){if(!(he instanceof ae))throw new TypeError("Cannot call a class as a function")}var W=function(){function he(ae){U(this,he),this.validator=(0,S.default)(ae)}return g(he,[{key:"isValid",value:function(ce){return ce?this.validator.isValid(ce):!0}},{key:"getValidationResult",value:function(ce){return ce?this.validator.getValidationResult(ce):{isValid:"true"}}}]),he}();n.default=W},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(4),x=S(g);function S(U){return U&&U.__esModule?U:{default:U}}function a(U,W){var he=(0,x.default)(U),ae=he.getValidationResult(W);if(ae.isValid==="false")throw Error(ae.message);return W}},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(27),x=S(g);function S(U){return U&&U.__esModule?U:{default:U}}function a(U){return new x.default(U)}},function(t,n,c){var g=function(){function ae(ce,be){for(var Je=0;Je<be.length;Je++){var st=be[Je];st.enumerable=st.enumerable||!1,st.configurable=!0,"value"in st&&(st.writable=!0),Object.defineProperty(ce,st.key,st)}}return function(ce,be,Je){return be&&ae(ce.prototype,be),Je&&ae(ce,Je),ce}}();Object.defineProperty(n,"__esModule",{value:!0});var x=c(8),S=U(x),a=c(4);U(a),c(6),c(5);function U(ae){return ae&&ae.__esModule?ae:{default:ae}}function W(ae,ce){if(!(ae instanceof ce))throw new TypeError("Cannot call a class as a function")}var he=function(){function ae(ce){if(W(this,ae),typeof ce!="function")throw Error("Deferred validator only accepts a function. "+(0,S.default)(ce)+" given");this.deferredValidator=ce}return g(ae,[{key:"isValid",value:function(be){return this._getValidator().isValid(be)}},{key:"getValidationResult",value:function(be){return this._getValidator().getValidationResult(be)}},{key:"_getValidator",value:function(){return this.validator||(this.validator=this.deferredValidator()),this.validator}}]),ae}();n.default=he},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(4),x=S(g);function S(U){return U&&U.__esModule?U:{default:U}}function a(U,W){var he=(0,x.default)(U);return he.isValid(W)}}])})(_U);function zU(e){let t,n,c,g=`<svg class="marker-svg" id="Layer_2" data-name="Layer 2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70.46 62.88"><defs><style>.fill {
                fill: #000;
                stroke: solid 1px red;
            }
            .stroke {
                stroke: #fff;
            }
        </style></defs><g id="Layer_1-2" data-name="Layer 1"><g><path class="fill" d="m35.23,60.88c-1.81,0-3.43-.93-4.33-2.5L2.68,9.5c-.9-1.57-.9-3.44,0-5,.9-1.57,2.52-2.5,4.33-2.5h56.44c1.81,0,3.43.93,4.33,2.5.9,1.56.9,3.43,0,5l-28.22,48.88c-.9,1.57-2.52,2.5-4.33,2.5Z"></path><path d="m63.45,4c1.56,0,2.34,1.05,2.6,1.5.26.45.78,1.65,0,3l-28.22,48.88c-.78,1.35-2.08,1.5-2.6,1.5s-1.82-.15-2.6-1.5L4.41,8.5c-.78-1.35-.26-2.55,0-3,.26-.45,1.03-1.5,2.6-1.5h56.44m0-4H7.01C1.62,0-1.75,5.83.95,10.5l28.22,48.88c1.35,2.33,3.7,3.5,6.06,3.5s4.72-1.17,6.06-3.5l28.22-48.88c2.69-4.67-.67-10.5-6.06-10.5h0Z"></path></g></g></svg>`;return{c(){t=Rn("div"),n=Sr(),c=Rn("div"),c.innerHTML=g,this.h()},l(x){t=Fn(x,"DIV",{id:!0,class:!0}),_n(t).forEach(yi),n=Ir(x),c=Fn(x,"DIV",{id:!0,class:!0,style:!0,"data-svelte-h":!0}),Qu(c)!=="svelte-1sgleu8"&&(c.innerHTML=g),this.h()},h(){Ti(t,"id","map"),Ti(t,"class","map"),Ti(c,"id","marker-template"),Ti(c,"class","hex-marker"),Ly(c,"display","none")},m(x,S){Un(x,t,S),Un(x,n,S),Un(x,c,S)},p:Oa,i:Oa,o:Oa,d(x){x&&(yi(t),yi(n),yi(c))}}}let u3=6;const RU=500;let FU=!1;function OU(e,t,n){let c,g,x,S,a,U,W;Bu(e,Kp,Yt=>n(11,c=Yt)),Bu(e,AT,Yt=>n(26,g=Yt)),Bu(e,Ry,Yt=>n(12,x=Yt)),Bu(e,hg,Yt=>n(13,S=Yt)),Bu(e,Fy,Yt=>n(27,a=Yt)),Bu(e,Oy,Yt=>n(14,U=Yt)),Bu(e,$_,Yt=>n(15,W=Yt));const he=[-119.449444,37.166111];let{metric:ae}=t,{colorScheme:ce}=t,{showCounties:be}=t,{showEcoregions:Je}=t,{drawnPath:st}=t,{clade:Ye}=t,{clades:it}=t,{finishBuilding:ct}=t;const Tt=[-124.40971816218747,32.534154544948464,-114.13120909272375,42.009518182466415];let zt,Rt,Oe,jt=!1,at=[-119.449444,37.166111],_t={hex:{},eco:{}},mt={hex:{},eco:{}};function xt(Yt){if(!c.getStyle)return;console.log(c.getStyle().layers);let rn=c.getStyle().layers.filter(Xt=>{var mr;let Ji=(mr=Xt.source)==null?void 0:mr.split("-");return Ji&&Ji[0]===`${U}layer`&&Ji[1]!==Yt});for(let Xt of rn)c.setPaintProperty(Xt.id,"fill-opacity",0)}function bt(Yt){jt=Yt!==null,Oe&&(console.log("SHOW?",jt),jt?Oe.addTo(c):Oe.remove())}async function lt(Yt){if(!Ri||!c.getLayer)return;if(Yt===null){c.getLayer("drawLayer")&&c.removeLayer("drawnPolygon"),c.getSource("drawnPolygon")&&c.removeSource("drawnPolygon");return}console.log(c.transform),console.log(Yt[0]),console.log(c.transform.pointLocation({x:10,y:10})),console.log(c.transform.pointLocation(Yt[0]));let rn=[];for(let lr of Yt){let On=c.transform.pointLocation(lr);rn.push([On.lat,On.lng])}let Xt=$V(rn,u3),Ji=pV.h3SetToMultiPolygonFeature(Xt);console.log(Ji),console.log(Ri);let mr=eU(Ri);console.log(mr),console.log(Ji.geometry),console.log(mr.features[0].geometry);let ci=gU(Ji.geometry.coordinates,mr.features[0].geometry.coordinates);console.log(ci);let sn={type:"Feature",properties:{},geometry:{type:"MultiPolygon",coordinates:ci}};c.addSource("drawnPolygon",{type:"geojson",data:sn}),c.addLayer({id:"drawLayer",type:"fill",source:"drawnPolygon",layout:{},paint:{"fill-color":"#00ffff","fill-opacity":x,"fill-color-transition":{duration:500,delay:0}}},Rt)}function $e(Yt,rn,Xt=U){if(console.log(Yt),!c.moveLayer)return;let Ji=`${Xt}-${Yt}-${rn}`;console.log(Yt),c.moveLayer(Ji,"place_hamlet"),setTimeout(()=>{ut([Ji])},RU/4),c.setPaintProperty(Ji,"fill-opacity",x)}const pt=["ecoregions-fill","ecoregions-line"];function ut(Yt=[]){if(!c.getStyle)return;let rn=c.getStyle().layers.filter(Xt=>{var Ji;return((Ji=Xt.source)==null?void 0:Ji.includes(`${U}layer`))&&!(Yt.includes(Xt.id)||pt.includes(Xt.id))});console.log(rn);for(let Xt of rn)c.setPaintProperty(Xt.id,"fill-opacity",0)}function Nt(Yt){if(!c.getStyle)return;let rn=c.getStyle().layers.filter(Xt=>{var Ji;return((Ji=Xt.source)==null?void 0:Ji.includes(`${U}layer`))&&!pt.includes(Xt.id)});for(let Xt of rn){let Ji=Xt.id.split("-")[1],mr=Hi(Ji,Yt,Ji.search("Sig")!=-1);console.log("palette:",mr),c.setPaintProperty(Xt.id,"fill-color",mr)}}function Bt(){$e(ae,Ye),Nt(ce)}function Ot(Yt){c.setPaintProperty&&(Yt?c.setPaintProperty("counties","line-opacity",g):c.setPaintProperty("counties","line-opacity",0))}function gi(Yt){c.setPaintProperty&&(console.log("ecoregions",Yt),Yt?(c.setPaintProperty("ecoregions-line","line-opacity",g),c.setPaintProperty("ecoregions-fill","fill-opacity",x)):(c.setPaintProperty("ecoregions-line","line-opacity",0),c.setPaintProperty("ecoregions-fill","fill-opacity",0)))}function Ii(Yt){Yt?(c.setPaintProperty("california-line","line-opacity",g),c.setPaintProperty("california-fill","fill-opacity",x)):(c.setPaintProperty("california-line","line-opacity",0),c.setPaintProperty("california-fill","fill-opacity",0))}let Ci,Ri,Ki=d_(0,5e3,ce);function Hi(Yt,rn,Xt=!0){if(!(!_t||!mt))if(console.log("generating for ",Yt,"interpolate: ",Xt),Xt){Ki=d_(mt[U][Yt],_t[U][Yt],rn),Yt==="quartile"&&(Ki=uT(rn)),console.log(Ki),Ki.length;let Ji=Ki.map((ci,sn)=>[ci[0],ci[1]]);Ji=Ji.flat(),console.log(Ji);let mr=["interpolate",["linear"],["get",Yt],...Ji];return a||Fy.set(mr),mr}else return["step",["get",Yt],"#ff00ff",-1,"#0000ff",0,"#ffffff",1,"#FF7F11"]}async function Ni(Yt,rn){var Xt;if(console.log(Yt),!(c&&((Xt=c==null?void 0:c.getStyle())!=null&&Xt.sources[`hexlayer-${Yt}`])))return fetch("/phast/data/hex_data_sf/polygon_data.geojson").then(Ji=>Ji.json()).then(Ji=>Ri=Ji).then(()=>{var sn,lr,On;_t.hex=(sn=Ri.properties)==null?void 0:sn.maxes,mt.hex=(lr=Ri.properties)==null?void 0:lr.mins,(On=Ri.properties)!=null&&On.rel_pd_exp&&Ri.properties.rel_pd_exp;let mr=c.getStyle().layers[71].id;c.getSource(`hexlayer-${Yt}`)||c.addSource(`hexlayer-${Yt}`,{type:"geojson",data:Ri});for(let Gn of m_){let pn=`hex-${Gn}-${Yt}`;c.addLayer({id:pn,type:"fill",source:`hexlayer-${Yt}`,layout:{},paint:{"fill-color":Hi(Gn,ce,Gn.search("Sig")==-1),"fill-opacity":x,"fill-color-transition":{duration:500,delay:0}}},mr),console.log("added layer ",pn)}let ci=`hex-${m_[0]}-${Yt}`;return c.on("click",ci,Gn=>{console.log(Gn);let pn=WV(Gn.lngLat.lat,Gn.lngLat.lng,rn);if(zi(pn),pn===(S==null?void 0:S.hex)){hg.set(null);return}console.log(c.getStyle().layers);let v=Rw(pn);at={lng:v[1],lat:v[0]},console.log(pn),hg.set({latlng:Gn.lngLat,hex:pn,properties:Gn.features[0].properties})}),c.on("mouseenter",ci,()=>{c.getCanvas().style.cursor="pointer"}),c.on("mouseleave",ci,()=>{c.getCanvas().style.cursor=""}),c.on("dragstart",ci,()=>{c.getCanvas().style.cursor="grabbing"}),c.on("dragend",ci,()=>{c.getCanvas().style.cursor="pointer"}),!0})}async function nn(){fetch("/phast/data/ecoregions.geojson").then(Yt=>Yt.json()).then(Yt=>{console.log(Yt),c.addSource("ecolayer",{type:"geojson",data:Yt,generateId:!0}),c.addLayer({id:"ecoregions-fill",type:"fill",source:"ecolayer",layout:{},paint:{"fill-opacity":0,"fill-color":["case",["boolean",["feature-state","hover"],!1],"#29abe2","#e9f6fb"],"fill-color-transition":{duration:500,delay:0}}}),c.addLayer({id:"ecoregions-line",type:"line",source:"ecolayer",layout:{},paint:{"line-color":"#555555","line-width":.25,"line-opacity":0}}),console.log("added ecoregions")})}async function vn(){Kp&&fetch("/phast/data/california.geojson").then(Yt=>Yt.json()).then(Yt=>{console.log(Yt),c.addSource("california",{type:"geojson",data:Yt,generateId:!0}),c.addLayer({id:"california-fill",type:"fill",source:"california",layout:{},paint:{"fill-opacity":x,"fill-color":["case",["boolean",["feature-state","hover"],!1],"#29abe2","#e9f6fb"],"fill-color-transition":{duration:500,delay:0}}}),c.addLayer({id:"california-line",type:"line",source:"california",layout:{},paint:{"line-color":"#555555","line-width":.25,"line-opacity":g}})})}function Ei(Yt){if(!Yt)return;console.log("started building");let rn=Date.now();Ni("Birds",u3).then(()=>{ct(),$e(ae,Ye),console.log(`finished building in ${Date.now()-rn}ms`)}),gi(!1),Ii(!1)}bc(()=>{om(Kp,c=new yx.Map({container:"map",style:`https://basemaps.cartocdn.com/gl/${bn}-gl-style/style.json`,center:he,zoom:4}),c),c.on("load",()=>{nn(),vn(),console.log("loaded"),mi()}),setTimeout(()=>{console.log("no load on timeout"),om(Kp,c._canvas.style.filter="none",c),mi()},3e3)});async function mi(){let Yt=Tt;Ci=window.innerWidth/3,c.fitBounds(Yt,{padding:{top:50,left:10,bottom:50,right:Ci}}),om(Kp,c._canvas.style.filter="none",c)}function zi(Yt){Oe||Oi();let rn=Rw(Yt);console.log(rn),Ci=2*window.innerWidth/5,xn([rn[1],rn[0]]),c.flyTo({center:[rn[1],rn[0]],essential:!0,padding:{right:Ci},duration:750})}function Oi(){let Yt=document.getElementById("marker-template");Yt.style.display="block",Oe=new yx.Marker({element:Yt}).setLngLat(at).addTo(c)}function xn(Yt){Oe.setLngLat(Yt)}let bn="positron";return e.$$set=Yt=>{"metric"in Yt&&n(0,ae=Yt.metric),"colorScheme"in Yt&&n(1,ce=Yt.colorScheme),"showCounties"in Yt&&n(2,be=Yt.showCounties),"showEcoregions"in Yt&&n(3,Je=Yt.showEcoregions),"drawnPath"in Yt&&n(4,st=Yt.drawnPath),"clade"in Yt&&n(5,Ye=Yt.clade),"clades"in Yt&&n(6,it=Yt.clades),"finishBuilding"in Yt&&n(7,ct=Yt.finishBuilding)},e.$$.update=()=>{e.$$.dirty[0]&3072&&c&&FU&&(n(10,zt=c.getStyle().layers.filter(Yt=>Yt["source-layer"]==="place")),console.log(zt)),e.$$.dirty[0]&33&&$e(ae,Ye),e.$$.dirty[0]&16384&&Bt(),e.$$.dirty[0]&4129&&x&&$e(ae,Ye),e.$$.dirty[0]&2&&Nt(ce),e.$$.dirty[0]&4&&Ot(be),e.$$.dirty[0]&8&&gi(Je),e.$$.dirty[0]&16&&lt(st),e.$$.dirty[0]&32&&xt(Ye),e.$$.dirty[0]&8192&&bt(S),e.$$.dirty[0]&32768&&Ei(W)},[ae,ce,be,Je,st,Ye,it,ct,gi,Ii,zt,c,x,S,U,W]}let NU=class extends fo{constructor(t){super(),po(this,t,OU,zU,Va,{metric:0,colorScheme:1,showCounties:2,showEcoregions:3,drawnPath:4,clade:5,clades:6,finishBuilding:7,updateShowEcoregions:8,updateShowCalifornia:9},null,[-1,-1])}get updateShowEcoregions(){return this.$$.ctx[8]}get updateShowCalifornia(){return this.$$.ctx[9]}};function c3(e){let t,n,c,g,x;return n=new mT({props:{updateColorScheme:e[10],updateShowCounties:e[11],updateShowEcoregions:e[12],updateDrawing:e[13],drawing:e[5],updateDrawnPath:e[14]}}),g=new TT({props:{colorScheme:e[2],metric:e[1]}}),{c(){t=Rn("div"),Jr(n.$$.fragment),c=Sr(),Jr(g.$$.fragment),this.h()},l(S){t=Fn(S,"DIV",{class:!0});var a=_n(t);vs(n.$$.fragment,a),c=Ir(a),vs(g.$$.fragment,a),a.forEach(yi),this.h()},h(){Ti(t,"class","control-container svelte-eoojfj")},m(S,a){Un(S,t,a),es(n,t,null),qi(t,c),es(g,t,null),x=!0},p(S,a){const U={};a&32&&(U.drawing=S[5]),n.$set(U);const W={};a&4&&(W.colorScheme=S[2]),a&2&&(W.metric=S[1]),g.$set(W)},i(S){x||(Wi(n.$$.fragment,S),Wi(g.$$.fragment,S),x=!0)},o(S){tn(n.$$.fragment,S),tn(g.$$.fragment,S),x=!1},d(S){S&&yi(t),ts(n),ts(g)}}}function h3(e){let t,n;return t=new wT({props:{updatePath:e[14],updateIsDrawing:e[13],isDrawing:e[5]}}),{c(){Jr(t.$$.fragment)},l(c){vs(t.$$.fragment,c)},m(c,g){es(t,c,g),n=!0},p(c,g){const x={};g&32&&(x.isDrawing=c[5]),t.$set(x)},i(c){n||(Wi(t.$$.fragment,c),n=!0)},o(c){tn(t.$$.fragment,c),n=!1},d(c){ts(t,c)}}}function VU(e){let t,n,c,g,x,S,a,U;n=new NU({props:{finishBuilding:e[18],metric:e[1],colorScheme:e[2],showCounties:e[3],showEcoregions:e[4],drawnPath:e[6],clade:e[7],clades:e[16]}}),g=new PO({props:{isBuilt:UU,isFinishedBuilding:e[8],visualLayers:e[17],updateMetricLayer:e[9],showEcoregions:e[12],colorScheme:e[2],metric:e[1],clade:e[7],clades:e[16],updateClade:e[15]}});let W=e[0]&&c3(e),he=e[5]&&h3(e);return{c(){t=Rn("main"),Jr(n.$$.fragment),c=Sr(),Jr(g.$$.fragment),x=Sr(),W&&W.c(),S=Sr(),he&&he.c(),a=xs(),this.h()},l(ae){t=Fn(ae,"MAIN",{class:!0});var ce=_n(t);vs(n.$$.fragment,ce),c=Ir(ce),vs(g.$$.fragment,ce),ce.forEach(yi),x=Ir(ae),W&&W.l(ae),S=Ir(ae),he&&he.l(ae),a=xs(),this.h()},h(){Ti(t,"class","svelte-eoojfj")},m(ae,ce){Un(ae,t,ce),es(n,t,null),qi(t,c),es(g,t,null),Un(ae,x,ce),W&&W.m(ae,ce),Un(ae,S,ce),he&&he.m(ae,ce),Un(ae,a,ce),U=!0},p(ae,[ce]){const be={};ce&2&&(be.metric=ae[1]),ce&4&&(be.colorScheme=ae[2]),ce&8&&(be.showCounties=ae[3]),ce&16&&(be.showEcoregions=ae[4]),ce&64&&(be.drawnPath=ae[6]),ce&128&&(be.clade=ae[7]),n.$set(be);const Je={};ce&256&&(Je.isFinishedBuilding=ae[8]),ce&4&&(Je.colorScheme=ae[2]),ce&2&&(Je.metric=ae[1]),ce&128&&(Je.clade=ae[7]),g.$set(Je),ae[0]?W?(W.p(ae,ce),ce&1&&Wi(W,1)):(W=c3(ae),W.c(),Wi(W,1),W.m(S.parentNode,S)):W&&(Eo(),tn(W,1,1,()=>{W=null}),Co()),ae[5]?he?(he.p(ae,ce),ce&32&&Wi(he,1)):(he=h3(ae),he.c(),Wi(he,1),he.m(a.parentNode,a)):he&&(Eo(),tn(he,1,1,()=>{he=null}),Co())},i(ae){U||(Wi(n.$$.fragment,ae),Wi(g.$$.fragment,ae),Wi(W),Wi(he),U=!0)},o(ae){tn(n.$$.fragment,ae),tn(g.$$.fragment,ae),tn(W),tn(he),U=!1},d(ae){ae&&(yi(t),yi(x),yi(S),yi(a)),ts(n),ts(g),W&&W.d(ae),he&&he.d(ae)}}}let UU=!1;function GU(e,t,n){let c;Bu(e,$_,Oe=>n(0,c=Oe));let g="pd";function x(Oe){n(1,g=Oe)}let S="*ibm";function a(Oe){n(2,S=Oe)}let U=!1;function W(Oe){n(3,U=Oe)}let he=!1;function ae(Oe){n(4,he=Oe)}let ce=!1;function be(Oe){n(5,ce=Oe)}let Je=null;function st(Oe){n(6,Je=Oe)}let Ye="Birds";function it(Oe){n(7,Ye=Oe)}const ct=["Birds","Plants"],Tt=["hex","eco"];let zt=!1;function Rt(){n(8,zt=!0)}return e.$$.update=()=>{e.$$.dirty&1&&console.log(c)},[c,g,S,U,he,ce,Je,Ye,zt,x,a,W,ae,be,st,it,ct,Tt,Rt]}class XU extends fo{constructor(t){super(),po(this,t,GU,VU,Va,{})}}export{XU as component};
