var tE=Object.defineProperty;var iE=(e,t,n)=>t in e?tE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Tr=(e,t,n)=>(iE(e,typeof t!="symbol"?t+"":t,n),n);import{y as Cu,s as Oa,c as ql,z as gr,A as Io,j as Eu,u as Hl,g as jl,a as Zl,r as Nh,B as Ao,C as vc,D as du,o as xc,E as wm,F as ic,e as pa,G as O0,n as Ra,H as nE,b as tc,I as om,J as V2,l as rE,K as ep}from"../chunks/scheduler.I9_GjKIr.js";import{S as fo,i as po,s as wr,e as Fn,h as Sr,c as On,d as yn,g as vi,y as sl,j as Un,z as Gl,t as $i,a as ln,A as N0,u as ls,v as Ds,w as us,x as cs,r as ef,m as Ls,q as zo,n as Ro,B as Ba,C as za,D as p_,E as m_,o as ki,k as Hi,b as to,f as io,l as su,F as sE,G as Zu,H as U2,I as up,J as aE,K as oE,L as em,p as By}from"../chunks/index.uFRP6icT.js";import{w as V0}from"../chunks/index.OKv3WG0v.js";const lE=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function ph(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function ma(e,t){const n={},c={},g={$$scope:1};let x=e.length;for(;x--;){const S=e[x],a=t[x];if(a){for(const G in S)G in a||(c[G]=1);for(const G in a)g[G]||(n[G]=a[G],g[G]=1);e[x]=a}else for(const G in S)g[G]=1}for(const S in c)S in n||(n[S]=void 0);return n}function Os(e){return typeof e=="object"&&e!==null?e:{}}var zy=function(e,t){return zy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,c){n.__proto__=c}||function(n,c){for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&(n[g]=c[g])},zy(e,t)};function s0(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");zy(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var ou=function(){return ou=Object.assign||function(t){for(var n,c=1,g=arguments.length;c<g;c++){n=arguments[c];for(var x in n)Object.prototype.hasOwnProperty.call(n,x)&&(t[x]=n[x])}return t},ou.apply(this,arguments)};function ig(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],c=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&c>=e.length&&(e=void 0),{value:e&&e[c++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function G2(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var c=n.call(e),g,x=[],S;try{for(;(t===void 0||t-- >0)&&!(g=c.next()).done;)x.push(g.value)}catch(a){S={error:a}}finally{try{g&&!g.done&&(n=c.return)&&n.call(c)}finally{if(S)throw S.error}}return x}function uE(e,t,n){if(n||arguments.length===2)for(var c=0,g=t.length,x;c<g;c++)(x||!(c in t))&&(x||(x=Array.prototype.slice.call(t,0,c)),x[c]=t[c]);return e.concat(x||Array.prototype.slice.call(t))}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var a0=function(){function e(t){t===void 0&&(t={}),this.adapter=t}return Object.defineProperty(e,"cssClasses",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{}},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.destroy=function(){},e}();/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function cE(e,t){if(e.closest)return e.closest(t);for(var n=e;n;){if(u3(n,t))return n;n=n.parentElement}return null}function u3(e,t){var n=e.matches||e.webkitMatchesSelector||e.msMatchesSelector;return n.call(e,t)}function hE(e){var t=e;if(t.offsetParent!==null)return t.scrollWidth;var n=t.cloneNode(!0);n.style.setProperty("position","absolute"),n.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(n);var c=n.scrollWidth;return document.documentElement.removeChild(n),c}const Lv=Object.freeze(Object.defineProperty({__proto__:null,closest:cE,estimateScrollWidth:hE,matches:u3},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var AE={LABEL_FLOAT_ABOVE:"mdc-floating-label--float-above",LABEL_REQUIRED:"mdc-floating-label--required",LABEL_SHAKE:"mdc-floating-label--shake",ROOT:"mdc-floating-label"};/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var fE=function(e){s0(t,e);function t(n){var c=e.call(this,ou(ou({},t.defaultAdapter),n))||this;return c.shakeAnimationEndHandler=function(){c.handleShakeAnimationEnd()},c}return Object.defineProperty(t,"cssClasses",{get:function(){return AE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},getWidth:function(){return 0},registerInteractionHandler:function(){},deregisterInteractionHandler:function(){}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.adapter.registerInteractionHandler("animationend",this.shakeAnimationEndHandler)},t.prototype.destroy=function(){this.adapter.deregisterInteractionHandler("animationend",this.shakeAnimationEndHandler)},t.prototype.getWidth=function(){return this.adapter.getWidth()},t.prototype.shake=function(n){var c=t.cssClasses.LABEL_SHAKE;n?this.adapter.addClass(c):this.adapter.removeClass(c)},t.prototype.float=function(n){var c=t.cssClasses,g=c.LABEL_FLOAT_ABOVE,x=c.LABEL_SHAKE;n?this.adapter.addClass(g):(this.adapter.removeClass(g),this.adapter.removeClass(x))},t.prototype.setRequired=function(n){var c=t.cssClasses.LABEL_REQUIRED;n?this.adapter.addClass(c):this.adapter.removeClass(c)},t.prototype.handleShakeAnimationEnd=function(){var n=t.cssClasses.LABEL_SHAKE;this.adapter.removeClass(n)},t}(a0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Vd={LINE_RIPPLE_ACTIVE:"mdc-line-ripple--active",LINE_RIPPLE_DEACTIVATING:"mdc-line-ripple--deactivating"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var dE=function(e){s0(t,e);function t(n){var c=e.call(this,ou(ou({},t.defaultAdapter),n))||this;return c.transitionEndHandler=function(g){c.handleTransitionEnd(g)},c}return Object.defineProperty(t,"cssClasses",{get:function(){return Vd},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setStyle:function(){},registerEventHandler:function(){},deregisterEventHandler:function(){}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.adapter.registerEventHandler("transitionend",this.transitionEndHandler)},t.prototype.destroy=function(){this.adapter.deregisterEventHandler("transitionend",this.transitionEndHandler)},t.prototype.activate=function(){this.adapter.removeClass(Vd.LINE_RIPPLE_DEACTIVATING),this.adapter.addClass(Vd.LINE_RIPPLE_ACTIVE)},t.prototype.setRippleCenter=function(n){this.adapter.setStyle("transform-origin",n+"px center")},t.prototype.deactivate=function(){this.adapter.addClass(Vd.LINE_RIPPLE_DEACTIVATING)},t.prototype.handleTransitionEnd=function(n){var c=this.adapter.hasClass(Vd.LINE_RIPPLE_DEACTIVATING);n.propertyName==="opacity"&&c&&(this.adapter.removeClass(Vd.LINE_RIPPLE_ACTIVE),this.adapter.removeClass(Vd.LINE_RIPPLE_DEACTIVATING))},t}(a0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var pE={ANCHOR:"mdc-menu-surface--anchor",ANIMATING_CLOSED:"mdc-menu-surface--animating-closed",ANIMATING_OPEN:"mdc-menu-surface--animating-open",FIXED:"mdc-menu-surface--fixed",IS_OPEN_BELOW:"mdc-menu-surface--is-open-below",OPEN:"mdc-menu-surface--open",ROOT:"mdc-menu-surface"},mE={CLOSED_EVENT:"MDCMenuSurface:closed",CLOSING_EVENT:"MDCMenuSurface:closing",OPENED_EVENT:"MDCMenuSurface:opened",OPENING_EVENT:"MDCMenuSurface:opening",FOCUSABLE_ELEMENTS:["button:not(:disabled)",'[href]:not([aria-disabled="true"])',"input:not(:disabled)","select:not(:disabled)","textarea:not(:disabled)",'[tabindex]:not([tabindex="-1"]):not([aria-disabled="true"])'].join(", ")},jm={TRANSITION_OPEN_DURATION:120,TRANSITION_CLOSE_DURATION:75,MARGIN_TO_EDGE:32,ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO:.67,TOUCH_EVENT_WAIT_MS:30},ru;(function(e){e[e.BOTTOM=1]="BOTTOM",e[e.CENTER=2]="CENTER",e[e.RIGHT=4]="RIGHT",e[e.FLIP_RTL=8]="FLIP_RTL"})(ru||(ru={}));var Wd;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=4]="TOP_RIGHT",e[e.BOTTOM_LEFT=1]="BOTTOM_LEFT",e[e.BOTTOM_RIGHT=5]="BOTTOM_RIGHT",e[e.TOP_START=8]="TOP_START",e[e.TOP_END=12]="TOP_END",e[e.BOTTOM_START=9]="BOTTOM_START",e[e.BOTTOM_END=13]="BOTTOM_END"})(Wd||(Wd={}));/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var B0,jf,la={LIST_ITEM_ACTIVATED_CLASS:"mdc-list-item--activated",LIST_ITEM_CLASS:"mdc-list-item",LIST_ITEM_DISABLED_CLASS:"mdc-list-item--disabled",LIST_ITEM_SELECTED_CLASS:"mdc-list-item--selected",LIST_ITEM_TEXT_CLASS:"mdc-list-item__text",LIST_ITEM_PRIMARY_TEXT_CLASS:"mdc-list-item__primary-text",ROOT:"mdc-list"};B0={},B0[""+la.LIST_ITEM_ACTIVATED_CLASS]="mdc-list-item--activated",B0[""+la.LIST_ITEM_CLASS]="mdc-list-item",B0[""+la.LIST_ITEM_DISABLED_CLASS]="mdc-list-item--disabled",B0[""+la.LIST_ITEM_SELECTED_CLASS]="mdc-list-item--selected",B0[""+la.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-list-item__primary-text",B0[""+la.ROOT]="mdc-list";var Zp=(jf={},jf[""+la.LIST_ITEM_ACTIVATED_CLASS]="mdc-deprecated-list-item--activated",jf[""+la.LIST_ITEM_CLASS]="mdc-deprecated-list-item",jf[""+la.LIST_ITEM_DISABLED_CLASS]="mdc-deprecated-list-item--disabled",jf[""+la.LIST_ITEM_SELECTED_CLASS]="mdc-deprecated-list-item--selected",jf[""+la.LIST_ITEM_TEXT_CLASS]="mdc-deprecated-list-item__text",jf[""+la.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-deprecated-list-item__primary-text",jf[""+la.ROOT]="mdc-deprecated-list",jf),z0={ACTION_EVENT:"MDCList:action",SELECTION_CHANGE_EVENT:"MDCList:selectionChange",ARIA_CHECKED:"aria-checked",ARIA_CHECKED_CHECKBOX_SELECTOR:'[role="checkbox"][aria-checked="true"]',ARIA_CHECKED_RADIO_SELECTOR:'[role="radio"][aria-checked="true"]',ARIA_CURRENT:"aria-current",ARIA_DISABLED:"aria-disabled",ARIA_ORIENTATION:"aria-orientation",ARIA_ORIENTATION_HORIZONTAL:"horizontal",ARIA_ROLE_CHECKBOX_SELECTOR:'[role="checkbox"]',ARIA_SELECTED:"aria-selected",ARIA_INTERACTIVE_ROLES_SELECTOR:'[role="listbox"], [role="menu"]',ARIA_MULTI_SELECTABLE_SELECTOR:'[aria-multiselectable="true"]',CHECKBOX_RADIO_SELECTOR:'input[type="checkbox"], input[type="radio"]',CHECKBOX_SELECTOR:'input[type="checkbox"]',CHILD_ELEMENTS_TO_TOGGLE_TABINDEX:`
    .`+la.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+la.LIST_ITEM_CLASS+` a,
    .`+Zp[la.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+Zp[la.LIST_ITEM_CLASS]+` a
  `,DEPRECATED_SELECTOR:".mdc-deprecated-list",FOCUSABLE_CHILD_ELEMENTS:`
    .`+la.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+la.LIST_ITEM_CLASS+` a,
    .`+la.LIST_ITEM_CLASS+` input[type="radio"]:not(:disabled),
    .`+la.LIST_ITEM_CLASS+` input[type="checkbox"]:not(:disabled),
    .`+Zp[la.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+Zp[la.LIST_ITEM_CLASS]+` a,
    .`+Zp[la.LIST_ITEM_CLASS]+` input[type="radio"]:not(:disabled),
    .`+Zp[la.LIST_ITEM_CLASS]+` input[type="checkbox"]:not(:disabled)
  `,RADIO_SELECTOR:'input[type="radio"]',SELECTED_ITEM_SELECTOR:'[aria-selected="true"], [aria-current="true"]'},nu={UNSET_INDEX:-1,TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS:300};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Ns={UNKNOWN:"Unknown",BACKSPACE:"Backspace",ENTER:"Enter",SPACEBAR:"Spacebar",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",END:"End",HOME:"Home",ARROW_LEFT:"ArrowLeft",ARROW_UP:"ArrowUp",ARROW_RIGHT:"ArrowRight",ARROW_DOWN:"ArrowDown",DELETE:"Delete",ESCAPE:"Escape",TAB:"Tab"},bc=new Set;bc.add(Ns.BACKSPACE);bc.add(Ns.ENTER);bc.add(Ns.SPACEBAR);bc.add(Ns.PAGE_UP);bc.add(Ns.PAGE_DOWN);bc.add(Ns.END);bc.add(Ns.HOME);bc.add(Ns.ARROW_LEFT);bc.add(Ns.ARROW_UP);bc.add(Ns.ARROW_RIGHT);bc.add(Ns.ARROW_DOWN);bc.add(Ns.DELETE);bc.add(Ns.ESCAPE);bc.add(Ns.TAB);var Qc={BACKSPACE:8,ENTER:13,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46,ESCAPE:27,TAB:9},wc=new Map;wc.set(Qc.BACKSPACE,Ns.BACKSPACE);wc.set(Qc.ENTER,Ns.ENTER);wc.set(Qc.SPACEBAR,Ns.SPACEBAR);wc.set(Qc.PAGE_UP,Ns.PAGE_UP);wc.set(Qc.PAGE_DOWN,Ns.PAGE_DOWN);wc.set(Qc.END,Ns.END);wc.set(Qc.HOME,Ns.HOME);wc.set(Qc.ARROW_LEFT,Ns.ARROW_LEFT);wc.set(Qc.ARROW_UP,Ns.ARROW_UP);wc.set(Qc.ARROW_RIGHT,Ns.ARROW_RIGHT);wc.set(Qc.ARROW_DOWN,Ns.ARROW_DOWN);wc.set(Qc.DELETE,Ns.DELETE);wc.set(Qc.ESCAPE,Ns.ESCAPE);wc.set(Qc.TAB,Ns.TAB);var G0=new Set;G0.add(Ns.PAGE_UP);G0.add(Ns.PAGE_DOWN);G0.add(Ns.END);G0.add(Ns.HOME);G0.add(Ns.ARROW_LEFT);G0.add(Ns.ARROW_UP);G0.add(Ns.ARROW_RIGHT);G0.add(Ns.ARROW_DOWN);function fu(e){var t=e.key;if(bc.has(t))return t;var n=wc.get(e.keyCode);return n||Ns.UNKNOWN}/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var gE=["input","button","textarea","select"],Rh=function(e){var t=e.target;if(t){var n=(""+t.tagName).toLowerCase();gE.indexOf(n)===-1&&e.preventDefault()}};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function _E(){var e={bufferClearTimeout:0,currentFirstChar:"",sortedIndexCursor:0,typeaheadBuffer:""};return e}function yE(e,t){for(var n=new Map,c=0;c<e;c++){var g=t(c).trim();if(g){var x=g[0].toLowerCase();n.has(x)||n.set(x,[]),n.get(x).push({text:g.toLowerCase(),index:c})}}return n.forEach(function(S){S.sort(function(a,G){return a.index-G.index})}),n}function Ry(e,t){var n=e.nextChar,c=e.focusItemAtIndex,g=e.sortedIndexByFirstChar,x=e.focusedItemIndex,S=e.skipFocus,a=e.isItemAtIndexDisabled;clearTimeout(t.bufferClearTimeout),t.bufferClearTimeout=setTimeout(function(){h3(t)},nu.TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS),t.typeaheadBuffer=t.typeaheadBuffer+n;var G;return t.typeaheadBuffer.length===1?G=vE(g,x,a,t):G=xE(g,a,t),G!==-1&&!S&&c(G),G}function vE(e,t,n,c){var g=c.typeaheadBuffer[0],x=e.get(g);if(!x)return-1;if(g===c.currentFirstChar&&x[c.sortedIndexCursor].index===t){c.sortedIndexCursor=(c.sortedIndexCursor+1)%x.length;var S=x[c.sortedIndexCursor].index;if(!n(S))return S}c.currentFirstChar=g;var a=-1,G;for(G=0;G<x.length;G++)if(!n(x[G].index)){a=G;break}for(;G<x.length;G++)if(x[G].index>t&&!n(x[G].index)){a=G;break}return a!==-1?(c.sortedIndexCursor=a,x[c.sortedIndexCursor].index):-1}function xE(e,t,n){var c=n.typeaheadBuffer[0],g=e.get(c);if(!g)return-1;var x=g[n.sortedIndexCursor];if(x.text.lastIndexOf(n.typeaheadBuffer,0)===0&&!t(x.index))return x.index;for(var S=(n.sortedIndexCursor+1)%g.length,a=-1;S!==n.sortedIndexCursor;){var G=g[S],W=G.text.lastIndexOf(n.typeaheadBuffer,0)===0,he=!t(G.index);if(W&&he){a=S;break}S=(S+1)%g.length}return a!==-1?(n.sortedIndexCursor=a,g[n.sortedIndexCursor].index):-1}function c3(e){return e.typeaheadBuffer.length>0}function h3(e){e.typeaheadBuffer=""}function q2(e,t){var n=e.event,c=e.isTargetListItem,g=e.focusedItemIndex,x=e.focusItemAtIndex,S=e.sortedIndexByFirstChar,a=e.isItemAtIndexDisabled,G=fu(n)==="ArrowLeft",W=fu(n)==="ArrowUp",he=fu(n)==="ArrowRight",ae=fu(n)==="ArrowDown",ue=fu(n)==="Home",be=fu(n)==="End",je=fu(n)==="Enter",nt=fu(n)==="Spacebar";if(n.altKey||n.ctrlKey||n.metaKey||G||W||he||ae||ue||be||je)return-1;var tt=!nt&&n.key.length===1;if(tt){Rh(n);var at={focusItemAtIndex:x,focusedItemIndex:g,nextChar:n.key.toLowerCase(),sortedIndexByFirstChar:S,skipFocus:!1,isItemAtIndexDisabled:a};return Ry(at,t)}if(!nt)return-1;c&&Rh(n);var ut=c&&c3(t);if(ut){var at={focusItemAtIndex:x,focusedItemIndex:g,nextChar:" ",sortedIndexByFirstChar:S,skipFocus:!1,isItemAtIndexDisabled:a};return Ry(at,t)}return-1}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function bE(e){return e instanceof Array}var wE=["Alt","Control","Meta","Shift"];function H2(e){var t=new Set(e?wE.filter(function(n){return e.getModifierState(n)}):[]);return function(n){return n.every(function(c){return t.has(c)})&&n.length===t.size}}var SE=function(e){s0(t,e);function t(n){var c=e.call(this,ou(ou({},t.defaultAdapter),n))||this;return c.wrapFocus=!1,c.isVertical=!0,c.isSingleSelectionList=!1,c.areDisabledItemsFocusable=!0,c.selectedIndex=nu.UNSET_INDEX,c.focusedItemIndex=nu.UNSET_INDEX,c.useActivatedClass=!1,c.useSelectedAttr=!1,c.ariaCurrentAttrValue=null,c.isCheckboxList=!1,c.isRadioList=!1,c.lastSelectedIndex=null,c.hasTypeahead=!1,c.typeaheadState=_E(),c.sortedIndexByFirstChar=new Map,c}return Object.defineProperty(t,"strings",{get:function(){return z0},enumerable:!1,configurable:!0}),Object.defineProperty(t,"cssClasses",{get:function(){return la},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return nu},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClassForElementIndex:function(){},focusItemAtIndex:function(){},getAttributeForElementIndex:function(){return null},getFocusedElementIndex:function(){return 0},getListItemCount:function(){return 0},hasCheckboxAtIndex:function(){return!1},hasRadioAtIndex:function(){return!1},isCheckboxCheckedAtIndex:function(){return!1},isFocusInsideList:function(){return!1},isRootFocused:function(){return!1},listItemAtIndexHasClass:function(){return!1},notifyAction:function(){},notifySelectionChange:function(){},removeClassForElementIndex:function(){},setAttributeForElementIndex:function(){},setCheckedCheckboxOrRadioAtIndex:function(){},setTabIndexForListItemChildren:function(){},getPrimaryTextAtIndex:function(){return""}}},enumerable:!1,configurable:!0}),t.prototype.layout=function(){this.adapter.getListItemCount()!==0&&(this.adapter.hasCheckboxAtIndex(0)?this.isCheckboxList=!0:this.adapter.hasRadioAtIndex(0)?this.isRadioList=!0:this.maybeInitializeSingleSelection(),this.hasTypeahead&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex()))},t.prototype.getFocusedItemIndex=function(){return this.focusedItemIndex},t.prototype.setWrapFocus=function(n){this.wrapFocus=n},t.prototype.setVerticalOrientation=function(n){this.isVertical=n},t.prototype.setSingleSelection=function(n){this.isSingleSelectionList=n,n&&(this.maybeInitializeSingleSelection(),this.selectedIndex=this.getSelectedIndexFromDOM())},t.prototype.setDisabledItemsFocusable=function(n){this.areDisabledItemsFocusable=n},t.prototype.maybeInitializeSingleSelection=function(){var n=this.getSelectedIndexFromDOM();if(n!==nu.UNSET_INDEX){var c=this.adapter.listItemAtIndexHasClass(n,la.LIST_ITEM_ACTIVATED_CLASS);c&&this.setUseActivatedClass(!0),this.isSingleSelectionList=!0,this.selectedIndex=n}},t.prototype.getSelectedIndexFromDOM=function(){for(var n=nu.UNSET_INDEX,c=this.adapter.getListItemCount(),g=0;g<c;g++){var x=this.adapter.listItemAtIndexHasClass(g,la.LIST_ITEM_SELECTED_CLASS),S=this.adapter.listItemAtIndexHasClass(g,la.LIST_ITEM_ACTIVATED_CLASS);if(x||S){n=g;break}}return n},t.prototype.setHasTypeahead=function(n){this.hasTypeahead=n,n&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex())},t.prototype.isTypeaheadInProgress=function(){return this.hasTypeahead&&c3(this.typeaheadState)},t.prototype.setUseActivatedClass=function(n){this.useActivatedClass=n},t.prototype.setUseSelectedAttribute=function(n){this.useSelectedAttr=n},t.prototype.getSelectedIndex=function(){return this.selectedIndex},t.prototype.setSelectedIndex=function(n,c){c===void 0&&(c={}),this.isIndexValid(n)&&(this.isCheckboxList?this.setCheckboxAtIndex(n,c):this.isRadioList?this.setRadioAtIndex(n,c):this.setSingleSelectionAtIndex(n,c))},t.prototype.handleFocusIn=function(n){n>=0&&(this.focusedItemIndex=n,this.adapter.setAttributeForElementIndex(n,"tabindex","0"),this.adapter.setTabIndexForListItemChildren(n,"0"))},t.prototype.handleFocusOut=function(n){var c=this;n>=0&&(this.adapter.setAttributeForElementIndex(n,"tabindex","-1"),this.adapter.setTabIndexForListItemChildren(n,"-1")),setTimeout(function(){c.adapter.isFocusInsideList()||c.setTabindexToFirstSelectedOrFocusedItem()},0)},t.prototype.isIndexDisabled=function(n){return this.adapter.listItemAtIndexHasClass(n,la.LIST_ITEM_DISABLED_CLASS)},t.prototype.handleKeydown=function(n,c,g){var x=this,S,a=fu(n)==="ArrowLeft",G=fu(n)==="ArrowUp",W=fu(n)==="ArrowRight",he=fu(n)==="ArrowDown",ae=fu(n)==="Home",ue=fu(n)==="End",be=fu(n)==="Enter",je=fu(n)==="Spacebar",nt=this.isVertical&&he||!this.isVertical&&W,tt=this.isVertical&&G||!this.isVertical&&a,at=n.key==="A"||n.key==="a",ut=H2(n);if(this.adapter.isRootFocused()){if((tt||ue)&&ut([]))n.preventDefault(),this.focusLastElement();else if((nt||ae)&&ut([]))n.preventDefault(),this.focusFirstElement();else if(tt&&ut(["Shift"])&&this.isCheckboxList){n.preventDefault();var xt=this.focusLastElement();xt!==-1&&this.setSelectedIndexOnAction(xt,!1)}else if(nt&&ut(["Shift"])&&this.isCheckboxList){n.preventDefault();var xt=this.focusFirstElement();xt!==-1&&this.setSelectedIndexOnAction(xt,!1)}if(this.hasTypeahead){var Tt={event:n,focusItemAtIndex:function(jt){x.focusItemAtIndex(jt)},focusedItemIndex:-1,isTargetListItem:c,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(jt){return x.isIndexDisabled(jt)}};q2(Tt,this.typeaheadState)}return}var Mt=this.adapter.getFocusedElementIndex();if(!(Mt===-1&&(Mt=g,Mt<0))){if(nt&&ut([]))Rh(n),this.focusNextElement(Mt);else if(tt&&ut([]))Rh(n),this.focusPrevElement(Mt);else if(nt&&ut(["Shift"])&&this.isCheckboxList){Rh(n);var xt=this.focusNextElement(Mt);xt!==-1&&this.setSelectedIndexOnAction(xt,!1)}else if(tt&&ut(["Shift"])&&this.isCheckboxList){Rh(n);var xt=this.focusPrevElement(Mt);xt!==-1&&this.setSelectedIndexOnAction(xt,!1)}else if(ae&&ut([]))Rh(n),this.focusFirstElement();else if(ue&&ut([]))Rh(n),this.focusLastElement();else if(ae&&ut(["Control","Shift"])&&this.isCheckboxList){if(Rh(n),this.isIndexDisabled(Mt))return;this.focusFirstElement(),this.toggleCheckboxRange(0,Mt,Mt)}else if(ue&&ut(["Control","Shift"])&&this.isCheckboxList){if(Rh(n),this.isIndexDisabled(Mt))return;this.focusLastElement(),this.toggleCheckboxRange(Mt,this.adapter.getListItemCount()-1,Mt)}else if(at&&ut(["Control"])&&this.isCheckboxList)n.preventDefault(),this.checkboxListToggleAll(this.selectedIndex===nu.UNSET_INDEX?[]:this.selectedIndex,!0);else if((be||je)&&ut([])){if(c){var Oe=n.target;if(Oe&&Oe.tagName==="A"&&be||(Rh(n),this.isIndexDisabled(Mt)))return;this.isTypeaheadInProgress()||(this.isSelectableList()&&this.setSelectedIndexOnAction(Mt,!1),this.adapter.notifyAction(Mt))}}else if((be||je)&&ut(["Shift"])&&this.isCheckboxList){var Oe=n.target;if(Oe&&Oe.tagName==="A"&&be||(Rh(n),this.isIndexDisabled(Mt)))return;this.isTypeaheadInProgress()||(this.toggleCheckboxRange((S=this.lastSelectedIndex)!==null&&S!==void 0?S:Mt,Mt,Mt),this.adapter.notifyAction(Mt))}if(this.hasTypeahead){var Tt={event:n,focusItemAtIndex:function(it){x.focusItemAtIndex(it)},focusedItemIndex:this.focusedItemIndex,isTargetListItem:c,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(it){return x.isIndexDisabled(it)}};q2(Tt,this.typeaheadState)}}},t.prototype.handleClick=function(n,c,g){var x,S=H2(g);n!==nu.UNSET_INDEX&&(this.isIndexDisabled(n)||(S([])?(this.isSelectableList()&&this.setSelectedIndexOnAction(n,c),this.adapter.notifyAction(n)):this.isCheckboxList&&S(["Shift"])&&(this.toggleCheckboxRange((x=this.lastSelectedIndex)!==null&&x!==void 0?x:n,n,n),this.adapter.notifyAction(n))))},t.prototype.focusNextElement=function(n){var c=this.adapter.getListItemCount(),g=n,x=null;do{if(g++,g>=c)if(this.wrapFocus)g=0;else return n;if(g===x)return-1;x=x??g}while(!this.areDisabledItemsFocusable&&this.isIndexDisabled(g));return this.focusItemAtIndex(g),g},t.prototype.focusPrevElement=function(n){var c=this.adapter.getListItemCount(),g=n,x=null;do{if(g--,g<0)if(this.wrapFocus)g=c-1;else return n;if(g===x)return-1;x=x??g}while(!this.areDisabledItemsFocusable&&this.isIndexDisabled(g));return this.focusItemAtIndex(g),g},t.prototype.focusFirstElement=function(){return this.focusNextElement(-1)},t.prototype.focusLastElement=function(){return this.focusPrevElement(this.adapter.getListItemCount())},t.prototype.focusInitialElement=function(){var n=this.getFirstSelectedOrFocusedItemIndex();return this.focusItemAtIndex(n),n},t.prototype.setEnabled=function(n,c){this.isIndexValid(n,!1)&&(c?(this.adapter.removeClassForElementIndex(n,la.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(n,z0.ARIA_DISABLED,"false")):(this.adapter.addClassForElementIndex(n,la.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(n,z0.ARIA_DISABLED,"true")))},t.prototype.setSingleSelectionAtIndex=function(n,c){if(c===void 0&&(c={}),!(this.selectedIndex===n&&!c.forceUpdate)){var g=la.LIST_ITEM_SELECTED_CLASS;this.useActivatedClass&&(g=la.LIST_ITEM_ACTIVATED_CLASS),this.selectedIndex!==nu.UNSET_INDEX&&this.adapter.removeClassForElementIndex(this.selectedIndex,g),this.setAriaForSingleSelectionAtIndex(n),this.setTabindexAtIndex(n),n!==nu.UNSET_INDEX&&this.adapter.addClassForElementIndex(n,g),this.selectedIndex=n,c.isUserInteraction&&!c.forceUpdate&&this.adapter.notifySelectionChange([n])}},t.prototype.setAriaForSingleSelectionAtIndex=function(n){this.selectedIndex===nu.UNSET_INDEX&&(this.ariaCurrentAttrValue=this.adapter.getAttributeForElementIndex(n,z0.ARIA_CURRENT));var c=this.ariaCurrentAttrValue!==null,g=c?z0.ARIA_CURRENT:z0.ARIA_SELECTED;if(this.selectedIndex!==nu.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,g,"false"),n!==nu.UNSET_INDEX){var x=c?this.ariaCurrentAttrValue:"true";this.adapter.setAttributeForElementIndex(n,g,x)}},t.prototype.getSelectionAttribute=function(){return this.useSelectedAttr?z0.ARIA_SELECTED:z0.ARIA_CHECKED},t.prototype.setRadioAtIndex=function(n,c){c===void 0&&(c={});var g=this.getSelectionAttribute();this.adapter.setCheckedCheckboxOrRadioAtIndex(n,!0),!(this.selectedIndex===n&&!c.forceUpdate)&&(this.selectedIndex!==nu.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,g,"false"),this.adapter.setAttributeForElementIndex(n,g,"true"),this.selectedIndex=n,c.isUserInteraction&&!c.forceUpdate&&this.adapter.notifySelectionChange([n]))},t.prototype.setCheckboxAtIndex=function(n,c){c===void 0&&(c={});for(var g=this.selectedIndex,x=c.isUserInteraction?new Set(g===nu.UNSET_INDEX?[]:g):null,S=this.getSelectionAttribute(),a=[],G=0;G<this.adapter.getListItemCount();G++){var W=x==null?void 0:x.has(G),he=n.indexOf(G)>=0;he!==W&&a.push(G),this.adapter.setCheckedCheckboxOrRadioAtIndex(G,he),this.adapter.setAttributeForElementIndex(G,S,he?"true":"false")}this.selectedIndex=n,c.isUserInteraction&&a.length&&this.adapter.notifySelectionChange(a)},t.prototype.toggleCheckboxRange=function(n,c,g){this.lastSelectedIndex=g;for(var x=new Set(this.selectedIndex===nu.UNSET_INDEX?[]:this.selectedIndex),S=!(x!=null&&x.has(g)),a=G2([n,c].sort(),2),G=a[0],W=a[1],he=this.getSelectionAttribute(),ae=[],ue=G;ue<=W;ue++)if(!this.isIndexDisabled(ue)){var be=x.has(ue);S!==be&&(ae.push(ue),this.adapter.setCheckedCheckboxOrRadioAtIndex(ue,S),this.adapter.setAttributeForElementIndex(ue,he,""+S),S?x.add(ue):x.delete(ue))}ae.length&&(this.selectedIndex=uE([],G2(x)),this.adapter.notifySelectionChange(ae))},t.prototype.setTabindexAtIndex=function(n){this.focusedItemIndex===nu.UNSET_INDEX&&n!==0?this.adapter.setAttributeForElementIndex(0,"tabindex","-1"):this.focusedItemIndex>=0&&this.focusedItemIndex!==n&&this.adapter.setAttributeForElementIndex(this.focusedItemIndex,"tabindex","-1"),!(this.selectedIndex instanceof Array)&&this.selectedIndex!==n&&this.adapter.setAttributeForElementIndex(this.selectedIndex,"tabindex","-1"),n!==nu.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(n,"tabindex","0")},t.prototype.isSelectableList=function(){return this.isSingleSelectionList||this.isCheckboxList||this.isRadioList},t.prototype.setTabindexToFirstSelectedOrFocusedItem=function(){var n=this.getFirstSelectedOrFocusedItemIndex();this.setTabindexAtIndex(n)},t.prototype.getFirstSelectedOrFocusedItemIndex=function(){return this.isSelectableList()?typeof this.selectedIndex=="number"&&this.selectedIndex!==nu.UNSET_INDEX?this.selectedIndex:bE(this.selectedIndex)&&this.selectedIndex.length>0?this.selectedIndex.reduce(function(n,c){return Math.min(n,c)}):0:Math.max(this.focusedItemIndex,0)},t.prototype.isIndexValid=function(n,c){var g=this;if(c===void 0&&(c=!0),n instanceof Array){if(!this.isCheckboxList&&c)throw new Error("MDCListFoundation: Array of index is only supported for checkbox based list");return n.length===0?!0:n.some(function(x){return g.isIndexInRange(x)})}else if(typeof n=="number"){if(this.isCheckboxList&&c)throw new Error("MDCListFoundation: Expected array of index for checkbox based list but got number: "+n);return this.isIndexInRange(n)||this.isSingleSelectionList&&n===nu.UNSET_INDEX}else return!1},t.prototype.isIndexInRange=function(n){var c=this.adapter.getListItemCount();return n>=0&&n<c},t.prototype.setSelectedIndexOnAction=function(n,c){this.lastSelectedIndex=n,this.isCheckboxList?(this.toggleCheckboxAtIndex(n,c),this.adapter.notifySelectionChange([n])):this.setSelectedIndex(n,{isUserInteraction:!0})},t.prototype.toggleCheckboxAtIndex=function(n,c){var g=this.getSelectionAttribute(),x=this.adapter.isCheckboxCheckedAtIndex(n),S;c?S=x:(S=!x,this.adapter.setCheckedCheckboxOrRadioAtIndex(n,S)),this.adapter.setAttributeForElementIndex(n,g,S?"true":"false");var a=this.selectedIndex===nu.UNSET_INDEX?[]:this.selectedIndex.slice();S?a.push(n):a=a.filter(function(G){return G!==n}),this.selectedIndex=a},t.prototype.focusItemAtIndex=function(n){this.adapter.focusItemAtIndex(n),this.focusedItemIndex=n},t.prototype.checkboxListToggleAll=function(n,c){var g=this.adapter.getListItemCount();if(n.length===g)this.setCheckboxAtIndex([],{isUserInteraction:c});else{for(var x=[],S=0;S<g;S++)(!this.isIndexDisabled(S)||n.indexOf(S)>-1)&&x.push(S);this.setCheckboxAtIndex(x,{isUserInteraction:c})}},t.prototype.typeaheadMatchItem=function(n,c,g){var x=this;g===void 0&&(g=!1);var S={focusItemAtIndex:function(a){x.focusItemAtIndex(a)},focusedItemIndex:c||this.focusedItemIndex,nextChar:n,sortedIndexByFirstChar:this.sortedIndexByFirstChar,skipFocus:g,isItemAtIndexDisabled:function(a){return x.isIndexDisabled(a)}};return Ry(S,this.typeaheadState)},t.prototype.typeaheadInitSortedIndex=function(){return yE(this.adapter.getListItemCount(),this.adapter.getPrimaryTextAtIndex)},t.prototype.clearTypeaheadBuffer=function(){h3(this.typeaheadState)},t}(a0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var A3=function(e){s0(t,e);function t(n){var c=e.call(this,ou(ou({},t.defaultAdapter),n))||this;return c.isSurfaceOpen=!1,c.isQuickOpen=!1,c.isHoistedElement=!1,c.isFixedPosition=!1,c.isHorizontallyCenteredOnViewport=!1,c.maxHeight=0,c.openBottomBias=0,c.openAnimationEndTimerId=0,c.closeAnimationEndTimerId=0,c.animationRequestId=0,c.anchorCorner=Wd.TOP_START,c.originCorner=Wd.TOP_START,c.anchorMargin={top:0,right:0,bottom:0,left:0},c.position={x:0,y:0},c}return Object.defineProperty(t,"cssClasses",{get:function(){return pE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return mE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return jm},enumerable:!1,configurable:!0}),Object.defineProperty(t,"Corner",{get:function(){return Wd},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},hasAnchor:function(){return!1},isElementInContainer:function(){return!1},isFocused:function(){return!1},isRtl:function(){return!1},getInnerDimensions:function(){return{height:0,width:0}},getAnchorDimensions:function(){return null},getWindowDimensions:function(){return{height:0,width:0}},getBodyDimensions:function(){return{height:0,width:0}},getWindowScroll:function(){return{x:0,y:0}},setPosition:function(){},setMaxHeight:function(){},setTransformOrigin:function(){},saveFocus:function(){},restoreFocus:function(){},notifyClose:function(){},notifyClosing:function(){},notifyOpen:function(){},notifyOpening:function(){}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){var n=t.cssClasses,c=n.ROOT,g=n.OPEN;if(!this.adapter.hasClass(c))throw new Error(c+" class required in root element.");this.adapter.hasClass(g)&&(this.isSurfaceOpen=!0)},t.prototype.destroy=function(){clearTimeout(this.openAnimationEndTimerId),clearTimeout(this.closeAnimationEndTimerId),cancelAnimationFrame(this.animationRequestId)},t.prototype.setAnchorCorner=function(n){this.anchorCorner=n},t.prototype.flipCornerHorizontally=function(){this.originCorner=this.originCorner^ru.RIGHT},t.prototype.setAnchorMargin=function(n){this.anchorMargin.top=n.top||0,this.anchorMargin.right=n.right||0,this.anchorMargin.bottom=n.bottom||0,this.anchorMargin.left=n.left||0},t.prototype.setIsHoisted=function(n){this.isHoistedElement=n},t.prototype.setFixedPosition=function(n){this.isFixedPosition=n},t.prototype.isFixed=function(){return this.isFixedPosition},t.prototype.setAbsolutePosition=function(n,c){this.position.x=this.isFinite(n)?n:0,this.position.y=this.isFinite(c)?c:0},t.prototype.setIsHorizontallyCenteredOnViewport=function(n){this.isHorizontallyCenteredOnViewport=n},t.prototype.setQuickOpen=function(n){this.isQuickOpen=n},t.prototype.setMaxHeight=function(n){this.maxHeight=n},t.prototype.setOpenBottomBias=function(n){this.openBottomBias=n},t.prototype.isOpen=function(){return this.isSurfaceOpen},t.prototype.open=function(){var n=this;this.isSurfaceOpen||(this.adapter.notifyOpening(),this.adapter.saveFocus(),this.isQuickOpen?(this.isSurfaceOpen=!0,this.adapter.addClass(t.cssClasses.OPEN),this.dimensions=this.adapter.getInnerDimensions(),this.autoposition(),this.adapter.notifyOpen()):(this.adapter.addClass(t.cssClasses.ANIMATING_OPEN),this.animationRequestId=requestAnimationFrame(function(){n.dimensions=n.adapter.getInnerDimensions(),n.autoposition(),n.adapter.addClass(t.cssClasses.OPEN),n.openAnimationEndTimerId=setTimeout(function(){n.openAnimationEndTimerId=0,n.adapter.removeClass(t.cssClasses.ANIMATING_OPEN),n.adapter.notifyOpen()},jm.TRANSITION_OPEN_DURATION)}),this.isSurfaceOpen=!0))},t.prototype.close=function(n){var c=this;if(n===void 0&&(n=!1),!!this.isSurfaceOpen){if(this.adapter.notifyClosing(),this.isQuickOpen){this.isSurfaceOpen=!1,n||this.maybeRestoreFocus(),this.adapter.removeClass(t.cssClasses.OPEN),this.adapter.removeClass(t.cssClasses.IS_OPEN_BELOW),this.adapter.notifyClose();return}this.adapter.addClass(t.cssClasses.ANIMATING_CLOSED),requestAnimationFrame(function(){c.adapter.removeClass(t.cssClasses.OPEN),c.adapter.removeClass(t.cssClasses.IS_OPEN_BELOW),c.closeAnimationEndTimerId=setTimeout(function(){c.closeAnimationEndTimerId=0,c.adapter.removeClass(t.cssClasses.ANIMATING_CLOSED),c.adapter.notifyClose()},jm.TRANSITION_CLOSE_DURATION)}),this.isSurfaceOpen=!1,n||this.maybeRestoreFocus()}},t.prototype.handleBodyClick=function(n){var c=n.target;this.adapter.isElementInContainer(c)||this.close()},t.prototype.handleKeydown=function(n){var c=n.keyCode,g=n.key,x=g==="Escape"||c===27;x&&this.close()},t.prototype.autoposition=function(){var n;this.measurements=this.getAutoLayoutmeasurements();var c=this.getoriginCorner(),g=this.getMenuSurfaceMaxHeight(c),x=this.hasBit(c,ru.BOTTOM)?"bottom":"top",S=this.hasBit(c,ru.RIGHT)?"right":"left",a=this.getHorizontalOriginOffset(c),G=this.getVerticalOriginOffset(c),W=this.measurements,he=W.anchorSize,ae=W.surfaceSize,ue=(n={},n[S]=a,n[x]=G,n);he.width/ae.width>jm.ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO&&(S="center"),(this.isHoistedElement||this.isFixedPosition)&&this.adjustPositionForHoistedElement(ue),this.adapter.setTransformOrigin(S+" "+x),this.adapter.setPosition(ue),this.adapter.setMaxHeight(g?g+"px":""),this.hasBit(c,ru.BOTTOM)||this.adapter.addClass(t.cssClasses.IS_OPEN_BELOW)},t.prototype.getAutoLayoutmeasurements=function(){var n=this.adapter.getAnchorDimensions(),c=this.adapter.getBodyDimensions(),g=this.adapter.getWindowDimensions(),x=this.adapter.getWindowScroll();return n||(n={top:this.position.y,right:this.position.x,bottom:this.position.y,left:this.position.x,width:0,height:0}),{anchorSize:n,bodySize:c,surfaceSize:this.dimensions,viewportDistance:{top:n.top,right:g.width-n.right,bottom:g.height-n.bottom,left:n.left},viewportSize:g,windowScroll:x}},t.prototype.getoriginCorner=function(){var n=this.originCorner,c=this.measurements,g=c.viewportDistance,x=c.anchorSize,S=c.surfaceSize,a=t.numbers.MARGIN_TO_EDGE,G=this.hasBit(this.anchorCorner,ru.BOTTOM),W,he;G?(W=g.top-a+this.anchorMargin.bottom,he=g.bottom-a-this.anchorMargin.bottom):(W=g.top-a+this.anchorMargin.top,he=g.bottom-a+x.height-this.anchorMargin.top);var ae=he-S.height>0;!ae&&W>he+this.openBottomBias&&(n=this.setBit(n,ru.BOTTOM));var ue=this.adapter.isRtl(),be=this.hasBit(this.anchorCorner,ru.FLIP_RTL),je=this.hasBit(this.anchorCorner,ru.RIGHT)||this.hasBit(n,ru.RIGHT),nt=!1;ue&&be?nt=!je:nt=je;var tt,at;nt?(tt=g.left+x.width+this.anchorMargin.right,at=g.right-this.anchorMargin.right):(tt=g.left+this.anchorMargin.left,at=g.right+x.width-this.anchorMargin.left);var ut=tt-S.width>0,xt=at-S.width>0,Tt=this.hasBit(n,ru.FLIP_RTL)&&this.hasBit(n,ru.RIGHT);return xt&&Tt&&ue||!ut&&Tt?n=this.unsetBit(n,ru.RIGHT):(ut&&nt&&ue||ut&&!nt&&je||!xt&&tt>=at)&&(n=this.setBit(n,ru.RIGHT)),n},t.prototype.getMenuSurfaceMaxHeight=function(n){if(this.maxHeight>0)return this.maxHeight;var c=this.measurements.viewportDistance,g=0,x=this.hasBit(n,ru.BOTTOM),S=this.hasBit(this.anchorCorner,ru.BOTTOM),a=t.numbers.MARGIN_TO_EDGE;return x?(g=c.top+this.anchorMargin.top-a,S||(g+=this.measurements.anchorSize.height)):(g=c.bottom-this.anchorMargin.bottom+this.measurements.anchorSize.height-a,S&&(g-=this.measurements.anchorSize.height)),g},t.prototype.getHorizontalOriginOffset=function(n){var c=this.measurements.anchorSize,g=this.hasBit(n,ru.RIGHT),x=this.hasBit(this.anchorCorner,ru.RIGHT);if(g){var S=x?c.width-this.anchorMargin.left:this.anchorMargin.right;return this.isHoistedElement||this.isFixedPosition?S-(this.measurements.viewportSize.width-this.measurements.bodySize.width):S}return x?c.width-this.anchorMargin.right:this.anchorMargin.left},t.prototype.getVerticalOriginOffset=function(n){var c=this.measurements.anchorSize,g=this.hasBit(n,ru.BOTTOM),x=this.hasBit(this.anchorCorner,ru.BOTTOM),S=0;return g?S=x?c.height-this.anchorMargin.top:-this.anchorMargin.bottom:S=x?c.height+this.anchorMargin.bottom:this.anchorMargin.top,S},t.prototype.adjustPositionForHoistedElement=function(n){var c,g,x=this.measurements,S=x.windowScroll,a=x.viewportDistance,G=x.surfaceSize,W=x.viewportSize,he=Object.keys(n);try{for(var ae=ig(he),ue=ae.next();!ue.done;ue=ae.next()){var be=ue.value,je=n[be]||0;if(this.isHorizontallyCenteredOnViewport&&(be==="left"||be==="right")){n[be]=(W.width-G.width)/2;continue}je+=a[be],this.isFixedPosition||(be==="top"?je+=S.y:be==="bottom"?je-=S.y:be==="left"?je+=S.x:je-=S.x),n[be]=je}}catch(nt){c={error:nt}}finally{try{ue&&!ue.done&&(g=ae.return)&&g.call(ae)}finally{if(c)throw c.error}}},t.prototype.maybeRestoreFocus=function(){var n=this,c=this.adapter.isFocused(),g=this.adapter.getOwnerDocument?this.adapter.getOwnerDocument():document,x=g.activeElement&&this.adapter.isElementInContainer(g.activeElement);(c||x)&&setTimeout(function(){n.adapter.restoreFocus()},jm.TOUCH_EVENT_WAIT_MS)},t.prototype.hasBit=function(n,c){return!!(n&c)},t.prototype.setBit=function(n,c){return n|c},t.prototype.unsetBit=function(n,c){return n^c},t.prototype.isFinite=function(n){return typeof n=="number"&&isFinite(n)},t}(a0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var lm={MENU_SELECTED_LIST_ITEM:"mdc-menu-item--selected",MENU_SELECTION_GROUP:"mdc-menu__selection-group",ROOT:"mdc-menu"},Qp={ARIA_CHECKED_ATTR:"aria-checked",ARIA_DISABLED_ATTR:"aria-disabled",CHECKBOX_SELECTOR:'input[type="checkbox"]',LIST_SELECTOR:".mdc-list,.mdc-deprecated-list",SELECTED_EVENT:"MDCMenu:selected",SKIP_RESTORE_FOCUS:"data-menu-item-skip-restore-focus"},IE={FOCUS_ROOT_INDEX:-1},tm;(function(e){e[e.NONE=0]="NONE",e[e.LIST_ROOT=1]="LIST_ROOT",e[e.FIRST_ITEM=2]="FIRST_ITEM",e[e.LAST_ITEM=3]="LAST_ITEM"})(tm||(tm={}));/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var EE=function(e){s0(t,e);function t(n){var c=e.call(this,ou(ou({},t.defaultAdapter),n))||this;return c.closeAnimationEndTimerId=0,c.defaultFocusState=tm.LIST_ROOT,c.selectedIndex=-1,c}return Object.defineProperty(t,"cssClasses",{get:function(){return lm},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return Qp},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return IE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClassToElementAtIndex:function(){},removeClassFromElementAtIndex:function(){},addAttributeToElementAtIndex:function(){},removeAttributeFromElementAtIndex:function(){},getAttributeFromElementAtIndex:function(){return null},elementContainsClass:function(){return!1},closeSurface:function(){},getElementIndex:function(){return-1},notifySelected:function(){},getMenuItemCount:function(){return 0},focusItemAtIndex:function(){},focusListRoot:function(){},getSelectedSiblingOfItemAtIndex:function(){return-1},isSelectableItemAtIndex:function(){return!1}}},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){this.closeAnimationEndTimerId&&clearTimeout(this.closeAnimationEndTimerId),this.adapter.closeSurface()},t.prototype.handleKeydown=function(n){var c=n.key,g=n.keyCode,x=c==="Tab"||g===9;x&&this.adapter.closeSurface(!0)},t.prototype.handleItemAction=function(n){var c=this,g=this.adapter.getElementIndex(n);if(!(g<0)){this.adapter.notifySelected({index:g});var x=this.adapter.getAttributeFromElementAtIndex(g,Qp.SKIP_RESTORE_FOCUS)==="true";this.adapter.closeSurface(x),this.closeAnimationEndTimerId=setTimeout(function(){var S=c.adapter.getElementIndex(n);S>=0&&c.adapter.isSelectableItemAtIndex(S)&&c.setSelectedIndex(S)},A3.numbers.TRANSITION_CLOSE_DURATION)}},t.prototype.handleMenuSurfaceOpened=function(){switch(this.defaultFocusState){case tm.FIRST_ITEM:this.adapter.focusItemAtIndex(0);break;case tm.LAST_ITEM:this.adapter.focusItemAtIndex(this.adapter.getMenuItemCount()-1);break;case tm.NONE:break;default:this.adapter.focusListRoot();break}},t.prototype.setDefaultFocusState=function(n){this.defaultFocusState=n},t.prototype.getSelectedIndex=function(){return this.selectedIndex},t.prototype.setSelectedIndex=function(n){if(this.validatedIndex(n),!this.adapter.isSelectableItemAtIndex(n))throw new Error("MDCMenuFoundation: No selection group at specified index.");var c=this.adapter.getSelectedSiblingOfItemAtIndex(n);c>=0&&(this.adapter.removeAttributeFromElementAtIndex(c,Qp.ARIA_CHECKED_ATTR),this.adapter.removeClassFromElementAtIndex(c,lm.MENU_SELECTED_LIST_ITEM)),this.adapter.addClassToElementAtIndex(n,lm.MENU_SELECTED_LIST_ITEM),this.adapter.addAttributeToElementAtIndex(n,Qp.ARIA_CHECKED_ATTR,"true"),this.selectedIndex=n},t.prototype.setEnabled=function(n,c){this.validatedIndex(n),c?(this.adapter.removeClassFromElementAtIndex(n,la.LIST_ITEM_DISABLED_CLASS),this.adapter.addAttributeToElementAtIndex(n,Qp.ARIA_DISABLED_ATTR,"false")):(this.adapter.addClassToElementAtIndex(n,la.LIST_ITEM_DISABLED_CLASS),this.adapter.addAttributeToElementAtIndex(n,Qp.ARIA_DISABLED_ATTR,"true"))},t.prototype.validatedIndex=function(n){var c=this.adapter.getMenuItemCount(),g=n>=0&&n<c;if(!g)throw new Error("MDCMenuFoundation: No list item at specified index.")},t}(a0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var CE={NOTCH_ELEMENT_SELECTOR:".mdc-notched-outline__notch"},j2={NOTCH_ELEMENT_PADDING:8},TE={NO_LABEL:"mdc-notched-outline--no-label",OUTLINE_NOTCHED:"mdc-notched-outline--notched",OUTLINE_UPGRADED:"mdc-notched-outline--upgraded"};/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var kE=function(e){s0(t,e);function t(n){return e.call(this,ou(ou({},t.defaultAdapter),n))||this}return Object.defineProperty(t,"strings",{get:function(){return CE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"cssClasses",{get:function(){return TE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return j2},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},setNotchWidthProperty:function(){},removeNotchWidthProperty:function(){}}},enumerable:!1,configurable:!0}),t.prototype.notch=function(n){var c=t.cssClasses.OUTLINE_NOTCHED;n>0&&(n+=j2.NOTCH_ELEMENT_PADDING),this.adapter.setNotchWidthProperty(n),this.adapter.addClass(c)},t.prototype.closeNotch=function(){var n=t.cssClasses.OUTLINE_NOTCHED;this.adapter.removeClass(n),this.adapter.removeNotchWidthProperty()},t}(a0);/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function ME(e){return e===void 0&&(e=window),PE(e)?{passive:!0}:!1}function PE(e){e===void 0&&(e=window);var t=!1;try{var n={get passive(){return t=!0,!1}},c=function(){};e.document.addEventListener("test",c,n),e.document.removeEventListener("test",c,n)}catch{t=!1}return t}const DE=Object.freeze(Object.defineProperty({__proto__:null,applyPassive:ME},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var LE={BG_FOCUSED:"mdc-ripple-upgraded--background-focused",FG_ACTIVATION:"mdc-ripple-upgraded--foreground-activation",FG_DEACTIVATION:"mdc-ripple-upgraded--foreground-deactivation",ROOT:"mdc-ripple-upgraded",UNBOUNDED:"mdc-ripple-upgraded--unbounded"},BE={VAR_FG_SCALE:"--mdc-ripple-fg-scale",VAR_FG_SIZE:"--mdc-ripple-fg-size",VAR_FG_TRANSLATE_END:"--mdc-ripple-fg-translate-end",VAR_FG_TRANSLATE_START:"--mdc-ripple-fg-translate-start",VAR_LEFT:"--mdc-ripple-left",VAR_TOP:"--mdc-ripple-top"},Z2={DEACTIVATION_TIMEOUT_MS:225,FG_DEACTIVATION_MS:150,INITIAL_ORIGIN_SCALE:.6,PADDING:10,TAP_DELAY_MS:300},Ng;function zE(e,t){t===void 0&&(t=!1);var n=e.CSS,c=Ng;if(typeof Ng=="boolean"&&!t)return Ng;var g=n&&typeof n.supports=="function";if(!g)return!1;var x=n.supports("--css-vars","yes"),S=n.supports("(--css-vars: yes)")&&n.supports("color","#00000000");return c=x||S,t||(Ng=c),c}function RE(e,t,n){if(!e)return{x:0,y:0};var c=t.x,g=t.y,x=c+n.left,S=g+n.top,a,G;if(e.type==="touchstart"){var W=e;a=W.changedTouches[0].pageX-x,G=W.changedTouches[0].pageY-S}else{var he=e;a=he.pageX-x,G=he.pageY-S}return{x:a,y:G}}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Q2=["touchstart","pointerdown","mousedown","keydown"],W2=["touchend","pointerup","mouseup","contextmenu"],Vg=[],FE=function(e){s0(t,e);function t(n){var c=e.call(this,ou(ou({},t.defaultAdapter),n))||this;return c.activationAnimationHasEnded=!1,c.activationTimer=0,c.fgDeactivationRemovalTimer=0,c.fgScale="0",c.frame={width:0,height:0},c.initialSize=0,c.layoutFrame=0,c.maxRadius=0,c.unboundedCoords={left:0,top:0},c.activationState=c.defaultActivationState(),c.activationTimerCallback=function(){c.activationAnimationHasEnded=!0,c.runDeactivationUXLogicIfReady()},c.activateHandler=function(g){c.activateImpl(g)},c.deactivateHandler=function(){c.deactivateImpl()},c.focusHandler=function(){c.handleFocus()},c.blurHandler=function(){c.handleBlur()},c.resizeHandler=function(){c.layout()},c}return Object.defineProperty(t,"cssClasses",{get:function(){return LE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return BE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return Z2},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},browserSupportsCssVars:function(){return!0},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},containsEventTarget:function(){return!0},deregisterDocumentInteractionHandler:function(){},deregisterInteractionHandler:function(){},deregisterResizeHandler:function(){},getWindowPageOffset:function(){return{x:0,y:0}},isSurfaceActive:function(){return!0},isSurfaceDisabled:function(){return!0},isUnbounded:function(){return!0},registerDocumentInteractionHandler:function(){},registerInteractionHandler:function(){},registerResizeHandler:function(){},removeClass:function(){},updateCssVariable:function(){}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){var n=this,c=this.supportsPressRipple();if(this.registerRootHandlers(c),c){var g=t.cssClasses,x=g.ROOT,S=g.UNBOUNDED;requestAnimationFrame(function(){n.adapter.addClass(x),n.adapter.isUnbounded()&&(n.adapter.addClass(S),n.layoutInternal())})}},t.prototype.destroy=function(){var n=this;if(this.supportsPressRipple()){this.activationTimer&&(clearTimeout(this.activationTimer),this.activationTimer=0,this.adapter.removeClass(t.cssClasses.FG_ACTIVATION)),this.fgDeactivationRemovalTimer&&(clearTimeout(this.fgDeactivationRemovalTimer),this.fgDeactivationRemovalTimer=0,this.adapter.removeClass(t.cssClasses.FG_DEACTIVATION));var c=t.cssClasses,g=c.ROOT,x=c.UNBOUNDED;requestAnimationFrame(function(){n.adapter.removeClass(g),n.adapter.removeClass(x),n.removeCssVars()})}this.deregisterRootHandlers(),this.deregisterDeactivationHandlers()},t.prototype.activate=function(n){this.activateImpl(n)},t.prototype.deactivate=function(){this.deactivateImpl()},t.prototype.layout=function(){var n=this;this.layoutFrame&&cancelAnimationFrame(this.layoutFrame),this.layoutFrame=requestAnimationFrame(function(){n.layoutInternal(),n.layoutFrame=0})},t.prototype.setUnbounded=function(n){var c=t.cssClasses.UNBOUNDED;n?this.adapter.addClass(c):this.adapter.removeClass(c)},t.prototype.handleFocus=function(){var n=this;requestAnimationFrame(function(){return n.adapter.addClass(t.cssClasses.BG_FOCUSED)})},t.prototype.handleBlur=function(){var n=this;requestAnimationFrame(function(){return n.adapter.removeClass(t.cssClasses.BG_FOCUSED)})},t.prototype.supportsPressRipple=function(){return this.adapter.browserSupportsCssVars()},t.prototype.defaultActivationState=function(){return{activationEvent:void 0,hasDeactivationUXRun:!1,isActivated:!1,isProgrammatic:!1,wasActivatedByPointer:!1,wasElementMadeActive:!1}},t.prototype.registerRootHandlers=function(n){var c,g;if(n){try{for(var x=ig(Q2),S=x.next();!S.done;S=x.next()){var a=S.value;this.adapter.registerInteractionHandler(a,this.activateHandler)}}catch(G){c={error:G}}finally{try{S&&!S.done&&(g=x.return)&&g.call(x)}finally{if(c)throw c.error}}this.adapter.isUnbounded()&&this.adapter.registerResizeHandler(this.resizeHandler)}this.adapter.registerInteractionHandler("focus",this.focusHandler),this.adapter.registerInteractionHandler("blur",this.blurHandler)},t.prototype.registerDeactivationHandlers=function(n){var c,g;if(n.type==="keydown")this.adapter.registerInteractionHandler("keyup",this.deactivateHandler);else try{for(var x=ig(W2),S=x.next();!S.done;S=x.next()){var a=S.value;this.adapter.registerDocumentInteractionHandler(a,this.deactivateHandler)}}catch(G){c={error:G}}finally{try{S&&!S.done&&(g=x.return)&&g.call(x)}finally{if(c)throw c.error}}},t.prototype.deregisterRootHandlers=function(){var n,c;try{for(var g=ig(Q2),x=g.next();!x.done;x=g.next()){var S=x.value;this.adapter.deregisterInteractionHandler(S,this.activateHandler)}}catch(a){n={error:a}}finally{try{x&&!x.done&&(c=g.return)&&c.call(g)}finally{if(n)throw n.error}}this.adapter.deregisterInteractionHandler("focus",this.focusHandler),this.adapter.deregisterInteractionHandler("blur",this.blurHandler),this.adapter.isUnbounded()&&this.adapter.deregisterResizeHandler(this.resizeHandler)},t.prototype.deregisterDeactivationHandlers=function(){var n,c;this.adapter.deregisterInteractionHandler("keyup",this.deactivateHandler);try{for(var g=ig(W2),x=g.next();!x.done;x=g.next()){var S=x.value;this.adapter.deregisterDocumentInteractionHandler(S,this.deactivateHandler)}}catch(a){n={error:a}}finally{try{x&&!x.done&&(c=g.return)&&c.call(g)}finally{if(n)throw n.error}}},t.prototype.removeCssVars=function(){var n=this,c=t.strings,g=Object.keys(c);g.forEach(function(x){x.indexOf("VAR_")===0&&n.adapter.updateCssVariable(c[x],null)})},t.prototype.activateImpl=function(n){var c=this;if(!this.adapter.isSurfaceDisabled()){var g=this.activationState;if(!g.isActivated){var x=this.previousActivationEvent,S=x&&n!==void 0&&x.type!==n.type;if(!S){g.isActivated=!0,g.isProgrammatic=n===void 0,g.activationEvent=n,g.wasActivatedByPointer=g.isProgrammatic?!1:n!==void 0&&(n.type==="mousedown"||n.type==="touchstart"||n.type==="pointerdown");var a=n!==void 0&&Vg.length>0&&Vg.some(function(G){return c.adapter.containsEventTarget(G)});if(a){this.resetActivationState();return}n!==void 0&&(Vg.push(n.target),this.registerDeactivationHandlers(n)),g.wasElementMadeActive=this.checkElementMadeActive(n),g.wasElementMadeActive&&this.animateActivation(),requestAnimationFrame(function(){Vg=[],!g.wasElementMadeActive&&n!==void 0&&(n.key===" "||n.keyCode===32)&&(g.wasElementMadeActive=c.checkElementMadeActive(n),g.wasElementMadeActive&&c.animateActivation()),g.wasElementMadeActive||(c.activationState=c.defaultActivationState())})}}}},t.prototype.checkElementMadeActive=function(n){return n!==void 0&&n.type==="keydown"?this.adapter.isSurfaceActive():!0},t.prototype.animateActivation=function(){var n=this,c=t.strings,g=c.VAR_FG_TRANSLATE_START,x=c.VAR_FG_TRANSLATE_END,S=t.cssClasses,a=S.FG_DEACTIVATION,G=S.FG_ACTIVATION,W=t.numbers.DEACTIVATION_TIMEOUT_MS;this.layoutInternal();var he="",ae="";if(!this.adapter.isUnbounded()){var ue=this.getFgTranslationCoordinates(),be=ue.startPoint,je=ue.endPoint;he=be.x+"px, "+be.y+"px",ae=je.x+"px, "+je.y+"px"}this.adapter.updateCssVariable(g,he),this.adapter.updateCssVariable(x,ae),clearTimeout(this.activationTimer),clearTimeout(this.fgDeactivationRemovalTimer),this.rmBoundedActivationClasses(),this.adapter.removeClass(a),this.adapter.computeBoundingRect(),this.adapter.addClass(G),this.activationTimer=setTimeout(function(){n.activationTimerCallback()},W)},t.prototype.getFgTranslationCoordinates=function(){var n=this.activationState,c=n.activationEvent,g=n.wasActivatedByPointer,x;g?x=RE(c,this.adapter.getWindowPageOffset(),this.adapter.computeBoundingRect()):x={x:this.frame.width/2,y:this.frame.height/2},x={x:x.x-this.initialSize/2,y:x.y-this.initialSize/2};var S={x:this.frame.width/2-this.initialSize/2,y:this.frame.height/2-this.initialSize/2};return{startPoint:x,endPoint:S}},t.prototype.runDeactivationUXLogicIfReady=function(){var n=this,c=t.cssClasses.FG_DEACTIVATION,g=this.activationState,x=g.hasDeactivationUXRun,S=g.isActivated,a=x||!S;a&&this.activationAnimationHasEnded&&(this.rmBoundedActivationClasses(),this.adapter.addClass(c),this.fgDeactivationRemovalTimer=setTimeout(function(){n.adapter.removeClass(c)},Z2.FG_DEACTIVATION_MS))},t.prototype.rmBoundedActivationClasses=function(){var n=t.cssClasses.FG_ACTIVATION;this.adapter.removeClass(n),this.activationAnimationHasEnded=!1,this.adapter.computeBoundingRect()},t.prototype.resetActivationState=function(){var n=this;this.previousActivationEvent=this.activationState.activationEvent,this.activationState=this.defaultActivationState(),setTimeout(function(){return n.previousActivationEvent=void 0},t.numbers.TAP_DELAY_MS)},t.prototype.deactivateImpl=function(){var n=this,c=this.activationState;if(c.isActivated){var g=ou({},c);c.isProgrammatic?(requestAnimationFrame(function(){n.animateDeactivation(g)}),this.resetActivationState()):(this.deregisterDeactivationHandlers(),requestAnimationFrame(function(){n.activationState.hasDeactivationUXRun=!0,n.animateDeactivation(g),n.resetActivationState()}))}},t.prototype.animateDeactivation=function(n){var c=n.wasActivatedByPointer,g=n.wasElementMadeActive;(c||g)&&this.runDeactivationUXLogicIfReady()},t.prototype.layoutInternal=function(){var n=this;this.frame=this.adapter.computeBoundingRect();var c=Math.max(this.frame.height,this.frame.width),g=function(){var S=Math.sqrt(Math.pow(n.frame.width,2)+Math.pow(n.frame.height,2));return S+t.numbers.PADDING};this.maxRadius=this.adapter.isUnbounded()?c:g();var x=Math.floor(c*t.numbers.INITIAL_ORIGIN_SCALE);this.adapter.isUnbounded()&&x%2!==0?this.initialSize=x-1:this.initialSize=x,this.fgScale=""+this.maxRadius/this.initialSize,this.updateLayoutCssVars()},t.prototype.updateLayoutCssVars=function(){var n=t.strings,c=n.VAR_FG_SIZE,g=n.VAR_LEFT,x=n.VAR_TOP,S=n.VAR_FG_SCALE;this.adapter.updateCssVariable(c,this.initialSize+"px"),this.adapter.updateCssVariable(S,this.fgScale),this.adapter.isUnbounded()&&(this.unboundedCoords={left:Math.round(this.frame.width/2-this.initialSize/2),top:Math.round(this.frame.height/2-this.initialSize/2)},this.adapter.updateCssVariable(g,this.unboundedCoords.left+"px"),this.adapter.updateCssVariable(x,this.unboundedCoords.top+"px"))},t}(a0);/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Rl={ACTIVATED:"mdc-select--activated",DISABLED:"mdc-select--disabled",FOCUSED:"mdc-select--focused",INVALID:"mdc-select--invalid",MENU_INVALID:"mdc-select__menu--invalid",OUTLINED:"mdc-select--outlined",REQUIRED:"mdc-select--required",ROOT:"mdc-select",WITH_LEADING_ICON:"mdc-select--with-leading-icon"},P1={ARIA_CONTROLS:"aria-controls",ARIA_DESCRIBEDBY:"aria-describedby",ARIA_SELECTED_ATTR:"aria-selected",CHANGE_EVENT:"MDCSelect:change",HIDDEN_INPUT_SELECTOR:'input[type="hidden"]',LABEL_SELECTOR:".mdc-floating-label",LEADING_ICON_SELECTOR:".mdc-select__icon",LINE_RIPPLE_SELECTOR:".mdc-line-ripple",MENU_SELECTOR:".mdc-select__menu",OUTLINE_SELECTOR:".mdc-notched-outline",SELECTED_TEXT_SELECTOR:".mdc-select__selected-text",SELECT_ANCHOR_SELECTOR:".mdc-select__anchor",VALUE_ATTR:"data-value"},Ud={LABEL_SCALE:.75,UNSET_INDEX:-1,CLICK_DEBOUNCE_TIMEOUT_MS:330};/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var OE=function(e){s0(t,e);function t(n,c){c===void 0&&(c={});var g=e.call(this,ou(ou({},t.defaultAdapter),n))||this;return g.disabled=!1,g.isMenuOpen=!1,g.useDefaultValidation=!0,g.customValidity=!0,g.lastSelectedIndex=Ud.UNSET_INDEX,g.clickDebounceTimeout=0,g.recentlyClicked=!1,g.leadingIcon=c.leadingIcon,g.helperText=c.helperText,g}return Object.defineProperty(t,"cssClasses",{get:function(){return Rl},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return Ud},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return P1},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},activateBottomLine:function(){},deactivateBottomLine:function(){},getSelectedIndex:function(){return-1},setSelectedIndex:function(){},hasLabel:function(){return!1},floatLabel:function(){},getLabelWidth:function(){return 0},setLabelRequired:function(){},hasOutline:function(){return!1},notchOutline:function(){},closeOutline:function(){},setRippleCenter:function(){},notifyChange:function(){},setSelectedText:function(){},isSelectAnchorFocused:function(){return!1},getSelectAnchorAttr:function(){return""},setSelectAnchorAttr:function(){},removeSelectAnchorAttr:function(){},addMenuClass:function(){},removeMenuClass:function(){},openMenu:function(){},closeMenu:function(){},getAnchorElement:function(){return null},setMenuAnchorElement:function(){},setMenuAnchorCorner:function(){},setMenuWrapFocus:function(){},focusMenuItemAtIndex:function(){},getMenuItemCount:function(){return 0},getMenuItemValues:function(){return[]},getMenuItemTextAtIndex:function(){return""},isTypeaheadInProgress:function(){return!1},typeaheadMatchItem:function(){return-1}}},enumerable:!1,configurable:!0}),t.prototype.getSelectedIndex=function(){return this.adapter.getSelectedIndex()},t.prototype.setSelectedIndex=function(n,c,g){c===void 0&&(c=!1),g===void 0&&(g=!1),!(n>=this.adapter.getMenuItemCount())&&(n===Ud.UNSET_INDEX?this.adapter.setSelectedText(""):this.adapter.setSelectedText(this.adapter.getMenuItemTextAtIndex(n).trim()),this.adapter.setSelectedIndex(n),c&&this.adapter.closeMenu(),!g&&this.lastSelectedIndex!==n&&this.handleChange(),this.lastSelectedIndex=n)},t.prototype.setValue=function(n,c){c===void 0&&(c=!1);var g=this.adapter.getMenuItemValues().indexOf(n);this.setSelectedIndex(g,!1,c)},t.prototype.getValue=function(){var n=this.adapter.getSelectedIndex(),c=this.adapter.getMenuItemValues();return n!==Ud.UNSET_INDEX?c[n]:""},t.prototype.getDisabled=function(){return this.disabled},t.prototype.setDisabled=function(n){this.disabled=n,this.disabled?(this.adapter.addClass(Rl.DISABLED),this.adapter.closeMenu()):this.adapter.removeClass(Rl.DISABLED),this.leadingIcon&&this.leadingIcon.setDisabled(this.disabled),this.disabled?this.adapter.removeSelectAnchorAttr("tabindex"):this.adapter.setSelectAnchorAttr("tabindex","0"),this.adapter.setSelectAnchorAttr("aria-disabled",this.disabled.toString())},t.prototype.openMenu=function(){this.adapter.addClass(Rl.ACTIVATED),this.adapter.openMenu(),this.isMenuOpen=!0,this.adapter.setSelectAnchorAttr("aria-expanded","true")},t.prototype.setHelperTextContent=function(n){this.helperText&&this.helperText.setContent(n)},t.prototype.layout=function(){if(this.adapter.hasLabel()){var n=this.getValue().length>0,c=this.adapter.hasClass(Rl.FOCUSED),g=n||c,x=this.adapter.hasClass(Rl.REQUIRED);this.notchOutline(g),this.adapter.floatLabel(g),this.adapter.setLabelRequired(x)}},t.prototype.layoutOptions=function(){var n=this.adapter.getMenuItemValues(),c=n.indexOf(this.getValue());this.setSelectedIndex(c,!1,!0)},t.prototype.handleMenuOpened=function(){if(this.adapter.getMenuItemValues().length!==0){var n=this.getSelectedIndex(),c=n>=0?n:0;this.adapter.focusMenuItemAtIndex(c)}},t.prototype.handleMenuClosing=function(){this.adapter.setSelectAnchorAttr("aria-expanded","false")},t.prototype.handleMenuClosed=function(){this.adapter.removeClass(Rl.ACTIVATED),this.isMenuOpen=!1,this.adapter.isSelectAnchorFocused()||this.blur()},t.prototype.handleChange=function(){this.layout(),this.adapter.notifyChange(this.getValue());var n=this.adapter.hasClass(Rl.REQUIRED);n&&this.useDefaultValidation&&this.setValid(this.isValid())},t.prototype.handleMenuItemAction=function(n){this.setSelectedIndex(n,!0)},t.prototype.handleFocus=function(){this.adapter.addClass(Rl.FOCUSED),this.layout(),this.adapter.activateBottomLine()},t.prototype.handleBlur=function(){this.isMenuOpen||this.blur()},t.prototype.handleClick=function(n){if(!(this.disabled||this.recentlyClicked)){if(this.setClickDebounceTimeout(),this.isMenuOpen){this.adapter.closeMenu();return}this.adapter.setRippleCenter(n),this.openMenu()}},t.prototype.handleKeydown=function(n){if(!(this.isMenuOpen||!this.adapter.hasClass(Rl.FOCUSED))){var c=fu(n)===Ns.ENTER,g=fu(n)===Ns.SPACEBAR,x=fu(n)===Ns.ARROW_UP,S=fu(n)===Ns.ARROW_DOWN,a=n.ctrlKey||n.metaKey;if(!a&&(!g&&n.key&&n.key.length===1||g&&this.adapter.isTypeaheadInProgress())){var G=g?" ":n.key,W=this.adapter.typeaheadMatchItem(G,this.getSelectedIndex());W>=0&&this.setSelectedIndex(W),n.preventDefault();return}!c&&!g&&!x&&!S||(this.openMenu(),n.preventDefault())}},t.prototype.notchOutline=function(n){if(this.adapter.hasOutline()){var c=this.adapter.hasClass(Rl.FOCUSED);if(n){var g=Ud.LABEL_SCALE,x=this.adapter.getLabelWidth()*g;this.adapter.notchOutline(x)}else c||this.adapter.closeOutline()}},t.prototype.setLeadingIconAriaLabel=function(n){this.leadingIcon&&this.leadingIcon.setAriaLabel(n)},t.prototype.setLeadingIconContent=function(n){this.leadingIcon&&this.leadingIcon.setContent(n)},t.prototype.getUseDefaultValidation=function(){return this.useDefaultValidation},t.prototype.setUseDefaultValidation=function(n){this.useDefaultValidation=n},t.prototype.setValid=function(n){this.useDefaultValidation||(this.customValidity=n),this.adapter.setSelectAnchorAttr("aria-invalid",(!n).toString()),n?(this.adapter.removeClass(Rl.INVALID),this.adapter.removeMenuClass(Rl.MENU_INVALID)):(this.adapter.addClass(Rl.INVALID),this.adapter.addMenuClass(Rl.MENU_INVALID)),this.syncHelperTextValidity(n)},t.prototype.isValid=function(){return this.useDefaultValidation&&this.adapter.hasClass(Rl.REQUIRED)&&!this.adapter.hasClass(Rl.DISABLED)?this.getSelectedIndex()!==Ud.UNSET_INDEX&&(this.getSelectedIndex()!==0||!!this.getValue()):this.customValidity},t.prototype.setRequired=function(n){n?this.adapter.addClass(Rl.REQUIRED):this.adapter.removeClass(Rl.REQUIRED),this.adapter.setSelectAnchorAttr("aria-required",n.toString()),this.adapter.setLabelRequired(n)},t.prototype.getRequired=function(){return this.adapter.getSelectAnchorAttr("aria-required")==="true"},t.prototype.init=function(){var n=this.adapter.getAnchorElement();n&&(this.adapter.setMenuAnchorElement(n),this.adapter.setMenuAnchorCorner(Wd.BOTTOM_START)),this.adapter.setMenuWrapFocus(!1),this.setDisabled(this.adapter.hasClass(Rl.DISABLED)),this.syncHelperTextValidity(!this.adapter.hasClass(Rl.INVALID)),this.layout(),this.layoutOptions()},t.prototype.blur=function(){this.adapter.removeClass(Rl.FOCUSED),this.layout(),this.adapter.deactivateBottomLine();var n=this.adapter.hasClass(Rl.REQUIRED);n&&this.useDefaultValidation&&this.setValid(this.isValid())},t.prototype.syncHelperTextValidity=function(n){if(this.helperText){this.helperText.setValidity(n);var c=this.helperText.isVisible(),g=this.helperText.getId();c&&g?this.adapter.setSelectAnchorAttr(P1.ARIA_DESCRIBEDBY,g):this.adapter.removeSelectAnchorAttr(P1.ARIA_DESCRIBEDBY)}},t.prototype.setClickDebounceTimeout=function(){var n=this;clearTimeout(this.clickDebounceTimeout),this.clickDebounceTimeout=setTimeout(function(){n.recentlyClicked=!1},Ud.CLICK_DEBOUNCE_TIMEOUT_MS),this.recentlyClicked=!0},t}(a0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Gd={ARIA_HIDDEN:"aria-hidden",ROLE:"role"},Zf={HELPER_TEXT_VALIDATION_MSG:"mdc-select-helper-text--validation-msg",HELPER_TEXT_VALIDATION_MSG_PERSISTENT:"mdc-select-helper-text--validation-msg-persistent"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var NE=function(e){s0(t,e);function t(n){return e.call(this,ou(ou({},t.defaultAdapter),n))||this}return Object.defineProperty(t,"cssClasses",{get:function(){return Zf},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return Gd},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setAttr:function(){},getAttr:function(){return null},removeAttr:function(){},setContent:function(){}}},enumerable:!1,configurable:!0}),t.prototype.getId=function(){return this.adapter.getAttr("id")},t.prototype.isVisible=function(){return this.adapter.getAttr(Gd.ARIA_HIDDEN)!=="true"},t.prototype.setContent=function(n){this.adapter.setContent(n)},t.prototype.setValidation=function(n){n?this.adapter.addClass(Zf.HELPER_TEXT_VALIDATION_MSG):this.adapter.removeClass(Zf.HELPER_TEXT_VALIDATION_MSG)},t.prototype.setValidationMsgPersistent=function(n){n?this.adapter.addClass(Zf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT):this.adapter.removeClass(Zf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT)},t.prototype.getIsValidation=function(){return this.adapter.hasClass(Zf.HELPER_TEXT_VALIDATION_MSG)},t.prototype.getIsValidationMsgPersistent=function(){return this.adapter.hasClass(Zf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT)},t.prototype.setValidity=function(n){var c=this.adapter.hasClass(Zf.HELPER_TEXT_VALIDATION_MSG);if(c){var g=this.adapter.hasClass(Zf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT),x=!n||g;if(x){this.showToScreenReader(),n?this.adapter.removeAttr(Gd.ROLE):this.adapter.setAttr(Gd.ROLE,"alert");return}this.adapter.removeAttr(Gd.ROLE),this.hide()}},t.prototype.showToScreenReader=function(){this.adapter.removeAttr(Gd.ARIA_HIDDEN)},t.prototype.hide=function(){this.adapter.setAttr(Gd.ARIA_HIDDEN,"true")},t}(a0);function Es(e){return Object.entries(e).filter(([t,n])=>t!==""&&n).map(([t])=>t).join(" ")}function au(e,t,n,c={bubbles:!0},g=!1){if(typeof Event>"u")throw new Error("Event not defined.");if(!e)throw new Error("Tried to dipatch event without element.");const x=new CustomEvent(t,Object.assign(Object.assign({},c),{detail:n}));if(e==null||e.dispatchEvent(x),g&&t.startsWith("SMUI")){const S=new CustomEvent(t.replace(/^SMUI/g,()=>"MDC"),Object.assign(Object.assign({},c),{detail:n}));e==null||e.dispatchEvent(S),S.defaultPrevented&&x.preventDefault()}return x}function $2(e,t){let n=Object.getOwnPropertyNames(e);const c={};for(let g=0;g<n.length;g++){const x=n[g],S=x.indexOf("$");S!==-1&&t.indexOf(x.substring(0,S+1))!==-1||t.indexOf(x)===-1&&(c[x]=e[x])}return c}const X2=/^[a-z]+(?::(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/,VE=/^[^$]+(?:\$(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/;function Sc(e){let t,n=[];e.$on=(g,x)=>{let S=g,a=()=>{};return t?a=t(S,x):n.push([S,x]),S.match(X2)&&console&&console.warn('Event modifiers in SMUI now use "$" instead of ":", so that all events can be bound with modifiers. Please update your event binding: ',S),()=>{a()}};function c(g){const x=e.$$.callbacks[g.type];x&&x.slice().forEach(S=>S.call(this,g))}return g=>{const x=[],S={};t=(a,G)=>{let W=a,he=G,ae=!1;const ue=W.match(X2),be=W.match(VE),je=ue||be;if(W.match(/^SMUI:\w+:/)){const at=W.split(":");let ut="";for(let xt=0;xt<at.length;xt++)ut+=xt===at.length-1?":"+at[xt]:at[xt].split("-").map(Tt=>Tt.slice(0,1).toUpperCase()+Tt.slice(1)).join("");console.warn(`The event ${W.split("$")[0]} has been renamed to ${ut.split("$")[0]}.`),W=ut}if(je){const at=W.split(ue?":":"$");W=at[0];const ut=at.slice(1).reduce((xt,Tt)=>(xt[Tt]=!0,xt),{});ut.passive&&(ae=ae||{},ae.passive=!0),ut.nonpassive&&(ae=ae||{},ae.passive=!1),ut.capture&&(ae=ae||{},ae.capture=!0),ut.once&&(ae=ae||{},ae.once=!0),ut.preventDefault&&(he=UE(he)),ut.stopPropagation&&(he=GE(he)),ut.stopImmediatePropagation&&(he=qE(he)),ut.self&&(he=HE(g,he)),ut.trusted&&(he=jE(he))}const nt=Y2(g,W,he,ae),tt=()=>{nt();const at=x.indexOf(tt);at>-1&&x.splice(at,1)};return x.push(tt),W in S||(S[W]=Y2(g,W,c)),tt};for(let a=0;a<n.length;a++)t(n[a][0],n[a][1]);return{destroy:()=>{for(let a=0;a<x.length;a++)x[a]();for(let a of Object.entries(S))a[1]()}}}}function Y2(e,t,n,c){return e.addEventListener(t,n,c),()=>e.removeEventListener(t,n,c)}function UE(e){return function(t){return t.preventDefault(),e.call(this,t)}}function GE(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function qE(e){return function(t){return t.stopImmediatePropagation(),e.call(this,t)}}function HE(e,t){return function(n){if(n.target===e)return t.call(this,n)}}function jE(e){return function(t){if(t.isTrusted)return e.call(this,t)}}function wl(e,t){let n=Object.getOwnPropertyNames(e);const c={};for(let g=0;g<n.length;g++){const x=n[g];x.substring(0,t.length)===t&&(c[x.substring(t.length)]=e[x])}return c}function mc(e,t){let n=[];if(t)for(let c=0;c<t.length;c++){const g=t[c],x=Array.isArray(g)?g[0]:g;Array.isArray(g)&&g.length>1?n.push(x(e,g[1])):n.push(x(e))}return{update(c){if((c&&c.length||0)!=n.length)throw new Error("You must not change the length of an actions array.");if(c)for(let g=0;g<c.length;g++){const x=n[g];if(x&&x.update){const S=c[g];Array.isArray(S)&&S.length>1?x.update(S[1]):x.update()}}},destroy(){for(let c=0;c<n.length;c++){const g=n[c];g&&g.destroy&&g.destroy()}}}}const{applyPassive:Ug}=DE,{matches:ZE}=Lv;function $d(e,{ripple:t=!0,surface:n=!1,unbounded:c=!1,disabled:g=!1,color:x,active:S,rippleElement:a,eventTarget:G,activeTarget:W,addClass:he=je=>e.classList.add(je),removeClass:ae=je=>e.classList.remove(je),addStyle:ue=(je,nt)=>e.style.setProperty(je,nt),initPromise:be=Promise.resolve()}={}){let je,nt=Cu("SMUI:addLayoutListener"),tt,at=S,ut=G,xt=W;function Tt(){n?(he("mdc-ripple-surface"),x==="primary"?(he("smui-ripple-surface--primary"),ae("smui-ripple-surface--secondary")):x==="secondary"?(ae("smui-ripple-surface--primary"),he("smui-ripple-surface--secondary")):(ae("smui-ripple-surface--primary"),ae("smui-ripple-surface--secondary"))):(ae("mdc-ripple-surface"),ae("smui-ripple-surface--primary"),ae("smui-ripple-surface--secondary")),je&&at!==S&&(at=S,S?je.activate():S===!1&&je.deactivate()),t&&!je?(je=new FE({addClass:he,browserSupportsCssVars:()=>zE(window),computeBoundingRect:()=>(a||e).getBoundingClientRect(),containsEventTarget:Oe=>e.contains(Oe),deregisterDocumentInteractionHandler:(Oe,jt)=>document.documentElement.removeEventListener(Oe,jt,Ug()),deregisterInteractionHandler:(Oe,jt)=>(G||e).removeEventListener(Oe,jt,Ug()),deregisterResizeHandler:Oe=>window.removeEventListener("resize",Oe),getWindowPageOffset:()=>({x:window.pageXOffset,y:window.pageYOffset}),isSurfaceActive:()=>S??ZE(W||e,":active"),isSurfaceDisabled:()=>!!g,isUnbounded:()=>!!c,registerDocumentInteractionHandler:(Oe,jt)=>document.documentElement.addEventListener(Oe,jt,Ug()),registerInteractionHandler:(Oe,jt)=>(G||e).addEventListener(Oe,jt,Ug()),registerResizeHandler:Oe=>window.addEventListener("resize",Oe),removeClass:ae,updateCssVariable:ue}),be.then(()=>{je&&(je.init(),je.setUnbounded(c))})):je&&!t&&be.then(()=>{je&&(je.destroy(),je=void 0)}),je&&(ut!==G||xt!==W)&&(ut=G,xt=W,je.destroy(),requestAnimationFrame(()=>{je&&(je.init(),je.setUnbounded(c))})),!t&&c&&he("mdc-ripple-upgraded--unbounded")}Tt(),nt&&(tt=nt(Mt));function Mt(){je&&je.layout()}return{update(Oe){({ripple:t,surface:n,unbounded:c,disabled:g,color:x,active:S,rippleElement:a,eventTarget:G,activeTarget:W,addClass:he,removeClass:ae,addStyle:ue,initPromise:be}=Object.assign({ripple:!0,surface:!1,unbounded:!1,disabled:!1,color:void 0,active:void 0,rippleElement:void 0,eventTarget:void 0,activeTarget:void 0,addClass:jt=>e.classList.add(jt),removeClass:jt=>e.classList.remove(jt),addStyle:(jt,it)=>e.style.setProperty(jt,it),initPromise:Promise.resolve()},Oe)),Tt()},destroy(){je&&(je.destroy(),je=void 0,ae("mdc-ripple-surface"),ae("smui-ripple-surface--primary"),ae("smui-ripple-surface--secondary")),tt&&tt()}}}const{document:QE}=lE;function WE(e){let t,n,c,g,x,S,a,G;const W=e[34].default,he=ql(W,e,e[33],null);let ae=[{class:c=Es({[e[1]]:!0,"mdc-menu-surface":!0,"mdc-menu-surface--fixed":e[4],"mdc-menu-surface--open":e[3],"smui-menu-surface--static":e[3],"mdc-menu-surface--fullwidth":e[5],...e[8]})},{style:g=Object.entries(e[9]).map(K2).concat([e[2]]).join(" ")},{role:"dialog"},e[12]],ue={};for(let be=0;be<ae.length;be+=1)ue=gr(ue,ae[be]);return{c(){t=wr(),n=Fn("div"),he&&he.c(),this.h()},l(be){t=Sr(be),n=On(be,"DIV",{class:!0,style:!0,role:!0});var je=yn(n);he&&he.l(je),je.forEach(vi),this.h()},h(){sl(n,ue)},m(be,je){Un(be,t,je),Un(be,n,je),he&&he.m(n,null),e[35](n),S=!0,a||(G=[Gl(QE.body,"click",e[11],!0),Io(x=mc.call(null,n,e[0])),Io(e[10].call(null,n)),Gl(n,"keydown",function(){Eu(e[7]&&e[7].handleKeydown.bind(e[7]))&&(e[7]&&e[7].handleKeydown.bind(e[7])).apply(this,arguments)})],a=!0)},p(be,je){e=be,he&&he.p&&(!S||je[1]&4)&&Hl(he,W,e,e[33],S?Zl(W,e[33],je,null):jl(e[33]),null),sl(n,ue=ma(ae,[(!S||je[0]&314&&c!==(c=Es({[e[1]]:!0,"mdc-menu-surface":!0,"mdc-menu-surface--fixed":e[4],"mdc-menu-surface--open":e[3],"smui-menu-surface--static":e[3],"mdc-menu-surface--fullwidth":e[5],...e[8]})))&&{class:c},(!S||je[0]&516&&g!==(g=Object.entries(e[9]).map(K2).concat([e[2]]).join(" ")))&&{style:g},{role:"dialog"},je[0]&4096&&e[12]])),x&&Eu(x.update)&&je[0]&1&&x.update.call(null,e[0])},i(be){S||($i(he,be),S=!0)},o(be){ln(he,be),S=!1},d(be){be&&(vi(t),vi(n)),he&&he.d(be),e[35](null),a=!1,Nh(G)}}}const K2=([e,t])=>`${e}: ${t};`;function $E(e,t,n){const c=["use","class","style","static","anchor","fixed","open","managed","fullWidth","quickOpen","anchorElement","anchorCorner","anchorMargin","maxHeight","horizontallyCenteredOnViewport","openBottomBias","neverRestoreFocus","isOpen","setOpen","setAbsolutePosition","setIsHoisted","isFixed","getElement"];let g=Ao(t,c),{$$slots:x={},$$scope:S}=t;var a,G,W;const he=Sc(vc());let{use:ae=[]}=t,{class:ue=""}=t,{style:be=""}=t,{static:je=!1}=t,{anchor:nt=!0}=t,{fixed:tt=!1}=t,{open:at=je}=t,{managed:ut=!1}=t,{fullWidth:xt=!1}=t,{quickOpen:Tt=!1}=t,{anchorElement:Mt=void 0}=t,{anchorCorner:Oe=void 0}=t,{anchorMargin:jt={top:0,right:0,bottom:0,left:0}}=t,{maxHeight:it=0}=t,{horizontallyCenteredOnViewport:vt=!1}=t,{openBottomBias:mt=0}=t,{neverRestoreFocus:Et=!1}=t,Pt,dt,Je={},pt={},lt;du("SMUI:list:role","menu"),du("SMUI:list:item:role","menuitem");const Nt=Wd;xc(()=>(n(7,dt=new A3({addClass:Ot,removeClass:gi,hasClass:zt,hasAnchor:()=>!!Mt,notifyClose:()=>{ut||n(13,at=je),at||au(Pt,"SMUIMenuSurface:closed",void 0,void 0,!0)},notifyClosing:()=>{ut||n(13,at=je),at||au(Pt,"SMUIMenuSurface:closing",void 0,void 0,!0)},notifyOpen:()=>{ut||n(13,at=!0),at&&au(Pt,"SMUIMenuSurface:opened",void 0,void 0,!0)},notifyOpening:()=>{at||au(Pt,"SMUIMenuSurface:opening",void 0,void 0,!0)},isElementInContainer:Ri=>Pt.contains(Ri),isRtl:()=>getComputedStyle(Pt).getPropertyValue("direction")==="rtl",setTransformOrigin:Ri=>{n(9,pt["transform-origin"]=Ri,pt)},isFocused:()=>document.activeElement===Pt,saveFocus:()=>{var Ri;lt=(Ri=document.activeElement)!==null&&Ri!==void 0?Ri:void 0},restoreFocus:()=>{!Et&&(!Pt||Pt.contains(document.activeElement))&&lt&&document.contains(lt)&&"focus"in lt&&lt.focus()},getInnerDimensions:()=>({width:Pt.offsetWidth,height:Pt.offsetHeight}),getAnchorDimensions:()=>Mt?Mt.getBoundingClientRect():null,getWindowDimensions:()=>({width:window.innerWidth,height:window.innerHeight}),getBodyDimensions:()=>({width:document.body.clientWidth,height:document.body.clientHeight}),getWindowScroll:()=>({x:window.pageXOffset,y:window.pageYOffset}),setPosition:Ri=>{n(9,pt.left="left"in Ri?`${Ri.left}px`:"",pt),n(9,pt.right="right"in Ri?`${Ri.right}px`:"",pt),n(9,pt.top="top"in Ri?`${Ri.top}px`:"",pt),n(9,pt.bottom="bottom"in Ri?`${Ri.bottom}px`:"",pt)},setMaxHeight:Ri=>{n(9,pt["max-height"]=Ri,pt)}})),au(Pt,"SMUIMenuSurface:mount",{get open(){return at},set open(Ri){n(13,at=Ri)},closeProgrammatic:wi}),dt.init(),()=>{var Ri;const Oi=dt.isHoistedElement;dt.destroy(),Oi&&((Ri=Pt.parentNode)===null||Ri===void 0||Ri.removeChild(Pt))})),wm(()=>{var mi;nt&&Pt&&((mi=Pt.parentElement)===null||mi===void 0||mi.classList.remove("mdc-menu-surface--anchor"))});function zt(mi){return mi in Je?Je[mi]:vn().classList.contains(mi)}function Ot(mi){Je[mi]||n(8,Je[mi]=!0,Je)}function gi(mi){(!(mi in Je)||Je[mi])&&n(8,Je[mi]=!1,Je)}function wi(mi){dt.close(mi),n(13,at=!1)}function Ti(mi){dt&&at&&!ut&&dt.handleBodyClick(mi)}function Ni(){return at}function en(mi){n(13,at=mi)}function ji(mi,Ri){return dt.setAbsolutePosition(mi,Ri)}function Vi(mi){return dt.setIsHoisted(mi)}function nn(){return dt.isFixed()}function vn(){return Pt}function Ci(mi){pa[mi?"unshift":"push"](()=>{Pt=mi,n(6,Pt)})}return e.$$set=mi=>{t=gr(gr({},t),ic(mi)),n(12,g=Ao(t,c)),"use"in mi&&n(0,ae=mi.use),"class"in mi&&n(1,ue=mi.class),"style"in mi&&n(2,be=mi.style),"static"in mi&&n(3,je=mi.static),"anchor"in mi&&n(15,nt=mi.anchor),"fixed"in mi&&n(4,tt=mi.fixed),"open"in mi&&n(13,at=mi.open),"managed"in mi&&n(16,ut=mi.managed),"fullWidth"in mi&&n(5,xt=mi.fullWidth),"quickOpen"in mi&&n(17,Tt=mi.quickOpen),"anchorElement"in mi&&n(14,Mt=mi.anchorElement),"anchorCorner"in mi&&n(18,Oe=mi.anchorCorner),"anchorMargin"in mi&&n(19,jt=mi.anchorMargin),"maxHeight"in mi&&n(20,it=mi.maxHeight),"horizontallyCenteredOnViewport"in mi&&n(21,vt=mi.horizontallyCenteredOnViewport),"openBottomBias"in mi&&n(22,mt=mi.openBottomBias),"neverRestoreFocus"in mi&&n(23,Et=mi.neverRestoreFocus),"$$scope"in mi&&n(33,S=mi.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&1073774656|e.$$.dirty[1]&3&&Pt&&nt&&!(!(n(30,a=Pt.parentElement)===null||a===void 0)&&a.classList.contains("mdc-menu-surface--anchor"))&&(n(31,G=Pt.parentElement)===null||G===void 0||G.classList.add("mdc-menu-surface--anchor"),n(14,Mt=n(32,W=Pt.parentElement)!==null&&W!==void 0?W:void 0)),e.$$.dirty[0]&8320&&dt&&dt.isOpen()!==at&&(at?dt.open():dt.close()),e.$$.dirty[0]&131200&&dt&&dt.setQuickOpen(Tt),e.$$.dirty[0]&144&&dt&&dt.setFixedPosition(tt),e.$$.dirty[0]&1048704&&dt&&dt.setMaxHeight(it),e.$$.dirty[0]&2097280&&dt&&dt.setIsHorizontallyCenteredOnViewport(vt),e.$$.dirty[0]&262272&&dt&&Oe!=null&&(typeof Oe=="string"?dt.setAnchorCorner(Nt[Oe]):dt.setAnchorCorner(Oe)),e.$$.dirty[0]&524416&&dt&&dt.setAnchorMargin(jt),e.$$.dirty[0]&4194432&&dt&&dt.setOpenBottomBias(mt)},[ae,ue,be,je,tt,xt,Pt,dt,Je,pt,he,Ti,g,at,Mt,nt,ut,Tt,Oe,jt,it,vt,mt,Et,Ni,en,ji,Vi,nn,vn,a,G,W,S,x,Ci]}class XE extends fo{constructor(t){super(),po(this,t,$E,WE,Oa,{use:0,class:1,style:2,static:3,anchor:15,fixed:4,open:13,managed:16,fullWidth:5,quickOpen:17,anchorElement:14,anchorCorner:18,anchorMargin:19,maxHeight:20,horizontallyCenteredOnViewport:21,openBottomBias:22,neverRestoreFocus:23,isOpen:24,setOpen:25,setAbsolutePosition:26,setIsHoisted:27,isFixed:28,getElement:29},null,[-1,-1])}get isOpen(){return this.$$.ctx[24]}get setOpen(){return this.$$.ctx[25]}get setAbsolutePosition(){return this.$$.ctx[26]}get setIsHoisted(){return this.$$.ctx[27]}get isFixed(){return this.$$.ctx[28]}get getElement(){return this.$$.ctx[29]}}function YE(e,{addClass:t=c=>e.classList.add(c),removeClass:n=c=>e.classList.remove(c)}={}){return t("mdc-menu-surface--anchor"),{destroy(){n("mdc-menu-surface--anchor")}}}function KE(e){let t;const n=e[17].default,c=ql(n,e,e[22],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,x){c&&c.m(g,x),t=!0},p(g,x){c&&c.p&&(!t||x&4194304)&&Hl(c,n,g,g[22],t?Zl(n,g[22],x,null):jl(g[22]),null)},i(g){t||($i(c,g),t=!0)},o(g){ln(c,g),t=!1},d(g){c&&c.d(g)}}}function JE(e){let t,n,c;const g=[{use:e[5]},{class:Es({[e[1]]:!0,"mdc-menu":!0})},e[9]];function x(a){e[19](a)}let S={$$slots:{default:[KE]},$$scope:{ctx:e}};for(let a=0;a<g.length;a+=1)S=gr(S,g[a]);return e[0]!==void 0&&(S.open=e[0]),t=new XE({props:S}),e[18](t),pa.push(()=>N0(t,"open",x)),t.$on("SMUIMenuSurface:mount",e[7]),t.$on("SMUIList:mount",e[8]),t.$on("SMUIMenuSurface:opened",e[20]),t.$on("keydown",e[6]),t.$on("SMUIList:action",e[21]),{c(){ls(t.$$.fragment)},l(a){Ds(t.$$.fragment,a)},m(a,G){us(t,a,G),c=!0},p(a,[G]){const W=G&546?ma(g,[G&32&&{use:a[5]},G&2&&{class:Es({[a[1]]:!0,"mdc-menu":!0})},G&512&&Os(a[9])]):{};G&4194304&&(W.$$scope={dirty:G,ctx:a}),!n&&G&1&&(n=!0,W.open=a[0],O0(()=>n=!1)),t.$set(W)},i(a){c||($i(t.$$.fragment,a),c=!0)},o(a){ln(t.$$.fragment,a),c=!1},d(a){e[18](null),cs(t,a)}}}function eC(e,t,n){let c;const g=["use","class","open","isOpen","setOpen","setDefaultFocusState","getSelectedIndex","getMenuSurface","getElement"];let x=Ao(t,g),{$$slots:S={},$$scope:a}=t;const{closest:G}=Lv,W=Sc(vc());let{use:he=[]}=t,{class:ae=""}=t,{open:ue=!1}=t,be,je,nt,tt;xc(()=>(n(3,je=new EE({addClassToElementAtIndex:(Je,pt)=>{tt.addClassForElementIndex(Je,pt)},removeClassFromElementAtIndex:(Je,pt)=>{tt.removeClassForElementIndex(Je,pt)},addAttributeToElementAtIndex:(Je,pt,lt)=>{tt.setAttributeForElementIndex(Je,pt,lt)},removeAttributeFromElementAtIndex:(Je,pt)=>{tt.removeAttributeForElementIndex(Je,pt)},getAttributeFromElementAtIndex:(Je,pt)=>tt.getAttributeFromElementIndex(Je,pt),elementContainsClass:(Je,pt)=>Je.classList.contains(pt),closeSurface:Je=>{nt.closeProgrammatic(Je),au(vt(),"SMUIMenu:closedProgrammatically")},getElementIndex:Je=>tt.getOrderedList().map(pt=>pt.element).indexOf(Je),notifySelected:Je=>au(vt(),"SMUIMenu:selected",{index:Je.index,item:tt.getOrderedList()[Je.index].element},void 0,!0),getMenuItemCount:()=>tt.items.length,focusItemAtIndex:Je=>tt.focusItemAtIndex(Je),focusListRoot:()=>"focus"in tt.element&&tt.element.focus(),isSelectableItemAtIndex:Je=>!!G(tt.getOrderedList()[Je].element,`.${lm.MENU_SELECTION_GROUP}`),getSelectedSiblingOfItemAtIndex:Je=>{const pt=tt.getOrderedList(),lt=G(pt[Je].element,`.${lm.MENU_SELECTION_GROUP}`),Nt=lt==null?void 0:lt.querySelector(`.${lm.MENU_SELECTED_LIST_ITEM}`);return Nt?pt.map(zt=>zt.element).indexOf(Nt):-1}})),au(vt(),"SMUIMenu:mount",je),je.init(),()=>{je.destroy()}));function at(Je){je&&je.handleKeydown(Je)}function ut(Je){nt||(nt=Je.detail)}function xt(Je){tt||n(4,tt=Je.detail)}function Tt(){return ue}function Mt(Je){n(0,ue=Je)}function Oe(Je){je.setDefaultFocusState(Je)}function jt(){return je.getSelectedIndex()}function it(){return be}function vt(){return be.getElement()}function mt(Je){pa[Je?"unshift":"push"](()=>{be=Je,n(2,be)})}function Et(Je){ue=Je,n(0,ue)}const Pt=()=>je&&je.handleMenuSurfaceOpened(),dt=Je=>je&&je.handleItemAction(tt.getOrderedList()[Je.detail.index].element);return e.$$set=Je=>{t=gr(gr({},t),ic(Je)),n(9,x=Ao(t,g)),"use"in Je&&n(10,he=Je.use),"class"in Je&&n(1,ae=Je.class),"open"in Je&&n(0,ue=Je.open),"$$scope"in Je&&n(22,a=Je.$$scope)},e.$$.update=()=>{e.$$.dirty&1024&&n(5,c=[W,...he])},[ue,ae,be,je,tt,c,at,ut,xt,x,he,Tt,Mt,Oe,jt,it,vt,S,mt,Et,Pt,dt,a]}class tC extends fo{constructor(t){super(),po(this,t,eC,JE,Oa,{use:10,class:1,open:0,isOpen:11,setOpen:12,setDefaultFocusState:13,getSelectedIndex:14,getMenuSurface:15,getElement:16})}get isOpen(){return this.$$.ctx[11]}get setOpen(){return this.$$.ctx[12]}get setDefaultFocusState(){return this.$$.ctx[13]}get getSelectedIndex(){return this.$$.ctx[14]}get getMenuSurface(){return this.$$.ctx[15]}get getElement(){return this.$$.ctx[16]}}function iC(e){let t;const n=e[10].default,c=ql(n,e,e[12],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,x){c&&c.m(g,x),t=!0},p(g,x){c&&c.p&&(!t||x&4096)&&Hl(c,n,g,g[12],t?Zl(n,g[12],x,null):jl(g[12]),null)},i(g){t||($i(c,g),t=!0)},o(g){ln(c,g),t=!1},d(g){c&&c.d(g)}}}function nC(e){let t,n,c;const g=[{tag:e[3]},{use:[e[5],...e[0]]},{class:Es({[e[1]]:!0,"mdc-button__label":e[6]==="button","mdc-fab__label":e[6]==="fab","mdc-tab__text-label":e[6]==="tab","mdc-image-list__label":e[6]==="image-list","mdc-snackbar__label":e[6]==="snackbar","mdc-banner__text":e[6]==="banner","mdc-segmented-button__label":e[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":e[6]==="data-table:pagination","mdc-data-table__header-cell-label":e[6]==="data-table:sortable-header-cell"})},e[6]==="snackbar"?{"aria-atomic":"false"}:{},{tabindex:e[7]},e[8]];var x=e[2];function S(a,G){let W={$$slots:{default:[iC]},$$scope:{ctx:a}};if(G!==void 0&&G&491)W=ma(g,[G&8&&{tag:a[3]},G&33&&{use:[a[5],...a[0]]},G&66&&{class:Es({[a[1]]:!0,"mdc-button__label":a[6]==="button","mdc-fab__label":a[6]==="fab","mdc-tab__text-label":a[6]==="tab","mdc-image-list__label":a[6]==="image-list","mdc-snackbar__label":a[6]==="snackbar","mdc-banner__text":a[6]==="banner","mdc-segmented-button__label":a[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":a[6]==="data-table:pagination","mdc-data-table__header-cell-label":a[6]==="data-table:sortable-header-cell"})},G&64&&Os(a[6]==="snackbar"?{"aria-atomic":"false"}:{}),G&128&&{tabindex:a[7]},G&256&&Os(a[8])]);else for(let he=0;he<g.length;he+=1)W=gr(W,g[he]);return{props:W}}return x&&(t=ef(x,S(e)),e[11](t)),{c(){t&&ls(t.$$.fragment),n=Ls()},l(a){t&&Ds(t.$$.fragment,a),n=Ls()},m(a,G){t&&us(t,a,G),Un(a,n,G),c=!0},p(a,[G]){if(G&4&&x!==(x=a[2])){if(t){zo();const W=t;ln(W.$$.fragment,1,0,()=>{cs(W,1)}),Ro()}x?(t=ef(x,S(a,G)),a[11](t),ls(t.$$.fragment),$i(t.$$.fragment,1),us(t,n.parentNode,n)):t=null}else if(x){const W=G&491?ma(g,[G&8&&{tag:a[3]},G&33&&{use:[a[5],...a[0]]},G&66&&{class:Es({[a[1]]:!0,"mdc-button__label":a[6]==="button","mdc-fab__label":a[6]==="fab","mdc-tab__text-label":a[6]==="tab","mdc-image-list__label":a[6]==="image-list","mdc-snackbar__label":a[6]==="snackbar","mdc-banner__text":a[6]==="banner","mdc-segmented-button__label":a[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":a[6]==="data-table:pagination","mdc-data-table__header-cell-label":a[6]==="data-table:sortable-header-cell"})},G&64&&Os(a[6]==="snackbar"?{"aria-atomic":"false"}:{}),G&128&&{tabindex:a[7]},G&256&&Os(a[8])]):{};G&4096&&(W.$$scope={dirty:G,ctx:a}),t.$set(W)}},i(a){c||(t&&$i(t.$$.fragment,a),c=!0)},o(a){t&&ln(t.$$.fragment,a),c=!1},d(a){a&&vi(n),e[11](null),t&&cs(t,a)}}}function rC(e,t,n){const c=["use","class","component","tag","getElement"];let g=Ao(t,c),{$$slots:x={},$$scope:S}=t;const a=Sc(vc());let{use:G=[]}=t,{class:W=""}=t,he,{component:ae=tf}=t,{tag:ue=ae===tf?"span":void 0}=t;const be=Cu("SMUI:label:context"),je=Cu("SMUI:label:tabindex");function nt(){return he.getElement()}function tt(at){pa[at?"unshift":"push"](()=>{he=at,n(4,he)})}return e.$$set=at=>{t=gr(gr({},t),ic(at)),n(8,g=Ao(t,c)),"use"in at&&n(0,G=at.use),"class"in at&&n(1,W=at.class),"component"in at&&n(2,ae=at.component),"tag"in at&&n(3,ue=at.tag),"$$scope"in at&&n(12,S=at.$$scope)},[G,W,ae,ue,he,a,be,je,g,nt,x,tt,S]}class sC extends fo{constructor(t){super(),po(this,t,rC,nC,Oa,{use:0,class:1,component:2,tag:3,getElement:9})}get getElement(){return this.$$.ctx[9]}}function aC(e){let t=e[1],n,c,g=e[1]&&D1(e);return{c(){g&&g.c(),n=Ls()},l(x){g&&g.l(x),n=Ls()},m(x,S){g&&g.m(x,S),Un(x,n,S),c=!0},p(x,S){x[1]?t?Oa(t,x[1])?(g.d(1),g=D1(x),t=x[1],g.c(),g.m(n.parentNode,n)):g.p(x,S):(g=D1(x),t=x[1],g.c(),g.m(n.parentNode,n)):t&&(g.d(1),g=null,t=x[1])},i(x){c||($i(g,x),c=!0)},o(x){ln(g,x),c=!1},d(x){x&&vi(n),g&&g.d(x)}}}function oC(e){let t=e[1],n,c=e[1]&&L1(e);return{c(){c&&c.c(),n=Ls()},l(g){c&&c.l(g),n=Ls()},m(g,x){c&&c.m(g,x),Un(g,n,x)},p(g,x){g[1]?t?Oa(t,g[1])?(c.d(1),c=L1(g),t=g[1],c.c(),c.m(n.parentNode,n)):c.p(g,x):(c=L1(g),t=g[1],c.c(),c.m(n.parentNode,n)):t&&(c.d(1),c=null,t=g[1])},i:Ra,o:Ra,d(g){g&&vi(n),c&&c.d(g)}}}function lC(e){let t,n,c,g,x;const S=e[8].default,a=ql(S,e,e[7],null);let G=[e[5]],W={};for(let he=0;he<G.length;he+=1)W=gr(W,G[he]);return{c(){t=Ba("svg"),a&&a.c(),this.h()},l(he){t=za(he,"svg",{});var ae=yn(t);a&&a.l(ae),ae.forEach(vi),this.h()},h(){p_(t,W)},m(he,ae){Un(he,t,ae),a&&a.m(t,null),e[9](t),c=!0,g||(x=[Io(n=mc.call(null,t,e[0])),Io(e[4].call(null,t))],g=!0)},p(he,ae){a&&a.p&&(!c||ae&128)&&Hl(a,S,he,he[7],c?Zl(S,he[7],ae,null):jl(he[7]),null),p_(t,W=ma(G,[ae&32&&he[5]])),n&&Eu(n.update)&&ae&1&&n.update.call(null,he[0])},i(he){c||($i(a,he),c=!0)},o(he){ln(a,he),c=!1},d(he){he&&vi(t),a&&a.d(he),e[9](null),g=!1,Nh(x)}}}function D1(e){let t,n,c,g,x;const S=e[8].default,a=ql(S,e,e[7],null);let G=[e[5]],W={};for(let he=0;he<G.length;he+=1)W=gr(W,G[he]);return{c(){t=Fn(e[1]),a&&a.c(),this.h()},l(he){t=On(he,(e[1]||"null").toUpperCase(),{});var ae=yn(t);a&&a.l(ae),ae.forEach(vi),this.h()},h(){m_(e[1])(t,W)},m(he,ae){Un(he,t,ae),a&&a.m(t,null),e[11](t),c=!0,g||(x=[Io(n=mc.call(null,t,e[0])),Io(e[4].call(null,t))],g=!0)},p(he,ae){a&&a.p&&(!c||ae&128)&&Hl(a,S,he,he[7],c?Zl(S,he[7],ae,null):jl(he[7]),null),m_(he[1])(t,W=ma(G,[ae&32&&he[5]])),n&&Eu(n.update)&&ae&1&&n.update.call(null,he[0])},i(he){c||($i(a,he),c=!0)},o(he){ln(a,he),c=!1},d(he){he&&vi(t),a&&a.d(he),e[11](null),g=!1,Nh(x)}}}function L1(e){let t,n,c,g,x=[e[5]],S={};for(let a=0;a<x.length;a+=1)S=gr(S,x[a]);return{c(){t=Fn(e[1]),this.h()},l(a){t=On(a,(e[1]||"null").toUpperCase(),{}),yn(t).forEach(vi),this.h()},h(){m_(e[1])(t,S)},m(a,G){Un(a,t,G),e[10](t),c||(g=[Io(n=mc.call(null,t,e[0])),Io(e[4].call(null,t))],c=!0)},p(a,G){m_(a[1])(t,S=ma(x,[G&32&&a[5]])),n&&Eu(n.update)&&G&1&&n.update.call(null,a[0])},d(a){a&&vi(t),e[10](null),c=!1,Nh(g)}}}function uC(e){let t,n,c,g;const x=[lC,oC,aC],S=[];function a(G,W){return G[1]==="svg"?0:G[3]?1:2}return t=a(e),n=S[t]=x[t](e),{c(){n.c(),c=Ls()},l(G){n.l(G),c=Ls()},m(G,W){S[t].m(G,W),Un(G,c,W),g=!0},p(G,[W]){let he=t;t=a(G),t===he?S[t].p(G,W):(zo(),ln(S[he],1,1,()=>{S[he]=null}),Ro(),n=S[t],n?n.p(G,W):(n=S[t]=x[t](G),n.c()),$i(n,1),n.m(c.parentNode,c))},i(G){g||($i(n),g=!0)},o(G){ln(n),g=!1},d(G){G&&vi(c),S[t].d(G)}}}function cC(e,t,n){let c;const g=["use","tag","getElement"];let x=Ao(t,g),{$$slots:S={},$$scope:a}=t,{use:G=[]}=t,{tag:W}=t;const he=Sc(vc());let ae;function ue(){return ae}function be(tt){pa[tt?"unshift":"push"](()=>{ae=tt,n(2,ae)})}function je(tt){pa[tt?"unshift":"push"](()=>{ae=tt,n(2,ae)})}function nt(tt){pa[tt?"unshift":"push"](()=>{ae=tt,n(2,ae)})}return e.$$set=tt=>{t=gr(gr({},t),ic(tt)),n(5,x=Ao(t,g)),"use"in tt&&n(0,G=tt.use),"tag"in tt&&n(1,W=tt.tag),"$$scope"in tt&&n(7,a=tt.$$scope)},e.$$.update=()=>{e.$$.dirty&2&&n(3,c=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"].indexOf(W)>-1)},[G,W,ae,c,he,x,ue,a,S,be,je,nt]}class tf extends fo{constructor(t){super(),po(this,t,cC,uC,Oa,{use:0,tag:1,getElement:6})}get getElement(){return this.$$.ctx[6]}}function hC(e){let t;const n=e[11].default,c=ql(n,e,e[13],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,x){c&&c.m(g,x),t=!0},p(g,x){c&&c.p&&(!t||x&8192)&&Hl(c,n,g,g[13],t?Zl(n,g[13],x,null):jl(g[13]),null)},i(g){t||($i(c,g),t=!0)},o(g){ln(c,g),t=!1},d(g){c&&c.d(g)}}}function AC(e){let t,n,c;const g=[{tag:e[3]},{use:[e[8],...e[0]]},{class:Es({[e[1]]:!0,[e[6]]:!0,...e[5]})},e[7],e[9]];var x=e[2];function S(a,G){let W={$$slots:{default:[hC]},$$scope:{ctx:a}};if(G!==void 0&&G&1003)W=ma(g,[G&8&&{tag:a[3]},G&257&&{use:[a[8],...a[0]]},G&98&&{class:Es({[a[1]]:!0,[a[6]]:!0,...a[5]})},G&128&&Os(a[7]),G&512&&Os(a[9])]);else for(let he=0;he<g.length;he+=1)W=gr(W,g[he]);return{props:W}}return x&&(t=ef(x,S(e)),e[12](t)),{c(){t&&ls(t.$$.fragment),n=Ls()},l(a){t&&Ds(t.$$.fragment,a),n=Ls()},m(a,G){t&&us(t,a,G),Un(a,n,G),c=!0},p(a,[G]){if(G&4&&x!==(x=a[2])){if(t){zo();const W=t;ln(W.$$.fragment,1,0,()=>{cs(W,1)}),Ro()}x?(t=ef(x,S(a,G)),a[12](t),ls(t.$$.fragment),$i(t.$$.fragment,1),us(t,n.parentNode,n)):t=null}else if(x){const W=G&1003?ma(g,[G&8&&{tag:a[3]},G&257&&{use:[a[8],...a[0]]},G&98&&{class:Es({[a[1]]:!0,[a[6]]:!0,...a[5]})},G&128&&Os(a[7]),G&512&&Os(a[9])]):{};G&8192&&(W.$$scope={dirty:G,ctx:a}),t.$set(W)}},i(a){c||(t&&$i(t.$$.fragment,a),c=!0)},o(a){t&&ln(t.$$.fragment,a),c=!1},d(a){a&&vi(n),e[12](null),t&&cs(t,a)}}}const Kf={component:tf,tag:"div",class:"",classMap:{},contexts:{},props:{}};function fC(e,t,n){const c=["use","class","component","tag","getElement"];let g=Ao(t,c),{$$slots:x={},$$scope:S}=t,{use:a=[]}=t,{class:G=""}=t,W;const he=Kf.class,ae={},ue=[],be=Kf.contexts,je=Kf.props;let{component:nt=Kf.component}=t,{tag:tt=nt===tf?Kf.tag:void 0}=t;Object.entries(Kf.classMap).forEach(([Tt,Mt])=>{const Oe=Cu(Mt);Oe&&"subscribe"in Oe&&ue.push(Oe.subscribe(jt=>{n(5,ae[Tt]=jt,ae)}))});const at=Sc(vc());for(let Tt in be)be.hasOwnProperty(Tt)&&du(Tt,be[Tt]);wm(()=>{for(const Tt of ue)Tt()});function ut(){return W.getElement()}function xt(Tt){pa[Tt?"unshift":"push"](()=>{W=Tt,n(4,W)})}return e.$$set=Tt=>{t=gr(gr({},t),ic(Tt)),n(9,g=Ao(t,c)),"use"in Tt&&n(0,a=Tt.use),"class"in Tt&&n(1,G=Tt.class),"component"in Tt&&n(2,nt=Tt.component),"tag"in Tt&&n(3,tt=Tt.tag),"$$scope"in Tt&&n(13,S=Tt.$$scope)},[a,G,nt,tt,W,ae,he,je,at,g,ut,x,xt,S]}class dC extends fo{constructor(t){super(),po(this,t,fC,AC,Oa,{use:0,class:1,component:2,tag:3,getElement:10})}get getElement(){return this.$$.ctx[10]}}const J2=Object.assign({},Kf);function cp(e){return new Proxy(dC,{construct:function(t,n){return Object.assign(Kf,J2,e),new t(...n)},get:function(t,n){return Object.assign(Kf,J2,e),t[n]}})}function pC(e){let t;const n=e[42].default,c=ql(n,e,e[44],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,x){c&&c.m(g,x),t=!0},p(g,x){c&&c.p&&(!t||x[1]&8192)&&Hl(c,n,g,g[44],t?Zl(n,g[44],x,null):jl(g[44]),null)},i(g){t||($i(c,g),t=!0)},o(g){ln(c,g),t=!1},d(g){c&&c.d(g)}}}function mC(e){let t,n,c;const g=[{tag:e[13]},{use:[e[16],...e[0]]},{class:Es({[e[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":e[2],"mdc-deprecated-list--dense":e[3],"mdc-deprecated-list--textual-list":e[4],"mdc-deprecated-list--avatar-list":e[5]||e[17],"mdc-deprecated-list--icon-list":e[6],"mdc-deprecated-list--image-list":e[7],"mdc-deprecated-list--thumbnail-list":e[8],"mdc-deprecated-list--video-list":e[9],"mdc-deprecated-list--two-line":e[10],"smui-list--three-line":e[11]&&!e[10]})},{role:e[15]},e[25]];var x=e[12];function S(a,G){let W={$$slots:{default:[pC]},$$scope:{ctx:a}};if(G!==void 0&&G[0]&33796095)W=ma(g,[G[0]&8192&&{tag:a[13]},G[0]&65537&&{use:[a[16],...a[0]]},G[0]&135166&&{class:Es({[a[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":a[2],"mdc-deprecated-list--dense":a[3],"mdc-deprecated-list--textual-list":a[4],"mdc-deprecated-list--avatar-list":a[5]||a[17],"mdc-deprecated-list--icon-list":a[6],"mdc-deprecated-list--image-list":a[7],"mdc-deprecated-list--thumbnail-list":a[8],"mdc-deprecated-list--video-list":a[9],"mdc-deprecated-list--two-line":a[10],"smui-list--three-line":a[11]&&!a[10]})},G[0]&32768&&{role:a[15]},G[0]&33554432&&Os(a[25])]);else for(let he=0;he<g.length;he+=1)W=gr(W,g[he]);return{props:W}}return x&&(t=ef(x,S(e)),e[43](t),t.$on("keydown",e[20]),t.$on("focusin",e[21]),t.$on("focusout",e[22]),t.$on("click",e[23]),t.$on("SMUIListItem:mount",e[18]),t.$on("SMUIListItem:unmount",e[19]),t.$on("SMUI:action",e[24])),{c(){t&&ls(t.$$.fragment),n=Ls()},l(a){t&&Ds(t.$$.fragment,a),n=Ls()},m(a,G){t&&us(t,a,G),Un(a,n,G),c=!0},p(a,G){if(G[0]&4096&&x!==(x=a[12])){if(t){zo();const W=t;ln(W.$$.fragment,1,0,()=>{cs(W,1)}),Ro()}x?(t=ef(x,S(a,G)),a[43](t),t.$on("keydown",a[20]),t.$on("focusin",a[21]),t.$on("focusout",a[22]),t.$on("click",a[23]),t.$on("SMUIListItem:mount",a[18]),t.$on("SMUIListItem:unmount",a[19]),t.$on("SMUI:action",a[24]),ls(t.$$.fragment),$i(t.$$.fragment,1),us(t,n.parentNode,n)):t=null}else if(x){const W=G[0]&33796095?ma(g,[G[0]&8192&&{tag:a[13]},G[0]&65537&&{use:[a[16],...a[0]]},G[0]&135166&&{class:Es({[a[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":a[2],"mdc-deprecated-list--dense":a[3],"mdc-deprecated-list--textual-list":a[4],"mdc-deprecated-list--avatar-list":a[5]||a[17],"mdc-deprecated-list--icon-list":a[6],"mdc-deprecated-list--image-list":a[7],"mdc-deprecated-list--thumbnail-list":a[8],"mdc-deprecated-list--video-list":a[9],"mdc-deprecated-list--two-line":a[10],"smui-list--three-line":a[11]&&!a[10]})},G[0]&32768&&{role:a[15]},G[0]&33554432&&Os(a[25])]):{};G[1]&8192&&(W.$$scope={dirty:G,ctx:a}),t.$set(W)}},i(a){c||(t&&$i(t.$$.fragment,a),c=!0)},o(a){t&&ln(t.$$.fragment,a),c=!1},d(a){a&&vi(n),e[43](null),t&&cs(t,a)}}}function gC(e,t,n){const c=["use","class","nonInteractive","dense","textualList","avatarList","iconList","imageList","thumbnailList","videoList","twoLine","threeLine","vertical","wrapFocus","singleSelection","disabledItemsFocusable","selectedIndex","radioList","checkList","hasTypeahead","component","tag","layout","setEnabled","getTypeaheadInProgress","getSelectedIndex","getFocusedItemIndex","focusItemAtIndex","getElement"];let g=Ao(t,c),{$$slots:x={},$$scope:S}=t;var a;const{closest:G,matches:W}=Lv,he=Sc(vc());let{use:ae=[]}=t,{class:ue=""}=t,{nonInteractive:be=!1}=t,{dense:je=!1}=t,{textualList:nt=!1}=t,{avatarList:tt=!1}=t,{iconList:at=!1}=t,{imageList:ut=!1}=t,{thumbnailList:xt=!1}=t,{videoList:Tt=!1}=t,{twoLine:Mt=!1}=t,{threeLine:Oe=!1}=t,{vertical:jt=!0}=t,{wrapFocus:it=(a=Cu("SMUI:list:wrapFocus"))!==null&&a!==void 0?a:!1}=t,{singleSelection:vt=!1}=t,{disabledItemsFocusable:mt=!1}=t,{selectedIndex:Et=-1}=t,{radioList:Pt=!1}=t,{checkList:dt=!1}=t,{hasTypeahead:Je=!1}=t,pt,lt,Nt=[],zt=Cu("SMUI:list:role"),Ot=Cu("SMUI:list:nav");const gi=new WeakMap;let wi=Cu("SMUI:dialog:selection"),Ti=Cu("SMUI:addLayoutListener"),Ni,{component:en=tf}=t,{tag:ji=en===tf?Ot?"nav":"ul":void 0}=t;du("SMUI:list:nonInteractive",be),du("SMUI:separator:context","list"),zt||(vt?(zt="listbox",du("SMUI:list:item:role","option")):Pt?(zt="radiogroup",du("SMUI:list:item:role","radio")):dt?(zt="group",du("SMUI:list:item:role","checkbox")):(zt="list",du("SMUI:list:item:role",void 0))),Ti&&(Ni=Ti(tr)),xc(()=>{n(41,lt=new SE({addClassForElementIndex:Ai,focusItemAtIndex:k,getAttributeForElementIndex:(fe,ve)=>{var Ie,Ee;return(Ee=(Ie=_i()[fe])===null||Ie===void 0?void 0:Ie.getAttr(ve))!==null&&Ee!==void 0?Ee:null},getFocusedElementIndex:()=>document.activeElement?_i().map(fe=>fe.element).indexOf(document.activeElement):-1,getListItemCount:()=>Nt.length,getPrimaryTextAtIndex:ci,hasCheckboxAtIndex:fe=>{var ve,Ie;return(Ie=(ve=_i()[fe])===null||ve===void 0?void 0:ve.hasCheckbox)!==null&&Ie!==void 0?Ie:!1},hasRadioAtIndex:fe=>{var ve,Ie;return(Ie=(ve=_i()[fe])===null||ve===void 0?void 0:ve.hasRadio)!==null&&Ie!==void 0?Ie:!1},isCheckboxCheckedAtIndex:fe=>{var ve;const Ie=_i()[fe];return(ve=(Ie==null?void 0:Ie.hasCheckbox)&&Ie.checked)!==null&&ve!==void 0?ve:!1},isFocusInsideList:()=>pt!=null&&V()!==document.activeElement&&V().contains(document.activeElement),isRootFocused:()=>pt!=null&&document.activeElement===V(),listItemAtIndexHasClass:Ji,notifyAction:fe=>{n(26,Et=fe),pt!=null&&au(V(),"SMUIList:action",{index:fe},void 0,!0)},notifySelectionChange:fe=>{pt!=null&&au(V(),"SMUIList:selectionChange",{changedIndices:fe})},removeClassForElementIndex:sn,setAttributeForElementIndex:ei,setCheckedCheckboxOrRadioAtIndex:(fe,ve)=>{_i()[fe].checked=ve},setTabIndexForListItemChildren:(fe,ve)=>{const Ie=_i()[fe];Array.prototype.forEach.call(Ie.element.querySelectorAll("button:not(:disabled), a"),ze=>{ze.setAttribute("tabindex",ve)})}}));const te={get element(){return V()},get items(){return Nt},get typeaheadInProgress(){return lt.isTypeaheadInProgress()},typeaheadMatchItem(fe,ve){return lt.typeaheadMatchItem(fe,ve,!0)},getOrderedList:_i,focusItemAtIndex:k,addClassForElementIndex:Ai,removeClassForElementIndex:sn,setAttributeForElementIndex:ei,removeAttributeForElementIndex:_n,getAttributeFromElementIndex:Pr,getPrimaryTextAtIndex:ci};return au(V(),"SMUIList:mount",te),lt.init(),lt.layout(),()=>{lt.destroy()}}),wm(()=>{Ni&&Ni()});function Vi(te){Nt.push(te.detail),gi.set(te.detail.element,te.detail),vt&&te.detail.selected&&n(26,Et=rn(te.detail.element)),te.stopPropagation()}function nn(te){var fe;const ve=(fe=te.detail&&Nt.indexOf(te.detail))!==null&&fe!==void 0?fe:-1;ve!==-1&&(Nt.splice(ve,1),Nt=Nt,gi.delete(te.detail.element)),te.stopPropagation()}function vn(te){lt&&te.target&&lt.handleKeydown(te,te.target.classList.contains("mdc-deprecated-list-item"),rn(te.target))}function Ci(te){lt&&te.target&&lt.handleFocusIn(rn(te.target))}function mi(te){lt&&te.target&&lt.handleFocusOut(rn(te.target))}function Ri(te){lt&&te.target&&lt.handleClick(rn(te.target),!W(te.target,'input[type="checkbox"], input[type="radio"]'),te)}function Oi(te){if(Pt||dt){const fe=rn(te.target);if(fe!==-1){const ve=_i()[fe];ve&&(Pt&&!ve.checked||dt)&&(W(te.detail.target,'input[type="checkbox"], input[type="radio"]')||(ve.checked=!ve.checked),ve.activateRipple(),window.requestAnimationFrame(()=>{ve.deactivateRipple()}))}}}function _i(){return pt==null?[]:[...V().children].map(te=>gi.get(te)).filter(te=>te&&te._smui_list_item_accessor)}function Ji(te,fe){var ve;const Ie=_i()[te];return(ve=Ie&&Ie.hasClass(fe))!==null&&ve!==void 0?ve:!1}function Ai(te,fe){const ve=_i()[te];ve&&ve.addClass(fe)}function sn(te,fe){const ve=_i()[te];ve&&ve.removeClass(fe)}function ei(te,fe,ve){const Ie=_i()[te];Ie&&Ie.addAttr(fe,ve)}function _n(te,fe){const ve=_i()[te];ve&&ve.removeAttr(fe)}function Pr(te,fe){const ve=_i()[te];return ve?ve.getAttr(fe):null}function ci(te){var fe;const ve=_i()[te];return(fe=ve&&ve.getPrimaryText())!==null&&fe!==void 0?fe:""}function rn(te){const fe=G(te,".mdc-deprecated-list-item, .mdc-deprecated-list");return fe&&W(fe,".mdc-deprecated-list-item")?_i().map(ve=>ve==null?void 0:ve.element).indexOf(fe):-1}function tr(){return lt.layout()}function Pn(te,fe){return lt.setEnabled(te,fe)}function Qn(){return lt.isTypeaheadInProgress()}function In(){return lt.getSelectedIndex()}function v(){return lt.getFocusedItemIndex()}function k(te){const fe=_i()[te];fe&&"focus"in fe.element&&fe.element.focus()}function V(){return pt.getElement()}function Y(te){pa[te?"unshift":"push"](()=>{pt=te,n(14,pt)})}return e.$$set=te=>{t=gr(gr({},t),ic(te)),n(25,g=Ao(t,c)),"use"in te&&n(0,ae=te.use),"class"in te&&n(1,ue=te.class),"nonInteractive"in te&&n(2,be=te.nonInteractive),"dense"in te&&n(3,je=te.dense),"textualList"in te&&n(4,nt=te.textualList),"avatarList"in te&&n(5,tt=te.avatarList),"iconList"in te&&n(6,at=te.iconList),"imageList"in te&&n(7,ut=te.imageList),"thumbnailList"in te&&n(8,xt=te.thumbnailList),"videoList"in te&&n(9,Tt=te.videoList),"twoLine"in te&&n(10,Mt=te.twoLine),"threeLine"in te&&n(11,Oe=te.threeLine),"vertical"in te&&n(27,jt=te.vertical),"wrapFocus"in te&&n(28,it=te.wrapFocus),"singleSelection"in te&&n(29,vt=te.singleSelection),"disabledItemsFocusable"in te&&n(30,mt=te.disabledItemsFocusable),"selectedIndex"in te&&n(26,Et=te.selectedIndex),"radioList"in te&&n(31,Pt=te.radioList),"checkList"in te&&n(32,dt=te.checkList),"hasTypeahead"in te&&n(33,Je=te.hasTypeahead),"component"in te&&n(12,en=te.component),"tag"in te&&n(13,ji=te.tag),"$$scope"in te&&n(44,S=te.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&134217728|e.$$.dirty[1]&1024&&lt&&lt.setVerticalOrientation(jt),e.$$.dirty[0]&268435456|e.$$.dirty[1]&1024&&lt&&lt.setWrapFocus(it),e.$$.dirty[1]&1028&&lt&&lt.setHasTypeahead(Je),e.$$.dirty[0]&536870912|e.$$.dirty[1]&1024&&lt&&lt.setSingleSelection(vt),e.$$.dirty[0]&1073741824|e.$$.dirty[1]&1024&&lt&&lt.setDisabledItemsFocusable(mt),e.$$.dirty[0]&603979776|e.$$.dirty[1]&1024&&lt&&vt&&In()!==Et&&lt.setSelectedIndex(Et)},[ae,ue,be,je,nt,tt,at,ut,xt,Tt,Mt,Oe,en,ji,pt,zt,he,wi,Vi,nn,vn,Ci,mi,Ri,Oi,g,Et,jt,it,vt,mt,Pt,dt,Je,tr,Pn,Qn,In,v,k,V,lt,x,Y,S]}class _C extends fo{constructor(t){super(),po(this,t,gC,mC,Oa,{use:0,class:1,nonInteractive:2,dense:3,textualList:4,avatarList:5,iconList:6,imageList:7,thumbnailList:8,videoList:9,twoLine:10,threeLine:11,vertical:27,wrapFocus:28,singleSelection:29,disabledItemsFocusable:30,selectedIndex:26,radioList:31,checkList:32,hasTypeahead:33,component:12,tag:13,layout:34,setEnabled:35,getTypeaheadInProgress:36,getSelectedIndex:37,getFocusedItemIndex:38,focusItemAtIndex:39,getElement:40},null,[-1,-1])}get layout(){return this.$$.ctx[34]}get setEnabled(){return this.$$.ctx[35]}get getTypeaheadInProgress(){return this.$$.ctx[36]}get getSelectedIndex(){return this.$$.ctx[37]}get getFocusedItemIndex(){return this.$$.ctx[38]}get focusItemAtIndex(){return this.$$.ctx[39]}get getElement(){return this.$$.ctx[40]}}function ex(e){let t;return{c(){t=Fn("span"),this.h()},l(n){t=On(n,"SPAN",{class:!0}),yn(t).forEach(vi),this.h()},h(){ki(t,"class","mdc-deprecated-list-item__ripple")},m(n,c){Un(n,t,c)},d(n){n&&vi(t)}}}function yC(e){let t,n,c=e[7]&&ex();const g=e[34].default,x=ql(g,e,e[37],null);return{c(){c&&c.c(),t=Ls(),x&&x.c()},l(S){c&&c.l(S),t=Ls(),x&&x.l(S)},m(S,a){c&&c.m(S,a),Un(S,t,a),x&&x.m(S,a),n=!0},p(S,a){S[7]?c||(c=ex(),c.c(),c.m(t.parentNode,t)):c&&(c.d(1),c=null),x&&x.p&&(!n||a[1]&64)&&Hl(x,g,S,S[37],n?Zl(g,S[37],a,null):jl(S[37]),null)},i(S){n||($i(x,S),n=!0)},o(S){ln(x,S),n=!1},d(S){S&&vi(t),c&&c.d(S),x&&x.d(S)}}}function vC(e){let t,n,c;const g=[{tag:e[14]},{use:[...e[6]?[]:[[$d,{ripple:!e[16],unbounded:!1,color:(e[1]||e[0])&&e[5]==null?"primary":e[5],disabled:e[10],addClass:e[24],removeClass:e[25],addStyle:e[26]}]],e[22],...e[2]]},{class:Es({[e[3]]:!0,"mdc-deprecated-list-item":!e[8],"mdc-deprecated-list-item__wrapper":e[8],"mdc-deprecated-list-item--activated":e[1],"mdc-deprecated-list-item--selected":e[0],"mdc-deprecated-list-item--disabled":e[10],"mdc-menu-item--selected":!e[23]&&e[9]==="menuitem"&&e[0],"smui-menu-item--non-interactive":e[6],...e[18]})},{style:Object.entries(e[19]).map(B1).concat([e[4]]).join(" ")},e[23]&&e[1]?{"aria-current":"page"}:{},!e[23]||e[8]?{role:e[9]}:{},!e[23]&&e[9]==="option"?{"aria-selected":e[0]?"true":"false"}:{},!e[23]&&(e[9]==="radio"||e[9]==="checkbox")?{"aria-checked":e[16]&&e[16].checked?"true":"false"}:{},e[23]?{}:{"aria-disabled":e[10]?"true":"false"},{"data-menu-item-skip-restore-focus":e[11]||void 0},{tabindex:e[21]},{href:e[12]},e[20],e[29]];var x=e[13];function S(a,G){let W={$$slots:{default:[yC]},$$scope:{ctx:a}};if(G!==void 0&&G[0]&670916479)W=ma(g,[G[0]&16384&&{tag:a[14]},G[0]&121701479&&{use:[...a[6]?[]:[[$d,{ripple:!a[16],unbounded:!1,color:(a[1]||a[0])&&a[5]==null?"primary":a[5],disabled:a[10],addClass:a[24],removeClass:a[25],addStyle:a[26]}]],a[22],...a[2]]},G[0]&8652619&&{class:Es({[a[3]]:!0,"mdc-deprecated-list-item":!a[8],"mdc-deprecated-list-item__wrapper":a[8],"mdc-deprecated-list-item--activated":a[1],"mdc-deprecated-list-item--selected":a[0],"mdc-deprecated-list-item--disabled":a[10],"mdc-menu-item--selected":!a[23]&&a[9]==="menuitem"&&a[0],"smui-menu-item--non-interactive":a[6],...a[18]})},G[0]&524304&&{style:Object.entries(a[19]).map(B1).concat([a[4]]).join(" ")},G[0]&8388610&&Os(a[23]&&a[1]?{"aria-current":"page"}:{}),G[0]&8389376&&Os(!a[23]||a[8]?{role:a[9]}:{}),G[0]&8389121&&Os(!a[23]&&a[9]==="option"?{"aria-selected":a[0]?"true":"false"}:{}),G[0]&8454656&&Os(!a[23]&&(a[9]==="radio"||a[9]==="checkbox")?{"aria-checked":a[16]&&a[16].checked?"true":"false"}:{}),G[0]&8389632&&Os(a[23]?{}:{"aria-disabled":a[10]?"true":"false"}),G[0]&2048&&{"data-menu-item-skip-restore-focus":a[11]||void 0},G[0]&2097152&&{tabindex:a[21]},G[0]&4096&&{href:a[12]},G[0]&1048576&&Os(a[20]),G[0]&536870912&&Os(a[29])]);else for(let he=0;he<g.length;he+=1)W=gr(W,g[he]);return{props:W}}return x&&(t=ef(x,S(e)),e[35](t),t.$on("click",e[15]),t.$on("keydown",e[27]),t.$on("SMUIGenericInput:mount",e[28]),t.$on("SMUIGenericInput:unmount",e[36])),{c(){t&&ls(t.$$.fragment),n=Ls()},l(a){t&&Ds(t.$$.fragment,a),n=Ls()},m(a,G){t&&us(t,a,G),Un(a,n,G),c=!0},p(a,G){if(G[0]&8192&&x!==(x=a[13])){if(t){zo();const W=t;ln(W.$$.fragment,1,0,()=>{cs(W,1)}),Ro()}x?(t=ef(x,S(a,G)),a[35](t),t.$on("click",a[15]),t.$on("keydown",a[27]),t.$on("SMUIGenericInput:mount",a[28]),t.$on("SMUIGenericInput:unmount",a[36]),ls(t.$$.fragment),$i(t.$$.fragment,1),us(t,n.parentNode,n)):t=null}else if(x){const W=G[0]&670916479?ma(g,[G[0]&16384&&{tag:a[14]},G[0]&121701479&&{use:[...a[6]?[]:[[$d,{ripple:!a[16],unbounded:!1,color:(a[1]||a[0])&&a[5]==null?"primary":a[5],disabled:a[10],addClass:a[24],removeClass:a[25],addStyle:a[26]}]],a[22],...a[2]]},G[0]&8652619&&{class:Es({[a[3]]:!0,"mdc-deprecated-list-item":!a[8],"mdc-deprecated-list-item__wrapper":a[8],"mdc-deprecated-list-item--activated":a[1],"mdc-deprecated-list-item--selected":a[0],"mdc-deprecated-list-item--disabled":a[10],"mdc-menu-item--selected":!a[23]&&a[9]==="menuitem"&&a[0],"smui-menu-item--non-interactive":a[6],...a[18]})},G[0]&524304&&{style:Object.entries(a[19]).map(B1).concat([a[4]]).join(" ")},G[0]&8388610&&Os(a[23]&&a[1]?{"aria-current":"page"}:{}),G[0]&8389376&&Os(!a[23]||a[8]?{role:a[9]}:{}),G[0]&8389121&&Os(!a[23]&&a[9]==="option"?{"aria-selected":a[0]?"true":"false"}:{}),G[0]&8454656&&Os(!a[23]&&(a[9]==="radio"||a[9]==="checkbox")?{"aria-checked":a[16]&&a[16].checked?"true":"false"}:{}),G[0]&8389632&&Os(a[23]?{}:{"aria-disabled":a[10]?"true":"false"}),G[0]&2048&&{"data-menu-item-skip-restore-focus":a[11]||void 0},G[0]&2097152&&{tabindex:a[21]},G[0]&4096&&{href:a[12]},G[0]&1048576&&Os(a[20]),G[0]&536870912&&Os(a[29])]):{};G[0]&128|G[1]&64&&(W.$$scope={dirty:G,ctx:a}),t.$set(W)}},i(a){c||(t&&$i(t.$$.fragment,a),c=!0)},o(a){t&&ln(t.$$.fragment,a),c=!1},d(a){a&&vi(n),e[35](null),t&&cs(t,a)}}}let xC=0;const B1=([e,t])=>`${e}: ${t};`;function bC(e,t,n){let c;const g=["use","class","style","color","nonInteractive","ripple","wrapper","activated","role","selected","disabled","skipRestoreFocus","tabindex","inputId","href","component","tag","action","getPrimaryText","getElement"];let x=Ao(t,g),{$$slots:S={},$$scope:a}=t;var G;const W=Sc(vc());let he=()=>{};function ae(Ai){return Ai===he}let{use:ue=[]}=t,{class:be=""}=t,{style:je=""}=t,{color:nt=void 0}=t,{nonInteractive:tt=(G=Cu("SMUI:list:nonInteractive"))!==null&&G!==void 0?G:!1}=t;du("SMUI:list:nonInteractive",void 0);let{ripple:at=!tt}=t,{wrapper:ut=!1}=t,{activated:xt=!1}=t,{role:Tt=ut?"presentation":Cu("SMUI:list:item:role")}=t;du("SMUI:list:item:role",void 0);let{selected:Mt=!1}=t,{disabled:Oe=!1}=t,{skipRestoreFocus:jt=!1}=t,{tabindex:it=he}=t,{inputId:vt="SMUI-form-field-list-"+xC++}=t,{href:mt=void 0}=t,Et,Pt={},dt={},Je={},pt,lt,Nt=Cu("SMUI:list:item:nav"),{component:zt=tf}=t,{tag:Ot=zt===tf?Nt?mt?"a":"span":"li":void 0}=t;du("SMUI:generic:input:props",{id:vt}),du("SMUI:separator:context",void 0),xc(()=>{if(!Mt&&!tt){let sn=!0,ei=Et.getElement();for(;ei.previousSibling;)if(ei=ei.previousSibling,ei.nodeType===1&&ei.classList.contains("mdc-deprecated-list-item")&&!ei.classList.contains("mdc-deprecated-list-item--disabled")){sn=!1;break}sn&&(lt=window.requestAnimationFrame(()=>nn(ei)))}const Ai={_smui_list_item_accessor:!0,get element(){return Oi()},get selected(){return Mt},set selected(sn){n(0,Mt=sn)},hasClass:gi,addClass:wi,removeClass:Ti,getAttr:en,addAttr:ji,removeAttr:Vi,getPrimaryText:Ri,get checked(){var sn;return(sn=pt&&pt.checked)!==null&&sn!==void 0?sn:!1},set checked(sn){pt&&n(16,pt.checked=!!sn,pt)},get hasCheckbox(){return!!(pt&&"_smui_checkbox_accessor"in pt)},get hasRadio(){return!!(pt&&"_smui_radio_accessor"in pt)},activateRipple(){pt&&pt.activateRipple()},deactivateRipple(){pt&&pt.deactivateRipple()},getValue(){return x.value},action:mi,get tabindex(){return c},set tabindex(sn){n(30,it=sn)},get disabled(){return Oe},get activated(){return xt},set activated(sn){n(1,xt=sn)}};return au(Oi(),"SMUIListItem:mount",Ai),()=>{au(Oi(),"SMUIListItem:unmount",Ai)}}),wm(()=>{lt&&window.cancelAnimationFrame(lt)});function gi(Ai){return Ai in Pt?Pt[Ai]:Oi().classList.contains(Ai)}function wi(Ai){Pt[Ai]||n(18,Pt[Ai]=!0,Pt)}function Ti(Ai){(!(Ai in Pt)||Pt[Ai])&&n(18,Pt[Ai]=!1,Pt)}function Ni(Ai,sn){dt[Ai]!=sn&&(sn===""||sn==null?(delete dt[Ai],n(19,dt)):n(19,dt[Ai]=sn,dt))}function en(Ai){var sn;return Ai in Je?(sn=Je[Ai])!==null&&sn!==void 0?sn:null:Oi().getAttribute(Ai)}function ji(Ai,sn){Je[Ai]!==sn&&n(20,Je[Ai]=sn,Je)}function Vi(Ai){(!(Ai in Je)||Je[Ai]!=null)&&n(20,Je[Ai]=void 0,Je)}function nn(Ai){let sn=!0;for(;Ai.nextElementSibling;)if(Ai=Ai.nextElementSibling,Ai.nodeType===1&&Ai.classList.contains("mdc-deprecated-list-item")){const ei=Ai.attributes.getNamedItem("tabindex");if(ei&&ei.value==="0"){sn=!1;break}}sn&&n(21,c=0)}function vn(Ai){const sn=Ai.key==="Enter",ei=Ai.key==="Space";(sn||ei)&&mi(Ai)}function Ci(Ai){("_smui_checkbox_accessor"in Ai.detail||"_smui_radio_accessor"in Ai.detail)&&n(16,pt=Ai.detail)}function mi(Ai){Oe||au(Oi(),"SMUI:action",Ai)}function Ri(){var Ai,sn,ei;const _n=Oi(),Pr=_n.querySelector(".mdc-deprecated-list-item__primary-text");if(Pr)return(Ai=Pr.textContent)!==null&&Ai!==void 0?Ai:"";const ci=_n.querySelector(".mdc-deprecated-list-item__text");return ci?(sn=ci.textContent)!==null&&sn!==void 0?sn:"":(ei=_n.textContent)!==null&&ei!==void 0?ei:""}function Oi(){return Et.getElement()}function _i(Ai){pa[Ai?"unshift":"push"](()=>{Et=Ai,n(17,Et)})}const Ji=()=>n(16,pt=void 0);return e.$$set=Ai=>{t=gr(gr({},t),ic(Ai)),n(29,x=Ao(t,g)),"use"in Ai&&n(2,ue=Ai.use),"class"in Ai&&n(3,be=Ai.class),"style"in Ai&&n(4,je=Ai.style),"color"in Ai&&n(5,nt=Ai.color),"nonInteractive"in Ai&&n(6,tt=Ai.nonInteractive),"ripple"in Ai&&n(7,at=Ai.ripple),"wrapper"in Ai&&n(8,ut=Ai.wrapper),"activated"in Ai&&n(1,xt=Ai.activated),"role"in Ai&&n(9,Tt=Ai.role),"selected"in Ai&&n(0,Mt=Ai.selected),"disabled"in Ai&&n(10,Oe=Ai.disabled),"skipRestoreFocus"in Ai&&n(11,jt=Ai.skipRestoreFocus),"tabindex"in Ai&&n(30,it=Ai.tabindex),"inputId"in Ai&&n(31,vt=Ai.inputId),"href"in Ai&&n(12,mt=Ai.href),"component"in Ai&&n(13,zt=Ai.component),"tag"in Ai&&n(14,Ot=Ai.tag),"$$scope"in Ai&&n(37,a=Ai.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&1073808449&&n(21,c=ae(it)?!tt&&!Oe&&(Mt||pt&&pt.checked)?0:-1:it)},[Mt,xt,ue,be,je,nt,tt,at,ut,Tt,Oe,jt,mt,zt,Ot,mi,pt,Et,Pt,dt,Je,c,W,Nt,wi,Ti,Ni,vn,Ci,x,it,vt,Ri,Oi,S,_i,Ji,a]}class wC extends fo{constructor(t){super(),po(this,t,bC,vC,Oa,{use:2,class:3,style:4,color:5,nonInteractive:6,ripple:7,wrapper:8,activated:1,role:9,selected:0,disabled:10,skipRestoreFocus:11,tabindex:30,inputId:31,href:12,component:13,tag:14,action:15,getPrimaryText:32,getElement:33},null,[-1,-1])}get action(){return this.$$.ctx[15]}get getPrimaryText(){return this.$$.ctx[32]}get getElement(){return this.$$.ctx[33]}}cp({class:"mdc-deprecated-list-item__text",tag:"span"});cp({class:"mdc-deprecated-list-item__primary-text",tag:"span"});cp({class:"mdc-deprecated-list-item__secondary-text",tag:"span"});function SC(e){let t,n,c,g,x,S;const a=e[8].default,G=ql(a,e,e[7],null);let W=[{class:n=Es({[e[1]]:!0,"mdc-deprecated-list-item__graphic":!0,"mdc-menu__selection-group-icon":e[4]})},e[5]],he={};for(let ae=0;ae<W.length;ae+=1)he=gr(he,W[ae]);return{c(){t=Fn("span"),G&&G.c(),this.h()},l(ae){t=On(ae,"SPAN",{class:!0});var ue=yn(t);G&&G.l(ue),ue.forEach(vi),this.h()},h(){sl(t,he)},m(ae,ue){Un(ae,t,ue),G&&G.m(t,null),e[9](t),g=!0,x||(S=[Io(c=mc.call(null,t,e[0])),Io(e[3].call(null,t))],x=!0)},p(ae,[ue]){G&&G.p&&(!g||ue&128)&&Hl(G,a,ae,ae[7],g?Zl(a,ae[7],ue,null):jl(ae[7]),null),sl(t,he=ma(W,[(!g||ue&2&&n!==(n=Es({[ae[1]]:!0,"mdc-deprecated-list-item__graphic":!0,"mdc-menu__selection-group-icon":ae[4]})))&&{class:n},ue&32&&ae[5]])),c&&Eu(c.update)&&ue&1&&c.update.call(null,ae[0])},i(ae){g||($i(G,ae),g=!0)},o(ae){ln(G,ae),g=!1},d(ae){ae&&vi(t),G&&G.d(ae),e[9](null),x=!1,Nh(S)}}}function IC(e,t,n){const c=["use","class","getElement"];let g=Ao(t,c),{$$slots:x={},$$scope:S}=t;const a=Sc(vc());let{use:G=[]}=t,{class:W=""}=t,he,ae=Cu("SMUI:list:graphic:menu-selection-group");function ue(){return he}function be(je){pa[je?"unshift":"push"](()=>{he=je,n(2,he)})}return e.$$set=je=>{t=gr(gr({},t),ic(je)),n(5,g=Ao(t,c)),"use"in je&&n(0,G=je.use),"class"in je&&n(1,W=je.class),"$$scope"in je&&n(7,S=je.$$scope)},[G,W,he,a,ae,g,ue,S,x,be]}class EC extends fo{constructor(t){super(),po(this,t,IC,SC,Oa,{use:0,class:1,getElement:6})}get getElement(){return this.$$.ctx[6]}}cp({class:"mdc-deprecated-list-item__meta",tag:"span"});cp({class:"mdc-deprecated-list-group",tag:"div"});cp({class:"mdc-deprecated-list-group__subheader",tag:"h3"});cp({class:"mdc-menu__selection-group-icon",component:EC});function CC(e){let t,n,c,g,x,S,a,G;const W=e[22].default,he=ql(W,e,e[21],null);let ae=[{class:n=Es({[e[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":e[0],"mdc-floating-label--required":e[1],...e[8]})},{style:c=Object.entries(e[9]).map(ix).concat([e[4]]).join(" ")},{for:g=e[5]||(e[11]?e[11].id:void 0)},e[12]],ue={};for(let be=0;be<ae.length;be+=1)ue=gr(ue,ae[be]);return{c(){t=Fn("label"),he&&he.c(),this.h()},l(be){t=On(be,"LABEL",{class:!0,style:!0,for:!0});var je=yn(t);he&&he.l(je),je.forEach(vi),this.h()},h(){sl(t,ue)},m(be,je){Un(be,t,je),he&&he.m(t,null),e[24](t),S=!0,a||(G=[Io(x=mc.call(null,t,e[2])),Io(e[10].call(null,t))],a=!0)},p(be,je){he&&he.p&&(!S||je&2097152)&&Hl(he,W,be,be[21],S?Zl(W,be[21],je,null):jl(be[21]),null),sl(t,ue=ma(ae,[(!S||je&267&&n!==(n=Es({[be[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":be[0],"mdc-floating-label--required":be[1],...be[8]})))&&{class:n},(!S||je&528&&c!==(c=Object.entries(be[9]).map(ix).concat([be[4]]).join(" ")))&&{style:c},(!S||je&32&&g!==(g=be[5]||(be[11]?be[11].id:void 0)))&&{for:g},je&4096&&be[12]])),x&&Eu(x.update)&&je&4&&x.update.call(null,be[2])},i(be){S||($i(he,be),S=!0)},o(be){ln(he,be),S=!1},d(be){be&&vi(t),he&&he.d(be),e[24](null),a=!1,Nh(G)}}}function TC(e){let t,n,c,g,x,S,a;const G=e[22].default,W=ql(G,e,e[21],null);let he=[{class:n=Es({[e[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":e[0],"mdc-floating-label--required":e[1],...e[8]})},{style:c=Object.entries(e[9]).map(tx).concat([e[4]]).join(" ")},e[12]],ae={};for(let ue=0;ue<he.length;ue+=1)ae=gr(ae,he[ue]);return{c(){t=Fn("span"),W&&W.c(),this.h()},l(ue){t=On(ue,"SPAN",{class:!0,style:!0});var be=yn(t);W&&W.l(be),be.forEach(vi),this.h()},h(){sl(t,ae)},m(ue,be){Un(ue,t,be),W&&W.m(t,null),e[23](t),x=!0,S||(a=[Io(g=mc.call(null,t,e[2])),Io(e[10].call(null,t))],S=!0)},p(ue,be){W&&W.p&&(!x||be&2097152)&&Hl(W,G,ue,ue[21],x?Zl(G,ue[21],be,null):jl(ue[21]),null),sl(t,ae=ma(he,[(!x||be&267&&n!==(n=Es({[ue[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":ue[0],"mdc-floating-label--required":ue[1],...ue[8]})))&&{class:n},(!x||be&528&&c!==(c=Object.entries(ue[9]).map(tx).concat([ue[4]]).join(" ")))&&{style:c},be&4096&&ue[12]])),g&&Eu(g.update)&&be&4&&g.update.call(null,ue[2])},i(ue){x||($i(W,ue),x=!0)},o(ue){ln(W,ue),x=!1},d(ue){ue&&vi(t),W&&W.d(ue),e[23](null),S=!1,Nh(a)}}}function kC(e){let t,n,c,g;const x=[TC,CC],S=[];function a(G,W){return G[6]?0:1}return t=a(e),n=S[t]=x[t](e),{c(){n.c(),c=Ls()},l(G){n.l(G),c=Ls()},m(G,W){S[t].m(G,W),Un(G,c,W),g=!0},p(G,[W]){let he=t;t=a(G),t===he?S[t].p(G,W):(zo(),ln(S[he],1,1,()=>{S[he]=null}),Ro(),n=S[t],n?n.p(G,W):(n=S[t]=x[t](G),n.c()),$i(n,1),n.m(c.parentNode,c))},i(G){g||($i(n),g=!0)},o(G){ln(n),g=!1},d(G){G&&vi(c),S[t].d(G)}}}const tx=([e,t])=>`${e}: ${t};`,ix=([e,t])=>`${e}: ${t};`;function MC(e,t,n){const c=["use","class","style","for","floatAbove","required","wrapped","shake","float","setRequired","getWidth","getElement"];let g=Ao(t,c),{$$slots:x={},$$scope:S}=t;var a;const G=Sc(vc());let{use:W=[]}=t,{class:he=""}=t,{style:ae=""}=t,{for:ue=void 0}=t,{floatAbove:be=!1}=t,{required:je=!1}=t,{wrapped:nt=!1}=t,tt,at,ut={},xt={},Tt=(a=Cu("SMUI:generic:input:props"))!==null&&a!==void 0?a:{},Mt=be,Oe=je;xc(()=>{n(18,at=new fE({addClass:jt,removeClass:it,getWidth:()=>{var Ot,gi;const wi=pt(),Ti=wi.cloneNode(!0);(Ot=wi.parentNode)===null||Ot===void 0||Ot.appendChild(Ti),Ti.classList.add("smui-floating-label--remove-transition"),Ti.classList.add("smui-floating-label--force-size"),Ti.classList.remove("mdc-floating-label--float-above");const Ni=Ti.scrollWidth;return(gi=wi.parentNode)===null||gi===void 0||gi.removeChild(Ti),Ni},registerInteractionHandler:(Ot,gi)=>pt().addEventListener(Ot,gi),deregisterInteractionHandler:(Ot,gi)=>pt().removeEventListener(Ot,gi)}));const zt={get element(){return pt()},addStyle:vt,removeStyle:mt};return au(tt,"SMUIFloatingLabel:mount",zt),at.init(),()=>{au(tt,"SMUIFloatingLabel:unmount",zt),at.destroy()}});function jt(zt){ut[zt]||n(8,ut[zt]=!0,ut)}function it(zt){(!(zt in ut)||ut[zt])&&n(8,ut[zt]=!1,ut)}function vt(zt,Ot){xt[zt]!=Ot&&(Ot===""||Ot==null?(delete xt[zt],n(9,xt)):n(9,xt[zt]=Ot,xt))}function mt(zt){zt in xt&&(delete xt[zt],n(9,xt))}function Et(zt){at.shake(zt)}function Pt(zt){n(0,be=zt)}function dt(zt){n(1,je=zt)}function Je(){return at.getWidth()}function pt(){return tt}function lt(zt){pa[zt?"unshift":"push"](()=>{tt=zt,n(7,tt)})}function Nt(zt){pa[zt?"unshift":"push"](()=>{tt=zt,n(7,tt)})}return e.$$set=zt=>{t=gr(gr({},t),ic(zt)),n(12,g=Ao(t,c)),"use"in zt&&n(2,W=zt.use),"class"in zt&&n(3,he=zt.class),"style"in zt&&n(4,ae=zt.style),"for"in zt&&n(5,ue=zt.for),"floatAbove"in zt&&n(0,be=zt.floatAbove),"required"in zt&&n(1,je=zt.required),"wrapped"in zt&&n(6,nt=zt.wrapped),"$$scope"in zt&&n(21,S=zt.$$scope)},e.$$.update=()=>{e.$$.dirty&786433&&at&&Mt!==be&&(n(19,Mt=be),at.float(be)),e.$$.dirty&1310722&&at&&Oe!==je&&(n(20,Oe=je),at.setRequired(je))},[be,je,W,he,ae,ue,nt,tt,ut,xt,G,Tt,g,Et,Pt,dt,Je,pt,at,Mt,Oe,S,x,lt,Nt]}class f3 extends fo{constructor(t){super(),po(this,t,MC,kC,Oa,{use:2,class:3,style:4,for:5,floatAbove:0,required:1,wrapped:6,shake:13,float:14,setRequired:15,getWidth:16,getElement:17})}get shake(){return this.$$.ctx[13]}get float(){return this.$$.ctx[14]}get setRequired(){return this.$$.ctx[15]}get getWidth(){return this.$$.ctx[16]}get getElement(){return this.$$.ctx[17]}}function PC(e){let t,n,c,g,x,S,a=[{class:n=Es({[e[1]]:!0,"mdc-line-ripple":!0,"mdc-line-ripple--active":e[3],...e[5]})},{style:c=Object.entries(e[6]).map(nx).concat([e[2]]).join(" ")},e[8]],G={};for(let W=0;W<a.length;W+=1)G=gr(G,a[W]);return{c(){t=Fn("div"),this.h()},l(W){t=On(W,"DIV",{class:!0,style:!0}),yn(t).forEach(vi),this.h()},h(){sl(t,G)},m(W,he){Un(W,t,he),e[13](t),x||(S=[Io(g=mc.call(null,t,e[0])),Io(e[7].call(null,t))],x=!0)},p(W,[he]){sl(t,G=ma(a,[he&42&&n!==(n=Es({[W[1]]:!0,"mdc-line-ripple":!0,"mdc-line-ripple--active":W[3],...W[5]}))&&{class:n},he&68&&c!==(c=Object.entries(W[6]).map(nx).concat([W[2]]).join(" "))&&{style:c},he&256&&W[8]])),g&&Eu(g.update)&&he&1&&g.update.call(null,W[0])},i:Ra,o:Ra,d(W){W&&vi(t),e[13](null),x=!1,Nh(S)}}}const nx=([e,t])=>`${e}: ${t};`;function DC(e,t,n){const c=["use","class","style","active","activate","deactivate","setRippleCenter","getElement"];let g=Ao(t,c);const x=Sc(vc());let{use:S=[]}=t,{class:a=""}=t,{style:G=""}=t,{active:W=!1}=t,he,ae,ue={},be={};xc(()=>(ae=new dE({addClass:nt,removeClass:tt,hasClass:je,setStyle:at,registerEventHandler:(jt,it)=>Mt().addEventListener(jt,it),deregisterEventHandler:(jt,it)=>Mt().removeEventListener(jt,it)}),ae.init(),()=>{ae.destroy()}));function je(jt){return jt in ue?ue[jt]:Mt().classList.contains(jt)}function nt(jt){ue[jt]||n(5,ue[jt]=!0,ue)}function tt(jt){(!(jt in ue)||ue[jt])&&n(5,ue[jt]=!1,ue)}function at(jt,it){be[jt]!=it&&(it===""||it==null?(delete be[jt],n(6,be)):n(6,be[jt]=it,be))}function ut(){ae.activate()}function xt(){ae.deactivate()}function Tt(jt){ae.setRippleCenter(jt)}function Mt(){return he}function Oe(jt){pa[jt?"unshift":"push"](()=>{he=jt,n(4,he)})}return e.$$set=jt=>{t=gr(gr({},t),ic(jt)),n(8,g=Ao(t,c)),"use"in jt&&n(0,S=jt.use),"class"in jt&&n(1,a=jt.class),"style"in jt&&n(2,G=jt.style),"active"in jt&&n(3,W=jt.active)},[S,a,G,W,he,ue,be,x,g,ut,xt,Tt,Mt,Oe]}class LC extends fo{constructor(t){super(),po(this,t,DC,PC,Oa,{use:0,class:1,style:2,active:3,activate:9,deactivate:10,setRippleCenter:11,getElement:12})}get activate(){return this.$$.ctx[9]}get deactivate(){return this.$$.ctx[10]}get setRippleCenter(){return this.$$.ctx[11]}get getElement(){return this.$$.ctx[12]}}function rx(e){let t,n,c;const g=e[15].default,x=ql(g,e,e[14],null);return{c(){t=Fn("div"),x&&x.c(),this.h()},l(S){t=On(S,"DIV",{class:!0,style:!0});var a=yn(t);x&&x.l(a),a.forEach(vi),this.h()},h(){ki(t,"class","mdc-notched-outline__notch"),ki(t,"style",n=Object.entries(e[7]).map(sx).join(" "))},m(S,a){Un(S,t,a),x&&x.m(t,null),c=!0},p(S,a){x&&x.p&&(!c||a&16384)&&Hl(x,g,S,S[14],c?Zl(g,S[14],a,null):jl(S[14]),null),(!c||a&128&&n!==(n=Object.entries(S[7]).map(sx).join(" ")))&&ki(t,"style",n)},i(S){c||($i(x,S),c=!0)},o(S){ln(x,S),c=!1},d(S){S&&vi(t),x&&x.d(S)}}}function BC(e){let t,n,c,g,x,S,a,G,W,he,ae=!e[3]&&rx(e),ue=[{class:S=Es({[e[1]]:!0,"mdc-notched-outline":!0,"mdc-notched-outline--notched":e[2],"mdc-notched-outline--no-label":e[3],...e[6]})},e[10]],be={};for(let je=0;je<ue.length;je+=1)be=gr(be,ue[je]);return{c(){t=Fn("div"),n=Fn("div"),c=wr(),ae&&ae.c(),g=wr(),x=Fn("div"),this.h()},l(je){t=On(je,"DIV",{class:!0});var nt=yn(t);n=On(nt,"DIV",{class:!0}),yn(n).forEach(vi),c=Sr(nt),ae&&ae.l(nt),g=Sr(nt),x=On(nt,"DIV",{class:!0}),yn(x).forEach(vi),nt.forEach(vi),this.h()},h(){ki(n,"class","mdc-notched-outline__leading"),ki(x,"class","mdc-notched-outline__trailing"),sl(t,be)},m(je,nt){Un(je,t,nt),Hi(t,n),Hi(t,c),ae&&ae.m(t,null),Hi(t,g),Hi(t,x),e[16](t),G=!0,W||(he=[Io(a=mc.call(null,t,e[0])),Io(e[8].call(null,t)),Gl(t,"SMUIFloatingLabel:mount",e[9]),Gl(t,"SMUIFloatingLabel:unmount",e[17])],W=!0)},p(je,[nt]){je[3]?ae&&(zo(),ln(ae,1,1,()=>{ae=null}),Ro()):ae?(ae.p(je,nt),nt&8&&$i(ae,1)):(ae=rx(je),ae.c(),$i(ae,1),ae.m(t,g)),sl(t,be=ma(ue,[(!G||nt&78&&S!==(S=Es({[je[1]]:!0,"mdc-notched-outline":!0,"mdc-notched-outline--notched":je[2],"mdc-notched-outline--no-label":je[3],...je[6]})))&&{class:S},nt&1024&&je[10]])),a&&Eu(a.update)&&nt&1&&a.update.call(null,je[0])},i(je){G||($i(ae),G=!0)},o(je){ln(ae),G=!1},d(je){je&&vi(t),ae&&ae.d(),e[16](null),W=!1,Nh(he)}}}const sx=([e,t])=>`${e}: ${t};`;function zC(e,t,n){const c=["use","class","notched","noLabel","notch","closeNotch","getElement"];let g=Ao(t,c),{$$slots:x={},$$scope:S}=t;const a=Sc(vc());let{use:G=[]}=t,{class:W=""}=t,{notched:he=!1}=t,{noLabel:ae=!1}=t,ue,be,je,nt={},tt={};xc(()=>(be=new kE({addClass:ut,removeClass:xt,setNotchWidthProperty:Et=>Tt("width",Et+"px"),removeNotchWidthProperty:()=>Mt("width")}),be.init(),()=>{be.destroy()}));function at(Et){n(4,je=Et.detail)}function ut(Et){nt[Et]||n(6,nt[Et]=!0,nt)}function xt(Et){(!(Et in nt)||nt[Et])&&n(6,nt[Et]=!1,nt)}function Tt(Et,Pt){tt[Et]!=Pt&&(Pt===""||Pt==null?(delete tt[Et],n(7,tt)):n(7,tt[Et]=Pt,tt))}function Mt(Et){Et in tt&&(delete tt[Et],n(7,tt))}function Oe(Et){be.notch(Et)}function jt(){be.closeNotch()}function it(){return ue}function vt(Et){pa[Et?"unshift":"push"](()=>{ue=Et,n(5,ue)})}const mt=()=>n(4,je=void 0);return e.$$set=Et=>{t=gr(gr({},t),ic(Et)),n(10,g=Ao(t,c)),"use"in Et&&n(0,G=Et.use),"class"in Et&&n(1,W=Et.class),"notched"in Et&&n(2,he=Et.notched),"noLabel"in Et&&n(3,ae=Et.noLabel),"$$scope"in Et&&n(14,S=Et.$$scope)},e.$$.update=()=>{e.$$.dirty&16&&(je?(je.addStyle("transition-duration","0s"),ut("mdc-notched-outline--upgraded"),requestAnimationFrame(()=>{je&&je.removeStyle("transition-duration")})):xt("mdc-notched-outline--upgraded"))},[G,W,he,ae,je,ue,nt,tt,a,at,g,Oe,jt,it,S,x,vt,mt]}class RC extends fo{constructor(t){super(),po(this,t,zC,BC,Oa,{use:0,class:1,notched:2,noLabel:3,notch:11,closeNotch:12,getElement:13})}get notch(){return this.$$.ctx[11]}get closeNotch(){return this.$$.ctx[12]}get getElement(){return this.$$.ctx[13]}}function FC(e){let t;return{c(){t=to(e[8])},l(n){t=io(n,e[8])},m(n,c){Un(n,t,c)},p(n,c){c&256&&su(t,n[8])},i:Ra,o:Ra,d(n){n&&vi(t)}}}function OC(e){let t;const n=e[13].default,c=ql(n,e,e[12],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,x){c&&c.m(g,x),t=!0},p(g,x){c&&c.p&&(!t||x&4096)&&Hl(c,n,g,g[12],t?Zl(n,g[12],x,null):jl(g[12]),null)},i(g){t||($i(c,g),t=!0)},o(g){ln(c,g),t=!1},d(g){c&&c.d(g)}}}function NC(e){let t,n,c,g,x,S,a,G,W;const he=[OC,FC],ae=[];function ue(nt,tt){return nt[8]==null?0:1}n=ue(e),c=ae[n]=he[n](e);let be=[{class:g=Es({[e[1]]:!0,"mdc-select-helper-text":!0,"mdc-select-helper-text--validation-msg":e[4],"mdc-select-helper-text--validation-msg-persistent":e[3],...e[6]})},{"aria-hidden":x=e[3]?void 0:"true"},{id:e[2]},e[7],e[10]],je={};for(let nt=0;nt<be.length;nt+=1)je=gr(je,be[nt]);return{c(){t=Fn("div"),c.c(),this.h()},l(nt){t=On(nt,"DIV",{class:!0,"aria-hidden":!0,id:!0});var tt=yn(t);c.l(tt),tt.forEach(vi),this.h()},h(){sl(t,je)},m(nt,tt){Un(nt,t,tt),ae[n].m(t,null),e[14](t),a=!0,G||(W=[Io(S=mc.call(null,t,e[0])),Io(e[9].call(null,t))],G=!0)},p(nt,[tt]){let at=n;n=ue(nt),n===at?ae[n].p(nt,tt):(zo(),ln(ae[at],1,1,()=>{ae[at]=null}),Ro(),c=ae[n],c?c.p(nt,tt):(c=ae[n]=he[n](nt),c.c()),$i(c,1),c.m(t,null)),sl(t,je=ma(be,[(!a||tt&90&&g!==(g=Es({[nt[1]]:!0,"mdc-select-helper-text":!0,"mdc-select-helper-text--validation-msg":nt[4],"mdc-select-helper-text--validation-msg-persistent":nt[3],...nt[6]})))&&{class:g},(!a||tt&8&&x!==(x=nt[3]?void 0:"true"))&&{"aria-hidden":x},(!a||tt&4)&&{id:nt[2]},tt&128&&nt[7],tt&1024&&nt[10]])),S&&Eu(S.update)&&tt&1&&S.update.call(null,nt[0])},i(nt){a||($i(c),a=!0)},o(nt){ln(c),a=!1},d(nt){nt&&vi(t),ae[n].d(),e[14](null),G=!1,Nh(W)}}}let VC=0;function UC(e,t,n){const c=["use","class","id","persistent","validationMsg","getElement"];let g=Ao(t,c),{$$slots:x={},$$scope:S}=t;const a=Sc(vc());let{use:G=[]}=t,{class:W=""}=t,{id:he="SMUI-select-helper-text-"+VC++}=t,{persistent:ae=!1}=t,{validationMsg:ue=!1}=t,be,je,nt={},tt={},at;xc(()=>(je=new NE({addClass:xt,removeClass:Tt,hasClass:ut,getAttr:Mt,setAttr:Oe,removeAttr:jt,setContent:mt=>{n(8,at=mt)}}),he.startsWith("SMUI-select-helper-text-")&&au(it(),"SMUISelectHelperText:id",he),au(it(),"SMUISelectHelperText:mount",je),je.init(),()=>{au(it(),"SMUISelectHelperText:unmount",je),je.destroy()}));function ut(mt){return mt in nt?nt[mt]:it().classList.contains(mt)}function xt(mt){nt[mt]||n(6,nt[mt]=!0,nt)}function Tt(mt){(!(mt in nt)||nt[mt])&&n(6,nt[mt]=!1,nt)}function Mt(mt){var Et;return mt in tt?(Et=tt[mt])!==null&&Et!==void 0?Et:null:it().getAttribute(mt)}function Oe(mt,Et){tt[mt]!==Et&&n(7,tt[mt]=Et,tt)}function jt(mt){(!(mt in tt)||tt[mt]!=null)&&n(7,tt[mt]=void 0,tt)}function it(){return be}function vt(mt){pa[mt?"unshift":"push"](()=>{be=mt,n(5,be)})}return e.$$set=mt=>{t=gr(gr({},t),ic(mt)),n(10,g=Ao(t,c)),"use"in mt&&n(0,G=mt.use),"class"in mt&&n(1,W=mt.class),"id"in mt&&n(2,he=mt.id),"persistent"in mt&&n(3,ae=mt.persistent),"validationMsg"in mt&&n(4,ue=mt.validationMsg),"$$scope"in mt&&n(12,S=mt.$$scope)},[G,W,he,ae,ue,be,nt,tt,at,a,g,it,S,x,vt]}class GC extends fo{constructor(t){super(),po(this,t,UC,NC,Oa,{use:0,class:1,id:2,persistent:3,validationMsg:4,getElement:11})}get getElement(){return this.$$.ctx[11]}}const qC=e=>({}),ax=e=>({}),HC=e=>({}),ox=e=>({}),jC=e=>({}),lx=e=>({}),ZC=e=>({}),ux=e=>({});function cx(e){let t,n=[{type:"hidden"},{required:e[10]},{disabled:e[6]},{value:e[0]},wl(e[53],"input$")],c={};for(let g=0;g<n.length;g+=1)c=gr(c,n[g]);return{c(){t=Fn("input"),this.h()},l(g){t=On(g,"INPUT",{type:!0}),this.h()},h(){sl(t,c)},m(g,x){Un(g,t,x),t.autofocus&&t.focus()},p(g,x){sl(t,c=ma(n,[{type:"hidden"},x[0]&1024&&{required:g[10]},x[0]&64&&{disabled:g[6]},x[0]&1&&{value:g[0]},x[1]&4194304&&wl(g[53],"input$")]))},d(g){g&&vi(t)}}}function hx(e){let t;return{c(){t=Fn("span"),this.h()},l(n){t=On(n,"SPAN",{class:!0}),yn(t).forEach(vi),this.h()},h(){ki(t,"class","mdc-select__ripple")},m(n,c){Un(n,t,c)},d(n){n&&vi(t)}}}function Ax(e){let t,n;const c=[{id:e[11]+"-smui-label"},{floatAbove:e[42]!==""},{required:e[10]},wl(e[53],"label$")];let g={$$slots:{default:[QC]},$$scope:{ctx:e}};for(let x=0;x<c.length;x+=1)g=gr(g,c[x]);return t=new f3({props:g}),e[67](t),{c(){ls(t.$$.fragment)},l(x){Ds(t.$$.fragment,x)},m(x,S){us(t,x,S),n=!0},p(x,S){const a=S[0]&3072|S[1]&4196352?ma(c,[S[0]&2048&&{id:x[11]+"-smui-label"},S[1]&2048&&{floatAbove:x[42]!==""},S[0]&1024&&{required:x[10]},S[1]&4194304&&Os(wl(x[53],"label$"))]):{};S[0]&512|S[2]&33554432&&(a.$$scope={dirty:S,ctx:x}),t.$set(a)},i(x){n||($i(t.$$.fragment,x),n=!0)},o(x){ln(t.$$.fragment,x),n=!1},d(x){e[67](null),cs(t,x)}}}function QC(e){let t=(e[9]==null?"":e[9])+"",n,c;const g=e[64].label,x=ql(g,e,e[87],ux);return{c(){n=to(t),x&&x.c()},l(S){n=io(S,t),x&&x.l(S)},m(S,a){Un(S,n,a),x&&x.m(S,a),c=!0},p(S,a){(!c||a[0]&512)&&t!==(t=(S[9]==null?"":S[9])+"")&&su(n,t),x&&x.p&&(!c||a[2]&33554432)&&Hl(x,g,S,S[87],c?Zl(g,S[87],a,ZC):jl(S[87]),ux)},i(S){c||($i(x,S),c=!0)},o(S){ln(x,S),c=!1},d(S){S&&vi(n),x&&x.d(S)}}}function fx(e){let t,n;const c=[{noLabel:e[8]||e[9]==null&&!e[54].label},wl(e[53],"outline$")];let g={$$slots:{default:[$C]},$$scope:{ctx:e}};for(let x=0;x<c.length;x+=1)g=gr(g,c[x]);return t=new RC({props:g}),e[69](t),{c(){ls(t.$$.fragment)},l(x){Ds(t.$$.fragment,x)},m(x,S){us(t,x,S),n=!0},p(x,S){const a=S[0]&768|S[1]&12582912?ma(c,[S[0]&768|S[1]&8388608&&{noLabel:x[8]||x[9]==null&&!x[54].label},S[1]&4194304&&Os(wl(x[53],"outline$"))]):{};S[0]&3840|S[1]&12585216|S[2]&33554432&&(a.$$scope={dirty:S,ctx:x}),t.$set(a)},i(x){n||($i(t.$$.fragment,x),n=!0)},o(x){ln(t.$$.fragment,x),n=!1},d(x){e[69](null),cs(t,x)}}}function dx(e){let t,n;const c=[{id:e[11]+"-smui-label"},{floatAbove:e[42]!==""},{required:e[10]},wl(e[53],"label$")];let g={$$slots:{default:[WC]},$$scope:{ctx:e}};for(let x=0;x<c.length;x+=1)g=gr(g,c[x]);return t=new f3({props:g}),e[68](t),{c(){ls(t.$$.fragment)},l(x){Ds(t.$$.fragment,x)},m(x,S){us(t,x,S),n=!0},p(x,S){const a=S[0]&3072|S[1]&4196352?ma(c,[S[0]&2048&&{id:x[11]+"-smui-label"},S[1]&2048&&{floatAbove:x[42]!==""},S[0]&1024&&{required:x[10]},S[1]&4194304&&Os(wl(x[53],"label$"))]):{};S[0]&512|S[2]&33554432&&(a.$$scope={dirty:S,ctx:x}),t.$set(a)},i(x){n||($i(t.$$.fragment,x),n=!0)},o(x){ln(t.$$.fragment,x),n=!1},d(x){e[68](null),cs(t,x)}}}function WC(e){let t=(e[9]==null?"":e[9])+"",n,c;const g=e[64].label,x=ql(g,e,e[87],lx);return{c(){n=to(t),x&&x.c()},l(S){n=io(S,t),x&&x.l(S)},m(S,a){Un(S,n,a),x&&x.m(S,a),c=!0},p(S,a){(!c||a[0]&512)&&t!==(t=(S[9]==null?"":S[9])+"")&&su(n,t),x&&x.p&&(!c||a[2]&33554432)&&Hl(x,g,S,S[87],c?Zl(g,S[87],a,jC):jl(S[87]),lx)},i(S){c||($i(x,S),c=!0)},o(S){ln(x,S),c=!1},d(S){S&&vi(n),x&&x.d(S)}}}function $C(e){let t,n,c=!e[8]&&(e[9]!=null||e[54].label)&&dx(e);return{c(){c&&c.c(),t=Ls()},l(g){c&&c.l(g),t=Ls()},m(g,x){c&&c.m(g,x),Un(g,t,x),n=!0},p(g,x){!g[8]&&(g[9]!=null||g[54].label)?c?(c.p(g,x),x[0]&768|x[1]&8388608&&$i(c,1)):(c=dx(g),c.c(),$i(c,1),c.m(t.parentNode,t)):c&&(zo(),ln(c,1,1,()=>{c=null}),Ro())},i(g){n||($i(c),n=!0)},o(g){ln(c),n=!1},d(g){g&&vi(t),c&&c.d(g)}}}function px(e){let t,n;const c=[wl(e[53],"ripple$")];let g={};for(let x=0;x<c.length;x+=1)g=gr(g,c[x]);return t=new LC({props:g}),e[70](t),{c(){ls(t.$$.fragment)},l(x){Ds(t.$$.fragment,x)},m(x,S){us(t,x,S),n=!0},p(x,S){const a=S[1]&4194304?ma(c,[Os(wl(x[53],"ripple$"))]):{};t.$set(a)},i(x){n||($i(t.$$.fragment,x),n=!0)},o(x){ln(t.$$.fragment,x),n=!1},d(x){e[70](null),cs(t,x)}}}function XC(e){let t;const n=e[64].default,c=ql(n,e,e[87],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,x){c&&c.m(g,x),t=!0},p(g,x){c&&c.p&&(!t||x[2]&33554432)&&Hl(c,n,g,g[87],t?Zl(n,g[87],x,null):jl(g[87]),null)},i(g){t||($i(c,g),t=!0)},o(g){ln(c,g),t=!1},d(g){c&&c.d(g)}}}function YC(e){let t,n,c;const g=[{role:"listbox"},{wrapFocus:e[35]},wl(e[53],"list$")];function x(a){e[75](a)}let S={$$slots:{default:[XC]},$$scope:{ctx:e}};for(let a=0;a<g.length;a+=1)S=gr(S,g[a]);return e[24]!==void 0&&(S.selectedIndex=e[24]),t=new _C({props:S}),pa.push(()=>N0(t,"selectedIndex",x)),t.$on("SMUIList:mount",e[76]),{c(){ls(t.$$.fragment)},l(a){Ds(t.$$.fragment,a)},m(a,G){us(t,a,G),c=!0},p(a,G){const W=G[1]&4194320?ma(g,[g[0],G[1]&16&&{wrapFocus:a[35]},G[1]&4194304&&Os(wl(a[53],"list$"))]):{};G[2]&33554432&&(W.$$scope={dirty:G,ctx:a}),!n&&G[0]&16777216&&(n=!0,W.selectedIndex=a[24],O0(()=>n=!1)),t.$set(W)},i(a){c||($i(t.$$.fragment,a),c=!0)},o(a){ln(t.$$.fragment,a),c=!1},d(a){cs(t,a)}}}function mx(e){let t,n;const c=[wl(e[53],"helperText$")];let g={$$slots:{default:[KC]},$$scope:{ctx:e}};for(let x=0;x<c.length;x+=1)g=gr(g,c[x]);return t=new GC({props:g}),t.$on("SMUISelectHelperText:id",e[84]),t.$on("SMUISelectHelperText:mount",e[85]),t.$on("SMUISelectHelperText:unmount",e[86]),{c(){ls(t.$$.fragment)},l(x){Ds(t.$$.fragment,x)},m(x,S){us(t,x,S),n=!0},p(x,S){const a=S[1]&4194304?ma(c,[Os(wl(x[53],"helperText$"))]):{};S[2]&33554432&&(a.$$scope={dirty:S,ctx:x}),t.$set(a)},i(x){n||($i(t.$$.fragment,x),n=!0)},o(x){ln(t.$$.fragment,x),n=!1},d(x){cs(t,x)}}}function KC(e){let t;const n=e[64].helperText,c=ql(n,e,e[87],ax);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,x){c&&c.m(g,x),t=!0},p(g,x){c&&c.p&&(!t||x[2]&33554432)&&Hl(c,n,g,g[87],t?Zl(n,g[87],x,qC):jl(g[87]),ax)},i(g){t||($i(c,g),t=!0)},o(g){ln(c,g),t=!1},d(g){c&&c.d(g)}}}function JC(e){let t,n,c,g,x,S,a,G,W,he,ae,ue,be,je,nt,tt,at,ut,xt,Tt,Mt,Oe,jt,it,vt,mt,Et,Pt,dt,Je,pt,lt,Nt,zt,Ot,gi,wi,Ti,Ni,en,ji,Vi=e[12]&&cx(e),nn=e[7]==="filled"&&hx(),vn=e[7]!=="outlined"&&!e[8]&&(e[9]!=null||e[54].label)&&Ax(e),Ci=e[7]==="outlined"&&fx(e);const mi=e[64].leadingIcon,Ri=ql(mi,e,e[87],ox);let Oi=[{id:ae=e[11]+"-smui-selected-text"},{class:ue=Es({[e[19]]:!0,"mdc-select__selected-text":!0})},{role:"button"},{"aria-haspopup":"listbox"},{"aria-labelledby":be=e[11]+"-smui-label"},wl(e[53],"selectedText$")],_i={};for(let k=0;k<Oi.length;k+=1)_i=gr(_i,Oi[k]);let Ji=[{class:nt=Es({[e[17]]:!0,"mdc-select__selected-text-container":!0})},wl(e[53],"selectedTextContainer$")],Ai={};for(let k=0;k<Ji.length;k+=1)Ai=gr(Ai,Ji[k]);let sn=[{class:Oe=Es({[e[21]]:!0,"mdc-select__dropdown-icon":!0})},wl(e[53],"dropdownIcon$")],ei={};for(let k=0;k<sn.length;k+=1)ei=gr(ei,sn[k]);let _n=e[7]!=="outlined"&&e[5]&&px(e),Pr=[{class:vt=Es({[e[15]]:!0,"mdc-select__anchor":!0})},{"aria-required":mt=e[10]?"true":void 0},{"aria-disabled":Et=e[6]?"true":void 0},{"aria-controls":e[45]},{"aria-expanded":Pt=e[31]?"true":"false"},{"aria-describedby":e[30]},{role:"combobox"},{tabindex:"0"},e[29],wl(e[53],"anchor$")],ci={};for(let k=0;k<Pr.length;k+=1)ci=gr(ci,Pr[k]);const rn=[{class:Es({[e[22]]:!0,"mdc-select__menu":!0,...e[32]})},{id:e[45]},{fullWidth:!0},{anchor:!1},{anchorElement:e[33]},{anchorCorner:e[34]},wl(e[53],"menu$")];function tr(k){e[77](k)}let Pn={$$slots:{default:[YC]},$$scope:{ctx:e}};for(let k=0;k<rn.length;k+=1)Pn=gr(Pn,rn[k]);e[31]!==void 0&&(Pn.open=e[31]),pt=new tC({props:Pn}),pa.push(()=>N0(pt,"open",tr)),pt.$on("SMUIMenu:selected",e[78]),pt.$on("SMUIMenuSurface:closing",e[79]),pt.$on("SMUIMenuSurface:closed",e[80]),pt.$on("SMUIMenuSurface:opened",e[81]);let Qn=[{class:Nt=Es({[e[3]]:!0,"mdc-select":!0,"mdc-select--required":e[10],"mdc-select--disabled":e[6],"mdc-select--filled":e[7]==="filled","mdc-select--outlined":e[7]==="outlined","smui-select--standard":e[7]==="standard","mdc-select--with-leading-icon":e[44](e[13])?e[54].leadingIcon:e[13],"mdc-select--no-label":e[8]||e[9]==null&&!e[54].label,"mdc-select--invalid":e[1],"mdc-select--activated":e[31],"mdc-data-table__pagination-rows-per-page-select":e[46]==="data-table:pagination",...e[26]})},{style:zt=Object.entries(e[27]).map(gx).concat([e[4]]).join(" ")},$2(e[53],["input$","anchor$","label$","outline$","selectedTextContainer$","selectedText$","dropdownIcon$","ripple$","menu$","list$","helperText$"])],In={};for(let k=0;k<Qn.length;k+=1)In=gr(In,Qn[k]);let v=e[54].helperText&&mx(e);return{c(){t=Fn("div"),Vi&&Vi.c(),n=wr(),c=Fn("div"),nn&&nn.c(),g=wr(),vn&&vn.c(),x=wr(),Ci&&Ci.c(),S=wr(),Ri&&Ri.c(),a=wr(),G=Fn("span"),W=Fn("span"),he=to(e[42]),at=wr(),ut=Fn("span"),xt=Ba("svg"),Tt=Ba("polygon"),Mt=Ba("polygon"),it=wr(),_n&&_n.c(),Je=wr(),ls(pt.$$.fragment),wi=wr(),v&&v.c(),Ti=Ls(),this.h()},l(k){t=On(k,"DIV",{class:!0,style:!0});var V=yn(t);Vi&&Vi.l(V),n=Sr(V),c=On(V,"DIV",{class:!0,"aria-required":!0,"aria-disabled":!0,"aria-controls":!0,"aria-expanded":!0,"aria-describedby":!0,role:!0,tabindex:!0});var Y=yn(c);nn&&nn.l(Y),g=Sr(Y),vn&&vn.l(Y),x=Sr(Y),Ci&&Ci.l(Y),S=Sr(Y),Ri&&Ri.l(Y),a=Sr(Y),G=On(Y,"SPAN",{class:!0});var te=yn(G);W=On(te,"SPAN",{id:!0,class:!0,role:!0,"aria-haspopup":!0,"aria-labelledby":!0});var fe=yn(W);he=io(fe,e[42]),fe.forEach(vi),te.forEach(vi),at=Sr(Y),ut=On(Y,"SPAN",{class:!0});var ve=yn(ut);xt=za(ve,"svg",{class:!0,viewBox:!0,focusable:!0});var Ie=yn(xt);Tt=za(Ie,"polygon",{class:!0,stroke:!0,"fill-rule":!0,points:!0}),yn(Tt).forEach(vi),Mt=za(Ie,"polygon",{class:!0,stroke:!0,"fill-rule":!0,points:!0}),yn(Mt).forEach(vi),Ie.forEach(vi),ve.forEach(vi),it=Sr(Y),_n&&_n.l(Y),Y.forEach(vi),Je=Sr(V),Ds(pt.$$.fragment,V),V.forEach(vi),wi=Sr(k),v&&v.l(k),Ti=Ls(),this.h()},h(){sl(W,_i),sl(G,Ai),ki(Tt,"class","mdc-select__dropdown-icon-inactive"),ki(Tt,"stroke","none"),ki(Tt,"fill-rule","evenodd"),ki(Tt,"points","7 10 12 15 17 10"),ki(Mt,"class","mdc-select__dropdown-icon-active"),ki(Mt,"stroke","none"),ki(Mt,"fill-rule","evenodd"),ki(Mt,"points","7 15 12 10 17 15"),ki(xt,"class","mdc-select__dropdown-icon-graphic"),ki(xt,"viewBox","7 10 10 5"),ki(xt,"focusable","false"),sl(ut,ei),sl(c,ci),sl(t,In)},m(k,V){Un(k,t,V),Vi&&Vi.m(t,null),Hi(t,n),Hi(t,c),nn&&nn.m(c,null),Hi(c,g),vn&&vn.m(c,null),Hi(c,x),Ci&&Ci.m(c,null),Hi(c,S),Ri&&Ri.m(c,null),Hi(c,a),Hi(c,G),Hi(G,W),Hi(W,he),Hi(c,at),Hi(c,ut),Hi(ut,xt),Hi(xt,Tt),Hi(xt,Mt),Hi(c,it),_n&&_n.m(c,null),e[71](c),Hi(t,Je),us(pt,t,null),e[82](t),Un(k,wi,V),v&&v.m(k,V),Un(k,Ti,V),Ni=!0,en||(ji=[Io(je=mc.call(null,W,e[18])),Io(tt=mc.call(null,G,e[16])),Io(jt=mc.call(null,ut,e[20])),Io(dt=mc.call(null,c,e[14])),Gl(c,"focus",e[72]),Gl(c,"blur",e[73]),Gl(c,"click",e[74]),Gl(c,"keydown",function(){Eu(e[23]&&e[23].handleKeydown.bind(e[23]))&&(e[23]&&e[23].handleKeydown.bind(e[23])).apply(this,arguments)}),Gl(c,"focus",e[65]),Gl(c,"blur",e[66]),Io(Ot=$d.call(null,t,{ripple:e[7]==="filled",unbounded:!1,addClass:e[50],removeClass:e[51],addStyle:e[52]})),Io(YE.call(null,t,{addClass:e[50],removeClass:e[51]})),Io(gi=mc.call(null,t,e[2])),Io(e[43].call(null,t)),Gl(t,"SMUISelectLeadingIcon:mount",e[49]),Gl(t,"SMUISelectLeadingIcon:unmount",e[83])],en=!0)},p(k,V){e=k,e[12]?Vi?Vi.p(e,V):(Vi=cx(e),Vi.c(),Vi.m(t,n)):Vi&&(Vi.d(1),Vi=null),e[7]==="filled"?nn||(nn=hx(),nn.c(),nn.m(c,g)):nn&&(nn.d(1),nn=null),e[7]!=="outlined"&&!e[8]&&(e[9]!=null||e[54].label)?vn?(vn.p(e,V),V[0]&896|V[1]&8388608&&$i(vn,1)):(vn=Ax(e),vn.c(),$i(vn,1),vn.m(c,x)):vn&&(zo(),ln(vn,1,1,()=>{vn=null}),Ro()),e[7]==="outlined"?Ci?(Ci.p(e,V),V[0]&128&&$i(Ci,1)):(Ci=fx(e),Ci.c(),$i(Ci,1),Ci.m(c,S)):Ci&&(zo(),ln(Ci,1,1,()=>{Ci=null}),Ro()),Ri&&Ri.p&&(!Ni||V[2]&33554432)&&Hl(Ri,mi,e,e[87],Ni?Zl(mi,e[87],V,HC):jl(e[87]),ox),(!Ni||V[1]&2048)&&sE(he,e[42],_i.contenteditable),sl(W,_i=ma(Oi,[(!Ni||V[0]&2048&&ae!==(ae=e[11]+"-smui-selected-text"))&&{id:ae},(!Ni||V[0]&524288&&ue!==(ue=Es({[e[19]]:!0,"mdc-select__selected-text":!0})))&&{class:ue},{role:"button"},{"aria-haspopup":"listbox"},(!Ni||V[0]&2048&&be!==(be=e[11]+"-smui-label"))&&{"aria-labelledby":be},V[1]&4194304&&wl(e[53],"selectedText$")])),je&&Eu(je.update)&&V[0]&262144&&je.update.call(null,e[18]),sl(G,Ai=ma(Ji,[(!Ni||V[0]&131072&&nt!==(nt=Es({[e[17]]:!0,"mdc-select__selected-text-container":!0})))&&{class:nt},V[1]&4194304&&wl(e[53],"selectedTextContainer$")])),tt&&Eu(tt.update)&&V[0]&65536&&tt.update.call(null,e[16]),sl(ut,ei=ma(sn,[(!Ni||V[0]&2097152&&Oe!==(Oe=Es({[e[21]]:!0,"mdc-select__dropdown-icon":!0})))&&{class:Oe},V[1]&4194304&&wl(e[53],"dropdownIcon$")])),jt&&Eu(jt.update)&&V[0]&1048576&&jt.update.call(null,e[20]),e[7]!=="outlined"&&e[5]?_n?(_n.p(e,V),V[0]&160&&$i(_n,1)):(_n=px(e),_n.c(),$i(_n,1),_n.m(c,null)):_n&&(zo(),ln(_n,1,1,()=>{_n=null}),Ro()),sl(c,ci=ma(Pr,[(!Ni||V[0]&32768&&vt!==(vt=Es({[e[15]]:!0,"mdc-select__anchor":!0})))&&{class:vt},(!Ni||V[0]&1024&&mt!==(mt=e[10]?"true":void 0))&&{"aria-required":mt},(!Ni||V[0]&64&&Et!==(Et=e[6]?"true":void 0))&&{"aria-disabled":Et},{"aria-controls":e[45]},(!Ni||V[1]&1&&Pt!==(Pt=e[31]?"true":"false"))&&{"aria-expanded":Pt},(!Ni||V[0]&1073741824)&&{"aria-describedby":e[30]},{role:"combobox"},{tabindex:"0"},V[0]&536870912&&e[29],V[1]&4194304&&wl(e[53],"anchor$")])),dt&&Eu(dt.update)&&V[0]&16384&&dt.update.call(null,e[14]);const Y=V[0]&4194304|V[1]&4210702?ma(rn,[V[0]&4194304|V[1]&2&&{class:Es({[e[22]]:!0,"mdc-select__menu":!0,...e[32]})},V[1]&16384&&{id:e[45]},rn[2],rn[3],V[1]&4&&{anchorElement:e[33]},V[1]&8&&{anchorCorner:e[34]},V[1]&4194304&&Os(wl(e[53],"menu$"))]):{};V[0]&16777216|V[1]&4194352|V[2]&33554432&&(Y.$$scope={dirty:V,ctx:e}),!lt&&V[1]&1&&(lt=!0,Y.open=e[31],O0(()=>lt=!1)),pt.$set(Y),sl(t,In=ma(Qn,[(!Ni||V[0]&67119050|V[1]&8388609&&Nt!==(Nt=Es({[e[3]]:!0,"mdc-select":!0,"mdc-select--required":e[10],"mdc-select--disabled":e[6],"mdc-select--filled":e[7]==="filled","mdc-select--outlined":e[7]==="outlined","smui-select--standard":e[7]==="standard","mdc-select--with-leading-icon":e[44](e[13])?e[54].leadingIcon:e[13],"mdc-select--no-label":e[8]||e[9]==null&&!e[54].label,"mdc-select--invalid":e[1],"mdc-select--activated":e[31],"mdc-data-table__pagination-rows-per-page-select":e[46]==="data-table:pagination",...e[26]})))&&{class:Nt},(!Ni||V[0]&134217744&&zt!==(zt=Object.entries(e[27]).map(gx).concat([e[4]]).join(" ")))&&{style:zt},V[1]&4194304&&$2(e[53],["input$","anchor$","label$","outline$","selectedTextContainer$","selectedText$","dropdownIcon$","ripple$","menu$","list$","helperText$"])])),Ot&&Eu(Ot.update)&&V[0]&128&&Ot.update.call(null,{ripple:e[7]==="filled",unbounded:!1,addClass:e[50],removeClass:e[51],addStyle:e[52]}),gi&&Eu(gi.update)&&V[0]&4&&gi.update.call(null,e[2]),e[54].helperText?v?(v.p(e,V),V[1]&8388608&&$i(v,1)):(v=mx(e),v.c(),$i(v,1),v.m(Ti.parentNode,Ti)):v&&(zo(),ln(v,1,1,()=>{v=null}),Ro())},i(k){Ni||($i(vn),$i(Ci),$i(Ri,k),$i(_n),$i(pt.$$.fragment,k),$i(v),Ni=!0)},o(k){ln(vn),ln(Ci),ln(Ri,k),ln(_n),ln(pt.$$.fragment,k),ln(v),Ni=!1},d(k){k&&(vi(t),vi(wi),vi(Ti)),Vi&&Vi.d(),nn&&nn.d(),vn&&vn.d(),Ci&&Ci.d(),Ri&&Ri.d(k),_n&&_n.d(),e[71](null),cs(pt),e[82](null),v&&v.d(k),en=!1,Nh(ji)}}}let eT=0;function tT(e){const t=e.currentTarget.getBoundingClientRect();return(iT(e)?e.touches[0].clientX:e.clientX)-t.left}function iT(e){return"touches"in e}const gx=([e,t])=>`${e}: ${t};`;function nT(e,t,n){const c=["use","class","style","ripple","disabled","variant","noLabel","label","value","key","dirty","invalid","updateInvalid","required","inputId","hiddenInput","withLeadingIcon","anchor$use","anchor$class","selectedTextContainer$use","selectedTextContainer$class","selectedText$use","selectedText$class","dropdownIcon$use","dropdownIcon$class","menu$class","getUseDefaultValidation","setUseDefaultValidation","focus","layout","getElement"];let g=Ao(t,c),x,S,{$$slots:a={},$$scope:G}=t;const W=nE(a);var he;const ae=Sc(vc());let ue=()=>{};function be(Yt){return Yt===ue}let{use:je=[]}=t,{class:nt=""}=t,{style:tt=""}=t,{ripple:at=!0}=t,{disabled:ut=!1}=t,{variant:xt="standard"}=t,{noLabel:Tt=!1}=t,{label:Mt=void 0}=t,{value:Oe=""}=t,{key:jt=Yt=>Yt}=t,{dirty:it=!1}=t,{invalid:vt=ue}=t,{updateInvalid:mt=be(vt)}=t;const Et=be(vt);be(vt)&&(vt=!1);let{required:Pt=!1}=t,{inputId:dt="SMUI-select-"+eT++}=t,{hiddenInput:Je=!1}=t,{withLeadingIcon:pt=ue}=t,{anchor$use:lt=[]}=t,{anchor$class:Nt=""}=t,{selectedTextContainer$use:zt=[]}=t,{selectedTextContainer$class:Ot=""}=t,{selectedText$use:gi=[]}=t,{selectedText$class:wi=""}=t,{dropdownIcon$use:Ti=[]}=t,{dropdownIcon$class:Ni=""}=t,{menu$class:en=""}=t,ji,Vi,nn={},vn={},Ci,mi={},Ri=-1,Oi=(he=g.menu$id)!==null&&he!==void 0?he:dt+"-menu",_i,Ji=Cu("SMUI:addLayoutListener"),Ai,sn=!1,ei={},_n,Pr,ci=!1,rn,tr=Cu("SMUI:select:context"),Pn,Qn,In,v,k;du("SMUI:list:role",""),du("SMUI:list:nav",!1);const V=V0("");tc(e,V,Yt=>n(42,x=Yt)),du("SMUI:select:selectedText",V);const Y=V0(Oe);tc(e,Y,Yt=>n(90,S=Yt)),du("SMUI:select:value",Y);let te=Ri;Ji&&(Ai=Ji($)),xc(()=>(n(23,Vi=new OE({setSelectedText:Yt=>{om(V,x=Yt,x)},isSelectAnchorFocused:()=>document.activeElement===Ci,getSelectAnchorAttr:Qe,setSelectAnchorAttr:Ue,removeSelectAnchorAttr:ft,addMenuClass:We,removeMenuClass:He,openMenu:()=>{n(31,sn=!0)},closeMenu:()=>{n(31,sn=!1)},getAnchorElement:()=>Ci,setMenuAnchorElement:Yt=>{n(33,_n=Yt)},setMenuAnchorCorner:Yt=>{n(34,Pr=Yt)},setMenuWrapFocus:Yt=>{n(35,ci=Yt)},getSelectedIndex:()=>Ri,setSelectedIndex:Yt=>{n(63,te=Yt),n(24,Ri=Yt),n(0,Oe=st()[Ri])},focusMenuItemAtIndex:Yt=>{rn.focusItemAtIndex(Yt)},getMenuItemCount:()=>rn.items.length,getMenuItemValues:()=>st().map(jt),getMenuItemTextAtIndex:Yt=>rn.getPrimaryTextAtIndex(Yt),isTypeaheadInProgress:()=>rn.typeaheadInProgress,typeaheadMatchItem:(Yt,bn)=>rn.typeaheadMatchItem(Yt,bn),addClass:Ie,removeClass:Ee,hasClass:ve,setRippleCenter:Yt=>v&&v.setRippleCenter(Yt),activateBottomLine:()=>v&&v.activate(),deactivateBottomLine:()=>v&&v.deactivate(),notifyChange:Yt=>{n(55,it=!0),mt&&n(1,vt=!Vi.isValid()),au(ie(),"SMUISelect:change",{value:Oe,index:Ri},void 0,!0)},hasOutline:()=>!!k,notchOutline:Yt=>k&&k.notch(Yt),closeOutline:()=>k&&k.closeNotch(),hasLabel:()=>!!In,floatLabel:Yt=>In&&In.float(Yt),getLabelWidth:()=>In?In.getWidth():0,setLabelRequired:Yt=>In&&In.setRequired(Yt)},{get helperText(){return Qn},get leadingIcon(){return Pn}})),n(24,Ri=st().indexOf(Oe)),Vi.init(),se(Et),()=>{Vi.destroy()})),wm(()=>{Ai&&Ai()});function fe(Yt){n(37,Pn=Yt.detail)}function ve(Yt){return Yt in nn?nn[Yt]:ie().classList.contains(Yt)}function Ie(Yt){nn[Yt]||n(26,nn[Yt]=!0,nn)}function Ee(Yt){(!(Yt in nn)||nn[Yt])&&n(26,nn[Yt]=!1,nn)}function ze(Yt,bn){vn[Yt]!=bn&&(bn===""||bn==null?(delete vn[Yt],n(27,vn)):n(27,vn[Yt]=bn,vn))}function We(Yt){ei[Yt]||n(32,ei[Yt]=!0,ei)}function He(Yt){(!(Yt in ei)||ei[Yt])&&n(32,ei[Yt]=!1,ei)}function Qe(Yt){var bn;return Yt in mi?(bn=mi[Yt])!==null&&bn!==void 0?bn:null:ie().getAttribute(Yt)}function Ue(Yt,bn){mi[Yt]!==bn&&n(29,mi[Yt]=bn,mi)}function ft(Yt){(!(Yt in mi)||mi[Yt]!=null)&&n(29,mi[Yt]=void 0,mi)}function st(){return rn.getOrderedList().map(Yt=>Yt.getValue())}function Me(){return Vi.getUseDefaultValidation()}function se(Yt){Vi.setUseDefaultValidation(Yt)}function ne(){Ci.focus()}function $(){Vi.layout()}function ie(){return ji}function de(Yt){V2.call(this,e,Yt)}function ye(Yt){V2.call(this,e,Yt)}function ge(Yt){pa[Yt?"unshift":"push"](()=>{In=Yt,n(39,In)})}function Pe(Yt){pa[Yt?"unshift":"push"](()=>{In=Yt,n(39,In)})}function Fe(Yt){pa[Yt?"unshift":"push"](()=>{k=Yt,n(41,k)})}function Ve(Yt){pa[Yt?"unshift":"push"](()=>{v=Yt,n(40,v)})}function Xe(Yt){pa[Yt?"unshift":"push"](()=>{Ci=Yt,n(28,Ci)})}const Ye=()=>Vi&&Vi.handleFocus(),De=()=>Vi&&Vi.handleBlur(),Ge=Yt=>{Ci.focus(),Vi&&Vi.handleClick(tT(Yt))};function ht(Yt){Ri=Yt,n(24,Ri)}const kt=Yt=>n(36,rn=Yt.detail);function o(Yt){sn=Yt,n(31,sn)}const ke=Yt=>Vi&&Vi.handleMenuItemAction(Yt.detail.index),ai=()=>Vi&&Vi.handleMenuClosing(),fi=()=>Vi&&Vi.handleMenuClosed(),hi=()=>Vi&&Vi.handleMenuOpened();function Jt(Yt){pa[Yt?"unshift":"push"](()=>{ji=Yt,n(25,ji)})}const oi=()=>n(37,Pn=void 0),zi=Yt=>n(30,_i=Yt.detail),xi=Yt=>n(38,Qn=Yt.detail),Si=()=>{n(30,_i=void 0),n(38,Qn=void 0)};return e.$$set=Yt=>{t=gr(gr({},t),ic(Yt)),n(53,g=Ao(t,c)),"use"in Yt&&n(2,je=Yt.use),"class"in Yt&&n(3,nt=Yt.class),"style"in Yt&&n(4,tt=Yt.style),"ripple"in Yt&&n(5,at=Yt.ripple),"disabled"in Yt&&n(6,ut=Yt.disabled),"variant"in Yt&&n(7,xt=Yt.variant),"noLabel"in Yt&&n(8,Tt=Yt.noLabel),"label"in Yt&&n(9,Mt=Yt.label),"value"in Yt&&n(0,Oe=Yt.value),"key"in Yt&&n(56,jt=Yt.key),"dirty"in Yt&&n(55,it=Yt.dirty),"invalid"in Yt&&n(1,vt=Yt.invalid),"updateInvalid"in Yt&&n(57,mt=Yt.updateInvalid),"required"in Yt&&n(10,Pt=Yt.required),"inputId"in Yt&&n(11,dt=Yt.inputId),"hiddenInput"in Yt&&n(12,Je=Yt.hiddenInput),"withLeadingIcon"in Yt&&n(13,pt=Yt.withLeadingIcon),"anchor$use"in Yt&&n(14,lt=Yt.anchor$use),"anchor$class"in Yt&&n(15,Nt=Yt.anchor$class),"selectedTextContainer$use"in Yt&&n(16,zt=Yt.selectedTextContainer$use),"selectedTextContainer$class"in Yt&&n(17,Ot=Yt.selectedTextContainer$class),"selectedText$use"in Yt&&n(18,gi=Yt.selectedText$use),"selectedText$class"in Yt&&n(19,wi=Yt.selectedText$class),"dropdownIcon$use"in Yt&&n(20,Ti=Yt.dropdownIcon$use),"dropdownIcon$class"in Yt&&n(21,Ni=Yt.dropdownIcon$class),"menu$class"in Yt&&n(22,en=Yt.menu$class),"$$scope"in Yt&&n(87,G=Yt.$$scope)},e.$$.update=()=>{if(e.$$.dirty[0]&25165825|e.$$.dirty[2]&2&&te!==Ri)if(n(63,te=Ri),Vi)Vi.setSelectedIndex(Ri,!1,!0);else{const Yt=st();Oe!==Yt[Ri]&&n(0,Oe=Yt[Ri])}e.$$.dirty[0]&1&&om(Y,S=Oe,S),e.$$.dirty[0]&8388609|e.$$.dirty[1]&33554432&&Vi&&Vi.getValue()!==jt(Oe)&&Vi.setValue(jt(Oe)),e.$$.dirty[0]&8388672&&Vi&&Vi.getDisabled()!==ut&&Vi.setDisabled(ut),e.$$.dirty[0]&8388610|e.$$.dirty[1]&83886080&&Vi&&it&&Vi.isValid()!==!vt&&(mt?n(1,vt=!Vi.isValid()):Vi.setValid(!vt)),e.$$.dirty[0]&8389632&&Vi&&Vi.getRequired()!==Pt&&Vi.setRequired(Pt)},[Oe,vt,je,nt,tt,at,ut,xt,Tt,Mt,Pt,dt,Je,pt,lt,Nt,zt,Ot,gi,wi,Ti,Ni,en,Vi,Ri,ji,nn,vn,Ci,mi,_i,sn,ei,_n,Pr,ci,rn,Pn,Qn,In,v,k,x,ae,be,Oi,tr,V,Y,fe,Ie,Ee,ze,g,W,it,jt,mt,Me,se,ne,$,ie,te,a,de,ye,ge,Pe,Fe,Ve,Xe,Ye,De,Ge,ht,kt,o,ke,ai,fi,hi,Jt,oi,zi,xi,Si,G]}class fg extends fo{constructor(t){super(),po(this,t,nT,JC,Oa,{use:2,class:3,style:4,ripple:5,disabled:6,variant:7,noLabel:8,label:9,value:0,key:56,dirty:55,invalid:1,updateInvalid:57,required:10,inputId:11,hiddenInput:12,withLeadingIcon:13,anchor$use:14,anchor$class:15,selectedTextContainer$use:16,selectedTextContainer$class:17,selectedText$use:18,selectedText$class:19,dropdownIcon$use:20,dropdownIcon$class:21,menu$class:22,getUseDefaultValidation:58,setUseDefaultValidation:59,focus:60,layout:61,getElement:62},null,[-1,-1,-1,-1])}get getUseDefaultValidation(){return this.$$.ctx[58]}get setUseDefaultValidation(){return this.$$.ctx[59]}get focus(){return this.$$.ctx[60]}get layout(){return this.$$.ctx[61]}get getElement(){return this.$$.ctx[62]}}function rT(e){let t;const n=e[11].default,c=ql(n,e,e[13],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,x){c&&c.m(g,x),t=!0},p(g,x){c&&c.p&&(!t||x&8192)&&Hl(c,n,g,g[13],t?Zl(n,g[13],x,null):jl(g[13]),null)},i(g){t||($i(c,g),t=!0)},o(g){ln(c,g),t=!1},d(g){c&&c.d(g)}}}function sT(e){let t,n;const c=[{use:e[3]},{"data-value":e[0]},{value:e[0]},{selected:e[2]},e[6]];let g={$$slots:{default:[rT]},$$scope:{ctx:e}};for(let x=0;x<c.length;x+=1)g=gr(g,c[x]);return t=new wC({props:g}),e[12](t),{c(){ls(t.$$.fragment)},l(x){Ds(t.$$.fragment,x)},m(x,S){us(t,x,S),n=!0},p(x,[S]){const a=S&77?ma(c,[S&8&&{use:x[3]},S&1&&{"data-value":x[0]},S&1&&{value:x[0]},S&4&&{selected:x[2]},S&64&&Os(x[6])]):{};S&8192&&(a.$$scope={dirty:S,ctx:x}),t.$set(a)},i(x){n||($i(t.$$.fragment,x),n=!0)},o(x){ln(t.$$.fragment,x),n=!1},d(x){e[12](null),cs(t,x)}}}function aT(e,t,n){let c,g;const x=["use","class","value","getElement"];let S=Ao(t,x),a,G,{$$slots:W={},$$scope:he}=t;const ae=Sc(vc());let{use:ue=[]}=t;const be="";let{value:je=""}=t,nt;const tt=Cu("SMUI:select:selectedText");tc(e,tt,Mt=>n(14,a=Mt));const at=Cu("SMUI:select:value");tc(e,at,Mt=>n(10,G=Mt)),du("SMUI:list:item:role","option"),xc(ut),wm(ut);function ut(){g&&nt&&om(tt,a=nt.getPrimaryText(),a)}function xt(){return nt.getElement()}function Tt(Mt){pa[Mt?"unshift":"push"](()=>{nt=Mt,n(1,nt)})}return e.$$set=Mt=>{t=gr(gr({},t),ic(Mt)),n(6,S=Ao(t,x)),"use"in Mt&&n(7,ue=Mt.use),"value"in Mt&&n(0,je=Mt.value),"$$scope"in Mt&&n(13,he=Mt.$$scope)},e.$$.update=()=>{e.$$.dirty&128&&n(3,c=[ae,...ue]),e.$$.dirty&1025&&n(2,g=je!=null&&je!==""&&G===je)},[je,nt,g,c,tt,at,S,ue,be,xt,G,W,Tt,he]}class Tg extends fo{constructor(t){super(),po(this,t,aT,sT,Oa,{use:7,class:8,value:0,getElement:9})}get class(){return this.$$.ctx[8]}get getElement(){return this.$$.ctx[9]}}function g_(e,t,n="*ibm"){return Bv[n](e,t)}function oT(e="*ibm_flip"){return[[-1,"#dddddd"],[.5,"#648FFFcc"],[1,"#7580ed"],[1.5,"#8671db"],[2,"#9762c9"],[2.5,"#a853b7"],[5,"#b944a5"],[10,"#ca3593"],[25,"#DC267Fcc"],[75,"#FFB000cc"],[90,"#e64c5a"],[97.5,"#eb6048"],[98,"#f07436"],[98.5,"#f58824"],[99,"#fa9c12"],[99.5,"#FFB000cc"]]}function lT(e="*ibm_flip"){let t=Bv[e](0,1),n=[];for(let c of t)n.push(c[1]);return n}function Ho(e,t,n){return n*(t-e)+e}const Bv={"*ibm":function(t,n){return[[-1,"#dddddd"],[t,"#648FFF","Very low"],[Ho(t,n,.25),"#785EF0"],[Ho(t,n,.5),"#DC267F","Expected"],[Ho(t,n,.75),"#FE6100"],[n,"#FFB000","Very high"]]},"*ibm_flip":function(t,n){return[[-1,"#dddddd"],[t,"#FFB000","Very low"],[Ho(t,n,.25),"#FE6100"],[Ho(t,n,.5),"#DC267F","Expected"],[Ho(t,n,.75),"#785EF0"],[n,"#648FFF","Very high"]]},orGrBlu:function(t,n){return[[-1,"#dddddd"],[t,"#F9A825","Very low"],[Ho(t,n,.35),"#e8f4c4"],[Ho(t,n,.5),"#00E676","Expected"],[Ho(t,n,.75),"#3d9ab8"],[Ho(t,n,.85),"#318ab5"],[n,"#2a4e9b","Very high"]]},blGr:function(t,n){return[[-1,"#dddddd"],[t,"#000000","Very low"],[n,"#00ff00","Very high"]]},blBluCyWt:function(t,n){return[[-1,"#dddddd","Missing"],[t,"#000000","Very low"],[Ho(t,n,.5),"#0000ff","Expected"],[Ho(t,n,.75),"#00ffff"],[n,"#ffffff","Very high"]]},rdYlGr:function(t,n){return[[-1,"#dddddd","Missing"],[t,"#fd5533","Very low"],[Ho(t,n,.5),"#f8f611","Normal"],[n,"#4eb87b","Very high"]]},"*mgYlGr":function(t,n){return[[-1,"#dddddd","Missing"],[t,"#F15C8E","Very low"],[Ho(t,n,.5),"#f8f611","Normal"],[n,"#4eb87b","Very high"]]},grYlRd:function(t,n){return[[-1,"#dddddd","Missing"],[t,"#00ff33","Very low biodiversity"],[Ho(t,n,.5),"#ffff33","Normal biodiversity"],[n,"#ff3300","Very high biodiversity"]]},"*census":function(t,n){return[[-1,"#dddddd","Missing"],[t,"#efd100","Very low biodiversity"],[Ho(t,n,.5),"#4eb87b","Normal biodiversity"],[n,"#007fc4","Very high biodiversity"]]},seqseq:function(t,n){return[[-1,"#dddddd","Missing"],[t,"#de4fa6","Very low biodiversity"],[Ho(t,n,.5),"#4fadd0","Normal biodiversity"],[n,"#2a1a8a","Very high biodiversity"]]},"*parula":function(t,n){return[[-1,"#dddddd"],[t,"#352a87","Very low"],[Ho(t,n,.167),"#0469df"],[Ho(t,n,.33),"#06a0cb"],[Ho(t,n,.5),"#1fb2ac","Expected"],[Ho(t,n,.667),"#a3bd6a"],[Ho(t,n,.833),"#fcc336"],[n,"#f8f611","Very high"]]},"*parula_flip":function(t,n){return[[-1,"#dddddd"],[t,"#f8f611","Very low"],[Ho(t,n,.167),"#fcc336"],[Ho(t,n,.33),"#a3bd6a"],[Ho(t,n,.5),"#1fb2ac","Expected"],[Ho(t,n,.667),"#06a0cb"],[Ho(t,n,.833),"#0469df"],[n,"#352a87","Very high"]]}};function fm(){return{100:"#e9f6fc",200:"#b9e4f7",300:"#89d1f0",400:"#59bee9",500:"#29abe2",600:"#2186af",700:"#175f7c",800:"#0d3849",900:"#031116"}}var Jf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zv(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function c(){return this instanceof c?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(c){var g=Object.getOwnPropertyDescriptor(e,c);Object.defineProperty(n,c,g.get?g:{enumerable:!0,get:function(){return e[c]}})}),n}var d3={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.1.0/LICENSE.txt
 */(function(e,t){(function(n,c){e.exports=c()})(Jf,function(){var n={},c={};function g(S,a,G){if(c[S]=G,S==="index"){var W="var sharedModule = {}; ("+c.shared+")(sharedModule); ("+c.worker+")(sharedModule);",he={};return c.shared(he),c.index(n,he),typeof window<"u"&&n.setWorkerUrl(window.URL.createObjectURL(new Blob([W],{type:"text/javascript"}))),n}}g("shared",["exports"],function(S){function a(m,h,b,M){return new(b||(b=Promise))(function(q,K){function J(Ne){try{Ce(M.next(Ne))}catch(f){K(f)}}function me(Ne){try{Ce(M.throw(Ne))}catch(f){K(f)}}function Ce(Ne){var f;Ne.done?q(Ne.value):(f=Ne.value,f instanceof b?f:new b(function(u){u(f)})).then(J,me)}Ce((M=M.apply(m,h||[])).next())})}function G(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}typeof SuppressedError=="function"&&SuppressedError;var W=he;function he(m,h){this.x=m,this.y=h}he.prototype={clone:function(){return new he(this.x,this.y)},add:function(m){return this.clone()._add(m)},sub:function(m){return this.clone()._sub(m)},multByPoint:function(m){return this.clone()._multByPoint(m)},divByPoint:function(m){return this.clone()._divByPoint(m)},mult:function(m){return this.clone()._mult(m)},div:function(m){return this.clone()._div(m)},rotate:function(m){return this.clone()._rotate(m)},rotateAround:function(m,h){return this.clone()._rotateAround(m,h)},matMult:function(m){return this.clone()._matMult(m)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(m){return this.x===m.x&&this.y===m.y},dist:function(m){return Math.sqrt(this.distSqr(m))},distSqr:function(m){var h=m.x-this.x,b=m.y-this.y;return h*h+b*b},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(m){return Math.atan2(this.y-m.y,this.x-m.x)},angleWith:function(m){return this.angleWithSep(m.x,m.y)},angleWithSep:function(m,h){return Math.atan2(this.x*h-this.y*m,this.x*m+this.y*h)},_matMult:function(m){var h=m[2]*this.x+m[3]*this.y;return this.x=m[0]*this.x+m[1]*this.y,this.y=h,this},_add:function(m){return this.x+=m.x,this.y+=m.y,this},_sub:function(m){return this.x-=m.x,this.y-=m.y,this},_mult:function(m){return this.x*=m,this.y*=m,this},_div:function(m){return this.x/=m,this.y/=m,this},_multByPoint:function(m){return this.x*=m.x,this.y*=m.y,this},_divByPoint:function(m){return this.x/=m.x,this.y/=m.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var m=this.y;return this.y=this.x,this.x=-m,this},_rotate:function(m){var h=Math.cos(m),b=Math.sin(m),M=b*this.x+h*this.y;return this.x=h*this.x-b*this.y,this.y=M,this},_rotateAround:function(m,h){var b=Math.cos(m),M=Math.sin(m),q=h.y+M*(this.x-h.x)+b*(this.y-h.y);return this.x=h.x+b*(this.x-h.x)-M*(this.y-h.y),this.y=q,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},he.convert=function(m){return m instanceof he?m:Array.isArray(m)?new he(m[0],m[1]):m};var ae=G(W),ue=be;function be(m,h,b,M){this.cx=3*m,this.bx=3*(b-m)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(M-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=m,this.p1y=h,this.p2x=b,this.p2y=M}be.prototype={sampleCurveX:function(m){return((this.ax*m+this.bx)*m+this.cx)*m},sampleCurveY:function(m){return((this.ay*m+this.by)*m+this.cy)*m},sampleCurveDerivativeX:function(m){return(3*this.ax*m+2*this.bx)*m+this.cx},solveCurveX:function(m,h){if(h===void 0&&(h=1e-6),m<0)return 0;if(m>1)return 1;for(var b=m,M=0;M<8;M++){var q=this.sampleCurveX(b)-m;if(Math.abs(q)<h)return b;var K=this.sampleCurveDerivativeX(b);if(Math.abs(K)<1e-6)break;b-=q/K}var J=0,me=1;for(b=m,M=0;M<20&&(q=this.sampleCurveX(b),!(Math.abs(q-m)<h));M++)m>q?J=b:me=b,b=.5*(me-J)+J;return b},solve:function(m,h){return this.sampleCurveY(this.solveCurveX(m,h))}};var je=G(ue);let nt,tt;function at(){return nt==null&&(nt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),nt}function ut(){if(tt==null&&(tt=!1,at())){const h=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(h){for(let M=0;M<5*5;M++){const q=4*M;h.fillStyle=`rgb(${q},${q+1},${q+2})`,h.fillRect(M%5,Math.floor(M/5),1,1)}const b=h.getImageData(0,0,5,5).data;for(let M=0;M<5*5*4;M++)if(M%4!=3&&b[M]!==M){tt=!0;break}}}return tt||!1}function xt(m,h,b,M){const q=new je(m,h,b,M);return function(K){return q.solve(K)}}const Tt=xt(.25,.1,.25,1);function Mt(m,h,b){return Math.min(b,Math.max(h,m))}function Oe(m,h,b){const M=b-h,q=((m-h)%M+M)%M+h;return q===h?b:q}function jt(m,...h){for(const b of h)for(const M in b)m[M]=b[M];return m}let it=1;function vt(m,h,b){const M={};for(const q in m)M[q]=h.call(b||this,m[q],q,m);return M}function mt(m,h,b){const M={};for(const q in m)h.call(b||this,m[q],q,m)&&(M[q]=m[q]);return M}function Et(m){return Array.isArray(m)?m.map(Et):typeof m=="object"&&m?vt(m,Et):m}const Pt={};function dt(m){Pt[m]||(typeof console<"u"&&console.warn(m),Pt[m]=!0)}function Je(m,h,b){return(b.y-m.y)*(h.x-m.x)>(h.y-m.y)*(b.x-m.x)}function pt(m){let h=0;for(let b,M,q=0,K=m.length,J=K-1;q<K;J=q++)b=m[q],M=m[J],h+=(M.x-b.x)*(b.y+M.y);return h}function lt(m){return typeof WorkerGlobalScope<"u"&&m!==void 0&&m instanceof WorkerGlobalScope}let Nt=null;function zt(m){return typeof ImageBitmap<"u"&&m instanceof ImageBitmap}const Ot="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function gi(m,h,b,M,q){return a(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const K=new VideoFrame(m,{timestamp:0});try{const J=K==null?void 0:K.format;if(!J||!J.startsWith("BGR")&&!J.startsWith("RGB"))throw new Error(`Unrecognized format ${J}`);const me=J.startsWith("BGR"),Ce=new Uint8ClampedArray(M*q*4);if(yield K.copyTo(Ce,function(Ne,f,u,p,I){const L=4*Math.max(-f,0),U=(Math.max(0,u)-u)*p*4+L,Q=4*p,re=Math.max(0,f),Ae=Math.max(0,u);return{rect:{x:re,y:Ae,width:Math.min(Ne.width,f+p)-re,height:Math.min(Ne.height,u+I)-Ae},layout:[{offset:U,stride:Q}]}}(m,h,b,M,q)),me)for(let Ne=0;Ne<Ce.length;Ne+=4){const f=Ce[Ne];Ce[Ne]=Ce[Ne+2],Ce[Ne+2]=f}return Ce}finally{K.close()}})}let wi,Ti;const Ni="AbortError";function en(){return new Error(Ni)}const ji={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Vi(m){return ji.REGISTERED_PROTOCOLS[m.substring(0,m.indexOf("://"))]}const nn="global-dispatcher";class vn extends Error{constructor(h,b,M,q){super(`AJAXError: ${b} (${h}): ${M}`),this.status=h,this.statusText=b,this.url=M,this.body=q}}const Ci=()=>lt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,mi=function(m,h){if(/:\/\//.test(m.url)&&!/^https?:|^file:/.test(m.url)){const M=Vi(m.url);if(M)return M(m,h);if(lt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:m,targetMapId:nn},h)}if(!(/^file:/.test(b=m.url)||/^file:/.test(Ci())&&!/^\w+:/.test(b))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(M,q){return a(this,void 0,void 0,function*(){const K=new Request(M.url,{method:M.method||"GET",body:M.body,credentials:M.credentials,headers:M.headers,cache:M.cache,referrer:Ci(),signal:q.signal});M.type==="json"&&K.headers.set("Accept","application/json");const J=yield fetch(K);if(!J.ok){const Ne=yield J.blob();throw new vn(J.status,J.statusText,M.url,Ne)}const me=M.type==="arrayBuffer"||M.type==="image"?J.arrayBuffer():M.type==="json"?J.json():J.text(),Ce=yield me;if(q.signal.aborted)throw en();return{data:Ce,cacheControl:J.headers.get("Cache-Control"),expires:J.headers.get("Expires")}})}(m,h);if(lt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:m,mustQueue:!0,targetMapId:nn},h)}var b;return function(M,q){return new Promise((K,J)=>{const me=new XMLHttpRequest;me.open(M.method||"GET",M.url,!0),M.type!=="arrayBuffer"&&M.type!=="image"||(me.responseType="arraybuffer");for(const Ce in M.headers)me.setRequestHeader(Ce,M.headers[Ce]);M.type==="json"&&(me.responseType="text",me.setRequestHeader("Accept","application/json")),me.withCredentials=M.credentials==="include",me.onerror=()=>{J(new Error(me.statusText))},me.onload=()=>{if(!q.signal.aborted)if((me.status>=200&&me.status<300||me.status===0)&&me.response!==null){let Ce=me.response;if(M.type==="json")try{Ce=JSON.parse(me.response)}catch(Ne){return void J(Ne)}K({data:Ce,cacheControl:me.getResponseHeader("Cache-Control"),expires:me.getResponseHeader("Expires")})}else{const Ce=new Blob([me.response],{type:me.getResponseHeader("Content-Type")});J(new vn(me.status,me.statusText,M.url,Ce))}},q.signal.addEventListener("abort",()=>{me.abort(),J(en())}),me.send(M.body)})}(m,h)};function Ri(m){if(!m||m.indexOf("://")<=0||m.indexOf("data:image/")===0||m.indexOf("blob:")===0)return!0;const h=new URL(m),b=window.location;return h.protocol===b.protocol&&h.host===b.host}function Oi(m,h,b){b[m]&&b[m].indexOf(h)!==-1||(b[m]=b[m]||[],b[m].push(h))}function _i(m,h,b){if(b&&b[m]){const M=b[m].indexOf(h);M!==-1&&b[m].splice(M,1)}}class Ji{constructor(h,b={}){jt(this,b),this.type=h}}class Ai extends Ji{constructor(h,b={}){super("error",jt({error:h},b))}}class sn{on(h,b){return this._listeners=this._listeners||{},Oi(h,b,this._listeners),this}off(h,b){return _i(h,b,this._listeners),_i(h,b,this._oneTimeListeners),this}once(h,b){return b?(this._oneTimeListeners=this._oneTimeListeners||{},Oi(h,b,this._oneTimeListeners),this):new Promise(M=>this.once(h,M))}fire(h,b){typeof h=="string"&&(h=new Ji(h,b||{}));const M=h.type;if(this.listens(M)){h.target=this;const q=this._listeners&&this._listeners[M]?this._listeners[M].slice():[];for(const me of q)me.call(this,h);const K=this._oneTimeListeners&&this._oneTimeListeners[M]?this._oneTimeListeners[M].slice():[];for(const me of K)_i(M,me,this._oneTimeListeners),me.call(this,h);const J=this._eventedParent;J&&(jt(h,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),J.fire(h))}else h instanceof Ai&&console.error(h.error);return this}listens(h){return this._listeners&&this._listeners[h]&&this._listeners[h].length>0||this._oneTimeListeners&&this._oneTimeListeners[h]&&this._oneTimeListeners[h].length>0||this._eventedParent&&this._eventedParent.listens(h)}setEventedParent(h,b){return this._eventedParent=h,this._eventedParentData=b,this}}var ei={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const _n=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Pr(m,h){const b={};for(const M in m)M!=="ref"&&(b[M]=m[M]);return _n.forEach(M=>{M in h&&(b[M]=h[M])}),b}function ci(m,h){if(Array.isArray(m)){if(!Array.isArray(h)||m.length!==h.length)return!1;for(let b=0;b<m.length;b++)if(!ci(m[b],h[b]))return!1;return!0}if(typeof m=="object"&&m!==null&&h!==null){if(typeof h!="object"||Object.keys(m).length!==Object.keys(h).length)return!1;for(const b in m)if(!ci(m[b],h[b]))return!1;return!0}return m===h}function rn(m,h){m.push(h)}function tr(m,h,b){rn(b,{command:"addSource",args:[m,h[m]]})}function Pn(m,h,b){rn(h,{command:"removeSource",args:[m]}),b[m]=!0}function Qn(m,h,b,M){Pn(m,b,M),tr(m,h,b)}function In(m,h,b){let M;for(M in m[b])if(Object.prototype.hasOwnProperty.call(m[b],M)&&M!=="data"&&!ci(m[b][M],h[b][M]))return!1;for(M in h[b])if(Object.prototype.hasOwnProperty.call(h[b],M)&&M!=="data"&&!ci(m[b][M],h[b][M]))return!1;return!0}function v(m,h,b,M,q,K){m=m||{},h=h||{};for(const J in m)Object.prototype.hasOwnProperty.call(m,J)&&(ci(m[J],h[J])||b.push({command:K,args:[M,J,h[J],q]}));for(const J in h)Object.prototype.hasOwnProperty.call(h,J)&&!Object.prototype.hasOwnProperty.call(m,J)&&(ci(m[J],h[J])||b.push({command:K,args:[M,J,h[J],q]}))}function k(m){return m.id}function V(m,h){return m[h.id]=h,m}class Y{constructor(h,b,M,q){this.message=(h?`${h}: `:"")+M,q&&(this.identifier=q),b!=null&&b.__line__&&(this.line=b.__line__)}}function te(m,...h){for(const b of h)for(const M in b)m[M]=b[M];return m}class fe extends Error{constructor(h,b){super(b),this.message=b,this.key=h}}class ve{constructor(h,b=[]){this.parent=h,this.bindings={};for(const[M,q]of b)this.bindings[M]=q}concat(h){return new ve(this,h)}get(h){if(this.bindings[h])return this.bindings[h];if(this.parent)return this.parent.get(h);throw new Error(`${h} not found in scope.`)}has(h){return!!this.bindings[h]||!!this.parent&&this.parent.has(h)}}const Ie={kind:"null"},Ee={kind:"number"},ze={kind:"string"},We={kind:"boolean"},He={kind:"color"},Qe={kind:"object"},Ue={kind:"value"},ft={kind:"collator"},st={kind:"formatted"},Me={kind:"padding"},se={kind:"resolvedImage"},ne={kind:"variableAnchorOffsetCollection"};function $(m,h){return{kind:"array",itemType:m,N:h}}function ie(m){if(m.kind==="array"){const h=ie(m.itemType);return typeof m.N=="number"?`array<${h}, ${m.N}>`:m.itemType.kind==="value"?"array":`array<${h}>`}return m.kind}const de=[Ie,Ee,ze,We,He,st,Qe,$(Ue),Me,se,ne];function ye(m,h){if(h.kind==="error")return null;if(m.kind==="array"){if(h.kind==="array"&&(h.N===0&&h.itemType.kind==="value"||!ye(m.itemType,h.itemType))&&(typeof m.N!="number"||m.N===h.N))return null}else{if(m.kind===h.kind)return null;if(m.kind==="value"){for(const b of de)if(!ye(b,h))return null}}return`Expected ${ie(m)} but found ${ie(h)} instead.`}function ge(m,h){return h.some(b=>b.kind===m.kind)}function Pe(m,h){return h.some(b=>b==="null"?m===null:b==="array"?Array.isArray(m):b==="object"?m&&!Array.isArray(m)&&typeof m=="object":b===typeof m)}function Fe(m,h){return m.kind==="array"&&h.kind==="array"?m.itemType.kind===h.itemType.kind&&typeof m.N=="number":m.kind===h.kind}const Ve=.96422,Xe=.82521,Ye=4/29,De=6/29,Ge=3*De*De,ht=De*De*De,kt=Math.PI/180,o=180/Math.PI;function ke(m){return(m%=360)<0&&(m+=360),m}function ai([m,h,b,M]){let q,K;const J=hi((.2225045*(m=fi(m))+.7168786*(h=fi(h))+.0606169*(b=fi(b)))/1);m===h&&h===b?q=K=J:(q=hi((.4360747*m+.3850649*h+.1430804*b)/Ve),K=hi((.0139322*m+.0971045*h+.7141733*b)/Xe));const me=116*J-16;return[me<0?0:me,500*(q-J),200*(J-K),M]}function fi(m){return m<=.04045?m/12.92:Math.pow((m+.055)/1.055,2.4)}function hi(m){return m>ht?Math.pow(m,1/3):m/Ge+Ye}function Jt([m,h,b,M]){let q=(m+16)/116,K=isNaN(h)?q:q+h/500,J=isNaN(b)?q:q-b/200;return q=1*zi(q),K=Ve*zi(K),J=Xe*zi(J),[oi(3.1338561*K-1.6168667*q-.4906146*J),oi(-.9787684*K+1.9161415*q+.033454*J),oi(.0719453*K-.2289914*q+1.4052427*J),M]}function oi(m){return(m=m<=.00304?12.92*m:1.055*Math.pow(m,1/2.4)-.055)<0?0:m>1?1:m}function zi(m){return m>De?m*m*m:Ge*(m-Ye)}function xi(m){return parseInt(m.padEnd(2,m),16)/255}function Si(m,h){return Yt(h?m/100:m,0,1)}function Yt(m,h,b){return Math.min(Math.max(h,m),b)}function bn(m){return!m.some(Number.isNaN)}const or={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class mn{constructor(h,b,M,q=1,K=!0){this.r=h,this.g=b,this.b=M,this.a=q,K||(this.r*=q,this.g*=q,this.b*=q,q||this.overwriteGetter("rgb",[h,b,M,q]))}static parse(h){if(h instanceof mn)return h;if(typeof h!="string")return;const b=function(M){if((M=M.toLowerCase().trim())==="transparent")return[0,0,0,0];const q=or[M];if(q){const[J,me,Ce]=q;return[J/255,me/255,Ce/255,1]}if(M.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(M)){const J=M.length<6?1:2;let me=1;return[xi(M.slice(me,me+=J)),xi(M.slice(me,me+=J)),xi(M.slice(me,me+=J)),xi(M.slice(me,me+J)||"ff")]}if(M.startsWith("rgb")){const J=M.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(J){const[me,Ce,Ne,f,u,p,I,L,U,Q,re,Ae]=J,_e=[f||" ",I||" ",Q].join("");if(_e==="  "||_e==="  /"||_e===",,"||_e===",,,"){const Le=[Ne,p,U].join(""),qe=Le==="%%%"?100:Le===""?255:0;if(qe){const et=[Yt(+Ce/qe,0,1),Yt(+u/qe,0,1),Yt(+L/qe,0,1),re?Si(+re,Ae):1];if(bn(et))return et}}return}}const K=M.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(K){const[J,me,Ce,Ne,f,u,p,I,L]=K,U=[Ce||" ",f||" ",p].join("");if(U==="  "||U==="  /"||U===",,"||U===",,,"){const Q=[+me,Yt(+Ne,0,100),Yt(+u,0,100),I?Si(+I,L):1];if(bn(Q))return function([re,Ae,_e,Le]){function qe(et){const At=(et+re/30)%12,gt=Ae*Math.min(_e,1-_e);return _e-gt*Math.max(-1,Math.min(At-3,9-At,1))}return re=ke(re),Ae/=100,_e/=100,[qe(0),qe(8),qe(4),Le]}(Q)}}}(h);return b?new mn(...b,!1):void 0}get rgb(){const{r:h,g:b,b:M,a:q}=this,K=q||1/0;return this.overwriteGetter("rgb",[h/K,b/K,M/K,q])}get hcl(){return this.overwriteGetter("hcl",function(h){const[b,M,q,K]=ai(h),J=Math.sqrt(M*M+q*q);return[Math.round(1e4*J)?ke(Math.atan2(q,M)*o):NaN,J,b,K]}(this.rgb))}get lab(){return this.overwriteGetter("lab",ai(this.rgb))}overwriteGetter(h,b){return Object.defineProperty(this,h,{value:b}),b}toString(){const[h,b,M,q]=this.rgb;return`rgba(${[h,b,M].map(K=>Math.round(255*K)).join(",")},${q})`}}mn.black=new mn(0,0,0,1),mn.white=new mn(1,1,1,1),mn.transparent=new mn(0,0,0,0),mn.red=new mn(1,0,0,1);class qn{constructor(h,b,M){this.sensitivity=h?b?"variant":"case":b?"accent":"base",this.locale=M,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(h,b){return this.collator.compare(h,b)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class jr{constructor(h,b,M,q,K){this.text=h,this.image=b,this.scale=M,this.fontStack=q,this.textColor=K}}class Zi{constructor(h){this.sections=h}static fromString(h){return new Zi([new jr(h,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(h=>h.text.length!==0||h.image&&h.image.name.length!==0)}static factory(h){return h instanceof Zi?h:Zi.fromString(h)}toString(){return this.sections.length===0?"":this.sections.map(h=>h.text).join("")}}class ur{constructor(h){this.values=h.slice()}static parse(h){if(h instanceof ur)return h;if(typeof h=="number")return new ur([h,h,h,h]);if(Array.isArray(h)&&!(h.length<1||h.length>4)){for(const b of h)if(typeof b!="number")return;switch(h.length){case 1:h=[h[0],h[0],h[0],h[0]];break;case 2:h=[h[0],h[1],h[0],h[1]];break;case 3:h=[h[0],h[1],h[2],h[1]]}return new ur(h)}}toString(){return JSON.stringify(this.values)}}const Vn=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Wt{constructor(h){this.values=h.slice()}static parse(h){if(h instanceof Wt)return h;if(Array.isArray(h)&&!(h.length<1)&&h.length%2==0){for(let b=0;b<h.length;b+=2){const M=h[b],q=h[b+1];if(typeof M!="string"||!Vn.has(M)||!Array.isArray(q)||q.length!==2||typeof q[0]!="number"||typeof q[1]!="number")return}return new Wt(h)}}toString(){return JSON.stringify(this.values)}}class Ki{constructor(h){this.name=h.name,this.available=h.available}toString(){return this.name}static fromString(h){return h?new Ki({name:h,available:!1}):null}}function Ut(m,h,b,M){return typeof m=="number"&&m>=0&&m<=255&&typeof h=="number"&&h>=0&&h<=255&&typeof b=="number"&&b>=0&&b<=255?M===void 0||typeof M=="number"&&M>=0&&M<=1?null:`Invalid rgba value [${[m,h,b,M].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof M=="number"?[m,h,b,M]:[m,h,b]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Tn(m){if(m===null||typeof m=="string"||typeof m=="boolean"||typeof m=="number"||m instanceof mn||m instanceof qn||m instanceof Zi||m instanceof ur||m instanceof Wt||m instanceof Ki)return!0;if(Array.isArray(m)){for(const h of m)if(!Tn(h))return!1;return!0}if(typeof m=="object"){for(const h in m)if(!Tn(m[h]))return!1;return!0}return!1}function cr(m){if(m===null)return Ie;if(typeof m=="string")return ze;if(typeof m=="boolean")return We;if(typeof m=="number")return Ee;if(m instanceof mn)return He;if(m instanceof qn)return ft;if(m instanceof Zi)return st;if(m instanceof ur)return Me;if(m instanceof Wt)return ne;if(m instanceof Ki)return se;if(Array.isArray(m)){const h=m.length;let b;for(const M of m){const q=cr(M);if(b){if(b===q)continue;b=Ue;break}b=q}return $(b||Ue,h)}return Qe}function Vs(m){const h=typeof m;return m===null?"":h==="string"||h==="number"||h==="boolean"?String(m):m instanceof mn||m instanceof Zi||m instanceof ur||m instanceof Wt||m instanceof Ki?m.toString():JSON.stringify(m)}class Ur{constructor(h,b){this.type=h,this.value=b}static parse(h,b){if(h.length!==2)return b.error(`'literal' expression requires exactly one argument, but found ${h.length-1} instead.`);if(!Tn(h[1]))return b.error("invalid value");const M=h[1];let q=cr(M);const K=b.expectedType;return q.kind!=="array"||q.N!==0||!K||K.kind!=="array"||typeof K.N=="number"&&K.N!==0||(q=K),new Ur(q,M)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Vt{constructor(h){this.name="ExpressionEvaluationError",this.message=h}toJSON(){return this.message}}const hr={string:ze,number:Ee,boolean:We,object:Qe};class Bt{constructor(h,b){this.type=h,this.args=b}static parse(h,b){if(h.length<2)return b.error("Expected at least one argument.");let M,q=1;const K=h[0];if(K==="array"){let me,Ce;if(h.length>2){const Ne=h[1];if(typeof Ne!="string"||!(Ne in hr)||Ne==="object")return b.error('The item type argument of "array" must be one of string, number, boolean',1);me=hr[Ne],q++}else me=Ue;if(h.length>3){if(h[2]!==null&&(typeof h[2]!="number"||h[2]<0||h[2]!==Math.floor(h[2])))return b.error('The length argument to "array" must be a positive integer literal',2);Ce=h[2],q++}M=$(me,Ce)}else{if(!hr[K])throw new Error(`Types doesn't contain name = ${K}`);M=hr[K]}const J=[];for(;q<h.length;q++){const me=b.parse(h[q],q,Ue);if(!me)return null;J.push(me)}return new Bt(M,J)}evaluate(h){for(let b=0;b<this.args.length;b++){const M=this.args[b].evaluate(h);if(!ye(this.type,cr(M)))return M;if(b===this.args.length-1)throw new Vt(`Expected value to be of type ${ie(this.type)}, but found ${ie(cr(M))} instead.`)}throw new Error}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}}const Fr={"to-boolean":We,"to-color":He,"to-number":Ee,"to-string":ze};class Us{constructor(h,b){this.type=h,this.args=b}static parse(h,b){if(h.length<2)return b.error("Expected at least one argument.");const M=h[0];if(!Fr[M])throw new Error(`Can't parse ${M} as it is not part of the known types`);if((M==="to-boolean"||M==="to-string")&&h.length!==2)return b.error("Expected one argument.");const q=Fr[M],K=[];for(let J=1;J<h.length;J++){const me=b.parse(h[J],J,Ue);if(!me)return null;K.push(me)}return new Us(q,K)}evaluate(h){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(h);case"color":{let b,M;for(const q of this.args){if(b=q.evaluate(h),M=null,b instanceof mn)return b;if(typeof b=="string"){const K=h.parseColor(b);if(K)return K}else if(Array.isArray(b)&&(M=b.length<3||b.length>4?`Invalid rbga value ${JSON.stringify(b)}: expected an array containing either three or four numeric values.`:Ut(b[0],b[1],b[2],b[3]),!M))return new mn(b[0]/255,b[1]/255,b[2]/255,b[3])}throw new Vt(M||`Could not parse color from value '${typeof b=="string"?b:JSON.stringify(b)}'`)}case"padding":{let b;for(const M of this.args){b=M.evaluate(h);const q=ur.parse(b);if(q)return q}throw new Vt(`Could not parse padding from value '${typeof b=="string"?b:JSON.stringify(b)}'`)}case"variableAnchorOffsetCollection":{let b;for(const M of this.args){b=M.evaluate(h);const q=Wt.parse(b);if(q)return q}throw new Vt(`Could not parse variableAnchorOffsetCollection from value '${typeof b=="string"?b:JSON.stringify(b)}'`)}case"number":{let b=null;for(const M of this.args){if(b=M.evaluate(h),b===null)return 0;const q=Number(b);if(!isNaN(q))return q}throw new Vt(`Could not convert ${JSON.stringify(b)} to number.`)}case"formatted":return Zi.fromString(Vs(this.args[0].evaluate(h)));case"resolvedImage":return Ki.fromString(Vs(this.args[0].evaluate(h)));default:return Vs(this.args[0].evaluate(h))}}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}}const ua=["Unknown","Point","LineString","Polygon"];class Dr{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ua[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(h){let b=this._parseColorCache[h];return b||(b=this._parseColorCache[h]=mn.parse(h)),b}}class Na{constructor(h,b,M=[],q,K=new ve,J=[]){this.registry=h,this.path=M,this.key=M.map(me=>`[${me}]`).join(""),this.scope=K,this.errors=J,this.expectedType=q,this._isConstant=b}parse(h,b,M,q,K={}){return b?this.concat(b,M,q)._parse(h,K):this._parse(h,K)}_parse(h,b){function M(q,K,J){return J==="assert"?new Bt(K,[q]):J==="coerce"?new Us(K,[q]):q}if(h!==null&&typeof h!="string"&&typeof h!="boolean"&&typeof h!="number"||(h=["literal",h]),Array.isArray(h)){if(h.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const q=h[0];if(typeof q!="string")return this.error(`Expression name must be a string, but found ${typeof q} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const K=this.registry[q];if(K){let J=K.parse(h,this);if(!J)return null;if(this.expectedType){const me=this.expectedType,Ce=J.type;if(me.kind!=="string"&&me.kind!=="number"&&me.kind!=="boolean"&&me.kind!=="object"&&me.kind!=="array"||Ce.kind!=="value")if(me.kind!=="color"&&me.kind!=="formatted"&&me.kind!=="resolvedImage"||Ce.kind!=="value"&&Ce.kind!=="string")if(me.kind!=="padding"||Ce.kind!=="value"&&Ce.kind!=="number"&&Ce.kind!=="array")if(me.kind!=="variableAnchorOffsetCollection"||Ce.kind!=="value"&&Ce.kind!=="array"){if(this.checkSubtype(me,Ce))return null}else J=M(J,me,b.typeAnnotation||"coerce");else J=M(J,me,b.typeAnnotation||"coerce");else J=M(J,me,b.typeAnnotation||"coerce");else J=M(J,me,b.typeAnnotation||"assert")}if(!(J instanceof Ur)&&J.type.kind!=="resolvedImage"&&this._isConstant(J)){const me=new Dr;try{J=new Ur(J.type,J.evaluate(me))}catch(Ce){return this.error(Ce.message),null}}return J}return this.error(`Unknown expression "${q}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(h===void 0?"'undefined' value invalid. Use null instead.":typeof h=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof h} instead.`)}concat(h,b,M){const q=typeof h=="number"?this.path.concat(h):this.path,K=M?this.scope.concat(M):this.scope;return new Na(this.registry,this._isConstant,q,b||null,K,this.errors)}error(h,...b){const M=`${this.key}${b.map(q=>`[${q}]`).join("")}`;this.errors.push(new fe(M,h))}checkSubtype(h,b){const M=ye(h,b);return M&&this.error(M),M}}class Fo{constructor(h,b,M){this.type=ft,this.locale=M,this.caseSensitive=h,this.diacriticSensitive=b}static parse(h,b){if(h.length!==2)return b.error("Expected one argument.");const M=h[1];if(typeof M!="object"||Array.isArray(M))return b.error("Collator options argument must be an object.");const q=b.parse(M["case-sensitive"]!==void 0&&M["case-sensitive"],1,We);if(!q)return null;const K=b.parse(M["diacritic-sensitive"]!==void 0&&M["diacritic-sensitive"],1,We);if(!K)return null;let J=null;return M.locale&&(J=b.parse(M.locale,1,ze),!J)?null:new Fo(q,K,J)}evaluate(h){return new qn(this.caseSensitive.evaluate(h),this.diacriticSensitive.evaluate(h),this.locale?this.locale.evaluate(h):null)}eachChild(h){h(this.caseSensitive),h(this.diacriticSensitive),this.locale&&h(this.locale)}outputDefined(){return!1}}const Va=8192;function Xs(m,h){m[0]=Math.min(m[0],h[0]),m[1]=Math.min(m[1],h[1]),m[2]=Math.max(m[2],h[0]),m[3]=Math.max(m[3],h[1])}function Zn(m,h){return!(m[0]<=h[0]||m[2]>=h[2]||m[1]<=h[1]||m[3]>=h[3])}function aa(m,h){const b=(180+m[0])/360,M=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+m[1]*Math.PI/360)))/360,q=Math.pow(2,h.z);return[Math.round(b*q*Va),Math.round(M*q*Va)]}function hs(m,h,b){const M=m[0]-h[0],q=m[1]-h[1],K=m[0]-b[0],J=m[1]-b[1];return M*J-K*q==0&&M*K<=0&&q*J<=0}function Ua(m,h){let b=!1;for(let J=0,me=h.length;J<me;J++){const Ce=h[J];for(let Ne=0,f=Ce.length;Ne<f-1;Ne++){if(hs(m,Ce[Ne],Ce[Ne+1]))return!1;(q=Ce[Ne])[1]>(M=m)[1]!=(K=Ce[Ne+1])[1]>M[1]&&M[0]<(K[0]-q[0])*(M[1]-q[1])/(K[1]-q[1])+q[0]&&(b=!b)}}var M,q,K;return b}function al(m,h){for(let b=0;b<h.length;b++)if(Ua(m,h[b]))return!0;return!1}function ol(m,h,b,M){const q=M[0]-b[0],K=M[1]-b[1],J=(m[0]-b[0])*K-q*(m[1]-b[1]),me=(h[0]-b[0])*K-q*(h[1]-b[1]);return J>0&&me<0||J<0&&me>0}function no(m,h,b){for(const Ne of b)for(let f=0;f<Ne.length-1;++f)if((me=[(J=Ne[f+1])[0]-(K=Ne[f])[0],J[1]-K[1]])[0]*(Ce=[(q=h)[0]-(M=m)[0],q[1]-M[1]])[1]-me[1]*Ce[0]!=0&&ol(M,q,K,J)&&ol(K,J,M,q))return!0;var M,q,K,J,me,Ce;return!1}function Ga(m,h){for(let b=0;b<m.length;++b)if(!Ua(m[b],h))return!1;for(let b=0;b<m.length-1;++b)if(no(m[b],m[b+1],h))return!1;return!0}function N(m,h){for(let b=0;b<h.length;b++)if(Ga(m,h[b]))return!0;return!1}function xe(m,h,b){const M=[];for(let q=0;q<m.length;q++){const K=[];for(let J=0;J<m[q].length;J++){const me=aa(m[q][J],b);Xs(h,me),K.push(me)}M.push(K)}return M}function rt(m,h,b){const M=[];for(let q=0;q<m.length;q++){const K=xe(m[q],h,b);M.push(K)}return M}function St(m,h,b,M){if(m[0]<b[0]||m[0]>b[2]){const q=.5*M;let K=m[0]-b[0]>q?-M:b[0]-m[0]>q?M:0;K===0&&(K=m[0]-b[2]>q?-M:b[2]-m[0]>q?M:0),m[0]+=K}Xs(h,m)}function $t(m,h,b,M){const q=Math.pow(2,M.z)*Va,K=[M.x*Va,M.y*Va],J=[];for(const me of m)for(const Ce of me){const Ne=[Ce.x+K[0],Ce.y+K[1]];St(Ne,h,b,q),J.push(Ne)}return J}function Ii(m,h,b,M){const q=Math.pow(2,M.z)*Va,K=[M.x*Va,M.y*Va],J=[];for(const Ce of m){const Ne=[];for(const f of Ce){const u=[f.x+K[0],f.y+K[1]];Xs(h,u),Ne.push(u)}J.push(Ne)}if(h[2]-h[0]<=q/2){(me=h)[0]=me[1]=1/0,me[2]=me[3]=-1/0;for(const Ce of J)for(const Ne of Ce)St(Ne,h,b,q)}var me;return J}class Li{constructor(h,b){this.type=We,this.geojson=h,this.geometries=b}static parse(h,b){if(h.length!==2)return b.error(`'within' expression requires exactly one argument, but found ${h.length-1} instead.`);if(Tn(h[1])){const M=h[1];if(M.type==="FeatureCollection"){const q=[];for(const K of M.features){const{type:J,coordinates:me}=K.geometry;J==="Polygon"&&q.push(me),J==="MultiPolygon"&&q.push(...me)}if(q.length)return new Li(M,{type:"MultiPolygon",coordinates:q})}else if(M.type==="Feature"){const q=M.geometry.type;if(q==="Polygon"||q==="MultiPolygon")return new Li(M,M.geometry)}else if(M.type==="Polygon"||M.type==="MultiPolygon")return new Li(M,M)}return b.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(h){if(h.geometry()!=null&&h.canonicalID()!=null){if(h.geometryType()==="Point")return function(b,M){const q=[1/0,1/0,-1/0,-1/0],K=[1/0,1/0,-1/0,-1/0],J=b.canonicalID();if(M.type==="Polygon"){const me=xe(M.coordinates,K,J),Ce=$t(b.geometry(),q,K,J);if(!Zn(q,K))return!1;for(const Ne of Ce)if(!Ua(Ne,me))return!1}if(M.type==="MultiPolygon"){const me=rt(M.coordinates,K,J),Ce=$t(b.geometry(),q,K,J);if(!Zn(q,K))return!1;for(const Ne of Ce)if(!al(Ne,me))return!1}return!0}(h,this.geometries);if(h.geometryType()==="LineString")return function(b,M){const q=[1/0,1/0,-1/0,-1/0],K=[1/0,1/0,-1/0,-1/0],J=b.canonicalID();if(M.type==="Polygon"){const me=xe(M.coordinates,K,J),Ce=Ii(b.geometry(),q,K,J);if(!Zn(q,K))return!1;for(const Ne of Ce)if(!Ga(Ne,me))return!1}if(M.type==="MultiPolygon"){const me=rt(M.coordinates,K,J),Ce=Ii(b.geometry(),q,K,J);if(!Zn(q,K))return!1;for(const Ne of Ce)if(!N(Ne,me))return!1}return!0}(h,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class An{constructor(h,b){this.type=b.type,this.name=h,this.boundExpression=b}static parse(h,b){if(h.length!==2||typeof h[1]!="string")return b.error("'var' expression requires exactly one string literal argument.");const M=h[1];return b.scope.has(M)?new An(M,b.scope.get(M)):b.error(`Unknown variable "${M}". Make sure "${M}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(h){return this.boundExpression.evaluate(h)}eachChild(){}outputDefined(){return!1}}class pn{constructor(h,b,M,q){this.name=h,this.type=b,this._evaluate=M,this.args=q}evaluate(h){return this._evaluate(h,this.args)}eachChild(h){this.args.forEach(h)}outputDefined(){return!1}static parse(h,b){const M=h[0],q=pn.definitions[M];if(!q)return b.error(`Unknown expression "${M}". If you wanted a literal array, use ["literal", [...]].`,0);const K=Array.isArray(q)?q[0]:q.type,J=Array.isArray(q)?[[q[1],q[2]]]:q.overloads,me=J.filter(([Ne])=>!Array.isArray(Ne)||Ne.length===h.length-1);let Ce=null;for(const[Ne,f]of me){Ce=new Na(b.registry,sr,b.path,null,b.scope);const u=[];let p=!1;for(let I=1;I<h.length;I++){const L=h[I],U=Array.isArray(Ne)?Ne[I-1]:Ne.type,Q=Ce.parse(L,1+u.length,U);if(!Q){p=!0;break}u.push(Q)}if(!p)if(Array.isArray(Ne)&&Ne.length!==u.length)Ce.error(`Expected ${Ne.length} arguments, but found ${u.length} instead.`);else{for(let I=0;I<u.length;I++){const L=Array.isArray(Ne)?Ne[I]:Ne.type,U=u[I];Ce.concat(I+1).checkSubtype(L,U.type)}if(Ce.errors.length===0)return new pn(M,K,f,u)}}if(me.length===1)b.errors.push(...Ce.errors);else{const Ne=(me.length?me:J).map(([u])=>{return p=u,Array.isArray(p)?`(${p.map(ie).join(", ")})`:`(${ie(p.type)}...)`;var p}).join(" | "),f=[];for(let u=1;u<h.length;u++){const p=b.parse(h[u],1+f.length);if(!p)return null;f.push(ie(p.type))}b.error(`Expected arguments of type ${Ne}, but found (${f.join(", ")}) instead.`)}return null}static register(h,b){pn.definitions=b;for(const M in b)h[M]=pn}}function sr(m){if(m instanceof An)return sr(m.boundExpression);if(m instanceof pn&&m.name==="error"||m instanceof Fo||m instanceof Li)return!1;const h=m instanceof Us||m instanceof Bt;let b=!0;return m.eachChild(M=>{b=h?b&&sr(M):b&&M instanceof Ur}),!!b&&Ar(m)&&qa(m,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ar(m){if(m instanceof pn&&(m.name==="get"&&m.args.length===1||m.name==="feature-state"||m.name==="has"&&m.args.length===1||m.name==="properties"||m.name==="geometry-type"||m.name==="id"||/^filter-/.test(m.name))||m instanceof Li)return!1;let h=!0;return m.eachChild(b=>{h&&!Ar(b)&&(h=!1)}),h}function Or(m){if(m instanceof pn&&m.name==="feature-state")return!1;let h=!0;return m.eachChild(b=>{h&&!Or(b)&&(h=!1)}),h}function qa(m,h){if(m instanceof pn&&h.indexOf(m.name)>=0)return!1;let b=!0;return m.eachChild(M=>{b&&!qa(M,h)&&(b=!1)}),b}function Ha(m,h){const b=m.length-1;let M,q,K=0,J=b,me=0;for(;K<=J;)if(me=Math.floor((K+J)/2),M=m[me],q=m[me+1],M<=h){if(me===b||h<q)return me;K=me+1}else{if(!(M>h))throw new Vt("Input is not a number.");J=me-1}return 0}class ja{constructor(h,b,M){this.type=h,this.input=b,this.labels=[],this.outputs=[];for(const[q,K]of M)this.labels.push(q),this.outputs.push(K)}static parse(h,b){if(h.length-1<4)return b.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if((h.length-1)%2!=0)return b.error("Expected an even number of arguments.");const M=b.parse(h[1],1,Ee);if(!M)return null;const q=[];let K=null;b.expectedType&&b.expectedType.kind!=="value"&&(K=b.expectedType);for(let J=1;J<h.length;J+=2){const me=J===1?-1/0:h[J],Ce=h[J+1],Ne=J,f=J+1;if(typeof me!="number")return b.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Ne);if(q.length&&q[q.length-1][0]>=me)return b.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Ne);const u=b.parse(Ce,f,K);if(!u)return null;K=K||u.type,q.push([me,u])}return new ja(K,M,q)}evaluate(h){const b=this.labels,M=this.outputs;if(b.length===1)return M[0].evaluate(h);const q=this.input.evaluate(h);if(q<=b[0])return M[0].evaluate(h);const K=b.length;return q>=b[K-1]?M[K-1].evaluate(h):M[Ha(b,q)].evaluate(h)}eachChild(h){h(this.input);for(const b of this.outputs)h(b)}outputDefined(){return this.outputs.every(h=>h.outputDefined())}}function pl(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}var Gr=nr;function nr(m,h,b,M){this.cx=3*m,this.bx=3*(b-m)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(M-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=m,this.p1y=h,this.p2x=b,this.p2y=M}nr.prototype={sampleCurveX:function(m){return((this.ax*m+this.bx)*m+this.cx)*m},sampleCurveY:function(m){return((this.ay*m+this.by)*m+this.cy)*m},sampleCurveDerivativeX:function(m){return(3*this.ax*m+2*this.bx)*m+this.cx},solveCurveX:function(m,h){if(h===void 0&&(h=1e-6),m<0)return 0;if(m>1)return 1;for(var b=m,M=0;M<8;M++){var q=this.sampleCurveX(b)-m;if(Math.abs(q)<h)return b;var K=this.sampleCurveDerivativeX(b);if(Math.abs(K)<1e-6)break;b-=q/K}var J=0,me=1;for(b=m,M=0;M<20&&(q=this.sampleCurveX(b),!(Math.abs(q-m)<h));M++)m>q?J=b:me=b,b=.5*(me-J)+J;return b},solve:function(m,h){return this.sampleCurveY(this.solveCurveX(m,h))}};var Ir=pl(Gr);function Lr(m,h,b){return m+b*(h-m)}function Zs(m,h,b){return m.map((M,q)=>Lr(M,h[q],b))}const vr={number:Lr,color:function(m,h,b,M="rgb"){switch(M){case"rgb":{const[q,K,J,me]=Zs(m.rgb,h.rgb,b);return new mn(q,K,J,me,!1)}case"hcl":{const[q,K,J,me]=m.hcl,[Ce,Ne,f,u]=h.hcl;let p,I;if(isNaN(q)||isNaN(Ce))isNaN(q)?isNaN(Ce)?p=NaN:(p=Ce,J!==1&&J!==0||(I=Ne)):(p=q,f!==1&&f!==0||(I=K));else{let Ae=Ce-q;Ce>q&&Ae>180?Ae-=360:Ce<q&&q-Ce>180&&(Ae+=360),p=q+b*Ae}const[L,U,Q,re]=function([Ae,_e,Le,qe]){return Ae=isNaN(Ae)?0:Ae*kt,Jt([Le,Math.cos(Ae)*_e,Math.sin(Ae)*_e,qe])}([p,I??Lr(K,Ne,b),Lr(J,f,b),Lr(me,u,b)]);return new mn(L,U,Q,re,!1)}case"lab":{const[q,K,J,me]=Jt(Zs(m.lab,h.lab,b));return new mn(q,K,J,me,!1)}}},array:Zs,padding:function(m,h,b){return new ur(Zs(m.values,h.values,b))},variableAnchorOffsetCollection:function(m,h,b){const M=m.values,q=h.values;if(M.length!==q.length)throw new Vt(`Cannot interpolate values of different length. from: ${m.toString()}, to: ${h.toString()}`);const K=[];for(let J=0;J<M.length;J+=2){if(M[J]!==q[J])throw new Vt(`Cannot interpolate values containing mismatched anchors. from[${J}]: ${M[J]}, to[${J}]: ${q[J]}`);K.push(M[J]);const[me,Ce]=M[J+1],[Ne,f]=q[J+1];K.push([Lr(me,Ne,b),Lr(Ce,f,b)])}return new Wt(K)}};class Ks{constructor(h,b,M,q,K){this.type=h,this.operator=b,this.interpolation=M,this.input=q,this.labels=[],this.outputs=[];for(const[J,me]of K)this.labels.push(J),this.outputs.push(me)}static interpolationFactor(h,b,M,q){let K=0;if(h.name==="exponential")K=Br(b,h.base,M,q);else if(h.name==="linear")K=Br(b,1,M,q);else if(h.name==="cubic-bezier"){const J=h.controlPoints;K=new Ir(J[0],J[1],J[2],J[3]).solve(Br(b,1,M,q))}return K}static parse(h,b){let[M,q,K,...J]=h;if(!Array.isArray(q)||q.length===0)return b.error("Expected an interpolation type expression.",1);if(q[0]==="linear")q={name:"linear"};else if(q[0]==="exponential"){const Ne=q[1];if(typeof Ne!="number")return b.error("Exponential interpolation requires a numeric base.",1,1);q={name:"exponential",base:Ne}}else{if(q[0]!=="cubic-bezier")return b.error(`Unknown interpolation type ${String(q[0])}`,1,0);{const Ne=q.slice(1);if(Ne.length!==4||Ne.some(f=>typeof f!="number"||f<0||f>1))return b.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);q={name:"cubic-bezier",controlPoints:Ne}}}if(h.length-1<4)return b.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if((h.length-1)%2!=0)return b.error("Expected an even number of arguments.");if(K=b.parse(K,2,Ee),!K)return null;const me=[];let Ce=null;M==="interpolate-hcl"||M==="interpolate-lab"?Ce=He:b.expectedType&&b.expectedType.kind!=="value"&&(Ce=b.expectedType);for(let Ne=0;Ne<J.length;Ne+=2){const f=J[Ne],u=J[Ne+1],p=Ne+3,I=Ne+4;if(typeof f!="number")return b.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(me.length&&me[me.length-1][0]>=f)return b.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',p);const L=b.parse(u,I,Ce);if(!L)return null;Ce=Ce||L.type,me.push([f,L])}return Fe(Ce,Ee)||Fe(Ce,He)||Fe(Ce,Me)||Fe(Ce,ne)||Fe(Ce,$(Ee))?new Ks(Ce,M,q,K,me):b.error(`Type ${ie(Ce)} is not interpolatable.`)}evaluate(h){const b=this.labels,M=this.outputs;if(b.length===1)return M[0].evaluate(h);const q=this.input.evaluate(h);if(q<=b[0])return M[0].evaluate(h);const K=b.length;if(q>=b[K-1])return M[K-1].evaluate(h);const J=Ha(b,q),me=Ks.interpolationFactor(this.interpolation,q,b[J],b[J+1]),Ce=M[J].evaluate(h),Ne=M[J+1].evaluate(h);switch(this.operator){case"interpolate":return vr[this.type.kind](Ce,Ne,me);case"interpolate-hcl":return vr.color(Ce,Ne,me,"hcl");case"interpolate-lab":return vr.color(Ce,Ne,me,"lab")}}eachChild(h){h(this.input);for(const b of this.outputs)h(b)}outputDefined(){return this.outputs.every(h=>h.outputDefined())}}function Br(m,h,b,M){const q=M-b,K=m-b;return q===0?0:h===1?K/q:(Math.pow(h,K)-1)/(Math.pow(h,q)-1)}class Eo{constructor(h,b){this.type=h,this.args=b}static parse(h,b){if(h.length<2)return b.error("Expectected at least one argument.");let M=null;const q=b.expectedType;q&&q.kind!=="value"&&(M=q);const K=[];for(const me of h.slice(1)){const Ce=b.parse(me,1+K.length,M,void 0,{typeAnnotation:"omit"});if(!Ce)return null;M=M||Ce.type,K.push(Ce)}if(!M)throw new Error("No output type");const J=q&&K.some(me=>ye(q,me.type));return new Eo(J?Ue:M,K)}evaluate(h){let b,M=null,q=0;for(const K of this.args)if(q++,M=K.evaluate(h),M&&M instanceof Ki&&!M.available&&(b||(b=M.name),M=null,q===this.args.length&&(M=b)),M!==null)break;return M}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}}class Zo{constructor(h,b){this.type=b.type,this.bindings=[].concat(h),this.result=b}evaluate(h){return this.result.evaluate(h)}eachChild(h){for(const b of this.bindings)h(b[1]);h(this.result)}static parse(h,b){if(h.length<4)return b.error(`Expected at least 3 arguments, but found ${h.length-1} instead.`);const M=[];for(let K=1;K<h.length-1;K+=2){const J=h[K];if(typeof J!="string")return b.error(`Expected string, but found ${typeof J} instead.`,K);if(/[^a-zA-Z0-9_]/.test(J))return b.error("Variable names must contain only alphanumeric characters or '_'.",K);const me=b.parse(h[K+1],K+1);if(!me)return null;M.push([J,me])}const q=b.parse(h[h.length-1],h.length-1,b.expectedType,M);return q?new Zo(M,q):null}outputDefined(){return this.result.outputDefined()}}class Bs{constructor(h,b,M){this.type=h,this.index=b,this.input=M}static parse(h,b){if(h.length!==3)return b.error(`Expected 2 arguments, but found ${h.length-1} instead.`);const M=b.parse(h[1],1,Ee),q=b.parse(h[2],2,$(b.expectedType||Ue));return M&&q?new Bs(q.type.itemType,M,q):null}evaluate(h){const b=this.index.evaluate(h),M=this.input.evaluate(h);if(b<0)throw new Vt(`Array index out of bounds: ${b} < 0.`);if(b>=M.length)throw new Vt(`Array index out of bounds: ${b} > ${M.length-1}.`);if(b!==Math.floor(b))throw new Vt(`Array index must be an integer, but found ${b} instead.`);return M[b]}eachChild(h){h(this.index),h(this.input)}outputDefined(){return!1}}class Il{constructor(h,b){this.type=We,this.needle=h,this.haystack=b}static parse(h,b){if(h.length!==3)return b.error(`Expected 2 arguments, but found ${h.length-1} instead.`);const M=b.parse(h[1],1,Ue),q=b.parse(h[2],2,Ue);return M&&q?ge(M.type,[We,ze,Ee,Ie,Ue])?new Il(M,q):b.error(`Expected first argument to be of type boolean, string, number or null, but found ${ie(M.type)} instead`):null}evaluate(h){const b=this.needle.evaluate(h),M=this.haystack.evaluate(h);if(!M)return!1;if(!Pe(b,["boolean","string","number","null"]))throw new Vt(`Expected first argument to be of type boolean, string, number or null, but found ${ie(cr(b))} instead.`);if(!Pe(M,["string","array"]))throw new Vt(`Expected second argument to be of type array or string, but found ${ie(cr(M))} instead.`);return M.indexOf(b)>=0}eachChild(h){h(this.needle),h(this.haystack)}outputDefined(){return!0}}class mo{constructor(h,b,M){this.type=Ee,this.needle=h,this.haystack=b,this.fromIndex=M}static parse(h,b){if(h.length<=2||h.length>=5)return b.error(`Expected 3 or 4 arguments, but found ${h.length-1} instead.`);const M=b.parse(h[1],1,Ue),q=b.parse(h[2],2,Ue);if(!M||!q)return null;if(!ge(M.type,[We,ze,Ee,Ie,Ue]))return b.error(`Expected first argument to be of type boolean, string, number or null, but found ${ie(M.type)} instead`);if(h.length===4){const K=b.parse(h[3],3,Ee);return K?new mo(M,q,K):null}return new mo(M,q)}evaluate(h){const b=this.needle.evaluate(h),M=this.haystack.evaluate(h);if(!Pe(b,["boolean","string","number","null"]))throw new Vt(`Expected first argument to be of type boolean, string, number or null, but found ${ie(cr(b))} instead.`);if(!Pe(M,["string","array"]))throw new Vt(`Expected second argument to be of type array or string, but found ${ie(cr(M))} instead.`);if(this.fromIndex){const q=this.fromIndex.evaluate(h);return M.indexOf(b,q)}return M.indexOf(b)}eachChild(h){h(this.needle),h(this.haystack),this.fromIndex&&h(this.fromIndex)}outputDefined(){return!1}}class Qo{constructor(h,b,M,q,K,J){this.inputType=h,this.type=b,this.input=M,this.cases=q,this.outputs=K,this.otherwise=J}static parse(h,b){if(h.length<5)return b.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if(h.length%2!=1)return b.error("Expected an even number of arguments.");let M,q;b.expectedType&&b.expectedType.kind!=="value"&&(q=b.expectedType);const K={},J=[];for(let Ne=2;Ne<h.length-1;Ne+=2){let f=h[Ne];const u=h[Ne+1];Array.isArray(f)||(f=[f]);const p=b.concat(Ne);if(f.length===0)return p.error("Expected at least one branch label.");for(const L of f){if(typeof L!="number"&&typeof L!="string")return p.error("Branch labels must be numbers or strings.");if(typeof L=="number"&&Math.abs(L)>Number.MAX_SAFE_INTEGER)return p.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof L=="number"&&Math.floor(L)!==L)return p.error("Numeric branch labels must be integer values.");if(M){if(p.checkSubtype(M,cr(L)))return null}else M=cr(L);if(K[String(L)]!==void 0)return p.error("Branch labels must be unique.");K[String(L)]=J.length}const I=b.parse(u,Ne,q);if(!I)return null;q=q||I.type,J.push(I)}const me=b.parse(h[1],1,Ue);if(!me)return null;const Ce=b.parse(h[h.length-1],h.length-1,q);return Ce?me.type.kind!=="value"&&b.concat(1).checkSubtype(M,me.type)?null:new Qo(M,q,me,K,J,Ce):null}evaluate(h){const b=this.input.evaluate(h);return(cr(b)===this.inputType&&this.outputs[this.cases[b]]||this.otherwise).evaluate(h)}eachChild(h){h(this.input),this.outputs.forEach(h),h(this.otherwise)}outputDefined(){return this.outputs.every(h=>h.outputDefined())&&this.otherwise.outputDefined()}}class ca{constructor(h,b,M){this.type=h,this.branches=b,this.otherwise=M}static parse(h,b){if(h.length<4)return b.error(`Expected at least 3 arguments, but found only ${h.length-1}.`);if(h.length%2!=0)return b.error("Expected an odd number of arguments.");let M;b.expectedType&&b.expectedType.kind!=="value"&&(M=b.expectedType);const q=[];for(let J=1;J<h.length-1;J+=2){const me=b.parse(h[J],J,We);if(!me)return null;const Ce=b.parse(h[J+1],J+1,M);if(!Ce)return null;q.push([me,Ce]),M=M||Ce.type}const K=b.parse(h[h.length-1],h.length-1,M);if(!K)return null;if(!M)throw new Error("Can't infer output type");return new ca(M,q,K)}evaluate(h){for(const[b,M]of this.branches)if(b.evaluate(h))return M.evaluate(h);return this.otherwise.evaluate(h)}eachChild(h){for(const[b,M]of this.branches)h(b),h(M);h(this.otherwise)}outputDefined(){return this.branches.every(([h,b])=>b.outputDefined())&&this.otherwise.outputDefined()}}class Ys{constructor(h,b,M,q){this.type=h,this.input=b,this.beginIndex=M,this.endIndex=q}static parse(h,b){if(h.length<=2||h.length>=5)return b.error(`Expected 3 or 4 arguments, but found ${h.length-1} instead.`);const M=b.parse(h[1],1,Ue),q=b.parse(h[2],2,Ee);if(!M||!q)return null;if(!ge(M.type,[$(Ue),ze,Ue]))return b.error(`Expected first argument to be of type array or string, but found ${ie(M.type)} instead`);if(h.length===4){const K=b.parse(h[3],3,Ee);return K?new Ys(M.type,M,q,K):null}return new Ys(M.type,M,q)}evaluate(h){const b=this.input.evaluate(h),M=this.beginIndex.evaluate(h);if(!Pe(b,["string","array"]))throw new Vt(`Expected first argument to be of type array or string, but found ${ie(cr(b))} instead.`);if(this.endIndex){const q=this.endIndex.evaluate(h);return b.slice(M,q)}return b.slice(M)}eachChild(h){h(this.input),h(this.beginIndex),this.endIndex&&h(this.endIndex)}outputDefined(){return!1}}function El(m,h){return m==="=="||m==="!="?h.kind==="boolean"||h.kind==="string"||h.kind==="number"||h.kind==="null"||h.kind==="value":h.kind==="string"||h.kind==="number"||h.kind==="value"}function Za(m,h,b,M){return M.compare(h,b)===0}function Ta(m,h,b){const M=m!=="=="&&m!=="!=";return class p3{constructor(K,J,me){this.type=We,this.lhs=K,this.rhs=J,this.collator=me,this.hasUntypedArgument=K.type.kind==="value"||J.type.kind==="value"}static parse(K,J){if(K.length!==3&&K.length!==4)return J.error("Expected two or three arguments.");const me=K[0];let Ce=J.parse(K[1],1,Ue);if(!Ce)return null;if(!El(me,Ce.type))return J.concat(1).error(`"${me}" comparisons are not supported for type '${ie(Ce.type)}'.`);let Ne=J.parse(K[2],2,Ue);if(!Ne)return null;if(!El(me,Ne.type))return J.concat(2).error(`"${me}" comparisons are not supported for type '${ie(Ne.type)}'.`);if(Ce.type.kind!==Ne.type.kind&&Ce.type.kind!=="value"&&Ne.type.kind!=="value")return J.error(`Cannot compare types '${ie(Ce.type)}' and '${ie(Ne.type)}'.`);M&&(Ce.type.kind==="value"&&Ne.type.kind!=="value"?Ce=new Bt(Ne.type,[Ce]):Ce.type.kind!=="value"&&Ne.type.kind==="value"&&(Ne=new Bt(Ce.type,[Ne])));let f=null;if(K.length===4){if(Ce.type.kind!=="string"&&Ne.type.kind!=="string"&&Ce.type.kind!=="value"&&Ne.type.kind!=="value")return J.error("Cannot use collator to compare non-string types.");if(f=J.parse(K[3],3,ft),!f)return null}return new p3(Ce,Ne,f)}evaluate(K){const J=this.lhs.evaluate(K),me=this.rhs.evaluate(K);if(M&&this.hasUntypedArgument){const Ce=cr(J),Ne=cr(me);if(Ce.kind!==Ne.kind||Ce.kind!=="string"&&Ce.kind!=="number")throw new Vt(`Expected arguments for "${m}" to be (string, string) or (number, number), but found (${Ce.kind}, ${Ne.kind}) instead.`)}if(this.collator&&!M&&this.hasUntypedArgument){const Ce=cr(J),Ne=cr(me);if(Ce.kind!=="string"||Ne.kind!=="string")return h(K,J,me)}return this.collator?b(K,J,me,this.collator.evaluate(K)):h(K,J,me)}eachChild(K){K(this.lhs),K(this.rhs),this.collator&&K(this.collator)}outputDefined(){return!0}}}const ml=Ta("==",function(m,h,b){return h===b},Za),Cl=Ta("!=",function(m,h,b){return h!==b},function(m,h,b,M){return!Za(0,h,b,M)}),mu=Ta("<",function(m,h,b){return h<b},function(m,h,b,M){return M.compare(h,b)<0}),As=Ta(">",function(m,h,b){return h>b},function(m,h,b,M){return M.compare(h,b)>0}),ac=Ta("<=",function(m,h,b){return h<=b},function(m,h,b,M){return M.compare(h,b)<=0}),ro=Ta(">=",function(m,h,b){return h>=b},function(m,h,b,M){return M.compare(h,b)>=0});class so{constructor(h,b,M,q,K){this.type=ze,this.number=h,this.locale=b,this.currency=M,this.minFractionDigits=q,this.maxFractionDigits=K}static parse(h,b){if(h.length!==3)return b.error("Expected two arguments.");const M=b.parse(h[1],1,Ee);if(!M)return null;const q=h[2];if(typeof q!="object"||Array.isArray(q))return b.error("NumberFormat options argument must be an object.");let K=null;if(q.locale&&(K=b.parse(q.locale,1,ze),!K))return null;let J=null;if(q.currency&&(J=b.parse(q.currency,1,ze),!J))return null;let me=null;if(q["min-fraction-digits"]&&(me=b.parse(q["min-fraction-digits"],1,Ee),!me))return null;let Ce=null;return q["max-fraction-digits"]&&(Ce=b.parse(q["max-fraction-digits"],1,Ee),!Ce)?null:new so(M,K,J,me,Ce)}evaluate(h){return new Intl.NumberFormat(this.locale?this.locale.evaluate(h):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(h):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(h):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(h):void 0}).format(this.number.evaluate(h))}eachChild(h){h(this.number),this.locale&&h(this.locale),this.currency&&h(this.currency),this.minFractionDigits&&h(this.minFractionDigits),this.maxFractionDigits&&h(this.maxFractionDigits)}outputDefined(){return!1}}class Ql{constructor(h){this.type=st,this.sections=h}static parse(h,b){if(h.length<2)return b.error("Expected at least one argument.");const M=h[1];if(!Array.isArray(M)&&typeof M=="object")return b.error("First argument must be an image or text section.");const q=[];let K=!1;for(let J=1;J<=h.length-1;++J){const me=h[J];if(K&&typeof me=="object"&&!Array.isArray(me)){K=!1;let Ce=null;if(me["font-scale"]&&(Ce=b.parse(me["font-scale"],1,Ee),!Ce))return null;let Ne=null;if(me["text-font"]&&(Ne=b.parse(me["text-font"],1,$(ze)),!Ne))return null;let f=null;if(me["text-color"]&&(f=b.parse(me["text-color"],1,He),!f))return null;const u=q[q.length-1];u.scale=Ce,u.font=Ne,u.textColor=f}else{const Ce=b.parse(h[J],1,Ue);if(!Ce)return null;const Ne=Ce.type.kind;if(Ne!=="string"&&Ne!=="value"&&Ne!=="null"&&Ne!=="resolvedImage")return b.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");K=!0,q.push({content:Ce,scale:null,font:null,textColor:null})}}return new Ql(q)}evaluate(h){return new Zi(this.sections.map(b=>{const M=b.content.evaluate(h);return cr(M)===se?new jr("",M,null,null,null):new jr(Vs(M),null,b.scale?b.scale.evaluate(h):null,b.font?b.font.evaluate(h).join(","):null,b.textColor?b.textColor.evaluate(h):null)}))}eachChild(h){for(const b of this.sections)h(b.content),b.scale&&h(b.scale),b.font&&h(b.font),b.textColor&&h(b.textColor)}outputDefined(){return!1}}class Oo{constructor(h){this.type=se,this.input=h}static parse(h,b){if(h.length!==2)return b.error("Expected two arguments.");const M=b.parse(h[1],1,ze);return M?new Oo(M):b.error("No image name provided.")}evaluate(h){const b=this.input.evaluate(h),M=Ki.fromString(b);return M&&h.availableImages&&(M.available=h.availableImages.indexOf(b)>-1),M}eachChild(h){h(this.input)}outputDefined(){return!1}}class Wo{constructor(h){this.type=Ee,this.input=h}static parse(h,b){if(h.length!==2)return b.error(`Expected 1 argument, but found ${h.length-1} instead.`);const M=b.parse(h[1],1);return M?M.type.kind!=="array"&&M.type.kind!=="string"&&M.type.kind!=="value"?b.error(`Expected argument of type string or array, but found ${ie(M.type)} instead.`):new Wo(M):null}evaluate(h){const b=this.input.evaluate(h);if(typeof b=="string"||Array.isArray(b))return b.length;throw new Vt(`Expected value to be of type string or array, but found ${ie(cr(b))} instead.`)}eachChild(h){h(this.input)}outputDefined(){return!1}}const Co={"==":ml,"!=":Cl,">":As,"<":mu,">=":ro,"<=":ac,array:Bt,at:Bs,boolean:Bt,case:ca,coalesce:Eo,collator:Fo,format:Ql,image:Oo,in:Il,"index-of":mo,interpolate:Ks,"interpolate-hcl":Ks,"interpolate-lab":Ks,length:Wo,let:Zo,literal:Ur,match:Qo,number:Bt,"number-format":so,object:Bt,slice:Ys,step:ja,string:Bt,"to-boolean":Us,"to-color":Us,"to-number":Us,"to-string":Us,var:An,within:Li};function Gs(m,[h,b,M,q]){h=h.evaluate(m),b=b.evaluate(m),M=M.evaluate(m);const K=q?q.evaluate(m):1,J=Ut(h,b,M,K);if(J)throw new Vt(J);return new mn(h/255,b/255,M/255,K,!1)}function $o(m,h){return m in h}function Xo(m,h){const b=h[m];return b===void 0?null:b}function Yo(m){return{type:m}}function ba(m){return{result:"success",value:m}}function Qa(m){return{result:"error",value:m}}function Cs(m){return m["property-type"]==="data-driven"||m["property-type"]==="cross-faded-data-driven"}function gu(m){return!!m.expression&&m.expression.parameters.indexOf("zoom")>-1}function Er(m){return!!m.expression&&m.expression.interpolated}function $n(m){return m instanceof Number?"number":m instanceof String?"string":m instanceof Boolean?"boolean":Array.isArray(m)?"array":m===null?"null":typeof m}function Ko(m){return typeof m=="object"&&m!==null&&!Array.isArray(m)}function zr(m){return m}function Wa(m,h){const b=h.type==="color",M=m.stops&&typeof m.stops[0][0]=="object",q=M||!(M||m.property!==void 0),K=m.type||(Er(h)?"exponential":"interval");if(b||h.type==="padding"){const f=b?mn.parse:ur.parse;(m=te({},m)).stops&&(m.stops=m.stops.map(u=>[u[0],f(u[1])])),m.default=f(m.default?m.default:h.default)}if(m.colorSpace&&(J=m.colorSpace)!=="rgb"&&J!=="hcl"&&J!=="lab")throw new Error(`Unknown color space: "${m.colorSpace}"`);var J;let me,Ce,Ne;if(K==="exponential")me=Gn;else if(K==="interval")me=To;else if(K==="categorical"){me=fr,Ce=Object.create(null);for(const f of m.stops)Ce[f[0]]=f[1];Ne=typeof m.stops[0][0]}else{if(K!=="identity")throw new Error(`Unknown function type "${K}"`);me=Ol}if(M){const f={},u=[];for(let L=0;L<m.stops.length;L++){const U=m.stops[L],Q=U[0].zoom;f[Q]===void 0&&(f[Q]={zoom:Q,type:m.type,property:m.property,default:m.default,stops:[]},u.push(Q)),f[Q].stops.push([U[0].value,U[1]])}const p=[];for(const L of u)p.push([f[L].zoom,Wa(f[L],h)]);const I={name:"linear"};return{kind:"composite",interpolationType:I,interpolationFactor:Ks.interpolationFactor.bind(void 0,I),zoomStops:p.map(L=>L[0]),evaluate:({zoom:L},U)=>Gn({stops:p,base:m.base},h,L).evaluate(L,U)}}if(q){const f=K==="exponential"?{name:"exponential",base:m.base!==void 0?m.base:1}:null;return{kind:"camera",interpolationType:f,interpolationFactor:Ks.interpolationFactor.bind(void 0,f),zoomStops:m.stops.map(u=>u[0]),evaluate:({zoom:u})=>me(m,h,u,Ce,Ne)}}return{kind:"source",evaluate(f,u){const p=u&&u.properties?u.properties[m.property]:void 0;return p===void 0?Jr(m.default,h.default):me(m,h,p,Ce,Ne)}}}function Jr(m,h,b){return m!==void 0?m:h!==void 0?h:b!==void 0?b:void 0}function fr(m,h,b,M,q){return Jr(typeof b===q?M[b]:void 0,m.default,h.default)}function To(m,h,b){if($n(b)!=="number")return Jr(m.default,h.default);const M=m.stops.length;if(M===1||b<=m.stops[0][0])return m.stops[0][1];if(b>=m.stops[M-1][0])return m.stops[M-1][1];const q=Ha(m.stops.map(K=>K[0]),b);return m.stops[q][1]}function Gn(m,h,b){const M=m.base!==void 0?m.base:1;if($n(b)!=="number")return Jr(m.default,h.default);const q=m.stops.length;if(q===1||b<=m.stops[0][0])return m.stops[0][1];if(b>=m.stops[q-1][0])return m.stops[q-1][1];const K=Ha(m.stops.map(f=>f[0]),b),J=function(f,u,p,I){const L=I-p,U=f-p;return L===0?0:u===1?U/L:(Math.pow(u,U)-1)/(Math.pow(u,L)-1)}(b,M,m.stops[K][0],m.stops[K+1][0]),me=m.stops[K][1],Ce=m.stops[K+1][1],Ne=vr[h.type]||zr;return typeof me.evaluate=="function"?{evaluate(...f){const u=me.evaluate.apply(void 0,f),p=Ce.evaluate.apply(void 0,f);if(u!==void 0&&p!==void 0)return Ne(u,p,J,m.colorSpace)}}:Ne(me,Ce,J,m.colorSpace)}function Ol(m,h,b){switch(h.type){case"color":b=mn.parse(b);break;case"formatted":b=Zi.fromString(b.toString());break;case"resolvedImage":b=Ki.fromString(b.toString());break;case"padding":b=ur.parse(b);break;default:$n(b)===h.type||h.type==="enum"&&h.values[b]||(b=void 0)}return Jr(b,m.default,h.default)}pn.register(Co,{error:[{kind:"error"},[ze],(m,[h])=>{throw new Vt(h.evaluate(m))}],typeof:[ze,[Ue],(m,[h])=>ie(cr(h.evaluate(m)))],"to-rgba":[$(Ee,4),[He],(m,[h])=>{const[b,M,q,K]=h.evaluate(m).rgb;return[255*b,255*M,255*q,K]}],rgb:[He,[Ee,Ee,Ee],Gs],rgba:[He,[Ee,Ee,Ee,Ee],Gs],has:{type:We,overloads:[[[ze],(m,[h])=>$o(h.evaluate(m),m.properties())],[[ze,Qe],(m,[h,b])=>$o(h.evaluate(m),b.evaluate(m))]]},get:{type:Ue,overloads:[[[ze],(m,[h])=>Xo(h.evaluate(m),m.properties())],[[ze,Qe],(m,[h,b])=>Xo(h.evaluate(m),b.evaluate(m))]]},"feature-state":[Ue,[ze],(m,[h])=>Xo(h.evaluate(m),m.featureState||{})],properties:[Qe,[],m=>m.properties()],"geometry-type":[ze,[],m=>m.geometryType()],id:[Ue,[],m=>m.id()],zoom:[Ee,[],m=>m.globals.zoom],"heatmap-density":[Ee,[],m=>m.globals.heatmapDensity||0],"line-progress":[Ee,[],m=>m.globals.lineProgress||0],accumulated:[Ue,[],m=>m.globals.accumulated===void 0?null:m.globals.accumulated],"+":[Ee,Yo(Ee),(m,h)=>{let b=0;for(const M of h)b+=M.evaluate(m);return b}],"*":[Ee,Yo(Ee),(m,h)=>{let b=1;for(const M of h)b*=M.evaluate(m);return b}],"-":{type:Ee,overloads:[[[Ee,Ee],(m,[h,b])=>h.evaluate(m)-b.evaluate(m)],[[Ee],(m,[h])=>-h.evaluate(m)]]},"/":[Ee,[Ee,Ee],(m,[h,b])=>h.evaluate(m)/b.evaluate(m)],"%":[Ee,[Ee,Ee],(m,[h,b])=>h.evaluate(m)%b.evaluate(m)],ln2:[Ee,[],()=>Math.LN2],pi:[Ee,[],()=>Math.PI],e:[Ee,[],()=>Math.E],"^":[Ee,[Ee,Ee],(m,[h,b])=>Math.pow(h.evaluate(m),b.evaluate(m))],sqrt:[Ee,[Ee],(m,[h])=>Math.sqrt(h.evaluate(m))],log10:[Ee,[Ee],(m,[h])=>Math.log(h.evaluate(m))/Math.LN10],ln:[Ee,[Ee],(m,[h])=>Math.log(h.evaluate(m))],log2:[Ee,[Ee],(m,[h])=>Math.log(h.evaluate(m))/Math.LN2],sin:[Ee,[Ee],(m,[h])=>Math.sin(h.evaluate(m))],cos:[Ee,[Ee],(m,[h])=>Math.cos(h.evaluate(m))],tan:[Ee,[Ee],(m,[h])=>Math.tan(h.evaluate(m))],asin:[Ee,[Ee],(m,[h])=>Math.asin(h.evaluate(m))],acos:[Ee,[Ee],(m,[h])=>Math.acos(h.evaluate(m))],atan:[Ee,[Ee],(m,[h])=>Math.atan(h.evaluate(m))],min:[Ee,Yo(Ee),(m,h)=>Math.min(...h.map(b=>b.evaluate(m)))],max:[Ee,Yo(Ee),(m,h)=>Math.max(...h.map(b=>b.evaluate(m)))],abs:[Ee,[Ee],(m,[h])=>Math.abs(h.evaluate(m))],round:[Ee,[Ee],(m,[h])=>{const b=h.evaluate(m);return b<0?-Math.round(-b):Math.round(b)}],floor:[Ee,[Ee],(m,[h])=>Math.floor(h.evaluate(m))],ceil:[Ee,[Ee],(m,[h])=>Math.ceil(h.evaluate(m))],"filter-==":[We,[ze,Ue],(m,[h,b])=>m.properties()[h.value]===b.value],"filter-id-==":[We,[Ue],(m,[h])=>m.id()===h.value],"filter-type-==":[We,[ze],(m,[h])=>m.geometryType()===h.value],"filter-<":[We,[ze,Ue],(m,[h,b])=>{const M=m.properties()[h.value],q=b.value;return typeof M==typeof q&&M<q}],"filter-id-<":[We,[Ue],(m,[h])=>{const b=m.id(),M=h.value;return typeof b==typeof M&&b<M}],"filter->":[We,[ze,Ue],(m,[h,b])=>{const M=m.properties()[h.value],q=b.value;return typeof M==typeof q&&M>q}],"filter-id->":[We,[Ue],(m,[h])=>{const b=m.id(),M=h.value;return typeof b==typeof M&&b>M}],"filter-<=":[We,[ze,Ue],(m,[h,b])=>{const M=m.properties()[h.value],q=b.value;return typeof M==typeof q&&M<=q}],"filter-id-<=":[We,[Ue],(m,[h])=>{const b=m.id(),M=h.value;return typeof b==typeof M&&b<=M}],"filter->=":[We,[ze,Ue],(m,[h,b])=>{const M=m.properties()[h.value],q=b.value;return typeof M==typeof q&&M>=q}],"filter-id->=":[We,[Ue],(m,[h])=>{const b=m.id(),M=h.value;return typeof b==typeof M&&b>=M}],"filter-has":[We,[Ue],(m,[h])=>h.value in m.properties()],"filter-has-id":[We,[],m=>m.id()!==null&&m.id()!==void 0],"filter-type-in":[We,[$(ze)],(m,[h])=>h.value.indexOf(m.geometryType())>=0],"filter-id-in":[We,[$(Ue)],(m,[h])=>h.value.indexOf(m.id())>=0],"filter-in-small":[We,[ze,$(Ue)],(m,[h,b])=>b.value.indexOf(m.properties()[h.value])>=0],"filter-in-large":[We,[ze,$(Ue)],(m,[h,b])=>function(M,q,K,J){for(;K<=J;){const me=K+J>>1;if(q[me]===M)return!0;q[me]>M?J=me-1:K=me+1}return!1}(m.properties()[h.value],b.value,0,b.value.length-1)],all:{type:We,overloads:[[[We,We],(m,[h,b])=>h.evaluate(m)&&b.evaluate(m)],[Yo(We),(m,h)=>{for(const b of h)if(!b.evaluate(m))return!1;return!0}]]},any:{type:We,overloads:[[[We,We],(m,[h,b])=>h.evaluate(m)||b.evaluate(m)],[Yo(We),(m,h)=>{for(const b of h)if(b.evaluate(m))return!0;return!1}]]},"!":[We,[We],(m,[h])=>!h.evaluate(m)],"is-supported-script":[We,[ze],(m,[h])=>{const b=m.globals&&m.globals.isSupportedScript;return!b||b(h.evaluate(m))}],upcase:[ze,[ze],(m,[h])=>h.evaluate(m).toUpperCase()],downcase:[ze,[ze],(m,[h])=>h.evaluate(m).toLowerCase()],concat:[ze,Yo(Ue),(m,h)=>h.map(b=>Vs(b.evaluate(m))).join("")],"resolved-locale":[ze,[ft],(m,[h])=>h.evaluate(m).resolvedLocale()]});class es{constructor(h,b){var M;this.expression=h,this._warningHistory={},this._evaluator=new Dr,this._defaultValue=b?(M=b).type==="color"&&Ko(M.default)?new mn(0,0,0,0):M.type==="color"?mn.parse(M.default)||null:M.type==="padding"?ur.parse(M.default)||null:M.type==="variableAnchorOffsetCollection"?Wt.parse(M.default)||null:M.default===void 0?null:M.default:null,this._enumValues=b&&b.type==="enum"?b.values:null}evaluateWithoutErrorHandling(h,b,M,q,K,J){return this._evaluator.globals=h,this._evaluator.feature=b,this._evaluator.featureState=M,this._evaluator.canonical=q,this._evaluator.availableImages=K||null,this._evaluator.formattedSection=J,this.expression.evaluate(this._evaluator)}evaluate(h,b,M,q,K,J){this._evaluator.globals=h,this._evaluator.feature=b||null,this._evaluator.featureState=M||null,this._evaluator.canonical=q,this._evaluator.availableImages=K||null,this._evaluator.formattedSection=J||null;try{const me=this.expression.evaluate(this._evaluator);if(me==null||typeof me=="number"&&me!=me)return this._defaultValue;if(this._enumValues&&!(me in this._enumValues))throw new Vt(`Expected value to be one of ${Object.keys(this._enumValues).map(Ce=>JSON.stringify(Ce)).join(", ")}, but found ${JSON.stringify(me)} instead.`);return me}catch(me){return this._warningHistory[me.message]||(this._warningHistory[me.message]=!0,typeof console<"u"&&console.warn(me.message)),this._defaultValue}}}function Zr(m){return Array.isArray(m)&&m.length>0&&typeof m[0]=="string"&&m[0]in Co}function Ts(m,h){const b=new Na(Co,sr,[],h?function(q){const K={color:He,string:ze,number:Ee,enum:ze,boolean:We,formatted:st,padding:Me,resolvedImage:se,variableAnchorOffsetCollection:ne};return q.type==="array"?$(K[q.value]||Ue,q.length):K[q.type]}(h):void 0),M=b.parse(m,void 0,void 0,void 0,h&&h.type==="string"?{typeAnnotation:"coerce"}:void 0);return M?ba(new es(M,h)):Qa(b.errors)}class kr{constructor(h,b){this.kind=h,this._styleExpression=b,this.isStateDependent=h!=="constant"&&!Or(b.expression)}evaluateWithoutErrorHandling(h,b,M,q,K,J){return this._styleExpression.evaluateWithoutErrorHandling(h,b,M,q,K,J)}evaluate(h,b,M,q,K,J){return this._styleExpression.evaluate(h,b,M,q,K,J)}}class rr{constructor(h,b,M,q){this.kind=h,this.zoomStops=M,this._styleExpression=b,this.isStateDependent=h!=="camera"&&!Or(b.expression),this.interpolationType=q}evaluateWithoutErrorHandling(h,b,M,q,K,J){return this._styleExpression.evaluateWithoutErrorHandling(h,b,M,q,K,J)}evaluate(h,b,M,q,K,J){return this._styleExpression.evaluate(h,b,M,q,K,J)}interpolationFactor(h,b,M){return this.interpolationType?Ks.interpolationFactor(this.interpolationType,h,b,M):0}}function ll(m,h){const b=Ts(m,h);if(b.result==="error")return b;const M=b.value.expression,q=Ar(M);if(!q&&!Cs(h))return Qa([new fe("","data expressions not supported")]);const K=qa(M,["zoom"]);if(!K&&!gu(h))return Qa([new fe("","zoom expressions not supported")]);const J=ko(M);return J||K?J instanceof fe?Qa([J]):J instanceof Ks&&!Er(h)?Qa([new fe("",'"interpolate" expressions cannot be used with this property')]):ba(J?new rr(q?"camera":"composite",b.value,J.labels,J instanceof Ks?J.interpolation:void 0):new kr(q?"constant":"source",b.value)):Qa([new fe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Xr{constructor(h,b){this._parameters=h,this._specification=b,te(this,Wa(this._parameters,this._specification))}static deserialize(h){return new Xr(h._parameters,h._specification)}static serialize(h){return{_parameters:h._parameters,_specification:h._specification}}}function ko(m){let h=null;if(m instanceof Zo)h=ko(m.result);else if(m instanceof Eo){for(const b of m.args)if(h=ko(b),h)break}else(m instanceof ja||m instanceof Ks)&&m.input instanceof pn&&m.input.name==="zoom"&&(h=m);return h instanceof fe||m.eachChild(b=>{const M=ko(b);M instanceof fe?h=M:!h&&M?h=new fe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):h&&M&&h!==M&&(h=new fe("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),h}function ul(m){if(m===!0||m===!1)return!0;if(!Array.isArray(m)||m.length===0)return!1;switch(m[0]){case"has":return m.length>=2&&m[1]!=="$id"&&m[1]!=="$type";case"in":return m.length>=3&&(typeof m[1]!="string"||Array.isArray(m[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return m.length!==3||Array.isArray(m[1])||Array.isArray(m[2]);case"any":case"all":for(const h of m.slice(1))if(!ul(h)&&typeof h!="boolean")return!1;return!0;default:return!0}}const Qr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ds(m){if(m==null)return{filter:()=>!0,needGeometry:!1};ul(m)||(m=Mo(m));const h=Ts(m,Qr);if(h.result==="error")throw new Error(h.value.map(b=>`${b.key}: ${b.message}`).join(", "));return{filter:(b,M,q)=>h.value.evaluate(b,M,{},q),needGeometry:Tl(m)}}function wa(m,h){return m<h?-1:m>h?1:0}function Tl(m){if(!Array.isArray(m))return!1;if(m[0]==="within")return!0;for(let h=1;h<m.length;h++)if(Tl(m[h]))return!0;return!1}function Mo(m){if(!m)return!0;const h=m[0];return m.length<=1?h!=="any":h==="=="?kl(m[1],m[2],"=="):h==="!="?qs(kl(m[1],m[2],"==")):h==="<"||h===">"||h==="<="||h===">="?kl(m[1],m[2],h):h==="any"?(b=m.slice(1),["any"].concat(b.map(Mo))):h==="all"?["all"].concat(m.slice(1).map(Mo)):h==="none"?["all"].concat(m.slice(1).map(Mo).map(qs)):h==="in"?go(m[1],m.slice(2)):h==="!in"?qs(go(m[1],m.slice(2))):h==="has"?Js(m[1]):h==="!has"?qs(Js(m[1])):h!=="within"||m;var b}function kl(m,h,b){switch(m){case"$type":return[`filter-type-${b}`,h];case"$id":return[`filter-id-${b}`,h];default:return[`filter-${b}`,m,h]}}function go(m,h){if(h.length===0)return!1;switch(m){case"$type":return["filter-type-in",["literal",h]];case"$id":return["filter-id-in",["literal",h]];default:return h.length>200&&!h.some(b=>typeof b!=typeof h[0])?["filter-in-large",m,["literal",h.sort(wa)]]:["filter-in-small",m,["literal",h]]}}function Js(m){switch(m){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",m]}}function qs(m){return["!",m]}function $a(m){const h=typeof m;if(h==="number"||h==="boolean"||h==="string"||m==null)return JSON.stringify(m);if(Array.isArray(m)){let q="[";for(const K of m)q+=`${$a(K)},`;return`${q}]`}const b=Object.keys(m).sort();let M="{";for(let q=0;q<b.length;q++)M+=`${JSON.stringify(b[q])}:${$a(m[b[q]])},`;return`${M}}`}function Jo(m){let h="";for(const b of _n)h+=`/${$a(m[b])}`;return h}function Yr(m){const h=m.value;return h?[new Y(m.key,h,"constants have been deprecated as of v8")]:[]}function mr(m){return m instanceof Number||m instanceof String||m instanceof Boolean?m.valueOf():m}function Nr(m){if(Array.isArray(m))return m.map(Nr);if(m instanceof Object&&!(m instanceof Number||m instanceof String||m instanceof Boolean)){const h={};for(const b in m)h[b]=Nr(m[b]);return h}return mr(m)}function ha(m){const h=m.key,b=m.value,M=m.valueSpec||{},q=m.objectElementValidators||{},K=m.style,J=m.styleSpec,me=m.validateSpec;let Ce=[];const Ne=$n(b);if(Ne!=="object")return[new Y(h,b,`object expected, ${Ne} found`)];for(const f in b){const u=f.split(".")[0],p=M[u]||M["*"];let I;if(q[u])I=q[u];else if(M[u])I=me;else if(q["*"])I=q["*"];else{if(!M["*"]){Ce.push(new Y(h,b[f],`unknown property "${f}"`));continue}I=me}Ce=Ce.concat(I({key:(h&&`${h}.`)+f,value:b[f],valueSpec:p,style:K,styleSpec:J,object:b,objectKey:f,validateSpec:me},b))}for(const f in M)q[f]||M[f].required&&M[f].default===void 0&&b[f]===void 0&&Ce.push(new Y(h,b,`missing required property "${f}"`));return Ce}function _o(m){const h=m.value,b=m.valueSpec,M=m.style,q=m.styleSpec,K=m.key,J=m.arrayElementValidator||m.validateSpec;if($n(h)!=="array")return[new Y(K,h,`array expected, ${$n(h)} found`)];if(b.length&&h.length!==b.length)return[new Y(K,h,`array length ${b.length} expected, length ${h.length} found`)];if(b["min-length"]&&h.length<b["min-length"])return[new Y(K,h,`array length at least ${b["min-length"]} expected, length ${h.length} found`)];let me={type:b.value,values:b.values};q.$version<7&&(me.function=b.function),$n(b.value)==="object"&&(me=b.value);let Ce=[];for(let Ne=0;Ne<h.length;Ne++)Ce=Ce.concat(J({array:h,arrayIndex:Ne,value:h[Ne],valueSpec:me,validateSpec:m.validateSpec,style:M,styleSpec:q,key:`${K}[${Ne}]`}));return Ce}function ea(m){const h=m.key,b=m.value,M=m.valueSpec;let q=$n(b);return q==="number"&&b!=b&&(q="NaN"),q!=="number"?[new Y(h,b,`number expected, ${q} found`)]:"minimum"in M&&b<M.minimum?[new Y(h,b,`${b} is less than the minimum value ${M.minimum}`)]:"maximum"in M&&b>M.maximum?[new Y(h,b,`${b} is greater than the maximum value ${M.maximum}`)]:[]}function Sa(m){const h=m.valueSpec,b=mr(m.value.type);let M,q,K,J={};const me=b!=="categorical"&&m.value.property===void 0,Ce=!me,Ne=$n(m.value.stops)==="array"&&$n(m.value.stops[0])==="array"&&$n(m.value.stops[0][0])==="object",f=ha({key:m.key,value:m.value,valueSpec:m.styleSpec.function,validateSpec:m.validateSpec,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{stops:function(I){if(b==="identity")return[new Y(I.key,I.value,'identity function may not have a "stops" property')];let L=[];const U=I.value;return L=L.concat(_o({key:I.key,value:U,valueSpec:I.valueSpec,validateSpec:I.validateSpec,style:I.style,styleSpec:I.styleSpec,arrayElementValidator:u})),$n(U)==="array"&&U.length===0&&L.push(new Y(I.key,U,"array must have at least one stop")),L},default:function(I){return I.validateSpec({key:I.key,value:I.value,valueSpec:h,validateSpec:I.validateSpec,style:I.style,styleSpec:I.styleSpec})}}});return b==="identity"&&me&&f.push(new Y(m.key,m.value,'missing required property "property"')),b==="identity"||m.value.stops||f.push(new Y(m.key,m.value,'missing required property "stops"')),b==="exponential"&&m.valueSpec.expression&&!Er(m.valueSpec)&&f.push(new Y(m.key,m.value,"exponential functions not supported")),m.styleSpec.$version>=8&&(Ce&&!Cs(m.valueSpec)?f.push(new Y(m.key,m.value,"property functions not supported")):me&&!gu(m.valueSpec)&&f.push(new Y(m.key,m.value,"zoom functions not supported"))),b!=="categorical"&&!Ne||m.value.property!==void 0||f.push(new Y(m.key,m.value,'"property" property is required')),f;function u(I){let L=[];const U=I.value,Q=I.key;if($n(U)!=="array")return[new Y(Q,U,`array expected, ${$n(U)} found`)];if(U.length!==2)return[new Y(Q,U,`array length 2 expected, length ${U.length} found`)];if(Ne){if($n(U[0])!=="object")return[new Y(Q,U,`object expected, ${$n(U[0])} found`)];if(U[0].zoom===void 0)return[new Y(Q,U,"object stop key must have zoom")];if(U[0].value===void 0)return[new Y(Q,U,"object stop key must have value")];if(K&&K>mr(U[0].zoom))return[new Y(Q,U[0].zoom,"stop zoom values must appear in ascending order")];mr(U[0].zoom)!==K&&(K=mr(U[0].zoom),q=void 0,J={}),L=L.concat(ha({key:`${Q}[0]`,value:U[0],valueSpec:{zoom:{}},validateSpec:I.validateSpec,style:I.style,styleSpec:I.styleSpec,objectElementValidators:{zoom:ea,value:p}}))}else L=L.concat(p({key:`${Q}[0]`,value:U[0],valueSpec:{},validateSpec:I.validateSpec,style:I.style,styleSpec:I.styleSpec},U));return Zr(Nr(U[1]))?L.concat([new Y(`${Q}[1]`,U[1],"expressions are not allowed in function stops.")]):L.concat(I.validateSpec({key:`${Q}[1]`,value:U[1],valueSpec:h,validateSpec:I.validateSpec,style:I.style,styleSpec:I.styleSpec}))}function p(I,L){const U=$n(I.value),Q=mr(I.value),re=I.value!==null?I.value:L;if(M){if(U!==M)return[new Y(I.key,re,`${U} stop domain type must match previous stop domain type ${M}`)]}else M=U;if(U!=="number"&&U!=="string"&&U!=="boolean")return[new Y(I.key,re,"stop domain value must be a number, string, or boolean")];if(U!=="number"&&b!=="categorical"){let Ae=`number expected, ${U} found`;return Cs(h)&&b===void 0&&(Ae+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Y(I.key,re,Ae)]}return b!=="categorical"||U!=="number"||isFinite(Q)&&Math.floor(Q)===Q?b!=="categorical"&&U==="number"&&q!==void 0&&Q<q?[new Y(I.key,re,"stop domain values must appear in ascending order")]:(q=Q,b==="categorical"&&Q in J?[new Y(I.key,re,"stop domain values must be unique")]:(J[Q]=!0,[])):[new Y(I.key,re,`integer expected, found ${Q}`)]}}function ka(m){const h=(m.expressionContext==="property"?ll:Ts)(Nr(m.value),m.valueSpec);if(h.result==="error")return h.value.map(M=>new Y(`${m.key}${M.key}`,m.value,M.message));const b=h.value.expression||h.value._styleExpression.expression;if(m.expressionContext==="property"&&m.propertyKey==="text-font"&&!b.outputDefined())return[new Y(m.key,m.value,`Invalid data expression for "${m.propertyKey}". Output values must be contained as literals within the expression.`)];if(m.expressionContext==="property"&&m.propertyType==="layout"&&!Or(b))return[new Y(m.key,m.value,'"feature-state" data expressions are not supported with layout properties.')];if(m.expressionContext==="filter"&&!Or(b))return[new Y(m.key,m.value,'"feature-state" data expressions are not supported with filters.')];if(m.expressionContext&&m.expressionContext.indexOf("cluster")===0){if(!qa(b,["zoom","feature-state"]))return[new Y(m.key,m.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(m.expressionContext==="cluster-initial"&&!Ar(b))return[new Y(m.key,m.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Xa(m){const h=m.key,b=m.value,M=m.valueSpec,q=[];return Array.isArray(M.values)?M.values.indexOf(mr(b))===-1&&q.push(new Y(h,b,`expected one of [${M.values.join(", ")}], ${JSON.stringify(b)} found`)):Object.keys(M.values).indexOf(mr(b))===-1&&q.push(new Y(h,b,`expected one of [${Object.keys(M.values).join(", ")}], ${JSON.stringify(b)} found`)),q}function cl(m){return ul(Nr(m.value))?ka(te({},m,{expressionContext:"filter",valueSpec:{value:"boolean"}})):lu(m)}function lu(m){const h=m.value,b=m.key;if($n(h)!=="array")return[new Y(b,h,`array expected, ${$n(h)} found`)];const M=m.styleSpec;let q,K=[];if(h.length<1)return[new Y(b,h,"filter array must have at least 1 element")];switch(K=K.concat(Xa({key:`${b}[0]`,value:h[0],valueSpec:M.filter_operator,style:m.style,styleSpec:m.styleSpec})),mr(h[0])){case"<":case"<=":case">":case">=":h.length>=2&&mr(h[1])==="$type"&&K.push(new Y(b,h,`"$type" cannot be use with operator "${h[0]}"`));case"==":case"!=":h.length!==3&&K.push(new Y(b,h,`filter array for operator "${h[0]}" must have 3 elements`));case"in":case"!in":h.length>=2&&(q=$n(h[1]),q!=="string"&&K.push(new Y(`${b}[1]`,h[1],`string expected, ${q} found`)));for(let J=2;J<h.length;J++)q=$n(h[J]),mr(h[1])==="$type"?K=K.concat(Xa({key:`${b}[${J}]`,value:h[J],valueSpec:M.geometry_type,style:m.style,styleSpec:m.styleSpec})):q!=="string"&&q!=="number"&&q!=="boolean"&&K.push(new Y(`${b}[${J}]`,h[J],`string, number, or boolean expected, ${q} found`));break;case"any":case"all":case"none":for(let J=1;J<h.length;J++)K=K.concat(lu({key:`${b}[${J}]`,value:h[J],style:m.style,styleSpec:m.styleSpec}));break;case"has":case"!has":q=$n(h[1]),h.length!==2?K.push(new Y(b,h,`filter array for "${h[0]}" operator must have 2 elements`)):q!=="string"&&K.push(new Y(`${b}[1]`,h[1],`string expected, ${q} found`));break;case"within":q=$n(h[1]),h.length!==2?K.push(new Y(b,h,`filter array for "${h[0]}" operator must have 2 elements`)):q!=="object"&&K.push(new Y(`${b}[1]`,h[1],`object expected, ${q} found`))}return K}function gl(m,h){const b=m.key,M=m.validateSpec,q=m.style,K=m.styleSpec,J=m.value,me=m.objectKey,Ce=K[`${h}_${m.layerType}`];if(!Ce)return[];const Ne=me.match(/^(.*)-transition$/);if(h==="paint"&&Ne&&Ce[Ne[1]]&&Ce[Ne[1]].transition)return M({key:b,value:J,valueSpec:K.transition,style:q,styleSpec:K});const f=m.valueSpec||Ce[me];if(!f)return[new Y(b,J,`unknown property "${me}"`)];let u;if($n(J)==="string"&&Cs(f)&&!f.tokens&&(u=/^{([^}]+)}$/.exec(J)))return[new Y(b,J,`"${me}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(u[1])} }\`.`)];const p=[];return m.layerType==="symbol"&&(me==="text-field"&&q&&!q.glyphs&&p.push(new Y(b,J,'use of "text-field" requires a style "glyphs" property')),me==="text-font"&&Ko(Nr(J))&&mr(J.type)==="identity"&&p.push(new Y(b,J,'"text-font" does not support identity functions'))),p.concat(M({key:m.key,value:J,valueSpec:f,style:q,styleSpec:K,expressionContext:"property",propertyType:h,propertyKey:me}))}function ao(m){return gl(m,"paint")}function pi(m){return gl(m,"layout")}function Ui(m){let h=[];const b=m.value,M=m.key,q=m.style,K=m.styleSpec;b.type||b.ref||h.push(new Y(M,b,'either "type" or "ref" is required'));let J=mr(b.type);const me=mr(b.ref);if(b.id){const Ce=mr(b.id);for(let Ne=0;Ne<m.arrayIndex;Ne++){const f=q.layers[Ne];mr(f.id)===Ce&&h.push(new Y(M,b.id,`duplicate layer id "${b.id}", previously used at line ${f.id.__line__}`))}}if("ref"in b){let Ce;["type","source","source-layer","filter","layout"].forEach(Ne=>{Ne in b&&h.push(new Y(M,b[Ne],`"${Ne}" is prohibited for ref layers`))}),q.layers.forEach(Ne=>{mr(Ne.id)===me&&(Ce=Ne)}),Ce?Ce.ref?h.push(new Y(M,b.ref,"ref cannot reference another ref layer")):J=mr(Ce.type):h.push(new Y(M,b.ref,`ref layer "${me}" not found`))}else if(J!=="background")if(b.source){const Ce=q.sources&&q.sources[b.source],Ne=Ce&&mr(Ce.type);Ce?Ne==="vector"&&J==="raster"?h.push(new Y(M,b.source,`layer "${b.id}" requires a raster source`)):Ne!=="raster-dem"&&J==="hillshade"?h.push(new Y(M,b.source,`layer "${b.id}" requires a raster-dem source`)):Ne==="raster"&&J!=="raster"?h.push(new Y(M,b.source,`layer "${b.id}" requires a vector source`)):Ne!=="vector"||b["source-layer"]?Ne==="raster-dem"&&J!=="hillshade"?h.push(new Y(M,b.source,"raster-dem source can only be used with layer type 'hillshade'.")):J!=="line"||!b.paint||!b.paint["line-gradient"]||Ne==="geojson"&&Ce.lineMetrics||h.push(new Y(M,b,`layer "${b.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):h.push(new Y(M,b,`layer "${b.id}" must specify a "source-layer"`)):h.push(new Y(M,b.source,`source "${b.source}" not found`))}else h.push(new Y(M,b,'missing required property "source"'));return h=h.concat(ha({key:M,value:b,valueSpec:K.layer,style:m.style,styleSpec:m.styleSpec,validateSpec:m.validateSpec,objectElementValidators:{"*":()=>[],type:()=>m.validateSpec({key:`${M}.type`,value:b.type,valueSpec:K.layer.type,style:m.style,styleSpec:m.styleSpec,validateSpec:m.validateSpec,object:b,objectKey:"type"}),filter:cl,layout:Ce=>ha({layer:b,key:Ce.key,value:Ce.value,style:Ce.style,styleSpec:Ce.styleSpec,validateSpec:Ce.validateSpec,objectElementValidators:{"*":Ne=>pi(te({layerType:J},Ne))}}),paint:Ce=>ha({layer:b,key:Ce.key,value:Ce.value,style:Ce.style,styleSpec:Ce.styleSpec,validateSpec:Ce.validateSpec,objectElementValidators:{"*":Ne=>ao(te({layerType:J},Ne))}})}})),h}function Di(m){const h=m.value,b=m.key,M=$n(h);return M!=="string"?[new Y(b,h,`string expected, ${M} found`)]:[]}const Ft={promoteId:function({key:m,value:h}){if($n(h)==="string")return Di({key:m,value:h});{const b=[];for(const M in h)b.push(...Di({key:`${m}.${M}`,value:h[M]}));return b}}};function ii(m){const h=m.value,b=m.key,M=m.styleSpec,q=m.style,K=m.validateSpec;if(!h.type)return[new Y(b,h,'"type" is required')];const J=mr(h.type);let me;switch(J){case"vector":case"raster":return me=ha({key:b,value:h,valueSpec:M[`source_${J.replace("-","_")}`],style:m.style,styleSpec:M,objectElementValidators:Ft,validateSpec:K}),me;case"raster-dem":return me=function(Ce){var Ne;const f=(Ne=Ce.sourceName)!==null&&Ne!==void 0?Ne:"",u=Ce.value,p=Ce.styleSpec,I=p.source_raster_dem,L=Ce.style;let U=[];const Q=$n(u);if(u===void 0)return U;if(Q!=="object")return U.push(new Y("source_raster_dem",u,`object expected, ${Q} found`)),U;const re=mr(u.encoding)==="custom",Ae=["redFactor","greenFactor","blueFactor","baseShift"],_e=Ce.value.encoding?`"${Ce.value.encoding}"`:"Default";for(const Le in u)!re&&Ae.includes(Le)?U.push(new Y(Le,u[Le],`In "${f}": "${Le}" is only valid when "encoding" is set to "custom". ${_e} encoding found`)):I[Le]?U=U.concat(Ce.validateSpec({key:Le,value:u[Le],valueSpec:I[Le],validateSpec:Ce.validateSpec,style:L,styleSpec:p})):U.push(new Y(Le,u[Le],`unknown property "${Le}"`));return U}({sourceName:b,value:h,style:m.style,styleSpec:M,validateSpec:K}),me;case"geojson":if(me=ha({key:b,value:h,valueSpec:M.source_geojson,style:q,styleSpec:M,validateSpec:K,objectElementValidators:Ft}),h.cluster)for(const Ce in h.clusterProperties){const[Ne,f]=h.clusterProperties[Ce],u=typeof Ne=="string"?[Ne,["accumulated"],["get",Ce]]:Ne;me.push(...ka({key:`${b}.${Ce}.map`,value:f,validateSpec:K,expressionContext:"cluster-map"})),me.push(...ka({key:`${b}.${Ce}.reduce`,value:u,validateSpec:K,expressionContext:"cluster-reduce"}))}return me;case"video":return ha({key:b,value:h,valueSpec:M.source_video,style:q,validateSpec:K,styleSpec:M});case"image":return ha({key:b,value:h,valueSpec:M.source_image,style:q,validateSpec:K,styleSpec:M});case"canvas":return[new Y(b,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Xa({key:`${b}.type`,value:h.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:q,validateSpec:K,styleSpec:M})}}function bi(m){const h=m.value,b=m.styleSpec,M=b.light,q=m.style;let K=[];const J=$n(h);if(h===void 0)return K;if(J!=="object")return K=K.concat([new Y("light",h,`object expected, ${J} found`)]),K;for(const me in h){const Ce=me.match(/^(.*)-transition$/);K=K.concat(Ce&&M[Ce[1]]&&M[Ce[1]].transition?m.validateSpec({key:me,value:h[me],valueSpec:b.transition,validateSpec:m.validateSpec,style:q,styleSpec:b}):M[me]?m.validateSpec({key:me,value:h[me],valueSpec:M[me],validateSpec:m.validateSpec,style:q,styleSpec:b}):[new Y(me,h[me],`unknown property "${me}"`)])}return K}function Fi(m){const h=m.value,b=m.styleSpec,M=b.sky,q=m.style,K=$n(h);if(h===void 0)return[];if(K!=="object")return[new Y("sky",h,`object expected, ${K} found`)];let J=[];for(const me in h)J=J.concat(M[me]?Xn({key:me,value:h[me],valueSpec:M[me],style:q,styleSpec:b}):[new Y(me,h[me],`unknown property "${me}"`)]);return J}function Bn(m){const h=m.value,b=m.styleSpec,M=b.terrain,q=m.style;let K=[];const J=$n(h);if(h===void 0)return K;if(J!=="object")return K=K.concat([new Y("terrain",h,`object expected, ${J} found`)]),K;for(const me in h)K=K.concat(M[me]?m.validateSpec({key:me,value:h[me],valueSpec:M[me],validateSpec:m.validateSpec,style:q,styleSpec:b}):[new Y(me,h[me],`unknown property "${me}"`)]);return K}function Hn(m){let h=[];const b=m.value,M=m.key;if(Array.isArray(b)){const q=[],K=[];for(const J in b)b[J].id&&q.includes(b[J].id)&&h.push(new Y(M,b,`all the sprites' ids must be unique, but ${b[J].id} is duplicated`)),q.push(b[J].id),b[J].url&&K.includes(b[J].url)&&h.push(new Y(M,b,`all the sprites' URLs must be unique, but ${b[J].url} is duplicated`)),K.push(b[J].url),h=h.concat(ha({key:`${M}[${J}]`,value:b[J],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:m.validateSpec}));return h}return Di({key:M,value:b})}const lr={"*":()=>[],array:_o,boolean:function(m){const h=m.value,b=m.key,M=$n(h);return M!=="boolean"?[new Y(b,h,`boolean expected, ${M} found`)]:[]},number:ea,color:function(m){const h=m.key,b=m.value,M=$n(b);return M!=="string"?[new Y(h,b,`color expected, ${M} found`)]:mn.parse(String(b))?[]:[new Y(h,b,`color expected, "${b}" found`)]},constants:Yr,enum:Xa,filter:cl,function:Sa,layer:Ui,object:ha,source:ii,light:bi,sky:Fi,terrain:Bn,string:Di,formatted:function(m){return Di(m).length===0?[]:ka(m)},resolvedImage:function(m){return Di(m).length===0?[]:ka(m)},padding:function(m){const h=m.key,b=m.value;if($n(b)==="array"){if(b.length<1||b.length>4)return[new Y(h,b,`padding requires 1 to 4 values; ${b.length} values found`)];const M={type:"number"};let q=[];for(let K=0;K<b.length;K++)q=q.concat(m.validateSpec({key:`${h}[${K}]`,value:b[K],validateSpec:m.validateSpec,valueSpec:M}));return q}return ea({key:h,value:b,valueSpec:{}})},variableAnchorOffsetCollection:function(m){const h=m.key,b=m.value,M=$n(b),q=m.styleSpec;if(M!=="array"||b.length<1||b.length%2!=0)return[new Y(h,b,"variableAnchorOffsetCollection requires a non-empty array of even length")];let K=[];for(let J=0;J<b.length;J+=2)K=K.concat(Xa({key:`${h}[${J}]`,value:b[J],valueSpec:q.layout_symbol["text-anchor"]})),K=K.concat(_o({key:`${h}[${J+1}]`,value:b[J+1],valueSpec:{length:2,value:"number"},validateSpec:m.validateSpec,style:m.style,styleSpec:q}));return K},sprite:Hn};function Xn(m){const h=m.value,b=m.valueSpec,M=m.styleSpec;return m.validateSpec=Xn,b.expression&&Ko(mr(h))?Sa(m):b.expression&&Zr(Nr(h))?ka(m):b.type&&lr[b.type]?lr[b.type](m):ha(te({},m,{valueSpec:b.type?M[b.type]:b}))}function Hs(m){const h=m.value,b=m.key,M=Di(m);return M.length||(h.indexOf("{fontstack}")===-1&&M.push(new Y(b,h,'"glyphs" url must include a "{fontstack}" token')),h.indexOf("{range}")===-1&&M.push(new Y(b,h,'"glyphs" url must include a "{range}" token'))),M}function ks(m,h=ei){let b=[];return b=b.concat(Xn({key:"",value:m,valueSpec:h.$root,styleSpec:h,style:m,validateSpec:Xn,objectElementValidators:{glyphs:Hs,"*":()=>[]}})),m.constants&&(b=b.concat(Yr({key:"constants",value:m.constants,style:m,styleSpec:h,validateSpec:Xn}))),Ya(b)}function ps(m){return function(h){return m({...h,validateSpec:Xn})}}function Ya(m){return[].concat(m).sort((h,b)=>h.line-b.line)}function yo(m){return function(...h){return Ya(m.apply(this,h))}}ks.source=yo(ps(ii)),ks.sprite=yo(ps(Hn)),ks.glyphs=yo(ps(Hs)),ks.light=yo(ps(bi)),ks.sky=yo(ps(Fi)),ks.terrain=yo(ps(Bn)),ks.layer=yo(ps(Ui)),ks.filter=yo(ps(cl)),ks.paintProperty=yo(ps(ao)),ks.layoutProperty=yo(ps(pi));const rs=ks,Wu=rs.light,Ru=rs.paintProperty,vo=rs.layoutProperty;function Ml(m,h){let b=!1;if(h&&h.length)for(const M of h)m.fire(new Ai(new Error(M.message))),b=!0;return b}class Dn{constructor(h,b,M){const q=this.cells=[];if(h instanceof ArrayBuffer){this.arrayBuffer=h;const J=new Int32Array(this.arrayBuffer);h=J[0],this.d=(b=J[1])+2*(M=J[2]);for(let Ce=0;Ce<this.d*this.d;Ce++){const Ne=J[3+Ce],f=J[3+Ce+1];q.push(Ne===f?null:J.subarray(Ne,f))}const me=J[3+q.length+1];this.keys=J.subarray(J[3+q.length],me),this.bboxes=J.subarray(me),this.insert=this._insertReadonly}else{this.d=b+2*M;for(let J=0;J<this.d*this.d;J++)q.push([]);this.keys=[],this.bboxes=[]}this.n=b,this.extent=h,this.padding=M,this.scale=b/h,this.uid=0;const K=M/b*h;this.min=-K,this.max=h+K}insert(h,b,M,q,K){this._forEachCell(b,M,q,K,this._insertCell,this.uid++,void 0,void 0),this.keys.push(h),this.bboxes.push(b),this.bboxes.push(M),this.bboxes.push(q),this.bboxes.push(K)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(h,b,M,q,K,J){this.cells[K].push(J)}query(h,b,M,q,K){const J=this.min,me=this.max;if(h<=J&&b<=J&&me<=M&&me<=q&&!K)return Array.prototype.slice.call(this.keys);{const Ce=[];return this._forEachCell(h,b,M,q,this._queryCell,Ce,{},K),Ce}}_queryCell(h,b,M,q,K,J,me,Ce){const Ne=this.cells[K];if(Ne!==null){const f=this.keys,u=this.bboxes;for(let p=0;p<Ne.length;p++){const I=Ne[p];if(me[I]===void 0){const L=4*I;(Ce?Ce(u[L+0],u[L+1],u[L+2],u[L+3]):h<=u[L+2]&&b<=u[L+3]&&M>=u[L+0]&&q>=u[L+1])?(me[I]=!0,J.push(f[I])):me[I]=!1}}}}_forEachCell(h,b,M,q,K,J,me,Ce){const Ne=this._convertToCellCoord(h),f=this._convertToCellCoord(b),u=this._convertToCellCoord(M),p=this._convertToCellCoord(q);for(let I=Ne;I<=u;I++)for(let L=f;L<=p;L++){const U=this.d*L+I;if((!Ce||Ce(this._convertFromCellCoord(I),this._convertFromCellCoord(L),this._convertFromCellCoord(I+1),this._convertFromCellCoord(L+1)))&&K.call(this,h,b,M,q,U,J,me,Ce))return}}_convertFromCellCoord(h){return(h-this.padding)/this.scale}_convertToCellCoord(h){return Math.max(0,Math.min(this.d-1,Math.floor(h*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const h=this.cells,b=3+this.cells.length+1+1;let M=0;for(let J=0;J<this.cells.length;J++)M+=this.cells[J].length;const q=new Int32Array(b+M+this.keys.length+this.bboxes.length);q[0]=this.extent,q[1]=this.n,q[2]=this.padding;let K=b;for(let J=0;J<h.length;J++){const me=h[J];q[3+J]=K,q.set(me,K),K+=me.length}return q[3+h.length]=K,q.set(this.keys,K),K+=this.keys.length,q[3+h.length+1]=K,q.set(this.bboxes,K),K+=this.bboxes.length,q.buffer}static serialize(h,b){const M=h.toArrayBuffer();return b&&b.push(M),{buffer:M}}static deserialize(h){return new Dn(h.buffer)}}const Ma={};function Sn(m,h,b={}){if(Ma[m])throw new Error(`${m} is already registered.`);Object.defineProperty(h,"_classRegistryKey",{value:m,writeable:!1}),Ma[m]={klass:h,omit:b.omit||[],shallow:b.shallow||[]}}Sn("Object",Object),Sn("TransferableGridIndex",Dn),Sn("Color",mn),Sn("Error",Error),Sn("AJAXError",vn),Sn("ResolvedImage",Ki),Sn("StylePropertyFunction",Xr),Sn("StyleExpression",es,{omit:["_evaluator"]}),Sn("ZoomDependentExpression",rr),Sn("ZoomConstantExpression",kr),Sn("CompoundExpression",pn,{omit:["_evaluate"]});for(const m in Co)Co[m]._classRegistryKey||Sn(`Expression_${m}`,Co[m]);function No(m){return m&&typeof ArrayBuffer<"u"&&(m instanceof ArrayBuffer||m.constructor&&m.constructor.name==="ArrayBuffer")}function Nl(m,h){if(m==null||typeof m=="boolean"||typeof m=="number"||typeof m=="string"||m instanceof Boolean||m instanceof Number||m instanceof String||m instanceof Date||m instanceof RegExp||m instanceof Blob||m instanceof Error)return m;if(No(m)||zt(m))return h&&h.push(m),m;if(ArrayBuffer.isView(m)){const b=m;return h&&h.push(b.buffer),b}if(m instanceof ImageData)return h&&h.push(m.data.buffer),m;if(Array.isArray(m)){const b=[];for(const M of m)b.push(Nl(M,h));return b}if(typeof m=="object"){const b=m.constructor,M=b._classRegistryKey;if(!M)throw new Error(`can't serialize object of unregistered class ${b.name}`);if(!Ma[M])throw new Error(`${M} is not registered.`);const q=b.serialize?b.serialize(m,h):{};if(b.serialize){if(h&&q===h[h.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const K in m){if(!m.hasOwnProperty(K)||Ma[M].omit.indexOf(K)>=0)continue;const J=m[K];q[K]=Ma[M].shallow.indexOf(K)>=0?J:Nl(J,h)}m instanceof Error&&(q.message=m.message)}if(q.$name)throw new Error("$name property is reserved for worker serialization logic.");return M!=="Object"&&(q.$name=M),q}throw new Error("can't serialize object of type "+typeof m)}function En(m){if(m==null||typeof m=="boolean"||typeof m=="number"||typeof m=="string"||m instanceof Boolean||m instanceof Number||m instanceof String||m instanceof Date||m instanceof RegExp||m instanceof Blob||m instanceof Error||No(m)||zt(m)||ArrayBuffer.isView(m)||m instanceof ImageData)return m;if(Array.isArray(m))return m.map(En);if(typeof m=="object"){const h=m.$name||"Object";if(!Ma[h])throw new Error(`can't deserialize unregistered class ${h}`);const{klass:b}=Ma[h];if(!b)throw new Error(`can't deserialize unregistered class ${h}`);if(b.deserialize)return b.deserialize(m);const M=Object.create(b.prototype);for(const q of Object.keys(m)){if(q==="$name")continue;const K=m[q];M[q]=Ma[h].shallow.indexOf(q)>=0?K:En(K)}return M}throw new Error("can't deserialize object of type "+typeof m)}class Wl{constructor(){this.first=!0}update(h,b){const M=Math.floor(h);return this.first?(this.first=!1,this.lastIntegerZoom=M,this.lastIntegerZoomTime=0,this.lastZoom=h,this.lastFloorZoom=M,!0):(this.lastFloorZoom>M?(this.lastIntegerZoom=M+1,this.lastIntegerZoomTime=b):this.lastFloorZoom<M&&(this.lastIntegerZoom=M,this.lastIntegerZoomTime=b),h!==this.lastZoom&&(this.lastZoom=h,this.lastFloorZoom=M,!0))}}const Cn={"Latin-1 Supplement":m=>m>=128&&m<=255,Arabic:m=>m>=1536&&m<=1791,"Arabic Supplement":m=>m>=1872&&m<=1919,"Arabic Extended-A":m=>m>=2208&&m<=2303,"Hangul Jamo":m=>m>=4352&&m<=4607,"Unified Canadian Aboriginal Syllabics":m=>m>=5120&&m<=5759,Khmer:m=>m>=6016&&m<=6143,"Unified Canadian Aboriginal Syllabics Extended":m=>m>=6320&&m<=6399,"General Punctuation":m=>m>=8192&&m<=8303,"Letterlike Symbols":m=>m>=8448&&m<=8527,"Number Forms":m=>m>=8528&&m<=8591,"Miscellaneous Technical":m=>m>=8960&&m<=9215,"Control Pictures":m=>m>=9216&&m<=9279,"Optical Character Recognition":m=>m>=9280&&m<=9311,"Enclosed Alphanumerics":m=>m>=9312&&m<=9471,"Geometric Shapes":m=>m>=9632&&m<=9727,"Miscellaneous Symbols":m=>m>=9728&&m<=9983,"Miscellaneous Symbols and Arrows":m=>m>=11008&&m<=11263,"CJK Radicals Supplement":m=>m>=11904&&m<=12031,"Kangxi Radicals":m=>m>=12032&&m<=12255,"Ideographic Description Characters":m=>m>=12272&&m<=12287,"CJK Symbols and Punctuation":m=>m>=12288&&m<=12351,Hiragana:m=>m>=12352&&m<=12447,Katakana:m=>m>=12448&&m<=12543,Bopomofo:m=>m>=12544&&m<=12591,"Hangul Compatibility Jamo":m=>m>=12592&&m<=12687,Kanbun:m=>m>=12688&&m<=12703,"Bopomofo Extended":m=>m>=12704&&m<=12735,"CJK Strokes":m=>m>=12736&&m<=12783,"Katakana Phonetic Extensions":m=>m>=12784&&m<=12799,"Enclosed CJK Letters and Months":m=>m>=12800&&m<=13055,"CJK Compatibility":m=>m>=13056&&m<=13311,"CJK Unified Ideographs Extension A":m=>m>=13312&&m<=19903,"Yijing Hexagram Symbols":m=>m>=19904&&m<=19967,"CJK Unified Ideographs":m=>m>=19968&&m<=40959,"Yi Syllables":m=>m>=40960&&m<=42127,"Yi Radicals":m=>m>=42128&&m<=42191,"Hangul Jamo Extended-A":m=>m>=43360&&m<=43391,"Hangul Syllables":m=>m>=44032&&m<=55215,"Hangul Jamo Extended-B":m=>m>=55216&&m<=55295,"Private Use Area":m=>m>=57344&&m<=63743,"CJK Compatibility Ideographs":m=>m>=63744&&m<=64255,"Arabic Presentation Forms-A":m=>m>=64336&&m<=65023,"Vertical Forms":m=>m>=65040&&m<=65055,"CJK Compatibility Forms":m=>m>=65072&&m<=65103,"Small Form Variants":m=>m>=65104&&m<=65135,"Arabic Presentation Forms-B":m=>m>=65136&&m<=65279,"Halfwidth and Fullwidth Forms":m=>m>=65280&&m<=65519};function _l(m){for(const h of m)if(Vl(h.charCodeAt(0)))return!0;return!1}function uu(m){for(const h of m)if(!Fu(h.charCodeAt(0)))return!1;return!0}function Fu(m){return!(Cn.Arabic(m)||Cn["Arabic Supplement"](m)||Cn["Arabic Extended-A"](m)||Cn["Arabic Presentation Forms-A"](m)||Cn["Arabic Presentation Forms-B"](m))}function Vl(m){return!(m!==746&&m!==747&&(m<4352||!(Cn["Bopomofo Extended"](m)||Cn.Bopomofo(m)||Cn["CJK Compatibility Forms"](m)&&!(m>=65097&&m<=65103)||Cn["CJK Compatibility Ideographs"](m)||Cn["CJK Compatibility"](m)||Cn["CJK Radicals Supplement"](m)||Cn["CJK Strokes"](m)||!(!Cn["CJK Symbols and Punctuation"](m)||m>=12296&&m<=12305||m>=12308&&m<=12319||m===12336)||Cn["CJK Unified Ideographs Extension A"](m)||Cn["CJK Unified Ideographs"](m)||Cn["Enclosed CJK Letters and Months"](m)||Cn["Hangul Compatibility Jamo"](m)||Cn["Hangul Jamo Extended-A"](m)||Cn["Hangul Jamo Extended-B"](m)||Cn["Hangul Jamo"](m)||Cn["Hangul Syllables"](m)||Cn.Hiragana(m)||Cn["Ideographic Description Characters"](m)||Cn.Kanbun(m)||Cn["Kangxi Radicals"](m)||Cn["Katakana Phonetic Extensions"](m)||Cn.Katakana(m)&&m!==12540||!(!Cn["Halfwidth and Fullwidth Forms"](m)||m===65288||m===65289||m===65293||m>=65306&&m<=65310||m===65339||m===65341||m===65343||m>=65371&&m<=65503||m===65507||m>=65512&&m<=65519)||!(!Cn["Small Form Variants"](m)||m>=65112&&m<=65118||m>=65123&&m<=65126)||Cn["Unified Canadian Aboriginal Syllabics"](m)||Cn["Unified Canadian Aboriginal Syllabics Extended"](m)||Cn["Vertical Forms"](m)||Cn["Yijing Hexagram Symbols"](m)||Cn["Yi Syllables"](m)||Cn["Yi Radicals"](m))))}function yl(m){return!(Vl(m)||function(h){return!!(Cn["Latin-1 Supplement"](h)&&(h===167||h===169||h===174||h===177||h===188||h===189||h===190||h===215||h===247)||Cn["General Punctuation"](h)&&(h===8214||h===8224||h===8225||h===8240||h===8241||h===8251||h===8252||h===8258||h===8263||h===8264||h===8265||h===8273)||Cn["Letterlike Symbols"](h)||Cn["Number Forms"](h)||Cn["Miscellaneous Technical"](h)&&(h>=8960&&h<=8967||h>=8972&&h<=8991||h>=8996&&h<=9e3||h===9003||h>=9085&&h<=9114||h>=9150&&h<=9165||h===9167||h>=9169&&h<=9179||h>=9186&&h<=9215)||Cn["Control Pictures"](h)&&h!==9251||Cn["Optical Character Recognition"](h)||Cn["Enclosed Alphanumerics"](h)||Cn["Geometric Shapes"](h)||Cn["Miscellaneous Symbols"](h)&&!(h>=9754&&h<=9759)||Cn["Miscellaneous Symbols and Arrows"](h)&&(h>=11026&&h<=11055||h>=11088&&h<=11097||h>=11192&&h<=11243)||Cn["CJK Symbols and Punctuation"](h)||Cn.Katakana(h)||Cn["Private Use Area"](h)||Cn["CJK Compatibility Forms"](h)||Cn["Small Form Variants"](h)||Cn["Halfwidth and Fullwidth Forms"](h)||h===8734||h===8756||h===8757||h>=9984&&h<=10087||h>=10102&&h<=10131||h===65532||h===65533)}(m))}function ta(m){return m>=1424&&m<=2303||Cn["Arabic Presentation Forms-A"](m)||Cn["Arabic Presentation Forms-B"](m)}function oc(m,h){return!(!h&&ta(m)||m>=2304&&m<=3583||m>=3840&&m<=4255||Cn.Khmer(m))}function $u(m){for(const h of m)if(ta(h.charCodeAt(0)))return!0;return!1}const $l=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(m){this.pluginStatus=m.pluginStatus,this.pluginURL=m.pluginURL}setMethods(m){this.applyArabicShaping=m.applyArabicShaping,this.processBidirectionalText=m.processBidirectionalText,this.processStyledBidirectionalText=m.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class ms{constructor(h,b){this.zoom=h,b?(this.now=b.now,this.fadeDuration=b.fadeDuration,this.zoomHistory=b.zoomHistory,this.transition=b.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Wl,this.transition={})}isSupportedScript(h){return function(b,M){for(const q of b)if(!oc(q.charCodeAt(0),M))return!1;return!0}(h,$l.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const h=this.zoom,b=h-Math.floor(h),M=this.crossFadingFactor();return h>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:b+(1-b)*M}:{fromScale:.5,toScale:1,t:1-(1-M)*b}}}class _a{constructor(h,b){this.property=h,this.value=b,this.expression=function(M,q){if(Ko(M))return new Xr(M,q);if(Zr(M)){const K=ll(M,q);if(K.result==="error")throw new Error(K.value.map(J=>`${J.key}: ${J.message}`).join(", "));return K.value}{let K=M;return q.type==="color"&&typeof M=="string"?K=mn.parse(M):q.type!=="padding"||typeof M!="number"&&!Array.isArray(M)?q.type==="variableAnchorOffsetCollection"&&Array.isArray(M)&&(K=Wt.parse(M)):K=ur.parse(M),{kind:"constant",evaluate:()=>K}}}(b===void 0?h.specification.default:b,h.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(h,b,M){return this.property.possiblyEvaluate(this,h,b,M)}}class el{constructor(h){this.property=h,this.value=new _a(h,void 0)}transitioned(h,b){return new Ou(this.property,this.value,b,jt({},h.transition,this.transition),h.now)}untransitioned(){return new Ou(this.property,this.value,null,{},0)}}class _u{constructor(h){this._properties=h,this._values=Object.create(h.defaultTransitionablePropertyValues)}getValue(h){return Et(this._values[h].value.value)}setValue(h,b){Object.prototype.hasOwnProperty.call(this._values,h)||(this._values[h]=new el(this._values[h].property)),this._values[h].value=new _a(this._values[h].property,b===null?void 0:Et(b))}getTransition(h){return Et(this._values[h].transition)}setTransition(h,b){Object.prototype.hasOwnProperty.call(this._values,h)||(this._values[h]=new el(this._values[h].property)),this._values[h].transition=Et(b)||void 0}serialize(){const h={};for(const b of Object.keys(this._values)){const M=this.getValue(b);M!==void 0&&(h[b]=M);const q=this.getTransition(b);q!==void 0&&(h[`${b}-transition`]=q)}return h}transitioned(h,b){const M=new cu(this._properties);for(const q of Object.keys(this._values))M._values[q]=this._values[q].transitioned(h,b._values[q]);return M}untransitioned(){const h=new cu(this._properties);for(const b of Object.keys(this._values))h._values[b]=this._values[b].untransitioned();return h}}class Ou{constructor(h,b,M,q,K){this.property=h,this.value=b,this.begin=K+q.delay||0,this.end=this.begin+q.duration||0,h.specification.transition&&(q.delay||q.duration)&&(this.prior=M)}possiblyEvaluate(h,b,M){const q=h.now||0,K=this.value.possiblyEvaluate(h,b,M),J=this.prior;if(J){if(q>this.end)return this.prior=null,K;if(this.value.isDataDriven())return this.prior=null,K;if(q<this.begin)return J.possiblyEvaluate(h,b,M);{const me=(q-this.begin)/(this.end-this.begin);return this.property.interpolate(J.possiblyEvaluate(h,b,M),K,function(Ce){if(Ce<=0)return 0;if(Ce>=1)return 1;const Ne=Ce*Ce,f=Ne*Ce;return 4*(Ce<.5?f:3*(Ce-Ne)+f-.75)}(me))}}return K}}class cu{constructor(h){this._properties=h,this._values=Object.create(h.defaultTransitioningPropertyValues)}possiblyEvaluate(h,b,M){const q=new gs(this._properties);for(const K of Object.keys(this._values))q._values[K]=this._values[K].possiblyEvaluate(h,b,M);return q}hasTransition(){for(const h of Object.keys(this._values))if(this._values[h].prior)return!0;return!1}}class Nu{constructor(h){this._properties=h,this._values=Object.create(h.defaultPropertyValues)}hasValue(h){return this._values[h].value!==void 0}getValue(h){return Et(this._values[h].value)}setValue(h,b){this._values[h]=new _a(this._values[h].property,b===null?void 0:Et(b))}serialize(){const h={};for(const b of Object.keys(this._values)){const M=this.getValue(b);M!==void 0&&(h[b]=M)}return h}possiblyEvaluate(h,b,M){const q=new gs(this._properties);for(const K of Object.keys(this._values))q._values[K]=this._values[K].possiblyEvaluate(h,b,M);return q}}class _r{constructor(h,b,M){this.property=h,this.value=b,this.parameters=M}isConstant(){return this.value.kind==="constant"}constantOr(h){return this.value.kind==="constant"?this.value.value:h}evaluate(h,b,M,q){return this.property.evaluate(this.value,this.parameters,h,b,M,q)}}class gs{constructor(h){this._properties=h,this._values=Object.create(h.defaultPossiblyEvaluatedValues)}get(h){return this._values[h]}}class gn{constructor(h){this.specification=h}possiblyEvaluate(h,b){if(h.isDataDriven())throw new Error("Value should not be data driven");return h.expression.evaluate(b)}interpolate(h,b,M){const q=vr[this.specification.type];return q?q(h,b,M):h}}class jn{constructor(h,b){this.specification=h,this.overrides=b}possiblyEvaluate(h,b,M,q){return new _r(this,h.expression.kind==="constant"||h.expression.kind==="camera"?{kind:"constant",value:h.expression.evaluate(b,null,{},M,q)}:h.expression,b)}interpolate(h,b,M){if(h.value.kind!=="constant"||b.value.kind!=="constant")return h;if(h.value.value===void 0||b.value.value===void 0)return new _r(this,{kind:"constant",value:void 0},h.parameters);const q=vr[this.specification.type];if(q){const K=q(h.value.value,b.value.value,M);return new _r(this,{kind:"constant",value:K},h.parameters)}return h}evaluate(h,b,M,q,K,J){return h.kind==="constant"?h.value:h.evaluate(b,M,q,K,J)}}class Jn extends jn{possiblyEvaluate(h,b,M,q){if(h.value===void 0)return new _r(this,{kind:"constant",value:void 0},b);if(h.expression.kind==="constant"){const K=h.expression.evaluate(b,null,{},M,q),J=h.property.specification.type==="resolvedImage"&&typeof K!="string"?K.name:K,me=this._calculate(J,J,J,b);return new _r(this,{kind:"constant",value:me},b)}if(h.expression.kind==="camera"){const K=this._calculate(h.expression.evaluate({zoom:b.zoom-1}),h.expression.evaluate({zoom:b.zoom}),h.expression.evaluate({zoom:b.zoom+1}),b);return new _r(this,{kind:"constant",value:K},b)}return new _r(this,h.expression,b)}evaluate(h,b,M,q,K,J){if(h.kind==="source"){const me=h.evaluate(b,M,q,K,J);return this._calculate(me,me,me,b)}return h.kind==="composite"?this._calculate(h.evaluate({zoom:Math.floor(b.zoom)-1},M,q),h.evaluate({zoom:Math.floor(b.zoom)},M,q),h.evaluate({zoom:Math.floor(b.zoom)+1},M,q),b):h.value}_calculate(h,b,M,q){return q.zoom>q.zoomHistory.lastIntegerZoom?{from:h,to:b}:{from:M,to:b}}interpolate(h){return h}}class tl{constructor(h){this.specification=h}possiblyEvaluate(h,b,M,q){if(h.value!==void 0){if(h.expression.kind==="constant"){const K=h.expression.evaluate(b,null,{},M,q);return this._calculate(K,K,K,b)}return this._calculate(h.expression.evaluate(new ms(Math.floor(b.zoom-1),b)),h.expression.evaluate(new ms(Math.floor(b.zoom),b)),h.expression.evaluate(new ms(Math.floor(b.zoom+1),b)),b)}}_calculate(h,b,M,q){return q.zoom>q.zoomHistory.lastIntegerZoom?{from:h,to:b}:{from:M,to:b}}interpolate(h){return h}}class Tu{constructor(h){this.specification=h}possiblyEvaluate(h,b,M,q){return!!h.expression.evaluate(b,null,{},M,q)}interpolate(){return!1}}class oa{constructor(h){this.properties=h,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const b in h){const M=h[b];M.specification.overridable&&this.overridableProperties.push(b);const q=this.defaultPropertyValues[b]=new _a(M,void 0),K=this.defaultTransitionablePropertyValues[b]=new el(M);this.defaultTransitioningPropertyValues[b]=K.untransitioned(),this.defaultPossiblyEvaluatedValues[b]=q.possiblyEvaluate({})}}}Sn("DataDrivenProperty",jn),Sn("DataConstantProperty",gn),Sn("CrossFadedDataDrivenProperty",Jn),Sn("CrossFadedProperty",tl),Sn("ColorRampProperty",Tu);const yu="-transition";class vs extends sn{constructor(h,b){if(super(),this.id=h.id,this.type=h.type,this._featureFilter={filter:()=>!0,needGeometry:!1},h.type!=="custom"&&(this.metadata=h.metadata,this.minzoom=h.minzoom,this.maxzoom=h.maxzoom,h.type!=="background"&&(this.source=h.source,this.sourceLayer=h["source-layer"],this.filter=h.filter),b.layout&&(this._unevaluatedLayout=new Nu(b.layout)),b.paint)){this._transitionablePaint=new _u(b.paint);for(const M in h.paint)this.setPaintProperty(M,h.paint[M],{validate:!1});for(const M in h.layout)this.setLayoutProperty(M,h.layout[M],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new gs(b.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(h){return h==="visibility"?this.visibility:this._unevaluatedLayout.getValue(h)}setLayoutProperty(h,b,M={}){b!=null&&this._validate(vo,`layers.${this.id}.layout.${h}`,h,b,M)||(h!=="visibility"?this._unevaluatedLayout.setValue(h,b):this.visibility=b)}getPaintProperty(h){return h.endsWith(yu)?this._transitionablePaint.getTransition(h.slice(0,-11)):this._transitionablePaint.getValue(h)}setPaintProperty(h,b,M={}){if(b!=null&&this._validate(Ru,`layers.${this.id}.paint.${h}`,h,b,M))return!1;if(h.endsWith(yu))return this._transitionablePaint.setTransition(h.slice(0,-11),b||void 0),!1;{const q=this._transitionablePaint._values[h],K=q.property.specification["property-type"]==="cross-faded-data-driven",J=q.value.isDataDriven(),me=q.value;this._transitionablePaint.setValue(h,b),this._handleSpecialPaintPropertyUpdate(h);const Ce=this._transitionablePaint._values[h].value;return Ce.isDataDriven()||J||K||this._handleOverridablePaintPropertyUpdate(h,me,Ce)}}_handleSpecialPaintPropertyUpdate(h){}_handleOverridablePaintPropertyUpdate(h,b,M){return!1}isHidden(h){return!!(this.minzoom&&h<this.minzoom)||!!(this.maxzoom&&h>=this.maxzoom)||this.visibility==="none"}updateTransitions(h){this._transitioningPaint=this._transitionablePaint.transitioned(h,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(h,b){h.getCrossfadeParameters&&(this._crossfadeParameters=h.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(h,void 0,b)),this.paint=this._transitioningPaint.possiblyEvaluate(h,void 0,b)}serialize(){const h={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(h.layout=h.layout||{},h.layout.visibility=this.visibility),mt(h,(b,M)=>!(b===void 0||M==="layout"&&!Object.keys(b).length||M==="paint"&&!Object.keys(b).length))}_validate(h,b,M,q,K={}){return(!K||K.validate!==!1)&&Ml(this,h.call(rs,{key:b,layerType:this.type,objectKey:M,value:q,styleSpec:ei,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const h in this.paint._values){const b=this.paint.get(h);if(b instanceof _r&&Cs(b.property.specification)&&(b.value.kind==="source"||b.value.kind==="composite")&&b.value.isStateDependent)return!0}return!1}}const Po={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Mi{constructor(h,b){this._structArray=h,this._pos1=b*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Bi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(h,b){return h._trim(),b&&(h.isTransferred=!0,b.push(h.arrayBuffer)),{length:h.length,arrayBuffer:h.arrayBuffer}}static deserialize(h){const b=Object.create(this.prototype);return b.arrayBuffer=h.arrayBuffer,b.length=h.length,b.capacity=h.arrayBuffer.byteLength/b.bytesPerElement,b._refreshViews(),b}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(h){this.reserve(h),this.length=h}reserve(h){if(h>this.capacity){this.capacity=Math.max(h,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const b=this.uint8;this._refreshViews(),b&&this.uint8.set(b)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function xs(m,h=1){let b=0,M=0;return{members:m.map(q=>{const K=Po[q.type].BYTES_PER_ELEMENT,J=b=vu(b,Math.max(h,K)),me=q.components||1;return M=Math.max(M,K),b+=K*me,{name:q.name,type:q.type,components:me,offset:J}}),size:vu(b,Math.max(M,h)),alignment:h}}function vu(m,h){return Math.ceil(m/h)*h}class Vo extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,b){const M=this.length;return this.resize(M+1),this.emplace(M,h,b)}emplace(h,b,M){const q=2*h;return this.int16[q+0]=b,this.int16[q+1]=M,h}}Vo.prototype.bytesPerElement=4,Sn("StructArrayLayout2i4",Vo);class fs extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,b,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,b,M)}emplace(h,b,M,q){const K=3*h;return this.int16[K+0]=b,this.int16[K+1]=M,this.int16[K+2]=q,h}}fs.prototype.bytesPerElement=6,Sn("StructArrayLayout3i6",fs);class hl extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,b,M,q){const K=this.length;return this.resize(K+1),this.emplace(K,h,b,M,q)}emplace(h,b,M,q,K){const J=4*h;return this.int16[J+0]=b,this.int16[J+1]=M,this.int16[J+2]=q,this.int16[J+3]=K,h}}hl.prototype.bytesPerElement=8,Sn("StructArrayLayout4i8",hl);class Ms extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,b,M,q,K,J){const me=this.length;return this.resize(me+1),this.emplace(me,h,b,M,q,K,J)}emplace(h,b,M,q,K,J,me){const Ce=6*h;return this.int16[Ce+0]=b,this.int16[Ce+1]=M,this.int16[Ce+2]=q,this.int16[Ce+3]=K,this.int16[Ce+4]=J,this.int16[Ce+5]=me,h}}Ms.prototype.bytesPerElement=12,Sn("StructArrayLayout2i4i12",Ms);class C extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,b,M,q,K,J){const me=this.length;return this.resize(me+1),this.emplace(me,h,b,M,q,K,J)}emplace(h,b,M,q,K,J,me){const Ce=4*h,Ne=8*h;return this.int16[Ce+0]=b,this.int16[Ce+1]=M,this.uint8[Ne+4]=q,this.uint8[Ne+5]=K,this.uint8[Ne+6]=J,this.uint8[Ne+7]=me,h}}C.prototype.bytesPerElement=8,Sn("StructArrayLayout2i4ub8",C);class D extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,b){const M=this.length;return this.resize(M+1),this.emplace(M,h,b)}emplace(h,b,M){const q=2*h;return this.float32[q+0]=b,this.float32[q+1]=M,h}}D.prototype.bytesPerElement=8,Sn("StructArrayLayout2f8",D);class z extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,b,M,q,K,J,me,Ce,Ne,f){const u=this.length;return this.resize(u+1),this.emplace(u,h,b,M,q,K,J,me,Ce,Ne,f)}emplace(h,b,M,q,K,J,me,Ce,Ne,f,u){const p=10*h;return this.uint16[p+0]=b,this.uint16[p+1]=M,this.uint16[p+2]=q,this.uint16[p+3]=K,this.uint16[p+4]=J,this.uint16[p+5]=me,this.uint16[p+6]=Ce,this.uint16[p+7]=Ne,this.uint16[p+8]=f,this.uint16[p+9]=u,h}}z.prototype.bytesPerElement=20,Sn("StructArrayLayout10ui20",z);class R extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,b,M,q,K,J,me,Ce,Ne,f,u,p){const I=this.length;return this.resize(I+1),this.emplace(I,h,b,M,q,K,J,me,Ce,Ne,f,u,p)}emplace(h,b,M,q,K,J,me,Ce,Ne,f,u,p,I){const L=12*h;return this.int16[L+0]=b,this.int16[L+1]=M,this.int16[L+2]=q,this.int16[L+3]=K,this.uint16[L+4]=J,this.uint16[L+5]=me,this.uint16[L+6]=Ce,this.uint16[L+7]=Ne,this.int16[L+8]=f,this.int16[L+9]=u,this.int16[L+10]=p,this.int16[L+11]=I,h}}R.prototype.bytesPerElement=24,Sn("StructArrayLayout4i4ui4i24",R);class ee extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,b,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,b,M)}emplace(h,b,M,q){const K=3*h;return this.float32[K+0]=b,this.float32[K+1]=M,this.float32[K+2]=q,h}}ee.prototype.bytesPerElement=12,Sn("StructArrayLayout3f12",ee);class le extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(h){const b=this.length;return this.resize(b+1),this.emplace(b,h)}emplace(h,b){return this.uint32[1*h+0]=b,h}}le.prototype.bytesPerElement=4,Sn("StructArrayLayout1ul4",le);class oe extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,b,M,q,K,J,me,Ce,Ne){const f=this.length;return this.resize(f+1),this.emplace(f,h,b,M,q,K,J,me,Ce,Ne)}emplace(h,b,M,q,K,J,me,Ce,Ne,f){const u=10*h,p=5*h;return this.int16[u+0]=b,this.int16[u+1]=M,this.int16[u+2]=q,this.int16[u+3]=K,this.int16[u+4]=J,this.int16[u+5]=me,this.uint32[p+3]=Ce,this.uint16[u+8]=Ne,this.uint16[u+9]=f,h}}oe.prototype.bytesPerElement=20,Sn("StructArrayLayout6i1ul2ui20",oe);class we extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,b,M,q,K,J){const me=this.length;return this.resize(me+1),this.emplace(me,h,b,M,q,K,J)}emplace(h,b,M,q,K,J,me){const Ce=6*h;return this.int16[Ce+0]=b,this.int16[Ce+1]=M,this.int16[Ce+2]=q,this.int16[Ce+3]=K,this.int16[Ce+4]=J,this.int16[Ce+5]=me,h}}we.prototype.bytesPerElement=12,Sn("StructArrayLayout2i2i2i12",we);class $e extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,b,M,q,K){const J=this.length;return this.resize(J+1),this.emplace(J,h,b,M,q,K)}emplace(h,b,M,q,K,J){const me=4*h,Ce=8*h;return this.float32[me+0]=b,this.float32[me+1]=M,this.float32[me+2]=q,this.int16[Ce+6]=K,this.int16[Ce+7]=J,h}}$e.prototype.bytesPerElement=16,Sn("StructArrayLayout2f1f2i16",$e);class _t extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,b,M,q){const K=this.length;return this.resize(K+1),this.emplace(K,h,b,M,q)}emplace(h,b,M,q,K){const J=12*h,me=3*h;return this.uint8[J+0]=b,this.uint8[J+1]=M,this.float32[me+1]=q,this.float32[me+2]=K,h}}_t.prototype.bytesPerElement=12,Sn("StructArrayLayout2ub2f12",_t);class Ct extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,b,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,b,M)}emplace(h,b,M,q){const K=3*h;return this.uint16[K+0]=b,this.uint16[K+1]=M,this.uint16[K+2]=q,h}}Ct.prototype.bytesPerElement=6,Sn("StructArrayLayout3ui6",Ct);class ni extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,b,M,q,K,J,me,Ce,Ne,f,u,p,I,L,U,Q,re){const Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,h,b,M,q,K,J,me,Ce,Ne,f,u,p,I,L,U,Q,re)}emplace(h,b,M,q,K,J,me,Ce,Ne,f,u,p,I,L,U,Q,re,Ae){const _e=24*h,Le=12*h,qe=48*h;return this.int16[_e+0]=b,this.int16[_e+1]=M,this.uint16[_e+2]=q,this.uint16[_e+3]=K,this.uint32[Le+2]=J,this.uint32[Le+3]=me,this.uint32[Le+4]=Ce,this.uint16[_e+10]=Ne,this.uint16[_e+11]=f,this.uint16[_e+12]=u,this.float32[Le+7]=p,this.float32[Le+8]=I,this.uint8[qe+36]=L,this.uint8[qe+37]=U,this.uint8[qe+38]=Q,this.uint32[Le+10]=re,this.int16[_e+22]=Ae,h}}ni.prototype.bytesPerElement=48,Sn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ni);class Gt extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,b,M,q,K,J,me,Ce,Ne,f,u,p,I,L,U,Q,re,Ae,_e,Le,qe,et,At,gt,Dt,Lt,Rt,Kt){const Ht=this.length;return this.resize(Ht+1),this.emplace(Ht,h,b,M,q,K,J,me,Ce,Ne,f,u,p,I,L,U,Q,re,Ae,_e,Le,qe,et,At,gt,Dt,Lt,Rt,Kt)}emplace(h,b,M,q,K,J,me,Ce,Ne,f,u,p,I,L,U,Q,re,Ae,_e,Le,qe,et,At,gt,Dt,Lt,Rt,Kt,Ht){const Qt=32*h,ui=16*h;return this.int16[Qt+0]=b,this.int16[Qt+1]=M,this.int16[Qt+2]=q,this.int16[Qt+3]=K,this.int16[Qt+4]=J,this.int16[Qt+5]=me,this.int16[Qt+6]=Ce,this.int16[Qt+7]=Ne,this.uint16[Qt+8]=f,this.uint16[Qt+9]=u,this.uint16[Qt+10]=p,this.uint16[Qt+11]=I,this.uint16[Qt+12]=L,this.uint16[Qt+13]=U,this.uint16[Qt+14]=Q,this.uint16[Qt+15]=re,this.uint16[Qt+16]=Ae,this.uint16[Qt+17]=_e,this.uint16[Qt+18]=Le,this.uint16[Qt+19]=qe,this.uint16[Qt+20]=et,this.uint16[Qt+21]=At,this.uint16[Qt+22]=gt,this.uint32[ui+12]=Dt,this.float32[ui+13]=Lt,this.float32[ui+14]=Rt,this.uint16[Qt+30]=Kt,this.uint16[Qt+31]=Ht,h}}Gt.prototype.bytesPerElement=64,Sn("StructArrayLayout8i15ui1ul2f2ui64",Gt);class Zt extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h){const b=this.length;return this.resize(b+1),this.emplace(b,h)}emplace(h,b){return this.float32[1*h+0]=b,h}}Zt.prototype.bytesPerElement=4,Sn("StructArrayLayout1f4",Zt);class Z extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,b,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,b,M)}emplace(h,b,M,q){const K=3*h;return this.uint16[6*h+0]=b,this.float32[K+1]=M,this.float32[K+2]=q,h}}Z.prototype.bytesPerElement=12,Sn("StructArrayLayout1ui2f12",Z);class A extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,b,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,b,M)}emplace(h,b,M,q){const K=4*h;return this.uint32[2*h+0]=b,this.uint16[K+2]=M,this.uint16[K+3]=q,h}}A.prototype.bytesPerElement=8,Sn("StructArrayLayout1ul2ui8",A);class E extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,b){const M=this.length;return this.resize(M+1),this.emplace(M,h,b)}emplace(h,b,M){const q=2*h;return this.uint16[q+0]=b,this.uint16[q+1]=M,h}}E.prototype.bytesPerElement=4,Sn("StructArrayLayout2ui4",E);class F extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h){const b=this.length;return this.resize(b+1),this.emplace(b,h)}emplace(h,b){return this.uint16[1*h+0]=b,h}}F.prototype.bytesPerElement=2,Sn("StructArrayLayout1ui2",F);class O extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,b,M,q){const K=this.length;return this.resize(K+1),this.emplace(K,h,b,M,q)}emplace(h,b,M,q,K){const J=4*h;return this.float32[J+0]=b,this.float32[J+1]=M,this.float32[J+2]=q,this.float32[J+3]=K,h}}O.prototype.bytesPerElement=16,Sn("StructArrayLayout4f16",O);class y extends Mi{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ae(this.anchorPointX,this.anchorPointY)}}y.prototype.size=20;class s extends oe{get(h){return new y(this,h)}}Sn("CollisionBoxArray",s);class i extends Mi{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(h){this._structArray.uint8[this._pos1+37]=h}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(h){this._structArray.uint8[this._pos1+38]=h}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(h){this._structArray.uint32[this._pos4+10]=h}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}i.prototype.size=48;class r extends ni{get(h){return new i(this,h)}}Sn("PlacedSymbolArray",r);class l extends Mi{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(h){this._structArray.uint32[this._pos4+12]=h}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}l.prototype.size=64;class d extends Gt{get(h){return new l(this,h)}}Sn("SymbolInstanceArray",d);class _ extends Zt{getoffsetX(h){return this.float32[1*h+0]}}Sn("GlyphOffsetArray",_);class w extends fs{getx(h){return this.int16[3*h+0]}gety(h){return this.int16[3*h+1]}gettileUnitDistanceFromAnchor(h){return this.int16[3*h+2]}}Sn("SymbolLineVertexArray",w);class T extends Mi{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}T.prototype.size=12;class B extends Z{get(h){return new T(this,h)}}Sn("TextAnchorOffsetArray",B);class j extends Mi{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}j.prototype.size=8;class X extends A{get(h){return new j(this,h)}}Sn("FeatureIndexArray",X);class ce extends Vo{}class Se extends Vo{}class Te extends Vo{}class Re extends Ms{}class Be extends C{}class Ke extends D{}class yt extends z{}class ot extends R{}class ct extends ee{}class It extends le{}class bt extends we{}class ri extends _t{}class Xt extends Ct{}class ti extends E{}const si=xs([{name:"a_pos",components:2,type:"Int16"}],4),{members:Qi}=si;class Wi{constructor(h=[]){this.segments=h}prepareSegment(h,b,M,q){let K=this.segments[this.segments.length-1];return h>Wi.MAX_VERTEX_ARRAY_LENGTH&&dt(`Max vertices per segment is ${Wi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${h}`),(!K||K.vertexLength+h>Wi.MAX_VERTEX_ARRAY_LENGTH||K.sortKey!==q)&&(K={vertexOffset:b.length,primitiveOffset:M.length,vertexLength:0,primitiveLength:0},q!==void 0&&(K.sortKey=q),this.segments.push(K)),K}get(){return this.segments}destroy(){for(const h of this.segments)for(const b in h.vaos)h.vaos[b].destroy()}static simpleSegment(h,b,M,q){return new Wi([{vertexOffset:h,primitiveOffset:b,vertexLength:M,primitiveLength:q,vaos:{},sortKey:0}])}}function Ei(m,h){return 256*(m=Mt(Math.floor(m),0,255))+Mt(Math.floor(h),0,255)}Wi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Sn("SegmentVector",Wi);const Gi=xs([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var qi={exports:{}},cn={exports:{}};cn.exports=function(m,h){var b,M,q,K,J,me,Ce,Ne;for(M=m.length-(b=3&m.length),q=h,J=3432918353,me=461845907,Ne=0;Ne<M;)Ce=255&m.charCodeAt(Ne)|(255&m.charCodeAt(++Ne))<<8|(255&m.charCodeAt(++Ne))<<16|(255&m.charCodeAt(++Ne))<<24,++Ne,q=27492+(65535&(K=5*(65535&(q=(q^=Ce=(65535&(Ce=(Ce=(65535&Ce)*J+(((Ce>>>16)*J&65535)<<16)&4294967295)<<15|Ce>>>17))*me+(((Ce>>>16)*me&65535)<<16)&4294967295)<<13|q>>>19))+((5*(q>>>16)&65535)<<16)&4294967295))+((58964+(K>>>16)&65535)<<16);switch(Ce=0,b){case 3:Ce^=(255&m.charCodeAt(Ne+2))<<16;case 2:Ce^=(255&m.charCodeAt(Ne+1))<<8;case 1:q^=Ce=(65535&(Ce=(Ce=(65535&(Ce^=255&m.charCodeAt(Ne)))*J+(((Ce>>>16)*J&65535)<<16)&4294967295)<<15|Ce>>>17))*me+(((Ce>>>16)*me&65535)<<16)&4294967295}return q^=m.length,q=2246822507*(65535&(q^=q>>>16))+((2246822507*(q>>>16)&65535)<<16)&4294967295,q=3266489909*(65535&(q^=q>>>13))+((3266489909*(q>>>16)&65535)<<16)&4294967295,(q^=q>>>16)>>>0};var zn=cn.exports,tn={exports:{}};tn.exports=function(m,h){for(var b,M=m.length,q=h^M,K=0;M>=4;)b=1540483477*(65535&(b=255&m.charCodeAt(K)|(255&m.charCodeAt(++K))<<8|(255&m.charCodeAt(++K))<<16|(255&m.charCodeAt(++K))<<24))+((1540483477*(b>>>16)&65535)<<16),q=1540483477*(65535&q)+((1540483477*(q>>>16)&65535)<<16)^(b=1540483477*(65535&(b^=b>>>24))+((1540483477*(b>>>16)&65535)<<16)),M-=4,++K;switch(M){case 3:q^=(255&m.charCodeAt(K+2))<<16;case 2:q^=(255&m.charCodeAt(K+1))<<8;case 1:q=1540483477*(65535&(q^=255&m.charCodeAt(K)))+((1540483477*(q>>>16)&65535)<<16)}return q=1540483477*(65535&(q^=q>>>13))+((1540483477*(q>>>16)&65535)<<16),(q^=q>>>15)>>>0};var kn=zn,yr=tn.exports;qi.exports=kn,qi.exports.murmur3=kn,qi.exports.murmur2=yr;var er=G(qi.exports);class Ia{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(h,b,M,q){this.ids.push(Aa(h)),this.positions.push(b,M,q)}getPositions(h){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const b=Aa(h);let M=0,q=this.ids.length-1;for(;M<q;){const J=M+q>>1;this.ids[J]>=b?q=J:M=J+1}const K=[];for(;this.ids[M]===b;)K.push({index:this.positions[3*M],start:this.positions[3*M+1],end:this.positions[3*M+2]}),M++;return K}static serialize(h,b){const M=new Float64Array(h.ids),q=new Uint32Array(h.positions);return zs(M,q,0,M.length-1),b&&b.push(M.buffer,q.buffer),{ids:M,positions:q}}static deserialize(h){const b=new Ia;return b.ids=h.ids,b.positions=h.positions,b.indexed=!0,b}}function Aa(m){const h=+m;return!isNaN(h)&&h<=Number.MAX_SAFE_INTEGER?h:er(String(m))}function zs(m,h,b,M){for(;b<M;){const q=m[b+M>>1];let K=b-1,J=M+1;for(;;){do K++;while(m[K]<q);do J--;while(m[J]>q);if(K>=J)break;oo(m,K,J),oo(h,3*K,3*J),oo(h,3*K+1,3*J+1),oo(h,3*K+2,3*J+2)}J-b<M-J?(zs(m,h,b,J),b=J+1):(zs(m,h,J+1,M),M=J)}}function oo(m,h,b){const M=m[h];m[h]=m[b],m[b]=M}Sn("FeaturePositionMap",Ia);class lo{constructor(h,b){this.gl=h.gl,this.location=b}}class qr extends lo{constructor(h,b){super(h,b),this.current=0}set(h){this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class ya extends lo{constructor(h,b){super(h,b),this.current=[0,0,0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3]))}}class xo extends lo{constructor(h,b){super(h,b),this.current=mn.transparent}set(h){h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a))}}const bo=new Float32Array(16);function Qs(m){return[Ei(255*m.r,255*m.g),Ei(255*m.b,255*m.a)]}class ts{constructor(h,b,M){this.value=h,this.uniformNames=b.map(q=>`u_${q}`),this.type=M}setUniform(h,b,M){h.set(M.constantOr(this.value))}getBinding(h,b,M){return this.type==="color"?new xo(h,b):new qr(h,b)}}class is{constructor(h,b){this.uniformNames=b.map(M=>`u_${M}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(h,b){this.pixelRatioFrom=b.pixelRatio,this.pixelRatioTo=h.pixelRatio,this.patternFrom=b.tlbr,this.patternTo=h.tlbr}setUniform(h,b,M,q){const K=q==="u_pattern_to"?this.patternTo:q==="u_pattern_from"?this.patternFrom:q==="u_pixel_ratio_to"?this.pixelRatioTo:q==="u_pixel_ratio_from"?this.pixelRatioFrom:null;K&&h.set(K)}getBinding(h,b,M){return M.substr(0,9)==="u_pattern"?new ya(h,b):new qr(h,b)}}class Rr{constructor(h,b,M,q){this.expression=h,this.type=M,this.maxValue=0,this.paintVertexAttributes=b.map(K=>({name:`a_${K}`,type:"Float32",components:M==="color"?2:1,offset:0})),this.paintVertexArray=new q}populatePaintArray(h,b,M,q,K){const J=this.paintVertexArray.length,me=this.expression.evaluate(new ms(0),b,{},q,[],K);this.paintVertexArray.resize(h),this._setPaintValue(J,h,me)}updatePaintArray(h,b,M,q){const K=this.expression.evaluate({zoom:0},M,q);this._setPaintValue(h,b,K)}_setPaintValue(h,b,M){if(this.type==="color"){const q=Qs(M);for(let K=h;K<b;K++)this.paintVertexArray.emplace(K,q[0],q[1])}else{for(let q=h;q<b;q++)this.paintVertexArray.emplace(q,M);this.maxValue=Math.max(this.maxValue,Math.abs(M))}}upload(h){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=h.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class bs{constructor(h,b,M,q,K,J){this.expression=h,this.uniformNames=b.map(me=>`u_${me}_t`),this.type=M,this.useIntegerZoom=q,this.zoom=K,this.maxValue=0,this.paintVertexAttributes=b.map(me=>({name:`a_${me}`,type:"Float32",components:M==="color"?4:2,offset:0})),this.paintVertexArray=new J}populatePaintArray(h,b,M,q,K){const J=this.expression.evaluate(new ms(this.zoom),b,{},q,[],K),me=this.expression.evaluate(new ms(this.zoom+1),b,{},q,[],K),Ce=this.paintVertexArray.length;this.paintVertexArray.resize(h),this._setPaintValue(Ce,h,J,me)}updatePaintArray(h,b,M,q){const K=this.expression.evaluate({zoom:this.zoom},M,q),J=this.expression.evaluate({zoom:this.zoom+1},M,q);this._setPaintValue(h,b,K,J)}_setPaintValue(h,b,M,q){if(this.type==="color"){const K=Qs(M),J=Qs(q);for(let me=h;me<b;me++)this.paintVertexArray.emplace(me,K[0],K[1],J[0],J[1])}else{for(let K=h;K<b;K++)this.paintVertexArray.emplace(K,M,q);this.maxValue=Math.max(this.maxValue,Math.abs(M),Math.abs(q))}}upload(h){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=h.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(h,b){const M=this.useIntegerZoom?Math.floor(b.zoom):b.zoom,q=Mt(this.expression.interpolationFactor(M,this.zoom,this.zoom+1),0,1);h.set(q)}getBinding(h,b,M){return new qr(h,b)}}class Ws{constructor(h,b,M,q,K,J){this.expression=h,this.type=b,this.useIntegerZoom=M,this.zoom=q,this.layerId=J,this.zoomInPaintVertexArray=new K,this.zoomOutPaintVertexArray=new K}populatePaintArray(h,b,M){const q=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(h),this.zoomOutPaintVertexArray.resize(h),this._setPaintValues(q,h,b.patterns&&b.patterns[this.layerId],M)}updatePaintArray(h,b,M,q,K){this._setPaintValues(h,b,M.patterns&&M.patterns[this.layerId],K)}_setPaintValues(h,b,M,q){if(!q||!M)return;const{min:K,mid:J,max:me}=M,Ce=q[K],Ne=q[J],f=q[me];if(Ce&&Ne&&f)for(let u=h;u<b;u++)this.zoomInPaintVertexArray.emplace(u,Ne.tl[0],Ne.tl[1],Ne.br[0],Ne.br[1],Ce.tl[0],Ce.tl[1],Ce.br[0],Ce.br[1],Ne.pixelRatio,Ce.pixelRatio),this.zoomOutPaintVertexArray.emplace(u,Ne.tl[0],Ne.tl[1],Ne.br[0],Ne.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],Ne.pixelRatio,f.pixelRatio)}upload(h){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=h.createVertexBuffer(this.zoomInPaintVertexArray,Gi.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=h.createVertexBuffer(this.zoomOutPaintVertexArray,Gi.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Do{constructor(h,b,M){this.binders={},this._buffers=[];const q=[];for(const K in h.paint._values){if(!M(K))continue;const J=h.paint.get(K);if(!(J instanceof _r&&Cs(J.property.specification)))continue;const me=Go(K,h.type),Ce=J.value,Ne=J.property.specification.type,f=J.property.useIntegerZoom,u=J.property.specification["property-type"],p=u==="cross-faded"||u==="cross-faded-data-driven";if(Ce.kind==="constant")this.binders[K]=p?new is(Ce.value,me):new ts(Ce.value,me,Ne),q.push(`/u_${K}`);else if(Ce.kind==="source"||p){const I=Ic(K,Ne,"source");this.binders[K]=p?new Ws(Ce,Ne,f,b,I,h.id):new Rr(Ce,me,Ne,I),q.push(`/a_${K}`)}else{const I=Ic(K,Ne,"composite");this.binders[K]=new bs(Ce,me,Ne,f,b,I),q.push(`/z_${K}`)}}this.cacheKey=q.sort().join("")}getMaxValue(h){const b=this.binders[h];return b instanceof Rr||b instanceof bs?b.maxValue:0}populatePaintArrays(h,b,M,q,K){for(const J in this.binders){const me=this.binders[J];(me instanceof Rr||me instanceof bs||me instanceof Ws)&&me.populatePaintArray(h,b,M,q,K)}}setConstantPatternPositions(h,b){for(const M in this.binders){const q=this.binders[M];q instanceof is&&q.setConstantPatternPositions(h,b)}}updatePaintArrays(h,b,M,q,K){let J=!1;for(const me in h){const Ce=b.getPositions(me);for(const Ne of Ce){const f=M.feature(Ne.index);for(const u in this.binders){const p=this.binders[u];if((p instanceof Rr||p instanceof bs||p instanceof Ws)&&p.expression.isStateDependent===!0){const I=q.paint.get(u);p.expression=I.value,p.updatePaintArray(Ne.start,Ne.end,f,h[me],K),J=!0}}}}return J}defines(){const h=[];for(const b in this.binders){const M=this.binders[b];(M instanceof ts||M instanceof is)&&h.push(...M.uniformNames.map(q=>`#define HAS_UNIFORM_${q}`))}return h}getBinderAttributes(){const h=[];for(const b in this.binders){const M=this.binders[b];if(M instanceof Rr||M instanceof bs)for(let q=0;q<M.paintVertexAttributes.length;q++)h.push(M.paintVertexAttributes[q].name);else if(M instanceof Ws)for(let q=0;q<Gi.members.length;q++)h.push(Gi.members[q].name)}return h}getBinderUniforms(){const h=[];for(const b in this.binders){const M=this.binders[b];if(M instanceof ts||M instanceof is||M instanceof bs)for(const q of M.uniformNames)h.push(q)}return h}getPaintVertexBuffers(){return this._buffers}getUniforms(h,b){const M=[];for(const q in this.binders){const K=this.binders[q];if(K instanceof ts||K instanceof is||K instanceof bs){for(const J of K.uniformNames)if(b[J]){const me=K.getBinding(h,b[J],J);M.push({name:J,property:q,binding:me})}}}return M}setUniforms(h,b,M,q){for(const{name:K,property:J,binding:me}of b)this.binders[J].setUniform(me,q,M.get(J),K)}updatePaintBuffers(h){this._buffers=[];for(const b in this.binders){const M=this.binders[b];if(h&&M instanceof Ws){const q=h.fromScale===2?M.zoomInPaintVertexBuffer:M.zoomOutPaintVertexBuffer;q&&this._buffers.push(q)}else(M instanceof Rr||M instanceof bs)&&M.paintVertexBuffer&&this._buffers.push(M.paintVertexBuffer)}}upload(h){for(const b in this.binders){const M=this.binders[b];(M instanceof Rr||M instanceof bs||M instanceof Ws)&&M.upload(h)}this.updatePaintBuffers()}destroy(){for(const h in this.binders){const b=this.binders[h];(b instanceof Rr||b instanceof bs||b instanceof Ws)&&b.destroy()}}}class Uo{constructor(h,b,M=()=>!0){this.programConfigurations={};for(const q of h)this.programConfigurations[q.id]=new Do(q,b,M);this.needsUpload=!1,this._featureMap=new Ia,this._bufferOffset=0}populatePaintArrays(h,b,M,q,K,J){for(const me in this.programConfigurations)this.programConfigurations[me].populatePaintArrays(h,b,q,K,J);b.id!==void 0&&this._featureMap.add(b.id,M,this._bufferOffset,h),this._bufferOffset=h,this.needsUpload=!0}updatePaintArrays(h,b,M,q){for(const K of M)this.needsUpload=this.programConfigurations[K.id].updatePaintArrays(h,this._featureMap,b,K,q)||this.needsUpload}get(h){return this.programConfigurations[h]}upload(h){if(this.needsUpload){for(const b in this.programConfigurations)this.programConfigurations[b].upload(h);this.needsUpload=!1}}destroy(){for(const h in this.programConfigurations)this.programConfigurations[h].destroy()}}function Go(m,h){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[m]||[m.replace(`${h}-`,"").replace(/-/g,"_")]}function Ic(m,h,b){const M={color:{source:D,composite:O},number:{source:Zt,composite:D}},q=function(K){return{"line-pattern":{source:yt,composite:yt},"fill-pattern":{source:yt,composite:yt},"fill-extrusion-pattern":{source:yt,composite:yt}}[K]}(m);return q&&q[b]||M[h][b]}Sn("ConstantBinder",ts),Sn("CrossFadedConstantBinder",is),Sn("SourceExpressionBinder",Rr),Sn("CrossFadedCompositeBinder",Ws),Sn("CompositeExpressionBinder",bs),Sn("ProgramConfiguration",Do,{omit:["_buffers"]}),Sn("ProgramConfigurationSet",Uo);const $s=8192,Xl=Math.pow(2,14)-1,hu=-Xl-1;function il(m){const h=$s/m.extent,b=m.loadGeometry();for(let M=0;M<b.length;M++){const q=b[M];for(let K=0;K<q.length;K++){const J=q[K],me=Math.round(J.x*h),Ce=Math.round(J.y*h);J.x=Mt(me,hu,Xl),J.y=Mt(Ce,hu,Xl),(me<J.x||me>J.x+1||Ce<J.y||Ce>J.y+1)&&dt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return b}function vl(m,h){return{type:m.type,id:m.id,properties:m.properties,geometry:h?il(m):[]}}function Pl(m,h,b,M,q){m.emplaceBack(2*h+(M+1)/2,2*b+(q+1)/2)}class Au{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(b=>b.id),this.index=h.index,this.hasPattern=!1,this.layoutVertexArray=new Se,this.indexArray=new Xt,this.segments=new Wi,this.programConfigurations=new Uo(h.layers,h.zoom),this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id)}populate(h,b,M){const q=this.layers[0],K=[];let J=null,me=!1;q.type==="circle"&&(J=q.layout.get("circle-sort-key"),me=!J.isConstant());for(const{feature:Ce,id:Ne,index:f,sourceLayerIndex:u}of h){const p=this.layers[0]._featureFilter.needGeometry,I=vl(Ce,p);if(!this.layers[0]._featureFilter.filter(new ms(this.zoom),I,M))continue;const L=me?J.evaluate(I,{},M):void 0,U={id:Ne,properties:Ce.properties,type:Ce.type,sourceLayerIndex:u,index:f,geometry:p?I.geometry:il(Ce),patterns:{},sortKey:L};K.push(U)}me&&K.sort((Ce,Ne)=>Ce.sortKey-Ne.sortKey);for(const Ce of K){const{geometry:Ne,index:f,sourceLayerIndex:u}=Ce,p=h[f].feature;this.addFeature(Ce,Ne,f,M),b.featureIndex.insert(p,Ne,f,u,this.index)}}update(h,b,M){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,b,this.stateDependentLayers,M)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,Qi),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(h,b,M,q){for(const K of b)for(const J of K){const me=J.x,Ce=J.y;if(me<0||me>=$s||Ce<0||Ce>=$s)continue;const Ne=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,h.sortKey),f=Ne.vertexLength;Pl(this.layoutVertexArray,me,Ce,-1,-1),Pl(this.layoutVertexArray,me,Ce,1,-1),Pl(this.layoutVertexArray,me,Ce,1,1),Pl(this.layoutVertexArray,me,Ce,-1,1),this.indexArray.emplaceBack(f,f+1,f+2),this.indexArray.emplaceBack(f,f+3,f+2),Ne.vertexLength+=4,Ne.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,M,{},q)}}function af(m,h){for(let b=0;b<m.length;b++)if($c(h,m[b]))return!0;for(let b=0;b<h.length;b++)if($c(m,h[b]))return!0;return!!yh(m,h)}function Vh(m,h,b){return!!$c(m,h)||!!Ec(h,m,b)}function Pa(m,h){if(m.length===1)return l0(h,m[0]);for(let b=0;b<h.length;b++){const M=h[b];for(let q=0;q<M.length;q++)if($c(m,M[q]))return!0}for(let b=0;b<m.length;b++)if(l0(h,m[b]))return!0;for(let b=0;b<h.length;b++)if(yh(m,h[b]))return!0;return!1}function pA(m,h,b){if(m.length>1){if(yh(m,h))return!0;for(let M=0;M<h.length;M++)if(Ec(h[M],m,b))return!0}for(let M=0;M<m.length;M++)if(Ec(m[M],h,b))return!0;return!1}function yh(m,h){if(m.length===0||h.length===0)return!1;for(let b=0;b<m.length-1;b++){const M=m[b],q=m[b+1];for(let K=0;K<h.length-1;K++)if(Uh(M,q,h[K],h[K+1]))return!0}return!1}function Uh(m,h,b,M){return Je(m,b,M)!==Je(h,b,M)&&Je(m,h,b)!==Je(m,h,M)}function Ec(m,h,b){const M=b*b;if(h.length===1)return m.distSqr(h[0])<M;for(let q=1;q<h.length;q++)if(Gh(m,h[q-1],h[q])<M)return!0;return!1}function Gh(m,h,b){const M=h.distSqr(b);if(M===0)return m.distSqr(h);const q=((m.x-h.x)*(b.x-h.x)+(m.y-h.y)*(b.y-h.y))/M;return m.distSqr(q<0?h:q>1?b:b.sub(h)._mult(q)._add(h))}function l0(m,h){let b,M,q,K=!1;for(let J=0;J<m.length;J++){b=m[J];for(let me=0,Ce=b.length-1;me<b.length;Ce=me++)M=b[me],q=b[Ce],M.y>h.y!=q.y>h.y&&h.x<(q.x-M.x)*(h.y-M.y)/(q.y-M.y)+M.x&&(K=!K)}return K}function $c(m,h){let b=!1;for(let M=0,q=m.length-1;M<m.length;q=M++){const K=m[M],J=m[q];K.y>h.y!=J.y>h.y&&h.x<(J.x-K.x)*(h.y-K.y)/(J.y-K.y)+K.x&&(b=!b)}return b}function _p(m,h,b){const M=b[0],q=b[2];if(m.x<M.x&&h.x<M.x||m.x>q.x&&h.x>q.x||m.y<M.y&&h.y<M.y||m.y>q.y&&h.y>q.y)return!1;const K=Je(m,h,b[0]);return K!==Je(m,h,b[1])||K!==Je(m,h,b[2])||K!==Je(m,h,b[3])}function qh(m,h,b){const M=h.paint.get(m).value;return M.kind==="constant"?M.value:b.programConfigurations.get(h.id).getMaxValue(m)}function of(m){return Math.sqrt(m[0]*m[0]+m[1]*m[1])}function Xc(m,h,b,M,q){if(!h[0]&&!h[1])return m;const K=ae.convert(h)._mult(q);b==="viewport"&&K._rotate(-M);const J=[];for(let me=0;me<m.length;me++)J.push(m[me].sub(K));return J}let yp,lf;Sn("CircleBucket",Au,{omit:["layers"]});var H0={get paint(){return lf=lf||new oa({"circle-radius":new jn(ei.paint_circle["circle-radius"]),"circle-color":new jn(ei.paint_circle["circle-color"]),"circle-blur":new jn(ei.paint_circle["circle-blur"]),"circle-opacity":new jn(ei.paint_circle["circle-opacity"]),"circle-translate":new gn(ei.paint_circle["circle-translate"]),"circle-translate-anchor":new gn(ei.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new gn(ei.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new gn(ei.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new jn(ei.paint_circle["circle-stroke-width"]),"circle-stroke-color":new jn(ei.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new jn(ei.paint_circle["circle-stroke-opacity"])})},get layout(){return yp=yp||new oa({"circle-sort-key":new jn(ei.layout_circle["circle-sort-key"])})}},Yl=1e-6,Xu=typeof Float32Array<"u"?Float32Array:Array;function j0(m){return m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=1,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=1,m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,m}function vh(m,h,b){var M=h[0],q=h[1],K=h[2],J=h[3],me=h[4],Ce=h[5],Ne=h[6],f=h[7],u=h[8],p=h[9],I=h[10],L=h[11],U=h[12],Q=h[13],re=h[14],Ae=h[15],_e=b[0],Le=b[1],qe=b[2],et=b[3];return m[0]=_e*M+Le*me+qe*u+et*U,m[1]=_e*q+Le*Ce+qe*p+et*Q,m[2]=_e*K+Le*Ne+qe*I+et*re,m[3]=_e*J+Le*f+qe*L+et*Ae,m[4]=(_e=b[4])*M+(Le=b[5])*me+(qe=b[6])*u+(et=b[7])*U,m[5]=_e*q+Le*Ce+qe*p+et*Q,m[6]=_e*K+Le*Ne+qe*I+et*re,m[7]=_e*J+Le*f+qe*L+et*Ae,m[8]=(_e=b[8])*M+(Le=b[9])*me+(qe=b[10])*u+(et=b[11])*U,m[9]=_e*q+Le*Ce+qe*p+et*Q,m[10]=_e*K+Le*Ne+qe*I+et*re,m[11]=_e*J+Le*f+qe*L+et*Ae,m[12]=(_e=b[12])*M+(Le=b[13])*me+(qe=b[14])*u+(et=b[15])*U,m[13]=_e*q+Le*Ce+qe*p+et*Q,m[14]=_e*K+Le*Ne+qe*I+et*re,m[15]=_e*J+Le*f+qe*L+et*Ae,m}Math.hypot||(Math.hypot=function(){for(var m=0,h=arguments.length;h--;)m+=arguments[h]*arguments[h];return Math.sqrt(m)});var Yc,mA=vh;function uf(m,h,b){var M=h[0],q=h[1],K=h[2],J=h[3];return m[0]=b[0]*M+b[4]*q+b[8]*K+b[12]*J,m[1]=b[1]*M+b[5]*q+b[9]*K+b[13]*J,m[2]=b[2]*M+b[6]*q+b[10]*K+b[14]*J,m[3]=b[3]*M+b[7]*q+b[11]*K+b[15]*J,m}Yc=new Xu(4),Xu!=Float32Array&&(Yc[0]=0,Yc[1]=0,Yc[2]=0,Yc[3]=0);class u0 extends vs{constructor(h){super(h,H0)}createBucket(h){return new Au(h)}queryRadius(h){const b=h;return qh("circle-radius",this,b)+qh("circle-stroke-width",this,b)+of(this.paint.get("circle-translate"))}queryIntersectsFeature(h,b,M,q,K,J,me,Ce){const Ne=Xc(h,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),J.angle,me),f=this.paint.get("circle-radius").evaluate(b,M)+this.paint.get("circle-stroke-width").evaluate(b,M),u=this.paint.get("circle-pitch-alignment")==="map",p=u?Ne:function(L,U){return L.map(Q=>_s(Q,U))}(Ne,Ce),I=u?f*me:f;for(const L of q)for(const U of L){const Q=u?U:_s(U,Ce);let re=I;const Ae=uf([],[U.x,U.y,0,1],Ce);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?re*=Ae[3]/J.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(re*=J.cameraToCenterDistance/Ae[3]),Vh(p,Q,re))return!0}return!1}}function _s(m,h){const b=uf([],[m.x,m.y,0,1],h);return new ae(b[0]/b[3],b[1]/b[3])}class Kl extends Au{}let Hh;Sn("HeatmapBucket",Kl,{omit:["layers"]});var jh={get paint(){return Hh=Hh||new oa({"heatmap-radius":new jn(ei.paint_heatmap["heatmap-radius"]),"heatmap-weight":new jn(ei.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new gn(ei.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Tu(ei.paint_heatmap["heatmap-color"]),"heatmap-opacity":new gn(ei.paint_heatmap["heatmap-opacity"])})}};function cf(m,{width:h,height:b},M,q){if(q){if(q instanceof Uint8ClampedArray)q=new Uint8Array(q.buffer);else if(q.length!==h*b*M)throw new RangeError(`mismatched image size. expected: ${q.length} but got: ${h*b*M}`)}else q=new Uint8Array(h*b*M);return m.width=h,m.height=b,m.data=q,m}function gA(m,{width:h,height:b},M){if(h===m.width&&b===m.height)return;const q=cf({},{width:h,height:b},M);Z0(m,q,{x:0,y:0},{x:0,y:0},{width:Math.min(m.width,h),height:Math.min(m.height,b)},M),m.width=h,m.height=b,m.data=q.data}function Z0(m,h,b,M,q,K){if(q.width===0||q.height===0)return h;if(q.width>m.width||q.height>m.height||b.x>m.width-q.width||b.y>m.height-q.height)throw new RangeError("out of range source coordinates for image copy");if(q.width>h.width||q.height>h.height||M.x>h.width-q.width||M.y>h.height-q.height)throw new RangeError("out of range destination coordinates for image copy");const J=m.data,me=h.data;if(J===me)throw new Error("srcData equals dstData, so image is already copied");for(let Ce=0;Ce<q.height;Ce++){const Ne=((b.y+Ce)*m.width+b.x)*K,f=((M.y+Ce)*h.width+M.x)*K;for(let u=0;u<q.width*K;u++)me[f+u]=J[Ne+u]}return h}class Dl{constructor(h,b){cf(this,h,1,b)}resize(h){gA(this,h,1)}clone(){return new Dl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(h,b,M,q,K){Z0(h,b,M,q,K,1)}}class Vu{constructor(h,b){cf(this,h,4,b)}resize(h){gA(this,h,4)}replace(h,b){b?this.data.set(h):this.data=h instanceof Uint8ClampedArray?new Uint8Array(h.buffer):h}clone(){return new Vu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(h,b,M,q,K){Z0(h,b,M,q,K,4)}}function _A(m){const h={},b=m.resolution||256,M=m.clips?m.clips.length:1,q=m.image||new Vu({width:b,height:M});if(Math.log(b)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${b}`);const K=(J,me,Ce)=>{h[m.evaluationKey]=Ce;const Ne=m.expression.evaluate(h);q.data[J+me+0]=Math.floor(255*Ne.r/Ne.a),q.data[J+me+1]=Math.floor(255*Ne.g/Ne.a),q.data[J+me+2]=Math.floor(255*Ne.b/Ne.a),q.data[J+me+3]=Math.floor(255*Ne.a)};if(m.clips)for(let J=0,me=0;J<M;++J,me+=4*b)for(let Ce=0,Ne=0;Ce<b;Ce++,Ne+=4){const f=Ce/(b-1),{start:u,end:p}=m.clips[J];K(me,Ne,u*(1-f)+p*f)}else for(let J=0,me=0;J<b;J++,me+=4)K(0,me,J/(b-1));return q}Sn("AlphaImage",Dl),Sn("RGBAImage",Vu);class c0 extends vs{createBucket(h){return new Kl(h)}constructor(h){super(h,jh),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(h){h==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=_A({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let h0;var vp={get paint(){return h0=h0||new oa({"hillshade-illumination-direction":new gn(ei.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new gn(ei.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new gn(ei.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new gn(ei.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new gn(ei.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new gn(ei.paint_hillshade["hillshade-accent-color"])})}};class xu extends vs{constructor(h){super(h,vp)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const Kc=xs([{name:"a_pos",components:2,type:"Int16"}],4),{members:hf}=Kc;var xh={exports:{}};function Ll(m,h,b){b=b||2;var M,q,K,J,me,Ce,Ne,f=h&&h.length,u=f?h[0]*b:m.length,p=A0(m,0,u,b,!0),I=[];if(!p||p.next===p.prev)return I;if(f&&(p=function(U,Q,re,Ae){var _e,Le,qe,et=[];for(_e=0,Le=Q.length;_e<Le;_e++)(qe=A0(U,Q[_e]*Ae,_e<Le-1?Q[_e+1]*Ae:U.length,Ae,!1))===qe.next&&(qe.steiner=!0),et.push(ff(qe));for(et.sort(Cc),_e=0;_e<et.length;_e++)re=Af(et[_e],re);return re}(m,h,p,b)),m.length>80*b){M=K=m[0],q=J=m[1];for(var L=b;L<u;L+=b)(me=m[L])<M&&(M=me),(Ce=m[L+1])<q&&(q=Ce),me>K&&(K=me),Ce>J&&(J=Ce);Ne=(Ne=Math.max(K-M,J-q))!==0?32767/Ne:0}return Zh(p,I,b,M,q,Ne,0),I}function A0(m,h,b,M,q){var K,J;if(q===cc(m,h,b,M)>0)for(K=h;K<b;K+=M)J=Qh(K,m[K],m[K+1],J);else for(K=b-M;K>=h;K-=M)J=Qh(K,m[K],m[K+1],J);return J&&df(J,J.next)&&(gf(J),J=J.next),J}function Jc(m,h){if(!m)return m;h||(h=m);var b,M=m;do if(b=!1,M.steiner||!df(M,M.next)&&Lo(M.prev,M,M.next)!==0)M=M.next;else{if(gf(M),(M=h=M.prev)===M.next)break;b=!0}while(b||M!==h);return h}function Zh(m,h,b,M,q,K,J){if(m){!J&&K&&function(f,u,p,I){var L=f;do L.z===0&&(L.z=lc(L.x,L.y,u,p,I)),L.prevZ=L.prev,L.nextZ=L.next,L=L.next;while(L!==f);L.prevZ.nextZ=null,L.prevZ=null,function(U){var Q,re,Ae,_e,Le,qe,et,At,gt=1;do{for(re=U,U=null,Le=null,qe=0;re;){for(qe++,Ae=re,et=0,Q=0;Q<gt&&(et++,Ae=Ae.nextZ);Q++);for(At=gt;et>0||At>0&&Ae;)et!==0&&(At===0||!Ae||re.z<=Ae.z)?(_e=re,re=re.nextZ,et--):(_e=Ae,Ae=Ae.nextZ,At--),Le?Le.nextZ=_e:U=_e,_e.prevZ=Le,Le=_e;re=Ae}Le.nextZ=null,gt*=2}while(qe>1)}(L)}(m,M,q,K);for(var me,Ce,Ne=m;m.prev!==m.next;)if(me=m.prev,Ce=m.next,K?W0(m,M,q,K):Q0(m))h.push(me.i/b|0),h.push(m.i/b|0),h.push(Ce.i/b|0),gf(m),m=Ce.next,Ne=Ce.next;else if((m=Ce)===Ne){J?J===1?Zh(m=bh(Jc(m),h,b),h,b,M,q,K,2):J===2&&Cm(m,h,b,M,q,K):Zh(Jc(m),h,b,M,q,K,1);break}}}function Q0(m){var h=m.prev,b=m,M=m.next;if(Lo(h,b,M)>=0)return!1;for(var q=h.x,K=b.x,J=M.x,me=h.y,Ce=b.y,Ne=M.y,f=q<K?q<J?q:J:K<J?K:J,u=me<Ce?me<Ne?me:Ne:Ce<Ne?Ce:Ne,p=q>K?q>J?q:J:K>J?K:J,I=me>Ce?me>Ne?me:Ne:Ce>Ne?Ce:Ne,L=M.next;L!==h;){if(L.x>=f&&L.x<=p&&L.y>=u&&L.y<=I&&yA(q,me,K,Ce,J,Ne,L.x,L.y)&&Lo(L.prev,L,L.next)>=0)return!1;L=L.next}return!0}function W0(m,h,b,M){var q=m.prev,K=m,J=m.next;if(Lo(q,K,J)>=0)return!1;for(var me=q.x,Ce=K.x,Ne=J.x,f=q.y,u=K.y,p=J.y,I=me<Ce?me<Ne?me:Ne:Ce<Ne?Ce:Ne,L=f<u?f<p?f:p:u<p?u:p,U=me>Ce?me>Ne?me:Ne:Ce>Ne?Ce:Ne,Q=f>u?f>p?f:p:u>p?u:p,re=lc(I,L,h,b,M),Ae=lc(U,Q,h,b,M),_e=m.prevZ,Le=m.nextZ;_e&&_e.z>=re&&Le&&Le.z<=Ae;){if(_e.x>=I&&_e.x<=U&&_e.y>=L&&_e.y<=Q&&_e!==q&&_e!==J&&yA(me,f,Ce,u,Ne,p,_e.x,_e.y)&&Lo(_e.prev,_e,_e.next)>=0||(_e=_e.prevZ,Le.x>=I&&Le.x<=U&&Le.y>=L&&Le.y<=Q&&Le!==q&&Le!==J&&yA(me,f,Ce,u,Ne,p,Le.x,Le.y)&&Lo(Le.prev,Le,Le.next)>=0))return!1;Le=Le.nextZ}for(;_e&&_e.z>=re;){if(_e.x>=I&&_e.x<=U&&_e.y>=L&&_e.y<=Q&&_e!==q&&_e!==J&&yA(me,f,Ce,u,Ne,p,_e.x,_e.y)&&Lo(_e.prev,_e,_e.next)>=0)return!1;_e=_e.prevZ}for(;Le&&Le.z<=Ae;){if(Le.x>=I&&Le.x<=U&&Le.y>=L&&Le.y<=Q&&Le!==q&&Le!==J&&yA(me,f,Ce,u,Ne,p,Le.x,Le.y)&&Lo(Le.prev,Le,Le.next)>=0)return!1;Le=Le.nextZ}return!0}function bh(m,h,b){var M=m;do{var q=M.prev,K=M.next.next;!df(q,K)&&xp(q,M,M.next,K)&&xl(q,K)&&xl(K,q)&&(h.push(q.i/b|0),h.push(M.i/b|0),h.push(K.i/b|0),gf(M),gf(M.next),M=m=K),M=M.next}while(M!==m);return Jc(M)}function Cm(m,h,b,M,q,K){var J=m;do{for(var me=J.next.next;me!==J.prev;){if(J.i!==me.i&&Tm(J,me)){var Ce=uc(J,me);return J=Jc(J,J.next),Ce=Jc(Ce,Ce.next),Zh(J,h,b,M,q,K,0),void Zh(Ce,h,b,M,q,K,0)}me=me.next}J=J.next}while(J!==m)}function Cc(m,h){return m.x-h.x}function Af(m,h){var b=function(q,K){var J,me=K,Ce=q.x,Ne=q.y,f=-1/0;do{if(Ne<=me.y&&Ne>=me.next.y&&me.next.y!==me.y){var u=me.x+(Ne-me.y)*(me.next.x-me.x)/(me.next.y-me.y);if(u<=Ce&&u>f&&(f=u,J=me.x<me.next.x?me:me.next,u===Ce))return J}me=me.next}while(me!==K);if(!J)return null;var p,I=J,L=J.x,U=J.y,Q=1/0;me=J;do Ce>=me.x&&me.x>=L&&Ce!==me.x&&yA(Ne<U?Ce:f,Ne,L,U,Ne<U?f:Ce,Ne,me.x,me.y)&&(p=Math.abs(Ne-me.y)/(Ce-me.x),xl(me,q)&&(p<Q||p===Q&&(me.x>J.x||me.x===J.x&&$0(J,me)))&&(J=me,Q=p)),me=me.next;while(me!==I);return J}(m,h);if(!b)return h;var M=uc(b,m);return Jc(M,M.next),Jc(b,b.next)}function $0(m,h){return Lo(m.prev,m,h.prev)<0&&Lo(h.next,m,m.next)<0}function lc(m,h,b,M,q){return(m=1431655765&((m=858993459&((m=252645135&((m=16711935&((m=(m-b)*q|0)|m<<8))|m<<4))|m<<2))|m<<1))|(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-M)*q|0)|h<<8))|h<<4))|h<<2))|h<<1))<<1}function ff(m){var h=m,b=m;do(h.x<b.x||h.x===b.x&&h.y<b.y)&&(b=h),h=h.next;while(h!==m);return b}function yA(m,h,b,M,q,K,J,me){return(q-J)*(h-me)>=(m-J)*(K-me)&&(m-J)*(M-me)>=(b-J)*(h-me)&&(b-J)*(K-me)>=(q-J)*(M-me)}function Tm(m,h){return m.next.i!==h.i&&m.prev.i!==h.i&&!function(b,M){var q=b;do{if(q.i!==b.i&&q.next.i!==b.i&&q.i!==M.i&&q.next.i!==M.i&&xp(q,q.next,b,M))return!0;q=q.next}while(q!==b);return!1}(m,h)&&(xl(m,h)&&xl(h,m)&&function(b,M){var q=b,K=!1,J=(b.x+M.x)/2,me=(b.y+M.y)/2;do q.y>me!=q.next.y>me&&q.next.y!==q.y&&J<(q.next.x-q.x)*(me-q.y)/(q.next.y-q.y)+q.x&&(K=!K),q=q.next;while(q!==b);return K}(m,h)&&(Lo(m.prev,m,h.prev)||Lo(m,h.prev,h))||df(m,h)&&Lo(m.prev,m,m.next)>0&&Lo(h.prev,h,h.next)>0)}function Lo(m,h,b){return(h.y-m.y)*(b.x-h.x)-(h.x-m.x)*(b.y-h.y)}function df(m,h){return m.x===h.x&&m.y===h.y}function xp(m,h,b,M){var q=mf(Lo(m,h,b)),K=mf(Lo(m,h,M)),J=mf(Lo(b,M,m)),me=mf(Lo(b,M,h));return q!==K&&J!==me||!(q!==0||!pf(m,b,h))||!(K!==0||!pf(m,M,h))||!(J!==0||!pf(b,m,M))||!(me!==0||!pf(b,h,M))}function pf(m,h,b){return h.x<=Math.max(m.x,b.x)&&h.x>=Math.min(m.x,b.x)&&h.y<=Math.max(m.y,b.y)&&h.y>=Math.min(m.y,b.y)}function mf(m){return m>0?1:m<0?-1:0}function xl(m,h){return Lo(m.prev,m,m.next)<0?Lo(m,h,m.next)>=0&&Lo(m,m.prev,h)>=0:Lo(m,h,m.prev)<0||Lo(m,m.next,h)<0}function uc(m,h){var b=new Da(m.i,m.x,m.y),M=new Da(h.i,h.x,h.y),q=m.next,K=h.prev;return m.next=h,h.prev=m,b.next=q,q.prev=b,M.next=b,b.prev=M,K.next=M,M.prev=K,M}function Qh(m,h,b,M){var q=new Da(m,h,b);return M?(q.next=M.next,q.prev=M,M.next.prev=q,M.next=q):(q.prev=q,q.next=q),q}function gf(m){m.next.prev=m.prev,m.prev.next=m.next,m.prevZ&&(m.prevZ.nextZ=m.nextZ),m.nextZ&&(m.nextZ.prevZ=m.prevZ)}function Da(m,h,b){this.i=m,this.x=h,this.y=b,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function cc(m,h,b,M){for(var q=0,K=h,J=b-M;K<b;K+=M)q+=(m[J]-m[K])*(m[K+1]+m[J+1]),J=K;return q}xh.exports=Ll,xh.exports.default=Ll,Ll.deviation=function(m,h,b,M){var q=h&&h.length,K=Math.abs(cc(m,0,q?h[0]*b:m.length,b));if(q)for(var J=0,me=h.length;J<me;J++)K-=Math.abs(cc(m,h[J]*b,J<me-1?h[J+1]*b:m.length,b));var Ce=0;for(J=0;J<M.length;J+=3){var Ne=M[J]*b,f=M[J+1]*b,u=M[J+2]*b;Ce+=Math.abs((m[Ne]-m[u])*(m[f+1]-m[Ne+1])-(m[Ne]-m[f])*(m[u+1]-m[Ne+1]))}return K===0&&Ce===0?0:Math.abs((Ce-K)/K)},Ll.flatten=function(m){for(var h=m[0][0].length,b={vertices:[],holes:[],dimensions:h},M=0,q=0;q<m.length;q++){for(var K=0;K<m[q].length;K++)for(var J=0;J<h;J++)b.vertices.push(m[q][K][J]);q>0&&b.holes.push(M+=m[q-1].length)}return b};var f0=G(xh.exports);function _f(m,h,b,M,q){yf(m,h,b||0,M||m.length-1,q||Wh)}function yf(m,h,b,M,q){for(;M>b;){if(M-b>600){var K=M-b+1,J=h-b+1,me=Math.log(K),Ce=.5*Math.exp(2*me/3),Ne=.5*Math.sqrt(me*Ce*(K-Ce)/K)*(J-K/2<0?-1:1);yf(m,h,Math.max(b,Math.floor(h-J*Ce/K+Ne)),Math.min(M,Math.floor(h+(K-J)*Ce/K+Ne)),q)}var f=m[h],u=b,p=M;for(Tc(m,b,h),q(m[M],f)>0&&Tc(m,b,M);u<p;){for(Tc(m,u,p),u++,p--;q(m[u],f)<0;)u++;for(;q(m[p],f)>0;)p--}q(m[b],f)===0?Tc(m,b,p):Tc(m,++p,M),p<=h&&(b=p+1),h<=p&&(M=p-1)}}function Tc(m,h,b){var M=m[h];m[h]=m[b],m[b]=M}function Wh(m,h){return m<h?-1:m>h?1:0}function wh(m,h){const b=m.length;if(b<=1)return[m];const M=[];let q,K;for(let J=0;J<b;J++){const me=pt(m[J]);me!==0&&(m[J].area=Math.abs(me),K===void 0&&(K=me<0),K===me<0?(q&&M.push(q),q=[m[J]]):q.push(m[J]))}if(q&&M.push(q),h>1)for(let J=0;J<M.length;J++)M[J].length<=h||(_f(M[J],h,1,M[J].length-1,vf),M[J]=M[J].slice(0,h));return M}function vf(m,h){return h.area-m.area}function vA(m,h,b){const M=b.patternDependencies;let q=!1;for(const K of h){const J=K.paint.get(`${m}-pattern`);J.isConstant()||(q=!0);const me=J.constantOr(null);me&&(q=!0,M[me.to]=!0,M[me.from]=!0)}return q}function xA(m,h,b,M,q){const K=q.patternDependencies;for(const J of h){const me=J.paint.get(`${m}-pattern`).value;if(me.kind!=="constant"){let Ce=me.evaluate({zoom:M-1},b,{},q.availableImages),Ne=me.evaluate({zoom:M},b,{},q.availableImages),f=me.evaluate({zoom:M+1},b,{},q.availableImages);Ce=Ce&&Ce.name?Ce.name:Ce,Ne=Ne&&Ne.name?Ne.name:Ne,f=f&&f.name?f.name:f,K[Ce]=!0,K[Ne]=!0,K[f]=!0,b.patterns[J.id]={min:Ce,mid:Ne,max:f}}}return b}class $h{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(b=>b.id),this.index=h.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Te,this.indexArray=new Xt,this.indexArray2=new ti,this.programConfigurations=new Uo(h.layers,h.zoom),this.segments=new Wi,this.segments2=new Wi,this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id)}populate(h,b,M){this.hasPattern=vA("fill",this.layers,b);const q=this.layers[0].layout.get("fill-sort-key"),K=!q.isConstant(),J=[];for(const{feature:me,id:Ce,index:Ne,sourceLayerIndex:f}of h){const u=this.layers[0]._featureFilter.needGeometry,p=vl(me,u);if(!this.layers[0]._featureFilter.filter(new ms(this.zoom),p,M))continue;const I=K?q.evaluate(p,{},M,b.availableImages):void 0,L={id:Ce,properties:me.properties,type:me.type,sourceLayerIndex:f,index:Ne,geometry:u?p.geometry:il(me),patterns:{},sortKey:I};J.push(L)}K&&J.sort((me,Ce)=>me.sortKey-Ce.sortKey);for(const me of J){const{geometry:Ce,index:Ne,sourceLayerIndex:f}=me;if(this.hasPattern){const u=xA("fill",this.layers,me,this.zoom,b);this.patternFeatures.push(u)}else this.addFeature(me,Ce,Ne,M,{});b.featureIndex.insert(h[Ne].feature,Ce,Ne,f,this.index)}}update(h,b,M){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,b,this.stateDependentLayers,M)}addFeatures(h,b,M){for(const q of this.patternFeatures)this.addFeature(q,q.geometry,q.index,b,M)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,hf),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.indexBuffer2=h.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(h,b,M,q,K){for(const J of wh(b,500)){let me=0;for(const I of J)me+=I.length;const Ce=this.segments.prepareSegment(me,this.layoutVertexArray,this.indexArray),Ne=Ce.vertexLength,f=[],u=[];for(const I of J){if(I.length===0)continue;I!==J[0]&&u.push(f.length/2);const L=this.segments2.prepareSegment(I.length,this.layoutVertexArray,this.indexArray2),U=L.vertexLength;this.layoutVertexArray.emplaceBack(I[0].x,I[0].y),this.indexArray2.emplaceBack(U+I.length-1,U),f.push(I[0].x),f.push(I[0].y);for(let Q=1;Q<I.length;Q++)this.layoutVertexArray.emplaceBack(I[Q].x,I[Q].y),this.indexArray2.emplaceBack(U+Q-1,U+Q),f.push(I[Q].x),f.push(I[Q].y);L.vertexLength+=I.length,L.primitiveLength+=I.length}const p=f0(f,u);for(let I=0;I<p.length;I+=3)this.indexArray.emplaceBack(Ne+p[I],Ne+p[I+1],Ne+p[I+2]);Ce.vertexLength+=me,Ce.primitiveLength+=p.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,M,K,q)}}let X0,bA;Sn("FillBucket",$h,{omit:["layers","patternFeatures"]});var Xh={get paint(){return bA=bA||new oa({"fill-antialias":new gn(ei.paint_fill["fill-antialias"]),"fill-opacity":new jn(ei.paint_fill["fill-opacity"]),"fill-color":new jn(ei.paint_fill["fill-color"]),"fill-outline-color":new jn(ei.paint_fill["fill-outline-color"]),"fill-translate":new gn(ei.paint_fill["fill-translate"]),"fill-translate-anchor":new gn(ei.paint_fill["fill-translate-anchor"]),"fill-pattern":new Jn(ei.paint_fill["fill-pattern"])})},get layout(){return X0=X0||new oa({"fill-sort-key":new jn(ei.layout_fill["fill-sort-key"])})}};class d0 extends vs{constructor(h){super(h,Xh)}recalculate(h,b){super.recalculate(h,b);const M=this.paint._values["fill-outline-color"];M.value.kind==="constant"&&M.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(h){return new $h(h)}queryRadius(){return of(this.paint.get("fill-translate"))}queryIntersectsFeature(h,b,M,q,K,J,me){return Pa(Xc(h,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),J.angle,me),q)}isTileClipped(){return!0}}const Y0=xs([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),bp=xs([{name:"a_centroid",components:2,type:"Int16"}],4),{members:wA}=Y0;var hc={},xf=W,K0=Sh;function Sh(m,h,b,M,q){this.properties={},this.extent=b,this.type=0,this._pbf=m,this._geometry=-1,this._keys=M,this._values=q,m.readFields(eh,this,h)}function eh(m,h,b){m==1?h.id=b.readVarint():m==2?function(M,q){for(var K=M.readVarint()+M.pos;M.pos<K;){var J=q._keys[M.readVarint()],me=q._values[M.readVarint()];q.properties[J]=me}}(b,h):m==3?h.type=b.readVarint():m==4&&(h._geometry=b.pos)}function wp(m){for(var h,b,M=0,q=0,K=m.length,J=K-1;q<K;J=q++)M+=((b=m[J]).x-(h=m[q]).x)*(h.y+b.y);return M}Sh.types=["Unknown","Point","LineString","Polygon"],Sh.prototype.loadGeometry=function(){var m=this._pbf;m.pos=this._geometry;for(var h,b=m.readVarint()+m.pos,M=1,q=0,K=0,J=0,me=[];m.pos<b;){if(q<=0){var Ce=m.readVarint();M=7&Ce,q=Ce>>3}if(q--,M===1||M===2)K+=m.readSVarint(),J+=m.readSVarint(),M===1&&(h&&me.push(h),h=[]),h.push(new xf(K,J));else{if(M!==7)throw new Error("unknown command "+M);h&&h.push(h[0].clone())}}return h&&me.push(h),me},Sh.prototype.bbox=function(){var m=this._pbf;m.pos=this._geometry;for(var h=m.readVarint()+m.pos,b=1,M=0,q=0,K=0,J=1/0,me=-1/0,Ce=1/0,Ne=-1/0;m.pos<h;){if(M<=0){var f=m.readVarint();b=7&f,M=f>>3}if(M--,b===1||b===2)(q+=m.readSVarint())<J&&(J=q),q>me&&(me=q),(K+=m.readSVarint())<Ce&&(Ce=K),K>Ne&&(Ne=K);else if(b!==7)throw new Error("unknown command "+b)}return[J,Ce,me,Ne]},Sh.prototype.toGeoJSON=function(m,h,b){var M,q,K=this.extent*Math.pow(2,b),J=this.extent*m,me=this.extent*h,Ce=this.loadGeometry(),Ne=Sh.types[this.type];function f(I){for(var L=0;L<I.length;L++){var U=I[L];I[L]=[360*(U.x+J)/K-180,360/Math.PI*Math.atan(Math.exp((180-360*(U.y+me)/K)*Math.PI/180))-90]}}switch(this.type){case 1:var u=[];for(M=0;M<Ce.length;M++)u[M]=Ce[M][0];f(Ce=u);break;case 2:for(M=0;M<Ce.length;M++)f(Ce[M]);break;case 3:for(Ce=function(I){var L=I.length;if(L<=1)return[I];for(var U,Q,re=[],Ae=0;Ae<L;Ae++){var _e=wp(I[Ae]);_e!==0&&(Q===void 0&&(Q=_e<0),Q===_e<0?(U&&re.push(U),U=[I[Ae]]):U.push(I[Ae]))}return U&&re.push(U),re}(Ce),M=0;M<Ce.length;M++)for(q=0;q<Ce[M].length;q++)f(Ce[M][q])}Ce.length===1?Ce=Ce[0]:Ne="Multi"+Ne;var p={type:"Feature",geometry:{type:Ne,coordinates:Ce},properties:this.properties};return"id"in this&&(p.id=this.id),p};var Sp=K0,Ip=J0;function J0(m,h){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=m,this._keys=[],this._values=[],this._features=[],m.readFields(Ih,this,h),this.length=this._features.length}function Ih(m,h,b){m===15?h.version=b.readVarint():m===1?h.name=b.readString():m===5?h.extent=b.readVarint():m===2?h._features.push(b.pos):m===3?h._keys.push(b.readString()):m===4&&h._values.push(function(M){for(var q=null,K=M.readVarint()+M.pos;M.pos<K;){var J=M.readVarint()>>3;q=J===1?M.readString():J===2?M.readFloat():J===3?M.readDouble():J===4?M.readVarint64():J===5?M.readVarint():J===6?M.readSVarint():J===7?M.readBoolean():null}return q}(b))}J0.prototype.feature=function(m){if(m<0||m>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[m];var h=this._pbf.readVarint()+this._pbf.pos;return new Sp(this._pbf,h,this.extent,this._keys,this._values)};var km=Ip;function kc(m,h,b){if(m===3){var M=new km(b,b.readVarint()+b.pos);M.length&&(h[M.name]=M)}}hc.VectorTile=function(m,h){this.layers=m.readFields(kc,{},h)},hc.VectorTileFeature=K0,hc.VectorTileLayer=Ip;const Eh=hc.VectorTileFeature.types,bf=Math.pow(2,13);function Yh(m,h,b,M,q,K,J,me){m.emplaceBack(h,b,2*Math.floor(M*bf)+J,q*bf*2,K*bf*2,Math.round(me))}class SA{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(b=>b.id),this.index=h.index,this.hasPattern=!1,this.layoutVertexArray=new Re,this.centroidVertexArray=new ce,this.indexArray=new Xt,this.programConfigurations=new Uo(h.layers,h.zoom),this.segments=new Wi,this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id)}populate(h,b,M){this.features=[],this.hasPattern=vA("fill-extrusion",this.layers,b);for(const{feature:q,id:K,index:J,sourceLayerIndex:me}of h){const Ce=this.layers[0]._featureFilter.needGeometry,Ne=vl(q,Ce);if(!this.layers[0]._featureFilter.filter(new ms(this.zoom),Ne,M))continue;const f={id:K,sourceLayerIndex:me,index:J,geometry:Ce?Ne.geometry:il(q),properties:q.properties,type:q.type,patterns:{}};this.hasPattern?this.features.push(xA("fill-extrusion",this.layers,f,this.zoom,b)):this.addFeature(f,f.geometry,J,M,{}),b.featureIndex.insert(q,f.geometry,J,me,this.index,!0)}}addFeatures(h,b,M){for(const q of this.features){const{geometry:K}=q;this.addFeature(q,K,q.index,b,M)}}update(h,b,M){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,b,this.stateDependentLayers,M)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,wA),this.centroidVertexBuffer=h.createVertexBuffer(this.centroidVertexArray,bp.members,!0),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(h,b,M,q,K){const J={x:0,y:0,vertexCount:0};for(const me of wh(b,500)){let Ce=0;for(const L of me)Ce+=L.length;let Ne=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const L of me){if(L.length===0||Cr(L))continue;let U=0;for(let Q=0;Q<L.length;Q++){const re=L[Q];if(Q>=1){const Ae=L[Q-1];if(!Kh(re,Ae)){Ne.vertexLength+4>Wi.MAX_VERTEX_ARRAY_LENGTH&&(Ne=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const _e=re.sub(Ae)._perp()._unit(),Le=Ae.dist(re);U+Le>32768&&(U=0),Yh(this.layoutVertexArray,re.x,re.y,_e.x,_e.y,0,0,U),Yh(this.layoutVertexArray,re.x,re.y,_e.x,_e.y,0,1,U),J.x+=2*re.x,J.y+=2*re.y,J.vertexCount+=2,U+=Le,Yh(this.layoutVertexArray,Ae.x,Ae.y,_e.x,_e.y,0,0,U),Yh(this.layoutVertexArray,Ae.x,Ae.y,_e.x,_e.y,0,1,U),J.x+=2*Ae.x,J.y+=2*Ae.y,J.vertexCount+=2;const qe=Ne.vertexLength;this.indexArray.emplaceBack(qe,qe+2,qe+1),this.indexArray.emplaceBack(qe+1,qe+2,qe+3),Ne.vertexLength+=4,Ne.primitiveLength+=2}}}}if(Ne.vertexLength+Ce>Wi.MAX_VERTEX_ARRAY_LENGTH&&(Ne=this.segments.prepareSegment(Ce,this.layoutVertexArray,this.indexArray)),Eh[h.type]!=="Polygon")continue;const f=[],u=[],p=Ne.vertexLength;for(const L of me)if(L.length!==0){L!==me[0]&&u.push(f.length/2);for(let U=0;U<L.length;U++){const Q=L[U];Yh(this.layoutVertexArray,Q.x,Q.y,0,0,1,1,0),J.x+=Q.x,J.y+=Q.y,J.vertexCount+=1,f.push(Q.x),f.push(Q.y)}}const I=f0(f,u);for(let L=0;L<I.length;L+=3)this.indexArray.emplaceBack(p+I[L],p+I[L+2],p+I[L+1]);Ne.primitiveLength+=I.length/3,Ne.vertexLength+=Ce}for(let me=0;me<J.vertexCount;me++)this.centroidVertexArray.emplaceBack(Math.floor(J.x/J.vertexCount),Math.floor(J.y/J.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,M,K,q)}}function Kh(m,h){return m.x===h.x&&(m.x<0||m.x>$s)||m.y===h.y&&(m.y<0||m.y>$s)}function Cr(m){return m.every(h=>h.x<0)||m.every(h=>h.x>$s)||m.every(h=>h.y<0)||m.every(h=>h.y>$s)}let wf;Sn("FillExtrusionBucket",SA,{omit:["layers","features"]});var ed={get paint(){return wf=wf||new oa({"fill-extrusion-opacity":new gn(ei["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new jn(ei["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new gn(ei["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new gn(ei["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Jn(ei["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new jn(ei["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new jn(ei["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new gn(ei["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Jh extends vs{constructor(h){super(h,ed)}createBucket(h){return new SA(h)}queryRadius(){return of(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(h,b,M,q,K,J,me,Ce){const Ne=Xc(h,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),J.angle,me),f=this.paint.get("fill-extrusion-height").evaluate(b,M),u=this.paint.get("fill-extrusion-base").evaluate(b,M),p=function(L,U,Q,re){const Ae=[];for(const _e of L){const Le=[_e.x,_e.y,0,1];uf(Le,Le,U),Ae.push(new ae(Le[0]/Le[3],Le[1]/Le[3]))}return Ae}(Ne,Ce),I=function(L,U,Q,re){const Ae=[],_e=[],Le=re[8]*U,qe=re[9]*U,et=re[10]*U,At=re[11]*U,gt=re[8]*Q,Dt=re[9]*Q,Lt=re[10]*Q,Rt=re[11]*Q;for(const Kt of L){const Ht=[],Qt=[];for(const ui of Kt){const yi=ui.x,Yi=ui.y,wn=re[0]*yi+re[4]*Yi+re[12],un=re[1]*yi+re[5]*Yi+re[13],on=re[2]*yi+re[6]*Yi+re[14],dn=re[3]*yi+re[7]*Yi+re[15],Rn=on+et,an=dn+At,Xi=wn+gt,Ln=un+Dt,Nn=on+Lt,pr=dn+Rt,Vr=new ae((wn+Le)/an,(un+qe)/an);Vr.z=Rn/an,Ht.push(Vr);const Hr=new ae(Xi/pr,Ln/pr);Hr.z=Nn/pr,Qt.push(Hr)}Ae.push(Ht),_e.push(Qt)}return[Ae,_e]}(q,u,f,Ce);return function(L,U,Q){let re=1/0;Pa(Q,U)&&(re=IA(Q,U[0]));for(let Ae=0;Ae<U.length;Ae++){const _e=U[Ae],Le=L[Ae];for(let qe=0;qe<_e.length-1;qe++){const et=_e[qe],At=[et,_e[qe+1],Le[qe+1],Le[qe],et];af(Q,At)&&(re=Math.min(re,IA(Q,At)))}}return re!==1/0&&re}(I[0],I[1],p)}}function Sf(m,h){return m.x*h.x+m.y*h.y}function IA(m,h){if(m.length===1){let b=0;const M=h[b++];let q;for(;!q||M.equals(q);)if(q=h[b++],!q)return 1/0;for(;b<h.length;b++){const K=h[b],J=m[0],me=q.sub(M),Ce=K.sub(M),Ne=J.sub(M),f=Sf(me,me),u=Sf(me,Ce),p=Sf(Ce,Ce),I=Sf(Ne,me),L=Sf(Ne,Ce),U=f*p-u*u,Q=(p*I-u*L)/U,re=(f*L-u*I)/U,Ae=M.z*(1-Q-re)+q.z*Q+K.z*re;if(isFinite(Ae))return Ae}return 1/0}{let b=1/0;for(const M of h)b=Math.min(b,M.z);return b}}const EA=xs([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Ul}=EA,Mm=xs([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Pm}=Mm,td=hc.VectorTileFeature.types,Dm=Math.cos(Math.PI/180*37.5),id=Math.pow(2,14)/.5;class eA{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(b=>b.id),this.index=h.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(b=>{this.gradients[b.id]={}}),this.layoutVertexArray=new Be,this.layoutVertexArray2=new Ke,this.indexArray=new Xt,this.programConfigurations=new Uo(h.layers,h.zoom),this.segments=new Wi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id)}populate(h,b,M){this.hasPattern=vA("line",this.layers,b);const q=this.layers[0].layout.get("line-sort-key"),K=!q.isConstant(),J=[];for(const{feature:me,id:Ce,index:Ne,sourceLayerIndex:f}of h){const u=this.layers[0]._featureFilter.needGeometry,p=vl(me,u);if(!this.layers[0]._featureFilter.filter(new ms(this.zoom),p,M))continue;const I=K?q.evaluate(p,{},M):void 0,L={id:Ce,properties:me.properties,type:me.type,sourceLayerIndex:f,index:Ne,geometry:u?p.geometry:il(me),patterns:{},sortKey:I};J.push(L)}K&&J.sort((me,Ce)=>me.sortKey-Ce.sortKey);for(const me of J){const{geometry:Ce,index:Ne,sourceLayerIndex:f}=me;if(this.hasPattern){const u=xA("line",this.layers,me,this.zoom,b);this.patternFeatures.push(u)}else this.addFeature(me,Ce,Ne,M,{});b.featureIndex.insert(h[Ne].feature,Ce,Ne,f,this.index)}}update(h,b,M){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,b,this.stateDependentLayers,M)}addFeatures(h,b,M){for(const q of this.patternFeatures)this.addFeature(q,q.geometry,q.index,b,M)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=h.createVertexBuffer(this.layoutVertexArray2,Pm)),this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,Ul),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(h){if(h.properties&&Object.prototype.hasOwnProperty.call(h.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(h.properties,"mapbox_clip_end"))return{start:+h.properties.mapbox_clip_start,end:+h.properties.mapbox_clip_end}}addFeature(h,b,M,q,K){const J=this.layers[0].layout,me=J.get("line-join").evaluate(h,{}),Ce=J.get("line-cap"),Ne=J.get("line-miter-limit"),f=J.get("line-round-limit");this.lineClips=this.lineFeatureClips(h);for(const u of b)this.addLine(u,h,me,Ce,Ne,f);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,M,K,q)}addLine(h,b,M,q,K,J){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let re=0;re<h.length-1;re++)this.totalDistance+=h[re].dist(h[re+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const me=td[b.type]==="Polygon";let Ce=h.length;for(;Ce>=2&&h[Ce-1].equals(h[Ce-2]);)Ce--;let Ne=0;for(;Ne<Ce-1&&h[Ne].equals(h[Ne+1]);)Ne++;if(Ce<(me?3:2))return;M==="bevel"&&(K=1.05);const f=this.overscaling<=16?15*$s/(512*this.overscaling):0,u=this.segments.prepareSegment(10*Ce,this.layoutVertexArray,this.indexArray);let p,I,L,U,Q;this.e1=this.e2=-1,me&&(p=h[Ce-2],Q=h[Ne].sub(p)._unit()._perp());for(let re=Ne;re<Ce;re++){if(L=re===Ce-1?me?h[Ne+1]:void 0:h[re+1],L&&h[re].equals(L))continue;Q&&(U=Q),p&&(I=p),p=h[re],Q=L?L.sub(p)._unit()._perp():U,U=U||Q;let Ae=U.add(Q);Ae.x===0&&Ae.y===0||Ae._unit();const _e=U.x*Q.x+U.y*Q.y,Le=Ae.x*Q.x+Ae.y*Q.y,qe=Le!==0?1/Le:1/0,et=2*Math.sqrt(2-2*Le),At=Le<Dm&&I&&L,gt=U.x*Q.y-U.y*Q.x>0;if(At&&re>Ne){const Rt=p.dist(I);if(Rt>2*f){const Kt=p.sub(p.sub(I)._mult(f/Rt)._round());this.updateDistance(I,Kt),this.addCurrentVertex(Kt,U,0,0,u),I=Kt}}const Dt=I&&L;let Lt=Dt?M:me?"butt":q;if(Dt&&Lt==="round"&&(qe<J?Lt="miter":qe<=2&&(Lt="fakeround")),Lt==="miter"&&qe>K&&(Lt="bevel"),Lt==="bevel"&&(qe>2&&(Lt="flipbevel"),qe<K&&(Lt="miter")),I&&this.updateDistance(I,p),Lt==="miter")Ae._mult(qe),this.addCurrentVertex(p,Ae,0,0,u);else if(Lt==="flipbevel"){if(qe>100)Ae=Q.mult(-1);else{const Rt=qe*U.add(Q).mag()/U.sub(Q).mag();Ae._perp()._mult(Rt*(gt?-1:1))}this.addCurrentVertex(p,Ae,0,0,u),this.addCurrentVertex(p,Ae.mult(-1),0,0,u)}else if(Lt==="bevel"||Lt==="fakeround"){const Rt=-Math.sqrt(qe*qe-1),Kt=gt?Rt:0,Ht=gt?0:Rt;if(I&&this.addCurrentVertex(p,U,Kt,Ht,u),Lt==="fakeround"){const Qt=Math.round(180*et/Math.PI/20);for(let ui=1;ui<Qt;ui++){let yi=ui/Qt;if(yi!==.5){const wn=yi-.5;yi+=yi*wn*(yi-1)*((1.0904+_e*(_e*(3.55645-1.43519*_e)-3.2452))*wn*wn+(.848013+_e*(.215638*_e-1.06021)))}const Yi=Q.sub(U)._mult(yi)._add(U)._unit()._mult(gt?-1:1);this.addHalfVertex(p,Yi.x,Yi.y,!1,gt,0,u)}}L&&this.addCurrentVertex(p,Q,-Kt,-Ht,u)}else if(Lt==="butt")this.addCurrentVertex(p,Ae,0,0,u);else if(Lt==="square"){const Rt=I?1:-1;this.addCurrentVertex(p,Ae,Rt,Rt,u)}else Lt==="round"&&(I&&(this.addCurrentVertex(p,U,0,0,u),this.addCurrentVertex(p,U,1,1,u,!0)),L&&(this.addCurrentVertex(p,Q,-1,-1,u,!0),this.addCurrentVertex(p,Q,0,0,u)));if(At&&re<Ce-1){const Rt=p.dist(L);if(Rt>2*f){const Kt=p.add(L.sub(p)._mult(f/Rt)._round());this.updateDistance(p,Kt),this.addCurrentVertex(Kt,Q,0,0,u),p=Kt}}}}addCurrentVertex(h,b,M,q,K,J=!1){const me=b.y*q-b.x,Ce=-b.y-b.x*q;this.addHalfVertex(h,b.x+b.y*M,b.y-b.x*M,J,!1,M,K),this.addHalfVertex(h,me,Ce,J,!0,-q,K),this.distance>id/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(h,b,M,q,K,J))}addHalfVertex({x:h,y:b},M,q,K,J,me,Ce){const Ne=.5*(this.lineClips?this.scaledDistance*(id-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((h<<1)+(K?1:0),(b<<1)+(J?1:0),Math.round(63*M)+128,Math.round(63*q)+128,1+(me===0?0:me<0?-1:1)|(63&Ne)<<2,Ne>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const f=Ce.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,f),Ce.primitiveLength++),J?this.e2=f:this.e1=f}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(h,b){this.distance+=h.dist(b),this.updateScaledDistance()}}let nd,Ep;Sn("LineBucket",eA,{omit:["layers","patternFeatures"]});var Mc={get paint(){return Ep=Ep||new oa({"line-opacity":new jn(ei.paint_line["line-opacity"]),"line-color":new jn(ei.paint_line["line-color"]),"line-translate":new gn(ei.paint_line["line-translate"]),"line-translate-anchor":new gn(ei.paint_line["line-translate-anchor"]),"line-width":new jn(ei.paint_line["line-width"]),"line-gap-width":new jn(ei.paint_line["line-gap-width"]),"line-offset":new jn(ei.paint_line["line-offset"]),"line-blur":new jn(ei.paint_line["line-blur"]),"line-dasharray":new tl(ei.paint_line["line-dasharray"]),"line-pattern":new Jn(ei.paint_line["line-pattern"]),"line-gradient":new Tu(ei.paint_line["line-gradient"])})},get layout(){return nd=nd||new oa({"line-cap":new gn(ei.layout_line["line-cap"]),"line-join":new jn(ei.layout_line["line-join"]),"line-miter-limit":new gn(ei.layout_line["line-miter-limit"]),"line-round-limit":new gn(ei.layout_line["line-round-limit"]),"line-sort-key":new jn(ei.layout_line["line-sort-key"])})}};class bu extends jn{possiblyEvaluate(h,b){return b=new ms(Math.floor(b.zoom),{now:b.now,fadeDuration:b.fadeDuration,zoomHistory:b.zoomHistory,transition:b.transition}),super.possiblyEvaluate(h,b)}evaluate(h,b,M,q){return b=jt({},b,{zoom:Math.floor(b.zoom)}),super.evaluate(h,b,M,q)}}let CA;class Lm extends vs{constructor(h){super(h,Mc),this.gradientVersion=0,CA||(CA=new bu(Mc.paint.properties["line-width"].specification),CA.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(h){if(h==="line-gradient"){const b=this.gradientExpression();this.stepInterpolant=!!function(M){return M._styleExpression!==void 0}(b)&&b._styleExpression.expression instanceof ja,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(h,b){super.recalculate(h,b),this.paint._values["line-floorwidth"]=CA.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,h)}createBucket(h){return new eA(h)}queryRadius(h){const b=h,M=p0(qh("line-width",this,b),qh("line-gap-width",this,b)),q=qh("line-offset",this,b);return M/2+Math.abs(q)+of(this.paint.get("line-translate"))}queryIntersectsFeature(h,b,M,q,K,J,me){const Ce=Xc(h,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),J.angle,me),Ne=me/2*p0(this.paint.get("line-width").evaluate(b,M),this.paint.get("line-gap-width").evaluate(b,M)),f=this.paint.get("line-offset").evaluate(b,M);return f&&(q=function(u,p){const I=[];for(let L=0;L<u.length;L++){const U=u[L],Q=[];for(let re=0;re<U.length;re++){const Ae=U[re-1],_e=U[re],Le=U[re+1],qe=re===0?new ae(0,0):_e.sub(Ae)._unit()._perp(),et=re===U.length-1?new ae(0,0):Le.sub(_e)._unit()._perp(),At=qe._add(et)._unit(),gt=At.x*et.x+At.y*et.y;gt!==0&&At._mult(1/gt),Q.push(At._mult(p)._add(_e))}I.push(Q)}return I}(q,f*me)),function(u,p,I){for(let L=0;L<p.length;L++){const U=p[L];if(u.length>=3){for(let Q=0;Q<U.length;Q++)if($c(u,U[Q]))return!0}if(pA(u,U,I))return!0}return!1}(Ce,q,Ne)}isTileClipped(){return!0}}function p0(m,h){return h>0?h+2*m:m}const Cp=xs([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),rd=xs([{name:"a_projected_pos",components:3,type:"Float32"}],4);xs([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const TA=xs([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);xs([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const m0=xs([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),sd=xs([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Bm(m,h,b){return m.sections.forEach(M=>{M.text=function(q,K,J){const me=K.layout.get("text-transform").evaluate(J,{});return me==="uppercase"?q=q.toLocaleUpperCase():me==="lowercase"&&(q=q.toLocaleLowerCase()),$l.applyArabicShaping&&(q=$l.applyArabicShaping(q)),q}(M.text,h,b)}),m}xs([{name:"triangle",components:3,type:"Uint16"}]),xs([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),xs([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),xs([{type:"Float32",name:"offsetX"}]),xs([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),xs([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Ch={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Al=24,ad=fa,od=function(m,h,b,M,q){var K,J,me=8*q-M-1,Ce=(1<<me)-1,Ne=Ce>>1,f=-7,u=b?q-1:0,p=b?-1:1,I=m[h+u];for(u+=p,K=I&(1<<-f)-1,I>>=-f,f+=me;f>0;K=256*K+m[h+u],u+=p,f-=8);for(J=K&(1<<-f)-1,K>>=-f,f+=M;f>0;J=256*J+m[h+u],u+=p,f-=8);if(K===0)K=1-Ne;else{if(K===Ce)return J?NaN:1/0*(I?-1:1);J+=Math.pow(2,M),K-=Ne}return(I?-1:1)*J*Math.pow(2,K-M)},ld=function(m,h,b,M,q,K){var J,me,Ce,Ne=8*K-q-1,f=(1<<Ne)-1,u=f>>1,p=q===23?Math.pow(2,-24)-Math.pow(2,-77):0,I=M?0:K-1,L=M?1:-1,U=h<0||h===0&&1/h<0?1:0;for(h=Math.abs(h),isNaN(h)||h===1/0?(me=isNaN(h)?1:0,J=f):(J=Math.floor(Math.log(h)/Math.LN2),h*(Ce=Math.pow(2,-J))<1&&(J--,Ce*=2),(h+=J+u>=1?p/Ce:p*Math.pow(2,1-u))*Ce>=2&&(J++,Ce/=2),J+u>=f?(me=0,J=f):J+u>=1?(me=(h*Ce-1)*Math.pow(2,q),J+=u):(me=h*Math.pow(2,u-1)*Math.pow(2,q),J=0));q>=8;m[b+I]=255&me,I+=L,me/=256,q-=8);for(J=J<<q|me,Ne+=q;Ne>0;m[b+I]=255&J,I+=L,J/=256,Ne-=8);m[b+I-L]|=128*U};function fa(m){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(m)?m:new Uint8Array(m||0),this.pos=0,this.type=0,this.length=this.buf.length}fa.Varint=0,fa.Fixed64=1,fa.Bytes=2,fa.Fixed32=5;var kA=4294967296,ud=1/kA,MA=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function wu(m){return m.type===fa.Bytes?m.readVarint()+m.pos:m.pos+1}function Ka(m,h,b){return b?4294967296*h+(m>>>0):4294967296*(h>>>0)+(m>>>0)}function g0(m,h,b){var M=h<=16383?1:h<=2097151?2:h<=268435455?3:Math.floor(Math.log(h)/(7*Math.LN2));b.realloc(M);for(var q=b.pos-1;q>=m;q--)b.buf[q+M]=b.buf[q]}function If(m,h){for(var b=0;b<m.length;b++)h.writeVarint(m[b])}function cd(m,h){for(var b=0;b<m.length;b++)h.writeSVarint(m[b])}function ys(m,h){for(var b=0;b<m.length;b++)h.writeFloat(m[b])}function th(m,h){for(var b=0;b<m.length;b++)h.writeDouble(m[b])}function Tp(m,h){for(var b=0;b<m.length;b++)h.writeBoolean(m[b])}function hd(m,h){for(var b=0;b<m.length;b++)h.writeFixed32(m[b])}function ih(m,h){for(var b=0;b<m.length;b++)h.writeSFixed32(m[b])}function PA(m,h){for(var b=0;b<m.length;b++)h.writeFixed64(m[b])}function kp(m,h){for(var b=0;b<m.length;b++)h.writeSFixed64(m[b])}function _0(m,h){return(m[h]|m[h+1]<<8|m[h+2]<<16)+16777216*m[h+3]}function DA(m,h,b){m[b]=h,m[b+1]=h>>>8,m[b+2]=h>>>16,m[b+3]=h>>>24}function Mp(m,h){return(m[h]|m[h+1]<<8|m[h+2]<<16)+(m[h+3]<<24)}fa.prototype={destroy:function(){this.buf=null},readFields:function(m,h,b){for(b=b||this.length;this.pos<b;){var M=this.readVarint(),q=M>>3,K=this.pos;this.type=7&M,m(q,h,this),this.pos===K&&this.skip(M)}return h},readMessage:function(m,h){return this.readFields(m,h,this.readVarint()+this.pos)},readFixed32:function(){var m=_0(this.buf,this.pos);return this.pos+=4,m},readSFixed32:function(){var m=Mp(this.buf,this.pos);return this.pos+=4,m},readFixed64:function(){var m=_0(this.buf,this.pos)+_0(this.buf,this.pos+4)*kA;return this.pos+=8,m},readSFixed64:function(){var m=_0(this.buf,this.pos)+Mp(this.buf,this.pos+4)*kA;return this.pos+=8,m},readFloat:function(){var m=od(this.buf,this.pos,!0,23,4);return this.pos+=4,m},readDouble:function(){var m=od(this.buf,this.pos,!0,52,8);return this.pos+=8,m},readVarint:function(m){var h,b,M=this.buf;return h=127&(b=M[this.pos++]),b<128?h:(h|=(127&(b=M[this.pos++]))<<7,b<128?h:(h|=(127&(b=M[this.pos++]))<<14,b<128?h:(h|=(127&(b=M[this.pos++]))<<21,b<128?h:function(q,K,J){var me,Ce,Ne=J.buf;if(me=(112&(Ce=Ne[J.pos++]))>>4,Ce<128||(me|=(127&(Ce=Ne[J.pos++]))<<3,Ce<128)||(me|=(127&(Ce=Ne[J.pos++]))<<10,Ce<128)||(me|=(127&(Ce=Ne[J.pos++]))<<17,Ce<128)||(me|=(127&(Ce=Ne[J.pos++]))<<24,Ce<128)||(me|=(1&(Ce=Ne[J.pos++]))<<31,Ce<128))return Ka(q,me,K);throw new Error("Expected varint not more than 10 bytes")}(h|=(15&(b=M[this.pos]))<<28,m,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var m=this.readVarint();return m%2==1?(m+1)/-2:m/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var m=this.readVarint()+this.pos,h=this.pos;return this.pos=m,m-h>=12&&MA?function(b,M,q){return MA.decode(b.subarray(M,q))}(this.buf,h,m):function(b,M,q){for(var K="",J=M;J<q;){var me,Ce,Ne,f=b[J],u=null,p=f>239?4:f>223?3:f>191?2:1;if(J+p>q)break;p===1?f<128&&(u=f):p===2?(192&(me=b[J+1]))==128&&(u=(31&f)<<6|63&me)<=127&&(u=null):p===3?(Ce=b[J+2],(192&(me=b[J+1]))==128&&(192&Ce)==128&&((u=(15&f)<<12|(63&me)<<6|63&Ce)<=2047||u>=55296&&u<=57343)&&(u=null)):p===4&&(Ce=b[J+2],Ne=b[J+3],(192&(me=b[J+1]))==128&&(192&Ce)==128&&(192&Ne)==128&&((u=(15&f)<<18|(63&me)<<12|(63&Ce)<<6|63&Ne)<=65535||u>=1114112)&&(u=null)),u===null?(u=65533,p=1):u>65535&&(u-=65536,K+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),K+=String.fromCharCode(u),J+=p}return K}(this.buf,h,m)},readBytes:function(){var m=this.readVarint()+this.pos,h=this.buf.subarray(this.pos,m);return this.pos=m,h},readPackedVarint:function(m,h){if(this.type!==fa.Bytes)return m.push(this.readVarint(h));var b=wu(this);for(m=m||[];this.pos<b;)m.push(this.readVarint(h));return m},readPackedSVarint:function(m){if(this.type!==fa.Bytes)return m.push(this.readSVarint());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readSVarint());return m},readPackedBoolean:function(m){if(this.type!==fa.Bytes)return m.push(this.readBoolean());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readBoolean());return m},readPackedFloat:function(m){if(this.type!==fa.Bytes)return m.push(this.readFloat());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readFloat());return m},readPackedDouble:function(m){if(this.type!==fa.Bytes)return m.push(this.readDouble());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readDouble());return m},readPackedFixed32:function(m){if(this.type!==fa.Bytes)return m.push(this.readFixed32());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readFixed32());return m},readPackedSFixed32:function(m){if(this.type!==fa.Bytes)return m.push(this.readSFixed32());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readSFixed32());return m},readPackedFixed64:function(m){if(this.type!==fa.Bytes)return m.push(this.readFixed64());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readFixed64());return m},readPackedSFixed64:function(m){if(this.type!==fa.Bytes)return m.push(this.readSFixed64());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readSFixed64());return m},skip:function(m){var h=7&m;if(h===fa.Varint)for(;this.buf[this.pos++]>127;);else if(h===fa.Bytes)this.pos=this.readVarint()+this.pos;else if(h===fa.Fixed32)this.pos+=4;else{if(h!==fa.Fixed64)throw new Error("Unimplemented type: "+h);this.pos+=8}},writeTag:function(m,h){this.writeVarint(m<<3|h)},realloc:function(m){for(var h=this.length||16;h<this.pos+m;)h*=2;if(h!==this.length){var b=new Uint8Array(h);b.set(this.buf),this.buf=b,this.length=h}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(m){this.realloc(4),DA(this.buf,m,this.pos),this.pos+=4},writeSFixed32:function(m){this.realloc(4),DA(this.buf,m,this.pos),this.pos+=4},writeFixed64:function(m){this.realloc(8),DA(this.buf,-1&m,this.pos),DA(this.buf,Math.floor(m*ud),this.pos+4),this.pos+=8},writeSFixed64:function(m){this.realloc(8),DA(this.buf,-1&m,this.pos),DA(this.buf,Math.floor(m*ud),this.pos+4),this.pos+=8},writeVarint:function(m){(m=+m||0)>268435455||m<0?function(h,b){var M,q;if(h>=0?(M=h%4294967296|0,q=h/4294967296|0):(q=~(-h/4294967296),4294967295^(M=~(-h%4294967296))?M=M+1|0:(M=0,q=q+1|0)),h>=18446744073709552e3||h<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");b.realloc(10),function(K,J,me){me.buf[me.pos++]=127&K|128,K>>>=7,me.buf[me.pos++]=127&K|128,K>>>=7,me.buf[me.pos++]=127&K|128,K>>>=7,me.buf[me.pos++]=127&K|128,me.buf[me.pos]=127&(K>>>=7)}(M,0,b),function(K,J){var me=(7&K)<<4;J.buf[J.pos++]|=me|((K>>>=3)?128:0),K&&(J.buf[J.pos++]=127&K|((K>>>=7)?128:0),K&&(J.buf[J.pos++]=127&K|((K>>>=7)?128:0),K&&(J.buf[J.pos++]=127&K|((K>>>=7)?128:0),K&&(J.buf[J.pos++]=127&K|((K>>>=7)?128:0),K&&(J.buf[J.pos++]=127&K)))))}(q,b)}(m,this):(this.realloc(4),this.buf[this.pos++]=127&m|(m>127?128:0),m<=127||(this.buf[this.pos++]=127&(m>>>=7)|(m>127?128:0),m<=127||(this.buf[this.pos++]=127&(m>>>=7)|(m>127?128:0),m<=127||(this.buf[this.pos++]=m>>>7&127))))},writeSVarint:function(m){this.writeVarint(m<0?2*-m-1:2*m)},writeBoolean:function(m){this.writeVarint(!!m)},writeString:function(m){m=String(m),this.realloc(4*m.length),this.pos++;var h=this.pos;this.pos=function(M,q,K){for(var J,me,Ce=0;Ce<q.length;Ce++){if((J=q.charCodeAt(Ce))>55295&&J<57344){if(!me){J>56319||Ce+1===q.length?(M[K++]=239,M[K++]=191,M[K++]=189):me=J;continue}if(J<56320){M[K++]=239,M[K++]=191,M[K++]=189,me=J;continue}J=me-55296<<10|J-56320|65536,me=null}else me&&(M[K++]=239,M[K++]=191,M[K++]=189,me=null);J<128?M[K++]=J:(J<2048?M[K++]=J>>6|192:(J<65536?M[K++]=J>>12|224:(M[K++]=J>>18|240,M[K++]=J>>12&63|128),M[K++]=J>>6&63|128),M[K++]=63&J|128)}return K}(this.buf,m,this.pos);var b=this.pos-h;b>=128&&g0(h,b,this),this.pos=h-1,this.writeVarint(b),this.pos+=b},writeFloat:function(m){this.realloc(4),ld(this.buf,m,this.pos,!0,23,4),this.pos+=4},writeDouble:function(m){this.realloc(8),ld(this.buf,m,this.pos,!0,52,8),this.pos+=8},writeBytes:function(m){var h=m.length;this.writeVarint(h),this.realloc(h);for(var b=0;b<h;b++)this.buf[this.pos++]=m[b]},writeRawMessage:function(m,h){this.pos++;var b=this.pos;m(h,this);var M=this.pos-b;M>=128&&g0(b,M,this),this.pos=b-1,this.writeVarint(M),this.pos+=M},writeMessage:function(m,h,b){this.writeTag(m,fa.Bytes),this.writeRawMessage(h,b)},writePackedVarint:function(m,h){h.length&&this.writeMessage(m,If,h)},writePackedSVarint:function(m,h){h.length&&this.writeMessage(m,cd,h)},writePackedBoolean:function(m,h){h.length&&this.writeMessage(m,Tp,h)},writePackedFloat:function(m,h){h.length&&this.writeMessage(m,ys,h)},writePackedDouble:function(m,h){h.length&&this.writeMessage(m,th,h)},writePackedFixed32:function(m,h){h.length&&this.writeMessage(m,hd,h)},writePackedSFixed32:function(m,h){h.length&&this.writeMessage(m,ih,h)},writePackedFixed64:function(m,h){h.length&&this.writeMessage(m,PA,h)},writePackedSFixed64:function(m,h){h.length&&this.writeMessage(m,kp,h)},writeBytesField:function(m,h){this.writeTag(m,fa.Bytes),this.writeBytes(h)},writeFixed32Field:function(m,h){this.writeTag(m,fa.Fixed32),this.writeFixed32(h)},writeSFixed32Field:function(m,h){this.writeTag(m,fa.Fixed32),this.writeSFixed32(h)},writeFixed64Field:function(m,h){this.writeTag(m,fa.Fixed64),this.writeFixed64(h)},writeSFixed64Field:function(m,h){this.writeTag(m,fa.Fixed64),this.writeSFixed64(h)},writeVarintField:function(m,h){this.writeTag(m,fa.Varint),this.writeVarint(h)},writeSVarintField:function(m,h){this.writeTag(m,fa.Varint),this.writeSVarint(h)},writeStringField:function(m,h){this.writeTag(m,fa.Bytes),this.writeString(h)},writeFloatField:function(m,h){this.writeTag(m,fa.Fixed32),this.writeFloat(h)},writeDoubleField:function(m,h){this.writeTag(m,fa.Fixed64),this.writeDouble(h)},writeBooleanField:function(m,h){this.writeVarintField(m,!!h)}};var Ad=G(ad);const fd=3;function zm(m,h,b){m===1&&b.readMessage(Rm,h)}function Rm(m,h,b){if(m===3){const{id:M,bitmap:q,width:K,height:J,left:me,top:Ce,advance:Ne}=b.readMessage(Fm,{});h.push({id:M,bitmap:new Dl({width:K+2*fd,height:J+2*fd},q),metrics:{width:K,height:J,left:me,top:Ce,advance:Ne}})}}function Fm(m,h,b){m===1?h.id=b.readVarint():m===2?h.bitmap=b.readBytes():m===3?h.width=b.readVarint():m===4?h.height=b.readVarint():m===5?h.left=b.readSVarint():m===6?h.top=b.readSVarint():m===7&&(h.advance=b.readVarint())}const dd=fd;function LA(m){let h=0,b=0;for(const J of m)h+=J.w*J.h,b=Math.max(b,J.w);m.sort((J,me)=>me.h-J.h);const M=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(h/.95)),b),h:1/0}];let q=0,K=0;for(const J of m)for(let me=M.length-1;me>=0;me--){const Ce=M[me];if(!(J.w>Ce.w||J.h>Ce.h)){if(J.x=Ce.x,J.y=Ce.y,K=Math.max(K,J.y+J.h),q=Math.max(q,J.x+J.w),J.w===Ce.w&&J.h===Ce.h){const Ne=M.pop();me<M.length&&(M[me]=Ne)}else J.h===Ce.h?(Ce.x+=J.w,Ce.w-=J.w):J.w===Ce.w?(Ce.y+=J.h,Ce.h-=J.h):(M.push({x:Ce.x+J.w,y:Ce.y,w:Ce.w-J.w,h:J.h}),Ce.y+=J.h,Ce.h-=J.h);break}}return{w:q,h:K,fill:h/(q*K)||0}}const fl=1;class y0{constructor(h,{pixelRatio:b,version:M,stretchX:q,stretchY:K,content:J}){this.paddedRect=h,this.pixelRatio=b,this.stretchX=q,this.stretchY=K,this.content=J,this.version=M}get tl(){return[this.paddedRect.x+fl,this.paddedRect.y+fl]}get br(){return[this.paddedRect.x+this.paddedRect.w-fl,this.paddedRect.y+this.paddedRect.h-fl]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*fl)/this.pixelRatio,(this.paddedRect.h-2*fl)/this.pixelRatio]}}class v0{constructor(h,b){const M={},q={};this.haveRenderCallbacks=[];const K=[];this.addImages(h,M,K),this.addImages(b,q,K);const{w:J,h:me}=LA(K),Ce=new Vu({width:J||1,height:me||1});for(const Ne in h){const f=h[Ne],u=M[Ne].paddedRect;Vu.copy(f.data,Ce,{x:0,y:0},{x:u.x+fl,y:u.y+fl},f.data)}for(const Ne in b){const f=b[Ne],u=q[Ne].paddedRect,p=u.x+fl,I=u.y+fl,L=f.data.width,U=f.data.height;Vu.copy(f.data,Ce,{x:0,y:0},{x:p,y:I},f.data),Vu.copy(f.data,Ce,{x:0,y:U-1},{x:p,y:I-1},{width:L,height:1}),Vu.copy(f.data,Ce,{x:0,y:0},{x:p,y:I+U},{width:L,height:1}),Vu.copy(f.data,Ce,{x:L-1,y:0},{x:p-1,y:I},{width:1,height:U}),Vu.copy(f.data,Ce,{x:0,y:0},{x:p+L,y:I},{width:1,height:U})}this.image=Ce,this.iconPositions=M,this.patternPositions=q}addImages(h,b,M){for(const q in h){const K=h[q],J={x:0,y:0,w:K.data.width+2*fl,h:K.data.height+2*fl};M.push(J),b[q]=new y0(J,K),K.hasRenderCallback&&this.haveRenderCallbacks.push(q)}}patchUpdatedImages(h,b){h.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const M in h.updatedImages)this.patchUpdatedImage(this.iconPositions[M],h.getImage(M),b),this.patchUpdatedImage(this.patternPositions[M],h.getImage(M),b)}patchUpdatedImage(h,b,M){if(!h||!b||h.version===b.version)return;h.version=b.version;const[q,K]=h.tl;M.update(b.data,void 0,{x:q,y:K})}}var Pc;Sn("ImagePosition",y0),Sn("ImageAtlas",v0),S.ah=void 0,(Pc=S.ah||(S.ah={}))[Pc.none=0]="none",Pc[Pc.horizontal=1]="horizontal",Pc[Pc.vertical=2]="vertical",Pc[Pc.horizontalOnly=3]="horizontalOnly";const BA=-17;class Ef{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(h,b){const M=new Ef;return M.scale=h||1,M.fontStack=b,M}static forImage(h){const b=new Ef;return b.imageName=h,b}}class zA{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(h,b){const M=new zA;for(let q=0;q<h.sections.length;q++){const K=h.sections[q];K.image?M.addImageSection(K):M.addTextSection(K,b)}return M}length(){return this.text.length}getSection(h){return this.sections[this.sectionIndex[h]]}getSectionIndex(h){return this.sectionIndex[h]}getCharCode(h){return this.text.charCodeAt(h)}verticalizePunctuation(){this.text=function(h){let b="";for(let M=0;M<h.length;M++){const q=h.charCodeAt(M+1)||null,K=h.charCodeAt(M-1)||null;b+=q&&yl(q)&&!Ch[h[M+1]]||K&&yl(K)&&!Ch[h[M-1]]||!Ch[h[M]]?h[M]:Ch[h[M]]}return b}(this.text)}trim(){let h=0;for(let M=0;M<this.text.length&&Tf[this.text.charCodeAt(M)];M++)h++;let b=this.text.length;for(let M=this.text.length-1;M>=0&&M>=h&&Tf[this.text.charCodeAt(M)];M--)b--;this.text=this.text.substring(h,b),this.sectionIndex=this.sectionIndex.slice(h,b)}substring(h,b){const M=new zA;return M.text=this.text.substring(h,b),M.sectionIndex=this.sectionIndex.slice(h,b),M.sections=this.sections,M}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((h,b)=>Math.max(h,this.sections[b].scale),0)}addTextSection(h,b){this.text+=h.text,this.sections.push(Ef.forText(h.scale,h.fontStack||b));const M=this.sections.length-1;for(let q=0;q<h.text.length;++q)this.sectionIndex.push(M)}addImageSection(h){const b=h.image?h.image.name:"";if(b.length===0)return void dt("Can't add FormattedSection with an empty image.");const M=this.getNextImageSectionCharCode();M?(this.text+=String.fromCharCode(M),this.sections.push(Ef.forImage(b)),this.sectionIndex.push(this.sections.length-1)):dt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Cf(m,h,b,M,q,K,J,me,Ce,Ne,f,u,p,I,L,U){const Q=zA.fromFeature(m,q);let re;u===S.ah.vertical&&Q.verticalizePunctuation();const{processBidirectionalText:Ae,processStyledBidirectionalText:_e}=$l;if(Ae&&Q.sections.length===1){re=[];const et=Ae(Q.toString(),nh(Q,Ne,K,h,M,I,L));for(const At of et){const gt=new zA;gt.text=At,gt.sections=Q.sections;for(let Dt=0;Dt<At.length;Dt++)gt.sectionIndex.push(0);re.push(gt)}}else if(_e){re=[];const et=_e(Q.text,Q.sectionIndex,nh(Q,Ne,K,h,M,I,L));for(const At of et){const gt=new zA;gt.text=At[0],gt.sectionIndex=At[1],gt.sections=Q.sections,re.push(gt)}}else re=function(et,At){const gt=[],Dt=et.text;let Lt=0;for(const Rt of At)gt.push(et.substring(Lt,Rt)),Lt=Rt;return Lt<Dt.length&&gt.push(et.substring(Lt,Dt.length)),gt}(Q,nh(Q,Ne,K,h,M,I,L));const Le=[],qe={positionedLines:Le,text:Q.toString(),top:f[1],bottom:f[1],left:f[0],right:f[0],writingMode:u,iconsInText:!1,verticalizable:!1};return function(et,At,gt,Dt,Lt,Rt,Kt,Ht,Qt,ui,yi,Yi){let wn=0,un=BA,on=0,dn=0;const Rn=Ht==="right"?1:Ht==="left"?0:.5;let an=0;for(const Vr of Lt){Vr.trim();const Hr=Vr.getMaxScale(),Rs=(Hr-1)*Al,Ea={positionedGlyphs:[],lineOffset:0};et.positionedLines[an]=Ea;const ia=Ea.positionedGlyphs;let ns=0;if(!Vr.length()){un+=Rt,++an;continue}for(let ws=0;ws<Vr.length();ws++){const ir=Vr.getSection(ws),na=Vr.getSectionIndex(ws),Ps=Vr.getCharCode(ws);let Kn=0,La=null,Ja=null,va=null,qo=Al;const uo=!(Qt===S.ah.horizontal||!yi&&!Vl(Ps)||yi&&(Tf[Ps]||(Xi=Ps,Cn.Arabic(Xi)||Cn["Arabic Supplement"](Xi)||Cn["Arabic Extended-A"](Xi)||Cn["Arabic Presentation Forms-A"](Xi)||Cn["Arabic Presentation Forms-B"](Xi))));if(ir.imageName){const ra=Dt[ir.imageName];if(!ra)continue;va=ir.imageName,et.iconsInText=et.iconsInText||!0,Ja=ra.paddedRect;const br=ra.displaySize;ir.scale=ir.scale*Al/Yi,La={width:br[0],height:br[1],left:fl,top:-dd,advance:uo?br[1]:br[0]},Kn=Rs+(Al-br[1]*ir.scale),qo=La.advance;const wo=uo?br[0]*ir.scale-Al*Hr:br[1]*ir.scale-Al*Hr;wo>0&&wo>ns&&(ns=wo)}else{const ra=gt[ir.fontStack],br=ra&&ra[Ps];if(br&&br.rect)Ja=br.rect,La=br.metrics;else{const wo=At[ir.fontStack],nl=wo&&wo[Ps];if(!nl)continue;La=nl.metrics}Kn=(Hr-ir.scale)*Al}uo?(et.verticalizable=!0,ia.push({glyph:Ps,imageName:va,x:wn,y:un+Kn,vertical:uo,scale:ir.scale,fontStack:ir.fontStack,sectionIndex:na,metrics:La,rect:Ja}),wn+=qo*ir.scale+ui):(ia.push({glyph:Ps,imageName:va,x:wn,y:un+Kn,vertical:uo,scale:ir.scale,fontStack:ir.fontStack,sectionIndex:na,metrics:La,rect:Ja}),wn+=La.advance*ir.scale+ui)}ia.length!==0&&(on=Math.max(wn-ui,on),b0(ia,0,ia.length-1,Rn,ns)),wn=0;const Wn=Rt*Hr+ns;Ea.lineOffset=Math.max(ns,Rs),un+=Wn,dn=Math.max(Wn,dn),++an}var Xi;const Ln=un-BA,{horizontalAlign:Nn,verticalAlign:pr}=OA(Kt);(function(Vr,Hr,Rs,Ea,ia,ns,Wn,ws,ir){const na=(Hr-Rs)*ia;let Ps=0;Ps=ns!==Wn?-ws*Ea-BA:(-Ea*ir+.5)*Wn;for(const Kn of Vr)for(const La of Kn.positionedGlyphs)La.x+=na,La.y+=Ps})(et.positionedLines,Rn,Nn,pr,on,dn,Rt,Ln,Lt.length),et.top+=-pr*Ln,et.bottom=et.top+Ln,et.left+=-Nn*on,et.right=et.left+on}(qe,h,b,M,re,J,me,Ce,u,Ne,p,U),!function(et){for(const At of et)if(At.positionedGlyphs.length!==0)return!1;return!0}(Le)&&qe}const Tf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Su={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function x0(m,h,b,M,q,K){if(h.imageName){const J=M[h.imageName];return J?J.displaySize[0]*h.scale*Al/K+q:0}{const J=b[h.fontStack],me=J&&J[m];return me?me.metrics.advance*h.scale+q:0}}function ku(m,h,b,M){const q=Math.pow(m-h,2);return M?m<h?q/2:2*q:q+Math.abs(b)*b}function Th(m,h,b){let M=0;return m===10&&(M-=1e4),b&&(M+=150),m!==40&&m!==65288||(M+=50),h!==41&&h!==65289||(M+=50),M}function RA(m,h,b,M,q,K){let J=null,me=ku(h,b,q,K);for(const Ce of M){const Ne=ku(h-Ce.x,b,q,K)+Ce.badness;Ne<=me&&(J=Ce,me=Ne)}return{index:m,x:h,priorBreak:J,badness:me}}function FA(m){return m?FA(m.priorBreak).concat(m.index):[]}function nh(m,h,b,M,q,K,J){if(K!=="point")return[];if(!m)return[];const me=[],Ce=function(p,I,L,U,Q,re){let Ae=0;for(let _e=0;_e<p.length();_e++){const Le=p.getSection(_e);Ae+=x0(p.getCharCode(_e),Le,U,Q,I,re)}return Ae/Math.max(1,Math.ceil(Ae/L))}(m,h,b,M,q,J),Ne=m.text.indexOf("")>=0;let f=0;for(let p=0;p<m.length();p++){const I=m.getSection(p),L=m.getCharCode(p);if(Tf[L]||(f+=x0(L,I,M,q,h,J)),p<m.length()-1){const U=!((u=L)<11904||!(Cn["Bopomofo Extended"](u)||Cn.Bopomofo(u)||Cn["CJK Compatibility Forms"](u)||Cn["CJK Compatibility Ideographs"](u)||Cn["CJK Compatibility"](u)||Cn["CJK Radicals Supplement"](u)||Cn["CJK Strokes"](u)||Cn["CJK Symbols and Punctuation"](u)||Cn["CJK Unified Ideographs Extension A"](u)||Cn["CJK Unified Ideographs"](u)||Cn["Enclosed CJK Letters and Months"](u)||Cn["Halfwidth and Fullwidth Forms"](u)||Cn.Hiragana(u)||Cn["Ideographic Description Characters"](u)||Cn["Kangxi Radicals"](u)||Cn["Katakana Phonetic Extensions"](u)||Cn.Katakana(u)||Cn["Vertical Forms"](u)||Cn["Yi Radicals"](u)||Cn["Yi Syllables"](u)));(Su[L]||U||I.imageName)&&me.push(RA(p+1,f,Ce,me,Th(L,m.getCharCode(p+1),U&&Ne),!1))}}var u;return FA(RA(m.length(),f,Ce,me,0,!0))}function OA(m){let h=.5,b=.5;switch(m){case"right":case"top-right":case"bottom-right":h=1;break;case"left":case"top-left":case"bottom-left":h=0}switch(m){case"bottom":case"bottom-right":case"bottom-left":b=1;break;case"top":case"top-right":case"top-left":b=0}return{horizontalAlign:h,verticalAlign:b}}function b0(m,h,b,M,q){if(!M&&!q)return;const K=m[b],J=(m[b].x+K.metrics.advance*K.scale)*M;for(let me=h;me<=b;me++)m[me].x-=J,m[me].y+=q}function Om(m,h,b){const{horizontalAlign:M,verticalAlign:q}=OA(b),K=h[0]-m.displaySize[0]*M,J=h[1]-m.displaySize[1]*q;return{image:m,top:J,bottom:J+m.displaySize[1],left:K,right:K+m.displaySize[0]}}function pd(m,h,b,M,q,K){const J=m.image;let me;if(J.content){const Q=J.content,re=J.pixelRatio||1;me=[Q[0]/re,Q[1]/re,J.displaySize[0]-Q[2]/re,J.displaySize[1]-Q[3]/re]}const Ce=h.left*K,Ne=h.right*K;let f,u,p,I;b==="width"||b==="both"?(I=q[0]+Ce-M[3],u=q[0]+Ne+M[1]):(I=q[0]+(Ce+Ne-J.displaySize[0])/2,u=I+J.displaySize[0]);const L=h.top*K,U=h.bottom*K;return b==="height"||b==="both"?(f=q[1]+L-M[0],p=q[1]+U+M[2]):(f=q[1]+(L+U-J.displaySize[1])/2,p=f+J.displaySize[1]),{image:J,top:f,right:u,bottom:p,left:I,collisionPadding:me}}const kh=255,Dc=128,rh=kh*Dc;function md(m,h){const{expression:b}=h;if(b.kind==="constant")return{kind:"constant",layoutSize:b.evaluate(new ms(m+1))};if(b.kind==="source")return{kind:"source"};{const{zoomStops:M,interpolationType:q}=b;let K=0;for(;K<M.length&&M[K]<=m;)K++;K=Math.max(0,K-1);let J=K;for(;J<M.length&&M[J]<m+1;)J++;J=Math.min(M.length-1,J);const me=M[K],Ce=M[J];return b.kind==="composite"?{kind:"composite",minZoom:me,maxZoom:Ce,interpolationType:q}:{kind:"camera",minZoom:me,maxZoom:Ce,minSize:b.evaluate(new ms(me)),maxSize:b.evaluate(new ms(Ce)),interpolationType:q}}}function kf(m,h,b){let M="never";const q=m.get(h);return q?M=q:m.get(b)&&(M="always"),M}const gd=hc.VectorTileFeature.types,Nm=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function w0(m,h,b,M,q,K,J,me,Ce,Ne,f,u,p){const I=me?Math.min(rh,Math.round(me[0])):0,L=me?Math.min(rh,Math.round(me[1])):0;m.emplaceBack(h,b,Math.round(32*M),Math.round(32*q),K,J,(I<<1)+(Ce?1:0),L,16*Ne,16*f,256*u,256*p)}function S0(m,h,b){m.emplaceBack(h.x,h.y,b),m.emplaceBack(h.x,h.y,b),m.emplaceBack(h.x,h.y,b),m.emplaceBack(h.x,h.y,b)}function Mf(m){for(const h of m.sections)if($u(h.text))return!0;return!1}class Yu{constructor(h){this.layoutVertexArray=new ot,this.indexArray=new Xt,this.programConfigurations=h,this.segments=new Wi,this.dynamicLayoutVertexArray=new ct,this.opacityVertexArray=new It,this.hasVisibleVertices=!1,this.placedSymbolArray=new r}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(h,b,M,q){this.isEmpty()||(M&&(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,Cp.members),this.indexBuffer=h.createIndexBuffer(this.indexArray,b),this.dynamicLayoutVertexBuffer=h.createVertexBuffer(this.dynamicLayoutVertexArray,rd.members,!0),this.opacityVertexBuffer=h.createVertexBuffer(this.opacityVertexArray,Nm,!0),this.opacityVertexBuffer.itemSize=1),(M||q)&&this.programConfigurations.upload(h))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Sn("SymbolBuffers",Yu);class Lc{constructor(h,b,M){this.layoutVertexArray=new h,this.layoutAttributes=b,this.indexArray=new M,this.segments=new Wi,this.collisionVertexArray=new ri}upload(h){this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=h.createVertexBuffer(this.collisionVertexArray,TA.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Sn("CollisionBuffers",Lc);class tA{constructor(h){this.collisionBoxArray=h.collisionBoxArray,this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(J=>J.id),this.index=h.index,this.pixelRatio=h.pixelRatio,this.sourceLayerIndex=h.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=j0([]),this.placementViewportMatrix=j0([]);const b=this.layers[0]._unevaluatedLayout._values;this.textSizeData=md(this.zoom,b["text-size"]),this.iconSizeData=md(this.zoom,b["icon-size"]);const M=this.layers[0].layout,q=M.get("symbol-sort-key"),K=M.get("symbol-z-order");this.canOverlap=kf(M,"text-overlap","text-allow-overlap")!=="never"||kf(M,"icon-overlap","icon-allow-overlap")!=="never"||M.get("text-ignore-placement")||M.get("icon-ignore-placement"),this.sortFeaturesByKey=K!=="viewport-y"&&!q.isConstant(),this.sortFeaturesByY=(K==="viewport-y"||K==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,M.get("symbol-placement")==="point"&&(this.writingModes=M.get("text-writing-mode").map(J=>S.ah[J])),this.stateDependentLayerIds=this.layers.filter(J=>J.isStateDependent()).map(J=>J.id),this.sourceID=h.sourceID}createArrays(){this.text=new Yu(new Uo(this.layers,this.zoom,h=>/^text/.test(h))),this.icon=new Yu(new Uo(this.layers,this.zoom,h=>/^icon/.test(h))),this.glyphOffsetArray=new _,this.lineVertexArray=new w,this.symbolInstances=new d,this.textAnchorOffsets=new B}calculateGlyphDependencies(h,b,M,q,K){for(let J=0;J<h.length;J++)if(b[h.charCodeAt(J)]=!0,(M||q)&&K){const me=Ch[h.charAt(J)];me&&(b[me.charCodeAt(0)]=!0)}}populate(h,b,M){const q=this.layers[0],K=q.layout,J=K.get("text-font"),me=K.get("text-field"),Ce=K.get("icon-image"),Ne=(me.value.kind!=="constant"||me.value.value instanceof Zi&&!me.value.value.isEmpty()||me.value.value.toString().length>0)&&(J.value.kind!=="constant"||J.value.value.length>0),f=Ce.value.kind!=="constant"||!!Ce.value.value||Object.keys(Ce.parameters).length>0,u=K.get("symbol-sort-key");if(this.features=[],!Ne&&!f)return;const p=b.iconDependencies,I=b.glyphDependencies,L=b.availableImages,U=new ms(this.zoom);for(const{feature:Q,id:re,index:Ae,sourceLayerIndex:_e}of h){const Le=q._featureFilter.needGeometry,qe=vl(Q,Le);if(!q._featureFilter.filter(U,qe,M))continue;let et,At;if(Le||(qe.geometry=il(Q)),Ne){const Dt=q.getValueAndResolveTokens("text-field",qe,M,L),Lt=Zi.factory(Dt);Mf(Lt)&&(this.hasRTLText=!0),(!this.hasRTLText||$l.getRTLTextPluginStatus()==="unavailable"||this.hasRTLText&&$l.isParsed())&&(et=Bm(Lt,q,qe))}if(f){const Dt=q.getValueAndResolveTokens("icon-image",qe,M,L);At=Dt instanceof Ki?Dt:Ki.fromString(Dt)}if(!et&&!At)continue;const gt=this.sortFeaturesByKey?u.evaluate(qe,{},M):void 0;if(this.features.push({id:re,text:et,icon:At,index:Ae,sourceLayerIndex:_e,geometry:qe.geometry,properties:Q.properties,type:gd[Q.type],sortKey:gt}),At&&(p[At.name]=!0),et){const Dt=J.evaluate(qe,{},M).join(","),Lt=K.get("text-rotation-alignment")!=="viewport"&&K.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(S.ah.vertical)>=0;for(const Rt of et.sections)if(Rt.image)p[Rt.image.name]=!0;else{const Kt=_l(et.toString()),Ht=Rt.fontStack||Dt,Qt=I[Ht]=I[Ht]||{};this.calculateGlyphDependencies(Rt.text,Qt,Lt,this.allowVerticalPlacement,Kt)}}}K.get("symbol-placement")==="line"&&(this.features=function(Q){const re={},Ae={},_e=[];let Le=0;function qe(Dt){_e.push(Q[Dt]),Le++}function et(Dt,Lt,Rt){const Kt=Ae[Dt];return delete Ae[Dt],Ae[Lt]=Kt,_e[Kt].geometry[0].pop(),_e[Kt].geometry[0]=_e[Kt].geometry[0].concat(Rt[0]),Kt}function At(Dt,Lt,Rt){const Kt=re[Lt];return delete re[Lt],re[Dt]=Kt,_e[Kt].geometry[0].shift(),_e[Kt].geometry[0]=Rt[0].concat(_e[Kt].geometry[0]),Kt}function gt(Dt,Lt,Rt){const Kt=Rt?Lt[0][Lt[0].length-1]:Lt[0][0];return`${Dt}:${Kt.x}:${Kt.y}`}for(let Dt=0;Dt<Q.length;Dt++){const Lt=Q[Dt],Rt=Lt.geometry,Kt=Lt.text?Lt.text.toString():null;if(!Kt){qe(Dt);continue}const Ht=gt(Kt,Rt),Qt=gt(Kt,Rt,!0);if(Ht in Ae&&Qt in re&&Ae[Ht]!==re[Qt]){const ui=At(Ht,Qt,Rt),yi=et(Ht,Qt,_e[ui].geometry);delete re[Ht],delete Ae[Qt],Ae[gt(Kt,_e[yi].geometry,!0)]=yi,_e[ui].geometry=null}else Ht in Ae?et(Ht,Qt,Rt):Qt in re?At(Ht,Qt,Rt):(qe(Dt),re[Ht]=Le-1,Ae[Qt]=Le-1)}return _e.filter(Dt=>Dt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Q,re)=>Q.sortKey-re.sortKey)}update(h,b,M){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(h,b,this.layers,M),this.icon.programConfigurations.updatePaintArrays(h,b,this.layers,M))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(h){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(h),this.iconCollisionBox.upload(h)),this.text.upload(h,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(h,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(h,b){const M=this.lineVertexArray.length;if(h.segment!==void 0){let q=h.dist(b[h.segment+1]),K=h.dist(b[h.segment]);const J={};for(let me=h.segment+1;me<b.length;me++)J[me]={x:b[me].x,y:b[me].y,tileUnitDistanceFromAnchor:q},me<b.length-1&&(q+=b[me+1].dist(b[me]));for(let me=h.segment||0;me>=0;me--)J[me]={x:b[me].x,y:b[me].y,tileUnitDistanceFromAnchor:K},me>0&&(K+=b[me-1].dist(b[me]));for(let me=0;me<b.length;me++){const Ce=J[me];this.lineVertexArray.emplaceBack(Ce.x,Ce.y,Ce.tileUnitDistanceFromAnchor)}}return{lineStartIndex:M,lineLength:this.lineVertexArray.length-M}}addSymbols(h,b,M,q,K,J,me,Ce,Ne,f,u,p){const I=h.indexArray,L=h.layoutVertexArray,U=h.segments.prepareSegment(4*b.length,L,I,this.canOverlap?J.sortKey:void 0),Q=this.glyphOffsetArray.length,re=U.vertexLength,Ae=this.allowVerticalPlacement&&me===S.ah.vertical?Math.PI/2:0,_e=J.text&&J.text.sections;for(let Le=0;Le<b.length;Le++){const{tl:qe,tr:et,bl:At,br:gt,tex:Dt,pixelOffsetTL:Lt,pixelOffsetBR:Rt,minFontScaleX:Kt,minFontScaleY:Ht,glyphOffset:Qt,isSDF:ui,sectionIndex:yi}=b[Le],Yi=U.vertexLength,wn=Qt[1];w0(L,Ce.x,Ce.y,qe.x,wn+qe.y,Dt.x,Dt.y,M,ui,Lt.x,Lt.y,Kt,Ht),w0(L,Ce.x,Ce.y,et.x,wn+et.y,Dt.x+Dt.w,Dt.y,M,ui,Rt.x,Lt.y,Kt,Ht),w0(L,Ce.x,Ce.y,At.x,wn+At.y,Dt.x,Dt.y+Dt.h,M,ui,Lt.x,Rt.y,Kt,Ht),w0(L,Ce.x,Ce.y,gt.x,wn+gt.y,Dt.x+Dt.w,Dt.y+Dt.h,M,ui,Rt.x,Rt.y,Kt,Ht),S0(h.dynamicLayoutVertexArray,Ce,Ae),I.emplaceBack(Yi,Yi+1,Yi+2),I.emplaceBack(Yi+1,Yi+2,Yi+3),U.vertexLength+=4,U.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Qt[0]),Le!==b.length-1&&yi===b[Le+1].sectionIndex||h.programConfigurations.populatePaintArrays(L.length,J,J.index,{},p,_e&&_e[yi])}h.placedSymbolArray.emplaceBack(Ce.x,Ce.y,Q,this.glyphOffsetArray.length-Q,re,Ne,f,Ce.segment,M?M[0]:0,M?M[1]:0,q[0],q[1],me,0,!1,0,u)}_addCollisionDebugVertex(h,b,M,q,K,J){return b.emplaceBack(0,0),h.emplaceBack(M.x,M.y,q,K,Math.round(J.x),Math.round(J.y))}addCollisionDebugVertices(h,b,M,q,K,J,me){const Ce=K.segments.prepareSegment(4,K.layoutVertexArray,K.indexArray),Ne=Ce.vertexLength,f=K.layoutVertexArray,u=K.collisionVertexArray,p=me.anchorX,I=me.anchorY;this._addCollisionDebugVertex(f,u,J,p,I,new ae(h,b)),this._addCollisionDebugVertex(f,u,J,p,I,new ae(M,b)),this._addCollisionDebugVertex(f,u,J,p,I,new ae(M,q)),this._addCollisionDebugVertex(f,u,J,p,I,new ae(h,q)),Ce.vertexLength+=4;const L=K.indexArray;L.emplaceBack(Ne,Ne+1),L.emplaceBack(Ne+1,Ne+2),L.emplaceBack(Ne+2,Ne+3),L.emplaceBack(Ne+3,Ne),Ce.primitiveLength+=4}addDebugCollisionBoxes(h,b,M,q){for(let K=h;K<b;K++){const J=this.collisionBoxArray.get(K);this.addCollisionDebugVertices(J.x1,J.y1,J.x2,J.y2,q?this.textCollisionBox:this.iconCollisionBox,J.anchorPoint,M)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Lc(bt,m0.members,ti),this.iconCollisionBox=new Lc(bt,m0.members,ti);for(let h=0;h<this.symbolInstances.length;h++){const b=this.symbolInstances.get(h);this.addDebugCollisionBoxes(b.textBoxStartIndex,b.textBoxEndIndex,b,!0),this.addDebugCollisionBoxes(b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b,!0),this.addDebugCollisionBoxes(b.iconBoxStartIndex,b.iconBoxEndIndex,b,!1),this.addDebugCollisionBoxes(b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b,!1)}}_deserializeCollisionBoxesForSymbol(h,b,M,q,K,J,me,Ce,Ne){const f={};for(let u=b;u<M;u++){const p=h.get(u);f.textBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.textFeatureIndex=p.featureIndex;break}for(let u=q;u<K;u++){const p=h.get(u);f.verticalTextBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.verticalTextFeatureIndex=p.featureIndex;break}for(let u=J;u<me;u++){const p=h.get(u);f.iconBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.iconFeatureIndex=p.featureIndex;break}for(let u=Ce;u<Ne;u++){const p=h.get(u);f.verticalIconBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.verticalIconFeatureIndex=p.featureIndex;break}return f}deserializeCollisionBoxes(h){this.collisionArrays=[];for(let b=0;b<this.symbolInstances.length;b++){const M=this.symbolInstances.get(b);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(h,M.textBoxStartIndex,M.textBoxEndIndex,M.verticalTextBoxStartIndex,M.verticalTextBoxEndIndex,M.iconBoxStartIndex,M.iconBoxEndIndex,M.verticalIconBoxStartIndex,M.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(h,b){const M=h.placedSymbolArray.get(b),q=M.vertexStartIndex+4*M.numGlyphs;for(let K=M.vertexStartIndex;K<q;K+=4)h.indexArray.emplaceBack(K,K+1,K+2),h.indexArray.emplaceBack(K+1,K+2,K+3)}getSortedSymbolIndexes(h){if(this.sortedAngle===h&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const b=Math.sin(h),M=Math.cos(h),q=[],K=[],J=[];for(let me=0;me<this.symbolInstances.length;++me){J.push(me);const Ce=this.symbolInstances.get(me);q.push(0|Math.round(b*Ce.anchorX+M*Ce.anchorY)),K.push(Ce.featureIndex)}return J.sort((me,Ce)=>q[me]-q[Ce]||K[Ce]-K[me]),J}addToSortKeyRanges(h,b){const M=this.sortKeyRanges[this.sortKeyRanges.length-1];M&&M.sortKey===b?M.symbolInstanceEnd=h+1:this.sortKeyRanges.push({sortKey:b,symbolInstanceStart:h,symbolInstanceEnd:h+1})}sortFeatures(h){if(this.sortFeaturesByY&&this.sortedAngle!==h&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(h),this.sortedAngle=h,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const b of this.symbolInstanceIndexes){const M=this.symbolInstances.get(b);this.featureSortOrder.push(M.featureIndex),[M.rightJustifiedTextSymbolIndex,M.centerJustifiedTextSymbolIndex,M.leftJustifiedTextSymbolIndex].forEach((q,K,J)=>{q>=0&&J.indexOf(q)===K&&this.addIndicesForPlacedSymbol(this.text,q)}),M.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,M.verticalPlacedTextSymbolIndex),M.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,M.placedIconSymbolIndex),M.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,M.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let I0,Pp;Sn("SymbolBucket",tA,{omit:["layers","collisionBoxArray","features","compareText"]}),tA.MAX_GLYPHS=65535,tA.addDynamicAttributes=S0;var _d={get paint(){return Pp=Pp||new oa({"icon-opacity":new jn(ei.paint_symbol["icon-opacity"]),"icon-color":new jn(ei.paint_symbol["icon-color"]),"icon-halo-color":new jn(ei.paint_symbol["icon-halo-color"]),"icon-halo-width":new jn(ei.paint_symbol["icon-halo-width"]),"icon-halo-blur":new jn(ei.paint_symbol["icon-halo-blur"]),"icon-translate":new gn(ei.paint_symbol["icon-translate"]),"icon-translate-anchor":new gn(ei.paint_symbol["icon-translate-anchor"]),"text-opacity":new jn(ei.paint_symbol["text-opacity"]),"text-color":new jn(ei.paint_symbol["text-color"],{runtimeType:He,getOverride:m=>m.textColor,hasOverride:m=>!!m.textColor}),"text-halo-color":new jn(ei.paint_symbol["text-halo-color"]),"text-halo-width":new jn(ei.paint_symbol["text-halo-width"]),"text-halo-blur":new jn(ei.paint_symbol["text-halo-blur"]),"text-translate":new gn(ei.paint_symbol["text-translate"]),"text-translate-anchor":new gn(ei.paint_symbol["text-translate-anchor"])})},get layout(){return I0=I0||new oa({"symbol-placement":new gn(ei.layout_symbol["symbol-placement"]),"symbol-spacing":new gn(ei.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new gn(ei.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new jn(ei.layout_symbol["symbol-sort-key"]),"symbol-z-order":new gn(ei.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new gn(ei.layout_symbol["icon-allow-overlap"]),"icon-overlap":new gn(ei.layout_symbol["icon-overlap"]),"icon-ignore-placement":new gn(ei.layout_symbol["icon-ignore-placement"]),"icon-optional":new gn(ei.layout_symbol["icon-optional"]),"icon-rotation-alignment":new gn(ei.layout_symbol["icon-rotation-alignment"]),"icon-size":new jn(ei.layout_symbol["icon-size"]),"icon-text-fit":new gn(ei.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new gn(ei.layout_symbol["icon-text-fit-padding"]),"icon-image":new jn(ei.layout_symbol["icon-image"]),"icon-rotate":new jn(ei.layout_symbol["icon-rotate"]),"icon-padding":new jn(ei.layout_symbol["icon-padding"]),"icon-keep-upright":new gn(ei.layout_symbol["icon-keep-upright"]),"icon-offset":new jn(ei.layout_symbol["icon-offset"]),"icon-anchor":new jn(ei.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new gn(ei.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new gn(ei.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new gn(ei.layout_symbol["text-rotation-alignment"]),"text-field":new jn(ei.layout_symbol["text-field"]),"text-font":new jn(ei.layout_symbol["text-font"]),"text-size":new jn(ei.layout_symbol["text-size"]),"text-max-width":new jn(ei.layout_symbol["text-max-width"]),"text-line-height":new gn(ei.layout_symbol["text-line-height"]),"text-letter-spacing":new jn(ei.layout_symbol["text-letter-spacing"]),"text-justify":new jn(ei.layout_symbol["text-justify"]),"text-radial-offset":new jn(ei.layout_symbol["text-radial-offset"]),"text-variable-anchor":new gn(ei.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new jn(ei.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new jn(ei.layout_symbol["text-anchor"]),"text-max-angle":new gn(ei.layout_symbol["text-max-angle"]),"text-writing-mode":new gn(ei.layout_symbol["text-writing-mode"]),"text-rotate":new jn(ei.layout_symbol["text-rotate"]),"text-padding":new gn(ei.layout_symbol["text-padding"]),"text-keep-upright":new gn(ei.layout_symbol["text-keep-upright"]),"text-transform":new jn(ei.layout_symbol["text-transform"]),"text-offset":new jn(ei.layout_symbol["text-offset"]),"text-allow-overlap":new gn(ei.layout_symbol["text-allow-overlap"]),"text-overlap":new gn(ei.layout_symbol["text-overlap"]),"text-ignore-placement":new gn(ei.layout_symbol["text-ignore-placement"]),"text-optional":new gn(ei.layout_symbol["text-optional"])})}};class Pf{constructor(h){if(h.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=h.property.overrides?h.property.overrides.runtimeType:Ie,this.defaultValue=h}evaluate(h){if(h.formattedSection){const b=this.defaultValue.property.overrides;if(b&&b.hasOverride(h.formattedSection))return b.getOverride(h.formattedSection)}return h.feature&&h.featureState?this.defaultValue.evaluate(h.feature,h.featureState):this.defaultValue.property.specification.default}eachChild(h){this.defaultValue.isConstant()||h(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Sn("FormatSectionOverride",Pf,{omit:["defaultValue"]});class NA extends vs{constructor(h){super(h,_d)}recalculate(h,b){if(super.recalculate(h,b),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const M=this.layout.get("text-writing-mode");if(M){const q=[];for(const K of M)q.indexOf(K)<0&&q.push(K);this.layout._values["text-writing-mode"]=q}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(h,b,M,q){const K=this.layout.get(h).evaluate(b,{},M,q),J=this._unevaluatedLayout._values[h];return J.isDataDriven()||Zr(J.value)||!K?K:function(me,Ce){return Ce.replace(/{([^{}]+)}/g,(Ne,f)=>me&&f in me?String(me[f]):"")}(b.properties,K)}createBucket(h){return new tA(h)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const h of _d.paint.overridableProperties){if(!NA.hasPaintOverride(this.layout,h))continue;const b=this.paint.get(h),M=new Pf(b),q=new es(M,b.property.specification);let K=null;K=b.value.kind==="constant"||b.value.kind==="source"?new kr("source",q):new rr("composite",q,b.value.zoomStops),this.paint._values[h]=new _r(b.property,K,b.parameters)}}_handleOverridablePaintPropertyUpdate(h,b,M){return!(!this.layout||b.isDataDriven()||M.isDataDriven())&&NA.hasPaintOverride(this.layout,h)}static hasPaintOverride(h,b){const M=h.get("text-field"),q=_d.paint.properties[b];let K=!1;const J=me=>{for(const Ce of me)if(q.overrides&&q.overrides.hasOverride(Ce))return void(K=!0)};if(M.value.kind==="constant"&&M.value.value instanceof Zi)J(M.value.value.sections);else if(M.value.kind==="source"){const me=Ne=>{K||(Ne instanceof Ur&&cr(Ne.value)===st?J(Ne.value.sections):Ne instanceof Ql?J(Ne.sections):Ne.eachChild(me))},Ce=M.value;Ce._styleExpression&&me(Ce._styleExpression.expression)}return K}}let Dp;var yd={get paint(){return Dp=Dp||new oa({"background-color":new gn(ei.paint_background["background-color"]),"background-pattern":new tl(ei.paint_background["background-pattern"]),"background-opacity":new gn(ei.paint_background["background-opacity"])})}};class vd extends vs{constructor(h){super(h,yd)}}let sh;var xd={get paint(){return sh=sh||new oa({"raster-opacity":new gn(ei.paint_raster["raster-opacity"]),"raster-hue-rotate":new gn(ei.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new gn(ei.paint_raster["raster-brightness-min"]),"raster-brightness-max":new gn(ei.paint_raster["raster-brightness-max"]),"raster-saturation":new gn(ei.paint_raster["raster-saturation"]),"raster-contrast":new gn(ei.paint_raster["raster-contrast"]),"raster-resampling":new gn(ei.paint_raster["raster-resampling"]),"raster-fade-duration":new gn(ei.paint_raster["raster-fade-duration"])})}};class Lp extends vs{constructor(h){super(h,xd)}}class bd extends vs{constructor(h){super(h,{}),this.onAdd=b=>{this.implementation.onAdd&&this.implementation.onAdd(b,b.painter.context.gl)},this.onRemove=b=>{this.implementation.onRemove&&this.implementation.onRemove(b,b.painter.context.gl)},this.implementation=h}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Bp{constructor(h){this._methodToThrottle=h,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const VA=63710088e-1;class ah{constructor(h,b){if(isNaN(h)||isNaN(b))throw new Error(`Invalid LngLat object: (${h}, ${b})`);if(this.lng=+h,this.lat=+b,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ah(Oe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(h){const b=Math.PI/180,M=this.lat*b,q=h.lat*b,K=Math.sin(M)*Math.sin(q)+Math.cos(M)*Math.cos(q)*Math.cos((h.lng-this.lng)*b);return VA*Math.acos(Math.min(K,1))}static convert(h){if(h instanceof ah)return h;if(Array.isArray(h)&&(h.length===2||h.length===3))return new ah(Number(h[0]),Number(h[1]));if(!Array.isArray(h)&&typeof h=="object"&&h!==null)return new ah(Number("lng"in h?h.lng:h.lon),Number(h.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const zp=2*Math.PI*VA;function Rp(m){return zp*Math.cos(m*Math.PI/180)}function wd(m){return(180+m)/360}function Sd(m){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+m*Math.PI/360)))/360}function Fp(m,h){return m/Rp(h)}function UA(m){return 360/Math.PI*Math.atan(Math.exp((180-360*m)*Math.PI/180))-90}class E0{constructor(h,b,M=0){this.x=+h,this.y=+b,this.z=+M}static fromLngLat(h,b=0){const M=ah.convert(h);return new E0(wd(M.lng),Sd(M.lat),Fp(b,M.lat))}toLngLat(){return new ah(360*this.x-180,UA(this.y))}toAltitude(){return this.z*Rp(UA(this.y))}meterInMercatorCoordinateUnits(){return 1/zp*(h=UA(this.y),1/Math.cos(h*Math.PI/180));var h}}function C0(m,h,b){var M=2*Math.PI*6378137/256/Math.pow(2,b);return[m*M-2*Math.PI*6378137/2,h*M-2*Math.PI*6378137/2]}class Bc{constructor(h,b,M){if(h<0||h>25||M<0||M>=Math.pow(2,h)||b<0||b>=Math.pow(2,h))throw new Error(`x=${b}, y=${M}, z=${h} outside of bounds. 0<=x<${Math.pow(2,h)}, 0<=y<${Math.pow(2,h)} 0<=z<=25 `);this.z=h,this.x=b,this.y=M,this.key=GA(0,h,h,b,M)}equals(h){return this.z===h.z&&this.x===h.x&&this.y===h.y}url(h,b,M){const q=(J=this.y,me=this.z,Ce=C0(256*(K=this.x),256*(J=Math.pow(2,me)-J-1),me),Ne=C0(256*(K+1),256*(J+1),me),Ce[0]+","+Ce[1]+","+Ne[0]+","+Ne[1]);var K,J,me,Ce,Ne;const f=function(u,p,I){let L,U="";for(let Q=u;Q>0;Q--)L=1<<Q-1,U+=(p&L?1:0)+(I&L?2:0);return U}(this.z,this.x,this.y);return h[(this.x+this.y)%h.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(M==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,b>1?"@2x":"").replace(/{quadkey}/g,f).replace(/{bbox-epsg-3857}/g,q)}isChildOf(h){const b=this.z-h.z;return b>0&&h.x===this.x>>b&&h.y===this.y>>b}getTilePoint(h){const b=Math.pow(2,this.z);return new ae((h.x*b-this.x)*$s,(h.y*b-this.y)*$s)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Id{constructor(h,b){this.wrap=h,this.canonical=b,this.key=GA(h,b.z,b.z,b.x,b.y)}}class Mu{constructor(h,b,M,q,K){if(h<M)throw new Error(`overscaledZ should be >= z; overscaledZ = ${h}; z = ${M}`);this.overscaledZ=h,this.wrap=b,this.canonical=new Bc(M,+q,+K),this.key=GA(b,h,M,q,K)}clone(){return new Mu(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(h){return this.overscaledZ===h.overscaledZ&&this.wrap===h.wrap&&this.canonical.equals(h.canonical)}scaledTo(h){if(h>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${h}; overscaledZ = ${this.overscaledZ}`);const b=this.canonical.z-h;return h>this.canonical.z?new Mu(h,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Mu(h,this.wrap,h,this.canonical.x>>b,this.canonical.y>>b)}calculateScaledKey(h,b){if(h>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${h}; overscaledZ = ${this.overscaledZ}`);const M=this.canonical.z-h;return h>this.canonical.z?GA(this.wrap*+b,h,this.canonical.z,this.canonical.x,this.canonical.y):GA(this.wrap*+b,h,h,this.canonical.x>>M,this.canonical.y>>M)}isChildOf(h){if(h.wrap!==this.wrap)return!1;const b=this.canonical.z-h.canonical.z;return h.overscaledZ===0||h.overscaledZ<this.overscaledZ&&h.canonical.x===this.canonical.x>>b&&h.canonical.y===this.canonical.y>>b}children(h){if(this.overscaledZ>=h)return[new Mu(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const b=this.canonical.z+1,M=2*this.canonical.x,q=2*this.canonical.y;return[new Mu(b,this.wrap,b,M,q),new Mu(b,this.wrap,b,M+1,q),new Mu(b,this.wrap,b,M,q+1),new Mu(b,this.wrap,b,M+1,q+1)]}isLessThan(h){return this.wrap<h.wrap||!(this.wrap>h.wrap)&&(this.overscaledZ<h.overscaledZ||!(this.overscaledZ>h.overscaledZ)&&(this.canonical.x<h.canonical.x||!(this.canonical.x>h.canonical.x)&&this.canonical.y<h.canonical.y))}wrapped(){return new Mu(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(h){return new Mu(this.overscaledZ,h,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Id(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(h){return this.canonical.getTilePoint(new E0(h.x-this.wrap,h.y))}}function GA(m,h,b,M,q){(m*=2)<0&&(m=-1*m-1);const K=1<<b;return(K*K*m+K*q+M).toString(36)+b.toString(36)+h.toString(36)}Sn("CanonicalTileID",Bc),Sn("OverscaledTileID",Mu,{omit:["posMatrix"]});class Ed{constructor(h,b,M,q=1,K=1,J=1,me=0){if(this.uid=h,b.height!==b.width)throw new RangeError("DEM tiles must be square");if(M&&!["mapbox","terrarium","custom"].includes(M))return void dt(`"${M}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=b.height;const Ce=this.dim=b.height-2;switch(this.data=new Uint32Array(b.data.buffer),M){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=q,this.greenFactor=K,this.blueFactor=J,this.baseShift=me;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let Ne=0;Ne<Ce;Ne++)this.data[this._idx(-1,Ne)]=this.data[this._idx(0,Ne)],this.data[this._idx(Ce,Ne)]=this.data[this._idx(Ce-1,Ne)],this.data[this._idx(Ne,-1)]=this.data[this._idx(Ne,0)],this.data[this._idx(Ne,Ce)]=this.data[this._idx(Ne,Ce-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(Ce,-1)]=this.data[this._idx(Ce-1,0)],this.data[this._idx(-1,Ce)]=this.data[this._idx(0,Ce-1)],this.data[this._idx(Ce,Ce)]=this.data[this._idx(Ce-1,Ce-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let Ne=0;Ne<Ce;Ne++)for(let f=0;f<Ce;f++){const u=this.get(Ne,f);u>this.max&&(this.max=u),u<this.min&&(this.min=u)}}get(h,b){const M=new Uint8Array(this.data.buffer),q=4*this._idx(h,b);return this.unpack(M[q],M[q+1],M[q+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(h,b){if(h<-1||h>=this.dim+1||b<-1||b>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(b+1)*this.stride+(h+1)}unpack(h,b,M){return h*this.redFactor+b*this.greenFactor+M*this.blueFactor-this.baseShift}getPixels(){return new Vu({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(h,b,M){if(this.dim!==h.dim)throw new Error("dem dimension mismatch");let q=b*this.dim,K=b*this.dim+this.dim,J=M*this.dim,me=M*this.dim+this.dim;switch(b){case-1:q=K-1;break;case 1:K=q+1}switch(M){case-1:J=me-1;break;case 1:me=J+1}const Ce=-b*this.dim,Ne=-M*this.dim;for(let f=J;f<me;f++)for(let u=q;u<K;u++)this.data[this._idx(u,f)]=h.data[this._idx(u+Ce,f+Ne)]}}Sn("DEMData",Ed);class Cd{constructor(h){this._stringToNumber={},this._numberToString=[];for(let b=0;b<h.length;b++){const M=h[b];this._stringToNumber[M]=b,this._numberToString[b]=M}}encode(h){return this._stringToNumber[h]}decode(h){if(h>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${h} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[h]}}class Td{constructor(h,b,M,q,K){this.type="Feature",this._vectorTileFeature=h,h._z=b,h._x=M,h._y=q,this.properties=h.properties,this.id=K}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(h){this._geometry=h}toJSON(){const h={geometry:this.geometry};for(const b in this)b!=="_geometry"&&b!=="_vectorTileFeature"&&(h[b]=this[b]);return h}}class T0{constructor(h,b){this.tileID=h,this.x=h.canonical.x,this.y=h.canonical.y,this.z=h.canonical.z,this.grid=new Dn($s,16,0),this.grid3D=new Dn($s,16,0),this.featureIndexArray=new X,this.promoteId=b}insert(h,b,M,q,K,J){const me=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(M,q,K);const Ce=J?this.grid3D:this.grid;for(let Ne=0;Ne<b.length;Ne++){const f=b[Ne],u=[1/0,1/0,-1/0,-1/0];for(let p=0;p<f.length;p++){const I=f[p];u[0]=Math.min(u[0],I.x),u[1]=Math.min(u[1],I.y),u[2]=Math.max(u[2],I.x),u[3]=Math.max(u[3],I.y)}u[0]<$s&&u[1]<$s&&u[2]>=0&&u[3]>=0&&Ce.insert(me,u[0],u[1],u[2],u[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new hc.VectorTile(new Ad(this.rawTileData)).layers,this.sourceLayerCoder=new Cd(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(h,b,M,q){this.loadVTLayers();const K=h.params||{},J=$s/h.tileSize/h.scale,me=ds(K.filter),Ce=h.queryGeometry,Ne=h.queryPadding*J,f=kd(Ce),u=this.grid.query(f.minX-Ne,f.minY-Ne,f.maxX+Ne,f.maxY+Ne),p=kd(h.cameraQueryGeometry),I=this.grid3D.query(p.minX-Ne,p.minY-Ne,p.maxX+Ne,p.maxY+Ne,(Q,re,Ae,_e)=>function(Le,qe,et,At,gt){for(const Lt of Le)if(qe<=Lt.x&&et<=Lt.y&&At>=Lt.x&&gt>=Lt.y)return!0;const Dt=[new ae(qe,et),new ae(qe,gt),new ae(At,gt),new ae(At,et)];if(Le.length>2){for(const Lt of Dt)if($c(Le,Lt))return!0}for(let Lt=0;Lt<Le.length-1;Lt++)if(_p(Le[Lt],Le[Lt+1],Dt))return!0;return!1}(h.cameraQueryGeometry,Q-Ne,re-Ne,Ae+Ne,_e+Ne));for(const Q of I)u.push(Q);u.sort(Md);const L={};let U;for(let Q=0;Q<u.length;Q++){const re=u[Q];if(re===U)continue;U=re;const Ae=this.featureIndexArray.get(re);let _e=null;this.loadMatchingFeature(L,Ae.bucketIndex,Ae.sourceLayerIndex,Ae.featureIndex,me,K.layers,K.availableImages,b,M,q,(Le,qe,et)=>(_e||(_e=il(Le)),qe.queryIntersectsFeature(Ce,Le,et,_e,this.z,h.transform,J,h.pixelPosMatrix)))}return L}loadMatchingFeature(h,b,M,q,K,J,me,Ce,Ne,f,u){const p=this.bucketLayerIDs[b];if(J&&!function(Q,re){for(let Ae=0;Ae<Q.length;Ae++)if(re.indexOf(Q[Ae])>=0)return!0;return!1}(J,p))return;const I=this.sourceLayerCoder.decode(M),L=this.vtLayers[I].feature(q);if(K.needGeometry){const Q=vl(L,!0);if(!K.filter(new ms(this.tileID.overscaledZ),Q,this.tileID.canonical))return}else if(!K.filter(new ms(this.tileID.overscaledZ),L))return;const U=this.getId(L,I);for(let Q=0;Q<p.length;Q++){const re=p[Q];if(J&&J.indexOf(re)<0)continue;const Ae=Ce[re];if(!Ae)continue;let _e={};U&&f&&(_e=f.getState(Ae.sourceLayer||"_geojsonTileLayer",U));const Le=jt({},Ne[re]);Le.paint=Df(Le.paint,Ae.paint,L,_e,me),Le.layout=Df(Le.layout,Ae.layout,L,_e,me);const qe=!u||u(L,Ae,_e);if(!qe)continue;const et=new Td(L,this.z,this.x,this.y,U);et.layer=Le;let At=h[re];At===void 0&&(At=h[re]=[]),At.push({featureIndex:q,feature:et,intersectionZ:qe})}}lookupSymbolFeatures(h,b,M,q,K,J,me,Ce){const Ne={};this.loadVTLayers();const f=ds(K);for(const u of h)this.loadMatchingFeature(Ne,M,q,u,f,J,me,Ce,b);return Ne}hasLayer(h){for(const b of this.bucketLayerIDs)for(const M of b)if(h===M)return!0;return!1}getId(h,b){let M=h.id;return this.promoteId&&(M=h.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[b]],typeof M=="boolean"&&(M=Number(M))),M}}function Df(m,h,b,M,q){return vt(m,(K,J)=>{const me=h instanceof gs?h.get(J):null;return me&&me.evaluate?me.evaluate(b,M,q):me})}function kd(m){let h=1/0,b=1/0,M=-1/0,q=-1/0;for(const K of m)h=Math.min(h,K.x),b=Math.min(b,K.y),M=Math.max(M,K.x),q=Math.max(q,K.y);return{minX:h,minY:b,maxX:M,maxY:q}}function Md(m,h){return h-m}function Pd(m,h,b,M,q){const K=[];for(let J=0;J<m.length;J++){const me=m[J];let Ce;for(let Ne=0;Ne<me.length-1;Ne++){let f=me[Ne],u=me[Ne+1];f.x<h&&u.x<h||(f.x<h?f=new ae(h,f.y+(h-f.x)/(u.x-f.x)*(u.y-f.y))._round():u.x<h&&(u=new ae(h,f.y+(h-f.x)/(u.x-f.x)*(u.y-f.y))._round()),f.y<b&&u.y<b||(f.y<b?f=new ae(f.x+(b-f.y)/(u.y-f.y)*(u.x-f.x),b)._round():u.y<b&&(u=new ae(f.x+(b-f.y)/(u.y-f.y)*(u.x-f.x),b)._round()),f.x>=M&&u.x>=M||(f.x>=M?f=new ae(M,f.y+(M-f.x)/(u.x-f.x)*(u.y-f.y))._round():u.x>=M&&(u=new ae(M,f.y+(M-f.x)/(u.x-f.x)*(u.y-f.y))._round()),f.y>=q&&u.y>=q||(f.y>=q?f=new ae(f.x+(q-f.y)/(u.y-f.y)*(u.x-f.x),q)._round():u.y>=q&&(u=new ae(f.x+(q-f.y)/(u.y-f.y)*(u.x-f.x),q)._round()),Ce&&f.equals(Ce[Ce.length-1])||(Ce=[f],K.push(Ce)),Ce.push(u)))))}}return K}Sn("FeatureIndex",T0,{omit:["rawTileData","sourceLayerCoder"]});class bl extends ae{constructor(h,b,M,q){super(h,b),this.angle=M,q!==void 0&&(this.segment=q)}clone(){return new bl(this.x,this.y,this.angle,this.segment)}}function qA(m,h,b,M,q){if(h.segment===void 0||b===0)return!0;let K=h,J=h.segment+1,me=0;for(;me>-b/2;){if(J--,J<0)return!1;me-=m[J].dist(K),K=m[J]}me+=m[J].dist(m[J+1]),J++;const Ce=[];let Ne=0;for(;me<b/2;){const f=m[J],u=m[J+1];if(!u)return!1;let p=m[J-1].angleTo(f)-f.angleTo(u);for(p=Math.abs((p+3*Math.PI)%(2*Math.PI)-Math.PI),Ce.push({distance:me,angleDelta:p}),Ne+=p;me-Ce[0].distance>M;)Ne-=Ce.shift().angleDelta;if(Ne>q)return!1;J++,me+=f.dist(u)}return!0}function k0(m){let h=0;for(let b=0;b<m.length-1;b++)h+=m[b].dist(m[b+1]);return h}function M0(m,h,b){return m?.6*h*b:0}function Dd(m,h){return Math.max(m?m.right-m.left:0,h?h.right-h.left:0)}function Op(m,h,b,M,q,K){const J=M0(b,q,K),me=Dd(b,M)*K;let Ce=0;const Ne=k0(m)/2;for(let f=0;f<m.length-1;f++){const u=m[f],p=m[f+1],I=u.dist(p);if(Ce+I>Ne){const L=(Ne-Ce)/I,U=vr.number(u.x,p.x,L),Q=vr.number(u.y,p.y,L),re=new bl(U,Q,p.angleTo(u),f);return re._round(),!J||qA(m,re,me,J,h)?re:void 0}Ce+=I}}function Np(m,h,b,M,q,K,J,me,Ce){const Ne=M0(M,K,J),f=Dd(M,q),u=f*J,p=m[0].x===0||m[0].x===Ce||m[0].y===0||m[0].y===Ce;return h-u<h/4&&(h=u+h/4),Ld(m,p?h/2*me%h:(f/2+2*K)*J*me%h,h,Ne,b,u,p,!1,Ce)}function Ld(m,h,b,M,q,K,J,me,Ce){const Ne=K/2,f=k0(m);let u=0,p=h-b,I=[];for(let L=0;L<m.length-1;L++){const U=m[L],Q=m[L+1],re=U.dist(Q),Ae=Q.angleTo(U);for(;p+b<u+re;){p+=b;const _e=(p-u)/re,Le=vr.number(U.x,Q.x,_e),qe=vr.number(U.y,Q.y,_e);if(Le>=0&&Le<Ce&&qe>=0&&qe<Ce&&p-Ne>=0&&p+Ne<=f){const et=new bl(Le,qe,Ae,L);et._round(),M&&!qA(m,et,K,M,q)||I.push(et)}}u+=re}return me||I.length||J||(I=Ld(m,u/2,b,M,q,K,J,!0,Ce)),I}Sn("Anchor",bl);const oh=fl;function Bd(m,h,b,M){const q=[],K=m.image,J=K.pixelRatio,me=K.paddedRect.w-2*oh,Ce=K.paddedRect.h-2*oh,Ne=m.right-m.left,f=m.bottom-m.top,u=K.stretchX||[[0,me]],p=K.stretchY||[[0,Ce]],I=(Rt,Kt)=>Rt+Kt[1]-Kt[0],L=u.reduce(I,0),U=p.reduce(I,0),Q=me-L,re=Ce-U;let Ae=0,_e=L,Le=0,qe=U,et=0,At=Q,gt=0,Dt=re;if(K.content&&M){const Rt=K.content;Ae=Ac(u,0,Rt[0]),Le=Ac(p,0,Rt[1]),_e=Ac(u,Rt[0],Rt[2]),qe=Ac(p,Rt[1],Rt[3]),et=Rt[0]-Ae,gt=Rt[1]-Le,At=Rt[2]-Rt[0]-_e,Dt=Rt[3]-Rt[1]-qe}const Lt=(Rt,Kt,Ht,Qt)=>{const ui=Lf(Rt.stretch-Ae,_e,Ne,m.left),yi=Bf(Rt.fixed-et,At,Rt.stretch,L),Yi=Lf(Kt.stretch-Le,qe,f,m.top),wn=Bf(Kt.fixed-gt,Dt,Kt.stretch,U),un=Lf(Ht.stretch-Ae,_e,Ne,m.left),on=Bf(Ht.fixed-et,At,Ht.stretch,L),dn=Lf(Qt.stretch-Le,qe,f,m.top),Rn=Bf(Qt.fixed-gt,Dt,Qt.stretch,U),an=new ae(ui,Yi),Xi=new ae(un,Yi),Ln=new ae(un,dn),Nn=new ae(ui,dn),pr=new ae(yi/J,wn/J),Vr=new ae(on/J,Rn/J),Hr=h*Math.PI/180;if(Hr){const ia=Math.sin(Hr),ns=Math.cos(Hr),Wn=[ns,-ia,ia,ns];an._matMult(Wn),Xi._matMult(Wn),Nn._matMult(Wn),Ln._matMult(Wn)}const Rs=Rt.stretch+Rt.fixed,Ea=Kt.stretch+Kt.fixed;return{tl:an,tr:Xi,bl:Nn,br:Ln,tex:{x:K.paddedRect.x+oh+Rs,y:K.paddedRect.y+oh+Ea,w:Ht.stretch+Ht.fixed-Rs,h:Qt.stretch+Qt.fixed-Ea},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:pr,pixelOffsetBR:Vr,minFontScaleX:At/J/Ne,minFontScaleY:Dt/J/f,isSDF:b}};if(M&&(K.stretchX||K.stretchY)){const Rt=zd(u,Q,L),Kt=zd(p,re,U);for(let Ht=0;Ht<Rt.length-1;Ht++){const Qt=Rt[Ht],ui=Rt[Ht+1];for(let yi=0;yi<Kt.length-1;yi++)q.push(Lt(Qt,Kt[yi],ui,Kt[yi+1]))}}else q.push(Lt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:me+1},{fixed:0,stretch:Ce+1}));return q}function Ac(m,h,b){let M=0;for(const q of m)M+=Math.max(h,Math.min(b,q[1]))-Math.max(h,Math.min(b,q[0]));return M}function zd(m,h,b){const M=[{fixed:-oh,stretch:0}];for(const[q,K]of m){const J=M[M.length-1];M.push({fixed:q-J.stretch,stretch:J.stretch}),M.push({fixed:q-J.stretch,stretch:J.stretch+(K-q)})}return M.push({fixed:h+oh,stretch:b}),M}function Lf(m,h,b,M){return m/h*b+M}function Bf(m,h,b,M){return m-h*b/M}class zf{constructor(h,b,M,q,K,J,me,Ce,Ne,f){if(this.boxStartIndex=h.length,Ne){let u=J.top,p=J.bottom;const I=J.collisionPadding;I&&(u-=I[1],p+=I[3]);let L=p-u;L>0&&(L=Math.max(10,L),this.circleDiameter=L)}else{let u=J.top*me-Ce[0],p=J.bottom*me+Ce[2],I=J.left*me-Ce[3],L=J.right*me+Ce[1];const U=J.collisionPadding;if(U&&(I-=U[0]*me,u-=U[1]*me,L+=U[2]*me,p+=U[3]*me),f){const Q=new ae(I,u),re=new ae(L,u),Ae=new ae(I,p),_e=new ae(L,p),Le=f*Math.PI/180;Q._rotate(Le),re._rotate(Le),Ae._rotate(Le),_e._rotate(Le),I=Math.min(Q.x,re.x,Ae.x,_e.x),L=Math.max(Q.x,re.x,Ae.x,_e.x),u=Math.min(Q.y,re.y,Ae.y,_e.y),p=Math.max(Q.y,re.y,Ae.y,_e.y)}h.emplaceBack(b.x,b.y,I,u,L,p,M,q,K)}this.boxEndIndex=h.length}}class Vm{constructor(h=[],b=Um){if(this.data=h,this.length=this.data.length,this.compare=b,this.length>0)for(let M=(this.length>>1)-1;M>=0;M--)this._down(M)}push(h){this.data.push(h),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const h=this.data[0],b=this.data.pop();return this.length--,this.length>0&&(this.data[0]=b,this._down(0)),h}peek(){return this.data[0]}_up(h){const{data:b,compare:M}=this,q=b[h];for(;h>0;){const K=h-1>>1,J=b[K];if(M(q,J)>=0)break;b[h]=J,h=K}b[h]=q}_down(h){const{data:b,compare:M}=this,q=this.length>>1,K=b[h];for(;h<q;){let J=1+(h<<1),me=b[J];const Ce=J+1;if(Ce<this.length&&M(b[Ce],me)<0&&(J=Ce,me=b[Ce]),M(me,K)>=0)break;b[h]=me,h=J}b[h]=K}}function Um(m,h){return m<h?-1:m>h?1:0}function Vp(m,h=1,b=!1){let M=1/0,q=1/0,K=-1/0,J=-1/0;const me=m[0];for(let I=0;I<me.length;I++){const L=me[I];(!I||L.x<M)&&(M=L.x),(!I||L.y<q)&&(q=L.y),(!I||L.x>K)&&(K=L.x),(!I||L.y>J)&&(J=L.y)}const Ce=Math.min(K-M,J-q);let Ne=Ce/2;const f=new Vm([],HA);if(Ce===0)return new ae(M,q);for(let I=M;I<K;I+=Ce)for(let L=q;L<J;L+=Ce)f.push(new iA(I+Ne,L+Ne,Ne,m));let u=function(I){let L=0,U=0,Q=0;const re=I[0];for(let Ae=0,_e=re.length,Le=_e-1;Ae<_e;Le=Ae++){const qe=re[Ae],et=re[Le],At=qe.x*et.y-et.x*qe.y;U+=(qe.x+et.x)*At,Q+=(qe.y+et.y)*At,L+=3*At}return new iA(U/L,Q/L,0,I)}(m),p=f.length;for(;f.length;){const I=f.pop();(I.d>u.d||!u.d)&&(u=I,b&&console.log("found best %d after %d probes",Math.round(1e4*I.d)/1e4,p)),I.max-u.d<=h||(Ne=I.h/2,f.push(new iA(I.p.x-Ne,I.p.y-Ne,Ne,m)),f.push(new iA(I.p.x+Ne,I.p.y-Ne,Ne,m)),f.push(new iA(I.p.x-Ne,I.p.y+Ne,Ne,m)),f.push(new iA(I.p.x+Ne,I.p.y+Ne,Ne,m)),p+=4)}return b&&(console.log(`num probes: ${p}`),console.log(`best distance: ${u.d}`)),u.p}function HA(m,h){return h.max-m.max}function iA(m,h,b,M){this.p=new ae(m,h),this.h=b,this.d=function(q,K){let J=!1,me=1/0;for(let Ce=0;Ce<K.length;Ce++){const Ne=K[Ce];for(let f=0,u=Ne.length,p=u-1;f<u;p=f++){const I=Ne[f],L=Ne[p];I.y>q.y!=L.y>q.y&&q.x<(L.x-I.x)*(q.y-I.y)/(L.y-I.y)+I.x&&(J=!J),me=Math.min(me,Gh(q,I,L))}}return(J?1:-1)*Math.sqrt(me)}(this.p,M),this.max=this.d+this.h*Math.SQRT2}var Bo;S.ap=void 0,(Bo=S.ap||(S.ap={}))[Bo.center=1]="center",Bo[Bo.left=2]="left",Bo[Bo.right=3]="right",Bo[Bo.top=4]="top",Bo[Bo.bottom=5]="bottom",Bo[Bo["top-left"]=6]="top-left",Bo[Bo["top-right"]=7]="top-right",Bo[Bo["bottom-left"]=8]="bottom-left",Bo[Bo["bottom-right"]=9]="bottom-right";const lh=7,nA=Number.POSITIVE_INFINITY;function jA(m,h){return h[1]!==nA?function(b,M,q){let K=0,J=0;switch(M=Math.abs(M),q=Math.abs(q),b){case"top-right":case"top-left":case"top":J=q-lh;break;case"bottom-right":case"bottom-left":case"bottom":J=-q+lh}switch(b){case"top-right":case"bottom-right":case"right":K=-M;break;case"top-left":case"bottom-left":case"left":K=M}return[K,J]}(m,h[0],h[1]):function(b,M){let q=0,K=0;M<0&&(M=0);const J=M/Math.SQRT2;switch(b){case"top-right":case"top-left":K=J-lh;break;case"bottom-right":case"bottom-left":K=-J+lh;break;case"bottom":K=-M+lh;break;case"top":K=M-lh}switch(b){case"top-right":case"bottom-right":q=-J;break;case"top-left":case"bottom-left":q=J;break;case"left":q=M;break;case"right":q=-M}return[q,K]}(m,h[0])}function rA(m,h,b){var M;const q=m.layout,K=(M=q.get("text-variable-anchor-offset"))===null||M===void 0?void 0:M.evaluate(h,{},b);if(K){const me=K.values,Ce=[];for(let Ne=0;Ne<me.length;Ne+=2){const f=Ce[Ne]=me[Ne],u=me[Ne+1].map(p=>p*Al);f.startsWith("top")?u[1]-=lh:f.startsWith("bottom")&&(u[1]+=lh),Ce[Ne+1]=u}return new Wt(Ce)}const J=q.get("text-variable-anchor");if(J){let me;me=m._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[q.get("text-radial-offset").evaluate(h,{},b)*Al,nA]:q.get("text-offset").evaluate(h,{},b).map(Ne=>Ne*Al);const Ce=[];for(const Ne of J)Ce.push(Ne,jA(Ne,me));return new Wt(Ce)}return null}function P0(m){switch(m){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Up(m,h,b,M,q,K,J,me,Ce,Ne,f){let u=K.textMaxSize.evaluate(h,{});u===void 0&&(u=J);const p=m.layers[0].layout,I=p.get("icon-offset").evaluate(h,{},f),L=Fd(b.horizontal),U=J/24,Q=m.tilePixelRatio*U,re=m.tilePixelRatio*u/24,Ae=m.tilePixelRatio*me,_e=m.tilePixelRatio*p.get("symbol-spacing"),Le=p.get("text-padding")*m.tilePixelRatio,qe=function(Qt,ui,yi,Yi=1){const wn=Qt.get("icon-padding").evaluate(ui,{},yi),un=wn&&wn.values;return[un[0]*Yi,un[1]*Yi,un[2]*Yi,un[3]*Yi]}(p,h,f,m.tilePixelRatio),et=p.get("text-max-angle")/180*Math.PI,At=p.get("text-rotation-alignment")!=="viewport"&&p.get("symbol-placement")!=="point",gt=p.get("icon-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point",Dt=p.get("symbol-placement"),Lt=_e/2,Rt=p.get("icon-text-fit");let Kt;M&&Rt!=="none"&&(m.allowVerticalPlacement&&b.vertical&&(Kt=pd(M,b.vertical,Rt,p.get("icon-text-fit-padding"),I,U)),L&&(M=pd(M,L,Rt,p.get("icon-text-fit-padding"),I,U)));const Ht=(Qt,ui)=>{ui.x<0||ui.x>=$s||ui.y<0||ui.y>=$s||function(yi,Yi,wn,un,on,dn,Rn,an,Xi,Ln,Nn,pr,Vr,Hr,Rs,Ea,ia,ns,Wn,ws,ir,na,Ps,Kn,La){const Ja=yi.addToLineVertexArray(Yi,wn);let va,qo,uo,ra,br=0,wo=0,nl=0,rl=0,Pu=-1,Uu=-1;const zl={};let Rc=er("");if(yi.allowVerticalPlacement&&un.vertical){const eu=an.layout.get("text-rotate").evaluate(ir,{},Kn)+90;uo=new zf(Xi,Yi,Ln,Nn,pr,un.vertical,Vr,Hr,Rs,eu),Rn&&(ra=new zf(Xi,Yi,Ln,Nn,pr,Rn,ia,ns,Rs,eu))}if(on){const eu=an.layout.get("icon-rotate").evaluate(ir,{}),Hu=an.layout.get("icon-text-fit")!=="none",Ph=Bd(on,eu,Ps,Hu),fc=Rn?Bd(Rn,eu,Ps,Hu):void 0;qo=new zf(Xi,Yi,Ln,Nn,pr,on,ia,ns,!1,eu),br=4*Ph.length;const tu=yi.iconSizeData;let ju=null;tu.kind==="source"?(ju=[Dc*an.layout.get("icon-size").evaluate(ir,{})],ju[0]>rh&&dt(`${yi.layerIds[0]}: Value for "icon-size" is >= ${kh}. Reduce your "icon-size".`)):tu.kind==="composite"&&(ju=[Dc*na.compositeIconSizes[0].evaluate(ir,{},Kn),Dc*na.compositeIconSizes[1].evaluate(ir,{},Kn)],(ju[0]>rh||ju[1]>rh)&&dt(`${yi.layerIds[0]}: Value for "icon-size" is >= ${kh}. Reduce your "icon-size".`)),yi.addSymbols(yi.icon,Ph,ju,ws,Wn,ir,S.ah.none,Yi,Ja.lineStartIndex,Ja.lineLength,-1,Kn),Pu=yi.icon.placedSymbolArray.length-1,fc&&(wo=4*fc.length,yi.addSymbols(yi.icon,fc,ju,ws,Wn,ir,S.ah.vertical,Yi,Ja.lineStartIndex,Ja.lineLength,-1,Kn),Uu=yi.icon.placedSymbolArray.length-1)}const Gu=Object.keys(un.horizontal);for(const eu of Gu){const Hu=un.horizontal[eu];if(!va){Rc=er(Hu.text);const fc=an.layout.get("text-rotate").evaluate(ir,{},Kn);va=new zf(Xi,Yi,Ln,Nn,pr,Hu,Vr,Hr,Rs,fc)}const Ph=Hu.positionedLines.length===1;if(nl+=Rd(yi,Yi,Hu,dn,an,Rs,ir,Ea,Ja,un.vertical?S.ah.horizontal:S.ah.horizontalOnly,Ph?Gu:[eu],zl,Pu,na,Kn),Ph)break}un.vertical&&(rl+=Rd(yi,Yi,un.vertical,dn,an,Rs,ir,Ea,Ja,S.ah.vertical,["vertical"],zl,Uu,na,Kn));const qu=va?va.boxStartIndex:yi.collisionBoxArray.length,Jl=va?va.boxEndIndex:yi.collisionBoxArray.length,uh=uo?uo.boxStartIndex:yi.collisionBoxArray.length,sA=uo?uo.boxEndIndex:yi.collisionBoxArray.length,qp=qo?qo.boxStartIndex:yi.collisionBoxArray.length,Od=qo?qo.boxEndIndex:yi.collisionBoxArray.length,Nd=ra?ra.boxStartIndex:yi.collisionBoxArray.length,co=ra?ra.boxEndIndex:yi.collisionBoxArray.length;let So=-1;const Gf=(eu,Hu)=>eu&&eu.circleDiameter?Math.max(eu.circleDiameter,Hu):Hu;So=Gf(va,So),So=Gf(uo,So),So=Gf(qo,So),So=Gf(ra,So);const Hp=So>-1?1:0;Hp&&(So*=La/Al),yi.glyphOffsetArray.length>=tA.MAX_GLYPHS&&dt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ir.sortKey!==void 0&&yi.addToSortKeyRanges(yi.symbolInstances.length,ir.sortKey);const Gm=rA(an,ir,Kn),[jp,qm]=function(eu,Hu){const Ph=eu.length,fc=Hu==null?void 0:Hu.values;if((fc==null?void 0:fc.length)>0)for(let tu=0;tu<fc.length;tu+=2){const ju=fc[tu+1];eu.emplaceBack(S.ap[fc[tu]],ju[0],ju[1])}return[Ph,eu.length]}(yi.textAnchorOffsets,Gm);yi.symbolInstances.emplaceBack(Yi.x,Yi.y,zl.right>=0?zl.right:-1,zl.center>=0?zl.center:-1,zl.left>=0?zl.left:-1,zl.vertical||-1,Pu,Uu,Rc,qu,Jl,uh,sA,qp,Od,Nd,co,Ln,nl,rl,br,wo,Hp,0,Vr,So,jp,qm)}(m,ui,Qt,b,M,q,Kt,m.layers[0],m.collisionBoxArray,h.index,h.sourceLayerIndex,m.index,Q,[Le,Le,Le,Le],At,Ce,Ae,qe,gt,I,h,K,Ne,f,J)};if(Dt==="line")for(const Qt of Pd(h.geometry,0,0,$s,$s)){const ui=Np(Qt,_e,et,b.vertical||L,M,24,re,m.overscaling,$s);for(const yi of ui)L&&ZA(m,L.text,Lt,yi)||Ht(Qt,yi)}else if(Dt==="line-center"){for(const Qt of h.geometry)if(Qt.length>1){const ui=Op(Qt,et,b.vertical||L,M,24,re);ui&&Ht(Qt,ui)}}else if(h.type==="Polygon")for(const Qt of wh(h.geometry,0)){const ui=Vp(Qt,16);Ht(Qt[0],new bl(ui.x,ui.y,0))}else if(h.type==="LineString")for(const Qt of h.geometry)Ht(Qt,new bl(Qt[0].x,Qt[0].y,0));else if(h.type==="Point")for(const Qt of h.geometry)for(const ui of Qt)Ht([ui],new bl(ui.x,ui.y,0))}function Rd(m,h,b,M,q,K,J,me,Ce,Ne,f,u,p,I,L){const U=function(Ae,_e,Le,qe,et,At,gt,Dt){const Lt=qe.layout.get("text-rotate").evaluate(At,{})*Math.PI/180,Rt=[];for(const Kt of _e.positionedLines)for(const Ht of Kt.positionedGlyphs){if(!Ht.rect)continue;const Qt=Ht.rect||{};let ui=dd+1,yi=!0,Yi=1,wn=0;const un=(et||Dt)&&Ht.vertical,on=Ht.metrics.advance*Ht.scale/2;if(Dt&&_e.verticalizable&&(wn=Kt.lineOffset/2-(Ht.imageName?-(Al-Ht.metrics.width*Ht.scale)/2:(Ht.scale-1)*Al)),Ht.imageName){const ws=gt[Ht.imageName];yi=ws.sdf,Yi=ws.pixelRatio,ui=fl/Yi}const dn=et?[Ht.x+on,Ht.y]:[0,0];let Rn=et?[0,0]:[Ht.x+on+Le[0],Ht.y+Le[1]-wn],an=[0,0];un&&(an=Rn,Rn=[0,0]);const Xi=Ht.metrics.isDoubleResolution?2:1,Ln=(Ht.metrics.left-ui)*Ht.scale-on+Rn[0],Nn=(-Ht.metrics.top-ui)*Ht.scale+Rn[1],pr=Ln+Qt.w/Xi*Ht.scale/Yi,Vr=Nn+Qt.h/Xi*Ht.scale/Yi,Hr=new ae(Ln,Nn),Rs=new ae(pr,Nn),Ea=new ae(Ln,Vr),ia=new ae(pr,Vr);if(un){const ws=new ae(-on,on-BA),ir=-Math.PI/2,na=Al/2-on,Ps=new ae(5-BA-na,-(Ht.imageName?na:0)),Kn=new ae(...an);Hr._rotateAround(ir,ws)._add(Ps)._add(Kn),Rs._rotateAround(ir,ws)._add(Ps)._add(Kn),Ea._rotateAround(ir,ws)._add(Ps)._add(Kn),ia._rotateAround(ir,ws)._add(Ps)._add(Kn)}if(Lt){const ws=Math.sin(Lt),ir=Math.cos(Lt),na=[ir,-ws,ws,ir];Hr._matMult(na),Rs._matMult(na),Ea._matMult(na),ia._matMult(na)}const ns=new ae(0,0),Wn=new ae(0,0);Rt.push({tl:Hr,tr:Rs,bl:Ea,br:ia,tex:Qt,writingMode:_e.writingMode,glyphOffset:dn,sectionIndex:Ht.sectionIndex,isSDF:yi,pixelOffsetTL:ns,pixelOffsetBR:Wn,minFontScaleX:0,minFontScaleY:0})}return Rt}(0,b,me,q,K,J,M,m.allowVerticalPlacement),Q=m.textSizeData;let re=null;Q.kind==="source"?(re=[Dc*q.layout.get("text-size").evaluate(J,{})],re[0]>rh&&dt(`${m.layerIds[0]}: Value for "text-size" is >= ${kh}. Reduce your "text-size".`)):Q.kind==="composite"&&(re=[Dc*I.compositeTextSizes[0].evaluate(J,{},L),Dc*I.compositeTextSizes[1].evaluate(J,{},L)],(re[0]>rh||re[1]>rh)&&dt(`${m.layerIds[0]}: Value for "text-size" is >= ${kh}. Reduce your "text-size".`)),m.addSymbols(m.text,U,re,me,K,J,Ne,h,Ce.lineStartIndex,Ce.lineLength,p,L);for(const Ae of f)u[Ae]=m.text.placedSymbolArray.length-1;return 4*U.length}function Fd(m){for(const h in m)return m[h];return null}function ZA(m,h,b,M){const q=m.compareText;if(h in q){const K=q[h];for(let J=K.length-1;J>=0;J--)if(M.dist(K[J])<b)return!0}else q[h]=[];return q[h].push(M),!1}const Bl=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class zc{static from(h){if(!(h instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[b,M]=new Uint8Array(h,0,2);if(b!==219)throw new Error("Data does not appear to be in a KDBush format.");const q=M>>4;if(q!==1)throw new Error(`Got v${q} data when expected v1.`);const K=Bl[15&M];if(!K)throw new Error("Unrecognized array type.");const[J]=new Uint16Array(h,2,1),[me]=new Uint32Array(h,4,1);return new zc(me,J,K,h)}constructor(h,b=64,M=Float64Array,q){if(isNaN(h)||h<0)throw new Error(`Unpexpected numItems value: ${h}.`);this.numItems=+h,this.nodeSize=Math.min(Math.max(+b,2),65535),this.ArrayType=M,this.IndexArrayType=h<65536?Uint16Array:Uint32Array;const K=Bl.indexOf(this.ArrayType),J=2*h*this.ArrayType.BYTES_PER_ELEMENT,me=h*this.IndexArrayType.BYTES_PER_ELEMENT,Ce=(8-me%8)%8;if(K<0)throw new Error(`Unexpected typed array class: ${M}.`);q&&q instanceof ArrayBuffer?(this.data=q,this.ids=new this.IndexArrayType(this.data,8,h),this.coords=new this.ArrayType(this.data,8+me+Ce,2*h),this._pos=2*h,this._finished=!0):(this.data=new ArrayBuffer(8+J+me+Ce),this.ids=new this.IndexArrayType(this.data,8,h),this.coords=new this.ArrayType(this.data,8+me+Ce,2*h),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+K]),new Uint16Array(this.data,2,1)[0]=b,new Uint32Array(this.data,4,1)[0]=h)}add(h,b){const M=this._pos>>1;return this.ids[M]=M,this.coords[this._pos++]=h,this.coords[this._pos++]=b,M}finish(){const h=this._pos>>1;if(h!==this.numItems)throw new Error(`Added ${h} items when expected ${this.numItems}.`);return Mh(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(h,b,M,q){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:K,coords:J,nodeSize:me}=this,Ce=[0,K.length-1,0],Ne=[];for(;Ce.length;){const f=Ce.pop()||0,u=Ce.pop()||0,p=Ce.pop()||0;if(u-p<=me){for(let Q=p;Q<=u;Q++){const re=J[2*Q],Ae=J[2*Q+1];re>=h&&re<=M&&Ae>=b&&Ae<=q&&Ne.push(K[Q])}continue}const I=p+u>>1,L=J[2*I],U=J[2*I+1];L>=h&&L<=M&&U>=b&&U<=q&&Ne.push(K[I]),(f===0?h<=L:b<=U)&&(Ce.push(p),Ce.push(I-1),Ce.push(1-f)),(f===0?M>=L:q>=U)&&(Ce.push(I+1),Ce.push(u),Ce.push(1-f))}return Ne}within(h,b,M){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:q,coords:K,nodeSize:J}=this,me=[0,q.length-1,0],Ce=[],Ne=M*M;for(;me.length;){const f=me.pop()||0,u=me.pop()||0,p=me.pop()||0;if(u-p<=J){for(let Q=p;Q<=u;Q++)D0(K[2*Q],K[2*Q+1],h,b)<=Ne&&Ce.push(q[Q]);continue}const I=p+u>>1,L=K[2*I],U=K[2*I+1];D0(L,U,h,b)<=Ne&&Ce.push(q[I]),(f===0?h-M<=L:b-M<=U)&&(me.push(p),me.push(I-1),me.push(1-f)),(f===0?h+M>=L:b+M>=U)&&(me.push(I+1),me.push(u),me.push(1-f))}return Ce}}function Mh(m,h,b,M,q,K){if(q-M<=b)return;const J=M+q>>1;QA(m,h,J,M,q,K),Mh(m,h,b,M,J-1,1-K),Mh(m,h,b,J+1,q,1-K)}function QA(m,h,b,M,q,K){for(;q>M;){if(q-M>600){const Ne=q-M+1,f=b-M+1,u=Math.log(Ne),p=.5*Math.exp(2*u/3),I=.5*Math.sqrt(u*p*(Ne-p)/Ne)*(f-Ne/2<0?-1:1);QA(m,h,b,Math.max(M,Math.floor(b-f*p/Ne+I)),Math.min(q,Math.floor(b+(Ne-f)*p/Ne+I)),K)}const J=h[2*b+K];let me=M,Ce=q;for(WA(m,h,M,b),h[2*q+K]>J&&WA(m,h,M,q);me<Ce;){for(WA(m,h,me,Ce),me++,Ce--;h[2*me+K]<J;)me++;for(;h[2*Ce+K]>J;)Ce--}h[2*M+K]===J?WA(m,h,M,Ce):(Ce++,WA(m,h,Ce,q)),Ce<=b&&(M=Ce+1),b<=Ce&&(q=Ce-1)}}function WA(m,h,b,M){Rf(m,b,M),Rf(h,2*b,2*M),Rf(h,2*b+1,2*M+1)}function Rf(m,h,b){const M=m[h];m[h]=m[b],m[b]=M}function D0(m,h,b,M){const q=m-b,K=h-M;return q*q+K*K}var Ff;S.bc=void 0,(Ff=S.bc||(S.bc={})).create="create",Ff.load="load",Ff.fullLoad="fullLoad";let Of=null,Nf=[];const L0=1e3/60,Vf="loadTime",Uf="fullLoadTime",Gp={mark(m){performance.mark(m)},frame(m){const h=m;Of!=null&&Nf.push(h-Of),Of=h},clearMetrics(){Of=null,Nf=[],performance.clearMeasures(Vf),performance.clearMeasures(Uf);for(const m in S.bc)performance.clearMarks(S.bc[m])},getPerformanceMetrics(){performance.measure(Vf,S.bc.create,S.bc.load),performance.measure(Uf,S.bc.create,S.bc.fullLoad);const m=performance.getEntriesByName(Vf)[0].duration,h=performance.getEntriesByName(Uf)[0].duration,b=Nf.length,M=1/(Nf.reduce((K,J)=>K+J,0)/b/1e3),q=Nf.filter(K=>K>L0).reduce((K,J)=>K+(J-L0)/L0,0);return{loadTime:m,fullLoadTime:h,fps:M,percentDroppedFrames:q/(b+q)*100,totalFrames:b}}};S.$=Wi,S.A=Xu,S.B=function(m){if(Nt==null){const h=m.navigator?m.navigator.userAgent:null;Nt=!!m.safari||!(!h||!(/\b(iPad|iPhone|iPod)\b/.test(h)||h.match("Safari")&&!h.match("Chrome")))}return Nt},S.C=class{constructor(m,h){this.target=m,this.mapId=h,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Bp(()=>this.process()),this.subscription=function(b,M,q,K){return b.addEventListener(M,q,!1),{unsubscribe:()=>{b.removeEventListener(M,q,!1)}}}(this.target,"message",b=>this.receive(b)),this.globalScope=lt(self)?m:window}registerMessageHandler(m,h){this.messageHandlers[m]=h}sendAsync(m,h){return new Promise((b,M)=>{const q=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[q]={resolve:b,reject:M},h&&h.signal.addEventListener("abort",()=>{delete this.resolveRejects[q];const me={id:q,type:"<cancel>",origin:location.origin,targetMapId:m.targetMapId,sourceMapId:this.mapId};this.target.postMessage(me)},{once:!0});const K=[],J=Object.assign(Object.assign({},m),{id:q,sourceMapId:this.mapId,origin:location.origin,data:Nl(m.data,K)});this.target.postMessage(J,{transfer:K})})}receive(m){const h=m.data,b=h.id;if(!(h.origin!=="file://"&&location.origin!=="file://"&&h.origin!==location.origin||h.targetMapId&&this.mapId!==h.targetMapId)){if(h.type==="<cancel>"){delete this.tasks[b];const M=this.abortControllers[b];return delete this.abortControllers[b],void(M&&M.abort())}if(lt(self)||h.mustQueue)return this.tasks[b]=h,this.taskQueue.push(b),void this.invoker.trigger();this.processTask(b,h)}}process(){if(this.taskQueue.length===0)return;const m=this.taskQueue.shift(),h=this.tasks[m];delete this.tasks[m],this.taskQueue.length>0&&this.invoker.trigger(),h&&this.processTask(m,h)}processTask(m,h){return a(this,void 0,void 0,function*(){if(h.type==="<response>"){const q=this.resolveRejects[m];return delete this.resolveRejects[m],q?void(h.error?q.reject(En(h.error)):q.resolve(En(h.data))):void 0}if(!this.messageHandlers[h.type])return void this.completeTask(m,new Error(`Could not find a registered handler for ${h.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const b=En(h.data),M=new AbortController;this.abortControllers[m]=M;try{const q=yield this.messageHandlers[h.type](h.sourceMapId,b,M);this.completeTask(m,null,q)}catch(q){this.completeTask(m,q)}})}completeTask(m,h,b){const M=[];delete this.abortControllers[m];const q={id:m,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:h?Nl(h):null,data:Nl(b,M)};this.target.postMessage(q,{transfer:M})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},S.D=gn,S.E=sn,S.F=function(){var m=new Xu(16);return Xu!=Float32Array&&(m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[11]=0,m[12]=0,m[13]=0,m[14]=0),m[0]=1,m[5]=1,m[10]=1,m[15]=1,m},S.G=nn,S.H=function(m,h,b){var M,q,K,J,me,Ce,Ne,f,u,p,I,L,U=b[0],Q=b[1],re=b[2];return h===m?(m[12]=h[0]*U+h[4]*Q+h[8]*re+h[12],m[13]=h[1]*U+h[5]*Q+h[9]*re+h[13],m[14]=h[2]*U+h[6]*Q+h[10]*re+h[14],m[15]=h[3]*U+h[7]*Q+h[11]*re+h[15]):(q=h[1],K=h[2],J=h[3],me=h[4],Ce=h[5],Ne=h[6],f=h[7],u=h[8],p=h[9],I=h[10],L=h[11],m[0]=M=h[0],m[1]=q,m[2]=K,m[3]=J,m[4]=me,m[5]=Ce,m[6]=Ne,m[7]=f,m[8]=u,m[9]=p,m[10]=I,m[11]=L,m[12]=M*U+me*Q+u*re+h[12],m[13]=q*U+Ce*Q+p*re+h[13],m[14]=K*U+Ne*Q+I*re+h[14],m[15]=J*U+f*Q+L*re+h[15]),m},S.I=y0,S.J=function(m,h,b){var M=b[0],q=b[1],K=b[2];return m[0]=h[0]*M,m[1]=h[1]*M,m[2]=h[2]*M,m[3]=h[3]*M,m[4]=h[4]*q,m[5]=h[5]*q,m[6]=h[6]*q,m[7]=h[7]*q,m[8]=h[8]*K,m[9]=h[9]*K,m[10]=h[10]*K,m[11]=h[11]*K,m[12]=h[12],m[13]=h[13],m[14]=h[14],m[15]=h[15],m},S.K=vh,S.L=function(m,h){const b={};for(let M=0;M<h.length;M++){const q=h[M];q in m&&(b[q]=m[q])}return b},S.M=ah,S.N=wd,S.O=Sd,S.P=ae,S.Q=Mu,S.R=Vu,S.S=at,S.T=_u,S.U=ut,S.V=gi,S.W=$s,S.X=xs,S.Y=E0,S.Z=class extends hl{},S._=a,S.a=ji,S.a$=function(m,h){return m[0]*h[0]+m[1]*h[1]+m[2]*h[2]+m[3]*h[3]},S.a0=Bc,S.a1=Y,S.a2=m=>{const h=window.document.createElement("video");return h.muted=!0,new Promise(b=>{h.onloadstart=()=>{b(h)};for(const M of m){const q=window.document.createElement("source");Ri(M)||(h.crossOrigin="Anonymous"),q.src=M,h.appendChild(q)}})},S.a3=function(){return it++},S.a4=s,S.a5=tA,S.a6=ds,S.a7=vl,S.a8=ms,S.a9=Td,S.aA=Et,S.aB=function(m,h){if(!m)return[{command:"setStyle",args:[h]}];let b=[];try{if(!ci(m.version,h.version))return[{command:"setStyle",args:[h]}];ci(m.center,h.center)||b.push({command:"setCenter",args:[h.center]}),ci(m.zoom,h.zoom)||b.push({command:"setZoom",args:[h.zoom]}),ci(m.bearing,h.bearing)||b.push({command:"setBearing",args:[h.bearing]}),ci(m.pitch,h.pitch)||b.push({command:"setPitch",args:[h.pitch]}),ci(m.sprite,h.sprite)||b.push({command:"setSprite",args:[h.sprite]}),ci(m.glyphs,h.glyphs)||b.push({command:"setGlyphs",args:[h.glyphs]}),ci(m.transition,h.transition)||b.push({command:"setTransition",args:[h.transition]}),ci(m.light,h.light)||b.push({command:"setLight",args:[h.light]}),ci(m.terrain,h.terrain)||b.push({command:"setTerrain",args:[h.terrain]}),ci(m.sky,h.sky)||b.push({command:"setSky",args:[h.sky]});const M={},q=[];(function(J,me,Ce,Ne){let f;for(f in me=me||{},J=J||{})Object.prototype.hasOwnProperty.call(J,f)&&(Object.prototype.hasOwnProperty.call(me,f)||Pn(f,Ce,Ne));for(f in me)Object.prototype.hasOwnProperty.call(me,f)&&(Object.prototype.hasOwnProperty.call(J,f)?ci(J[f],me[f])||(J[f].type==="geojson"&&me[f].type==="geojson"&&In(J,me,f)?rn(Ce,{command:"setGeoJSONSourceData",args:[f,me[f].data]}):Qn(f,me,Ce,Ne)):tr(f,me,Ce))})(m.sources,h.sources,q,M);const K=[];m.layers&&m.layers.forEach(J=>{"source"in J&&M[J.source]?b.push({command:"removeLayer",args:[J.id]}):K.push(J)}),b=b.concat(q),function(J,me,Ce){me=me||[];const Ne=(J=J||[]).map(k),f=me.map(k),u=J.reduce(V,{}),p=me.reduce(V,{}),I=Ne.slice(),L=Object.create(null);let U,Q,re,Ae,_e;for(let Le=0,qe=0;Le<Ne.length;Le++)U=Ne[Le],Object.prototype.hasOwnProperty.call(p,U)?qe++:(rn(Ce,{command:"removeLayer",args:[U]}),I.splice(I.indexOf(U,qe),1));for(let Le=0,qe=0;Le<f.length;Le++)U=f[f.length-1-Le],I[I.length-1-Le]!==U&&(Object.prototype.hasOwnProperty.call(u,U)?(rn(Ce,{command:"removeLayer",args:[U]}),I.splice(I.lastIndexOf(U,I.length-qe),1)):qe++,Ae=I[I.length-Le],rn(Ce,{command:"addLayer",args:[p[U],Ae]}),I.splice(I.length-Le,0,U),L[U]=!0);for(let Le=0;Le<f.length;Le++)if(U=f[Le],Q=u[U],re=p[U],!L[U]&&!ci(Q,re))if(ci(Q.source,re.source)&&ci(Q["source-layer"],re["source-layer"])&&ci(Q.type,re.type)){for(_e in v(Q.layout,re.layout,Ce,U,null,"setLayoutProperty"),v(Q.paint,re.paint,Ce,U,null,"setPaintProperty"),ci(Q.filter,re.filter)||rn(Ce,{command:"setFilter",args:[U,re.filter]}),ci(Q.minzoom,re.minzoom)&&ci(Q.maxzoom,re.maxzoom)||rn(Ce,{command:"setLayerZoomRange",args:[U,re.minzoom,re.maxzoom]}),Q)Object.prototype.hasOwnProperty.call(Q,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?v(Q[_e],re[_e],Ce,U,_e.slice(6),"setPaintProperty"):ci(Q[_e],re[_e])||rn(Ce,{command:"setLayerProperty",args:[U,_e,re[_e]]}));for(_e in re)Object.prototype.hasOwnProperty.call(re,_e)&&!Object.prototype.hasOwnProperty.call(Q,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?v(Q[_e],re[_e],Ce,U,_e.slice(6),"setPaintProperty"):ci(Q[_e],re[_e])||rn(Ce,{command:"setLayerProperty",args:[U,_e,re[_e]]}))}else rn(Ce,{command:"removeLayer",args:[U]}),Ae=I[I.lastIndexOf(U)+1],rn(Ce,{command:"addLayer",args:[re,Ae]})}(K,h.layers,b)}catch(M){console.warn("Unable to compute style diff:",M),b=[{command:"setStyle",args:[h]}]}return b},S.aC=function(m){const h=[],b=m.id;return b===void 0&&h.push({message:`layers.${b}: missing required property "id"`}),m.render===void 0&&h.push({message:`layers.${b}: missing required method "render"`}),m.renderingMode&&m.renderingMode!=="2d"&&m.renderingMode!=="3d"&&h.push({message:`layers.${b}: property "renderingMode" must be either "2d" or "3d"`}),h},S.aD=function m(h,b){if(Array.isArray(h)){if(!Array.isArray(b)||h.length!==b.length)return!1;for(let M=0;M<h.length;M++)if(!m(h[M],b[M]))return!1;return!0}if(typeof h=="object"&&h!==null&&b!==null){if(typeof b!="object"||Object.keys(h).length!==Object.keys(b).length)return!1;for(const M in h)if(!m(h[M],b[M]))return!1;return!0}return h===b},S.aE=vt,S.aF=mt,S.aG=class extends lo{constructor(m,h){super(m,h),this.current=0}set(m){this.current!==m&&(this.current=m,this.gl.uniform1i(this.location,m))}},S.aH=qr,S.aI=class extends lo{constructor(m,h){super(m,h),this.current=bo}set(m){if(m[12]!==this.current[12]||m[0]!==this.current[0])return this.current=m,void this.gl.uniformMatrix4fv(this.location,!1,m);for(let h=1;h<16;h++)if(m[h]!==this.current[h]){this.current=m,this.gl.uniformMatrix4fv(this.location,!1,m);break}}},S.aJ=ya,S.aK=class extends lo{constructor(m,h){super(m,h),this.current=[0,0,0]}set(m){m[0]===this.current[0]&&m[1]===this.current[1]&&m[2]===this.current[2]||(this.current=m,this.gl.uniform3f(this.location,m[0],m[1],m[2]))}},S.aL=class extends lo{constructor(m,h){super(m,h),this.current=[0,0]}set(m){m[0]===this.current[0]&&m[1]===this.current[1]||(this.current=m,this.gl.uniform2f(this.location,m[0],m[1]))}},S.aM=xo,S.aN=function(m,h,b,M,q,K,J){var me=1/(h-b),Ce=1/(M-q),Ne=1/(K-J);return m[0]=-2*me,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=-2*Ce,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=2*Ne,m[11]=0,m[12]=(h+b)*me,m[13]=(q+M)*Ce,m[14]=(J+K)*Ne,m[15]=1,m},S.aO=mn,S.aP=mA,S.aQ=class extends $e{},S.aR=sd,S.aS=class extends Ct{},S.aT=function(m){return m<=1?1:Math.pow(2,Math.ceil(Math.log(m)/Math.LN2))},S.aU=_A,S.aV=ce,S.aW=class extends F{},S.aX=Xt,S.aY=function(m,h){var b=m[0],M=m[1],q=m[2],K=m[3],J=m[4],me=m[5],Ce=m[6],Ne=m[7],f=m[8],u=m[9],p=m[10],I=m[11],L=m[12],U=m[13],Q=m[14],re=m[15],Ae=h[0],_e=h[1],Le=h[2],qe=h[3],et=h[4],At=h[5],gt=h[6],Dt=h[7],Lt=h[8],Rt=h[9],Kt=h[10],Ht=h[11],Qt=h[12],ui=h[13],yi=h[14],Yi=h[15];return Math.abs(b-Ae)<=Yl*Math.max(1,Math.abs(b),Math.abs(Ae))&&Math.abs(M-_e)<=Yl*Math.max(1,Math.abs(M),Math.abs(_e))&&Math.abs(q-Le)<=Yl*Math.max(1,Math.abs(q),Math.abs(Le))&&Math.abs(K-qe)<=Yl*Math.max(1,Math.abs(K),Math.abs(qe))&&Math.abs(J-et)<=Yl*Math.max(1,Math.abs(J),Math.abs(et))&&Math.abs(me-At)<=Yl*Math.max(1,Math.abs(me),Math.abs(At))&&Math.abs(Ce-gt)<=Yl*Math.max(1,Math.abs(Ce),Math.abs(gt))&&Math.abs(Ne-Dt)<=Yl*Math.max(1,Math.abs(Ne),Math.abs(Dt))&&Math.abs(f-Lt)<=Yl*Math.max(1,Math.abs(f),Math.abs(Lt))&&Math.abs(u-Rt)<=Yl*Math.max(1,Math.abs(u),Math.abs(Rt))&&Math.abs(p-Kt)<=Yl*Math.max(1,Math.abs(p),Math.abs(Kt))&&Math.abs(I-Ht)<=Yl*Math.max(1,Math.abs(I),Math.abs(Ht))&&Math.abs(L-Qt)<=Yl*Math.max(1,Math.abs(L),Math.abs(Qt))&&Math.abs(U-ui)<=Yl*Math.max(1,Math.abs(U),Math.abs(ui))&&Math.abs(Q-yi)<=Yl*Math.max(1,Math.abs(Q),Math.abs(yi))&&Math.abs(re-Yi)<=Yl*Math.max(1,Math.abs(re),Math.abs(Yi))},S.aZ=function(m,h){return m[0]=h[0],m[1]=h[1],m[2]=h[2],m[3]=h[3],m[4]=h[4],m[5]=h[5],m[6]=h[6],m[7]=h[7],m[8]=h[8],m[9]=h[9],m[10]=h[10],m[11]=h[11],m[12]=h[12],m[13]=h[13],m[14]=h[14],m[15]=h[15],m},S.a_=function(m,h,b){return m[0]=h[0]*b[0],m[1]=h[1]*b[1],m[2]=h[2]*b[2],m[3]=h[3]*b[3],m},S.aa=function(m){const h={};if(m.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(b,M,q,K)=>{const J=q||K;return h[M]=!J||J.toLowerCase(),""}),h["max-age"]){const b=parseInt(h["max-age"],10);isNaN(b)?delete h["max-age"]:h["max-age"]=b}return h},S.ab=function(m,h){const b=[];for(const M in m)M in h||b.push(M);return b},S.ac=Mt,S.ad=function(m,h,b){var M=Math.sin(b),q=Math.cos(b),K=h[0],J=h[1],me=h[2],Ce=h[3],Ne=h[4],f=h[5],u=h[6],p=h[7];return h!==m&&(m[8]=h[8],m[9]=h[9],m[10]=h[10],m[11]=h[11],m[12]=h[12],m[13]=h[13],m[14]=h[14],m[15]=h[15]),m[0]=K*q+Ne*M,m[1]=J*q+f*M,m[2]=me*q+u*M,m[3]=Ce*q+p*M,m[4]=Ne*q-K*M,m[5]=f*q-J*M,m[6]=u*q-me*M,m[7]=p*q-Ce*M,m},S.ae=function(m){var h=new Xu(16);return h[0]=m[0],h[1]=m[1],h[2]=m[2],h[3]=m[3],h[4]=m[4],h[5]=m[5],h[6]=m[6],h[7]=m[7],h[8]=m[8],h[9]=m[9],h[10]=m[10],h[11]=m[11],h[12]=m[12],h[13]=m[13],h[14]=m[14],h[15]=m[15],h},S.af=uf,S.ag=function(m,h){let b=0,M=0;if(m.kind==="constant")M=m.layoutSize;else if(m.kind!=="source"){const{interpolationType:q,minZoom:K,maxZoom:J}=m,me=q?Mt(Ks.interpolationFactor(q,h,K,J),0,1):0;m.kind==="camera"?M=vr.number(m.minSize,m.maxSize,me):b=me}return{uSizeT:b,uSize:M}},S.ai=function(m,{uSize:h,uSizeT:b},{lowerSize:M,upperSize:q}){return m.kind==="source"?M/Dc:m.kind==="composite"?vr.number(M/Dc,q/Dc,b):h},S.aj=S0,S.ak=function(m,h,b,M){const q=h.y-m.y,K=h.x-m.x,J=M.y-b.y,me=M.x-b.x,Ce=J*K-me*q;if(Ce===0)return null;const Ne=(me*(m.y-b.y)-J*(m.x-b.x))/Ce;return new ae(m.x+Ne*K,m.y+Ne*q)},S.al=Pd,S.am=af,S.an=j0,S.ao=Al,S.aq=kf,S.ar=function(m,h){var b=h[0],M=h[1],q=h[2],K=h[3],J=h[4],me=h[5],Ce=h[6],Ne=h[7],f=h[8],u=h[9],p=h[10],I=h[11],L=h[12],U=h[13],Q=h[14],re=h[15],Ae=b*me-M*J,_e=b*Ce-q*J,Le=b*Ne-K*J,qe=M*Ce-q*me,et=M*Ne-K*me,At=q*Ne-K*Ce,gt=f*U-u*L,Dt=f*Q-p*L,Lt=f*re-I*L,Rt=u*Q-p*U,Kt=u*re-I*U,Ht=p*re-I*Q,Qt=Ae*Ht-_e*Kt+Le*Rt+qe*Lt-et*Dt+At*gt;return Qt?(m[0]=(me*Ht-Ce*Kt+Ne*Rt)*(Qt=1/Qt),m[1]=(q*Kt-M*Ht-K*Rt)*Qt,m[2]=(U*At-Q*et+re*qe)*Qt,m[3]=(p*et-u*At-I*qe)*Qt,m[4]=(Ce*Lt-J*Ht-Ne*Dt)*Qt,m[5]=(b*Ht-q*Lt+K*Dt)*Qt,m[6]=(Q*Le-L*At-re*_e)*Qt,m[7]=(f*At-p*Le+I*_e)*Qt,m[8]=(J*Kt-me*Lt+Ne*gt)*Qt,m[9]=(M*Lt-b*Kt-K*gt)*Qt,m[10]=(L*et-U*Le+re*Ae)*Qt,m[11]=(u*Le-f*et-I*Ae)*Qt,m[12]=(me*Dt-J*Rt-Ce*gt)*Qt,m[13]=(b*Rt-M*Dt+q*gt)*Qt,m[14]=(U*_e-L*qe-Q*Ae)*Qt,m[15]=(f*qe-u*_e+p*Ae)*Qt,m):null},S.as=P0,S.at=OA,S.au=zc,S.av=function(){const m={},h=ei.$version;for(const b in ei.$root){const M=ei.$root[b];if(M.required){let q=null;q=b==="version"?h:M.type==="array"?[]:{},q!=null&&(m[b]=q)}}return m},S.aw=Wl,S.ax=Ci,S.ay=function(m){m=m.slice();const h=Object.create(null);for(let b=0;b<m.length;b++)h[m[b].id]=m[b];for(let b=0;b<m.length;b++)"ref"in m[b]&&(m[b]=Pr(m[b],h[m[b].ref]));return m},S.az=function(m){if(m.type==="custom")return new bd(m);switch(m.type){case"background":return new vd(m);case"circle":return new u0(m);case"fill":return new d0(m);case"fill-extrusion":return new Jh(m);case"heatmap":return new c0(m);case"hillshade":return new xu(m);case"line":return new Lm(m);case"raster":return new Lp(m);case"symbol":return new NA(m)}},S.b=zt,S.b0=Oe,S.b1=Id,S.b2=Fp,S.b3=function(m,h,b,M,q){var K,J=1/Math.tan(h/2);return m[0]=J/b,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=J,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[11]=-1,m[12]=0,m[13]=0,m[15]=0,q!=null&&q!==1/0?(m[10]=(q+M)*(K=1/(M-q)),m[14]=2*q*M*K):(m[10]=-1,m[14]=-2*M),m},S.b4=function(m,h,b){var M=Math.sin(b),q=Math.cos(b),K=h[4],J=h[5],me=h[6],Ce=h[7],Ne=h[8],f=h[9],u=h[10],p=h[11];return h!==m&&(m[0]=h[0],m[1]=h[1],m[2]=h[2],m[3]=h[3],m[12]=h[12],m[13]=h[13],m[14]=h[14],m[15]=h[15]),m[4]=K*q+Ne*M,m[5]=J*q+f*M,m[6]=me*q+u*M,m[7]=Ce*q+p*M,m[8]=Ne*q-K*M,m[9]=f*q-J*M,m[10]=u*q-me*M,m[11]=p*q-Ce*M,m},S.b5=xt,S.b6=Tt,S.b7=function(m){return m*Math.PI/180},S.b8=function(m,h){return m[0]=h[0],m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=h[1],m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=h[2],m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,m},S.b9=class extends fs{},S.ba=VA,S.bb=Gp,S.bd=vn,S.be=function(m,h){ji.REGISTERED_PROTOCOLS[m]=h},S.bf=function(m){delete ji.REGISTERED_PROTOCOLS[m]},S.bg=function(m,h){const b={};for(let q=0;q<m.length;q++){const K=h&&h[m[q].id]||Jo(m[q]);h&&(h[m[q].id]=K);let J=b[K];J||(J=b[K]=[]),J.push(m[q])}const M=[];for(const q in b)M.push(b[q]);return M},S.bh=Sn,S.bi=Cd,S.bj=T0,S.bk=v0,S.bl=function(m){m.bucket.createArrays(),m.bucket.tilePixelRatio=$s/(512*m.bucket.overscaling),m.bucket.compareText={},m.bucket.iconsNeedLinear=!1;const h=m.bucket.layers[0],b=h.layout,M=h._unevaluatedLayout._values,q={layoutIconSize:M["icon-size"].possiblyEvaluate(new ms(m.bucket.zoom+1),m.canonical),layoutTextSize:M["text-size"].possiblyEvaluate(new ms(m.bucket.zoom+1),m.canonical),textMaxSize:M["text-size"].possiblyEvaluate(new ms(18))};if(m.bucket.textSizeData.kind==="composite"){const{minZoom:Ne,maxZoom:f}=m.bucket.textSizeData;q.compositeTextSizes=[M["text-size"].possiblyEvaluate(new ms(Ne),m.canonical),M["text-size"].possiblyEvaluate(new ms(f),m.canonical)]}if(m.bucket.iconSizeData.kind==="composite"){const{minZoom:Ne,maxZoom:f}=m.bucket.iconSizeData;q.compositeIconSizes=[M["icon-size"].possiblyEvaluate(new ms(Ne),m.canonical),M["icon-size"].possiblyEvaluate(new ms(f),m.canonical)]}const K=b.get("text-line-height")*Al,J=b.get("text-rotation-alignment")!=="viewport"&&b.get("symbol-placement")!=="point",me=b.get("text-keep-upright"),Ce=b.get("text-size");for(const Ne of m.bucket.features){const f=b.get("text-font").evaluate(Ne,{},m.canonical).join(","),u=Ce.evaluate(Ne,{},m.canonical),p=q.layoutTextSize.evaluate(Ne,{},m.canonical),I=q.layoutIconSize.evaluate(Ne,{},m.canonical),L={horizontal:{},vertical:void 0},U=Ne.text;let Q,re=[0,0];if(U){const Le=U.toString(),qe=b.get("text-letter-spacing").evaluate(Ne,{},m.canonical)*Al,et=uu(Le)?qe:0,At=b.get("text-anchor").evaluate(Ne,{},m.canonical),gt=rA(h,Ne,m.canonical);if(!gt){const Ht=b.get("text-radial-offset").evaluate(Ne,{},m.canonical);re=Ht?jA(At,[Ht*Al,nA]):b.get("text-offset").evaluate(Ne,{},m.canonical).map(Qt=>Qt*Al)}let Dt=J?"center":b.get("text-justify").evaluate(Ne,{},m.canonical);const Lt=b.get("symbol-placement"),Rt=Lt==="point"?b.get("text-max-width").evaluate(Ne,{},m.canonical)*Al:0,Kt=()=>{m.bucket.allowVerticalPlacement&&_l(Le)&&(L.vertical=Cf(U,m.glyphMap,m.glyphPositions,m.imagePositions,f,Rt,K,At,"left",et,re,S.ah.vertical,!0,Lt,p,u))};if(!J&&gt){const Ht=new Set;if(Dt==="auto")for(let ui=0;ui<gt.values.length;ui+=2)Ht.add(P0(gt.values[ui]));else Ht.add(Dt);let Qt=!1;for(const ui of Ht)if(!L.horizontal[ui])if(Qt)L.horizontal[ui]=L.horizontal[0];else{const yi=Cf(U,m.glyphMap,m.glyphPositions,m.imagePositions,f,Rt,K,"center",ui,et,re,S.ah.horizontal,!1,Lt,p,u);yi&&(L.horizontal[ui]=yi,Qt=yi.positionedLines.length===1)}Kt()}else{Dt==="auto"&&(Dt=P0(At));const Ht=Cf(U,m.glyphMap,m.glyphPositions,m.imagePositions,f,Rt,K,At,Dt,et,re,S.ah.horizontal,!1,Lt,p,u);Ht&&(L.horizontal[Dt]=Ht),Kt(),_l(Le)&&J&&me&&(L.vertical=Cf(U,m.glyphMap,m.glyphPositions,m.imagePositions,f,Rt,K,At,Dt,et,re,S.ah.vertical,!1,Lt,p,u))}}let Ae=!1;if(Ne.icon&&Ne.icon.name){const Le=m.imageMap[Ne.icon.name];Le&&(Q=Om(m.imagePositions[Ne.icon.name],b.get("icon-offset").evaluate(Ne,{},m.canonical),b.get("icon-anchor").evaluate(Ne,{},m.canonical)),Ae=!!Le.sdf,m.bucket.sdfIcons===void 0?m.bucket.sdfIcons=Ae:m.bucket.sdfIcons!==Ae&&dt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Le.pixelRatio!==m.bucket.pixelRatio||b.get("icon-rotate").constantOr(1)!==0)&&(m.bucket.iconsNeedLinear=!0))}const _e=Fd(L.horizontal)||L.vertical;m.bucket.iconsInText=!!_e&&_e.iconsInText,(_e||Q)&&Up(m.bucket,Ne,L,Q,m.imageMap,q,p,I,re,Ae,m.canonical)}m.showCollisionBoxes&&m.bucket.generateCollisionDebugBuffers()},S.bm=eA,S.bn=$h,S.bo=SA,S.bp=hc,S.bq=Ad,S.br=class{constructor(m){this._marks={start:[m.url,"start"].join("#"),end:[m.url,"end"].join("#"),measure:m.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let m=performance.getEntriesByName(this._marks.measure);return m.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),m=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),m}},S.bs=function(m,h,b,M,q){return a(this,void 0,void 0,function*(){if(ut())try{return yield gi(m,h,b,M,q)}catch{}return function(K,J,me,Ce,Ne){const f=K.width,u=K.height;wi&&Ti||(wi=new OffscreenCanvas(f,u),Ti=wi.getContext("2d",{willReadFrequently:!0})),wi.width=f,wi.height=u,Ti.drawImage(K,0,0,f,u);const p=Ti.getImageData(J,me,Ce,Ne);return Ti.clearRect(0,0,f,u),p.data}(m,h,b,M,q)})},S.bt=Ed,S.bu=G,S.bv=W,S.bw=ad,S.bx=Ts,S.by=function(m){return m.message===Ni},S.bz=$l,S.c=en,S.d=m=>a(void 0,void 0,void 0,function*(){if(m.byteLength===0)return createImageBitmap(new ImageData(1,1));const h=new Blob([new Uint8Array(m)],{type:"image/png"});try{return createImageBitmap(h)}catch(b){throw new Error(`Could not load image because of ${b.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),S.e=jt,S.f=m=>new Promise((h,b)=>{const M=new Image;M.onload=()=>{h(M),URL.revokeObjectURL(M.src),M.onload=null,window.requestAnimationFrame(()=>{M.src=Ot})},M.onerror=()=>b(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const q=new Blob([new Uint8Array(m)],{type:"image/png"});M.src=m.byteLength?URL.createObjectURL(q):Ot}),S.g=Vi,S.h=(m,h)=>mi(jt(m,{type:"json"}),h),S.i=lt,S.j=Ai,S.k=Ji,S.l=(m,h)=>mi(jt(m,{type:"arrayBuffer"}),h),S.m=mi,S.n=function(m){return new Ad(m).readFields(zm,[])},S.o=Dl,S.p=LA,S.q=oa,S.r=Wu,S.s=Ri,S.t=Ml,S.u=Cn,S.v=ei,S.w=dt,S.x=rs,S.y=function([m,h,b]){return h+=90,h*=Math.PI/180,b*=Math.PI/180,{x:m*Math.cos(h)*Math.sin(b),y:m*Math.sin(h)*Math.sin(b),z:m*Math.cos(b)}},S.z=vr}),g("worker",["./shared"],function(S){class a{constructor(se){this.keyCache={},se&&this.replace(se)}replace(se){this._layerConfigs={},this._layers={},this.update(se,[])}update(se,ne){for(const ie of se){this._layerConfigs[ie.id]=ie;const de=this._layers[ie.id]=S.az(ie);de._featureFilter=S.a6(de.filter),this.keyCache[ie.id]&&delete this.keyCache[ie.id]}for(const ie of ne)delete this.keyCache[ie],delete this._layerConfigs[ie],delete this._layers[ie];this.familiesBySource={};const $=S.bg(Object.values(this._layerConfigs),this.keyCache);for(const ie of $){const de=ie.map(Xe=>this._layers[Xe.id]),ye=de[0];if(ye.visibility==="none")continue;const ge=ye.source||"";let Pe=this.familiesBySource[ge];Pe||(Pe=this.familiesBySource[ge]={});const Fe=ye.sourceLayer||"_geojsonTileLayer";let Ve=Pe[Fe];Ve||(Ve=Pe[Fe]=[]),Ve.push(de)}}}class G{constructor(se){const ne={},$=[];for(const ge in se){const Pe=se[ge],Fe=ne[ge]={};for(const Ve in Pe){const Xe=Pe[+Ve];if(!Xe||Xe.bitmap.width===0||Xe.bitmap.height===0)continue;const Ye={x:0,y:0,w:Xe.bitmap.width+2,h:Xe.bitmap.height+2};$.push(Ye),Fe[Ve]={rect:Ye,metrics:Xe.metrics}}}const{w:ie,h:de}=S.p($),ye=new S.o({width:ie||1,height:de||1});for(const ge in se){const Pe=se[ge];for(const Fe in Pe){const Ve=Pe[+Fe];if(!Ve||Ve.bitmap.width===0||Ve.bitmap.height===0)continue;const Xe=ne[ge][Fe].rect;S.o.copy(Ve.bitmap,ye,{x:0,y:0},{x:Xe.x+1,y:Xe.y+1},Ve.bitmap)}}this.image=ye,this.positions=ne}}S.bh("GlyphAtlas",G);class W{constructor(se){this.tileID=new S.Q(se.tileID.overscaledZ,se.tileID.wrap,se.tileID.canonical.z,se.tileID.canonical.x,se.tileID.canonical.y),this.uid=se.uid,this.zoom=se.zoom,this.pixelRatio=se.pixelRatio,this.tileSize=se.tileSize,this.source=se.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=se.showCollisionBoxes,this.collectResourceTiming=!!se.collectResourceTiming,this.returnDependencies=!!se.returnDependencies,this.promoteId=se.promoteId,this.inFlightDependencies=[]}parse(se,ne,$,ie){return S._(this,void 0,void 0,function*(){this.status="parsing",this.data=se,this.collisionBoxArray=new S.a4;const de=new S.bi(Object.keys(se.layers).sort()),ye=new S.bj(this.tileID,this.promoteId);ye.bucketLayerIDs=[];const ge={},Pe={featureIndex:ye,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:$},Fe=ne.familiesBySource[this.source];for(const hi in Fe){const Jt=se.layers[hi];if(!Jt)continue;Jt.version===1&&S.w(`Vector tile source "${this.source}" layer "${hi}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const oi=de.encode(hi),zi=[];for(let xi=0;xi<Jt.length;xi++){const Si=Jt.feature(xi),Yt=ye.getId(Si,hi);zi.push({feature:Si,id:Yt,index:xi,sourceLayerIndex:oi})}for(const xi of Fe[hi]){const Si=xi[0];Si.source!==this.source&&S.w(`layer.source = ${Si.source} does not equal this.source = ${this.source}`),Si.minzoom&&this.zoom<Math.floor(Si.minzoom)||Si.maxzoom&&this.zoom>=Si.maxzoom||Si.visibility!=="none"&&(he(xi,this.zoom,$),(ge[Si.id]=Si.createBucket({index:ye.bucketLayerIDs.length,layers:xi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:oi,sourceID:this.source})).populate(zi,Pe,this.tileID.canonical),ye.bucketLayerIDs.push(xi.map(Yt=>Yt.id)))}}const Ve=S.aE(Pe.glyphDependencies,hi=>Object.keys(hi).map(Number));this.inFlightDependencies.forEach(hi=>hi==null?void 0:hi.abort()),this.inFlightDependencies=[];let Xe=Promise.resolve({});if(Object.keys(Ve).length){const hi=new AbortController;this.inFlightDependencies.push(hi),Xe=ie.sendAsync({type:"getGlyphs",data:{stacks:Ve,source:this.source,tileID:this.tileID,type:"glyphs"}},hi)}const Ye=Object.keys(Pe.iconDependencies);let De=Promise.resolve({});if(Ye.length){const hi=new AbortController;this.inFlightDependencies.push(hi),De=ie.sendAsync({type:"getImages",data:{icons:Ye,source:this.source,tileID:this.tileID,type:"icons"}},hi)}const Ge=Object.keys(Pe.patternDependencies);let ht=Promise.resolve({});if(Ge.length){const hi=new AbortController;this.inFlightDependencies.push(hi),ht=ie.sendAsync({type:"getImages",data:{icons:Ge,source:this.source,tileID:this.tileID,type:"patterns"}},hi)}const[kt,o,ke]=yield Promise.all([Xe,De,ht]),ai=new G(kt),fi=new S.bk(o,ke);for(const hi in ge){const Jt=ge[hi];Jt instanceof S.a5?(he(Jt.layers,this.zoom,$),S.bl({bucket:Jt,glyphMap:kt,glyphPositions:ai.positions,imageMap:o,imagePositions:fi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Jt.hasPattern&&(Jt instanceof S.bm||Jt instanceof S.bn||Jt instanceof S.bo)&&(he(Jt.layers,this.zoom,$),Jt.addFeatures(Pe,this.tileID.canonical,fi.patternPositions))}return this.status="done",{buckets:Object.values(ge).filter(hi=>!hi.isEmpty()),featureIndex:ye,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ai.image,imageAtlas:fi,glyphMap:this.returnDependencies?kt:null,iconMap:this.returnDependencies?o:null,glyphPositions:this.returnDependencies?ai.positions:null}})}}function he(Me,se,ne){const $=new S.a8(se);for(const ie of Me)ie.recalculate($,ne)}class ae{constructor(se,ne,$){this.actor=se,this.layerIndex=ne,this.availableImages=$,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(se,ne){return S._(this,void 0,void 0,function*(){const $=yield S.l(se.request,ne);try{return{vectorTile:new S.bp.VectorTile(new S.bq($.data)),rawData:$.data,cacheControl:$.cacheControl,expires:$.expires}}catch(ie){const de=new Uint8Array($.data);let ye=`Unable to parse the tile at ${se.request.url}, `;throw ye+=de[0]===31&&de[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ie.messge}`,new Error(ye)}})}loadTile(se){return S._(this,void 0,void 0,function*(){const ne=se.uid,$=!!(se&&se.request&&se.request.collectResourceTiming)&&new S.br(se.request),ie=new W(se);this.loading[ne]=ie;const de=new AbortController;ie.abort=de;try{const ye=yield this.loadVectorTile(se,de);if(delete this.loading[ne],!ye)return null;const ge=ye.rawData,Pe={};ye.expires&&(Pe.expires=ye.expires),ye.cacheControl&&(Pe.cacheControl=ye.cacheControl);const Fe={};if($){const Xe=$.finish();Xe&&(Fe.resourceTiming=JSON.parse(JSON.stringify(Xe)))}ie.vectorTile=ye.vectorTile;const Ve=ie.parse(ye.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[ne]=ie,this.fetching[ne]={rawTileData:ge,cacheControl:Pe,resourceTiming:Fe};try{const Xe=yield Ve;return S.e({rawTileData:ge.slice(0)},Xe,Pe,Fe)}finally{delete this.fetching[ne]}}catch(ye){throw delete this.loading[ne],ie.status="done",this.loaded[ne]=ie,ye}})}reloadTile(se){return S._(this,void 0,void 0,function*(){const ne=se.uid;if(!this.loaded||!this.loaded[ne])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const $=this.loaded[ne];if($.showCollisionBoxes=se.showCollisionBoxes,$.status==="parsing"){const ie=yield $.parse($.vectorTile,this.layerIndex,this.availableImages,this.actor);let de;if(this.fetching[ne]){const{rawTileData:ye,cacheControl:ge,resourceTiming:Pe}=this.fetching[ne];delete this.fetching[ne],de=S.e({rawTileData:ye.slice(0)},ie,ge,Pe)}else de=ie;return de}if($.status==="done"&&$.vectorTile)return $.parse($.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(se){return S._(this,void 0,void 0,function*(){const ne=this.loading,$=se.uid;ne&&ne[$]&&ne[$].abort&&(ne[$].abort.abort(),delete ne[$])})}removeTile(se){return S._(this,void 0,void 0,function*(){this.loaded&&this.loaded[se.uid]&&delete this.loaded[se.uid]})}}class ue{constructor(){this.loaded={}}loadTile(se){return S._(this,void 0,void 0,function*(){const{uid:ne,encoding:$,rawImageData:ie,redFactor:de,greenFactor:ye,blueFactor:ge,baseShift:Pe}=se,Fe=ie.width+2,Ve=ie.height+2,Xe=S.b(ie)?new S.R({width:Fe,height:Ve},yield S.bs(ie,-1,-1,Fe,Ve)):ie,Ye=new S.bt(ne,Xe,$,de,ye,ge,Pe);return this.loaded=this.loaded||{},this.loaded[ne]=Ye,Ye})}removeTile(se){const ne=this.loaded,$=se.uid;ne&&ne[$]&&delete ne[$]}}function be(Me,se){if(Me.length!==0){je(Me[0],se);for(var ne=1;ne<Me.length;ne++)je(Me[ne],!se)}}function je(Me,se){for(var ne=0,$=0,ie=0,de=Me.length,ye=de-1;ie<de;ye=ie++){var ge=(Me[ie][0]-Me[ye][0])*(Me[ye][1]+Me[ie][1]),Pe=ne+ge;$+=Math.abs(ne)>=Math.abs(ge)?ne-Pe+ge:ge-Pe+ne,ne=Pe}ne+$>=0!=!!se&&Me.reverse()}var nt=S.bu(function Me(se,ne){var $,ie=se&&se.type;if(ie==="FeatureCollection")for($=0;$<se.features.length;$++)Me(se.features[$],ne);else if(ie==="GeometryCollection")for($=0;$<se.geometries.length;$++)Me(se.geometries[$],ne);else if(ie==="Feature")Me(se.geometry,ne);else if(ie==="Polygon")be(se.coordinates,ne);else if(ie==="MultiPolygon")for($=0;$<se.coordinates.length;$++)be(se.coordinates[$],ne);return se});const tt=S.bp.VectorTileFeature.prototype.toGeoJSON;var at={exports:{}},ut=S.bv,xt=S.bp.VectorTileFeature,Tt=Mt;function Mt(Me,se){this.options=se||{},this.features=Me,this.length=Me.length}function Oe(Me,se){this.id=typeof Me.id=="number"?Me.id:void 0,this.type=Me.type,this.rawGeometry=Me.type===1?[Me.geometry]:Me.geometry,this.properties=Me.tags,this.extent=se||4096}Mt.prototype.feature=function(Me){return new Oe(this.features[Me],this.options.extent)},Oe.prototype.loadGeometry=function(){var Me=this.rawGeometry;this.geometry=[];for(var se=0;se<Me.length;se++){for(var ne=Me[se],$=[],ie=0;ie<ne.length;ie++)$.push(new ut(ne[ie][0],ne[ie][1]));this.geometry.push($)}return this.geometry},Oe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Me=this.geometry,se=1/0,ne=-1/0,$=1/0,ie=-1/0,de=0;de<Me.length;de++)for(var ye=Me[de],ge=0;ge<ye.length;ge++){var Pe=ye[ge];se=Math.min(se,Pe.x),ne=Math.max(ne,Pe.x),$=Math.min($,Pe.y),ie=Math.max(ie,Pe.y)}return[se,$,ne,ie]},Oe.prototype.toGeoJSON=xt.prototype.toGeoJSON;var jt=S.bw,it=Tt;function vt(Me){var se=new jt;return function(ne,$){for(var ie in ne.layers)$.writeMessage(3,mt,ne.layers[ie])}(Me,se),se.finish()}function mt(Me,se){var ne;se.writeVarintField(15,Me.version||1),se.writeStringField(1,Me.name||""),se.writeVarintField(5,Me.extent||4096);var $={keys:[],values:[],keycache:{},valuecache:{}};for(ne=0;ne<Me.length;ne++)$.feature=Me.feature(ne),se.writeMessage(2,Et,$);var ie=$.keys;for(ne=0;ne<ie.length;ne++)se.writeStringField(3,ie[ne]);var de=$.values;for(ne=0;ne<de.length;ne++)se.writeMessage(4,lt,de[ne])}function Et(Me,se){var ne=Me.feature;ne.id!==void 0&&se.writeVarintField(1,ne.id),se.writeMessage(2,Pt,Me),se.writeVarintField(3,ne.type),se.writeMessage(4,pt,ne)}function Pt(Me,se){var ne=Me.feature,$=Me.keys,ie=Me.values,de=Me.keycache,ye=Me.valuecache;for(var ge in ne.properties){var Pe=ne.properties[ge],Fe=de[ge];if(Pe!==null){Fe===void 0&&($.push(ge),de[ge]=Fe=$.length-1),se.writeVarint(Fe);var Ve=typeof Pe;Ve!=="string"&&Ve!=="boolean"&&Ve!=="number"&&(Pe=JSON.stringify(Pe));var Xe=Ve+":"+Pe,Ye=ye[Xe];Ye===void 0&&(ie.push(Pe),ye[Xe]=Ye=ie.length-1),se.writeVarint(Ye)}}}function dt(Me,se){return(se<<3)+(7&Me)}function Je(Me){return Me<<1^Me>>31}function pt(Me,se){for(var ne=Me.loadGeometry(),$=Me.type,ie=0,de=0,ye=ne.length,ge=0;ge<ye;ge++){var Pe=ne[ge],Fe=1;$===1&&(Fe=Pe.length),se.writeVarint(dt(1,Fe));for(var Ve=$===3?Pe.length-1:Pe.length,Xe=0;Xe<Ve;Xe++){Xe===1&&$!==1&&se.writeVarint(dt(2,Ve-1));var Ye=Pe[Xe].x-ie,De=Pe[Xe].y-de;se.writeVarint(Je(Ye)),se.writeVarint(Je(De)),ie+=Ye,de+=De}$===3&&se.writeVarint(dt(7,1))}}function lt(Me,se){var ne=typeof Me;ne==="string"?se.writeStringField(1,Me):ne==="boolean"?se.writeBooleanField(7,Me):ne==="number"&&(Me%1!=0?se.writeDoubleField(3,Me):Me<0?se.writeSVarintField(6,Me):se.writeVarintField(5,Me))}at.exports=vt,at.exports.fromVectorTileJs=vt,at.exports.fromGeojsonVt=function(Me,se){se=se||{};var ne={};for(var $ in Me)ne[$]=new it(Me[$].features,se),ne[$].name=$,ne[$].version=se.version,ne[$].extent=se.extent;return vt({layers:ne})},at.exports.GeoJSONWrapper=it;var Nt=S.bu(at.exports);const zt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Me=>Me},Ot=Math.fround||(gi=new Float32Array(1),Me=>(gi[0]=+Me,gi[0]));var gi;const wi=3,Ti=5,Ni=6;class en{constructor(se){this.options=Object.assign(Object.create(zt),se),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(se){const{log:ne,minZoom:$,maxZoom:ie}=this.options;ne&&console.time("total time");const de=`prepare ${se.length} points`;ne&&console.time(de),this.points=se;const ye=[];for(let Pe=0;Pe<se.length;Pe++){const Fe=se[Pe];if(!Fe.geometry)continue;const[Ve,Xe]=Fe.geometry.coordinates,Ye=Ot(nn(Ve)),De=Ot(vn(Xe));ye.push(Ye,De,1/0,Pe,-1,1),this.options.reduce&&ye.push(0)}let ge=this.trees[ie+1]=this._createTree(ye);ne&&console.timeEnd(de);for(let Pe=ie;Pe>=$;Pe--){const Fe=+Date.now();ge=this.trees[Pe]=this._createTree(this._cluster(ge,Pe)),ne&&console.log("z%d: %d clusters in %dms",Pe,ge.numItems,+Date.now()-Fe)}return ne&&console.timeEnd("total time"),this}getClusters(se,ne){let $=((se[0]+180)%360+360)%360-180;const ie=Math.max(-90,Math.min(90,se[1]));let de=se[2]===180?180:((se[2]+180)%360+360)%360-180;const ye=Math.max(-90,Math.min(90,se[3]));if(se[2]-se[0]>=360)$=-180,de=180;else if($>de){const Xe=this.getClusters([$,ie,180,ye],ne),Ye=this.getClusters([-180,ie,de,ye],ne);return Xe.concat(Ye)}const ge=this.trees[this._limitZoom(ne)],Pe=ge.range(nn($),vn(ye),nn(de),vn(ie)),Fe=ge.data,Ve=[];for(const Xe of Pe){const Ye=this.stride*Xe;Ve.push(Fe[Ye+Ti]>1?ji(Fe,Ye,this.clusterProps):this.points[Fe[Ye+wi]])}return Ve}getChildren(se){const ne=this._getOriginId(se),$=this._getOriginZoom(se),ie="No cluster with the specified id.",de=this.trees[$];if(!de)throw new Error(ie);const ye=de.data;if(ne*this.stride>=ye.length)throw new Error(ie);const ge=this.options.radius/(this.options.extent*Math.pow(2,$-1)),Pe=de.within(ye[ne*this.stride],ye[ne*this.stride+1],ge),Fe=[];for(const Ve of Pe){const Xe=Ve*this.stride;ye[Xe+4]===se&&Fe.push(ye[Xe+Ti]>1?ji(ye,Xe,this.clusterProps):this.points[ye[Xe+wi]])}if(Fe.length===0)throw new Error(ie);return Fe}getLeaves(se,ne,$){const ie=[];return this._appendLeaves(ie,se,ne=ne||10,$=$||0,0),ie}getTile(se,ne,$){const ie=this.trees[this._limitZoom(se)],de=Math.pow(2,se),{extent:ye,radius:ge}=this.options,Pe=ge/ye,Fe=($-Pe)/de,Ve=($+1+Pe)/de,Xe={features:[]};return this._addTileFeatures(ie.range((ne-Pe)/de,Fe,(ne+1+Pe)/de,Ve),ie.data,ne,$,de,Xe),ne===0&&this._addTileFeatures(ie.range(1-Pe/de,Fe,1,Ve),ie.data,de,$,de,Xe),ne===de-1&&this._addTileFeatures(ie.range(0,Fe,Pe/de,Ve),ie.data,-1,$,de,Xe),Xe.features.length?Xe:null}getClusterExpansionZoom(se){let ne=this._getOriginZoom(se)-1;for(;ne<=this.options.maxZoom;){const $=this.getChildren(se);if(ne++,$.length!==1)break;se=$[0].properties.cluster_id}return ne}_appendLeaves(se,ne,$,ie,de){const ye=this.getChildren(ne);for(const ge of ye){const Pe=ge.properties;if(Pe&&Pe.cluster?de+Pe.point_count<=ie?de+=Pe.point_count:de=this._appendLeaves(se,Pe.cluster_id,$,ie,de):de<ie?de++:se.push(ge),se.length===$)break}return de}_createTree(se){const ne=new S.au(se.length/this.stride|0,this.options.nodeSize,Float32Array);for(let $=0;$<se.length;$+=this.stride)ne.add(se[$],se[$+1]);return ne.finish(),ne.data=se,ne}_addTileFeatures(se,ne,$,ie,de,ye){for(const ge of se){const Pe=ge*this.stride,Fe=ne[Pe+Ti]>1;let Ve,Xe,Ye;if(Fe)Ve=Vi(ne,Pe,this.clusterProps),Xe=ne[Pe],Ye=ne[Pe+1];else{const ht=this.points[ne[Pe+wi]];Ve=ht.properties;const[kt,o]=ht.geometry.coordinates;Xe=nn(kt),Ye=vn(o)}const De={type:1,geometry:[[Math.round(this.options.extent*(Xe*de-$)),Math.round(this.options.extent*(Ye*de-ie))]],tags:Ve};let Ge;Ge=Fe||this.options.generateId?ne[Pe+wi]:this.points[ne[Pe+wi]].id,Ge!==void 0&&(De.id=Ge),ye.features.push(De)}}_limitZoom(se){return Math.max(this.options.minZoom,Math.min(Math.floor(+se),this.options.maxZoom+1))}_cluster(se,ne){const{radius:$,extent:ie,reduce:de,minPoints:ye}=this.options,ge=$/(ie*Math.pow(2,ne)),Pe=se.data,Fe=[],Ve=this.stride;for(let Xe=0;Xe<Pe.length;Xe+=Ve){if(Pe[Xe+2]<=ne)continue;Pe[Xe+2]=ne;const Ye=Pe[Xe],De=Pe[Xe+1],Ge=se.within(Pe[Xe],Pe[Xe+1],ge),ht=Pe[Xe+Ti];let kt=ht;for(const o of Ge){const ke=o*Ve;Pe[ke+2]>ne&&(kt+=Pe[ke+Ti])}if(kt>ht&&kt>=ye){let o,ke=Ye*ht,ai=De*ht,fi=-1;const hi=((Xe/Ve|0)<<5)+(ne+1)+this.points.length;for(const Jt of Ge){const oi=Jt*Ve;if(Pe[oi+2]<=ne)continue;Pe[oi+2]=ne;const zi=Pe[oi+Ti];ke+=Pe[oi]*zi,ai+=Pe[oi+1]*zi,Pe[oi+4]=hi,de&&(o||(o=this._map(Pe,Xe,!0),fi=this.clusterProps.length,this.clusterProps.push(o)),de(o,this._map(Pe,oi)))}Pe[Xe+4]=hi,Fe.push(ke/kt,ai/kt,1/0,hi,-1,kt),de&&Fe.push(fi)}else{for(let o=0;o<Ve;o++)Fe.push(Pe[Xe+o]);if(kt>1)for(const o of Ge){const ke=o*Ve;if(!(Pe[ke+2]<=ne)){Pe[ke+2]=ne;for(let ai=0;ai<Ve;ai++)Fe.push(Pe[ke+ai])}}}}return Fe}_getOriginId(se){return se-this.points.length>>5}_getOriginZoom(se){return(se-this.points.length)%32}_map(se,ne,$){if(se[ne+Ti]>1){const ye=this.clusterProps[se[ne+Ni]];return $?Object.assign({},ye):ye}const ie=this.points[se[ne+wi]].properties,de=this.options.map(ie);return $&&de===ie?Object.assign({},de):de}}function ji(Me,se,ne){return{type:"Feature",id:Me[se+wi],properties:Vi(Me,se,ne),geometry:{type:"Point",coordinates:[($=Me[se],360*($-.5)),Ci(Me[se+1])]}};var $}function Vi(Me,se,ne){const $=Me[se+Ti],ie=$>=1e4?`${Math.round($/1e3)}k`:$>=1e3?Math.round($/100)/10+"k":$,de=Me[se+Ni],ye=de===-1?{}:Object.assign({},ne[de]);return Object.assign(ye,{cluster:!0,cluster_id:Me[se+wi],point_count:$,point_count_abbreviated:ie})}function nn(Me){return Me/360+.5}function vn(Me){const se=Math.sin(Me*Math.PI/180),ne=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return ne<0?0:ne>1?1:ne}function Ci(Me){const se=(180-360*Me)*Math.PI/180;return 360*Math.atan(Math.exp(se))/Math.PI-90}function mi(Me,se,ne,$){for(var ie,de=$,ye=ne-se>>1,ge=ne-se,Pe=Me[se],Fe=Me[se+1],Ve=Me[ne],Xe=Me[ne+1],Ye=se+3;Ye<ne;Ye+=3){var De=Ri(Me[Ye],Me[Ye+1],Pe,Fe,Ve,Xe);if(De>de)ie=Ye,de=De;else if(De===de){var Ge=Math.abs(Ye-ye);Ge<ge&&(ie=Ye,ge=Ge)}}de>$&&(ie-se>3&&mi(Me,se,ie,$),Me[ie+2]=de,ne-ie>3&&mi(Me,ie,ne,$))}function Ri(Me,se,ne,$,ie,de){var ye=ie-ne,ge=de-$;if(ye!==0||ge!==0){var Pe=((Me-ne)*ye+(se-$)*ge)/(ye*ye+ge*ge);Pe>1?(ne=ie,$=de):Pe>0&&(ne+=ye*Pe,$+=ge*Pe)}return(ye=Me-ne)*ye+(ge=se-$)*ge}function Oi(Me,se,ne,$){var ie={id:Me===void 0?null:Me,type:se,geometry:ne,tags:$,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(de){var ye=de.geometry,ge=de.type;if(ge==="Point"||ge==="MultiPoint"||ge==="LineString")_i(de,ye);else if(ge==="Polygon"||ge==="MultiLineString")for(var Pe=0;Pe<ye.length;Pe++)_i(de,ye[Pe]);else if(ge==="MultiPolygon")for(Pe=0;Pe<ye.length;Pe++)for(var Fe=0;Fe<ye[Pe].length;Fe++)_i(de,ye[Pe][Fe])}(ie),ie}function _i(Me,se){for(var ne=0;ne<se.length;ne+=3)Me.minX=Math.min(Me.minX,se[ne]),Me.minY=Math.min(Me.minY,se[ne+1]),Me.maxX=Math.max(Me.maxX,se[ne]),Me.maxY=Math.max(Me.maxY,se[ne+1])}function Ji(Me,se,ne,$){if(se.geometry){var ie=se.geometry.coordinates,de=se.geometry.type,ye=Math.pow(ne.tolerance/((1<<ne.maxZoom)*ne.extent),2),ge=[],Pe=se.id;if(ne.promoteId?Pe=se.properties[ne.promoteId]:ne.generateId&&(Pe=$||0),de==="Point")Ai(ie,ge);else if(de==="MultiPoint")for(var Fe=0;Fe<ie.length;Fe++)Ai(ie[Fe],ge);else if(de==="LineString")sn(ie,ge,ye,!1);else if(de==="MultiLineString"){if(ne.lineMetrics){for(Fe=0;Fe<ie.length;Fe++)sn(ie[Fe],ge=[],ye,!1),Me.push(Oi(Pe,"LineString",ge,se.properties));return}ei(ie,ge,ye,!1)}else if(de==="Polygon")ei(ie,ge,ye,!0);else{if(de!=="MultiPolygon"){if(de==="GeometryCollection"){for(Fe=0;Fe<se.geometry.geometries.length;Fe++)Ji(Me,{id:Pe,geometry:se.geometry.geometries[Fe],properties:se.properties},ne,$);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Fe=0;Fe<ie.length;Fe++){var Ve=[];ei(ie[Fe],Ve,ye,!0),ge.push(Ve)}}Me.push(Oi(Pe,de,ge,se.properties))}}function Ai(Me,se){se.push(_n(Me[0])),se.push(Pr(Me[1])),se.push(0)}function sn(Me,se,ne,$){for(var ie,de,ye=0,ge=0;ge<Me.length;ge++){var Pe=_n(Me[ge][0]),Fe=Pr(Me[ge][1]);se.push(Pe),se.push(Fe),se.push(0),ge>0&&(ye+=$?(ie*Fe-Pe*de)/2:Math.sqrt(Math.pow(Pe-ie,2)+Math.pow(Fe-de,2))),ie=Pe,de=Fe}var Ve=se.length-3;se[2]=1,mi(se,0,Ve,ne),se[Ve+2]=1,se.size=Math.abs(ye),se.start=0,se.end=se.size}function ei(Me,se,ne,$){for(var ie=0;ie<Me.length;ie++){var de=[];sn(Me[ie],de,ne,$),se.push(de)}}function _n(Me){return Me/360+.5}function Pr(Me){var se=Math.sin(Me*Math.PI/180),ne=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return ne<0?0:ne>1?1:ne}function ci(Me,se,ne,$,ie,de,ye,ge){if($/=se,de>=(ne/=se)&&ye<$)return Me;if(ye<ne||de>=$)return null;for(var Pe=[],Fe=0;Fe<Me.length;Fe++){var Ve=Me[Fe],Xe=Ve.geometry,Ye=Ve.type,De=ie===0?Ve.minX:Ve.minY,Ge=ie===0?Ve.maxX:Ve.maxY;if(De>=ne&&Ge<$)Pe.push(Ve);else if(!(Ge<ne||De>=$)){var ht=[];if(Ye==="Point"||Ye==="MultiPoint")rn(Xe,ht,ne,$,ie);else if(Ye==="LineString")tr(Xe,ht,ne,$,ie,!1,ge.lineMetrics);else if(Ye==="MultiLineString")Qn(Xe,ht,ne,$,ie,!1);else if(Ye==="Polygon")Qn(Xe,ht,ne,$,ie,!0);else if(Ye==="MultiPolygon")for(var kt=0;kt<Xe.length;kt++){var o=[];Qn(Xe[kt],o,ne,$,ie,!0),o.length&&ht.push(o)}if(ht.length){if(ge.lineMetrics&&Ye==="LineString"){for(kt=0;kt<ht.length;kt++)Pe.push(Oi(Ve.id,Ye,ht[kt],Ve.tags));continue}Ye!=="LineString"&&Ye!=="MultiLineString"||(ht.length===1?(Ye="LineString",ht=ht[0]):Ye="MultiLineString"),Ye!=="Point"&&Ye!=="MultiPoint"||(Ye=ht.length===3?"Point":"MultiPoint"),Pe.push(Oi(Ve.id,Ye,ht,Ve.tags))}}}return Pe.length?Pe:null}function rn(Me,se,ne,$,ie){for(var de=0;de<Me.length;de+=3){var ye=Me[de+ie];ye>=ne&&ye<=$&&(se.push(Me[de]),se.push(Me[de+1]),se.push(Me[de+2]))}}function tr(Me,se,ne,$,ie,de,ye){for(var ge,Pe,Fe=Pn(Me),Ve=ie===0?v:k,Xe=Me.start,Ye=0;Ye<Me.length-3;Ye+=3){var De=Me[Ye],Ge=Me[Ye+1],ht=Me[Ye+2],kt=Me[Ye+3],o=Me[Ye+4],ke=ie===0?De:Ge,ai=ie===0?kt:o,fi=!1;ye&&(ge=Math.sqrt(Math.pow(De-kt,2)+Math.pow(Ge-o,2))),ke<ne?ai>ne&&(Pe=Ve(Fe,De,Ge,kt,o,ne),ye&&(Fe.start=Xe+ge*Pe)):ke>$?ai<$&&(Pe=Ve(Fe,De,Ge,kt,o,$),ye&&(Fe.start=Xe+ge*Pe)):In(Fe,De,Ge,ht),ai<ne&&ke>=ne&&(Pe=Ve(Fe,De,Ge,kt,o,ne),fi=!0),ai>$&&ke<=$&&(Pe=Ve(Fe,De,Ge,kt,o,$),fi=!0),!de&&fi&&(ye&&(Fe.end=Xe+ge*Pe),se.push(Fe),Fe=Pn(Me)),ye&&(Xe+=ge)}var hi=Me.length-3;De=Me[hi],Ge=Me[hi+1],ht=Me[hi+2],(ke=ie===0?De:Ge)>=ne&&ke<=$&&In(Fe,De,Ge,ht),hi=Fe.length-3,de&&hi>=3&&(Fe[hi]!==Fe[0]||Fe[hi+1]!==Fe[1])&&In(Fe,Fe[0],Fe[1],Fe[2]),Fe.length&&se.push(Fe)}function Pn(Me){var se=[];return se.size=Me.size,se.start=Me.start,se.end=Me.end,se}function Qn(Me,se,ne,$,ie,de){for(var ye=0;ye<Me.length;ye++)tr(Me[ye],se,ne,$,ie,de,!1)}function In(Me,se,ne,$){Me.push(se),Me.push(ne),Me.push($)}function v(Me,se,ne,$,ie,de){var ye=(de-se)/($-se);return Me.push(de),Me.push(ne+(ie-ne)*ye),Me.push(1),ye}function k(Me,se,ne,$,ie,de){var ye=(de-ne)/(ie-ne);return Me.push(se+($-se)*ye),Me.push(de),Me.push(1),ye}function V(Me,se){for(var ne=[],$=0;$<Me.length;$++){var ie,de=Me[$],ye=de.type;if(ye==="Point"||ye==="MultiPoint"||ye==="LineString")ie=Y(de.geometry,se);else if(ye==="MultiLineString"||ye==="Polygon"){ie=[];for(var ge=0;ge<de.geometry.length;ge++)ie.push(Y(de.geometry[ge],se))}else if(ye==="MultiPolygon")for(ie=[],ge=0;ge<de.geometry.length;ge++){for(var Pe=[],Fe=0;Fe<de.geometry[ge].length;Fe++)Pe.push(Y(de.geometry[ge][Fe],se));ie.push(Pe)}ne.push(Oi(de.id,ye,ie,de.tags))}return ne}function Y(Me,se){var ne=[];ne.size=Me.size,Me.start!==void 0&&(ne.start=Me.start,ne.end=Me.end);for(var $=0;$<Me.length;$+=3)ne.push(Me[$]+se,Me[$+1],Me[$+2]);return ne}function te(Me,se){if(Me.transformed)return Me;var ne,$,ie,de=1<<Me.z,ye=Me.x,ge=Me.y;for(ne=0;ne<Me.features.length;ne++){var Pe=Me.features[ne],Fe=Pe.geometry,Ve=Pe.type;if(Pe.geometry=[],Ve===1)for($=0;$<Fe.length;$+=2)Pe.geometry.push(fe(Fe[$],Fe[$+1],se,de,ye,ge));else for($=0;$<Fe.length;$++){var Xe=[];for(ie=0;ie<Fe[$].length;ie+=2)Xe.push(fe(Fe[$][ie],Fe[$][ie+1],se,de,ye,ge));Pe.geometry.push(Xe)}}return Me.transformed=!0,Me}function fe(Me,se,ne,$,ie,de){return[Math.round(ne*(Me*$-ie)),Math.round(ne*(se*$-de))]}function ve(Me,se,ne,$,ie){for(var de=se===ie.maxZoom?0:ie.tolerance/((1<<se)*ie.extent),ye={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ne,y:$,z:se,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ge=0;ge<Me.length;ge++){ye.numFeatures++,Ie(ye,Me[ge],de,ie);var Pe=Me[ge].minX,Fe=Me[ge].minY,Ve=Me[ge].maxX,Xe=Me[ge].maxY;Pe<ye.minX&&(ye.minX=Pe),Fe<ye.minY&&(ye.minY=Fe),Ve>ye.maxX&&(ye.maxX=Ve),Xe>ye.maxY&&(ye.maxY=Xe)}return ye}function Ie(Me,se,ne,$){var ie=se.geometry,de=se.type,ye=[];if(de==="Point"||de==="MultiPoint")for(var ge=0;ge<ie.length;ge+=3)ye.push(ie[ge]),ye.push(ie[ge+1]),Me.numPoints++,Me.numSimplified++;else if(de==="LineString")Ee(ye,ie,Me,ne,!1,!1);else if(de==="MultiLineString"||de==="Polygon")for(ge=0;ge<ie.length;ge++)Ee(ye,ie[ge],Me,ne,de==="Polygon",ge===0);else if(de==="MultiPolygon")for(var Pe=0;Pe<ie.length;Pe++){var Fe=ie[Pe];for(ge=0;ge<Fe.length;ge++)Ee(ye,Fe[ge],Me,ne,!0,ge===0)}if(ye.length){var Ve=se.tags||null;if(de==="LineString"&&$.lineMetrics){for(var Xe in Ve={},se.tags)Ve[Xe]=se.tags[Xe];Ve.mapbox_clip_start=ie.start/ie.size,Ve.mapbox_clip_end=ie.end/ie.size}var Ye={geometry:ye,type:de==="Polygon"||de==="MultiPolygon"?3:de==="LineString"||de==="MultiLineString"?2:1,tags:Ve};se.id!==null&&(Ye.id=se.id),Me.features.push(Ye)}}function Ee(Me,se,ne,$,ie,de){var ye=$*$;if($>0&&se.size<(ie?ye:$))ne.numPoints+=se.length/3;else{for(var ge=[],Pe=0;Pe<se.length;Pe+=3)($===0||se[Pe+2]>ye)&&(ne.numSimplified++,ge.push(se[Pe]),ge.push(se[Pe+1])),ne.numPoints++;ie&&function(Fe,Ve){for(var Xe=0,Ye=0,De=Fe.length,Ge=De-2;Ye<De;Ge=Ye,Ye+=2)Xe+=(Fe[Ye]-Fe[Ge])*(Fe[Ye+1]+Fe[Ge+1]);if(Xe>0===Ve)for(Ye=0,De=Fe.length;Ye<De/2;Ye+=2){var ht=Fe[Ye],kt=Fe[Ye+1];Fe[Ye]=Fe[De-2-Ye],Fe[Ye+1]=Fe[De-1-Ye],Fe[De-2-Ye]=ht,Fe[De-1-Ye]=kt}}(ge,de),Me.push(ge)}}function ze(Me,se){var ne=(se=this.options=function(ie,de){for(var ye in de)ie[ye]=de[ye];return ie}(Object.create(this.options),se)).debug;if(ne&&console.time("preprocess data"),se.maxZoom<0||se.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(se.promoteId&&se.generateId)throw new Error("promoteId and generateId cannot be used together.");var $=function(ie,de){var ye=[];if(ie.type==="FeatureCollection")for(var ge=0;ge<ie.features.length;ge++)Ji(ye,ie.features[ge],de,ge);else Ji(ye,ie.type==="Feature"?ie:{geometry:ie},de);return ye}(Me,se);this.tiles={},this.tileCoords=[],ne&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",se.indexMaxZoom,se.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),$=function(ie,de){var ye=de.buffer/de.extent,ge=ie,Pe=ci(ie,1,-1-ye,ye,0,-1,2,de),Fe=ci(ie,1,1-ye,2+ye,0,-1,2,de);return(Pe||Fe)&&(ge=ci(ie,1,-ye,1+ye,0,-1,2,de)||[],Pe&&(ge=V(Pe,1).concat(ge)),Fe&&(ge=ge.concat(V(Fe,-1)))),ge}($,se),$.length&&this.splitTile($,0,0,0),ne&&($.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function We(Me,se,ne){return 32*((1<<Me)*ne+se)+Me}function He(Me,se){return se?Me.properties[se]:Me.id}function Qe(Me,se){if(Me==null)return!0;if(Me.type==="Feature")return He(Me,se)!=null;if(Me.type==="FeatureCollection"){const ne=new Set;for(const $ of Me.features){const ie=He($,se);if(ie==null||ne.has(ie))return!1;ne.add(ie)}return!0}return!1}function Ue(Me,se){const ne=new Map;if(Me!=null)if(Me.type==="Feature")ne.set(He(Me,se),Me);else for(const $ of Me.features)ne.set(He($,se),$);return ne}ze.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ze.prototype.splitTile=function(Me,se,ne,$,ie,de,ye){for(var ge=[Me,se,ne,$],Pe=this.options,Fe=Pe.debug;ge.length;){$=ge.pop(),ne=ge.pop(),se=ge.pop(),Me=ge.pop();var Ve=1<<se,Xe=We(se,ne,$),Ye=this.tiles[Xe];if(!Ye&&(Fe>1&&console.time("creation"),Ye=this.tiles[Xe]=ve(Me,se,ne,$,Pe),this.tileCoords.push({z:se,x:ne,y:$}),Fe)){Fe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",se,ne,$,Ye.numFeatures,Ye.numPoints,Ye.numSimplified),console.timeEnd("creation"));var De="z"+se;this.stats[De]=(this.stats[De]||0)+1,this.total++}if(Ye.source=Me,ie){if(se===Pe.maxZoom||se===ie)continue;var Ge=1<<ie-se;if(ne!==Math.floor(de/Ge)||$!==Math.floor(ye/Ge))continue}else if(se===Pe.indexMaxZoom||Ye.numPoints<=Pe.indexMaxPoints)continue;if(Ye.source=null,Me.length!==0){Fe>1&&console.time("clipping");var ht,kt,o,ke,ai,fi,hi=.5*Pe.buffer/Pe.extent,Jt=.5-hi,oi=.5+hi,zi=1+hi;ht=kt=o=ke=null,ai=ci(Me,Ve,ne-hi,ne+oi,0,Ye.minX,Ye.maxX,Pe),fi=ci(Me,Ve,ne+Jt,ne+zi,0,Ye.minX,Ye.maxX,Pe),Me=null,ai&&(ht=ci(ai,Ve,$-hi,$+oi,1,Ye.minY,Ye.maxY,Pe),kt=ci(ai,Ve,$+Jt,$+zi,1,Ye.minY,Ye.maxY,Pe),ai=null),fi&&(o=ci(fi,Ve,$-hi,$+oi,1,Ye.minY,Ye.maxY,Pe),ke=ci(fi,Ve,$+Jt,$+zi,1,Ye.minY,Ye.maxY,Pe),fi=null),Fe>1&&console.timeEnd("clipping"),ge.push(ht||[],se+1,2*ne,2*$),ge.push(kt||[],se+1,2*ne,2*$+1),ge.push(o||[],se+1,2*ne+1,2*$),ge.push(ke||[],se+1,2*ne+1,2*$+1)}}},ze.prototype.getTile=function(Me,se,ne){var $=this.options,ie=$.extent,de=$.debug;if(Me<0||Me>24)return null;var ye=1<<Me,ge=We(Me,se=(se%ye+ye)%ye,ne);if(this.tiles[ge])return te(this.tiles[ge],ie);de>1&&console.log("drilling down to z%d-%d-%d",Me,se,ne);for(var Pe,Fe=Me,Ve=se,Xe=ne;!Pe&&Fe>0;)Fe--,Ve=Math.floor(Ve/2),Xe=Math.floor(Xe/2),Pe=this.tiles[We(Fe,Ve,Xe)];return Pe&&Pe.source?(de>1&&console.log("found parent tile z%d-%d-%d",Fe,Ve,Xe),de>1&&console.time("drilling down"),this.splitTile(Pe.source,Fe,Ve,Xe,Me,se,ne),de>1&&console.timeEnd("drilling down"),this.tiles[ge]?te(this.tiles[ge],ie):null):null};class ft extends ae{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(se,ne){return S._(this,void 0,void 0,function*(){const $=se.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ie=this._geoJSONIndex.getTile($.z,$.x,$.y);if(!ie)return null;const de=new class{constructor(ge){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=S.W,this.length=ge.length,this._features=ge}feature(ge){return new class{constructor(Pe){this._feature=Pe,this.extent=S.W,this.type=Pe.type,this.properties=Pe.tags,"id"in Pe&&!isNaN(Pe.id)&&(this.id=parseInt(Pe.id,10))}loadGeometry(){if(this._feature.type===1){const Pe=[];for(const Fe of this._feature.geometry)Pe.push([new S.P(Fe[0],Fe[1])]);return Pe}{const Pe=[];for(const Fe of this._feature.geometry){const Ve=[];for(const Xe of Fe)Ve.push(new S.P(Xe[0],Xe[1]));Pe.push(Ve)}return Pe}}toGeoJSON(Pe,Fe,Ve){return tt.call(this,Pe,Fe,Ve)}}(this._features[ge])}}(ie.features);let ye=Nt(de);return ye.byteOffset===0&&ye.byteLength===ye.buffer.byteLength||(ye=new Uint8Array(ye)),{vectorTile:de,rawData:ye.buffer}})}loadData(se){var ne;return S._(this,void 0,void 0,function*(){(ne=this._pendingRequest)===null||ne===void 0||ne.abort();const $=!!(se&&se.request&&se.request.collectResourceTiming)&&new S.br(se.request);this._pendingRequest=new AbortController;try{let ie=yield this.loadGeoJSON(se,this._pendingRequest);if(delete this._pendingRequest,typeof ie!="object")throw new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`);if(nt(ie,!0),se.filter){const ye=S.bx(se.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ye.result==="error")throw new Error(ye.value.map(Pe=>`${Pe.key}: ${Pe.message}`).join(", "));ie={type:"FeatureCollection",features:ie.features.filter(Pe=>ye.value.evaluate({zoom:0},Pe))}}this._geoJSONIndex=se.cluster?new en(function({superclusterOptions:ye,clusterProperties:ge}){if(!ge||!ye)return ye;const Pe={},Fe={},Ve={accumulated:null,zoom:0},Xe={properties:null},Ye=Object.keys(ge);for(const De of Ye){const[Ge,ht]=ge[De],kt=S.bx(ht),o=S.bx(typeof Ge=="string"?[Ge,["accumulated"],["get",De]]:Ge);Pe[De]=kt.value,Fe[De]=o.value}return ye.map=De=>{Xe.properties=De;const Ge={};for(const ht of Ye)Ge[ht]=Pe[ht].evaluate(Ve,Xe);return Ge},ye.reduce=(De,Ge)=>{Xe.properties=Ge;for(const ht of Ye)Ve.accumulated=De[ht],De[ht]=Fe[ht].evaluate(Ve,Xe)},ye}(se)).load(ie.features):function(ye,ge){return new ze(ye,ge)}(ie,se.geojsonVtOptions),this.loaded={};const de={};if($){const ye=$.finish();ye&&(de.resourceTiming={},de.resourceTiming[se.source]=JSON.parse(JSON.stringify(ye)))}return de}catch(ie){if(delete this._pendingRequest,S.by(ie))return{abandoned:!0};throw ie}})}reloadTile(se){const ne=this.loaded;return ne&&ne[se.uid]?super.reloadTile(se):this.loadTile(se)}loadGeoJSON(se,ne){return S._(this,void 0,void 0,function*(){const{promoteId:$}=se;if(se.request){const ie=yield S.h(se.request,ne);return this._dataUpdateable=Qe(ie.data,$)?Ue(ie.data,$):void 0,ie.data}if(typeof se.data=="string")try{const ie=JSON.parse(se.data);return this._dataUpdateable=Qe(ie,$)?Ue(ie,$):void 0,ie}catch{throw new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`)}if(!se.dataDiff)throw new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${se.source}`);return function(ie,de,ye){var ge,Pe,Fe,Ve;if(de.removeAll&&ie.clear(),de.remove)for(const Xe of de.remove)ie.delete(Xe);if(de.add)for(const Xe of de.add){const Ye=He(Xe,ye);Ye!=null&&ie.set(Ye,Xe)}if(de.update)for(const Xe of de.update){let Ye=ie.get(Xe.id);if(Ye==null)continue;const De=!Xe.removeAllProperties&&(((ge=Xe.removeProperties)===null||ge===void 0?void 0:ge.length)>0||((Pe=Xe.addOrUpdateProperties)===null||Pe===void 0?void 0:Pe.length)>0);if((Xe.newGeometry||Xe.removeAllProperties||De)&&(Ye=Object.assign({},Ye),ie.set(Xe.id,Ye),De&&(Ye.properties=Object.assign({},Ye.properties))),Xe.newGeometry&&(Ye.geometry=Xe.newGeometry),Xe.removeAllProperties)Ye.properties={};else if(((Fe=Xe.removeProperties)===null||Fe===void 0?void 0:Fe.length)>0)for(const Ge of Xe.removeProperties)Object.prototype.hasOwnProperty.call(Ye.properties,Ge)&&delete Ye.properties[Ge];if(((Ve=Xe.addOrUpdateProperties)===null||Ve===void 0?void 0:Ve.length)>0)for(const{key:Ge,value:ht}of Xe.addOrUpdateProperties)Ye.properties[Ge]=ht}}(this._dataUpdateable,se.dataDiff,$),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(se){return S._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(se){return this._geoJSONIndex.getClusterExpansionZoom(se.clusterId)}getClusterChildren(se){return this._geoJSONIndex.getChildren(se.clusterId)}getClusterLeaves(se){return this._geoJSONIndex.getLeaves(se.clusterId,se.limit,se.offset)}}class st{constructor(se){this.self=se,this.actor=new S.C(se),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(ne,$)=>{if(this.externalWorkerSourceTypes[ne])throw new Error(`Worker source with name "${ne}" already registered.`);this.externalWorkerSourceTypes[ne]=$},this.self.addProtocol=S.be,this.self.removeProtocol=S.bf,this.self.registerRTLTextPlugin=ne=>{if(S.bz.isParsed())throw new Error("RTL text plugin already registered.");S.bz.setMethods(ne)},this.actor.registerMessageHandler("loadDEMTile",(ne,$)=>this._getDEMWorkerSource(ne,$.source).loadTile($)),this.actor.registerMessageHandler("removeDEMTile",(ne,$)=>S._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ne,$.source).removeTile($)})),this.actor.registerMessageHandler("getClusterExpansionZoom",(ne,$)=>S._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,$.type,$.source).getClusterExpansionZoom($)})),this.actor.registerMessageHandler("getClusterChildren",(ne,$)=>S._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,$.type,$.source).getClusterChildren($)})),this.actor.registerMessageHandler("getClusterLeaves",(ne,$)=>S._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,$.type,$.source).getClusterLeaves($)})),this.actor.registerMessageHandler("loadData",(ne,$)=>this._getWorkerSource(ne,$.type,$.source).loadData($)),this.actor.registerMessageHandler("loadTile",(ne,$)=>this._getWorkerSource(ne,$.type,$.source).loadTile($)),this.actor.registerMessageHandler("reloadTile",(ne,$)=>this._getWorkerSource(ne,$.type,$.source).reloadTile($)),this.actor.registerMessageHandler("abortTile",(ne,$)=>this._getWorkerSource(ne,$.type,$.source).abortTile($)),this.actor.registerMessageHandler("removeTile",(ne,$)=>this._getWorkerSource(ne,$.type,$.source).removeTile($)),this.actor.registerMessageHandler("removeSource",(ne,$)=>S._(this,void 0,void 0,function*(){if(!this.workerSources[ne]||!this.workerSources[ne][$.type]||!this.workerSources[ne][$.type][$.source])return;const ie=this.workerSources[ne][$.type][$.source];delete this.workerSources[ne][$.type][$.source],ie.removeSource!==void 0&&ie.removeSource($)})),this.actor.registerMessageHandler("removeMap",ne=>S._(this,void 0,void 0,function*(){delete this.layerIndexes[ne],delete this.availableImages[ne],delete this.workerSources[ne],delete this.demWorkerSources[ne]})),this.actor.registerMessageHandler("setReferrer",(ne,$)=>S._(this,void 0,void 0,function*(){this.referrer=$})),this.actor.registerMessageHandler("syncRTLPluginState",(ne,$)=>this._syncRTLPluginState(ne,$)),this.actor.registerMessageHandler("importScript",(ne,$)=>S._(this,void 0,void 0,function*(){this.self.importScripts($)})),this.actor.registerMessageHandler("setImages",(ne,$)=>this._setImages(ne,$)),this.actor.registerMessageHandler("updateLayers",(ne,$)=>S._(this,void 0,void 0,function*(){this._getLayerIndex(ne).update($.layers,$.removedIds)})),this.actor.registerMessageHandler("setLayers",(ne,$)=>S._(this,void 0,void 0,function*(){this._getLayerIndex(ne).replace($)}))}_setImages(se,ne){return S._(this,void 0,void 0,function*(){this.availableImages[se]=ne;for(const $ in this.workerSources[se]){const ie=this.workerSources[se][$];for(const de in ie)ie[de].availableImages=ne}})}_syncRTLPluginState(se,ne){return S._(this,void 0,void 0,function*(){S.bz.setState(ne);const $=S.bz.getPluginURL();if(ne.pluginStatus==="loaded"&&!S.bz.isParsed()&&$!=null){this.self.importScripts($);const ie=S.bz.isParsed();if(ie)return ie;throw new Error(`RTL Text Plugin failed to import scripts from ${$}`)}return!1})}_getAvailableImages(se){let ne=this.availableImages[se];return ne||(ne=[]),ne}_getLayerIndex(se){let ne=this.layerIndexes[se];return ne||(ne=this.layerIndexes[se]=new a),ne}_getWorkerSource(se,ne,$){if(this.workerSources[se]||(this.workerSources[se]={}),this.workerSources[se][ne]||(this.workerSources[se][ne]={}),!this.workerSources[se][ne][$]){const ie={sendAsync:(de,ye)=>(de.targetMapId=se,this.actor.sendAsync(de,ye))};switch(ne){case"vector":this.workerSources[se][ne][$]=new ae(ie,this._getLayerIndex(se),this._getAvailableImages(se));break;case"geojson":this.workerSources[se][ne][$]=new ft(ie,this._getLayerIndex(se),this._getAvailableImages(se));break;default:this.workerSources[se][ne][$]=new this.externalWorkerSourceTypes[ne](ie,this._getLayerIndex(se),this._getAvailableImages(se))}}return this.workerSources[se][ne][$]}_getDEMWorkerSource(se,ne){return this.demWorkerSources[se]||(this.demWorkerSources[se]={}),this.demWorkerSources[se][ne]||(this.demWorkerSources[se][ne]=new ue),this.demWorkerSources[se][ne]}}return S.i(self)&&(self.worker=new st(self)),st}),g("index",["exports","./shared"],function(S,a){var G="4.1.0";let W,he;const ae={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:y=>new Promise((s,i)=>{const r=requestAnimationFrame(s);y.signal.addEventListener("abort",()=>{cancelAnimationFrame(r),i(a.c())})}),getImageData(y,s=0){return this.getImageCanvasContext(y).getImageData(-s,-s,y.width+2*s,y.height+2*s)},getImageCanvasContext(y){const s=window.document.createElement("canvas"),i=s.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("failed to create canvas 2d context");return s.width=y.width,s.height=y.height,i.drawImage(y,0,0,y.width,y.height),i},resolveURL:y=>(W||(W=document.createElement("a")),W.href=y,W.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(he==null&&(he=matchMedia("(prefers-reduced-motion: reduce)")),he.matches)}};class ue{static testProp(s){if(!ue.docStyle)return s[0];for(let i=0;i<s.length;i++)if(s[i]in ue.docStyle)return s[i];return s[0]}static create(s,i,r){const l=window.document.createElement(s);return i!==void 0&&(l.className=i),r&&r.appendChild(l),l}static createNS(s,i){return window.document.createElementNS(s,i)}static disableDrag(){ue.docStyle&&ue.selectProp&&(ue.userSelect=ue.docStyle[ue.selectProp],ue.docStyle[ue.selectProp]="none")}static enableDrag(){ue.docStyle&&ue.selectProp&&(ue.docStyle[ue.selectProp]=ue.userSelect)}static setTransform(s,i){s.style[ue.transformProp]=i}static addEventListener(s,i,r,l={}){s.addEventListener(i,r,"passive"in l?l:l.capture)}static removeEventListener(s,i,r,l={}){s.removeEventListener(i,r,"passive"in l?l:l.capture)}static suppressClickInternal(s){s.preventDefault(),s.stopPropagation(),window.removeEventListener("click",ue.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ue.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",ue.suppressClickInternal,!0)},0)}static getScale(s){const i=s.getBoundingClientRect();return{x:i.width/s.offsetWidth||1,y:i.height/s.offsetHeight||1,boundingClientRect:i}}static getPoint(s,i,r){const l=i.boundingClientRect;return new a.P((r.clientX-l.left)/i.x-s.clientLeft,(r.clientY-l.top)/i.y-s.clientTop)}static mousePos(s,i){const r=ue.getScale(s);return ue.getPoint(s,r,i)}static touchPos(s,i){const r=[],l=ue.getScale(s);for(let d=0;d<i.length;d++)r.push(ue.getPoint(s,l,i[d]));return r}static mouseButton(s){return s.button}static remove(s){s.parentNode&&s.parentNode.removeChild(s)}}ue.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,ue.selectProp=ue.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ue.transformProp=ue.testProp(["transform","WebkitTransform"]);const be={supported:!1,testSupport:function(y){!tt&&nt&&(at?ut(y):je=y)}};let je,nt,tt=!1,at=!1;function ut(y){const s=y.createTexture();y.bindTexture(y.TEXTURE_2D,s);try{if(y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,nt),y.isContextLost())return;be.supported=!0}catch{}y.deleteTexture(s),tt=!0}var xt,Tt;typeof document<"u"&&(nt=document.createElement("img"),nt.onload=function(){je&&ut(je),je=null,at=!0},nt.onerror=function(){tt=!0,je=null},nt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(y){let s,i,r,l;y.resetRequestQueue=()=>{s=[],i=0,r=0,l={}},y.addThrottleControl=T=>{const B=r++;return l[B]=T,B},y.removeThrottleControl=T=>{delete l[T],_()},y.getImage=(T,B,j=!0)=>new Promise((X,ce)=>{be.supported&&(T.headers||(T.headers={}),T.headers.accept="image/webp,*/*"),a.e(T,{type:"image"}),s.push({abortController:B,requestParameters:T,supportImageRefresh:j,state:"queued",onError:Se=>{ce(Se)},onSuccess:Se=>{X(Se)}}),_()});const d=T=>a._(this,void 0,void 0,function*(){T.state="running";const{requestParameters:B,supportImageRefresh:j,onError:X,onSuccess:ce,abortController:Se}=T,Te=j===!1&&!a.i(self)&&!a.g(B.url)&&(!B.headers||Object.keys(B.headers).reduce((Ke,yt)=>Ke&&yt==="accept",!0));i++;const Re=Te?w(B,Se):a.m(B,Se);try{const Ke=yield Re;delete T.abortController,T.state="completed",Ke.data instanceof HTMLImageElement||a.b(Ke.data)?ce(Ke):Ke.data&&ce({data:yield(Be=Ke.data,typeof createImageBitmap=="function"?a.d(Be):a.f(Be)),cacheControl:Ke.cacheControl,expires:Ke.expires})}catch(Ke){delete T.abortController,X(Ke)}finally{i--,_()}var Be}),_=()=>{const T=(()=>{for(const B of Object.keys(l))if(l[B]())return!0;return!1})()?a.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let B=i;B<T&&s.length>0;B++){const j=s.shift();j.abortController.signal.aborted?B--:d(j)}},w=(T,B)=>new Promise((j,X)=>{const ce=new Image,Se=T.url,Te=T.credentials;Te&&Te==="include"?ce.crossOrigin="use-credentials":(Te&&Te==="same-origin"||!a.s(Se))&&(ce.crossOrigin="anonymous"),B.signal.addEventListener("abort",()=>{ce.src="",X(a.c())}),ce.fetchPriority="high",ce.onload=()=>{ce.onerror=ce.onload=null,j({data:ce})},ce.onerror=()=>{ce.onerror=ce.onload=null,B.signal.aborted||X(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},ce.src=Se})}(xt||(xt={})),xt.resetRequestQueue(),function(y){y.Glyphs="Glyphs",y.Image="Image",y.Source="Source",y.SpriteImage="SpriteImage",y.SpriteJSON="SpriteJSON",y.Style="Style",y.Tile="Tile",y.Unknown="Unknown"}(Tt||(Tt={}));class Mt{constructor(s){this._transformRequestFn=s}transformRequest(s,i){return this._transformRequestFn&&this._transformRequestFn(s,i)||{url:s}}normalizeSpriteURL(s,i,r){const l=function(d){const _=d.match(Oe);if(!_)throw new Error(`Unable to parse URL "${d}"`);return{protocol:_[1],authority:_[2],path:_[3]||"/",params:_[4]?_[4].split("&"):[]}}(s);return l.path+=`${i}${r}`,function(d){const _=d.params.length?`?${d.params.join("&")}`:"";return`${d.protocol}://${d.authority}${d.path}${_}`}(l)}setTransformRequest(s){this._transformRequestFn=s}}const Oe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function jt(y){var s=new a.A(3);return s[0]=y[0],s[1]=y[1],s[2]=y[2],s}var it,vt=function(y,s,i){return y[0]=s[0]-i[0],y[1]=s[1]-i[1],y[2]=s[2]-i[2],y};it=new a.A(3),a.A!=Float32Array&&(it[0]=0,it[1]=0,it[2]=0);var mt=function(y){var s=y[0],i=y[1];return s*s+i*i};function Et(y){const s=[];if(typeof y=="string")s.push({id:"default",url:y});else if(y&&y.length>0){const i=[];for(const{id:r,url:l}of y){const d=`${r}${l}`;i.indexOf(d)===-1&&(i.push(d),s.push({id:r,url:l}))}}return s}(function(){var y=new a.A(2);a.A!=Float32Array&&(y[0]=0,y[1]=0)})();class Pt{constructor(s,i,r,l){this.context=s,this.format=r,this.texture=s.gl.createTexture(),this.update(i,l)}update(s,i,r){const{width:l,height:d}=s,_=!(this.size&&this.size[0]===l&&this.size[1]===d||r),{context:w}=this,{gl:T}=w;if(this.useMipmap=!!(i&&i.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!i||i.premultiply!==!1)),_)this.size=[l,d],s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||a.b(s)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,s):T.texImage2D(T.TEXTURE_2D,0,this.format,l,d,0,this.format,T.UNSIGNED_BYTE,s.data);else{const{x:B,y:j}=r||{x:0,y:0};s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||a.b(s)?T.texSubImage2D(T.TEXTURE_2D,0,B,j,T.RGBA,T.UNSIGNED_BYTE,s):T.texSubImage2D(T.TEXTURE_2D,0,B,j,l,d,T.RGBA,T.UNSIGNED_BYTE,s.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D)}bind(s,i,r){const{context:l}=this,{gl:d}=l;d.bindTexture(d.TEXTURE_2D,this.texture),r!==d.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=d.LINEAR),s!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,s),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,r||s),this.filter=s),i!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,i),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}function dt(y){const{userImage:s}=y;return!!(s&&s.render&&s.render())&&(y.data.replace(new Uint8Array(s.data.buffer)),!0)}class Je extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(s){if(this.loaded!==s&&(this.loaded=s,s)){for(const{ids:i,promiseResolve:r}of this.requestors)r(this._getImagesForIds(i));this.requestors=[]}}getImage(s){const i=this.images[s];if(i&&!i.data&&i.spriteData){const r=i.spriteData;i.data=new a.R({width:r.width,height:r.height},r.context.getImageData(r.x,r.y,r.width,r.height).data),i.spriteData=null}return i}addImage(s,i){if(this.images[s])throw new Error(`Image id ${s} already exist, use updateImage instead`);this._validate(s,i)&&(this.images[s]=i)}_validate(s,i){let r=!0;const l=i.data||i.spriteData;return this._validateStretch(i.stretchX,l&&l.width)||(this.fire(new a.j(new Error(`Image "${s}" has invalid "stretchX" value`))),r=!1),this._validateStretch(i.stretchY,l&&l.height)||(this.fire(new a.j(new Error(`Image "${s}" has invalid "stretchY" value`))),r=!1),this._validateContent(i.content,i)||(this.fire(new a.j(new Error(`Image "${s}" has invalid "content" value`))),r=!1),r}_validateStretch(s,i){if(!s)return!0;let r=0;for(const l of s){if(l[0]<r||l[1]<l[0]||i<l[1])return!1;r=l[1]}return!0}_validateContent(s,i){if(!s)return!0;if(s.length!==4)return!1;const r=i.spriteData,l=r&&r.width||i.data.width,d=r&&r.height||i.data.height;return!(s[0]<0||l<s[0]||s[1]<0||d<s[1]||s[2]<0||l<s[2]||s[3]<0||d<s[3]||s[2]<s[0]||s[3]<s[1])}updateImage(s,i,r=!0){const l=this.getImage(s);if(r&&(l.data.width!==i.data.width||l.data.height!==i.data.height))throw new Error(`size mismatch between old image (${l.data.width}x${l.data.height}) and new image (${i.data.width}x${i.data.height}).`);i.version=l.version+1,this.images[s]=i,this.updatedImages[s]=!0}removeImage(s){const i=this.images[s];delete this.images[s],delete this.patterns[s],i.userImage&&i.userImage.onRemove&&i.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(s){return new Promise((i,r)=>{let l=!0;if(!this.isLoaded())for(const d of s)this.images[d]||(l=!1);this.isLoaded()||l?i(this._getImagesForIds(s)):this.requestors.push({ids:s,promiseResolve:i})})}_getImagesForIds(s){const i={};for(const r of s){let l=this.getImage(r);l||(this.fire(new a.k("styleimagemissing",{id:r})),l=this.getImage(r)),l?i[r]={data:l.data.clone(),pixelRatio:l.pixelRatio,sdf:l.sdf,version:l.version,stretchX:l.stretchX,stretchY:l.stretchY,content:l.content,hasRenderCallback:!!(l.userImage&&l.userImage.render)}:a.w(`Image "${r}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return i}getPixelSize(){const{width:s,height:i}=this.atlasImage;return{width:s,height:i}}getPattern(s){const i=this.patterns[s],r=this.getImage(s);if(!r)return null;if(i&&i.position.version===r.version)return i.position;if(i)i.position.version=r.version;else{const l={w:r.data.width+2,h:r.data.height+2,x:0,y:0},d=new a.I(l,r);this.patterns[s]={bin:l,position:d}}return this._updatePatternAtlas(),this.patterns[s].position}bind(s){const i=s.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Pt(s,this.atlasImage,i.RGBA),this.atlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}_updatePatternAtlas(){const s=[];for(const d in this.patterns)s.push(this.patterns[d].bin);const{w:i,h:r}=a.p(s),l=this.atlasImage;l.resize({width:i||1,height:r||1});for(const d in this.patterns){const{bin:_}=this.patterns[d],w=_.x+1,T=_.y+1,B=this.getImage(d).data,j=B.width,X=B.height;a.R.copy(B,l,{x:0,y:0},{x:w,y:T},{width:j,height:X}),a.R.copy(B,l,{x:0,y:X-1},{x:w,y:T-1},{width:j,height:1}),a.R.copy(B,l,{x:0,y:0},{x:w,y:T+X},{width:j,height:1}),a.R.copy(B,l,{x:j-1,y:0},{x:w-1,y:T},{width:1,height:X}),a.R.copy(B,l,{x:0,y:0},{x:w+j,y:T},{width:1,height:X})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(s){for(const i of s){if(this.callbackDispatchedThisFrame[i])continue;this.callbackDispatchedThisFrame[i]=!0;const r=this.getImage(i);r||a.w(`Image with ID: "${i}" was not found`),dt(r)&&this.updateImage(i,r)}}}const pt=1e20;function lt(y,s,i,r,l,d,_,w,T){for(let B=s;B<s+r;B++)Nt(y,i*d+B,d,l,_,w,T);for(let B=i;B<i+l;B++)Nt(y,B*d+s,1,r,_,w,T)}function Nt(y,s,i,r,l,d,_){d[0]=0,_[0]=-pt,_[1]=pt,l[0]=y[s];for(let w=1,T=0,B=0;w<r;w++){l[w]=y[s+w*i];const j=w*w;do{const X=d[T];B=(l[w]-l[X]+j-X*X)/(w-X)/2}while(B<=_[T]&&--T>-1);T++,d[T]=w,_[T]=B,_[T+1]=pt}for(let w=0,T=0;w<r;w++){for(;_[T+1]<w;)T++;const B=d[T],j=w-B;y[s+w*i]=l[B]+j*j}}class zt{constructor(s,i){this.requestManager=s,this.localIdeographFontFamily=i,this.entries={}}setURL(s){this.url=s}getGlyphs(s){return a._(this,void 0,void 0,function*(){const i=[];for(const d in s)for(const _ of s[d])i.push(this._getAndCacheGlyphsPromise(d,_));const r=yield Promise.all(i),l={};for(const{stack:d,id:_,glyph:w}of r)l[d]||(l[d]={}),l[d][_]=w&&{id:w.id,bitmap:w.bitmap.clone(),metrics:w.metrics};return l})}_getAndCacheGlyphsPromise(s,i){return a._(this,void 0,void 0,function*(){let r=this.entries[s];r||(r=this.entries[s]={glyphs:{},requests:{},ranges:{}});let l=r.glyphs[i];if(l!==void 0)return{stack:s,id:i,glyph:l};if(l=this._tinySDF(r,s,i),l)return r.glyphs[i]=l,{stack:s,id:i,glyph:l};const d=Math.floor(i/256);if(256*d>65535)throw new Error("glyphs > 65535 not supported");if(r.ranges[d])return{stack:s,id:i,glyph:l};if(!this.url)throw new Error("glyphsUrl is not set");if(!r.requests[d]){const w=zt.loadGlyphRange(s,d,this.url,this.requestManager);r.requests[d]=w}const _=yield r.requests[d];for(const w in _)this._doesCharSupportLocalGlyph(+w)||(r.glyphs[+w]=_[+w]);return r.ranges[d]=!0,{stack:s,id:i,glyph:_[i]||null}})}_doesCharSupportLocalGlyph(s){return!!this.localIdeographFontFamily&&(a.u["CJK Unified Ideographs"](s)||a.u["Hangul Syllables"](s)||a.u.Hiragana(s)||a.u.Katakana(s))}_tinySDF(s,i,r){const l=this.localIdeographFontFamily;if(!l||!this._doesCharSupportLocalGlyph(r))return;let d=s.tinySDF;if(!d){let w="400";/bold/i.test(i)?w="900":/medium/i.test(i)?w="500":/light/i.test(i)&&(w="200"),d=s.tinySDF=new zt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:l,fontWeight:w})}const _=d.draw(String.fromCharCode(r));return{id:r,bitmap:new a.o({width:_.width||60,height:_.height||60},_.data),metrics:{width:_.glyphWidth/2||24,height:_.glyphHeight/2||24,left:_.glyphLeft/2+.5||0,top:_.glyphTop/2-27.5||-8,advance:_.glyphAdvance/2||24,isDoubleResolution:!0}}}}zt.loadGlyphRange=function(y,s,i,r){return a._(this,void 0,void 0,function*(){const l=256*s,d=l+255,_=r.transformRequest(i.replace("{fontstack}",y).replace("{range}",`${l}-${d}`),Tt.Glyphs),w=yield a.l(_,new AbortController);if(!w||!w.data)throw new Error(`Could not load glyph range. range: ${s}, ${l}-${d}`);const T={};for(const B of a.n(w.data))T[B.id]=B;return T})},zt.TinySDF=class{constructor({fontSize:y=24,buffer:s=3,radius:i=8,cutoff:r=.25,fontFamily:l="sans-serif",fontWeight:d="normal",fontStyle:_="normal"}={}){this.buffer=s,this.cutoff=r,this.radius=i;const w=this.size=y+4*s,T=this._createCanvas(w),B=this.ctx=T.getContext("2d",{willReadFrequently:!0});B.font=`${_} ${d} ${y}px ${l}`,B.textBaseline="alphabetic",B.textAlign="left",B.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(y){const s=document.createElement("canvas");return s.width=s.height=y,s}draw(y){const{width:s,actualBoundingBoxAscent:i,actualBoundingBoxDescent:r,actualBoundingBoxLeft:l,actualBoundingBoxRight:d}=this.ctx.measureText(y),_=Math.ceil(i),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(d-l))),T=Math.min(this.size-this.buffer,_+Math.ceil(r)),B=w+2*this.buffer,j=T+2*this.buffer,X=Math.max(B*j,0),ce=new Uint8ClampedArray(X),Se={data:ce,width:B,height:j,glyphWidth:w,glyphHeight:T,glyphTop:_,glyphLeft:0,glyphAdvance:s};if(w===0||T===0)return Se;const{ctx:Te,buffer:Re,gridInner:Be,gridOuter:Ke}=this;Te.clearRect(Re,Re,w,T),Te.fillText(y,Re,Re+_);const yt=Te.getImageData(Re,Re,w,T);Ke.fill(pt,0,X),Be.fill(0,0,X);for(let ot=0;ot<T;ot++)for(let ct=0;ct<w;ct++){const It=yt.data[4*(ot*w+ct)+3]/255;if(It===0)continue;const bt=(ot+Re)*B+ct+Re;if(It===1)Ke[bt]=0,Be[bt]=pt;else{const ri=.5-It;Ke[bt]=ri>0?ri*ri:0,Be[bt]=ri<0?ri*ri:0}}lt(Ke,0,0,B,j,B,this.f,this.v,this.z),lt(Be,Re,Re,w,T,B,this.f,this.v,this.z);for(let ot=0;ot<X;ot++){const ct=Math.sqrt(Ke[ot])-Math.sqrt(Be[ot]);ce[ot]=Math.round(255-255*(ct/this.radius+this.cutoff))}return Se}};class Ot{constructor(){this.specification=a.v.light.position}possiblyEvaluate(s,i){return a.y(s.expression.evaluate(i))}interpolate(s,i,r){return{x:a.z.number(s.x,i.x,r),y:a.z.number(s.y,i.y,r),z:a.z.number(s.z,i.z,r)}}}let gi;class wi extends a.E{constructor(s){super(),gi=gi||new a.q({anchor:new a.D(a.v.light.anchor),position:new Ot,color:new a.D(a.v.light.color),intensity:new a.D(a.v.light.intensity)}),this._transitionable=new a.T(gi),this.setLight(s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,i={}){if(!this._validate(a.r,s,i))for(const r in s){const l=s[r];r.endsWith("-transition")?this._transitionable.setTransition(r.slice(0,-11),l):this._transitionable.setValue(r,l)}}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,i,r){return(!r||r.validate!==!1)&&a.t(this,s.call(a.x,{value:i,style:{glyphs:!0,sprite:!0},styleSpec:a.v}))}}class Ti{constructor(s,i){this.width=s,this.height=i,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(s,i){const r=s.join(",")+String(i);return this.dashEntry[r]||(this.dashEntry[r]=this.addDash(s,i)),this.dashEntry[r]}getDashRanges(s,i,r){const l=[];let d=s.length%2==1?-s[s.length-1]*r:0,_=s[0]*r,w=!0;l.push({left:d,right:_,isDash:w,zeroLength:s[0]===0});let T=s[0];for(let B=1;B<s.length;B++){w=!w;const j=s[B];d=T*r,T+=j,_=T*r,l.push({left:d,right:_,isDash:w,zeroLength:j===0})}return l}addRoundDash(s,i,r){const l=i/2;for(let d=-r;d<=r;d++){const _=this.width*(this.nextRow+r+d);let w=0,T=s[w];for(let B=0;B<this.width;B++){B/T.right>1&&(T=s[++w]);const j=Math.abs(B-T.left),X=Math.abs(B-T.right),ce=Math.min(j,X);let Se;const Te=d/r*(l+1);if(T.isDash){const Re=l-Math.abs(Te);Se=Math.sqrt(ce*ce+Re*Re)}else Se=l-Math.sqrt(ce*ce+Te*Te);this.data[_+B]=Math.max(0,Math.min(255,Se+128))}}}addRegularDash(s){for(let w=s.length-1;w>=0;--w){const T=s[w],B=s[w+1];T.zeroLength?s.splice(w,1):B&&B.isDash===T.isDash&&(B.left=T.left,s.splice(w,1))}const i=s[0],r=s[s.length-1];i.isDash===r.isDash&&(i.left=r.left-this.width,r.right=i.right+this.width);const l=this.width*this.nextRow;let d=0,_=s[d];for(let w=0;w<this.width;w++){w/_.right>1&&(_=s[++d]);const T=Math.abs(w-_.left),B=Math.abs(w-_.right),j=Math.min(T,B);this.data[l+w]=Math.max(0,Math.min(255,(_.isDash?j:-j)+128))}}addDash(s,i){const r=i?7:0,l=2*r+1;if(this.nextRow+l>this.height)return a.w("LineAtlas out of space"),null;let d=0;for(let w=0;w<s.length;w++)d+=s[w];if(d!==0){const w=this.width/d,T=this.getDashRanges(s,this.width,w);i?this.addRoundDash(T,w,r):this.addRegularDash(T)}const _={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:d};return this.nextRow+=l,this.dirty=!0,_}bind(s){const i=s.gl;this.texture?(i.bindTexture(i.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,i.texSubImage2D(i.TEXTURE_2D,0,0,0,this.width,this.height,i.ALPHA,i.UNSIGNED_BYTE,this.data))):(this.texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.ALPHA,this.width,this.height,0,i.ALPHA,i.UNSIGNED_BYTE,this.data))}}const Ni="maplibre_preloaded_worker_pool";class en{constructor(){this.active={}}acquire(s){if(!this.workers)for(this.workers=[];this.workers.length<en.workerCount;)this.workers.push(new Worker(a.a.WORKER_URL));return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(i=>{i.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ni]}numActive(){return Object.keys(this.active).length}}const ji=Math.floor(ae.hardwareConcurrency/2);let Vi,nn;function vn(){return Vi||(Vi=new en),Vi}en.workerCount=a.B(globalThis)?Math.max(Math.min(ji,3),1):1;class Ci{constructor(s,i){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=i;const r=this.workerPool.acquire(i);for(let l=0;l<r.length;l++){const d=new a.C(r[l],i);d.name=`Worker ${l}`,this.actors.push(d)}if(!this.actors.length)throw new Error("No actors found")}broadcast(s,i){const r=[];for(const l of this.actors)r.push(l.sendAsync({type:s,data:i}));return Promise.all(r)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(s=!0){this.actors.forEach(i=>{i.remove()}),this.actors=[],s&&this.workerPool.release(this.id)}registerMessageHandler(s,i){for(const r of this.actors)r.registerMessageHandler(s,i)}}function mi(){return nn||(nn=new Ci(vn(),a.G),nn.registerMessageHandler("getResource",(y,s,i)=>a.m(s,i))),nn}function Ri(y,s){const i=a.F();return a.H(i,i,[1,1,0]),a.J(i,i,[.5*y.width,.5*y.height,1]),a.K(i,i,y.calculatePosMatrix(s.toUnwrapped()))}function Oi(y,s,i,r,l,d){const _=function(X,ce,Se){if(X)for(const Te of X){const Re=ce[Te];if(Re&&Re.source===Se&&Re.type==="fill-extrusion")return!0}else for(const Te in ce){const Re=ce[Te];if(Re.source===Se&&Re.type==="fill-extrusion")return!0}return!1}(l&&l.layers,s,y.id),w=d.maxPitchScaleFactor(),T=y.tilesIn(r,w,_);T.sort(_i);const B=[];for(const X of T)B.push({wrappedTileID:X.tileID.wrapped().key,queryResults:X.tile.queryRenderedFeatures(s,i,y._state,X.queryGeometry,X.cameraQueryGeometry,X.scale,l,d,w,Ri(y.transform,X.tileID))});const j=function(X){const ce={},Se={};for(const Te of X){const Re=Te.queryResults,Be=Te.wrappedTileID,Ke=Se[Be]=Se[Be]||{};for(const yt in Re){const ot=Re[yt],ct=Ke[yt]=Ke[yt]||{},It=ce[yt]=ce[yt]||[];for(const bt of ot)ct[bt.featureIndex]||(ct[bt.featureIndex]=!0,It.push(bt))}}return ce}(B);for(const X in j)j[X].forEach(ce=>{const Se=ce.feature,Te=y.getFeatureState(Se.layer["source-layer"],Se.id);Se.source=Se.layer.source,Se.layer["source-layer"]&&(Se.sourceLayer=Se.layer["source-layer"]),Se.state=Te});return j}function _i(y,s){const i=y.tileID,r=s.tileID;return i.overscaledZ-r.overscaledZ||i.canonical.y-r.canonical.y||i.wrap-r.wrap||i.canonical.x-r.canonical.x}function Ji(y,s,i){return a._(this,void 0,void 0,function*(){let r=y;if(y.url?r=(yield a.h(s.transformRequest(y.url,Tt.Source),i)).data:yield ae.frameAsync(i),!r)return null;const l=a.L(a.e(r,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in r&&r.vector_layers&&(l.vectorLayerIds=r.vector_layers.map(d=>d.id)),l})}class Ai{constructor(s,i){s&&(i?this.setSouthWest(s).setNorthEast(i):Array.isArray(s)&&(s.length===4?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1])))}setNorthEast(s){return this._ne=s instanceof a.M?new a.M(s.lng,s.lat):a.M.convert(s),this}setSouthWest(s){return this._sw=s instanceof a.M?new a.M(s.lng,s.lat):a.M.convert(s),this}extend(s){const i=this._sw,r=this._ne;let l,d;if(s instanceof a.M)l=s,d=s;else{if(!(s instanceof Ai))return Array.isArray(s)?s.length===4||s.every(Array.isArray)?this.extend(Ai.convert(s)):this.extend(a.M.convert(s)):s&&("lng"in s||"lon"in s)&&"lat"in s?this.extend(a.M.convert(s)):this;if(l=s._sw,d=s._ne,!l||!d)return this}return i||r?(i.lng=Math.min(l.lng,i.lng),i.lat=Math.min(l.lat,i.lat),r.lng=Math.max(d.lng,r.lng),r.lat=Math.max(d.lat,r.lat)):(this._sw=new a.M(l.lng,l.lat),this._ne=new a.M(d.lng,d.lat)),this}getCenter(){return new a.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.M(this.getWest(),this.getNorth())}getSouthEast(){return new a.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:i,lat:r}=a.M.convert(s);let l=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(l=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=r&&r<=this._ne.lat&&l}static convert(s){return s instanceof Ai?s:s&&new Ai(s)}static fromLngLat(s,i=0){const r=360*i/40075017,l=r/Math.cos(Math.PI/180*s.lat);return new Ai(new a.M(s.lng-l,s.lat-r),new a.M(s.lng+l,s.lat+r))}}class sn{constructor(s,i,r){this.bounds=Ai.convert(this.validateBounds(s)),this.minzoom=i||0,this.maxzoom=r||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){const i=Math.pow(2,s.z),r=Math.floor(a.N(this.bounds.getWest())*i),l=Math.floor(a.O(this.bounds.getNorth())*i),d=Math.ceil(a.N(this.bounds.getEast())*i),_=Math.ceil(a.O(this.bounds.getSouth())*i);return s.x>=r&&s.x<d&&s.y>=l&&s.y<_}}class ei extends a.E{constructor(s,i,r,l){if(super(),this.id=s,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.L(i,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(l)}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const s=yield Ji(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),s&&(a.e(this,s),s.bounds&&(this.tileBounds=new sn(s.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))}catch(s){this._tileJSONRequest=null,this.fire(new a.j(s))}})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}setSourceProperty(s){this._tileJSONRequest&&this._tileJSONRequest.abort(),s(),this.load()}setTiles(s){return this.setSourceProperty(()=>{this._options.tiles=s}),this}setUrl(s){return this.setSourceProperty(()=>{this.url=s,this._options.url=s}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return a.e({},this._options)}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r={request:this.map._requestManager.transformRequest(i,Tt.Tile),uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.request.collectResourceTiming=this._collectResourceTiming;let l="reloadTile";if(s.actor&&s.state!=="expired"){if(s.state==="loading")return new Promise((d,_)=>{s.reloadPromise={resolve:d,reject:_}})}else s.actor=this.dispatcher.getActor(),l="loadTile";s.abortController=new AbortController;try{const d=yield s.actor.sendAsync({type:l,data:r},s.abortController);if(delete s.abortController,s.aborted)return;this._afterTileLoadWorkerResponse(s,d)}catch(d){if(delete s.abortController,s.aborted)return;if(d&&d.status!==404)throw d;this._afterTileLoadWorkerResponse(s,null)}})}_afterTileLoadWorkerResponse(s,i){if(i&&i.resourceTiming&&(s.resourceTiming=i.resourceTiming),i&&this.map._refreshExpiredTiles&&s.setExpiryData(i),s.loadVectorData(i,this.map.painter),s.reloadPromise){const r=s.reloadPromise;s.reloadPromise=null,this.loadTile(s).then(r.resolve).catch(r.reject)}}abortTile(s){return a._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController),s.actor&&(yield s.actor.sendAsync({type:"abortTile",data:{uid:s.uid,type:this.type,source:this.id}}))})}unloadTile(s){return a._(this,void 0,void 0,function*(){s.unloadVectorData(),s.actor&&(yield s.actor.sendAsync({type:"removeTile",data:{uid:s.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class _n extends a.E{constructor(s,i,r,l){super(),this.id=s,this.dispatcher=r,this.setEventedParent(l),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},i),a.e(this,a.L(i,["url","scheme","tileSize"]))}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const s=yield Ji(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,s&&(a.e(this,s),s.bounds&&(this.tileBounds=new sn(s.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))}catch(s){this._tileJSONRequest=null,this.fire(new a.j(s))}})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(s){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),s(),this.load()}setTiles(s){return this.setSourceProperty(()=>{this._options.tiles=s}),this}setUrl(s){return this.setSourceProperty(()=>{this.url=s,this._options.url=s}),this}serialize(){return a.e({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);s.abortController=new AbortController;try{const r=yield xt.getImage(this.map._requestManager.transformRequest(i,Tt.Tile),s.abortController,this.map._refreshExpiredTiles);if(delete s.abortController,s.aborted)return void(s.state="unloaded");if(r&&r.data){this.map._refreshExpiredTiles&&r.cacheControl&&r.expires&&s.setExpiryData({cacheControl:r.cacheControl,expires:r.expires});const l=this.map.painter.context,d=l.gl,_=r.data;s.texture=this.map.painter.getTileTexture(_.width),s.texture?s.texture.update(_,{useMipmap:!0}):(s.texture=new Pt(l,_,d.RGBA,{useMipmap:!0}),s.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),l.extTextureFilterAnisotropic&&d.texParameterf(d.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax)),s.state="loaded"}}catch(r){if(delete s.abortController,s.aborted)s.state="unloaded";else if(r)throw s.state="errored",r}})}abortTile(s){return a._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController)})}unloadTile(s){return a._(this,void 0,void 0,function*(){s.texture&&this.map.painter.saveTileTexture(s.texture)})}hasTransition(){return!1}}class Pr extends _n{constructor(s,i,r,l){super(s,i,r,l),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox",this.redFactor=i.redFactor,this.greenFactor=i.greenFactor,this.blueFactor=i.blueFactor,this.baseShift=i.baseShift}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r=this.map._requestManager.transformRequest(i,Tt.Tile);s.neighboringTiles=this._getNeighboringTiles(s.tileID),s.abortController=new AbortController;try{const l=yield xt.getImage(r,s.abortController,this.map._refreshExpiredTiles);if(delete s.abortController,s.aborted)return void(s.state="unloaded");if(l&&l.data){const d=l.data;this.map._refreshExpiredTiles&&l.cacheControl&&l.expires&&s.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const _=a.b(d)&&a.S()?d:yield this.readImageNow(d),w={type:this.type,uid:s.uid,source:this.id,rawImageData:_,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!s.actor||s.state==="expired"){s.actor=this.dispatcher.getActor();const T=yield s.actor.sendAsync({type:"loadDEMTile",data:w});s.dem=T,s.needsHillshadePrepare=!0,s.needsTerrainPrepare=!0,s.state="loaded"}}}catch(l){if(delete s.abortController,s.aborted)s.state="unloaded";else if(l)throw s.state="errored",l}})}readImageNow(s){return a._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&a.U()){const i=s.width+2,r=s.height+2;try{return new a.R({width:i,height:r},yield a.V(s,-1,-1,i,r))}catch{}}return ae.getImageData(s,1)})}_getNeighboringTiles(s){const i=s.canonical,r=Math.pow(2,i.z),l=(i.x-1+r)%r,d=i.x===0?s.wrap-1:s.wrap,_=(i.x+1+r)%r,w=i.x+1===r?s.wrap+1:s.wrap,T={};return T[new a.Q(s.overscaledZ,d,i.z,l,i.y).key]={backfilled:!1},T[new a.Q(s.overscaledZ,w,i.z,_,i.y).key]={backfilled:!1},i.y>0&&(T[new a.Q(s.overscaledZ,d,i.z,l,i.y-1).key]={backfilled:!1},T[new a.Q(s.overscaledZ,s.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},T[new a.Q(s.overscaledZ,w,i.z,_,i.y-1).key]={backfilled:!1}),i.y+1<r&&(T[new a.Q(s.overscaledZ,d,i.z,l,i.y+1).key]={backfilled:!1},T[new a.Q(s.overscaledZ,s.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},T[new a.Q(s.overscaledZ,w,i.z,_,i.y+1).key]={backfilled:!1}),T}unloadTile(s){return a._(this,void 0,void 0,function*(){s.demTexture&&this.map.painter.saveTileTexture(s.demTexture),s.fbo&&(s.fbo.destroy(),delete s.fbo),s.dem&&delete s.dem,delete s.neighboringTiles,s.state="unloaded",s.actor&&(yield s.actor.sendAsync({type:"removeDEMTile",data:{type:this.type,uid:s.uid,source:this.id}}))})}}class ci extends a.E{constructor(s,i,r,l){super(),this.id=s,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=r.getActor(),this.setEventedParent(l),this._data=i.data,this._options=a.e({},i),this._collectResourceTiming=i.collectResourceTiming,i.maxzoom!==void 0&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const d=a.W/this.tileSize;this.workerOptions=a.e({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(i.buffer!==void 0?i.buffer:128)*d,tolerance:(i.tolerance!==void 0?i.tolerance:.375)*d,extent:a.W,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:i.clusterMaxZoom!==void 0?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:a.W,radius:(i.clusterRadius||50)*d,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return a._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(s){this.map=s,this.load()}setData(s){return this._data=s,this._updateWorkerData(),this}updateData(s){return this._updateWorkerData(s),this}setClusterOptions(s){return this.workerOptions.cluster=s.cluster,s&&(s.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=s.clusterRadius),s.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=s.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(s){return this.actor.sendAsync({type:"getClusterExpansionZoom",data:{type:this.type,clusterId:s,source:this.id}})}getClusterChildren(s){return this.actor.sendAsync({type:"getClusterChildren",data:{type:this.type,clusterId:s,source:this.id}})}getClusterLeaves(s,i,r){return this.actor.sendAsync({type:"getClusterLeaves",data:{type:this.type,source:this.id,clusterId:s,limit:i,offset:r}})}_updateWorkerData(s){return a._(this,void 0,void 0,function*(){const i=a.e({type:this.type},this.workerOptions);s?i.dataDiff=s:typeof this._data=="string"?(i.request=this.map._requestManager.transformRequest(ae.resolveURL(this._data),Tt.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new a.k("dataloading",{dataType:"source"}));try{const r=yield this.actor.sendAsync({type:"loadData",data:i});if(this._pendingLoads--,this._removed||r.abandoned)return void this.fire(new a.k("dataabort",{dataType:"source"}));let l=null;r.resourceTiming&&r.resourceTiming[this.id]&&(l=r.resourceTiming[this.id].slice(0));const d={dataType:"source"};this._collectResourceTiming&&l&&l.length>0&&a.e(d,{resourceTiming:l}),this.fire(new a.k("data",Object.assign(Object.assign({},d),{sourceDataType:"metadata"}))),this.fire(new a.k("data",Object.assign(Object.assign({},d),{sourceDataType:"content"})))}catch(r){if(this._pendingLoads--,this._removed)return void this.fire(new a.k("dataabort",{dataType:"source"}));this.fire(new a.j(r))}})}loaded(){return this._pendingLoads===0}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.actor?"reloadTile":"loadTile";s.actor=this.actor;const r={type:this.type,uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};s.abortController=new AbortController;const l=yield this.actor.sendAsync({type:i,data:r},s.abortController);delete s.abortController,s.unloadVectorData(),s.aborted||s.loadVectorData(l,this.map.painter,i==="reloadTile")})}abortTile(s){return a._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController),s.aborted=!0})}unloadTile(s){return a._(this,void 0,void 0,function*(){s.unloadVectorData(),yield this.actor.sendAsync({type:"removeTile",data:{uid:s.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"removeSource",data:{type:this.type,source:this.id}})}serialize(){return a.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var rn=a.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class tr extends a.E{constructor(s,i,r,l){super(),this.id=s,this.dispatcher=r,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(l),this.options=i}load(s){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const i=yield xt.getImage(this.map._requestManager.transformRequest(this.url,Tt.Image),this._request);this._request=null,this._loaded=!0,i&&i.data&&(this.image=i.data,s&&(this.coordinates=s),this._finishLoading())}catch(i){this._request=null,this.fire(new a.j(i))}})}loaded(){return this._loaded}updateImage(s){return s.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=s.url,this.load(s.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(s){this.coordinates=s;const i=s.map(a.Y.fromLngLat);this.tileID=function(l){let d=1/0,_=1/0,w=-1/0,T=-1/0;for(const ce of l)d=Math.min(d,ce.x),_=Math.min(_,ce.y),w=Math.max(w,ce.x),T=Math.max(T,ce.y);const B=Math.max(w-d,T-_),j=Math.max(0,Math.floor(-Math.log(B)/Math.LN2)),X=Math.pow(2,j);return new a.a0(j,Math.floor((d+w)/2*X),Math.floor((_+T)/2*X))}(i),this.minzoom=this.maxzoom=this.tileID.z;const r=i.map(l=>this.tileID.getTilePoint(l)._round());return this._boundsArray=new a.Z,this._boundsArray.emplaceBack(r[0].x,r[0].y,0,0),this._boundsArray.emplaceBack(r[1].x,r[1].y,a.W,0),this._boundsArray.emplaceBack(r[3].x,r[3].y,0,a.W),this._boundsArray.emplaceBack(r[2].x,r[2].y,a.W,a.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const s=this.map.painter.context,i=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,rn.members)),this.boundsSegments||(this.boundsSegments=a.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Pt(s,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let r=!1;for(const l in this.tiles){const d=this.tiles[l];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture,r=!0)}r&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(s){return a._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={}):s.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Pn extends tr{constructor(s,i,r,l){super(s,i,r,l),this.roundZoom=!0,this.type="video",this.options=i}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1;const s=this.options;this.urls=[];for(const i of s.urls)this.urls.push(this.map._requestManager.transformRequest(i,Tt.Source).url);try{const i=yield a.a2(this.urls);if(this._loaded=!0,!i)return;this.video=i,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(i){this.fire(new a.j(i))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(s){if(this.video){const i=this.video.seekable;s<i.start(0)||s>i.end(0)?this.fire(new a.j(new a.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=s}}getVideo(){return this.video}onAdd(s){this.map||(this.map=s,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const s=this.map.painter.context,i=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,rn.members)),this.boundsSegments||(this.boundsSegments=a.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new Pt(s,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let r=!1;for(const l in this.tiles){const d=this.tiles[l];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture,r=!0)}r&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Qn extends tr{constructor(s,i,r,l){super(s,i,r,l),i.coordinates?Array.isArray(i.coordinates)&&i.coordinates.length===4&&!i.coordinates.some(d=>!Array.isArray(d)||d.length!==2||d.some(_=>typeof _!="number"))||this.fire(new a.j(new a.a1(`sources.${s}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.j(new a.a1(`sources.${s}`,null,'missing required property "coordinates"'))),i.animate&&typeof i.animate!="boolean"&&this.fire(new a.j(new a.a1(`sources.${s}`,null,'optional "animate" property must be a boolean value'))),i.canvas?typeof i.canvas=="string"||i.canvas instanceof HTMLCanvasElement||this.fire(new a.j(new a.a1(`sources.${s}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.j(new a.a1(`sources.${s}`,null,'missing required property "canvas"'))),this.options=i,this.animate=i.animate===void 0||i.animate}load(){return a._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(s){this.map=s,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let s=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,s=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,s=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const i=this.map.painter.context,r=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,rn.members)),this.boundsSegments||(this.boundsSegments=a.$.simpleSegment(0,0,4,2)),this.texture?(s||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Pt(i,this.canvas,r.RGBA,{premultiply:!0});let l=!1;for(const d in this.tiles){const _=this.tiles[d];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,l=!0)}l&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const s of[this.canvas.width,this.canvas.height])if(isNaN(s)||s<=0)return!0;return!1}}const In={},v=y=>{switch(y){case"geojson":return ci;case"image":return tr;case"raster":return _n;case"raster-dem":return Pr;case"vector":return ei;case"video":return Pn;case"canvas":return Qn}return In[y]};class k extends a.E{constructor(){super(...arguments),this.pluginStatus="unavailable",this.pluginURL=null,this.dispatcher=mi(),this.queue=[]}_sendPluginStateToWorker(){return a._(this,void 0,void 0,function*(){yield this.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}),this.fire(new a.k("pluginStateChange",{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}))})}getRTLTextPluginStatus(){return this.pluginStatus}clearRTLTextPlugin(){this.pluginStatus="unavailable",this.pluginURL=null}setRTLTextPlugin(s,i=!1){return a._(this,void 0,void 0,function*(){if(this.pluginStatus==="deferred"||this.pluginStatus==="loading"||this.pluginStatus==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");this.pluginURL=ae.resolveURL(s),this.pluginStatus="deferred",yield this._sendPluginStateToWorker(),i||(yield this._downloadRTLTextPlugin())})}_downloadRTLTextPlugin(){return a._(this,void 0,void 0,function*(){if(this.pluginStatus!=="deferred"||!this.pluginURL)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");try{this.pluginStatus="loading",yield this._sendPluginStateToWorker(),yield a.l({url:this.pluginURL},new AbortController),this.pluginStatus="loaded"}catch{this.pluginStatus="error"}yield this._sendPluginStateToWorker()})}lazyLoadRTLTextPlugin(){return a._(this,void 0,void 0,function*(){this.pluginStatus==="deferred"&&(yield this._downloadRTLTextPlugin())})}}let V=null;function Y(){return V||(V=new k),V}class te{constructor(s,i){this.timeAdded=0,this.fadeEndTime=0,this.tileID=s,this.uid=a.a3(),this.uses=0,this.tileSize=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(s){const i=s+this.timeAdded;i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(s){this.demTexture&&s.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(s,i,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(l,d){const _={};if(!d)return _;for(const w of l){const T=w.layerIds.map(B=>d.getLayer(B)).filter(Boolean);if(T.length!==0){w.layers=T,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(B=>T.filter(j=>j.id===B)[0]));for(const B of T)_[B.id]=w}}return _}(s.buckets,i.style),this.hasSymbolBuckets=!1;for(const l in this.buckets){const d=this.buckets[l];if(d instanceof a.a5){if(this.hasSymbolBuckets=!0,!r)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const l in this.buckets){const d=this.buckets[l];if(d instanceof a.a5&&d.hasRTLText){this.hasRTLText=!0,Y().lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const l in this.buckets){const d=this.buckets[l];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(l).queryRadius(d))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage)}else this.collisionBoxArray=new a.a4}unloadVectorData(){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(s){return this.buckets[s.id]}upload(s){for(const r in this.buckets){const l=this.buckets[r];l.uploadPending()&&l.upload(s)}const i=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Pt(s,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Pt(s,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null)}prepare(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)}queryRenderedFeatures(s,i,r,l,d,_,w,T,B,j){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:l,cameraQueryGeometry:d,scale:_,tileSize:this.tileSize,pixelPosMatrix:j,transform:T,params:w,queryPadding:this.queryPadding*B},s,i,r):{}}querySourceFeatures(s,i){const r=this.latestFeatureIndex;if(!r||!r.rawTileData)return;const l=r.loadVTLayers(),d=i&&i.sourceLayer?i.sourceLayer:"",_=l._geojsonTileLayer||l[d];if(!_)return;const w=a.a6(i&&i.filter),{z:T,x:B,y:j}=this.tileID.canonical,X={z:T,x:B,y:j};for(let ce=0;ce<_.length;ce++){const Se=_.feature(ce);if(w.needGeometry){const Be=a.a7(Se,!0);if(!w.filter(new a.a8(this.tileID.overscaledZ),Be,this.tileID.canonical))continue}else if(!w.filter(new a.a8(this.tileID.overscaledZ),Se))continue;const Te=r.getId(Se,d),Re=new a.a9(Se,T,B,j,Te);Re.tile=X,s.push(Re)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const i=this.expirationTime;if(s.cacheControl){const r=a.aa(s.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const r=Date.now();let l=!1;if(this.expirationTime>r)l=!1;else if(i)if(this.expirationTime<i)l=!0;else{const d=this.expirationTime-i;d?this.expirationTime=r+Math.max(d,3e4):l=!0}else l=!0;l?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(s,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(s).length===0)return;const r=this.latestFeatureIndex.loadVTLayers();for(const l in this.buckets){if(!i.style.hasLayer(l))continue;const d=this.buckets[l],_=d.layers[0].sourceLayer||"_geojsonTileLayer",w=r[_],T=s[_];if(!w||!T||Object.keys(T).length===0)continue;d.update(T,w,this.imageAtlas&&this.imageAtlas.patternPositions||{});const B=i&&i.style&&i.style.getLayer(l);B&&(this.queryPadding=Math.max(this.queryPadding,B.queryRadius(d)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ae.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=ae.now()+s}setDependencies(s,i){const r={};for(const l of i)r[l]=!0;this.dependencies[s]=r}hasDependency(s,i){for(const r of s){const l=this.dependencies[r];if(l){for(const d of i)if(l[d])return!0}}return!1}}class fe{constructor(s,i){this.max=s,this.onRemove=i,this.reset()}reset(){for(const s in this.data)for(const i of this.data[s])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(s,i,r){const l=s.wrapped().key;this.data[l]===void 0&&(this.data[l]=[]);const d={value:i,timeout:void 0};if(r!==void 0&&(d.timeout=setTimeout(()=>{this.remove(s,d)},r)),this.data[l].push(d),this.order.push(l),this.order.length>this.max){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const i=this.data[s].shift();return i.timeout&&clearTimeout(i.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),i.value}getByKey(s){const i=this.data[s];return i?i[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,i){if(!this.has(s))return this;const r=s.wrapped().key,l=i===void 0?0:this.data[r].indexOf(i),d=this.data[r][l];return this.data[r].splice(l,1),d.timeout&&clearTimeout(d.timeout),this.data[r].length===0&&delete this.data[r],this.onRemove(d.value),this.order.splice(this.order.indexOf(r),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(s){const i=[];for(const r in this.data)for(const l of this.data[r])s(l.value)||i.push(l);for(const r of i)this.remove(r.value.tileID,r)}}class ve{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,i,r){const l=String(i);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][l]=this.stateChanges[s][l]||{},a.e(this.stateChanges[s][l],r),this.deletedStates[s]===null){this.deletedStates[s]={};for(const d in this.state[s])d!==l&&(this.deletedStates[s][d]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][l]===null){this.deletedStates[s][l]={};for(const d in this.state[s][l])r[d]||(this.deletedStates[s][l][d]=null)}else for(const d in r)this.deletedStates[s]&&this.deletedStates[s][l]&&this.deletedStates[s][l][d]===null&&delete this.deletedStates[s][l][d]}removeFeatureState(s,i,r){if(this.deletedStates[s]===null)return;const l=String(i);if(this.deletedStates[s]=this.deletedStates[s]||{},r&&i!==void 0)this.deletedStates[s][l]!==null&&(this.deletedStates[s][l]=this.deletedStates[s][l]||{},this.deletedStates[s][l][r]=null);else if(i!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][l])for(r in this.deletedStates[s][l]={},this.stateChanges[s][l])this.deletedStates[s][l][r]=null;else this.deletedStates[s][l]=null;else this.deletedStates[s]=null}getState(s,i){const r=String(i),l=a.e({},(this.state[s]||{})[r],(this.stateChanges[s]||{})[r]);if(this.deletedStates[s]===null)return{};if(this.deletedStates[s]){const d=this.deletedStates[s][i];if(d===null)return{};for(const _ in d)delete l[_]}return l}initializeTileState(s,i){s.setFeatureState(this.state,i)}coalesceChanges(s,i){const r={};for(const l in this.stateChanges){this.state[l]=this.state[l]||{};const d={};for(const _ in this.stateChanges[l])this.state[l][_]||(this.state[l][_]={}),a.e(this.state[l][_],this.stateChanges[l][_]),d[_]=this.state[l][_];r[l]=d}for(const l in this.deletedStates){this.state[l]=this.state[l]||{};const d={};if(this.deletedStates[l]===null)for(const _ in this.state[l])d[_]={},this.state[l][_]={};else for(const _ in this.deletedStates[l]){if(this.deletedStates[l][_]===null)this.state[l][_]={};else for(const w of Object.keys(this.deletedStates[l][_]))delete this.state[l][_][w];d[_]=this.state[l][_]}r[l]=r[l]||{},a.e(r[l],d)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(const l in s)s[l].setFeatureState(r,i)}}class Ie extends a.E{constructor(s,i,r){super(),this.id=s,this.dispatcher=r,this.on("data",l=>{l.dataType==="source"&&l.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&l.dataType==="source"&&l.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((l,d,_,w)=>{const T=new(v(d.type))(l,d,_,w);if(T.id!==l)throw new Error(`Expected Source id to be ${l} instead of ${T.id}`);return T})(s,i,r,this),this._tiles={},this._cache=new fe(0,l=>this._unloadTile(l)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ve,this._didEmitContent=!1,this._updated=!1}onAdd(s){this.map=s,this._maxTileCacheSize=s?s._maxTileCacheSize:null,this._maxTileCacheZoomLevels=s?s._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(s)}onRemove(s){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(s)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const s in this._tiles){const i=this._tiles[s];if(i.state!=="loaded"&&i.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(s,i,r){return a._(this,void 0,void 0,function*(){try{yield this._source.loadTile(s),this._tileLoaded(s,i,r)}catch(l){s.state="errored",l.status!==404?this._source.fire(new a.j(l,{tile:s})):this.update(this.transform,this.terrain)}})}_unloadTile(s){this._source.unloadTile&&this._source.unloadTile(s)}_abortTile(s){this._source.abortTile&&this._source.abortTile(s),this._source.fire(new a.k("dataabort",{tile:s,coord:s.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const r=this._tiles[i];r.upload(s),r.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(s=>s.tileID).sort(Ee).map(s=>s.key)}getRenderableIds(s){const i=[];for(const r in this._tiles)this._isIdRenderable(r,s)&&i.push(this._tiles[r]);return s?i.sort((r,l)=>{const d=r.tileID,_=l.tileID,w=new a.P(d.canonical.x,d.canonical.y)._rotate(this.transform.angle),T=new a.P(_.canonical.x,_.canonical.y)._rotate(this.transform.angle);return d.overscaledZ-_.overscaledZ||T.y-w.y||T.x-w.x}).map(r=>r.tileID.key):i.map(r=>r.tileID).sort(Ee).map(r=>r.key)}hasRenderableParent(s){const i=this.findLoadedParent(s,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(s,i){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(i||!this._tiles[s].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(s,"reloading")}}_reloadTile(s,i){return a._(this,void 0,void 0,function*(){const r=this._tiles[s];r&&(r.state!=="loading"&&(r.state=i),yield this._loadTile(r,s,i))})}_tileLoaded(s,i,r){s.timeAdded=ae.now(),r==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(i,s),this.getSource().type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),s.aborted||this._source.fire(new a.k("data",{dataType:"source",tile:s,coord:s.tileID}))}_backfillDEM(s){const i=this.getRenderableIds();for(let l=0;l<i.length;l++){const d=i[l];if(s.neighboringTiles&&s.neighboringTiles[d]){const _=this.getTileByID(d);r(s,_),r(_,s)}}function r(l,d){l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0;let _=d.tileID.canonical.x-l.tileID.canonical.x;const w=d.tileID.canonical.y-l.tileID.canonical.y,T=Math.pow(2,l.tileID.canonical.z),B=d.tileID.key;_===0&&w===0||Math.abs(w)>1||(Math.abs(_)>1&&(Math.abs(_+T)===1?_+=T:Math.abs(_-T)===1&&(_-=T)),d.dem&&l.dem&&(l.dem.backfillBorder(d.dem,_,w),l.neighboringTiles&&l.neighboringTiles[B]&&(l.neighboringTiles[B].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,i,r,l){for(const d in this._tiles){let _=this._tiles[d];if(l[d]||!_.hasData()||_.tileID.overscaledZ<=i||_.tileID.overscaledZ>r)continue;let w=_.tileID;for(;_&&_.tileID.overscaledZ>i+1;){const B=_.tileID.scaledTo(_.tileID.overscaledZ-1);_=this._tiles[B.key],_&&_.hasData()&&(w=B)}let T=w;for(;T.overscaledZ>i;)if(T=T.scaledTo(T.overscaledZ-1),s[T.key]){l[w.key]=w;break}}}findLoadedParent(s,i){if(s.key in this._loadedParentTiles){const r=this._loadedParentTiles[s.key];return r&&r.tileID.overscaledZ>=i?r:null}for(let r=s.overscaledZ-1;r>=i;r--){const l=s.scaledTo(r),d=this._getLoadedTile(l);if(d)return d}}_getLoadedTile(s){const i=this._tiles[s.key];return i&&i.hasData()?i:this._cache.getByKey(s.wrapped().key)}updateCacheSize(s){const i=Math.ceil(s.width/this._source.tileSize)+1,r=Math.ceil(s.height/this._source.tileSize)+1,l=Math.floor(i*r*(this._maxTileCacheZoomLevels===null?a.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),d=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,l):l;this._cache.setMaxSize(d)}handleWrapJump(s){const i=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,i){const r={};for(const l in this._tiles){const d=this._tiles[l];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+i),r[d.tileID.key]=d}this._tiles=r;for(const l in this._timers)clearTimeout(this._timers[l]),delete this._timers[l];for(const l in this._tiles)this._setTileReloadTimer(l,this._tiles[l])}}update(s,i){if(this.transform=s,this.terrain=i,!this._sourceLoaded||this._paused)return;let r;this.updateCacheSize(s),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?r=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(j=>new a.Q(j.canonical.z,j.wrap,j.canonical.z,j.canonical.x,j.canonical.y)):(r=s.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:i}),this._source.hasTile&&(r=r.filter(j=>this._source.hasTile(j)))):r=[];const l=s.coveringZoomLevel(this._source),d=Math.max(l-Ie.maxOverzooming,this._source.minzoom),_=Math.max(l+Ie.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const j={};for(const X of r)if(X.canonical.z>this._source.minzoom){const ce=X.scaledTo(X.canonical.z-1);j[ce.key]=ce;const Se=X.scaledTo(Math.max(this._source.minzoom,Math.min(X.canonical.z,5)));j[Se.key]=Se}r=r.concat(Object.values(j))}const w=r.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,w&&this.fire(new a.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const T=this._updateRetainedTiles(r,l);if(ze(this._source.type)){const j={},X={},ce=Object.keys(T),Se=ae.now();for(const Te of ce){const Re=T[Te],Be=this._tiles[Te];if(!Be||Be.fadeEndTime!==0&&Be.fadeEndTime<=Se)continue;const Ke=this.findLoadedParent(Re,d);Ke&&(this._addTile(Ke.tileID),j[Ke.tileID.key]=Ke.tileID),X[Te]=Re}this._retainLoadedChildren(X,l,_,T);for(const Te in j)T[Te]||(this._coveredTiles[Te]=!0,T[Te]=j[Te]);if(i){const Te={},Re={};for(const Be of r)this._tiles[Be.key].hasData()?Te[Be.key]=Be:Re[Be.key]=Be;for(const Be in Re){const Ke=Re[Be].children(this._source.maxzoom);this._tiles[Ke[0].key]&&this._tiles[Ke[1].key]&&this._tiles[Ke[2].key]&&this._tiles[Ke[3].key]&&(Te[Ke[0].key]=T[Ke[0].key]=Ke[0],Te[Ke[1].key]=T[Ke[1].key]=Ke[1],Te[Ke[2].key]=T[Ke[2].key]=Ke[2],Te[Ke[3].key]=T[Ke[3].key]=Ke[3],delete Re[Be])}for(const Be in Re){const Ke=this.findLoadedParent(Re[Be],this._source.minzoom);if(Ke){Te[Ke.tileID.key]=T[Ke.tileID.key]=Ke.tileID;for(const yt in Te)Te[yt].isChildOf(Ke.tileID)&&delete Te[yt]}}for(const Be in this._tiles)Te[Be]||(this._coveredTiles[Be]=!0)}}for(const j in T)this._tiles[j].clearFadeHold();const B=a.ab(this._tiles,T);for(const j of B){const X=this._tiles[j];X.hasSymbolBuckets&&!X.holdingForFade()?X.setHoldDuration(this.map._fadeDuration):X.hasSymbolBuckets&&!X.symbolFadeFinished()||this._removeTile(j)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(s)}_updateRetainedTiles(s,i){const r={},l={},d=Math.max(i-Ie.maxOverzooming,this._source.minzoom),_=Math.max(i+Ie.maxUnderzooming,this._source.minzoom),w={};for(const T of s){const B=this._addTile(T);r[T.key]=T,B.hasData()||i<this._source.maxzoom&&(w[T.key]=T)}this._retainLoadedChildren(w,i,_,r);for(const T of s){let B=this._tiles[T.key];if(B.hasData())continue;if(i+1>this._source.maxzoom){const X=T.children(this._source.maxzoom)[0],ce=this.getTile(X);if(ce&&ce.hasData()){r[X.key]=X;continue}}else{const X=T.children(this._source.maxzoom);if(r[X[0].key]&&r[X[1].key]&&r[X[2].key]&&r[X[3].key])continue}let j=B.wasRequested();for(let X=T.overscaledZ-1;X>=d;--X){const ce=T.scaledTo(X);if(l[ce.key])break;if(l[ce.key]=!0,B=this.getTile(ce),!B&&j&&(B=this._addTile(ce)),B){const Se=B.hasData();if((j||Se)&&(r[ce.key]=ce),j=B.wasRequested(),Se)break}}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const i=[];let r,l=this._tiles[s].tileID;for(;l.overscaledZ>0;){if(l.key in this._loadedParentTiles){r=this._loadedParentTiles[l.key];break}i.push(l.key);const d=l.scaledTo(l.overscaledZ-1);if(r=this._getLoadedTile(d),r)break;l=d}for(const d of i)this._loadedParentTiles[d]=r}}_addTile(s){let i=this._tiles[s.key];if(i)return i;i=this._cache.getAndRemove(s),i&&(this._setTileReloadTimer(s.key,i),i.tileID=s,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,i)));const r=i;return i||(i=new te(s,this._source.tileSize*s.overscaleFactor()),this._loadTile(i,s.key,i.state)),i.uses++,this._tiles[s.key]=i,r||this._source.fire(new a.k("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i}_setTileReloadTimer(s,i){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const r=i.getExpiryTimeout();r&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},r))}_removeTile(s){const i=this._tiles[s];i&&(i.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(s);this._cache.reset()}tilesIn(s,i,r){const l=[],d=this.transform;if(!d)return l;const _=r?d.getCameraQueryGeometry(s):s,w=s.map(Te=>d.pointCoordinate(Te,this.terrain)),T=_.map(Te=>d.pointCoordinate(Te,this.terrain)),B=this.getIds();let j=1/0,X=1/0,ce=-1/0,Se=-1/0;for(const Te of T)j=Math.min(j,Te.x),X=Math.min(X,Te.y),ce=Math.max(ce,Te.x),Se=Math.max(Se,Te.y);for(let Te=0;Te<B.length;Te++){const Re=this._tiles[B[Te]];if(Re.holdingForFade())continue;const Be=Re.tileID,Ke=Math.pow(2,d.zoom-Re.tileID.overscaledZ),yt=i*Re.queryPadding*a.W/Re.tileSize/Ke,ot=[Be.getTilePoint(new a.Y(j,X)),Be.getTilePoint(new a.Y(ce,Se))];if(ot[0].x-yt<a.W&&ot[0].y-yt<a.W&&ot[1].x+yt>=0&&ot[1].y+yt>=0){const ct=w.map(bt=>Be.getTilePoint(bt)),It=T.map(bt=>Be.getTilePoint(bt));l.push({tile:Re,tileID:Be,queryGeometry:ct,cameraQueryGeometry:It,scale:Ke})}}return l}getVisibleCoordinates(s){const i=this.getRenderableIds(s).map(r=>this._tiles[r].tileID);for(const r of i)r.posMatrix=this.transform.calculatePosMatrix(r.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(ze(this._source.type)){const s=ae.now();for(const i in this._tiles)if(this._tiles[i].fadeEndTime>=s)return!0}return!1}setFeatureState(s,i,r){this._state.updateState(s=s||"_geojsonTileLayer",i,r)}removeFeatureState(s,i,r){this._state.removeFeatureState(s=s||"_geojsonTileLayer",i,r)}getFeatureState(s,i){return this._state.getState(s=s||"_geojsonTileLayer",i)}setDependencies(s,i,r){const l=this._tiles[s];l&&l.setDependencies(i,r)}reloadTilesForDependencies(s,i){for(const r in this._tiles)this._tiles[r].hasDependency(s,i)&&this._reloadTile(r,"reloading");this._cache.filter(r=>!r.hasDependency(s,i))}}function Ee(y,s){const i=Math.abs(2*y.wrap)-+(y.wrap<0),r=Math.abs(2*s.wrap)-+(s.wrap<0);return y.overscaledZ-s.overscaledZ||r-i||s.canonical.y-y.canonical.y||s.canonical.x-y.canonical.x}function ze(y){return y==="raster"||y==="image"||y==="video"}Ie.maxOverzooming=10,Ie.maxUnderzooming=3;class We{constructor(s,i){this.reset(s,i)}reset(s,i){this.points=s||[],this._distances=[0];for(let r=1;r<this.points.length;r++)this._distances[r]=this._distances[r-1]+this.points[r].dist(this.points[r-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(i||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=a.ac(s,0,1);let i=1,r=this._distances[i];const l=s*this.paddedLength+this.padding;for(;r<l&&i<this._distances.length;)r=this._distances[++i];const d=i-1,_=this._distances[d],w=r-_,T=w>0?(l-_)/w:0;return this.points[d].mult(1-T).add(this.points[i].mult(T))}}function He(y,s){let i=!0;return y==="always"||y!=="never"&&s!=="never"||(i=!1),i}class Qe{constructor(s,i,r){const l=this.boxCells=[],d=this.circleCells=[];this.xCellCount=Math.ceil(s/r),this.yCellCount=Math.ceil(i/r);for(let _=0;_<this.xCellCount*this.yCellCount;_++)l.push([]),d.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=i,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/i,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,i,r,l,d){this._forEachCell(i,r,l,d,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(d)}insertCircle(s,i,r,l){this._forEachCell(i-l,r-l,i+l,r+l,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(i),this.circles.push(r),this.circles.push(l)}_insertBoxCell(s,i,r,l,d,_){this.boxCells[d].push(_)}_insertCircleCell(s,i,r,l,d,_){this.circleCells[d].push(_)}_query(s,i,r,l,d,_,w){if(r<0||s>this.width||l<0||i>this.height)return[];const T=[];if(s<=0&&i<=0&&this.width<=r&&this.height<=l){if(d)return[{key:null,x1:s,y1:i,x2:r,y2:l}];for(let B=0;B<this.boxKeys.length;B++)T.push({key:this.boxKeys[B],x1:this.bboxes[4*B],y1:this.bboxes[4*B+1],x2:this.bboxes[4*B+2],y2:this.bboxes[4*B+3]});for(let B=0;B<this.circleKeys.length;B++){const j=this.circles[3*B],X=this.circles[3*B+1],ce=this.circles[3*B+2];T.push({key:this.circleKeys[B],x1:j-ce,y1:X-ce,x2:j+ce,y2:X+ce})}}else this._forEachCell(s,i,r,l,this._queryCell,T,{hitTest:d,overlapMode:_,seenUids:{box:{},circle:{}}},w);return T}query(s,i,r,l){return this._query(s,i,r,l,!1,null)}hitTest(s,i,r,l,d,_){return this._query(s,i,r,l,!0,d,_).length>0}hitTestCircle(s,i,r,l,d){const _=s-r,w=s+r,T=i-r,B=i+r;if(w<0||_>this.width||B<0||T>this.height)return!1;const j=[];return this._forEachCell(_,T,w,B,this._queryCellCircle,j,{hitTest:!0,overlapMode:l,circle:{x:s,y:i,radius:r},seenUids:{box:{},circle:{}}},d),j.length>0}_queryCell(s,i,r,l,d,_,w,T){const{seenUids:B,hitTest:j,overlapMode:X}=w,ce=this.boxCells[d];if(ce!==null){const Te=this.bboxes;for(const Re of ce)if(!B.box[Re]){B.box[Re]=!0;const Be=4*Re,Ke=this.boxKeys[Re];if(s<=Te[Be+2]&&i<=Te[Be+3]&&r>=Te[Be+0]&&l>=Te[Be+1]&&(!T||T(Ke))&&(!j||!He(X,Ke.overlapMode))&&(_.push({key:Ke,x1:Te[Be],y1:Te[Be+1],x2:Te[Be+2],y2:Te[Be+3]}),j))return!0}}const Se=this.circleCells[d];if(Se!==null){const Te=this.circles;for(const Re of Se)if(!B.circle[Re]){B.circle[Re]=!0;const Be=3*Re,Ke=this.circleKeys[Re];if(this._circleAndRectCollide(Te[Be],Te[Be+1],Te[Be+2],s,i,r,l)&&(!T||T(Ke))&&(!j||!He(X,Ke.overlapMode))){const yt=Te[Be],ot=Te[Be+1],ct=Te[Be+2];if(_.push({key:Ke,x1:yt-ct,y1:ot-ct,x2:yt+ct,y2:ot+ct}),j)return!0}}}return!1}_queryCellCircle(s,i,r,l,d,_,w,T){const{circle:B,seenUids:j,overlapMode:X}=w,ce=this.boxCells[d];if(ce!==null){const Te=this.bboxes;for(const Re of ce)if(!j.box[Re]){j.box[Re]=!0;const Be=4*Re,Ke=this.boxKeys[Re];if(this._circleAndRectCollide(B.x,B.y,B.radius,Te[Be+0],Te[Be+1],Te[Be+2],Te[Be+3])&&(!T||T(Ke))&&!He(X,Ke.overlapMode))return _.push(!0),!0}}const Se=this.circleCells[d];if(Se!==null){const Te=this.circles;for(const Re of Se)if(!j.circle[Re]){j.circle[Re]=!0;const Be=3*Re,Ke=this.circleKeys[Re];if(this._circlesCollide(Te[Be],Te[Be+1],Te[Be+2],B.x,B.y,B.radius)&&(!T||T(Ke))&&!He(X,Ke.overlapMode))return _.push(!0),!0}}}_forEachCell(s,i,r,l,d,_,w,T){const B=this._convertToXCellCoord(s),j=this._convertToYCellCoord(i),X=this._convertToXCellCoord(r),ce=this._convertToYCellCoord(l);for(let Se=B;Se<=X;Se++)for(let Te=j;Te<=ce;Te++)if(d.call(this,s,i,r,l,this.xCellCount*Te+Se,_,w,T))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,i,r,l,d,_){const w=l-s,T=d-i,B=r+_;return B*B>w*w+T*T}_circleAndRectCollide(s,i,r,l,d,_,w){const T=(_-l)/2,B=Math.abs(s-(l+T));if(B>T+r)return!1;const j=(w-d)/2,X=Math.abs(i-(d+j));if(X>j+r)return!1;if(B<=T||X<=j)return!0;const ce=B-T,Se=X-j;return ce*ce+Se*Se<=r*r}}function Ue(y,s,i,r,l){const d=a.F();return s?(a.J(d,d,[1/l,1/l,1]),i||a.ad(d,d,r.angle)):a.K(d,r.labelPlaneMatrix,y),d}function ft(y,s,i,r,l){if(s){const d=a.ae(y);return a.J(d,d,[l,l,1]),i||a.ad(d,d,-r.angle),d}return r.glCoordMatrix}function st(y,s,i){let r;i?(r=[y.x,y.y,i(y.x,y.y),1],a.af(r,r,s)):(r=[y.x,y.y,0,1],De(r,r,s));const l=r[3];return{point:new a.P(r[0]/l,r[1]/l),signedDistanceFromCamera:l}}function Me(y,s){return .5+y/s*.5}function se(y,s){const i=y[0]/y[3],r=y[1]/y[3];return i>=-s[0]&&i<=s[0]&&r>=-s[1]&&r<=s[1]}function ne(y,s,i,r,l,d,_,w,T,B){const j=r?y.textSizeData:y.iconSizeData,X=a.ag(j,i.transform.zoom),ce=[256/i.width*2+1,256/i.height*2+1],Se=r?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;Se.clear();const Te=y.lineVertexArray,Re=r?y.text.placedSymbolArray:y.icon.placedSymbolArray,Be=i.transform.width/i.transform.height;let Ke=!1;for(let yt=0;yt<Re.length;yt++){const ot=Re.get(yt);if(ot.hidden||ot.writingMode===a.ah.vertical&&!Ke){Ye(ot.numGlyphs,Se);continue}let ct;if(Ke=!1,B?(ct=[ot.anchorX,ot.anchorY,B(ot.anchorX,ot.anchorY),1],a.af(ct,ct,s)):(ct=[ot.anchorX,ot.anchorY,0,1],De(ct,ct,s)),!se(ct,ce)){Ye(ot.numGlyphs,Se);continue}const It=Me(i.transform.cameraToCenterDistance,ct[3]),bt=a.ai(j,X,ot),ri=_?bt/It:bt*It,Xt=new a.P(ot.anchorX,ot.anchorY),ti=st(Xt,l,B).point,si={projections:{},offsets:{}},Qi=de(ot,ri,!1,w,s,l,d,y.glyphOffsetArray,Te,Se,ti,Xt,si,Be,T,B);Ke=Qi.useVertical,(Qi.notEnoughRoom||Ke||Qi.needsFlipping&&de(ot,ri,!0,w,s,l,d,y.glyphOffsetArray,Te,Se,ti,Xt,si,Be,T,B).notEnoughRoom)&&Ye(ot.numGlyphs,Se)}r?y.text.dynamicLayoutVertexBuffer.updateData(Se):y.icon.dynamicLayoutVertexBuffer.updateData(Se)}function $(y,s,i,r,l,d,_,w,T,B,j,X,ce){const Se=w.glyphStartIndex+w.numGlyphs,Te=w.lineStartIndex,Re=w.lineStartIndex+w.lineLength,Be=s.getoffsetX(w.glyphStartIndex),Ke=s.getoffsetX(Se-1),yt=Ve(y*Be,i,r,l,d,_,w.segment,Te,Re,T,B,j,X,ce);if(!yt)return null;const ot=Ve(y*Ke,i,r,l,d,_,w.segment,Te,Re,T,B,j,X,ce);return ot?{first:yt,last:ot}:null}function ie(y,s,i,r){return y===a.ah.horizontal&&Math.abs(i.y-s.y)>Math.abs(i.x-s.x)*r?{useVertical:!0}:(y===a.ah.vertical?s.y<i.y:s.x>i.x)?{needsFlipping:!0}:null}function de(y,s,i,r,l,d,_,w,T,B,j,X,ce,Se,Te,Re){const Be=s/24,Ke=y.lineOffsetX*Be,yt=y.lineOffsetY*Be;let ot;if(y.numGlyphs>1){const ct=y.glyphStartIndex+y.numGlyphs,It=y.lineStartIndex,bt=y.lineStartIndex+y.lineLength,ri=$(Be,w,Ke,yt,i,j,X,y,T,d,ce,Te,Re);if(!ri)return{notEnoughRoom:!0};const Xt=st(ri.first.point,_,Re).point,ti=st(ri.last.point,_,Re).point;if(r&&!i){const si=ie(y.writingMode,Xt,ti,Se);if(si)return si}ot=[ri.first];for(let si=y.glyphStartIndex+1;si<ct-1;si++)ot.push(Ve(Be*w.getoffsetX(si),Ke,yt,i,j,X,y.segment,It,bt,T,d,ce,Te,Re));ot.push(ri.last)}else{if(r&&!i){const It=st(X,l,Re).point,bt=y.lineStartIndex+y.segment+1,ri=new a.P(T.getx(bt),T.gety(bt)),Xt=st(ri,l,Re),ti=Xt.signedDistanceFromCamera>0?Xt.point:ye(X,ri,It,1,l,Re),si=ie(y.writingMode,It,ti,Se);if(si)return si}const ct=Ve(Be*w.getoffsetX(y.glyphStartIndex),Ke,yt,i,j,X,y.segment,y.lineStartIndex,y.lineStartIndex+y.lineLength,T,d,ce,Te,Re);if(!ct)return{notEnoughRoom:!0};ot=[ct]}for(const ct of ot)a.aj(B,ct.point,ct.angle);return{}}function ye(y,s,i,r,l,d){const _=st(y.add(y.sub(s)._unit()),l,d).point,w=i.sub(_);return i.add(w._mult(r/w.mag()))}function ge(y,s){const{projectionCache:i,lineVertexArray:r,labelPlaneMatrix:l,tileAnchorPoint:d,distanceFromAnchor:_,getElevation:w,previousVertex:T,direction:B,absOffsetX:j}=s;if(i.projections[y])return i.projections[y];const X=new a.P(r.getx(y),r.gety(y)),ce=st(X,l,w);if(ce.signedDistanceFromCamera>0)return i.projections[y]=ce.point,ce.point;const Se=y-B;return ye(_===0?d:new a.P(r.getx(Se),r.gety(Se)),X,T,j-_+1,l,w)}function Pe(y,s,i){return y._unit()._perp()._mult(s*i)}function Fe(y,s,i,r,l,d,_,w){const{projectionCache:T,direction:B}=w;if(T.offsets[y])return T.offsets[y];const j=i.add(s);if(y+B<r||y+B>=l)return T.offsets[y]=j,j;const X=ge(y+B,w),ce=Pe(X.sub(i),_,B),Se=i.add(ce),Te=X.add(ce);return T.offsets[y]=a.ak(d,j,Se,Te)||j,T.offsets[y]}function Ve(y,s,i,r,l,d,_,w,T,B,j,X,ce,Se){const Te=r?y-s:y+s;let Re=Te>0?1:-1,Be=0;r&&(Re*=-1,Be=Math.PI),Re<0&&(Be+=Math.PI);let Ke,yt,ot=Re>0?w+_:w+_+1,ct=l,It=l,bt=0,ri=0;const Xt=Math.abs(Te),ti=[];let si;for(;bt+ri<=Xt;){if(ot+=Re,ot<w||ot>=T)return null;bt+=ri,It=ct,yt=Ke;const Ei={projectionCache:X,lineVertexArray:B,labelPlaneMatrix:j,tileAnchorPoint:d,distanceFromAnchor:bt,getElevation:Se,previousVertex:It,direction:Re,absOffsetX:Xt};if(ct=ge(ot,Ei),i===0)ti.push(It),si=ct.sub(It);else{let Gi;const qi=ct.sub(It);Gi=qi.mag()===0?Pe(ge(ot+Re,Ei).sub(ct),i,Re):Pe(qi,i,Re),yt||(yt=It.add(Gi)),Ke=Fe(ot,Gi,ct,w,T,yt,i,Ei),ti.push(yt),si=Ke.sub(yt)}ri=si.mag()}const Qi=si._mult((Xt-bt)/ri)._add(yt||It),Wi=Be+Math.atan2(ct.y-It.y,ct.x-It.x);return ti.push(Qi),{point:Qi,angle:ce?Wi:0,path:ti}}const Xe=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ye(y,s){for(let i=0;i<y;i++){const r=s.length;s.resize(r+4),s.float32.set(Xe,3*r)}}function De(y,s,i){const r=s[0],l=s[1];return y[0]=i[0]*r+i[4]*l+i[12],y[1]=i[1]*r+i[5]*l+i[13],y[3]=i[3]*r+i[7]*l+i[15],y}const Ge=100;class ht{constructor(s,i=new Qe(s.width+200,s.height+200,25),r=new Qe(s.width+200,s.height+200,25)){this.transform=s,this.grid=i,this.ignoredGrid=r,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+Ge,this.screenBottomBoundary=s.height+Ge,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(s,i,r,l,d,_){const w=this.projectAndGetPerspectiveRatio(l,s.anchorPointX,s.anchorPointY,_),T=r*w.perspectiveRatio,B=s.x1*T+w.point.x,j=s.y1*T+w.point.y,X=s.x2*T+w.point.x,ce=s.y2*T+w.point.y;return!this.isInsideGrid(B,j,X,ce)||i!=="always"&&this.grid.hitTest(B,j,X,ce,i,d)||w.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[B,j,X,ce],offscreen:this.isOffscreen(B,j,X,ce)}}placeCollisionCircles(s,i,r,l,d,_,w,T,B,j,X,ce,Se,Te){const Re=[],Be=new a.P(i.anchorX,i.anchorY),Ke=st(Be,_,Te),yt=Me(this.transform.cameraToCenterDistance,Ke.signedDistanceFromCamera),ot=(j?d/yt:d*yt)/a.ao,ct=st(Be,w,Te).point,It=$(ot,l,i.lineOffsetX*ot,i.lineOffsetY*ot,!1,ct,Be,i,r,w,{projections:{},offsets:{}},!1,Te);let bt=!1,ri=!1,Xt=!0;if(It){const ti=.5*ce*yt+Se,si=new a.P(-100,-100),Qi=new a.P(this.screenRightBoundary,this.screenBottomBoundary),Wi=new We,Ei=It.first,Gi=It.last;let qi=[];for(let tn=Ei.path.length-1;tn>=1;tn--)qi.push(Ei.path[tn]);for(let tn=1;tn<Gi.path.length;tn++)qi.push(Gi.path[tn]);const cn=2.5*ti;if(T){const tn=qi.map(kn=>st(kn,T,Te));qi=tn.some(kn=>kn.signedDistanceFromCamera<=0)?[]:tn.map(kn=>kn.point)}let zn=[];if(qi.length>0){const tn=qi[0].clone(),kn=qi[0].clone();for(let yr=1;yr<qi.length;yr++)tn.x=Math.min(tn.x,qi[yr].x),tn.y=Math.min(tn.y,qi[yr].y),kn.x=Math.max(kn.x,qi[yr].x),kn.y=Math.max(kn.y,qi[yr].y);zn=tn.x>=si.x&&kn.x<=Qi.x&&tn.y>=si.y&&kn.y<=Qi.y?[qi]:kn.x<si.x||tn.x>Qi.x||kn.y<si.y||tn.y>Qi.y?[]:a.al([qi],si.x,si.y,Qi.x,Qi.y)}for(const tn of zn){Wi.reset(tn,.25*ti);let kn=0;kn=Wi.length<=.5*ti?1:Math.ceil(Wi.paddedLength/cn)+1;for(let yr=0;yr<kn;yr++){const er=yr/Math.max(kn-1,1),Ia=Wi.lerp(er),Aa=Ia.x+Ge,zs=Ia.y+Ge;Re.push(Aa,zs,ti,0);const oo=Aa-ti,lo=zs-ti,qr=Aa+ti,ya=zs+ti;if(Xt=Xt&&this.isOffscreen(oo,lo,qr,ya),ri=ri||this.isInsideGrid(oo,lo,qr,ya),s!=="always"&&this.grid.hitTestCircle(Aa,zs,ti,s,X)&&(bt=!0,!B))return{circles:[],offscreen:!1,collisionDetected:bt}}}}return{circles:!B&&bt||!ri||yt<this.perspectiveRatioCutoff?[]:Re,offscreen:Xt,collisionDetected:bt}}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const i=[];let r=1/0,l=1/0,d=-1/0,_=-1/0;for(const j of s){const X=new a.P(j.x+Ge,j.y+Ge);r=Math.min(r,X.x),l=Math.min(l,X.y),d=Math.max(d,X.x),_=Math.max(_,X.y),i.push(X)}const w=this.grid.query(r,l,d,_).concat(this.ignoredGrid.query(r,l,d,_)),T={},B={};for(const j of w){const X=j.key;if(T[X.bucketInstanceId]===void 0&&(T[X.bucketInstanceId]={}),T[X.bucketInstanceId][X.featureIndex])continue;const ce=[new a.P(j.x1,j.y1),new a.P(j.x2,j.y1),new a.P(j.x2,j.y2),new a.P(j.x1,j.y2)];a.am(i,ce)&&(T[X.bucketInstanceId][X.featureIndex]=!0,B[X.bucketInstanceId]===void 0&&(B[X.bucketInstanceId]=[]),B[X.bucketInstanceId].push(X.featureIndex))}return B}insertCollisionBox(s,i,r,l,d,_){(r?this.ignoredGrid:this.grid).insert({bucketInstanceId:l,featureIndex:d,collisionGroupID:_,overlapMode:i},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,i,r,l,d,_){const w=r?this.ignoredGrid:this.grid,T={bucketInstanceId:l,featureIndex:d,collisionGroupID:_,overlapMode:i};for(let B=0;B<s.length;B+=4)w.insertCircle(T,s[B],s[B+1],s[B+2])}projectAndGetPerspectiveRatio(s,i,r,l){let d;return l?(d=[i,r,l(i,r),1],a.af(d,d,s)):(d=[i,r,0,1],De(d,d,s)),{point:new a.P((d[0]/d[3]+1)/2*this.transform.width+Ge,(-d[1]/d[3]+1)/2*this.transform.height+Ge),perspectiveRatio:.5+this.transform.cameraToCenterDistance/d[3]*.5}}isOffscreen(s,i,r,l){return r<Ge||s>=this.screenRightBoundary||l<Ge||i>this.screenBottomBoundary}isInsideGrid(s,i,r,l){return r>=0&&s<this.gridRightBoundary&&l>=0&&i<this.gridBottomBoundary}getViewportMatrix(){const s=a.an([]);return a.H(s,s,[-100,-100,0]),s}}function kt(y,s,i){return s*(a.W/(y.tileSize*Math.pow(2,i-y.tileID.overscaledZ)))}class o{constructor(s,i,r,l){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?i:-i))):l&&r?1:0,this.placed=r}isHidden(){return this.opacity===0&&!this.placed}}class ke{constructor(s,i,r,l,d){this.text=new o(s?s.text:null,i,r,d),this.icon=new o(s?s.icon:null,i,l,d)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ai{constructor(s,i,r){this.text=s,this.icon=i,this.skipFade=r}}class fi{constructor(){this.invProjMatrix=a.F(),this.viewportMatrix=a.F(),this.circles=[]}}class hi{constructor(s,i,r,l,d){this.bucketInstanceId=s,this.featureIndex=i,this.sourceLayerIndex=r,this.bucketIndex=l,this.tileID=d}}class Jt{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const i=++this.maxGroupID;this.collisionGroups[s]={ID:i,predicate:r=>r.collisionGroupID===i}}return this.collisionGroups[s]}}function oi(y,s,i,r,l){const{horizontalAlign:d,verticalAlign:_}=a.at(y);return new a.P(-(d-.5)*s+r[0]*l,-(_-.5)*i+r[1]*l)}function zi(y,s,i,r,l,d){const{x1:_,x2:w,y1:T,y2:B,anchorPointX:j,anchorPointY:X}=y,ce=new a.P(s,i);return r&&ce._rotate(l?d:-d),{x1:_+ce.x,y1:T+ce.y,x2:w+ce.x,y2:B+ce.y,anchorPointX:j,anchorPointY:X}}class xi{constructor(s,i,r,l,d){this.transform=s.clone(),this.terrain=i,this.collisionIndex=new ht(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new Jt(l),this.collisionCircleArrays={},this.prevPlacement=d,d&&(d.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,i,r,l){const d=r.getBucket(i),_=r.latestFeatureIndex;if(!d||!_||i.id!==d.layerIds[0])return;const w=r.collisionBoxArray,T=d.layers[0].layout,B=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),j=r.tileSize/a.W,X=this.transform.calculatePosMatrix(r.tileID.toUnwrapped()),ce=T.get("text-pitch-alignment")==="map",Se=T.get("text-rotation-alignment")==="map",Te=kt(r,1,this.transform.zoom),Re=Ue(X,ce,Se,this.transform,Te);let Be=null;if(ce){const yt=ft(X,ce,Se,this.transform,Te);Be=a.K([],this.transform.labelPlaneMatrix,yt)}this.retainedQueryData[d.bucketInstanceId]=new hi(d.bucketInstanceId,_,d.sourceLayerIndex,d.index,r.tileID);const Ke={bucket:d,layout:T,posMatrix:X,textLabelPlaneMatrix:Re,labelToScreenMatrix:Be,scale:B,textPixelRatio:j,holdingForFade:r.holdingForFade(),collisionBoxArray:w,partiallyEvaluatedTextSize:a.ag(d.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(d.sourceID)};if(l)for(const yt of d.sortKeyRanges){const{sortKey:ot,symbolInstanceStart:ct,symbolInstanceEnd:It}=yt;s.push({sortKey:ot,symbolInstanceStart:ct,symbolInstanceEnd:It,parameters:Ke})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:d.symbolInstances.length,parameters:Ke})}attemptAnchorPlacement(s,i,r,l,d,_,w,T,B,j,X,ce,Se,Te,Re,Be){const Ke=a.ap[s.textAnchor],yt=[s.textOffset0,s.textOffset1],ot=oi(Ke,r,l,yt,d),ct=this.collisionIndex.placeCollisionBox(zi(i,ot.x,ot.y,_,w,this.transform.angle),X,T,B,j.predicate,Be);if((!Re||this.collisionIndex.placeCollisionBox(zi(Re,ot.x,ot.y,_,w,this.transform.angle),X,T,B,j.predicate,Be).box.length!==0)&&ct.box.length>0){let It;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ce.crossTileID]&&this.prevPlacement.placements[ce.crossTileID]&&this.prevPlacement.placements[ce.crossTileID].text&&(It=this.prevPlacement.variableOffsets[ce.crossTileID].anchor),ce.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ce.crossTileID]={textOffset:yt,width:r,height:l,anchor:Ke,textBoxScale:d,prevAnchor:It},this.markUsedJustification(Se,Ke,ce,Te),Se.allowVerticalPlacement&&(this.markUsedOrientation(Se,Te,ce),this.placedOrientations[ce.crossTileID]=Te),{shift:ot,placedGlyphBoxes:ct}}}placeLayerBucketPart(s,i,r){const{bucket:l,layout:d,posMatrix:_,textLabelPlaneMatrix:w,labelToScreenMatrix:T,textPixelRatio:B,holdingForFade:j,collisionBoxArray:X,partiallyEvaluatedTextSize:ce,collisionGroup:Se}=s.parameters,Te=d.get("text-optional"),Re=d.get("icon-optional"),Be=a.aq(d,"text-overlap","text-allow-overlap"),Ke=Be==="always",yt=a.aq(d,"icon-overlap","icon-allow-overlap"),ot=yt==="always",ct=d.get("text-rotation-alignment")==="map",It=d.get("text-pitch-alignment")==="map",bt=d.get("icon-text-fit")!=="none",ri=d.get("symbol-z-order")==="viewport-y",Xt=Ke&&(ot||!l.hasIconData()||Re),ti=ot&&(Ke||!l.hasTextData()||Te);!l.collisionArrays&&X&&l.deserializeCollisionBoxes(X);const si=this.retainedQueryData[l.bucketInstanceId].tileID,Qi=this.terrain?(Ei,Gi)=>this.terrain.getElevation(si,Ei,Gi):null,Wi=(Ei,Gi)=>{var qi,cn;if(i[Ei.crossTileID])return;if(j)return void(this.placements[Ei.crossTileID]=new ai(!1,!1,!1));let zn=!1,tn=!1,kn=!0,yr=null,er={box:null,offscreen:null},Ia={box:null,offscreen:null},Aa=null,zs=null,oo=null,lo=0,qr=0,ya=0;Gi.textFeatureIndex?lo=Gi.textFeatureIndex:Ei.useRuntimeCollisionCircles&&(lo=Ei.featureIndex),Gi.verticalTextFeatureIndex&&(qr=Gi.verticalTextFeatureIndex);const xo=Gi.textBox;if(xo){const ts=Ws=>{let Do=a.ah.horizontal;if(l.allowVerticalPlacement&&!Ws&&this.prevPlacement){const Uo=this.prevPlacement.placedOrientations[Ei.crossTileID];Uo&&(this.placedOrientations[Ei.crossTileID]=Uo,Do=Uo,this.markUsedOrientation(l,Do,Ei))}return Do},is=(Ws,Do)=>{if(l.allowVerticalPlacement&&Ei.numVerticalGlyphVertices>0&&Gi.verticalTextBox){for(const Uo of l.writingModes)if(Uo===a.ah.vertical?(er=Do(),Ia=er):er=Ws(),er&&er.box&&er.box.length)break}else er=Ws()},Rr=Ei.textAnchorOffsetStartIndex,bs=Ei.textAnchorOffsetEndIndex;if(bs===Rr){const Ws=(Do,Uo)=>{const Go=this.collisionIndex.placeCollisionBox(Do,Be,B,_,Se.predicate,Qi);return Go&&Go.box&&Go.box.length&&(this.markUsedOrientation(l,Uo,Ei),this.placedOrientations[Ei.crossTileID]=Uo),Go};is(()=>Ws(xo,a.ah.horizontal),()=>{const Do=Gi.verticalTextBox;return l.allowVerticalPlacement&&Ei.numVerticalGlyphVertices>0&&Do?Ws(Do,a.ah.vertical):{box:null,offscreen:null}}),ts(er&&er.box&&er.box.length)}else{let Ws=a.ap[(cn=(qi=this.prevPlacement)===null||qi===void 0?void 0:qi.variableOffsets[Ei.crossTileID])===null||cn===void 0?void 0:cn.anchor];const Do=(Go,Ic,$s)=>{const Xl=Go.x2-Go.x1,hu=Go.y2-Go.y1,il=Ei.textBoxScale,vl=bt&&yt==="never"?Ic:null;let Pl={box:[],offscreen:!1},Au=Be==="never"?1:2,af="never";Ws&&Au++;for(let Vh=0;Vh<Au;Vh++){for(let Pa=Rr;Pa<bs;Pa++){const pA=l.textAnchorOffsets.get(Pa);if(Ws&&pA.textAnchor!==Ws)continue;const yh=this.attemptAnchorPlacement(pA,Go,Xl,hu,il,ct,It,B,_,Se,af,Ei,l,$s,vl,Qi);if(yh&&(Pl=yh.placedGlyphBoxes,Pl&&Pl.box&&Pl.box.length))return zn=!0,yr=yh.shift,Pl}Ws?Ws=null:af=Be}return Pl};is(()=>Do(xo,Gi.iconBox,a.ah.horizontal),()=>{const Go=Gi.verticalTextBox;return l.allowVerticalPlacement&&!(er&&er.box&&er.box.length)&&Ei.numVerticalGlyphVertices>0&&Go?Do(Go,Gi.verticalIconBox,a.ah.vertical):{box:null,offscreen:null}}),er&&(zn=er.box,kn=er.offscreen);const Uo=ts(er&&er.box);if(!zn&&this.prevPlacement){const Go=this.prevPlacement.variableOffsets[Ei.crossTileID];Go&&(this.variableOffsets[Ei.crossTileID]=Go,this.markUsedJustification(l,Go.anchor,Ei,Uo))}}}if(Aa=er,zn=Aa&&Aa.box&&Aa.box.length>0,kn=Aa&&Aa.offscreen,Ei.useRuntimeCollisionCircles){const ts=l.text.placedSymbolArray.get(Ei.centerJustifiedTextSymbolIndex),is=a.ai(l.textSizeData,ce,ts),Rr=d.get("text-padding");zs=this.collisionIndex.placeCollisionCircles(Be,ts,l.lineVertexArray,l.glyphOffsetArray,is,_,w,T,r,It,Se.predicate,Ei.collisionCircleDiameter,Rr,Qi),zs.circles.length&&zs.collisionDetected&&!r&&a.w("Collisions detected, but collision boxes are not shown"),zn=Ke||zs.circles.length>0&&!zs.collisionDetected,kn=kn&&zs.offscreen}if(Gi.iconFeatureIndex&&(ya=Gi.iconFeatureIndex),Gi.iconBox){const ts=is=>{const Rr=bt&&yr?zi(is,yr.x,yr.y,ct,It,this.transform.angle):is;return this.collisionIndex.placeCollisionBox(Rr,yt,B,_,Se.predicate,Qi)};Ia&&Ia.box&&Ia.box.length&&Gi.verticalIconBox?(oo=ts(Gi.verticalIconBox),tn=oo.box.length>0):(oo=ts(Gi.iconBox),tn=oo.box.length>0),kn=kn&&oo.offscreen}const bo=Te||Ei.numHorizontalGlyphVertices===0&&Ei.numVerticalGlyphVertices===0,Qs=Re||Ei.numIconVertices===0;if(bo||Qs?Qs?bo||(tn=tn&&zn):zn=tn&&zn:tn=zn=tn&&zn,zn&&Aa&&Aa.box&&this.collisionIndex.insertCollisionBox(Aa.box,Be,d.get("text-ignore-placement"),l.bucketInstanceId,Ia&&Ia.box&&qr?qr:lo,Se.ID),tn&&oo&&this.collisionIndex.insertCollisionBox(oo.box,yt,d.get("icon-ignore-placement"),l.bucketInstanceId,ya,Se.ID),zs&&(zn&&this.collisionIndex.insertCollisionCircles(zs.circles,Be,d.get("text-ignore-placement"),l.bucketInstanceId,lo,Se.ID),r)){const ts=l.bucketInstanceId;let is=this.collisionCircleArrays[ts];is===void 0&&(is=this.collisionCircleArrays[ts]=new fi);for(let Rr=0;Rr<zs.circles.length;Rr+=4)is.circles.push(zs.circles[Rr+0]),is.circles.push(zs.circles[Rr+1]),is.circles.push(zs.circles[Rr+2]),is.circles.push(zs.collisionDetected?1:0)}if(Ei.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(l.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ei.crossTileID]=new ai(zn||Xt,tn||ti,kn||l.justReloaded),i[Ei.crossTileID]=!0};if(ri){if(s.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ei=l.getSortedSymbolIndexes(this.transform.angle);for(let Gi=Ei.length-1;Gi>=0;--Gi){const qi=Ei[Gi];Wi(l.symbolInstances.get(qi),l.collisionArrays[qi])}}else for(let Ei=s.symbolInstanceStart;Ei<s.symbolInstanceEnd;Ei++)Wi(l.symbolInstances.get(Ei),l.collisionArrays[Ei]);if(r&&l.bucketInstanceId in this.collisionCircleArrays){const Ei=this.collisionCircleArrays[l.bucketInstanceId];a.ar(Ei.invProjMatrix,_),Ei.viewportMatrix=this.collisionIndex.getViewportMatrix()}l.justReloaded=!1}markUsedJustification(s,i,r,l){let d;d=l===a.ah.vertical?r.verticalPlacedTextSymbolIndex:{left:r.leftJustifiedTextSymbolIndex,center:r.centerJustifiedTextSymbolIndex,right:r.rightJustifiedTextSymbolIndex}[a.as(i)];const _=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex,r.verticalPlacedTextSymbolIndex];for(const w of _)w>=0&&(s.text.placedSymbolArray.get(w).crossTileID=d>=0&&w!==d?0:r.crossTileID)}markUsedOrientation(s,i,r){const l=i===a.ah.horizontal||i===a.ah.horizontalOnly?i:0,d=i===a.ah.vertical?i:0,_=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex];for(const w of _)s.text.placedSymbolArray.get(w).placedOrientation=l;r.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation=d)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const i=this.prevPlacement;let r=!1;this.prevZoomAdjustment=i?i.zoomAdjustment(this.transform.zoom):0;const l=i?i.symbolFadeChange(s):1,d=i?i.opacities:{},_=i?i.variableOffsets:{},w=i?i.placedOrientations:{};for(const T in this.placements){const B=this.placements[T],j=d[T];j?(this.opacities[T]=new ke(j,l,B.text,B.icon),r=r||B.text!==j.text.placed||B.icon!==j.icon.placed):(this.opacities[T]=new ke(null,l,B.text,B.icon,B.skipFade),r=r||B.text||B.icon)}for(const T in d){const B=d[T];if(!this.opacities[T]){const j=new ke(B,l,!1,!1);j.isHidden()||(this.opacities[T]=j,r=r||B.text.placed||B.icon.placed)}}for(const T in _)this.variableOffsets[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.variableOffsets[T]=_[T]);for(const T in w)this.placedOrientations[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.placedOrientations[T]=w[T]);if(i&&i.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");r?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=i?i.lastPlacementChangeTime:s)}updateLayerOpacities(s,i){const r={};for(const l of i){const d=l.getBucket(s);d&&l.latestFeatureIndex&&s.id===d.layerIds[0]&&this.updateBucketOpacities(d,r,l.collisionBoxArray)}}updateBucketOpacities(s,i,r){s.hasTextData()&&(s.text.opacityVertexArray.clear(),s.text.hasVisibleVertices=!1),s.hasIconData()&&(s.icon.opacityVertexArray.clear(),s.icon.hasVisibleVertices=!1),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const l=s.layers[0],d=l.layout,_=new ke(null,0,!1,!1,!0),w=d.get("text-allow-overlap"),T=d.get("icon-allow-overlap"),B=l._unevaluatedLayout.hasValue("text-variable-anchor")||l._unevaluatedLayout.hasValue("text-variable-anchor-offset"),j=d.get("text-rotation-alignment")==="map",X=d.get("text-pitch-alignment")==="map",ce=d.get("icon-text-fit")!=="none",Se=new ke(null,0,w&&(T||!s.hasIconData()||d.get("icon-optional")),T&&(w||!s.hasTextData()||d.get("text-optional")),!0);!s.collisionArrays&&r&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(r);const Te=(Re,Be,Ke)=>{for(let yt=0;yt<Be/4;yt++)Re.opacityVertexArray.emplaceBack(Ke);Re.hasVisibleVertices=Re.hasVisibleVertices||Ke!==Vn};for(let Re=0;Re<s.symbolInstances.length;Re++){const Be=s.symbolInstances.get(Re),{numHorizontalGlyphVertices:Ke,numVerticalGlyphVertices:yt,crossTileID:ot}=Be;let ct=this.opacities[ot];i[ot]?ct=_:ct||(ct=Se,this.opacities[ot]=ct),i[ot]=!0;const It=Be.numIconVertices>0,bt=this.placedOrientations[Be.crossTileID],ri=bt===a.ah.vertical,Xt=bt===a.ah.horizontal||bt===a.ah.horizontalOnly;if(Ke>0||yt>0){const ti=ur(ct.text);Te(s.text,Ke,ri?Vn:ti),Te(s.text,yt,Xt?Vn:ti);const si=ct.text.isHidden();[Be.rightJustifiedTextSymbolIndex,Be.centerJustifiedTextSymbolIndex,Be.leftJustifiedTextSymbolIndex].forEach(Ei=>{Ei>=0&&(s.text.placedSymbolArray.get(Ei).hidden=si||ri?1:0)}),Be.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(Be.verticalPlacedTextSymbolIndex).hidden=si||Xt?1:0);const Qi=this.variableOffsets[Be.crossTileID];Qi&&this.markUsedJustification(s,Qi.anchor,Be,bt);const Wi=this.placedOrientations[Be.crossTileID];Wi&&(this.markUsedJustification(s,"left",Be,Wi),this.markUsedOrientation(s,Wi,Be))}if(It){const ti=ur(ct.icon),si=!(ce&&Be.verticalPlacedIconSymbolIndex&&ri);Be.placedIconSymbolIndex>=0&&(Te(s.icon,Be.numIconVertices,si?ti:Vn),s.icon.placedSymbolArray.get(Be.placedIconSymbolIndex).hidden=ct.icon.isHidden()),Be.verticalPlacedIconSymbolIndex>=0&&(Te(s.icon,Be.numVerticalIconVertices,si?Vn:ti),s.icon.placedSymbolArray.get(Be.verticalPlacedIconSymbolIndex).hidden=ct.icon.isHidden())}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const ti=s.collisionArrays[Re];if(ti){let si=new a.P(0,0);if(ti.textBox||ti.verticalTextBox){let Wi=!0;if(B){const Ei=this.variableOffsets[ot];Ei?(si=oi(Ei.anchor,Ei.width,Ei.height,Ei.textOffset,Ei.textBoxScale),j&&si._rotate(X?this.transform.angle:-this.transform.angle)):Wi=!1}ti.textBox&&Si(s.textCollisionBox.collisionVertexArray,ct.text.placed,!Wi||ri,si.x,si.y),ti.verticalTextBox&&Si(s.textCollisionBox.collisionVertexArray,ct.text.placed,!Wi||Xt,si.x,si.y)}const Qi=!!(!Xt&&ti.verticalIconBox);ti.iconBox&&Si(s.iconCollisionBox.collisionVertexArray,ct.icon.placed,Qi,ce?si.x:0,ce?si.y:0),ti.verticalIconBox&&Si(s.iconCollisionBox.collisionVertexArray,ct.icon.placed,!Qi,ce?si.x:0,ce?si.y:0)}}}if(s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.text.opacityVertexArray.length!==s.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${s.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${s.text.layoutVertexArray.length}) / 4`);if(s.icon.opacityVertexArray.length!==s.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${s.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${s.icon.layoutVertexArray.length}) / 4`);if(s.bucketInstanceId in this.collisionCircleArrays){const Re=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=Re.invProjMatrix,s.placementViewportMatrix=Re.viewportMatrix,s.collisionCircleArray=Re.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,i){const r=this.zoomAtLastRecencyCheck===i?1-this.zoomAdjustment(i):1;return this.zoomAtLastRecencyCheck=i,this.commitTime+this.fadeDuration*r>s}setStale(){this.stale=!0}}function Si(y,s,i,r,l){y.emplaceBack(s?1:0,i?1:0,r||0,l||0),y.emplaceBack(s?1:0,i?1:0,r||0,l||0),y.emplaceBack(s?1:0,i?1:0,r||0,l||0),y.emplaceBack(s?1:0,i?1:0,r||0,l||0)}const Yt=Math.pow(2,25),bn=Math.pow(2,24),or=Math.pow(2,17),mn=Math.pow(2,16),qn=Math.pow(2,9),jr=Math.pow(2,8),Zi=Math.pow(2,1);function ur(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const s=y.placed?1:0,i=Math.floor(127*y.opacity);return i*Yt+s*bn+i*or+s*mn+i*qn+s*jr+i*Zi+s}const Vn=0;class Wt{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&!s.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(s,i,r,l,d){const _=this._bucketParts;for(;this._currentTileIndex<s.length;)if(i.getBucketParts(_,l,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,d())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,_.sort((w,T)=>w.sortKey-T.sortKey));this._currentPartIndex<_.length;)if(i.placeLayerBucketPart(_[this._currentPartIndex],this._seenCrossTileIDs,r),this._currentPartIndex++,d())return!0;return!1}}class Ki{constructor(s,i,r,l,d,_,w,T){this.placement=new xi(s,i,_,w,T),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=l,this._showCollisionBoxes=d,this._done=!1}isDone(){return this._done}continuePlacement(s,i,r){const l=ae.now(),d=()=>!this._forceFullPlacement&&ae.now()-l>2;for(;this._currentPlacementIndex>=0;){const _=i[s[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if(_.type==="symbol"&&(!_.minzoom||_.minzoom<=w)&&(!_.maxzoom||_.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new Wt(_)),this._inProgressLayer.continuePlacement(r[_.source],this.placement,this._showCollisionBoxes,_,d))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const Ut=512/a.W/2;class Tn{constructor(s,i,r){this.tileID=s,this.bucketInstanceId=r,this._symbolsByKey={};const l=new Map;for(let d=0;d<i.length;d++){const _=i.get(d),w=_.key,T=l.get(w);T?T.push(_):l.set(w,[_])}for(const[d,_]of l){const w={positions:_.map(T=>({x:Math.floor(T.anchorX*Ut),y:Math.floor(T.anchorY*Ut)})),crossTileIDs:_.map(T=>T.crossTileID)};if(w.positions.length>128){const T=new a.au(w.positions.length,16,Uint16Array);for(const{x:B,y:j}of w.positions)T.add(B,j);T.finish(),delete w.positions,w.index=T}this._symbolsByKey[d]=w}}getScaledCoordinates(s,i){const{x:r,y:l,z:d}=this.tileID.canonical,{x:_,y:w,z:T}=i.canonical,B=Ut/Math.pow(2,T-d),j=(w*a.W+s.anchorY)*B,X=l*a.W*Ut;return{x:Math.floor((_*a.W+s.anchorX)*B-r*a.W*Ut),y:Math.floor(j-X)}}findMatches(s,i,r){const l=this.tileID.canonical.z<i.canonical.z?1:Math.pow(2,this.tileID.canonical.z-i.canonical.z);for(let d=0;d<s.length;d++){const _=s.get(d);if(_.crossTileID)continue;const w=this._symbolsByKey[_.key];if(!w)continue;const T=this.getScaledCoordinates(_,i);if(w.index){const B=w.index.range(T.x-l,T.y-l,T.x+l,T.y+l).sort();for(const j of B){const X=w.crossTileIDs[j];if(!r[X]){r[X]=!0,_.crossTileID=X;break}}}else if(w.positions)for(let B=0;B<w.positions.length;B++){const j=w.positions[B],X=w.crossTileIDs[B];if(Math.abs(j.x-T.x)<=l&&Math.abs(j.y-T.y)<=l&&!r[X]){r[X]=!0,_.crossTileID=X;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:s})=>s)}}class cr{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Vs{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const i=Math.round((s-this.lng)/360);if(i!==0)for(const r in this.indexes){const l=this.indexes[r],d={};for(const _ in l){const w=l[_];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+i),d[w.tileID.key]=w}this.indexes[r]=d}this.lng=s}addBucket(s,i,r){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===i.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let d=0;d<i.symbolInstances.length;d++)i.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});const l=this.usedCrossTileIDs[s.overscaledZ];for(const d in this.indexes){const _=this.indexes[d];if(Number(d)>s.overscaledZ)for(const w in _){const T=_[w];T.tileID.isChildOf(s)&&T.findMatches(i.symbolInstances,s,l)}else{const w=_[s.scaledTo(Number(d)).key];w&&w.findMatches(i.symbolInstances,s,l)}}for(let d=0;d<i.symbolInstances.length;d++){const _=i.symbolInstances.get(d);_.crossTileID||(_.crossTileID=r.generate(),l[_.crossTileID]=!0)}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new Tn(s,i.symbolInstances,i.bucketInstanceId),!0}removeBucketCrossTileIDs(s,i){for(const r of i.getCrossTileIDsLists())for(const l of r)delete this.usedCrossTileIDs[s][l]}removeStaleBuckets(s){let i=!1;for(const r in this.indexes){const l=this.indexes[r];for(const d in l)s[l[d].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,l[d]),delete l[d],i=!0)}return i}}class Ur{constructor(){this.layerIndexes={},this.crossTileIDs=new cr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,i,r){let l=this.layerIndexes[s.id];l===void 0&&(l=this.layerIndexes[s.id]=new Vs);let d=!1;const _={};l.handleWrapJump(r);for(const w of i){const T=w.getBucket(s);T&&s.id===T.layerIds[0]&&(T.bucketInstanceId||(T.bucketInstanceId=++this.maxBucketInstanceId),l.addBucket(w.tileID,T,this.crossTileIDs)&&(d=!0),_[T.bucketInstanceId]=!0)}return l.removeStaleBuckets(_)&&(d=!0),d}pruneUnusedLayers(s){const i={};s.forEach(r=>{i[r]=!0});for(const r in this.layerIndexes)i[r]||delete this.layerIndexes[r]}}const Vt=(y,s)=>a.t(y,s&&s.filter(i=>i.identifier!=="source.canvas")),hr=a.av();class Bt extends a.E{constructor(s,i={}){super(),this._rtlTextPluginStateChange=()=>{for(const r in this.sourceCaches){const l=this.sourceCaches[r].getSource().type;l!=="vector"&&l!=="geojson"||this.sourceCaches[r].reload()}},this.map=s,this.dispatcher=new Ci(vn(),s._getMapId()),this.dispatcher.registerMessageHandler("getGlyphs",(r,l)=>this.getGlyphs(r,l)),this.dispatcher.registerMessageHandler("getImages",(r,l)=>this.getImages(r,l)),this.imageManager=new Je,this.imageManager.setEventedParent(this),this.glyphManager=new zt(s._requestManager,i.localIdeographFontFamily),this.lineAtlas=new Ti(256,512),this.crossTileSymbolIndex=new Ur,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.aw,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.ax()),Y().on("pluginStateChange",this._rtlTextPluginStateChange),this.on("data",r=>{if(r.dataType!=="source"||r.sourceDataType!=="metadata")return;const l=this.sourceCaches[r.sourceId];if(!l)return;const d=l.getSource();if(d&&d.vectorLayerIds)for(const _ in this._layers){const w=this._layers[_];w.source===d.id&&this._validateLayer(w)}})}loadURL(s,i={},r){this.fire(new a.k("dataloading",{dataType:"style"})),i.validate=typeof i.validate!="boolean"||i.validate;const l=this.map._requestManager.transformRequest(s,Tt.Style);this._loadStyleRequest=new AbortController,a.h(l,this._loadStyleRequest).then(d=>{this._loadStyleRequest=null,this._load(d.data,i,r)}).catch(d=>{this._loadStyleRequest=null,d&&this.fire(new a.j(d))})}loadJSON(s,i={},r){this.fire(new a.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,ae.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,i.validate=i.validate!==!1,this._load(s,i,r)}).catch(()=>{})}loadEmpty(){this.fire(new a.k("dataloading",{dataType:"style"})),this._load(hr,{validate:!1})}_load(s,i,r){var l;const d=i.transformStyle?i.transformStyle(r,s):s;if(!i.validate||!Vt(this,a.x(d))){this._loaded=!0,this.stylesheet=d;for(const _ in d.sources)this.addSource(_,d.sources[_],{validate:!1});d.sprite?this._loadSprite(d.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(d.glyphs),this._createLayers(),this.light=new wi(this.stylesheet.light),this.map.setTerrain((l=this.stylesheet.terrain)!==null&&l!==void 0?l:null),this.fire(new a.k("data",{dataType:"style"})),this.fire(new a.k("style.load"))}}_createLayers(){const s=a.ay(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",s),this._order=s.map(i=>i.id),this._layers={},this._serializedLayers=null;for(const i of s){const r=a.az(i);r.setEventedParent(this,{layer:{id:i.id}}),this._layers[i.id]=r}}_loadSprite(s,i=!1,r=void 0){let l;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(d,_,w,T){return a._(this,void 0,void 0,function*(){const B=Et(d),j=w>1?"@2x":"",X={},ce={};for(const{id:Se,url:Te}of B){const Re=_.transformRequest(_.normalizeSpriteURL(Te,j,".json"),Tt.SpriteJSON);X[Se]=a.h(Re,T);const Be=_.transformRequest(_.normalizeSpriteURL(Te,j,".png"),Tt.SpriteImage);ce[Se]=xt.getImage(Be,T)}return yield Promise.all([...Object.values(X),...Object.values(ce)]),function(Se,Te){return a._(this,void 0,void 0,function*(){const Re={};for(const Be in Se){Re[Be]={};const Ke=ae.getImageCanvasContext((yield Te[Be]).data),yt=(yield Se[Be]).data;for(const ot in yt){const{width:ct,height:It,x:bt,y:ri,sdf:Xt,pixelRatio:ti,stretchX:si,stretchY:Qi,content:Wi}=yt[ot];Re[Be][ot]={data:null,pixelRatio:ti,sdf:Xt,stretchX:si,stretchY:Qi,content:Wi,spriteData:{width:ct,height:It,x:bt,y:ri,context:Ke}}}}return Re})}(X,ce)})}(s,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(d=>{if(this._spriteRequest=null,d)for(const _ in d){this._spritesImagesIds[_]=[];const w=this._spritesImagesIds[_]?this._spritesImagesIds[_].filter(T=>!(T in d)):[];for(const T of w)this.imageManager.removeImage(T),this._changedImages[T]=!0;for(const T in d[_]){const B=_==="default"?T:`${_}:${T}`;this._spritesImagesIds[_].push(B),B in this.imageManager.images?this.imageManager.updateImage(B,d[_][T],!1):this.imageManager.addImage(B,d[_][T]),i&&(this._changedImages[B]=!0)}}}).catch(d=>{this._spriteRequest=null,l=d,this.fire(new a.j(l))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),i&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"})),r&&r(l)})}_unloadSprite(){for(const s of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(s),this._changedImages[s]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}_validateLayer(s){const i=this.sourceCaches[s.source];if(!i)return;const r=s.sourceLayer;if(!r)return;const l=i.getSource();(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(r)===-1)&&this.fire(new a.j(new Error(`Source layer "${r}" does not exist on source "${l.id}" as specified by style layer "${s.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const s in this.sourceCaches)if(!this.sourceCaches[s].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(s){const i=this._serializedAllLayers();if(!s||s.length===0)return Object.values(i);const r=[];for(const l of s)i[l]&&r.push(i[l]);return r}_serializedAllLayers(){let s=this._serializedLayers;if(s)return s;s=this._serializedLayers={};const i=Object.keys(this._layers);for(const r of i){const l=this._layers[r];l.type!=="custom"&&(s[r]=l.serialize())}return s}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const s in this.sourceCaches)if(this.sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(s){if(!this._loaded)return;const i=this._changed;if(this._changed){const l=Object.keys(this._updatedLayers),d=Object.keys(this._removedLayers);(l.length||d.length)&&this._updateWorkerLayers(l,d);for(const _ in this._updatedSources){const w=this._updatedSources[_];if(w==="reload")this._reloadSource(_);else{if(w!=="clear")throw new Error(`Invalid action ${w}`);this._clearSource(_)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const _ in this._updatedPaintProps)this._layers[_].updateTransitions(s);this.light.updateTransitions(s),this._resetUpdates()}const r={};for(const l in this.sourceCaches){const d=this.sourceCaches[l];r[l]=d.used,d.used=!1}for(const l of this._order){const d=this._layers[l];d.recalculate(s,this._availableImages),!d.isHidden(s.zoom)&&d.source&&(this.sourceCaches[d.source].used=!0)}for(const l in r){const d=this.sourceCaches[l];r[l]!==d.used&&d.fire(new a.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:l}))}this.light.recalculate(s),this.z=s.zoom,i&&this.fire(new a.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const s=Object.keys(this._changedImages);if(s.length){for(const i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["icons","patterns"],s);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(s,i){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(s),removedIds:i})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(s,i={}){var r;this._checkLoaded();const l=this.serialize();if(s=i.transformStyle?i.transformStyle(l,s):s,((r=i.validate)===null||r===void 0||r)&&Vt(this,a.x(s)))return!1;(s=a.aA(s)).layers=a.ay(s.layers);const d=a.aB(l,s),_=this._getOperationsToPerform(d);if(_.unimplemented.length>0)throw new Error(`Unimplemented: ${_.unimplemented.join(", ")}.`);if(_.operations.length===0)return!1;for(const w of _.operations)w();return this.stylesheet=s,this._serializedLayers=null,!0}_getOperationsToPerform(s){const i=[],r=[];for(const l of s)switch(l.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":i.push(()=>this.addLayer.apply(this,l.args));break;case"removeLayer":i.push(()=>this.removeLayer.apply(this,l.args));break;case"setPaintProperty":i.push(()=>this.setPaintProperty.apply(this,l.args));break;case"setLayoutProperty":i.push(()=>this.setLayoutProperty.apply(this,l.args));break;case"setFilter":i.push(()=>this.setFilter.apply(this,l.args));break;case"addSource":i.push(()=>this.addSource.apply(this,l.args));break;case"removeSource":i.push(()=>this.removeSource.apply(this,l.args));break;case"setLayerZoomRange":i.push(()=>this.setLayerZoomRange.apply(this,l.args));break;case"setLight":i.push(()=>this.setLight.apply(this,l.args));break;case"setGeoJSONSourceData":i.push(()=>this.setGeoJSONSourceData.apply(this,l.args));break;case"setGlyphs":i.push(()=>this.setGlyphs.apply(this,l.args));break;case"setSprite":i.push(()=>this.setSprite.apply(this,l.args));break;case"setTerrain":i.push(()=>this.map.setTerrain.apply(this,l.args));break;case"setTransition":i.push(()=>{});break;default:r.push(l.command)}return{operations:i,unimplemented:r}}addImage(s,i){if(this.getImage(s))return this.fire(new a.j(new Error(`An image named "${s}" already exists.`)));this.imageManager.addImage(s,i),this._afterImageUpdated(s)}updateImage(s,i){this.imageManager.updateImage(s,i)}getImage(s){return this.imageManager.getImage(s)}removeImage(s){if(!this.getImage(s))return this.fire(new a.j(new Error(`An image named "${s}" does not exist.`)));this.imageManager.removeImage(s),this._afterImageUpdated(s)}_afterImageUpdated(s){this._availableImages=this.imageManager.listImages(),this._changedImages[s]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(s,i,r={}){if(this._checkLoaded(),this.sourceCaches[s]!==void 0)throw new Error(`Source "${s}" already exists.`);if(!i.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(i).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(a.x.source,`sources.${s}`,i,null,r))return;this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);const l=this.sourceCaches[s]=new Ie(s,i,this.dispatcher);l.style=this,l.setEventedParent(this,()=>({isSourceLoaded:l.loaded(),source:l.serialize(),sourceId:s})),l.onAdd(this.map),this._changed=!0}removeSource(s){if(this._checkLoaded(),this.sourceCaches[s]===void 0)throw new Error("There is no source with this ID");for(const r in this._layers)if(this._layers[r].source===s)return this.fire(new a.j(new Error(`Source "${s}" cannot be removed while layer "${r}" is using it.`)));const i=this.sourceCaches[s];delete this.sourceCaches[s],delete this._updatedSources[s],i.fire(new a.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:s})),i.setEventedParent(null),i.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(s,i){if(this._checkLoaded(),this.sourceCaches[s]===void 0)throw new Error(`There is no source with this ID=${s}`);const r=this.sourceCaches[s].getSource();if(r.type!=="geojson")throw new Error(`geojsonSource.type is ${r.type}, which is !== 'geojson`);r.setData(i),this._changed=!0}getSource(s){return this.sourceCaches[s]&&this.sourceCaches[s].getSource()}addLayer(s,i,r={}){this._checkLoaded();const l=s.id;if(this.getLayer(l))return void this.fire(new a.j(new Error(`Layer "${l}" already exists on this map.`)));let d;if(s.type==="custom"){if(Vt(this,a.aC(s)))return;d=a.az(s)}else{if("source"in s&&typeof s.source=="object"&&(this.addSource(l,s.source),s=a.aA(s),s=a.e(s,{source:l})),this._validate(a.x.layer,`layers.${l}`,s,{arrayIndex:-1},r))return;d=a.az(s),this._validateLayer(d),d.setEventedParent(this,{layer:{id:l}})}const _=i?this._order.indexOf(i):this._order.length;if(i&&_===-1)this.fire(new a.j(new Error(`Cannot add layer "${l}" before non-existing layer "${i}".`)));else{if(this._order.splice(_,0,l),this._layerOrderChanged=!0,this._layers[l]=d,this._removedLayers[l]&&d.source&&d.type!=="custom"){const w=this._removedLayers[l];delete this._removedLayers[l],w.type!==d.type?this._updatedSources[d.source]="clear":(this._updatedSources[d.source]="reload",this.sourceCaches[d.source].pause())}this._updateLayer(d),d.onAdd&&d.onAdd(this.map)}}moveLayer(s,i){if(this._checkLoaded(),this._changed=!0,!this._layers[s])return void this.fire(new a.j(new Error(`The layer '${s}' does not exist in the map's style and cannot be moved.`)));if(s===i)return;const r=this._order.indexOf(s);this._order.splice(r,1);const l=i?this._order.indexOf(i):this._order.length;i&&l===-1?this.fire(new a.j(new Error(`Cannot move layer "${s}" before non-existing layer "${i}".`))):(this._order.splice(l,0,s),this._layerOrderChanged=!0)}removeLayer(s){this._checkLoaded();const i=this._layers[s];if(!i)return void this.fire(new a.j(new Error(`Cannot remove non-existing layer "${s}".`)));i.setEventedParent(null);const r=this._order.indexOf(s);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[s]=i,delete this._layers[s],this._serializedLayers&&delete this._serializedLayers[s],delete this._updatedLayers[s],delete this._updatedPaintProps[s],i.onRemove&&i.onRemove(this.map)}getLayer(s){return this._layers[s]}getLayersOrder(){return[...this._order]}hasLayer(s){return s in this._layers}setLayerZoomRange(s,i,r){this._checkLoaded();const l=this.getLayer(s);l?l.minzoom===i&&l.maxzoom===r||(i!=null&&(l.minzoom=i),r!=null&&(l.maxzoom=r),this._updateLayer(l)):this.fire(new a.j(new Error(`Cannot set the zoom range of non-existing layer "${s}".`)))}setFilter(s,i,r={}){this._checkLoaded();const l=this.getLayer(s);if(l){if(!a.aD(l.filter,i))return i==null?(l.filter=void 0,void this._updateLayer(l)):void(this._validate(a.x.filter,`layers.${l.id}.filter`,i,null,r)||(l.filter=a.aA(i),this._updateLayer(l)))}else this.fire(new a.j(new Error(`Cannot filter non-existing layer "${s}".`)))}getFilter(s){return a.aA(this.getLayer(s).filter)}setLayoutProperty(s,i,r,l={}){this._checkLoaded();const d=this.getLayer(s);d?a.aD(d.getLayoutProperty(i),r)||(d.setLayoutProperty(i,r,l),this._updateLayer(d)):this.fire(new a.j(new Error(`Cannot style non-existing layer "${s}".`)))}getLayoutProperty(s,i){const r=this.getLayer(s);if(r)return r.getLayoutProperty(i);this.fire(new a.j(new Error(`Cannot get style of non-existing layer "${s}".`)))}setPaintProperty(s,i,r,l={}){this._checkLoaded();const d=this.getLayer(s);d?a.aD(d.getPaintProperty(i),r)||(d.setPaintProperty(i,r,l)&&this._updateLayer(d),this._changed=!0,this._updatedPaintProps[s]=!0):this.fire(new a.j(new Error(`Cannot style non-existing layer "${s}".`)))}getPaintProperty(s,i){return this.getLayer(s).getPaintProperty(i)}setFeatureState(s,i){this._checkLoaded();const r=s.source,l=s.sourceLayer,d=this.sourceCaches[r];if(d===void 0)return void this.fire(new a.j(new Error(`The source '${r}' does not exist in the map's style.`)));const _=d.getSource().type;_==="geojson"&&l?this.fire(new a.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):_!=="vector"||l?(s.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),d.setFeatureState(l,s.id,i)):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(s,i){this._checkLoaded();const r=s.source,l=this.sourceCaches[r];if(l===void 0)return void this.fire(new a.j(new Error(`The source '${r}' does not exist in the map's style.`)));const d=l.getSource().type,_=d==="vector"?s.sourceLayer:void 0;d!=="vector"||_?i&&typeof s.id!="string"&&typeof s.id!="number"?this.fire(new a.j(new Error("A feature id is required to remove its specific state property."))):l.removeFeatureState(_,s.id,i):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(s){this._checkLoaded();const i=s.source,r=s.sourceLayer,l=this.sourceCaches[i];if(l!==void 0)return l.getSource().type!=="vector"||r?(s.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),l.getFeatureState(r,s.id)):void this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.j(new Error(`The source '${i}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const s=a.aE(this.sourceCaches,d=>d.serialize()),i=this._serializeByIds(this._order),r=this.map.getTerrain()||void 0,l=this.stylesheet;return a.aF({version:l.version,name:l.name,metadata:l.metadata,light:l.light,center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,sprite:l.sprite,glyphs:l.glyphs,transition:l.transition,sources:s,layers:i,terrain:r},d=>d!==void 0)}_updateLayer(s){this._updatedLayers[s.id]=!0,s.source&&!this._updatedSources[s.source]&&this.sourceCaches[s.source].getSource().type!=="raster"&&(this._updatedSources[s.source]="reload",this.sourceCaches[s.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(s){const i=_=>this._layers[_].type==="fill-extrusion",r={},l=[];for(let _=this._order.length-1;_>=0;_--){const w=this._order[_];if(i(w)){r[w]=_;for(const T of s){const B=T[w];if(B)for(const j of B)l.push(j)}}}l.sort((_,w)=>w.intersectionZ-_.intersectionZ);const d=[];for(let _=this._order.length-1;_>=0;_--){const w=this._order[_];if(i(w))for(let T=l.length-1;T>=0;T--){const B=l[T].feature;if(r[B.layer.id]<_)break;d.push(B),l.pop()}else for(const T of s){const B=T[w];if(B)for(const j of B)d.push(j.feature)}}return d}queryRenderedFeatures(s,i,r){i&&i.filter&&this._validate(a.x.filter,"queryRenderedFeatures.filter",i.filter,null,i);const l={};if(i&&i.layers){if(!Array.isArray(i.layers))return this.fire(new a.j(new Error("parameters.layers must be an Array."))),[];for(const w of i.layers){const T=this._layers[w];if(!T)return this.fire(new a.j(new Error(`The layer '${w}' does not exist in the map's style and cannot be queried for features.`))),[];l[T.source]=!0}}const d=[];i.availableImages=this._availableImages;const _=this._serializedAllLayers();for(const w in this.sourceCaches)i.layers&&!l[w]||d.push(Oi(this.sourceCaches[w],this._layers,_,s,i,r));return this.placement&&d.push(function(w,T,B,j,X,ce,Se){const Te={},Re=ce.queryRenderedSymbols(j),Be=[];for(const Ke of Object.keys(Re).map(Number))Be.push(Se[Ke]);Be.sort(_i);for(const Ke of Be){const yt=Ke.featureIndex.lookupSymbolFeatures(Re[Ke.bucketInstanceId],T,Ke.bucketIndex,Ke.sourceLayerIndex,X.filter,X.layers,X.availableImages,w);for(const ot in yt){const ct=Te[ot]=Te[ot]||[],It=yt[ot];It.sort((bt,ri)=>{const Xt=Ke.featureSortOrder;if(Xt){const ti=Xt.indexOf(bt.featureIndex);return Xt.indexOf(ri.featureIndex)-ti}return ri.featureIndex-bt.featureIndex});for(const bt of It)ct.push(bt)}}for(const Ke in Te)Te[Ke].forEach(yt=>{const ot=yt.feature,ct=B[w[Ke].source].getFeatureState(ot.layer["source-layer"],ot.id);ot.source=ot.layer.source,ot.layer["source-layer"]&&(ot.sourceLayer=ot.layer["source-layer"]),ot.state=ct});return Te}(this._layers,_,this.sourceCaches,s,i,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(d)}querySourceFeatures(s,i){i&&i.filter&&this._validate(a.x.filter,"querySourceFeatures.filter",i.filter,null,i);const r=this.sourceCaches[s];return r?function(l,d){const _=l.getRenderableIds().map(B=>l.getTileByID(B)),w=[],T={};for(let B=0;B<_.length;B++){const j=_[B],X=j.tileID.canonical.key;T[X]||(T[X]=!0,j.querySourceFeatures(w,d))}return w}(r,i):[]}getLight(){return this.light.getLight()}setLight(s,i={}){this._checkLoaded();const r=this.light.getLight();let l=!1;for(const _ in s)if(!a.aD(s[_],r[_])){l=!0;break}if(!l)return;const d={now:ae.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(s,i),this.light.updateTransitions(d)}_validate(s,i,r,l,d={}){return(!d||d.validate!==!1)&&Vt(this,s.call(a.x,a.e({key:i,style:this.serialize(),value:r,styleSpec:a.v},l)))}_remove(s=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Y().off("pluginStateChange",this._rtlTextPluginStateChange);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this.sourceCaches){const r=this.sourceCaches[i];r.setEventedParent(null),r.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),s&&this.dispatcher.broadcast("removeMap",void 0),this.dispatcher.remove(s)}_clearSource(s){this.sourceCaches[s].clearTiles()}_reloadSource(s){this.sourceCaches[s].resume(),this.sourceCaches[s].reload()}_updateSources(s){for(const i in this.sourceCaches)this.sourceCaches[i].update(s,this.map.terrain)}_generateCollisionBoxes(){for(const s in this.sourceCaches)this._reloadSource(s)}_updatePlacement(s,i,r,l,d=!1){let _=!1,w=!1;const T={};for(const B of this._order){const j=this._layers[B];if(j.type!=="symbol")continue;if(!T[j.source]){const ce=this.sourceCaches[j.source];T[j.source]=ce.getRenderableIds(!0).map(Se=>ce.getTileByID(Se)).sort((Se,Te)=>Te.tileID.overscaledZ-Se.tileID.overscaledZ||(Se.tileID.isLessThan(Te.tileID)?-1:1))}const X=this.crossTileSymbolIndex.addLayer(j,T[j.source],s.center.lng);_=_||X}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((d=d||this._layerOrderChanged||r===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(ae.now(),s.zoom))&&(this.pauseablePlacement=new Ki(s,this.map.terrain,this._order,d,i,r,l,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,T),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(ae.now()),w=!0),_&&this.pauseablePlacement.placement.setStale()),w||_)for(const B of this._order){const j=this._layers[B];j.type==="symbol"&&this.placement.updateLayerOpacities(j,T[j.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(ae.now())}_releaseSymbolFadeTiles(){for(const s in this.sourceCaches)this.sourceCaches[s].releaseSymbolFadeTiles()}getImages(s,i){return a._(this,void 0,void 0,function*(){const r=yield this.imageManager.getImages(i.icons);this._updateTilesForChangedImages();const l=this.sourceCaches[i.source];return l&&l.setDependencies(i.tileID.key,i.type,i.icons),r})}getGlyphs(s,i){return a._(this,void 0,void 0,function*(){const r=yield this.glyphManager.getGlyphs(i.stacks),l=this.sourceCaches[i.source];return l&&l.setDependencies(i.tileID.key,i.type,[""]),r})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(s,i={}){this._checkLoaded(),s&&this._validate(a.x.glyphs,"glyphs",s,null,i)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=s,this.glyphManager.entries={},this.glyphManager.setURL(s))}addSprite(s,i,r={},l){this._checkLoaded();const d=[{id:s,url:i}],_=[...Et(this.stylesheet.sprite),...d];this._validate(a.x.sprite,"sprite",_,null,r)||(this.stylesheet.sprite=_,this._loadSprite(d,!0,l))}removeSprite(s){this._checkLoaded();const i=Et(this.stylesheet.sprite);if(i.find(r=>r.id===s)){if(this._spritesImagesIds[s])for(const r of this._spritesImagesIds[s])this.imageManager.removeImage(r),this._changedImages[r]=!0;i.splice(i.findIndex(r=>r.id===s),1),this.stylesheet.sprite=i.length>0?i:void 0,delete this._spritesImagesIds[s],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}else this.fire(new a.j(new Error(`Sprite "${s}" doesn't exists on this map.`)))}getSprite(){return Et(this.stylesheet.sprite)}setSprite(s,i={},r){this._checkLoaded(),s&&this._validate(a.x.sprite,"sprite",s,null,i)||(this.stylesheet.sprite=s,s?this._loadSprite(s,!0,r):(this._unloadSprite(),r&&r(null)))}}var Fr=a.X([{name:"a_pos",type:"Int16",components:2}]),Us="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const ua={prelude:Dr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Dr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Dr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Dr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Dr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Dr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Dr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Dr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Dr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Dr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Dr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Dr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Dr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Dr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Dr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Dr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Dr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Dr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Dr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Dr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Dr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Dr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Dr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Dr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Dr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Dr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Dr("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Us),terrainDepth:Dr("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Us),terrainCoords:Dr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Us)};function Dr(y,s){const i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=s.match(/attribute ([\w]+) ([\w]+)/g),l=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),d=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=d?d.concat(l):l,w={};return{fragmentSource:y=y.replace(i,(T,B,j,X,ce)=>(w[ce]=!0,B==="define"?`
#ifndef HAS_UNIFORM_u_${ce}
varying ${j} ${X} ${ce};
#else
uniform ${j} ${X} u_${ce};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ce}
    ${j} ${X} ${ce} = u_${ce};
#endif
`)),vertexSource:s=s.replace(i,(T,B,j,X,ce)=>{const Se=X==="float"?"vec2":"vec4",Te=ce.match(/color/)?"color":Se;return w[ce]?B==="define"?`
#ifndef HAS_UNIFORM_u_${ce}
uniform lowp float u_${ce}_t;
attribute ${j} ${Se} a_${ce};
varying ${j} ${X} ${ce};
#else
uniform ${j} ${X} u_${ce};
#endif
`:Te==="vec4"?`
#ifndef HAS_UNIFORM_u_${ce}
    ${ce} = a_${ce};
#else
    ${j} ${X} ${ce} = u_${ce};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ce}
    ${ce} = unpack_mix_${Te}(a_${ce}, u_${ce}_t);
#else
    ${j} ${X} ${ce} = u_${ce};
#endif
`:B==="define"?`
#ifndef HAS_UNIFORM_u_${ce}
uniform lowp float u_${ce}_t;
attribute ${j} ${Se} a_${ce};
#else
uniform ${j} ${X} u_${ce};
#endif
`:Te==="vec4"?`
#ifndef HAS_UNIFORM_u_${ce}
    ${j} ${X} ${ce} = a_${ce};
#else
    ${j} ${X} ${ce} = u_${ce};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ce}
    ${j} ${X} ${ce} = unpack_mix_${Te}(a_${ce}, u_${ce}_t);
#else
    ${j} ${X} ${ce} = u_${ce};
#endif
`}),staticAttributes:r,staticUniforms:_}}class Na{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(s,i,r,l,d,_,w,T,B){this.context=s;let j=this.boundPaintVertexBuffers.length!==l.length;for(let X=0;!j&&X<l.length;X++)this.boundPaintVertexBuffers[X]!==l[X]&&(j=!0);!this.vao||this.boundProgram!==i||this.boundLayoutVertexBuffer!==r||j||this.boundIndexBuffer!==d||this.boundVertexOffset!==_||this.boundDynamicVertexBuffer!==w||this.boundDynamicVertexBuffer2!==T||this.boundDynamicVertexBuffer3!==B?this.freshBind(i,r,l,d,_,w,T,B):(s.bindVertexArray.set(this.vao),w&&w.bind(),d&&d.dynamicDraw&&d.bind(),T&&T.bind(),B&&B.bind())}freshBind(s,i,r,l,d,_,w,T){const B=s.numAttributes,j=this.context,X=j.gl;this.vao&&this.destroy(),this.vao=j.createVertexArray(),j.bindVertexArray.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=i,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=l,this.boundVertexOffset=d,this.boundDynamicVertexBuffer=_,this.boundDynamicVertexBuffer2=w,this.boundDynamicVertexBuffer3=T,i.enableAttributes(X,s);for(const ce of r)ce.enableAttributes(X,s);_&&_.enableAttributes(X,s),w&&w.enableAttributes(X,s),T&&T.enableAttributes(X,s),i.bind(),i.setVertexAttribPointers(X,s,d);for(const ce of r)ce.bind(),ce.setVertexAttribPointers(X,s,d);_&&(_.bind(),_.setVertexAttribPointers(X,s,d)),l&&l.bind(),w&&(w.bind(),w.setVertexAttribPointers(X,s,d)),T&&(T.bind(),T.setVertexAttribPointers(X,s,d)),j.currentNumAttributes=B}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Fo(y){const s=[];for(let i=0;i<y.length;i++){if(y[i]===null)continue;const r=y[i].split(" ");s.push(r.pop())}return s}class Va{constructor(s,i,r,l,d,_){const w=s.gl;this.program=w.createProgram();const T=Fo(i.staticAttributes),B=r?r.getBinderAttributes():[],j=T.concat(B),X=ua.prelude.staticUniforms?Fo(ua.prelude.staticUniforms):[],ce=i.staticUniforms?Fo(i.staticUniforms):[],Se=r?r.getBinderUniforms():[],Te=X.concat(ce).concat(Se),Re=[];for(const bt of Te)Re.indexOf(bt)<0&&Re.push(bt);const Be=r?r.defines():[];d&&Be.push("#define OVERDRAW_INSPECTOR;"),_&&Be.push("#define TERRAIN3D;");const Ke=Be.concat(ua.prelude.fragmentSource,i.fragmentSource).join(`
`),yt=Be.concat(ua.prelude.vertexSource,i.vertexSource).join(`
`),ot=w.createShader(w.FRAGMENT_SHADER);if(w.isContextLost())return void(this.failedToCreate=!0);if(w.shaderSource(ot,Ke),w.compileShader(ot),!w.getShaderParameter(ot,w.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${w.getShaderInfoLog(ot)}`);w.attachShader(this.program,ot);const ct=w.createShader(w.VERTEX_SHADER);if(w.isContextLost())return void(this.failedToCreate=!0);if(w.shaderSource(ct,yt),w.compileShader(ct),!w.getShaderParameter(ct,w.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${w.getShaderInfoLog(ct)}`);w.attachShader(this.program,ct),this.attributes={};const It={};this.numAttributes=j.length;for(let bt=0;bt<this.numAttributes;bt++)j[bt]&&(w.bindAttribLocation(this.program,bt,j[bt]),this.attributes[j[bt]]=bt);if(w.linkProgram(this.program),!w.getProgramParameter(this.program,w.LINK_STATUS))throw new Error(`Program failed to link: ${w.getProgramInfoLog(this.program)}`);w.deleteShader(ct),w.deleteShader(ot);for(let bt=0;bt<Re.length;bt++){const ri=Re[bt];if(ri&&!It[ri]){const Xt=w.getUniformLocation(this.program,ri);Xt&&(It[ri]=Xt)}}this.fixedUniforms=l(s,It),this.terrainUniforms=((bt,ri)=>({u_depth:new a.aG(bt,ri.u_depth),u_terrain:new a.aG(bt,ri.u_terrain),u_terrain_dim:new a.aH(bt,ri.u_terrain_dim),u_terrain_matrix:new a.aI(bt,ri.u_terrain_matrix),u_terrain_unpack:new a.aJ(bt,ri.u_terrain_unpack),u_terrain_exaggeration:new a.aH(bt,ri.u_terrain_exaggeration)}))(s,It),this.binderUniforms=r?r.getUniforms(s,It):[]}draw(s,i,r,l,d,_,w,T,B,j,X,ce,Se,Te,Re,Be,Ke,yt){const ot=s.gl;if(this.failedToCreate)return;if(s.program.set(this.program),s.setDepthMode(r),s.setStencilMode(l),s.setColorMode(d),s.setCullFace(_),T){s.activeTexture.set(ot.TEXTURE2),ot.bindTexture(ot.TEXTURE_2D,T.depthTexture),s.activeTexture.set(ot.TEXTURE3),ot.bindTexture(ot.TEXTURE_2D,T.texture);for(const It in this.terrainUniforms)this.terrainUniforms[It].set(T[It])}for(const It in this.fixedUniforms)this.fixedUniforms[It].set(w[It]);Re&&Re.setUniforms(s,this.binderUniforms,Se,{zoom:Te});let ct=0;switch(i){case ot.LINES:ct=2;break;case ot.TRIANGLES:ct=3;break;case ot.LINE_STRIP:ct=1}for(const It of ce.get()){const bt=It.vaos||(It.vaos={});(bt[B]||(bt[B]=new Na)).bind(s,this,j,Re?Re.getPaintVertexBuffers():[],X,It.vertexOffset,Be,Ke,yt),ot.drawElements(i,It.primitiveLength*ct,ot.UNSIGNED_SHORT,It.primitiveOffset*ct*2)}}}function Xs(y,s,i){const r=1/kt(i,1,s.transform.tileZoom),l=Math.pow(2,i.tileID.overscaledZ),d=i.tileSize*Math.pow(2,s.transform.tileZoom)/l,_=d*(i.tileID.canonical.x+i.tileID.wrap*l),w=d*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[r,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[_>>16,w>>16],u_pixel_coord_lower:[65535&_,65535&w]}}const Zn=(y,s,i,r)=>{const l=s.style.light,d=l.properties.get("position"),_=[d.x,d.y,d.z],w=function(){var B=new a.A(9);return a.A!=Float32Array&&(B[1]=0,B[2]=0,B[3]=0,B[5]=0,B[6]=0,B[7]=0),B[0]=1,B[4]=1,B[8]=1,B}();l.properties.get("anchor")==="viewport"&&function(B,j){var X=Math.sin(j),ce=Math.cos(j);B[0]=ce,B[1]=X,B[2]=0,B[3]=-X,B[4]=ce,B[5]=0,B[6]=0,B[7]=0,B[8]=1}(w,-s.transform.angle),function(B,j,X){var ce=j[0],Se=j[1],Te=j[2];B[0]=ce*X[0]+Se*X[3]+Te*X[6],B[1]=ce*X[1]+Se*X[4]+Te*X[7],B[2]=ce*X[2]+Se*X[5]+Te*X[8]}(_,_,w);const T=l.properties.get("color");return{u_matrix:y,u_lightpos:_,u_lightintensity:l.properties.get("intensity"),u_lightcolor:[T.r,T.g,T.b],u_vertical_gradient:+i,u_opacity:r}},aa=(y,s,i,r,l,d,_)=>a.e(Zn(y,s,i,r),Xs(d,s,_),{u_height_factor:-Math.pow(2,l.overscaledZ)/_.tileSize/8}),hs=y=>({u_matrix:y}),Ua=(y,s,i,r)=>a.e(hs(y),Xs(i,s,r)),al=(y,s)=>({u_matrix:y,u_world:s}),ol=(y,s,i,r,l)=>a.e(Ua(y,s,i,r),{u_world:l}),no=(y,s,i,r)=>{const l=y.transform;let d,_;if(r.paint.get("circle-pitch-alignment")==="map"){const w=kt(i,1,l.zoom);d=!0,_=[w,w]}else d=!1,_=l.pixelsToGLUnits;return{u_camera_to_center_distance:l.cameraToCenterDistance,u_scale_with_map:+(r.paint.get("circle-pitch-scale")==="map"),u_matrix:y.translatePosMatrix(s.posMatrix,i,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_pitch_with_map:+d,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:_}},Ga=(y,s,i)=>{const r=kt(i,1,s.zoom),l=Math.pow(2,s.zoom-i.tileID.overscaledZ),d=i.tileID.overscaleFactor();return{u_matrix:y,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:r,u_extrude_scale:[s.pixelsToGLUnits[0]/(r*l),s.pixelsToGLUnits[1]/(r*l)],u_overscale_factor:d}},N=(y,s,i=1)=>({u_matrix:y,u_color:s,u_overlay:0,u_overlay_scale:i}),xe=y=>({u_matrix:y}),rt=(y,s,i,r)=>({u_matrix:y,u_extrude_scale:kt(s,1,i),u_intensity:r});function St(y,s){const i=Math.pow(2,s.canonical.z),r=s.canonical.y;return[new a.Y(0,r/i).toLngLat().lat,new a.Y(0,(r+1)/i).toLngLat().lat]}const $t=(y,s,i,r)=>{const l=y.transform;return{u_matrix:sr(y,s,i,r),u_ratio:1/kt(s,1,l.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/l.pixelsToGLUnits[0],1/l.pixelsToGLUnits[1]]}},Ii=(y,s,i,r,l)=>a.e($t(y,s,i,l),{u_image:0,u_image_height:r}),Li=(y,s,i,r,l)=>{const d=y.transform,_=pn(s,d);return{u_matrix:sr(y,s,i,l),u_texsize:s.imageAtlasTexture.size,u_ratio:1/kt(s,1,d.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[_,r.fromScale,r.toScale],u_fade:r.t,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},An=(y,s,i,r,l,d)=>{const _=y.lineAtlas,w=pn(s,y.transform),T=i.layout.get("line-cap")==="round",B=_.getDash(r.from,T),j=_.getDash(r.to,T),X=B.width*l.fromScale,ce=j.width*l.toScale;return a.e($t(y,s,i,d),{u_patternscale_a:[w/X,-B.height/2],u_patternscale_b:[w/ce,-j.height/2],u_sdfgamma:_.width/(256*Math.min(X,ce)*y.pixelRatio)/2,u_image:0,u_tex_y_a:B.y,u_tex_y_b:j.y,u_mix:l.t})};function pn(y,s){return 1/kt(y,1,s.tileZoom)}function sr(y,s,i,r){return y.translatePosMatrix(r?r.posMatrix:s.tileID.posMatrix,s,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const Ar=(y,s,i,r,l)=>{return{u_matrix:y,u_tl_parent:s,u_scale_parent:i,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(_=l.paint.get("raster-saturation"),_>0?1-1/(1.001-_):-_),u_contrast_factor:(d=l.paint.get("raster-contrast"),d>0?1/(1-d):1+d),u_spin_weights:Or(l.paint.get("raster-hue-rotate"))};var d,_};function Or(y){y*=Math.PI/180;const s=Math.sin(y),i=Math.cos(y);return[(2*i+1)/3,(-Math.sqrt(3)*s-i+1)/3,(Math.sqrt(3)*s-i+1)/3]}const qa=(y,s,i,r,l,d,_,w,T,B)=>{const j=l.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:j.cameraToCenterDistance,u_pitch:j.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:j.width/j.height,u_fade_change:l.options.fadeDuration?l.symbolFadeChange:1,u_matrix:d,u_label_plane_matrix:_,u_coord_matrix:w,u_is_text:+T,u_pitch_with_map:+r,u_texsize:B,u_texture:0}},Ha=(y,s,i,r,l,d,_,w,T,B,j)=>{const X=l.transform;return a.e(qa(y,s,i,r,l,d,_,w,T,B),{u_gamma_scale:r?Math.cos(X._pitch)*X.cameraToCenterDistance:1,u_device_pixel_ratio:l.pixelRatio,u_is_halo:+j})},ja=(y,s,i,r,l,d,_,w,T,B)=>a.e(Ha(y,s,i,r,l,d,_,w,!0,T,!0),{u_texsize_icon:B,u_texture_icon:1}),pl=(y,s,i)=>({u_matrix:y,u_opacity:s,u_color:i}),Gr=(y,s,i,r,l,d)=>a.e(function(_,w,T,B){const j=T.imageManager.getPattern(_.from.toString()),X=T.imageManager.getPattern(_.to.toString()),{width:ce,height:Se}=T.imageManager.getPixelSize(),Te=Math.pow(2,B.tileID.overscaledZ),Re=B.tileSize*Math.pow(2,T.transform.tileZoom)/Te,Be=Re*(B.tileID.canonical.x+B.tileID.wrap*Te),Ke=Re*B.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:j.tl,u_pattern_br_a:j.br,u_pattern_tl_b:X.tl,u_pattern_br_b:X.br,u_texsize:[ce,Se],u_mix:w.t,u_pattern_size_a:j.displaySize,u_pattern_size_b:X.displaySize,u_scale_a:w.fromScale,u_scale_b:w.toScale,u_tile_units_to_pixels:1/kt(B,1,T.transform.tileZoom),u_pixel_coord_upper:[Be>>16,Ke>>16],u_pixel_coord_lower:[65535&Be,65535&Ke]}}(r,d,i,l),{u_matrix:y,u_opacity:s}),nr={fillExtrusion:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_lightpos:new a.aK(y,s.u_lightpos),u_lightintensity:new a.aH(y,s.u_lightintensity),u_lightcolor:new a.aK(y,s.u_lightcolor),u_vertical_gradient:new a.aH(y,s.u_vertical_gradient),u_opacity:new a.aH(y,s.u_opacity)}),fillExtrusionPattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_lightpos:new a.aK(y,s.u_lightpos),u_lightintensity:new a.aH(y,s.u_lightintensity),u_lightcolor:new a.aK(y,s.u_lightcolor),u_vertical_gradient:new a.aH(y,s.u_vertical_gradient),u_height_factor:new a.aH(y,s.u_height_factor),u_image:new a.aG(y,s.u_image),u_texsize:new a.aL(y,s.u_texsize),u_pixel_coord_upper:new a.aL(y,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(y,s.u_pixel_coord_lower),u_scale:new a.aK(y,s.u_scale),u_fade:new a.aH(y,s.u_fade),u_opacity:new a.aH(y,s.u_opacity)}),fill:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix)}),fillPattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_image:new a.aG(y,s.u_image),u_texsize:new a.aL(y,s.u_texsize),u_pixel_coord_upper:new a.aL(y,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(y,s.u_pixel_coord_lower),u_scale:new a.aK(y,s.u_scale),u_fade:new a.aH(y,s.u_fade)}),fillOutline:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_world:new a.aL(y,s.u_world)}),fillOutlinePattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_world:new a.aL(y,s.u_world),u_image:new a.aG(y,s.u_image),u_texsize:new a.aL(y,s.u_texsize),u_pixel_coord_upper:new a.aL(y,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(y,s.u_pixel_coord_lower),u_scale:new a.aK(y,s.u_scale),u_fade:new a.aH(y,s.u_fade)}),circle:(y,s)=>({u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_scale_with_map:new a.aG(y,s.u_scale_with_map),u_pitch_with_map:new a.aG(y,s.u_pitch_with_map),u_extrude_scale:new a.aL(y,s.u_extrude_scale),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_matrix:new a.aI(y,s.u_matrix)}),collisionBox:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_pixels_to_tile_units:new a.aH(y,s.u_pixels_to_tile_units),u_extrude_scale:new a.aL(y,s.u_extrude_scale),u_overscale_factor:new a.aH(y,s.u_overscale_factor)}),collisionCircle:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_inv_matrix:new a.aI(y,s.u_inv_matrix),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_viewport_size:new a.aL(y,s.u_viewport_size)}),debug:(y,s)=>({u_color:new a.aM(y,s.u_color),u_matrix:new a.aI(y,s.u_matrix),u_overlay:new a.aG(y,s.u_overlay),u_overlay_scale:new a.aH(y,s.u_overlay_scale)}),clippingMask:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix)}),heatmap:(y,s)=>({u_extrude_scale:new a.aH(y,s.u_extrude_scale),u_intensity:new a.aH(y,s.u_intensity),u_matrix:new a.aI(y,s.u_matrix)}),heatmapTexture:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_world:new a.aL(y,s.u_world),u_image:new a.aG(y,s.u_image),u_color_ramp:new a.aG(y,s.u_color_ramp),u_opacity:new a.aH(y,s.u_opacity)}),hillshade:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_image:new a.aG(y,s.u_image),u_latrange:new a.aL(y,s.u_latrange),u_light:new a.aL(y,s.u_light),u_shadow:new a.aM(y,s.u_shadow),u_highlight:new a.aM(y,s.u_highlight),u_accent:new a.aM(y,s.u_accent)}),hillshadePrepare:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_image:new a.aG(y,s.u_image),u_dimension:new a.aL(y,s.u_dimension),u_zoom:new a.aH(y,s.u_zoom),u_unpack:new a.aJ(y,s.u_unpack)}),line:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_ratio:new a.aH(y,s.u_ratio),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_units_to_pixels:new a.aL(y,s.u_units_to_pixels)}),lineGradient:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_ratio:new a.aH(y,s.u_ratio),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_units_to_pixels:new a.aL(y,s.u_units_to_pixels),u_image:new a.aG(y,s.u_image),u_image_height:new a.aH(y,s.u_image_height)}),linePattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_texsize:new a.aL(y,s.u_texsize),u_ratio:new a.aH(y,s.u_ratio),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_image:new a.aG(y,s.u_image),u_units_to_pixels:new a.aL(y,s.u_units_to_pixels),u_scale:new a.aK(y,s.u_scale),u_fade:new a.aH(y,s.u_fade)}),lineSDF:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_ratio:new a.aH(y,s.u_ratio),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_units_to_pixels:new a.aL(y,s.u_units_to_pixels),u_patternscale_a:new a.aL(y,s.u_patternscale_a),u_patternscale_b:new a.aL(y,s.u_patternscale_b),u_sdfgamma:new a.aH(y,s.u_sdfgamma),u_image:new a.aG(y,s.u_image),u_tex_y_a:new a.aH(y,s.u_tex_y_a),u_tex_y_b:new a.aH(y,s.u_tex_y_b),u_mix:new a.aH(y,s.u_mix)}),raster:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_tl_parent:new a.aL(y,s.u_tl_parent),u_scale_parent:new a.aH(y,s.u_scale_parent),u_buffer_scale:new a.aH(y,s.u_buffer_scale),u_fade_t:new a.aH(y,s.u_fade_t),u_opacity:new a.aH(y,s.u_opacity),u_image0:new a.aG(y,s.u_image0),u_image1:new a.aG(y,s.u_image1),u_brightness_low:new a.aH(y,s.u_brightness_low),u_brightness_high:new a.aH(y,s.u_brightness_high),u_saturation_factor:new a.aH(y,s.u_saturation_factor),u_contrast_factor:new a.aH(y,s.u_contrast_factor),u_spin_weights:new a.aK(y,s.u_spin_weights)}),symbolIcon:(y,s)=>({u_is_size_zoom_constant:new a.aG(y,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aG(y,s.u_is_size_feature_constant),u_size_t:new a.aH(y,s.u_size_t),u_size:new a.aH(y,s.u_size),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_pitch:new a.aH(y,s.u_pitch),u_rotate_symbol:new a.aG(y,s.u_rotate_symbol),u_aspect_ratio:new a.aH(y,s.u_aspect_ratio),u_fade_change:new a.aH(y,s.u_fade_change),u_matrix:new a.aI(y,s.u_matrix),u_label_plane_matrix:new a.aI(y,s.u_label_plane_matrix),u_coord_matrix:new a.aI(y,s.u_coord_matrix),u_is_text:new a.aG(y,s.u_is_text),u_pitch_with_map:new a.aG(y,s.u_pitch_with_map),u_texsize:new a.aL(y,s.u_texsize),u_texture:new a.aG(y,s.u_texture)}),symbolSDF:(y,s)=>({u_is_size_zoom_constant:new a.aG(y,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aG(y,s.u_is_size_feature_constant),u_size_t:new a.aH(y,s.u_size_t),u_size:new a.aH(y,s.u_size),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_pitch:new a.aH(y,s.u_pitch),u_rotate_symbol:new a.aG(y,s.u_rotate_symbol),u_aspect_ratio:new a.aH(y,s.u_aspect_ratio),u_fade_change:new a.aH(y,s.u_fade_change),u_matrix:new a.aI(y,s.u_matrix),u_label_plane_matrix:new a.aI(y,s.u_label_plane_matrix),u_coord_matrix:new a.aI(y,s.u_coord_matrix),u_is_text:new a.aG(y,s.u_is_text),u_pitch_with_map:new a.aG(y,s.u_pitch_with_map),u_texsize:new a.aL(y,s.u_texsize),u_texture:new a.aG(y,s.u_texture),u_gamma_scale:new a.aH(y,s.u_gamma_scale),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_is_halo:new a.aG(y,s.u_is_halo)}),symbolTextAndIcon:(y,s)=>({u_is_size_zoom_constant:new a.aG(y,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aG(y,s.u_is_size_feature_constant),u_size_t:new a.aH(y,s.u_size_t),u_size:new a.aH(y,s.u_size),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_pitch:new a.aH(y,s.u_pitch),u_rotate_symbol:new a.aG(y,s.u_rotate_symbol),u_aspect_ratio:new a.aH(y,s.u_aspect_ratio),u_fade_change:new a.aH(y,s.u_fade_change),u_matrix:new a.aI(y,s.u_matrix),u_label_plane_matrix:new a.aI(y,s.u_label_plane_matrix),u_coord_matrix:new a.aI(y,s.u_coord_matrix),u_is_text:new a.aG(y,s.u_is_text),u_pitch_with_map:new a.aG(y,s.u_pitch_with_map),u_texsize:new a.aL(y,s.u_texsize),u_texsize_icon:new a.aL(y,s.u_texsize_icon),u_texture:new a.aG(y,s.u_texture),u_texture_icon:new a.aG(y,s.u_texture_icon),u_gamma_scale:new a.aH(y,s.u_gamma_scale),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_is_halo:new a.aG(y,s.u_is_halo)}),background:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_opacity:new a.aH(y,s.u_opacity),u_color:new a.aM(y,s.u_color)}),backgroundPattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_opacity:new a.aH(y,s.u_opacity),u_image:new a.aG(y,s.u_image),u_pattern_tl_a:new a.aL(y,s.u_pattern_tl_a),u_pattern_br_a:new a.aL(y,s.u_pattern_br_a),u_pattern_tl_b:new a.aL(y,s.u_pattern_tl_b),u_pattern_br_b:new a.aL(y,s.u_pattern_br_b),u_texsize:new a.aL(y,s.u_texsize),u_mix:new a.aH(y,s.u_mix),u_pattern_size_a:new a.aL(y,s.u_pattern_size_a),u_pattern_size_b:new a.aL(y,s.u_pattern_size_b),u_scale_a:new a.aH(y,s.u_scale_a),u_scale_b:new a.aH(y,s.u_scale_b),u_pixel_coord_upper:new a.aL(y,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(y,s.u_pixel_coord_lower),u_tile_units_to_pixels:new a.aH(y,s.u_tile_units_to_pixels)}),terrain:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_texture:new a.aG(y,s.u_texture),u_ele_delta:new a.aH(y,s.u_ele_delta)}),terrainDepth:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_ele_delta:new a.aH(y,s.u_ele_delta)}),terrainCoords:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_texture:new a.aG(y,s.u_texture),u_terrain_coords_id:new a.aH(y,s.u_terrain_coords_id),u_ele_delta:new a.aH(y,s.u_ele_delta)})};class Ir{constructor(s,i,r){this.context=s;const l=s.gl;this.buffer=l.createBuffer(),this.dynamicDraw=!!r,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),l.bufferData(l.ELEMENT_ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?l.DYNAMIC_DRAW:l.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){const i=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Lr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Zs{constructor(s,i,r,l){this.length=i.length,this.attributes=r,this.itemSize=i.bytesPerElement,this.dynamicDraw=l,this.context=s;const d=s.gl;this.buffer=d.createBuffer(),s.bindVertexBuffer.set(this.buffer),d.bufferData(d.ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){if(s.length!==this.length)throw new Error(`Length of new data is ${s.length}, which doesn't match current length of ${this.length}`);const i=this.context.gl;this.bind(),i.bufferSubData(i.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,i){for(let r=0;r<this.attributes.length;r++){const l=i.attributes[this.attributes[r].name];l!==void 0&&s.enableVertexAttribArray(l)}}setVertexAttribPointers(s,i,r){for(let l=0;l<this.attributes.length;l++){const d=this.attributes[l],_=i.attributes[d.name];_!==void 0&&s.vertexAttribPointer(_,d.components,s[Lr[d.type]],!1,this.itemSize,d.offset+this.itemSize*(r||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const vr=new WeakMap;function Ks(y){var s;if(vr.has(y))return vr.get(y);{const i=(s=y.getParameter(y.VERSION))===null||s===void 0?void 0:s.startsWith("WebGL 2.0");return vr.set(y,i),i}}class Br{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Eo extends Br{getDefault(){return a.aO.transparent}set(s){const i=this.current;(s.r!==i.r||s.g!==i.g||s.b!==i.b||s.a!==i.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Zo extends Br{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class Bs extends Br{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class Il extends Br{getDefault(){return[!0,!0,!0,!0]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||s[2]!==i[2]||s[3]!==i[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class mo extends Br{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class Qo extends Br{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class ca extends Br{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const i=this.current;(s.func!==i.func||s.ref!==i.ref||s.mask!==i.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class Ys extends Br{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||s[2]!==i[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class El extends Br{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.STENCIL_TEST):i.disable(i.STENCIL_TEST),this.current=s,this.dirty=!1}}class Za extends Br{getDefault(){return[0,1]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class Ta extends Br{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.DEPTH_TEST):i.disable(i.DEPTH_TEST),this.current=s,this.dirty=!1}}class ml extends Br{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class Cl extends Br{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.BLEND):i.disable(i.BLEND),this.current=s,this.dirty=!1}}class mu extends Br{getDefault(){const s=this.gl;return[s.ONE,s.ZERO]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||this.dirty)&&(this.gl.blendFunc(s[0],s[1]),this.current=s,this.dirty=!1)}}class As extends Br{getDefault(){return a.aO.transparent}set(s){const i=this.current;(s.r!==i.r||s.g!==i.g||s.b!==i.b||s.a!==i.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class ac extends Br{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquation(s),this.current=s,this.dirty=!1)}}class ro extends Br{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.CULL_FACE):i.disable(i.CULL_FACE),this.current=s,this.dirty=!1}}class so extends Br{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class Ql extends Br{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}class Oo extends Br{getDefault(){return null}set(s){(s!==this.current||this.dirty)&&(this.gl.useProgram(s),this.current=s,this.dirty=!1)}}class Wo extends Br{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class Co extends Br{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||s[2]!==i[2]||s[3]!==i[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Gs extends Br{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindFramebuffer(i.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class $o extends Br{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindRenderbuffer(i.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Xo extends Br{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindTexture(i.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class Yo extends Br{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindBuffer(i.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class ba extends Br{getDefault(){return null}set(s){const i=this.gl;i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class Qa extends Br{getDefault(){return null}set(s){var i;if(s===this.current&&!this.dirty)return;const r=this.gl;Ks(r)?r.bindVertexArray(s):(i=r.getExtension("OES_vertex_array_object"))===null||i===void 0||i.bindVertexArrayOES(s),this.current=s,this.dirty=!1}}class Cs extends Br{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class gu extends Br{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class Er extends Br{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class $n extends Br{constructor(s,i){super(s),this.context=s,this.parent=i}getDefault(){return null}}class Ko extends $n{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class zr extends $n{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Wa extends $n{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Jr{constructor(s,i,r,l,d){this.context=s,this.width=i,this.height=r;const _=s.gl,w=this.framebuffer=_.createFramebuffer();if(this.colorAttachment=new Ko(s,w),l)this.depthAttachment=d?new Wa(s,w):new zr(s,w);else if(d)throw new Error("Stencil cannot be set without depth");if(_.checkFramebufferStatus(_.FRAMEBUFFER)!==_.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const s=this.context.gl,i=this.colorAttachment.get();if(i&&s.deleteTexture(i),this.depthAttachment){const r=this.depthAttachment.get();r&&s.deleteRenderbuffer(r)}s.deleteFramebuffer(this.framebuffer)}}class fr{constructor(s,i,r){this.blendFunction=s,this.blendColor=i,this.mask=r}}fr.Replace=[1,0],fr.disabled=new fr(fr.Replace,a.aO.transparent,[!1,!1,!1,!1]),fr.unblended=new fr(fr.Replace,a.aO.transparent,[!0,!0,!0,!0]),fr.alphaBlended=new fr([1,771],a.aO.transparent,[!0,!0,!0,!0]);class To{constructor(s){var i,r;if(this.gl=s,this.clearColor=new Eo(this),this.clearDepth=new Zo(this),this.clearStencil=new Bs(this),this.colorMask=new Il(this),this.depthMask=new mo(this),this.stencilMask=new Qo(this),this.stencilFunc=new ca(this),this.stencilOp=new Ys(this),this.stencilTest=new El(this),this.depthRange=new Za(this),this.depthTest=new Ta(this),this.depthFunc=new ml(this),this.blend=new Cl(this),this.blendFunc=new mu(this),this.blendColor=new As(this),this.blendEquation=new ac(this),this.cullFace=new ro(this),this.cullFaceSide=new so(this),this.frontFace=new Ql(this),this.program=new Oo(this),this.activeTexture=new Wo(this),this.viewport=new Co(this),this.bindFramebuffer=new Gs(this),this.bindRenderbuffer=new $o(this),this.bindTexture=new Xo(this),this.bindVertexBuffer=new Yo(this),this.bindElementBuffer=new ba(this),this.bindVertexArray=new Qa(this),this.pixelStoreUnpack=new Cs(this),this.pixelStoreUnpackPremultiplyAlpha=new gu(this),this.pixelStoreUnpackFlipY=new Er(this),this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),Ks(s)){this.HALF_FLOAT=s.HALF_FLOAT;const l=s.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(i=s.RGBA16F)!==null&&i!==void 0?i:l==null?void 0:l.RGBA16F_EXT,this.RGB16F=(r=s.RGB16F)!==null&&r!==void 0?r:l==null?void 0:l.RGB16F_EXT,s.getExtension("EXT_color_buffer_float")}else{s.getExtension("EXT_color_buffer_half_float"),s.getExtension("OES_texture_half_float_linear");const l=s.getExtension("OES_texture_half_float");this.HALF_FLOAT=l==null?void 0:l.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,i){return new Ir(this,s,i)}createVertexBuffer(s,i,r){return new Zs(this,s,i,r)}createRenderbuffer(s,i,r){const l=this.gl,d=l.createRenderbuffer();return this.bindRenderbuffer.set(d),l.renderbufferStorage(l.RENDERBUFFER,s,i,r),this.bindRenderbuffer.set(null),d}createFramebuffer(s,i,r,l){return new Jr(this,s,i,r,l)}clear({color:s,depth:i,stencil:r}){const l=this.gl;let d=0;s&&(d|=l.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),i!==void 0&&(d|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),r!==void 0&&(d|=l.STENCIL_BUFFER_BIT,this.clearStencil.set(r),this.stencilMask.set(255)),l.clear(d)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){a.aD(s.blendFunction,fr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)}createVertexArray(){var s;return Ks(this.gl)?this.gl.createVertexArray():(s=this.gl.getExtension("OES_vertex_array_object"))===null||s===void 0?void 0:s.createVertexArrayOES()}deleteVertexArray(s){var i;return Ks(this.gl)?this.gl.deleteVertexArray(s):(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.deleteVertexArrayOES(s)}unbindVAO(){this.bindVertexArray.set(null)}}class Gn{constructor(s,i,r){this.func=s,this.mask=i,this.range=r}}Gn.ReadOnly=!1,Gn.ReadWrite=!0,Gn.disabled=new Gn(519,Gn.ReadOnly,[0,1]);const Ol=7680;class es{constructor(s,i,r,l,d,_){this.test=s,this.ref=i,this.mask=r,this.fail=l,this.depthFail=d,this.pass=_}}es.disabled=new es({func:519,mask:0},0,0,Ol,Ol,Ol);class Zr{constructor(s,i,r){this.enable=s,this.mode=i,this.frontFace=r}}let Ts;function kr(y,s,i,r,l,d,_){const w=y.context,T=w.gl,B=y.useProgram("collisionBox"),j=[];let X=0,ce=0;for(let ot=0;ot<r.length;ot++){const ct=r[ot],It=s.getTile(ct),bt=It.getBucket(i);if(!bt)continue;let ri=ct.posMatrix;l[0]===0&&l[1]===0||(ri=y.translatePosMatrix(ct.posMatrix,It,l,d));const Xt=_?bt.textCollisionBox:bt.iconCollisionBox,ti=bt.collisionCircleArray;if(ti.length>0){const si=a.F(),Qi=ri;a.aP(si,bt.placementInvProjMatrix,y.transform.glCoordMatrix),a.aP(si,si,bt.placementViewportMatrix),j.push({circleArray:ti,circleOffset:ce,transform:Qi,invTransform:si,coord:ct}),X+=ti.length/4,ce=X}Xt&&B.draw(w,T.LINES,Gn.disabled,es.disabled,y.colorModeForRenderPass(),Zr.disabled,Ga(ri,y.transform,It),y.style.map.terrain&&y.style.map.terrain.getTerrainData(ct),i.id,Xt.layoutVertexBuffer,Xt.indexBuffer,Xt.segments,null,y.transform.zoom,null,null,Xt.collisionVertexBuffer)}if(!_||!j.length)return;const Se=y.useProgram("collisionCircle"),Te=new a.aQ;Te.resize(4*X),Te._trim();let Re=0;for(const ot of j)for(let ct=0;ct<ot.circleArray.length/4;ct++){const It=4*ct,bt=ot.circleArray[It+0],ri=ot.circleArray[It+1],Xt=ot.circleArray[It+2],ti=ot.circleArray[It+3];Te.emplace(Re++,bt,ri,Xt,ti,0),Te.emplace(Re++,bt,ri,Xt,ti,1),Te.emplace(Re++,bt,ri,Xt,ti,2),Te.emplace(Re++,bt,ri,Xt,ti,3)}(!Ts||Ts.length<2*X)&&(Ts=function(ot){const ct=2*ot,It=new a.aS;It.resize(ct),It._trim();for(let bt=0;bt<ct;bt++){const ri=6*bt;It.uint16[ri+0]=4*bt+0,It.uint16[ri+1]=4*bt+1,It.uint16[ri+2]=4*bt+2,It.uint16[ri+3]=4*bt+2,It.uint16[ri+4]=4*bt+3,It.uint16[ri+5]=4*bt+0}return It}(X));const Be=w.createIndexBuffer(Ts,!0),Ke=w.createVertexBuffer(Te,a.aR.members,!0);for(const ot of j){const ct={u_matrix:ot.transform,u_inv_matrix:ot.invTransform,u_camera_to_center_distance:(yt=y.transform).cameraToCenterDistance,u_viewport_size:[yt.width,yt.height]};Se.draw(w,T.TRIANGLES,Gn.disabled,es.disabled,y.colorModeForRenderPass(),Zr.disabled,ct,y.style.map.terrain&&y.style.map.terrain.getTerrainData(ot.coord),i.id,Ke,Be,a.$.simpleSegment(0,2*ot.circleOffset,ot.circleArray.length,ot.circleArray.length/2),null,y.transform.zoom,null,null,null)}var yt;Ke.destroy(),Be.destroy()}Zr.disabled=new Zr(!1,1029,2305),Zr.backCCW=new Zr(!0,1029,2305);const rr=a.an(new Float32Array(16));function ll(y,s,i,r,l,d){const{horizontalAlign:_,verticalAlign:w}=a.at(y);return new a.P((-(_-.5)*s/l+r[0])*d,(-(w-.5)*i/l+r[1])*d)}function Xr(y,s,i,r,l,d,_,w,T,B,j){const X=y.text.placedSymbolArray,ce=y.text.dynamicLayoutVertexArray,Se=y.icon.dynamicLayoutVertexArray,Te={};ce.clear();for(let Re=0;Re<X.length;Re++){const Be=X.get(Re),Ke=Be.hidden||!Be.crossTileID||y.allowVerticalPlacement&&!Be.placedOrientation?null:r[Be.crossTileID];if(Ke){const yt=new a.P(Be.anchorX,Be.anchorY),ot=st(yt,i?_:d,j),ct=Me(l.cameraToCenterDistance,ot.signedDistanceFromCamera);let It=a.ai(y.textSizeData,T,Be)*ct/a.ao;i&&(It*=y.tilePixelRatio/w);const{width:bt,height:ri,anchor:Xt,textOffset:ti,textBoxScale:si}=Ke,Qi=ll(Xt,bt,ri,ti,si,It),Wi=i?st(yt.add(Qi),d,j).point:ot.point.add(s?Qi.rotate(-l.angle):Qi),Ei=y.allowVerticalPlacement&&Be.placedOrientation===a.ah.vertical?Math.PI/2:0;for(let Gi=0;Gi<Be.numGlyphs;Gi++)a.aj(ce,Wi,Ei);B&&Be.associatedIconIndex>=0&&(Te[Be.associatedIconIndex]={shiftedAnchor:Wi,angle:Ei})}else Ye(Be.numGlyphs,ce)}if(B){Se.clear();const Re=y.icon.placedSymbolArray;for(let Be=0;Be<Re.length;Be++){const Ke=Re.get(Be);if(Ke.hidden)Ye(Ke.numGlyphs,Se);else{const yt=Te[Be];if(yt)for(let ot=0;ot<Ke.numGlyphs;ot++)a.aj(Se,yt.shiftedAnchor,yt.angle);else Ye(Ke.numGlyphs,Se)}}y.icon.dynamicLayoutVertexBuffer.updateData(Se)}y.text.dynamicLayoutVertexBuffer.updateData(ce)}function ko(y,s,i){return i.iconsInText&&s?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function ul(y,s,i,r,l,d,_,w,T,B,j,X){const ce=y.context,Se=ce.gl,Te=y.transform,Re=w==="map",Be=T==="map",Ke=w!=="viewport"&&i.layout.get("symbol-placement")!=="point",yt=Re&&!Be&&!Ke,ot=!i.layout.get("symbol-sort-key").isConstant();let ct=!1;const It=y.depthModeForSublayer(0,Gn.ReadOnly),bt=i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ri=[];for(const Xt of r){const ti=s.getTile(Xt),si=ti.getBucket(i);if(!si)continue;const Qi=l?si.text:si.icon;if(!Qi||!Qi.segments.get().length||!Qi.hasVisibleVertices)continue;const Wi=Qi.programConfigurations.get(i.id),Ei=l||si.sdfIcons,Gi=l?si.textSizeData:si.iconSizeData,qi=Be||Te.pitch!==0,cn=y.useProgram(ko(Ei,l,si),Wi),zn=a.ag(Gi,Te.zoom),tn=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Xt);let kn,yr,er,Ia,Aa=[0,0],zs=null;if(l)yr=ti.glyphAtlasTexture,er=Se.LINEAR,kn=ti.glyphAtlasTexture.size,si.iconsInText&&(Aa=ti.imageAtlasTexture.size,zs=ti.imageAtlasTexture,Ia=qi||y.options.rotating||y.options.zooming||Gi.kind==="composite"||Gi.kind==="camera"?Se.LINEAR:Se.NEAREST);else{const Ws=i.layout.get("icon-size").constantOr(0)!==1||si.iconsNeedLinear;yr=ti.imageAtlasTexture,er=Ei||y.options.rotating||y.options.zooming||Ws||qi?Se.LINEAR:Se.NEAREST,kn=ti.imageAtlasTexture.size}const oo=kt(ti,1,y.transform.zoom),lo=Ue(Xt.posMatrix,Be,Re,y.transform,oo),qr=ft(Xt.posMatrix,Be,Re,y.transform,oo),ya=bt&&si.hasTextData(),xo=i.layout.get("icon-text-fit")!=="none"&&ya&&si.hasIconData();if(Ke){const Ws=y.style.map.terrain?(Uo,Go)=>y.style.map.terrain.getElevation(Xt,Uo,Go):null,Do=i.layout.get("text-rotation-alignment")==="map";ne(si,Xt.posMatrix,y,l,lo,qr,Be,B,Do,Ws)}const bo=y.translatePosMatrix(Xt.posMatrix,ti,d,_),Qs=Ke||l&&bt||xo?rr:lo,ts=y.translatePosMatrix(qr,ti,d,_,!0),is=Ei&&i.paint.get(l?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Rr;Rr=Ei?si.iconsInText?ja(Gi.kind,zn,yt,Be,y,bo,Qs,ts,kn,Aa):Ha(Gi.kind,zn,yt,Be,y,bo,Qs,ts,l,kn,!0):qa(Gi.kind,zn,yt,Be,y,bo,Qs,ts,l,kn);const bs={program:cn,buffers:Qi,uniformValues:Rr,atlasTexture:yr,atlasTextureIcon:zs,atlasInterpolation:er,atlasInterpolationIcon:Ia,isSDF:Ei,hasHalo:is};if(ot&&si.canOverlap){ct=!0;const Ws=Qi.segments.get();for(const Do of Ws)ri.push({segments:new a.$([Do]),sortKey:Do.sortKey,state:bs,terrainData:tn})}else ri.push({segments:Qi.segments,sortKey:0,state:bs,terrainData:tn})}ct&&ri.sort((Xt,ti)=>Xt.sortKey-ti.sortKey);for(const Xt of ri){const ti=Xt.state;if(ce.activeTexture.set(Se.TEXTURE0),ti.atlasTexture.bind(ti.atlasInterpolation,Se.CLAMP_TO_EDGE),ti.atlasTextureIcon&&(ce.activeTexture.set(Se.TEXTURE1),ti.atlasTextureIcon&&ti.atlasTextureIcon.bind(ti.atlasInterpolationIcon,Se.CLAMP_TO_EDGE)),ti.isSDF){const si=ti.uniformValues;ti.hasHalo&&(si.u_is_halo=1,Qr(ti.buffers,Xt.segments,i,y,ti.program,It,j,X,si,Xt.terrainData)),si.u_is_halo=0}Qr(ti.buffers,Xt.segments,i,y,ti.program,It,j,X,ti.uniformValues,Xt.terrainData)}}function Qr(y,s,i,r,l,d,_,w,T,B){const j=r.context;l.draw(j,j.gl.TRIANGLES,d,_,w,Zr.disabled,T,B,i.id,y.layoutVertexBuffer,y.indexBuffer,s,i.paint,r.transform.zoom,y.programConfigurations.get(i.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function ds(y,s,i,r,l){if(!i||!r||!r.imageAtlas)return;const d=r.imageAtlas.patternPositions;let _=d[i.to.toString()],w=d[i.from.toString()];if(!_&&w&&(_=w),!w&&_&&(w=_),!_||!w){const T=l.getPaintProperty(s);_=d[T],w=d[T]}_&&w&&y.setConstantPatternPositions(_,w)}function wa(y,s,i,r,l,d,_){const w=y.context.gl,T="fill-pattern",B=i.paint.get(T),j=B&&B.constantOr(1),X=i.getCrossfadeParameters();let ce,Se,Te,Re,Be;_?(Se=j&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ce=w.LINES):(Se=j?"fillPattern":"fill",ce=w.TRIANGLES);const Ke=B.constantOr(null);for(const yt of r){const ot=s.getTile(yt);if(j&&!ot.patternsLoaded())continue;const ct=ot.getBucket(i);if(!ct)continue;const It=ct.programConfigurations.get(i.id),bt=y.useProgram(Se,It),ri=y.style.map.terrain&&y.style.map.terrain.getTerrainData(yt);j&&(y.context.activeTexture.set(w.TEXTURE0),ot.imageAtlasTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),It.updatePaintBuffers(X)),ds(It,T,Ke,ot,i);const Xt=ri?yt:null,ti=y.translatePosMatrix(Xt?Xt.posMatrix:yt.posMatrix,ot,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(_){Re=ct.indexBuffer2,Be=ct.segments2;const si=[w.drawingBufferWidth,w.drawingBufferHeight];Te=Se==="fillOutlinePattern"&&j?ol(ti,y,X,ot,si):al(ti,si)}else Re=ct.indexBuffer,Be=ct.segments,Te=j?Ua(ti,y,X,ot):hs(ti);bt.draw(y.context,ce,l,y.stencilModeForClipping(yt),d,Zr.disabled,Te,ri,i.id,ct.layoutVertexBuffer,Re,Be,i.paint,y.transform.zoom,It)}}function Tl(y,s,i,r,l,d,_){const w=y.context,T=w.gl,B="fill-extrusion-pattern",j=i.paint.get(B),X=j.constantOr(1),ce=i.getCrossfadeParameters(),Se=i.paint.get("fill-extrusion-opacity"),Te=j.constantOr(null);for(const Re of r){const Be=s.getTile(Re),Ke=Be.getBucket(i);if(!Ke)continue;const yt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Re),ot=Ke.programConfigurations.get(i.id),ct=y.useProgram(X?"fillExtrusionPattern":"fillExtrusion",ot);X&&(y.context.activeTexture.set(T.TEXTURE0),Be.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),ot.updatePaintBuffers(ce)),ds(ot,B,Te,Be,i);const It=y.translatePosMatrix(Re.posMatrix,Be,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),bt=i.paint.get("fill-extrusion-vertical-gradient"),ri=X?aa(It,y,bt,Se,Re,ce,Be):Zn(It,y,bt,Se);ct.draw(w,w.gl.TRIANGLES,l,d,_,Zr.backCCW,ri,yt,i.id,Ke.layoutVertexBuffer,Ke.indexBuffer,Ke.segments,i.paint,y.transform.zoom,ot,y.style.map.terrain&&Ke.centroidVertexBuffer)}}function Mo(y,s,i,r,l,d,_){const w=y.context,T=w.gl,B=i.fbo;if(!B)return;const j=y.useProgram("hillshade"),X=y.style.map.terrain&&y.style.map.terrain.getTerrainData(s);w.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,B.colorAttachment.get()),j.draw(w,T.TRIANGLES,l,d,_,Zr.disabled,((ce,Se,Te,Re)=>{const Be=Te.paint.get("hillshade-shadow-color"),Ke=Te.paint.get("hillshade-highlight-color"),yt=Te.paint.get("hillshade-accent-color");let ot=Te.paint.get("hillshade-illumination-direction")*(Math.PI/180);Te.paint.get("hillshade-illumination-anchor")==="viewport"&&(ot-=ce.transform.angle);const ct=!ce.options.moving;return{u_matrix:Re?Re.posMatrix:ce.transform.calculatePosMatrix(Se.tileID.toUnwrapped(),ct),u_image:0,u_latrange:St(0,Se.tileID),u_light:[Te.paint.get("hillshade-exaggeration"),ot],u_shadow:Be,u_highlight:Ke,u_accent:yt}})(y,i,r,X?s:null),X,r.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}function kl(y,s,i,r,l,d){const _=y.context,w=_.gl,T=s.dem;if(T&&T.data){const B=T.dim,j=T.stride,X=T.getPixels();if(_.activeTexture.set(w.TEXTURE1),_.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||y.getTileTexture(j),s.demTexture){const Se=s.demTexture;Se.update(X,{premultiply:!1}),Se.bind(w.NEAREST,w.CLAMP_TO_EDGE)}else s.demTexture=new Pt(_,X,w.RGBA,{premultiply:!1}),s.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);_.activeTexture.set(w.TEXTURE0);let ce=s.fbo;if(!ce){const Se=new Pt(_,{width:B,height:B,data:null},w.RGBA);Se.bind(w.LINEAR,w.CLAMP_TO_EDGE),ce=s.fbo=_.createFramebuffer(B,B,!0,!1),ce.colorAttachment.set(Se.texture)}_.bindFramebuffer.set(ce.framebuffer),_.viewport.set([0,0,B,B]),y.useProgram("hillshadePrepare").draw(_,w.TRIANGLES,r,l,d,Zr.disabled,((Se,Te)=>{const Re=Te.stride,Be=a.F();return a.aN(Be,0,a.W,-a.W,0,0,1),a.H(Be,Be,[0,-a.W,0]),{u_matrix:Be,u_image:1,u_dimension:[Re,Re],u_zoom:Se.overscaledZ,u_unpack:Te.getUnpackVector()}})(s.tileID,T),null,i.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function go(y,s,i,r,l,d){const _=r.paint.get("raster-fade-duration");if(!d&&_>0){const w=ae.now(),T=(w-y.timeAdded)/_,B=s?(w-s.timeAdded)/_:-1,j=i.getSource(),X=l.coveringZoomLevel({tileSize:j.tileSize,roundZoom:j.roundZoom}),ce=!s||Math.abs(s.tileID.overscaledZ-X)>Math.abs(y.tileID.overscaledZ-X),Se=ce&&y.refreshedUponExpiration?1:a.ac(ce?T:1-B,0,1);return y.refreshedUponExpiration&&T>=1&&(y.refreshedUponExpiration=!1),s?{opacity:1,mix:1-Se}:{opacity:Se,mix:0}}return{opacity:1,mix:0}}const Js=new a.aO(1,0,0,1),qs=new a.aO(0,1,0,1),$a=new a.aO(0,0,1,1),Jo=new a.aO(1,0,1,1),Yr=new a.aO(0,1,1,1);function mr(y,s,i,r){ha(y,0,s+i/2,y.transform.width,i,r)}function Nr(y,s,i,r){ha(y,s-i/2,0,i,y.transform.height,r)}function ha(y,s,i,r,l,d){const _=y.context,w=_.gl;w.enable(w.SCISSOR_TEST),w.scissor(s*y.pixelRatio,i*y.pixelRatio,r*y.pixelRatio,l*y.pixelRatio),_.clear({color:d}),w.disable(w.SCISSOR_TEST)}function _o(y,s,i){const r=y.context,l=r.gl,d=i.posMatrix,_=y.useProgram("debug"),w=Gn.disabled,T=es.disabled,B=y.colorModeForRenderPass(),j="$debug",X=y.style.map.terrain&&y.style.map.terrain.getTerrainData(i);r.activeTexture.set(l.TEXTURE0);const ce=s.getTileByID(i.key).latestRawTileData,Se=Math.floor((ce&&ce.byteLength||0)/1024),Te=s.getTile(i).tileSize,Re=512/Math.min(Te,512)*(i.overscaledZ/y.transform.zoom)*.5;let Be=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(Be+=` => ${i.overscaledZ}`),function(Ke,yt){Ke.initDebugOverlayCanvas();const ot=Ke.debugOverlayCanvas,ct=Ke.context.gl,It=Ke.debugOverlayCanvas.getContext("2d");It.clearRect(0,0,ot.width,ot.height),It.shadowColor="white",It.shadowBlur=2,It.lineWidth=1.5,It.strokeStyle="white",It.textBaseline="top",It.font="bold 36px Open Sans, sans-serif",It.fillText(yt,5,5),It.strokeText(yt,5,5),Ke.debugOverlayTexture.update(ot),Ke.debugOverlayTexture.bind(ct.LINEAR,ct.CLAMP_TO_EDGE)}(y,`${Be} ${Se}kB`),_.draw(r,l.TRIANGLES,w,T,fr.alphaBlended,Zr.disabled,N(d,a.aO.transparent,Re),null,j,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments),_.draw(r,l.LINE_STRIP,w,T,B,Zr.disabled,N(d,a.aO.red),X,j,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments)}function ea(y,s,i){const r=y.context,l=r.gl,d=y.colorModeForRenderPass(),_=new Gn(l.LEQUAL,Gn.ReadWrite,y.depthRangeFor3D),w=y.useProgram("terrain"),T=s.getTerrainMesh();r.bindFramebuffer.set(null),r.viewport.set([0,0,y.width,y.height]);for(const B of i){const j=y.renderToTexture.getTexture(B),X=s.getTerrainData(B.tileID);r.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,j.texture);const ce={u_matrix:y.transform.calculatePosMatrix(B.tileID.toUnwrapped()),u_texture:0,u_ele_delta:s.getMeshFrameDelta(y.transform.zoom)};w.draw(r,l.TRIANGLES,_,es.disabled,d,Zr.backCCW,ce,X,"terrain",T.vertexBuffer,T.indexBuffer,T.segments)}}class Sa{constructor(s,i){this.context=new To(s),this.transform=i,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.F(),renderTime:0},this.setup(),this.numSublayers=Ie.maxUnderzooming+Ie.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ur}resize(s,i,r){if(this.width=Math.floor(s*r),this.height=Math.floor(i*r),this.pixelRatio=r,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const l of this.style._order)this.style._layers[l].resize()}setup(){const s=this.context,i=new a.aV;i.emplaceBack(0,0),i.emplaceBack(a.W,0),i.emplaceBack(0,a.W),i.emplaceBack(a.W,a.W),this.tileExtentBuffer=s.createVertexBuffer(i,Fr.members),this.tileExtentSegments=a.$.simpleSegment(0,0,4,2);const r=new a.aV;r.emplaceBack(0,0),r.emplaceBack(a.W,0),r.emplaceBack(0,a.W),r.emplaceBack(a.W,a.W),this.debugBuffer=s.createVertexBuffer(r,Fr.members),this.debugSegments=a.$.simpleSegment(0,0,4,5);const l=new a.Z;l.emplaceBack(0,0,0,0),l.emplaceBack(a.W,0,a.W,0),l.emplaceBack(0,a.W,0,a.W),l.emplaceBack(a.W,a.W,a.W,a.W),this.rasterBoundsBuffer=s.createVertexBuffer(l,rn.members),this.rasterBoundsSegments=a.$.simpleSegment(0,0,4,2);const d=new a.aV;d.emplaceBack(0,0),d.emplaceBack(1,0),d.emplaceBack(0,1),d.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(d,Fr.members),this.viewportSegments=a.$.simpleSegment(0,0,4,2);const _=new a.aW;_.emplaceBack(0),_.emplaceBack(1),_.emplaceBack(3),_.emplaceBack(2),_.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(_);const w=new a.aX;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(w);const T=this.context.gl;this.stencilClearMode=new es({func:T.ALWAYS,mask:0},0,255,T.ZERO,T.ZERO,T.ZERO)}clearStencil(){const s=this.context,i=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const r=a.F();a.aN(r,0,this.width,this.height,0,0,1),a.J(r,r,[i.drawingBufferWidth,i.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(s,i.TRIANGLES,Gn.disabled,this.stencilClearMode,fr.disabled,Zr.disabled,xe(r),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(s,i){if(this.currentStencilSource===s.source||!s.isTileClipped()||!i||!i.length)return;this.currentStencilSource=s.source;const r=this.context,l=r.gl;this.nextStencilID+i.length>256&&this.clearStencil(),r.setColorMode(fr.disabled),r.setDepthMode(Gn.disabled);const d=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const _ of i){const w=this._tileClippingMaskIDs[_.key]=this.nextStencilID++,T=this.style.map.terrain&&this.style.map.terrain.getTerrainData(_);d.draw(r,l.TRIANGLES,Gn.disabled,new es({func:l.ALWAYS,mask:0},w,255,l.KEEP,l.KEEP,l.REPLACE),fr.disabled,Zr.disabled,xe(_.posMatrix),T,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,i=this.context.gl;return new es({func:i.NOTEQUAL,mask:255},s,255,i.KEEP,i.KEEP,i.REPLACE)}stencilModeForClipping(s){const i=this.context.gl;return new es({func:i.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,i.KEEP,i.KEEP,i.REPLACE)}stencilConfigForOverlap(s){const i=this.context.gl,r=s.sort((_,w)=>w.overscaledZ-_.overscaledZ),l=r[r.length-1].overscaledZ,d=r[0].overscaledZ-l+1;if(d>1){this.currentStencilSource=void 0,this.nextStencilID+d>256&&this.clearStencil();const _={};for(let w=0;w<d;w++)_[w+l]=new es({func:i.GEQUAL,mask:255},w+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=d,[_,r]}return[{[l]:es.disabled},r]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new fr([s.CONSTANT_COLOR,s.ONE],new a.aO(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?fr.unblended:fr.alphaBlended}depthModeForSublayer(s,i,r){if(!this.opaquePassEnabledForLayer())return Gn.disabled;const l=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new Gn(r||this.context.gl.LEQUAL,i,[l,l])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(s,i){this.style=s,this.options=i,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(ae.now()),this.imageManager.beginFrame();const r=this.style._order,l=this.style.sourceCaches,d={},_={},w={};for(const T in l){const B=l[T];B.used&&B.prepare(this.context),d[T]=B.getVisibleCoordinates(),_[T]=d[T].slice().reverse(),w[T]=B.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let T=0;T<r.length;T++)if(this.style._layers[r[T]].is3D()){this.opaquePassCutoff=T;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const T=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!a.aY(this.terrainFacilitator.matrix,this.transform.projMatrix)||T.length)&&(a.aZ(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(B,j){const X=B.context,ce=X.gl,Se=fr.unblended,Te=new Gn(ce.LEQUAL,Gn.ReadWrite,[0,1]),Re=j.getTerrainMesh(),Be=j.sourceCache.getRenderableTiles(),Ke=B.useProgram("terrainDepth");X.bindFramebuffer.set(j.getFramebuffer("depth").framebuffer),X.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),X.clear({color:a.aO.transparent,depth:1});for(const yt of Be){const ot=j.getTerrainData(yt.tileID),ct={u_matrix:B.transform.calculatePosMatrix(yt.tileID.toUnwrapped()),u_ele_delta:j.getMeshFrameDelta(B.transform.zoom)};Ke.draw(X,ce.TRIANGLES,Te,es.disabled,Se,Zr.backCCW,ct,ot,"terrain",Re.vertexBuffer,Re.indexBuffer,Re.segments)}X.bindFramebuffer.set(null),X.viewport.set([0,0,B.width,B.height])}(this,this.style.map.terrain),function(B,j){const X=B.context,ce=X.gl,Se=fr.unblended,Te=new Gn(ce.LEQUAL,Gn.ReadWrite,[0,1]),Re=j.getTerrainMesh(),Be=j.getCoordsTexture(),Ke=j.sourceCache.getRenderableTiles(),yt=B.useProgram("terrainCoords");X.bindFramebuffer.set(j.getFramebuffer("coords").framebuffer),X.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),X.clear({color:a.aO.transparent,depth:1}),j.coordsIndex=[];for(const ot of Ke){const ct=j.getTerrainData(ot.tileID);X.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_2D,Be.texture);const It={u_matrix:B.transform.calculatePosMatrix(ot.tileID.toUnwrapped()),u_terrain_coords_id:(255-j.coordsIndex.length)/255,u_texture:0,u_ele_delta:j.getMeshFrameDelta(B.transform.zoom)};yt.draw(X,ce.TRIANGLES,Te,es.disabled,Se,Zr.backCCW,It,ct,"terrain",Re.vertexBuffer,Re.indexBuffer,Re.segments),j.coordsIndex.push(ot.tileID.key)}X.bindFramebuffer.set(null),X.viewport.set([0,0,B.width,B.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const T of r){const B=this.style._layers[T];if(!B.hasOffscreenPass()||B.isHidden(this.transform.zoom))continue;const j=_[B.source];(B.type==="custom"||j.length)&&this.renderLayer(this,l[B.source],B,j)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:i.showOverdrawInspector?a.aO.black:a.aO.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){const T=this.style._layers[r[this.currentLayer]],B=l[T.source],j=d[T.source];this._renderTileClippingMasks(T,j),this.renderLayer(this,B,T,j)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){const T=this.style._layers[r[this.currentLayer]],B=l[T.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(T))continue;const j=(T.type==="symbol"?w:_)[T.source];this._renderTileClippingMasks(T,d[T.source]),this.renderLayer(this,B,T,j)}if(this.options.showTileBoundaries){const T=function(B,j){let X=null;const ce=Object.values(B._layers).flatMap(Be=>Be.source&&!Be.isHidden(j)?[B.sourceCaches[Be.source]]:[]),Se=ce.filter(Be=>Be.getSource().type==="vector"),Te=ce.filter(Be=>Be.getSource().type!=="vector"),Re=Be=>{(!X||X.getSource().maxzoom<Be.getSource().maxzoom)&&(X=Be)};return Se.forEach(Be=>Re(Be)),X||Te.forEach(Be=>Re(Be)),X}(this.style,this.transform.zoom);T&&function(B,j,X){for(let ce=0;ce<X.length;ce++)_o(B,j,X[ce])}(this,T,T.getVisibleCoordinates())}this.options.showPadding&&function(T){const B=T.transform.padding;mr(T,T.transform.height-(B.top||0),3,Js),mr(T,B.bottom||0,3,qs),Nr(T,B.left||0,3,$a),Nr(T,T.transform.width-(B.right||0),3,Jo);const j=T.transform.centerPoint;(function(X,ce,Se,Te){ha(X,ce-1,Se-10,2,20,Te),ha(X,ce-10,Se-1,20,2,Te)})(T,j.x,T.transform.height-j.y,Yr)}(this),this.context.setDefault()}renderLayer(s,i,r,l){if(!r.isHidden(this.transform.zoom)&&(r.type==="background"||r.type==="custom"||(l||[]).length))switch(this.id=r.id,r.type){case"symbol":(function(d,_,w,T,B){if(d.renderPass!=="translucent")return;const j=es.disabled,X=d.colorModeForRenderPass();(w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ce,Se,Te,Re,Be,Ke,yt){const ot=Se.transform,ct=Be==="map",It=Ke==="map";for(const bt of ce){const ri=Re.getTile(bt),Xt=ri.getBucket(Te);if(!Xt||!Xt.text||!Xt.text.segments.get().length)continue;const ti=a.ag(Xt.textSizeData,ot.zoom),si=kt(ri,1,Se.transform.zoom),Qi=Ue(bt.posMatrix,It,ct,Se.transform,si),Wi=Te.layout.get("icon-text-fit")!=="none"&&Xt.hasIconData();if(ti){const Ei=Math.pow(2,ot.zoom-ri.tileID.overscaledZ);Xr(Xt,ct,It,yt,ot,Qi,bt.posMatrix,Ei,ti,Wi,Se.style.map.terrain?(Gi,qi)=>Se.style.map.terrain.getElevation(bt,Gi,qi):null)}}}(T,d,w,_,w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),B),w.paint.get("icon-opacity").constantOr(1)!==0&&ul(d,_,w,T,!1,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),w.layout.get("icon-rotation-alignment"),w.layout.get("icon-pitch-alignment"),w.layout.get("icon-keep-upright"),j,X),w.paint.get("text-opacity").constantOr(1)!==0&&ul(d,_,w,T,!0,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),w.layout.get("text-keep-upright"),j,X),_.map.showCollisionBoxes&&(kr(d,_,w,T,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),!0),kr(d,_,w,T,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),!1))})(s,i,r,l,this.style.placement.variableOffsets);break;case"circle":(function(d,_,w,T){if(d.renderPass!=="translucent")return;const B=w.paint.get("circle-opacity"),j=w.paint.get("circle-stroke-width"),X=w.paint.get("circle-stroke-opacity"),ce=!w.layout.get("circle-sort-key").isConstant();if(B.constantOr(1)===0&&(j.constantOr(1)===0||X.constantOr(1)===0))return;const Se=d.context,Te=Se.gl,Re=d.depthModeForSublayer(0,Gn.ReadOnly),Be=es.disabled,Ke=d.colorModeForRenderPass(),yt=[];for(let ot=0;ot<T.length;ot++){const ct=T[ot],It=_.getTile(ct),bt=It.getBucket(w);if(!bt)continue;const ri=bt.programConfigurations.get(w.id),Xt=d.useProgram("circle",ri),ti=bt.layoutVertexBuffer,si=bt.indexBuffer,Qi=d.style.map.terrain&&d.style.map.terrain.getTerrainData(ct),Wi={programConfiguration:ri,program:Xt,layoutVertexBuffer:ti,indexBuffer:si,uniformValues:no(d,ct,It,w),terrainData:Qi};if(ce){const Ei=bt.segments.get();for(const Gi of Ei)yt.push({segments:new a.$([Gi]),sortKey:Gi.sortKey,state:Wi})}else yt.push({segments:bt.segments,sortKey:0,state:Wi})}ce&&yt.sort((ot,ct)=>ot.sortKey-ct.sortKey);for(const ot of yt){const{programConfiguration:ct,program:It,layoutVertexBuffer:bt,indexBuffer:ri,uniformValues:Xt,terrainData:ti}=ot.state;It.draw(Se,Te.TRIANGLES,Re,Be,Ke,Zr.disabled,Xt,ti,w.id,bt,ri,ot.segments,w.paint,d.transform.zoom,ct)}})(s,i,r,l);break;case"heatmap":(function(d,_,w,T){if(w.paint.get("heatmap-opacity")!==0)if(d.renderPass==="offscreen"){const B=d.context,j=B.gl,X=es.disabled,ce=new fr([j.ONE,j.ONE],a.aO.transparent,[!0,!0,!0,!0]);(function(Se,Te,Re){const Be=Se.gl;Se.activeTexture.set(Be.TEXTURE1),Se.viewport.set([0,0,Te.width/4,Te.height/4]);let Ke=Re.heatmapFbo;if(Ke)Be.bindTexture(Be.TEXTURE_2D,Ke.colorAttachment.get()),Se.bindFramebuffer.set(Ke.framebuffer);else{const yt=Be.createTexture();Be.bindTexture(Be.TEXTURE_2D,yt),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_WRAP_S,Be.CLAMP_TO_EDGE),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_WRAP_T,Be.CLAMP_TO_EDGE),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_MIN_FILTER,Be.LINEAR),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_MAG_FILTER,Be.LINEAR),Ke=Re.heatmapFbo=Se.createFramebuffer(Te.width/4,Te.height/4,!1,!1),function(ot,ct,It,bt){var ri,Xt;const ti=ot.gl,si=(ri=ot.HALF_FLOAT)!==null&&ri!==void 0?ri:ti.UNSIGNED_BYTE,Qi=(Xt=ot.RGBA16F)!==null&&Xt!==void 0?Xt:ti.RGBA;ti.texImage2D(ti.TEXTURE_2D,0,Qi,ct.width/4,ct.height/4,0,ti.RGBA,si,null),bt.colorAttachment.set(It)}(Se,Te,yt,Ke)}})(B,d,w),B.clear({color:a.aO.transparent});for(let Se=0;Se<T.length;Se++){const Te=T[Se];if(_.hasRenderableParent(Te))continue;const Re=_.getTile(Te),Be=Re.getBucket(w);if(!Be)continue;const Ke=Be.programConfigurations.get(w.id),yt=d.useProgram("heatmap",Ke),{zoom:ot}=d.transform;yt.draw(B,j.TRIANGLES,Gn.disabled,X,ce,Zr.disabled,rt(Te.posMatrix,Re,ot,w.paint.get("heatmap-intensity")),null,w.id,Be.layoutVertexBuffer,Be.indexBuffer,Be.segments,w.paint,d.transform.zoom,Ke)}B.viewport.set([0,0,d.width,d.height])}else d.renderPass==="translucent"&&(d.context.setColorMode(d.colorModeForRenderPass()),function(B,j){const X=B.context,ce=X.gl,Se=j.heatmapFbo;if(!Se)return;X.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_2D,Se.colorAttachment.get()),X.activeTexture.set(ce.TEXTURE1);let Te=j.colorRampTexture;Te||(Te=j.colorRampTexture=new Pt(X,j.colorRamp,ce.RGBA)),Te.bind(ce.LINEAR,ce.CLAMP_TO_EDGE),B.useProgram("heatmapTexture").draw(X,ce.TRIANGLES,Gn.disabled,es.disabled,B.colorModeForRenderPass(),Zr.disabled,((Re,Be,Ke,yt)=>{const ot=a.F();a.aN(ot,0,Re.width,Re.height,0,0,1);const ct=Re.context.gl;return{u_matrix:ot,u_world:[ct.drawingBufferWidth,ct.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Be.paint.get("heatmap-opacity")}})(B,j),null,j.id,B.viewportBuffer,B.quadTriangleIndexBuffer,B.viewportSegments,j.paint,B.transform.zoom)}(d,w))})(s,i,r,l);break;case"line":(function(d,_,w,T){if(d.renderPass!=="translucent")return;const B=w.paint.get("line-opacity"),j=w.paint.get("line-width");if(B.constantOr(1)===0||j.constantOr(1)===0)return;const X=d.depthModeForSublayer(0,Gn.ReadOnly),ce=d.colorModeForRenderPass(),Se=w.paint.get("line-dasharray"),Te=w.paint.get("line-pattern"),Re=Te.constantOr(1),Be=w.paint.get("line-gradient"),Ke=w.getCrossfadeParameters(),yt=Re?"linePattern":Se?"lineSDF":Be?"lineGradient":"line",ot=d.context,ct=ot.gl;let It=!0;for(const bt of T){const ri=_.getTile(bt);if(Re&&!ri.patternsLoaded())continue;const Xt=ri.getBucket(w);if(!Xt)continue;const ti=Xt.programConfigurations.get(w.id),si=d.context.program.get(),Qi=d.useProgram(yt,ti),Wi=It||Qi.program!==si,Ei=d.style.map.terrain&&d.style.map.terrain.getTerrainData(bt),Gi=Te.constantOr(null);if(Gi&&ri.imageAtlas){const zn=ri.imageAtlas,tn=zn.patternPositions[Gi.to.toString()],kn=zn.patternPositions[Gi.from.toString()];tn&&kn&&ti.setConstantPatternPositions(tn,kn)}const qi=Ei?bt:null,cn=Re?Li(d,ri,w,Ke,qi):Se?An(d,ri,w,Se,Ke,qi):Be?Ii(d,ri,w,Xt.lineClipsArray.length,qi):$t(d,ri,w,qi);if(Re)ot.activeTexture.set(ct.TEXTURE0),ri.imageAtlasTexture.bind(ct.LINEAR,ct.CLAMP_TO_EDGE),ti.updatePaintBuffers(Ke);else if(Se&&(Wi||d.lineAtlas.dirty))ot.activeTexture.set(ct.TEXTURE0),d.lineAtlas.bind(ot);else if(Be){const zn=Xt.gradients[w.id];let tn=zn.texture;if(w.gradientVersion!==zn.version){let kn=256;if(w.stepInterpolant){const yr=_.getSource().maxzoom,er=bt.canonical.z===yr?Math.ceil(1<<d.transform.maxZoom-bt.canonical.z):1;kn=a.ac(a.aT(Xt.maxLineLength/a.W*1024*er),256,ot.maxTextureSize)}zn.gradient=a.aU({expression:w.gradientExpression(),evaluationKey:"lineProgress",resolution:kn,image:zn.gradient||void 0,clips:Xt.lineClipsArray}),zn.texture?zn.texture.update(zn.gradient):zn.texture=new Pt(ot,zn.gradient,ct.RGBA),zn.version=w.gradientVersion,tn=zn.texture}ot.activeTexture.set(ct.TEXTURE0),tn.bind(w.stepInterpolant?ct.NEAREST:ct.LINEAR,ct.CLAMP_TO_EDGE)}Qi.draw(ot,ct.TRIANGLES,X,d.stencilModeForClipping(bt),ce,Zr.disabled,cn,Ei,w.id,Xt.layoutVertexBuffer,Xt.indexBuffer,Xt.segments,w.paint,d.transform.zoom,ti,Xt.layoutVertexBuffer2),It=!1}})(s,i,r,l);break;case"fill":(function(d,_,w,T){const B=w.paint.get("fill-color"),j=w.paint.get("fill-opacity");if(j.constantOr(1)===0)return;const X=d.colorModeForRenderPass(),ce=w.paint.get("fill-pattern"),Se=d.opaquePassEnabledForLayer()&&!ce.constantOr(1)&&B.constantOr(a.aO.transparent).a===1&&j.constantOr(0)===1?"opaque":"translucent";if(d.renderPass===Se){const Te=d.depthModeForSublayer(1,d.renderPass==="opaque"?Gn.ReadWrite:Gn.ReadOnly);wa(d,_,w,T,Te,X,!1)}if(d.renderPass==="translucent"&&w.paint.get("fill-antialias")){const Te=d.depthModeForSublayer(w.getPaintProperty("fill-outline-color")?2:0,Gn.ReadOnly);wa(d,_,w,T,Te,X,!0)}})(s,i,r,l);break;case"fill-extrusion":(function(d,_,w,T){const B=w.paint.get("fill-extrusion-opacity");if(B!==0&&d.renderPass==="translucent"){const j=new Gn(d.context.gl.LEQUAL,Gn.ReadWrite,d.depthRangeFor3D);if(B!==1||w.paint.get("fill-extrusion-pattern").constantOr(1))Tl(d,_,w,T,j,es.disabled,fr.disabled),Tl(d,_,w,T,j,d.stencilModeFor3D(),d.colorModeForRenderPass());else{const X=d.colorModeForRenderPass();Tl(d,_,w,T,j,es.disabled,X)}}})(s,i,r,l);break;case"hillshade":(function(d,_,w,T){if(d.renderPass!=="offscreen"&&d.renderPass!=="translucent")return;const B=d.context,j=d.depthModeForSublayer(0,Gn.ReadOnly),X=d.colorModeForRenderPass(),[ce,Se]=d.renderPass==="translucent"?d.stencilConfigForOverlap(T):[{},T];for(const Te of Se){const Re=_.getTile(Te);Re.needsHillshadePrepare!==void 0&&Re.needsHillshadePrepare&&d.renderPass==="offscreen"?kl(d,Re,w,j,es.disabled,X):d.renderPass==="translucent"&&Mo(d,Te,Re,w,j,ce[Te.overscaledZ],X)}B.viewport.set([0,0,d.width,d.height])})(s,i,r,l);break;case"raster":(function(d,_,w,T){if(d.renderPass!=="translucent"||w.paint.get("raster-opacity")===0||!T.length)return;const B=d.context,j=B.gl,X=_.getSource(),ce=d.useProgram("raster"),Se=d.colorModeForRenderPass(),[Te,Re]=X instanceof tr?[{},T]:d.stencilConfigForOverlap(T),Be=Re[Re.length-1].overscaledZ,Ke=!d.options.moving;for(const yt of Re){const ot=d.depthModeForSublayer(yt.overscaledZ-Be,w.paint.get("raster-opacity")===1?Gn.ReadWrite:Gn.ReadOnly,j.LESS),ct=_.getTile(yt);ct.registerFadeDuration(w.paint.get("raster-fade-duration"));const It=_.findLoadedParent(yt,0),bt=go(ct,It,_,w,d.transform,d.style.map.terrain);let ri,Xt;const ti=w.paint.get("raster-resampling")==="nearest"?j.NEAREST:j.LINEAR;B.activeTexture.set(j.TEXTURE0),ct.texture.bind(ti,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),B.activeTexture.set(j.TEXTURE1),It?(It.texture.bind(ti,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),ri=Math.pow(2,It.tileID.overscaledZ-ct.tileID.overscaledZ),Xt=[ct.tileID.canonical.x*ri%1,ct.tileID.canonical.y*ri%1]):ct.texture.bind(ti,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST);const si=d.style.map.terrain&&d.style.map.terrain.getTerrainData(yt),Qi=si?yt:null,Wi=Qi?Qi.posMatrix:d.transform.calculatePosMatrix(yt.toUnwrapped(),Ke),Ei=Ar(Wi,Xt||[0,0],ri||1,bt,w);X instanceof tr?ce.draw(B,j.TRIANGLES,ot,es.disabled,Se,Zr.disabled,Ei,si,w.id,X.boundsBuffer,d.quadTriangleIndexBuffer,X.boundsSegments):ce.draw(B,j.TRIANGLES,ot,Te[yt.overscaledZ],Se,Zr.disabled,Ei,si,w.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments)}})(s,i,r,l);break;case"background":(function(d,_,w,T){const B=w.paint.get("background-color"),j=w.paint.get("background-opacity");if(j===0)return;const X=d.context,ce=X.gl,Se=d.transform,Te=Se.tileSize,Re=w.paint.get("background-pattern");if(d.isPatternMissing(Re))return;const Be=!Re&&B.a===1&&j===1&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass!==Be)return;const Ke=es.disabled,yt=d.depthModeForSublayer(0,Be==="opaque"?Gn.ReadWrite:Gn.ReadOnly),ot=d.colorModeForRenderPass(),ct=d.useProgram(Re?"backgroundPattern":"background"),It=T||Se.coveringTiles({tileSize:Te,terrain:d.style.map.terrain});Re&&(X.activeTexture.set(ce.TEXTURE0),d.imageManager.bind(d.context));const bt=w.getCrossfadeParameters();for(const ri of It){const Xt=T?ri.posMatrix:d.transform.calculatePosMatrix(ri.toUnwrapped()),ti=Re?Gr(Xt,j,d,Re,{tileID:ri,tileSize:Te},bt):pl(Xt,j,B),si=d.style.map.terrain&&d.style.map.terrain.getTerrainData(ri);ct.draw(X,ce.TRIANGLES,yt,Ke,ot,Zr.disabled,ti,si,w.id,d.tileExtentBuffer,d.quadTriangleIndexBuffer,d.tileExtentSegments)}})(s,0,r,l);break;case"custom":(function(d,_,w){const T=d.context,B=w.implementation;if(d.renderPass==="offscreen"){const j=B.prerender;j&&(d.setCustomLayerDefaults(),T.setColorMode(d.colorModeForRenderPass()),j.call(B,T.gl,d.transform.customLayerMatrix()),T.setDirty(),d.setBaseState())}else if(d.renderPass==="translucent"){d.setCustomLayerDefaults(),T.setColorMode(d.colorModeForRenderPass()),T.setStencilMode(es.disabled);const j=B.renderingMode==="3d"?new Gn(d.context.gl.LEQUAL,Gn.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,Gn.ReadOnly);T.setDepthMode(j),B.render(T.gl,d.transform.customLayerMatrix()),T.setDirty(),d.setBaseState(),T.bindFramebuffer.set(null)}})(s,0,r)}}translatePosMatrix(s,i,r,l,d){if(!r[0]&&!r[1])return s;const _=d?l==="map"?this.transform.angle:0:l==="viewport"?-this.transform.angle:0;if(_){const B=Math.sin(_),j=Math.cos(_);r=[r[0]*j-r[1]*B,r[0]*B+r[1]*j]}const w=[d?r[0]:kt(i,r[0],this.transform.zoom),d?r[1]:kt(i,r[1],this.transform.zoom),0],T=new Float32Array(16);return a.H(T,s,w),T}saveTileTexture(s){const i=this._tileTextures[s.size[0]];i?i.push(s):this._tileTextures[s.size[0]]=[s]}getTileTexture(s){const i=this._tileTextures[s];return i&&i.length>0?i.pop():null}isPatternMissing(s){if(!s)return!1;if(!s.from||!s.to)return!0;const i=this.imageManager.getPattern(s.from.toString()),r=this.imageManager.getPattern(s.to.toString());return!i||!r}useProgram(s,i){this.cache=this.cache||{};const r=s+(i?i.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[r]||(this.cache[r]=new Va(this.context,ua[s],i,nr[s],this._showOverdrawInspector,this.style.map.terrain)),this.cache[r]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Pt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:s,drawingBufferHeight:i}=this.context.gl;return this.width!==s||this.height!==i}}class ka{constructor(s,i){this.points=s,this.planes=i}static fromInvProjectionMatrix(s,i,r){const l=Math.pow(2,r),d=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(w=>{const T=1/(w=a.af([],w,s))[3]/i*l;return a.a_(w,w,[T,T,1/w[3],T])}),_=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(w=>{const T=function(ce,Se){var Te=Se[0],Re=Se[1],Be=Se[2],Ke=Te*Te+Re*Re+Be*Be;return Ke>0&&(Ke=1/Math.sqrt(Ke)),ce[0]=Se[0]*Ke,ce[1]=Se[1]*Ke,ce[2]=Se[2]*Ke,ce}([],function(ce,Se,Te){var Re=Se[0],Be=Se[1],Ke=Se[2],yt=Te[0],ot=Te[1],ct=Te[2];return ce[0]=Be*ct-Ke*ot,ce[1]=Ke*yt-Re*ct,ce[2]=Re*ot-Be*yt,ce}([],vt([],d[w[0]],d[w[1]]),vt([],d[w[2]],d[w[1]]))),B=-((j=T)[0]*(X=d[w[1]])[0]+j[1]*X[1]+j[2]*X[2]);var j,X;return T.concat(B)});return new ka(d,_)}}class Xa{constructor(s,i){this.min=s,this.max=i,this.center=function(r,l,d){return r[0]=.5*l[0],r[1]=.5*l[1],r[2]=.5*l[2],r}([],function(r,l,d){return r[0]=l[0]+d[0],r[1]=l[1]+d[1],r[2]=l[2]+d[2],r}([],this.min,this.max))}quadrant(s){const i=[s%2==0,s<2],r=jt(this.min),l=jt(this.max);for(let d=0;d<i.length;d++)r[d]=i[d]?this.min[d]:this.center[d],l[d]=i[d]?this.center[d]:this.max[d];return l[2]=this.max[2],new Xa(r,l)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}intersects(s){const i=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let r=!0;for(let l=0;l<s.planes.length;l++){const d=s.planes[l];let _=0;for(let w=0;w<i.length;w++)a.a$(d,i[w])>=0&&_++;if(_===0)return 0;_!==i.length&&(r=!1)}if(r)return 2;for(let l=0;l<3;l++){let d=Number.MAX_VALUE,_=-Number.MAX_VALUE;for(let w=0;w<s.points.length;w++){const T=s.points[w][l]-this.min[l];d=Math.min(d,T),_=Math.max(_,T)}if(_<0||d>this.max[l]-this.min[l])return 0}return 1}}class cl{constructor(s=0,i=0,r=0,l=0){if(isNaN(s)||s<0||isNaN(i)||i<0||isNaN(r)||r<0||isNaN(l)||l<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=i,this.left=r,this.right=l}interpolate(s,i,r){return i.top!=null&&s.top!=null&&(this.top=a.z.number(s.top,i.top,r)),i.bottom!=null&&s.bottom!=null&&(this.bottom=a.z.number(s.bottom,i.bottom,r)),i.left!=null&&s.left!=null&&(this.left=a.z.number(s.left,i.left,r)),i.right!=null&&s.right!=null&&(this.right=a.z.number(s.right,i.right,r)),this}getCenter(s,i){const r=a.ac((this.left+s-this.right)/2,0,s),l=a.ac((this.top+i-this.bottom)/2,0,i);return new a.P(r,l)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new cl(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class lu{constructor(s,i,r,l,d){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=d===void 0||!!d,this._minZoom=s||0,this._maxZoom=i||22,this._minPitch=r??0,this._maxPitch=l??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new cl,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const s=new lu(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return s.apply(this),s}apply(s){this.tileSize=s.tileSize,this.latRange=s.latRange,this.width=s.width,this.height=s.height,this._center=s._center,this._elevation=s._elevation,this.minElevationForCurrentTile=s.minElevationForCurrentTile,this.zoom=s.zoom,this.angle=s.angle,this._fov=s._fov,this._pitch=s._pitch,this._unmodified=s._unmodified,this._edgeInsets=s._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(s){const i=-a.b0(s,-180,180)*Math.PI/180;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=function(){var r=new a.A(4);return a.A!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r}(),function(r,l,d){var _=l[0],w=l[1],T=l[2],B=l[3],j=Math.sin(d),X=Math.cos(d);r[0]=_*X+T*j,r[1]=w*X+B*j,r[2]=_*-j+T*X,r[3]=w*-j+B*X}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const i=a.ac(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=s/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(s){const i=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==i&&(this._unmodified=!1,this._zoom=i,this.tileZoom=Math.max(0,Math.floor(i)),this.scale=this.zoomScale(i),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(s){s!==this._elevation&&(this._elevation=s,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,i,r){this._unmodified=!1,this._edgeInsets.interpolate(s,i,r),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const i=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,i)}getVisibleUnwrappedCoordinates(s){const i=[new a.b1(0,s)];if(this._renderWorldCopies){const r=this.pointCoordinate(new a.P(0,0)),l=this.pointCoordinate(new a.P(this.width,0)),d=this.pointCoordinate(new a.P(this.width,this.height)),_=this.pointCoordinate(new a.P(0,this.height)),w=Math.floor(Math.min(r.x,l.x,d.x,_.x)),T=Math.floor(Math.max(r.x,l.x,d.x,_.x)),B=1;for(let j=w-B;j<=T+B;j++)j!==0&&i.push(new a.b1(j,s))}return i}coveringTiles(s){var i,r;let l=this.coveringZoomLevel(s);const d=l;if(s.minzoom!==void 0&&l<s.minzoom)return[];s.maxzoom!==void 0&&l>s.maxzoom&&(l=s.maxzoom);const _=this.pointCoordinate(this.getCameraPoint()),w=a.Y.fromLngLat(this.center),T=Math.pow(2,l),B=[T*_.x,T*_.y,0],j=[T*w.x,T*w.y,0],X=ka.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l);let ce=s.minzoom||0;!s.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(ce=l);const Se=s.terrain?2/Math.min(this.tileSize,s.tileSize)*this.tileSize:3,Te=ot=>({aabb:new Xa([ot*T,0,0],[(ot+1)*T,T,0]),zoom:0,x:0,y:0,wrap:ot,fullyVisible:!1}),Re=[],Be=[],Ke=l,yt=s.reparseOverscaled?d:l;if(this._renderWorldCopies)for(let ot=1;ot<=3;ot++)Re.push(Te(-ot)),Re.push(Te(ot));for(Re.push(Te(0));Re.length>0;){const ot=Re.pop(),ct=ot.x,It=ot.y;let bt=ot.fullyVisible;if(!bt){const Qi=ot.aabb.intersects(X);if(Qi===0)continue;bt=Qi===2}const ri=s.terrain?B:j,Xt=ot.aabb.distanceX(ri),ti=ot.aabb.distanceY(ri),si=Math.max(Math.abs(Xt),Math.abs(ti));if(ot.zoom===Ke||si>Se+(1<<Ke-ot.zoom)-2&&ot.zoom>=ce){const Qi=Ke-ot.zoom,Wi=B[0]-.5-(ct<<Qi),Ei=B[1]-.5-(It<<Qi);Be.push({tileID:new a.Q(ot.zoom===Ke?yt:ot.zoom,ot.wrap,ot.zoom,ct,It),distanceSq:mt([j[0]-.5-ct,j[1]-.5-It]),tileDistanceToCamera:Math.sqrt(Wi*Wi+Ei*Ei)})}else for(let Qi=0;Qi<4;Qi++){const Wi=(ct<<1)+Qi%2,Ei=(It<<1)+(Qi>>1),Gi=ot.zoom+1;let qi=ot.aabb.quadrant(Qi);if(s.terrain){const cn=new a.Q(Gi,ot.wrap,Gi,Wi,Ei),zn=s.terrain.getMinMaxElevation(cn),tn=(i=zn.minElevation)!==null&&i!==void 0?i:this.elevation,kn=(r=zn.maxElevation)!==null&&r!==void 0?r:this.elevation;qi=new Xa([qi.min[0],qi.min[1],tn],[qi.max[0],qi.max[1],kn])}Re.push({aabb:qi,zoom:Gi,x:Wi,y:Ei,wrap:ot.wrap,fullyVisible:bt})}}return Be.sort((ot,ct)=>ot.distanceSq-ct.distanceSq).map(ot=>ot.tileID)}resize(s,i){this.width=s,this.height=i,this.pixelsToGLUnits=[2/s,-2/i],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){const i=a.ac(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.P(a.N(s.lng)*this.worldSize,a.O(i)*this.worldSize)}unproject(s){return new a.Y(s.x/this.worldSize,s.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(s){const i=this.pointLocation(this.centerPoint,s),r=s.getElevationForLngLatZoom(i,this.tileZoom);if(!(this.elevation-r))return;const l=this.getCameraPosition(),d=a.Y.fromLngLat(l.lngLat,l.altitude),_=a.Y.fromLngLat(i,r),w=d.x-_.x,T=d.y-_.y,B=d.z-_.z,j=Math.sqrt(w*w+T*T+B*B),X=this.scaleZoom(this.cameraToCenterDistance/j/this.tileSize);this._elevation=r,this._center=i,this.zoom=X}setLocationAtPoint(s,i){const r=this.pointCoordinate(i),l=this.pointCoordinate(this.centerPoint),d=this.locationCoordinate(s),_=new a.Y(d.x-(r.x-l.x),d.y-(r.y-l.y));this.center=this.coordinateLocation(_),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(s,i){return i?this.coordinatePoint(this.locationCoordinate(s),i.getElevationForLngLatZoom(s,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(s))}pointLocation(s,i){return this.coordinateLocation(this.pointCoordinate(s,i))}locationCoordinate(s){return a.Y.fromLngLat(s)}coordinateLocation(s){return s&&s.toLngLat()}pointCoordinate(s,i){if(i){const ce=i.pointCoordinate(s);if(ce!=null)return ce}const r=[s.x,s.y,0,1],l=[s.x,s.y,1,1];a.af(r,r,this.pixelMatrixInverse),a.af(l,l,this.pixelMatrixInverse);const d=r[3],_=l[3],w=r[1]/d,T=l[1]/_,B=r[2]/d,j=l[2]/_,X=B===j?0:(0-B)/(j-B);return new a.Y(a.z.number(r[0]/d,l[0]/_,X)/this.worldSize,a.z.number(w,T,X)/this.worldSize)}coordinatePoint(s,i=0,r=this.pixelMatrix){const l=[s.x*this.worldSize,s.y*this.worldSize,i,1];return a.af(l,l,r),new a.P(l[0]/l[3],l[1]/l[3])}getBounds(){const s=Math.max(0,this.height/2-this.getHorizon());return new Ai().extend(this.pointLocation(new a.P(0,s))).extend(this.pointLocation(new a.P(this.width,s))).extend(this.pointLocation(new a.P(this.width,this.height))).extend(this.pointLocation(new a.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Ai([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(s,i=!1){const r=s.key,l=i?this._alignedPosMatrixCache:this._posMatrixCache;if(l[r])return l[r];const d=s.canonical,_=this.worldSize/this.zoomScale(d.z),w=d.x+Math.pow(2,d.z)*s.wrap,T=a.an(new Float64Array(16));return a.H(T,T,[w*_,d.y*_,0]),a.J(T,T,[_/a.W,_/a.W,1]),a.K(T,i?this.alignedProjMatrix:this.projMatrix,T),l[r]=new Float32Array(T),l[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;let s=this.lngRange;if(!this._renderWorldCopies&&s===null){const Te=179.9999999999;s=[-Te,Te]}this._constraining=!0;let i,r,l,d,_=-90,w=90,T=-180,B=180;const j=this.size,X=this._unmodified;if(this.latRange){const Te=this.latRange;_=a.O(Te[1])*this.worldSize,w=a.O(Te[0])*this.worldSize,i=w-_<j.y?j.y/(w-_):0}s&&(T=a.b0(a.N(s[0])*this.worldSize,0,this.worldSize),B=a.b0(a.N(s[1])*this.worldSize,0,this.worldSize),B<T&&(B+=this.worldSize),r=B-T<j.x?j.x/(B-T):0);const ce=this.point,Se=Math.max(r||0,i||0);if(Se)return this.center=this.unproject(new a.P(r?(B+T)/2:ce.x,i?(w+_)/2:ce.y)),this.zoom+=this.scaleZoom(Se),this._unmodified=X,void(this._constraining=!1);if(this.latRange){const Te=ce.y,Re=j.y/2;Te-Re<_&&(d=_+Re),Te+Re>w&&(d=w-Re)}if(s){const Te=(T+B)/2;let Re=ce.x;this._renderWorldCopies&&(Re=a.b0(ce.x,Te-this.worldSize/2,Te+this.worldSize/2));const Be=j.x/2;Re-Be<T&&(l=T+Be),Re+Be>B&&(l=B-Be)}l===void 0&&d===void 0||(this.center=this.unproject(new a.P(l!==void 0?l:ce.x,d!==void 0?d:ce.y)).wrap()),this._unmodified=X,this._constraining=!1}_calcMatrices(){if(!this.height)return;const s=this.centerOffset,i=this.point.x,r=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=a.b2(1,this.center.lat)*this.worldSize;let l=a.an(new Float64Array(16));a.J(l,l,[this.width/2,-this.height/2,1]),a.H(l,l,[1,-1,0]),this.labelPlaneMatrix=l,l=a.an(new Float64Array(16)),a.J(l,l,[1,-1,1]),a.H(l,l,[-1,-1,0]),a.J(l,l,[2/this.width,2/this.height,1]),this.glCoordMatrix=l;const d=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),_=Math.min(this.elevation,this.minElevationForCurrentTile),w=d-_*this._pixelPerMeter/Math.cos(this._pitch),T=_<0?w:d,B=Math.PI/2+this._pitch,j=this._fov*(.5+s.y/this.height),X=Math.sin(j)*T/Math.sin(a.ac(Math.PI-B-j,.01,Math.PI-.01)),ce=this.getHorizon(),Se=2*Math.atan(ce/this.cameraToCenterDistance)*(.5+s.y/(2*ce)),Te=Math.sin(Se)*T/Math.sin(a.ac(Math.PI-B-Se,.01,Math.PI-.01)),Re=Math.min(X,Te),Be=1.01*(Math.cos(Math.PI/2-this._pitch)*Re+T),Ke=this.height/50;l=new Float64Array(16),a.b3(l,this._fov,this.width/this.height,Ke,Be),l[8]=2*-s.x/this.width,l[9]=2*s.y/this.height,a.J(l,l,[1,-1,1]),a.H(l,l,[0,0,-this.cameraToCenterDistance]),a.b4(l,l,this._pitch),a.ad(l,l,this.angle),a.H(l,l,[-i,-r,0]),this.mercatorMatrix=a.J([],l,[this.worldSize,this.worldSize,this.worldSize]),a.J(l,l,[1,1,this._pixelPerMeter]),this.pixelMatrix=a.K(new Float64Array(16),this.labelPlaneMatrix,l),a.H(l,l,[0,0,-this.elevation]),this.projMatrix=l,this.invProjMatrix=a.ar([],l),this.pixelMatrix3D=a.K(new Float64Array(16),this.labelPlaneMatrix,l);const yt=this.width%2/2,ot=this.height%2/2,ct=Math.cos(this.angle),It=Math.sin(this.angle),bt=i-Math.round(i)+ct*yt+It*ot,ri=r-Math.round(r)+ct*ot+It*yt,Xt=new Float64Array(l);if(a.H(Xt,Xt,[bt>.5?bt-1:bt,ri>.5?ri-1:ri,0]),this.alignedProjMatrix=Xt,l=a.ar(new Float64Array(16),this.pixelMatrix),!l)throw new Error("failed to invert matrix");this.pixelMatrixInverse=l,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const s=this.pointCoordinate(new a.P(0,0)),i=[s.x*this.worldSize,s.y*this.worldSize,0,1];return a.af(i,i,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,s))}getCameraQueryGeometry(s){const i=this.getCameraPoint();if(s.length===1)return[s[0],i];{let r=i.x,l=i.y,d=i.x,_=i.y;for(const w of s)r=Math.min(r,w.x),l=Math.min(l,w.y),d=Math.max(d,w.x),_=Math.max(_,w.y);return[new a.P(r,l),new a.P(d,l),new a.P(d,_),new a.P(r,_),new a.P(r,l)]}}lngLatToCameraDepth(s,i){const r=this.locationCoordinate(s),l=[r.x*this.worldSize,r.y*this.worldSize,i,1];return a.af(l,l,this.projMatrix),l[2]/l[3]}}function gl(y,s){let i,r=!1,l=null,d=null;const _=()=>{l=null,r&&(y.apply(d,i),l=setTimeout(_,s),r=!1)};return(...w)=>(r=!0,d=this,i=w,l||_(),l)}class ao{constructor(s){this._getCurrentHash=()=>{const i=window.location.hash.replace("#","");if(this._hashName){let r;return i.split("&").map(l=>l.split("=")).forEach(l=>{l[0]===this._hashName&&(r=l)}),(r&&r[1]||"").split("/")}return i.split("/")},this._onHashChange=()=>{const i=this._getCurrentHash();if(i.length>=3&&!i.some(r=>isNaN(r))){const r=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(i[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+i[2],+i[1]],zoom:+i[0],bearing:r,pitch:+(i[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const i=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,i)}catch{}},this._updateHash=gl(this._updateHashUnthrottled,300),this._hashName=s&&encodeURIComponent(s)}addTo(s){return this._map=s,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(s){const i=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,l=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),d=Math.pow(10,l),_=Math.round(i.lng*d)/d,w=Math.round(i.lat*d)/d,T=this._map.getBearing(),B=this._map.getPitch();let j="";if(j+=s?`/${_}/${w}/${r}`:`${r}/${w}/${_}`,(T||B)&&(j+="/"+Math.round(10*T)/10),B&&(j+=`/${Math.round(B)}`),this._hashName){const X=this._hashName;let ce=!1;const Se=window.location.hash.slice(1).split("&").map(Te=>{const Re=Te.split("=")[0];return Re===X?(ce=!0,`${Re}=${j}`):Te}).filter(Te=>Te);return ce||Se.push(`${X}=${j}`),`#${Se.join("&")}`}return`#${j}`}}const pi={linearity:.3,easing:a.b5(0,0,.3,1)},Ui=a.e({deceleration:2500,maxSpeed:1400},pi),Di=a.e({deceleration:20,maxSpeed:1400},pi),Ft=a.e({deceleration:1e3,maxSpeed:360},pi),ii=a.e({deceleration:1e3,maxSpeed:90},pi);class bi{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:ae.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,i=ae.now();for(;s.length>0&&i-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const i={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:d}of this._inertiaBuffer)i.zoom+=d.zoomDelta||0,i.bearing+=d.bearingDelta||0,i.pitch+=d.pitchDelta||0,d.panDelta&&i.pan._add(d.panDelta),d.around&&(i.around=d.around),d.pinchAround&&(i.pinchAround=d.pinchAround);const r=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,l={};if(i.pan.mag()){const d=Bn(i.pan.mag(),r,a.e({},Ui,s||{}));l.offset=i.pan.mult(d.amount/i.pan.mag()),l.center=this._map.transform.center,Fi(l,d)}if(i.zoom){const d=Bn(i.zoom,r,Di);l.zoom=this._map.transform.zoom+d.amount,Fi(l,d)}if(i.bearing){const d=Bn(i.bearing,r,Ft);l.bearing=this._map.transform.bearing+a.ac(d.amount,-179,179),Fi(l,d)}if(i.pitch){const d=Bn(i.pitch,r,ii);l.pitch=this._map.transform.pitch+d.amount,Fi(l,d)}if(l.zoom||l.bearing){const d=i.pinchAround===void 0?i.around:i.pinchAround;l.around=d?this._map.unproject(d):this._map.getCenter()}return this.clear(),a.e(l,{noMoveStart:!0})}}function Fi(y,s){(!y.duration||y.duration<s.duration)&&(y.duration=s.duration,y.easing=s.easing)}function Bn(y,s,i){const{maxSpeed:r,linearity:l,deceleration:d}=i,_=a.ac(y*l/(s/1e3),-r,r),w=Math.abs(_)/(d*l);return{easing:i.easing,duration:1e3*w,amount:_*(w/2)}}class Hn extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,i,r,l={}){const d=ue.mousePos(i.getCanvas(),r),_=i.unproject(d);super(s,a.e({point:d,lngLat:_,originalEvent:r},l)),this._defaultPrevented=!1,this.target=i}}class lr extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,i,r){const l=s==="touchend"?r.changedTouches:r.touches,d=ue.touchPos(i.getCanvasContainer(),l),_=d.map(T=>i.unproject(T)),w=d.reduce((T,B,j,X)=>T.add(B.div(X.length)),new a.P(0,0));super(s,{points:d,point:w,lngLats:_,lngLat:i.unproject(w),originalEvent:r}),this._defaultPrevented=!1}}class Xn extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,i,r){super(s,{originalEvent:r}),this._defaultPrevented=!1}}class Hs{constructor(s,i){this._map=s,this._clickTolerance=i.clickTolerance}reset(){delete this._mousedownPos}wheel(s){return this._firePreventable(new Xn(s.type,this._map,s))}mousedown(s,i){return this._mousedownPos=i,this._firePreventable(new Hn(s.type,this._map,s))}mouseup(s){this._map.fire(new Hn(s.type,this._map,s))}click(s,i){this._mousedownPos&&this._mousedownPos.dist(i)>=this._clickTolerance||this._map.fire(new Hn(s.type,this._map,s))}dblclick(s){return this._firePreventable(new Hn(s.type,this._map,s))}mouseover(s){this._map.fire(new Hn(s.type,this._map,s))}mouseout(s){this._map.fire(new Hn(s.type,this._map,s))}touchstart(s){return this._firePreventable(new lr(s.type,this._map,s))}touchmove(s){this._map.fire(new lr(s.type,this._map,s))}touchend(s){this._map.fire(new lr(s.type,this._map,s))}touchcancel(s){this._map.fire(new lr(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ks{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(s){this._map.fire(new Hn(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Hn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._ignoreContextMenu||this._map.fire(new Hn(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ps{constructor(s){this._map=s}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(s){return this.transform.pointLocation(a.P.convert(s),this._map.terrain)}}class Ya{constructor(s,i){this._map=s,this._tr=new ps(s),this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=i.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,i){this.isEnabled()&&s.shiftKey&&s.button===0&&(ue.disableDrag(),this._startPos=this._lastPos=i,this._active=!0)}mousemoveWindow(s,i){if(!this._active)return;const r=i;if(this._lastPos.equals(r)||!this._box&&r.dist(this._startPos)<this._clickTolerance)return;const l=this._startPos;this._lastPos=r,this._box||(this._box=ue.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",s));const d=Math.min(l.x,r.x),_=Math.max(l.x,r.x),w=Math.min(l.y,r.y),T=Math.max(l.y,r.y);ue.setTransform(this._box,`translate(${d}px,${w}px)`),this._box.style.width=_-d+"px",this._box.style.height=T-w+"px"}mouseupWindow(s,i){if(!this._active||s.button!==0)return;const r=this._startPos,l=i;if(this.reset(),ue.suppressClick(),r.x!==l.x||r.y!==l.y)return this._map.fire(new a.k("boxzoomend",{originalEvent:s})),{cameraAnimation:d=>d.fitScreenCoordinates(r,l,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",s)}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(ue.remove(this._box),this._box=null),ue.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(s,i){return this._map.fire(new a.k(s,{originalEvent:i}))}}function yo(y,s){if(y.length!==s.length)throw new Error(`The number of touches and points are not equal - touches ${y.length}, points ${s.length}`);const i={};for(let r=0;r<y.length;r++)i[y[r].identifier]=s[r];return i}class rs{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(s,i,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=s.timeStamp),r.length===this.numTouches&&(this.centroid=function(l){const d=new a.P(0,0);for(const _ of l)d._add(_);return d.div(l.length)}(i),this.touches=yo(r,i)))}touchmove(s,i,r){if(this.aborted||!this.centroid)return;const l=yo(r,i);for(const d in this.touches){const _=l[d];(!_||_.dist(this.touches[d])>30)&&(this.aborted=!0)}}touchend(s,i,r){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),r.length===0){const l=!this.aborted&&this.centroid;if(this.reset(),l)return l}}}class Wu{constructor(s){this.singleTap=new rs(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(s,i,r){this.singleTap.touchstart(s,i,r)}touchmove(s,i,r){this.singleTap.touchmove(s,i,r)}touchend(s,i,r){const l=this.singleTap.touchend(s,i,r);if(l){const d=s.timeStamp-this.lastTime<500,_=!this.lastTap||this.lastTap.dist(l)<30;if(d&&_||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=l,this.count===this.numTaps)return this.reset(),l}}}class Ru{constructor(s){this._tr=new ps(s),this._zoomIn=new Wu({numTouches:1,numTaps:2}),this._zoomOut=new Wu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,i,r){this._zoomIn.touchstart(s,i,r),this._zoomOut.touchstart(s,i,r)}touchmove(s,i,r){this._zoomIn.touchmove(s,i,r),this._zoomOut.touchmove(s,i,r)}touchend(s,i,r){const l=this._zoomIn.touchend(s,i,r),d=this._zoomOut.touchend(s,i,r),_=this._tr;return l?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:_.zoom+1,around:_.unproject(l)},{originalEvent:s})}):d?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:_.zoom-1,around:_.unproject(d)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class vo{constructor(s){this._enabled=!!s.enable,this._moveStateManager=s.moveStateManager,this._clickTolerance=s.clickTolerance||1,this._moveFunction=s.move,this._activateOnStart=!!s.activateOnStart,s.assignEvents(this),this.reset()}reset(s){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(s)}_move(...s){const i=this._moveFunction(...s);if(i.bearingDelta||i.pitchDelta||i.around||i.panDelta)return this._active=!0,i}dragStart(s,i){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(s)&&(this._moveStateManager.startMove(s),this._lastPoint=i.length?i[0]:i,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(s,i){if(!this.isEnabled())return;const r=this._lastPoint;if(!r)return;if(s.preventDefault(),!this._moveStateManager.isValidMoveEvent(s))return void this.reset(s);const l=i.length?i[0]:i;return!this._moved&&l.dist(r)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=l,this._move(r,l))}dragEnd(s){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(s)&&(this._moved&&ue.suppressClick(),this.reset(s))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ml={0:1,2:2};class Dn{constructor(s){this._correctEvent=s.checkCorrectEvent}startMove(s){const i=ue.mouseButton(s);this._eventButton=i}endMove(s){delete this._eventButton}isValidStartEvent(s){return this._correctEvent(s)}isValidMoveEvent(s){return!function(i,r){const l=Ml[r];return i.buttons===void 0||(i.buttons&l)!==l}(s,this._eventButton)}isValidEndEvent(s){return ue.mouseButton(s)===this._eventButton}}class Ma{constructor(){this._firstTouch=void 0}_isOneFingerTouch(s){return s.targetTouches.length===1}_isSameTouchEvent(s){return s.targetTouches[0].identifier===this._firstTouch}startMove(s){this._firstTouch=s.targetTouches[0].identifier}endMove(s){delete this._firstTouch}isValidStartEvent(s){return this._isOneFingerTouch(s)}isValidMoveEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}isValidEndEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}}const Sn=y=>{y.mousedown=y.dragStart,y.mousemoveWindow=y.dragMove,y.mouseup=y.dragEnd,y.contextmenu=function(s){s.preventDefault()}},No=({enable:y,clickTolerance:s,bearingDegreesPerPixelMoved:i=.8})=>{const r=new Dn({checkCorrectEvent:l=>ue.mouseButton(l)===0&&l.ctrlKey||ue.mouseButton(l)===2});return new vo({clickTolerance:s,move:(l,d)=>({bearingDelta:(d.x-l.x)*i}),moveStateManager:r,enable:y,assignEvents:Sn})},Nl=({enable:y,clickTolerance:s,pitchDegreesPerPixelMoved:i=-.5})=>{const r=new Dn({checkCorrectEvent:l=>ue.mouseButton(l)===0&&l.ctrlKey||ue.mouseButton(l)===2});return new vo({clickTolerance:s,move:(l,d)=>({pitchDelta:(d.y-l.y)*i}),moveStateManager:r,enable:y,assignEvents:Sn})};class En{constructor(s,i){this._clickTolerance=s.clickTolerance||1,this._map=i,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(s,i,r){return this._calculateTransform(s,i,r)}touchmove(s,i,r){if(this._active&&!(r.length<this.minTouchs()))return s.preventDefault(),this._calculateTransform(s,i,r)}touchend(s,i,r){this._calculateTransform(s,i,r),this._active&&r.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,i,r){r.length>0&&(this._active=!0);const l=yo(r,i),d=new a.P(0,0),_=new a.P(0,0);let w=0;for(const B in l){const j=l[B],X=this._touches[B];X&&(d._add(j),_._add(j.sub(X)),w++,l[B]=j)}if(this._touches=l,w<this.minTouchs()||!_.mag())return;const T=_.div(w);return this._sum._add(T),this._sum.mag()<this._clickTolerance?void 0:{around:d.div(w),panDelta:T}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(s,i,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([i[0],i[1]]))}touchmove(s,i,r){if(!this._firstTwoTouches)return;s.preventDefault();const[l,d]=this._firstTwoTouches,_=Cn(r,i,l),w=Cn(r,i,d);if(!_||!w)return;const T=this._aroundCenter?null:_.add(w).div(2);return this._move([_,w],T,s)}touchend(s,i,r){if(!this._firstTwoTouches)return;const[l,d]=this._firstTwoTouches,_=Cn(r,i,l),w=Cn(r,i,d);_&&w||(this._active&&ue.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Cn(y,s,i){for(let r=0;r<y.length;r++)if(y[r].identifier===i)return s[r]}function _l(y,s){return Math.log(y/s)/Math.LN2}class uu extends Wl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,i){const r=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(_l(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:_l(this._distance,r),pinchAround:i}}}function Fu(y,s){return 180*y.angleWith(s)/Math.PI}class Vl extends Wl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,i,r){const l=this._vector;if(this._vector=s[0].sub(s[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Fu(this._vector,l),pinchAround:i}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const i=25/(Math.PI*this._minDiameter)*360,r=Fu(s,this._startVector);return Math.abs(r)<i}}function yl(y){return Math.abs(y.y)>Math.abs(y.x)}class ta extends Wl{constructor(s){super(),this._currentTouchCount=0,this._map=s}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(s,i,r){super.touchstart(s,i,r),this._currentTouchCount=r.length}_start(s){this._lastPoints=s,yl(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,i,r){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const l=s[0].sub(this._lastPoints[0]),d=s[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(l,d,r.timeStamp),this._valid?(this._lastPoints=s,this._active=!0,{pitchDelta:(l.y+d.y)/2*-.5}):void 0}gestureBeginsVertically(s,i,r){if(this._valid!==void 0)return this._valid;const l=s.mag()>=2,d=i.mag()>=2;if(!l&&!d)return;if(!l||!d)return this._firstMove===void 0&&(this._firstMove=r),r-this._firstMove<100&&void 0;const _=s.y>0==i.y>0;return yl(s)&&yl(i)&&_}}const oc={panStep:100,bearingStep:15,pitchStep:10};class $u{constructor(s){this._tr=new ps(s);const i=oc;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let i=0,r=0,l=0,d=0,_=0;switch(s.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:s.shiftKey?r=-1:(s.preventDefault(),d=-1);break;case 39:s.shiftKey?r=1:(s.preventDefault(),d=1);break;case 38:s.shiftKey?l=1:(s.preventDefault(),_=-1);break;case 40:s.shiftKey?l=-1:(s.preventDefault(),_=1);break;default:return}return this._rotationDisabled&&(r=0,l=0),{cameraAnimation:w=>{const T=this._tr;w.easeTo({duration:300,easeId:"keyboardHandler",easing:$l,zoom:i?Math.round(T.zoom)+i*(s.shiftKey?2:1):T.zoom,bearing:T.bearing+r*this._bearingStep,pitch:T.pitch+l*this._pitchStep,offset:[-d*this._panStep,-_*this._panStep],center:T.center},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function $l(y){return y*(2-y)}const ms=4.000244140625;class _a{constructor(s,i){this._onTimeout=r=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)},this._map=s,this._tr=new ps(s),this._triggerRenderFrame=i,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(s){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!s[this._map.cooperativeGestures._bypassKey])return;let i=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const r=ae.now(),l=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,i!==0&&i%ms==0?this._type="wheel":i!==0&&Math.abs(i)<4?this._type="trackpad":l>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(l*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),s.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=s,this._delta-=i,this._active||this._start(s)),s.preventDefault()}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const i=ue.mousePos(this._map.getCanvas(),s),r=this._tr;this._around=i.y>r.transform.height/2-r.transform.getHorizon()?a.M.convert(this._aroundCenter?r.center:r.unproject(i)):a.M.convert(r.center),this._aroundPoint=r.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._tr.transform;if(this._delta!==0){const w=this._type==="wheel"&&Math.abs(this._delta)>ms?this._wheelZoomRate:this._defaultZoomRate;let T=2/(1+Math.exp(-Math.abs(this._delta*w)));this._delta<0&&T!==0&&(T=1/T);const B=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(B*T))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const i=typeof this._targetZoom=="number"?this._targetZoom:s.zoom,r=this._startZoom,l=this._easing;let d,_=!1;if(this._type==="wheel"&&r&&l){const w=Math.min((ae.now()-this._lastWheelEventTime)/200,1),T=l(w);d=a.z.number(r,i,T),w<1?this._frameId||(this._frameId=!0):_=!0}else d=i,_=!0;return this._active=!0,_&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!_,zoomDelta:d-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let i=a.b6;if(this._prevEase){const r=this._prevEase,l=(ae.now()-r.start)/r.duration,d=r.easing(l+.01)-r.easing(l),_=.27/Math.sqrt(d*d+1e-4)*.01,w=Math.sqrt(.0729-_*_);i=a.b5(_,w,.25,1)}return this._prevEase={start:ae.now(),duration:s,easing:i},i}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class el{constructor(s,i){this._clickZoom=s,this._tapZoom=i}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class _u{constructor(s){this._tr=new ps(s),this.reset()}reset(){this._active=!1}dblclick(s,i){return s.preventDefault(),{cameraAnimation:r=>{r.easeTo({duration:300,zoom:this._tr.zoom+(s.shiftKey?-1:1),around:this._tr.unproject(i)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ou{constructor(){this._tap=new Wu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(s,i,r){if(!this._swipePoint)if(this._tapTime){const l=i[0],d=s.timeStamp-this._tapTime<500,_=this._tapPoint.dist(l)<30;d&&_?r.length>0&&(this._swipePoint=l,this._swipeTouch=r[0].identifier):this.reset()}else this._tap.touchstart(s,i,r)}touchmove(s,i,r){if(this._tapTime){if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;const l=i[0],d=l.y-this._swipePoint.y;return this._swipePoint=l,s.preventDefault(),this._active=!0,{zoomDelta:d/128}}}else this._tap.touchmove(s,i,r)}touchend(s,i,r){if(this._tapTime)this._swipePoint&&r.length===0&&this.reset();else{const l=this._tap.touchend(s,i,r);l&&(this._tapTime=s.timeStamp,this._tapPoint=l)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class cu{constructor(s,i,r){this._el=s,this._mousePan=i,this._touchPan=r}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Nu{constructor(s,i,r){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=i,this._mousePitch=r}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class _r{constructor(s,i,r,l){this._el=s,this._touchZoom=i,this._touchRotate=r,this._tapDragZoom=l,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class gs{constructor(s,i){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=s,this._options=i,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const s=this._map.getCanvasContainer();s.classList.add("maplibregl-cooperative-gestures"),this._container=ue.create("div","maplibregl-cooperative-gesture-screen",s);let i=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(i=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const r=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),l=document.createElement("div");l.className="maplibregl-desktop-message",l.textContent=i,this._container.appendChild(l);const d=document.createElement("div");d.className="maplibregl-mobile-message",d.textContent=r,this._container.appendChild(d),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(ue.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(s){this._onCooperativeGesture(s.touches.length===1)}wheel(s){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!s[this._bypassKey])}_onCooperativeGesture(s){this._enabled&&s&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const gn=y=>y.zoom||y.drag||y.pitch||y.rotate;class jn extends a.k{}function Jn(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class tl{constructor(s,i){this.handleWindowEvent=l=>{this.handleEvent(l,`${l.type}Window`)},this.handleEvent=(l,d)=>{if(l.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const _=l.type==="renderFrame"?void 0:l,w={needsRenderFrame:!1},T={},B={},j=l.touches,X=j?this._getMapTouches(j):void 0,ce=X?ue.touchPos(this._map.getCanvas(),X):ue.mousePos(this._map.getCanvas(),l);for(const{handlerName:Re,handler:Be,allowed:Ke}of this._handlers){if(!Be.isEnabled())continue;let yt;this._blockedByActive(B,Ke,Re)?Be.reset():Be[d||l.type]&&(yt=Be[d||l.type](l,ce,X),this.mergeHandlerResult(w,T,yt,Re,_),yt&&yt.needsRenderFrame&&this._triggerRenderFrame()),(yt||Be.isActive())&&(B[Re]=Be)}const Se={};for(const Re in this._previousActiveHandlers)B[Re]||(Se[Re]=_);this._previousActiveHandlers=B,(Object.keys(Se).length||Jn(w))&&(this._changes.push([w,T,Se]),this._triggerRenderFrame()),(Object.keys(B).length||Jn(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Te}=w;Te&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Te(this._map))},this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new bi(s),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(i);const r=this._el;this._listeners=[[r,"touchstart",{passive:!0}],[r,"touchmove",{passive:!1}],[r,"touchend",void 0],[r,"touchcancel",void 0],[r,"mousedown",void 0],[r,"mousemove",void 0],[r,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[r,"mouseover",void 0],[r,"mouseout",void 0],[r,"dblclick",void 0],[r,"click",void 0],[r,"keydown",{capture:!1}],[r,"keyup",void 0],[r,"wheel",{passive:!1}],[r,"contextmenu",void 0],[window,"blur",void 0]];for(const[l,d,_]of this._listeners)ue.addEventListener(l,d,l===document?this.handleWindowEvent:this.handleEvent,_)}destroy(){for(const[s,i,r]of this._listeners)ue.removeEventListener(s,i,s===document?this.handleWindowEvent:this.handleEvent,r)}_addDefaultHandlers(s){const i=this._map,r=i.getCanvasContainer();this._add("mapEvent",new Hs(i,s));const l=i.boxZoom=new Ya(i,s);this._add("boxZoom",l),s.interactive&&s.boxZoom&&l.enable();const d=i.cooperativeGestures=new gs(i,s.cooperativeGestures);this._add("cooperativeGestures",d),s.cooperativeGestures&&d.enable();const _=new Ru(i),w=new _u(i);i.doubleClickZoom=new el(w,_),this._add("tapZoom",_),this._add("clickZoom",w),s.interactive&&s.doubleClickZoom&&i.doubleClickZoom.enable();const T=new Ou;this._add("tapDragZoom",T);const B=i.touchPitch=new ta(i);this._add("touchPitch",B),s.interactive&&s.touchPitch&&i.touchPitch.enable(s.touchPitch);const j=No(s),X=Nl(s);i.dragRotate=new Nu(s,j,X),this._add("mouseRotate",j,["mousePitch"]),this._add("mousePitch",X,["mouseRotate"]),s.interactive&&s.dragRotate&&i.dragRotate.enable();const ce=(({enable:yt,clickTolerance:ot})=>{const ct=new Dn({checkCorrectEvent:It=>ue.mouseButton(It)===0&&!It.ctrlKey});return new vo({clickTolerance:ot,move:(It,bt)=>({around:bt,panDelta:bt.sub(It)}),activateOnStart:!0,moveStateManager:ct,enable:yt,assignEvents:Sn})})(s),Se=new En(s,i);i.dragPan=new cu(r,ce,Se),this._add("mousePan",ce),this._add("touchPan",Se,["touchZoom","touchRotate"]),s.interactive&&s.dragPan&&i.dragPan.enable(s.dragPan);const Te=new Vl,Re=new uu;i.touchZoomRotate=new _r(r,Re,Te,T),this._add("touchRotate",Te,["touchPan","touchZoom"]),this._add("touchZoom",Re,["touchPan","touchRotate"]),s.interactive&&s.touchZoomRotate&&i.touchZoomRotate.enable(s.touchZoomRotate);const Be=i.scrollZoom=new _a(i,()=>this._triggerRenderFrame());this._add("scrollZoom",Be,["mousePan"]),s.interactive&&s.scrollZoom&&i.scrollZoom.enable(s.scrollZoom);const Ke=i.keyboard=new $u(i);this._add("keyboard",Ke),s.interactive&&s.keyboard&&i.keyboard.enable(),this._add("blockableMapEvent",new ks(i))}_add(s,i,r){this._handlers.push({handlerName:s,handler:i,allowed:r}),this._handlersById[s]=i}stop(s){if(!this._updatingCamera){for(const{handler:i}of this._handlers)i.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!gn(this._eventsInProgress)||this.isZooming()}_blockedByActive(s,i,r){for(const l in s)if(l!==r&&(!i||i.indexOf(l)<0))return!0;return!1}_getMapTouches(s){const i=[];for(const r of s)this._el.contains(r.target)&&i.push(r);return i}mergeHandlerResult(s,i,r,l,d){if(!r)return;a.e(s,r);const _={handlerName:l,originalEvent:r.originalEvent||d};r.zoomDelta!==void 0&&(i.zoom=_),r.panDelta!==void 0&&(i.drag=_),r.pitchDelta!==void 0&&(i.pitch=_),r.bearingDelta!==void 0&&(i.rotate=_)}_applyChanges(){const s={},i={},r={};for(const[l,d,_]of this._changes)l.panDelta&&(s.panDelta=(s.panDelta||new a.P(0,0))._add(l.panDelta)),l.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+l.zoomDelta),l.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+l.bearingDelta),l.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+l.pitchDelta),l.around!==void 0&&(s.around=l.around),l.pinchAround!==void 0&&(s.pinchAround=l.pinchAround),l.noInertia&&(s.noInertia=l.noInertia),a.e(i,d),a.e(r,_);this._updateMapTransform(s,i,r),this._changes=[]}_updateMapTransform(s,i,r){const l=this._map,d=l._getTransformForUpdate(),_=l.terrain;if(!(Jn(s)||_&&this._terrainMovement))return this._fireEvents(i,r,!0);let{panDelta:w,zoomDelta:T,bearingDelta:B,pitchDelta:j,around:X,pinchAround:ce}=s;ce!==void 0&&(X=ce),l._stop(!0),X=X||l.transform.centerPoint;const Se=d.pointLocation(w?X.sub(w):X);B&&(d.bearing+=B),j&&(d.pitch+=j),T&&(d.zoom+=T),_?this._terrainMovement||!i.drag&&!i.zoom?i.drag&&this._terrainMovement?d.center=d.pointLocation(d.centerPoint.sub(w)):d.setLocationAtPoint(Se,X):(this._terrainMovement=!0,this._map._elevationFreeze=!0,d.setLocationAtPoint(Se,X),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,d.recalculateZoom(l.terrain)})):d.setLocationAtPoint(Se,X),l._applyUpdatedTransform(d),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(i,r,!0)}_fireEvents(s,i,r){const l=gn(this._eventsInProgress),d=gn(s),_={};for(const j in s){const{originalEvent:X}=s[j];this._eventsInProgress[j]||(_[`${j}start`]=X),this._eventsInProgress[j]=s[j]}!l&&d&&this._fireEvent("movestart",d.originalEvent);for(const j in _)this._fireEvent(j,_[j]);d&&this._fireEvent("move",d.originalEvent);for(const j in s){const{originalEvent:X}=s[j];this._fireEvent(j,X)}const w={};let T;for(const j in this._eventsInProgress){const{handlerName:X,originalEvent:ce}=this._eventsInProgress[j];this._handlersById[X].isActive()||(delete this._eventsInProgress[j],T=i[X]||ce,w[`${j}end`]=T)}for(const j in w)this._fireEvent(j,w[j]);const B=gn(this._eventsInProgress);if(r&&(l||d)&&!B){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),X=ce=>ce!==0&&-this._bearingSnap<ce&&ce<this._bearingSnap;!j||!j.essential&&ae.prefersReducedMotion?(this._map.fire(new a.k("moveend",{originalEvent:T})),X(this._map.getBearing())&&this._map.resetNorth()):(X(j.bearing||this._map.getBearing())&&(j.bearing=0),j.freezeElevation=!0,this._map.easeTo(j,{originalEvent:T})),this._updatingCamera=!1}}_fireEvent(s,i){this._map.fire(new a.k(s,i?{originalEvent:i}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{delete this._frameId,this.handleEvent(new jn("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Tu extends a.E{constructor(s,i){super(),this._renderFrameCallback=()=>{const r=Math.min((ae.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(r)),r<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=i.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new a.M(this.transform.center.lng,this.transform.center.lat)}setCenter(s,i){return this.jumpTo({center:s},i)}panBy(s,i,r){return s=a.P.convert(s).mult(-1),this.panTo(this.transform.center,a.e({offset:s},i),r)}panTo(s,i,r){return this.easeTo(a.e({center:s},i),r)}getZoom(){return this.transform.zoom}setZoom(s,i){return this.jumpTo({zoom:s},i),this}zoomTo(s,i,r){return this.easeTo(a.e({zoom:s},i),r)}zoomIn(s,i){return this.zoomTo(this.getZoom()+1,s,i),this}zoomOut(s,i){return this.zoomTo(this.getZoom()-1,s,i),this}getBearing(){return this.transform.bearing}setBearing(s,i){return this.jumpTo({bearing:s},i),this}getPadding(){return this.transform.padding}setPadding(s,i){return this.jumpTo({padding:s},i),this}rotateTo(s,i,r){return this.easeTo(a.e({bearing:s},i),r)}resetNorth(s,i){return this.rotateTo(0,a.e({duration:1e3},s),i),this}resetNorthPitch(s,i){return this.easeTo(a.e({bearing:0,pitch:0,duration:1e3},s),i),this}snapToNorth(s,i){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,i):this}getPitch(){return this.transform.pitch}setPitch(s,i){return this.jumpTo({pitch:s},i),this}cameraForBounds(s,i){s=Ai.convert(s);const r=i&&i.bearing||0;return this._cameraForBoxAndBearing(s.getNorthWest(),s.getSouthEast(),r,i)}_cameraForBoxAndBearing(s,i,r,l){const d={top:0,bottom:0,right:0,left:0};if(typeof(l=a.e({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},l)).padding=="number"){const Qi=l.padding;l.padding={top:Qi,bottom:Qi,right:Qi,left:Qi}}l.padding=a.e(d,l.padding);const _=this.transform,w=_.padding,T=new Ai(s,i),B=_.project(T.getNorthWest()),j=_.project(T.getNorthEast()),X=_.project(T.getSouthEast()),ce=_.project(T.getSouthWest()),Se=a.b7(-r),Te=B.rotate(Se),Re=j.rotate(Se),Be=X.rotate(Se),Ke=ce.rotate(Se),yt=new a.P(Math.max(Te.x,Re.x,Ke.x,Be.x),Math.max(Te.y,Re.y,Ke.y,Be.y)),ot=new a.P(Math.min(Te.x,Re.x,Ke.x,Be.x),Math.min(Te.y,Re.y,Ke.y,Be.y)),ct=yt.sub(ot),It=(_.width-(w.left+w.right+l.padding.left+l.padding.right))/ct.x,bt=(_.height-(w.top+w.bottom+l.padding.top+l.padding.bottom))/ct.y;if(bt<0||It<0)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ri=Math.min(_.scaleZoom(_.scale*Math.min(It,bt)),l.maxZoom),Xt=a.P.convert(l.offset),ti=new a.P((l.padding.left-l.padding.right)/2,(l.padding.top-l.padding.bottom)/2).rotate(a.b7(r)),si=Xt.add(ti).mult(_.scale/_.zoomScale(ri));return{center:_.unproject(B.add(X).div(2).sub(si)),zoom:ri,bearing:r}}fitBounds(s,i,r){return this._fitInternal(this.cameraForBounds(s,i),i,r)}fitScreenCoordinates(s,i,r,l,d){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.P.convert(s)),this.transform.pointLocation(a.P.convert(i)),r,l),l,d)}_fitInternal(s,i,r){return s?(delete(i=a.e(s,i)).padding,i.linear?this.easeTo(i,r):this.flyTo(i,r)):this}jumpTo(s,i){this.stop();const r=this._getTransformForUpdate();let l=!1,d=!1,_=!1;return"zoom"in s&&r.zoom!==+s.zoom&&(l=!0,r.zoom=+s.zoom),s.center!==void 0&&(r.center=a.M.convert(s.center)),"bearing"in s&&r.bearing!==+s.bearing&&(d=!0,r.bearing=+s.bearing),"pitch"in s&&r.pitch!==+s.pitch&&(_=!0,r.pitch=+s.pitch),s.padding==null||r.isPaddingEqual(s.padding)||(r.padding=s.padding),this._applyUpdatedTransform(r),this.fire(new a.k("movestart",i)).fire(new a.k("move",i)),l&&this.fire(new a.k("zoomstart",i)).fire(new a.k("zoom",i)).fire(new a.k("zoomend",i)),d&&this.fire(new a.k("rotatestart",i)).fire(new a.k("rotate",i)).fire(new a.k("rotateend",i)),_&&this.fire(new a.k("pitchstart",i)).fire(new a.k("pitch",i)).fire(new a.k("pitchend",i)),this.fire(new a.k("moveend",i))}calculateCameraOptionsFromTo(s,i,r,l=0){const d=a.Y.fromLngLat(s,i),_=a.Y.fromLngLat(r,l),w=_.x-d.x,T=_.y-d.y,B=_.z-d.z,j=Math.hypot(w,T,B);if(j===0)throw new Error("Can't calculate camera options with same From and To");const X=Math.hypot(w,T),ce=this.transform.scaleZoom(this.transform.cameraToCenterDistance/j/this.transform.tileSize),Se=180*Math.atan2(w,-T)/Math.PI;let Te=180*Math.acos(X/j)/Math.PI;return Te=B<0?90-Te:90+Te,{center:_.toLngLat(),zoom:ce,pitch:Te,bearing:Se}}easeTo(s,i){this._stop(!1,s.easeId),((s=a.e({offset:[0,0],duration:500,easing:a.b6},s)).animate===!1||!s.essential&&ae.prefersReducedMotion)&&(s.duration=0);const r=this._getTransformForUpdate(),l=this.getZoom(),d=this.getBearing(),_=this.getPitch(),w=this.getPadding(),T="zoom"in s?+s.zoom:l,B="bearing"in s?this._normalizeBearing(s.bearing,d):d,j="pitch"in s?+s.pitch:_,X="padding"in s?s.padding:r.padding,ce=a.P.convert(s.offset);let Se=r.centerPoint.add(ce);const Te=r.pointLocation(Se),Re=a.M.convert(s.center||Te);this._normalizeCenter(Re);const Be=r.project(Te),Ke=r.project(Re).sub(Be),yt=r.zoomScale(T-l);let ot,ct;s.around&&(ot=a.M.convert(s.around),ct=r.locationPoint(ot));const It={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||T!==l,this._rotating=this._rotating||d!==B,this._pitching=this._pitching||j!==_,this._padding=!r.isPaddingEqual(X),this._easeId=s.easeId,this._prepareEase(i,s.noMoveStart,It),this.terrain&&this._prepareElevation(Re),this._ease(bt=>{if(this._zooming&&(r.zoom=a.z.number(l,T,bt)),this._rotating&&(r.bearing=a.z.number(d,B,bt)),this._pitching&&(r.pitch=a.z.number(_,j,bt)),this._padding&&(r.interpolatePadding(w,X,bt),Se=r.centerPoint.add(ce)),this.terrain&&!s.freezeElevation&&this._updateElevation(bt),ot)r.setLocationAtPoint(ot,ct);else{const ri=r.zoomScale(r.zoom-l),Xt=T>l?Math.min(2,yt):Math.max(.5,yt),ti=Math.pow(Xt,1-bt),si=r.unproject(Be.add(Ke.mult(bt*ti)).mult(ri));r.setLocationAtPoint(r.renderWorldCopies?si.wrap():si,Se)}this._applyUpdatedTransform(r),this._fireMoveEvents(i)},bt=>{this.terrain&&this._finalizeElevation(),this._afterEase(i,bt)},s),this}_prepareEase(s,i,r={}){this._moving=!0,i||r.moving||this.fire(new a.k("movestart",s)),this._zooming&&!r.zooming&&this.fire(new a.k("zoomstart",s)),this._rotating&&!r.rotating&&this.fire(new a.k("rotatestart",s)),this._pitching&&!r.pitching&&this.fire(new a.k("pitchstart",s))}_prepareElevation(s){this._elevationCenter=s,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(s,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(s){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const i=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(s<1&&i!==this._elevationTarget){const r=this._elevationTarget-this._elevationStart;this._elevationStart+=s*(r-(i-(r*s+this._elevationStart))/(1-s)),this._elevationTarget=i}this.transform.elevation=a.z.number(this._elevationStart,this._elevationTarget,s)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(s){if(!this.transformCameraUpdate)return;const i=s.clone(),{center:r,zoom:l,pitch:d,bearing:_,elevation:w}=this.transformCameraUpdate(i);r&&(i.center=r),l!==void 0&&(i.zoom=l),d!==void 0&&(i.pitch=d),_!==void 0&&(i.bearing=_),w!==void 0&&(i.elevation=w),this.transform.apply(i)}_fireMoveEvents(s){this.fire(new a.k("move",s)),this._zooming&&this.fire(new a.k("zoom",s)),this._rotating&&this.fire(new a.k("rotate",s)),this._pitching&&this.fire(new a.k("pitch",s))}_afterEase(s,i){if(this._easeId&&i&&this._easeId===i)return;delete this._easeId;const r=this._zooming,l=this._rotating,d=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new a.k("zoomend",s)),l&&this.fire(new a.k("rotateend",s)),d&&this.fire(new a.k("pitchend",s)),this.fire(new a.k("moveend",s))}flyTo(s,i){if(!s.essential&&ae.prefersReducedMotion){const qi=a.L(s,["center","zoom","bearing","pitch","around"]);return this.jumpTo(qi,i)}this.stop(),s=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.b6},s);const r=this._getTransformForUpdate(),l=this.getZoom(),d=this.getBearing(),_=this.getPitch(),w=this.getPadding(),T="zoom"in s?a.ac(+s.zoom,r.minZoom,r.maxZoom):l,B="bearing"in s?this._normalizeBearing(s.bearing,d):d,j="pitch"in s?+s.pitch:_,X="padding"in s?s.padding:r.padding,ce=r.zoomScale(T-l),Se=a.P.convert(s.offset);let Te=r.centerPoint.add(Se);const Re=r.pointLocation(Te),Be=a.M.convert(s.center||Re);this._normalizeCenter(Be);const Ke=r.project(Re),yt=r.project(Be).sub(Ke);let ot=s.curve;const ct=Math.max(r.width,r.height),It=ct/ce,bt=yt.mag();if("minZoom"in s){const qi=a.ac(Math.min(s.minZoom,l,T),r.minZoom,r.maxZoom),cn=ct/r.zoomScale(qi-l);ot=Math.sqrt(cn/bt*2)}const ri=ot*ot;function Xt(qi){const cn=(It*It-ct*ct+(qi?-1:1)*ri*ri*bt*bt)/(2*(qi?It:ct)*ri*bt);return Math.log(Math.sqrt(cn*cn+1)-cn)}function ti(qi){return(Math.exp(qi)-Math.exp(-qi))/2}function si(qi){return(Math.exp(qi)+Math.exp(-qi))/2}const Qi=Xt(!1);let Wi=function(qi){return si(Qi)/si(Qi+ot*qi)},Ei=function(qi){return ct*((si(Qi)*(ti(cn=Qi+ot*qi)/si(cn))-ti(Qi))/ri)/bt;var cn},Gi=(Xt(!0)-Qi)/ot;if(Math.abs(bt)<1e-6||!isFinite(Gi)){if(Math.abs(ct-It)<1e-6)return this.easeTo(s,i);const qi=It<ct?-1:1;Gi=Math.abs(Math.log(It/ct))/ot,Ei=function(){return 0},Wi=function(cn){return Math.exp(qi*ot*cn)}}return s.duration="duration"in s?+s.duration:1e3*Gi/("screenSpeed"in s?+s.screenSpeed/ot:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0),this._zooming=!0,this._rotating=d!==B,this._pitching=j!==_,this._padding=!r.isPaddingEqual(X),this._prepareEase(i,!1),this.terrain&&this._prepareElevation(Be),this._ease(qi=>{const cn=qi*Gi,zn=1/Wi(cn);r.zoom=qi===1?T:l+r.scaleZoom(zn),this._rotating&&(r.bearing=a.z.number(d,B,qi)),this._pitching&&(r.pitch=a.z.number(_,j,qi)),this._padding&&(r.interpolatePadding(w,X,qi),Te=r.centerPoint.add(Se)),this.terrain&&!s.freezeElevation&&this._updateElevation(qi);const tn=qi===1?Be:r.unproject(Ke.add(yt.mult(Ei(cn))).mult(zn));r.setLocationAtPoint(r.renderWorldCopies?tn.wrap():tn,Te),this._applyUpdatedTransform(r),this._fireMoveEvents(i)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(i)},s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(s,i){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const r=this._onEaseEnd;delete this._onEaseEnd,r.call(this,i)}if(!s){const r=this.handlers;r&&r.stop(!1)}return this}_ease(s,i,r){r.animate===!1||r.duration===0?(s(1),i()):(this._easeStart=ae.now(),this._easeOptions=r,this._onEaseFrame=s,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(s,i){s=a.b0(s,-180,180);const r=Math.abs(s-i);return Math.abs(s-360-i)<r&&(s-=360),Math.abs(s+360-i)<r&&(s+=360),s}_normalizeCenter(s){const i=this.transform;if(!i.renderWorldCopies||i.lngRange)return;const r=s.lng-i.center.lng;s.lng+=r>180?-360:r<-180?360:0}queryTerrainElevation(s){return this.terrain?this.terrain.getElevationForLngLatZoom(a.M.convert(s),this.transform.tileZoom)-this.transform.elevation:null}}const oa={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class yu{constructor(s=oa){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=i=>{!i||i.sourceDataType!=="metadata"&&i.sourceDataType!=="visibility"&&i.dataType!=="style"&&i.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=s}getDefaultPosition(){return"bottom-right"}onAdd(s){return this._map=s,this._compact=this.options.compact,this._container=ue.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=ue.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ue.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){ue.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(s,i){const r=this._map._getUIString(`AttributionControl.${i}`);s.title=r,s.setAttribute("aria-label",r)}_updateAttributions(){if(!this._map.style)return;let s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(l=>typeof l!="string"?"":l)):typeof this.options.customAttribution=="string"&&s.push(this.options.customAttribution)),this._map.style.stylesheet){const l=this._map.style.stylesheet;this.styleOwner=l.owner,this.styleId=l.id}const i=this._map.style.sourceCaches;for(const l in i){const d=i[l];if(d.used||d.usedForTerrain){const _=d.getSource();_.attribution&&s.indexOf(_.attribution)<0&&s.push(_.attribution)}}s=s.filter(l=>String(l).trim()),s.sort((l,d)=>l.length-d.length),s=s.filter((l,d)=>{for(let _=d+1;_<s.length;_++)if(s[_].indexOf(l)>=0)return!1;return!0});const r=s.join(" | ");r!==this._attribHTML&&(this._attribHTML=r,s.length?(this._innerContainer.innerHTML=r,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class vs{constructor(s={}){this._updateCompact=()=>{const i=this._container.children;if(i.length){const r=i[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&r.classList.add("maplibregl-compact"):r.classList.remove("maplibregl-compact")}},this.options=s}getDefaultPosition(){return"bottom-left"}onAdd(s){this._map=s,this._compact=this.options&&this.options.compact,this._container=ue.create("div","maplibregl-ctrl");const i=ue.create("a","maplibregl-ctrl-logo");return i.target="_blank",i.rel="noopener nofollow",i.href="https://maplibre.org/",i.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),i.setAttribute("rel","noopener nofollow"),this._container.appendChild(i),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ue.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Po{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const i=++this._id;return this._queue.push({callback:s,id:i,cancelled:!1}),i}remove(s){const i=this._currentlyRunning,r=i?this._queue.concat(i):this._queue;for(const l of r)if(l.id===s)return void(l.cancelled=!0)}run(s=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const i=this._currentlyRunning=this._queue;this._queue=[];for(const r of i)if(!r.cancelled&&(r.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Mi=a.X([{name:"a_pos3d",type:"Int16",components:3}]);class Bi extends a.E{constructor(s){super(),this.sourceCache=s,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,s.usedForTerrain=!0,s.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(s,i){this.sourceCache.update(s,i),this._renderableTilesKeys=[];const r={};for(const l of s.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:i}))r[l.key]=!0,this._renderableTilesKeys.push(l.key),this._tiles[l.key]||(l.posMatrix=new Float64Array(16),a.aN(l.posMatrix,0,a.W,0,a.W,0,1),this._tiles[l.key]=new te(l,this.tileSize));for(const l in this._tiles)r[l]||delete this._tiles[l]}freeRtt(s){for(const i in this._tiles){const r=this._tiles[i];(!s||r.tileID.equals(s)||r.tileID.isChildOf(s)||s.isChildOf(r.tileID))&&(r.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(s=>this.getTileByID(s))}getTileByID(s){return this._tiles[s]}getTerrainCoords(s){const i={};for(const r of this._renderableTilesKeys){const l=this._tiles[r].tileID;if(l.canonical.equals(s.canonical)){const d=s.clone();d.posMatrix=new Float64Array(16),a.aN(d.posMatrix,0,a.W,0,a.W,0,1),i[r]=d}else if(l.canonical.isChildOf(s.canonical)){const d=s.clone();d.posMatrix=new Float64Array(16);const _=l.canonical.z-s.canonical.z,w=l.canonical.x-(l.canonical.x>>_<<_),T=l.canonical.y-(l.canonical.y>>_<<_),B=a.W>>_;a.aN(d.posMatrix,0,B,0,B,0,1),a.H(d.posMatrix,d.posMatrix,[-w*B,-T*B,0]),i[r]=d}else if(s.canonical.isChildOf(l.canonical)){const d=s.clone();d.posMatrix=new Float64Array(16);const _=s.canonical.z-l.canonical.z,w=s.canonical.x-(s.canonical.x>>_<<_),T=s.canonical.y-(s.canonical.y>>_<<_),B=a.W>>_;a.aN(d.posMatrix,0,a.W,0,a.W,0,1),a.H(d.posMatrix,d.posMatrix,[w*B,T*B,0]),a.J(d.posMatrix,d.posMatrix,[1/2**_,1/2**_,0]),i[r]=d}}return i}getSourceTile(s,i){const r=this.sourceCache._source;let l=s.overscaledZ-this.deltaZoom;if(l>r.maxzoom&&(l=r.maxzoom),l<r.minzoom)return null;this._sourceTileCache[s.key]||(this._sourceTileCache[s.key]=s.scaledTo(l).key);let d=this.sourceCache.getTileByID(this._sourceTileCache[s.key]);if((!d||!d.dem)&&i)for(;l>=r.minzoom&&(!d||!d.dem);)d=this.sourceCache.getTileByID(s.scaledTo(l--).key);return d}tilesAfterTime(s=Date.now()){return Object.values(this._tiles).filter(i=>i.timeAdded>=s)}}class xs{constructor(s,i,r){this.painter=s,this.sourceCache=new Bi(i),this.options=r,this.exaggeration=typeof r.exaggeration=="number"?r.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(s,i,r,l=a.W){var d;if(!(i>=0&&i<l&&r>=0&&r<l))return 0;const _=this.getTerrainData(s),w=(d=_.tile)===null||d===void 0?void 0:d.dem;if(!w)return 0;const T=function(Te,Re,Be){var Ke=Re[0],yt=Re[1];return Te[0]=Be[0]*Ke+Be[4]*yt+Be[12],Te[1]=Be[1]*Ke+Be[5]*yt+Be[13],Te}([],[i/l*a.W,r/l*a.W],_.u_terrain_matrix),B=[T[0]*w.dim,T[1]*w.dim],j=Math.floor(B[0]),X=Math.floor(B[1]),ce=B[0]-j,Se=B[1]-X;return w.get(j,X)*(1-ce)*(1-Se)+w.get(j+1,X)*ce*(1-Se)+w.get(j,X+1)*(1-ce)*Se+w.get(j+1,X+1)*ce*Se}getElevationForLngLatZoom(s,i){const{tileID:r,mercatorX:l,mercatorY:d}=this._getOverscaledTileIDFromLngLatZoom(s,i);return this.getElevation(r,l%a.W,d%a.W,a.W)}getElevation(s,i,r,l=a.W){return this.getDEMElevation(s,i,r,l)*this.exaggeration}getTerrainData(s){if(!this._emptyDemTexture){const l=this.painter.context,d=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Pt(l,d,l.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Pt(l,new a.R({width:1,height:1}),l.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.an([])}const i=this.sourceCache.getSourceTile(s,!0);if(i&&i.dem&&(!i.demTexture||i.needsTerrainPrepare)){const l=this.painter.context;i.demTexture=this.painter.getTileTexture(i.dem.stride),i.demTexture?i.demTexture.update(i.dem.getPixels(),{premultiply:!1}):i.demTexture=new Pt(l,i.dem.getPixels(),l.gl.RGBA,{premultiply:!1}),i.demTexture.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),i.needsTerrainPrepare=!1}const r=i&&i+i.tileID.key+s.key;if(r&&!this._demMatrixCache[r]){const l=this.sourceCache.sourceCache._source.maxzoom;let d=s.canonical.z-i.tileID.canonical.z;s.overscaledZ>s.canonical.z&&(s.canonical.z>=l?d=s.canonical.z-l:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const _=s.canonical.x-(s.canonical.x>>d<<d),w=s.canonical.y-(s.canonical.y>>d<<d),T=a.b8(new Float64Array(16),[1/(a.W<<d),1/(a.W<<d),0]);a.H(T,T,[_*a.W,w*a.W,0]),this._demMatrixCache[s.key]={matrix:T,coord:s}}return{u_depth:2,u_terrain:3,u_terrain_dim:i&&i.dem&&i.dem.dim||1,u_terrain_matrix:r?this._demMatrixCache[s.key].matrix:this._emptyDemMatrix,u_terrain_unpack:i&&i.dem&&i.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(i&&i.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:i}}getFramebuffer(s){const i=this.painter,r=i.width/devicePixelRatio,l=i.height/devicePixelRatio;return!this._fbo||this._fbo.width===r&&this._fbo.height===l||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Pt(i.context,{width:r,height:l,data:null},i.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(i.context.gl.NEAREST,i.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Pt(i.context,{width:r,height:l,data:null},i.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(i.context.gl.NEAREST,i.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=i.context.createFramebuffer(r,l,!0,!1),this._fbo.depthAttachment.set(i.context.createRenderbuffer(i.context.gl.DEPTH_COMPONENT16,r,l))),this._fbo.colorAttachment.set(s==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const s=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const i=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let d=0,_=0;d<this._coordsTextureSize;d++)for(let w=0;w<this._coordsTextureSize;w++,_+=4)i[_+0]=255&w,i[_+1]=255&d,i[_+2]=w>>8<<4|d>>8,i[_+3]=0;const r=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(i.buffer)),l=new Pt(s,r,s.gl.RGBA,{premultiply:!1});return l.bind(s.gl.NEAREST,s.gl.CLAMP_TO_EDGE),this._coordsTexture=l,l}pointCoordinate(s){const i=new Uint8Array(4),r=this.painter.context,l=r.gl;r.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),l.readPixels(s.x,this.painter.height/devicePixelRatio-s.y-1,1,1,l.RGBA,l.UNSIGNED_BYTE,i),r.bindFramebuffer.set(null);const d=i[0]+(i[2]>>4<<8),_=i[1]+((15&i[2])<<8),w=this.coordsIndex[255-i[3]],T=w&&this.sourceCache.getTileByID(w);if(!T)return null;const B=this._coordsTextureSize,j=(1<<T.tileID.canonical.z)*B;return new a.Y((T.tileID.canonical.x*B+d)/j+T.tileID.wrap,(T.tileID.canonical.y*B+_)/j,this.getElevation(T.tileID,d,_,B))}depthAtPoint(s){const i=new Uint8Array(4),r=this.painter.context,l=r.gl;return r.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),l.readPixels(s.x,this.painter.height/devicePixelRatio-s.y-1,1,1,l.RGBA,l.UNSIGNED_BYTE,i),r.bindFramebuffer.set(null),(i[0]/16777216+i[1]/65536+i[2]/256+i[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const s=this.painter.context,i=new a.b9,r=new a.aX,l=this.meshSize,d=a.W/l,_=l*l;for(let X=0;X<=l;X++)for(let ce=0;ce<=l;ce++)i.emplaceBack(ce*d,X*d,0);for(let X=0;X<_;X+=l+1)for(let ce=0;ce<l;ce++)r.emplaceBack(ce+X,l+ce+X+1,l+ce+X+2),r.emplaceBack(ce+X,l+ce+X+2,ce+X+1);const w=i.length,T=w+2*(l+1);for(const X of[0,1])for(let ce=0;ce<=l;ce++)for(const Se of[0,1])i.emplaceBack(ce*d,X*a.W,Se);for(let X=0;X<2*l;X+=2)r.emplaceBack(T+X,T+X+1,T+X+3),r.emplaceBack(T+X,T+X+3,T+X+2),r.emplaceBack(w+X,w+X+3,w+X+1),r.emplaceBack(w+X,w+X+2,w+X+3);const B=i.length,j=B+2*(l+1);for(const X of[0,1])for(let ce=0;ce<=l;ce++)for(const Se of[0,1])i.emplaceBack(X*a.W,ce*d,Se);for(let X=0;X<2*l;X+=2)r.emplaceBack(B+X,B+X+1,B+X+3),r.emplaceBack(B+X,B+X+3,B+X+2),r.emplaceBack(j+X,j+X+3,j+X+1),r.emplaceBack(j+X,j+X+2,j+X+3);return this._mesh={indexBuffer:s.createIndexBuffer(r),vertexBuffer:s.createVertexBuffer(i,Mi.members),segments:a.$.simpleSegment(0,0,i.length,r.length)},this._mesh}getMeshFrameDelta(s){return 2*Math.PI*a.ba/Math.pow(2,s)/5}getMinTileElevationForLngLatZoom(s,i){var r;const{tileID:l}=this._getOverscaledTileIDFromLngLatZoom(s,i);return(r=this.getMinMaxElevation(l).minElevation)!==null&&r!==void 0?r:0}getMinMaxElevation(s){const i=this.getTerrainData(s).tile,r={minElevation:null,maxElevation:null};return i&&i.dem&&(r.minElevation=i.dem.min*this.exaggeration,r.maxElevation=i.dem.max*this.exaggeration),r}_getOverscaledTileIDFromLngLatZoom(s,i){const r=a.Y.fromLngLat(s.wrap()),l=(1<<i)*a.W,d=r.x*l,_=r.y*l,w=Math.floor(d/a.W),T=Math.floor(_/a.W);return{tileID:new a.Q(i,0,i,w,T),mercatorX:d,mercatorY:_}}}class vu{constructor(s,i,r){this._context=s,this._size=i,this._tileSize=r,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const s of this._objects)s.texture.destroy(),s.fbo.destroy()}_createObject(s){const i=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),r=new Pt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return r.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),i.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),i.colorAttachment.set(r.texture),{id:s,fbo:i,texture:r,stamp:-1,inUse:!1}}getObjectForId(s){return this._objects[s]}useObject(s){s.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(i=>s.id!==i),this._recentlyUsed.push(s.id)}stampObject(s){s.stamp=++this._stamp}getOrCreateFreeObject(){for(const i of this._recentlyUsed)if(!this._objects[i].inUse)return this._objects[i];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const s=this._createObject(this._objects.length);return this._objects.push(s),s}freeObject(s){s.inUse=!1}freeAllObjects(){for(const s of this._objects)this.freeObject(s)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(s=>!s.inUse)===!1}}const Vo={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class fs{constructor(s,i){this.painter=s,this.terrain=i,this.pool=new vu(s.context,30,i.sourceCache.tileSize*i.qualityFactor)}destruct(){this.pool.destruct()}getTexture(s){return this.pool.getObjectForId(s.rtt[this._stacks.length-1].id).texture}prepareForRender(s,i){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=s._order.filter(r=>!s._layers[r].isHidden(i)),this._coordsDescendingInv={};for(const r in s.sourceCaches){this._coordsDescendingInv[r]={};const l=s.sourceCaches[r].getVisibleCoordinates();for(const d of l){const _=this.terrain.sourceCache.getTerrainCoords(d);for(const w in _)this._coordsDescendingInv[r][w]||(this._coordsDescendingInv[r][w]=[]),this._coordsDescendingInv[r][w].push(_[w])}}this._coordsDescendingInvStr={};for(const r of s._order){const l=s._layers[r],d=l.source;if(Vo[l.type]&&!this._coordsDescendingInvStr[d]){this._coordsDescendingInvStr[d]={};for(const _ in this._coordsDescendingInv[d])this._coordsDescendingInvStr[d][_]=this._coordsDescendingInv[d][_].map(w=>w.key).sort().join()}}for(const r of this._renderableTiles)for(const l in this._coordsDescendingInvStr){const d=this._coordsDescendingInvStr[l][r.tileID.key];d&&d!==r.rttCoords[l]&&(r.rtt=[])}}renderLayer(s){if(s.isHidden(this.painter.transform.zoom))return!1;const i=s.type,r=this.painter,l=this._renderableLayerIds[this._renderableLayerIds.length-1]===s.id;if(Vo[i]&&(this._prevType&&Vo[this._prevType]||this._stacks.push([]),this._prevType=i,this._stacks[this._stacks.length-1].push(s.id),!l))return!0;if(Vo[this._prevType]||Vo[i]&&l){this._prevType=i;const d=this._stacks.length-1,_=this._stacks[d]||[];for(const w of this._renderableTiles){if(this.pool.isFull()&&(ea(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(w),w.rtt[d]){const B=this.pool.getObjectForId(w.rtt[d].id);if(B.stamp===w.rtt[d].stamp){this.pool.useObject(B);continue}}const T=this.pool.getOrCreateFreeObject();this.pool.useObject(T),this.pool.stampObject(T),w.rtt[d]={id:T.id,stamp:T.stamp},r.context.bindFramebuffer.set(T.fbo.framebuffer),r.context.clear({color:a.aO.transparent,stencil:0}),r.currentStencilSource=void 0;for(let B=0;B<_.length;B++){const j=r.style._layers[_[B]],X=j.source?this._coordsDescendingInv[j.source][w.tileID.key]:[w.tileID];r.context.viewport.set([0,0,T.fbo.width,T.fbo.height]),r._renderTileClippingMasks(j,X),r.renderLayer(r,r.style.sourceCaches[j.source],j,X),j.source&&(w.rttCoords[j.source]=this._coordsDescendingInvStr[j.source][w.tileID.key])}}return ea(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Vo[i]}return!1}}const hl={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Ms=G,C={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:oa,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.a.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},D=y=>{y.touchstart=y.dragStart,y.touchmoveWindow=y.dragMove,y.touchend=y.dragEnd},z={showCompass:!0,showZoom:!0,visualizePitch:!1};class R{constructor(s,i,r=!1){this.mousedown=_=>{this.startMouse(a.e({},_,{ctrlKey:!0,preventDefault:()=>_.preventDefault()}),ue.mousePos(this.element,_)),ue.addEventListener(window,"mousemove",this.mousemove),ue.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=_=>{this.moveMouse(_,ue.mousePos(this.element,_))},this.mouseup=_=>{this.mouseRotate.dragEnd(_),this.mousePitch&&this.mousePitch.dragEnd(_),this.offTemp()},this.touchstart=_=>{_.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ue.touchPos(this.element,_.targetTouches)[0],this.startTouch(_,this._startPos),ue.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),ue.addEventListener(window,"touchend",this.touchend))},this.touchmove=_=>{_.targetTouches.length!==1?this.reset():(this._lastPos=ue.touchPos(this.element,_.targetTouches)[0],this.moveTouch(_,this._lastPos))},this.touchend=_=>{_.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const l=s.dragRotate._mouseRotate.getClickTolerance(),d=s.dragRotate._mousePitch.getClickTolerance();this.element=i,this.mouseRotate=No({clickTolerance:l,enable:!0}),this.touchRotate=(({enable:_,clickTolerance:w,bearingDegreesPerPixelMoved:T=.8})=>{const B=new Ma;return new vo({clickTolerance:w,move:(j,X)=>({bearingDelta:(X.x-j.x)*T}),moveStateManager:B,enable:_,assignEvents:D})})({clickTolerance:l,enable:!0}),this.map=s,r&&(this.mousePitch=Nl({clickTolerance:d,enable:!0}),this.touchPitch=(({enable:_,clickTolerance:w,pitchDegreesPerPixelMoved:T=-.5})=>{const B=new Ma;return new vo({clickTolerance:w,move:(j,X)=>({pitchDelta:(X.y-j.y)*T}),moveStateManager:B,enable:_,assignEvents:D})})({clickTolerance:d,enable:!0})),ue.addEventListener(i,"mousedown",this.mousedown),ue.addEventListener(i,"touchstart",this.touchstart,{passive:!1}),ue.addEventListener(i,"touchcancel",this.reset)}startMouse(s,i){this.mouseRotate.dragStart(s,i),this.mousePitch&&this.mousePitch.dragStart(s,i),ue.disableDrag()}startTouch(s,i){this.touchRotate.dragStart(s,i),this.touchPitch&&this.touchPitch.dragStart(s,i),ue.disableDrag()}moveMouse(s,i){const r=this.map,{bearingDelta:l}=this.mouseRotate.dragMove(s,i)||{};if(l&&r.setBearing(r.getBearing()+l),this.mousePitch){const{pitchDelta:d}=this.mousePitch.dragMove(s,i)||{};d&&r.setPitch(r.getPitch()+d)}}moveTouch(s,i){const r=this.map,{bearingDelta:l}=this.touchRotate.dragMove(s,i)||{};if(l&&r.setBearing(r.getBearing()+l),this.touchPitch){const{pitchDelta:d}=this.touchPitch.dragMove(s,i)||{};d&&r.setPitch(r.getPitch()+d)}}off(){const s=this.element;ue.removeEventListener(s,"mousedown",this.mousedown),ue.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),ue.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ue.removeEventListener(window,"touchend",this.touchend),ue.removeEventListener(s,"touchcancel",this.reset),this.offTemp()}offTemp(){ue.enableDrag(),ue.removeEventListener(window,"mousemove",this.mousemove),ue.removeEventListener(window,"mouseup",this.mouseup),ue.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ue.removeEventListener(window,"touchend",this.touchend)}}let ee;function le(y,s,i){const r=new a.M(y.lng,y.lat);if(y=new a.M(y.lng,y.lat),s){const l=new a.M(y.lng-360,y.lat),d=new a.M(y.lng+360,y.lat),_=i.locationPoint(y).distSqr(s);i.locationPoint(l).distSqr(s)<_?y=l:i.locationPoint(d).distSqr(s)<_&&(y=d)}for(;Math.abs(y.lng-i.center.lng)>180;){const l=i.locationPoint(y);if(l.x>=0&&l.y>=0&&l.x<=i.width&&l.y<=i.height)break;y.lng>i.center.lng?y.lng-=360:y.lng+=360}return y.lng!==r.lng&&i.locationPoint(y).y>i.height/2-i.getHorizon()?y:r}const oe={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function we(y,s,i){const r=y.classList;for(const l in oe)r.remove(`maplibregl-${i}-anchor-${l}`);r.add(`maplibregl-${i}-anchor-${s}`)}class $e extends a.E{constructor(s){if(super(),this._onKeyPress=i=>{const r=i.code,l=i.charCode||i.keyCode;r!=="Space"&&r!=="Enter"&&l!==32&&l!==13||this.togglePopup()},this._onMapClick=i=>{const r=i.originalEvent.target,l=this._element;this._popup&&(r===l||l.contains(r))&&this.togglePopup()},this._update=i=>{var r;if(!this._map)return;const l=this._map.loaded()&&!this._map.isMoving();((i==null?void 0:i.type)==="terrain"||(i==null?void 0:i.type)==="render"&&!l)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?le(this._lngLat,this._flatPos,this._map.transform):(r=this._lngLat)===null||r===void 0?void 0:r.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let d="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?d=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(d=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let _="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?_="rotateX(0deg)":this._pitchAlignment==="map"&&(_=`rotateX(${this._map.getPitch()}deg)`),i&&i.type!=="moveend"||(this._pos=this._pos.round()),ue.setTransform(this._element,`${oe[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${_} ${d}`),ae.frameAsync(new AbortController).then(()=>{this._updateOpacity(i&&i.type==="moveend")}).catch(()=>{})},this._onMove=i=>{if(!this._isDragging){const r=this._clickTolerance||this._map._clickTolerance;this._isDragging=i.point.dist(this._pointerdownPos)>=r}this._isDragging&&(this._pos=i.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.k("dragstart"))),this.fire(new a.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.k("dragend")),this._state="inactive"},this._addDragHandler=i=>{this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos).add(this._offset),this._pointerdownPos=i.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=s&&s.anchor||"center",this._color=s&&s.color||"#3FB1CE",this._scale=s&&s.scale||1,this._draggable=s&&s.draggable||!1,this._clickTolerance=s&&s.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=s&&s.rotation||0,this._rotationAlignment=s&&s.rotationAlignment||"auto",this._pitchAlignment=s&&s.pitchAlignment&&s.pitchAlignment!=="auto"?s.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(s==null?void 0:s.opacity,s==null?void 0:s.opacityWhenCovered),s&&s.element)this._element=s.element,this._offset=a.P.convert(s&&s.offset||[0,0]);else{this._defaultMarker=!0,this._element=ue.create("div"),this._element.setAttribute("aria-label","Map marker");const i=ue.createNS("http://www.w3.org/2000/svg","svg"),r=41,l=27;i.setAttributeNS(null,"display","block"),i.setAttributeNS(null,"height",`${r}px`),i.setAttributeNS(null,"width",`${l}px`),i.setAttributeNS(null,"viewBox",`0 0 ${l} ${r}`);const d=ue.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"stroke","none"),d.setAttributeNS(null,"stroke-width","1"),d.setAttributeNS(null,"fill","none"),d.setAttributeNS(null,"fill-rule","evenodd");const _=ue.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"fill-rule","nonzero");const w=ue.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(3.0, 29.0)"),w.setAttributeNS(null,"fill","#000000");const T=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Ke of T){const yt=ue.createNS("http://www.w3.org/2000/svg","ellipse");yt.setAttributeNS(null,"opacity","0.04"),yt.setAttributeNS(null,"cx","10.5"),yt.setAttributeNS(null,"cy","5.80029008"),yt.setAttributeNS(null,"rx",Ke.rx),yt.setAttributeNS(null,"ry",Ke.ry),w.appendChild(yt)}const B=ue.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"fill",this._color);const j=ue.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),B.appendChild(j);const X=ue.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"opacity","0.25"),X.setAttributeNS(null,"fill","#000000");const ce=ue.createNS("http://www.w3.org/2000/svg","path");ce.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),X.appendChild(ce);const Se=ue.createNS("http://www.w3.org/2000/svg","g");Se.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Se.setAttributeNS(null,"fill","#FFFFFF");const Te=ue.createNS("http://www.w3.org/2000/svg","g");Te.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Re=ue.createNS("http://www.w3.org/2000/svg","circle");Re.setAttributeNS(null,"fill","#000000"),Re.setAttributeNS(null,"opacity","0.25"),Re.setAttributeNS(null,"cx","5.5"),Re.setAttributeNS(null,"cy","5.5"),Re.setAttributeNS(null,"r","5.4999962");const Be=ue.createNS("http://www.w3.org/2000/svg","circle");Be.setAttributeNS(null,"fill","#FFFFFF"),Be.setAttributeNS(null,"cx","5.5"),Be.setAttributeNS(null,"cy","5.5"),Be.setAttributeNS(null,"r","5.4999962"),Te.appendChild(Re),Te.appendChild(Be),_.appendChild(w),_.appendChild(B),_.appendChild(X),_.appendChild(Se),_.appendChild(Te),i.appendChild(_),i.setAttributeNS(null,"height",r*this._scale+"px"),i.setAttributeNS(null,"width",l*this._scale+"px"),this._element.appendChild(i),this._offset=a.P.convert(s&&s.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",i=>{i.preventDefault()}),this._element.addEventListener("mousedown",i=>{i.preventDefault()}),we(this._element,this._anchor,"marker"),s&&s.className)for(const i of s.className.split(" "))this._element.classList.add(i);this._popup=null}addTo(s){return this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._update),s.on("moveend",this._update),s.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ue.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=a.M.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const l=Math.abs(13.5)/Math.SQRT2;s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[l,-1*(38.1-13.5+l)],"bottom-right":[-l,-1*(38.1-13.5+l)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?s.remove():(s.setLngLat(this._lngLat),s.addTo(this._map)),this):this}_updateOpacity(s=!1){var i;if(!(!((i=this._map)===null||i===void 0)&&i.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(s)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const r=this._map,l=r.terrain.depthAtPoint(this._pos),d=r.terrain.getElevationForLngLatZoom(this._lngLat,r.transform.tileZoom);if(r.transform.lngLatToCameraDepth(this._lngLat,d)-l<.006)return void(this._element.style.opacity=this._opacity);const _=-this._offset.y/r.transform._pixelPerMeter,w=Math.sin(r.getPitch()*Math.PI/180)*_,T=r.terrain.depthAtPoint(new a.P(this._pos.x,this._pos.y-this._offset.y)),B=r.transform.lngLatToCameraDepth(this._lngLat,d+w);this._element.style.opacity=B-T>.006?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(s){return this._offset=a.P.convert(s),this._update(),this}addClassName(s){this._element.classList.add(s)}removeClassName(s){this._element.classList.remove(s)}toggleClassName(s){return this._element.classList.toggle(s)}setDraggable(s){return this._draggable=!!s,this._map&&(s?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s&&s!=="auto"?s:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(s,i){return s===void 0&&i===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),s!==void 0&&(this._opacity=s),i!==void 0&&(this._opacityWhenCovered=i),this._map&&this._updateOpacity(!0),this}}const _t={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ct=0,ni=!1;const Gt={maxWidth:100,unit:"metric"};function Zt(y,s,i){const r=i&&i.maxWidth||100,l=y._container.clientHeight/2,d=y.unproject([0,l]),_=y.unproject([r,l]),w=d.distanceTo(_);if(i&&i.unit==="imperial"){const T=3.2808*w;T>5280?Z(s,r,T/5280,y._getUIString("ScaleControl.Miles")):Z(s,r,T,y._getUIString("ScaleControl.Feet"))}else i&&i.unit==="nautical"?Z(s,r,w/1852,y._getUIString("ScaleControl.NauticalMiles")):w>=1e3?Z(s,r,w/1e3,y._getUIString("ScaleControl.Kilometers")):Z(s,r,w,y._getUIString("ScaleControl.Meters"))}function Z(y,s,i,r){const l=function(d){const _=Math.pow(10,`${Math.floor(d)}`.length-1);let w=d/_;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:w>=1?1:function(T){const B=Math.pow(10,Math.ceil(-Math.log(T)/Math.LN10));return Math.round(T*B)/B}(w),_*w}(i);y.style.width=s*(l/i)+"px",y.innerHTML=`${l}&nbsp;${r}`}const A={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},E=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function F(y){if(y){if(typeof y=="number"){const s=Math.round(Math.abs(y)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,y),"top-left":new a.P(s,s),"top-right":new a.P(-s,s),bottom:new a.P(0,-y),"bottom-left":new a.P(s,-s),"bottom-right":new a.P(-s,-s),left:new a.P(y,0),right:new a.P(-y,0)}}if(y instanceof a.P||Array.isArray(y)){const s=a.P.convert(y);return{center:s,top:s,"top-left":s,"top-right":s,bottom:s,"bottom-left":s,"bottom-right":s,left:s,right:s}}return{center:a.P.convert(y.center||[0,0]),top:a.P.convert(y.top||[0,0]),"top-left":a.P.convert(y["top-left"]||[0,0]),"top-right":a.P.convert(y["top-right"]||[0,0]),bottom:a.P.convert(y.bottom||[0,0]),"bottom-left":a.P.convert(y["bottom-left"]||[0,0]),"bottom-right":a.P.convert(y["bottom-right"]||[0,0]),left:a.P.convert(y.left||[0,0]),right:a.P.convert(y.right||[0,0])}}return F(new a.P(0,0))}const O=G;S.AJAXError=a.bd,S.Evented=a.E,S.LngLat=a.M,S.MercatorCoordinate=a.Y,S.Point=a.P,S.addProtocol=a.be,S.config=a.a,S.removeProtocol=a.bf,S.AttributionControl=yu,S.BoxZoomHandler=Ya,S.CanvasSource=Qn,S.CooperativeGesturesHandler=gs,S.DoubleClickZoomHandler=el,S.DragPanHandler=cu,S.DragRotateHandler=Nu,S.EdgeInsets=cl,S.FullscreenControl=class extends a.E{constructor(y={}){super(),this._onFullscreenChange=()=>{var s;let i=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((s=i==null?void 0:i.shadowRoot)===null||s===void 0)&&s.fullscreenElement;)i=i.shadowRoot.fullscreenElement;i===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=ue.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){ue.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const y=this._fullscreenButton=ue.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);ue.create("span","maplibregl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new a.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},S.GeoJSONSource=ci,S.GeolocateControl=class extends a.E{constructor(y){super(),this._onSuccess=s=>{if(this._map){if(this._isOutOfMapMaxBounds(s))return this._setErrorState(),this.fire(new a.k("outofmaxbounds",s)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=s,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(s),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(s),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.k("geolocate",s)),this._finish()}},this._updateCamera=s=>{const i=new a.M(s.coords.longitude,s.coords.latitude),r=s.coords.accuracy,l=this._map.getBearing(),d=a.e({bearing:l},this.options.fitBoundsOptions),_=Ai.fromLngLat(i,r);this._map.fitBounds(_,d,{geolocateSource:!0})},this._updateMarker=s=>{if(s){const i=new a.M(s.coords.longitude,s.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=s.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=s=>{if(this._map){if(this.options.trackUserLocation)if(s.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(s.code===3&&ni)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.k("error",s)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=s=>{if(this._map){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=ue.create("button","maplibregl-ctrl-geolocate",this._container),ue.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",s===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ue.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new $e({element:this._dotElement}),this._circleElement=ue.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new $e({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||this._watchState!=="ACTIVE_LOCK"||i.originalEvent&&i.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.k("trackuserlocationend")))})}},this.options=a.e({},_t,y)}onAdd(y){return this._map=y,this._container=ue.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(s=!1){return a._(this,void 0,void 0,function*(){if(ee!==void 0&&!s)return ee;if(window.navigator.permissions===void 0)return ee=!!window.navigator.geolocation,ee;try{ee=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ee=!!window.navigator.geolocation}return ee})}().then(s=>this._setupUI(s)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ue.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ct=0,ni=!1}_isOutOfMapMaxBounds(y){const s=this._map.getMaxBounds(),i=y.coords;return s&&(i.longitude<s.getWest()||i.longitude>s.getEast()||i.latitude<s.getSouth()||i.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const y=this._map.getBounds(),s=y.getSouthEast(),i=y.getNorthEast(),r=s.distanceTo(i),l=Math.ceil(this._accuracy/(r/this._map._container.clientHeight)*2);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ct--,ni=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ct++,Ct>1?(y={maximumAge:6e5,timeout:0},ni=!0):(y=this.options.positionOptions,ni=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},S.Hash=ao,S.ImageSource=tr,S.KeyboardHandler=$u,S.LngLatBounds=Ai,S.LogoControl=vs,S.Map=class extends Tu{constructor(y){if(a.bb.mark(a.bc.create),(y=a.e({},C,y)).minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(y.minPitch!=null&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(y.maxPitch!=null&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new lu(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies),{bearingSnap:y.bearingSnap}),this._contextLost=s=>{s.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new a.k("webglcontextlost",{originalEvent:s}))},this._contextRestored=s=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.k("webglcontextrestored",{originalEvent:s}))},this._onMapScroll=s=>{if(s.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=y.interactive,this._maxTileCacheSize=y.maxTileCacheSize,this._maxTileCacheZoomLevels=y.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._crossSourceCollisions=y.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=y.collectResourceTiming,this._renderTaskQueue=new Po,this._controls=[],this._mapId=a.a3(),this._locale=a.e({},hl,y.locale),this._clickTolerance=y.clickTolerance,this._overridePixelRatio=y.pixelRatio,this._maxCanvasSize=y.maxCanvasSize,this.transformCameraUpdate=y.transformCameraUpdate,this._imageQueueHandle=xt.addThrottleControl(()=>this.isMoving()),this._requestManager=new Mt(y.transformRequest),typeof y.container=="string"){if(this._container=document.getElementById(y.container),!this._container)throw new Error(`Container '${y.container}' not found.`)}else{if(!(y.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(y.maxBounds&&this.setMaxBounds(y.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let s=!1;const i=gl(r=>{this._trackResize&&!this._removed&&this.resize(r)._update()},50);this._resizeObserver=new ResizeObserver(r=>{s?i(r):s=!0}),this._resizeObserver.observe(this._container)}this.handlers=new tl(this,y),this._hash=y.hash&&new ao(typeof y.hash=="string"&&y.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),y.bounds&&(this.resize(),this.fitBounds(y.bounds,a.e({},y.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=y.localIdeographFontFamily,this._validateStyle=y.validateStyle,y.style&&this.setStyle(y.style,{localIdeographFontFamily:y.localIdeographFontFamily}),y.attributionControl&&this.addControl(new yu(typeof y.attributionControl=="boolean"?void 0:y.attributionControl)),y.maplibreLogo&&this.addControl(new vs,y.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new a.k(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new a.k(`${s.dataType}dataloading`,s))}),this.on("dataabort",s=>{this.fire(new a.k("sourcedataabort",s))})}_getMapId(){return this._mapId}addControl(y,s){if(s===void 0&&(s=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new a.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=y.onAdd(this);this._controls.push(y);const r=this._controlPositions[s];return s.indexOf("bottom")!==-1?r.insertBefore(i,r.firstChild):r.appendChild(i),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new a.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(y);return s>-1&&this._controls.splice(s,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}calculateCameraOptionsFromTo(y,s,i,r){return r==null&&this.terrain&&(r=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(y,s,i,r)}resize(y){var s;const i=this._containerDimensions(),r=i[0],l=i[1],d=this._getClampedPixelRatio(r,l);if(this._resizeCanvas(r,l,d),this.painter.resize(r,l,d),this.painter.overLimit()){const w=this.painter.context.gl;this._maxCanvasSize=[w.drawingBufferWidth,w.drawingBufferHeight];const T=this._getClampedPixelRatio(r,l);this._resizeCanvas(r,l,T),this.painter.resize(r,l,T)}this.transform.resize(r,l),(s=this._requestedCameraState)===null||s===void 0||s.resize(r,l);const _=!this._moving;return _&&(this.stop(),this.fire(new a.k("movestart",y)).fire(new a.k("move",y))),this.fire(new a.k("resize",y)),_&&this.fire(new a.k("moveend",y)),this}_getClampedPixelRatio(y,s){const{0:i,1:r}=this._maxCanvasSize,l=this.getPixelRatio(),d=y*l,_=s*l;return Math.min(d>i?i/d:1,_>r?r/_:1)*l}getPixelRatio(){var y;return(y=this._overridePixelRatio)!==null&&y!==void 0?y:devicePixelRatio}setPixelRatio(y){this._overridePixelRatio=y,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(Ai.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this._update()}project(y){return this.transform.locationPoint(a.M.convert(y),this.style&&this.terrain)}unproject(y){return this.transform.pointLocation(a.P.convert(y),this.terrain)}isMoving(){var y;return this._moving||((y=this.handlers)===null||y===void 0?void 0:y.isMoving())}isZooming(){var y;return this._zooming||((y=this.handlers)===null||y===void 0?void 0:y.isZooming())}isRotating(){var y;return this._rotating||((y=this.handlers)===null||y===void 0?void 0:y.isRotating())}_createDelegatedListener(y,s,i){if(y==="mouseenter"||y==="mouseover"){let r=!1;return{layer:s,listener:i,delegates:{mousemove:d=>{const _=this.getLayer(s)?this.queryRenderedFeatures(d.point,{layers:[s]}):[];_.length?r||(r=!0,i.call(this,new Hn(y,this,d.originalEvent,{features:_}))):r=!1},mouseout:()=>{r=!1}}}}if(y==="mouseleave"||y==="mouseout"){let r=!1;return{layer:s,listener:i,delegates:{mousemove:_=>{(this.getLayer(s)?this.queryRenderedFeatures(_.point,{layers:[s]}):[]).length?r=!0:r&&(r=!1,i.call(this,new Hn(y,this,_.originalEvent)))},mouseout:_=>{r&&(r=!1,i.call(this,new Hn(y,this,_.originalEvent)))}}}}{const r=l=>{const d=this.getLayer(s)?this.queryRenderedFeatures(l.point,{layers:[s]}):[];d.length&&(l.features=d,i.call(this,l),delete l.features)};return{layer:s,listener:i,delegates:{[y]:r}}}}on(y,s,i){if(i===void 0)return super.on(y,s);const r=this._createDelegatedListener(y,s,i);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(r);for(const l in r.delegates)this.on(l,r.delegates[l]);return this}once(y,s,i){if(i===void 0)return super.once(y,s);const r=this._createDelegatedListener(y,s,i);for(const l in r.delegates)this.once(l,r.delegates[l]);return this}off(y,s,i){return i===void 0?super.off(y,s):(this._delegatedListeners&&this._delegatedListeners[y]&&(r=>{const l=this._delegatedListeners[y];for(let d=0;d<l.length;d++){const _=l[d];if(_.layer===s&&_.listener===i){for(const w in _.delegates)this.off(w,_.delegates[w]);return l.splice(d,1),this}}})(),this)}queryRenderedFeatures(y,s){if(!this.style)return[];let i;const r=y instanceof a.P||Array.isArray(y),l=r?y:[[0,0],[this.transform.width,this.transform.height]];if(s=s||(r?{}:y)||{},l instanceof a.P||typeof l[0]=="number")i=[a.P.convert(l)];else{const d=a.P.convert(l[0]),_=a.P.convert(l[1]);i=[d,new a.P(_.x,d.y),_,new a.P(d.x,_.y),d]}return this.style.queryRenderedFeatures(i,s,this.transform)}querySourceFeatures(y,s){return this.style.querySourceFeatures(y,s)}setStyle(y,s){return(s=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},s)).diff!==!1&&s.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,s),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._updateStyle(y,s))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){const s=this._locale[y];if(s==null)throw new Error(`Missing UI string '${y}'`);return s}_updateStyle(y,s){if(s.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(y,s));const i=this.style&&s.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!y)),y?(this.style=new Bt(this,s||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y,s,i):this.style.loadJSON(y,s,i),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Bt(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,s){if(typeof y=="string"){const i=this._requestManager.transformRequest(y,Tt.Style);a.h(i,new AbortController).then(r=>{this._updateDiff(r.data,s)}).catch(r=>{r&&this.fire(new a.j(r))})}else typeof y=="object"&&this._updateDiff(y,s)}_updateDiff(y,s){try{this.style.setState(y,s)&&this._update(!0)}catch(i){a.w(`Unable to perform style diff: ${i.message||i.error||i}.  Rebuilding the style from scratch.`),this._updateStyle(y,s)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(y,s){return this._lazyInitEmptyStyle(),this.style.addSource(y,s),this._update(!0)}isSourceLoaded(y){const s=this.style&&this.style.sourceCaches[y];if(s!==void 0)return s.loaded();this.fire(new a.j(new Error(`There is no source with ID '${y}'`)))}setTerrain(y){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),y){const s=this.style.sourceCaches[y.source];if(!s)throw new Error(`cannot load terrain, because there exists no source with ID: ${y.source}`);this.terrain===null&&s.reload();for(const i in this.style._layers){const r=this.style._layers[i];r.type==="hillshade"&&r.source===y.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new xs(this.painter,s,y),this.painter.renderToTexture=new fs(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=i=>{i.dataType==="style"?this.terrain.sourceCache.freeRtt():i.dataType==="source"&&i.tile&&(i.sourceId!==y.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(i.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new a.k("terrain",{terrain:y})),this}getTerrain(){var y,s;return(s=(y=this.terrain)===null||y===void 0?void 0:y.options)!==null&&s!==void 0?s:null}areTilesLoaded(){const y=this.style&&this.style.sourceCaches;for(const s in y){const i=y[s]._tiles;for(const r in i){const l=i[r];if(l.state!=="loaded"&&l.state!=="errored")return!1}}return!0}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,s,i={}){const{pixelRatio:r=1,sdf:l=!1,stretchX:d,stretchY:_,content:w}=i;if(this._lazyInitEmptyStyle(),!(s instanceof HTMLImageElement||a.b(s))){if(s.width===void 0||s.height===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:T,height:B,data:j}=s,X=s;return this.style.addImage(y,{data:new a.R({width:T,height:B},new Uint8Array(j)),pixelRatio:r,stretchX:d,stretchY:_,content:w,sdf:l,version:0,userImage:X}),X.onAdd&&X.onAdd(this,y),this}}{const{width:T,height:B,data:j}=ae.getImageData(s);this.style.addImage(y,{data:new a.R({width:T,height:B},j),pixelRatio:r,stretchX:d,stretchY:_,content:w,sdf:l,version:0})}}updateImage(y,s){const i=this.style.getImage(y);if(!i)return this.fire(new a.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const r=s instanceof HTMLImageElement||a.b(s)?ae.getImageData(s):s,{width:l,height:d,data:_}=r;if(l===void 0||d===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(l!==i.data.width||d!==i.data.height)return this.fire(new a.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const w=!(s instanceof HTMLImageElement||a.b(s));return i.data.replace(_,w),this.style.updateImage(y,i),this}getImage(y){return this.style.getImage(y)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new a.j(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y){return xt.getImage(this._requestManager.transformRequest(y,Tt.Image),new AbortController)}listImages(){return this.style.listImages()}addLayer(y,s){return this._lazyInitEmptyStyle(),this.style.addLayer(y,s),this._update(!0)}moveLayer(y,s){return this.style.moveLayer(y,s),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(y,s,i){return this.style.setLayerZoomRange(y,s,i),this._update(!0)}setFilter(y,s,i={}){return this.style.setFilter(y,s,i),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,s,i,r={}){return this.style.setPaintProperty(y,s,i,r),this._update(!0)}getPaintProperty(y,s){return this.style.getPaintProperty(y,s)}setLayoutProperty(y,s,i,r={}){return this.style.setLayoutProperty(y,s,i,r),this._update(!0)}getLayoutProperty(y,s){return this.style.getLayoutProperty(y,s)}setGlyphs(y,s={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(y,s),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(y,s,i={}){return this._lazyInitEmptyStyle(),this.style.addSprite(y,s,i,r=>{r||this._update(!0)}),this}removeSprite(y){return this._lazyInitEmptyStyle(),this.style.removeSprite(y),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(y,s={}){return this._lazyInitEmptyStyle(),this.style.setSprite(y,s,i=>{i||this._update(!0)}),this}setLight(y,s={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,s),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(y,s){return this.style.setFeatureState(y,s),this._update()}removeFeatureState(y,s){return this.style.removeFeatureState(y,s),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,s=0;return this._container&&(y=this._container.clientWidth||400,s=this._container.clientHeight||300),[y,s]}_setupContainer(){const y=this._container;y.classList.add("maplibregl-map");const s=this._canvasContainer=ue.create("div","maplibregl-canvas-container",y);this._interactive&&s.classList.add("maplibregl-interactive"),this._canvas=ue.create("canvas","maplibregl-canvas",s),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const i=this._containerDimensions(),r=this._getClampedPixelRatio(i[0],i[1]);this._resizeCanvas(i[0],i[1],r);const l=this._controlContainer=ue.create("div","maplibregl-control-container",y),d=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(_=>{d[_]=ue.create("div",`maplibregl-ctrl-${_} `,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,s,i){this._canvas.width=Math.floor(i*y),this._canvas.height=Math.floor(i*s),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${s}px`}_setupPainter(){const y={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let s=null;this._canvas.addEventListener("webglcontextcreationerror",r=>{s={requestedAttributes:y},r&&(s.statusMessage=r.statusMessage,s.type=r.type)},{once:!0});const i=this._canvas.getContext("webgl2",y)||this._canvas.getContext("webgl",y);if(!i){const r="Failed to initialize WebGL";throw s?(s.message=r,new Error(JSON.stringify(s))):new Error(r)}this.painter=new Sa(i,this.transform),be.testSupport(i)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){const s=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let i=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const l=this.transform.zoom,d=ae.now();this.style.zoomHistory.update(l,d);const _=new a.a8(l,{now:d,fadeDuration:s,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),w=_.crossFadingFactor();w===1&&w===this._crossFadingFactor||(i=!0,this._crossFadingFactor=w),this.style.update(_)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,s,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:s,showPadding:this.showPadding}),this.fire(new a.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.bb.mark(a.bc.load),this.fire(new a.k("load"))),this.style&&(this.style.hasTransitions()||i)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const r=this._sourcesDirty||this._styleDirty||this._placementDirty;return r||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.k("idle")),!this._loaded||this._fullyLoaded||r||(this._fullyLoaded=!0,a.bb.mark(a.bc.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var y;this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),xt.removeThrottleControl(this._imageQueueHandle),(y=this._resizeObserver)===null||y===void 0||y.disconnect();const s=this.painter.context.gl.getExtension("WEBGL_lose_context");s&&s.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),ue.remove(this._canvasContainer),ue.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),a.bb.clearMetrics(),this._removed=!0,this.fire(new a.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,ae.frameAsync(this._frameRequest).then(y=>{a.bb.frame(y),this._frameRequest=null,this._render(y)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get version(){return Ms}getCameraTargetElevation(){return this.transform.elevation}},S.MapMouseEvent=Hn,S.MapTouchEvent=lr,S.MapWheelEvent=Xn,S.Marker=$e,S.NavigationControl=class{constructor(y){this._updateZoomButtons=()=>{const s=this._map.getZoom(),i=s===this._map.getMaxZoom(),r=s===this._map.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=r,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",r.toString())},this._rotateCompassArrow=()=>{const s=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=s},this._setButtonTitle=(s,i)=>{const r=this._map._getUIString(`NavigationControl.${i}`);s.title=r,s.setAttribute("aria-label",r)},this.options=a.e({},z,y),this._container=ue.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",s=>this._map.zoomIn({},{originalEvent:s})),ue.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",s=>this._map.zoomOut({},{originalEvent:s})),ue.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",s=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:s}):this._map.resetNorth({},{originalEvent:s})}),this._compassIcon=ue.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new R(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ue.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,s){const i=ue.create("button",y,this._container);return i.type="button",i.addEventListener("click",s),i}},S.Popup=class extends a.E{constructor(y){super(),this.remove=()=>(this._content&&ue.remove(this._content),this._container&&(ue.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map),this.fire(new a.k("close")),this),this._onMouseUp=s=>{this._update(s.point)},this._onMouseMove=s=>{this._update(s.point)},this._onDrag=s=>{this._update(s.point)},this._update=s=>{var i;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=ue.create("div","maplibregl-popup",this._map.getContainer()),this._tip=ue.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const w of this.options.className.split(" "))this._container.classList.add(w);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?le(this._lngLat,this._flatPos,this._map.transform):(i=this._lngLat)===null||i===void 0?void 0:i.wrap(),this._trackPointer&&!s)return;const r=this._flatPos=this._pos=this._trackPointer&&s?s:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&s?s:this._map.transform.locationPoint(this._lngLat));let l=this.options.anchor;const d=F(this.options.offset);if(!l){const w=this._container.offsetWidth,T=this._container.offsetHeight;let B;B=r.y+d.bottom.y<T?["top"]:r.y>this._map.transform.height-T?["bottom"]:[],r.x<w/2?B.push("left"):r.x>this._map.transform.width-w/2&&B.push("right"),l=B.length===0?"bottom":B.join("-")}let _=r.add(d[l]);this.options.subpixelPositioning||(_=_.round()),ue.setTransform(this._container,`${oe[l]} translate(${_.x}px,${_.y}px)`),we(this._container,l,"popup")},this._onClose=()=>{this.remove()},this.options=a.e(Object.create(A),y)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=a.M.convert(y),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const s=document.createDocumentFragment(),i=document.createElement("body");let r;for(i.innerHTML=y;r=i.firstChild,r;)s.appendChild(r);return this.setDOMContent(s)}getMaxWidth(){var y;return(y=this._container)===null||y===void 0?void 0:y.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ue.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){this._container&&this._container.classList.add(y)}removeClassName(y){this._container&&this._container.classList.remove(y)}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}setSubpixelPositioning(y){this.options.subpixelPositioning=y}_createCloseButton(){this.options.closeButton&&(this._closeButton=ue.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(E);y&&y.focus()}},S.RasterDEMTileSource=Pr,S.RasterTileSource=_n,S.ScaleControl=class{constructor(y){this._onMove=()=>{Zt(this._map,this._container,this.options)},this.setUnit=s=>{this.options.unit=s,Zt(this._map,this._container,this.options)},this.options=a.e({},Gt,y)}getDefaultPosition(){return"bottom-left"}onAdd(y){return this._map=y,this._container=ue.create("div","maplibregl-ctrl maplibregl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ue.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},S.ScrollZoomHandler=_a,S.Style=Bt,S.TerrainControl=class{constructor(y){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=y}onAdd(y){return this._map=y,this._container=ue.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=ue.create("button","maplibregl-ctrl-terrain",this._container),ue.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){ue.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},S.TwoFingersTouchPitchHandler=ta,S.TwoFingersTouchRotateHandler=Vl,S.TwoFingersTouchZoomHandler=uu,S.TwoFingersTouchZoomRotateHandler=_r,S.VectorTileSource=ei,S.VideoSource=Pn,S.addSourceType=(y,s)=>a._(void 0,void 0,void 0,function*(){if(v(y))throw new Error(`A source type called "${y}" already exists.`);((i,r)=>{In[i]=r})(y,s)}),S.clearPrewarmedResources=function(){const y=Vi;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(Ni),Vi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},S.getMaxParallelImageRequests=function(){return a.a.MAX_PARALLEL_IMAGE_REQUESTS},S.getRTLTextPluginStatus=function(){return Y().getRTLTextPluginStatus()},S.getVersion=function(){return O},S.getWorkerCount=function(){return en.workerCount},S.getWorkerUrl=function(){return a.a.WORKER_URL},S.importScriptInWorkers=function(y){return mi().broadcast("importScript",y)},S.prewarm=function(){vn().acquire(Ni)},S.setMaxParallelImageRequests=function(y){a.a.MAX_PARALLEL_IMAGE_REQUESTS=y},S.setRTLTextPlugin=function(y,s){return Y().setRTLTextPlugin(y,s)},S.setWorkerCount=function(y){en.workerCount=y},S.setWorkerUrl=function(y){a.a.WORKER_URL=y}});var x=n;return x})})(d3);var _x=d3.exports;const Kp=uT();function uT(){const{subscribe:e,set:t,update:n}=V0(new Map);return{subscribe:e,set:t,update:n}}const Fy=V0(.78),cT=V0(1),e_=V0({}),Y_=hT(),cg=V0(null);function hT(){const{subscribe:e,set:t,update:n}=V0(null);return{subscribe:e,set:t,update:n}}function yx(e,t,n){const c=e.slice();return c[21]=t[n],c}function vx(e){let t,n=e[21]+"",c;return{c(){t=Fn("option"),c=to(n),this.h()},l(g){t=On(g,"OPTION",{});var x=yn(t);c=io(x,n),x.forEach(vi),this.h()},h(){t.__value=e[21],aE(t,t.__value)},m(g,x){Un(g,t,x),Hi(t,c)},p:Ra,d(g){g&&vi(t)}}}function AT(e){let t,n,c,g="Palette",x,S,a,G,W,he="Show county lines?",ae,ue,be,je,nt,tt="Show ecoregions?",at,ut,xt,Tt,Mt,Oe="Draw Mode?",jt,it,vt="Draw Polygon",mt,Et,Pt="Reset",dt,Je,pt,lt="Fill Opacity",Nt,zt,Ot,gi,wi=ph(e[9]),Ti=[];for(let Ni=0;Ni<wi.length;Ni+=1)Ti[Ni]=vx(yx(e,wi,Ni));return{c(){t=Fn("div"),n=Fn("div"),c=Fn("h4"),c.textContent=g,x=wr(),S=Fn("select");for(let Ni=0;Ni<Ti.length;Ni+=1)Ti[Ni].c();a=wr(),G=Fn("div"),W=Fn("h4"),W.textContent=he,ae=wr(),ue=Fn("input"),be=wr(),je=Fn("div"),nt=Fn("h4"),nt.textContent=tt,at=wr(),ut=Fn("input"),xt=wr(),Tt=Fn("div"),Mt=Fn("h4"),Mt.textContent=Oe,jt=wr(),it=Fn("button"),it.textContent=vt,mt=wr(),Et=Fn("button"),Et.textContent=Pt,dt=wr(),Je=Fn("div"),pt=Fn("h4"),pt.textContent=lt,Nt=wr(),zt=Fn("input"),this.h()},l(Ni){t=On(Ni,"DIV",{class:!0});var en=yn(t);n=On(en,"DIV",{class:!0});var ji=yn(n);c=On(ji,"H4",{class:!0,"data-svelte-h":!0}),Zu(c)!=="svelte-16skbun"&&(c.textContent=g),x=Sr(ji),S=On(ji,"SELECT",{label:!0});var Vi=yn(S);for(let Ri=0;Ri<Ti.length;Ri+=1)Ti[Ri].l(Vi);Vi.forEach(vi),ji.forEach(vi),a=Sr(en),G=On(en,"DIV",{class:!0});var nn=yn(G);W=On(nn,"H4",{class:!0,"data-svelte-h":!0}),Zu(W)!=="svelte-tf6nwt"&&(W.textContent=he),ae=Sr(nn),ue=On(nn,"INPUT",{type:!0}),nn.forEach(vi),be=Sr(en),je=On(en,"DIV",{class:!0});var vn=yn(je);nt=On(vn,"H4",{class:!0,"data-svelte-h":!0}),Zu(nt)!=="svelte-1f8vskc"&&(nt.textContent=tt),at=Sr(vn),ut=On(vn,"INPUT",{type:!0}),vn.forEach(vi),xt=Sr(en),Tt=On(en,"DIV",{class:!0});var Ci=yn(Tt);Mt=On(Ci,"H4",{class:!0,"data-svelte-h":!0}),Zu(Mt)!=="svelte-hi5xw8"&&(Mt.textContent=Oe),jt=Sr(Ci),it=On(Ci,"BUTTON",{"data-svelte-h":!0}),Zu(it)!=="svelte-o8r62u"&&(it.textContent=vt),mt=Sr(Ci),Et=On(Ci,"BUTTON",{"data-svelte-h":!0}),Zu(Et)!=="svelte-2y01av"&&(Et.textContent=Pt),Ci.forEach(vi),dt=Sr(en),Je=On(en,"DIV",{class:!0});var mi=yn(Je);pt=On(mi,"H4",{class:!0,"data-svelte-h":!0}),Zu(pt)!=="svelte-1fb1xwq"&&(pt.textContent=lt),Nt=Sr(mi),zt=On(mi,"INPUT",{type:!0,min:!0,max:!0}),mi.forEach(vi),en.forEach(vi),this.h()},h(){ki(c,"class","svelte-11w56ip"),ki(S,"label","Color Scheme"),e[5]===void 0&&rE(()=>e[11].call(S)),ki(n,"class","control-item svelte-11w56ip"),ki(W,"class","svelte-11w56ip"),ki(ue,"type","checkbox"),ki(G,"class","control-item svelte-11w56ip"),ki(nt,"class","svelte-11w56ip"),ki(ut,"type","checkbox"),ki(je,"class","control-item svelte-11w56ip"),ki(Mt,"class","svelte-11w56ip"),ki(Tt,"class","control-item svelte-11w56ip"),ki(pt,"class","svelte-11w56ip"),ki(zt,"type","range"),ki(zt,"min","0"),ki(zt,"max","100"),zt.value=e[8]*100,ki(Je,"class","control-item svelte-11w56ip"),ki(t,"class","controls svelte-11w56ip")},m(Ni,en){Un(Ni,t,en),Hi(t,n),Hi(n,c),Hi(n,x),Hi(n,S);for(let ji=0;ji<Ti.length;ji+=1)Ti[ji]&&Ti[ji].m(S,null);U2(S,e[5],!0),Hi(t,a),Hi(t,G),Hi(G,W),Hi(G,ae),Hi(G,ue),ue.checked=e[6],Hi(t,be),Hi(t,je),Hi(je,nt),Hi(je,at),Hi(je,ut),ut.checked=e[7],Hi(t,xt),Hi(t,Tt),Hi(Tt,Mt),Hi(Tt,jt),Hi(Tt,it),Hi(Tt,mt),Hi(Tt,Et),Hi(t,dt),Hi(t,Je),Hi(Je,pt),Hi(Je,Nt),Hi(Je,zt),Ot||(gi=[Gl(S,"change",e[11]),Gl(S,"change",e[12]),Gl(ue,"change",e[13]),Gl(ue,"change",e[14]),Gl(ut,"change",e[15]),Gl(ut,"change",e[16]),Gl(it,"click",e[17]),Gl(Et,"click",e[18]),Gl(zt,"input",e[19])],Ot=!0)},p(Ni,[en]){if(en&512){wi=ph(Ni[9]);let ji;for(ji=0;ji<wi.length;ji+=1){const Vi=yx(Ni,wi,ji);Ti[ji]?Ti[ji].p(Vi,en):(Ti[ji]=vx(Vi),Ti[ji].c(),Ti[ji].m(S,null))}for(;ji<Ti.length;ji+=1)Ti[ji].d(1);Ti.length=wi.length}en&544&&U2(S,Ni[5]),en&64&&(ue.checked=Ni[6]),en&128&&(ut.checked=Ni[7])},i:Ra,o:Ra,d(Ni){Ni&&vi(t),up(Ti,Ni),Ot=!1,Nh(gi)}}}function fT(e,t,n){let c;tc(e,Fy,it=>n(20,c=it));let{updateColorScheme:g}=t,{updateShowCounties:x}=t,{updateShowEcoregions:S}=t,{updateDrawing:a}=t,{updateDrawnPath:G}=t,{isDrawing:W}=t,he,ae,ue,be=c;const je=Object.keys(Bv);xc(()=>{g(he)});function nt(){he=oE(this),n(5,he),n(9,je)}const tt=()=>g(he);function at(){ae=this.checked,n(6,ae)}const ut=()=>x(ae);function xt(){ue=this.checked,n(7,ue)}const Tt=()=>S(ue),Mt=()=>a(!0),Oe=()=>G(null),jt=it=>Fy.set(Number.parseInt(it.target.value)/100);return e.$$set=it=>{"updateColorScheme"in it&&n(0,g=it.updateColorScheme),"updateShowCounties"in it&&n(1,x=it.updateShowCounties),"updateShowEcoregions"in it&&n(2,S=it.updateShowEcoregions),"updateDrawing"in it&&n(3,a=it.updateDrawing),"updateDrawnPath"in it&&n(4,G=it.updateDrawnPath),"isDrawing"in it&&n(10,W=it.isDrawing)},[g,x,S,a,G,he,ae,ue,be,je,W,nt,tt,at,ut,xt,Tt,Mt,Oe,jt]}class dT extends fo{constructor(t){super(),po(this,t,fT,AT,Oa,{updateColorScheme:0,updateShowCounties:1,updateShowEcoregions:2,updateDrawing:3,updateDrawnPath:4,isDrawing:10})}}function pT(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var m3={exports:{}};const mT={},gT=Object.freeze(Object.defineProperty({__proto__:null,default:mT},Symbol.toStringTag,{value:"Module"})),xx=zv(gT);var Gg={exports:{}},bx;function _T(){return bx||(bx=1,function(e,t){(function(n,c){c(t)})(Jf,function(n){var c=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,81,2,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,9,5351,0,7,14,13835,9,87,9,39,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,4706,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,983,6,110,6,6,9,4759,9,787719,239],g=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,68,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,4026,582,8634,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,757,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],x="-----------------------------------------------------------------------------------------------------------------------------------------------------",S="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",a={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},G="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",W={5:G,"5module":G+" export import",6:G+" const class extends export import super"},he=/^in(stanceof)?$/,ae=new RegExp("["+S+"]"),ue=new RegExp("["+S+x+"]");function be(N,xe){for(var rt=65536,St=0;St<xe.length;St+=2){if(rt+=xe[St],rt>N)return!1;if(rt+=xe[St+1],rt>=N)return!0}return!1}function je(N,xe){return N<65?N===36:N<91?!0:N<97?N===95:N<123?!0:N<=65535?N>=170&&ae.test(String.fromCharCode(N)):xe===!1?!1:be(N,g)}function nt(N,xe){return N<48?N===36:N<58?!0:N<65?!1:N<91?!0:N<97?N===95:N<123?!0:N<=65535?N>=170&&ue.test(String.fromCharCode(N)):xe===!1?!1:be(N,g)||be(N,c)}var tt=function(xe,rt){rt===void 0&&(rt={}),this.label=xe,this.keyword=rt.keyword,this.beforeExpr=!!rt.beforeExpr,this.startsExpr=!!rt.startsExpr,this.isLoop=!!rt.isLoop,this.isAssign=!!rt.isAssign,this.prefix=!!rt.prefix,this.postfix=!!rt.postfix,this.binop=rt.binop||null,this.updateContext=null};function at(N,xe){return new tt(N,{beforeExpr:!0,binop:xe})}var ut={beforeExpr:!0},xt={startsExpr:!0},Tt={};function Mt(N,xe){return xe===void 0&&(xe={}),xe.keyword=N,Tt[N]=new tt(N,xe)}var Oe={num:new tt("num",xt),regexp:new tt("regexp",xt),string:new tt("string",xt),name:new tt("name",xt),privateId:new tt("privateId",xt),eof:new tt("eof"),bracketL:new tt("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new tt("]"),braceL:new tt("{",{beforeExpr:!0,startsExpr:!0}),braceR:new tt("}"),parenL:new tt("(",{beforeExpr:!0,startsExpr:!0}),parenR:new tt(")"),comma:new tt(",",ut),semi:new tt(";",ut),colon:new tt(":",ut),dot:new tt("."),question:new tt("?",ut),questionDot:new tt("?."),arrow:new tt("=>",ut),template:new tt("template"),invalidTemplate:new tt("invalidTemplate"),ellipsis:new tt("...",ut),backQuote:new tt("`",xt),dollarBraceL:new tt("${",{beforeExpr:!0,startsExpr:!0}),eq:new tt("=",{beforeExpr:!0,isAssign:!0}),assign:new tt("_=",{beforeExpr:!0,isAssign:!0}),incDec:new tt("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new tt("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:at("||",1),logicalAND:at("&&",2),bitwiseOR:at("|",3),bitwiseXOR:at("^",4),bitwiseAND:at("&",5),equality:at("==/!=/===/!==",6),relational:at("</>/<=/>=",7),bitShift:at("<</>>/>>>",8),plusMin:new tt("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:at("%",10),star:at("*",10),slash:at("/",10),starstar:new tt("**",{beforeExpr:!0}),coalesce:at("??",1),_break:Mt("break"),_case:Mt("case",ut),_catch:Mt("catch"),_continue:Mt("continue"),_debugger:Mt("debugger"),_default:Mt("default",ut),_do:Mt("do",{isLoop:!0,beforeExpr:!0}),_else:Mt("else",ut),_finally:Mt("finally"),_for:Mt("for",{isLoop:!0}),_function:Mt("function",xt),_if:Mt("if"),_return:Mt("return",ut),_switch:Mt("switch"),_throw:Mt("throw",ut),_try:Mt("try"),_var:Mt("var"),_const:Mt("const"),_while:Mt("while",{isLoop:!0}),_with:Mt("with"),_new:Mt("new",{beforeExpr:!0,startsExpr:!0}),_this:Mt("this",xt),_super:Mt("super",xt),_class:Mt("class",xt),_extends:Mt("extends",ut),_export:Mt("export"),_import:Mt("import",xt),_null:Mt("null",xt),_true:Mt("true",xt),_false:Mt("false",xt),_in:Mt("in",{beforeExpr:!0,binop:7}),_instanceof:Mt("instanceof",{beforeExpr:!0,binop:7}),_typeof:Mt("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Mt("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Mt("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},jt=/\r\n?|\n|\u2028|\u2029/,it=new RegExp(jt.source,"g");function vt(N){return N===10||N===13||N===8232||N===8233}function mt(N,xe,rt){rt===void 0&&(rt=N.length);for(var St=xe;St<rt;St++){var $t=N.charCodeAt(St);if(vt($t))return St<rt-1&&$t===13&&N.charCodeAt(St+1)===10?St+2:St+1}return-1}var Et=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Pt=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,dt=Object.prototype,Je=dt.hasOwnProperty,pt=dt.toString,lt=Object.hasOwn||function(N,xe){return Je.call(N,xe)},Nt=Array.isArray||function(N){return pt.call(N)==="[object Array]"},zt=Object.create(null);function Ot(N){return zt[N]||(zt[N]=new RegExp("^(?:"+N.replace(/ /g,"|")+")$"))}function gi(N){return N<=65535?String.fromCharCode(N):(N-=65536,String.fromCharCode((N>>10)+55296,(N&1023)+56320))}var wi=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,Ti=function(xe,rt){this.line=xe,this.column=rt};Ti.prototype.offset=function(xe){return new Ti(this.line,this.column+xe)};var Ni=function(xe,rt,St){this.start=rt,this.end=St,xe.sourceFile!==null&&(this.source=xe.sourceFile)};function en(N,xe){for(var rt=1,St=0;;){var $t=mt(N,St,xe);if($t<0)return new Ti(rt,xe-St);++rt,St=$t}}var ji={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},Vi=!1;function nn(N){var xe={};for(var rt in ji)xe[rt]=N&&lt(N,rt)?N[rt]:ji[rt];if(xe.ecmaVersion==="latest"?xe.ecmaVersion=1e8:xe.ecmaVersion==null?(!Vi&&typeof console=="object"&&console.warn&&(Vi=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),xe.ecmaVersion=11):xe.ecmaVersion>=2015&&(xe.ecmaVersion-=2009),xe.allowReserved==null&&(xe.allowReserved=xe.ecmaVersion<5),(!N||N.allowHashBang==null)&&(xe.allowHashBang=xe.ecmaVersion>=14),Nt(xe.onToken)){var St=xe.onToken;xe.onToken=function($t){return St.push($t)}}return Nt(xe.onComment)&&(xe.onComment=vn(xe,xe.onComment)),xe}function vn(N,xe){return function(rt,St,$t,Ii,Li,An){var pn={type:rt?"Block":"Line",value:St,start:$t,end:Ii};N.locations&&(pn.loc=new Ni(this,Li,An)),N.ranges&&(pn.range=[$t,Ii]),xe.push(pn)}}var Ci=1,mi=2,Ri=4,Oi=8,_i=16,Ji=32,Ai=64,sn=128,ei=256,_n=Ci|mi|ei;function Pr(N,xe){return mi|(N?Ri:0)|(xe?Oi:0)}var ci=0,rn=1,tr=2,Pn=3,Qn=4,In=5,v=function(xe,rt,St){this.options=xe=nn(xe),this.sourceFile=xe.sourceFile,this.keywords=Ot(W[xe.ecmaVersion>=6?6:xe.sourceType==="module"?"5module":5]);var $t="";xe.allowReserved!==!0&&($t=a[xe.ecmaVersion>=6?6:xe.ecmaVersion===5?5:3],xe.sourceType==="module"&&($t+=" await")),this.reservedWords=Ot($t);var Ii=($t?$t+" ":"")+a.strict;this.reservedWordsStrict=Ot(Ii),this.reservedWordsStrictBind=Ot(Ii+" "+a.strictBind),this.input=String(rt),this.containsEsc=!1,St?(this.pos=St,this.lineStart=this.input.lastIndexOf(`
`,St-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(jt).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=Oe.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=xe.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&xe.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(Ci),this.regexpState=null,this.privateNameStack=[]},k={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};v.prototype.parse=function(){var xe=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(xe)},k.inFunction.get=function(){return(this.currentVarScope().flags&mi)>0},k.inGenerator.get=function(){return(this.currentVarScope().flags&Oi)>0&&!this.currentVarScope().inClassFieldInit},k.inAsync.get=function(){return(this.currentVarScope().flags&Ri)>0&&!this.currentVarScope().inClassFieldInit},k.canAwait.get=function(){for(var N=this.scopeStack.length-1;N>=0;N--){var xe=this.scopeStack[N];if(xe.inClassFieldInit||xe.flags&ei)return!1;if(xe.flags&mi)return(xe.flags&Ri)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction},k.allowSuper.get=function(){var N=this.currentThisScope(),xe=N.flags,rt=N.inClassFieldInit;return(xe&Ai)>0||rt||this.options.allowSuperOutsideMethod},k.allowDirectSuper.get=function(){return(this.currentThisScope().flags&sn)>0},k.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},k.allowNewDotTarget.get=function(){var N=this.currentThisScope(),xe=N.flags,rt=N.inClassFieldInit;return(xe&(mi|ei))>0||rt},k.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&ei)>0},v.extend=function(){for(var xe=[],rt=arguments.length;rt--;)xe[rt]=arguments[rt];for(var St=this,$t=0;$t<xe.length;$t++)St=xe[$t](St);return St},v.parse=function(xe,rt){return new this(rt,xe).parse()},v.parseExpressionAt=function(xe,rt,St){var $t=new this(St,xe,rt);return $t.nextToken(),$t.parseExpression()},v.tokenizer=function(xe,rt){return new this(rt,xe)},Object.defineProperties(v.prototype,k);var V=v.prototype,Y=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;V.strictDirective=function(N){if(this.options.ecmaVersion<5)return!1;for(;;){Pt.lastIndex=N,N+=Pt.exec(this.input)[0].length;var xe=Y.exec(this.input.slice(N));if(!xe)return!1;if((xe[1]||xe[2])==="use strict"){Pt.lastIndex=N+xe[0].length;var rt=Pt.exec(this.input),St=rt.index+rt[0].length,$t=this.input.charAt(St);return $t===";"||$t==="}"||jt.test(rt[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test($t)||$t==="!"&&this.input.charAt(St+1)==="=")}N+=xe[0].length,Pt.lastIndex=N,N+=Pt.exec(this.input)[0].length,this.input[N]===";"&&N++}},V.eat=function(N){return this.type===N?(this.next(),!0):!1},V.isContextual=function(N){return this.type===Oe.name&&this.value===N&&!this.containsEsc},V.eatContextual=function(N){return this.isContextual(N)?(this.next(),!0):!1},V.expectContextual=function(N){this.eatContextual(N)||this.unexpected()},V.canInsertSemicolon=function(){return this.type===Oe.eof||this.type===Oe.braceR||jt.test(this.input.slice(this.lastTokEnd,this.start))},V.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},V.semicolon=function(){!this.eat(Oe.semi)&&!this.insertSemicolon()&&this.unexpected()},V.afterTrailingComma=function(N,xe){if(this.type===N)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),xe||this.next(),!0},V.expect=function(N){this.eat(N)||this.unexpected()},V.unexpected=function(N){this.raise(N??this.start,"Unexpected token")};var te=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};V.checkPatternErrors=function(N,xe){if(N){N.trailingComma>-1&&this.raiseRecoverable(N.trailingComma,"Comma is not permitted after the rest element");var rt=xe?N.parenthesizedAssign:N.parenthesizedBind;rt>-1&&this.raiseRecoverable(rt,xe?"Assigning to rvalue":"Parenthesized pattern")}},V.checkExpressionErrors=function(N,xe){if(!N)return!1;var rt=N.shorthandAssign,St=N.doubleProto;if(!xe)return rt>=0||St>=0;rt>=0&&this.raise(rt,"Shorthand property assignments are valid only in destructuring patterns"),St>=0&&this.raiseRecoverable(St,"Redefinition of __proto__ property")},V.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},V.isSimpleAssignTarget=function(N){return N.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(N.expression):N.type==="Identifier"||N.type==="MemberExpression"};var fe=v.prototype;fe.parseTopLevel=function(N){var xe=Object.create(null);for(N.body||(N.body=[]);this.type!==Oe.eof;){var rt=this.parseStatement(null,!0,xe);N.body.push(rt)}if(this.inModule)for(var St=0,$t=Object.keys(this.undefinedExports);St<$t.length;St+=1){var Ii=$t[St];this.raiseRecoverable(this.undefinedExports[Ii].start,"Export '"+Ii+"' is not defined")}return this.adaptDirectivePrologue(N.body),this.next(),N.sourceType=this.options.sourceType,this.finishNode(N,"Program")};var ve={kind:"loop"},Ie={kind:"switch"};fe.isLet=function(N){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;Pt.lastIndex=this.pos;var xe=Pt.exec(this.input),rt=this.pos+xe[0].length,St=this.input.charCodeAt(rt);if(St===91||St===92)return!0;if(N)return!1;if(St===123||St>55295&&St<56320)return!0;if(je(St,!0)){for(var $t=rt+1;nt(St=this.input.charCodeAt($t),!0);)++$t;if(St===92||St>55295&&St<56320)return!0;var Ii=this.input.slice(rt,$t);if(!he.test(Ii))return!0}return!1},fe.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;Pt.lastIndex=this.pos;var N=Pt.exec(this.input),xe=this.pos+N[0].length,rt;return!jt.test(this.input.slice(this.pos,xe))&&this.input.slice(xe,xe+8)==="function"&&(xe+8===this.input.length||!(nt(rt=this.input.charCodeAt(xe+8))||rt>55295&&rt<56320))},fe.parseStatement=function(N,xe,rt){var St=this.type,$t=this.startNode(),Ii;switch(this.isLet(N)&&(St=Oe._var,Ii="let"),St){case Oe._break:case Oe._continue:return this.parseBreakContinueStatement($t,St.keyword);case Oe._debugger:return this.parseDebuggerStatement($t);case Oe._do:return this.parseDoStatement($t);case Oe._for:return this.parseForStatement($t);case Oe._function:return N&&(this.strict||N!=="if"&&N!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement($t,!1,!N);case Oe._class:return N&&this.unexpected(),this.parseClass($t,!0);case Oe._if:return this.parseIfStatement($t);case Oe._return:return this.parseReturnStatement($t);case Oe._switch:return this.parseSwitchStatement($t);case Oe._throw:return this.parseThrowStatement($t);case Oe._try:return this.parseTryStatement($t);case Oe._const:case Oe._var:return Ii=Ii||this.value,N&&Ii!=="var"&&this.unexpected(),this.parseVarStatement($t,Ii);case Oe._while:return this.parseWhileStatement($t);case Oe._with:return this.parseWithStatement($t);case Oe.braceL:return this.parseBlock(!0,$t);case Oe.semi:return this.parseEmptyStatement($t);case Oe._export:case Oe._import:if(this.options.ecmaVersion>10&&St===Oe._import){Pt.lastIndex=this.pos;var Li=Pt.exec(this.input),An=this.pos+Li[0].length,pn=this.input.charCodeAt(An);if(pn===40||pn===46)return this.parseExpressionStatement($t,this.parseExpression())}return this.options.allowImportExportEverywhere||(xe||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),St===Oe._import?this.parseImport($t):this.parseExport($t,rt);default:if(this.isAsyncFunction())return N&&this.unexpected(),this.next(),this.parseFunctionStatement($t,!0,!N);var sr=this.value,Ar=this.parseExpression();return St===Oe.name&&Ar.type==="Identifier"&&this.eat(Oe.colon)?this.parseLabeledStatement($t,sr,Ar,N):this.parseExpressionStatement($t,Ar)}},fe.parseBreakContinueStatement=function(N,xe){var rt=xe==="break";this.next(),this.eat(Oe.semi)||this.insertSemicolon()?N.label=null:this.type!==Oe.name?this.unexpected():(N.label=this.parseIdent(),this.semicolon());for(var St=0;St<this.labels.length;++St){var $t=this.labels[St];if((N.label==null||$t.name===N.label.name)&&($t.kind!=null&&(rt||$t.kind==="loop")||N.label&&rt))break}return St===this.labels.length&&this.raise(N.start,"Unsyntactic "+xe),this.finishNode(N,rt?"BreakStatement":"ContinueStatement")},fe.parseDebuggerStatement=function(N){return this.next(),this.semicolon(),this.finishNode(N,"DebuggerStatement")},fe.parseDoStatement=function(N){return this.next(),this.labels.push(ve),N.body=this.parseStatement("do"),this.labels.pop(),this.expect(Oe._while),N.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(Oe.semi):this.semicolon(),this.finishNode(N,"DoWhileStatement")},fe.parseForStatement=function(N){this.next();var xe=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(ve),this.enterScope(0),this.expect(Oe.parenL),this.type===Oe.semi)return xe>-1&&this.unexpected(xe),this.parseFor(N,null);var rt=this.isLet();if(this.type===Oe._var||this.type===Oe._const||rt){var St=this.startNode(),$t=rt?"let":this.value;return this.next(),this.parseVar(St,!0,$t),this.finishNode(St,"VariableDeclaration"),(this.type===Oe._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&St.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===Oe._in?xe>-1&&this.unexpected(xe):N.await=xe>-1),this.parseForIn(N,St)):(xe>-1&&this.unexpected(xe),this.parseFor(N,St))}var Ii=this.isContextual("let"),Li=!1,An=new te,pn=this.parseExpression(xe>-1?"await":!0,An);return this.type===Oe._in||(Li=this.options.ecmaVersion>=6&&this.isContextual("of"))?(this.options.ecmaVersion>=9&&(this.type===Oe._in?xe>-1&&this.unexpected(xe):N.await=xe>-1),Ii&&Li&&this.raise(pn.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(pn,!1,An),this.checkLValPattern(pn),this.parseForIn(N,pn)):(this.checkExpressionErrors(An,!0),xe>-1&&this.unexpected(xe),this.parseFor(N,pn))},fe.parseFunctionStatement=function(N,xe,rt){return this.next(),this.parseFunction(N,ze|(rt?0:We),!1,xe)},fe.parseIfStatement=function(N){return this.next(),N.test=this.parseParenExpression(),N.consequent=this.parseStatement("if"),N.alternate=this.eat(Oe._else)?this.parseStatement("if"):null,this.finishNode(N,"IfStatement")},fe.parseReturnStatement=function(N){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(Oe.semi)||this.insertSemicolon()?N.argument=null:(N.argument=this.parseExpression(),this.semicolon()),this.finishNode(N,"ReturnStatement")},fe.parseSwitchStatement=function(N){this.next(),N.discriminant=this.parseParenExpression(),N.cases=[],this.expect(Oe.braceL),this.labels.push(Ie),this.enterScope(0);for(var xe,rt=!1;this.type!==Oe.braceR;)if(this.type===Oe._case||this.type===Oe._default){var St=this.type===Oe._case;xe&&this.finishNode(xe,"SwitchCase"),N.cases.push(xe=this.startNode()),xe.consequent=[],this.next(),St?xe.test=this.parseExpression():(rt&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),rt=!0,xe.test=null),this.expect(Oe.colon)}else xe||this.unexpected(),xe.consequent.push(this.parseStatement(null));return this.exitScope(),xe&&this.finishNode(xe,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(N,"SwitchStatement")},fe.parseThrowStatement=function(N){return this.next(),jt.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),N.argument=this.parseExpression(),this.semicolon(),this.finishNode(N,"ThrowStatement")};var Ee=[];fe.parseCatchClauseParam=function(){var N=this.parseBindingAtom(),xe=N.type==="Identifier";return this.enterScope(xe?Ji:0),this.checkLValPattern(N,xe?Qn:tr),this.expect(Oe.parenR),N},fe.parseTryStatement=function(N){if(this.next(),N.block=this.parseBlock(),N.handler=null,this.type===Oe._catch){var xe=this.startNode();this.next(),this.eat(Oe.parenL)?xe.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),xe.param=null,this.enterScope(0)),xe.body=this.parseBlock(!1),this.exitScope(),N.handler=this.finishNode(xe,"CatchClause")}return N.finalizer=this.eat(Oe._finally)?this.parseBlock():null,!N.handler&&!N.finalizer&&this.raise(N.start,"Missing catch or finally clause"),this.finishNode(N,"TryStatement")},fe.parseVarStatement=function(N,xe,rt){return this.next(),this.parseVar(N,!1,xe,rt),this.semicolon(),this.finishNode(N,"VariableDeclaration")},fe.parseWhileStatement=function(N){return this.next(),N.test=this.parseParenExpression(),this.labels.push(ve),N.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(N,"WhileStatement")},fe.parseWithStatement=function(N){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),N.object=this.parseParenExpression(),N.body=this.parseStatement("with"),this.finishNode(N,"WithStatement")},fe.parseEmptyStatement=function(N){return this.next(),this.finishNode(N,"EmptyStatement")},fe.parseLabeledStatement=function(N,xe,rt,St){for(var $t=0,Ii=this.labels;$t<Ii.length;$t+=1){var Li=Ii[$t];Li.name===xe&&this.raise(rt.start,"Label '"+xe+"' is already declared")}for(var An=this.type.isLoop?"loop":this.type===Oe._switch?"switch":null,pn=this.labels.length-1;pn>=0;pn--){var sr=this.labels[pn];if(sr.statementStart===N.start)sr.statementStart=this.start,sr.kind=An;else break}return this.labels.push({name:xe,kind:An,statementStart:this.start}),N.body=this.parseStatement(St?St.indexOf("label")===-1?St+"label":St:"label"),this.labels.pop(),N.label=rt,this.finishNode(N,"LabeledStatement")},fe.parseExpressionStatement=function(N,xe){return N.expression=xe,this.semicolon(),this.finishNode(N,"ExpressionStatement")},fe.parseBlock=function(N,xe,rt){for(N===void 0&&(N=!0),xe===void 0&&(xe=this.startNode()),xe.body=[],this.expect(Oe.braceL),N&&this.enterScope(0);this.type!==Oe.braceR;){var St=this.parseStatement(null);xe.body.push(St)}return rt&&(this.strict=!1),this.next(),N&&this.exitScope(),this.finishNode(xe,"BlockStatement")},fe.parseFor=function(N,xe){return N.init=xe,this.expect(Oe.semi),N.test=this.type===Oe.semi?null:this.parseExpression(),this.expect(Oe.semi),N.update=this.type===Oe.parenR?null:this.parseExpression(),this.expect(Oe.parenR),N.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(N,"ForStatement")},fe.parseForIn=function(N,xe){var rt=this.type===Oe._in;return this.next(),xe.type==="VariableDeclaration"&&xe.declarations[0].init!=null&&(!rt||this.options.ecmaVersion<8||this.strict||xe.kind!=="var"||xe.declarations[0].id.type!=="Identifier")&&this.raise(xe.start,(rt?"for-in":"for-of")+" loop variable declaration may not have an initializer"),N.left=xe,N.right=rt?this.parseExpression():this.parseMaybeAssign(),this.expect(Oe.parenR),N.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(N,rt?"ForInStatement":"ForOfStatement")},fe.parseVar=function(N,xe,rt,St){for(N.declarations=[],N.kind=rt;;){var $t=this.startNode();if(this.parseVarId($t,rt),this.eat(Oe.eq)?$t.init=this.parseMaybeAssign(xe):!St&&rt==="const"&&!(this.type===Oe._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!St&&$t.id.type!=="Identifier"&&!(xe&&(this.type===Oe._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):$t.init=null,N.declarations.push(this.finishNode($t,"VariableDeclarator")),!this.eat(Oe.comma))break}return N},fe.parseVarId=function(N,xe){N.id=this.parseBindingAtom(),this.checkLValPattern(N.id,xe==="var"?rn:tr,!1)};var ze=1,We=2,He=4;fe.parseFunction=function(N,xe,rt,St,$t){this.initFunction(N),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!St)&&(this.type===Oe.star&&xe&We&&this.unexpected(),N.generator=this.eat(Oe.star)),this.options.ecmaVersion>=8&&(N.async=!!St),xe&ze&&(N.id=xe&He&&this.type!==Oe.name?null:this.parseIdent(),N.id&&!(xe&We)&&this.checkLValSimple(N.id,this.strict||N.generator||N.async?this.treatFunctionsAsVar?rn:tr:Pn));var Ii=this.yieldPos,Li=this.awaitPos,An=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Pr(N.async,N.generator)),xe&ze||(N.id=this.type===Oe.name?this.parseIdent():null),this.parseFunctionParams(N),this.parseFunctionBody(N,rt,!1,$t),this.yieldPos=Ii,this.awaitPos=Li,this.awaitIdentPos=An,this.finishNode(N,xe&ze?"FunctionDeclaration":"FunctionExpression")},fe.parseFunctionParams=function(N){this.expect(Oe.parenL),N.params=this.parseBindingList(Oe.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},fe.parseClass=function(N,xe){this.next();var rt=this.strict;this.strict=!0,this.parseClassId(N,xe),this.parseClassSuper(N);var St=this.enterClassBody(),$t=this.startNode(),Ii=!1;for($t.body=[],this.expect(Oe.braceL);this.type!==Oe.braceR;){var Li=this.parseClassElement(N.superClass!==null);Li&&($t.body.push(Li),Li.type==="MethodDefinition"&&Li.kind==="constructor"?(Ii&&this.raiseRecoverable(Li.start,"Duplicate constructor in the same class"),Ii=!0):Li.key&&Li.key.type==="PrivateIdentifier"&&Qe(St,Li)&&this.raiseRecoverable(Li.key.start,"Identifier '#"+Li.key.name+"' has already been declared"))}return this.strict=rt,this.next(),N.body=this.finishNode($t,"ClassBody"),this.exitClassBody(),this.finishNode(N,xe?"ClassDeclaration":"ClassExpression")},fe.parseClassElement=function(N){if(this.eat(Oe.semi))return null;var xe=this.options.ecmaVersion,rt=this.startNode(),St="",$t=!1,Ii=!1,Li="method",An=!1;if(this.eatContextual("static")){if(xe>=13&&this.eat(Oe.braceL))return this.parseClassStaticBlock(rt),rt;this.isClassElementNameStart()||this.type===Oe.star?An=!0:St="static"}if(rt.static=An,!St&&xe>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===Oe.star)&&!this.canInsertSemicolon()?Ii=!0:St="async"),!St&&(xe>=9||!Ii)&&this.eat(Oe.star)&&($t=!0),!St&&!Ii&&!$t){var pn=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?Li=pn:St=pn)}if(St?(rt.computed=!1,rt.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),rt.key.name=St,this.finishNode(rt.key,"Identifier")):this.parseClassElementName(rt),xe<13||this.type===Oe.parenL||Li!=="method"||$t||Ii){var sr=!rt.static&&Ue(rt,"constructor"),Ar=sr&&N;sr&&Li!=="method"&&this.raise(rt.key.start,"Constructor can't have get/set modifier"),rt.kind=sr?"constructor":Li,this.parseClassMethod(rt,$t,Ii,Ar)}else this.parseClassField(rt);return rt},fe.isClassElementNameStart=function(){return this.type===Oe.name||this.type===Oe.privateId||this.type===Oe.num||this.type===Oe.string||this.type===Oe.bracketL||this.type.keyword},fe.parseClassElementName=function(N){this.type===Oe.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),N.computed=!1,N.key=this.parsePrivateIdent()):this.parsePropertyName(N)},fe.parseClassMethod=function(N,xe,rt,St){var $t=N.key;N.kind==="constructor"?(xe&&this.raise($t.start,"Constructor can't be a generator"),rt&&this.raise($t.start,"Constructor can't be an async method")):N.static&&Ue(N,"prototype")&&this.raise($t.start,"Classes may not have a static property named prototype");var Ii=N.value=this.parseMethod(xe,rt,St);return N.kind==="get"&&Ii.params.length!==0&&this.raiseRecoverable(Ii.start,"getter should have no params"),N.kind==="set"&&Ii.params.length!==1&&this.raiseRecoverable(Ii.start,"setter should have exactly one param"),N.kind==="set"&&Ii.params[0].type==="RestElement"&&this.raiseRecoverable(Ii.params[0].start,"Setter cannot use rest params"),this.finishNode(N,"MethodDefinition")},fe.parseClassField=function(N){if(Ue(N,"constructor")?this.raise(N.key.start,"Classes can't have a field named 'constructor'"):N.static&&Ue(N,"prototype")&&this.raise(N.key.start,"Classes can't have a static field named 'prototype'"),this.eat(Oe.eq)){var xe=this.currentThisScope(),rt=xe.inClassFieldInit;xe.inClassFieldInit=!0,N.value=this.parseMaybeAssign(),xe.inClassFieldInit=rt}else N.value=null;return this.semicolon(),this.finishNode(N,"PropertyDefinition")},fe.parseClassStaticBlock=function(N){N.body=[];var xe=this.labels;for(this.labels=[],this.enterScope(ei|Ai);this.type!==Oe.braceR;){var rt=this.parseStatement(null);N.body.push(rt)}return this.next(),this.exitScope(),this.labels=xe,this.finishNode(N,"StaticBlock")},fe.parseClassId=function(N,xe){this.type===Oe.name?(N.id=this.parseIdent(),xe&&this.checkLValSimple(N.id,tr,!1)):(xe===!0&&this.unexpected(),N.id=null)},fe.parseClassSuper=function(N){N.superClass=this.eat(Oe._extends)?this.parseExprSubscripts(null,!1):null},fe.enterClassBody=function(){var N={declared:Object.create(null),used:[]};return this.privateNameStack.push(N),N.declared},fe.exitClassBody=function(){var N=this.privateNameStack.pop(),xe=N.declared,rt=N.used;if(this.options.checkPrivateFields)for(var St=this.privateNameStack.length,$t=St===0?null:this.privateNameStack[St-1],Ii=0;Ii<rt.length;++Ii){var Li=rt[Ii];lt(xe,Li.name)||($t?$t.used.push(Li):this.raiseRecoverable(Li.start,"Private field '#"+Li.name+"' must be declared in an enclosing class"))}};function Qe(N,xe){var rt=xe.key.name,St=N[rt],$t="true";return xe.type==="MethodDefinition"&&(xe.kind==="get"||xe.kind==="set")&&($t=(xe.static?"s":"i")+xe.kind),St==="iget"&&$t==="iset"||St==="iset"&&$t==="iget"||St==="sget"&&$t==="sset"||St==="sset"&&$t==="sget"?(N[rt]="true",!1):St?!0:(N[rt]=$t,!1)}function Ue(N,xe){var rt=N.computed,St=N.key;return!rt&&(St.type==="Identifier"&&St.name===xe||St.type==="Literal"&&St.value===xe)}fe.parseExportAllDeclaration=function(N,xe){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(N.exported=this.parseModuleExportName(),this.checkExport(xe,N.exported,this.lastTokStart)):N.exported=null),this.expectContextual("from"),this.type!==Oe.string&&this.unexpected(),N.source=this.parseExprAtom(),this.semicolon(),this.finishNode(N,"ExportAllDeclaration")},fe.parseExport=function(N,xe){if(this.next(),this.eat(Oe.star))return this.parseExportAllDeclaration(N,xe);if(this.eat(Oe._default))return this.checkExport(xe,"default",this.lastTokStart),N.declaration=this.parseExportDefaultDeclaration(),this.finishNode(N,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())N.declaration=this.parseExportDeclaration(N),N.declaration.type==="VariableDeclaration"?this.checkVariableExport(xe,N.declaration.declarations):this.checkExport(xe,N.declaration.id,N.declaration.id.start),N.specifiers=[],N.source=null;else{if(N.declaration=null,N.specifiers=this.parseExportSpecifiers(xe),this.eatContextual("from"))this.type!==Oe.string&&this.unexpected(),N.source=this.parseExprAtom();else{for(var rt=0,St=N.specifiers;rt<St.length;rt+=1){var $t=St[rt];this.checkUnreserved($t.local),this.checkLocalExport($t.local),$t.local.type==="Literal"&&this.raise($t.local.start,"A string literal cannot be used as an exported binding without `from`.")}N.source=null}this.semicolon()}return this.finishNode(N,"ExportNamedDeclaration")},fe.parseExportDeclaration=function(N){return this.parseStatement(null)},fe.parseExportDefaultDeclaration=function(){var N;if(this.type===Oe._function||(N=this.isAsyncFunction())){var xe=this.startNode();return this.next(),N&&this.next(),this.parseFunction(xe,ze|He,!1,N)}else if(this.type===Oe._class){var rt=this.startNode();return this.parseClass(rt,"nullableID")}else{var St=this.parseMaybeAssign();return this.semicolon(),St}},fe.checkExport=function(N,xe,rt){N&&(typeof xe!="string"&&(xe=xe.type==="Identifier"?xe.name:xe.value),lt(N,xe)&&this.raiseRecoverable(rt,"Duplicate export '"+xe+"'"),N[xe]=!0)},fe.checkPatternExport=function(N,xe){var rt=xe.type;if(rt==="Identifier")this.checkExport(N,xe,xe.start);else if(rt==="ObjectPattern")for(var St=0,$t=xe.properties;St<$t.length;St+=1){var Ii=$t[St];this.checkPatternExport(N,Ii)}else if(rt==="ArrayPattern")for(var Li=0,An=xe.elements;Li<An.length;Li+=1){var pn=An[Li];pn&&this.checkPatternExport(N,pn)}else rt==="Property"?this.checkPatternExport(N,xe.value):rt==="AssignmentPattern"?this.checkPatternExport(N,xe.left):rt==="RestElement"&&this.checkPatternExport(N,xe.argument)},fe.checkVariableExport=function(N,xe){if(N)for(var rt=0,St=xe;rt<St.length;rt+=1){var $t=St[rt];this.checkPatternExport(N,$t.id)}},fe.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},fe.parseExportSpecifier=function(N){var xe=this.startNode();return xe.local=this.parseModuleExportName(),xe.exported=this.eatContextual("as")?this.parseModuleExportName():xe.local,this.checkExport(N,xe.exported,xe.exported.start),this.finishNode(xe,"ExportSpecifier")},fe.parseExportSpecifiers=function(N){var xe=[],rt=!0;for(this.expect(Oe.braceL);!this.eat(Oe.braceR);){if(rt)rt=!1;else if(this.expect(Oe.comma),this.afterTrailingComma(Oe.braceR))break;xe.push(this.parseExportSpecifier(N))}return xe},fe.parseImport=function(N){return this.next(),this.type===Oe.string?(N.specifiers=Ee,N.source=this.parseExprAtom()):(N.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),N.source=this.type===Oe.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(N,"ImportDeclaration")},fe.parseImportSpecifier=function(){var N=this.startNode();return N.imported=this.parseModuleExportName(),this.eatContextual("as")?N.local=this.parseIdent():(this.checkUnreserved(N.imported),N.local=N.imported),this.checkLValSimple(N.local,tr),this.finishNode(N,"ImportSpecifier")},fe.parseImportDefaultSpecifier=function(){var N=this.startNode();return N.local=this.parseIdent(),this.checkLValSimple(N.local,tr),this.finishNode(N,"ImportDefaultSpecifier")},fe.parseImportNamespaceSpecifier=function(){var N=this.startNode();return this.next(),this.expectContextual("as"),N.local=this.parseIdent(),this.checkLValSimple(N.local,tr),this.finishNode(N,"ImportNamespaceSpecifier")},fe.parseImportSpecifiers=function(){var N=[],xe=!0;if(this.type===Oe.name&&(N.push(this.parseImportDefaultSpecifier()),!this.eat(Oe.comma)))return N;if(this.type===Oe.star)return N.push(this.parseImportNamespaceSpecifier()),N;for(this.expect(Oe.braceL);!this.eat(Oe.braceR);){if(xe)xe=!1;else if(this.expect(Oe.comma),this.afterTrailingComma(Oe.braceR))break;N.push(this.parseImportSpecifier())}return N},fe.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===Oe.string){var N=this.parseLiteral(this.value);return wi.test(N.value)&&this.raise(N.start,"An export name cannot include a lone surrogate."),N}return this.parseIdent(!0)},fe.adaptDirectivePrologue=function(N){for(var xe=0;xe<N.length&&this.isDirectiveCandidate(N[xe]);++xe)N[xe].directive=N[xe].expression.raw.slice(1,-1)},fe.isDirectiveCandidate=function(N){return this.options.ecmaVersion>=5&&N.type==="ExpressionStatement"&&N.expression.type==="Literal"&&typeof N.expression.value=="string"&&(this.input[N.start]==='"'||this.input[N.start]==="'")};var ft=v.prototype;ft.toAssignable=function(N,xe,rt){if(this.options.ecmaVersion>=6&&N)switch(N.type){case"Identifier":this.inAsync&&N.name==="await"&&this.raise(N.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":N.type="ObjectPattern",rt&&this.checkPatternErrors(rt,!0);for(var St=0,$t=N.properties;St<$t.length;St+=1){var Ii=$t[St];this.toAssignable(Ii,xe),Ii.type==="RestElement"&&(Ii.argument.type==="ArrayPattern"||Ii.argument.type==="ObjectPattern")&&this.raise(Ii.argument.start,"Unexpected token")}break;case"Property":N.kind!=="init"&&this.raise(N.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(N.value,xe);break;case"ArrayExpression":N.type="ArrayPattern",rt&&this.checkPatternErrors(rt,!0),this.toAssignableList(N.elements,xe);break;case"SpreadElement":N.type="RestElement",this.toAssignable(N.argument,xe),N.argument.type==="AssignmentPattern"&&this.raise(N.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":N.operator!=="="&&this.raise(N.left.end,"Only '=' operator can be used for specifying default value."),N.type="AssignmentPattern",delete N.operator,this.toAssignable(N.left,xe);break;case"ParenthesizedExpression":this.toAssignable(N.expression,xe,rt);break;case"ChainExpression":this.raiseRecoverable(N.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!xe)break;default:this.raise(N.start,"Assigning to rvalue")}else rt&&this.checkPatternErrors(rt,!0);return N},ft.toAssignableList=function(N,xe){for(var rt=N.length,St=0;St<rt;St++){var $t=N[St];$t&&this.toAssignable($t,xe)}if(rt){var Ii=N[rt-1];this.options.ecmaVersion===6&&xe&&Ii&&Ii.type==="RestElement"&&Ii.argument.type!=="Identifier"&&this.unexpected(Ii.argument.start)}return N},ft.parseSpread=function(N){var xe=this.startNode();return this.next(),xe.argument=this.parseMaybeAssign(!1,N),this.finishNode(xe,"SpreadElement")},ft.parseRestBinding=function(){var N=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==Oe.name&&this.unexpected(),N.argument=this.parseBindingAtom(),this.finishNode(N,"RestElement")},ft.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case Oe.bracketL:var N=this.startNode();return this.next(),N.elements=this.parseBindingList(Oe.bracketR,!0,!0),this.finishNode(N,"ArrayPattern");case Oe.braceL:return this.parseObj(!0)}return this.parseIdent()},ft.parseBindingList=function(N,xe,rt,St){for(var $t=[],Ii=!0;!this.eat(N);)if(Ii?Ii=!1:this.expect(Oe.comma),xe&&this.type===Oe.comma)$t.push(null);else{if(rt&&this.afterTrailingComma(N))break;if(this.type===Oe.ellipsis){var Li=this.parseRestBinding();this.parseBindingListItem(Li),$t.push(Li),this.type===Oe.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(N);break}else $t.push(this.parseAssignableListItem(St))}return $t},ft.parseAssignableListItem=function(N){var xe=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(xe),xe},ft.parseBindingListItem=function(N){return N},ft.parseMaybeDefault=function(N,xe,rt){if(rt=rt||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(Oe.eq))return rt;var St=this.startNodeAt(N,xe);return St.left=rt,St.right=this.parseMaybeAssign(),this.finishNode(St,"AssignmentPattern")},ft.checkLValSimple=function(N,xe,rt){xe===void 0&&(xe=ci);var St=xe!==ci;switch(N.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(N.name)&&this.raiseRecoverable(N.start,(St?"Binding ":"Assigning to ")+N.name+" in strict mode"),St&&(xe===tr&&N.name==="let"&&this.raiseRecoverable(N.start,"let is disallowed as a lexically bound name"),rt&&(lt(rt,N.name)&&this.raiseRecoverable(N.start,"Argument name clash"),rt[N.name]=!0),xe!==In&&this.declareName(N.name,xe,N.start));break;case"ChainExpression":this.raiseRecoverable(N.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":St&&this.raiseRecoverable(N.start,"Binding member expression");break;case"ParenthesizedExpression":return St&&this.raiseRecoverable(N.start,"Binding parenthesized expression"),this.checkLValSimple(N.expression,xe,rt);default:this.raise(N.start,(St?"Binding":"Assigning to")+" rvalue")}},ft.checkLValPattern=function(N,xe,rt){switch(xe===void 0&&(xe=ci),N.type){case"ObjectPattern":for(var St=0,$t=N.properties;St<$t.length;St+=1){var Ii=$t[St];this.checkLValInnerPattern(Ii,xe,rt)}break;case"ArrayPattern":for(var Li=0,An=N.elements;Li<An.length;Li+=1){var pn=An[Li];pn&&this.checkLValInnerPattern(pn,xe,rt)}break;default:this.checkLValSimple(N,xe,rt)}},ft.checkLValInnerPattern=function(N,xe,rt){switch(xe===void 0&&(xe=ci),N.type){case"Property":this.checkLValInnerPattern(N.value,xe,rt);break;case"AssignmentPattern":this.checkLValPattern(N.left,xe,rt);break;case"RestElement":this.checkLValPattern(N.argument,xe,rt);break;default:this.checkLValPattern(N,xe,rt)}};var st=function(xe,rt,St,$t,Ii){this.token=xe,this.isExpr=!!rt,this.preserveSpace=!!St,this.override=$t,this.generator=!!Ii},Me={b_stat:new st("{",!1),b_expr:new st("{",!0),b_tmpl:new st("${",!1),p_stat:new st("(",!1),p_expr:new st("(",!0),q_tmpl:new st("`",!0,!0,function(N){return N.tryReadTemplateToken()}),f_stat:new st("function",!1),f_expr:new st("function",!0),f_expr_gen:new st("function",!0,!1,null,!0),f_gen:new st("function",!1,!1,null,!0)},se=v.prototype;se.initialContext=function(){return[Me.b_stat]},se.curContext=function(){return this.context[this.context.length-1]},se.braceIsBlock=function(N){var xe=this.curContext();return xe===Me.f_expr||xe===Me.f_stat?!0:N===Oe.colon&&(xe===Me.b_stat||xe===Me.b_expr)?!xe.isExpr:N===Oe._return||N===Oe.name&&this.exprAllowed?jt.test(this.input.slice(this.lastTokEnd,this.start)):N===Oe._else||N===Oe.semi||N===Oe.eof||N===Oe.parenR||N===Oe.arrow?!0:N===Oe.braceL?xe===Me.b_stat:N===Oe._var||N===Oe._const||N===Oe.name?!1:!this.exprAllowed},se.inGeneratorContext=function(){for(var N=this.context.length-1;N>=1;N--){var xe=this.context[N];if(xe.token==="function")return xe.generator}return!1},se.updateContext=function(N){var xe,rt=this.type;rt.keyword&&N===Oe.dot?this.exprAllowed=!1:(xe=rt.updateContext)?xe.call(this,N):this.exprAllowed=rt.beforeExpr},se.overrideContext=function(N){this.curContext()!==N&&(this.context[this.context.length-1]=N)},Oe.parenR.updateContext=Oe.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var N=this.context.pop();N===Me.b_stat&&this.curContext().token==="function"&&(N=this.context.pop()),this.exprAllowed=!N.isExpr},Oe.braceL.updateContext=function(N){this.context.push(this.braceIsBlock(N)?Me.b_stat:Me.b_expr),this.exprAllowed=!0},Oe.dollarBraceL.updateContext=function(){this.context.push(Me.b_tmpl),this.exprAllowed=!0},Oe.parenL.updateContext=function(N){var xe=N===Oe._if||N===Oe._for||N===Oe._with||N===Oe._while;this.context.push(xe?Me.p_stat:Me.p_expr),this.exprAllowed=!0},Oe.incDec.updateContext=function(){},Oe._function.updateContext=Oe._class.updateContext=function(N){N.beforeExpr&&N!==Oe._else&&!(N===Oe.semi&&this.curContext()!==Me.p_stat)&&!(N===Oe._return&&jt.test(this.input.slice(this.lastTokEnd,this.start)))&&!((N===Oe.colon||N===Oe.braceL)&&this.curContext()===Me.b_stat)?this.context.push(Me.f_expr):this.context.push(Me.f_stat),this.exprAllowed=!1},Oe.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0},Oe.backQuote.updateContext=function(){this.curContext()===Me.q_tmpl?this.context.pop():this.context.push(Me.q_tmpl),this.exprAllowed=!1},Oe.star.updateContext=function(N){if(N===Oe._function){var xe=this.context.length-1;this.context[xe]===Me.f_expr?this.context[xe]=Me.f_expr_gen:this.context[xe]=Me.f_gen}this.exprAllowed=!0},Oe.name.updateContext=function(N){var xe=!1;this.options.ecmaVersion>=6&&N!==Oe.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(xe=!0),this.exprAllowed=xe};var ne=v.prototype;ne.checkPropClash=function(N,xe,rt){if(!(this.options.ecmaVersion>=9&&N.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(N.computed||N.method||N.shorthand))){var St=N.key,$t;switch(St.type){case"Identifier":$t=St.name;break;case"Literal":$t=String(St.value);break;default:return}var Ii=N.kind;if(this.options.ecmaVersion>=6){$t==="__proto__"&&Ii==="init"&&(xe.proto&&(rt?rt.doubleProto<0&&(rt.doubleProto=St.start):this.raiseRecoverable(St.start,"Redefinition of __proto__ property")),xe.proto=!0);return}$t="$"+$t;var Li=xe[$t];if(Li){var An;Ii==="init"?An=this.strict&&Li.init||Li.get||Li.set:An=Li.init||Li[Ii],An&&this.raiseRecoverable(St.start,"Redefinition of property")}else Li=xe[$t]={init:!1,get:!1,set:!1};Li[Ii]=!0}},ne.parseExpression=function(N,xe){var rt=this.start,St=this.startLoc,$t=this.parseMaybeAssign(N,xe);if(this.type===Oe.comma){var Ii=this.startNodeAt(rt,St);for(Ii.expressions=[$t];this.eat(Oe.comma);)Ii.expressions.push(this.parseMaybeAssign(N,xe));return this.finishNode(Ii,"SequenceExpression")}return $t},ne.parseMaybeAssign=function(N,xe,rt){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(N);this.exprAllowed=!1}var St=!1,$t=-1,Ii=-1,Li=-1;xe?($t=xe.parenthesizedAssign,Ii=xe.trailingComma,Li=xe.doubleProto,xe.parenthesizedAssign=xe.trailingComma=-1):(xe=new te,St=!0);var An=this.start,pn=this.startLoc;(this.type===Oe.parenL||this.type===Oe.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=N==="await");var sr=this.parseMaybeConditional(N,xe);if(rt&&(sr=rt.call(this,sr,An,pn)),this.type.isAssign){var Ar=this.startNodeAt(An,pn);return Ar.operator=this.value,this.type===Oe.eq&&(sr=this.toAssignable(sr,!1,xe)),St||(xe.parenthesizedAssign=xe.trailingComma=xe.doubleProto=-1),xe.shorthandAssign>=sr.start&&(xe.shorthandAssign=-1),this.type===Oe.eq?this.checkLValPattern(sr):this.checkLValSimple(sr),Ar.left=sr,this.next(),Ar.right=this.parseMaybeAssign(N),Li>-1&&(xe.doubleProto=Li),this.finishNode(Ar,"AssignmentExpression")}else St&&this.checkExpressionErrors(xe,!0);return $t>-1&&(xe.parenthesizedAssign=$t),Ii>-1&&(xe.trailingComma=Ii),sr},ne.parseMaybeConditional=function(N,xe){var rt=this.start,St=this.startLoc,$t=this.parseExprOps(N,xe);if(this.checkExpressionErrors(xe))return $t;if(this.eat(Oe.question)){var Ii=this.startNodeAt(rt,St);return Ii.test=$t,Ii.consequent=this.parseMaybeAssign(),this.expect(Oe.colon),Ii.alternate=this.parseMaybeAssign(N),this.finishNode(Ii,"ConditionalExpression")}return $t},ne.parseExprOps=function(N,xe){var rt=this.start,St=this.startLoc,$t=this.parseMaybeUnary(xe,!1,!1,N);return this.checkExpressionErrors(xe)||$t.start===rt&&$t.type==="ArrowFunctionExpression"?$t:this.parseExprOp($t,rt,St,-1,N)},ne.parseExprOp=function(N,xe,rt,St,$t){var Ii=this.type.binop;if(Ii!=null&&(!$t||this.type!==Oe._in)&&Ii>St){var Li=this.type===Oe.logicalOR||this.type===Oe.logicalAND,An=this.type===Oe.coalesce;An&&(Ii=Oe.logicalAND.binop);var pn=this.value;this.next();var sr=this.start,Ar=this.startLoc,Or=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,$t),sr,Ar,Ii,$t),qa=this.buildBinary(xe,rt,N,Or,pn,Li||An);return(Li&&this.type===Oe.coalesce||An&&(this.type===Oe.logicalOR||this.type===Oe.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(qa,xe,rt,St,$t)}return N},ne.buildBinary=function(N,xe,rt,St,$t,Ii){St.type==="PrivateIdentifier"&&this.raise(St.start,"Private identifier can only be left side of binary expression");var Li=this.startNodeAt(N,xe);return Li.left=rt,Li.operator=$t,Li.right=St,this.finishNode(Li,Ii?"LogicalExpression":"BinaryExpression")},ne.parseMaybeUnary=function(N,xe,rt,St){var $t=this.start,Ii=this.startLoc,Li;if(this.isContextual("await")&&this.canAwait)Li=this.parseAwait(St),xe=!0;else if(this.type.prefix){var An=this.startNode(),pn=this.type===Oe.incDec;An.operator=this.value,An.prefix=!0,this.next(),An.argument=this.parseMaybeUnary(null,!0,pn,St),this.checkExpressionErrors(N,!0),pn?this.checkLValSimple(An.argument):this.strict&&An.operator==="delete"&&An.argument.type==="Identifier"?this.raiseRecoverable(An.start,"Deleting local variable in strict mode"):An.operator==="delete"&&$(An.argument)?this.raiseRecoverable(An.start,"Private fields can not be deleted"):xe=!0,Li=this.finishNode(An,pn?"UpdateExpression":"UnaryExpression")}else if(!xe&&this.type===Oe.privateId)(St||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),Li=this.parsePrivateIdent(),this.type!==Oe._in&&this.unexpected();else{if(Li=this.parseExprSubscripts(N,St),this.checkExpressionErrors(N))return Li;for(;this.type.postfix&&!this.canInsertSemicolon();){var sr=this.startNodeAt($t,Ii);sr.operator=this.value,sr.prefix=!1,sr.argument=Li,this.checkLValSimple(Li),this.next(),Li=this.finishNode(sr,"UpdateExpression")}}if(!rt&&this.eat(Oe.starstar))if(xe)this.unexpected(this.lastTokStart);else return this.buildBinary($t,Ii,Li,this.parseMaybeUnary(null,!1,!1,St),"**",!1);else return Li};function $(N){return N.type==="MemberExpression"&&N.property.type==="PrivateIdentifier"||N.type==="ChainExpression"&&$(N.expression)}ne.parseExprSubscripts=function(N,xe){var rt=this.start,St=this.startLoc,$t=this.parseExprAtom(N,xe);if($t.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return $t;var Ii=this.parseSubscripts($t,rt,St,!1,xe);return N&&Ii.type==="MemberExpression"&&(N.parenthesizedAssign>=Ii.start&&(N.parenthesizedAssign=-1),N.parenthesizedBind>=Ii.start&&(N.parenthesizedBind=-1),N.trailingComma>=Ii.start&&(N.trailingComma=-1)),Ii},ne.parseSubscripts=function(N,xe,rt,St,$t){for(var Ii=this.options.ecmaVersion>=8&&N.type==="Identifier"&&N.name==="async"&&this.lastTokEnd===N.end&&!this.canInsertSemicolon()&&N.end-N.start===5&&this.potentialArrowAt===N.start,Li=!1;;){var An=this.parseSubscript(N,xe,rt,St,Ii,Li,$t);if(An.optional&&(Li=!0),An===N||An.type==="ArrowFunctionExpression"){if(Li){var pn=this.startNodeAt(xe,rt);pn.expression=An,An=this.finishNode(pn,"ChainExpression")}return An}N=An}},ne.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(Oe.arrow)},ne.parseSubscriptAsyncArrow=function(N,xe,rt,St){return this.parseArrowExpression(this.startNodeAt(N,xe),rt,!0,St)},ne.parseSubscript=function(N,xe,rt,St,$t,Ii,Li){var An=this.options.ecmaVersion>=11,pn=An&&this.eat(Oe.questionDot);St&&pn&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var sr=this.eat(Oe.bracketL);if(sr||pn&&this.type!==Oe.parenL&&this.type!==Oe.backQuote||this.eat(Oe.dot)){var Ar=this.startNodeAt(xe,rt);Ar.object=N,sr?(Ar.property=this.parseExpression(),this.expect(Oe.bracketR)):this.type===Oe.privateId&&N.type!=="Super"?Ar.property=this.parsePrivateIdent():Ar.property=this.parseIdent(this.options.allowReserved!=="never"),Ar.computed=!!sr,An&&(Ar.optional=pn),N=this.finishNode(Ar,"MemberExpression")}else if(!St&&this.eat(Oe.parenL)){var Or=new te,qa=this.yieldPos,Ha=this.awaitPos,ja=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var pl=this.parseExprList(Oe.parenR,this.options.ecmaVersion>=8,!1,Or);if($t&&!pn&&this.shouldParseAsyncArrow())return this.checkPatternErrors(Or,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=qa,this.awaitPos=Ha,this.awaitIdentPos=ja,this.parseSubscriptAsyncArrow(xe,rt,pl,Li);this.checkExpressionErrors(Or,!0),this.yieldPos=qa||this.yieldPos,this.awaitPos=Ha||this.awaitPos,this.awaitIdentPos=ja||this.awaitIdentPos;var Gr=this.startNodeAt(xe,rt);Gr.callee=N,Gr.arguments=pl,An&&(Gr.optional=pn),N=this.finishNode(Gr,"CallExpression")}else if(this.type===Oe.backQuote){(pn||Ii)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var nr=this.startNodeAt(xe,rt);nr.tag=N,nr.quasi=this.parseTemplate({isTagged:!0}),N=this.finishNode(nr,"TaggedTemplateExpression")}return N},ne.parseExprAtom=function(N,xe,rt){this.type===Oe.slash&&this.readRegexp();var St,$t=this.potentialArrowAt===this.start;switch(this.type){case Oe._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),St=this.startNode(),this.next(),this.type===Oe.parenL&&!this.allowDirectSuper&&this.raise(St.start,"super() call outside constructor of a subclass"),this.type!==Oe.dot&&this.type!==Oe.bracketL&&this.type!==Oe.parenL&&this.unexpected(),this.finishNode(St,"Super");case Oe._this:return St=this.startNode(),this.next(),this.finishNode(St,"ThisExpression");case Oe.name:var Ii=this.start,Li=this.startLoc,An=this.containsEsc,pn=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!An&&pn.name==="async"&&!this.canInsertSemicolon()&&this.eat(Oe._function))return this.overrideContext(Me.f_expr),this.parseFunction(this.startNodeAt(Ii,Li),0,!1,!0,xe);if($t&&!this.canInsertSemicolon()){if(this.eat(Oe.arrow))return this.parseArrowExpression(this.startNodeAt(Ii,Li),[pn],!1,xe);if(this.options.ecmaVersion>=8&&pn.name==="async"&&this.type===Oe.name&&!An&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return pn=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(Oe.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(Ii,Li),[pn],!0,xe)}return pn;case Oe.regexp:var sr=this.value;return St=this.parseLiteral(sr.value),St.regex={pattern:sr.pattern,flags:sr.flags},St;case Oe.num:case Oe.string:return this.parseLiteral(this.value);case Oe._null:case Oe._true:case Oe._false:return St=this.startNode(),St.value=this.type===Oe._null?null:this.type===Oe._true,St.raw=this.type.keyword,this.next(),this.finishNode(St,"Literal");case Oe.parenL:var Ar=this.start,Or=this.parseParenAndDistinguishExpression($t,xe);return N&&(N.parenthesizedAssign<0&&!this.isSimpleAssignTarget(Or)&&(N.parenthesizedAssign=Ar),N.parenthesizedBind<0&&(N.parenthesizedBind=Ar)),Or;case Oe.bracketL:return St=this.startNode(),this.next(),St.elements=this.parseExprList(Oe.bracketR,!0,!0,N),this.finishNode(St,"ArrayExpression");case Oe.braceL:return this.overrideContext(Me.b_expr),this.parseObj(!1,N);case Oe._function:return St=this.startNode(),this.next(),this.parseFunction(St,0);case Oe._class:return this.parseClass(this.startNode(),!1);case Oe._new:return this.parseNew();case Oe.backQuote:return this.parseTemplate();case Oe._import:return this.options.ecmaVersion>=11?this.parseExprImport(rt):this.unexpected();default:return this.parseExprAtomDefault()}},ne.parseExprAtomDefault=function(){this.unexpected()},ne.parseExprImport=function(N){var xe=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===Oe.parenL&&!N)return this.parseDynamicImport(xe);if(this.type===Oe.dot){var rt=this.startNodeAt(xe.start,xe.loc&&xe.loc.start);return rt.name="import",xe.meta=this.finishNode(rt,"Identifier"),this.parseImportMeta(xe)}else this.unexpected()},ne.parseDynamicImport=function(N){if(this.next(),N.source=this.parseMaybeAssign(),!this.eat(Oe.parenR)){var xe=this.start;this.eat(Oe.comma)&&this.eat(Oe.parenR)?this.raiseRecoverable(xe,"Trailing comma is not allowed in import()"):this.unexpected(xe)}return this.finishNode(N,"ImportExpression")},ne.parseImportMeta=function(N){this.next();var xe=this.containsEsc;return N.property=this.parseIdent(!0),N.property.name!=="meta"&&this.raiseRecoverable(N.property.start,"The only valid meta property for import is 'import.meta'"),xe&&this.raiseRecoverable(N.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(N.start,"Cannot use 'import.meta' outside a module"),this.finishNode(N,"MetaProperty")},ne.parseLiteral=function(N){var xe=this.startNode();return xe.value=N,xe.raw=this.input.slice(this.start,this.end),xe.raw.charCodeAt(xe.raw.length-1)===110&&(xe.bigint=xe.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(xe,"Literal")},ne.parseParenExpression=function(){this.expect(Oe.parenL);var N=this.parseExpression();return this.expect(Oe.parenR),N},ne.shouldParseArrow=function(N){return!this.canInsertSemicolon()},ne.parseParenAndDistinguishExpression=function(N,xe){var rt=this.start,St=this.startLoc,$t,Ii=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var Li=this.start,An=this.startLoc,pn=[],sr=!0,Ar=!1,Or=new te,qa=this.yieldPos,Ha=this.awaitPos,ja;for(this.yieldPos=0,this.awaitPos=0;this.type!==Oe.parenR;)if(sr?sr=!1:this.expect(Oe.comma),Ii&&this.afterTrailingComma(Oe.parenR,!0)){Ar=!0;break}else if(this.type===Oe.ellipsis){ja=this.start,pn.push(this.parseParenItem(this.parseRestBinding())),this.type===Oe.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else pn.push(this.parseMaybeAssign(!1,Or,this.parseParenItem));var pl=this.lastTokEnd,Gr=this.lastTokEndLoc;if(this.expect(Oe.parenR),N&&this.shouldParseArrow(pn)&&this.eat(Oe.arrow))return this.checkPatternErrors(Or,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=qa,this.awaitPos=Ha,this.parseParenArrowList(rt,St,pn,xe);(!pn.length||Ar)&&this.unexpected(this.lastTokStart),ja&&this.unexpected(ja),this.checkExpressionErrors(Or,!0),this.yieldPos=qa||this.yieldPos,this.awaitPos=Ha||this.awaitPos,pn.length>1?($t=this.startNodeAt(Li,An),$t.expressions=pn,this.finishNodeAt($t,"SequenceExpression",pl,Gr)):$t=pn[0]}else $t=this.parseParenExpression();if(this.options.preserveParens){var nr=this.startNodeAt(rt,St);return nr.expression=$t,this.finishNode(nr,"ParenthesizedExpression")}else return $t},ne.parseParenItem=function(N){return N},ne.parseParenArrowList=function(N,xe,rt,St){return this.parseArrowExpression(this.startNodeAt(N,xe),rt,!1,St)};var ie=[];ne.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var N=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===Oe.dot){var xe=this.startNodeAt(N.start,N.loc&&N.loc.start);xe.name="new",N.meta=this.finishNode(xe,"Identifier"),this.next();var rt=this.containsEsc;return N.property=this.parseIdent(!0),N.property.name!=="target"&&this.raiseRecoverable(N.property.start,"The only valid meta property for new is 'new.target'"),rt&&this.raiseRecoverable(N.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(N.start,"'new.target' can only be used in functions and class static block"),this.finishNode(N,"MetaProperty")}var St=this.start,$t=this.startLoc;return N.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),St,$t,!0,!1),this.eat(Oe.parenL)?N.arguments=this.parseExprList(Oe.parenR,this.options.ecmaVersion>=8,!1):N.arguments=ie,this.finishNode(N,"NewExpression")},ne.parseTemplateElement=function(N){var xe=N.isTagged,rt=this.startNode();return this.type===Oe.invalidTemplate?(xe||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),rt.value={raw:this.value,cooked:null}):rt.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),rt.tail=this.type===Oe.backQuote,this.finishNode(rt,"TemplateElement")},ne.parseTemplate=function(N){N===void 0&&(N={});var xe=N.isTagged;xe===void 0&&(xe=!1);var rt=this.startNode();this.next(),rt.expressions=[];var St=this.parseTemplateElement({isTagged:xe});for(rt.quasis=[St];!St.tail;)this.type===Oe.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(Oe.dollarBraceL),rt.expressions.push(this.parseExpression()),this.expect(Oe.braceR),rt.quasis.push(St=this.parseTemplateElement({isTagged:xe}));return this.next(),this.finishNode(rt,"TemplateLiteral")},ne.isAsyncProp=function(N){return!N.computed&&N.key.type==="Identifier"&&N.key.name==="async"&&(this.type===Oe.name||this.type===Oe.num||this.type===Oe.string||this.type===Oe.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===Oe.star)&&!jt.test(this.input.slice(this.lastTokEnd,this.start))},ne.parseObj=function(N,xe){var rt=this.startNode(),St=!0,$t={};for(rt.properties=[],this.next();!this.eat(Oe.braceR);){if(St)St=!1;else if(this.expect(Oe.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(Oe.braceR))break;var Ii=this.parseProperty(N,xe);N||this.checkPropClash(Ii,$t,xe),rt.properties.push(Ii)}return this.finishNode(rt,N?"ObjectPattern":"ObjectExpression")},ne.parseProperty=function(N,xe){var rt=this.startNode(),St,$t,Ii,Li;if(this.options.ecmaVersion>=9&&this.eat(Oe.ellipsis))return N?(rt.argument=this.parseIdent(!1),this.type===Oe.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(rt,"RestElement")):(rt.argument=this.parseMaybeAssign(!1,xe),this.type===Oe.comma&&xe&&xe.trailingComma<0&&(xe.trailingComma=this.start),this.finishNode(rt,"SpreadElement"));this.options.ecmaVersion>=6&&(rt.method=!1,rt.shorthand=!1,(N||xe)&&(Ii=this.start,Li=this.startLoc),N||(St=this.eat(Oe.star)));var An=this.containsEsc;return this.parsePropertyName(rt),!N&&!An&&this.options.ecmaVersion>=8&&!St&&this.isAsyncProp(rt)?($t=!0,St=this.options.ecmaVersion>=9&&this.eat(Oe.star),this.parsePropertyName(rt)):$t=!1,this.parsePropertyValue(rt,N,St,$t,Ii,Li,xe,An),this.finishNode(rt,"Property")},ne.parseGetterSetter=function(N){N.kind=N.key.name,this.parsePropertyName(N),N.value=this.parseMethod(!1);var xe=N.kind==="get"?0:1;if(N.value.params.length!==xe){var rt=N.value.start;N.kind==="get"?this.raiseRecoverable(rt,"getter should have no params"):this.raiseRecoverable(rt,"setter should have exactly one param")}else N.kind==="set"&&N.value.params[0].type==="RestElement"&&this.raiseRecoverable(N.value.params[0].start,"Setter cannot use rest params")},ne.parsePropertyValue=function(N,xe,rt,St,$t,Ii,Li,An){(rt||St)&&this.type===Oe.colon&&this.unexpected(),this.eat(Oe.colon)?(N.value=xe?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,Li),N.kind="init"):this.options.ecmaVersion>=6&&this.type===Oe.parenL?(xe&&this.unexpected(),N.kind="init",N.method=!0,N.value=this.parseMethod(rt,St)):!xe&&!An&&this.options.ecmaVersion>=5&&!N.computed&&N.key.type==="Identifier"&&(N.key.name==="get"||N.key.name==="set")&&this.type!==Oe.comma&&this.type!==Oe.braceR&&this.type!==Oe.eq?((rt||St)&&this.unexpected(),this.parseGetterSetter(N)):this.options.ecmaVersion>=6&&!N.computed&&N.key.type==="Identifier"?((rt||St)&&this.unexpected(),this.checkUnreserved(N.key),N.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=$t),N.kind="init",xe?N.value=this.parseMaybeDefault($t,Ii,this.copyNode(N.key)):this.type===Oe.eq&&Li?(Li.shorthandAssign<0&&(Li.shorthandAssign=this.start),N.value=this.parseMaybeDefault($t,Ii,this.copyNode(N.key))):N.value=this.copyNode(N.key),N.shorthand=!0):this.unexpected()},ne.parsePropertyName=function(N){if(this.options.ecmaVersion>=6){if(this.eat(Oe.bracketL))return N.computed=!0,N.key=this.parseMaybeAssign(),this.expect(Oe.bracketR),N.key;N.computed=!1}return N.key=this.type===Oe.num||this.type===Oe.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},ne.initFunction=function(N){N.id=null,this.options.ecmaVersion>=6&&(N.generator=N.expression=!1),this.options.ecmaVersion>=8&&(N.async=!1)},ne.parseMethod=function(N,xe,rt){var St=this.startNode(),$t=this.yieldPos,Ii=this.awaitPos,Li=this.awaitIdentPos;return this.initFunction(St),this.options.ecmaVersion>=6&&(St.generator=N),this.options.ecmaVersion>=8&&(St.async=!!xe),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Pr(xe,St.generator)|Ai|(rt?sn:0)),this.expect(Oe.parenL),St.params=this.parseBindingList(Oe.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(St,!1,!0,!1),this.yieldPos=$t,this.awaitPos=Ii,this.awaitIdentPos=Li,this.finishNode(St,"FunctionExpression")},ne.parseArrowExpression=function(N,xe,rt,St){var $t=this.yieldPos,Ii=this.awaitPos,Li=this.awaitIdentPos;return this.enterScope(Pr(rt,!1)|_i),this.initFunction(N),this.options.ecmaVersion>=8&&(N.async=!!rt),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,N.params=this.toAssignableList(xe,!0),this.parseFunctionBody(N,!0,!1,St),this.yieldPos=$t,this.awaitPos=Ii,this.awaitIdentPos=Li,this.finishNode(N,"ArrowFunctionExpression")},ne.parseFunctionBody=function(N,xe,rt,St){var $t=xe&&this.type!==Oe.braceL,Ii=this.strict,Li=!1;if($t)N.body=this.parseMaybeAssign(St),N.expression=!0,this.checkParams(N,!1);else{var An=this.options.ecmaVersion>=7&&!this.isSimpleParamList(N.params);(!Ii||An)&&(Li=this.strictDirective(this.end),Li&&An&&this.raiseRecoverable(N.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var pn=this.labels;this.labels=[],Li&&(this.strict=!0),this.checkParams(N,!Ii&&!Li&&!xe&&!rt&&this.isSimpleParamList(N.params)),this.strict&&N.id&&this.checkLValSimple(N.id,In),N.body=this.parseBlock(!1,void 0,Li&&!Ii),N.expression=!1,this.adaptDirectivePrologue(N.body.body),this.labels=pn}this.exitScope()},ne.isSimpleParamList=function(N){for(var xe=0,rt=N;xe<rt.length;xe+=1){var St=rt[xe];if(St.type!=="Identifier")return!1}return!0},ne.checkParams=function(N,xe){for(var rt=Object.create(null),St=0,$t=N.params;St<$t.length;St+=1){var Ii=$t[St];this.checkLValInnerPattern(Ii,rn,xe?null:rt)}},ne.parseExprList=function(N,xe,rt,St){for(var $t=[],Ii=!0;!this.eat(N);){if(Ii)Ii=!1;else if(this.expect(Oe.comma),xe&&this.afterTrailingComma(N))break;var Li=void 0;rt&&this.type===Oe.comma?Li=null:this.type===Oe.ellipsis?(Li=this.parseSpread(St),St&&this.type===Oe.comma&&St.trailingComma<0&&(St.trailingComma=this.start)):Li=this.parseMaybeAssign(!1,St),$t.push(Li)}return $t},ne.checkUnreserved=function(N){var xe=N.start,rt=N.end,St=N.name;if(this.inGenerator&&St==="yield"&&this.raiseRecoverable(xe,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&St==="await"&&this.raiseRecoverable(xe,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().inClassFieldInit&&St==="arguments"&&this.raiseRecoverable(xe,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(St==="arguments"||St==="await")&&this.raise(xe,"Cannot use "+St+" in class static initialization block"),this.keywords.test(St)&&this.raise(xe,"Unexpected keyword '"+St+"'"),!(this.options.ecmaVersion<6&&this.input.slice(xe,rt).indexOf("\\")!==-1)){var $t=this.strict?this.reservedWordsStrict:this.reservedWords;$t.test(St)&&(!this.inAsync&&St==="await"&&this.raiseRecoverable(xe,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(xe,"The keyword '"+St+"' is reserved"))}},ne.parseIdent=function(N){var xe=this.parseIdentNode();return this.next(!!N),this.finishNode(xe,"Identifier"),N||(this.checkUnreserved(xe),xe.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=xe.start)),xe},ne.parseIdentNode=function(){var N=this.startNode();return this.type===Oe.name?N.name=this.value:this.type.keyword?(N.name=this.type.keyword,(N.name==="class"||N.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=Oe.name):this.unexpected(),N},ne.parsePrivateIdent=function(){var N=this.startNode();return this.type===Oe.privateId?N.name=this.value:this.unexpected(),this.next(),this.finishNode(N,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(N.start,"Private field '#"+N.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(N)),N},ne.parseYield=function(N){this.yieldPos||(this.yieldPos=this.start);var xe=this.startNode();return this.next(),this.type===Oe.semi||this.canInsertSemicolon()||this.type!==Oe.star&&!this.type.startsExpr?(xe.delegate=!1,xe.argument=null):(xe.delegate=this.eat(Oe.star),xe.argument=this.parseMaybeAssign(N)),this.finishNode(xe,"YieldExpression")},ne.parseAwait=function(N){this.awaitPos||(this.awaitPos=this.start);var xe=this.startNode();return this.next(),xe.argument=this.parseMaybeUnary(null,!0,!1,N),this.finishNode(xe,"AwaitExpression")};var de=v.prototype;de.raise=function(N,xe){var rt=en(this.input,N);xe+=" ("+rt.line+":"+rt.column+")";var St=new SyntaxError(xe);throw St.pos=N,St.loc=rt,St.raisedAt=this.pos,St},de.raiseRecoverable=de.raise,de.curPosition=function(){if(this.options.locations)return new Ti(this.curLine,this.pos-this.lineStart)};var ye=v.prototype,ge=function(xe){this.flags=xe,this.var=[],this.lexical=[],this.functions=[],this.inClassFieldInit=!1};ye.enterScope=function(N){this.scopeStack.push(new ge(N))},ye.exitScope=function(){this.scopeStack.pop()},ye.treatFunctionsAsVarInScope=function(N){return N.flags&mi||!this.inModule&&N.flags&Ci},ye.declareName=function(N,xe,rt){var St=!1;if(xe===tr){var $t=this.currentScope();St=$t.lexical.indexOf(N)>-1||$t.functions.indexOf(N)>-1||$t.var.indexOf(N)>-1,$t.lexical.push(N),this.inModule&&$t.flags&Ci&&delete this.undefinedExports[N]}else if(xe===Qn){var Ii=this.currentScope();Ii.lexical.push(N)}else if(xe===Pn){var Li=this.currentScope();this.treatFunctionsAsVar?St=Li.lexical.indexOf(N)>-1:St=Li.lexical.indexOf(N)>-1||Li.var.indexOf(N)>-1,Li.functions.push(N)}else for(var An=this.scopeStack.length-1;An>=0;--An){var pn=this.scopeStack[An];if(pn.lexical.indexOf(N)>-1&&!(pn.flags&Ji&&pn.lexical[0]===N)||!this.treatFunctionsAsVarInScope(pn)&&pn.functions.indexOf(N)>-1){St=!0;break}if(pn.var.push(N),this.inModule&&pn.flags&Ci&&delete this.undefinedExports[N],pn.flags&_n)break}St&&this.raiseRecoverable(rt,"Identifier '"+N+"' has already been declared")},ye.checkLocalExport=function(N){this.scopeStack[0].lexical.indexOf(N.name)===-1&&this.scopeStack[0].var.indexOf(N.name)===-1&&(this.undefinedExports[N.name]=N)},ye.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},ye.currentVarScope=function(){for(var N=this.scopeStack.length-1;;N--){var xe=this.scopeStack[N];if(xe.flags&_n)return xe}},ye.currentThisScope=function(){for(var N=this.scopeStack.length-1;;N--){var xe=this.scopeStack[N];if(xe.flags&_n&&!(xe.flags&_i))return xe}};var Pe=function(xe,rt,St){this.type="",this.start=rt,this.end=0,xe.options.locations&&(this.loc=new Ni(xe,St)),xe.options.directSourceFile&&(this.sourceFile=xe.options.directSourceFile),xe.options.ranges&&(this.range=[rt,0])},Fe=v.prototype;Fe.startNode=function(){return new Pe(this,this.start,this.startLoc)},Fe.startNodeAt=function(N,xe){return new Pe(this,N,xe)};function Ve(N,xe,rt,St){return N.type=xe,N.end=rt,this.options.locations&&(N.loc.end=St),this.options.ranges&&(N.range[1]=rt),N}Fe.finishNode=function(N,xe){return Ve.call(this,N,xe,this.lastTokEnd,this.lastTokEndLoc)},Fe.finishNodeAt=function(N,xe,rt,St){return Ve.call(this,N,xe,rt,St)},Fe.copyNode=function(N){var xe=new Pe(this,N.start,this.startLoc);for(var rt in N)xe[rt]=N[rt];return xe};var Xe="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",Ye=Xe+" Extended_Pictographic",De=Ye,Ge=De+" EBase EComp EMod EPres ExtPict",ht=Ge,kt=ht,o={9:Xe,10:Ye,11:De,12:Ge,13:ht,14:kt},ke="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",ai={9:"",10:"",11:"",12:"",13:"",14:ke},fi="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",hi="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",Jt=hi+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",oi=Jt+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",zi=oi+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",xi=zi+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",Si=xi+" Hrkt Katakana_Or_Hiragana Kawi Nag_Mundari Nagm Unknown Zzzz",Yt={9:hi,10:Jt,11:oi,12:zi,13:xi,14:Si},bn={};function or(N){var xe=bn[N]={binary:Ot(o[N]+" "+fi),binaryOfStrings:Ot(ai[N]),nonBinary:{General_Category:Ot(fi),Script:Ot(Yt[N])}};xe.nonBinary.Script_Extensions=xe.nonBinary.Script,xe.nonBinary.gc=xe.nonBinary.General_Category,xe.nonBinary.sc=xe.nonBinary.Script,xe.nonBinary.scx=xe.nonBinary.Script_Extensions}for(var mn=0,qn=[9,10,11,12,13,14];mn<qn.length;mn+=1){var jr=qn[mn];or(jr)}var Zi=v.prototype,ur=function(xe){this.parser=xe,this.validFlags="gim"+(xe.options.ecmaVersion>=6?"uy":"")+(xe.options.ecmaVersion>=9?"s":"")+(xe.options.ecmaVersion>=13?"d":"")+(xe.options.ecmaVersion>=15?"v":""),this.unicodeProperties=bn[xe.options.ecmaVersion>=14?14:xe.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};ur.prototype.reset=function(xe,rt,St){var $t=St.indexOf("v")!==-1,Ii=St.indexOf("u")!==-1;this.start=xe|0,this.source=rt+"",this.flags=St,$t&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=Ii&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=Ii&&this.parser.options.ecmaVersion>=9)},ur.prototype.raise=function(xe){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+xe)},ur.prototype.at=function(xe,rt){rt===void 0&&(rt=!1);var St=this.source,$t=St.length;if(xe>=$t)return-1;var Ii=St.charCodeAt(xe);if(!(rt||this.switchU)||Ii<=55295||Ii>=57344||xe+1>=$t)return Ii;var Li=St.charCodeAt(xe+1);return Li>=56320&&Li<=57343?(Ii<<10)+Li-56613888:Ii},ur.prototype.nextIndex=function(xe,rt){rt===void 0&&(rt=!1);var St=this.source,$t=St.length;if(xe>=$t)return $t;var Ii=St.charCodeAt(xe),Li;return!(rt||this.switchU)||Ii<=55295||Ii>=57344||xe+1>=$t||(Li=St.charCodeAt(xe+1))<56320||Li>57343?xe+1:xe+2},ur.prototype.current=function(xe){return xe===void 0&&(xe=!1),this.at(this.pos,xe)},ur.prototype.lookahead=function(xe){return xe===void 0&&(xe=!1),this.at(this.nextIndex(this.pos,xe),xe)},ur.prototype.advance=function(xe){xe===void 0&&(xe=!1),this.pos=this.nextIndex(this.pos,xe)},ur.prototype.eat=function(xe,rt){return rt===void 0&&(rt=!1),this.current(rt)===xe?(this.advance(rt),!0):!1},ur.prototype.eatChars=function(xe,rt){rt===void 0&&(rt=!1);for(var St=this.pos,$t=0,Ii=xe;$t<Ii.length;$t+=1){var Li=Ii[$t],An=this.at(St,rt);if(An===-1||An!==Li)return!1;St=this.nextIndex(St,rt)}return this.pos=St,!0},Zi.validateRegExpFlags=function(N){for(var xe=N.validFlags,rt=N.flags,St=!1,$t=!1,Ii=0;Ii<rt.length;Ii++){var Li=rt.charAt(Ii);xe.indexOf(Li)===-1&&this.raise(N.start,"Invalid regular expression flag"),rt.indexOf(Li,Ii+1)>-1&&this.raise(N.start,"Duplicate regular expression flag"),Li==="u"&&(St=!0),Li==="v"&&($t=!0)}this.options.ecmaVersion>=15&&St&&$t&&this.raise(N.start,"Invalid regular expression flag")},Zi.validateRegExpPattern=function(N){this.regexp_pattern(N),!N.switchN&&this.options.ecmaVersion>=9&&N.groupNames.length>0&&(N.switchN=!0,this.regexp_pattern(N))},Zi.regexp_pattern=function(N){N.pos=0,N.lastIntValue=0,N.lastStringValue="",N.lastAssertionIsQuantifiable=!1,N.numCapturingParens=0,N.maxBackReference=0,N.groupNames.length=0,N.backReferenceNames.length=0,this.regexp_disjunction(N),N.pos!==N.source.length&&(N.eat(41)&&N.raise("Unmatched ')'"),(N.eat(93)||N.eat(125))&&N.raise("Lone quantifier brackets")),N.maxBackReference>N.numCapturingParens&&N.raise("Invalid escape");for(var xe=0,rt=N.backReferenceNames;xe<rt.length;xe+=1){var St=rt[xe];N.groupNames.indexOf(St)===-1&&N.raise("Invalid named capture referenced")}},Zi.regexp_disjunction=function(N){for(this.regexp_alternative(N);N.eat(124);)this.regexp_alternative(N);this.regexp_eatQuantifier(N,!0)&&N.raise("Nothing to repeat"),N.eat(123)&&N.raise("Lone quantifier brackets")},Zi.regexp_alternative=function(N){for(;N.pos<N.source.length&&this.regexp_eatTerm(N););},Zi.regexp_eatTerm=function(N){return this.regexp_eatAssertion(N)?(N.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(N)&&N.switchU&&N.raise("Invalid quantifier"),!0):(N.switchU?this.regexp_eatAtom(N):this.regexp_eatExtendedAtom(N))?(this.regexp_eatQuantifier(N),!0):!1},Zi.regexp_eatAssertion=function(N){var xe=N.pos;if(N.lastAssertionIsQuantifiable=!1,N.eat(94)||N.eat(36))return!0;if(N.eat(92)){if(N.eat(66)||N.eat(98))return!0;N.pos=xe}if(N.eat(40)&&N.eat(63)){var rt=!1;if(this.options.ecmaVersion>=9&&(rt=N.eat(60)),N.eat(61)||N.eat(33))return this.regexp_disjunction(N),N.eat(41)||N.raise("Unterminated group"),N.lastAssertionIsQuantifiable=!rt,!0}return N.pos=xe,!1},Zi.regexp_eatQuantifier=function(N,xe){return xe===void 0&&(xe=!1),this.regexp_eatQuantifierPrefix(N,xe)?(N.eat(63),!0):!1},Zi.regexp_eatQuantifierPrefix=function(N,xe){return N.eat(42)||N.eat(43)||N.eat(63)||this.regexp_eatBracedQuantifier(N,xe)},Zi.regexp_eatBracedQuantifier=function(N,xe){var rt=N.pos;if(N.eat(123)){var St=0,$t=-1;if(this.regexp_eatDecimalDigits(N)&&(St=N.lastIntValue,N.eat(44)&&this.regexp_eatDecimalDigits(N)&&($t=N.lastIntValue),N.eat(125)))return $t!==-1&&$t<St&&!xe&&N.raise("numbers out of order in {} quantifier"),!0;N.switchU&&!xe&&N.raise("Incomplete quantifier"),N.pos=rt}return!1},Zi.regexp_eatAtom=function(N){return this.regexp_eatPatternCharacters(N)||N.eat(46)||this.regexp_eatReverseSolidusAtomEscape(N)||this.regexp_eatCharacterClass(N)||this.regexp_eatUncapturingGroup(N)||this.regexp_eatCapturingGroup(N)},Zi.regexp_eatReverseSolidusAtomEscape=function(N){var xe=N.pos;if(N.eat(92)){if(this.regexp_eatAtomEscape(N))return!0;N.pos=xe}return!1},Zi.regexp_eatUncapturingGroup=function(N){var xe=N.pos;if(N.eat(40)){if(N.eat(63)&&N.eat(58)){if(this.regexp_disjunction(N),N.eat(41))return!0;N.raise("Unterminated group")}N.pos=xe}return!1},Zi.regexp_eatCapturingGroup=function(N){if(N.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(N):N.current()===63&&N.raise("Invalid group"),this.regexp_disjunction(N),N.eat(41))return N.numCapturingParens+=1,!0;N.raise("Unterminated group")}return!1},Zi.regexp_eatExtendedAtom=function(N){return N.eat(46)||this.regexp_eatReverseSolidusAtomEscape(N)||this.regexp_eatCharacterClass(N)||this.regexp_eatUncapturingGroup(N)||this.regexp_eatCapturingGroup(N)||this.regexp_eatInvalidBracedQuantifier(N)||this.regexp_eatExtendedPatternCharacter(N)},Zi.regexp_eatInvalidBracedQuantifier=function(N){return this.regexp_eatBracedQuantifier(N,!0)&&N.raise("Nothing to repeat"),!1},Zi.regexp_eatSyntaxCharacter=function(N){var xe=N.current();return Vn(xe)?(N.lastIntValue=xe,N.advance(),!0):!1};function Vn(N){return N===36||N>=40&&N<=43||N===46||N===63||N>=91&&N<=94||N>=123&&N<=125}Zi.regexp_eatPatternCharacters=function(N){for(var xe=N.pos,rt=0;(rt=N.current())!==-1&&!Vn(rt);)N.advance();return N.pos!==xe},Zi.regexp_eatExtendedPatternCharacter=function(N){var xe=N.current();return xe!==-1&&xe!==36&&!(xe>=40&&xe<=43)&&xe!==46&&xe!==63&&xe!==91&&xe!==94&&xe!==124?(N.advance(),!0):!1},Zi.regexp_groupSpecifier=function(N){if(N.eat(63)){if(this.regexp_eatGroupName(N)){N.groupNames.indexOf(N.lastStringValue)!==-1&&N.raise("Duplicate capture group name"),N.groupNames.push(N.lastStringValue);return}N.raise("Invalid group")}},Zi.regexp_eatGroupName=function(N){if(N.lastStringValue="",N.eat(60)){if(this.regexp_eatRegExpIdentifierName(N)&&N.eat(62))return!0;N.raise("Invalid capture group name")}return!1},Zi.regexp_eatRegExpIdentifierName=function(N){if(N.lastStringValue="",this.regexp_eatRegExpIdentifierStart(N)){for(N.lastStringValue+=gi(N.lastIntValue);this.regexp_eatRegExpIdentifierPart(N);)N.lastStringValue+=gi(N.lastIntValue);return!0}return!1},Zi.regexp_eatRegExpIdentifierStart=function(N){var xe=N.pos,rt=this.options.ecmaVersion>=11,St=N.current(rt);return N.advance(rt),St===92&&this.regexp_eatRegExpUnicodeEscapeSequence(N,rt)&&(St=N.lastIntValue),Wt(St)?(N.lastIntValue=St,!0):(N.pos=xe,!1)};function Wt(N){return je(N,!0)||N===36||N===95}Zi.regexp_eatRegExpIdentifierPart=function(N){var xe=N.pos,rt=this.options.ecmaVersion>=11,St=N.current(rt);return N.advance(rt),St===92&&this.regexp_eatRegExpUnicodeEscapeSequence(N,rt)&&(St=N.lastIntValue),Ki(St)?(N.lastIntValue=St,!0):(N.pos=xe,!1)};function Ki(N){return nt(N,!0)||N===36||N===95||N===8204||N===8205}Zi.regexp_eatAtomEscape=function(N){return this.regexp_eatBackReference(N)||this.regexp_eatCharacterClassEscape(N)||this.regexp_eatCharacterEscape(N)||N.switchN&&this.regexp_eatKGroupName(N)?!0:(N.switchU&&(N.current()===99&&N.raise("Invalid unicode escape"),N.raise("Invalid escape")),!1)},Zi.regexp_eatBackReference=function(N){var xe=N.pos;if(this.regexp_eatDecimalEscape(N)){var rt=N.lastIntValue;if(N.switchU)return rt>N.maxBackReference&&(N.maxBackReference=rt),!0;if(rt<=N.numCapturingParens)return!0;N.pos=xe}return!1},Zi.regexp_eatKGroupName=function(N){if(N.eat(107)){if(this.regexp_eatGroupName(N))return N.backReferenceNames.push(N.lastStringValue),!0;N.raise("Invalid named reference")}return!1},Zi.regexp_eatCharacterEscape=function(N){return this.regexp_eatControlEscape(N)||this.regexp_eatCControlLetter(N)||this.regexp_eatZero(N)||this.regexp_eatHexEscapeSequence(N)||this.regexp_eatRegExpUnicodeEscapeSequence(N,!1)||!N.switchU&&this.regexp_eatLegacyOctalEscapeSequence(N)||this.regexp_eatIdentityEscape(N)},Zi.regexp_eatCControlLetter=function(N){var xe=N.pos;if(N.eat(99)){if(this.regexp_eatControlLetter(N))return!0;N.pos=xe}return!1},Zi.regexp_eatZero=function(N){return N.current()===48&&!Dr(N.lookahead())?(N.lastIntValue=0,N.advance(),!0):!1},Zi.regexp_eatControlEscape=function(N){var xe=N.current();return xe===116?(N.lastIntValue=9,N.advance(),!0):xe===110?(N.lastIntValue=10,N.advance(),!0):xe===118?(N.lastIntValue=11,N.advance(),!0):xe===102?(N.lastIntValue=12,N.advance(),!0):xe===114?(N.lastIntValue=13,N.advance(),!0):!1},Zi.regexp_eatControlLetter=function(N){var xe=N.current();return Ut(xe)?(N.lastIntValue=xe%32,N.advance(),!0):!1};function Ut(N){return N>=65&&N<=90||N>=97&&N<=122}Zi.regexp_eatRegExpUnicodeEscapeSequence=function(N,xe){xe===void 0&&(xe=!1);var rt=N.pos,St=xe||N.switchU;if(N.eat(117)){if(this.regexp_eatFixedHexDigits(N,4)){var $t=N.lastIntValue;if(St&&$t>=55296&&$t<=56319){var Ii=N.pos;if(N.eat(92)&&N.eat(117)&&this.regexp_eatFixedHexDigits(N,4)){var Li=N.lastIntValue;if(Li>=56320&&Li<=57343)return N.lastIntValue=($t-55296)*1024+(Li-56320)+65536,!0}N.pos=Ii,N.lastIntValue=$t}return!0}if(St&&N.eat(123)&&this.regexp_eatHexDigits(N)&&N.eat(125)&&Tn(N.lastIntValue))return!0;St&&N.raise("Invalid unicode escape"),N.pos=rt}return!1};function Tn(N){return N>=0&&N<=1114111}Zi.regexp_eatIdentityEscape=function(N){if(N.switchU)return this.regexp_eatSyntaxCharacter(N)?!0:N.eat(47)?(N.lastIntValue=47,!0):!1;var xe=N.current();return xe!==99&&(!N.switchN||xe!==107)?(N.lastIntValue=xe,N.advance(),!0):!1},Zi.regexp_eatDecimalEscape=function(N){N.lastIntValue=0;var xe=N.current();if(xe>=49&&xe<=57){do N.lastIntValue=10*N.lastIntValue+(xe-48),N.advance();while((xe=N.current())>=48&&xe<=57);return!0}return!1};var cr=0,Vs=1,Ur=2;Zi.regexp_eatCharacterClassEscape=function(N){var xe=N.current();if(Vt(xe))return N.lastIntValue=-1,N.advance(),Vs;var rt=!1;if(N.switchU&&this.options.ecmaVersion>=9&&((rt=xe===80)||xe===112)){N.lastIntValue=-1,N.advance();var St;if(N.eat(123)&&(St=this.regexp_eatUnicodePropertyValueExpression(N))&&N.eat(125))return rt&&St===Ur&&N.raise("Invalid property name"),St;N.raise("Invalid property name")}return cr};function Vt(N){return N===100||N===68||N===115||N===83||N===119||N===87}Zi.regexp_eatUnicodePropertyValueExpression=function(N){var xe=N.pos;if(this.regexp_eatUnicodePropertyName(N)&&N.eat(61)){var rt=N.lastStringValue;if(this.regexp_eatUnicodePropertyValue(N)){var St=N.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(N,rt,St),Vs}}if(N.pos=xe,this.regexp_eatLoneUnicodePropertyNameOrValue(N)){var $t=N.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(N,$t)}return cr},Zi.regexp_validateUnicodePropertyNameAndValue=function(N,xe,rt){lt(N.unicodeProperties.nonBinary,xe)||N.raise("Invalid property name"),N.unicodeProperties.nonBinary[xe].test(rt)||N.raise("Invalid property value")},Zi.regexp_validateUnicodePropertyNameOrValue=function(N,xe){if(N.unicodeProperties.binary.test(xe))return Vs;if(N.switchV&&N.unicodeProperties.binaryOfStrings.test(xe))return Ur;N.raise("Invalid property name")},Zi.regexp_eatUnicodePropertyName=function(N){var xe=0;for(N.lastStringValue="";hr(xe=N.current());)N.lastStringValue+=gi(xe),N.advance();return N.lastStringValue!==""};function hr(N){return Ut(N)||N===95}Zi.regexp_eatUnicodePropertyValue=function(N){var xe=0;for(N.lastStringValue="";Bt(xe=N.current());)N.lastStringValue+=gi(xe),N.advance();return N.lastStringValue!==""};function Bt(N){return hr(N)||Dr(N)}Zi.regexp_eatLoneUnicodePropertyNameOrValue=function(N){return this.regexp_eatUnicodePropertyValue(N)},Zi.regexp_eatCharacterClass=function(N){if(N.eat(91)){var xe=N.eat(94),rt=this.regexp_classContents(N);return N.eat(93)||N.raise("Unterminated character class"),xe&&rt===Ur&&N.raise("Negated character class may contain strings"),!0}return!1},Zi.regexp_classContents=function(N){return N.current()===93?Vs:N.switchV?this.regexp_classSetExpression(N):(this.regexp_nonEmptyClassRanges(N),Vs)},Zi.regexp_nonEmptyClassRanges=function(N){for(;this.regexp_eatClassAtom(N);){var xe=N.lastIntValue;if(N.eat(45)&&this.regexp_eatClassAtom(N)){var rt=N.lastIntValue;N.switchU&&(xe===-1||rt===-1)&&N.raise("Invalid character class"),xe!==-1&&rt!==-1&&xe>rt&&N.raise("Range out of order in character class")}}},Zi.regexp_eatClassAtom=function(N){var xe=N.pos;if(N.eat(92)){if(this.regexp_eatClassEscape(N))return!0;if(N.switchU){var rt=N.current();(rt===99||Va(rt))&&N.raise("Invalid class escape"),N.raise("Invalid escape")}N.pos=xe}var St=N.current();return St!==93?(N.lastIntValue=St,N.advance(),!0):!1},Zi.regexp_eatClassEscape=function(N){var xe=N.pos;if(N.eat(98))return N.lastIntValue=8,!0;if(N.switchU&&N.eat(45))return N.lastIntValue=45,!0;if(!N.switchU&&N.eat(99)){if(this.regexp_eatClassControlLetter(N))return!0;N.pos=xe}return this.regexp_eatCharacterClassEscape(N)||this.regexp_eatCharacterEscape(N)},Zi.regexp_classSetExpression=function(N){var xe=Vs,rt;if(!this.regexp_eatClassSetRange(N))if(rt=this.regexp_eatClassSetOperand(N)){rt===Ur&&(xe=Ur);for(var St=N.pos;N.eatChars([38,38]);){if(N.current()!==38&&(rt=this.regexp_eatClassSetOperand(N))){rt!==Ur&&(xe=Vs);continue}N.raise("Invalid character in character class")}if(St!==N.pos)return xe;for(;N.eatChars([45,45]);)this.regexp_eatClassSetOperand(N)||N.raise("Invalid character in character class");if(St!==N.pos)return xe}else N.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(N)){if(rt=this.regexp_eatClassSetOperand(N),!rt)return xe;rt===Ur&&(xe=Ur)}},Zi.regexp_eatClassSetRange=function(N){var xe=N.pos;if(this.regexp_eatClassSetCharacter(N)){var rt=N.lastIntValue;if(N.eat(45)&&this.regexp_eatClassSetCharacter(N)){var St=N.lastIntValue;return rt!==-1&&St!==-1&&rt>St&&N.raise("Range out of order in character class"),!0}N.pos=xe}return!1},Zi.regexp_eatClassSetOperand=function(N){return this.regexp_eatClassSetCharacter(N)?Vs:this.regexp_eatClassStringDisjunction(N)||this.regexp_eatNestedClass(N)},Zi.regexp_eatNestedClass=function(N){var xe=N.pos;if(N.eat(91)){var rt=N.eat(94),St=this.regexp_classContents(N);if(N.eat(93))return rt&&St===Ur&&N.raise("Negated character class may contain strings"),St;N.pos=xe}if(N.eat(92)){var $t=this.regexp_eatCharacterClassEscape(N);if($t)return $t;N.pos=xe}return null},Zi.regexp_eatClassStringDisjunction=function(N){var xe=N.pos;if(N.eatChars([92,113])){if(N.eat(123)){var rt=this.regexp_classStringDisjunctionContents(N);if(N.eat(125))return rt}else N.raise("Invalid escape");N.pos=xe}return null},Zi.regexp_classStringDisjunctionContents=function(N){for(var xe=this.regexp_classString(N);N.eat(124);)this.regexp_classString(N)===Ur&&(xe=Ur);return xe},Zi.regexp_classString=function(N){for(var xe=0;this.regexp_eatClassSetCharacter(N);)xe++;return xe===1?Vs:Ur},Zi.regexp_eatClassSetCharacter=function(N){var xe=N.pos;if(N.eat(92))return this.regexp_eatCharacterEscape(N)||this.regexp_eatClassSetReservedPunctuator(N)?!0:N.eat(98)?(N.lastIntValue=8,!0):(N.pos=xe,!1);var rt=N.current();return rt<0||rt===N.lookahead()&&Fr(rt)||Us(rt)?!1:(N.advance(),N.lastIntValue=rt,!0)};function Fr(N){return N===33||N>=35&&N<=38||N>=42&&N<=44||N===46||N>=58&&N<=64||N===94||N===96||N===126}function Us(N){return N===40||N===41||N===45||N===47||N>=91&&N<=93||N>=123&&N<=125}Zi.regexp_eatClassSetReservedPunctuator=function(N){var xe=N.current();return ua(xe)?(N.lastIntValue=xe,N.advance(),!0):!1};function ua(N){return N===33||N===35||N===37||N===38||N===44||N===45||N>=58&&N<=62||N===64||N===96||N===126}Zi.regexp_eatClassControlLetter=function(N){var xe=N.current();return Dr(xe)||xe===95?(N.lastIntValue=xe%32,N.advance(),!0):!1},Zi.regexp_eatHexEscapeSequence=function(N){var xe=N.pos;if(N.eat(120)){if(this.regexp_eatFixedHexDigits(N,2))return!0;N.switchU&&N.raise("Invalid escape"),N.pos=xe}return!1},Zi.regexp_eatDecimalDigits=function(N){var xe=N.pos,rt=0;for(N.lastIntValue=0;Dr(rt=N.current());)N.lastIntValue=10*N.lastIntValue+(rt-48),N.advance();return N.pos!==xe};function Dr(N){return N>=48&&N<=57}Zi.regexp_eatHexDigits=function(N){var xe=N.pos,rt=0;for(N.lastIntValue=0;Na(rt=N.current());)N.lastIntValue=16*N.lastIntValue+Fo(rt),N.advance();return N.pos!==xe};function Na(N){return N>=48&&N<=57||N>=65&&N<=70||N>=97&&N<=102}function Fo(N){return N>=65&&N<=70?10+(N-65):N>=97&&N<=102?10+(N-97):N-48}Zi.regexp_eatLegacyOctalEscapeSequence=function(N){if(this.regexp_eatOctalDigit(N)){var xe=N.lastIntValue;if(this.regexp_eatOctalDigit(N)){var rt=N.lastIntValue;xe<=3&&this.regexp_eatOctalDigit(N)?N.lastIntValue=xe*64+rt*8+N.lastIntValue:N.lastIntValue=xe*8+rt}else N.lastIntValue=xe;return!0}return!1},Zi.regexp_eatOctalDigit=function(N){var xe=N.current();return Va(xe)?(N.lastIntValue=xe-48,N.advance(),!0):(N.lastIntValue=0,!1)};function Va(N){return N>=48&&N<=55}Zi.regexp_eatFixedHexDigits=function(N,xe){var rt=N.pos;N.lastIntValue=0;for(var St=0;St<xe;++St){var $t=N.current();if(!Na($t))return N.pos=rt,!1;N.lastIntValue=16*N.lastIntValue+Fo($t),N.advance()}return!0};var Xs=function(xe){this.type=xe.type,this.value=xe.value,this.start=xe.start,this.end=xe.end,xe.options.locations&&(this.loc=new Ni(xe,xe.startLoc,xe.endLoc)),xe.options.ranges&&(this.range=[xe.start,xe.end])},Zn=v.prototype;Zn.next=function(N){!N&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Xs(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},Zn.getToken=function(){return this.next(),new Xs(this)},typeof Symbol<"u"&&(Zn[Symbol.iterator]=function(){var N=this;return{next:function(){var xe=N.getToken();return{done:xe.type===Oe.eof,value:xe}}}}),Zn.nextToken=function(){var N=this.curContext();if((!N||!N.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(Oe.eof);if(N.override)return N.override(this);this.readToken(this.fullCharCodeAtPos())},Zn.readToken=function(N){return je(N,this.options.ecmaVersion>=6)||N===92?this.readWord():this.getTokenFromCode(N)},Zn.fullCharCodeAtPos=function(){var N=this.input.charCodeAt(this.pos);if(N<=55295||N>=56320)return N;var xe=this.input.charCodeAt(this.pos+1);return xe<=56319||xe>=57344?N:(N<<10)+xe-56613888},Zn.skipBlockComment=function(){var N=this.options.onComment&&this.curPosition(),xe=this.pos,rt=this.input.indexOf("*/",this.pos+=2);if(rt===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=rt+2,this.options.locations)for(var St=void 0,$t=xe;(St=mt(this.input,$t,this.pos))>-1;)++this.curLine,$t=this.lineStart=St;this.options.onComment&&this.options.onComment(!0,this.input.slice(xe+2,rt),xe,this.pos,N,this.curPosition())},Zn.skipLineComment=function(N){for(var xe=this.pos,rt=this.options.onComment&&this.curPosition(),St=this.input.charCodeAt(this.pos+=N);this.pos<this.input.length&&!vt(St);)St=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(xe+N,this.pos),xe,this.pos,rt,this.curPosition())},Zn.skipSpace=function(){e:for(;this.pos<this.input.length;){var N=this.input.charCodeAt(this.pos);switch(N){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(N>8&&N<14||N>=5760&&Et.test(String.fromCharCode(N)))++this.pos;else break e}}},Zn.finishToken=function(N,xe){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var rt=this.type;this.type=N,this.value=xe,this.updateContext(rt)},Zn.readToken_dot=function(){var N=this.input.charCodeAt(this.pos+1);if(N>=48&&N<=57)return this.readNumber(!0);var xe=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&N===46&&xe===46?(this.pos+=3,this.finishToken(Oe.ellipsis)):(++this.pos,this.finishToken(Oe.dot))},Zn.readToken_slash=function(){var N=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):N===61?this.finishOp(Oe.assign,2):this.finishOp(Oe.slash,1)},Zn.readToken_mult_modulo_exp=function(N){var xe=this.input.charCodeAt(this.pos+1),rt=1,St=N===42?Oe.star:Oe.modulo;return this.options.ecmaVersion>=7&&N===42&&xe===42&&(++rt,St=Oe.starstar,xe=this.input.charCodeAt(this.pos+2)),xe===61?this.finishOp(Oe.assign,rt+1):this.finishOp(St,rt)},Zn.readToken_pipe_amp=function(N){var xe=this.input.charCodeAt(this.pos+1);if(xe===N){if(this.options.ecmaVersion>=12){var rt=this.input.charCodeAt(this.pos+2);if(rt===61)return this.finishOp(Oe.assign,3)}return this.finishOp(N===124?Oe.logicalOR:Oe.logicalAND,2)}return xe===61?this.finishOp(Oe.assign,2):this.finishOp(N===124?Oe.bitwiseOR:Oe.bitwiseAND,1)},Zn.readToken_caret=function(){var N=this.input.charCodeAt(this.pos+1);return N===61?this.finishOp(Oe.assign,2):this.finishOp(Oe.bitwiseXOR,1)},Zn.readToken_plus_min=function(N){var xe=this.input.charCodeAt(this.pos+1);return xe===N?xe===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||jt.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(Oe.incDec,2):xe===61?this.finishOp(Oe.assign,2):this.finishOp(Oe.plusMin,1)},Zn.readToken_lt_gt=function(N){var xe=this.input.charCodeAt(this.pos+1),rt=1;return xe===N?(rt=N===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+rt)===61?this.finishOp(Oe.assign,rt+1):this.finishOp(Oe.bitShift,rt)):xe===33&&N===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(xe===61&&(rt=2),this.finishOp(Oe.relational,rt))},Zn.readToken_eq_excl=function(N){var xe=this.input.charCodeAt(this.pos+1);return xe===61?this.finishOp(Oe.equality,this.input.charCodeAt(this.pos+2)===61?3:2):N===61&&xe===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(Oe.arrow)):this.finishOp(N===61?Oe.eq:Oe.prefix,1)},Zn.readToken_question=function(){var N=this.options.ecmaVersion;if(N>=11){var xe=this.input.charCodeAt(this.pos+1);if(xe===46){var rt=this.input.charCodeAt(this.pos+2);if(rt<48||rt>57)return this.finishOp(Oe.questionDot,2)}if(xe===63){if(N>=12){var St=this.input.charCodeAt(this.pos+2);if(St===61)return this.finishOp(Oe.assign,3)}return this.finishOp(Oe.coalesce,2)}}return this.finishOp(Oe.question,1)},Zn.readToken_numberSign=function(){var N=this.options.ecmaVersion,xe=35;if(N>=13&&(++this.pos,xe=this.fullCharCodeAtPos(),je(xe,!0)||xe===92))return this.finishToken(Oe.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+gi(xe)+"'")},Zn.getTokenFromCode=function(N){switch(N){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(Oe.parenL);case 41:return++this.pos,this.finishToken(Oe.parenR);case 59:return++this.pos,this.finishToken(Oe.semi);case 44:return++this.pos,this.finishToken(Oe.comma);case 91:return++this.pos,this.finishToken(Oe.bracketL);case 93:return++this.pos,this.finishToken(Oe.bracketR);case 123:return++this.pos,this.finishToken(Oe.braceL);case 125:return++this.pos,this.finishToken(Oe.braceR);case 58:return++this.pos,this.finishToken(Oe.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(Oe.backQuote);case 48:var xe=this.input.charCodeAt(this.pos+1);if(xe===120||xe===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(xe===111||xe===79)return this.readRadixNumber(8);if(xe===98||xe===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(N);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(N);case 124:case 38:return this.readToken_pipe_amp(N);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(N);case 60:case 62:return this.readToken_lt_gt(N);case 61:case 33:return this.readToken_eq_excl(N);case 63:return this.readToken_question();case 126:return this.finishOp(Oe.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+gi(N)+"'")},Zn.finishOp=function(N,xe){var rt=this.input.slice(this.pos,this.pos+xe);return this.pos+=xe,this.finishToken(N,rt)},Zn.readRegexp=function(){for(var N,xe,rt=this.pos;;){this.pos>=this.input.length&&this.raise(rt,"Unterminated regular expression");var St=this.input.charAt(this.pos);if(jt.test(St)&&this.raise(rt,"Unterminated regular expression"),N)N=!1;else{if(St==="[")xe=!0;else if(St==="]"&&xe)xe=!1;else if(St==="/"&&!xe)break;N=St==="\\"}++this.pos}var $t=this.input.slice(rt,this.pos);++this.pos;var Ii=this.pos,Li=this.readWord1();this.containsEsc&&this.unexpected(Ii);var An=this.regexpState||(this.regexpState=new ur(this));An.reset(rt,$t,Li),this.validateRegExpFlags(An),this.validateRegExpPattern(An);var pn=null;try{pn=new RegExp($t,Li)}catch{}return this.finishToken(Oe.regexp,{pattern:$t,flags:Li,value:pn})},Zn.readInt=function(N,xe,rt){for(var St=this.options.ecmaVersion>=12&&xe===void 0,$t=rt&&this.input.charCodeAt(this.pos)===48,Ii=this.pos,Li=0,An=0,pn=0,sr=xe??1/0;pn<sr;++pn,++this.pos){var Ar=this.input.charCodeAt(this.pos),Or=void 0;if(St&&Ar===95){$t&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),An===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),pn===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),An=Ar;continue}if(Ar>=97?Or=Ar-97+10:Ar>=65?Or=Ar-65+10:Ar>=48&&Ar<=57?Or=Ar-48:Or=1/0,Or>=N)break;An=Ar,Li=Li*N+Or}return St&&An===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===Ii||xe!=null&&this.pos-Ii!==xe?null:Li};function aa(N,xe){return xe?parseInt(N,8):parseFloat(N.replace(/_/g,""))}function hs(N){return typeof BigInt!="function"?null:BigInt(N.replace(/_/g,""))}Zn.readRadixNumber=function(N){var xe=this.pos;this.pos+=2;var rt=this.readInt(N);return rt==null&&this.raise(this.start+2,"Expected number in radix "+N),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(rt=hs(this.input.slice(xe,this.pos)),++this.pos):je(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Oe.num,rt)},Zn.readNumber=function(N){var xe=this.pos;!N&&this.readInt(10,void 0,!0)===null&&this.raise(xe,"Invalid number");var rt=this.pos-xe>=2&&this.input.charCodeAt(xe)===48;rt&&this.strict&&this.raise(xe,"Invalid number");var St=this.input.charCodeAt(this.pos);if(!rt&&!N&&this.options.ecmaVersion>=11&&St===110){var $t=hs(this.input.slice(xe,this.pos));return++this.pos,je(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Oe.num,$t)}rt&&/[89]/.test(this.input.slice(xe,this.pos))&&(rt=!1),St===46&&!rt&&(++this.pos,this.readInt(10),St=this.input.charCodeAt(this.pos)),(St===69||St===101)&&!rt&&(St=this.input.charCodeAt(++this.pos),(St===43||St===45)&&++this.pos,this.readInt(10)===null&&this.raise(xe,"Invalid number")),je(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var Ii=aa(this.input.slice(xe,this.pos),rt);return this.finishToken(Oe.num,Ii)},Zn.readCodePoint=function(){var N=this.input.charCodeAt(this.pos),xe;if(N===123){this.options.ecmaVersion<6&&this.unexpected();var rt=++this.pos;xe=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,xe>1114111&&this.invalidStringToken(rt,"Code point out of bounds")}else xe=this.readHexChar(4);return xe},Zn.readString=function(N){for(var xe="",rt=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var St=this.input.charCodeAt(this.pos);if(St===N)break;St===92?(xe+=this.input.slice(rt,this.pos),xe+=this.readEscapedChar(!1),rt=this.pos):St===8232||St===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(vt(St)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return xe+=this.input.slice(rt,this.pos++),this.finishToken(Oe.string,xe)};var Ua={};Zn.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(N){if(N===Ua)this.readInvalidTemplateToken();else throw N}this.inTemplateElement=!1},Zn.invalidStringToken=function(N,xe){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Ua;this.raise(N,xe)},Zn.readTmplToken=function(){for(var N="",xe=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var rt=this.input.charCodeAt(this.pos);if(rt===96||rt===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===Oe.template||this.type===Oe.invalidTemplate)?rt===36?(this.pos+=2,this.finishToken(Oe.dollarBraceL)):(++this.pos,this.finishToken(Oe.backQuote)):(N+=this.input.slice(xe,this.pos),this.finishToken(Oe.template,N));if(rt===92)N+=this.input.slice(xe,this.pos),N+=this.readEscapedChar(!0),xe=this.pos;else if(vt(rt)){switch(N+=this.input.slice(xe,this.pos),++this.pos,rt){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:N+=`
`;break;default:N+=String.fromCharCode(rt);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),xe=this.pos}else++this.pos}},Zn.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(Oe.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},Zn.readEscapedChar=function(N){var xe=this.input.charCodeAt(++this.pos);switch(++this.pos,xe){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return gi(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),N){var rt=this.pos-1;this.invalidStringToken(rt,"Invalid escape sequence in template string")}default:if(xe>=48&&xe<=55){var St=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],$t=parseInt(St,8);return $t>255&&(St=St.slice(0,-1),$t=parseInt(St,8)),this.pos+=St.length-1,xe=this.input.charCodeAt(this.pos),(St!=="0"||xe===56||xe===57)&&(this.strict||N)&&this.invalidStringToken(this.pos-1-St.length,N?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode($t)}return vt(xe)?"":String.fromCharCode(xe)}},Zn.readHexChar=function(N){var xe=this.pos,rt=this.readInt(16,N);return rt===null&&this.invalidStringToken(xe,"Bad character escape sequence"),rt},Zn.readWord1=function(){this.containsEsc=!1;for(var N="",xe=!0,rt=this.pos,St=this.options.ecmaVersion>=6;this.pos<this.input.length;){var $t=this.fullCharCodeAtPos();if(nt($t,St))this.pos+=$t<=65535?1:2;else if($t===92){this.containsEsc=!0,N+=this.input.slice(rt,this.pos);var Ii=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var Li=this.readCodePoint();(xe?je:nt)(Li,St)||this.invalidStringToken(Ii,"Invalid Unicode escape"),N+=gi(Li),rt=this.pos}else break;xe=!1}return N+this.input.slice(rt,this.pos)},Zn.readWord=function(){var N=this.readWord1(),xe=Oe.name;return this.keywords.test(N)&&(xe=Tt[N]),this.finishToken(xe,N)};var al="8.11.3";v.acorn={Parser:v,version:al,defaultOptions:ji,Position:Ti,SourceLocation:Ni,getLineInfo:en,Node:Pe,TokenType:tt,tokTypes:Oe,keywordTypes:Tt,TokContext:st,tokContexts:Me,isIdentifierChar:nt,isIdentifierStart:je,Token:Xs,isNewLine:vt,lineBreak:jt,lineBreakG:it,nonASCIIwhitespace:Et};function ol(N,xe){return v.parse(N,xe)}function no(N,xe,rt){return v.parseExpressionAt(N,xe,rt)}function Ga(N,xe){return v.tokenizer(N,xe)}n.Node=Pe,n.Parser=v,n.Position=Ti,n.SourceLocation=Ni,n.TokContext=st,n.Token=Xs,n.TokenType=tt,n.defaultOptions=ji,n.getLineInfo=en,n.isIdentifierChar=nt,n.isIdentifierStart=je,n.isNewLine=vt,n.keywordTypes=Tt,n.lineBreak=jt,n.lineBreakG=it,n.nonASCIIwhitespace=Et,n.parse=ol,n.parseExpressionAt=no,n.tokContexts=Me,n.tokTypes=Oe,n.tokenizer=Ga,n.version=al})}(Gg,Gg.exports)),Gg.exports}/*!
 * Paper.js v0.12.17 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jrg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Thu Nov 3 21:15:36 2022 +0100
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jrg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */(function(e){(function(t,n){t=t||xx;var c=t.window,g=t.document,x=new function(){var v=/^(statics|enumerable|beans|preserve)$/,k=[],V=k.slice,Y=Object.create,te=Object.getOwnPropertyDescriptor,fe=Object.defineProperty,ve=k.forEach||function(Qe,Ue){for(var ft=0,st=this.length;ft<st;ft++)Qe.call(Ue,this[ft],ft,this)},Ie=function(Qe,Ue){for(var ft in this)this.hasOwnProperty(ft)&&Qe.call(Ue,this[ft],ft,this)},Ee=Object.assign||function(Qe){for(var Ue=1,ft=arguments.length;Ue<ft;Ue++){var st=arguments[Ue];for(var Me in st)st.hasOwnProperty(Me)&&(Qe[Me]=st[Me])}return Qe},ze=function(Qe,Ue,ft){if(Qe){var st=te(Qe,"length");(st&&typeof st.value=="number"?ve:Ie).call(Qe,Ue,ft=ft||Qe)}return ft};function We(Qe,Ue,ft,st,Me){var se={};function ne(ge,Pe){Pe=Pe||(Pe=te(Ue,ge))&&(Pe.get?Pe:Pe.value),typeof Pe=="string"&&Pe[0]==="#"&&(Pe=Qe[Pe.substring(1)]||Pe);var Fe=typeof Pe=="function",Ve=Pe,Xe=Me||Fe&&!Pe.base?Pe&&Pe.get?ge in Qe:Qe[ge]:null,Ye;(!Me||!Xe)&&(Fe&&Xe&&(Pe.base=Xe),Fe&&st!==!1&&(Ye=ge.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(se[Ye[3].toLowerCase()+Ye[4]]=Ye[2]),(!Ve||Fe||!Ve.get||typeof Ve.get!="function"||!He.isPlainObject(Ve))&&(Ve={value:Ve,writable:!0}),(te(Qe,ge)||{configurable:!0}).configurable&&(Ve.configurable=!0,Ve.enumerable=ft??!Ye),fe(Qe,ge,Ve))}if(Ue){for(var $ in Ue)Ue.hasOwnProperty($)&&!v.test($)&&ne($);for(var $ in se){var ie=se[$],de=Qe["set"+ie],ye=Qe["get"+ie]||de&&Qe["is"+ie];ye&&(st===!0||ye.length===0)&&ne($,{get:ye,set:de})}}return Qe}function He(){for(var Qe=0,Ue=arguments.length;Qe<Ue;Qe++){var ft=arguments[Qe];ft&&Ee(this,ft)}return this}return We(He,{inject:function(Qe){if(Qe){var Ue=Qe.statics===!0?Qe:Qe.statics,ft=Qe.beans,st=Qe.preserve;Ue!==Qe&&We(this.prototype,Qe,Qe.enumerable,ft,st),We(this,Ue,null,ft,st)}for(var Me=1,se=arguments.length;Me<se;Me++)this.inject(arguments[Me]);return this},extend:function(){for(var Qe=this,Ue,ft,st=0,Me,se=arguments.length;st<se&&!(Ue&&ft);st++)Me=arguments[st],Ue=Ue||Me.initialize,ft=ft||Me.prototype;return Ue=Ue||function(){Qe.apply(this,arguments)},ft=Ue.prototype=ft||Y(this.prototype),fe(ft,"constructor",{value:Ue,writable:!0,configurable:!0}),We(Ue,this),arguments.length&&this.inject.apply(Ue,arguments),Ue.base=Qe,Ue}}).inject({enumerable:!1,initialize:He,set:He,inject:function(){for(var Qe=0,Ue=arguments.length;Qe<Ue;Qe++){var ft=arguments[Qe];ft&&We(this,ft,ft.enumerable,ft.beans,ft.preserve)}return this},extend:function(){var Qe=Y(this);return Qe.inject.apply(Qe,arguments)},each:function(Qe,Ue){return ze(this,Qe,Ue)},clone:function(){return new this.constructor(this)},statics:{set:Ee,each:ze,create:Y,define:fe,describe:te,clone:function(Qe){return Ee(new Qe.constructor,Qe)},isPlainObject:function(Qe){var Ue=Qe!=null&&Qe.constructor;return Ue&&(Ue===Object||Ue===He||Ue.name==="Object")},pick:function(Qe,Ue){return Qe!==n?Qe:Ue},slice:function(Qe,Ue,ft){return V.call(Qe,Ue,ft)}}})};e.exports=x,x.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+x.each(this,function(v,k){if(!/^_/.test(k)){var V=typeof v;this.push(k+": "+(V==="number"?he.instance.number(v):V==="string"?"'"+v+"'":v))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(v){return x.importJSON(v,this)},exportJSON:function(v){return x.exportJSON(this,v)},toJSON:function(){return x.serialize(this)},set:function(v,k){return v&&x.filter(this,v,k,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function v(){var k=v.base.apply(this,arguments),V=k.prototype._class;return V&&!x.exports[V]&&(x.exports[V]=k),k},equals:function(v,k){if(v===k)return!0;if(v&&v.equals)return v.equals(k);if(k&&k.equals)return k.equals(v);if(v&&k&&typeof v=="object"&&typeof k=="object"){if(Array.isArray(v)&&Array.isArray(k)){var V=v.length;if(V!==k.length)return!1;for(;V--;)if(!x.equals(v[V],k[V]))return!1}else{var Y=Object.keys(v),V=Y.length;if(V!==Object.keys(k).length)return!1;for(;V--;){var te=Y[V];if(!(k.hasOwnProperty(te)&&x.equals(v[te],k[te])))return!1}}return!0}return!1},read:function(v,k,V,Y){if(this===x){var te=this.peek(v,k);return v.__index++,te}var fe=this.prototype,ve=fe._readIndex,Ie=k||ve&&v.__index||0,Ee=v.length,ze=v[Ie];if(Y=Y||Ee-Ie,ze instanceof this||V&&V.readNull&&ze==null&&Y<=1)return ve&&(v.__index=Ie+1),ze&&V&&V.clone?ze.clone():ze;if(ze=x.create(fe),ve&&(ze.__read=!0),ze=ze.initialize.apply(ze,Ie>0||Ie+Y<Ee?x.slice(v,Ie,Ie+Y):v)||ze,ve){v.__index=Ie+ze.__read;var We=ze.__filtered;We&&(v.__filtered=We,ze.__filtered=n),ze.__read=n}return ze},peek:function(v,k){return v[v.__index=k||v.__index||0]},remain:function(v){return v.length-(v.__index||0)},readList:function(v,k,V,Y){for(var te=[],fe,ve=k||0,Ie=Y?ve+Y:v.length,Ee=ve;Ee<Ie;Ee++)te.push(Array.isArray(fe=v[Ee])?this.read(fe,0,V):this.read(v,Ee,V,1));return te},readNamed:function(v,k,V,Y,te){var fe=this.getNamed(v,k),ve=fe!==n;if(ve){var Ie=v.__filtered;if(!Ie){var Ee=this.getSource(v);Ie=v.__filtered=x.create(Ee),Ie.__unfiltered=Ee}Ie[k]=n}return this.read(ve?[fe]:v,V,Y,te)},readSupported:function(v,k){var V=this.getSource(v),Y=this,te=!1;return V&&Object.keys(V).forEach(function(fe){if(fe in k){var ve=Y.readNamed(v,fe);ve!==n&&(k[fe]=ve),te=!0}}),te},getSource:function(v){var k=v.__source;if(k===n){var V=v.length===1&&v[0];k=v.__source=V&&x.isPlainObject(V)?V:null}return k},getNamed:function(v,k){var V=this.getSource(v);if(V)return k?V[k]:v.__filtered||V},hasNamed:function(v,k){return!!this.getNamed(v,k)},filter:function(v,k,V,Y){var te;function fe(We){if(!(V&&We in V)&&!(te&&We in te)){var He=k[We];He!==n&&(v[We]=He)}}if(Y){for(var ve={},Ie=0,Ee,ze=Y.length;Ie<ze;Ie++)(Ee=Y[Ie])in k&&(fe(Ee),ve[Ee]=!0);te=ve}return Object.keys(k.__unfiltered||k).forEach(fe),v},isPlainValue:function(v,k){return x.isPlainObject(v)||Array.isArray(v)||k&&typeof v=="string"},serialize:function(v,k,V,Y){k=k||{};var te=!Y,fe;if(te&&(k.formatter=new he(k.precision),Y={length:0,definitions:{},references:{},add:function(He,Qe){var Ue="#"+He._id,ft=this.references[Ue];if(!ft){this.length++;var st=Qe.call(He),Me=He._class;Me&&st[0]!==Me&&st.unshift(Me),this.definitions[Ue]=st,ft=this.references[Ue]=[Ue]}return ft}}),v&&v._serialize){fe=v._serialize(k,Y);var ve=v._class;ve&&!v._compactSerialize&&(te||!V)&&fe[0]!==ve&&fe.unshift(ve)}else if(Array.isArray(v)){fe=[];for(var Ie=0,Ee=v.length;Ie<Ee;Ie++)fe[Ie]=x.serialize(v[Ie],k,V,Y)}else if(x.isPlainObject(v)){fe={};for(var ze=Object.keys(v),Ie=0,Ee=ze.length;Ie<Ee;Ie++){var We=ze[Ie];fe[We]=x.serialize(v[We],k,V,Y)}}else typeof v=="number"?fe=k.formatter.number(v,k.precision):fe=v;return te&&Y.length>0?[["dictionary",Y.definitions],fe]:fe},deserialize:function(v,k,V,Y,te){var fe=v,ve=!V,Ie=ve&&v&&v.length&&v[0][0]==="dictionary";if(V=V||{},Array.isArray(v)){var Ee=v[0],ze=Ee==="dictionary";if(v.length==1&&/^#/.test(Ee))return V.dictionary[Ee];Ee=x.exports[Ee],fe=[];for(var We=Ee?1:0,He=v.length;We<He;We++)fe.push(x.deserialize(v[We],k,V,ze,Ie));if(Ee){var Qe=fe;k?fe=k(Ee,Qe,ve||te):fe=new Ee(Qe)}}else if(x.isPlainObject(v)){fe={},Y&&(V.dictionary=fe);for(var Ue in v)fe[Ue]=x.deserialize(v[Ue],k,V)}return Ie?fe[1]:fe},exportJSON:function(v,k){var V=x.serialize(v,k);return k&&k.asString==!1?V:JSON.stringify(V)},importJSON:function(v,k){return x.deserialize(typeof v=="string"?JSON.parse(v):v,function(V,Y,te){var fe=te&&k&&k.constructor===V,ve=fe?k:x.create(V.prototype);if(Y.length===1&&ve instanceof Oe&&(fe||!(ve instanceof it))){var Ie=Y[0];x.isPlainObject(Ie)&&(Ie.insert=!1,fe&&(Y=Y.concat([Oe.INSERT])))}return(fe?ve.set:V).apply(ve,Y),fe&&(k=null),ve})},push:function(v,k){var V=k.length;if(V<4096)v.push.apply(v,k);else{var Y=v.length;v.length+=V;for(var te=0;te<V;te++)v[Y+te]=k[te]}return v},splice:function(v,k,V,Y){var te=k&&k.length,fe=V===n;V=fe?v.length:V,V>v.length&&(V=v.length);for(var ve=0;ve<te;ve++)k[ve]._index=V+ve;if(fe)return x.push(v,k),[];var Ie=[V,Y];k&&x.push(Ie,k);for(var Ee=v.splice.apply(v,Ie),ve=0,ze=Ee.length;ve<ze;ve++)Ee[ve]._index=n;for(var ve=V+te,ze=v.length;ve<ze;ve++)v[ve]._index=ve;return Ee},capitalize:function(v){return v.replace(/\b[a-z]/g,function(k){return k.toUpperCase()})},camelize:function(v){return v.replace(/-(.)/g,function(k,V){return V.toUpperCase()})},hyphenate:function(v){return v.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var S={on:function(v,k){if(typeof v!="string")x.each(v,function(fe,ve){this.on(ve,fe)},this);else{var V=this._eventTypes,Y=V&&V[v],te=this._callbacks=this._callbacks||{};te=te[v]=te[v]||[],te.indexOf(k)===-1&&(te.push(k),Y&&Y.install&&te.length===1&&Y.install.call(this,v))}return this},off:function(v,k){if(typeof v!="string"){x.each(v,function(ve,Ie){this.off(Ie,ve)},this);return}var V=this._eventTypes,Y=V&&V[v],te=this._callbacks&&this._callbacks[v],fe;return te&&(!k||(fe=te.indexOf(k))!==-1&&te.length===1?(Y&&Y.uninstall&&Y.uninstall.call(this,v),delete this._callbacks[v]):fe!==-1&&te.splice(fe,1)),this},once:function(v,k){return this.on(v,function V(){k.apply(this,arguments),this.off(v,V)})},emit:function(v,k){var V=this._callbacks&&this._callbacks[v];if(!V)return!1;var Y=x.slice(arguments,1),te=k&&k.target&&!k.currentTarget;V=V.slice(),te&&(k.currentTarget=this);for(var fe=0,ve=V.length;fe<ve;fe++)if(V[fe].apply(this,Y)==!1){k&&k.stop&&k.stop();break}return te&&delete k.currentTarget,!0},responds:function(v){return!!(this._callbacks&&this._callbacks[v])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(v){var k=this._eventTypes,V=this._callbacks,Y=v?"install":"uninstall";if(k){for(var te in V)if(V[te].length>0){var fe=k[te],ve=fe&&fe[Y];ve&&ve.call(this,te)}}},statics:{inject:function v(k){var V=k._events;if(V){var Y={};x.each(V,function(te,fe){var ve=typeof te=="string",Ie=ve?te:fe,Ee=x.capitalize(Ie),ze=Ie.substring(2).toLowerCase();Y[ze]=ve?{}:te,Ie="_"+Ie,k["get"+Ee]=function(){return this[Ie]},k["set"+Ee]=function(We){var He=this[Ie];He&&this.off(ze,He),We&&this.on(ze,We),this[Ie]=We}}),k._eventTypes=Y}return v.base.apply(this,arguments)}}},a=x.extend({_class:"PaperScope",initialize:function v(){In=this,this.settings=new x({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=v._id++,v._scopes[this._id]=this;var k=v.prototype;if(!this.support){var V=rn.getContext(1,1)||{};k.support={nativeDash:"setLineDash"in V||"mozDash"in V,nativeBlendModes:tr.nativeModes},rn.release(V)}if(!this.agent){var Y=t.navigator.userAgent.toLowerCase(),te=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(Y)||[])[0],fe=te==="darwin"?"mac":te,ve=k.agent=k.browser={platform:fe};fe&&(ve[fe]=!0),Y.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(Ie,Ee,ze,We,He){if(!ve.chrome){var Qe=Ee==="opera"?We:/^(node|trident)$/.test(Ee)?He:ze;ve.version=Qe,ve.versionNumber=parseFloat(Qe),Ee={trident:"msie",jsdom:"node"}[Ee]||Ee,ve.name=Ee,ve[Ee]=!0}}),ve.chrome&&delete ve.webkit,ve.atom&&delete ve.chrome}},version:"0.12.17",getView:function(){var v=this.project;return v&&v._view},getPaper:function(){return this},execute:function(v,k){var V=In.PaperScript.execute(v,this,k);return Ri.updateFocus(),V},install:function(v){var k=this;x.each(["project","view","tool"],function(Y){x.define(v,Y,{configurable:!0,get:function(){return k[Y]}})});for(var V in this)!/^_/.test(V)&&this[V]&&(v[V]=this[V])},setup:function(v){return In=this,this.project=new Mt(v),this},createCanvas:function(v,k){return rn.getCanvas(v,k)},activate:function(){In=this},clear:function(){for(var v=this.projects,k=this.tools,V=v.length-1;V>=0;V--)v[V].remove();for(var V=k.length-1;V>=0;V--)k[V].remove()},remove:function(){this.clear(),delete a._scopes[this._id]},statics:new function(){function v(k){return k+="Attribute",function(V,Y){return V[k](Y)||V[k]("data-paper-"+Y)}}return{_scopes:{},_id:0,get:function(k){return this._scopes[k]||null},getAttribute:v("get"),hasAttribute:v("has")}}}),G=x.extend(S,{initialize:function(v){this._scope=In,this._index=this._scope[this._list].push(this)-1,(v||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var v=this._scope[this._reference];return v&&v!==this&&v.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",v),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return this._index==null?!1:(x.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),W={findItemBoundsCollisions:function(v,k,V){function Y(ve){for(var Ie=new Array(ve.length),Ee=0;Ee<ve.length;Ee++){var ze=ve[Ee].getBounds();Ie[Ee]=[ze.left,ze.top,ze.right,ze.bottom]}return Ie}var te=Y(v),fe=!k||k===v?te:Y(k);return this.findBoundsCollisions(te,fe,V||0)},findCurveBoundsCollisions:function(v,k,V,Y){function te(Qe){for(var Ue=Math.min,ft=Math.max,st=new Array(Qe.length),Me=0;Me<Qe.length;Me++){var se=Qe[Me];st[Me]=[Ue(se[0],se[2],se[4],se[6]),Ue(se[1],se[3],se[5],se[7]),ft(se[0],se[2],se[4],se[6]),ft(se[1],se[3],se[5],se[7])]}return st}var fe=te(v),ve=!k||k===v?fe:te(k);if(Y){for(var Ie=this.findBoundsCollisions(fe,ve,V||0,!1,!0),Ee=this.findBoundsCollisions(fe,ve,V||0,!0,!0),ze=[],We=0,He=Ie.length;We<He;We++)ze[We]={hor:Ie[We],ver:Ee[We]};return ze}return this.findBoundsCollisions(fe,ve,V||0)},findBoundsCollisions:function(v,k,V,Y,te){var fe=!k||v===k,ve=fe?v:v.concat(k),Ie=v.length,Ee=ve.length;function ze(ai,fi,hi){for(var Jt=0,oi=ai.length;Jt<oi;){var zi=oi+Jt>>>1;ve[ai[zi]][fi]<hi?Jt=zi+1:oi=zi}return Jt-1}for(var We=Y?1:0,He=We+2,Qe=Y?0:1,Ue=Qe+2,ft=new Array(Ee),st=0;st<Ee;st++)ft[st]=st;ft.sort(function(ai,fi){return ve[ai][We]-ve[fi][We]});for(var Me=[],se=new Array(Ie),st=0;st<Ee;st++){var ne=ft[st],$=ve[ne],ie=fe?ne:ne-Ie,de=ne<Ie,ye=fe||!de,ge=de?[]:null;if(Me.length){var Pe=ze(Me,He,$[We]-V)+1;if(Me.splice(0,Pe),fe&&te){ge=ge.concat(Me);for(var Fe=0;Fe<Me.length;Fe++){var Ve=Me[Fe];se[Ve].push(ie)}}else for(var Xe=$[Ue],Ye=$[Qe],Fe=0;Fe<Me.length;Fe++){var Ve=Me[Fe],De=ve[Ve],Ge=Ve<Ie,ht=fe||Ve>=Ie;(te||(de&&ht||ye&&Ge)&&Xe>=De[Qe]-V&&Ye<=De[Ue]+V)&&(de&&ht&&ge.push(fe?Ve:Ve-Ie),ye&&Ge&&se[Ve].push(ie))}}if(de&&(v===k&&ge.push(ne),se[ne]=ge),Me.length){var kt=$[He],o=ze(Me,He,kt);Me.splice(o+1,0,ne)}else Me.push(ne)}for(var st=0;st<se.length;st++){var ke=se[st];ke&&ke.sort(function(fi,hi){return fi-hi})}return se}},he=x.extend({initialize:function(v){this.precision=x.pick(v,5),this.multiplier=Math.pow(10,this.precision)},number:function(v){return this.precision<16?Math.round(v*this.multiplier)/this.multiplier:v},pair:function(v,k,V){return this.number(v)+(V||",")+this.number(k)},point:function(v,k){return this.number(v.x)+(k||",")+this.number(v.y)},size:function(v,k){return this.number(v.width)+(k||",")+this.number(v.height)},rectangle:function(v,k){return this.point(v,k)+(k||",")+this.size(v,k)}});he.instance=new he;var ae=new function(){var v=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],k=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],V=Math.abs,Y=Math.sqrt,te=Math.pow,fe=Math.log2||function(He){return Math.log(He)*Math.LOG2E},ve=1e-12,Ie=112e-18;function Ee(He,Qe,Ue){return He<Qe?Qe:He>Ue?Ue:He}function ze(He,Qe,Ue){function ft(Pe){var Fe=Pe*134217729,Ve=Pe-Fe,Xe=Ve+Fe,Ye=Pe-Xe;return[Xe,Ye]}var st=Qe*Qe-He*Ue,Me=Qe*Qe+He*Ue;if(V(st)*3<Me){var se=ft(He),ne=ft(Qe),$=ft(Ue),ie=Qe*Qe,de=ne[0]*ne[0]-ie+2*ne[0]*ne[1]+ne[1]*ne[1],ye=He*Ue,ge=se[0]*$[0]-ye+se[0]*$[1]+se[1]*$[0]+se[1]*$[1];st=ie-ye+(de-ge)}return st}function We(){var He=Math.max.apply(Math,arguments);return He&&(He<1e-8||He>1e8)?te(2,-Math.round(fe(He))):0}return{EPSILON:ve,MACHINE_EPSILON:Ie,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,ANGULAR_EPSILON:1e-5,KAPPA:4*(Y(2)-1)/3,isZero:function(He){return He>=-ve&&He<=ve},isMachineZero:function(He){return He>=-Ie&&He<=Ie},clamp:Ee,integrate:function(He,Qe,Ue,ft){for(var st=v[ft-2],Me=k[ft-2],se=(Ue-Qe)*.5,ne=se+Qe,$=0,ie=ft+1>>1,de=ft&1?Me[$++]*He(ne):0;$<ie;){var ye=se*st[$];de+=Me[$++]*(He(ne+ye)+He(ne-ye))}return se*de},findRoot:function(He,Qe,Ue,ft,st,Me,se){for(var ne=0;ne<Me;ne++){var $=He(Ue),ie=$/Qe(Ue),de=Ue-ie;if(V(ie)<se){Ue=de;break}$>0?(st=Ue,Ue=de<=ft?(ft+st)*.5:de):(ft=Ue,Ue=de>=st?(ft+st)*.5:de)}return Ee(Ue,ft,st)},solveQuadratic:function(He,Qe,Ue,ft,st,Me){var se,ne=1/0;if(V(He)<ve){if(V(Qe)<ve)return V(Ue)<ve?-1:0;se=-Ue/Qe}else{Qe*=-.5;var $=ze(He,Qe,Ue);if($&&V($)<Ie){var ie=We(V(He),V(Qe),V(Ue));ie&&(He*=ie,Qe*=ie,Ue*=ie,$=ze(He,Qe,Ue))}if($>=-Ie){var de=$<0?0:Y($),ye=Qe+(Qe<0?-de:de);ye===0?(se=Ue/He,ne=-se):(se=ye/He,ne=Ue/ye)}}var ge=0,Pe=st==null,Fe=st-ve,Ve=Me+ve;return isFinite(se)&&(Pe||se>Fe&&se<Ve)&&(ft[ge++]=Pe?se:Ee(se,st,Me)),ne!==se&&isFinite(ne)&&(Pe||ne>Fe&&ne<Ve)&&(ft[ge++]=Pe?ne:Ee(ne,st,Me)),ge},solveCubic:function(He,Qe,Ue,ft,st,Me,se){var ne=We(V(He),V(Qe),V(Ue),V(ft)),$,ie,de,ye,ge;ne&&(He*=ne,Qe*=ne,Ue*=ne,ft*=ne);function Pe(o){$=o;var ke=He*$;ie=ke+Qe,de=ie*$+Ue,ye=(ke+ie)*$+de,ge=de*$+ft}if(V(He)<ve)He=Qe,ie=Ue,de=ft,$=1/0;else if(V(ft)<ve)ie=Qe,de=Ue,$=0;else{Pe(-(Qe/He)/3);var Fe=ge/He,Ve=te(V(Fe),1/3),Xe=Fe<0?-1:1,Ye=-ye/He,De=Ye>0?1.324717957244746*Math.max(Ve,Y(Ye)):Ve,Ge=$-Xe*De;if(Ge!==$){do Pe(Ge),Ge=ye===0?$:$-ge/ye/(1+Ie);while(Xe*Ge>Xe*$);V(He)*$*$>V(ft/$)&&(de=-ft/$,ie=(de-Ue)/$)}}var ht=ae.solveQuadratic(He,ie,de,st,Me,se),kt=Me==null;return isFinite($)&&(ht===0||ht>0&&$!==st[0]&&$!==st[1])&&(kt||$>Me-ve&&$<se+ve)&&(st[ht++]=kt?$:Ee($,Me,se)),ht}}},ue={_id:1,_pools:{},get:function(v){if(v){var k=this._pools[v];return k||(k=this._pools[v]={_id:1}),k._id++}else return this._id++}},be=x.extend({_class:"Point",_readIndex:!0,initialize:function(k,V){var Y=typeof k,te=this.__read,fe=0;if(Y==="number"){var ve=typeof V=="number";this._set(k,ve?V:k),te&&(fe=ve?2:1)}else if(Y==="undefined"||k===null)this._set(0,0),te&&(fe=k===null?1:0);else{var Ie=Y==="string"?k.split(/[\s,]+/)||[]:k;fe=1,Array.isArray(Ie)?this._set(+Ie[0],+(Ie.length>1?Ie[1]:Ie[0])):"x"in Ie?this._set(Ie.x||0,Ie.y||0):"width"in Ie?this._set(Ie.width||0,Ie.height||0):"angle"in Ie?(this._set(Ie.length||0,0),this.setAngle(Ie.angle||0)):(this._set(0,0),fe=0)}return te&&(this.__read=fe),this},set:"#initialize",_set:function(v,k){return this.x=v,this.y=k,this},equals:function(v){return this===v||v&&(this.x===v.x&&this.y===v.y||Array.isArray(v)&&this.x===v[0]&&this.y===v[1])||!1},clone:function(){return new be(this.x,this.y)},toString:function(){var v=he.instance;return"{ x: "+v.number(this.x)+", y: "+v.number(this.y)+" }"},_serialize:function(v){var k=v.formatter;return[k.number(this.x),k.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(v){if(this.isZero()){var k=this._angle||0;this._set(Math.cos(k)*v,Math.sin(k)*v)}else{var V=v/this.getLength();ae.isZero(V)&&this.getAngle(),this._set(this.x*V,this.y*V)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function(v){this.setAngleInRadians.call(this,v*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var v=be.read(arguments),k=this.getLength()*v.getLength();if(ae.isZero(k))return NaN;var V=this.dot(v)/k;return Math.acos(V<-1?-1:V>1?1:V)}else return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(v){if(this._angle=v,!this.isZero()){var k=this.getLength();this._set(Math.cos(v)*k,Math.sin(v)*k)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var v=be.read(arguments);return Math.atan2(this.cross(v),this.dot(v))*180/Math.PI},getDistance:function(){var v=arguments,k=be.read(v),V=k.x-this.x,Y=k.y-this.y,te=V*V+Y*Y,fe=x.read(v);return fe?te:Math.sqrt(te)},normalize:function(v){v===n&&(v=1);var k=this.getLength(),V=k!==0?v/k:0,Y=new be(this.x*V,this.y*V);return V>=0&&(Y._angle=this._angle),Y},rotate:function(v,k){if(v===0)return this.clone();v=v*Math.PI/180;var V=k?this.subtract(k):this,Y=Math.sin(v),te=Math.cos(v);return V=new be(V.x*te-V.y*Y,V.x*Y+V.y*te),k?V.add(k):V},transform:function(v){return v?v._transformPoint(this):this},add:function(){var v=be.read(arguments);return new be(this.x+v.x,this.y+v.y)},subtract:function(){var v=be.read(arguments);return new be(this.x-v.x,this.y-v.y)},multiply:function(){var v=be.read(arguments);return new be(this.x*v.x,this.y*v.y)},divide:function(){var v=be.read(arguments);return new be(this.x/v.x,this.y/v.y)},modulo:function(){var v=be.read(arguments);return new be(this.x%v.x,this.y%v.y)},negate:function(){return new be(-this.x,-this.y)},isInside:function(){return at.read(arguments).contains(this)},isClose:function(){var v=arguments,k=be.read(v),V=x.read(v);return this.getDistance(k)<=V},isCollinear:function(){var v=be.read(arguments);return be.isCollinear(this.x,this.y,v.x,v.y)},isColinear:"#isCollinear",isOrthogonal:function(){var v=be.read(arguments);return be.isOrthogonal(this.x,this.y,v.x,v.y)},isZero:function(){var v=ae.isZero;return v(this.x)&&v(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(v){return this.x*(v>1&&v<4?-1:1)>=0&&this.y*(v>2?-1:1)>=0},dot:function(){var v=be.read(arguments);return this.x*v.x+this.y*v.y},cross:function(){var v=be.read(arguments);return this.x*v.y-this.y*v.x},project:function(){var v=be.read(arguments),k=v.isZero()?0:this.dot(v)/v.dot(v);return new be(v.x*k,v.y*k)},statics:{min:function(){var v=arguments,k=be.read(v),V=be.read(v);return new be(Math.min(k.x,V.x),Math.min(k.y,V.y))},max:function(){var v=arguments,k=be.read(v),V=be.read(v);return new be(Math.max(k.x,V.x),Math.max(k.y,V.y))},random:function(){return new be(Math.random(),Math.random())},isCollinear:function(v,k,V,Y){return Math.abs(v*Y-k*V)<=Math.sqrt((v*v+k*k)*(V*V+Y*Y))*1e-8},isOrthogonal:function(v,k,V,Y){return Math.abs(v*V+k*Y)<=Math.sqrt((v*v+k*k)*(V*V+Y*Y))*1e-8}}},x.each(["round","ceil","floor","abs"],function(v){var k=Math[v];this[v]=function(){return new be(k(this.x),k(this.y))}},{})),je=be.extend({initialize:function(k,V,Y,te){this._x=k,this._y=V,this._owner=Y,this._setter=te},_set:function(v,k,V){return this._x=v,this._y=k,V||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(v){this._x=v,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(v){this._y=v,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(v){this._owner._changeSelection(this._getSelection(),v)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),nt=x.extend({_class:"Size",_readIndex:!0,initialize:function(k,V){var Y=typeof k,te=this.__read,fe=0;if(Y==="number"){var ve=typeof V=="number";this._set(k,ve?V:k),te&&(fe=ve?2:1)}else if(Y==="undefined"||k===null)this._set(0,0),te&&(fe=k===null?1:0);else{var Ie=Y==="string"?k.split(/[\s,]+/)||[]:k;fe=1,Array.isArray(Ie)?this._set(+Ie[0],+(Ie.length>1?Ie[1]:Ie[0])):"width"in Ie?this._set(Ie.width||0,Ie.height||0):"x"in Ie?this._set(Ie.x||0,Ie.y||0):(this._set(0,0),fe=0)}return te&&(this.__read=fe),this},set:"#initialize",_set:function(v,k){return this.width=v,this.height=k,this},equals:function(v){return v===this||v&&(this.width===v.width&&this.height===v.height||Array.isArray(v)&&this.width===v[0]&&this.height===v[1])||!1},clone:function(){return new nt(this.width,this.height)},toString:function(){var v=he.instance;return"{ width: "+v.number(this.width)+", height: "+v.number(this.height)+" }"},_serialize:function(v){var k=v.formatter;return[k.number(this.width),k.number(this.height)]},add:function(){var v=nt.read(arguments);return new nt(this.width+v.width,this.height+v.height)},subtract:function(){var v=nt.read(arguments);return new nt(this.width-v.width,this.height-v.height)},multiply:function(){var v=nt.read(arguments);return new nt(this.width*v.width,this.height*v.height)},divide:function(){var v=nt.read(arguments);return new nt(this.width/v.width,this.height/v.height)},modulo:function(){var v=nt.read(arguments);return new nt(this.width%v.width,this.height%v.height)},negate:function(){return new nt(-this.width,-this.height)},isZero:function(){var v=ae.isZero;return v(this.width)&&v(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(v,k){return new nt(Math.min(v.width,k.width),Math.min(v.height,k.height))},max:function(v,k){return new nt(Math.max(v.width,k.width),Math.max(v.height,k.height))},random:function(){return new nt(Math.random(),Math.random())}}},x.each(["round","ceil","floor","abs"],function(v){var k=Math[v];this[v]=function(){return new nt(k(this.width),k(this.height))}},{})),tt=nt.extend({initialize:function(k,V,Y,te){this._width=k,this._height=V,this._owner=Y,this._setter=te},_set:function(v,k,V){return this._width=v,this._height=k,V||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(v){this._width=v,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(v){this._height=v,this._owner[this._setter](this)}}),at=x.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(k,V,Y,te){var fe=arguments,ve=typeof k,Ie;if(ve==="number"?(this._set(k,V,Y,te),Ie=4):ve==="undefined"||k===null?(this._set(0,0,0,0),Ie=k===null?1:0):fe.length===1&&(Array.isArray(k)?(this._set.apply(this,k),Ie=1):k.x!==n||k.width!==n?(this._set(k.x||0,k.y||0,k.width||0,k.height||0),Ie=1):k.from===n&&k.to===n&&(this._set(0,0,0,0),x.readSupported(fe,this)&&(Ie=1))),Ie===n){var Ee=be.readNamed(fe,"from"),ze=x.peek(fe),We=Ee.x,He=Ee.y,Qe,Ue;if(ze&&ze.x!==n||x.hasNamed(fe,"to")){var ft=be.readNamed(fe,"to");Qe=ft.x-We,Ue=ft.y-He,Qe<0&&(We=ft.x,Qe=-Qe),Ue<0&&(He=ft.y,Ue=-Ue)}else{var st=nt.read(fe);Qe=st.width,Ue=st.height}this._set(We,He,Qe,Ue),Ie=fe.__index}var Me=fe.__filtered;return Me&&(this.__filtered=Me),this.__read&&(this.__read=Ie),this},set:"#initialize",_set:function(v,k,V,Y){return this.x=v,this.y=k,this.width=V,this.height=Y,this},clone:function(){return new at(this.x,this.y,this.width,this.height)},equals:function(v){var k=x.isPlainValue(v)?at.read(arguments):v;return k===this||k&&this.x===k.x&&this.y===k.y&&this.width===k.width&&this.height===k.height||!1},toString:function(){var v=he.instance;return"{ x: "+v.number(this.x)+", y: "+v.number(this.y)+", width: "+v.number(this.width)+", height: "+v.number(this.height)+" }"},_serialize:function(v){var k=v.formatter;return[k.number(this.x),k.number(this.y),k.number(this.width),k.number(this.height)]},getPoint:function(v){var k=v?be:je;return new k(this.x,this.y,this,"setPoint")},setPoint:function(){var v=be.read(arguments);this.x=v.x,this.y=v.y},getSize:function(v){var k=v?nt:tt;return new k(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var v=nt.read(arguments),k=this._sx,V=this._sy,Y=v.width,te=v.height;k&&(this.x+=(this.width-Y)*k),V&&(this.y+=(this.height-te)*V),this.width=Y,this.height=te,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(v){if(!this._fw){var k=v-this.x;this.width-=this._sx===.5?k*2:k}this.x=v,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(v){if(!this._fh){var k=v-this.y;this.height-=this._sy===.5?k*2:k}this.y=v,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(v){if(!this._fw){var k=v-this.x;this.width=this._sx===.5?k*2:k}this.x=v-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(v){if(!this._fh){var k=v-this.y;this.height=this._sy===.5?k*2:k}this.y=v-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(v){this._fw||this._sx===.5?this.x=v-this.width/2:(this._sx&&(this.x+=(v-this.x)*2*this._sx),this.width=(v-this.x)*2),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(v){this._fh||this._sy===.5?this.y=v-this.height/2:(this._sy&&(this.y+=(v-this.y)*2*this._sy),this.height=(v-this.y)*2),this._sy=.5,this._fh=0},getCenter:function(v){var k=v?be:je;return new k(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var v=be.read(arguments);return this.setCenterX(v.x),this.setCenterY(v.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function(v){return v&&v.width!==n||(Array.isArray(v)?v:arguments).length===4?this._containsRectangle(at.read(arguments)):this._containsPoint(be.read(arguments))},_containsPoint:function(v){var k=v.x,V=v.y;return k>=this.x&&V>=this.y&&k<=this.x+this.width&&V<=this.y+this.height},_containsRectangle:function(v){var k=v.x,V=v.y;return k>=this.x&&V>=this.y&&k+v.width<=this.x+this.width&&V+v.height<=this.y+this.height},intersects:function(){var v=at.read(arguments),k=x.read(arguments)||0;return v.x+v.width>this.x-k&&v.y+v.height>this.y-k&&v.x<this.x+this.width+k&&v.y<this.y+this.height+k},intersect:function(){var v=at.read(arguments),k=Math.max(this.x,v.x),V=Math.max(this.y,v.y),Y=Math.min(this.x+this.width,v.x+v.width),te=Math.min(this.y+this.height,v.y+v.height);return new at(k,V,Y-k,te-V)},unite:function(){var v=at.read(arguments),k=Math.min(this.x,v.x),V=Math.min(this.y,v.y),Y=Math.max(this.x+this.width,v.x+v.width),te=Math.max(this.y+this.height,v.y+v.height);return new at(k,V,Y-k,te-V)},include:function(){var v=be.read(arguments),k=Math.min(this.x,v.x),V=Math.min(this.y,v.y),Y=Math.max(this.x+this.width,v.x),te=Math.max(this.y+this.height,v.y);return new at(k,V,Y-k,te-V)},expand:function(){var v=nt.read(arguments),k=v.width,V=v.height;return new at(this.x-k/2,this.y-V/2,this.width+k,this.height+V)},scale:function(v,k){return this.expand(this.width*v-this.width,this.height*(k===n?v:k)-this.height)}},x.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(v,k){var V=v.join(""),Y=/^[RL]/.test(V);k>=4&&(v[1]+=Y?"Y":"X");var te=v[Y?0:1],fe=v[Y?1:0],ve="get"+te,Ie="get"+fe,Ee="set"+te,ze="set"+fe,We="get"+V,He="set"+V;this[We]=function(Qe){var Ue=Qe?be:je;return new Ue(this[ve](),this[Ie](),this,He)},this[He]=function(){var Qe=be.read(arguments);this[Ee](Qe.x),this[ze](Qe.y)}},{beans:!0})),ut=at.extend({initialize:function(k,V,Y,te,fe,ve){this._set(k,V,Y,te,!0),this._owner=fe,this._setter=ve},_set:function(v,k,V,Y,te){return this._x=v,this._y=k,this._width=V,this._height=Y,te||this._owner[this._setter](this),this}},new function(){var v=at.prototype;return x.each(["x","y","width","height"],function(k){var V=x.capitalize(k),Y="_"+k;this["get"+V]=function(){return this[Y]},this["set"+V]=function(te){this[Y]=te,this._dontNotify||this._owner[this._setter](this)}},x.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(k){var V="set"+k;this[V]=function(){this._dontNotify=!0,v[V].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(k){var V=this._owner;V._changeSelection&&V._changeSelection(2,k)}}))}),xt=x.extend({_class:"Matrix",initialize:function v(k,V){var Y=arguments,te=Y.length,fe=!0;if(te>=6?this._set.apply(this,Y):te===1||te===2?k instanceof v?this._set(k._a,k._b,k._c,k._d,k._tx,k._ty,V):Array.isArray(k)?this._set.apply(this,V?k.concat([V]):k):fe=!1:te?fe=!1:this.reset(),!fe)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(v,k,V,Y,te,fe,ve){return this._a=v,this._b=k,this._c=V,this._d=Y,this._tx=te,this._ty=fe,ve||this._changed(),this},_serialize:function(v,k){return x.serialize(this.getValues(),v,!0,k)},_changed:function(){var v=this._owner;v&&(v._applyMatrix?v.transform(null,!0):v._changed(25))},clone:function(){return new xt(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(v){return v===this||v&&this._a===v._a&&this._b===v._b&&this._c===v._c&&this._d===v._d&&this._tx===v._tx&&this._ty===v._ty},toString:function(){var v=he.instance;return"[["+[v.number(this._a),v.number(this._c),v.number(this._tx)].join(", ")+"], ["+[v.number(this._b),v.number(this._d),v.number(this._ty)].join(", ")+"]]"},reset:function(v){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,v||this._changed(),this},apply:function(v,k){var V=this._owner;return V?(V.transform(null,x.pick(v,!0),k),this.isIdentity()):!1},translate:function(){var v=be.read(arguments),k=v.x,V=v.y;return this._tx+=k*this._a+V*this._c,this._ty+=k*this._b+V*this._d,this._changed(),this},scale:function(){var v=arguments,k=be.read(v),V=be.read(v,0,{readNull:!0});return V&&this.translate(V),this._a*=k.x,this._b*=k.x,this._c*=k.y,this._d*=k.y,V&&this.translate(V.negate()),this._changed(),this},rotate:function(v){v*=Math.PI/180;var k=be.read(arguments,1),V=k.x,Y=k.y,te=Math.cos(v),fe=Math.sin(v),ve=V-V*te+Y*fe,Ie=Y-V*fe-Y*te,Ee=this._a,ze=this._b,We=this._c,He=this._d;return this._a=te*Ee+fe*We,this._b=te*ze+fe*He,this._c=-fe*Ee+te*We,this._d=-fe*ze+te*He,this._tx+=ve*Ee+Ie*We,this._ty+=ve*ze+Ie*He,this._changed(),this},shear:function(){var v=arguments,k=be.read(v),V=be.read(v,0,{readNull:!0});V&&this.translate(V);var Y=this._a,te=this._b;return this._a+=k.y*this._c,this._b+=k.y*this._d,this._c+=k.x*Y,this._d+=k.x*te,V&&this.translate(V.negate()),this._changed(),this},skew:function(){var v=arguments,k=be.read(v),V=be.read(v,0,{readNull:!0}),Y=Math.PI/180,te=new be(Math.tan(k.x*Y),Math.tan(k.y*Y));return this.shear(te,V)},append:function(v,k){if(v){var V=this._a,Y=this._b,te=this._c,fe=this._d,ve=v._a,Ie=v._c,Ee=v._b,ze=v._d,We=v._tx,He=v._ty;this._a=ve*V+Ee*te,this._c=Ie*V+ze*te,this._b=ve*Y+Ee*fe,this._d=Ie*Y+ze*fe,this._tx+=We*V+He*te,this._ty+=We*Y+He*fe,k||this._changed()}return this},prepend:function(v,k){if(v){var V=this._a,Y=this._b,te=this._c,fe=this._d,ve=this._tx,Ie=this._ty,Ee=v._a,ze=v._c,We=v._b,He=v._d,Qe=v._tx,Ue=v._ty;this._a=Ee*V+ze*Y,this._c=Ee*te+ze*fe,this._b=We*V+He*Y,this._d=We*te+He*fe,this._tx=Ee*ve+ze*Ie+Qe,this._ty=We*ve+He*Ie+Ue,k||this._changed()}return this},appended:function(v){return this.clone().append(v)},prepended:function(v){return this.clone().prepend(v)},invert:function(){var v=this._a,k=this._b,V=this._c,Y=this._d,te=this._tx,fe=this._ty,ve=v*Y-k*V,Ie=null;return ve&&!isNaN(ve)&&isFinite(te)&&isFinite(fe)&&(this._a=Y/ve,this._b=-k/ve,this._c=-V/ve,this._d=v/ve,this._tx=(V*fe-Y*te)/ve,this._ty=(k*te-v*fe)/ve,Ie=this),Ie},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new xt(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var v=this._a*this._d-this._c*this._b;return v&&!isNaN(v)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(v,k,V){return arguments.length<3?this._transformPoint(be.read(arguments)):this._transformCoordinates(v,k,V)},_transformPoint:function(v,k,V){var Y=v.x,te=v.y;return k||(k=new be),k._set(Y*this._a+te*this._c+this._tx,Y*this._b+te*this._d+this._ty,V)},_transformCoordinates:function(v,k,V){for(var Y=0,te=2*V;Y<te;Y+=2){var fe=v[Y],ve=v[Y+1];k[Y]=fe*this._a+ve*this._c+this._tx,k[Y+1]=fe*this._b+ve*this._d+this._ty}return k},_transformCorners:function(v){var k=v.x,V=v.y,Y=k+v.width,te=V+v.height,fe=[k,V,Y,V,Y,te,k,te];return this._transformCoordinates(fe,fe,4)},_transformBounds:function(v,k,V){for(var Y=this._transformCorners(v),te=Y.slice(0,2),fe=te.slice(),ve=2;ve<8;ve++){var Ie=Y[ve],Ee=ve&1;Ie<te[Ee]?te[Ee]=Ie:Ie>fe[Ee]&&(fe[Ee]=Ie)}return k||(k=new at),k._set(te[0],te[1],fe[0]-te[0],fe[1]-te[1],V)},inverseTransform:function(){return this._inverseTransform(be.read(arguments))},_inverseTransform:function(v,k,V){var Y=this._a,te=this._b,fe=this._c,ve=this._d,Ie=this._tx,Ee=this._ty,ze=Y*ve-te*fe,We=null;if(ze&&!isNaN(ze)&&isFinite(Ie)&&isFinite(Ee)){var He=v.x-this._tx,Qe=v.y-this._ty;k||(k=new be),We=k._set((He*ve-Qe*fe)/ze,(Qe*Y-He*te)/ze,V)}return We},decompose:function(){var v=this._a,k=this._b,V=this._c,Y=this._d,te=v*Y-k*V,fe=Math.sqrt,ve=Math.atan2,Ie=180/Math.PI,Ee,ze,We;if(v!==0||k!==0){var He=fe(v*v+k*k);Ee=Math.acos(v/He)*(k>0?1:-1),ze=[He,te/He],We=[ve(v*V+k*Y,He*He),0]}else if(V!==0||Y!==0){var Qe=fe(V*V+Y*Y);Ee=Math.asin(V/Qe)*(Y>0?1:-1),ze=[te/Qe,Qe],We=[0,ve(v*V+k*Y,Qe*Qe)]}else Ee=0,We=ze=[0,0];return{translation:this.getTranslation(),rotation:Ee*Ie,scaling:new be(ze),skewing:new be(We[0]*Ie,We[1]*Ie)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new be(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(v){this.isIdentity()||v.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},x.each(["a","b","c","d","tx","ty"],function(v){var k=x.capitalize(v),V="_"+v;this["get"+k]=function(){return this[V]},this["set"+k]=function(Y){this[V]=Y,this._changed()}},{})),Tt=x.extend({_class:"Line",initialize:function(k,V,Y,te,fe){var ve=!1;arguments.length>=4?(this._px=k,this._py=V,this._vx=Y,this._vy=te,ve=fe):(this._px=k.x,this._py=k.y,this._vx=V.x,this._vy=V.y,ve=Y),ve||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new be(this._px,this._py)},getVector:function(){return new be(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(v,k){return Tt.intersect(this._px,this._py,this._vx,this._vy,v._px,v._py,v._vx,v._vy,!0,k)},getSide:function(v,k){return Tt.getSide(this._px,this._py,this._vx,this._vy,v.x,v.y,!0,k)},getDistance:function(v){return Math.abs(this.getSignedDistance(v))},getSignedDistance:function(v){return Tt.getSignedDistance(this._px,this._py,this._vx,this._vy,v.x,v.y,!0)},isCollinear:function(v){return be.isCollinear(this._vx,this._vy,v._vx,v._vy)},isOrthogonal:function(v){return be.isOrthogonal(this._vx,this._vy,v._vx,v._vy)},statics:{intersect:function(v,k,V,Y,te,fe,ve,Ie,Ee,ze){Ee||(V-=v,Y-=k,ve-=te,Ie-=fe);var We=V*Ie-Y*ve;if(!ae.isMachineZero(We)){var He=v-te,Qe=k-fe,Ue=(ve*Qe-Ie*He)/We,ft=(V*Qe-Y*He)/We,st=1e-12,Me=-st,se=1+st;if(ze||Me<Ue&&Ue<se&&Me<ft&&ft<se)return ze||(Ue=Ue<=0?0:Ue>=1?1:Ue),new be(v+Ue*V,k+Ue*Y)}},getSide:function(v,k,V,Y,te,fe,ve,Ie){ve||(V-=v,Y-=k);var Ee=te-v,ze=fe-k,We=Ee*Y-ze*V;return!Ie&&ae.isMachineZero(We)&&(We=(Ee*V+Ee*V)/(V*V+Y*Y),We>=0&&We<=1&&(We=0)),We<0?-1:We>0?1:0},getSignedDistance:function(v,k,V,Y,te,fe,ve){return ve||(V-=v,Y-=k),V===0?Y>0?te-v:v-te:Y===0?V<0?fe-k:k-fe:((te-v)*Y-(fe-k)*V)/(Y>V?Y*Math.sqrt(1+V*V/(Y*Y)):V*Math.sqrt(1+Y*Y/(V*V)))},getDistance:function(v,k,V,Y,te,fe,ve){return Math.abs(Tt.getSignedDistance(v,k,V,Y,te,fe,ve))}}}),Mt=G.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(k){G.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new vn(null,null,this),this._view=Ri.create(this,k||rn.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(v,k){return x.serialize(this._children,v,!0,k)},_changed:function(v,k){if(v&1){var V=this._view;V&&(V._needsUpdate=!0,!V._requested&&V._autoUpdate&&V.requestUpdate())}var Y=this._changes;if(Y&&k){var te=this._changesById,fe=k._id,ve=te[fe];ve?ve.flags|=v:Y.push(te[fe]={item:k,flags:v})}},clear:function(){for(var v=this._children,k=v.length-1;k>=0;k--)v[k].remove()},isEmpty:function(){return!this._children.length},remove:function v(){return v.base.call(this)?(this._view&&this._view.remove(),!0):!1},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(v){this._currentStyle.set(v)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new it({project:this,insert:!0})},getSymbolDefinitions:function(){var v=[],k={};return this.getItems({class:Et,match:function(V){var Y=V._definition,te=Y._id;return k[te]||(k[te]=!0,v.push(Y)),!1}}),v},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var v=this._selectionItems,k=[];for(var V in v){var Y=v[V],te=Y._selection;te&1&&Y.isInserted()?k.push(Y):te||this._updateSelection(Y)}return k},_updateSelection:function(v){var k=v._id,V=this._selectionItems;v._selection?V[k]!==v&&(this._selectionCount++,V[k]=v):V[k]===v&&(this._selectionCount--,delete V[k])},selectAll:function(){for(var v=this._children,k=0,V=v.length;k<V;k++)v[k].setFullySelected(!0)},deselectAll:function(){var v=this._selectionItems;for(var k in v)v[k].setFullySelected(!1)},addLayer:function(v){return this.insertLayer(n,v)},insertLayer:function(v,k){if(k instanceof it){k._remove(!1,!0),x.splice(this._children,[k],v,0),k._setProject(this,!0);var V=k._name;V&&k.setName(V),this._changes&&k._changed(5),this._activeLayer||(this._activeLayer=k)}else k=null;return k},_insertItem:function(v,k,V){return k=this.insertLayer(v,k)||(this._activeLayer||this._insertItem(n,new it(Oe.NO_INSERT),!0)).insertChild(v,k),V&&k.activate&&k.activate(),k},getItems:function(v){return Oe._getItems(this,v)},getItem:function(v){return Oe._getItems(this,v,null,null,!0)[0]||null},importJSON:function(v){this.activate();var k=this._activeLayer;return x.importJSON(v,k&&k.isEmpty()&&k)},removeOn:function(v){var k=this._removeSets;if(k){v==="mouseup"&&(k.mousedrag=null);var V=k[v];if(V){for(var Y in V){var te=V[Y];for(var fe in k){var ve=k[fe];ve&&ve!=V&&delete ve[te._id]}te.remove()}k[v]=null}}},draw:function(v,k,V){this._updateVersion++,v.save(),k.applyToContext(v);for(var Y=this._children,te=new x({offset:new be(0,0),pixelRatio:V,viewMatrix:k.isIdentity()?null:k,matrices:[new xt],updateMatrix:!0}),fe=0,ve=Y.length;fe<ve;fe++)Y[fe].draw(v,te);if(v.restore(),this._selectionCount>0){v.save(),v.strokeWidth=1;var Ie=this._selectionItems,Ee=this._scope.settings.handleSize,ze=this._updateVersion;for(var We in Ie)Ie[We]._drawSelection(v,k,Ee,Ie,ze);v.restore()}}}),Oe=x.extend(S,{statics:{extend:function v(k){return k._serializeFields&&(k._serializeFields=x.set({},this.prototype._serializeFields,k._serializeFields)),v.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new xt,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var v=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return x.each(v,function(k){this._events[k]={install:function(V){this.getView()._countItemEvent(V,1)},uninstall:function(V){this.getView()._countItemEvent(V,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:v}})},{initialize:function(){},_initialize:function(v,k){var V=v&&x.isPlainObject(v),Y=V&&v.internal===!0,te=this._matrix=new xt,fe=V&&v.project||In.project,ve=In.settings;return this._id=Y?null:ue.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&ve.applyMatrix,k&&te.translate(k),te._owner=this,this._style=new vn(fe._currentStyle,this,fe),Y||V&&v.insert==!1||!ve.insertItems&&!(V&&v.insert==!0)?this._setProject(fe):(V&&v.parent||fe)._insertItem(n,this,!0),V&&v!==Oe.NO_INSERT&&v!==Oe.INSERT&&this.set(v,{internal:!0,insert:!0,project:!0,parent:!0}),V},_serialize:function(v,k){var V={},Y=this;function te(fe){for(var ve in fe){var Ie=Y[ve];x.equals(Ie,ve==="leading"?fe.fontSize*1.2:fe[ve])||(V[ve]=x.serialize(Ie,v,ve!=="data",k))}}return te(this._serializeFields),this instanceof jt||te(this._style._defaults),[this._class,V]},_changed:function(v){var k=this._symbol,V=this._parent||k,Y=this._project;v&8&&(this._bounds=this._position=this._decomposed=n),v&16&&(this._globalMatrix=n),V&&v&72&&Oe._clearBoundsCache(V),v&2&&Oe._clearBoundsCache(this),Y&&Y._changed(v,this),k&&k._changed(v)},getId:function(){return this._id},getName:function(){return this._name},setName:function(v){if(this._name&&this._removeNamed(),v===+v+"")throw new Error("Names consisting only of numbers are not supported.");var k=this._getOwner();if(v&&k){var V=k._children,Y=k._namedChildren;(Y[v]=Y[v]||[]).push(this),v in V||(V[v]=this)}this._name=v||n,this._changed(256)},getStyle:function(){return this._style},setStyle:function(v){this.getStyle().set(v)}},x.each(["locked","visible","blendMode","opacity","guide"],function(v){var k=x.capitalize(v),V="_"+v,Y={locked:256,visible:265};this["get"+k]=function(){return this[V]},this["set"+k]=function(te){te!=this[V]&&(this[V]=te,this._changed(Y[v]||257))}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(v){if(v!==this._selection){this._selection=v;var k=this._project;k&&(k._updateSelection(this),this._changed(257))}},_changeSelection:function(v,k){var V=this._selection;this.setSelection(k?V|v:V&~v)},isSelected:function(){if(this._selectChildren){for(var v=this._children,k=0,V=v.length;k<V;k++)if(v[k].isSelected())return!0}return!!(this._selection&1)},setSelected:function(v){if(this._selectChildren)for(var k=this._children,V=0,Y=k.length;V<Y;V++)k[V].setSelected(v);this._changeSelection(1,v)},isFullySelected:function(){var v=this._children,k=!!(this._selection&1);if(v&&k){for(var V=0,Y=v.length;V<Y;V++)if(!v[V].isFullySelected())return!1;return!0}return k},setFullySelected:function(v){var k=this._children;if(k)for(var V=0,Y=k.length;V<Y;V++)k[V].setFullySelected(v);this._changeSelection(1,v)},isClipMask:function(){return this._clipMask},setClipMask:function(v){this._clipMask!=(v=!!v)&&(this._clipMask=v,v&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(v){this._data=v},getPosition:function(v){var k=v?be:je,V=this._position||(this._position=this._getPositionFromBounds());return new k(V.x,V.y,this,"setPosition")},setPosition:function(){this.translate(be.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(v){return this._pivot?this._matrix._transformPoint(this._pivot):(v||this.getBounds()).getCenter(!0)},getPivot:function(){var v=this._pivot;return v?new je(v.x,v.y,this,"setPivot"):null},setPivot:function(){this._pivot=be.read(arguments,0,{clone:!0,readNull:!0}),this._position=n}},x.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(v,k){this[k]=function(V){return this.getBounds(V,v)}},{beans:!0,getBounds:function(v,k){var V=k||v instanceof xt,Y=x.set({},V?k:v,this._boundsOptions);(!Y.stroke||this.getStrokeScaling())&&(Y.cacheItem=this);var te=this._getCachedBounds(V&&v,Y).rect;return arguments.length?te:new ut(te.x,te.y,te.width,te.height,this,"setBounds")},setBounds:function(){var v=at.read(arguments),k=this.getBounds(),V=this._matrix,Y=new xt,te=v.getCenter();Y.translate(te),(v.width!=k.width||v.height!=k.height)&&(V.isInvertible()||(V.set(V._backup||new xt().translate(V.getTranslation())),k=this.getBounds()),Y.scale(k.width!==0?v.width/k.width:0,k.height!==0?v.height/k.height:0)),te=k.getCenter(),Y.translate(-te.x,-te.y),this.transform(Y)},_getBounds:function(v,k){var V=this._children;return!V||!V.length?new at:(Oe._updateBoundsCache(this,k.cacheItem),Oe._getBounds(V,v,k))},_getBoundsCacheKey:function(v,k){return[v.stroke?1:0,v.handle?1:0,k?1:0].join("")},_getCachedBounds:function(v,k,V){v=v&&v._orNullIfIdentity();var Y=k.internal&&!V,te=k.cacheItem,fe=Y?null:this._matrix._orNullIfIdentity(),ve=te&&(!v||v.equals(fe))&&this._getBoundsCacheKey(k,Y),Ie=this._bounds;if(Oe._updateBoundsCache(this._parent||this._symbol,te),ve&&Ie&&ve in Ie){var Ee=Ie[ve];return{rect:Ee.rect.clone(),nonscaling:Ee.nonscaling}}var ze=this._getBounds(v||fe,k),We=ze.rect||ze,He=this._style,Qe=ze.nonscaling||He.hasStroke()&&!He.getStrokeScaling();if(ve){Ie||(this._bounds=Ie={});var Ee=Ie[ve]={rect:We.clone(),nonscaling:Qe,internal:Y}}return{rect:We,nonscaling:Qe}},_getStrokeMatrix:function(v,k){var V=this.getStrokeScaling()?null:k&&k.internal?this:this._parent||this._symbol&&this._symbol._item,Y=V?V.getViewMatrix().invert():v;return Y&&Y._shiftless()},statics:{_updateBoundsCache:function(v,k){if(v&&k){var V=k._id,Y=v._boundsCache=v._boundsCache||{ids:{},list:[]};Y.ids[V]||(Y.list.push(k),Y.ids[V]=k)}},_clearBoundsCache:function(v){var k=v._boundsCache;if(k){v._bounds=v._position=v._boundsCache=n;for(var V=0,Y=k.list,te=Y.length;V<te;V++){var fe=Y[V];fe!==v&&(fe._bounds=fe._position=n,fe._boundsCache&&Oe._clearBoundsCache(fe))}}},_getBounds:function(v,k,V){var Y=1/0,te=-Y,fe=Y,ve=te,Ie=!1;V=V||{};for(var Ee=0,ze=v.length;Ee<ze;Ee++){var We=v[Ee];if(We._visible&&!We.isEmpty(!0)){var He=We._getCachedBounds(k&&k.appended(We._matrix),V,!0),Qe=He.rect;Y=Math.min(Qe.x,Y),fe=Math.min(Qe.y,fe),te=Math.max(Qe.x+Qe.width,te),ve=Math.max(Qe.y+Qe.height,ve),He.nonscaling&&(Ie=!0)}}return{rect:isFinite(Y)?new at(Y,fe,te-Y,ve-fe):new at,nonscaling:Ie}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var v=this._decompose();return v?v.rotation:0},setRotation:function(v){var k=this.getRotation();if(k!=null&&v!=null){var V=this._decomposed;this.rotate(v-k),V&&(V.rotation=v,this._decomposed=V)}},getScaling:function(){var v=this._decompose(),k=v&&v.scaling;return new je(k?k.x:1,k?k.y:1,this,"setScaling")},setScaling:function(){var v=this.getScaling(),k=be.read(arguments,0,{clone:!0,readNull:!0});if(v&&k&&!v.equals(k)){var V=this.getRotation(),Y=this._decomposed,te=new xt,fe=ae.isZero;if(fe(v.x)||fe(v.y))te.translate(Y.translation),V&&te.rotate(V),te.scale(k.x,k.y),this._matrix.set(te);else{var ve=this.getPosition(!0);te.translate(ve),V&&te.rotate(V),te.scale(k.x/v.x,k.y/v.y),V&&te.rotate(-V),te.translate(ve.negate()),this.transform(te)}Y&&(Y.scaling=k,this._decomposed=Y)}},getMatrix:function(){return this._matrix},setMatrix:function(){var v=this._matrix;v.set.apply(v,arguments)},getGlobalMatrix:function(v){var k=this._globalMatrix;if(k)for(var V=this._parent,Y=[];V;){if(!V._globalMatrix){k=null;for(var te=0,fe=Y.length;te<fe;te++)Y[te]._globalMatrix=null;break}Y.push(V),V=V._parent}if(!k){k=this._globalMatrix=this._matrix.clone();var V=this._parent;V&&k.prepend(V.getGlobalMatrix(!0))}return v?k:k.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(v){(this._applyMatrix=this._canApplyMatrix&&!!v)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(v,k){if(this._project!==v){this._project&&this._installEvents(!1),this._project=v;for(var V=this._children,Y=0,te=V&&V.length;Y<te;Y++)V[Y]._setProject(v);k=!0}k&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function v(k){v.base.call(this,k);for(var V=this._children,Y=0,te=V&&V.length;Y<te;Y++)V[Y]._installEvents(k)},getLayer:function(){for(var v=this;v=v._parent;)if(v instanceof it)return v;return null},getParent:function(){return this._parent},setParent:function(v){return v.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(v){this.removeChildren(),this.addChildren(v)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var v=this._getOwner();return v&&v._children[this._index+1]||null},getPreviousSibling:function(){var v=this._getOwner();return v&&v._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(v){return v===this||v&&this._class===v._class&&this._style.equals(v._style)&&this._matrix.equals(v._matrix)&&this._locked===v._locked&&this._visible===v._visible&&this._blendMode===v._blendMode&&this._opacity===v._opacity&&this._clipMask===v._clipMask&&this._guide===v._guide&&this._equals(v)||!1},_equals:function(v){return x.equals(this._children,v._children)},clone:function(v){var k=new this.constructor(Oe.NO_INSERT),V=this._children,Y=x.pick(v?v.insert:n,v===n||v===!0),te=x.pick(v?v.deep:n,!0);V&&k.copyAttributes(this),(!V||te)&&k.copyContent(this),V||k.copyAttributes(this),Y&&k.insertAbove(this);var fe=this._name,ve=this._parent;if(fe&&ve){for(var V=ve._children,Ie=fe,Ee=1;V[fe];)fe=Ie+" "+Ee++;fe!==Ie&&k.setName(fe)}return k},copyContent:function(v){for(var k=v._children,V=0,Y=k&&k.length;V<Y;V++)this.addChild(k[V].clone(!1),!0)},copyAttributes:function(v,k){this.setStyle(v._style);for(var V=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],Y=0,te=V.length;Y<te;Y++){var fe=V[Y];v.hasOwnProperty(fe)&&(this[fe]=v[fe])}k||this._matrix.set(v._matrix,!0),this.setApplyMatrix(v._applyMatrix),this.setPivot(v._pivot),this.setSelection(v._selection);var ve=v._data,Ie=v._name;this._data=ve?x.clone(ve):null,Ie&&this.setName(Ie)},rasterize:function(v,k){var V,Y,te;x.isPlainObject(v)?(V=v.resolution,Y=v.insert,te=v.raster):(V=v,Y=k),te||(te=new mt(Oe.NO_INSERT));var fe=this.getStrokeBounds(),ve=(V||this.getView().getResolution())/72,Ie=fe.getTopLeft().floor(),Ee=fe.getBottomRight().ceil(),ze=new nt(Ee.subtract(Ie)),We=ze.multiply(ve);if(te.setSize(We,!0),!We.isZero()){var He=te.getContext(!0),Qe=new xt().scale(ve).translate(Ie.negate());He.save(),Qe.applyToContext(He),this.draw(He,new x({matrices:[Qe]})),He.restore()}return te._matrix.set(new xt().translate(Ie.add(ze.divide(2))).scale(1/ve)),(Y===n||Y)&&te.insertAbove(this),te},contains:function(){var v=this._matrix;return v.isInvertible()&&!!this._contains(v._inverseTransform(be.read(arguments)))},_contains:function(v){var k=this._children;if(k){for(var V=k.length-1;V>=0;V--)if(k[V].contains(v))return!0;return!1}return v.isInside(this.getInternalBounds())},isInside:function(){return at.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new Ot.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(v,k){return v instanceof Oe?this._asPathItem().getIntersections(v._asPathItem(),null,k,!0).length>0:!1}},new function(){function v(){var Y=arguments;return this._hitTest(be.read(Y),dt.getOptions(Y))}function k(){var Y=arguments,te=be.read(Y),fe=dt.getOptions(Y),ve=[];return this._hitTest(te,new x({all:ve},fe)),ve}function V(Y,te,fe,ve){var Ie=this._children;if(Ie)for(var Ee=Ie.length-1;Ee>=0;Ee--){var ze=Ie[Ee],We=ze!==ve&&ze._hitTest(Y,te,fe);if(We&&!te.all)return We}return null}return Mt.inject({hitTest:v,hitTestAll:k,_hitTest:V}),{hitTest:v,hitTestAll:k,_hitTestChildren:V}},{_hitTest:function(v,k,V){if(this._locked||!this._visible||this._guide&&!k.guides||this.isEmpty())return null;var Y=this._matrix,te=V?V.appended(Y):this.getGlobalMatrix().prepend(this.getView()._matrix),fe=Math.max(k.tolerance,1e-12),ve=k._tolerancePadding=new nt(Ot._getStrokePadding(fe,Y._shiftless().invert()));if(v=Y._inverseTransform(v),!v||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(ve.multiply(2))._containsPoint(v))return null;var Ie=!(k.guides&&!this._guide||k.selected&&!this.isSelected()||k.type&&k.type!==x.hyphenate(this._class)||k.class&&!(this instanceof k.class)),Ee=k.match,ze=this,We,He;function Qe($){return $&&Ee&&!Ee($)&&($=null),$&&k.all&&k.all.push($),$}function Ue($,ie){var de=ie?We["get"+ie]():ze.getPosition();if(v.subtract(de).divide(ve).length<=1)return new dt($,ze,{name:ie?x.hyphenate(ie):$,point:de})}var ft=k.position,st=k.center,Me=k.bounds;if(Ie&&this._parent&&(ft||st||Me)){if((st||Me)&&(We=this.getInternalBounds()),He=ft&&Ue("position")||st&&Ue("center","Center"),!He&&Me)for(var se=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],ne=0;ne<8&&!He;ne++)He=Ue("bounds",se[ne]);He=Qe(He)}return He||(He=this._hitTestChildren(v,k,te)||Ie&&Qe(this._hitTestSelf(v,k,te,this.getStrokeScaling()?null:te._shiftless().invert()))||null),He&&He.point&&(He.point=Y.transform(He.point)),He},_hitTestSelf:function(v,k){if(k.fill&&this.hasFill()&&this._contains(v))return new dt("fill",this)},matches:function(v,k){function V(ve,Ie){for(var Ee in ve)if(ve.hasOwnProperty(Ee)){var ze=ve[Ee],We=Ie[Ee];if(x.isPlainObject(ze)&&x.isPlainObject(We)){if(!V(ze,We))return!1}else if(!x.equals(ze,We))return!1}return!0}var Y=typeof v;if(Y==="object"){for(var te in v)if(v.hasOwnProperty(te)&&!this.matches(te,v[te]))return!1;return!0}else{if(Y==="function")return v(this);if(v==="match")return k(this);var fe=/^(empty|editable)$/.test(v)?this["is"+x.capitalize(v)]():v==="type"?x.hyphenate(this._class):this[v];if(v==="class"){if(typeof k=="function")return this instanceof k;fe=this._class}if(typeof k=="function")return!!k(fe);if(k){if(k.test)return k.test(fe);if(x.isPlainObject(k))return V(k,fe)}return x.equals(fe,k)}},getItems:function(v){return Oe._getItems(this,v,this._matrix)},getItem:function(v){return Oe._getItems(this,v,this._matrix,null,!0)[0]||null},statics:{_getItems:function v(k,V,Y,te,fe){if(!te){var ve=typeof V=="object"&&V,Ie=ve&&ve.overlapping,Ee=ve&&ve.inside,ze=Ie||Ee,Qe=ze&&at.read([ze]);te={items:[],recursive:ve&&ve.recursive!==!1,inside:!!Ee,overlapping:!!Ie,rect:Qe,path:Ie&&new Ot.Rectangle({rectangle:Qe,insert:!1})},ve&&(V=x.filter({},V,{recursive:!0,inside:!0,overlapping:!0}))}var We=k._children,He=te.items,Qe=te.rect;Y=Qe&&(Y||new xt);for(var Ue=0,ft=We&&We.length;Ue<ft;Ue++){var st=We[Ue],Me=Y&&Y.appended(st._matrix),se=!0;if(Qe){var ze=st.getBounds(Me);if(!Qe.intersects(ze))continue;Qe.contains(ze)||te.overlapping&&(ze.contains(Qe)||te.path.intersects(st,Me))||(se=!1)}if(se&&st.matches(V)&&(He.push(st),fe)||(te.recursive!==!1&&v(st,V,Me,te,fe),fe&&He.length>0))break}return He}}},{importJSON:function(v){var k=x.importJSON(v,this);return k!==this?this.addChild(k):k},addChild:function(v){return this.insertChild(n,v)},insertChild:function(v,k){var V=k?this.insertChildren(v,[k]):null;return V&&V[0]},addChildren:function(v){return this.insertChildren(this._children.length,v)},insertChildren:function(v,k){var V=this._children;if(V&&k&&k.length>0){k=x.slice(k);for(var Y={},te=k.length-1;te>=0;te--){var fe=k[te],ve=fe&&fe._id;!fe||Y[ve]?k.splice(te,1):(fe._remove(!1,!0),Y[ve]=!0)}x.splice(V,k,v,0);for(var Ie=this._project,Ee=Ie._changes,te=0,ze=k.length;te<ze;te++){var fe=k[te],We=fe._name;fe._parent=this,fe._setProject(Ie,!0),We&&fe.setName(We),Ee&&fe._changed(5)}this._changed(11)}else k=null;return k},_insertItem:"#insertChild",_insertAt:function(v,k){var V=v&&v._getOwner(),Y=v!==this&&V?this:null;return Y&&(Y._remove(!1,!0),V._insertItem(v._index+k,Y)),Y},insertAbove:function(v){return this._insertAt(v,1)},insertBelow:function(v){return this._insertAt(v,0)},sendToBack:function(){var v=this._getOwner();return v?v._insertItem(0,this):null},bringToFront:function(){var v=this._getOwner();return v?v._insertItem(n,this):null},appendTop:"#addChild",appendBottom:function(v){return this.insertChild(0,v)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(v){return v._insertItem(n,this)},copyTo:function(v){return this.clone(!1).addTo(v)},reduce:function(v){var k=this._children;if(k&&k.length===1){var V=k[0].reduce(v);return this._parent?(V.insertAbove(this),this.remove()):V.remove(),V}return this},_removeNamed:function(){var v=this._getOwner();if(v){var k=v._children,V=v._namedChildren,Y=this._name,te=V[Y],fe=te?te.indexOf(this):-1;fe!==-1&&(k[Y]==this&&delete k[Y],te.splice(fe,1),te.length?k[Y]=te[0]:delete V[Y])}},_remove:function(v,k){var V=this._getOwner(),Y=this._project,te=this._index;return this._style&&this._style._dispose(),V?(this._name&&this._removeNamed(),te!=null&&(Y._activeLayer===this&&(Y._activeLayer=this.getNextSibling()||this.getPreviousSibling()),x.splice(V._children,null,te,1)),this._installEvents(!1),v&&Y._changes&&this._changed(5),k&&V._changed(11,this),this._parent=null,!0):!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(v){var k=v&&v.insertBelow(this);return k&&this.remove(),k},removeChildren:function(v,k){if(!this._children)return null;v=v||0,k=x.pick(k,this._children.length);for(var V=x.splice(this._children,null,v,k-v),Y=V.length-1;Y>=0;Y--)V[Y]._remove(!0,!1);return V.length>0&&this._changed(11),V},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var v=0,k=this._children.length;v<k;v++)this._children[v]._index=v;this._changed(11)}},isEmpty:function(v){var k=this._children,V=k?k.length:0;if(v){for(var Y=0;Y<V;Y++)if(!k[Y].isEmpty(v))return!1;return!0}return!V},isEditable:function(){for(var v=this;v;){if(!v._visible||v._locked)return!1;v=v._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(v){function k(ve){var Ie=[];do Ie.unshift(ve);while(ve=ve._parent);return Ie}for(var V=k(this),Y=k(v),te=0,fe=Math.min(V.length,Y.length);te<fe;te++)if(V[te]!=Y[te])return V[te]._index<Y[te]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function(v){return this._getOrder(v)===-1},isBelow:function(v){return this._getOrder(v)===1},isParent:function(v){return this._parent===v},isChild:function(v){return v&&v._parent===this},isDescendant:function(v){for(var k=this;k=k._parent;)if(k===v)return!0;return!1},isAncestor:function(v){return v?v.isDescendant(this):!1},isSibling:function(v){return this._parent===v._parent},isGroupedWith:function(v){for(var k=this._parent;k;){if(k._parent&&/^(Group|Layer|CompoundPath)$/.test(k._class)&&v.isDescendant(k))return!0;k=k._parent}return!1}},x.each(["rotate","scale","shear","skew"],function(v){var k=v==="rotate";this[v]=function(){var V=arguments,Y=(k?x:be).read(V),te=be.read(V,0,{readNull:!0});return this.transform(new xt()[v](Y,te||this.getPosition(!0)))}},{translate:function(){var v=new xt;return this.transform(v.translate.apply(v,arguments))},transform:function(v,k,V){var Y=this._matrix,te=v&&!v.isIdentity(),fe=V&&this._canApplyMatrix||this._applyMatrix&&(te||!Y.isIdentity()||k&&this._children);if(!te&&!fe)return this;if(te){!v.isInvertible()&&Y.isInvertible()&&(Y._backup=Y.getValues()),Y.prepend(v,!0);var ve=this._style,Ie=ve.getFillColor(!0),Ee=ve.getStrokeColor(!0);Ie&&Ie.transform(v),Ee&&Ee.transform(v)}if(fe&&(fe=this._transformContent(Y,k,V))){var ze=this._pivot;ze&&Y._transformPoint(ze,ze,!0),Y.reset(!0),V&&this._canApplyMatrix&&(this._applyMatrix=!0)}var We=this._bounds,He=this._position;(te||fe)&&this._changed(25);var Qe=te&&We&&v.decompose();if(Qe&&Qe.skewing.isZero()&&Qe.rotation%90===0){for(var Ue in We){var ft=We[Ue];if(ft.nonscaling)delete We[Ue];else if(fe||!ft.internal){var st=ft.rect;v._transformBounds(st,st)}}this._bounds=We;var Me=We[this._getBoundsCacheKey(this._boundsOptions||{})];Me&&(this._position=this._getPositionFromBounds(Me.rect))}else te&&He&&this._pivot&&(this._position=v._transformPoint(He,He));return this},_transformContent:function(v,k,V){var Y=this._children;if(Y){for(var te=0,fe=Y.length;te<fe;te++)Y[te].transform(v,k,V);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(be.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(be.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(be.read(arguments))},localToParent:function(){return this._matrix._transformPoint(be.read(arguments))},fitBounds:function(v,k){v=at.read(arguments);var V=this.getBounds(),Y=V.height/V.width,te=v.height/v.width,fe=(k?Y>te:Y<te)?v.width/V.width:v.height/V.height,ve=new at(new be,new nt(V.width*fe,V.height*fe));ve.setCenter(v.getCenter()),this.setBounds(ve)}}),{_setStyles:function(v,k,V){var Y=this._style,te=this._matrix;if(Y.hasFill()&&(v.fillStyle=Y.getFillColor().toCanvasStyle(v,te)),Y.hasStroke()){v.strokeStyle=Y.getStrokeColor().toCanvasStyle(v,te),v.lineWidth=Y.getStrokeWidth();var fe=Y.getStrokeJoin(),ve=Y.getStrokeCap(),Ie=Y.getMiterLimit();if(fe&&(v.lineJoin=fe),ve&&(v.lineCap=ve),Ie&&(v.miterLimit=Ie),In.support.nativeDash){var Ee=Y.getDashArray(),ze=Y.getDashOffset();Ee&&Ee.length&&("setLineDash"in v?(v.setLineDash(Ee),v.lineDashOffset=ze):(v.mozDash=Ee,v.mozDashOffset=ze))}}if(Y.hasShadow()){var We=k.pixelRatio||1,He=V._shiftless().prepend(new xt().scale(We,We)),Qe=He.transform(new be(Y.getShadowBlur(),0)),Ue=He.transform(this.getShadowOffset());v.shadowColor=Y.getShadowColor().toCanvasStyle(v),v.shadowBlur=Qe.getLength(),v.shadowOffsetX=Ue.x,v.shadowOffsetY=Ue.y}},draw:function(v,k,V){if(this._updateVersion=this._project._updateVersion,!(!this._visible||this._opacity===0)){var Y=k.matrices,te=k.viewMatrix,fe=this._matrix,ve=Y[Y.length-1].appended(fe);if(ve.isInvertible()){te=te?te.appended(ve):ve,Y.push(ve),k.updateMatrix&&(this._globalMatrix=ve);var Ie=this._blendMode,Ee=ae.clamp(this._opacity,0,1),ze=Ie==="normal",We=tr.nativeModes[Ie],He=ze&&Ee===1||k.dontStart||k.clip||(We||ze&&Ee<1)&&this._canComposite(),Qe=k.pixelRatio||1,Ue,ft,st;if(!He){var Me=this.getStrokeBounds(te);if(!Me.width||!Me.height){Y.pop();return}st=k.offset,ft=k.offset=Me.getTopLeft().floor(),Ue=v,v=rn.getContext(Me.getSize().ceil().add(1).multiply(Qe)),Qe!==1&&v.scale(Qe,Qe)}v.save();var se=V?V.appended(fe):this._canScaleStroke&&!this.getStrokeScaling(!0)&&te,ne=!He&&k.clipItem,$=!se||ne;if(He?(v.globalAlpha=Ee,We&&(v.globalCompositeOperation=Ie)):$&&v.translate(-ft.x,-ft.y),$&&(He?fe:te).applyToContext(v),ne&&k.clipItem.draw(v,k.extend({clip:!0})),se){v.setTransform(Qe,0,0,Qe,0,0);var ie=k.offset;ie&&v.translate(-ie.x,-ie.y)}this._draw(v,k,te,se),v.restore(),Y.pop(),k.clip&&!k.dontFinish&&v.clip(this.getFillRule()),He||(tr.process(Ie,v,Ue,Ee,ft.subtract(st).multiply(Qe)),rn.release(v),k.offset=st)}}},_isUpdated:function(v){var k=this._parent;if(k instanceof gi)return k._isUpdated(v);var V=this._updateVersion===v;return!V&&k&&k._visible&&k._isUpdated(v)&&(this._updateVersion=v,V=!0),V},_drawSelection:function(v,k,V,Y,te){var fe=this._selection,ve=fe&1,Ie=fe&2||ve&&this._selectBounds,Ee=fe&4;if(this._drawSelected||(ve=!1),(ve||Ie||Ee)&&this._isUpdated(te)){var ze,We=this.getSelectedColor(!0)||(ze=this.getLayer())&&ze.getSelectedColor(!0),He=k.appended(this.getGlobalMatrix(!0)),Qe=V/2;if(v.strokeStyle=v.fillStyle=We?We.toCanvasStyle(v):"#009dec",ve&&this._drawSelected(v,He,Y),Ee){var Ue=this.getPosition(!0),ft=this._parent,st=ft?ft.localToGlobal(Ue):Ue,Me=st.x,se=st.y;v.beginPath(),v.arc(Me,se,Qe,0,Math.PI*2,!0),v.stroke();for(var ne=[[0,-1],[1,0],[0,1],[-1,0]],$=Qe,ie=V+1,de=0;de<4;de++){var ye=ne[de],ge=ye[0],Pe=ye[1];v.moveTo(Me+ge*$,se+Pe*$),v.lineTo(Me+ge*ie,se+Pe*ie),v.stroke()}}if(Ie){var Fe=He._transformCorners(this.getInternalBounds());v.beginPath();for(var de=0;de<8;de++)v[de?"lineTo":"moveTo"](Fe[de],Fe[++de]);v.closePath(),v.stroke();for(var de=0;de<8;de++)v.fillRect(Fe[de]-Qe,Fe[++de]-Qe,V,V)}}},_canComposite:function(){return!1}},x.each(["down","drag","up","move"],function(v){this["removeOn"+x.capitalize(v)]=function(){var k={};return k[v]=!0,this.removeOn(k)}},{removeOn:function(v){for(var k in v)if(v[k]){var V="mouse"+k,Y=this._project,te=Y._removeSets=Y._removeSets||{};te[V]=te[V]||{},te[V][this._id]=this}return this}}),{tween:function(v,k,V){V||(V=k,k=v,v=null,V||(V=k,k=null));var Y=V&&V.easing,te=V&&V.start,fe=V!=null&&(typeof V=="number"?V:V.duration),ve=new Pr(this,v,k,fe,Y,te);function Ie(Ee){ve._handleFrame(Ee.time*1e3),ve.running||this.off("frame",Ie)}return fe&&this.on("frame",Ie),ve},tweenTo:function(v,k){return this.tween(null,v,k)},tweenFrom:function(v,k){return this.tween(v,null,k)}}),jt=Oe.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(k){this._children=[],this._namedChildren={},this._initialize(k)||this.addChildren(Array.isArray(k)?k:arguments)},_changed:function v(k){v.base.call(this,k),k&2050&&(this._clipItem=n)},_getClipItem:function(){var v=this._clipItem;if(v===n){v=null;for(var k=this._children,V=0,Y=k.length;V<Y;V++)if(k[V]._clipMask){v=k[V];break}this._clipItem=v}return v},isClipped:function(){return!!this._getClipItem()},setClipped:function(v){var k=this.getFirstChild();k&&k.setClipMask(v)},_getBounds:function v(k,V){var Y=this._getClipItem();return Y?Y._getCachedBounds(Y._matrix.prepended(k),x.set({},V,{stroke:!1})):v.base.call(this,k,V)},_hitTestChildren:function v(k,V,Y){var te=this._getClipItem();return(!te||te.contains(k))&&v.base.call(this,k,V,Y,te)},_draw:function(v,k){var V=k.clip,Y=!V&&this._getClipItem();k=k.extend({clipItem:Y,clip:!1}),V?(v.beginPath(),k.dontStart=k.dontFinish=!0):Y&&Y.draw(v,k.extend({clip:!0}));for(var te=this._children,fe=0,ve=te.length;fe<ve;fe++){var Ie=te[fe];Ie!==Y&&Ie.draw(v,k)}}}),it=jt.extend({_class:"Layer",initialize:function(){jt.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function v(){return this._parent?v.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),vt=Oe.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(k,V){this._initialize(k,V)},_equals:function(v){return this._type===v._type&&this._size.equals(v._size)&&x.equals(this._radius,v._radius)},copyContent:function(v){this.setType(v._type),this.setSize(v._size),this.setRadius(v._radius)},getType:function(){return this._type},setType:function(v){this._type=v},getShape:"#getType",setShape:"#setType",getSize:function(){var v=this._size;return new tt(v.width,v.height,this,"setSize")},setSize:function(){var v=nt.read(arguments);if(!this._size)this._size=v.clone();else if(!this._size.equals(v)){var k=this._type,V=v.width,Y=v.height;k==="rectangle"?this._radius.set(nt.min(this._radius,v.divide(2).abs())):k==="circle"?(V=Y=(V+Y)/2,this._radius=V/2):k==="ellipse"&&this._radius._set(V/2,Y/2),this._size._set(V,Y),this._changed(9)}},getRadius:function(){var v=this._radius;return this._type==="circle"?v:new tt(v.width,v.height,this,"setRadius")},setRadius:function(v){var k=this._type;if(k==="circle"){if(v===this._radius)return;var V=v*2;this._radius=v,this._size._set(V,V)}else if(v=nt.read(arguments),!this._radius)this._radius=v.clone();else{if(this._radius.equals(v))return;if(this._radius.set(v),k==="rectangle"){var V=nt.max(this._size,v.multiply(2));this._size.set(V)}else k==="ellipse"&&this._size._set(v.width*2,v.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function(v){var k=new Ot[x.capitalize(this._type)]({center:new be,size:this._size,radius:this._radius,insert:!1});return k.copyAttributes(this),In.settings.applyMatrix&&k.setApplyMatrix(!0),(v===n||v)&&k.insertAbove(this),k},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(v,k,V,Y){var te=this._style,fe=te.hasFill(),ve=te.hasStroke(),Ie=k.dontFinish||k.clip,Ee=!Y;if(fe||ve||Ie){var ze=this._type,We=this._radius,He=ze==="circle";if(k.dontStart||v.beginPath(),Ee&&He)v.arc(0,0,We,0,Math.PI*2,!0);else{var Qe=He?We:We.width,Ue=He?We:We.height,ft=this._size,st=ft.width,Me=ft.height;if(Ee&&ze==="rectangle"&&Qe===0&&Ue===0)v.rect(-st/2,-Me/2,st,Me);else{var se=st/2,ne=Me/2,$=1-.5522847498307936,ie=Qe*$,de=Ue*$,ye=[-se,-ne+Ue,-se,-ne+de,-se+ie,-ne,-se+Qe,-ne,se-Qe,-ne,se-ie,-ne,se,-ne+de,se,-ne+Ue,se,ne-Ue,se,ne-de,se-ie,ne,se-Qe,ne,-se+Qe,ne,-se+ie,ne,-se,ne-de,-se,ne-Ue];Y&&Y.transform(ye,ye,32),v.moveTo(ye[0],ye[1]),v.bezierCurveTo(ye[2],ye[3],ye[4],ye[5],ye[6],ye[7]),se!==Qe&&v.lineTo(ye[8],ye[9]),v.bezierCurveTo(ye[10],ye[11],ye[12],ye[13],ye[14],ye[15]),ne!==Ue&&v.lineTo(ye[16],ye[17]),v.bezierCurveTo(ye[18],ye[19],ye[20],ye[21],ye[22],ye[23]),se!==Qe&&v.lineTo(ye[24],ye[25]),v.bezierCurveTo(ye[26],ye[27],ye[28],ye[29],ye[30],ye[31])}}v.closePath()}!Ie&&(fe||ve)&&(this._setStyles(v,k,V),fe&&(v.fill(te.getFillRule()),v.shadowColor="rgba(0,0,0,0)"),ve&&v.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(v,k){var V=new at(this._size).setCenter(0,0),Y=this._style,te=k.stroke&&Y.hasStroke()&&Y.getStrokeWidth();return v&&(V=v._transformBounds(V)),te?V.expand(Ot._getStrokePadding(te,this._getStrokeMatrix(v,k))):V}},new function(){function v(V,Y,te){var fe=V._radius;if(!fe.isZero())for(var ve=V._size.divide(2),Ie=1;Ie<=4;Ie++){var Ee=new be(Ie>1&&Ie<4?-1:1,Ie>2?-1:1),ze=Ee.multiply(ve),We=ze.subtract(Ee.multiply(fe)),He=new at(te?ze.add(Ee.multiply(te)):ze,We);if(He.contains(Y))return{point:We,quadrant:Ie}}}function k(V,Y,te,fe){var ve=V.divide(Y);return(!fe||ve.isInQuadrant(fe))&&ve.subtract(ve.normalize()).multiply(Y).divide(te).length<=1}return{_contains:function V(Y){if(this._type==="rectangle"){var te=v(this,Y);return te?Y.subtract(te.point).divide(this._radius).getLength()<=1:V.base.call(this,Y)}else return Y.divide(this.size).getLength()<=.5},_hitTestSelf:function V(Y,te,fe,ve){var Ie=!1,Ee=this._style,ze=te.stroke&&Ee.hasStroke(),We=te.fill&&Ee.hasFill();if(ze||We){var He=this._type,Qe=this._radius,Ue=ze?Ee.getStrokeWidth()/2:0,ft=te._tolerancePadding.add(Ot._getStrokePadding(Ue,!Ee.getStrokeScaling()&&ve));if(He==="rectangle"){var st=ft.multiply(2),Me=v(this,Y,st);if(Me)Ie=k(Y.subtract(Me.point),Qe,ft,Me.quadrant);else{var se=new at(this._size).setCenter(0,0),ne=se.expand(st),$=se.expand(st.negate());Ie=ne._containsPoint(Y)&&!$._containsPoint(Y)}}else Ie=k(Y,Qe,ft)}return Ie?new dt(ze?"stroke":"fill",this):V.base.apply(this,arguments)}}},{statics:new function(){function v(k,V,Y,te,fe){var ve=x.create(vt.prototype);return ve._type=k,ve._size=Y,ve._radius=te,ve._initialize(x.getNamed(fe),V),ve}return{Circle:function(){var k=arguments,V=be.readNamed(k,"center"),Y=x.readNamed(k,"radius");return v("circle",V,new nt(Y*2),Y,k)},Rectangle:function(){var k=arguments,V=at.readNamed(k,"rectangle"),Y=nt.min(nt.readNamed(k,"radius"),V.getSize(!0).divide(2));return v("rectangle",V.getCenter(!0),V.getSize(!0),Y,k)},Ellipse:function(){var k=arguments,V=vt._readEllipse(k),Y=V.radius;return v("ellipse",V.center,Y.multiply(2),Y,k)},_readEllipse:function(k){var V,Y;if(x.hasNamed(k,"radius"))V=be.readNamed(k,"center"),Y=nt.readNamed(k,"radius");else{var te=at.readNamed(k,"rectangle");V=te.getCenter(!0),Y=te.getSize(!0).divide(2)}return{center:V,radius:Y}}}}}),mt=Oe.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(k,V){if(!this._initialize(k,V!==n&&be.read(arguments))){var Y,te=typeof k,fe=te==="string"?g.getElementById(k):te==="object"?k:null;if(fe&&fe!==Oe.NO_INSERT){if(fe.getContext||fe.naturalHeight!=null)Y=fe;else if(fe){var ve=nt.read(arguments);ve.isZero()||(Y=rn.getCanvas(ve))}}Y?this.setImage(Y):this.setSource(k)}this._size||(this._size=new nt,this._loaded=!1)},_equals:function(v){return this.getSource()===v.getSource()},copyContent:function(v){var k=v._image,V=v._canvas;if(k)this._setImage(k);else if(V){var Y=rn.getCanvas(v._size);Y.getContext("2d").drawImage(V,0,0),this._setImage(Y)}this._crossOrigin=v._crossOrigin},getSize:function(){var v=this._size;return new tt(v?v.width:0,v?v.height:0,this,"setSize")},setSize:function(v,k){var V=nt.read(arguments);if(V.equals(this._size))k&&this.clear();else if(V.width>0&&V.height>0){var Y=!k&&this.getElement();this._setImage(rn.getCanvas(V)),Y&&this.getContext(!0).drawImage(Y,0,0,V.width,V.height)}else this._canvas&&rn.release(this._canvas),this._size=V.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(v){this.setSize(v,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(v){this.setSize(this.getWidth(),v)},getLoaded:function(){return this._loaded},isEmpty:function(){var v=this._size;return!v||v.width===0&&v.height===0},getResolution:function(){var v=this._matrix,k=new be(0,0).transform(v),V=new be(1,0).transform(v).subtract(k),Y=new be(0,1).transform(v).subtract(k);return new nt(72/V.getLength(),72/Y.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(v){var k=this;function V(Y){var te=k.getView(),fe=Y&&Y.type||"load";te&&k.responds(fe)&&(In=te._scope,k.emit(fe,new _i(Y)))}this._setImage(v),this._loaded?setTimeout(V,0):v&&mi.add(v,{load:function(Y){k._setImage(v),V(Y)},error:V})},_setImage:function(v){this._canvas&&rn.release(this._canvas),v&&v.getContext?(this._image=null,this._canvas=v,this._loaded=!0):(this._image=v,this._canvas=null,this._loaded=!!(v&&v.src&&v.complete)),this._size=new nt(v?v.naturalWidth||v.width:0,v?v.naturalHeight||v.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var v=rn.getContext(this._size);try{this._image&&v.drawImage(this._image,0,0),this._canvas=v.canvas}catch{rn.release(v)}}return this._canvas},setCanvas:"#setImage",getContext:function(v){return this._context||(this._context=this.getCanvas().getContext("2d")),v&&(this._image=null,this._changed(1025)),this._context},setContext:function(v){this._context=v},getSource:function(){var v=this._image;return v&&v.src||this.toDataURL()},setSource:function(v){var k=new t.Image,V=this._crossOrigin;V&&(k.crossOrigin=V),v&&(k.src=v),this.setImage(k)},getCrossOrigin:function(){var v=this._image;return v&&v.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(v){this._crossOrigin=v;var k=this._image;k&&(k.crossOrigin=v)},getSmoothing:function(){return this._smoothing},setSmoothing:function(v){this._smoothing=typeof v=="string"?v:v?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var v=at.read(arguments),k=rn.getContext(v.getSize());return k.drawImage(this.getCanvas(),v.x,v.y,v.width,v.height,0,0,v.width,v.height),k.canvas},getSubRaster:function(){var v=at.read(arguments),k=new mt(Oe.NO_INSERT);return k._setImage(this.getSubCanvas(v)),k.translate(v.getCenter().subtract(this.getSize().divide(2))),k._matrix.prepend(this._matrix),k.insertAbove(this),k},toDataURL:function(){var v=this._image,k=v&&v.src;if(/^data:/.test(k))return k;var V=this.getCanvas();return V?V.toDataURL.apply(V,arguments):null},drawImage:function(v){var k=be.read(arguments,1);this.getContext(!0).drawImage(v,k.x,k.y)},getAverageColor:function(v){var k,V;if(v?v instanceof zt?(V=v,k=v.getBounds()):typeof v=="object"&&("width"in v?k=new at(v):"x"in v&&(k=new at(v.x-.5,v.y-.5,1,1))):k=this.getBounds(),!k)return null;var Y=32,te=Math.min(k.width,Y),fe=Math.min(k.height,Y),ve=mt._sampleContext;ve?ve.clearRect(0,0,Y+1,Y+1):ve=mt._sampleContext=rn.getContext(new nt(Y)),ve.save();var Ie=new xt().scale(te/k.width,fe/k.height).translate(-k.x,-k.y);Ie.applyToContext(ve),V&&V.draw(ve,new x({clip:!0,matrices:[Ie]})),this._matrix.applyToContext(ve);var Ee=this.getElement(),ze=this._size;Ee&&ve.drawImage(Ee,-ze.width/2,-ze.height/2),ve.restore();for(var We=ve.getImageData(.5,.5,Math.ceil(te),Math.ceil(fe)).data,He=[0,0,0],Qe=0,Ue=0,ft=We.length;Ue<ft;Ue+=4){var st=We[Ue+3];Qe+=st,st/=255,He[0]+=We[Ue]*st,He[1]+=We[Ue+1]*st,He[2]+=We[Ue+2]*st}for(var Ue=0;Ue<3;Ue++)He[Ue]/=Qe;return Qe?ji.read(He):null},getPixel:function(){var v=be.read(arguments),k=this.getContext().getImageData(v.x,v.y,1,1).data;return new ji("rgb",[k[0]/255,k[1]/255,k[2]/255],k[3]/255)},setPixel:function(){var v=arguments,k=be.read(v),V=ji.read(v),Y=V._convert("rgb"),te=V._alpha,fe=this.getContext(!0),ve=fe.createImageData(1,1),Ie=ve.data;Ie[0]=Y[0]*255,Ie[1]=Y[1]*255,Ie[2]=Y[2]*255,Ie[3]=te!=null?te*255:255,fe.putImageData(ve,k.x,k.y)},clear:function(){var v=this._size;this.getContext(!0).clearRect(0,0,v.width+1,v.height+1)},createImageData:function(){var v=nt.read(arguments);return this.getContext().createImageData(v.width,v.height)},getImageData:function(){var v=at.read(arguments);return v.isEmpty()&&(v=new at(this._size)),this.getContext().getImageData(v.x,v.y,v.width,v.height)},putImageData:function(v){var k=be.read(arguments,1);this.getContext(!0).putImageData(v,k.x,k.y)},setImageData:function(v){this.setSize(v),this.getContext(!0).putImageData(v,0,0)},_getBounds:function(v,k){var V=new at(this._size).setCenter(0,0);return v?v._transformBounds(V):V},_hitTestSelf:function(v){if(this._contains(v)){var k=this;return new dt("pixel",k,{offset:v.add(k._size.divide(2)).round(),color:{get:function(){return k.getPixel(this.offset)}}})}},_draw:function(v,k,V){var Y=this.getElement();if(Y&&Y.width>0&&Y.height>0){v.globalAlpha=ae.clamp(this._opacity,0,1),this._setStyles(v,k,V);var te=this._smoothing,fe=te==="off";Ci.setPrefixed(v,fe?"imageSmoothingEnabled":"imageSmoothingQuality",fe?!1:te),v.drawImage(Y,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),Et=Oe.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(k,V){this._initialize(k,V!==n&&be.read(arguments,1))||this.setDefinition(k instanceof Pt?k:new Pt(k))},_equals:function(v){return this._definition===v._definition},copyContent:function(v){this.setDefinition(v._definition)},getDefinition:function(){return this._definition},setDefinition:function(v){this._definition=v,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(v,k){var V=this._definition._item;return V._getCachedBounds(V._matrix.prepended(v),k)},_hitTestSelf:function(v,k,V){var Y=k.extend({all:!1}),te=this._definition._item._hitTest(v,Y,V);return te&&(te.item=this),te},_draw:function(v,k){this._definition._item.draw(v,k)}}),Pt=x.extend({_class:"SymbolDefinition",initialize:function(k,V){this._id=ue.get(),this.project=In.project,k&&this.setItem(k,V)},_serialize:function(v,k){return k.add(this,function(){return x.serialize([this._class,this._item],v,!1,k)})},_changed:function(v){v&8&&Oe._clearBoundsCache(this),v&1&&this.project._changed(v)},getItem:function(){return this._item},setItem:function(v,k){v._symbol&&(v=v.clone()),this._item&&(this._item._symbol=null),this._item=v,v.remove(),v.setSelected(!1),k||v.setPosition(new be),v._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(v){return new Et(this,v)},clone:function(){return new Pt(this._item.clone(!1))},equals:function(v){return v===this||v&&this._item.equals(v._item)||!1}}),dt=x.extend({_class:"HitResult",initialize:function(k,V,Y){this.type=k,this.item=V,Y&&this.inject(Y)},statics:{getOptions:function(v){var k=v&&x.read(v);return new x({type:null,tolerance:In.settings.hitTolerance,fill:!k,stroke:!k,segments:!k,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},k)}}}),Je=x.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(k,V,Y,te,fe,ve){var Ie=arguments.length,Ee,ze,We,He;Ie>0&&(k==null||typeof k=="object"?Ie===1&&k&&"point"in k?(Ee=k.point,ze=k.handleIn,We=k.handleOut,He=k.selection):(Ee=k,ze=V,We=Y,He=te):(Ee=[k,V],ze=Y!==n?[Y,te]:null,We=fe!==n?[fe,ve]:null)),new pt(Ee,this,"_point"),new pt(ze,this,"_handleIn"),new pt(We,this,"_handleOut"),He&&this.setSelection(He)},_serialize:function(v,k){var V=this._point,Y=this._selection,te=Y||this.hasHandles()?[V,this._handleIn,this._handleOut]:V;return Y&&te.push(Y),x.serialize(te,v,!0,k)},_changed:function(v){var k=this._path;if(k){var V=k._curves,Y=this._index,te;V&&((!v||v===this._point||v===this._handleIn)&&(te=Y>0?V[Y-1]:k._closed?V[V.length-1]:null)&&te._changed(),(!v||v===this._point||v===this._handleOut)&&(te=V[Y])&&te._changed()),k._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(be.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(be.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(be.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var v=this._handleIn,k=this._handleOut;return!v.isZero()&&!k.isZero()&&v.isCollinear(k)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(v){var k=this._selection,V=this._path;this._selection=v=v||0,V&&v!==k&&(V._updateSelection(this,k,v),V._changed(257))},_changeSelection:function(v,k){var V=this._selection;this.setSelection(k?V|v:V&~v)},isSelected:function(){return!!(this._selection&7)},setSelected:function(v){this._changeSelection(7,v)},getIndex:function(){return this._index!==n?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var v=this._path,k=this._index;return v?(k>0&&!v._closed&&k===v._segments.length-1&&k--,v.getCurves()[k]||null):null},getLocation:function(){var v=this.getCurve();return v?new Nt(v,this===v._segment1?0:1):null},getNext:function(){var v=this._path&&this._path._segments;return v&&(v[this._index+1]||this._path._closed&&v[0])||null},smooth:function(v,k,V){var Y=v||{},te=Y.type,fe=Y.factor,ve=this.getPrevious(),Ie=this.getNext(),Ee=(ve||this)._point,ze=this._point,We=(Ie||this)._point,He=Ee.getDistance(ze),Qe=ze.getDistance(We);if(!te||te==="catmull-rom"){var Ue=fe===n?.5:fe,ft=Math.pow(He,Ue),st=ft*ft,Me=Math.pow(Qe,Ue),se=Me*Me;if(!k&&ve){var ne=2*se+3*Me*ft+st,$=3*Me*(Me+ft);this.setHandleIn($!==0?new be((se*Ee._x+ne*ze._x-st*We._x)/$-ze._x,(se*Ee._y+ne*ze._y-st*We._y)/$-ze._y):new be)}if(!V&&Ie){var ne=2*st+3*ft*Me+se,$=3*ft*(ft+Me);this.setHandleOut($!==0?new be((st*We._x+ne*ze._x-se*Ee._x)/$-ze._x,(st*We._y+ne*ze._y-se*Ee._y)/$-ze._y):new be)}}else if(te==="geometric"){if(ve&&Ie){var ie=Ee.subtract(We),de=fe===n?.4:fe,ye=de*He/(He+Qe);k||this.setHandleIn(ie.multiply(ye)),V||this.setHandleOut(ie.multiply(ye-de))}}else throw new Error("Smoothing method '"+te+"' not supported.")},getPrevious:function(){var v=this._path&&this._path._segments;return v&&(v[this._index-1]||this._path._closed&&v[v.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var v=this._path;return v&&this._index===v._segments.length-1||!1},reverse:function(){var v=this._handleIn,k=this._handleOut,V=v.clone();v.set(k),k.set(V)},reversed:function(){return new Je(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new Je(this._point,this._handleIn,this._handleOut)},equals:function(v){return v===this||v&&this._class===v._class&&this._point.equals(v._point)&&this._handleIn.equals(v._handleIn)&&this._handleOut.equals(v._handleOut)||!1},toString:function(){var v=["point: "+this._point];return this._handleIn.isZero()||v.push("handleIn: "+this._handleIn),this._handleOut.isZero()||v.push("handleOut: "+this._handleOut),"{ "+v.join(", ")+" }"},transform:function(v){this._transformCoordinates(v,new Array(6),!0),this._changed()},interpolate:function(v,k,V){var Y=1-V,te=V,fe=v._point,ve=k._point,Ie=v._handleIn,Ee=k._handleIn,ze=k._handleOut,We=v._handleOut;this._point._set(Y*fe._x+te*ve._x,Y*fe._y+te*ve._y,!0),this._handleIn._set(Y*Ie._x+te*Ee._x,Y*Ie._y+te*Ee._y,!0),this._handleOut._set(Y*We._x+te*ze._x,Y*We._y+te*ze._y,!0),this._changed()},_transformCoordinates:function(v,k,V){var Y=this._point,te=!V||!this._handleIn.isZero()?this._handleIn:null,fe=!V||!this._handleOut.isZero()?this._handleOut:null,ve=Y._x,Ie=Y._y,Ee=2;return k[0]=ve,k[1]=Ie,te&&(k[Ee++]=te._x+ve,k[Ee++]=te._y+Ie),fe&&(k[Ee++]=fe._x+ve,k[Ee++]=fe._y+Ie),v&&(v._transformCoordinates(k,k,Ee/2),ve=k[0],Ie=k[1],V?(Y._x=ve,Y._y=Ie,Ee=2,te&&(te._x=k[Ee++]-ve,te._y=k[Ee++]-Ie),fe&&(fe._x=k[Ee++]-ve,fe._y=k[Ee++]-Ie)):(te||(k[Ee++]=ve,k[Ee++]=Ie),fe||(k[Ee++]=ve,k[Ee++]=Ie))),k}}),pt=be.extend({initialize:function(k,V,Y){var te,fe,ve;if(!k)te=fe=0;else if((te=k[0])!==n)fe=k[1];else{var Ie=k;(te=Ie.x)===n&&(Ie=be.read(arguments),te=Ie.x),fe=Ie.y,ve=Ie.selected}this._x=te,this._y=fe,this._owner=V,V[Y]=this,ve&&this.setSelected(!0)},_set:function(v,k){return this._x=v,this._y=k,this._owner._changed(this),this},getX:function(){return this._x},setX:function(v){this._x=v,this._owner._changed(this)},getY:function(){return this._y},setY:function(v){this._y=v,this._owner._changed(this)},isZero:function(){var v=ae.isZero;return v(this._x)&&v(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(v){this._owner._changeSelection(this._getSelection(),v)},_getSelection:function(){var v=this._owner;return this===v._point?1:this===v._handleIn?2:this===v._handleOut?4:0}}),lt=x.extend({_class:"Curve",beans:!0,initialize:function(k,V,Y,te,fe,ve,Ie,Ee){var ze=arguments.length,We,He,Qe,Ue,ft,st;ze===3?(this._path=k,We=V,He=Y):ze?ze===1?"segment1"in k?(We=new Je(k.segment1),He=new Je(k.segment2)):"point1"in k?(Qe=k.point1,ft=k.handle1,st=k.handle2,Ue=k.point2):Array.isArray(k)&&(Qe=[k[0],k[1]],Ue=[k[6],k[7]],ft=[k[2]-k[0],k[3]-k[1]],st=[k[4]-k[6],k[5]-k[7]]):ze===2?(We=new Je(k),He=new Je(V)):ze===4?(Qe=k,ft=V,st=Y,Ue=te):ze===8&&(Qe=[k,V],Ue=[Ie,Ee],ft=[Y-k,te-V],st=[fe-Ie,ve-Ee]):(We=new Je,He=new Je),this._segment1=We||new Je(Qe,null,ft),this._segment2=He||new Je(Ue,st,null)},_serialize:function(v,k){return x.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],v,!0,k)},_changed:function(){this._length=this._bounds=n},clone:function(){return new lt(this._segment1,this._segment2)},toString:function(){var v=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||v.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||v.push("handle2: "+this._segment2._handleIn),v.push("point2: "+this._segment2._point),"{ "+v.join(", ")+" }"},classify:function(){return lt.classify(this.getValues())},remove:function(){var v=!1;if(this._path){var k=this._segment2,V=k._handleOut;v=k.remove(),v&&this._segment1._handleOut.set(V)}return v},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(be.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(be.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(be.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(be.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var v=this._path&&this._path._curves;return v&&(v[this._segment1._index+1]||this._path._closed&&v[0])||null},getPrevious:function(){var v=this._path&&this._path._curves;return v&&(v[this._segment1._index-1]||this._path._closed&&v[v.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var v=this._path;return v&&this._segment1._index===v._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(v){this.getPoint1().setSelected(v),this.getHandle1().setSelected(v),this.getHandle2().setSelected(v),this.getPoint2().setSelected(v)},getValues:function(v){return lt.getValues(this._segment1,this._segment2,v)},getPoints:function(){for(var v=this.getValues(),k=[],V=0;V<8;V+=2)k.push(new be(v[V],v[V+1]));return k}},{getLength:function(){return this._length==null&&(this._length=lt.getLength(this.getValues(),0,1)),this._length},getArea:function(){return lt.getArea(this.getValues())},getLine:function(){return new Tt(this._segment1._point,this._segment2._point)},getPart:function(v,k){return new lt(lt.getPart(this.getValues(),v,k))},getPartLength:function(v,k){return lt.getLength(this.getValues(),v,k)},divideAt:function(v){return this.divideAtTime(v&&v.curve===this?v.time:this.getTimeAt(v))},divideAtTime:function(v,k){var V=1e-8,Y=1-V,te=null;if(v>=V&&v<=Y){var fe=lt.subdivide(this.getValues(),v),ve=fe[0],Ie=fe[1],Ee=k||this.hasHandles(),ze=this._segment1,We=this._segment2,He=this._path;Ee&&(ze._handleOut._set(ve[2]-ve[0],ve[3]-ve[1]),We._handleIn._set(Ie[4]-Ie[6],Ie[5]-Ie[7]));var Qe=ve[6],Ue=ve[7],ft=new Je(new be(Qe,Ue),Ee&&new be(ve[4]-Qe,ve[5]-Ue),Ee&&new be(Ie[2]-Qe,Ie[3]-Ue));He?(He.insert(ze._index+1,ft),te=this.getNext()):(this._segment2=ft,this._changed(),te=new lt(ft,We))}return te},splitAt:function(v){var k=this._path;return k?k.splitAt(v):null},splitAtTime:function(v){return this.splitAt(this.getLocationAtTime(v))},divide:function(v,k){return this.divideAtTime(v===n?.5:k?v:this.getTimeAt(v))},split:function(v,k){return this.splitAtTime(v===n?.5:k?v:this.getTimeAt(v))},reversed:function(){return new lt(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(v,k,V,Y){var te=v._point,fe=v._handleOut,ve=k._handleIn,Ie=k._point,Ee=te.x,ze=te.y,We=Ie.x,He=Ie.y,Qe=Y?[Ee,ze,Ee,ze,We,He,We,He]:[Ee,ze,Ee+fe._x,ze+fe._y,We+ve._x,He+ve._y,We,He];return V&&V._transformCoordinates(Qe,Qe,4),Qe},subdivide:function(v,k){var V=v[0],Y=v[1],te=v[2],fe=v[3],ve=v[4],Ie=v[5],Ee=v[6],ze=v[7];k===n&&(k=.5);var We=1-k,He=We*V+k*te,Qe=We*Y+k*fe,Ue=We*te+k*ve,ft=We*fe+k*Ie,st=We*ve+k*Ee,Me=We*Ie+k*ze,se=We*He+k*Ue,ne=We*Qe+k*ft,$=We*Ue+k*st,ie=We*ft+k*Me,de=We*se+k*$,ye=We*ne+k*ie;return[[V,Y,He,Qe,se,ne,de,ye],[de,ye,$,ie,st,Me,Ee,ze]]},getMonoCurves:function(v,k){var V=[],Y=k?0:1,te=v[Y+0],fe=v[Y+2],ve=v[Y+4],Ie=v[Y+6];if(te>=fe==fe>=ve&&fe>=ve==ve>=Ie||lt.isStraight(v))V.push(v);else{var Ee=3*(fe-ve)-te+Ie,ze=2*(te+ve)-4*fe,We=fe-te,He=1e-8,Qe=1-He,Ue=[],ft=ae.solveQuadratic(Ee,ze,We,Ue,He,Qe);if(!ft)V.push(v);else{Ue.sort();var st=Ue[0],Me=lt.subdivide(v,st);V.push(Me[0]),ft>1&&(st=(Ue[1]-st)/(1-st),Me=lt.subdivide(Me[1],st),V.push(Me[0])),V.push(Me[1])}}return V},solveCubic:function(v,k,V,Y,te,fe){var ve=v[k],Ie=v[k+2],Ee=v[k+4],ze=v[k+6],We=0;if(!(ve<V&&ze<V&&Ie<V&&Ee<V||ve>V&&ze>V&&Ie>V&&Ee>V)){var He=3*(Ie-ve),Qe=3*(Ee-Ie)-He,Ue=ze-ve-He-Qe;We=ae.solveCubic(Ue,Qe,He,ve-V,Y,te,fe)}return We},getTimeOf:function(v,k){var V=new be(v[0],v[1]),Y=new be(v[6],v[7]),te=1e-12,fe=1e-7,ve=k.isClose(V,te)?0:k.isClose(Y,te)?1:null;if(ve===null)for(var Ie=[k.x,k.y],Ee=[],ze=0;ze<2;ze++)for(var We=lt.solveCubic(v,ze,Ie[ze],Ee,0,1),He=0;He<We;He++){var Qe=Ee[He];if(k.isClose(lt.getPoint(v,Qe),fe))return Qe}return k.isClose(V,fe)?0:k.isClose(Y,fe)?1:null},getNearestTime:function(v,k){if(lt.isStraight(v)){var V=v[0],Y=v[1],te=v[6],fe=v[7],ve=te-V,Ie=fe-Y,Ee=ve*ve+Ie*Ie;if(Ee===0)return 0;var ze=((k.x-V)*ve+(k.y-Y)*Ie)/Ee;return ze<1e-12?0:ze>.999999999999?1:lt.getTimeOf(v,new be(V+ze*ve,Y+ze*Ie))}var We=100,He=1/0,Qe=0;function Ue(Me){if(Me>=0&&Me<=1){var se=k.getDistance(lt.getPoint(v,Me),!0);if(se<He)return He=se,Qe=Me,!0}}for(var ft=0;ft<=We;ft++)Ue(ft/We);for(var st=1/(We*2);st>1e-8;)!Ue(Qe-st)&&!Ue(Qe+st)&&(st/=2);return Qe},getPart:function(v,k,V){var Y=k>V;if(Y){var te=k;k=V,V=te}return k>0&&(v=lt.subdivide(v,k)[1]),V<1&&(v=lt.subdivide(v,(V-k)/(1-k))[0]),Y?[v[6],v[7],v[4],v[5],v[2],v[3],v[0],v[1]]:v},isFlatEnough:function(v,k){var V=v[0],Y=v[1],te=v[2],fe=v[3],ve=v[4],Ie=v[5],Ee=v[6],ze=v[7],We=3*te-2*V-Ee,He=3*fe-2*Y-ze,Qe=3*ve-2*Ee-V,Ue=3*Ie-2*ze-Y;return Math.max(We*We,Qe*Qe)+Math.max(He*He,Ue*Ue)<=16*k*k},getArea:function(v){var k=v[0],V=v[1],Y=v[2],te=v[3],fe=v[4],ve=v[5],Ie=v[6],Ee=v[7];return 3*((Ee-V)*(Y+fe)-(Ie-k)*(te+ve)+te*(k-fe)-Y*(V-ve)+Ee*(fe+k/3)-Ie*(ve+V/3))/20},getBounds:function(v){for(var k=v.slice(0,2),V=k.slice(),Y=[0,0],te=0;te<2;te++)lt._addBounds(v[te],v[te+2],v[te+4],v[te+6],te,0,k,V,Y);return new at(k[0],k[1],V[0]-k[0],V[1]-k[1])},_addBounds:function(v,k,V,Y,te,fe,ve,Ie,Ee){function ze(de,ye){var ge=de-ye,Pe=de+ye;ge<ve[te]&&(ve[te]=ge),Pe>Ie[te]&&(Ie[te]=Pe)}fe/=2;var We=ve[te]+fe,He=Ie[te]-fe;if(v<We||k<We||V<We||Y<We||v>He||k>He||V>He||Y>He)if(k<v!=k<Y&&V<v!=V<Y)ze(v,0),ze(Y,0);else{var Qe=3*(k-V)-v+Y,Ue=2*(v+V)-4*k,ft=k-v,st=ae.solveQuadratic(Qe,Ue,ft,Ee),Me=1e-8,se=1-Me;ze(Y,0);for(var ne=0;ne<st;ne++){var $=Ee[ne],ie=1-$;Me<=$&&$<=se&&ze(ie*ie*ie*v+3*ie*ie*$*k+3*ie*$*$*V+$*$*$*Y,fe)}}}}},x.each(["getBounds","getStrokeBounds","getHandleBounds"],function(v){this[v]=function(){this._bounds||(this._bounds={});var k=this._bounds[v];return k||(k=this._bounds[v]=Ot[v]([this._segment1,this._segment2],!1,this._path)),k.clone()}},{}),x.each({isStraight:function(v,k,V,Y){if(k.isZero()&&V.isZero())return!0;var te=Y.subtract(v);if(te.isZero())return!1;if(te.isCollinear(k)&&te.isCollinear(V)){var fe=new Tt(v,Y),ve=1e-7;if(fe.getDistance(v.add(k))<ve&&fe.getDistance(Y.add(V))<ve){var Ie=te.dot(te),Ee=te.dot(k)/Ie,ze=te.dot(V)/Ie;return Ee>=0&&Ee<=1&&ze<=0&&ze>=-1}}return!1},isLinear:function(v,k,V,Y){var te=Y.subtract(v).divide(3);return k.equals(te)&&V.negate().equals(te)}},function(v,k){this[k]=function(V){var Y=this._segment1,te=this._segment2;return v(Y._point,Y._handleOut,te._handleIn,te._point,V)},this.statics[k]=function(V,Y){var te=V[0],fe=V[1],ve=V[6],Ie=V[7];return v(new be(te,fe),new be(V[2]-te,V[3]-fe),new be(V[4]-ve,V[5]-Ie),new be(ve,Ie),Y)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(v){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(v||0)},isCollinear:function(v){return v&&this.isStraight()&&v.isStraight()&&this.getLine().isCollinear(v.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(v,k){return this.getLocationAtTime(k?v:this.getTimeAt(v))},getLocationAtTime:function(v){return v!=null&&v>=0&&v<=1?new Nt(this,v):null},getTimeAt:function(v,k){return lt.getTimeAt(this.getValues(),v,k)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var v=be.read(arguments);return v.isZero()?[]:lt.getTimesWithTangent(this.getValues(),v)},getOffsetAtTime:function(v){return this.getPartLength(0,v)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(be.read(arguments)))},getOffsetOf:function(){var v=this.getLocationOf.apply(this,arguments);return v?v.getOffset():null},getTimeOf:function(){return lt.getTimeOf(this.getValues(),be.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var v=be.read(arguments),k=this.getValues(),V=lt.getNearestTime(k,v),Y=lt.getPoint(k,V);return new Nt(this,V,Y,null,v.getDistance(Y))},getNearestPoint:function(){var v=this.getNearestLocation.apply(this,arguments);return v&&v.getPoint()}},new function(){var v=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return x.each(v,function(k){this[k+"At"]=function(V,Y){var te=this.getValues();return lt[k](te,Y?V:lt.getTimeAt(te,V))},this[k+"AtTime"]=function(V){return lt[k](this.getValues(),V)}},{statics:{_evaluateMethods:v}})},new function(){function v(Y){var te=Y[0],fe=Y[1],ve=Y[2],Ie=Y[3],Ee=Y[4],ze=Y[5],We=Y[6],He=Y[7],Qe=9*(ve-Ee)+3*(We-te),Ue=6*(te+Ee)-12*ve,ft=3*(ve-te),st=9*(Ie-ze)+3*(He-fe),Me=6*(fe+ze)-12*Ie,se=3*(Ie-fe);return function(ne){var $=(Qe*ne+Ue)*ne+ft,ie=(st*ne+Me)*ne+se;return Math.sqrt($*$+ie*ie)}}function k(Y,te){return Math.max(2,Math.min(16,Math.ceil(Math.abs(te-Y)*32)))}function V(Y,te,fe,ve){if(te==null||te<0||te>1)return null;var Ie=Y[0],Ee=Y[1],ze=Y[2],We=Y[3],He=Y[4],Qe=Y[5],Ue=Y[6],ft=Y[7],st=ae.isZero;st(ze-Ie)&&st(We-Ee)&&(ze=Ie,We=Ee),st(He-Ue)&&st(Qe-ft)&&(He=Ue,Qe=ft);var Me=3*(ze-Ie),se=3*(He-ze)-Me,ne=Ue-Ie-Me-se,$=3*(We-Ee),ie=3*(Qe-We)-$,de=ft-Ee-$-ie,ye,ge;if(fe===0)ye=te===0?Ie:te===1?Ue:((ne*te+se)*te+Me)*te+Ie,ge=te===0?Ee:te===1?ft:((de*te+ie)*te+$)*te+Ee;else{var Pe=1e-8,Fe=1-Pe;if(te<Pe?(ye=Me,ge=$):te>Fe?(ye=3*(Ue-He),ge=3*(ft-Qe)):(ye=(3*ne*te+2*se)*te+Me,ge=(3*de*te+2*ie)*te+$),ve){ye===0&&ge===0&&(te<Pe||te>Fe)&&(ye=He-ze,ge=Qe-We);var Ve=Math.sqrt(ye*ye+ge*ge);Ve&&(ye/=Ve,ge/=Ve)}if(fe===3){var He=6*ne*te+2*se,Qe=6*de*te+2*ie,Xe=Math.pow(ye*ye+ge*ge,3/2);ye=Xe!==0?(ye*Qe-ge*He)/Xe:0,ge=0}}return fe===2?new be(ge,-ye):new be(ye,ge)}return{statics:{classify:function(Y){var te=Y[0],fe=Y[1],ve=Y[2],Ie=Y[3],Ee=Y[4],ze=Y[5],We=Y[6],He=Y[7],Qe=te*(He-ze)+fe*(Ee-We)+We*ze-He*Ee,Ue=ve*(fe-He)+Ie*(We-te)+te*He-fe*We,ft=Ee*(Ie-fe)+ze*(te-ve)+ve*fe-Ie*te,st=3*ft,Me=st-Ue,se=Me-Ue+Qe,ne=Math.sqrt(se*se+Me*Me+st*st),$=ne!==0?1/ne:0,ie=ae.isZero,de="serpentine";se*=$,Me*=$,st*=$;function ye(Ve,Xe,Ye){var De=Xe!==n,Ge=De&&Xe>0&&Xe<1,ht=De&&Ye>0&&Ye<1;return De&&(!(Ge||ht)||Ve==="loop"&&!(Ge&&ht))&&(Ve="arch",Ge=ht=!1),{type:Ve,roots:Ge||ht?Ge&&ht?Xe<Ye?[Xe,Ye]:[Ye,Xe]:[Ge?Xe:Ye]:null}}if(ie(se))return ie(Me)?ye(ie(st)?"line":"quadratic"):ye(de,st/(3*Me));var ge=3*Me*Me-4*se*st;if(ie(ge))return ye("cusp",Me/(2*se));var Pe=ge>0?Math.sqrt(ge/3):Math.sqrt(-ge),Fe=2*se;return ye(ge>0?de:"loop",(Me+Pe)/Fe,(Me-Pe)/Fe)},getLength:function(Y,te,fe,ve){if(te===n&&(te=0),fe===n&&(fe=1),lt.isStraight(Y)){var Ie=Y;fe<1&&(Ie=lt.subdivide(Ie,fe)[0],te/=fe),te>0&&(Ie=lt.subdivide(Ie,te)[1]);var Ee=Ie[6]-Ie[0],ze=Ie[7]-Ie[1];return Math.sqrt(Ee*Ee+ze*ze)}return ae.integrate(ve||v(Y),te,fe,k(te,fe))},getTimeAt:function(Y,te,fe){if(fe===n&&(fe=te<0?1:0),te===0)return fe;var ve=Math.abs,Ie=1e-12,Ee=te>0,ze=Ee?fe:0,We=Ee?1:fe,He=v(Y),Qe=lt.getLength(Y,ze,We,He),Ue=ve(te)-Qe;if(ve(Ue)<Ie)return Ee?We:ze;if(Ue>Ie)return null;var ft=te/Qe,st=0;function Me(se){return st+=ae.integrate(He,fe,se,k(fe,se)),fe=se,st-te}return ae.findRoot(Me,He,fe+ft,ze,We,32,1e-12)},getPoint:function(Y,te){return V(Y,te,0,!1)},getTangent:function(Y,te){return V(Y,te,1,!0)},getWeightedTangent:function(Y,te){return V(Y,te,1,!1)},getNormal:function(Y,te){return V(Y,te,2,!0)},getWeightedNormal:function(Y,te){return V(Y,te,2,!1)},getCurvature:function(Y,te){return V(Y,te,3,!1).x},getPeaks:function(Y){var te=Y[0],fe=Y[1],ve=Y[2],Ie=Y[3],Ee=Y[4],ze=Y[5],We=Y[6],He=Y[7],Qe=-te+3*ve-3*Ee+We,Ue=3*te-6*ve+3*Ee,ft=-3*te+3*ve,st=-fe+3*Ie-3*ze+He,Me=3*fe-6*Ie+3*ze,se=-3*fe+3*Ie,ne=1e-8,$=1-ne,ie=[];return ae.solveCubic(9*(Qe*Qe+st*st),9*(Qe*Ue+Me*st),2*(Ue*Ue+Me*Me)+3*(ft*Qe+se*st),ft*Ue+Me*se,ie,ne,$),ie.sort()}}}},new function(){function v(Ue,ft,st,Me,se,ne,$){var ie=!$&&st.getPrevious()===se,de=!$&&st!==se&&st.getNext()===se,ye=1e-8,ge=1-ye;if(Me!==null&&Me>=(ie?ye:0)&&Me<=(de?ge:1)&&ne!==null&&ne>=(de?ye:0)&&ne<=(ie?ge:1)){var Pe=new Nt(st,Me,null,$),Fe=new Nt(se,ne,null,$);Pe._intersection=Fe,Fe._intersection=Pe,(!ft||ft(Pe))&&Nt.insert(Ue,Pe,!0)}}function k(Ue,ft,st,Me,se,ne,$,ie,de,ye,ge,Pe,Fe){if(++de>=4096||++ie>=40)return de;var Ve=1e-9,Xe=ft[0],Ye=ft[1],De=ft[6],Ge=ft[7],ht=Tt.getSignedDistance,kt=ht(Xe,Ye,De,Ge,ft[2],ft[3]),o=ht(Xe,Ye,De,Ge,ft[4],ft[5]),ke=kt*o>0?3/4:4/9,ai=ke*Math.min(0,kt,o),fi=ke*Math.max(0,kt,o),hi=ht(Xe,Ye,De,Ge,Ue[0],Ue[1]),Jt=ht(Xe,Ye,De,Ge,Ue[2],Ue[3]),oi=ht(Xe,Ye,De,Ge,Ue[4],Ue[5]),zi=ht(Xe,Ye,De,Ge,Ue[6],Ue[7]),xi=V(hi,Jt,oi,zi),Si=xi[0],Yt=xi[1],bn,or;if(kt===0&&o===0&&hi===0&&Jt===0&&oi===0&&zi===0||(bn=Y(Si,Yt,ai,fi))==null||(or=Y(Si.reverse(),Yt.reverse(),ai,fi))==null)return de;var mn=ye+(ge-ye)*bn,qn=ye+(ge-ye)*or;if(Math.max(Fe-Pe,qn-mn)<Ve){var jr=(mn+qn)/2,Zi=(Pe+Fe)/2;v(se,ne,$?Me:st,$?Zi:jr,$?st:Me,$?jr:Zi)}else{Ue=lt.getPart(Ue,bn,or);var ur=Fe-Pe;if(or-bn>.8)if(qn-mn>ur){var Vn=lt.subdivide(Ue,.5),jr=(mn+qn)/2;de=k(ft,Vn[0],Me,st,se,ne,!$,ie,de,Pe,Fe,mn,jr),de=k(ft,Vn[1],Me,st,se,ne,!$,ie,de,Pe,Fe,jr,qn)}else{var Vn=lt.subdivide(ft,.5),Zi=(Pe+Fe)/2;de=k(Vn[0],Ue,Me,st,se,ne,!$,ie,de,Pe,Zi,mn,qn),de=k(Vn[1],Ue,Me,st,se,ne,!$,ie,de,Zi,Fe,mn,qn)}else ur===0||ur>=Ve?de=k(ft,Ue,Me,st,se,ne,!$,ie,de,Pe,Fe,mn,qn):de=k(Ue,ft,st,Me,se,ne,$,ie,de,mn,qn,Pe,Fe)}return de}function V(Ue,ft,st,Me){var se=[0,Ue],ne=[1/3,ft],$=[2/3,st],ie=[1,Me],de=ft-(2*Ue+Me)/3,ye=st-(Ue+2*Me)/3,ge;if(de*ye<0)ge=[[se,ne,ie],[se,$,ie]];else{var Pe=de/ye;ge=[Pe>=2?[se,ne,ie]:Pe<=.5?[se,$,ie]:[se,ne,$,ie],[se,ie]]}return(de||ye)<0?ge.reverse():ge}function Y(Ue,ft,st,Me){return Ue[0][1]<st?te(Ue,!0,st):ft[0][1]>Me?te(ft,!1,Me):Ue[0][0]}function te(Ue,ft,st){for(var Me=Ue[0][0],se=Ue[0][1],ne=1,$=Ue.length;ne<$;ne++){var ie=Ue[ne][0],de=Ue[ne][1];if(ft?de>=st:de<=st)return de===st?ie:Me+(st-se)*(ie-Me)/(de-se);Me=ie,se=de}return null}function fe(Ue,ft,st,Me,se){var ne=ae.isZero;if(ne(Me)&&ne(se)){var $=lt.getTimeOf(Ue,new be(ft,st));return $===null?[]:[$]}for(var ie=Math.atan2(-se,Me),de=Math.sin(ie),ye=Math.cos(ie),ge=[],Pe=[],Fe=0;Fe<8;Fe+=2){var Ve=Ue[Fe]-ft,Xe=Ue[Fe+1]-st;ge.push(Ve*ye-Xe*de,Ve*de+Xe*ye)}return lt.solveCubic(ge,1,0,Pe,0,1),Pe}function ve(Ue,ft,st,Me,se,ne,$){for(var ie=ft[0],de=ft[1],ye=ft[6],ge=ft[7],Pe=fe(Ue,ie,de,ye-ie,ge-de),Fe=0,Ve=Pe.length;Fe<Ve;Fe++){var Xe=Pe[Fe],Ye=lt.getPoint(Ue,Xe),De=lt.getTimeOf(ft,Ye);De!==null&&v(se,ne,$?Me:st,$?De:Xe,$?st:Me,$?Xe:De)}}function Ie(Ue,ft,st,Me,se,ne){var $=Tt.intersect(Ue[0],Ue[1],Ue[6],Ue[7],ft[0],ft[1],ft[6],ft[7]);$&&v(se,ne,st,lt.getTimeOf(Ue,$),Me,lt.getTimeOf(ft,$))}function Ee(Ue,ft,st,Me,se,ne){var $=1e-12,ie=Math.min,de=Math.max;if(de(Ue[0],Ue[2],Ue[4],Ue[6])+$>ie(ft[0],ft[2],ft[4],ft[6])&&ie(Ue[0],Ue[2],Ue[4],Ue[6])-$<de(ft[0],ft[2],ft[4],ft[6])&&de(Ue[1],Ue[3],Ue[5],Ue[7])+$>ie(ft[1],ft[3],ft[5],ft[7])&&ie(Ue[1],Ue[3],Ue[5],Ue[7])-$<de(ft[1],ft[3],ft[5],ft[7])){var ye=He(Ue,ft);if(ye)for(var ge=0;ge<2;ge++){var Pe=ye[ge];v(se,ne,st,Pe[0],Me,Pe[1],!0)}else{var Fe=lt.isStraight(Ue),Ve=lt.isStraight(ft),Xe=Fe&&Ve,Ye=Fe&&!Ve,De=se.length;if((Xe?Ie:Fe||Ve?ve:k)(Ye?ft:Ue,Ye?Ue:ft,Ye?Me:st,Ye?st:Me,se,ne,Ye,0,0,0,1,0,1),!Xe||se.length===De)for(var ge=0;ge<4;ge++){var Ge=ge>>1,ht=ge&1,kt=Ge*6,o=ht*6,ke=new be(Ue[kt],Ue[kt+1]),ai=new be(ft[o],ft[o+1]);ke.isClose(ai,$)&&v(se,ne,st,Ge,Me,ht)}}}return se}function ze(Ue,ft,st,Me){var se=lt.classify(Ue);if(se.type==="loop"){var ne=se.roots;v(st,Me,ft,ne[0],ft,ne[1])}return st}function We(Ue,ft,st,Me,se,ne){var $=1e-7,ie=!ft;ie&&(ft=Ue);for(var de=Ue.length,ye=ft.length,ge=new Array(de),Pe=ie?ge:new Array(ye),Fe=[],Ve=0;Ve<de;Ve++)ge[Ve]=Ue[Ve].getValues(Me);if(!ie)for(var Ve=0;Ve<ye;Ve++)Pe[Ve]=ft[Ve].getValues(se);for(var Xe=W.findCurveBoundsCollisions(ge,Pe,$),Ye=0;Ye<de;Ye++){var De=Ue[Ye],Ge=ge[Ye];ie&&ze(Ge,De,Fe,st);var ht=Xe[Ye];if(ht)for(var kt=0;kt<ht.length;kt++){if(ne&&Fe.length)return Fe;var o=ht[kt];if(!ie||o>Ye){var ke=ft[o],ai=Pe[o];Ee(Ge,ai,De,ke,Fe,st)}}}return Fe}function He(Ue,ft){function st(zi){var xi=zi[6]-zi[0],Si=zi[7]-zi[1];return xi*xi+Si*Si}var Me=Math.abs,se=Tt.getDistance,ne=1e-8,$=1e-7,ie=lt.isStraight(Ue),de=lt.isStraight(ft),ye=ie&&de,ge=st(Ue)<st(ft),Pe=ge?ft:Ue,Fe=ge?Ue:ft,Ve=Pe[0],Xe=Pe[1],Ye=Pe[6]-Ve,De=Pe[7]-Xe;if(se(Ve,Xe,Ye,De,Fe[0],Fe[1],!0)<$&&se(Ve,Xe,Ye,De,Fe[6],Fe[7],!0)<$)!ye&&se(Ve,Xe,Ye,De,Pe[2],Pe[3],!0)<$&&se(Ve,Xe,Ye,De,Pe[4],Pe[5],!0)<$&&se(Ve,Xe,Ye,De,Fe[2],Fe[3],!0)<$&&se(Ve,Xe,Ye,De,Fe[4],Fe[5],!0)<$&&(ie=de=ye=!0);else if(ye)return null;if(ie^de)return null;for(var Ge=[Ue,ft],ht=[],kt=0;kt<4&&ht.length<2;kt++){var o=kt&1,ke=o^1,ai=kt>>1,fi=lt.getTimeOf(Ge[o],new be(Ge[ke][ai?6:0],Ge[ke][ai?7:1]));if(fi!=null){var hi=o?[ai,fi]:[fi,ai];(!ht.length||Me(hi[0]-ht[0][0])>ne&&Me(hi[1]-ht[0][1])>ne)&&ht.push(hi)}if(kt>2&&!ht.length)break}if(ht.length!==2)ht=null;else if(!ye){var Jt=lt.getPart(Ue,ht[0][0],ht[1][0]),oi=lt.getPart(ft,ht[0][1],ht[1][1]);(Me(oi[2]-Jt[2])>$||Me(oi[3]-Jt[3])>$||Me(oi[4]-Jt[4])>$||Me(oi[5]-Jt[5])>$)&&(ht=null)}return ht}function Qe(Ue,ft){var st=Ue[0],Me=Ue[1],se=Ue[2],ne=Ue[3],$=Ue[4],ie=Ue[5],de=Ue[6],ye=Ue[7],ge=ft.normalize(),Pe=ge.x,Fe=ge.y,Ve=3*de-9*$+9*se-3*st,Xe=3*ye-9*ie+9*ne-3*Me,Ye=6*$-12*se+6*st,De=6*ie-12*ne+6*Me,Ge=3*se-3*st,ht=3*ne-3*Me,kt=2*Ve*Fe-2*Xe*Pe,o=[];if(Math.abs(kt)<ae.CURVETIME_EPSILON){var ke=Ve*ht-Xe*Ge,kt=Ve*De-Xe*Ye;if(kt!=0){var ai=-ke/kt;ai>=0&&ai<=1&&o.push(ai)}}else{var fi=(Ye*Ye-4*Ve*Ge)*Fe*Fe+(-2*Ye*De+4*Xe*Ge+4*Ve*ht)*Pe*Fe+(De*De-4*Xe*ht)*Pe*Pe,hi=Ye*Fe-De*Pe;if(fi>=0&&kt!=0){var Jt=Math.sqrt(fi),oi=-(hi+Jt)/kt,zi=(-hi+Jt)/kt;oi>=0&&oi<=1&&o.push(oi),zi>=0&&zi<=1&&o.push(zi)}}return o}return{getIntersections:function(Ue){var ft=this.getValues(),st=Ue&&Ue!==this&&Ue.getValues();return st?Ee(ft,st,this,Ue,[]):ze(ft,this,[])},statics:{getOverlaps:He,getIntersections:We,getCurveLineIntersections:fe,getTimesWithTangent:Qe}}}),Nt=x.extend({_class:"CurveLocation",initialize:function(k,V,Y,te,fe){if(V>=.99999999){var ve=k.getNext();ve&&(V=0,k=ve)}this._setCurve(k),this._time=V,this._point=Y||k.getPointAtTime(V),this._overlap=te,this._distance=fe,this._intersection=this._next=this._previous=null},_setPath:function(v){this._path=v,this._version=v?v._version:0},_setCurve:function(v){this._setPath(v._path),this._curve=v,this._segment=null,this._segment1=v._segment1,this._segment2=v._segment2},_setSegment:function(v){var k=v.getCurve();k?this._setCurve(k):(this._setPath(v._path),this._segment1=v,this._segment2=null),this._segment=v,this._time=v===this._segment1?0:1,this._point=v._point.clone()},getSegment:function(){var v=this._segment;if(!v){var k=this.getCurve(),V=this.getTime();V===0?v=k._segment1:V===1?v=k._segment2:V!=null&&(v=k.getPartLength(0,V)<k.getPartLength(V,1)?k._segment1:k._segment2),this._segment=v}return v},getCurve:function(){var v=this._path,k=this;v&&v._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null);function V(Y){var te=Y&&Y.getCurve();if(te&&(k._time=te.getTimeOf(k._point))!=null)return k._setCurve(te),te}return this._curve||V(this._segment)||V(this._segment1)||V(this._segment2.getPrevious())},getPath:function(){var v=this.getCurve();return v&&v._path},getIndex:function(){var v=this.getCurve();return v&&v.getIndex()},getTime:function(){var v=this.getCurve(),k=this._time;return v&&k==null?this._time=v.getTimeOf(this._point):k},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var v=this._offset;if(v==null){v=0;var k=this.getPath(),V=this.getIndex();if(k&&V!=null)for(var Y=k.getCurves(),te=0;te<V;te++)v+=Y[te].getLength();this._offset=v+=this.getCurveOffset()}return v},getCurveOffset:function(){var v=this._curveOffset;if(v==null){var k=this.getCurve(),V=this.getTime();this._curveOffset=v=V!=null&&k&&k.getPartLength(0,V)}return v},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var v=this.getCurve(),k=v&&v.divideAtTime(this.getTime());return k&&this._setSegment(k._segment1),k},split:function(){var v=this.getCurve(),k=v._path,V=v&&v.splitAtTime(this.getTime());return V&&this._setSegment(k.getLastSegment()),V},equals:function(v,k){var V=this===v;if(!V&&v instanceof Nt){var Y=this.getCurve(),te=v.getCurve(),fe=Y._path,ve=te._path;if(fe===ve){var Ie=Math.abs,Ee=1e-7,ze=Ie(this.getOffset()-v.getOffset()),We=!k&&this._intersection,He=!k&&v._intersection;V=(ze<Ee||fe&&Ie(fe.getLength()-ze)<Ee)&&(!We&&!He||We&&He&&We.equals(He,!0))}}return V},toString:function(){var v=[],k=this.getPoint(),V=he.instance;k&&v.push("point: "+k);var Y=this.getIndex();Y!=null&&v.push("index: "+Y);var te=this.getTime();return te!=null&&v.push("time: "+V.number(te)),this._distance!=null&&v.push("distance: "+V.number(this._distance)),"{ "+v.join(", ")+" }"},isTouching:function(){var v=this._intersection;if(v&&this.getTangent().isCollinear(v.getTangent())){var k=this.getCurve(),V=v.getCurve();return!(k.isStraight()&&V.isStraight()&&k.getLine().intersect(V.getLine()))}return!1},isCrossing:function(){var v=this._intersection;if(!v)return!1;var k=this.getTime(),V=v.getTime(),Y=1e-8,te=1-Y,fe=k>=Y&&k<=te,ve=V>=Y&&V<=te;if(fe&&ve)return!this.isTouching();var Ie=this.getCurve(),Ee=Ie&&k<Y?Ie.getPrevious():Ie,ze=v.getCurve(),We=ze&&V<Y?ze.getPrevious():ze;if(k>te&&(Ie=Ie.getNext()),V>te&&(ze=ze.getNext()),!Ee||!Ie||!We||!ze)return!1;var He=[];function Qe(Pe,Fe){var Ve=Pe.getValues(),Xe=lt.classify(Ve).roots||lt.getPeaks(Ve),Ye=Xe.length,De=lt.getLength(Ve,Fe&&Ye?Xe[Ye-1]:0,!Fe&&Ye?Xe[0]:1);He.push(Ye?De:De/32)}function Ue(Pe,Fe,Ve){return Fe<Ve?Pe>Fe&&Pe<Ve:Pe>Fe||Pe<Ve}fe||(Qe(Ee,!0),Qe(Ie,!1)),ve||(Qe(We,!0),Qe(ze,!1));var ft=this.getPoint(),st=Math.min.apply(Math,He),Me=fe?Ie.getTangentAtTime(k):Ie.getPointAt(st).subtract(ft),se=fe?Me.negate():Ee.getPointAt(-st).subtract(ft),ne=ve?ze.getTangentAtTime(V):ze.getPointAt(st).subtract(ft),$=ve?ne.negate():We.getPointAt(-st).subtract(ft),ie=se.getAngle(),de=Me.getAngle(),ye=$.getAngle(),ge=ne.getAngle();return!!(fe?Ue(ie,ye,ge)^Ue(de,ye,ge)&&Ue(ie,ge,ye)^Ue(de,ge,ye):Ue(ye,ie,de)^Ue(ge,ie,de)&&Ue(ye,de,ie)^Ue(ge,de,ie))},hasOverlap:function(){return!!this._overlap}},x.each(lt._evaluateMethods,function(v){var k=v+"At";this[v]=function(){var V=this.getCurve(),Y=this.getTime();return Y!=null&&V&&V[k](Y,!0)}},{preserve:!0}),new function(){function v(k,V,Y){var te=k.length,fe=0,ve=te-1;function Ie(ft,st){for(var Me=ft+st;Me>=-1&&Me<=te;Me+=st){var se=k[(Me%te+te)%te];if(!V.getPoint().isClose(se.getPoint(),1e-7))break;if(V.equals(se))return se}return null}for(;fe<=ve;){var Ee=fe+ve>>>1,ze=k[Ee],We;if(Y&&(We=V.equals(ze)?ze:Ie(Ee,-1)||Ie(Ee,1)))return V._overlap&&(We._overlap=We._intersection._overlap=!0),We;var He=V.getPath(),Qe=ze.getPath(),Ue=He!==Qe?He._id-Qe._id:V.getIndex()+V.getTime()-(ze.getIndex()+ze.getTime());Ue<0?ve=Ee-1:fe=Ee+1}return k.splice(fe,0,V),V}return{statics:{insert:v,expand:function(k){for(var V=k.slice(),Y=k.length-1;Y>=0;Y--)v(V,k[Y]._intersection,!1);return V}}}}),zt=Oe.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(v){var k,V,Y;if(x.isPlainObject(v)?(V=v.segments,k=v.pathData):Array.isArray(v)?V=v:typeof v=="string"&&(k=v),V){var te=V[0];Y=te&&Array.isArray(te[0])}else k&&(Y=(k.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(k));var fe=Y?gi:Ot;return new fe(v)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(v){this.isClockwise()!=(v=!!v)&&this.reverse()},setPathData:function(v){var k=v&&v.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),V,Y=!1,te,fe,ve=new be,Ie=new be;function Ee($,ie){var de=+V[$];return Y&&(de+=ve[ie]),de}function ze($){return new be(Ee($,"x"),Ee($+1,"y"))}this.clear();for(var We=0,He=k&&k.length;We<He;We++){var Qe=k[We],Ue=Qe[0],ft=Ue.toLowerCase();V=Qe.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var st=V&&V.length;switch(Y=Ue===ft,te==="z"&&!/[mz]/.test(ft)&&this.moveTo(ve),ft){case"m":case"l":for(var Me=ft==="m",se=0;se<st;se+=2)this[Me?"moveTo":"lineTo"](ve=ze(se)),Me&&(Ie=ve,Me=!1);fe=ve;break;case"h":case"v":var ne=ft==="h"?"x":"y";ve=ve.clone();for(var se=0;se<st;se++)ve[ne]=Ee(se,ne),this.lineTo(ve);fe=ve;break;case"c":for(var se=0;se<st;se+=6)this.cubicCurveTo(ze(se),fe=ze(se+2),ve=ze(se+4));break;case"s":for(var se=0;se<st;se+=4)this.cubicCurveTo(/[cs]/.test(te)?ve.multiply(2).subtract(fe):ve,fe=ze(se),ve=ze(se+2)),te=ft;break;case"q":for(var se=0;se<st;se+=4)this.quadraticCurveTo(fe=ze(se),ve=ze(se+2));break;case"t":for(var se=0;se<st;se+=2)this.quadraticCurveTo(fe=/[qt]/.test(te)?ve.multiply(2).subtract(fe):ve,ve=ze(se)),te=ft;break;case"a":for(var se=0;se<st;se+=7)this.arcTo(ve=ze(se+5),new nt(+V[se],+V[se+1]),+V[se+2],+V[se+4],+V[se+3]);break;case"z":this.closePath(1e-12),ve=Ie;break}te=ft}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(v){var k=v.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(v):{};return k.onPath||!!(this.getFillRule()==="evenodd"?k.windingL&1||k.windingR&1:k.winding)},getIntersections:function(v,k,V,Y){var te=this===v||!v,fe=this._matrix._orNullIfIdentity(),ve=te?fe:(V||v._matrix)._orNullIfIdentity();return te||this.getBounds(fe).intersects(v.getBounds(ve),1e-12)?lt.getIntersections(this.getCurves(),!te&&v.getCurves(),k,fe,ve,Y):[]},getCrossings:function(v){return this.getIntersections(v,function(k){return k.isCrossing()})},getNearestLocation:function(){for(var v=be.read(arguments),k=this.getCurves(),V=1/0,Y=null,te=0,fe=k.length;te<fe;te++){var ve=k[te].getNearestLocation(v);ve._distance<V&&(V=ve._distance,Y=ve)}return Y},getNearestPoint:function(){var v=this.getNearestLocation.apply(this,arguments);return v&&v.getPoint()},interpolate:function(v,k,V){var Y=!this._children,te=Y?"_segments":"_children",fe=v[te],ve=k[te],Ie=this[te];if(!fe||!ve||fe.length!==ve.length)throw new Error("Invalid operands in interpolate() call: "+v+", "+k);var Ee=Ie.length,ze=ve.length;if(Ee<ze)for(var We=Y?Je:Ot,He=Ee;He<ze;He++)this.add(new We);else Ee>ze&&this[Y?"removeSegments":"removeChildren"](ze,Ee);for(var He=0;He<ze;He++)Ie[He].interpolate(fe[He],ve[He],V);Y&&(this.setClosed(v._closed),this._changed(9))},compare:function(v){var k=!1;if(v){var V=this._children||[this],Y=v._children?v._children.slice():[v],te=V.length,fe=Y.length,ve=[],Ie=0;k=!0;for(var Ee=W.findItemBoundsCollisions(V,Y,ae.GEOMETRIC_EPSILON),ze=te-1;ze>=0&&k;ze--){var We=V[ze];k=!1;var He=Ee[ze];if(He)for(var Qe=He.length-1;Qe>=0&&!k;Qe--)We.compare(Y[He[Qe]])&&(ve[He[Qe]]||(ve[He[Qe]]=!0,Ie++),k=!0)}k=k&&Ie===fe}return k}}),Ot=zt.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(k){this._closed=!1,this._segments=[],this._version=0;var V=arguments,Y=Array.isArray(k)?typeof k[0]=="object"?k:V:k&&k.size===n&&(k.x!==n||k.point!==n)?V:null;Y&&Y.length>0?this.setSegments(Y):(this._curves=n,this._segmentSelection=0,!Y&&typeof k=="string"&&(this.setPathData(k),k=null)),this._initialize(!Y&&k)},_equals:function(v){return this._closed===v._closed&&x.equals(this._segments,v._segments)},copyContent:function(v){this.setSegments(v._segments),this._closed=v._closed},_changed:function v(k){if(v.base.call(this,k),k&8){if(this._length=this._area=n,k&32)this._version++;else if(this._curves)for(var V=0,Y=this._curves.length;V<Y;V++)this._curves[V]._changed()}else k&64&&(this._bounds=n)},getStyle:function(){var v=this._parent;return(v instanceof gi?v:this)._style},getSegments:function(){return this._segments},setSegments:function(v){var k=this.isFullySelected(),V=v&&v.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=n,V){var Y=v[V-1];typeof Y=="boolean"&&(this.setClosed(Y),V--),this._add(Je.readList(v,0,{},V))}k&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var v=this._curves,k=this._segments;if(!v){var V=this._countCurves();v=this._curves=new Array(V);for(var Y=0;Y<V;Y++)v[Y]=new lt(this,k[Y],k[Y+1]||k[0])}return v},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var v=this.getCurves();return v[v.length-1]},isClosed:function(){return this._closed},setClosed:function(v){if(this._closed!=(v=!!v)){if(this._closed=v,this._curves){var k=this._curves.length=this._countCurves();v&&(this._curves[k-1]=new lt(this,this._segments[k-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(v,k){var V=this._segments,Y=V.length,te=new he(k),fe=new Array(6),ve=!0,Ie,Ee,ze,We,He,Qe,Ue,ft,st=[];function Me(ne,$){if(ne._transformCoordinates(v,fe),Ie=fe[0],Ee=fe[1],ve)st.push("M"+te.pair(Ie,Ee)),ve=!1;else if(He=fe[2],Qe=fe[3],He===Ie&&Qe===Ee&&Ue===ze&&ft===We){if(!$){var ie=Ie-ze,de=Ee-We;st.push(ie===0?"v"+te.number(de):de===0?"h"+te.number(ie):"l"+te.pair(ie,de))}}else st.push("c"+te.pair(Ue-ze,ft-We)+" "+te.pair(He-ze,Qe-We)+" "+te.pair(Ie-ze,Ee-We));ze=Ie,We=Ee,Ue=fe[4],ft=fe[5]}if(!Y)return"";for(var se=0;se<Y;se++)Me(V[se]);return this._closed&&Y>0&&(Me(V[0],!0),st.push("z")),st.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(v){for(var k=this._segments,V=new Array(6),Y=0,te=k.length;Y<te;Y++)k[Y]._transformCoordinates(v,V,!0);return!0},_add:function(v,ve){for(var V=this._segments,Y=this._curves,te=v.length,fe=ve==null,ve=fe?V.length:ve,Ie=0;Ie<te;Ie++){var Ee=v[Ie];Ee._path&&(Ee=v[Ie]=Ee.clone()),Ee._path=this,Ee._index=ve+Ie,Ee._selection&&this._updateSelection(Ee,0,Ee._selection)}if(fe)x.push(V,v);else{V.splice.apply(V,[ve,0].concat(v));for(var Ie=ve+te,ze=V.length;Ie<ze;Ie++)V[Ie]._index=Ie}if(Y){var We=this._countCurves(),He=ve>0&&ve+te-1===We?ve-1:ve,Qe=He,Ue=Math.min(He+te,We);v._curves&&(Y.splice.apply(Y,[He,0].concat(v._curves)),Qe+=v._curves.length);for(var Ie=Qe;Ie<Ue;Ie++)Y.splice(Ie,0,new lt(this,null,null));this._adjustCurves(He,Ue)}return this._changed(41),v},_adjustCurves:function(v,k){for(var V=this._segments,Y=this._curves,te,fe=v;fe<k;fe++)te=Y[fe],te._path=this,te._segment1=V[fe],te._segment2=V[fe+1]||V[0],te._changed();(te=Y[this._closed&&!v?V.length-1:v-1])&&(te._segment2=V[v]||V[0],te._changed()),(te=Y[k])&&(te._segment1=V[k],te._changed())},_countCurves:function(){var v=this._segments.length;return!this._closed&&v>0?v-1:v},add:function(v){var k=arguments;return k.length>1&&typeof v!="number"?this._add(Je.readList(k)):this._add([Je.read(k)])[0]},insert:function(v,k){var V=arguments;return V.length>2&&typeof k!="number"?this._add(Je.readList(V,1),v):this._add([Je.read(V,1)],v)[0]},addSegment:function(){return this._add([Je.read(arguments)])[0]},insertSegment:function(v){return this._add([Je.read(arguments,1)],v)[0]},addSegments:function(v){return this._add(Je.readList(v))},insertSegments:function(v,k){return this._add(Je.readList(k),v)},removeSegment:function(v){return this.removeSegments(v,v+1)[0]||null},removeSegments:function(v,k,V){v=v||0,k=x.pick(k,this._segments.length);var Y=this._segments,te=this._curves,fe=Y.length,ve=Y.splice(v,k-v),Ie=ve.length;if(!Ie)return ve;for(var Ee=0;Ee<Ie;Ee++){var ze=ve[Ee];ze._selection&&this._updateSelection(ze,ze._selection,0),ze._index=ze._path=null}for(var Ee=v,We=Y.length;Ee<We;Ee++)Y[Ee]._index=Ee;if(te){for(var He=v>0&&k===fe+(this._closed?1:0)?v-1:v,te=te.splice(He,Ie),Ee=te.length-1;Ee>=0;Ee--)te[Ee]._path=null;V&&(ve._curves=te.slice(1)),this._adjustCurves(He,He)}return this._changed(41),ve},clear:"#removeSegments",hasHandles:function(){for(var v=this._segments,k=0,V=v.length;k<V;k++)if(v[k].hasHandles())return!0;return!1},clearHandles:function(){for(var v=this._segments,k=0,V=v.length;k<V;k++)v[k].clearHandles()},getLength:function(){if(this._length==null){for(var v=this.getCurves(),k=0,V=0,Y=v.length;V<Y;V++)k+=v[V].getLength();this._length=k}return this._length},getArea:function(){var v=this._area;if(v==null){var k=this._segments,V=this._closed;v=0;for(var Y=0,te=k.length;Y<te;Y++){var fe=Y+1===te;v+=lt.getArea(lt.getValues(k[Y],k[fe?0:Y+1],null,fe&&!V))}this._area=v}return v},isFullySelected:function(){var v=this._segments.length;return this.isSelected()&&v>0&&this._segmentSelection===v*7},setFullySelected:function(v){v&&this._selectSegments(!0),this.setSelected(v)},setSelection:function v(k){k&1||this._selectSegments(!1),v.base.call(this,k)},_selectSegments:function(v){var k=this._segments,V=k.length,Y=v?7:0;this._segmentSelection=Y*V;for(var te=0;te<V;te++)k[te]._selection=Y},_updateSelection:function(v,k,V){v._selection=V;var Y=this._segmentSelection+=V-k;Y>0&&this.setSelected(!0)},divideAt:function(v){var k=this.getLocationAt(v),V;return k&&(V=k.getCurve().divideAt(k.getCurveOffset()))?V._segment1:null},splitAt:function(v){var k=this.getLocationAt(v),V=k&&k.index,Y=k&&k.time,te=1e-8,fe=1-te;Y>fe&&(V++,Y=0);var ve=this.getCurves();if(V>=0&&V<ve.length){Y>=te&&ve[V++].divideAtTime(Y);var Ie=this.removeSegments(V,this._segments.length,!0),Ee;return this._closed?(this.setClosed(!1),Ee=this):(Ee=new Ot(Oe.NO_INSERT),Ee.insertAbove(this),Ee.copyAttributes(this)),Ee._add(Ie,0),this.addSegment(Ie[0]),Ee}return null},split:function(v,k){var V,Y=k===n?v:(V=this.getCurves()[v])&&V.getLocationAtTime(k);return Y!=null?this.splitAt(Y):null},join:function(v,k){var V=k||0;if(v&&v!==this){var Y=v._segments,te=this.getLastSegment(),fe=v.getLastSegment();if(!fe)return this;te&&te._point.isClose(fe._point,V)&&v.reverse();var ve=v.getFirstSegment();if(te&&te._point.isClose(ve._point,V))te.setHandleOut(ve._handleOut),this._add(Y.slice(1));else{var Ie=this.getFirstSegment();Ie&&Ie._point.isClose(ve._point,V)&&v.reverse(),fe=v.getLastSegment(),Ie&&Ie._point.isClose(fe._point,V)?(Ie.setHandleIn(fe._handleIn),this._add(Y.slice(0,Y.length-1),0)):this._add(Y.slice())}v._closed&&this._add([Y[0]]),v.remove()}var Ee=this.getFirstSegment(),ze=this.getLastSegment();return Ee!==ze&&Ee._point.isClose(ze._point,V)&&(Ee.setHandleIn(ze._handleIn),ze.remove(),this.setClosed(!0)),this},reduce:function(v){for(var k=this.getCurves(),V=v&&v.simplify,Y=V?1e-7:0,te=k.length-1;te>=0;te--){var fe=k[te];!fe.hasHandles()&&(!fe.hasLength(Y)||V&&fe.isCollinear(fe.getNext()))&&fe.remove()}return this},reverse:function(){this._segments.reverse();for(var v=0,k=this._segments.length;v<k;v++){var V=this._segments[v],Y=V._handleIn;V._handleIn=V._handleOut,V._handleOut=Y,V._index=v}this._curves=null,this._changed(9)},flatten:function(v){for(var k=new wi(this,v||.25,256,!0),V=k.parts,Y=V.length,te=[],fe=0;fe<Y;fe++)te.push(new Je(V[fe].curve.slice(0,2)));!this._closed&&Y>0&&te.push(new Je(V[Y-1].curve.slice(6))),this.setSegments(te)},simplify:function(v){var k=new Ti(this).fit(v||2.5);return k&&this.setSegments(k),!!k},smooth:function(v){var k=this,V=v||{},Y=V.type||"asymmetric",te=this._segments,fe=te.length,ve=this._closed;function Ie(Si,Yt){var bn=Si&&Si.index;if(bn!=null){var or=Si.path;if(or&&or!==k)throw new Error(Si._class+" "+bn+" of "+or+" is not part of "+k);Yt&&Si instanceof lt&&bn++}else bn=typeof Si=="number"?Si:Yt;return Math.min(bn<0&&ve?bn%fe:bn<0?bn+fe:bn,fe-1)}var Ee=ve&&V.from===n&&V.to===n,ze=Ie(V.from,0),We=Ie(V.to,fe-1);if(ze>We)if(ve)ze-=fe;else{var He=ze;ze=We,We=He}if(/^(?:asymmetric|continuous)$/.test(Y)){var Qe=Y==="asymmetric",Ue=Math.min,ft=We-ze+1,st=ft-1,Me=Ee?Ue(ft,4):1,se=Me,ne=Me,$=[];if(ve||(se=Ue(1,ze),ne=Ue(1,fe-We-1)),st+=se+ne,st<=1)return;for(var ie=0,de=ze-se;ie<=st;ie++,de++)$[ie]=te[(de<0?de+fe:de)%fe]._point;for(var ye=$[0]._x+2*$[1]._x,ge=$[0]._y+2*$[1]._y,Pe=2,Fe=st-1,Ve=[ye],Xe=[ge],Ye=[Pe],De=[],Ge=[],ie=1;ie<st;ie++){var ht=ie<Fe,kt=ht||Qe?1:2,o=ht?4:Qe?2:7,ke=ht?4:Qe?3:8,ai=ht?2:Qe?0:1,fi=kt/Pe;Pe=Ye[ie]=o-fi,ye=Ve[ie]=ke*$[ie]._x+ai*$[ie+1]._x-fi*ye,ge=Xe[ie]=ke*$[ie]._y+ai*$[ie+1]._y-fi*ge}De[Fe]=Ve[Fe]/Ye[Fe],Ge[Fe]=Xe[Fe]/Ye[Fe];for(var ie=st-2;ie>=0;ie--)De[ie]=(Ve[ie]-De[ie+1])/Ye[ie],Ge[ie]=(Xe[ie]-Ge[ie+1])/Ye[ie];De[st]=(3*$[st]._x-De[Fe])/2,Ge[st]=(3*$[st]._y-Ge[Fe])/2;for(var ie=se,hi=st-ne,de=ze;ie<=hi;ie++,de++){var Jt=te[de<0?de+fe:de],oi=Jt._point,zi=De[ie]-oi._x,xi=Ge[ie]-oi._y;(Ee||ie<hi)&&Jt.setHandleOut(zi,xi),(Ee||ie>se)&&Jt.setHandleIn(-zi,-xi)}}else for(var ie=ze;ie<=We;ie++)te[ie<0?ie+fe:ie].smooth(V,!Ee&&ie===ze,!Ee&&ie===We)},toShape:function(v){if(!this._closed)return null;var k=this._segments,V,Y,te,fe;function ve(Qe,Ue){var ft=k[Qe],st=ft.getNext(),Me=k[Ue],se=Me.getNext();return ft._handleOut.isZero()&&st._handleIn.isZero()&&Me._handleOut.isZero()&&se._handleIn.isZero()&&st._point.subtract(ft._point).isCollinear(se._point.subtract(Me._point))}function Ie(Qe){var Ue=k[Qe],ft=Ue.getPrevious(),st=Ue.getNext();return ft._handleOut.isZero()&&Ue._handleIn.isZero()&&Ue._handleOut.isZero()&&st._handleIn.isZero()&&Ue._point.subtract(ft._point).isOrthogonal(st._point.subtract(Ue._point))}function Ee(Qe){var Ue=k[Qe],ft=Ue.getNext(),st=Ue._handleOut,Me=ft._handleIn,se=.5522847498307936;if(st.isOrthogonal(Me)){var ne=Ue._point,$=ft._point,ie=new Tt(ne,st,!0).intersect(new Tt($,Me,!0),!0);return ie&&ae.isZero(st.getLength()/ie.subtract(ne).getLength()-se)&&ae.isZero(Me.getLength()/ie.subtract($).getLength()-se)}return!1}function ze(Qe,Ue){return k[Qe]._point.getDistance(k[Ue]._point)}if(!this.hasHandles()&&k.length===4&&ve(0,2)&&ve(1,3)&&Ie(1)?(V=vt.Rectangle,Y=new nt(ze(0,3),ze(0,1)),fe=k[1]._point.add(k[2]._point).divide(2)):k.length===8&&Ee(0)&&Ee(2)&&Ee(4)&&Ee(6)&&ve(1,5)&&ve(3,7)?(V=vt.Rectangle,Y=new nt(ze(1,6),ze(0,3)),te=Y.subtract(new nt(ze(0,7),ze(1,2))).divide(2),fe=k[3]._point.add(k[4]._point).divide(2)):k.length===4&&Ee(0)&&Ee(1)&&Ee(2)&&Ee(3)&&(ae.isZero(ze(0,2)-ze(1,3))?(V=vt.Circle,te=ze(0,2)/2):(V=vt.Ellipse,te=new nt(ze(2,0)/2,ze(3,1)/2)),fe=k[1]._point),V){var We=this.getPosition(!0),He=new V({center:We,size:Y,radius:te,insert:!1});return He.copyAttributes(this,!0),He._matrix.prepend(this._matrix),He.rotate(fe.subtract(We).getAngle()+90),(v===n||v)&&He.insertAbove(this),He}return null},toPath:"#clone",compare:function v(k){if(!k||k instanceof gi)return v.base.call(this,k);var V=this.getCurves(),Y=k.getCurves(),te=V.length,fe=Y.length;if(!te||!fe)return te==fe;for(var ve=V[0].getValues(),Ie=[],Ee=0,ze,We=0,He,Qe=0;Qe<fe;Qe++){var Me=Y[Qe].getValues();Ie.push(Me);var Ue=lt.getOverlaps(ve,Me);if(Ue){ze=!Qe&&Ue[0][0]>0?fe-1:Qe,He=Ue[0][1];break}}for(var ft=Math.abs,st=1e-8,Me=Ie[ze],se;ve&&Me;){var Ue=lt.getOverlaps(ve,Me);if(Ue){var ne=Ue[0][0];if(ft(ne-We)<st){We=Ue[1][0],We===1&&(ve=++Ee<te?V[Ee].getValues():null,We=0);var $=Ue[0][1];if(ft($-He)<st){if(se||(se=[ze,$]),He=Ue[1][1],He===1&&(++ze>=fe&&(ze=0),Me=Ie[ze]||Y[ze].getValues(),He=0),!ve)return se[0]===ze&&se[1]===He;continue}}}break}return!1},_hitTestSelf:function(v,k,V,Y){var te=this,fe=this.getStyle(),ve=this._segments,Ie=ve.length,Ee=this._closed,ze=k._tolerancePadding,We=ze,He,Qe,Ue,ft,st,Me,se=k.stroke&&fe.hasStroke(),ne=k.fill&&fe.hasFill(),$=k.curves,ie=se?fe.getStrokeWidth()/2:ne&&k.tolerance>0||$?0:null;ie!==null&&(ie>0?(He=fe.getStrokeJoin(),Qe=fe.getStrokeCap(),Ue=fe.getMiterLimit(),We=We.add(Ot._getStrokePadding(ie,Y))):He=Qe="round");function de(De,Ge){return v.subtract(De).divide(Ge).length<=1}function ye(De,Ge,ht){if(!k.selected||Ge.isSelected()){var kt=De._point;if(Ge!==kt&&(Ge=Ge.add(kt)),de(Ge,We))return new dt(ht,te,{segment:De,point:Ge})}}function ge(De,Ge){return(Ge||k.segments)&&ye(De,De._point,"segment")||!Ge&&k.handles&&(ye(De,De._handleIn,"handle-in")||ye(De,De._handleOut,"handle-out"))}function Pe(De){ft.add(De)}function Fe(De){var Ge=Ee||De._index>0&&De._index<Ie-1;if((Ge?He:Qe)==="round")return de(De._point,We);if(ft=new Ot({internal:!0,closed:!0}),Ge?De.isSmooth()||Ot._addBevelJoin(De,He,ie,Ue,null,Y,Pe,!0):Qe==="square"&&Ot._addSquareCap(De,Qe,ie,null,Y,Pe,!0),!ft.isEmpty()){var ht;return ft.contains(v)||(ht=ft.getNearestLocation(v))&&de(ht.getPoint(),ze)}}if(k.ends&&!k.segments&&!Ee){if(Me=ge(ve[0],!0)||ge(ve[Ie-1],!0))return Me}else if(k.segments||k.handles){for(var Ve=0;Ve<Ie;Ve++)if(Me=ge(ve[Ve]))return Me}if(ie!==null){if(st=this.getNearestLocation(v),st){var Xe=st.getTime();Xe===0||Xe===1&&Ie>1?Fe(st.getSegment())||(st=null):de(st.getPoint(),We)||(st=null)}if(!st&&He==="miter"&&Ie>1)for(var Ve=0;Ve<Ie;Ve++){var Ye=ve[Ve];if(v.getDistance(Ye._point)<=Ue*ie&&Fe(Ye)){st=Ye.getLocation();break}}}return!st&&ne&&this._contains(v)||st&&!se&&!$?new dt("fill",this):st?new dt(se?"stroke":"curve",this,{location:st,point:st.getPoint()}):null}},x.each(lt._evaluateMethods,function(v){this[v+"At"]=function(k){var V=this.getLocationAt(k);return V&&V[v]()}},{beans:!1,getLocationOf:function(){for(var v=be.read(arguments),k=this.getCurves(),V=0,Y=k.length;V<Y;V++){var te=k[V].getLocationOf(v);if(te)return te}return null},getOffsetOf:function(){var v=this.getLocationOf.apply(this,arguments);return v?v.getOffset():null},getLocationAt:function(v){if(typeof v=="number"){for(var k=this.getCurves(),V=0,Y=0,te=k.length;Y<te;Y++){var fe=V,ve=k[Y];if(V+=ve.getLength(),V>v)return ve.getLocationAt(v-fe)}if(k.length>0&&v<=this.getLength())return new Nt(k[k.length-1],1)}else if(v&&v.getPath&&v.getPath()===this)return v;return null},getOffsetsWithTangent:function(){var v=be.read(arguments);if(v.isZero())return[];for(var k=[],V=0,Y=this.getCurves(),te=0,fe=Y.length;te<fe;te++){for(var ve=Y[te],Ie=ve.getTimesWithTangent(v),Ee=0,ze=Ie.length;Ee<ze;Ee++){var We=V+ve.getOffsetAtTime(Ie[Ee]);k.indexOf(We)<0&&k.push(We)}V+=ve.length}return k}}),new function(){function v(V,Y,te,fe){if(fe<=0)return;var ve=fe/2,Ie=fe-2,Ee=ve-1,ze=new Array(6),We,He;function Qe(ne){var $=ze[ne],ie=ze[ne+1];(We!=$||He!=ie)&&(V.beginPath(),V.moveTo(We,He),V.lineTo($,ie),V.stroke(),V.beginPath(),V.arc($,ie,ve,0,Math.PI*2,!0),V.fill())}for(var Ue=0,ft=Y.length;Ue<ft;Ue++){var st=Y[Ue],Me=st._selection;if(st._transformCoordinates(te,ze),We=ze[0],He=ze[1],Me&2&&Qe(2),Me&4&&Qe(4),V.fillRect(We-ve,He-ve,fe,fe),Ie>0&&!(Me&1)){var se=V.fillStyle;V.fillStyle="#ffffff",V.fillRect(We-Ee,He-Ee,Ie,Ie),V.fillStyle=se}}}function k(V,Y,te){var fe=Y._segments,ve=fe.length,Ie=new Array(6),Ee=!0,ze,We,He,Qe,Ue,ft,st,Me;function se($){if(te)$._transformCoordinates(te,Ie),ze=Ie[0],We=Ie[1];else{var ie=$._point;ze=ie._x,We=ie._y}if(Ee)V.moveTo(ze,We),Ee=!1;else{if(te)Ue=Ie[2],ft=Ie[3];else{var de=$._handleIn;Ue=ze+de._x,ft=We+de._y}Ue===ze&&ft===We&&st===He&&Me===Qe?V.lineTo(ze,We):V.bezierCurveTo(st,Me,Ue,ft,ze,We)}if(He=ze,Qe=We,te)st=Ie[4],Me=Ie[5];else{var de=$._handleOut;st=He+de._x,Me=Qe+de._y}}for(var ne=0;ne<ve;ne++)se(fe[ne]);Y._closed&&ve>0&&se(fe[0])}return{_draw:function(V,Y,te,fe){var ve=Y.dontStart,Ie=Y.dontFinish||Y.clip,Ee=this.getStyle(),ze=Ee.hasFill(),We=Ee.hasStroke(),He=Ee.getDashArray(),Qe=!In.support.nativeDash&&We&&He&&He.length;ve||V.beginPath(),(ze||We&&!Qe||Ie)&&(k(V,this,fe),this._closed&&V.closePath());function Ue($){return He[($%Qe+Qe)%Qe]}if(!Ie&&(ze||We)&&(this._setStyles(V,Y,te),ze&&(V.fill(Ee.getFillRule()),V.shadowColor="rgba(0,0,0,0)"),We)){if(Qe){ve||V.beginPath();for(var ft=new wi(this,.25,32,!1,fe),st=ft.length,Me=-Ee.getDashOffset(),se,ne=0;Me>0;)Me-=Ue(ne--)+Ue(ne--);for(;Me<st;)se=Me+Ue(ne++),(Me>0||se>0)&&ft.drawPart(V,Math.max(Me,0),Math.max(se,0)),Me=se+Ue(ne++)}V.stroke()}},_drawSelected:function(V,Y){V.beginPath(),k(V,this,Y),V.stroke(),v(V,this._segments,Y,In.settings.handleSize)}}},new function(){function v(k){var V=k._segments;if(!V.length)throw new Error("Use a moveTo() command first");return V[V.length-1]}return{moveTo:function(){var k=this._segments;k.length===1&&this.removeSegment(0),k.length||this._add([new Je(be.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new Je(be.read(arguments))])},cubicCurveTo:function(){var k=arguments,V=be.read(k),Y=be.read(k),te=be.read(k),fe=v(this);fe.setHandleOut(V.subtract(fe._point)),this._add([new Je(te,Y.subtract(te))])},quadraticCurveTo:function(){var k=arguments,V=be.read(k),Y=be.read(k),te=v(this)._point;this.cubicCurveTo(V.add(te.subtract(V).multiply(1/3)),V.add(Y.subtract(V).multiply(1/3)),Y)},curveTo:function(){var k=arguments,V=be.read(k),Y=be.read(k),te=x.pick(x.read(k),.5),fe=1-te,ve=v(this)._point,Ie=V.subtract(ve.multiply(fe*fe)).subtract(Y.multiply(te*te)).divide(2*te*fe);if(Ie.isNaN())throw new Error("Cannot put a curve through points with parameter = "+te);this.quadraticCurveTo(Ie,Y)},arcTo:function(){var k=arguments,V=Math.abs,Y=Math.sqrt,te=v(this),fe=te._point,ve=be.read(k),Ie,Ee=x.peek(k),ze=x.pick(Ee,!0),We,He,Qe,Ue;if(typeof ze=="boolean")var ft=fe.add(ve).divide(2),Ie=ft.add(ft.subtract(fe).rotate(ze?-90:90));else if(x.remain(k)<=2)Ie=ve,ve=be.read(k);else if(!fe.equals(ve)){var st=nt.read(k),Me=ae.isZero;if(Me(st.width)||Me(st.height))return this.lineTo(ve);var se=x.read(k),ze=!!x.read(k),ne=!!x.read(k),ft=fe.add(ve).divide(2),$=fe.subtract(ft).rotate(-se),ie=$.x,de=$.y,ye=V(st.width),ge=V(st.height),Pe=ye*ye,Fe=ge*ge,Ve=ie*ie,Xe=de*de,Ye=Y(Ve/Pe+Xe/Fe);if(Ye>1&&(ye*=Ye,ge*=Ye,Pe=ye*ye,Fe=ge*ge),Ye=(Pe*Fe-Pe*Xe-Fe*Ve)/(Pe*Xe+Fe*Ve),V(Ye)<1e-12&&(Ye=0),Ye<0)throw new Error("Cannot create an arc with the given arguments");We=new be(ye*de/ge,-ge*ie/ye).multiply((ne===ze?-1:1)*Y(Ye)).rotate(se).add(ft),Ue=new xt().translate(We).rotate(se).scale(ye,ge),Qe=Ue._inverseTransform(fe),He=Qe.getDirectedAngle(Ue._inverseTransform(ve)),!ze&&He>0?He-=360:ze&&He<0&&(He+=360)}if(Ie){var De=new Tt(fe.add(Ie).divide(2),Ie.subtract(fe).rotate(90),!0),Ge=new Tt(Ie.add(ve).divide(2),ve.subtract(Ie).rotate(90),!0),ht=new Tt(fe,ve),kt=ht.getSide(Ie);if(We=De.intersect(Ge,!0),!We){if(!kt)return this.lineTo(ve);throw new Error("Cannot create an arc with the given arguments")}Qe=fe.subtract(We),He=Qe.getDirectedAngle(ve.subtract(We));var o=ht.getSide(We,!0);o===0?He=kt*V(He):kt===o&&(He+=He<0?360:-360)}if(He){for(var ke=1e-5,ai=V(He),fi=ai>=360?4:Math.ceil((ai-ke)/90),hi=He/fi,Jt=hi*Math.PI/360,oi=4/3*Math.sin(Jt)/(1+Math.cos(Jt)),zi=[],xi=0;xi<=fi;xi++){var $=ve,Si=null;if(xi<fi&&(Si=Qe.rotate(90).multiply(oi),Ue?($=Ue._transformPoint(Qe),Si=Ue._transformPoint(Qe.add(Si)).subtract($)):$=We.add(Qe)),!xi)te.setHandleOut(Si);else{var Yt=Qe.rotate(-90).multiply(oi);Ue&&(Yt=Ue._transformPoint(Qe.add(Yt)).subtract($)),zi.push(new Je($,Yt,Si))}Qe=Qe.rotate(hi)}this._add(zi)}},lineBy:function(){var k=be.read(arguments),V=v(this)._point;this.lineTo(V.add(k))},curveBy:function(){var k=arguments,V=be.read(k),Y=be.read(k),te=x.read(k),fe=v(this)._point;this.curveTo(fe.add(V),fe.add(Y),te)},cubicCurveBy:function(){var k=arguments,V=be.read(k),Y=be.read(k),te=be.read(k),fe=v(this)._point;this.cubicCurveTo(fe.add(V),fe.add(Y),fe.add(te))},quadraticCurveBy:function(){var k=arguments,V=be.read(k),Y=be.read(k),te=v(this)._point;this.quadraticCurveTo(te.add(V),te.add(Y))},arcBy:function(){var k=arguments,V=v(this)._point,Y=V.add(be.read(k)),te=x.pick(x.peek(k),!0);typeof te=="boolean"?this.arcTo(Y,te):this.arcTo(Y,V.add(be.read(k)))},closePath:function(k){this.setClosed(!0),this.join(this,k)}}},{_getBounds:function(v,k){var V=k.handle?"getHandleBounds":k.stroke?"getStrokeBounds":"getBounds";return Ot[V](this._segments,this._closed,this,v,k)},statics:{getBounds:function(v,k,V,Y,te,fe){var ve=v[0];if(!ve)return new at;var Ie=new Array(6),Ee=ve._transformCoordinates(Y,new Array(6)),ze=Ee.slice(0,2),We=ze.slice(),He=new Array(2);function Qe(st){st._transformCoordinates(Y,Ie);for(var Me=0;Me<2;Me++)lt._addBounds(Ee[Me],Ee[Me+4],Ie[Me+2],Ie[Me],Me,fe?fe[Me]:0,ze,We,He);var se=Ee;Ee=Ie,Ie=se}for(var Ue=1,ft=v.length;Ue<ft;Ue++)Qe(v[Ue]);return k&&Qe(ve),new at(ze[0],ze[1],We[0]-ze[0],We[1]-ze[1])},getStrokeBounds:function(v,k,V,Y,te){var fe=V.getStyle(),ve=fe.hasStroke(),Ie=fe.getStrokeWidth(),Ee=ve&&V._getStrokeMatrix(Y,te),ze=ve&&Ot._getStrokePadding(Ie,Ee),We=Ot.getBounds(v,k,V,Y,te,ze);if(!ve)return We;var He=Ie/2,Qe=fe.getStrokeJoin(),Ue=fe.getStrokeCap(),ft=fe.getMiterLimit(),st=new at(new nt(ze));function Me(ye){We=We.include(ye)}function se(ye){We=We.unite(st.setCenter(ye._point.transform(Y)))}function ne(ye,ge){ge==="round"||ye.isSmooth()?se(ye):Ot._addBevelJoin(ye,ge,He,ft,Y,Ee,Me)}function $(ye,ge){ge==="round"?se(ye):Ot._addSquareCap(ye,ge,He,Y,Ee,Me)}var ie=v.length-(k?0:1);if(ie>0){for(var de=1;de<ie;de++)ne(v[de],Qe);k?ne(v[0],Qe):($(v[0],Ue),$(v[v.length-1],Ue))}return We},_getStrokePadding:function(v,k){if(!k)return[v,v];var V=new be(v,0).transform(k),Y=new be(0,v).transform(k),te=V.getAngleInRadians(),fe=V.getLength(),ve=Y.getLength(),Ie=Math.sin(te),Ee=Math.cos(te),ze=Math.tan(te),We=Math.atan2(ve*ze,fe),He=Math.atan2(ve,ze*fe);return[Math.abs(fe*Math.cos(We)*Ee+ve*Math.sin(We)*Ie),Math.abs(ve*Math.sin(He)*Ee+fe*Math.cos(He)*Ie)]},_addBevelJoin:function(v,k,V,Y,te,fe,ve,Ie){var Ee=v.getCurve(),ze=Ee.getPrevious(),We=Ee.getPoint1().transform(te),He=ze.getNormalAtTime(1).multiply(V).transform(fe),Qe=Ee.getNormalAtTime(0).multiply(V).transform(fe),Ue=He.getDirectedAngle(Qe);if((Ue<0||Ue>=180)&&(He=He.negate(),Qe=Qe.negate()),Ie&&ve(We),ve(We.add(He)),k==="miter"){var ft=new Tt(We.add(He),new be(-He.y,He.x),!0).intersect(new Tt(We.add(Qe),new be(-Qe.y,Qe.x),!0),!0);ft&&We.getDistance(ft)<=Y*V&&ve(ft)}ve(We.add(Qe))},_addSquareCap:function(v,k,V,Y,te,fe,ve){var Ie=v._point.transform(Y),Ee=v.getLocation(),ze=Ee.getNormal().multiply(Ee.getTime()===0?V:-V).transform(te);k==="square"&&(ve&&(fe(Ie.subtract(ze)),fe(Ie.add(ze))),Ie=Ie.add(ze.rotate(-90))),fe(Ie.add(ze)),fe(Ie.subtract(ze))},getHandleBounds:function(v,k,V,Y,te){var fe=V.getStyle(),ve=te.stroke&&fe.hasStroke(),Ie,Ee;if(ve){var ze=V._getStrokeMatrix(Y,te),We=fe.getStrokeWidth()/2,He=We;fe.getStrokeJoin()==="miter"&&(He=We*fe.getMiterLimit()),fe.getStrokeCap()==="square"&&(He=Math.max(He,We*Math.SQRT2)),Ie=Ot._getStrokePadding(We,ze),Ee=Ot._getStrokePadding(He,ze)}for(var Qe=new Array(6),Ue=1/0,ft=-Ue,st=Ue,Me=ft,se=0,ne=v.length;se<ne;se++){var $=v[se];$._transformCoordinates(Y,Qe);for(var ie=0;ie<6;ie+=2){var de=ie?Ie:Ee,ye=de?de[0]:0,ge=de?de[1]:0,Pe=Qe[ie],Fe=Qe[ie+1],Ve=Pe-ye,Xe=Pe+ye,Ye=Fe-ge,De=Fe+ge;Ve<Ue&&(Ue=Ve),Xe>ft&&(ft=Xe),Ye<st&&(st=Ye),De>Me&&(Me=De)}}return new at(Ue,st,ft-Ue,Me-st)}}});Ot.inject({statics:new function(){var v=.5522847498307936,k=[new Je([-1,0],[0,v],[0,-v]),new Je([0,-1],[-v,0],[v,0]),new Je([1,0],[0,-v],[0,v]),new Je([0,1],[v,0],[-v,0])];function V(te,fe,ve){var Ie=x.getNamed(ve),Ee=new Ot(Ie&&(Ie.insert==!0?Oe.INSERT:Ie.insert==!1?Oe.NO_INSERT:null));return Ee._add(te),Ee._closed=fe,Ee.set(Ie,Oe.INSERT)}function Y(te,fe,ve){for(var Ie=new Array(4),Ee=0;Ee<4;Ee++){var ze=k[Ee];Ie[Ee]=new Je(ze._point.multiply(fe).add(te),ze._handleIn.multiply(fe),ze._handleOut.multiply(fe))}return V(Ie,!0,ve)}return{Line:function(){var te=arguments;return V([new Je(be.readNamed(te,"from")),new Je(be.readNamed(te,"to"))],!1,te)},Circle:function(){var te=arguments,fe=be.readNamed(te,"center"),ve=x.readNamed(te,"radius");return Y(fe,new nt(ve),te)},Rectangle:function(){var te=arguments,fe=at.readNamed(te,"rectangle"),ve=nt.readNamed(te,"radius",0,{readNull:!0}),Ie=fe.getBottomLeft(!0),Ee=fe.getTopLeft(!0),ze=fe.getTopRight(!0),We=fe.getBottomRight(!0),He;if(!ve||ve.isZero())He=[new Je(Ie),new Je(Ee),new Je(ze),new Je(We)];else{ve=nt.min(ve,fe.getSize(!0).divide(2));var Qe=ve.width,Ue=ve.height,ft=Qe*v,st=Ue*v;He=[new Je(Ie.add(Qe,0),null,[-ft,0]),new Je(Ie.subtract(0,Ue),[0,st]),new Je(Ee.add(0,Ue),null,[0,-st]),new Je(Ee.add(Qe,0),[-ft,0],null),new Je(ze.subtract(Qe,0),null,[ft,0]),new Je(ze.add(0,Ue),[0,-st],null),new Je(We.subtract(0,Ue),null,[0,st]),new Je(We.subtract(Qe,0),[ft,0])]}return V(He,!0,te)},RoundRectangle:"#Rectangle",Ellipse:function(){var te=arguments,fe=vt._readEllipse(te);return Y(fe.center,fe.radius,te)},Oval:"#Ellipse",Arc:function(){var te=arguments,fe=be.readNamed(te,"from"),ve=be.readNamed(te,"through"),Ie=be.readNamed(te,"to"),Ee=x.getNamed(te),ze=new Ot(Ee&&Ee.insert==!1&&Oe.NO_INSERT);return ze.moveTo(fe),ze.arcTo(ve,Ie),ze.set(Ee)},RegularPolygon:function(){for(var te=arguments,fe=be.readNamed(te,"center"),ve=x.readNamed(te,"sides"),Ie=x.readNamed(te,"radius"),Ee=360/ve,ze=ve%3===0,We=new be(0,ze?-Ie:Ie),He=ze?-1:.5,Qe=new Array(ve),Ue=0;Ue<ve;Ue++)Qe[Ue]=new Je(fe.add(We.rotate((Ue+He)*Ee)));return V(Qe,!0,te)},Star:function(){for(var te=arguments,fe=be.readNamed(te,"center"),ve=x.readNamed(te,"points")*2,Ie=x.readNamed(te,"radius1"),Ee=x.readNamed(te,"radius2"),ze=360/ve,We=new be(0,-1),He=new Array(ve),Qe=0;Qe<ve;Qe++)He[Qe]=new Je(fe.add(We.rotate(ze*Qe).multiply(Qe%2?Ee:Ie)));return V(He,!0,te)}}}});var gi=zt.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(k){this._children=[],this._namedChildren={},this._initialize(k)||(typeof k=="string"?this.setPathData(k):this.addChildren(Array.isArray(k)?k:arguments))},insertChildren:function v(k,V){var Y=V,te=Y[0];te&&typeof te[0]=="number"&&(Y=[Y]);for(var fe=V.length-1;fe>=0;fe--){var ve=Y[fe];Y===V&&!(ve instanceof Ot)&&(Y=x.slice(Y)),Array.isArray(ve)?Y[fe]=new Ot({segments:ve,insert:!1}):ve instanceof gi&&(Y.splice.apply(Y,[fe,1].concat(ve.removeChildren())),ve.remove())}return v.base.call(this,k,Y)},reduce:function v(k){for(var V=this._children,Y=V.length-1;Y>=0;Y--){var te=V[Y].reduce(k);te.isEmpty()&&te.remove()}if(!V.length){var te=new Ot(Oe.NO_INSERT);return te.copyAttributes(this),te.insertAbove(this),this.remove(),te}return v.base.call(this)},isClosed:function(){for(var v=this._children,k=0,V=v.length;k<V;k++)if(!v[k]._closed)return!1;return!0},setClosed:function(v){for(var k=this._children,V=0,Y=k.length;V<Y;V++)k[V].setClosed(v)},getFirstSegment:function(){var v=this.getFirstChild();return v&&v.getFirstSegment()},getLastSegment:function(){var v=this.getLastChild();return v&&v.getLastSegment()},getCurves:function(){for(var v=this._children,k=[],V=0,Y=v.length;V<Y;V++)x.push(k,v[V].getCurves());return k},getFirstCurve:function(){var v=this.getFirstChild();return v&&v.getFirstCurve()},getLastCurve:function(){var v=this.getLastChild();return v&&v.getLastCurve()},getArea:function(){for(var v=this._children,k=0,V=0,Y=v.length;V<Y;V++)k+=v[V].getArea();return k},getLength:function(){for(var v=this._children,k=0,V=0,Y=v.length;V<Y;V++)k+=v[V].getLength();return k},getPathData:function(v,k){for(var V=this._children,Y=[],te=0,fe=V.length;te<fe;te++){var ve=V[te],Ie=ve._matrix;Y.push(ve.getPathData(v&&!Ie.isIdentity()?v.appended(Ie):v,k))}return Y.join("")},_hitTestChildren:function v(k,V,Y){return v.base.call(this,k,V.class===Ot||V.type==="path"?V:x.set({},V,{fill:!1}),Y)},_draw:function(v,k,V,Y){var te=this._children;if(te.length){k=k.extend({dontStart:!0,dontFinish:!0}),v.beginPath();for(var fe=0,ve=te.length;fe<ve;fe++)te[fe].draw(v,k,Y);if(!k.clip){this._setStyles(v,k,V);var Ie=this._style;Ie.hasFill()&&(v.fill(Ie.getFillRule()),v.shadowColor="rgba(0,0,0,0)"),Ie.hasStroke()&&v.stroke()}}},_drawSelected:function(v,k,V){for(var Y=this._children,te=0,fe=Y.length;te<fe;te++){var ve=Y[te],Ie=ve._matrix;V[ve._id]||ve._drawSelected(v,Ie.isIdentity()?k:k.appended(Ie))}}},new function(){function v(k,V){var Y=k._children;if(V&&!Y.length)throw new Error("Use a moveTo() command first");return Y[Y.length-1]}return x.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(k){this[k]=function(){var V=v(this,!0);V[k].apply(V,arguments)}},{moveTo:function(){var k=v(this),V=k&&k.isEmpty()?k:new Ot(Oe.NO_INSERT);V!==k&&this.addChild(V),V.moveTo.apply(V,arguments)},moveBy:function(){var k=v(this,!0),V=k&&k.getLastSegment(),Y=be.read(arguments);this.moveTo(V?Y.add(V._point):Y)},closePath:function(k){v(this,!0).closePath(k)}})},x.each(["reverse","flatten","simplify","smooth"],function(v){this[v]=function(k){for(var V=this._children,Y,te=0,fe=V.length;te<fe;te++)Y=V[te][v](k)||Y;return Y}},{}));zt.inject(new function(){var v=Math.min,k=Math.max,V=Math.abs,Y={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function te(se){return se._children||[se]}function fe(se,ne){var $=se.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(ne){for(var ie=te($),de=0,ye=ie.length;de<ye;de++){var se=ie[de];!se._closed&&!se.isEmpty()&&(se.closePath(1e-12),se.getFirstSegment().setHandleIn(0,0),se.getLastSegment().setHandleOut(0,0))}$=$.resolveCrossings().reorient($.getFillRule()==="nonzero",!0)}return $}function ve(se,ne,$,ie,de){var ye=new gi(Oe.NO_INSERT);return ye.addChildren(se,!0),ye=ye.reduce({simplify:ne}),de&&de.insert==!1||ye.insertAbove(ie&&$.isSibling(ie)&&$.getIndex()<ie.getIndex()?ie:$),ye.copyAttributes($,!0),ye}function Ie(se){return se.hasOverlap()||se.isCrossing()}function Ee(se,ne,$,ie){if(ie&&(ie.trace==!1||ie.stroke)&&/^(subtract|intersect)$/.test($))return ze(se,ne,$);var de=fe(se,!0),ye=ne&&se!==ne&&fe(ne,!0),ge=Y[$];ge[$]=!0,ye&&(ge.subtract||ge.exclude)^(ye.isClockwise()^de.isClockwise())&&ye.reverse();var Pe=Ue(Nt.expand(de.getIntersections(ye,Ie))),Fe=te(de),Ve=ye&&te(ye),Xe=[],Ye=[],De;function Ge(Si){for(var Yt=0,bn=Si.length;Yt<bn;Yt++){var or=Si[Yt];x.push(Xe,or._segments),x.push(Ye,or.getCurves()),or._overlapsOnly=!0}}function ht(Si){for(var Yt=[],bn=0,or=Si&&Si.length;bn<or;bn++)Yt.push(Ye[Si[bn]]);return Yt}if(Pe.length){Ge(Fe),Ve&&Ge(Ve);for(var kt=new Array(Ye.length),o=0,ke=Ye.length;o<ke;o++)kt[o]=Ye[o].getValues();for(var ai=W.findCurveBoundsCollisions(kt,kt,0,!0),fi={},o=0;o<Ye.length;o++){var hi=Ye[o],Jt=hi._path._id,oi=fi[Jt]=fi[Jt]||{};oi[hi.getIndex()]={hor:ht(ai[o].hor),ver:ht(ai[o].ver)}}for(var o=0,ke=Pe.length;o<ke;o++)st(Pe[o]._segment,de,ye,fi,ge);for(var o=0,ke=Xe.length;o<ke;o++){var zi=Xe[o],xi=zi._intersection;zi._winding||st(zi,de,ye,fi,ge),xi&&xi._overlap||(zi._path._overlapsOnly=!1)}De=Me(Xe,ge)}else De=Qe(Ve?Fe.concat(Ve):Fe.slice(),function(Si){return!!ge[Si]});return ve(De,!0,se,ne,ie)}function ze(se,ne,$){var ie=fe(se),de=fe(ne),ye=ie.getIntersections(de,Ie),ge=$==="subtract",Pe=$==="divide",Fe={},Ve=[];function Xe(Ge){if(!Fe[Ge._id]&&(Pe||de.contains(Ge.getPointAt(Ge.getLength()/2))^ge))return Ve.unshift(Ge),Fe[Ge._id]=!0}for(var Ye=ye.length-1;Ye>=0;Ye--){var De=ye[Ye].split();De&&(Xe(De)&&De.getFirstSegment().setHandleIn(0,0),ie.getLastSegment().setHandleOut(0,0))}return Xe(ie),ve(Ve,!1,se,ne)}function We(se,ne){for(var $=se;$;){if($===ne)return;$=$._previous}for(;se._next&&se._next!==ne;)se=se._next;if(!se._next){for(;ne._previous;)ne=ne._previous;se._next=ne,ne._previous=se}}function He(se){for(var ne=se.length-1;ne>=0;ne--)se[ne].clearHandles()}function Qe(se,ne,$){var ie=se&&se.length;if(ie){var de=x.each(se,function(ai,fi){this[ai._id]={container:null,winding:ai.isClockwise()?1:-1,index:fi}},{}),ye=se.slice().sort(function(ai,fi){return V(fi.getArea())-V(ai.getArea())}),ge=ye[0],Pe=W.findItemBoundsCollisions(ye,null,ae.GEOMETRIC_EPSILON);$==null&&($=ge.isClockwise());for(var Fe=0;Fe<ie;Fe++){var Ve=ye[Fe],Xe=de[Ve._id],Ye=0,De=Pe[Fe];if(De){for(var Ge=null,ht=De.length-1;ht>=0;ht--)if(De[ht]<Fe){Ge=Ge||Ve.getInteriorPoint();var kt=ye[De[ht]];if(kt.contains(Ge)){var o=de[kt._id];Ye=o.winding,Xe.winding+=Ye,Xe.container=o.exclude?o.container:kt;break}}}if(ne(Xe.winding)===ne(Ye))Xe.exclude=!0,se[Xe.index]=null;else{var ke=Xe.container;Ve.setClockwise(ke?!ke.isClockwise():$)}}}return se}function Ue(se,ne,$){var ie=ne&&[],de=1e-8,ye=1-de,ge=!1,Pe=$||[],Fe=$&&{},Ve,Xe,Ye;function De(Yt){return Yt._path._id+"."+Yt._segment1._index}for(var Ge=($&&$.length)-1;Ge>=0;Ge--){var ht=$[Ge];ht._path&&(Fe[De(ht)]=!0)}for(var Ge=se.length-1;Ge>=0;Ge--){var kt=se[Ge],o=kt._time,ke=o,ai=ne&&!ne(kt),ht=kt._curve,fi;if(ht&&(ht!==Xe?(ge=!ht.hasHandles()||Fe&&Fe[De(ht)],Ve=[],Ye=null,Xe=ht):Ye>=de&&(o/=Ye)),ai){Ve&&Ve.push(kt);continue}else ne&&ie.unshift(kt);if(Ye=ke,o<de)fi=ht._segment1;else if(o>ye)fi=ht._segment2;else{var hi=ht.divideAtTime(o,!0);ge&&Pe.push(ht,hi),fi=hi._segment1;for(var Jt=Ve.length-1;Jt>=0;Jt--){var oi=Ve[Jt];oi._time=(oi._time-o)/(1-o)}}kt._setSegment(fi);var zi=fi._intersection,xi=kt._intersection;if(zi){We(zi,xi);for(var Si=zi;Si;)We(Si._intersection,zi),Si=Si._next}else fi._intersection=xi}return $||He(Pe),ie||se}function ft(se,ne,$,ie,de){var ye=Array.isArray(ne)?ne:ne[$?"hor":"ver"],ge=$?1:0,Pe=ge^1,Fe=[se.x,se.y],Ve=Fe[ge],Xe=Fe[Pe],Ye=1e-9,De=1e-6,Ge=Ve-Ye,ht=Ve+Ye,kt=0,o=0,ke=0,ai=0,fi=!1,hi=!1,Jt=1,oi=[],zi,xi;function Si(Wt){var Ki=Wt[Pe+0],Ut=Wt[Pe+6];if(!(Xe<v(Ki,Ut)||Xe>k(Ki,Ut))){var Tn=Wt[ge+0],cr=Wt[ge+2],Vs=Wt[ge+4],Ur=Wt[ge+6];if(Ki===Ut){(Tn<ht&&Ur>Ge||Ur<ht&&Tn>Ge)&&(fi=!0);return}var Vt=Xe===Ki?0:Xe===Ut||Ge>k(Tn,cr,Vs,Ur)||ht<v(Tn,cr,Vs,Ur)?1:lt.solveCubic(Wt,Pe,Xe,oi,0,1)>0?oi[0]:1,hr=Vt===0?Tn:Vt===1?Ur:lt.getPoint(Wt,Vt)[$?"y":"x"],Bt=Ki>Ut?1:-1,Fr=zi[Pe]>zi[Pe+6]?1:-1,Us=zi[ge+6];return Xe!==Ki?(hr<Ge?ke+=Bt:hr>ht?ai+=Bt:fi=!0,hr>Ve-De&&hr<Ve+De&&(Jt/=2)):(Bt!==Fr?Tn<Ge?ke+=Bt:Tn>ht&&(ai+=Bt):Tn!=Us&&(Us<ht&&hr>ht?(ai+=Bt,fi=!0):Us>Ge&&hr<Ge&&(ke+=Bt,fi=!0)),Jt/=4),zi=Wt,!de&&hr>Ge&&hr<ht&&lt.getTangent(Wt,Vt)[$?"x":"y"]===0&&ft(se,ne,!$,ie,!0)}}function Yt(Wt){var Ki=Wt[Pe+0],Ut=Wt[Pe+2],Tn=Wt[Pe+4],cr=Wt[Pe+6];if(Xe<=k(Ki,Ut,Tn,cr)&&Xe>=v(Ki,Ut,Tn,cr)){for(var Vs=Wt[ge+0],Ur=Wt[ge+2],Vt=Wt[ge+4],hr=Wt[ge+6],Bt=Ge>k(Vs,Ur,Vt,hr)||ht<v(Vs,Ur,Vt,hr)?[Wt]:lt.getMonoCurves(Wt,$),Fr,Us=0,ua=Bt.length;Us<ua;Us++)if(Fr=Si(Bt[Us]))return Fr}}for(var bn=0,or=ye.length;bn<or;bn++){var mn=ye[bn],qn=mn._path,jr=mn.getValues(),Zi;if((!bn||ye[bn-1]._path!==qn)&&(zi=null,qn._closed||(xi=lt.getValues(qn.getLastCurve().getSegment2(),mn.getSegment1(),null,!ie),xi[Pe]!==xi[Pe+6]&&(zi=xi)),!zi)){zi=jr;for(var ur=qn.getLastCurve();ur&&ur!==mn;){var Vn=ur.getValues();if(Vn[Pe]!==Vn[Pe+6]){zi=Vn;break}ur=ur.getPrevious()}}if(Zi=Yt(jr))return Zi;if(bn+1===or||ye[bn+1]._path!==qn){if(xi&&(Zi=Yt(xi)))return Zi;fi&&!ke&&!ai&&(ke=ai=qn.isClockwise(ie)^$?1:-1),kt+=ke,o+=ai,ke=ai=0,fi&&(hi=!0,fi=!1),xi=null}}return kt=V(kt),o=V(o),{winding:k(kt,o),windingL:kt,windingR:o,quality:Jt,onPath:hi}}function st(se,ne,$,ie,de){var ye=[],ge=se,Pe=0,Ye;do{var Fe=se.getCurve();if(Fe){var Ve=Fe.getLength();ye.push({segment:se,curve:Fe,length:Ve}),Pe+=Ve}se=se.getNext()}while(se&&!se._intersection&&se!==ge);for(var Xe=[.5,.25,.75],Ye={winding:0,quality:-1},De=.001,Ge=1-De,ht=0;ht<Xe.length&&Ye.quality<.5;ht++)for(var Ve=Pe*Xe[ht],kt=0,o=ye.length;kt<o;kt++){var ke=ye[kt],ai=ke.length;if(Ve<=ai){var Fe=ke.curve,fi=Fe._path,hi=fi._parent,Jt=hi instanceof gi?hi:fi,oi=ae.clamp(Fe.getTimeAt(Ve),De,Ge),zi=Fe.getPointAtTime(oi),xi=V(Fe.getTangentAtTime(oi).y)<Math.SQRT1_2,Si=null;if(de.subtract&&$){var Yt=Jt===ne?$:ne,bn=Yt._getWinding(zi,xi,!0);if(Jt===ne&&bn.winding||Jt===$&&!bn.winding){if(bn.quality<1)continue;Si={winding:0,quality:1}}}Si=Si||ft(zi,ie[fi._id][Fe.getIndex()],xi,!0),Si.quality>Ye.quality&&(Ye=Si);break}Ve-=ai}for(var kt=ye.length-1;kt>=0;kt--)ye[kt].segment._winding=Ye}function Me(se,ne){var $=[],ie;function de(or){var mn;return!!(or&&!or._visited&&(!ne||ne[(mn=or._winding||{}).winding]&&!(ne.unite&&mn.winding===2&&mn.windingL&&mn.windingR)))}function ye(or){if(or){for(var mn=0,qn=ie.length;mn<qn;mn++)if(or===ie[mn])return!0}return!1}function ge(or){for(var mn=or._segments,qn=0,jr=mn.length;qn<jr;qn++)mn[qn]._visited=!0}function Pe(or,mn){var qn=or._intersection,jr=qn,Zi=[];mn&&(ie=[or]);function ur(Vn,Wt){for(;Vn&&Vn!==Wt;){var Ki=Vn._segment,Ut=Ki&&Ki._path;if(Ut){var Tn=Ki.getNext()||Ut.getFirstSegment(),cr=Tn._intersection;Ki!==or&&(ye(Ki)||ye(Tn)||Tn&&de(Ki)&&(de(Tn)||cr&&de(cr._segment)))&&Zi.push(Ki),mn&&ie.push(Ki)}Vn=Vn._next}}if(qn){for(ur(qn);qn&&qn._previous;)qn=qn._previous;ur(qn,jr)}return Zi}se.sort(function(or,mn){var qn=or._intersection,jr=mn._intersection,Zi=!!(qn&&qn._overlap),ur=!!(jr&&jr._overlap),Vn=or._path,Wt=mn._path;return Zi^ur?Zi?1:-1:!qn^!jr?qn?1:-1:Vn!==Wt?Vn._id-Wt._id:or._index-mn._index});for(var Fe=0,Ve=se.length;Fe<Ve;Fe++){var Xe=se[Fe],Ye=de(Xe),De=null,Ge=!1,ht=!0,kt=[],o,ke,ai;if(Ye&&Xe._path._overlapsOnly){var fi=Xe._path,hi=Xe._intersection._segment._path;fi.compare(hi)&&(fi.getArea()&&$.push(fi.clone(!1)),ge(fi),ge(hi),Ye=!1)}for(;Ye;){var Jt=!De,oi=Pe(Xe,Jt),zi=oi.shift(),Ge=!Jt&&(ye(Xe)||ye(zi)),xi=!Ge&&zi;if(Jt&&(De=new Ot(Oe.NO_INSERT),o=null),Ge){(Xe.isFirst()||Xe.isLast())&&(ht=Xe._path._closed),Xe._visited=!0;break}if(xi&&o&&(kt.push(o),o=null),o||(xi&&oi.push(Xe),o={start:De._segments.length,crossings:oi,visited:ke=[],handleIn:ai}),xi&&(Xe=zi),!de(Xe)){De.removeSegments(o.start);for(var Si=0,Yt=ke.length;Si<Yt;Si++)ke[Si]._visited=!1;ke.length=0;do Xe=o&&o.crossings.shift(),(!Xe||!Xe._path)&&(Xe=null,o=kt.pop(),o&&(ke=o.visited,ai=o.handleIn));while(o&&!de(Xe));if(!Xe)break}var bn=Xe.getNext();De.add(new Je(Xe._point,ai,bn&&Xe._handleOut)),Xe._visited=!0,ke.push(Xe),Xe=bn||Xe._path.getFirstSegment(),ai=bn&&bn._handleIn}Ge&&(ht&&(De.getFirstSegment().setHandleIn(ai),De.setClosed(ht)),De.getArea()!==0&&$.push(De))}return $}return{_getWinding:function(se,ne,$){return ft(se,this.getCurves(),ne,$)},unite:function(se,ne){return Ee(this,se,"unite",ne)},intersect:function(se,ne){return Ee(this,se,"intersect",ne)},subtract:function(se,ne){return Ee(this,se,"subtract",ne)},exclude:function(se,ne){return Ee(this,se,"exclude",ne)},divide:function(se,ne){return ne&&(ne.trace==!1||ne.stroke)?ze(this,se,"divide"):ve([this.subtract(se,ne),this.intersect(se,ne)],!0,this,se,ne)},resolveCrossings:function(){var se=this._children,ne=se||[this];function $(o,ke){var ai=o&&o._intersection;return ai&&ai._overlap&&ai._path===ke}var ie=!1,de=!1,ye=this.getIntersections(null,function(o){return o.hasOverlap()&&(ie=!0)||o.isCrossing()&&(de=!0)}),ge=ie&&de&&[];if(ye=Nt.expand(ye),ie)for(var Pe=Ue(ye,function(o){return o.hasOverlap()},ge),Fe=Pe.length-1;Fe>=0;Fe--){var Ve=Pe[Fe],Xe=Ve._path,Ye=Ve._segment,De=Ye.getPrevious(),Ge=Ye.getNext();$(De,Xe)&&$(Ge,Xe)&&(Ye.remove(),De._handleOut._set(0,0),Ge._handleIn._set(0,0),De!==Ye&&!De.getCurve().hasLength()&&(Ge._handleIn.set(De._handleIn),De.remove()))}de&&(Ue(ye,ie&&function(o){var ke=o.getCurve(),ai=o.getSegment(),fi=o._intersection,hi=fi._curve,Jt=fi._segment;if(ke&&hi&&ke._path&&hi._path)return!0;ai&&(ai._intersection=null),Jt&&(Jt._intersection=null)},ge),ge&&He(ge),ne=Me(x.each(ne,function(o){x.push(this,o._segments)},[])));var ht=ne.length,kt;return ht>1&&se?(ne!==se&&this.setChildren(ne),kt=this):ht===1&&!se&&(ne[0]!==this&&this.setSegments(ne[0].removeSegments()),kt=this),kt||(kt=new gi(Oe.NO_INSERT),kt.addChildren(ne),kt=kt.reduce(),kt.copyAttributes(this),this.replaceWith(kt)),kt},reorient:function(se,ne){var $=this._children;return $&&$.length?this.setChildren(Qe(this.removeChildren(),function(ie){return!!(se?ie:ie&1)},ne)):ne!==n&&this.setClockwise(ne),this},getInteriorPoint:function(){var se=this.getBounds(),ne=se.getCenter(!0);if(!this.contains(ne)){for(var $=this.getCurves(),ie=ne.y,de=[],ye=[],ge=0,Pe=$.length;ge<Pe;ge++){var Fe=$[ge].getValues(),Ve=Fe[1],Xe=Fe[3],Ye=Fe[5],De=Fe[7];if(ie>=v(Ve,Xe,Ye,De)&&ie<=k(Ve,Xe,Ye,De))for(var Ge=lt.getMonoCurves(Fe),ht=0,kt=Ge.length;ht<kt;ht++){var o=Ge[ht],ke=o[1],ai=o[7];if(ke!==ai&&(ie>=ke&&ie<=ai||ie>=ai&&ie<=ke)){var fi=ie===ke?o[0]:ie===ai?o[6]:lt.solveCubic(o,1,ie,ye,0,1)===1?lt.getPoint(o,ye[0]).x:(o[0]+o[6])/2;de.push(fi)}}}de.length>1&&(de.sort(function(hi,Jt){return hi-Jt}),ne.x=(de[0]+de[1])/2)}return ne}}});var wi=x.extend({_class:"PathFlattener",initialize:function(v,k,V,Y,te){var fe=[],ve=[],Ie=0,Ee=1/(V||32),ze=v._segments,We=ze[0],He;function Qe(Me,se){var ne=lt.getValues(Me,se,te);fe.push(ne),Ue(ne,Me._index,0,1)}function Ue(Me,se,ne,$){if($-ne>Ee&&!(Y&&lt.isStraight(Me))&&!lt.isFlatEnough(Me,k||.25)){var ie=lt.subdivide(Me,.5),de=(ne+$)/2;Ue(ie[0],se,ne,de),Ue(ie[1],se,de,$)}else{var ye=Me[6]-Me[0],ge=Me[7]-Me[1],Pe=Math.sqrt(ye*ye+ge*ge);Pe>0&&(Ie+=Pe,ve.push({offset:Ie,curve:Me,index:se,time:$}))}}for(var ft=1,st=ze.length;ft<st;ft++)He=ze[ft],Qe(We,He),We=He;v._closed&&Qe(He||We,ze[0]),this.curves=fe,this.parts=ve,this.length=Ie,this.index=0},_get:function(v){for(var k=this.parts,V=k.length,Y,te=this.index;Y=te,!(!te||k[--te].offset<v););for(;Y<V;Y++){var fe=k[Y];if(fe.offset>=v){this.index=Y;var ve=k[Y-1],Ie=ve&&ve.index===fe.index?ve.time:0,Ee=ve?ve.offset:0;return{index:fe.index,time:Ie+(fe.time-Ie)*(v-Ee)/(fe.offset-Ee)}}}return{index:k[V-1].index,time:1}},drawPart:function(v,k,V){for(var Y=this._get(k),te=this._get(V),fe=Y.index,ve=te.index;fe<=ve;fe++){var Ie=lt.getPart(this.curves[fe],fe===Y.index?Y.time:0,fe===te.index?te.time:1);fe===Y.index&&v.moveTo(Ie[0],Ie[1]),v.bezierCurveTo.apply(v,Ie.slice(2))}}},x.each(lt._evaluateMethods,function(v){this[v+"At"]=function(k){var V=this._get(k);return lt[v](this.curves[V.index],V.time)}},{})),Ti=x.extend({initialize:function(v){for(var k=this.points=[],V=v._segments,Y=v._closed,te=0,fe,ve=V.length;te<ve;te++){var Ie=V[te].point;(!fe||!fe.equals(Ie))&&k.push(fe=Ie.clone())}Y&&(k.unshift(k[k.length-1]),k.push(k[1])),this.closed=Y},fit:function(v){var k=this.points,V=k.length,Y=null;return V>0&&(Y=[new Je(k[0])],V>1&&(this.fitCubic(Y,v,0,V-1,k[1].subtract(k[0]),k[V-2].subtract(k[V-1])),this.closed&&(Y.shift(),Y.pop()))),Y},fitCubic:function(v,k,V,Y,te,fe){var ve=this.points;if(Y-V===1){var Ie=ve[V],Ee=ve[Y],ze=Ie.getDistance(Ee)/3;this.addCurve(v,[Ie,Ie.add(te.normalize(ze)),Ee.add(fe.normalize(ze)),Ee]);return}for(var We=this.chordLengthParameterize(V,Y),He=Math.max(k,k*k),Qe,Ue=!0,ft=0;ft<=4;ft++){var st=this.generateBezier(V,Y,We,te,fe),Me=this.findMaxError(V,Y,st,We);if(Me.error<k&&Ue){this.addCurve(v,st);return}if(Qe=Me.index,Me.error>=He)break;Ue=this.reparameterize(V,Y,We,st),He=Me.error}var se=ve[Qe-1].subtract(ve[Qe+1]);this.fitCubic(v,k,V,Qe,te,se),this.fitCubic(v,k,Qe,Y,se.negate(),fe)},addCurve:function(v,k){var V=v[v.length-1];V.setHandleOut(k[1].subtract(k[0])),v.push(new Je(k[3],k[2].subtract(k[3])))},generateBezier:function(v,k,V,Y,te){for(var fe=1e-12,ve=Math.abs,Ie=this.points,Ee=Ie[v],ze=Ie[k],We=[[0,0],[0,0]],He=[0,0],Qe=0,Ue=k-v+1;Qe<Ue;Qe++){var ft=V[Qe],st=1-ft,Me=3*ft*st,se=st*st*st,ne=Me*st,$=Me*ft,ie=ft*ft*ft,de=Y.normalize(ne),ye=te.normalize($),ge=Ie[v+Qe].subtract(Ee.multiply(se+ne)).subtract(ze.multiply($+ie));We[0][0]+=de.dot(de),We[0][1]+=de.dot(ye),We[1][0]=We[0][1],We[1][1]+=ye.dot(ye),He[0]+=de.dot(ge),He[1]+=ye.dot(ge)}var Pe=We[0][0]*We[1][1]-We[1][0]*We[0][1],Fe,Ve;if(ve(Pe)>fe){var Xe=We[0][0]*He[1]-We[1][0]*He[0],Ye=He[0]*We[1][1]-He[1]*We[0][1];Fe=Ye/Pe,Ve=Xe/Pe}else{var De=We[0][0]+We[0][1],Ge=We[1][0]+We[1][1];Fe=Ve=ve(De)>fe?He[0]/De:ve(Ge)>fe?He[1]/Ge:0}var ht=ze.getDistance(Ee),kt=fe*ht,o,ke;if(Fe<kt||Ve<kt)Fe=Ve=ht/3;else{var ai=ze.subtract(Ee);o=Y.normalize(Fe),ke=te.normalize(Ve),o.dot(ai)-ke.dot(ai)>ht*ht&&(Fe=Ve=ht/3,o=ke=null)}return[Ee,Ee.add(o||Y.normalize(Fe)),ze.add(ke||te.normalize(Ve)),ze]},reparameterize:function(v,k,V,Y){for(var te=v;te<=k;te++)V[te-v]=this.findRoot(Y,this.points[te],V[te-v]);for(var te=1,fe=V.length;te<fe;te++)if(V[te]<=V[te-1])return!1;return!0},findRoot:function(v,k,V){for(var Y=[],te=[],fe=0;fe<=2;fe++)Y[fe]=v[fe+1].subtract(v[fe]).multiply(3);for(var fe=0;fe<=1;fe++)te[fe]=Y[fe+1].subtract(Y[fe]).multiply(2);var ve=this.evaluate(3,v,V),Ie=this.evaluate(2,Y,V),Ee=this.evaluate(1,te,V),ze=ve.subtract(k),We=Ie.dot(Ie)+ze.dot(Ee);return ae.isMachineZero(We)?V:V-ze.dot(Ie)/We},evaluate:function(v,k,V){for(var Y=k.slice(),te=1;te<=v;te++)for(var fe=0;fe<=v-te;fe++)Y[fe]=Y[fe].multiply(1-V).add(Y[fe+1].multiply(V));return Y[0]},chordLengthParameterize:function(v,k){for(var V=[0],Y=v+1;Y<=k;Y++)V[Y-v]=V[Y-v-1]+this.points[Y].getDistance(this.points[Y-1]);for(var Y=1,te=k-v;Y<=te;Y++)V[Y]/=V[te];return V},findMaxError:function(v,k,V,Y){for(var te=Math.floor((k-v+1)/2),fe=0,ve=v+1;ve<k;ve++){var Ie=this.evaluate(3,V,Y[ve-v]),Ee=Ie.subtract(this.points[ve]),ze=Ee.x*Ee.x+Ee.y*Ee.y;ze>=fe&&(fe=ze,te=ve)}return{error:fe,index:te}}}),Ni=Oe.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(k){this._content="",this._lines=[];var V=k&&x.isPlainObject(k)&&k.x===n&&k.y===n;this._initialize(V&&k,!V&&be.read(arguments))},_equals:function(v){return this._content===v._content},copyContent:function(v){this.setContent(v._content)},getContent:function(){return this._content},setContent:function(v){this._content=""+v,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),en=Ni.extend({_class:"PointText",initialize:function(){Ni.apply(this,arguments)},getPoint:function(){var v=this._matrix.getTranslation();return new je(v.x,v.y,this,"setPoint")},setPoint:function(){var v=be.read(arguments);this.translate(v.subtract(this._matrix.getTranslation()))},_draw:function(v,k,V){if(this._content){this._setStyles(v,k,V);var Y=this._lines,te=this._style,fe=te.hasFill(),ve=te.hasStroke(),Ie=te.getLeading(),Ee=v.shadowColor;v.font=te.getFontStyle(),v.textAlign=te.getJustification();for(var ze=0,We=Y.length;ze<We;ze++){v.shadowColor=Ee;var He=Y[ze];fe&&(v.fillText(He,0,0),v.shadowColor="rgba(0,0,0,0)"),ve&&v.strokeText(He,0,0),v.translate(0,Ie)}}},_getBounds:function(v,k){var V=this._style,Y=this._lines,te=Y.length,fe=V.getJustification(),ve=V.getLeading(),Ie=this.getView().getTextWidth(V.getFontStyle(),Y),Ee=0;fe!=="left"&&(Ee-=Ie/(fe==="center"?2:1));var ze=new at(Ee,te?-.75*ve:0,Ie,te*ve);return v?v._transformBounds(ze,ze):ze}}),ji=x.extend(new function(){var v={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},k={},V={transparent:[0,0,0,0]},Y;function te(Ie){var Ee=Ie.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||Ie.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),ze="rgb",We;if(Ee){var He=Ee[4]?4:3;We=new Array(He);for(var Qe=0;Qe<He;Qe++){var Ue=Ee[Qe+1];We[Qe]=parseInt(Ue.length==1?Ue+Ue:Ue,16)/255}}else if(Ee=Ie.match(/^(rgb|hsl)a?\((.*)\)$/)){ze=Ee[1],We=Ee[2].trim().split(/[,\s]+/g);for(var ft=ze==="hsl",Qe=0,st=Math.min(We.length,4);Qe<st;Qe++){var Me=We[Qe],Ue=parseFloat(Me);if(ft)if(Qe===0){var se=Me.match(/([a-z]*)$/)[1];Ue*={turn:360,rad:180/Math.PI,grad:.9}[se]||1}else Qe<3&&(Ue/=100);else Qe<3&&(Ue/=/%$/.test(Me)?100:255);We[Qe]=Ue}}else{var ne=V[Ie];if(!ne)if(c){Y||(Y=rn.getContext(1,1,{willReadFrequently:!0}),Y.globalCompositeOperation="copy"),Y.fillStyle="rgba(0,0,0,0)",Y.fillStyle=Ie,Y.fillRect(0,0,1,1);var $=Y.getImageData(0,0,1,1).data;ne=V[Ie]=[$[0]/255,$[1]/255,$[2]/255]}else ne=[0,0,0];We=ne.slice()}return[ze,We]}var fe=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],ve={"rgb-hsb":function(Ie,Ee,ze){var We=Math.max(Ie,Ee,ze),He=Math.min(Ie,Ee,ze),Qe=We-He,Ue=Qe===0?0:(We==Ie?(Ee-ze)/Qe+(Ee<ze?6:0):We==Ee?(ze-Ie)/Qe+2:(Ie-Ee)/Qe+4)*60;return[Ue,We===0?0:Qe/We,We]},"hsb-rgb":function(Ie,Ee,ze){Ie=(Ie/60%6+6)%6;var He=Math.floor(Ie),We=Ie-He,He=fe[He],Qe=[ze,ze*(1-Ee),ze*(1-Ee*We),ze*(1-Ee*(1-We))];return[Qe[He[0]],Qe[He[1]],Qe[He[2]]]},"rgb-hsl":function(Ie,Ee,ze){var We=Math.max(Ie,Ee,ze),He=Math.min(Ie,Ee,ze),Qe=We-He,Ue=Qe===0,ft=Ue?0:(We==Ie?(Ee-ze)/Qe+(Ee<ze?6:0):We==Ee?(ze-Ie)/Qe+2:(Ie-Ee)/Qe+4)*60,st=(We+He)/2,Me=Ue?0:st<.5?Qe/(We+He):Qe/(2-We-He);return[ft,Me,st]},"hsl-rgb":function(Ie,Ee,ze){if(Ie=(Ie/360%1+1)%1,Ee===0)return[ze,ze,ze];for(var We=[Ie+1/3,Ie,Ie-1/3],He=ze<.5?ze*(1+Ee):ze+Ee-ze*Ee,Qe=2*ze-He,Ue=[],ft=0;ft<3;ft++){var st=We[ft];st<0&&(st+=1),st>1&&(st-=1),Ue[ft]=6*st<1?Qe+(He-Qe)*6*st:2*st<1?He:3*st<2?Qe+(He-Qe)*(2/3-st)*6:Qe}return Ue},"rgb-gray":function(Ie,Ee,ze){return[Ie*.2989+Ee*.587+ze*.114]},"gray-rgb":function(Ie){return[Ie,Ie,Ie]},"gray-hsb":function(Ie){return[0,0,Ie]},"gray-hsl":function(Ie){return[0,0,Ie]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return x.each(v,function(Ie,Ee){k[Ee]=[],x.each(Ie,function(ze,We){var He=x.capitalize(ze),Qe=/^(hue|saturation)$/.test(ze),Ue=k[Ee][We]=Ee==="gradient"?ze==="gradient"?function(ft){var st=this._components[0];return ft=Vi.read(Array.isArray(ft)?ft:arguments,0,{readNull:!0}),st!==ft&&(st&&st._removeOwner(this),ft&&ft._addOwner(this)),ft}:function(){return be.read(arguments,0,{readNull:ze==="highlight",clone:!0})}:function(ft){return ft==null||isNaN(ft)?0:+ft};this["get"+He]=function(){return this._type===Ee||Qe&&/^hs[bl]$/.test(this._type)?this._components[We]:this._convert(Ee)[We]},this["set"+He]=function(ft){this._type!==Ee&&!(Qe&&/^hs[bl]$/.test(this._type))&&(this._components=this._convert(Ee),this._properties=v[Ee],this._type=Ee),this._components[We]=Ue.call(this,ft),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function Ie(Ee){var ze=arguments,We=this.__read,He=0,Qe,Ue,ft,st;Array.isArray(Ee)&&(ze=Ee,Ee=ze[0]);var Me=Ee!=null&&typeof Ee;if(Me==="string"&&Ee in v&&(Qe=Ee,Ee=ze[1],Array.isArray(Ee)?(Ue=Ee,ft=ze[2]):(We&&(He=1),ze=x.slice(ze,1),Me=typeof Ee)),!Ue){if(st=Me==="number"?ze:Me==="object"&&Ee.length!=null?Ee:null,st){Qe||(Qe=st.length>=3?"rgb":"gray");var se=v[Qe].length;ft=st[se],We&&(He+=st===arguments?se+(ft!=null?1:0):1),st.length>se&&(st=x.slice(st,0,se))}else if(Me==="string"){var ne=te(Ee);Qe=ne[0],Ue=ne[1],Ue.length===4&&(ft=Ue[3],Ue.length--)}else if(Me==="object")if(Ee.constructor===Ie){if(Qe=Ee._type,Ue=Ee._components.slice(),ft=Ee._alpha,Qe==="gradient")for(var $=1,ie=Ue.length;$<ie;$++){var de=Ue[$];de&&(Ue[$]=de.clone())}}else if(Ee.constructor===Vi)Qe="gradient",st=ze;else{Qe="hue"in Ee?"lightness"in Ee?"hsl":"hsb":"gradient"in Ee||"stops"in Ee||"radial"in Ee?"gradient":"gray"in Ee?"gray":"rgb";var ye=v[Qe],ge=k[Qe];this._components=Ue=[];for(var $=0,ie=ye.length;$<ie;$++){var Pe=Ee[ye[$]];Pe==null&&!$&&Qe==="gradient"&&"stops"in Ee&&(Pe={stops:Ee.stops,radial:Ee.radial}),Pe=ge[$].call(this,Pe),Pe!=null&&(Ue[$]=Pe)}ft=Ee.alpha}We&&Qe&&(He=1)}if(this._type=Qe||"rgb",!Ue){this._components=Ue=[];for(var ge=k[this._type],$=0,ie=ge.length;$<ie;$++){var Pe=ge[$].call(this,st&&st[$]);Pe!=null&&(Ue[$]=Pe)}}return this._components=Ue,this._properties=v[this._type],this._alpha=ft,We&&(this.__read=He),this},set:"#initialize",_serialize:function(Ie,Ee){var ze=this.getComponents();return x.serialize(/^(gray|rgb)$/.test(this._type)?ze:[this._type].concat(ze),Ie,!0,Ee)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(Ie){var Ee;return this._type===Ie?this._components.slice():(Ee=ve[this._type+"-"+Ie])?Ee.apply(this,this._components):ve["rgb-"+Ie].apply(this,ve[this._type+"-rgb"].apply(this,this._components))},convert:function(Ie){return new ji(Ie,this._convert(Ie),this._alpha)},getType:function(){return this._type},setType:function(Ie){this._components=this._convert(Ie),this._properties=v[Ie],this._type=Ie},getComponents:function(){var Ie=this._components.slice();return this._alpha!=null&&Ie.push(this._alpha),Ie},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(Ie){this._alpha=Ie==null?null:Math.min(Math.max(Ie,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(Ie){var Ee=x.isPlainValue(Ie,!0)?ji.read(arguments):Ie;return Ee===this||Ee&&this._class===Ee._class&&this._type===Ee._type&&this.getAlpha()===Ee.getAlpha()&&x.equals(this._components,Ee._components)||!1},toString:function(){for(var Ie=this._properties,Ee=[],ze=this._type==="gradient",We=he.instance,He=0,Qe=Ie.length;He<Qe;He++){var Ue=this._components[He];Ue!=null&&Ee.push(Ie[He]+": "+(ze?Ue:We.number(Ue)))}return this._alpha!=null&&Ee.push("alpha: "+We.number(this._alpha)),"{ "+Ee.join(", ")+" }"},toCSS:function(Ie){var Ee=this._convert("rgb"),ze=Ie||this._alpha==null?1:this._alpha;function We(He){return Math.round((He<0?0:He>1?1:He)*255)}return Ee=[We(Ee[0]),We(Ee[1]),We(Ee[2])],ze<1&&Ee.push(ze<0?0:ze),Ie?"#"+((1<<24)+(Ee[0]<<16)+(Ee[1]<<8)+Ee[2]).toString(16).slice(1):(Ee.length==4?"rgba(":"rgb(")+Ee.join(",")+")"},toCanvasStyle:function(Ie,Ee){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var ze=this._components,We=ze[0],He=We._stops,Qe=ze[1],Ue=ze[2],ft=ze[3],st=Ee&&Ee.inverted(),Me;if(st&&(Qe=st._transformPoint(Qe),Ue=st._transformPoint(Ue),ft&&(ft=st._transformPoint(ft))),We._radial){var se=Ue.getDistance(Qe);if(ft){var ne=ft.subtract(Qe);ne.getLength()>se&&(ft=Qe.add(ne.normalize(se-.1)))}var $=ft||Qe;Me=Ie.createRadialGradient($.x,$.y,0,Qe.x,Qe.y,se)}else Me=Ie.createLinearGradient(Qe.x,Qe.y,Ue.x,Ue.y);for(var ie=0,de=He.length;ie<de;ie++){var ye=He[ie],ge=ye._offset;Me.addColorStop(ge??ie/(de-1),ye._color.toCanvasStyle())}return this._canvasStyle=Me},transform:function(Ie){if(this._type==="gradient"){for(var Ee=this._components,ze=1,We=Ee.length;ze<We;ze++){var He=Ee[ze];Ie._transformPoint(He,He,!0)}this._changed()}},statics:{_types:v,random:function(){var Ie=Math.random;return new ji(Ie(),Ie(),Ie())},_setOwner:function(Ie,Ee,ze){return Ie&&(Ie._owner&&Ee&&Ie._owner!==Ee&&(Ie=Ie.clone()),!Ie._owner^!Ee&&(Ie._owner=Ee||null,Ie._setter=ze||null)),Ie}}})},new function(){var v={add:function(k,V){return k+V},subtract:function(k,V){return k-V},multiply:function(k,V){return k*V},divide:function(k,V){return k/V}};return x.each(v,function(k,V){this[V]=function(Y){Y=ji.read(arguments);for(var te=this._type,fe=this._components,ve=Y._convert(te),Ie=0,Ee=fe.length;Ie<Ee;Ie++)ve[Ie]=k(fe[Ie],ve[Ie]);return new ji(te,ve,this._alpha!=null?k(this._alpha,Y.getAlpha()):null)}},{})}),Vi=x.extend({_class:"Gradient",initialize:function(k,V){this._id=ue.get(),k&&x.isPlainObject(k)&&(this.set(k),k=V=null),this._stops==null&&this.setStops(k||["white","black"]),this._radial==null&&this.setRadial(typeof V=="string"&&V==="radial"||V||!1)},_serialize:function(v,k){return k.add(this,function(){return x.serialize([this._stops,this._radial],v,!0,k)})},_changed:function(){for(var v=0,k=this._owners&&this._owners.length;v<k;v++)this._owners[v]._changed()},_addOwner:function(v){this._owners||(this._owners=[]),this._owners.push(v)},_removeOwner:function(v){var k=this._owners?this._owners.indexOf(v):-1;k!=-1&&(this._owners.splice(k,1),this._owners.length||(this._owners=n))},clone:function(){for(var v=[],k=0,V=this._stops.length;k<V;k++)v[k]=this._stops[k].clone();return new Vi(v,this._radial)},getStops:function(){return this._stops},setStops:function(v){if(v.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var k=this._stops;if(k)for(var V=0,Y=k.length;V<Y;V++)k[V]._owner=n;k=this._stops=nn.readList(v,0,{clone:!0});for(var V=0,Y=k.length;V<Y;V++)k[V]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(v){this._radial=v,this._changed()},equals:function(v){if(v===this)return!0;if(v&&this._class===v._class){var k=this._stops,V=v._stops,Y=k.length;if(Y===V.length){for(var te=0;te<Y;te++)if(!k[te].equals(V[te]))return!1;return!0}}return!1}}),nn=x.extend({_class:"GradientStop",initialize:function(k,V){var Y=k,te=V;typeof k=="object"&&V===n&&(Array.isArray(k)&&typeof k[0]!="number"?(Y=k[0],te=k[1]):("color"in k||"offset"in k||"rampPoint"in k)&&(Y=k.color,te=k.offset||k.rampPoint||0)),this.setColor(Y),this.setOffset(te)},clone:function(){return new nn(this._color.clone(),this._offset)},_serialize:function(v,k){var V=this._color,Y=this._offset;return x.serialize(Y==null?[V]:[V,Y],v,!0,k)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(v){this._offset=v,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){ji._setOwner(this._color,null),this._color=ji._setOwner(ji.read(arguments,0),this,"setColor"),this._changed()},equals:function(v){return v===this||v&&this._class===v._class&&this._color.equals(v._color)&&this._offset==v._offset||!1}}),vn=x.extend(new function(){var v={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new be,selectedColor:null},k=x.set({},v,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),V=x.set({},k,{fillColor:new ji}),Y={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},te={beans:!0},fe={_class:"Style",beans:!0,initialize:function(Ie,Ee,ze){this._values={},this._owner=Ee,this._project=Ee&&Ee._project||ze||In.project,this._defaults=!Ee||Ee instanceof jt?k:Ee instanceof Ni?V:v,Ie&&this.set(Ie)}};return x.each(k,function(ve,Ie){var Ee=/Color$/.test(Ie),ze=Ie==="shadowOffset",We=x.capitalize(Ie),He=Y[Ie],Qe="set"+We,Ue="get"+We;fe[Qe]=function(ft){var st=this._owner,Me=st&&st._children,se=Me&&Me.length>0&&!(st instanceof gi);if(se)for(var ne=0,$=Me.length;ne<$;ne++)Me[ne]._style[Qe](ft);if((Ie==="selectedColor"||!se)&&Ie in this._defaults){var ie=this._values[Ie];ie!==ft&&(Ee&&(ie&&(ji._setOwner(ie,null),ie._canvasStyle=null),ft&&ft.constructor===ji&&(ft=ji._setOwner(ft,st,se&&Qe))),this._values[Ie]=ft,st&&st._changed(He||129))}},fe[Ue]=function(ft){var st=this._owner,Me=st&&st._children,se=Me&&Me.length>0&&!(st instanceof gi),ne;if(se&&!ft)for(var $=0,ie=Me.length;$<ie;$++){var de=Me[$]._style[Ue]();if(!$)ne=de;else if(!x.equals(ne,de))return n}else if(Ie in this._defaults){var ne=this._values[Ie];if(ne===n)ne=this._defaults[Ie],ne&&ne.clone&&(ne=ne.clone());else{var ye=Ee?ji:ze?be:null;ye&&!(ne&&ne.constructor===ye)&&(this._values[Ie]=ne=ye.read([ne],0,{readNull:!0,clone:!0}))}}return ne&&Ee&&(ne=ji._setOwner(ne,st,se&&Qe)),ne},te[Ue]=function(ft){return this._style[Ue](ft)},te[Qe]=function(ft){this._style[Qe](ft)}}),x.each({Font:"FontFamily",WindingRule:"FillRule"},function(ve,Ie){var Ee="get"+Ie,ze="set"+Ie;fe[Ee]=te[Ee]="#get"+ve,fe[ze]=te[ze]="#set"+ve}),Oe.inject(te),fe},{set:function(v){var k=v instanceof vn,V=k?v._values:v;if(V){for(var Y in V)if(Y in this._defaults){var te=V[Y];this[Y]=te&&k&&te.clone?te.clone():te}}},equals:function(v){function k(V,Y,te){var fe=V._values,ve=Y._values,Ie=Y._defaults;for(var Ee in fe){var ze=fe[Ee],We=ve[Ee];if(!(te&&Ee in ve)&&!x.equals(ze,We===n?Ie[Ee]:We))return!1}return!0}return v===this||v&&this._class===v._class&&k(this,v)&&k(v,this,!0)||!1},_dispose:function(){var v;v=this.getFillColor(),v&&(v._canvasStyle=null),v=this.getStrokeColor(),v&&(v._canvasStyle=null),v=this.getShadowColor(),v&&(v._canvasStyle=null)},hasFill:function(){var v=this.getFillColor();return!!v&&v.alpha>0},hasStroke:function(){var v=this.getStrokeColor();return!!v&&v.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var v=this.getShadowColor();return!!v&&v.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var v=this.getFontSize();return this.getFontWeight()+" "+v+(/[a-z]/i.test(v+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function v(){var k=v.base.call(this),V=this.getFontSize();return/pt|em|%|px/.test(V)&&(V=this.getView().getPixelSize(V)),k??V*1.2}}),Ci=new function(){function v(k,V,Y,te){for(var fe=["","webkit","moz","Moz","ms","o"],ve=V[0].toUpperCase()+V.substring(1),Ie=0;Ie<6;Ie++){var Ee=fe[Ie],ze=Ee?Ee+ve:V;if(ze in k){if(Y)k[ze]=te;else return k[ze];break}}}return{getStyles:function(k){var V=k&&k.nodeType!==9?k.ownerDocument:k,Y=V&&V.defaultView;return Y&&Y.getComputedStyle(k,"")},getBounds:function(k,V){var Y=k.ownerDocument,te=Y.body,fe=Y.documentElement,ve;try{ve=k.getBoundingClientRect()}catch{ve={left:0,top:0,width:0,height:0}}var Ie=ve.left-(fe.clientLeft||te.clientLeft||0),Ee=ve.top-(fe.clientTop||te.clientTop||0);if(!V){var ze=Y.defaultView;Ie+=ze.pageXOffset||fe.scrollLeft||te.scrollLeft,Ee+=ze.pageYOffset||fe.scrollTop||te.scrollTop}return new at(Ie,Ee,ve.width,ve.height)},getViewportBounds:function(k){var V=k.ownerDocument,Y=V.defaultView,te=V.documentElement;return new at(0,0,Y.innerWidth||te.clientWidth,Y.innerHeight||te.clientHeight)},getOffset:function(k,V){return Ci.getBounds(k,V).getPoint()},getSize:function(k){return Ci.getBounds(k,!0).getSize()},isInvisible:function(k){return Ci.getSize(k).equals(new nt(0,0))},isInView:function(k){return!Ci.isInvisible(k)&&Ci.getViewportBounds(k).intersects(Ci.getBounds(k,!0))},isInserted:function(k){return g.body.contains(k)},getPrefixed:function(k,V){return k&&v(k,V)},setPrefixed:function(k,V,Y){if(typeof V=="object")for(var te in V)v(k,te,!0,V[te]);else v(k,V,!0,Y)}}},mi={add:function(v,k){if(v)for(var V in k)for(var Y=k[V],te=V.split(/[\s,]+/g),fe=0,ve=te.length;fe<ve;fe++){var Ie=te[fe],Ee=v===g&&(Ie==="touchstart"||Ie==="touchmove")?{passive:!1}:!1;v.addEventListener(Ie,Y,Ee)}},remove:function(v,k){if(v)for(var V in k)for(var Y=k[V],te=V.split(/[\s,]+/g),fe=0,ve=te.length;fe<ve;fe++)v.removeEventListener(te[fe],Y,!1)},getPoint:function(v){var k=v.targetTouches?v.targetTouches.length?v.targetTouches[0]:v.changedTouches[0]:v;return new be(k.pageX||k.clientX+g.documentElement.scrollLeft,k.pageY||k.clientY+g.documentElement.scrollTop)},getTarget:function(v){return v.target||v.srcElement},getRelatedTarget:function(v){return v.relatedTarget||v.toElement},getOffset:function(v,k){return mi.getPoint(v).subtract(Ci.getOffset(k||mi.getTarget(v)))}};mi.requestAnimationFrame=new function(){var v=Ci.getPrefixed(c,"requestAnimationFrame"),k=!1,V=[],Y;function te(){var fe=V;V=[];for(var ve=0,Ie=fe.length;ve<Ie;ve++)fe[ve]();k=v&&V.length,k&&v(te)}return function(fe){V.push(fe),v?k||(v(te),k=!0):Y||(Y=setInterval(te,1e3/60))}};var Ri=x.extend(S,{_class:"View",initialize:function v(k,V){function Y(He){return V[He]||parseInt(V.getAttribute(He),10)}function te(){var He=Ci.getSize(V);return He.isNaN()||He.isZero()?new nt(Y("width"),Y("height")):He}var fe;if(c&&V){this._id=V.getAttribute("id"),this._id==null&&V.setAttribute("id",this._id="paper-view-"+v._id++),mi.add(V,this._viewEvents);var ve="none";if(Ci.setPrefixed(V.style,{userDrag:ve,userSelect:ve,touchCallout:ve,contentZooming:ve,tapHighlightColor:"rgba(0,0,0,0)"}),a.hasAttribute(V,"resize")){var Ie=this;mi.add(c,this._windowEvents={resize:function(){Ie.setViewSize(te())}})}if(fe=te(),a.hasAttribute(V,"stats")&&typeof Stats<"u"){this._stats=new Stats;var Ee=this._stats.domElement,ze=Ee.style,We=Ci.getOffset(V);ze.position="absolute",ze.left=We.x+"px",ze.top=We.y+"px",g.body.appendChild(Ee)}}else fe=new nt(V),V=null;this._project=k,this._scope=k._scope,this._element=V,this._pixelRatio||(this._pixelRatio=c&&c.devicePixelRatio||1),this._setElementSize(fe.width,fe.height),this._viewSize=fe,v._views.push(this),v._viewsById[this._id]=this,(this._matrix=new xt)._owner=this,v._focused||(v._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!In.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;Ri._focused===this&&(Ri._focused=null),Ri._views.splice(Ri._views.indexOf(this),1),delete Ri._viewsById[this._id];var v=this._project;return v._view===this&&(v._view=null),mi.remove(this._element,this._viewEvents),mi.remove(c,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:x.each(Oe._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(v){this[v]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(v){this._autoUpdate=v,v&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var v=this;mi.requestAnimationFrame(function(){if(v._requested=!1,v._animate){v.requestUpdate();var k=v._element;(!Ci.getPrefixed(g,"hidden")||a.getAttribute(k,"keepalive")==="true")&&Ci.isInView(k)&&v._handleFrame()}v._autoUpdate&&v.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){In=this._scope;var v=Date.now()/1e3,k=this._last?v-this._last:0;this._last=v,this.emit("frame",new x({delta:k,time:this._time+=k,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(v,k){var V=this._frameItems;k?(V[v._id]={item:v,time:0,count:0},++this._frameItemCount===1&&this.on("frame",this._handleFrameItems)):(delete V[v._id],--this._frameItemCount===0&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(v){for(var k in this._frameItems){var V=this._frameItems[k];V.item.emit("frame",new x(v,{time:V.time+=v.delta,count:V.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=n},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var v=this._viewSize;return new tt(v.width,v.height,this,"setViewSize")},setViewSize:function(){var v=nt.read(arguments),k=v.subtract(this._viewSize);k.isZero()||(this._setElementSize(v.width,v.height),this._viewSize.set(v),this._changed(),this.emit("resize",{size:v,delta:k}),this._autoUpdate&&this.update())},_setElementSize:function(v,k){var V=this._element;V&&(V.width!==v&&(V.width=v),V.height!==k&&(V.height=k))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new at(new be,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return Ci.isInView(this._element)},isInserted:function(){return Ci.isInserted(this._element)},getPixelSize:function(v){var k=this._element,V;if(k){var Y=k.parentNode,te=g.createElement("div");te.style.fontSize=v,Y.appendChild(te),V=parseFloat(Ci.getStyles(te).fontSize),Y.removeChild(te)}else V=parseFloat(V);return V},getTextWidth:function(v,k){return 0}},x.each(["rotate","scale","shear","skew"],function(v){var k=v==="rotate";this[v]=function(){var V=arguments,Y=(k?x:be).read(V),te=be.read(V,0,{readNull:!0});return this.transform(new xt()[v](Y,te||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var v=new xt;return this.transform(v.translate.apply(v,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var v=be.read(arguments);this.translate(this.getCenter().subtract(v))},getZoom:function(){var v=this._decompose().scaling;return(v.x+v.y)/2},setZoom:function(v){this.transform(new xt().scale(v/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(v){var k=this.getRotation();k!=null&&v!=null&&this.rotate(v-k)},getScaling:function(){var v=this._decompose().scaling;return new je(v.x,v.y,this,"setScaling")},setScaling:function(){var v=this.getScaling(),k=be.read(arguments,0,{clone:!0,readNull:!0});v&&k&&this.scale(k.x/v.x,k.y/v.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var v=this._matrix;v.set.apply(v,arguments)},transform:function(v){this._matrix.append(v)},scrollBy:function(){this.translate(be.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(be.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(be.read(arguments))},getEventPoint:function(v){return this.viewToProject(mi.getOffset(v,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(v,k){g&&typeof k=="string"&&(k=g.getElementById(k));var V=c?Oi:Ri;return new V(v,k)}}},new function(){if(!c)return;var v,k,V=!1,Y=!1;function te(Ye){var De=mi.getTarget(Ye);return De.getAttribute&&Ri._viewsById[De.getAttribute("id")]}function fe(){var Ye=Ri._focused;if(!Ye||!Ye.isVisible()){for(var De=0,Ge=Ri._views.length;De<Ge;De++)if((Ye=Ri._views[De]).isVisible()){Ri._focused=k=Ye;break}}}function ve(Ye,De,Ge){Ye._handleMouseEvent("mousemove",De,Ge)}var Ie=c.navigator,Ee,ze,We;Ie.pointerEnabled||Ie.msPointerEnabled?(Ee="pointerdown MSPointerDown",ze="pointermove MSPointerMove",We="pointerup pointercancel MSPointerUp MSPointerCancel"):(Ee="touchstart",ze="touchmove",We="touchend touchcancel","ontouchstart"in c&&Ie.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(Ee+=" mousedown",ze+=" mousemove",We+=" mouseup"));var He={},Qe={mouseout:function(Ye){var De=Ri._focused,Ge=mi.getRelatedTarget(Ye);if(De&&(!Ge||Ge.nodeName==="HTML")){var ht=mi.getOffset(Ye,De._element),kt=ht.x,o=Math.abs,ke=o(kt),ai=1<<25,fi=ke-ai;ht.x=o(fi)<ke?fi*(kt<0?-1:1):kt,ve(De,Ye,De.viewToProject(ht))}},scroll:fe};He[Ee]=function(Ye){var De=Ri._focused=te(Ye);V||(V=!0,De._handleMouseEvent("mousedown",Ye))},Qe[ze]=function(Ye){var De=Ri._focused;if(!Y){var Ge=te(Ye);Ge?De!==Ge&&(De&&ve(De,Ye),v||(v=De),De=Ri._focused=k=Ge):k&&k===De&&(v&&!v.isInserted()&&(v=null),De=Ri._focused=v,v=null,fe())}De&&ve(De,Ye)},Qe[Ee]=function(){Y=!0},Qe[We]=function(Ye){var De=Ri._focused;De&&V&&De._handleMouseEvent("mouseup",Ye),Y=V=!1},mi.add(g,Qe),mi.add(c,{load:fe});var Ue=!1,ft=!1,st={doubleclick:"click",mousedrag:"mousemove"},Me=!1,se,ne,$,ie,de,ye,ge,Pe;function Fe(Ye,De,Ge,ht,kt,o,ke){var ai=!1,fi;function hi(Jt,oi){if(Jt.responds(oi)){if(fi||(fi=new sn(oi,ht,kt,De||Jt,o?kt.subtract(o):null)),Jt.emit(oi,fi)&&(Ue=!0,fi.prevented&&(ft=!0),fi.stopped))return ai=!0}else{var zi=st[oi];if(zi)return hi(Jt,zi)}}for(;Ye&&Ye!==ke&&!hi(Ye,Ge);)Ye=Ye._parent;return ai}function Ve(Ye,De,Ge,ht,kt,o){return Ye._project.removeOn(Ge),ft=Ue=!1,de&&Fe(de,null,Ge,ht,kt,o)||De&&De!==de&&!De.isDescendant(de)&&Fe(De,null,Ge==="mousedrag"?"mousemove":Ge,ht,kt,o,de)||Fe(Ye,de||De||Ye,Ge,ht,kt,o)}var Xe={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:He,_handleMouseEvent:function(Ye,De,Ge){var ht=this._itemEvents,kt=ht.native[Ye],o=Ye==="mousemove",ke=this._scope.tool,ai=this;function fi(Yt){return ht.virtual[Yt]||ai.responds(Yt)||ke&&ke.responds(Yt)}o&&V&&fi("mousedrag")&&(Ye="mousedrag"),Ge||(Ge=this.getEventPoint(De));var hi=this.getBounds().contains(Ge),Jt=kt&&hi&&ai._project.hitTest(Ge,{tolerance:0,fill:!0,stroke:!0}),oi=Jt&&Jt.item||null,zi=!1,xi={};if(xi[Ye.substr(5)]=!0,kt&&oi!==ie&&(ie&&Fe(ie,null,"mouseleave",De,Ge),oi&&Fe(oi,null,"mouseenter",De,Ge),ie=oi),Me^hi&&(Fe(this,null,hi?"mouseenter":"mouseleave",De,Ge),zi=!0),(hi||xi.drag)&&!Ge.equals(ne)&&(Ve(this,oi,o?Ye:"mousemove",De,Ge,ne),zi=!0),Me=hi,xi.down&&hi||xi.up&&se){if(Ve(this,oi,Ye,De,Ge,se),xi.down){if(Pe=oi===ye&&Date.now()-ge<300,$=ye=oi,!ft&&oi){for(var Si=oi;Si&&!Si.responds("mousedrag");)Si=Si._parent;Si&&(de=oi)}se=Ge}else xi.up&&(!ft&&oi===$&&(ge=Date.now(),Ve(this,oi,Pe?"doubleclick":"click",De,Ge,se),Pe=!1),$=de=null);Me=!1,zi=!0}ne=Ge,zi&&ke&&(Ue=ke._handleMouseEvent(Ye,De,Ge,xi)||Ue),De.cancelable!==!1&&(Ue&&!xi.move||xi.down&&fi("mouseup"))&&De.preventDefault()},_handleKeyEvent:function(Ye,De,Ge,ht){var kt=this._scope,o=kt.tool,ke;function ai(fi){fi.responds(Ye)&&(In=kt,fi.emit(Ye,ke=ke||new Ji(Ye,De,Ge,ht)))}this.isVisible()&&(ai(this),o&&o.responds(Ye)&&ai(o))},_countItemEvent:function(Ye,De){var Ge=this._itemEvents,ht=Ge.native,kt=Ge.virtual;for(var o in Xe)ht[o]=(ht[o]||0)+(Xe[o][Ye]||0)*De;kt[Ye]=(kt[Ye]||0)+De},statics:{updateFocus:fe,_resetState:function(){V=Y=Ue=Me=!1,v=k=se=ne=$=ie=de=ye=ge=Pe=null}}}}),Oi=Ri.extend({_class:"CanvasView",initialize:function(k,V){if(!(V instanceof c.HTMLCanvasElement)){var Y=nt.read(arguments,1);if(Y.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+x.slice(arguments,1));V=rn.getCanvas(Y)}var te=this._context=V.getContext("2d");if(te.save(),this._pixelRatio=1,!/^off|false$/.test(a.getAttribute(V,"hidpi"))){var fe=c.devicePixelRatio||1,ve=Ci.getPrefixed(te,"backingStorePixelRatio")||1;this._pixelRatio=fe/ve}Ri.call(this,k,V),this._needsUpdate=!0},remove:function v(){return this._context.restore(),v.base.call(this)},_setElementSize:function v(k,V){var Y=this._pixelRatio;if(v.base.call(this,k*Y,V*Y),Y!==1){var te=this._element,fe=this._context;if(!a.hasAttribute(te,"resize")){var ve=te.style;ve.width=k+"px",ve.height=V+"px"}fe.restore(),fe.save(),fe.scale(Y,Y)}},getContext:function(){return this._context},getPixelSize:function v(k){var V=In.agent,Y;if(V&&V.firefox)Y=v.base.call(this,k);else{var te=this._context,fe=te.font;te.font=k+" serif",Y=parseFloat(te.font),te.font=fe}return Y},getTextWidth:function(v,k){var V=this._context,Y=V.font,te=0;V.font=v;for(var fe=0,ve=k.length;fe<ve;fe++)te=Math.max(te,V.measureText(k[fe]).width);return V.font=Y,te},update:function(){if(!this._needsUpdate)return!1;var v=this._project,k=this._context,V=this._viewSize;return k.clearRect(0,0,V.width+1,V.height+1),v&&v.draw(k,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),_i=x.extend({_class:"Event",initialize:function(k){this.event=k,this.type=k&&k.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return Ai.modifiers}}),Ji=_i.extend({_class:"KeyEvent",initialize:function(k,V,Y,te){this.type=k,this.event=V,this.key=Y,this.character=te},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),Ai=new function(){var v={"	":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},k={tab:"	",space:" ",enter:"\r"},V={},Y={},te,fe,ve=new x({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var ze=In&&In.agent;return ze&&ze.mac?this.meta:this.control}}});function Ie(ze){var We=ze.key||ze.keyIdentifier;return We=/^U\+/.test(We)?String.fromCharCode(parseInt(We.substr(2),16)):/^Arrow[A-Z]/.test(We)?We.substr(5):We==="Unidentified"||We===n?String.fromCharCode(ze.keyCode):We,v[We]||(We.length>1?x.hyphenate(We):We.toLowerCase())}function Ee(ze,We,He,Qe){var Ue=Ri._focused,ft;if(V[We]=ze,ze?Y[We]=He:delete Y[We],We.length>1&&(ft=x.camelize(We))in ve){ve[ft]=ze;var st=In&&In.agent;if(ft==="meta"&&st&&st.mac)if(ze)te={};else{for(var Me in te)Me in Y&&Ee(!1,Me,te[Me],Qe);te=null}}else ze&&te&&(te[We]=He);Ue&&Ue._handleKeyEvent(ze?"keydown":"keyup",Qe,We,He)}return mi.add(g,{keydown:function(ze){var We=Ie(ze),He=In&&In.agent;We.length>1||He&&He.chrome&&(ze.altKey||He.mac&&ze.metaKey||!He.mac&&ze.ctrlKey)?Ee(!0,We,k[We]||(We.length>1?"":We),ze):fe=We},keypress:function(ze){if(fe){var We=Ie(ze),He=ze.charCode,Qe=He>=32?String.fromCharCode(He):We.length>1?"":We;We!==fe&&(We=Qe.toLowerCase()),Ee(!0,We,Qe,ze),fe=null}},keyup:function(ze){var We=Ie(ze);We in Y&&Ee(!1,We,Y[We],ze)}}),mi.add(c,{blur:function(ze){for(var We in Y)Ee(!1,We,Y[We],ze)}}),{modifiers:ve,isDown:function(ze){return!!V[ze]}}},sn=_i.extend({_class:"MouseEvent",initialize:function(k,V,Y,te,fe){this.type=k,this.event=V,this.point=Y,this.target=te,this.delta=fe},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),ei=_i.extend({_class:"ToolEvent",_item:null,initialize:function(k,V,Y){this.tool=k,this.type=V,this.event=Y},_choosePoint:function(v,k){return v||(k?k.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(v){this._point=v},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(v){this._lastPoint=v},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(v){this._downPoint=v},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(v){this._middlePoint=v},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(v){this._delta=v},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(v){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=v},getItem:function(){if(!this._item){var v=this.tool._scope.project.hitTest(this.getPoint());if(v){for(var k=v.item,V=k._parent;/^(Group|CompoundPath)$/.test(V._class);)k=V,V=V._parent;this._item=k}}return this._item},setItem:function(v){this._item=v},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),_n=G.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(k){G.call(this),this._moveCount=-1,this._downCount=-1,this.set(k)},getMinDistance:function(){return this._minDistance},setMinDistance:function(v){this._minDistance=v,v!=null&&this._maxDistance!=null&&v>this._maxDistance&&(this._maxDistance=v)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(v){this._maxDistance=v,this._minDistance!=null&&v!=null&&v<this._minDistance&&(this._minDistance=v)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(v){this._minDistance=this._maxDistance=v},_handleMouseEvent:function(v,k,V,Y){In=this._scope,Y.drag&&!this.responds(v)&&(v="mousemove");var te=Y.move||Y.drag,fe=this.responds(v),ve=this.minDistance,Ie=this.maxDistance,Ee=!1,ze=this;function We(Qe,Ue){var ft=V,st=te?ze._point:ze._downPoint||ft;if(te){if(ze._moveCount>=0&&ft.equals(st))return!1;if(st&&(Qe!=null||Ue!=null)){var Me=ft.subtract(st),se=Me.getLength();if(se<(Qe||0))return!1;Ue&&(ft=st.add(Me.normalize(Math.min(se,Ue))))}ze._moveCount++}return ze._point=ft,ze._lastPoint=st||ft,Y.down&&(ze._moveCount=-1,ze._downPoint=ft,ze._downCount++),!0}function He(){fe&&(Ee=ze.emit(v,new ei(ze,v,k))||Ee)}if(Y.down)We(),He();else if(Y.up)We(null,Ie),He();else if(fe)for(;We(ve,Ie);)He();return Ee}}),Pr=x.extend(S,{_class:"Tween",statics:{easings:new x({linear:function(v){return v},easeInQuad:function(v){return v*v},easeOutQuad:function(v){return v*(2-v)},easeInOutQuad:function(v){return v<.5?2*v*v:-1+2*(2-v)*v},easeInCubic:function(v){return v*v*v},easeOutCubic:function(v){return--v*v*v+1},easeInOutCubic:function(v){return v<.5?4*v*v*v:(v-1)*(2*v-2)*(2*v-2)+1},easeInQuart:function(v){return v*v*v*v},easeOutQuart:function(v){return 1- --v*v*v*v},easeInOutQuart:function(v){return v<.5?8*v*v*v*v:1-8*--v*v*v*v},easeInQuint:function(v){return v*v*v*v*v},easeOutQuint:function(v){return 1+--v*v*v*v*v},easeInOutQuint:function(v){return v<.5?16*v*v*v*v*v:1+16*--v*v*v*v*v}})},initialize:function v(k,V,Y,te,fe,ve){this.object=k;var Ie=typeof fe,Ee=Ie==="function";this.type=Ee?Ie:Ie==="string"?fe:"linear",this.easing=Ee?fe:v.easings[this.type],this.duration=te,this.running=!1,this._then=null,this._startTime=null;var ze=V||Y;this._keys=ze?Object.keys(ze):[],this._parsedKeys=this._parseKeys(this._keys),this._from=ze&&this._getState(V),this._to=ze&&this._getState(Y),ve!==!1&&this.start()},then:function(v){return this._then=v,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(v){if(this.running){v>=1&&(v=1,this.running=!1);for(var k=this.easing(v),V=this._keys,Y=function(We){return typeof We=="function"?We(k,v):We},te=0,fe=V&&V.length;te<fe;te++){var ve=V[te],Ie=Y(this._from[ve]),Ee=Y(this._to[ve]),ze=Ie&&Ee&&Ie.__add&&Ee.__add?Ee.__subtract(Ie).__multiply(k).__add(Ie):(Ee-Ie)*k+Ie;this._setProperty(this._parsedKeys[ve],ze)}this.responds("update")&&this.emit("update",new x({progress:v,factor:k})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(v){var k=this._startTime,V=k?(v-k)/this.duration:0;k||(this._startTime=v),this.update(V)},_getState:function(v){for(var k=this._keys,V={},Y=0,te=k.length;Y<te;Y++){var fe=k[Y],ve=this._parsedKeys[fe],Ie=this._getProperty(ve),Ee;if(v){var ze=this._resolveValue(Ie,v[fe]);this._setProperty(ve,ze),Ee=this._getProperty(ve),Ee=Ee&&Ee.clone?Ee.clone():Ee,this._setProperty(ve,Ie)}else Ee=Ie&&Ie.clone?Ie.clone():Ie;V[fe]=Ee}return V},_resolveValue:function(v,k){if(k){if(Array.isArray(k)&&k.length===2){var V=k[0];return V&&V.match&&V.match(/^[+\-\*\/]=/)?this._calculate(v,V[0],k[1]):k}else if(typeof k=="string"){var Y=k.match(/^[+\-*/]=(.*)/);if(Y){var te=JSON.parse(Y[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(v,k[0],te)}}}return k},_calculate:function(v,k,V){return In.PaperScript.calculateBinary(v,k,V)},_parseKeys:function(v){for(var k={},V=0,Y=v.length;V<Y;V++){var te=v[V],fe=te.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");k[te]=fe.split("/")}return k},_getProperty:function(v,k){for(var V=this.object,Y=0,te=v.length-(k||0);Y<te&&V;Y++)V=V[v[Y]];return V},_setProperty:function(v,k){var V=this._getProperty(v,1);V&&(V[v[v.length-1]]=k)}}),ci={request:function(v){var k=new t.XMLHttpRequest;return k.open((v.method||"get").toUpperCase(),v.url,x.pick(v.async,!0)),v.mimeType&&k.overrideMimeType(v.mimeType),k.onload=function(){var V=k.status;V===0||V===200?v.onLoad&&v.onLoad.call(k,k.responseText):k.onerror()},k.onerror=function(){var V=k.status,Y='Could not load "'+v.url+'" (Status: '+V+")";if(v.onError)v.onError(Y,V);else throw new Error(Y)},k.send(null)}},rn=x.exports.CanvasProvider={canvases:[],getCanvas:function(v,k,V){if(!c)return null;var Y,te=!0;typeof v=="object"&&(k=v.height,v=v.width),this.canvases.length?Y=this.canvases.pop():(Y=g.createElement("canvas"),te=!1);var fe=Y.getContext("2d",V||{});if(!fe)throw new Error("Canvas "+Y+" is unable to provide a 2D context.");return Y.width===v&&Y.height===k?te&&fe.clearRect(0,0,v+1,k+1):(Y.width=v,Y.height=k),fe.save(),Y},getContext:function(v,k,V){var Y=this.getCanvas(v,k,V);return Y?Y.getContext("2d",V||{}):null},release:function(v){var k=v&&v.canvas?v.canvas:v;k&&k.getContext&&(k.getContext("2d").restore(),this.canvases.push(k))}},tr=new function(){var v=Math.min,k=Math.max,V=Math.abs,Y,te,fe,ve,Ie,Ee,ze,We,He,Qe,Ue;function ft(de,ye,ge){return .2989*de+.587*ye+.114*ge}function st(de,ye,ge,Ve){var Fe=Ve-ft(de,ye,ge);He=de+Fe,Qe=ye+Fe,Ue=ge+Fe;var Ve=ft(He,Qe,Ue),Xe=v(He,Qe,Ue),Ye=k(He,Qe,Ue);if(Xe<0){var De=Ve-Xe;He=Ve+(He-Ve)*Ve/De,Qe=Ve+(Qe-Ve)*Ve/De,Ue=Ve+(Ue-Ve)*Ve/De}if(Ye>255){var Ge=255-Ve,ht=Ye-Ve;He=Ve+(He-Ve)*Ge/ht,Qe=Ve+(Qe-Ve)*Ge/ht,Ue=Ve+(Ue-Ve)*Ge/ht}}function Me(de,ye,ge){return k(de,ye,ge)-v(de,ye,ge)}function se(de,ye,ge,Pe){var Fe=[de,ye,ge],Ve=k(de,ye,ge),Xe=v(de,ye,ge),Ye;Xe=Xe===de?0:Xe===ye?1:2,Ve=Ve===de?0:Ve===ye?1:2,Ye=v(Xe,Ve)===0?k(Xe,Ve)===1?2:1:0,Fe[Ve]>Fe[Xe]?(Fe[Ye]=(Fe[Ye]-Fe[Xe])*Pe/(Fe[Ve]-Fe[Xe]),Fe[Ve]=Pe):Fe[Ye]=Fe[Ve]=0,Fe[Xe]=0,He=Fe[0],Qe=Fe[1],Ue=Fe[2]}var ne={multiply:function(){He=Ie*Y/255,Qe=Ee*te/255,Ue=ze*fe/255},screen:function(){He=Ie+Y-Ie*Y/255,Qe=Ee+te-Ee*te/255,Ue=ze+fe-ze*fe/255},overlay:function(){He=Ie<128?2*Ie*Y/255:255-2*(255-Ie)*(255-Y)/255,Qe=Ee<128?2*Ee*te/255:255-2*(255-Ee)*(255-te)/255,Ue=ze<128?2*ze*fe/255:255-2*(255-ze)*(255-fe)/255},"soft-light":function(){var de=Y*Ie/255;He=de+Ie*(255-(255-Ie)*(255-Y)/255-de)/255,de=te*Ee/255,Qe=de+Ee*(255-(255-Ee)*(255-te)/255-de)/255,de=fe*ze/255,Ue=de+ze*(255-(255-ze)*(255-fe)/255-de)/255},"hard-light":function(){He=Y<128?2*Y*Ie/255:255-2*(255-Y)*(255-Ie)/255,Qe=te<128?2*te*Ee/255:255-2*(255-te)*(255-Ee)/255,Ue=fe<128?2*fe*ze/255:255-2*(255-fe)*(255-ze)/255},"color-dodge":function(){He=Ie===0?0:Y===255?255:v(255,255*Ie/(255-Y)),Qe=Ee===0?0:te===255?255:v(255,255*Ee/(255-te)),Ue=ze===0?0:fe===255?255:v(255,255*ze/(255-fe))},"color-burn":function(){He=Ie===255?255:Y===0?0:k(0,255-(255-Ie)*255/Y),Qe=Ee===255?255:te===0?0:k(0,255-(255-Ee)*255/te),Ue=ze===255?255:fe===0?0:k(0,255-(255-ze)*255/fe)},darken:function(){He=Ie<Y?Ie:Y,Qe=Ee<te?Ee:te,Ue=ze<fe?ze:fe},lighten:function(){He=Ie>Y?Ie:Y,Qe=Ee>te?Ee:te,Ue=ze>fe?ze:fe},difference:function(){He=Ie-Y,He<0&&(He=-He),Qe=Ee-te,Qe<0&&(Qe=-Qe),Ue=ze-fe,Ue<0&&(Ue=-Ue)},exclusion:function(){He=Ie+Y*(255-Ie-Ie)/255,Qe=Ee+te*(255-Ee-Ee)/255,Ue=ze+fe*(255-ze-ze)/255},hue:function(){se(Y,te,fe,Me(Ie,Ee,ze)),st(He,Qe,Ue,ft(Ie,Ee,ze))},saturation:function(){se(Ie,Ee,ze,Me(Y,te,fe)),st(He,Qe,Ue,ft(Ie,Ee,ze))},luminosity:function(){st(Ie,Ee,ze,ft(Y,te,fe))},color:function(){st(Y,te,fe,ft(Ie,Ee,ze))},add:function(){He=v(Ie+Y,255),Qe=v(Ee+te,255),Ue=v(ze+fe,255)},subtract:function(){He=k(Ie-Y,0),Qe=k(Ee-te,0),Ue=k(ze-fe,0)},average:function(){He=(Ie+Y)/2,Qe=(Ee+te)/2,Ue=(ze+fe)/2},negation:function(){He=255-V(255-Y-Ie),Qe=255-V(255-te-Ee),Ue=255-V(255-fe-ze)}},$=this.nativeModes=x.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(de){this[de]=!0},{}),ie=rn.getContext(1,1,{willReadFrequently:!0});ie&&(x.each(ne,function(de,ye){var ge=ye==="darken",Pe=!1;ie.save();try{ie.fillStyle=ge?"#300":"#a00",ie.fillRect(0,0,1,1),ie.globalCompositeOperation=ye,ie.globalCompositeOperation===ye&&(ie.fillStyle=ge?"#a00":"#300",ie.fillRect(0,0,1,1),Pe=ie.getImageData(0,0,1,1).data[0]!==ge?170:51)}catch{}ie.restore(),$[ye]=Pe}),rn.release(ie)),this.process=function(de,ye,ge,Pe,Fe){var Ve=ye.canvas,Xe=de==="normal";if(Xe||$[de])ge.save(),ge.setTransform(1,0,0,1,0,0),ge.globalAlpha=Pe,Xe||(ge.globalCompositeOperation=de),ge.drawImage(Ve,Fe.x,Fe.y),ge.restore();else{var Ye=ne[de];if(!Ye)return;for(var De=ge.getImageData(Fe.x,Fe.y,Ve.width,Ve.height),Ge=De.data,ht=ye.getImageData(0,0,Ve.width,Ve.height).data,kt=0,o=Ge.length;kt<o;kt+=4){Y=ht[kt],Ie=Ge[kt],te=ht[kt+1],Ee=Ge[kt+1],fe=ht[kt+2],ze=Ge[kt+2],ve=ht[kt+3],We=Ge[kt+3],Ye();var ke=ve*Pe/255,ai=1-ke;Ge[kt]=ke*He+ai*Ie,Ge[kt+1]=ke*Qe+ai*Ee,Ge[kt+2]=ke*Ue+ai*ze,Ge[kt+3]=ve*Pe+ai*We}ge.putImageData(De,Fe.x,Fe.y)}}},Pn=new function(){var v="http://www.w3.org/2000/svg",k="http://www.w3.org/2000/xmlns",V="http://www.w3.org/1999/xlink",Y={href:V,xlink:k,xmlns:k+"/","xmlns:xlink":k+"/"};function te(Ie,Ee,ze){return ve(g.createElementNS(v,Ie),Ee,ze)}function fe(Ie,Ee){var ze=Y[Ee],We=ze?Ie.getAttributeNS(ze,Ee):Ie.getAttribute(Ee);return We==="null"?null:We}function ve(Ie,Ee,ze){for(var We in Ee){var He=Ee[We],Qe=Y[We];typeof He=="number"&&ze&&(He=ze.number(He)),Qe?Ie.setAttributeNS(Qe,We,He):Ie.setAttribute(We,He)}return Ie}return{svg:v,xmlns:k,xlink:V,create:te,get:fe,set:ve}},Qn=x.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(v,k){return!k&&(v instanceof zt||v instanceof vt||v instanceof Ni)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(v,k){var V=x.capitalize(k),Y=v[2];this[k]={type:v[1],property:k,attribute:v[0],toSVG:Y,fromSVG:Y&&x.each(Y,function(te,fe){this[te]=fe},{}),exportFilter:v[3],get:"get"+V,set:"set"+V}},{});new function(){var v;function k(ne,$,ie){var de=new x,ye=ne.getTranslation();if($){var ge;ne.isInvertible()?(ne=ne._shiftless(),ge=ne._inverseTransform(ye),ye=null):ge=new be,de[ie?"cx":"x"]=ge.x,de[ie?"cy":"y"]=ge.y}if(!ne.isIdentity()){var Pe=ne.decompose();if(Pe){var Fe=[],Ve=Pe.rotation,Xe=Pe.scaling,Ye=Pe.skewing;ye&&!ye.isZero()&&Fe.push("translate("+v.point(ye)+")"),Ve&&Fe.push("rotate("+v.number(Ve)+")"),(!ae.isZero(Xe.x-1)||!ae.isZero(Xe.y-1))&&Fe.push("scale("+v.point(Xe)+")"),Ye.x&&Fe.push("skewX("+v.number(Ye.x)+")"),Ye.y&&Fe.push("skewY("+v.number(Ye.y)+")"),de.transform=Fe.join(" ")}else de.transform="matrix("+ne.getValues().join(",")+")"}return de}function V(ne,$){for(var ie=k(ne._matrix),de=ne._children,ye=Pn.create("g",ie,v),ge=0,Pe=de.length;ge<Pe;ge++){var Fe=de[ge],Ve=Me(Fe,$);if(Ve)if(Fe.isClipMask()){var Xe=Pn.create("clipPath");Xe.appendChild(Ve),ft(Fe,Xe,"clip"),Pn.set(ye,{"clip-path":"url(#"+Xe.id+")"})}else ye.appendChild(Ve)}return ye}function Y(ne,$){var ie=k(ne._matrix,!0),de=ne.getSize(),ye=ne.getImage();return ie.x-=de.width/2,ie.y-=de.height/2,ie.width=de.width,ie.height=de.height,ie.href=$.embedImages==!1&&ye&&ye.src||ne.toDataURL(),Pn.create("image",ie,v)}function te(ne,$){var ie=$.matchShapes;if(ie){var de=ne.toShape(!1);if(de)return fe(de)}var ye=ne._segments,ge=ye.length,Pe,Fe=k(ne._matrix);if(ie&&ge>=2&&!ne.hasHandles())if(ge>2){Pe=ne._closed?"polygon":"polyline";for(var Ve=[],Xe=0;Xe<ge;Xe++)Ve.push(v.point(ye[Xe]._point));Fe.points=Ve.join(" ")}else{Pe="line";var Ye=ye[0]._point,De=ye[1]._point;Fe.set({x1:Ye.x,y1:Ye.y,x2:De.x,y2:De.y})}else Pe="path",Fe.d=ne.getPathData(null,$.precision);return Pn.create(Pe,Fe,v)}function fe(ne){var $=ne._type,ie=ne._radius,de=k(ne._matrix,!0,$!=="rectangle");if($==="rectangle"){$="rect";var ye=ne._size,ge=ye.width,Pe=ye.height;de.x-=ge/2,de.y-=Pe/2,de.width=ge,de.height=Pe,ie.isZero()&&(ie=null)}return ie&&($==="circle"?de.r=ie:(de.rx=ie.width,de.ry=ie.height)),Pn.create($,de,v)}function ve(ne,$){var ie=k(ne._matrix),de=ne.getPathData(null,$.precision);return de&&(ie.d=de),Pn.create("path",ie,v)}function Ie(ne,$){var ie=k(ne._matrix,!0),de=ne._definition,ye=Ue(de,"symbol"),ge=de._item,Pe=ge.getStrokeBounds();return ye||(ye=Pn.create("symbol",{viewBox:v.rectangle(Pe)}),ye.appendChild(Me(ge,$)),ft(de,ye,"symbol")),ie.href="#"+ye.id,ie.x+=Pe.x,ie.y+=Pe.y,ie.width=Pe.width,ie.height=Pe.height,ie.overflow="visible",Pn.create("use",ie,v)}function Ee(ne){var $=Ue(ne,"color");if(!$){var ie=ne.getGradient(),de=ie._radial,ye=ne.getOrigin(),ge=ne.getDestination(),Pe;if(de){Pe={cx:ye.x,cy:ye.y,r:ye.getDistance(ge)};var Fe=ne.getHighlight();Fe&&(Pe.fx=Fe.x,Pe.fy=Fe.y)}else Pe={x1:ye.x,y1:ye.y,x2:ge.x,y2:ge.y};Pe.gradientUnits="userSpaceOnUse",$=Pn.create((de?"radial":"linear")+"Gradient",Pe,v);for(var Ve=ie._stops,Xe=0,Ye=Ve.length;Xe<Ye;Xe++){var De=Ve[Xe],Ge=De._color,ht=Ge.getAlpha(),kt=De._offset;Pe={offset:kt??Xe/(Ye-1)},Ge&&(Pe["stop-color"]=Ge.toCSS(!0)),ht<1&&(Pe["stop-opacity"]=ht),$.appendChild(Pn.create("stop",Pe,v))}ft(ne,$,"color")}return"url(#"+$.id+")"}function ze(ne){var $=Pn.create("text",k(ne._matrix,!0),v);return $.textContent=ne._content,$}var We={Group:V,Layer:V,Raster:Y,Path:te,Shape:fe,CompoundPath:ve,SymbolItem:Ie,PointText:ze};function He(ne,$,ie){var de={},ye=!ie&&ne.getParent(),ge=[];return ne._name!=null&&(de.id=ne._name),x.each(Qn,function(Pe){var Fe=Pe.get,Ve=Pe.type,Xe=ne[Fe]();if(Pe.exportFilter?Pe.exportFilter(ne,Xe):!ye||!x.equals(ye[Fe](),Xe)){if(Ve==="color"&&Xe!=null){var Ye=Xe.getAlpha();Ye<1&&(de[Pe.attribute+"-opacity"]=Ye)}Ve==="style"?ge.push(Pe.attribute+": "+Xe):de[Pe.attribute]=Xe==null?"none":Ve==="color"?Xe.gradient?Ee(Xe):Xe.toCSS(!0):Ve==="array"?Xe.join(","):Ve==="lookup"?Pe.toSVG[Xe]:Xe}}),ge.length&&(de.style=ge.join(";")),de.opacity===1&&delete de.opacity,ne._visible||(de.visibility="hidden"),Pn.set($,de,v)}var Qe;function Ue(ne,$){return Qe||(Qe={ids:{},svgs:{}}),ne&&Qe.svgs[$+"-"+(ne._id||ne.__id||(ne.__id=ue.get("svg")))]}function ft(ne,$,ie){Qe||Ue();var de=Qe.ids[ie]=(Qe.ids[ie]||0)+1;$.id=ie+"-"+de,Qe.svgs[ie+"-"+(ne._id||ne.__id)]=$}function st(ne,$){var ie=ne,de=null;if(Qe){ie=ne.nodeName.toLowerCase()==="svg"&&ne;for(var ye in Qe.svgs)de||(ie||(ie=Pn.create("svg"),ie.appendChild(ne)),de=ie.insertBefore(Pn.create("defs"),ie.firstChild)),de.appendChild(Qe.svgs[ye]);Qe=null}return $.asString?new t.XMLSerializer().serializeToString(ie):ie}function Me(ne,$,ie){var de=We[ne._class],ye=de&&de(ne,$);if(ye){var ge=$.onExport;ge&&(ye=ge(ne,ye,$)||ye);var Pe=JSON.stringify(ne._data);Pe&&Pe!=="{}"&&Pe!=="null"&&ye.setAttribute("data-paper-data",Pe)}return ye&&He(ne,ye,ie)}function se(ne){return ne||(ne={}),v=new he(ne.precision),ne}Oe.inject({exportSVG:function(ne){return ne=se(ne),st(Me(this,ne,!0),ne)}}),Mt.inject({exportSVG:function(ne){ne=se(ne);var $=this._children,ie=this.getView(),de=x.pick(ne.bounds,"view"),ye=ne.matrix||de==="view"&&ie._matrix,ge=ye&&xt.read([ye]),Pe=de==="view"?new at([0,0],ie.getViewSize()):de==="content"?Oe._getBounds($,ge,{stroke:!0}).rect:at.read([de],0,{readNull:!0}),Fe={version:"1.1",xmlns:Pn.svg,"xmlns:xlink":Pn.xlink};Pe&&(Fe.width=Pe.width,Fe.height=Pe.height,(Pe.x||Pe.x===0||Pe.y||Pe.y===0)&&(Fe.viewBox=v.rectangle(Pe)));var Ve=Pn.create("svg",Fe,v),Xe=Ve;ge&&!ge.isIdentity()&&(Xe=Ve.appendChild(Pn.create("g",k(ge),v)));for(var Ye=0,De=$.length;Ye<De;Ye++)Xe.appendChild(Me($[Ye],ne,!0));return st(Ve,ne)}})},new function(){var v={},k;function V($,ie,de,ye,ge,Pe){var Fe=Pn.get($,ie)||Pe,Ve=Fe==null?ye?null:de?"":0:de?Fe:parseFloat(Fe);return/%\s*$/.test(Fe)?Ve/100*(ge?1:k[/x|^width/.test(ie)?"width":"height"]):Ve}function Y($,ie,de,ye,ge,Pe,Fe){return ie=V($,ie||"x",!1,ye,ge,Pe),de=V($,de||"y",!1,ye,ge,Fe),ye&&(ie==null||de==null)?null:new be(ie,de)}function te($,ie,de,ye,ge){return ie=V($,ie||"width",!1,ye,ge),de=V($,de||"height",!1,ye,ge),ye&&(ie==null||de==null)?null:new nt(ie,de)}function fe($,ie,de){return $==="none"?null:ie==="number"?parseFloat($):ie==="array"?$?$.split(/[\s,]+/g).map(parseFloat):[]:ie==="color"?Me($)||$:ie==="lookup"?de[$]:$}function ve($,ie,de,ye){var ge=$.childNodes,Pe=ie==="clippath",Fe=ie==="defs",Ve=new jt,Xe=Ve._project,Ye=Xe._currentStyle,De=[];if(!Pe&&!Fe&&(Ve=st(Ve,$,ye),Xe._currentStyle=Ve._style.clone()),ye)for(var Ge=$.querySelectorAll("defs"),ht=0,kt=Ge.length;ht<kt;ht++)se(Ge[ht],de,!1);for(var ht=0,kt=ge.length;ht<kt;ht++){var o=ge[ht],ke;o.nodeType===1&&!/^defs$/i.test(o.nodeName)&&(ke=se(o,de,!1))&&!(ke instanceof Pt)&&De.push(ke)}return Ve.addChildren(De),Pe&&(Ve=st(Ve.reduce(),$,ye)),Xe._currentStyle=Ye,(Pe||Fe)&&(Ve.remove(),Ve=null),Ve}function Ie($,ie){for(var de=$.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),ye=[],ge=0,Pe=de.length;ge<Pe;ge+=2)ye.push(new be(parseFloat(de[ge]),parseFloat(de[ge+1])));var Fe=new Ot(ye);return ie==="polygon"&&Fe.closePath(),Fe}function Ee($){return zt.create($.getAttribute("d"))}function ze($,ie){var de=(V($,"href",!0)||"").substring(1),ye=ie==="radialgradient",ge;if(de)ge=v[de].getGradient(),ge._radial^ye&&(ge=ge.clone(),ge._radial=ye);else{for(var Pe=$.childNodes,Fe=[],Ve=0,Xe=Pe.length;Ve<Xe;Ve++){var Ye=Pe[Ve];Ye.nodeType===1&&Fe.push(st(new nn,Ye))}ge=new Vi(Fe,ye)}var De,Ge,ht,kt=V($,"gradientUnits",!0)!=="userSpaceOnUse";ye?(De=Y($,"cx","cy",!1,kt,"50%","50%"),Ge=De.add(V($,"r",!1,!1,kt,"50%"),0),ht=Y($,"fx","fy",!0,kt)):(De=Y($,"x1","y1",!1,kt,"0%","0%"),Ge=Y($,"x2","y2",!1,kt,"100%","0%"));var o=st(new ji(ge,De,Ge,ht),$);return o._scaleToBounds=kt,null}var We={"#document":function($,ie,de,ye){for(var ge=$.childNodes,Pe=0,Fe=ge.length;Pe<Fe;Pe++){var Ve=ge[Pe];if(Ve.nodeType===1)return se(Ve,de,ye)}},g:ve,svg:ve,clippath:ve,polygon:Ie,polyline:Ie,path:Ee,lineargradient:ze,radialgradient:ze,image:function($){var ie=new mt(V($,"href",!0));return ie.on("load",function(){var de=te($);this.setSize(de);var ye=Y($).add(de.divide(2));this._matrix.append(new xt().translate(ye))}),ie},symbol:function($,ie,de,ye){return new Pt(ve($,ie,de,ye),!0)},defs:ve,use:function($){var ie=(V($,"href",!0)||"").substring(1),de=v[ie],ye=Y($);return de?de instanceof Pt?de.place(ye):de.clone().translate(ye):null},circle:function($){return new vt.Circle(Y($,"cx","cy"),V($,"r"))},ellipse:function($){return new vt.Ellipse({center:Y($,"cx","cy"),radius:te($,"rx","ry")})},rect:function($){return new vt.Rectangle(new at(Y($),te($)),te($,"rx","ry"))},line:function($){return new Ot.Line(Y($,"x1","y1"),Y($,"x2","y2"))},text:function($){var ie=new en(Y($).add(Y($,"dx","dy")));return ie.setContent($.textContent.trim()||""),ie},switch:ve};function He($,ie,de,ye){if($.transform){for(var ge=(ye.getAttribute(de)||"").split(/\)\s*/g),Pe=new xt,Fe=0,Ve=ge.length;Fe<Ve;Fe++){var Xe=ge[Fe];if(!Xe)break;for(var Ye=Xe.split(/\(\s*/),De=Ye[0],Ge=Ye[1].split(/[\s,]+/g),ht=0,kt=Ge.length;ht<kt;ht++)Ge[ht]=parseFloat(Ge[ht]);switch(De){case"matrix":Pe.append(new xt(Ge[0],Ge[1],Ge[2],Ge[3],Ge[4],Ge[5]));break;case"rotate":Pe.rotate(Ge[0],Ge[1]||0,Ge[2]||0);break;case"translate":Pe.translate(Ge[0],Ge[1]||0);break;case"scale":Pe.scale(Ge);break;case"skewX":Pe.skew(Ge[0],0);break;case"skewY":Pe.skew(0,Ge[0]);break}}$.transform(Pe)}}function Qe($,ie,de){var ye=de==="fill-opacity"?"getFillColor":"getStrokeColor",ge=$[ye]&&$[ye]();ge&&ge.setAlpha(parseFloat(ie))}var Ue=x.set(x.each(Qn,function($){this[$.attribute]=function(ie,de){if(ie[$.set]&&(ie[$.set](fe(de,$.type,$.fromSVG)),$.type==="color")){var ye=ie[$.get]();if(ye&&ye._scaleToBounds){var ge=ie.getBounds();ye.transform(new xt().translate(ge.getPoint()).scale(ge.getSize()))}}}},{}),{id:function($,ie){v[ie]=$,$.setName&&$.setName(ie)},"clip-path":function($,ie){var de=Me(ie);if(de)if(de=de.clone(),de.setClipMask(!0),$ instanceof jt)$.insertChild(0,de);else return new jt(de,$)},gradientTransform:He,transform:He,"fill-opacity":Qe,"stroke-opacity":Qe,visibility:function($,ie){$.setVisible&&$.setVisible(ie==="visible")},display:function($,ie){$.setVisible&&$.setVisible(ie!==null)},"stop-color":function($,ie){$.setColor&&$.setColor(ie)},"stop-opacity":function($,ie){$._color&&$._color.setAlpha(parseFloat(ie))},offset:function($,ie){if($.setOffset){var de=ie.match(/(.*)%$/);$.setOffset(de?de[1]/100:parseFloat(ie))}},viewBox:function($,ie,de,ye,ge){var Pe=new at(fe(ie,"array")),Fe=te(ye,null,null,!0),Ve,Xe;if($ instanceof jt){var Ye=Fe?Fe.divide(Pe.getSize()):1,Xe=new xt().scale(Ye).translate(Pe.getPoint().negate());Ve=$}else $ instanceof Pt&&(Fe&&Pe.setSize(Fe),Ve=$._item);if(Ve){if(ft(ye,"overflow",ge)!=="visible"){var De=new vt.Rectangle(Pe);De.setClipMask(!0),Ve.addChild(De)}Xe&&Ve.transform(Xe)}}});function ft($,ie,de){var ye=$.attributes[ie],ge=ye&&ye.value;if(!ge&&$.style){var Pe=x.camelize(ie);ge=$.style[Pe],!ge&&de.node[Pe]!==de.parent[Pe]&&(ge=de.node[Pe])}return ge?ge==="none"?null:ge:n}function st($,ie,de){var ye=ie.parentNode,ge={node:Ci.getStyles(ie)||{},parent:!de&&!/^defs$/i.test(ye.tagName)&&Ci.getStyles(ye)||{}};return x.each(Ue,function(Pe,Fe){var Ve=ft(ie,Fe,ge);$=Ve!==n&&Pe($,Ve,Fe,ie,ge)||$}),$}function Me($){var ie=$&&$.match(/\((?:["'#]*)([^"')]+)/),de=ie&&ie[1],ye=de&&v[c?de.replace(c.location.href.split("#")[0]+"#",""):de];return ye&&ye._scaleToBounds&&(ye=ye.clone(),ye._scaleToBounds=!0),ye}function se($,ie,de){var ye=$.nodeName.toLowerCase(),ge=ye!=="#document",Pe=g.body,Fe,Ve,Xe;de&&ge&&(k=In.getView().getSize(),k=te($,null,null,!0)||k,Fe=Pn.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),Ve=$.parentNode,Xe=$.nextSibling,Fe.appendChild($),Pe.appendChild(Fe));var Ye=In.settings,De=Ye.applyMatrix,Ge=Ye.insertItems;Ye.applyMatrix=!1,Ye.insertItems=!1;var ht=We[ye],kt=ht&&ht($,ye,ie,de)||null;if(Ye.insertItems=Ge,Ye.applyMatrix=De,kt){ge&&!(kt instanceof jt)&&(kt=st(kt,$,de));var o=ie.onImport,ke=ge&&$.getAttribute("data-paper-data");o&&(kt=o($,kt,ie)||kt),ie.expandShapes&&kt instanceof vt&&(kt.remove(),kt=kt.toPath()),ke&&(kt._data=JSON.parse(ke))}return Fe&&(Pe.removeChild(Fe),Ve&&(Xe?Ve.insertBefore($,Xe):Ve.appendChild($))),de&&(v={},kt&&x.pick(ie.applyMatrix,De)&&kt.matrix.apply(!0,!0)),kt}function ne($,ie,de){if(!$)return null;ie=typeof ie=="function"?{onLoad:ie}:ie||{};var ye=In,ge=null;function Pe(Ye){try{var De=typeof Ye=="object"?Ye:new t.DOMParser().parseFromString(Ye.trim(),"image/svg+xml");if(!De.nodeName)throw De=null,new Error("Unsupported SVG source: "+$);In=ye,ge=se(De,ie,!0),(!ie||ie.insert!==!1)&&de._insertItem(n,ge);var Ge=ie.onLoad;Ge&&Ge(ge,Ye)}catch(ht){Fe(ht)}}function Fe(Ye,De){var Ge=ie.onError;if(Ge)Ge(Ye,De);else throw new Error(Ye)}if(typeof $=="string"&&!/^[\s\S]*</.test($)){var Ve=g.getElementById($);Ve?Pe(Ve):ci.request({url:$,async:!0,onLoad:Pe,onError:Fe})}else if(typeof File<"u"&&$ instanceof File){var Xe=new FileReader;return Xe.onload=function(){Pe(Xe.result)},Xe.onerror=function(){Fe(Xe.error)},Xe.readAsText($)}else Pe($);return ge}Oe.inject({importSVG:function($,ie){return ne($,ie,this)}}),Mt.inject({importSVG:function($,ie){return this.activate(),ne($,ie,this)}})},x.exports.PaperScript=(function(){var v=this,k=v.acorn;if(!k&&typeof pT<"u")try{k=_T()}catch{}if(!k){var V,Y;k=V=Y={},function(st,Me){if(typeof V=="object"&&typeof Y=="object")return Me(V);if(typeof n=="function"&&n.amd)return n(["exports"],Me);Me(st.acorn||(st.acorn={}))}(this,function(st){st.version="0.5.0";var Me,se,ne,$;st.parse=function(Ft,ii){return se=String(Ft),ne=se.length,de(ii),mu(),Tl(Me.program)};var ie=st.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function de(Ft){Me=Ft||{};for(var ii in ie)Object.prototype.hasOwnProperty.call(Me,ii)||(Me[ii]=ie[ii]);$=Me.sourceFile||null}var ye=st.getLineInfo=function(Ft,ii){for(var bi=1,Fi=0;;){Za.lastIndex=Fi;var Bn=Za.exec(Ft);if(Bn&&Bn.index<ii)++bi,Fi=Bn.index+Bn[0].length;else break}return{line:bi,column:ii-Fi}};st.tokenize=function(Ft,ii){se=String(Ft),ne=se.length,de(ii),mu();var bi={};function Fi(Bn){return ke=Fe,Qa(Bn),bi.start=Pe,bi.end=Fe,bi.startLoc=Ve,bi.endLoc=Xe,bi.type=Ye,bi.value=De,bi}return Fi.jumpTo=function(Bn,Hn){if(ge=Bn,Me.locations){ht=1,kt=Za.lastIndex=0;for(var lr;(lr=Za.exec(se))&&lr.index<Bn;)++ht,kt=lr.index+lr[0].length}Ge=Hn,so()},Fi};var ge,Pe,Fe,Ve,Xe,Ye,De,Ge,ht,kt,o,ke,ai,fi,hi,Jt;function oi(Ft,ii){var bi=ye(se,Ft);ii+=" ("+bi.line+":"+bi.column+")";var Fi=new SyntaxError(ii);throw Fi.pos=Ft,Fi.loc=bi,Fi.raisedAt=ge,Fi}var zi=[],xi={type:"num"},Si={type:"regexp"},Yt={type:"string"},bn={type:"name"},or={type:"eof"},mn={keyword:"break"},qn={keyword:"case",beforeExpr:!0},jr={keyword:"catch"},Zi={keyword:"continue"},ur={keyword:"debugger"},Vn={keyword:"default"},Wt={keyword:"do",isLoop:!0},Ki={keyword:"else",beforeExpr:!0},Ut={keyword:"finally"},Tn={keyword:"for",isLoop:!0},cr={keyword:"function"},Vs={keyword:"if"},Ur={keyword:"return",beforeExpr:!0},Vt={keyword:"switch"},hr={keyword:"throw",beforeExpr:!0},Bt={keyword:"try"},Fr={keyword:"var"},Us={keyword:"while",isLoop:!0},ua={keyword:"with"},Dr={keyword:"new",beforeExpr:!0},Na={keyword:"this"},Fo={keyword:"null",atomValue:null},Va={keyword:"true",atomValue:!0},Xs={keyword:"false",atomValue:!1},Zn={keyword:"in",binop:7,beforeExpr:!0},aa={break:mn,case:qn,catch:jr,continue:Zi,debugger:ur,default:Vn,do:Wt,else:Ki,finally:Ut,for:Tn,function:cr,if:Vs,return:Ur,switch:Vt,throw:hr,try:Bt,var:Fr,while:Us,with:ua,null:Fo,true:Va,false:Xs,new:Dr,in:Zn,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:Na,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},hs={type:"[",beforeExpr:!0},Ua={type:"]"},al={type:"{",beforeExpr:!0},ol={type:"}"},no={type:"(",beforeExpr:!0},Ga={type:")"},N={type:",",beforeExpr:!0},xe={type:";",beforeExpr:!0},rt={type:":",beforeExpr:!0},St={type:"."},$t={type:"?",beforeExpr:!0},Ii={binop:10,beforeExpr:!0},Li={isAssign:!0,beforeExpr:!0},An={isAssign:!0,beforeExpr:!0},pn={postfix:!0,prefix:!0,isUpdate:!0},sr={prefix:!0,beforeExpr:!0},Ar={binop:1,beforeExpr:!0},Or={binop:2,beforeExpr:!0},qa={binop:3,beforeExpr:!0},Ha={binop:4,beforeExpr:!0},ja={binop:5,beforeExpr:!0},pl={binop:6,beforeExpr:!0},Gr={binop:7,beforeExpr:!0},nr={binop:8,beforeExpr:!0},Ir={binop:9,prefix:!0,beforeExpr:!0},Lr={binop:10,beforeExpr:!0};st.tokTypes={bracketL:hs,bracketR:Ua,braceL:al,braceR:ol,parenL:no,parenR:Ga,comma:N,semi:xe,colon:rt,dot:St,question:$t,slash:Ii,eq:Li,name:bn,eof:or,num:xi,regexp:Si,string:Yt};for(var Zs in aa)st.tokTypes["_"+Zs]=aa[Zs];function vr(Ft){Ft=Ft.split(" ");var ii="",bi=[];e:for(var Fi=0;Fi<Ft.length;++Fi){for(var Bn=0;Bn<bi.length;++Bn)if(bi[Bn][0].length==Ft[Fi].length){bi[Bn].push(Ft[Fi]);continue e}bi.push([Ft[Fi]])}function Hn(Xn){if(Xn.length==1)return ii+="return str === "+JSON.stringify(Xn[0])+";";ii+="switch(str){";for(var Hs=0;Hs<Xn.length;++Hs)ii+="case "+JSON.stringify(Xn[Hs])+":";ii+="return true}return false;"}if(bi.length>3){bi.sort(function(Xn,Hs){return Hs.length-Xn.length}),ii+="switch(str.length){";for(var Fi=0;Fi<bi.length;++Fi){var lr=bi[Fi];ii+="case "+lr[0].length+":",Hn(lr)}ii+="}"}else Hn(Ft);return new Function("str",ii)}var Ks=vr("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),Br=vr("class enum extends super const export import"),Eo=vr("implements interface let package private protected public static yield"),Zo=vr("eval arguments"),Bs=vr("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Il=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,mo="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",Qo="------------------------------------------------------------------------------------------------------------------------------------------",ca=new RegExp("["+mo+"]"),Ys=new RegExp("["+mo+Qo+"]"),El=/[\n\r\u2028\u2029]/,Za=/\r\n|[\n\r\u2028\u2029]/g,Ta=st.isIdentifierStart=function(Ft){return Ft<65?Ft===36:Ft<91?!0:Ft<97?Ft===95:Ft<123?!0:Ft>=170&&ca.test(String.fromCharCode(Ft))},ml=st.isIdentifierChar=function(Ft){return Ft<48?Ft===36:Ft<58?!0:Ft<65?!1:Ft<91?!0:Ft<97?Ft===95:Ft<123?!0:Ft>=170&&Ys.test(String.fromCharCode(Ft))};function Cl(){this.line=ht,this.column=ge-kt}function mu(){ht=1,ge=kt=0,Ge=!0,so()}function As(Ft,ii){Fe=ge,Me.locations&&(Xe=new Cl),Ye=Ft,so(),De=ii,Ge=Ft.beforeExpr}function ac(){var Ft=Me.onComment&&Me.locations&&new Cl,ii=ge,bi=se.indexOf("*/",ge+=2);if(bi===-1&&oi(ge-2,"Unterminated comment"),ge=bi+2,Me.locations){Za.lastIndex=ii;for(var Fi;(Fi=Za.exec(se))&&Fi.index<ge;)++ht,kt=Fi.index+Fi[0].length}Me.onComment&&Me.onComment(!0,se.slice(ii+2,bi),ii,ge,Ft,Me.locations&&new Cl)}function ro(){for(var Ft=ge,ii=Me.onComment&&Me.locations&&new Cl,bi=se.charCodeAt(ge+=2);ge<ne&&bi!==10&&bi!==13&&bi!==8232&&bi!==8233;)++ge,bi=se.charCodeAt(ge);Me.onComment&&Me.onComment(!1,se.slice(Ft+2,ge),Ft,ge,ii,Me.locations&&new Cl)}function so(){for(;ge<ne;){var Ft=se.charCodeAt(ge);if(Ft===32)++ge;else if(Ft===13){++ge;var ii=se.charCodeAt(ge);ii===10&&++ge,Me.locations&&(++ht,kt=ge)}else if(Ft===10||Ft===8232||Ft===8233)++ge,Me.locations&&(++ht,kt=ge);else if(Ft>8&&Ft<14)++ge;else if(Ft===47){var ii=se.charCodeAt(ge+1);if(ii===42)ac();else if(ii===47)ro();else break}else if(Ft===160)++ge;else if(Ft>=5760&&Il.test(String.fromCharCode(Ft)))++ge;else break}}function Ql(){var Ft=se.charCodeAt(ge+1);return Ft>=48&&Ft<=57?Ko(!0):(++ge,As(St))}function Oo(){var Ft=se.charCodeAt(ge+1);return Ge?(++ge,gu()):Ft===61?Cs(An,2):Cs(Ii,1)}function Wo(){var Ft=se.charCodeAt(ge+1);return Ft===61?Cs(An,2):Cs(Lr,1)}function Co(Ft){var ii=se.charCodeAt(ge+1);return ii===Ft?Cs(Ft===124?Ar:Or,2):ii===61?Cs(An,2):Cs(Ft===124?qa:ja,1)}function Gs(){var Ft=se.charCodeAt(ge+1);return Ft===61?Cs(An,2):Cs(Ha,1)}function $o(Ft){var ii=se.charCodeAt(ge+1);return ii===Ft?ii==45&&se.charCodeAt(ge+2)==62&&El.test(se.slice(ke,ge))?(ge+=3,ro(),so(),Qa()):Cs(pn,2):ii===61?Cs(An,2):Cs(Ir,1)}function Xo(Ft){var ii=se.charCodeAt(ge+1),bi=1;return ii===Ft?(bi=Ft===62&&se.charCodeAt(ge+2)===62?3:2,se.charCodeAt(ge+bi)===61?Cs(An,bi+1):Cs(nr,bi)):ii==33&&Ft==60&&se.charCodeAt(ge+2)==45&&se.charCodeAt(ge+3)==45?(ge+=4,ro(),so(),Qa()):(ii===61&&(bi=se.charCodeAt(ge+2)===61?3:2),Cs(Gr,bi))}function Yo(Ft){var ii=se.charCodeAt(ge+1);return ii===61?Cs(pl,se.charCodeAt(ge+2)===61?3:2):Cs(Ft===61?Li:sr,1)}function ba(Ft){switch(Ft){case 46:return Ql();case 40:return++ge,As(no);case 41:return++ge,As(Ga);case 59:return++ge,As(xe);case 44:return++ge,As(N);case 91:return++ge,As(hs);case 93:return++ge,As(Ua);case 123:return++ge,As(al);case 125:return++ge,As(ol);case 58:return++ge,As(rt);case 63:return++ge,As($t);case 48:var ii=se.charCodeAt(ge+1);if(ii===120||ii===88)return $n();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return Ko(!1);case 34:case 39:return zr(Ft);case 47:return Oo();case 37:case 42:return Wo();case 124:case 38:return Co(Ft);case 94:return Gs();case 43:case 45:return $o(Ft);case 60:case 62:return Xo(Ft);case 61:case 33:return Yo(Ft);case 126:return Cs(sr,1)}return!1}function Qa(Ft){if(Ft?ge=Pe+1:Pe=ge,Me.locations&&(Ve=new Cl),Ft)return gu();if(ge>=ne)return As(or);var ii=se.charCodeAt(ge);if(Ta(ii)||ii===92)return To();var bi=ba(ii);if(bi===!1){var Fi=String.fromCharCode(ii);if(Fi==="\\"||ca.test(Fi))return To();oi(ge,"Unexpected character '"+Fi+"'")}return bi}function Cs(Ft,ii){var bi=se.slice(ge,ge+ii);ge+=ii,As(Ft,bi)}function gu(){for(var Bn="",Ft,ii,bi=ge;;){ge>=ne&&oi(bi,"Unterminated regular expression");var Fi=se.charAt(ge);if(El.test(Fi)&&oi(bi,"Unterminated regular expression"),Ft)Ft=!1;else{if(Fi==="[")ii=!0;else if(Fi==="]"&&ii)ii=!1;else if(Fi==="/"&&!ii)break;Ft=Fi==="\\"}++ge}var Bn=se.slice(bi,ge);++ge;var Hn=fr();Hn&&!/^[gmsiy]*$/.test(Hn)&&oi(bi,"Invalid regexp flag");try{var lr=new RegExp(Bn,Hn)}catch(Xn){Xn instanceof SyntaxError&&oi(bi,Xn.message),oi(Xn)}return As(Si,lr)}function Er(Ft,ii){for(var bi=ge,Fi=0,Bn=0,Hn=ii??1/0;Bn<Hn;++Bn){var lr=se.charCodeAt(ge),Xn;if(lr>=97?Xn=lr-97+10:lr>=65?Xn=lr-65+10:lr>=48&&lr<=57?Xn=lr-48:Xn=1/0,Xn>=Ft)break;++ge,Fi=Fi*Ft+Xn}return ge===bi||ii!=null&&ge-bi!==ii?null:Fi}function $n(){ge+=2;var Ft=Er(16);return Ft==null&&oi(Pe+2,"Expected hexadecimal number"),Ta(se.charCodeAt(ge))&&oi(ge,"Identifier directly after number"),As(xi,Ft)}function Ko(Ft){var ii=ge,bi=!1,Fi=se.charCodeAt(ge)===48;!Ft&&Er(10)===null&&oi(ii,"Invalid number"),se.charCodeAt(ge)===46&&(++ge,Er(10),bi=!0);var Bn=se.charCodeAt(ge);(Bn===69||Bn===101)&&(Bn=se.charCodeAt(++ge),(Bn===43||Bn===45)&&++ge,Er(10)===null&&oi(ii,"Invalid number"),bi=!0),Ta(se.charCodeAt(ge))&&oi(ge,"Identifier directly after number");var Hn=se.slice(ii,ge),lr;return bi?lr=parseFloat(Hn):!Fi||Hn.length===1?lr=parseInt(Hn,10):/[89]/.test(Hn)||Jt?oi(ii,"Invalid number"):lr=parseInt(Hn,8),As(xi,lr)}function zr(Ft){ge++;for(var ii="";;){ge>=ne&&oi(Pe,"Unterminated string constant");var bi=se.charCodeAt(ge);if(bi===Ft)return++ge,As(Yt,ii);if(bi===92){bi=se.charCodeAt(++ge);var Fi=/^[0-7]+/.exec(se.slice(ge,ge+3));for(Fi&&(Fi=Fi[0]);Fi&&parseInt(Fi,8)>255;)Fi=Fi.slice(0,-1);if(Fi==="0"&&(Fi=null),++ge,Fi)Jt&&oi(ge-2,"Octal literal in strict mode"),ii+=String.fromCharCode(parseInt(Fi,8)),ge+=Fi.length-1;else switch(bi){case 110:ii+=`
`;break;case 114:ii+="\r";break;case 120:ii+=String.fromCharCode(Wa(2));break;case 117:ii+=String.fromCharCode(Wa(4));break;case 85:ii+=String.fromCharCode(Wa(8));break;case 116:ii+="	";break;case 98:ii+="\b";break;case 118:ii+="\v";break;case 102:ii+="\f";break;case 48:ii+="\0";break;case 13:se.charCodeAt(ge)===10&&++ge;case 10:Me.locations&&(kt=ge,++ht);break;default:ii+=String.fromCharCode(bi);break}}else(bi===13||bi===10||bi===8232||bi===8233)&&oi(Pe,"Unterminated string constant"),ii+=String.fromCharCode(bi),++ge}}function Wa(Ft){var ii=Er(16,Ft);return ii===null&&oi(Pe,"Bad character escape sequence"),ii}var Jr;function fr(){Jr=!1;for(var Ft,ii=!0,bi=ge;;){var Fi=se.charCodeAt(ge);if(ml(Fi))Jr&&(Ft+=se.charAt(ge)),++ge;else if(Fi===92){Jr||(Ft=se.slice(bi,ge)),Jr=!0,se.charCodeAt(++ge)!=117&&oi(ge,"Expecting Unicode escape sequence \\uXXXX"),++ge;var Bn=Wa(4),Hn=String.fromCharCode(Bn);Hn||oi(ge-1,"Invalid Unicode escape"),(ii?Ta(Bn):ml(Bn))||oi(ge-4,"Invalid Unicode escape"),Ft+=Hn}else break;ii=!1}return Jr?Ft:se.slice(bi,ge)}function To(){var Ft=fr(),ii=bn;return!Jr&&Bs(Ft)&&(ii=aa[Ft]),As(ii,Ft)}function Gn(){o=Pe,ke=Fe,ai=Xe,Qa()}function Ol(Ft){if(Jt=Ft,ge=Pe,Me.locations)for(;ge<kt;)kt=se.lastIndexOf(`
`,kt-2)+1,--ht;so(),Qa()}function es(){this.type=null,this.start=Pe,this.end=null}function Zr(){this.start=Ve,this.end=null,$!==null&&(this.source=$)}function Ts(){var Ft=new es;return Me.locations&&(Ft.loc=new Zr),Me.directSourceFile&&(Ft.sourceFile=Me.directSourceFile),Me.ranges&&(Ft.range=[Pe,0]),Ft}function kr(Ft){var ii=new es;return ii.start=Ft.start,Me.locations&&(ii.loc=new Zr,ii.loc.start=Ft.loc.start),Me.ranges&&(ii.range=[Ft.range[0],0]),ii}function rr(Ft,ii){return Ft.type=ii,Ft.end=ke,Me.locations&&(Ft.loc.end=ai),Me.ranges&&(Ft.range[1]=ke),Ft}function ll(Ft){return Me.ecmaVersion>=5&&Ft.type==="ExpressionStatement"&&Ft.expression.type==="Literal"&&Ft.expression.value==="use strict"}function Xr(Ft){if(Ye===Ft)return Gn(),!0}function ko(){return!Me.strictSemicolons&&(Ye===or||Ye===ol||El.test(se.slice(ke,Pe)))}function ul(){!Xr(xe)&&!ko()&&ds()}function Qr(Ft){Ye===Ft?Gn():ds()}function ds(){oi(Pe,"Unexpected token")}function wa(Ft){Ft.type!=="Identifier"&&Ft.type!=="MemberExpression"&&oi(Ft.start,"Assigning to rvalue"),Jt&&Ft.type==="Identifier"&&Zo(Ft.name)&&oi(Ft.start,"Assigning to "+Ft.name+" in strict mode")}function Tl(Ft){o=ke=ge,Me.locations&&(ai=new Cl),fi=Jt=null,hi=[],Qa();var ii=Ft||Ts(),bi=!0;for(Ft||(ii.body=[]);Ye!==or;){var Fi=go();ii.body.push(Fi),bi&&ll(Fi)&&Ol(!0),bi=!1}return rr(ii,"Program")}var Mo={kind:"loop"},kl={kind:"switch"};function go(){(Ye===Ii||Ye===An&&De=="/=")&&Qa(!0);var Ft=Ye,ii=Ts();switch(Ft){case mn:case Zi:Gn();var bi=Ft===mn;Xr(xe)||ko()?ii.label=null:Ye!==bn?ds():(ii.label=Di(),ul());for(var Fi=0;Fi<hi.length;++Fi){var Bn=hi[Fi];if((ii.label==null||Bn.name===ii.label.name)&&(Bn.kind!=null&&(bi||Bn.kind==="loop")||ii.label&&bi))break}return Fi===hi.length&&oi(ii.start,"Unsyntactic "+Ft.keyword),rr(ii,bi?"BreakStatement":"ContinueStatement");case ur:return Gn(),ul(),rr(ii,"DebuggerStatement");case Wt:return Gn(),hi.push(Mo),ii.body=go(),hi.pop(),Qr(Us),ii.test=Js(),ul(),rr(ii,"DoWhileStatement");case Tn:if(Gn(),hi.push(Mo),Qr(no),Ye===xe)return $a(ii,null);if(Ye===Fr){var Hn=Ts();return Gn(),Yr(Hn,!0),rr(Hn,"VariableDeclaration"),Hn.declarations.length===1&&Xr(Zn)?Jo(ii,Hn):$a(ii,Hn)}var Hn=mr(!1,!0);return Xr(Zn)?(wa(Hn),Jo(ii,Hn)):$a(ii,Hn);case cr:return Gn(),pi(ii,!0);case Vs:return Gn(),ii.test=Js(),ii.consequent=go(),ii.alternate=Xr(Ki)?go():null,rr(ii,"IfStatement");case Ur:return!fi&&!Me.allowReturnOutsideFunction&&oi(Pe,"'return' outside of function"),Gn(),Xr(xe)||ko()?ii.argument=null:(ii.argument=mr(),ul()),rr(ii,"ReturnStatement");case Vt:Gn(),ii.discriminant=Js(),ii.cases=[],Qr(al),hi.push(kl);for(var lr,Xn;Ye!=ol;)if(Ye===qn||Ye===Vn){var Hs=Ye===qn;lr&&rr(lr,"SwitchCase"),ii.cases.push(lr=Ts()),lr.consequent=[],Gn(),Hs?lr.test=mr():(Xn&&oi(o,"Multiple default clauses"),Xn=!0,lr.test=null),Qr(rt)}else lr||ds(),lr.consequent.push(go());return lr&&rr(lr,"SwitchCase"),Gn(),hi.pop(),rr(ii,"SwitchStatement");case hr:return Gn(),El.test(se.slice(ke,Pe))&&oi(ke,"Illegal newline after throw"),ii.argument=mr(),ul(),rr(ii,"ThrowStatement");case Bt:if(Gn(),ii.block=qs(),ii.handler=null,Ye===jr){var ks=Ts();Gn(),Qr(no),ks.param=Di(),Jt&&Zo(ks.param.name)&&oi(ks.param.start,"Binding "+ks.param.name+" in strict mode"),Qr(Ga),ks.guard=null,ks.body=qs(),ii.handler=rr(ks,"CatchClause")}return ii.guardedHandlers=zi,ii.finalizer=Xr(Ut)?qs():null,!ii.handler&&!ii.finalizer&&oi(ii.start,"Missing catch or finally clause"),rr(ii,"TryStatement");case Fr:return Gn(),Yr(ii),ul(),rr(ii,"VariableDeclaration");case Us:return Gn(),ii.test=Js(),hi.push(Mo),ii.body=go(),hi.pop(),rr(ii,"WhileStatement");case ua:return Jt&&oi(Pe,"'with' in strict mode"),Gn(),ii.object=Js(),ii.body=go(),rr(ii,"WithStatement");case al:return qs();case xe:return Gn(),rr(ii,"EmptyStatement");default:var ps=De,Ya=mr();if(Ft===bn&&Ya.type==="Identifier"&&Xr(rt)){for(var Fi=0;Fi<hi.length;++Fi)hi[Fi].name===ps&&oi(Ya.start,"Label '"+ps+"' is already declared");var yo=Ye.isLoop?"loop":Ye===Vt?"switch":null;return hi.push({name:ps,kind:yo}),ii.body=go(),hi.pop(),ii.label=Ya,rr(ii,"LabeledStatement")}else return ii.expression=Ya,ul(),rr(ii,"ExpressionStatement")}}function Js(){Qr(no);var Ft=mr();return Qr(Ga),Ft}function qs(Ft){var ii=Ts(),bi=!0,Fi=!1,Bn;for(ii.body=[],Qr(al);!Xr(ol);){var Hn=go();ii.body.push(Hn),bi&&Ft&&ll(Hn)&&(Bn=Fi,Ol(Fi=!0)),bi=!1}return Fi&&!Bn&&Ol(!1),rr(ii,"BlockStatement")}function $a(Ft,ii){return Ft.init=ii,Qr(xe),Ft.test=Ye===xe?null:mr(),Qr(xe),Ft.update=Ye===Ga?null:mr(),Qr(Ga),Ft.body=go(),hi.pop(),rr(Ft,"ForStatement")}function Jo(Ft,ii){return Ft.left=ii,Ft.right=mr(),Qr(Ga),Ft.body=go(),hi.pop(),rr(Ft,"ForInStatement")}function Yr(Ft,ii){for(Ft.declarations=[],Ft.kind="var";;){var bi=Ts();if(bi.id=Di(),Jt&&Zo(bi.id.name)&&oi(bi.id.start,"Binding "+bi.id.name+" in strict mode"),bi.init=Xr(Li)?mr(!0,ii):null,Ft.declarations.push(rr(bi,"VariableDeclarator")),!Xr(N))break}return Ft}function mr(Ft,ii){var bi=Nr(ii);if(!Ft&&Ye===N){var Fi=kr(bi);for(Fi.expressions=[bi];Xr(N);)Fi.expressions.push(Nr(ii));return rr(Fi,"SequenceExpression")}return bi}function Nr(Ft){var ii=ha(Ft);if(Ye.isAssign){var bi=kr(ii);return bi.operator=De,bi.left=ii,Gn(),bi.right=Nr(Ft),wa(ii),rr(bi,"AssignmentExpression")}return ii}function ha(Ft){var ii=_o(Ft);if(Xr($t)){var bi=kr(ii);return bi.test=ii,bi.consequent=mr(!0),Qr(rt),bi.alternate=mr(!0,Ft),rr(bi,"ConditionalExpression")}return ii}function _o(Ft){return ea(Sa(),-1,Ft)}function ea(Ft,ii,bi){var Fi=Ye.binop;if(Fi!=null&&(!bi||Ye!==Zn)&&Fi>ii){var Bn=kr(Ft);Bn.left=Ft,Bn.operator=De;var Hn=Ye;Gn(),Bn.right=ea(Sa(),Fi,bi);var lr=rr(Bn,Hn===Ar||Hn===Or?"LogicalExpression":"BinaryExpression");return ea(lr,ii,bi)}return Ft}function Sa(){if(Ye.prefix){var Ft=Ts(),ii=Ye.isUpdate;return Ft.operator=De,Ft.prefix=!0,Ge=!0,Gn(),Ft.argument=Sa(),ii?wa(Ft.argument):Jt&&Ft.operator==="delete"&&Ft.argument.type==="Identifier"&&oi(Ft.start,"Deleting local variable in strict mode"),rr(Ft,ii?"UpdateExpression":"UnaryExpression")}for(var bi=ka();Ye.postfix&&!ko();){var Ft=kr(bi);Ft.operator=De,Ft.prefix=!1,Ft.argument=bi,wa(bi),Gn(),bi=rr(Ft,"UpdateExpression")}return bi}function ka(){return Xa(cl())}function Xa(Ft,ii){if(Xr(St)){var bi=kr(Ft);return bi.object=Ft,bi.property=Di(!0),bi.computed=!1,Xa(rr(bi,"MemberExpression"),ii)}else if(Xr(hs)){var bi=kr(Ft);return bi.object=Ft,bi.property=mr(),bi.computed=!0,Qr(Ua),Xa(rr(bi,"MemberExpression"),ii)}else if(!ii&&Xr(no)){var bi=kr(Ft);return bi.callee=Ft,bi.arguments=Ui(Ga,!1),Xa(rr(bi,"CallExpression"),ii)}else return Ft}function cl(){switch(Ye){case Na:var Fi=Ts();return Gn(),rr(Fi,"ThisExpression");case bn:return Di();case xi:case Yt:case Si:var Fi=Ts();return Fi.value=De,Fi.raw=se.slice(Pe,Fe),Gn(),rr(Fi,"Literal");case Fo:case Va:case Xs:var Fi=Ts();return Fi.value=Ye.atomValue,Fi.raw=Ye.keyword,Gn(),rr(Fi,"Literal");case no:var Ft=Ve,ii=Pe;Gn();var bi=mr();return bi.start=ii,bi.end=Fe,Me.locations&&(bi.loc.start=Ft,bi.loc.end=Xe),Me.ranges&&(bi.range=[ii,Fe]),Qr(Ga),bi;case hs:var Fi=Ts();return Gn(),Fi.elements=Ui(Ua,!0,!0),rr(Fi,"ArrayExpression");case al:return gl();case cr:var Fi=Ts();return Gn(),pi(Fi,!1);case Dr:return lu();default:ds()}}function lu(){var Ft=Ts();return Gn(),Ft.callee=Xa(cl(),!0),Xr(no)?Ft.arguments=Ui(Ga,!1):Ft.arguments=zi,rr(Ft,"NewExpression")}function gl(){var Ft=Ts(),ii=!0,bi=!1;for(Ft.properties=[],Gn();!Xr(ol);){if(ii)ii=!1;else if(Qr(N),Me.allowTrailingCommas&&Xr(ol))break;var Fi={key:ao()},Bn=!1,Hn;if(Xr(rt)?(Fi.value=mr(!0),Hn=Fi.kind="init"):Me.ecmaVersion>=5&&Fi.key.type==="Identifier"&&(Fi.key.name==="get"||Fi.key.name==="set")?(Bn=bi=!0,Hn=Fi.kind=Fi.key.name,Fi.key=ao(),Ye!==no&&ds(),Fi.value=pi(Ts(),!1)):ds(),Fi.key.type==="Identifier"&&(Jt||bi))for(var lr=0;lr<Ft.properties.length;++lr){var Xn=Ft.properties[lr];if(Xn.key.name===Fi.key.name){var Hs=Hn==Xn.kind||Bn&&Xn.kind==="init"||Hn==="init"&&(Xn.kind==="get"||Xn.kind==="set");Hs&&!Jt&&Hn==="init"&&Xn.kind==="init"&&(Hs=!1),Hs&&oi(Fi.key.start,"Redefinition of property")}}Ft.properties.push(Fi)}return rr(Ft,"ObjectExpression")}function ao(){return Ye===xi||Ye===Yt?cl():Di(!0)}function pi(Ft,ii){Ye===bn?Ft.id=Di():ii?ds():Ft.id=null,Ft.params=[];var bi=!0;for(Qr(no);!Xr(Ga);)bi?bi=!1:Qr(N),Ft.params.push(Di());var Fi=fi,Bn=hi;if(fi=!0,hi=[],Ft.body=qs(!0),fi=Fi,hi=Bn,Jt||Ft.body.body.length&&ll(Ft.body.body[0]))for(var Hn=Ft.id?-1:0;Hn<Ft.params.length;++Hn){var lr=Hn<0?Ft.id:Ft.params[Hn];if((Eo(lr.name)||Zo(lr.name))&&oi(lr.start,"Defining '"+lr.name+"' in strict mode"),Hn>=0)for(var Xn=0;Xn<Hn;++Xn)lr.name===Ft.params[Xn].name&&oi(lr.start,"Argument name clash in strict mode")}return rr(Ft,ii?"FunctionDeclaration":"FunctionExpression")}function Ui(Ft,ii,bi){for(var Fi=[],Bn=!0;!Xr(Ft);){if(Bn)Bn=!1;else if(Qr(N),ii&&Me.allowTrailingCommas&&Xr(Ft))break;bi&&Ye===N?Fi.push(null):Fi.push(mr(!0))}return Fi}function Di(Ft){var ii=Ts();return Ft&&Me.forbidReserved=="everywhere"&&(Ft=!1),Ye===bn?(!Ft&&(Me.forbidReserved&&(Me.ecmaVersion===3?Ks:Br)(De)||Jt&&Eo(De))&&se.slice(Pe,Fe).indexOf("\\")==-1&&oi(Pe,"The keyword '"+De+"' is reserved"),ii.name=De):Ft&&Ye.keyword?ii.name=Ye.keyword:ds(),Ge=!1,Gn(),rr(ii,"Identifier")}}),k.version||(k=null)}function te(st,Me){return(v.acorn||k).parse(st,Me)}var fe={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"__equals","!=":"__equals"},ve={"-":"__negate","+":"__self"},Ie=x.each(["add","subtract","multiply","divide","modulo","equals","negate"],function(st){this["__"+st]="#"+st},{__self:function(){return this}});be.inject(Ie),nt.inject(Ie),ji.inject(Ie);function Ee(st,Me,se){var ne=fe[Me];if(st&&st[ne]){var $=st[ne](se);return Me==="!="?!$:$}switch(Me){case"+":return st+se;case"-":return st-se;case"*":return st*se;case"/":return st/se;case"%":return st%se;case"==":return st==se;case"!=":return st!=se}}function ze(st,Me){var se=ve[st];if(Me&&Me[se])return Me[se]();switch(st){case"+":return+Me;case"-":return-Me}}function We(st,Me){if(!st)return"";Me=Me||{};var se=[];function ne(Jt){for(var oi=0,zi=se.length;oi<zi;oi++){var xi=se[oi];if(xi[0]>=Jt)break;Jt+=xi[1]}return Jt}function $(Jt){return st.substring(ne(Jt.range[0]),ne(Jt.range[1]))}function ie(Jt,oi){return st.substring(ne(Jt.range[1]),ne(oi.range[0]))}function de(Jt,oi){for(var zi=ne(Jt.range[0]),xi=ne(Jt.range[1]),Si=0,Yt=se.length-1;Yt>=0;Yt--)if(zi>se[Yt][0]){Si=Yt+1;break}se.splice(Si,0,[zi,oi.length-xi+zi]),st=st.substring(0,zi)+oi+st.substring(xi)}function ye(Jt,oi){switch(Jt.type){case"UnaryExpression":if(Jt.operator in ve&&Jt.argument.type!=="Literal"){var zi=$(Jt.argument);de(Jt,'$__("'+Jt.operator+'", '+zi+")")}break;case"BinaryExpression":if(Jt.operator in fe&&Jt.left.type!=="Literal"){var xi=$(Jt.left),Si=$(Jt.right),Yt=ie(Jt.left,Jt.right),bn=Jt.operator;de(Jt,"__$__("+xi+","+Yt.replace(new RegExp("\\"+bn),'"'+bn+'"')+", "+Si+")")}break;case"UpdateExpression":case"AssignmentExpression":var or=oi&&oi.type;if(!(or==="ForStatement"||or==="BinaryExpression"&&/^[=!<>]/.test(oi.operator)||or==="MemberExpression"&&oi.computed)){if(Jt.type==="UpdateExpression"){var zi=$(Jt.argument),mn="__$__("+zi+', "'+Jt.operator[0]+'", 1)',qn=zi+" = "+mn;Jt.prefix?qn="("+qn+")":(or==="AssignmentExpression"||or==="VariableDeclarator"||or==="BinaryExpression")&&($(oi.left||oi.id)===zi&&(qn=mn),qn=zi+"; "+qn),de(Jt,qn)}else if(/^.=$/.test(Jt.operator)&&Jt.left.type!=="Literal"){var xi=$(Jt.left),Si=$(Jt.right),mn=xi+" = __$__("+xi+', "'+Jt.operator[0]+'", '+Si+")";de(Jt,/^\(.*\)$/.test($(Jt))?"("+mn+")":mn)}}break}}function ge(Jt){switch(Jt.type){case"ExportDefaultDeclaration":de({range:[Jt.start,Jt.declaration.start]},"module.exports = ");break;case"ExportNamedDeclaration":var oi=Jt.declaration,zi=Jt.specifiers;if(oi){var xi=oi.declarations;xi&&(xi.forEach(function(Yt){de(Yt,"module.exports."+$(Yt))}),de({range:[Jt.start,oi.start+oi.kind.length]},""))}else if(zi){var Si=zi.map(function(Yt){var bn=$(Yt);return"module.exports."+bn+" = "+bn+"; "}).join("");Si&&de(Jt,Si)}break}}function Pe(Jt,oi,zi){if(Jt){for(var xi in Jt)if(xi!=="range"&&xi!=="loc"){var Si=Jt[xi];if(Array.isArray(Si))for(var Yt=0,bn=Si.length;Yt<bn;Yt++)Pe(Si[Yt],Jt,zi);else Si&&typeof Si=="object"&&Pe(Si,Jt,zi)}zi.operatorOverloading!==!1&&ye(Jt,oi),zi.moduleExports!==!1&&ge(Jt)}}function Fe(Jt){var oi="",zi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Jt=(Math.abs(Jt)<<1)+(Jt<0?1:0);Jt||!oi;){var xi=Jt&31;Jt>>=5,Jt&&(xi|=32),oi+=zi[xi]}return oi}var Ve=Me.url||"",Xe=Me.sourceMaps,Ye=Me.paperFeatures||{},De=Me.source||st,Ge=Me.offset||0,ht=In.agent,kt=ht.versionNumber,o=!1,ke=/\r\n|\n|\r/mg,ai;if(Xe&&(ht.chrome&&kt>=30||ht.webkit&&kt>=537.76||ht.firefox&&kt>=23||ht.node)){if(ht.node)Ge-=2;else if(c&&Ve&&!c.location.href.indexOf(Ve)){var fi=g.getElementsByTagName("html")[0].innerHTML;Ge=fi.substr(0,fi.indexOf(st)+1).match(ke).length+1}o=Ge>0&&!(ht.chrome&&kt>=36||ht.safari&&kt>=600||ht.firefox&&kt>=40||ht.node);var hi=["AA"+Fe(o?0:Ge)+"A"];hi.length=(st.match(ke)||[]).length+1+(o?Ge:0),ai={version:3,file:Ve,names:[],mappings:hi.join(";AACA"),sourceRoot:"",sources:[Ve],sourcesContent:[De]}}return(Ye.operatorOverloading!==!1||Ye.moduleExports!==!1)&&Pe(te(st,{ranges:!0,preserveParens:!0,sourceType:"module"}),null,Ye),ai&&(o&&(st=new Array(Ge+1).join(`
`)+st),/^(inline|both)$/.test(Xe)&&(st+=`
//# sourceMappingURL=data:application/json;base64,`+t.btoa(unescape(encodeURIComponent(JSON.stringify(ai))))),st+=`
//# sourceURL=`+(Ve||"paperscript")),{url:Ve,source:De,code:st,map:ai}}function He(st,Me,se){In=Me;var ne=Me.getView(),$=/\btool\.\w+|\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(st)&&!/\bnew\s+Tool\b/.test(st)?new _n:null,ie=$?$._events:[],de=["onFrame","onResize"].concat(ie),ye=[],ge=[],Pe,Fe=typeof st=="object"?st:We(st,se);st=Fe.code;function Ve(kt,o){for(var ke in kt)(o||!/^_/.test(ke))&&new RegExp("([\\b\\s\\W]|^)"+ke.replace(/\$/g,"\\$")+"\\b").test(st)&&(ye.push(ke),ge.push(kt[ke]))}Ve({__$__:Ee,$__:ze,paper:Me,tool:$},!0),Ve(Me),st="var module = { exports: {} }; "+st;var Ge=x.each(de,function(kt){new RegExp("\\s+"+kt+"\\b").test(st)&&(ye.push(kt),this.push("module.exports."+kt+" = "+kt+";"))},[]).join(`
`);Ge&&(st+=`
`+Ge),st+=`
return module.exports;`;var Xe=In.agent;if(g&&(Xe.chrome||Xe.firefox&&Xe.versionNumber<40)){var Ye=g.createElement("script"),De=g.head||g.getElementsByTagName("head")[0];Xe.firefox&&(st=`
`+st),Ye.appendChild(g.createTextNode("document.__paperscript__ = function("+ye+") {"+st+`
}`)),De.appendChild(Ye),Pe=g.__paperscript__,delete g.__paperscript__,De.removeChild(Ye)}else Pe=Function(ye,st);var Ge=Pe&&Pe.apply(Me,ge),ht=Ge||{};return x.each(ie,function(kt){var o=ht[kt];o&&($[kt]=o)}),ne&&(ht.onResize&&ne.setOnResize(ht.onResize),ne.emit("resize",{size:ne.size,delta:new be}),ht.onFrame&&ne.setOnFrame(ht.onFrame),ne.requestUpdate()),Ge}function Qe(st){if(/^text\/(?:x-|)paperscript$/.test(st.type)&&a.getAttribute(st,"ignore")!=="true"){var Me=a.getAttribute(st,"canvas"),se=g.getElementById(Me),ne=st.src||st.getAttribute("data-src"),$=a.hasAttribute(st,"async"),ie="data-paper-scope";if(!se)throw new Error('Unable to find canvas with id "'+Me+'"');var de=a.get(se.getAttribute(ie))||new a().setup(se);return se.setAttribute(ie,de._id),ne?ci.request({url:ne,async:$,mimeType:"text/plain",onLoad:function(ye){He(ye,de,ne)}}):He(st.innerHTML,de,st.baseURI),st.setAttribute("data-paper-ignore","true"),de}}function Ue(){x.each(g&&g.getElementsByTagName("script"),Qe)}function ft(st){return st?Qe(st):Ue()}return c&&(g.readyState==="complete"?setTimeout(Ue):mi.add(c,{load:Ue})),{compile:We,execute:He,load:ft,parse:te,calculateBinary:Ee,calculateUnary:ze}}).call(this);var In=new(a.inject(x.exports,{Base:x,Numerical:ae,Key:Ai,DomEvent:mi,DomElement:Ci,document:g,window:c,Symbol:Pt,PlacedSymbol:Et}));return In.agent.node&&xx(In),typeof n=="function"&&n.amd?n("paper",In):e&&(e.exports=In),In}).call(Jf,typeof self=="object"?self:null)})(m3);var z1=m3.exports;function yT(e){let t,n,c="Click and drag to draw a polygon. Press Escape to exit.",g,x;return{c(){t=Fn("div"),n=Fn("span"),n.textContent=c,g=wr(),x=Fn("canvas"),this.h()},l(S){t=On(S,"DIV",{class:!0});var a=yn(t);n=On(a,"SPAN",{class:!0,"data-svelte-h":!0}),Zu(n)!=="svelte-1m9xrla"&&(n.textContent=c),g=Sr(a),x=On(a,"CANVAS",{class:!0}),yn(x).forEach(vi),a.forEach(vi),this.h()},h(){ki(n,"class","svelte-jrtjeu"),ki(x,"class","canvas svelte-jrtjeu"),ki(t,"class","draw-wrapper svelte-jrtjeu")},m(S,a){Un(S,t,a),Hi(t,n),Hi(t,g),Hi(t,x),e[5](x)},p:Ra,i:Ra,o:Ra,d(S){S&&vi(t),e[5](null)}}}function vT(e,t,n){let{path:c}=t,{updatePath:g}=t,{updateIsDrawing:x}=t,{isDrawing:S}=t,a,G;xc(()=>{z1.setup(G);let he=new z1.Tool;he.onMouseDown=function(ae){n(1,c=new z1.Path),n(1,c.strokeColor="white",c),c.add(ae.point)},he.onMouseDrag=function(ae){a&&c.add(ae.point)},he.onMouseUp=function(ae){if(!a)return;c.simplify(.5),c.clearHandles(),n(1,c.closed=!0,c);let ue=[];for(let be of c.segments){console.log();let je=be.point;ue.push({x:je.x,y:je.y})}g(ue),x(!1)},he.onKeyDown=function(ae){console.log(ae),ae.key==="escape"&&x(!1)}});function W(he){pa[he?"unshift":"push"](()=>{G=he,n(0,G)})}return e.$$set=he=>{"path"in he&&n(1,c=he.path),"updatePath"in he&&n(2,g=he.updatePath),"updateIsDrawing"in he&&n(3,x=he.updateIsDrawing),"isDrawing"in he&&n(4,S=he.isDrawing)},e.$$.update=()=>{e.$$.dirty&16&&(a=S)},[G,c,g,x,S,W]}class xT extends fo{constructor(t){super(),po(this,t,vT,yT,Oa,{path:1,updatePath:2,updateIsDrawing:3,isDrawing:4})}}const __=["pd","mpd","mntd","tree_sizes","rel_pd","quartile"],wx={pd:"phylodiversity",mpd:"mean pairwise phylogenetic distance",mntd:"mean nearest-taxon phylogenetic distance"};function bT(e){if(!e||!__.includes(e))return;const n=650;let c=new Array(n),g=[0,1];const x=Sx[1]/n;let S;switch(e){case"mntd":case"rel_mntd":S=um.mntd;break;case"mpd":case"rel_mpd":S=um.mpd;break;default:case"pd":S=um.pd}let a=S.d,G=S.b,W=S.e,he=S.c,ae=S.modelHigh,ue=S.modelLow,be=S.minY,je=S.maxY,nt=2;for(let tt=0;tt<n;tt++){let at=(tt+nt)*x;c[tt]={x:at,high:ae({x:at,b:G.high,c:he.high,d:a.high,e:W.high}),low:ue({x:at,b:G.low,c:he.low,d:a.low,e:W.low})}}return g=[be,je],{confidence:c,yAxis:g,xAxis:Sx,xAxisLabel:"Tree Size",yAxisLabel:S.yAxisLabel}}const Sx=[0,300],um={pd:{b:{low:-.7505,high:-.6608},c:{low:9.567,high:123.1524},d:{low:11690.7906,high:10762.3392},e:{low:1298.4931,high:1308.4918},minY:100,maxY:5e3,yAxisLabel:"Phylodiversity (pd)",modelHigh:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g)))),modelLow:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g))))},mpd:{b:{low:-.6495,high:.4117},c:{low:-39.3099,high:93.617},d:{low:102.1695,high:152.3637},e:{low:1.2904,high:2.763},minY:0,maxY:200,yAxisLabel:"Mean pairwise phylogenetic distance (mpd)",modelHigh:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g)))),modelLow:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g))))},mntd:{b:{low:1.2883,high:.9501},c:{low:8.8277,high:5.9462},d:{low:33.4172,high:156.3706},e:{low:44.5908,high:10.2206},minY:0,maxY:150,yAxisLabel:"Mean nearest-taxon phylogenetic distance (mntd)",modelHigh:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g)))),modelLow:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g))))}};function wT(e,t,n){if(t===-1||t==NaN)return-1;let c;switch(e){case"mntd":case"rel_mntd":c=um.mntd;break;case"mpd":case"rel_mpd":c=um.mpd;break;default:case"pd":c=um.pd}let g=c.d,x=c.b,S=c.e,a=c.c,G=c.modelHigh,W=c.modelLow;G({x:n,b:x.high,c:a.high,d:g.high,e:S.high});let he=W({x:n,b:x.low,c:a.low,d:g.low,e:S.low});return t-he}function Ix(e){let t,n=(e[1][0]??"min")+"",c,g,x,S=(e[1][1]??"med")+"",a,G,W,he=(e[1][2]??"max")+"",ae;return{c(){t=Fn("span"),c=to(n),g=wr(),x=Fn("span"),a=to(S),G=wr(),W=Fn("span"),ae=to(he),this.h()},l(ue){t=On(ue,"SPAN",{class:!0});var be=yn(t);c=io(be,n),be.forEach(vi),g=Sr(ue),x=On(ue,"SPAN",{class:!0});var je=yn(x);a=io(je,S),je.forEach(vi),G=Sr(ue),W=On(ue,"SPAN",{class:!0});var nt=yn(W);ae=io(nt,he),nt.forEach(vi),this.h()},h(){ki(t,"class","svelte-1mfvjh6"),ki(x,"class","svelte-1mfvjh6"),ki(W,"class","svelte-1mfvjh6")},m(ue,be){Un(ue,t,be),Hi(t,c),Un(ue,g,be),Un(ue,x,be),Hi(x,a),Un(ue,G,be),Un(ue,W,be),Hi(W,ae)},p(ue,be){be&2&&n!==(n=(ue[1][0]??"min")+"")&&su(c,n),be&2&&S!==(S=(ue[1][1]??"med")+"")&&su(a,S),be&2&&he!==(he=(ue[1][2]??"max")+"")&&su(ae,he)},d(ue){ue&&(vi(t),vi(g),vi(x),vi(G),vi(W))}}}function ST(e){let t,n,c,g,x,S=e[1]&&Ix(e);return{c(){t=Fn("div"),n=Fn("div"),g=wr(),x=Fn("div"),S&&S.c(),this.h()},l(a){t=On(a,"DIV",{class:!0});var G=yn(t);n=On(G,"DIV",{class:!0,style:!0}),yn(n).forEach(vi),g=Sr(G),x=On(G,"DIV",{class:!0});var W=yn(x);S&&S.l(W),W.forEach(vi),G.forEach(vi),this.h()},h(){ki(n,"class","gradient svelte-1mfvjh6"),ki(n,"style",c=`background-image: none, ${e[0]}`),ki(x,"class","label-container svelte-1mfvjh6"),ki(t,"class","legend-container svelte-1mfvjh6")},m(a,G){Un(a,t,G),Hi(t,n),Hi(t,g),Hi(t,x),S&&S.m(x,null)},p(a,[G]){G&1&&c!==(c=`background-image: none, ${a[0]}`)&&ki(n,"style",c),a[1]?S?S.p(a,G):(S=Ix(a),S.c(),S.m(x,null)):S&&(S.d(1),S=null)},i:Ra,o:Ra,d(a){a&&vi(t),S&&S.d()}}}function IT(e,t,n){let c;tc(e,e_,ae=>n(6,c=ae));let g=g_(),x,{colorScheme:S}=t,{metric:a}=t,G=[0,.5,1];function W(ae){console.log(ae);let ue=`linear-gradient(${ae.map(be=>be[1]).flat().reverse()})`;return console.log(ue),ue}function he(ae){if(!(ae!=null&&ae.length))return;let ue=ae.length-2;n(1,G[2]=Math.round(ae[ue]??1),G),n(1,G[1]=Math.round(ae[ue-2]??.5),G),n(1,G[0]=Math.round(ae[ue-4]??0),G)}return e.$$set=ae=>{"colorScheme"in ae&&n(2,S=ae.colorScheme),"metric"in ae&&n(3,a=ae.metric)},e.$$.update=()=>{e.$$.dirty&4&&n(5,g=g_(0,1,S).slice(1)),e.$$.dirty&32&&n(0,x=W(g)),e.$$.dirty&64&&he(c)},[x,G,S,a,W,g,c]}class ET extends fo{constructor(t){super(),po(this,t,IT,ST,Oa,{colorScheme:2,metric:3,createPaletteGradient:4})}get createPaletteGradient(){return this.$$.ctx[4]}}function CT(e){let t,n,c,g,x,S,a,G,W,he,ae,ue,be;return{c(){t=Ba("svg"),n=Ba("defs"),c=Ba("style"),g=to(`.cls-1 {
        fill: #29abe2;
      }
    `),x=Ba("g"),S=Ba("g"),a=Ba("g"),G=Ba("path"),W=Ba("path"),he=Ba("path"),ae=Ba("path"),ue=Ba("path"),be=Ba("polygon"),this.h()},l(je){t=za(je,"svg",{id:!0,"data-name":!0,xmlns:!0,viewBox:!0});var nt=yn(t);n=za(nt,"defs",{});var tt=yn(n);c=za(tt,"style",{});var at=yn(c);g=io(at,`.cls-1 {
        fill: #29abe2;
      }
    `),at.forEach(vi),tt.forEach(vi),x=za(nt,"g",{id:!0,"data-name":!0});var ut=yn(x);S=za(ut,"g",{});var xt=yn(S);a=za(xt,"g",{});var Tt=yn(a);G=za(Tt,"path",{class:!0,d:!0}),yn(G).forEach(vi),W=za(Tt,"path",{class:!0,d:!0}),yn(W).forEach(vi),he=za(Tt,"path",{class:!0,d:!0}),yn(he).forEach(vi),ae=za(Tt,"path",{class:!0,d:!0}),yn(ae).forEach(vi),ue=za(Tt,"path",{class:!0,d:!0}),yn(ue).forEach(vi),Tt.forEach(vi),be=za(xt,"polygon",{class:!0,points:!0}),yn(be).forEach(vi),xt.forEach(vi),ut.forEach(vi),nt.forEach(vi),this.h()},h(){ki(G,"class","cls-1"),ki(G,"d","m9.41.16c1.38,0,2.18.92,1.92,2.28-.33,1.76-1.73,2.88-3.52,2.98l-1.2.06-1.13,3.08-1.68.12L6.91.16h2.5Zm-1.4,1.58l-.8,2.12.87-.03c.93-.03,1.38-.63,1.48-1.19.1-.56-.12-.92-.86-.91h-.68Z"),ki(W,"class","cls-1"),ki(W,"d","m14.62,7.9l1.24-3.16-2.79.12-1.25,3.24-1.68.12L13.24.15h1.69s-1.21,3.04-1.21,3.04l2.8-.08,1.21-2.96h1.7s-3.11,7.63-3.11,7.63l-1.7.12Z"),ki(he,"class","cls-1"),ki(he,"d","m22.82,5.85l-2.81.16-1.15,1.58-1.89.14L22.88.14h1.96s-.36,7.04-.36,7.04l-1.75.13.1-1.46Zm-1.65-1.38l1.75-.08.19-2.47-1.94,2.54Z"),ki(ae,"class","cls-1"),ki(ae,"d","m29.21,4.99c.06-.27,0-.48-.4-.63l-.81-.29c-.94-.34-1.26-1.02-1.08-1.84.3-1.36,1.78-2.23,3.24-2.23,2.08,0,2.33,1.22,2.18,1.89l-1.62.26c.04-.19.1-.88-.92-.86-.62,0-1.07.4-1.15.77-.08.34.12.52.39.63l.73.28c1.08.4,1.41,1,1.22,1.82-.23,1.05-1.46,2.18-3.22,2.31-2.15.16-2.61-1.14-2.41-2.06.03-.13.05-.21.08-.27l1.6-.32s-.05.14-.07.23c-.12.58.14,1.13,1.06,1.09.65-.04,1.09-.34,1.18-.77Z"),ki(ue,"class","cls-1"),ki(ue,"d","m36.78,1.44l-2.45,5.03-1.69.12,2.44-5.13-2.22.04.67-1.38h6.04s-.67,1.28-.67,1.28l-2.12.03Z"),ki(be,"class","cls-1"),ki(be,"points","3.79 .23 1.5 .23 0 2.22 .8 4.21 3.09 4.21 4.59 2.22 3.79 .23"),ki(x,"id","Layer_1-2"),ki(x,"data-name","Layer 1"),ki(t,"id","Layer_2"),ki(t,"data-name","Layer 2"),ki(t,"xmlns","http://www.w3.org/2000/svg"),ki(t,"viewBox","0 0 39.57 8.68")},m(je,nt){Un(je,t,nt),Hi(t,n),Hi(n,c),Hi(c,g),Hi(t,x),Hi(x,S),Hi(S,a),Hi(a,G),Hi(a,W),Hi(a,he),Hi(a,ae),Hi(a,ue),Hi(S,be)},p:Ra,i:Ra,o:Ra,d(je){je&&vi(t)}}}class g3 extends fo{constructor(t){super(),po(this,t,null,CT,Oa,{})}}function t_(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function TT(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function _3(e){let t,n,c;e.length!==2?(t=t_,n=(a,G)=>t_(e(a),G),c=(a,G)=>e(a)-G):(t=e===t_||e===TT?e:kT,n=e,c=e);function g(a,G,W=0,he=a.length){if(W<he){if(t(G,G)!==0)return he;do{const ae=W+he>>>1;n(a[ae],G)<0?W=ae+1:he=ae}while(W<he)}return W}function x(a,G,W=0,he=a.length){if(W<he){if(t(G,G)!==0)return he;do{const ae=W+he>>>1;n(a[ae],G)<=0?W=ae+1:he=ae}while(W<he)}return W}function S(a,G,W=0,he=a.length){const ae=g(a,G,W,he-1);return ae>W&&c(a[ae-1],G)>-c(a[ae],G)?ae-1:ae}return{left:g,center:S,right:x}}function kT(){return 0}function MT(e){return e===null?NaN:+e}const PT=_3(t_),DT=PT.right;_3(MT).center;function Ex(e,t){let n,c;if(t===void 0)for(const g of e)g!=null&&(n===void 0?g>=g&&(n=c=g):(n>g&&(n=g),c<g&&(c=g)));else{let g=-1;for(let x of e)(x=t(x,++g,e))!=null&&(n===void 0?x>=x&&(n=c=x):(n>x&&(n=x),c<x&&(c=x)))}return[n,c]}const LT=Math.sqrt(50),BT=Math.sqrt(10),zT=Math.sqrt(2);function y_(e,t,n){const c=(t-e)/Math.max(0,n),g=Math.floor(Math.log10(c)),x=c/Math.pow(10,g),S=x>=LT?10:x>=BT?5:x>=zT?2:1;let a,G,W;return g<0?(W=Math.pow(10,-g)/S,a=Math.round(e*W),G=Math.round(t*W),a/W<e&&++a,G/W>t&&--G,W=-W):(W=Math.pow(10,g)*S,a=Math.round(e/W),G=Math.round(t/W),a*W<e&&++a,G*W>t&&--G),G<a&&.5<=n&&n<2?y_(e,t,n*2):[a,G,W]}function RT(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const c=t<e,[g,x,S]=c?y_(t,e,n):y_(e,t,n);if(!(x>=g))return[];const a=x-g+1,G=new Array(a);if(c)if(S<0)for(let W=0;W<a;++W)G[W]=(x-W)/-S;else for(let W=0;W<a;++W)G[W]=(x-W)*S;else if(S<0)for(let W=0;W<a;++W)G[W]=(g+W)/-S;else for(let W=0;W<a;++W)G[W]=(g+W)*S;return G}function Oy(e,t,n){return t=+t,e=+e,n=+n,y_(e,t,n)[2]}function FT(e,t,n){t=+t,e=+e,n=+n;const c=t<e,g=c?Oy(t,e,n):Oy(e,t,n);return(c?-1:1)*(g<0?1/-g:g)}function OT(e){return e}var R1=1,F1=2,Ny=3,ng=4,Cx=1e-6;function NT(e){return"translate("+e+",0)"}function VT(e){return"translate(0,"+e+")"}function UT(e){return t=>+e(t)}function GT(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function qT(){return!this.__axis}function y3(e,t){var n=[],c=null,g=null,x=6,S=6,a=3,G=typeof window<"u"&&window.devicePixelRatio>1?0:.5,W=e===R1||e===ng?-1:1,he=e===ng||e===F1?"x":"y",ae=e===R1||e===Ny?NT:VT;function ue(be){var je=c??(t.ticks?t.ticks.apply(t,n):t.domain()),nt=g??(t.tickFormat?t.tickFormat.apply(t,n):OT),tt=Math.max(x,0)+a,at=t.range(),ut=+at[0]+G,xt=+at[at.length-1]+G,Tt=(t.bandwidth?GT:UT)(t.copy(),G),Mt=be.selection?be.selection():be,Oe=Mt.selectAll(".domain").data([null]),jt=Mt.selectAll(".tick").data(je,t).order(),it=jt.exit(),vt=jt.enter().append("g").attr("class","tick"),mt=jt.select("line"),Et=jt.select("text");Oe=Oe.merge(Oe.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),jt=jt.merge(vt),mt=mt.merge(vt.append("line").attr("stroke","currentColor").attr(he+"2",W*x)),Et=Et.merge(vt.append("text").attr("fill","currentColor").attr(he,W*tt).attr("dy",e===R1?"0em":e===Ny?"0.71em":"0.32em")),be!==Mt&&(Oe=Oe.transition(be),jt=jt.transition(be),mt=mt.transition(be),Et=Et.transition(be),it=it.transition(be).attr("opacity",Cx).attr("transform",function(Pt){return isFinite(Pt=Tt(Pt))?ae(Pt+G):this.getAttribute("transform")}),vt.attr("opacity",Cx).attr("transform",function(Pt){var dt=this.parentNode.__axis;return ae((dt&&isFinite(dt=dt(Pt))?dt:Tt(Pt))+G)})),it.remove(),Oe.attr("d",e===ng||e===F1?S?"M"+W*S+","+ut+"H"+G+"V"+xt+"H"+W*S:"M"+G+","+ut+"V"+xt:S?"M"+ut+","+W*S+"V"+G+"H"+xt+"V"+W*S:"M"+ut+","+G+"H"+xt),jt.attr("opacity",1).attr("transform",function(Pt){return ae(Tt(Pt)+G)}),mt.attr(he+"2",W*x),Et.attr(he,W*tt).text(nt),Mt.filter(qT).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===F1?"start":e===ng?"end":"middle"),Mt.each(function(){this.__axis=Tt})}return ue.scale=function(be){return arguments.length?(t=be,ue):t},ue.ticks=function(){return n=Array.from(arguments),ue},ue.tickArguments=function(be){return arguments.length?(n=be==null?[]:Array.from(be),ue):n.slice()},ue.tickValues=function(be){return arguments.length?(c=be==null?null:Array.from(be),ue):c&&c.slice()},ue.tickFormat=function(be){return arguments.length?(g=be,ue):g},ue.tickSize=function(be){return arguments.length?(x=S=+be,ue):x},ue.tickSizeInner=function(be){return arguments.length?(x=+be,ue):x},ue.tickSizeOuter=function(be){return arguments.length?(S=+be,ue):S},ue.tickPadding=function(be){return arguments.length?(a=+be,ue):a},ue.offset=function(be){return arguments.length?(G=+be,ue):G},ue}function HT(e){return y3(Ny,e)}function jT(e){return y3(ng,e)}var ZT={value:()=>{}};function v3(){for(var e=0,t=arguments.length,n={},c;e<t;++e){if(!(c=arguments[e]+"")||c in n||/[\s.]/.test(c))throw new Error("illegal type: "+c);n[c]=[]}return new i_(n)}function i_(e){this._=e}function QT(e,t){return e.trim().split(/^|\s+/).map(function(n){var c="",g=n.indexOf(".");if(g>=0&&(c=n.slice(g+1),n=n.slice(0,g)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:c}})}i_.prototype=v3.prototype={constructor:i_,on:function(e,t){var n=this._,c=QT(e+"",n),g,x=-1,S=c.length;if(arguments.length<2){for(;++x<S;)if((g=(e=c[x]).type)&&(g=WT(n[g],e.name)))return g;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++x<S;)if(g=(e=c[x]).type)n[g]=Tx(n[g],e.name,t);else if(t==null)for(g in n)n[g]=Tx(n[g],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new i_(e)},call:function(e,t){if((g=arguments.length-2)>0)for(var n=new Array(g),c=0,g,x;c<g;++c)n[c]=arguments[c+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(x=this._[e],c=0,g=x.length;c<g;++c)x[c].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var c=this._[e],g=0,x=c.length;g<x;++g)c[g].value.apply(t,n)}};function WT(e,t){for(var n=0,c=e.length,g;n<c;++n)if((g=e[n]).name===t)return g.value}function Tx(e,t,n){for(var c=0,g=e.length;c<g;++c)if(e[c].name===t){e[c]=ZT,e=e.slice(0,c).concat(e.slice(c+1));break}return n!=null&&e.push({name:t,value:n}),e}var Vy="http://www.w3.org/1999/xhtml";const kx={svg:"http://www.w3.org/2000/svg",xhtml:Vy,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function K_(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),kx.hasOwnProperty(t)?{space:kx[t],local:e}:e}function $T(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Vy&&t.documentElement.namespaceURI===Vy?t.createElement(e):t.createElementNS(n,e)}}function XT(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function x3(e){var t=K_(e);return(t.local?XT:$T)(t)}function YT(){}function Rv(e){return e==null?YT:function(){return this.querySelector(e)}}function KT(e){typeof e!="function"&&(e=Rv(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var x=t[g],S=x.length,a=c[g]=new Array(S),G,W,he=0;he<S;++he)(G=x[he])&&(W=e.call(G,G.__data__,he,x))&&("__data__"in G&&(W.__data__=G.__data__),a[he]=W);return new mh(c,this._parents)}function JT(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function e6(){return[]}function b3(e){return e==null?e6:function(){return this.querySelectorAll(e)}}function t6(e){return function(){return JT(e.apply(this,arguments))}}function i6(e){typeof e=="function"?e=t6(e):e=b3(e);for(var t=this._groups,n=t.length,c=[],g=[],x=0;x<n;++x)for(var S=t[x],a=S.length,G,W=0;W<a;++W)(G=S[W])&&(c.push(e.call(G,G.__data__,W,S)),g.push(G));return new mh(c,g)}function w3(e){return function(){return this.matches(e)}}function S3(e){return function(t){return t.matches(e)}}var n6=Array.prototype.find;function r6(e){return function(){return n6.call(this.children,e)}}function s6(){return this.firstElementChild}function a6(e){return this.select(e==null?s6:r6(typeof e=="function"?e:S3(e)))}var o6=Array.prototype.filter;function l6(){return Array.from(this.children)}function u6(e){return function(){return o6.call(this.children,e)}}function c6(e){return this.selectAll(e==null?l6:u6(typeof e=="function"?e:S3(e)))}function h6(e){typeof e!="function"&&(e=w3(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var x=t[g],S=x.length,a=c[g]=[],G,W=0;W<S;++W)(G=x[W])&&e.call(G,G.__data__,W,x)&&a.push(G);return new mh(c,this._parents)}function I3(e){return new Array(e.length)}function A6(){return new mh(this._enter||this._groups.map(I3),this._parents)}function v_(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}v_.prototype={constructor:v_,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function f6(e){return function(){return e}}function d6(e,t,n,c,g,x){for(var S=0,a,G=t.length,W=x.length;S<W;++S)(a=t[S])?(a.__data__=x[S],c[S]=a):n[S]=new v_(e,x[S]);for(;S<G;++S)(a=t[S])&&(g[S]=a)}function p6(e,t,n,c,g,x,S){var a,G,W=new Map,he=t.length,ae=x.length,ue=new Array(he),be;for(a=0;a<he;++a)(G=t[a])&&(ue[a]=be=S.call(G,G.__data__,a,t)+"",W.has(be)?g[a]=G:W.set(be,G));for(a=0;a<ae;++a)be=S.call(e,x[a],a,x)+"",(G=W.get(be))?(c[a]=G,G.__data__=x[a],W.delete(be)):n[a]=new v_(e,x[a]);for(a=0;a<he;++a)(G=t[a])&&W.get(ue[a])===G&&(g[a]=G)}function m6(e){return e.__data__}function g6(e,t){if(!arguments.length)return Array.from(this,m6);var n=t?p6:d6,c=this._parents,g=this._groups;typeof e!="function"&&(e=f6(e));for(var x=g.length,S=new Array(x),a=new Array(x),G=new Array(x),W=0;W<x;++W){var he=c[W],ae=g[W],ue=ae.length,be=_6(e.call(he,he&&he.__data__,W,c)),je=be.length,nt=a[W]=new Array(je),tt=S[W]=new Array(je),at=G[W]=new Array(ue);n(he,ae,nt,tt,at,be,t);for(var ut=0,xt=0,Tt,Mt;ut<je;++ut)if(Tt=nt[ut]){for(ut>=xt&&(xt=ut+1);!(Mt=tt[xt])&&++xt<je;);Tt._next=Mt||null}}return S=new mh(S,c),S._enter=a,S._exit=G,S}function _6(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function y6(){return new mh(this._exit||this._groups.map(I3),this._parents)}function v6(e,t,n){var c=this.enter(),g=this,x=this.exit();return typeof e=="function"?(c=e(c),c&&(c=c.selection())):c=c.append(e+""),t!=null&&(g=t(g),g&&(g=g.selection())),n==null?x.remove():n(x),c&&g?c.merge(g).order():g}function x6(e){for(var t=e.selection?e.selection():e,n=this._groups,c=t._groups,g=n.length,x=c.length,S=Math.min(g,x),a=new Array(g),G=0;G<S;++G)for(var W=n[G],he=c[G],ae=W.length,ue=a[G]=new Array(ae),be,je=0;je<ae;++je)(be=W[je]||he[je])&&(ue[je]=be);for(;G<g;++G)a[G]=n[G];return new mh(a,this._parents)}function b6(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var c=e[t],g=c.length-1,x=c[g],S;--g>=0;)(S=c[g])&&(x&&S.compareDocumentPosition(x)^4&&x.parentNode.insertBefore(S,x),x=S);return this}function w6(e){e||(e=S6);function t(ae,ue){return ae&&ue?e(ae.__data__,ue.__data__):!ae-!ue}for(var n=this._groups,c=n.length,g=new Array(c),x=0;x<c;++x){for(var S=n[x],a=S.length,G=g[x]=new Array(a),W,he=0;he<a;++he)(W=S[he])&&(G[he]=W);G.sort(t)}return new mh(g,this._parents).order()}function S6(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function I6(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function E6(){return Array.from(this)}function C6(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var c=e[t],g=0,x=c.length;g<x;++g){var S=c[g];if(S)return S}return null}function T6(){let e=0;for(const t of this)++e;return e}function k6(){return!this.node()}function M6(e){for(var t=this._groups,n=0,c=t.length;n<c;++n)for(var g=t[n],x=0,S=g.length,a;x<S;++x)(a=g[x])&&e.call(a,a.__data__,x,g);return this}function P6(e){return function(){this.removeAttribute(e)}}function D6(e){return function(){this.removeAttributeNS(e.space,e.local)}}function L6(e,t){return function(){this.setAttribute(e,t)}}function B6(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function z6(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function R6(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function F6(e,t){var n=K_(e);if(arguments.length<2){var c=this.node();return n.local?c.getAttributeNS(n.space,n.local):c.getAttribute(n)}return this.each((t==null?n.local?D6:P6:typeof t=="function"?n.local?R6:z6:n.local?B6:L6)(n,t))}function E3(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function O6(e){return function(){this.style.removeProperty(e)}}function N6(e,t,n){return function(){this.style.setProperty(e,t,n)}}function V6(e,t,n){return function(){var c=t.apply(this,arguments);c==null?this.style.removeProperty(e):this.style.setProperty(e,c,n)}}function U6(e,t,n){return arguments.length>1?this.each((t==null?O6:typeof t=="function"?V6:N6)(e,t,n??"")):dm(this.node(),e)}function dm(e,t){return e.style.getPropertyValue(t)||E3(e).getComputedStyle(e,null).getPropertyValue(t)}function G6(e){return function(){delete this[e]}}function q6(e,t){return function(){this[e]=t}}function H6(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function j6(e,t){return arguments.length>1?this.each((t==null?G6:typeof t=="function"?H6:q6)(e,t)):this.node()[e]}function C3(e){return e.trim().split(/^|\s+/)}function Fv(e){return e.classList||new T3(e)}function T3(e){this._node=e,this._names=C3(e.getAttribute("class")||"")}T3.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function k3(e,t){for(var n=Fv(e),c=-1,g=t.length;++c<g;)n.add(t[c])}function M3(e,t){for(var n=Fv(e),c=-1,g=t.length;++c<g;)n.remove(t[c])}function Z6(e){return function(){k3(this,e)}}function Q6(e){return function(){M3(this,e)}}function W6(e,t){return function(){(t.apply(this,arguments)?k3:M3)(this,e)}}function $6(e,t){var n=C3(e+"");if(arguments.length<2){for(var c=Fv(this.node()),g=-1,x=n.length;++g<x;)if(!c.contains(n[g]))return!1;return!0}return this.each((typeof t=="function"?W6:t?Z6:Q6)(n,t))}function X6(){this.textContent=""}function Y6(e){return function(){this.textContent=e}}function K6(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function J6(e){return arguments.length?this.each(e==null?X6:(typeof e=="function"?K6:Y6)(e)):this.node().textContent}function e8(){this.innerHTML=""}function t8(e){return function(){this.innerHTML=e}}function i8(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function n8(e){return arguments.length?this.each(e==null?e8:(typeof e=="function"?i8:t8)(e)):this.node().innerHTML}function r8(){this.nextSibling&&this.parentNode.appendChild(this)}function s8(){return this.each(r8)}function a8(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function o8(){return this.each(a8)}function l8(e){var t=typeof e=="function"?e:x3(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function u8(){return null}function c8(e,t){var n=typeof e=="function"?e:x3(e),c=t==null?u8:typeof t=="function"?t:Rv(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),c.apply(this,arguments)||null)})}function h8(){var e=this.parentNode;e&&e.removeChild(this)}function A8(){return this.each(h8)}function f8(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function d8(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function p8(e){return this.select(e?d8:f8)}function m8(e){return arguments.length?this.property("__data__",e):this.node().__data__}function g8(e){return function(t){e.call(this,t,this.__data__)}}function _8(e){return e.trim().split(/^|\s+/).map(function(t){var n="",c=t.indexOf(".");return c>=0&&(n=t.slice(c+1),t=t.slice(0,c)),{type:t,name:n}})}function y8(e){return function(){var t=this.__on;if(t){for(var n=0,c=-1,g=t.length,x;n<g;++n)x=t[n],(!e.type||x.type===e.type)&&x.name===e.name?this.removeEventListener(x.type,x.listener,x.options):t[++c]=x;++c?t.length=c:delete this.__on}}}function v8(e,t,n){return function(){var c=this.__on,g,x=g8(t);if(c){for(var S=0,a=c.length;S<a;++S)if((g=c[S]).type===e.type&&g.name===e.name){this.removeEventListener(g.type,g.listener,g.options),this.addEventListener(g.type,g.listener=x,g.options=n),g.value=t;return}}this.addEventListener(e.type,x,n),g={type:e.type,name:e.name,value:t,listener:x,options:n},c?c.push(g):this.__on=[g]}}function x8(e,t,n){var c=_8(e+""),g,x=c.length,S;if(arguments.length<2){var a=this.node().__on;if(a){for(var G=0,W=a.length,he;G<W;++G)for(g=0,he=a[G];g<x;++g)if((S=c[g]).type===he.type&&S.name===he.name)return he.value}return}for(a=t?v8:y8,g=0;g<x;++g)this.each(a(c[g],t,n));return this}function P3(e,t,n){var c=E3(e),g=c.CustomEvent;typeof g=="function"?g=new g(t,n):(g=c.document.createEvent("Event"),n?(g.initEvent(t,n.bubbles,n.cancelable),g.detail=n.detail):g.initEvent(t,!1,!1)),e.dispatchEvent(g)}function b8(e,t){return function(){return P3(this,e,t)}}function w8(e,t){return function(){return P3(this,e,t.apply(this,arguments))}}function S8(e,t){return this.each((typeof t=="function"?w8:b8)(e,t))}function*I8(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var c=e[t],g=0,x=c.length,S;g<x;++g)(S=c[g])&&(yield S)}var D3=[null];function mh(e,t){this._groups=e,this._parents=t}function kg(){return new mh([[document.documentElement]],D3)}function E8(){return this}mh.prototype=kg.prototype={constructor:mh,select:KT,selectAll:i6,selectChild:a6,selectChildren:c6,filter:h6,data:g6,enter:A6,exit:y6,join:v6,merge:x6,selection:E8,order:b6,sort:w6,call:I6,nodes:E6,node:C6,size:T6,empty:k6,each:M6,attr:F6,style:U6,property:j6,classed:$6,text:J6,html:n8,raise:s8,lower:o8,append:l8,insert:c8,remove:A8,clone:p8,datum:m8,on:x8,dispatch:S8,[Symbol.iterator]:I8};function n_(e){return typeof e=="string"?new mh([[document.querySelector(e)]],[document.documentElement]):new mh([[e]],D3)}function Ov(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function L3(e,t){var n=Object.create(e.prototype);for(var c in t)n[c]=t[c];return n}function Mg(){}var dg=.7,x_=1/dg,cm="\\s*([+-]?\\d+)\\s*",pg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",YA="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",C8=/^#([0-9a-f]{3,8})$/,T8=new RegExp(`^rgb\\(${cm},${cm},${cm}\\)$`),k8=new RegExp(`^rgb\\(${YA},${YA},${YA}\\)$`),M8=new RegExp(`^rgba\\(${cm},${cm},${cm},${pg}\\)$`),P8=new RegExp(`^rgba\\(${YA},${YA},${YA},${pg}\\)$`),D8=new RegExp(`^hsl\\(${pg},${YA},${YA}\\)$`),L8=new RegExp(`^hsla\\(${pg},${YA},${YA},${pg}\\)$`),Mx={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ov(Mg,tp,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Px,formatHex:Px,formatHex8:B8,formatHsl:z8,formatRgb:Dx,toString:Dx});function Px(){return this.rgb().formatHex()}function B8(){return this.rgb().formatHex8()}function z8(){return B3(this).formatHsl()}function Dx(){return this.rgb().formatRgb()}function tp(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=C8.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Lx(t):n===3?new Uc(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?qg(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?qg(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=T8.exec(e))?new Uc(t[1],t[2],t[3],1):(t=k8.exec(e))?new Uc(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=M8.exec(e))?qg(t[1],t[2],t[3],t[4]):(t=P8.exec(e))?qg(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=D8.exec(e))?Rx(t[1],t[2]/100,t[3]/100,1):(t=L8.exec(e))?Rx(t[1],t[2]/100,t[3]/100,t[4]):Mx.hasOwnProperty(e)?Lx(Mx[e]):e==="transparent"?new Uc(NaN,NaN,NaN,0):null}function Lx(e){return new Uc(e>>16&255,e>>8&255,e&255,1)}function qg(e,t,n,c){return c<=0&&(e=t=n=NaN),new Uc(e,t,n,c)}function R8(e){return e instanceof Mg||(e=tp(e)),e?(e=e.rgb(),new Uc(e.r,e.g,e.b,e.opacity)):new Uc}function Uy(e,t,n,c){return arguments.length===1?R8(e):new Uc(e,t,n,c??1)}function Uc(e,t,n,c){this.r=+e,this.g=+t,this.b=+n,this.opacity=+c}Ov(Uc,Uy,L3(Mg,{brighter(e){return e=e==null?x_:Math.pow(x_,e),new Uc(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?dg:Math.pow(dg,e),new Uc(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Uc(Xd(this.r),Xd(this.g),Xd(this.b),b_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Bx,formatHex:Bx,formatHex8:F8,formatRgb:zx,toString:zx}));function Bx(){return`#${Qd(this.r)}${Qd(this.g)}${Qd(this.b)}`}function F8(){return`#${Qd(this.r)}${Qd(this.g)}${Qd(this.b)}${Qd((isNaN(this.opacity)?1:this.opacity)*255)}`}function zx(){const e=b_(this.opacity);return`${e===1?"rgb(":"rgba("}${Xd(this.r)}, ${Xd(this.g)}, ${Xd(this.b)}${e===1?")":`, ${e})`}`}function b_(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Xd(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Qd(e){return e=Xd(e),(e<16?"0":"")+e.toString(16)}function Rx(e,t,n,c){return c<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new cA(e,t,n,c)}function B3(e){if(e instanceof cA)return new cA(e.h,e.s,e.l,e.opacity);if(e instanceof Mg||(e=tp(e)),!e)return new cA;if(e instanceof cA)return e;e=e.rgb();var t=e.r/255,n=e.g/255,c=e.b/255,g=Math.min(t,n,c),x=Math.max(t,n,c),S=NaN,a=x-g,G=(x+g)/2;return a?(t===x?S=(n-c)/a+(n<c)*6:n===x?S=(c-t)/a+2:S=(t-n)/a+4,a/=G<.5?x+g:2-x-g,S*=60):a=G>0&&G<1?0:S,new cA(S,a,G,e.opacity)}function O8(e,t,n,c){return arguments.length===1?B3(e):new cA(e,t,n,c??1)}function cA(e,t,n,c){this.h=+e,this.s=+t,this.l=+n,this.opacity=+c}Ov(cA,O8,L3(Mg,{brighter(e){return e=e==null?x_:Math.pow(x_,e),new cA(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?dg:Math.pow(dg,e),new cA(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,c=n+(n<.5?n:1-n)*t,g=2*n-c;return new Uc(O1(e>=240?e-240:e+120,g,c),O1(e,g,c),O1(e<120?e+240:e-120,g,c),this.opacity)},clamp(){return new cA(Fx(this.h),Hg(this.s),Hg(this.l),b_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=b_(this.opacity);return`${e===1?"hsl(":"hsla("}${Fx(this.h)}, ${Hg(this.s)*100}%, ${Hg(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Fx(e){return e=(e||0)%360,e<0?e+360:e}function Hg(e){return Math.max(0,Math.min(1,e||0))}function O1(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Nv=e=>()=>e;function N8(e,t){return function(n){return e+n*t}}function V8(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(c){return Math.pow(e+c*t,n)}}function U8(e){return(e=+e)==1?z3:function(t,n){return n-t?V8(t,n,e):Nv(isNaN(t)?n:t)}}function z3(e,t){var n=t-e;return n?N8(e,n):Nv(isNaN(e)?t:e)}const w_=function e(t){var n=U8(t);function c(g,x){var S=n((g=Uy(g)).r,(x=Uy(x)).r),a=n(g.g,x.g),G=n(g.b,x.b),W=z3(g.opacity,x.opacity);return function(he){return g.r=S(he),g.g=a(he),g.b=G(he),g.opacity=W(he),g+""}}return c.gamma=e,c}(1);function G8(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,c=t.slice(),g;return function(x){for(g=0;g<n;++g)c[g]=e[g]*(1-x)+t[g]*x;return c}}function q8(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function H8(e,t){var n=t?t.length:0,c=e?Math.min(n,e.length):0,g=new Array(c),x=new Array(n),S;for(S=0;S<c;++S)g[S]=Vv(e[S],t[S]);for(;S<n;++S)x[S]=t[S];return function(a){for(S=0;S<c;++S)x[S]=g[S](a);return x}}function j8(e,t){var n=new Date;return e=+e,t=+t,function(c){return n.setTime(e*(1-c)+t*c),n}}function lA(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Z8(e,t){var n={},c={},g;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(g in t)g in e?n[g]=Vv(e[g],t[g]):c[g]=t[g];return function(x){for(g in n)c[g]=n[g](x);return c}}var Gy=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,N1=new RegExp(Gy.source,"g");function Q8(e){return function(){return e}}function W8(e){return function(t){return e(t)+""}}function R3(e,t){var n=Gy.lastIndex=N1.lastIndex=0,c,g,x,S=-1,a=[],G=[];for(e=e+"",t=t+"";(c=Gy.exec(e))&&(g=N1.exec(t));)(x=g.index)>n&&(x=t.slice(n,x),a[S]?a[S]+=x:a[++S]=x),(c=c[0])===(g=g[0])?a[S]?a[S]+=g:a[++S]=g:(a[++S]=null,G.push({i:S,x:lA(c,g)})),n=N1.lastIndex;return n<t.length&&(x=t.slice(n),a[S]?a[S]+=x:a[++S]=x),a.length<2?G[0]?W8(G[0].x):Q8(t):(t=G.length,function(W){for(var he=0,ae;he<t;++he)a[(ae=G[he]).i]=ae.x(W);return a.join("")})}function Vv(e,t){var n=typeof t,c;return t==null||n==="boolean"?Nv(t):(n==="number"?lA:n==="string"?(c=tp(t))?(t=c,w_):R3:t instanceof tp?w_:t instanceof Date?j8:q8(t)?G8:Array.isArray(t)?H8:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Z8:lA)(e,t)}function $8(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var Ox=180/Math.PI,qy={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function F3(e,t,n,c,g,x){var S,a,G;return(S=Math.sqrt(e*e+t*t))&&(e/=S,t/=S),(G=e*n+t*c)&&(n-=e*G,c-=t*G),(a=Math.sqrt(n*n+c*c))&&(n/=a,c/=a,G/=a),e*c<t*n&&(e=-e,t=-t,G=-G,S=-S),{translateX:g,translateY:x,rotate:Math.atan2(t,e)*Ox,skewX:Math.atan(G)*Ox,scaleX:S,scaleY:a}}var jg;function X8(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?qy:F3(t.a,t.b,t.c,t.d,t.e,t.f)}function Y8(e){return e==null||(jg||(jg=document.createElementNS("http://www.w3.org/2000/svg","g")),jg.setAttribute("transform",e),!(e=jg.transform.baseVal.consolidate()))?qy:(e=e.matrix,F3(e.a,e.b,e.c,e.d,e.e,e.f))}function O3(e,t,n,c){function g(W){return W.length?W.pop()+" ":""}function x(W,he,ae,ue,be,je){if(W!==ae||he!==ue){var nt=be.push("translate(",null,t,null,n);je.push({i:nt-4,x:lA(W,ae)},{i:nt-2,x:lA(he,ue)})}else(ae||ue)&&be.push("translate("+ae+t+ue+n)}function S(W,he,ae,ue){W!==he?(W-he>180?he+=360:he-W>180&&(W+=360),ue.push({i:ae.push(g(ae)+"rotate(",null,c)-2,x:lA(W,he)})):he&&ae.push(g(ae)+"rotate("+he+c)}function a(W,he,ae,ue){W!==he?ue.push({i:ae.push(g(ae)+"skewX(",null,c)-2,x:lA(W,he)}):he&&ae.push(g(ae)+"skewX("+he+c)}function G(W,he,ae,ue,be,je){if(W!==ae||he!==ue){var nt=be.push(g(be)+"scale(",null,",",null,")");je.push({i:nt-4,x:lA(W,ae)},{i:nt-2,x:lA(he,ue)})}else(ae!==1||ue!==1)&&be.push(g(be)+"scale("+ae+","+ue+")")}return function(W,he){var ae=[],ue=[];return W=e(W),he=e(he),x(W.translateX,W.translateY,he.translateX,he.translateY,ae,ue),S(W.rotate,he.rotate,ae,ue),a(W.skewX,he.skewX,ae,ue),G(W.scaleX,W.scaleY,he.scaleX,he.scaleY,ae,ue),W=he=null,function(be){for(var je=-1,nt=ue.length,tt;++je<nt;)ae[(tt=ue[je]).i]=tt.x(be);return ae.join("")}}}var K8=O3(X8,"px, ","px)","deg)"),J8=O3(Y8,", ",")",")"),pm=0,rg=0,Zm=0,N3=1e3,S_,sg,I_=0,ip=0,J_=0,mg=typeof performance=="object"&&performance.now?performance:Date,V3=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Uv(){return ip||(V3(ek),ip=mg.now()+J_)}function ek(){ip=0}function E_(){this._call=this._time=this._next=null}E_.prototype=U3.prototype={constructor:E_,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Uv():+n)+(t==null?0:+t),!this._next&&sg!==this&&(sg?sg._next=this:S_=this,sg=this),this._call=e,this._time=n,Hy()},stop:function(){this._call&&(this._call=null,this._time=1/0,Hy())}};function U3(e,t,n){var c=new E_;return c.restart(e,t,n),c}function tk(){Uv(),++pm;for(var e=S_,t;e;)(t=ip-e._time)>=0&&e._call.call(void 0,t),e=e._next;--pm}function Nx(){ip=(I_=mg.now())+J_,pm=rg=0;try{tk()}finally{pm=0,nk(),ip=0}}function ik(){var e=mg.now(),t=e-I_;t>N3&&(J_-=t,I_=e)}function nk(){for(var e,t=S_,n,c=1/0;t;)t._call?(c>t._time&&(c=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:S_=n);sg=e,Hy(c)}function Hy(e){if(!pm){rg&&(rg=clearTimeout(rg));var t=e-ip;t>24?(e<1/0&&(rg=setTimeout(Nx,e-mg.now()-J_)),Zm&&(Zm=clearInterval(Zm))):(Zm||(I_=mg.now(),Zm=setInterval(ik,N3)),pm=1,V3(Nx))}}function Vx(e,t,n){var c=new E_;return t=t==null?0:+t,c.restart(g=>{c.stop(),e(g+t)},t,n),c}var rk=v3("start","end","cancel","interrupt"),sk=[],G3=0,Ux=1,jy=2,r_=3,Gx=4,Zy=5,s_=6;function e1(e,t,n,c,g,x){var S=e.__transition;if(!S)e.__transition={};else if(n in S)return;ak(e,n,{name:t,index:c,group:g,on:rk,tween:sk,time:x.time,delay:x.delay,duration:x.duration,ease:x.ease,timer:null,state:G3})}function Gv(e,t){var n=hA(e,t);if(n.state>G3)throw new Error("too late; already scheduled");return n}function rf(e,t){var n=hA(e,t);if(n.state>r_)throw new Error("too late; already running");return n}function hA(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function ak(e,t,n){var c=e.__transition,g;c[t]=n,n.timer=U3(x,0,n.time);function x(W){n.state=Ux,n.timer.restart(S,n.delay,n.time),n.delay<=W&&S(W-n.delay)}function S(W){var he,ae,ue,be;if(n.state!==Ux)return G();for(he in c)if(be=c[he],be.name===n.name){if(be.state===r_)return Vx(S);be.state===Gx?(be.state=s_,be.timer.stop(),be.on.call("interrupt",e,e.__data__,be.index,be.group),delete c[he]):+he<t&&(be.state=s_,be.timer.stop(),be.on.call("cancel",e,e.__data__,be.index,be.group),delete c[he])}if(Vx(function(){n.state===r_&&(n.state=Gx,n.timer.restart(a,n.delay,n.time),a(W))}),n.state=jy,n.on.call("start",e,e.__data__,n.index,n.group),n.state===jy){for(n.state=r_,g=new Array(ue=n.tween.length),he=0,ae=-1;he<ue;++he)(be=n.tween[he].value.call(e,e.__data__,n.index,n.group))&&(g[++ae]=be);g.length=ae+1}}function a(W){for(var he=W<n.duration?n.ease.call(null,W/n.duration):(n.timer.restart(G),n.state=Zy,1),ae=-1,ue=g.length;++ae<ue;)g[ae].call(e,he);n.state===Zy&&(n.on.call("end",e,e.__data__,n.index,n.group),G())}function G(){n.state=s_,n.timer.stop(),delete c[t];for(var W in c)return;delete e.__transition}}function ok(e,t){var n=e.__transition,c,g,x=!0,S;if(n){t=t==null?null:t+"";for(S in n){if((c=n[S]).name!==t){x=!1;continue}g=c.state>jy&&c.state<Zy,c.state=s_,c.timer.stop(),c.on.call(g?"interrupt":"cancel",e,e.__data__,c.index,c.group),delete n[S]}x&&delete e.__transition}}function lk(e){return this.each(function(){ok(this,e)})}function uk(e,t){var n,c;return function(){var g=rf(this,e),x=g.tween;if(x!==n){c=n=x;for(var S=0,a=c.length;S<a;++S)if(c[S].name===t){c=c.slice(),c.splice(S,1);break}}g.tween=c}}function ck(e,t,n){var c,g;if(typeof n!="function")throw new Error;return function(){var x=rf(this,e),S=x.tween;if(S!==c){g=(c=S).slice();for(var a={name:t,value:n},G=0,W=g.length;G<W;++G)if(g[G].name===t){g[G]=a;break}G===W&&g.push(a)}x.tween=g}}function hk(e,t){var n=this._id;if(e+="",arguments.length<2){for(var c=hA(this.node(),n).tween,g=0,x=c.length,S;g<x;++g)if((S=c[g]).name===e)return S.value;return null}return this.each((t==null?uk:ck)(n,e,t))}function qv(e,t,n){var c=e._id;return e.each(function(){var g=rf(this,c);(g.value||(g.value={}))[t]=n.apply(this,arguments)}),function(g){return hA(g,c).value[t]}}function q3(e,t){var n;return(typeof t=="number"?lA:t instanceof tp?w_:(n=tp(t))?(t=n,w_):R3)(e,t)}function Ak(e){return function(){this.removeAttribute(e)}}function fk(e){return function(){this.removeAttributeNS(e.space,e.local)}}function dk(e,t,n){var c,g=n+"",x;return function(){var S=this.getAttribute(e);return S===g?null:S===c?x:x=t(c=S,n)}}function pk(e,t,n){var c,g=n+"",x;return function(){var S=this.getAttributeNS(e.space,e.local);return S===g?null:S===c?x:x=t(c=S,n)}}function mk(e,t,n){var c,g,x;return function(){var S,a=n(this),G;return a==null?void this.removeAttribute(e):(S=this.getAttribute(e),G=a+"",S===G?null:S===c&&G===g?x:(g=G,x=t(c=S,a)))}}function gk(e,t,n){var c,g,x;return function(){var S,a=n(this),G;return a==null?void this.removeAttributeNS(e.space,e.local):(S=this.getAttributeNS(e.space,e.local),G=a+"",S===G?null:S===c&&G===g?x:(g=G,x=t(c=S,a)))}}function _k(e,t){var n=K_(e),c=n==="transform"?J8:q3;return this.attrTween(e,typeof t=="function"?(n.local?gk:mk)(n,c,qv(this,"attr."+e,t)):t==null?(n.local?fk:Ak)(n):(n.local?pk:dk)(n,c,t))}function yk(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function vk(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function xk(e,t){var n,c;function g(){var x=t.apply(this,arguments);return x!==c&&(n=(c=x)&&vk(e,x)),n}return g._value=t,g}function bk(e,t){var n,c;function g(){var x=t.apply(this,arguments);return x!==c&&(n=(c=x)&&yk(e,x)),n}return g._value=t,g}function wk(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var c=K_(e);return this.tween(n,(c.local?xk:bk)(c,t))}function Sk(e,t){return function(){Gv(this,e).delay=+t.apply(this,arguments)}}function Ik(e,t){return t=+t,function(){Gv(this,e).delay=t}}function Ek(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Sk:Ik)(t,e)):hA(this.node(),t).delay}function Ck(e,t){return function(){rf(this,e).duration=+t.apply(this,arguments)}}function Tk(e,t){return t=+t,function(){rf(this,e).duration=t}}function kk(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Ck:Tk)(t,e)):hA(this.node(),t).duration}function Mk(e,t){if(typeof t!="function")throw new Error;return function(){rf(this,e).ease=t}}function Pk(e){var t=this._id;return arguments.length?this.each(Mk(t,e)):hA(this.node(),t).ease}function Dk(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;rf(this,e).ease=n}}function Lk(e){if(typeof e!="function")throw new Error;return this.each(Dk(this._id,e))}function Bk(e){typeof e!="function"&&(e=w3(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var x=t[g],S=x.length,a=c[g]=[],G,W=0;W<S;++W)(G=x[W])&&e.call(G,G.__data__,W,x)&&a.push(G);return new i0(c,this._parents,this._name,this._id)}function zk(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,c=t.length,g=n.length,x=Math.min(c,g),S=new Array(c),a=0;a<x;++a)for(var G=t[a],W=n[a],he=G.length,ae=S[a]=new Array(he),ue,be=0;be<he;++be)(ue=G[be]||W[be])&&(ae[be]=ue);for(;a<c;++a)S[a]=t[a];return new i0(S,this._parents,this._name,this._id)}function Rk(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Fk(e,t,n){var c,g,x=Rk(t)?Gv:rf;return function(){var S=x(this,e),a=S.on;a!==c&&(g=(c=a).copy()).on(t,n),S.on=g}}function Ok(e,t){var n=this._id;return arguments.length<2?hA(this.node(),n).on.on(e):this.each(Fk(n,e,t))}function Nk(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Vk(){return this.on("end.remove",Nk(this._id))}function Uk(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Rv(e));for(var c=this._groups,g=c.length,x=new Array(g),S=0;S<g;++S)for(var a=c[S],G=a.length,W=x[S]=new Array(G),he,ae,ue=0;ue<G;++ue)(he=a[ue])&&(ae=e.call(he,he.__data__,ue,a))&&("__data__"in he&&(ae.__data__=he.__data__),W[ue]=ae,e1(W[ue],t,n,ue,W,hA(he,n)));return new i0(x,this._parents,t,n)}function Gk(e){var t=this._name,n=this._id;typeof e!="function"&&(e=b3(e));for(var c=this._groups,g=c.length,x=[],S=[],a=0;a<g;++a)for(var G=c[a],W=G.length,he,ae=0;ae<W;++ae)if(he=G[ae]){for(var ue=e.call(he,he.__data__,ae,G),be,je=hA(he,n),nt=0,tt=ue.length;nt<tt;++nt)(be=ue[nt])&&e1(be,t,n,nt,ue,je);x.push(ue),S.push(he)}return new i0(x,S,t,n)}var qk=kg.prototype.constructor;function Hk(){return new qk(this._groups,this._parents)}function jk(e,t){var n,c,g;return function(){var x=dm(this,e),S=(this.style.removeProperty(e),dm(this,e));return x===S?null:x===n&&S===c?g:g=t(n=x,c=S)}}function H3(e){return function(){this.style.removeProperty(e)}}function Zk(e,t,n){var c,g=n+"",x;return function(){var S=dm(this,e);return S===g?null:S===c?x:x=t(c=S,n)}}function Qk(e,t,n){var c,g,x;return function(){var S=dm(this,e),a=n(this),G=a+"";return a==null&&(G=a=(this.style.removeProperty(e),dm(this,e))),S===G?null:S===c&&G===g?x:(g=G,x=t(c=S,a))}}function Wk(e,t){var n,c,g,x="style."+t,S="end."+x,a;return function(){var G=rf(this,e),W=G.on,he=G.value[x]==null?a||(a=H3(t)):void 0;(W!==n||g!==he)&&(c=(n=W).copy()).on(S,g=he),G.on=c}}function $k(e,t,n){var c=(e+="")=="transform"?K8:q3;return t==null?this.styleTween(e,jk(e,c)).on("end.style."+e,H3(e)):typeof t=="function"?this.styleTween(e,Qk(e,c,qv(this,"style."+e,t))).each(Wk(this._id,e)):this.styleTween(e,Zk(e,c,t),n).on("end.style."+e,null)}function Xk(e,t,n){return function(c){this.style.setProperty(e,t.call(this,c),n)}}function Yk(e,t,n){var c,g;function x(){var S=t.apply(this,arguments);return S!==g&&(c=(g=S)&&Xk(e,S,n)),c}return x._value=t,x}function Kk(e,t,n){var c="style."+(e+="");if(arguments.length<2)return(c=this.tween(c))&&c._value;if(t==null)return this.tween(c,null);if(typeof t!="function")throw new Error;return this.tween(c,Yk(e,t,n??""))}function Jk(e){return function(){this.textContent=e}}function eM(e){return function(){var t=e(this);this.textContent=t??""}}function tM(e){return this.tween("text",typeof e=="function"?eM(qv(this,"text",e)):Jk(e==null?"":e+""))}function iM(e){return function(t){this.textContent=e.call(this,t)}}function nM(e){var t,n;function c(){var g=e.apply(this,arguments);return g!==n&&(t=(n=g)&&iM(g)),t}return c._value=e,c}function rM(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,nM(e))}function sM(){for(var e=this._name,t=this._id,n=j3(),c=this._groups,g=c.length,x=0;x<g;++x)for(var S=c[x],a=S.length,G,W=0;W<a;++W)if(G=S[W]){var he=hA(G,t);e1(G,e,n,W,S,{time:he.time+he.delay+he.duration,delay:0,duration:he.duration,ease:he.ease})}return new i0(c,this._parents,e,n)}function aM(){var e,t,n=this,c=n._id,g=n.size();return new Promise(function(x,S){var a={value:S},G={value:function(){--g===0&&x()}};n.each(function(){var W=rf(this,c),he=W.on;he!==e&&(t=(e=he).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(G)),W.on=t}),g===0&&x()})}var oM=0;function i0(e,t,n,c){this._groups=e,this._parents=t,this._name=n,this._id=c}function j3(){return++oM}var Qf=kg.prototype;i0.prototype={constructor:i0,select:Uk,selectAll:Gk,selectChild:Qf.selectChild,selectChildren:Qf.selectChildren,filter:Bk,merge:zk,selection:Hk,transition:sM,call:Qf.call,nodes:Qf.nodes,node:Qf.node,size:Qf.size,empty:Qf.empty,each:Qf.each,on:Ok,attr:_k,attrTween:wk,style:$k,styleTween:Kk,text:tM,textTween:rM,remove:Vk,tween:hk,delay:Ek,duration:kk,ease:Pk,easeVarying:Lk,end:aM,[Symbol.iterator]:Qf[Symbol.iterator]};function lM(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var uM={time:null,delay:0,duration:250,ease:lM};function cM(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function hM(e){var t,n;e instanceof i0?(t=e._id,e=e._name):(t=j3(),(n=uM).time=Uv(),e=e==null?null:e+"");for(var c=this._groups,g=c.length,x=0;x<g;++x)for(var S=c[x],a=S.length,G,W=0;W<a;++W)(G=S[W])&&e1(G,e,t,W,S,n||cM(G,t));return new i0(c,this._parents,e,t)}kg.prototype.interrupt=lk;kg.prototype.transition=hM;const Qy=Math.PI,Wy=2*Qy,jd=1e-6,AM=Wy-jd;function Z3(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function fM(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Z3;const n=10**t;return function(c){this._+=c[0];for(let g=1,x=c.length;g<x;++g)this._+=Math.round(arguments[g]*n)/n+c[g]}}let dM=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Z3:fM(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,c,g){this._append`Q${+t},${+n},${this._x1=+c},${this._y1=+g}`}bezierCurveTo(t,n,c,g,x,S){this._append`C${+t},${+n},${+c},${+g},${this._x1=+x},${this._y1=+S}`}arcTo(t,n,c,g,x){if(t=+t,n=+n,c=+c,g=+g,x=+x,x<0)throw new Error(`negative radius: ${x}`);let S=this._x1,a=this._y1,G=c-t,W=g-n,he=S-t,ae=a-n,ue=he*he+ae*ae;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(ue>jd)if(!(Math.abs(ae*G-W*he)>jd)||!x)this._append`L${this._x1=t},${this._y1=n}`;else{let be=c-S,je=g-a,nt=G*G+W*W,tt=be*be+je*je,at=Math.sqrt(nt),ut=Math.sqrt(ue),xt=x*Math.tan((Qy-Math.acos((nt+ue-tt)/(2*at*ut)))/2),Tt=xt/ut,Mt=xt/at;Math.abs(Tt-1)>jd&&this._append`L${t+Tt*he},${n+Tt*ae}`,this._append`A${x},${x},0,0,${+(ae*be>he*je)},${this._x1=t+Mt*G},${this._y1=n+Mt*W}`}}arc(t,n,c,g,x,S){if(t=+t,n=+n,c=+c,S=!!S,c<0)throw new Error(`negative radius: ${c}`);let a=c*Math.cos(g),G=c*Math.sin(g),W=t+a,he=n+G,ae=1^S,ue=S?g-x:x-g;this._x1===null?this._append`M${W},${he}`:(Math.abs(this._x1-W)>jd||Math.abs(this._y1-he)>jd)&&this._append`L${W},${he}`,c&&(ue<0&&(ue=ue%Wy+Wy),ue>AM?this._append`A${c},${c},0,1,${ae},${t-a},${n-G}A${c},${c},0,1,${ae},${this._x1=W},${this._y1=he}`:ue>jd&&this._append`A${c},${c},0,${+(ue>=Qy)},${ae},${this._x1=t+c*Math.cos(x)},${this._y1=n+c*Math.sin(x)}`)}rect(t,n,c,g){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${c=+c}v${+g}h${-c}Z`}toString(){return this._}};function pM(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function C_(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,c=e.slice(0,n);return[c.length>1?c[0]+c.slice(2):c,+e.slice(n+1)]}function mm(e){return e=C_(Math.abs(e)),e?e[1]:NaN}function mM(e,t){return function(n,c){for(var g=n.length,x=[],S=0,a=e[0],G=0;g>0&&a>0&&(G+a+1>c&&(a=Math.max(1,c-G)),x.push(n.substring(g-=a,g+a)),!((G+=a+1)>c));)a=e[S=(S+1)%e.length];return x.reverse().join(t)}}function gM(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var _M=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function T_(e){if(!(t=_M.exec(e)))throw new Error("invalid format: "+e);var t;return new Hv({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}T_.prototype=Hv.prototype;function Hv(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Hv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function yM(e){e:for(var t=e.length,n=1,c=-1,g;n<t;++n)switch(e[n]){case".":c=g=n;break;case"0":c===0&&(c=n),g=n;break;default:if(!+e[n])break e;c>0&&(c=0);break}return c>0?e.slice(0,c)+e.slice(g+1):e}var Q3;function vM(e,t){var n=C_(e,t);if(!n)return e+"";var c=n[0],g=n[1],x=g-(Q3=Math.max(-8,Math.min(8,Math.floor(g/3)))*3)+1,S=c.length;return x===S?c:x>S?c+new Array(x-S+1).join("0"):x>0?c.slice(0,x)+"."+c.slice(x):"0."+new Array(1-x).join("0")+C_(e,Math.max(0,t+x-1))[0]}function qx(e,t){var n=C_(e,t);if(!n)return e+"";var c=n[0],g=n[1];return g<0?"0."+new Array(-g).join("0")+c:c.length>g+1?c.slice(0,g+1)+"."+c.slice(g+1):c+new Array(g-c.length+2).join("0")}const Hx={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:pM,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>qx(e*100,t),r:qx,s:vM,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function jx(e){return e}var Zx=Array.prototype.map,Qx=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function xM(e){var t=e.grouping===void 0||e.thousands===void 0?jx:mM(Zx.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",c=e.currency===void 0?"":e.currency[1]+"",g=e.decimal===void 0?".":e.decimal+"",x=e.numerals===void 0?jx:gM(Zx.call(e.numerals,String)),S=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"":e.minus+"",G=e.nan===void 0?"NaN":e.nan+"";function W(ae){ae=T_(ae);var ue=ae.fill,be=ae.align,je=ae.sign,nt=ae.symbol,tt=ae.zero,at=ae.width,ut=ae.comma,xt=ae.precision,Tt=ae.trim,Mt=ae.type;Mt==="n"?(ut=!0,Mt="g"):Hx[Mt]||(xt===void 0&&(xt=12),Tt=!0,Mt="g"),(tt||ue==="0"&&be==="=")&&(tt=!0,ue="0",be="=");var Oe=nt==="$"?n:nt==="#"&&/[boxX]/.test(Mt)?"0"+Mt.toLowerCase():"",jt=nt==="$"?c:/[%p]/.test(Mt)?S:"",it=Hx[Mt],vt=/[defgprs%]/.test(Mt);xt=xt===void 0?6:/[gprs]/.test(Mt)?Math.max(1,Math.min(21,xt)):Math.max(0,Math.min(20,xt));function mt(Et){var Pt=Oe,dt=jt,Je,pt,lt;if(Mt==="c")dt=it(Et)+dt,Et="";else{Et=+Et;var Nt=Et<0||1/Et<0;if(Et=isNaN(Et)?G:it(Math.abs(Et),xt),Tt&&(Et=yM(Et)),Nt&&+Et==0&&je!=="+"&&(Nt=!1),Pt=(Nt?je==="("?je:a:je==="-"||je==="("?"":je)+Pt,dt=(Mt==="s"?Qx[8+Q3/3]:"")+dt+(Nt&&je==="("?")":""),vt){for(Je=-1,pt=Et.length;++Je<pt;)if(lt=Et.charCodeAt(Je),48>lt||lt>57){dt=(lt===46?g+Et.slice(Je+1):Et.slice(Je))+dt,Et=Et.slice(0,Je);break}}}ut&&!tt&&(Et=t(Et,1/0));var zt=Pt.length+Et.length+dt.length,Ot=zt<at?new Array(at-zt+1).join(ue):"";switch(ut&&tt&&(Et=t(Ot+Et,Ot.length?at-dt.length:1/0),Ot=""),be){case"<":Et=Pt+Et+dt+Ot;break;case"=":Et=Pt+Ot+Et+dt;break;case"^":Et=Ot.slice(0,zt=Ot.length>>1)+Pt+Et+dt+Ot.slice(zt);break;default:Et=Ot+Pt+Et+dt;break}return x(Et)}return mt.toString=function(){return ae+""},mt}function he(ae,ue){var be=W((ae=T_(ae),ae.type="f",ae)),je=Math.max(-8,Math.min(8,Math.floor(mm(ue)/3)))*3,nt=Math.pow(10,-je),tt=Qx[8+je/3];return function(at){return be(nt*at)+tt}}return{format:W,formatPrefix:he}}var Zg,W3,$3;bM({thousands:",",grouping:[3],currency:["$",""]});function bM(e){return Zg=xM(e),W3=Zg.format,$3=Zg.formatPrefix,Zg}function wM(e){return Math.max(0,-mm(Math.abs(e)))}function SM(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(mm(t)/3)))*3-mm(Math.abs(e)))}function IM(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,mm(t)-mm(e))+1}function EM(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function CM(e){return function(){return e}}function TM(e){return+e}var Wx=[0,1];function im(e){return e}function $y(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:CM(isNaN(t)?NaN:.5)}function kM(e,t){var n;return e>t&&(n=e,e=t,t=n),function(c){return Math.max(e,Math.min(t,c))}}function MM(e,t,n){var c=e[0],g=e[1],x=t[0],S=t[1];return g<c?(c=$y(g,c),x=n(S,x)):(c=$y(c,g),x=n(x,S)),function(a){return x(c(a))}}function PM(e,t,n){var c=Math.min(e.length,t.length)-1,g=new Array(c),x=new Array(c),S=-1;for(e[c]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++S<c;)g[S]=$y(e[S],e[S+1]),x[S]=n(t[S],t[S+1]);return function(a){var G=DT(e,a,1,c)-1;return x[G](g[G](a))}}function DM(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function LM(){var e=Wx,t=Wx,n=Vv,c,g,x,S=im,a,G,W;function he(){var ue=Math.min(e.length,t.length);return S!==im&&(S=kM(e[0],e[ue-1])),a=ue>2?PM:MM,G=W=null,ae}function ae(ue){return ue==null||isNaN(ue=+ue)?x:(G||(G=a(e.map(c),t,n)))(c(S(ue)))}return ae.invert=function(ue){return S(g((W||(W=a(t,e.map(c),lA)))(ue)))},ae.domain=function(ue){return arguments.length?(e=Array.from(ue,TM),he()):e.slice()},ae.range=function(ue){return arguments.length?(t=Array.from(ue),he()):t.slice()},ae.rangeRound=function(ue){return t=Array.from(ue),n=$8,he()},ae.clamp=function(ue){return arguments.length?(S=ue?!0:im,he()):S!==im},ae.interpolate=function(ue){return arguments.length?(n=ue,he()):n},ae.unknown=function(ue){return arguments.length?(x=ue,ae):x},function(ue,be){return c=ue,g=be,he()}}function BM(){return LM()(im,im)}function zM(e,t,n,c){var g=FT(e,t,n),x;switch(c=T_(c??",f"),c.type){case"s":{var S=Math.max(Math.abs(e),Math.abs(t));return c.precision==null&&!isNaN(x=SM(g,S))&&(c.precision=x),$3(c,S)}case"":case"e":case"g":case"p":case"r":{c.precision==null&&!isNaN(x=IM(g,Math.max(Math.abs(e),Math.abs(t))))&&(c.precision=x-(c.type==="e"));break}case"f":case"%":{c.precision==null&&!isNaN(x=wM(g))&&(c.precision=x-(c.type==="%")*2);break}}return W3(c)}function RM(e){var t=e.domain;return e.ticks=function(n){var c=t();return RT(c[0],c[c.length-1],n??10)},e.tickFormat=function(n,c){var g=t();return zM(g[0],g[g.length-1],n??10,c)},e.nice=function(n){n==null&&(n=10);var c=t(),g=0,x=c.length-1,S=c[g],a=c[x],G,W,he=10;for(a<S&&(W=S,S=a,a=W,W=g,g=x,x=W);he-- >0;){if(W=Oy(S,a,n),W===G)return c[g]=S,c[x]=a,t(c);if(W>0)S=Math.floor(S/W)*W,a=Math.ceil(a/W)*W;else if(W<0)S=Math.ceil(S*W)/W,a=Math.floor(a*W)/W;else break;G=W}return e},e}function Xy(){var e=BM();return e.copy=function(){return DM(e,Xy())},EM.apply(e,arguments),RM(e)}function Lu(e){return function(){return e}}function X3(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const c=Math.floor(n);if(!(c>=0))throw new RangeError(`invalid digits: ${n}`);t=c}return e},()=>new dM(t)}function Y3(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function K3(e){this._context=e}K3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function J3(e){return new K3(e)}function e4(e){return e[0]}function t4(e){return e[1]}function Jp(e,t){var n=Lu(!0),c=null,g=J3,x=null,S=X3(a);e=typeof e=="function"?e:e===void 0?e4:Lu(e),t=typeof t=="function"?t:t===void 0?t4:Lu(t);function a(G){var W,he=(G=Y3(G)).length,ae,ue=!1,be;for(c==null&&(x=g(be=S())),W=0;W<=he;++W)!(W<he&&n(ae=G[W],W,G))===ue&&((ue=!ue)?x.lineStart():x.lineEnd()),ue&&x.point(+e(ae,W,G),+t(ae,W,G));if(be)return x=null,be+""||null}return a.x=function(G){return arguments.length?(e=typeof G=="function"?G:Lu(+G),a):e},a.y=function(G){return arguments.length?(t=typeof G=="function"?G:Lu(+G),a):t},a.defined=function(G){return arguments.length?(n=typeof G=="function"?G:Lu(!!G),a):n},a.curve=function(G){return arguments.length?(g=G,c!=null&&(x=g(c)),a):g},a.context=function(G){return arguments.length?(G==null?c=x=null:x=g(c=G),a):c},a}function V1(e,t,n){var c=null,g=Lu(!0),x=null,S=J3,a=null,G=X3(W);e=typeof e=="function"?e:e===void 0?e4:Lu(+e),t=typeof t=="function"?t:Lu(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?t4:Lu(+n);function W(ae){var ue,be,je,nt=(ae=Y3(ae)).length,tt,at=!1,ut,xt=new Array(nt),Tt=new Array(nt);for(x==null&&(a=S(ut=G())),ue=0;ue<=nt;++ue){if(!(ue<nt&&g(tt=ae[ue],ue,ae))===at)if(at=!at)be=ue,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),je=ue-1;je>=be;--je)a.point(xt[je],Tt[je]);a.lineEnd(),a.areaEnd()}at&&(xt[ue]=+e(tt,ue,ae),Tt[ue]=+t(tt,ue,ae),a.point(c?+c(tt,ue,ae):xt[ue],n?+n(tt,ue,ae):Tt[ue]))}if(ut)return a=null,ut+""||null}function he(){return Jp().defined(g).curve(S).context(x)}return W.x=function(ae){return arguments.length?(e=typeof ae=="function"?ae:Lu(+ae),c=null,W):e},W.x0=function(ae){return arguments.length?(e=typeof ae=="function"?ae:Lu(+ae),W):e},W.x1=function(ae){return arguments.length?(c=ae==null?null:typeof ae=="function"?ae:Lu(+ae),W):c},W.y=function(ae){return arguments.length?(t=typeof ae=="function"?ae:Lu(+ae),n=null,W):t},W.y0=function(ae){return arguments.length?(t=typeof ae=="function"?ae:Lu(+ae),W):t},W.y1=function(ae){return arguments.length?(n=ae==null?null:typeof ae=="function"?ae:Lu(+ae),W):n},W.lineX0=W.lineY0=function(){return he().x(e).y(t)},W.lineY1=function(){return he().x(e).y(n)},W.lineX1=function(){return he().x(c).y(t)},W.defined=function(ae){return arguments.length?(g=typeof ae=="function"?ae:Lu(!!ae),W):g},W.curve=function(ae){return arguments.length?(S=ae,x!=null&&(a=S(x)),W):S},W.context=function(ae){return arguments.length?(ae==null?x=a=null:a=S(x=ae),W):x},W}function $x(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function i4(e){this._context=e}i4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:$x(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:$x(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function FM(e){return new i4(e)}function ag(e,t,n){this.k=e,this.x=t,this.y=n}ag.prototype={constructor:ag,scale:function(e){return e===1?this:new ag(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new ag(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};ag.prototype;function Xx(e,t,n){const c=e.slice();return c[34]=t[n],c[36]=n,c}function Yx(e){let t,n,c=wx[e[5]]+"",g,x,S,a,G,W,he,ae,ue,be,je,nt,tt,at,ut,xt,Tt,Mt,Oe,jt,it,vt,mt,Et=ph(e[0]),Pt=[];for(let dt=0;dt<Et.length;dt+=1)Pt[dt]=Kx(Xx(e,Et,dt));return{c(){t=Fn("div"),n=Fn("h2"),g=to(c),x=to(" by tree size"),S=wr(),a=Ba("svg"),G=Ba("defs"),W=Ba("linearGradient"),he=Ba("stop"),ae=Ba("stop"),ue=Ba("stop"),be=Ba("g"),nt=Ba("g"),at=Ba("path"),xt=Ba("g");for(let dt=0;dt<Pt.length;dt+=1)Pt[dt].c();Tt=Ba("text"),Mt=to(e[11]),it=Ba("text"),vt=to(e[12]),this.h()},l(dt){t=On(dt,"DIV",{class:!0});var Je=yn(t);n=On(Je,"H2",{class:!0});var pt=yn(n);g=io(pt,c),x=io(pt," by tree size"),pt.forEach(vi),S=Sr(Je),a=za(Je,"svg",{id:!0,viewBox:!0,class:!0});var lt=yn(a);G=za(lt,"defs",{});var Nt=yn(G);W=za(Nt,"linearGradient",{id:!0,x1:!0,x2:!0,y1:!0,y2:!0});var zt=yn(W);he=za(zt,"stop",{class:!0,offset:!0}),yn(he).forEach(vi),ae=za(zt,"stop",{class:!0,offset:!0}),yn(ae).forEach(vi),ue=za(zt,"stop",{class:!0,offset:!0}),yn(ue).forEach(vi),zt.forEach(vi),Nt.forEach(vi),be=za(lt,"g",{class:!0,transform:!0}),yn(be).forEach(vi),nt=za(lt,"g",{class:!0,transform:!0}),yn(nt).forEach(vi),at=za(lt,"path",{class:!0,fill:!0,stroke:!0,"stroke-width":!0,d:!0}),yn(at).forEach(vi),xt=za(lt,"g",{class:!0,fill:!0,stroke:!0,"stroke-width":!0});var Ot=yn(xt);for(let Ti=0;Ti<Pt.length;Ti+=1)Pt[Ti].l(Ot);Ot.forEach(vi),Tt=za(lt,"text",{class:!0,"text-anchor":!0,x:!0,y:!0});var gi=yn(Tt);Mt=io(gi,e[11]),gi.forEach(vi),it=za(lt,"text",{class:!0,"text-anchor":!0,transform:!0,x:!0,y:!0});var wi=yn(it);vt=io(wi,e[12]),wi.forEach(vi),lt.forEach(vi),Je.forEach(vi),this.h()},h(){ki(n,"class","svelte-156wt8f"),ki(he,"class","stop1 svelte-156wt8f"),ki(he,"offset","0%"),ki(ae,"class","stop2 svelte-156wt8f"),ki(ae,"offset","50%"),ki(ue,"class","stop3 svelte-156wt8f"),ki(ue,"offset","100%"),ki(W,"id","Gradient1"),ki(W,"x1","0"),ki(W,"x2","0"),ki(W,"y1","0"),ki(W,"y2","0.2"),ki(be,"class","scale x svelte-156wt8f"),ki(be,"transform",je="translate(0,"+(e[2]-e[3])+")"),ki(nt,"class","scale y svelte-156wt8f"),ki(nt,"transform",tt="translate("+e[4]+",0)"),ki(at,"class","area ci svelte-156wt8f"),ki(at,"fill",fm()[300]),ki(at,"stroke","currentColor"),ki(at,"stroke-width","0"),ki(at,"d",ut=e[14](e[10])),ki(xt,"class","point"),ki(xt,"fill",fm[700]),ki(xt,"stroke","currentColor"),ki(xt,"stroke-width","1.5"),ki(Tt,"class","axis-label svelte-156wt8f"),ki(Tt,"text-anchor","center"),ki(Tt,"x",Oe=e[1]/2),ki(Tt,"y",jt=e[2]+12),ki(it,"class","axis-label svelte-156wt8f"),ki(it,"text-anchor","center"),ki(it,"transform","rotate(-90)"),ki(it,"x",e[13]),ki(it,"y",-10),ki(a,"id","viz"),ki(a,"viewBox",mt=`0 0 ${e[1]} ${e[2]}`),ki(a,"class","svelte-156wt8f"),ki(t,"class","graph-container svelte-156wt8f")},m(dt,Je){Un(dt,t,Je),Hi(t,n),Hi(n,g),Hi(n,x),Hi(t,S),Hi(t,a),Hi(a,G),Hi(G,W),Hi(W,he),Hi(W,ae),Hi(W,ue),Hi(a,be),e[21](be),Hi(a,nt),e[22](nt),Hi(a,at),Hi(a,xt);for(let pt=0;pt<Pt.length;pt+=1)Pt[pt]&&Pt[pt].m(xt,null);Hi(a,Tt),Hi(Tt,Mt),Hi(a,it),Hi(it,vt)},p(dt,Je){if(Je[0]&32&&c!==(c=wx[dt[5]]+"")&&su(g,c),Je[0]&12&&je!==(je="translate(0,"+(dt[2]-dt[3])+")")&&ki(be,"transform",je),Je[0]&16&&tt!==(tt="translate("+dt[4]+",0)")&&ki(nt,"transform",tt),Je[0]&1024&&ut!==(ut=dt[14](dt[10]))&&ki(at,"d",ut),Je[0]&769){Et=ph(dt[0]);let pt;for(pt=0;pt<Et.length;pt+=1){const lt=Xx(dt,Et,pt);Pt[pt]?Pt[pt].p(lt,Je):(Pt[pt]=Kx(lt),Pt[pt].c(),Pt[pt].m(xt,null))}for(;pt<Pt.length;pt+=1)Pt[pt].d(1);Pt.length=Et.length}Je[0]&2048&&su(Mt,dt[11]),Je[0]&2&&Oe!==(Oe=dt[1]/2)&&ki(Tt,"x",Oe),Je[0]&4&&jt!==(jt=dt[2]+12)&&ki(Tt,"y",jt),Je[0]&4096&&su(vt,dt[12]),Je[0]&8192&&ki(it,"x",dt[13]),Je[0]&6&&mt!==(mt=`0 0 ${dt[1]} ${dt[2]}`)&&ki(a,"viewBox",mt)},d(dt){dt&&vi(t),e[21](null),e[22](null),up(Pt,dt)}}}function Kx(e){let t,n,c;return{c(){t=Ba("circle"),this.h()},l(g){t=za(g,"circle",{key:!0,cx:!0,cy:!0,r:!0,fill:!0,class:!0}),yn(t).forEach(vi),this.h()},h(){ki(t,"key",e[36]),ki(t,"cx",n=e[8](e[34][0])),ki(t,"cy",c=e[9](e[34][1])),ki(t,"r","5"),ki(t,"fill",fm[700]),ki(t,"class","anim-point svelte-156wt8f")},m(g,x){Un(g,t,x)},p(g,x){x[0]&257&&n!==(n=g[8](g[34][0]))&&ki(t,"cx",n),x[0]&513&&c!==(c=g[9](g[34][1]))&&ki(t,"cy",c)},d(g){g&&vi(t)}}}function OM(e){let t,n=e[10]&&e[5]&&Yx(e);return{c(){n&&n.c(),t=Ls()},l(c){n&&n.l(c),t=Ls()},m(c,g){n&&n.m(c,g),Un(c,t,g)},p(c,g){c[10]&&c[5]?n?n.p(c,g):(n=Yx(c),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:Ra,o:Ra,d(c){c&&vi(t),n&&n.d(c)}}}function NM(e,t,n){let{data:c}=t,{point:g}=t,{width:x=640}=t,{height:S=400}=t,{marginTop:a=20}=t,{marginRight:G=20}=t,{marginBottom:W=30}=t,{marginLeft:he=40}=t,{metric:ae}=t,ue,be,je=null,nt=[0,10],tt=[0,10],at="",ut="",xt=0,Tt,Mt,{colorScheme:Oe}=t,jt;function it(dt){jt=bT(dt),console.log(jt),n(10,je=jt.confidence),n(19,nt=jt.yAxis),n(20,tt=jt.xAxis),n(11,at=jt.xAxisLabel),n(12,ut=jt.yAxisLabel),n(13,xt=vt(ut))}function vt(dt){return console.log("label length:",dt.length),-1*(S/2)-dt.length*2.5}const mt=V1().x(dt=>Tt(dt.x)).y0(dt=>Mt(Math.max(dt.low,nt[0]))).y1(dt=>Mt(Math.min(dt.high,nt[1])));Jp(dt=>Tt(dt.x),dt=>Mt(dt.y)),Jp(dt=>Tt(dt.x),dt=>Mt(dt.low)),Jp(dt=>Tt(dt.x),dt=>Mt(dt.high)),V1().x(dt=>Tt(dt.x)).y0(dt=>Mt(dt.high)).y1(dt=>-1*Mt(nt[1])),V1().x(dt=>Tt(dt.x)).y0(dt=>Mt(nt[0])).y1(dt=>Mt(dt.low)),Jp(dt=>Tt(dt.x),dt=>Mt(dt.y)).curve(FM);function Et(dt){pa[dt?"unshift":"push"](()=>{ue=dt,n(6,ue)})}function Pt(dt){pa[dt?"unshift":"push"](()=>{be=dt,n(7,be)})}return e.$$set=dt=>{"data"in dt&&n(15,c=dt.data),"point"in dt&&n(0,g=dt.point),"width"in dt&&n(1,x=dt.width),"height"in dt&&n(2,S=dt.height),"marginTop"in dt&&n(16,a=dt.marginTop),"marginRight"in dt&&n(17,G=dt.marginRight),"marginBottom"in dt&&n(3,W=dt.marginBottom),"marginLeft"in dt&&n(4,he=dt.marginLeft),"metric"in dt&&n(5,ae=dt.metric),"colorScheme"in dt&&n(18,Oe=dt.colorScheme)},e.$$.update=()=>{e.$$.dirty[0]&262144&&lT(Oe),e.$$.dirty[0]&32&&(jt=it(ae)),e.$$.dirty[0]&1179666&&n(8,Tt=Xy(Ex(tt),[he,x-G])),e.$$.dirty[0]&589836&&n(9,Mt=Xy(Ex(nt),[S-W,a])),e.$$.dirty[0]&768&&Jp((dt,Je)=>Tt(Je),Mt),e.$$.dirty[0]&640&&n_(be).call(jT(Mt)),e.$$.dirty[0]&320&&n_(ue).call(HT(Tt)),e.$$.dirty[0]&6&&n_("svg").append("div").classed("svg-container",!0).append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox",`0 0 ${x} ${S}`).classed("svg-content-responsive",!0),e.$$.dirty[0]&33&&console.log("relative:",wT(ae,g[0][1],g[0][0]))},[g,x,S,W,he,ae,ue,be,Tt,Mt,je,at,ut,xt,mt,c,a,G,Oe,nt,tt,Et,Pt]}class VM extends fo{constructor(t){super(),po(this,t,NM,OM,Oa,{data:15,point:0,width:1,height:2,marginTop:16,marginRight:17,marginBottom:3,marginLeft:4,metric:5,colorScheme:18},null,[-1,-1])}}function n4(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function r4(e){let t=e,n=e;e.length===1&&(t=(S,a)=>e(S)-a,n=UM(e));function c(S,a,G,W){for(G==null&&(G=0),W==null&&(W=S.length);G<W;){const he=G+W>>>1;n(S[he],a)<0?G=he+1:W=he}return G}function g(S,a,G,W){for(G==null&&(G=0),W==null&&(W=S.length);G<W;){const he=G+W>>>1;n(S[he],a)>0?W=he:G=he+1}return G}function x(S,a,G,W){G==null&&(G=0),W==null&&(W=S.length);const he=c(S,a,G,W-1);return he>G&&t(S[he-1],a)>-t(S[he],a)?he-1:he}return{left:c,center:x,right:g}}function UM(e){return(t,n)=>n4(e(t),n)}function GM(e){return e===null?NaN:+e}const qM=r4(n4),HM=qM.right;r4(GM).center;var Yy=Math.sqrt(50),Ky=Math.sqrt(10),Jy=Math.sqrt(2);function jM(e,t,n){var c,g=-1,x,S,a;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((c=t<e)&&(x=e,e=t,t=x),(a=s4(e,t,n))===0||!isFinite(a))return[];if(a>0){let G=Math.round(e/a),W=Math.round(t/a);for(G*a<e&&++G,W*a>t&&--W,S=new Array(x=W-G+1);++g<x;)S[g]=(G+g)*a}else{a=-a;let G=Math.round(e*a),W=Math.round(t*a);for(G/a<e&&++G,W/a>t&&--W,S=new Array(x=W-G+1);++g<x;)S[g]=(G+g)/a}return c&&S.reverse(),S}function s4(e,t,n){var c=(t-e)/Math.max(0,n),g=Math.floor(Math.log(c)/Math.LN10),x=c/Math.pow(10,g);return g>=0?(x>=Yy?10:x>=Ky?5:x>=Jy?2:1)*Math.pow(10,g):-Math.pow(10,-g)/(x>=Yy?10:x>=Ky?5:x>=Jy?2:1)}function ZM(e,t,n){var c=Math.abs(t-e)/Math.max(0,n),g=Math.pow(10,Math.floor(Math.log(c)/Math.LN10)),x=c/g;return x>=Yy?g*=10:x>=Ky?g*=5:x>=Jy&&(g*=2),t<e?-g:g}function QM(e,t){let n;if(t===void 0)for(const c of e)c!=null&&(n<c||n===void 0&&c>=c)&&(n=c);else{let c=-1;for(let g of e)(g=t(g,++c,e))!=null&&(n<g||n===void 0&&g>=g)&&(n=g)}return n}var U1=Array.prototype.slice;function WM(e){return e}var a_=1,G1=2,Jx=3,Qg=4,eb=1e-6;function $M(e){return"translate("+e+",0)"}function XM(e){return"translate(0,"+e+")"}function YM(e){return t=>+e(t)}function KM(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function JM(){return!this.__axis}function eP(e,t){var n=[],c=null,g=null,x=6,S=6,a=3,G=typeof window<"u"&&window.devicePixelRatio>1?0:.5,W=e===a_||e===Qg?-1:1,he=e===Qg||e===G1?"x":"y",ae=e===a_||e===Jx?$M:XM;function ue(be){var je=c??(t.ticks?t.ticks.apply(t,n):t.domain()),nt=g??(t.tickFormat?t.tickFormat.apply(t,n):WM),tt=Math.max(x,0)+a,at=t.range(),ut=+at[0]+G,xt=+at[at.length-1]+G,Tt=(t.bandwidth?KM:YM)(t.copy(),G),Mt=be.selection?be.selection():be,Oe=Mt.selectAll(".domain").data([null]),jt=Mt.selectAll(".tick").data(je,t).order(),it=jt.exit(),vt=jt.enter().append("g").attr("class","tick"),mt=jt.select("line"),Et=jt.select("text");Oe=Oe.merge(Oe.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),jt=jt.merge(vt),mt=mt.merge(vt.append("line").attr("stroke","currentColor").attr(he+"2",W*x)),Et=Et.merge(vt.append("text").attr("fill","currentColor").attr(he,W*tt).attr("dy",e===a_?"0em":e===Jx?"0.71em":"0.32em")),be!==Mt&&(Oe=Oe.transition(be),jt=jt.transition(be),mt=mt.transition(be),Et=Et.transition(be),it=it.transition(be).attr("opacity",eb).attr("transform",function(Pt){return isFinite(Pt=Tt(Pt))?ae(Pt+G):this.getAttribute("transform")}),vt.attr("opacity",eb).attr("transform",function(Pt){var dt=this.parentNode.__axis;return ae((dt&&isFinite(dt=dt(Pt))?dt:Tt(Pt))+G)})),it.remove(),Oe.attr("d",e===Qg||e===G1?S?"M"+W*S+","+ut+"H"+G+"V"+xt+"H"+W*S:"M"+G+","+ut+"V"+xt:S?"M"+ut+","+W*S+"V"+G+"H"+xt+"V"+W*S:"M"+ut+","+G+"H"+xt),jt.attr("opacity",1).attr("transform",function(Pt){return ae(Tt(Pt)+G)}),mt.attr(he+"2",W*x),Et.attr(he,W*tt).text(nt),Mt.filter(JM).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===G1?"start":e===Qg?"end":"middle"),Mt.each(function(){this.__axis=Tt})}return ue.scale=function(be){return arguments.length?(t=be,ue):t},ue.ticks=function(){return n=U1.call(arguments),ue},ue.tickArguments=function(be){return arguments.length?(n=be==null?[]:U1.call(be),ue):n.slice()},ue.tickValues=function(be){return arguments.length?(c=be==null?null:U1.call(be),ue):c&&c.slice()},ue.tickFormat=function(be){return arguments.length?(g=be,ue):g},ue.tickSize=function(be){return arguments.length?(x=S=+be,ue):x},ue.tickSizeInner=function(be){return arguments.length?(x=+be,ue):x},ue.tickSizeOuter=function(be){return arguments.length?(S=+be,ue):S},ue.tickPadding=function(be){return arguments.length?(a=+be,ue):a},ue.offset=function(be){return arguments.length?(G=+be,ue):G},ue}function tP(e){return eP(a_,e)}var iP={value:()=>{}};function t1(){for(var e=0,t=arguments.length,n={},c;e<t;++e){if(!(c=arguments[e]+"")||c in n||/[\s.]/.test(c))throw new Error("illegal type: "+c);n[c]=[]}return new o_(n)}function o_(e){this._=e}function nP(e,t){return e.trim().split(/^|\s+/).map(function(n){var c="",g=n.indexOf(".");if(g>=0&&(c=n.slice(g+1),n=n.slice(0,g)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:c}})}o_.prototype=t1.prototype={constructor:o_,on:function(e,t){var n=this._,c=nP(e+"",n),g,x=-1,S=c.length;if(arguments.length<2){for(;++x<S;)if((g=(e=c[x]).type)&&(g=rP(n[g],e.name)))return g;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++x<S;)if(g=(e=c[x]).type)n[g]=tb(n[g],e.name,t);else if(t==null)for(g in n)n[g]=tb(n[g],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new o_(e)},call:function(e,t){if((g=arguments.length-2)>0)for(var n=new Array(g),c=0,g,x;c<g;++c)n[c]=arguments[c+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(x=this._[e],c=0,g=x.length;c<g;++c)x[c].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var c=this._[e],g=0,x=c.length;g<x;++g)c[g].value.apply(t,n)}};function rP(e,t){for(var n=0,c=e.length,g;n<c;++n)if((g=e[n]).name===t)return g.value}function tb(e,t,n){for(var c=0,g=e.length;c<g;++c)if(e[c].name===t){e[c]=iP,e=e.slice(0,c).concat(e.slice(c+1));break}return n!=null&&e.push({name:t,value:n}),e}var ev="http://www.w3.org/1999/xhtml";const ib={svg:"http://www.w3.org/2000/svg",xhtml:ev,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function i1(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),ib.hasOwnProperty(t)?{space:ib[t],local:e}:e}function sP(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===ev&&t.documentElement.namespaceURI===ev?t.createElement(e):t.createElementNS(n,e)}}function aP(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function jv(e){var t=i1(e);return(t.local?aP:sP)(t)}function oP(){}function Zv(e){return e==null?oP:function(){return this.querySelector(e)}}function lP(e){typeof e!="function"&&(e=Zv(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var x=t[g],S=x.length,a=c[g]=new Array(S),G,W,he=0;he<S;++he)(G=x[he])&&(W=e.call(G,G.__data__,he,x))&&("__data__"in G&&(W.__data__=G.__data__),a[he]=W);return new qc(c,this._parents)}function a4(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function uP(){return[]}function o4(e){return e==null?uP:function(){return this.querySelectorAll(e)}}function cP(e){return function(){var t=e.apply(this,arguments);return t==null?[]:a4(t)}}function hP(e){typeof e=="function"?e=cP(e):e=o4(e);for(var t=this._groups,n=t.length,c=[],g=[],x=0;x<n;++x)for(var S=t[x],a=S.length,G,W=0;W<a;++W)(G=S[W])&&(c.push(e.call(G,G.__data__,W,S)),g.push(G));return new qc(c,g)}function l4(e){return function(){return this.matches(e)}}function u4(e){return function(t){return t.matches(e)}}var AP=Array.prototype.find;function fP(e){return function(){return AP.call(this.children,e)}}function dP(){return this.firstElementChild}function pP(e){return this.select(e==null?dP:fP(typeof e=="function"?e:u4(e)))}var mP=Array.prototype.filter;function gP(){return this.children}function _P(e){return function(){return mP.call(this.children,e)}}function yP(e){return this.selectAll(e==null?gP:_P(typeof e=="function"?e:u4(e)))}function vP(e){typeof e!="function"&&(e=l4(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var x=t[g],S=x.length,a=c[g]=[],G,W=0;W<S;++W)(G=x[W])&&e.call(G,G.__data__,W,x)&&a.push(G);return new qc(c,this._parents)}function c4(e){return new Array(e.length)}function xP(){return new qc(this._enter||this._groups.map(c4),this._parents)}function k_(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}k_.prototype={constructor:k_,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function bP(e){return function(){return e}}function wP(e,t,n,c,g,x){for(var S=0,a,G=t.length,W=x.length;S<W;++S)(a=t[S])?(a.__data__=x[S],c[S]=a):n[S]=new k_(e,x[S]);for(;S<G;++S)(a=t[S])&&(g[S]=a)}function SP(e,t,n,c,g,x,S){var a,G,W=new Map,he=t.length,ae=x.length,ue=new Array(he),be;for(a=0;a<he;++a)(G=t[a])&&(ue[a]=be=S.call(G,G.__data__,a,t)+"",W.has(be)?g[a]=G:W.set(be,G));for(a=0;a<ae;++a)be=S.call(e,x[a],a,x)+"",(G=W.get(be))?(c[a]=G,G.__data__=x[a],W.delete(be)):n[a]=new k_(e,x[a]);for(a=0;a<he;++a)(G=t[a])&&W.get(ue[a])===G&&(g[a]=G)}function IP(e){return e.__data__}function EP(e,t){if(!arguments.length)return Array.from(this,IP);var n=t?SP:wP,c=this._parents,g=this._groups;typeof e!="function"&&(e=bP(e));for(var x=g.length,S=new Array(x),a=new Array(x),G=new Array(x),W=0;W<x;++W){var he=c[W],ae=g[W],ue=ae.length,be=a4(e.call(he,he&&he.__data__,W,c)),je=be.length,nt=a[W]=new Array(je),tt=S[W]=new Array(je),at=G[W]=new Array(ue);n(he,ae,nt,tt,at,be,t);for(var ut=0,xt=0,Tt,Mt;ut<je;++ut)if(Tt=nt[ut]){for(ut>=xt&&(xt=ut+1);!(Mt=tt[xt])&&++xt<je;);Tt._next=Mt||null}}return S=new qc(S,c),S._enter=a,S._exit=G,S}function CP(){return new qc(this._exit||this._groups.map(c4),this._parents)}function TP(e,t,n){var c=this.enter(),g=this,x=this.exit();return c=typeof e=="function"?e(c):c.append(e+""),t!=null&&(g=t(g)),n==null?x.remove():n(x),c&&g?c.merge(g).order():g}function kP(e){if(!(e instanceof qc))throw new Error("invalid merge");for(var t=this._groups,n=e._groups,c=t.length,g=n.length,x=Math.min(c,g),S=new Array(c),a=0;a<x;++a)for(var G=t[a],W=n[a],he=G.length,ae=S[a]=new Array(he),ue,be=0;be<he;++be)(ue=G[be]||W[be])&&(ae[be]=ue);for(;a<c;++a)S[a]=t[a];return new qc(S,this._parents)}function MP(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var c=e[t],g=c.length-1,x=c[g],S;--g>=0;)(S=c[g])&&(x&&S.compareDocumentPosition(x)^4&&x.parentNode.insertBefore(S,x),x=S);return this}function PP(e){e||(e=DP);function t(ae,ue){return ae&&ue?e(ae.__data__,ue.__data__):!ae-!ue}for(var n=this._groups,c=n.length,g=new Array(c),x=0;x<c;++x){for(var S=n[x],a=S.length,G=g[x]=new Array(a),W,he=0;he<a;++he)(W=S[he])&&(G[he]=W);G.sort(t)}return new qc(g,this._parents).order()}function DP(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function LP(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function BP(){return Array.from(this)}function zP(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var c=e[t],g=0,x=c.length;g<x;++g){var S=c[g];if(S)return S}return null}function RP(){let e=0;for(const t of this)++e;return e}function FP(){return!this.node()}function OP(e){for(var t=this._groups,n=0,c=t.length;n<c;++n)for(var g=t[n],x=0,S=g.length,a;x<S;++x)(a=g[x])&&e.call(a,a.__data__,x,g);return this}function NP(e){return function(){this.removeAttribute(e)}}function VP(e){return function(){this.removeAttributeNS(e.space,e.local)}}function UP(e,t){return function(){this.setAttribute(e,t)}}function GP(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function qP(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function HP(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function jP(e,t){var n=i1(e);if(arguments.length<2){var c=this.node();return n.local?c.getAttributeNS(n.space,n.local):c.getAttribute(n)}return this.each((t==null?n.local?VP:NP:typeof t=="function"?n.local?HP:qP:n.local?GP:UP)(n,t))}function h4(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function ZP(e){return function(){this.style.removeProperty(e)}}function QP(e,t,n){return function(){this.style.setProperty(e,t,n)}}function WP(e,t,n){return function(){var c=t.apply(this,arguments);c==null?this.style.removeProperty(e):this.style.setProperty(e,c,n)}}function $P(e,t,n){return arguments.length>1?this.each((t==null?ZP:typeof t=="function"?WP:QP)(e,t,n??"")):gm(this.node(),e)}function gm(e,t){return e.style.getPropertyValue(t)||h4(e).getComputedStyle(e,null).getPropertyValue(t)}function XP(e){return function(){delete this[e]}}function YP(e,t){return function(){this[e]=t}}function KP(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function JP(e,t){return arguments.length>1?this.each((t==null?XP:typeof t=="function"?KP:YP)(e,t)):this.node()[e]}function A4(e){return e.trim().split(/^|\s+/)}function Qv(e){return e.classList||new f4(e)}function f4(e){this._node=e,this._names=A4(e.getAttribute("class")||"")}f4.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function d4(e,t){for(var n=Qv(e),c=-1,g=t.length;++c<g;)n.add(t[c])}function p4(e,t){for(var n=Qv(e),c=-1,g=t.length;++c<g;)n.remove(t[c])}function eD(e){return function(){d4(this,e)}}function tD(e){return function(){p4(this,e)}}function iD(e,t){return function(){(t.apply(this,arguments)?d4:p4)(this,e)}}function nD(e,t){var n=A4(e+"");if(arguments.length<2){for(var c=Qv(this.node()),g=-1,x=n.length;++g<x;)if(!c.contains(n[g]))return!1;return!0}return this.each((typeof t=="function"?iD:t?eD:tD)(n,t))}function rD(){this.textContent=""}function sD(e){return function(){this.textContent=e}}function aD(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function oD(e){return arguments.length?this.each(e==null?rD:(typeof e=="function"?aD:sD)(e)):this.node().textContent}function lD(){this.innerHTML=""}function uD(e){return function(){this.innerHTML=e}}function cD(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function hD(e){return arguments.length?this.each(e==null?lD:(typeof e=="function"?cD:uD)(e)):this.node().innerHTML}function AD(){this.nextSibling&&this.parentNode.appendChild(this)}function fD(){return this.each(AD)}function dD(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function pD(){return this.each(dD)}function mD(e){var t=typeof e=="function"?e:jv(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function gD(){return null}function _D(e,t){var n=typeof e=="function"?e:jv(e),c=t==null?gD:typeof t=="function"?t:Zv(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),c.apply(this,arguments)||null)})}function yD(){var e=this.parentNode;e&&e.removeChild(this)}function vD(){return this.each(yD)}function xD(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function bD(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function wD(e){return this.select(e?bD:xD)}function SD(e){return arguments.length?this.property("__data__",e):this.node().__data__}function ID(e){return function(t){e.call(this,t,this.__data__)}}function ED(e){return e.trim().split(/^|\s+/).map(function(t){var n="",c=t.indexOf(".");return c>=0&&(n=t.slice(c+1),t=t.slice(0,c)),{type:t,name:n}})}function CD(e){return function(){var t=this.__on;if(t){for(var n=0,c=-1,g=t.length,x;n<g;++n)x=t[n],(!e.type||x.type===e.type)&&x.name===e.name?this.removeEventListener(x.type,x.listener,x.options):t[++c]=x;++c?t.length=c:delete this.__on}}}function TD(e,t,n){return function(){var c=this.__on,g,x=ID(t);if(c){for(var S=0,a=c.length;S<a;++S)if((g=c[S]).type===e.type&&g.name===e.name){this.removeEventListener(g.type,g.listener,g.options),this.addEventListener(g.type,g.listener=x,g.options=n),g.value=t;return}}this.addEventListener(e.type,x,n),g={type:e.type,name:e.name,value:t,listener:x,options:n},c?c.push(g):this.__on=[g]}}function kD(e,t,n){var c=ED(e+""),g,x=c.length,S;if(arguments.length<2){var a=this.node().__on;if(a){for(var G=0,W=a.length,he;G<W;++G)for(g=0,he=a[G];g<x;++g)if((S=c[g]).type===he.type&&S.name===he.name)return he.value}return}for(a=t?TD:CD,g=0;g<x;++g)this.each(a(c[g],t,n));return this}function m4(e,t,n){var c=h4(e),g=c.CustomEvent;typeof g=="function"?g=new g(t,n):(g=c.document.createEvent("Event"),n?(g.initEvent(t,n.bubbles,n.cancelable),g.detail=n.detail):g.initEvent(t,!1,!1)),e.dispatchEvent(g)}function MD(e,t){return function(){return m4(this,e,t)}}function PD(e,t){return function(){return m4(this,e,t.apply(this,arguments))}}function DD(e,t){return this.each((typeof t=="function"?PD:MD)(e,t))}function*LD(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var c=e[t],g=0,x=c.length,S;g<x;++g)(S=c[g])&&(yield S)}var g4=[null];function qc(e,t){this._groups=e,this._parents=t}function Pg(){return new qc([[document.documentElement]],g4)}function BD(){return this}qc.prototype=Pg.prototype={constructor:qc,select:lP,selectAll:hP,selectChild:pP,selectChildren:yP,filter:vP,data:EP,enter:xP,exit:CP,join:TP,merge:kP,selection:BD,order:MP,sort:PP,call:LP,nodes:BP,node:zP,size:RP,empty:FP,each:OP,attr:jP,style:$P,property:JP,classed:nD,text:oD,html:hD,raise:fD,lower:pD,append:mD,insert:_D,remove:vD,clone:wD,datum:SD,on:kD,dispatch:DD,[Symbol.iterator]:LD};function dl(e){return typeof e=="string"?new qc([[document.querySelector(e)]],[document.documentElement]):new qc([[e]],g4)}function zD(e){return dl(jv(e).call(document.documentElement))}function RD(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Yf(e,t){if(e=RD(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var c=n.createSVGPoint();return c.x=e.clientX,c.y=e.clientY,c=c.matrixTransform(t.getScreenCTM().inverse()),[c.x,c.y]}if(t.getBoundingClientRect){var g=t.getBoundingClientRect();return[e.clientX-g.left-t.clientLeft,e.clientY-g.top-t.clientTop]}}return[e.pageX,e.pageY]}function tv(e){e.preventDefault(),e.stopImmediatePropagation()}function _4(e){var t=e.document.documentElement,n=dl(e).on("dragstart.drag",tv,!0);"onselectstart"in t?n.on("selectstart.drag",tv,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function y4(e,t){var n=e.document.documentElement,c=dl(e).on("dragstart.drag",null);t&&(c.on("click.drag",tv,!0),setTimeout(function(){c.on("click.drag",null)},0)),"onselectstart"in n?c.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function Wv(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function v4(e,t){var n=Object.create(e.prototype);for(var c in t)n[c]=t[c];return n}function Dg(){}var gg=.7,M_=1/gg,hm="\\s*([+-]?\\d+)\\s*",_g="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",KA="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",FD=/^#([0-9a-f]{3,8})$/,OD=new RegExp("^rgb\\("+[hm,hm,hm]+"\\)$"),ND=new RegExp("^rgb\\("+[KA,KA,KA]+"\\)$"),VD=new RegExp("^rgba\\("+[hm,hm,hm,_g]+"\\)$"),UD=new RegExp("^rgba\\("+[KA,KA,KA,_g]+"\\)$"),GD=new RegExp("^hsl\\("+[_g,KA,KA]+"\\)$"),qD=new RegExp("^hsla\\("+[_g,KA,KA,_g]+"\\)$"),nb={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Wv(Dg,np,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:rb,formatHex:rb,formatHsl:HD,formatRgb:sb,toString:sb});function rb(){return this.rgb().formatHex()}function HD(){return x4(this).formatHsl()}function sb(){return this.rgb().formatRgb()}function np(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=FD.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?ab(t):n===3?new fh(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Wg(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Wg(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=OD.exec(e))?new fh(t[1],t[2],t[3],1):(t=ND.exec(e))?new fh(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=VD.exec(e))?Wg(t[1],t[2],t[3],t[4]):(t=UD.exec(e))?Wg(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=GD.exec(e))?ub(t[1],t[2]/100,t[3]/100,1):(t=qD.exec(e))?ub(t[1],t[2]/100,t[3]/100,t[4]):nb.hasOwnProperty(e)?ab(nb[e]):e==="transparent"?new fh(NaN,NaN,NaN,0):null}function ab(e){return new fh(e>>16&255,e>>8&255,e&255,1)}function Wg(e,t,n,c){return c<=0&&(e=t=n=NaN),new fh(e,t,n,c)}function jD(e){return e instanceof Dg||(e=np(e)),e?(e=e.rgb(),new fh(e.r,e.g,e.b,e.opacity)):new fh}function iv(e,t,n,c){return arguments.length===1?jD(e):new fh(e,t,n,c??1)}function fh(e,t,n,c){this.r=+e,this.g=+t,this.b=+n,this.opacity=+c}Wv(fh,iv,v4(Dg,{brighter:function(e){return e=e==null?M_:Math.pow(M_,e),new fh(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?gg:Math.pow(gg,e),new fh(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ob,formatHex:ob,formatRgb:lb,toString:lb}));function ob(){return"#"+q1(this.r)+q1(this.g)+q1(this.b)}function lb(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function q1(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function ub(e,t,n,c){return c<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new $A(e,t,n,c)}function x4(e){if(e instanceof $A)return new $A(e.h,e.s,e.l,e.opacity);if(e instanceof Dg||(e=np(e)),!e)return new $A;if(e instanceof $A)return e;e=e.rgb();var t=e.r/255,n=e.g/255,c=e.b/255,g=Math.min(t,n,c),x=Math.max(t,n,c),S=NaN,a=x-g,G=(x+g)/2;return a?(t===x?S=(n-c)/a+(n<c)*6:n===x?S=(c-t)/a+2:S=(t-n)/a+4,a/=G<.5?x+g:2-x-g,S*=60):a=G>0&&G<1?0:S,new $A(S,a,G,e.opacity)}function ZD(e,t,n,c){return arguments.length===1?x4(e):new $A(e,t,n,c??1)}function $A(e,t,n,c){this.h=+e,this.s=+t,this.l=+n,this.opacity=+c}Wv($A,ZD,v4(Dg,{brighter:function(e){return e=e==null?M_:Math.pow(M_,e),new $A(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?gg:Math.pow(gg,e),new $A(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,c=n+(n<.5?n:1-n)*t,g=2*n-c;return new fh(H1(e>=240?e-240:e+120,g,c),H1(e,g,c),H1(e<120?e+240:e-120,g,c),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function H1(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const $v=e=>()=>e;function QD(e,t){return function(n){return e+n*t}}function WD(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(c){return Math.pow(e+c*t,n)}}function $D(e){return(e=+e)==1?b4:function(t,n){return n-t?WD(t,n,e):$v(isNaN(t)?n:t)}}function b4(e,t){var n=t-e;return n?QD(e,n):$v(isNaN(e)?t:e)}const P_=function e(t){var n=$D(t);function c(g,x){var S=n((g=iv(g)).r,(x=iv(x)).r),a=n(g.g,x.g),G=n(g.b,x.b),W=b4(g.opacity,x.opacity);return function(he){return g.r=S(he),g.g=a(he),g.b=G(he),g.opacity=W(he),g+""}}return c.gamma=e,c}(1);function XD(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,c=t.slice(),g;return function(x){for(g=0;g<n;++g)c[g]=e[g]*(1-x)+t[g]*x;return c}}function YD(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function KD(e,t){var n=t?t.length:0,c=e?Math.min(n,e.length):0,g=new Array(c),x=new Array(n),S;for(S=0;S<c;++S)g[S]=n1(e[S],t[S]);for(;S<n;++S)x[S]=t[S];return function(a){for(S=0;S<c;++S)x[S]=g[S](a);return x}}function JD(e,t){var n=new Date;return e=+e,t=+t,function(c){return n.setTime(e*(1-c)+t*c),n}}function uA(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function eL(e,t){var n={},c={},g;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(g in t)g in e?n[g]=n1(e[g],t[g]):c[g]=t[g];return function(x){for(g in n)c[g]=n[g](x);return c}}var nv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,j1=new RegExp(nv.source,"g");function tL(e){return function(){return e}}function iL(e){return function(t){return e(t)+""}}function w4(e,t){var n=nv.lastIndex=j1.lastIndex=0,c,g,x,S=-1,a=[],G=[];for(e=e+"",t=t+"";(c=nv.exec(e))&&(g=j1.exec(t));)(x=g.index)>n&&(x=t.slice(n,x),a[S]?a[S]+=x:a[++S]=x),(c=c[0])===(g=g[0])?a[S]?a[S]+=g:a[++S]=g:(a[++S]=null,G.push({i:S,x:uA(c,g)})),n=j1.lastIndex;return n<t.length&&(x=t.slice(n),a[S]?a[S]+=x:a[++S]=x),a.length<2?G[0]?iL(G[0].x):tL(t):(t=G.length,function(W){for(var he=0,ae;he<t;++he)a[(ae=G[he]).i]=ae.x(W);return a.join("")})}function n1(e,t){var n=typeof t,c;return t==null||n==="boolean"?$v(t):(n==="number"?uA:n==="string"?(c=np(t))?(t=c,P_):w4:t instanceof np?P_:t instanceof Date?JD:YD(t)?XD:Array.isArray(t)?KD:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?eL:uA)(e,t)}function nL(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var cb=180/Math.PI,rv={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function S4(e,t,n,c,g,x){var S,a,G;return(S=Math.sqrt(e*e+t*t))&&(e/=S,t/=S),(G=e*n+t*c)&&(n-=e*G,c-=t*G),(a=Math.sqrt(n*n+c*c))&&(n/=a,c/=a,G/=a),e*c<t*n&&(e=-e,t=-t,G=-G,S=-S),{translateX:g,translateY:x,rotate:Math.atan2(t,e)*cb,skewX:Math.atan(G)*cb,scaleX:S,scaleY:a}}var $g;function rL(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?rv:S4(t.a,t.b,t.c,t.d,t.e,t.f)}function sL(e){return e==null||($g||($g=document.createElementNS("http://www.w3.org/2000/svg","g")),$g.setAttribute("transform",e),!(e=$g.transform.baseVal.consolidate()))?rv:(e=e.matrix,S4(e.a,e.b,e.c,e.d,e.e,e.f))}function I4(e,t,n,c){function g(W){return W.length?W.pop()+" ":""}function x(W,he,ae,ue,be,je){if(W!==ae||he!==ue){var nt=be.push("translate(",null,t,null,n);je.push({i:nt-4,x:uA(W,ae)},{i:nt-2,x:uA(he,ue)})}else(ae||ue)&&be.push("translate("+ae+t+ue+n)}function S(W,he,ae,ue){W!==he?(W-he>180?he+=360:he-W>180&&(W+=360),ue.push({i:ae.push(g(ae)+"rotate(",null,c)-2,x:uA(W,he)})):he&&ae.push(g(ae)+"rotate("+he+c)}function a(W,he,ae,ue){W!==he?ue.push({i:ae.push(g(ae)+"skewX(",null,c)-2,x:uA(W,he)}):he&&ae.push(g(ae)+"skewX("+he+c)}function G(W,he,ae,ue,be,je){if(W!==ae||he!==ue){var nt=be.push(g(be)+"scale(",null,",",null,")");je.push({i:nt-4,x:uA(W,ae)},{i:nt-2,x:uA(he,ue)})}else(ae!==1||ue!==1)&&be.push(g(be)+"scale("+ae+","+ue+")")}return function(W,he){var ae=[],ue=[];return W=e(W),he=e(he),x(W.translateX,W.translateY,he.translateX,he.translateY,ae,ue),S(W.rotate,he.rotate,ae,ue),a(W.skewX,he.skewX,ae,ue),G(W.scaleX,W.scaleY,he.scaleX,he.scaleY,ae,ue),W=he=null,function(be){for(var je=-1,nt=ue.length,tt;++je<nt;)ae[(tt=ue[je]).i]=tt.x(be);return ae.join("")}}}var aL=I4(rL,"px, ","px)","deg)"),oL=I4(sL,", ",")",")"),lL=1e-12;function hb(e){return((e=Math.exp(e))+1/e)/2}function uL(e){return((e=Math.exp(e))-1/e)/2}function cL(e){return((e=Math.exp(2*e))-1)/(e+1)}const hL=function e(t,n,c){function g(x,S){var a=x[0],G=x[1],W=x[2],he=S[0],ae=S[1],ue=S[2],be=he-a,je=ae-G,nt=be*be+je*je,tt,at;if(nt<lL)at=Math.log(ue/W)/t,tt=function(jt){return[a+jt*be,G+jt*je,W*Math.exp(t*jt*at)]};else{var ut=Math.sqrt(nt),xt=(ue*ue-W*W+c*nt)/(2*W*n*ut),Tt=(ue*ue-W*W-c*nt)/(2*ue*n*ut),Mt=Math.log(Math.sqrt(xt*xt+1)-xt),Oe=Math.log(Math.sqrt(Tt*Tt+1)-Tt);at=(Oe-Mt)/t,tt=function(jt){var it=jt*at,vt=hb(Mt),mt=W/(n*ut)*(vt*cL(t*it+Mt)-uL(Mt));return[a+mt*be,G+mt*je,W*vt/hb(t*it+Mt)]}}return tt.duration=at*1e3*t/Math.SQRT2,tt}return g.rho=function(x){var S=Math.max(.001,+x),a=S*S,G=a*a;return e(S,a,G)},g}(Math.SQRT2,2,4);var _m=0,og=0,Qm=0,E4=1e3,D_,lg,L_=0,rp=0,r1=0,yg=typeof performance=="object"&&performance.now?performance:Date,C4=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Xv(){return rp||(C4(AL),rp=yg.now()+r1)}function AL(){rp=0}function B_(){this._call=this._time=this._next=null}B_.prototype=T4.prototype={constructor:B_,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Xv():+n)+(t==null?0:+t),!this._next&&lg!==this&&(lg?lg._next=this:D_=this,lg=this),this._call=e,this._time=n,sv()},stop:function(){this._call&&(this._call=null,this._time=1/0,sv())}};function T4(e,t,n){var c=new B_;return c.restart(e,t,n),c}function fL(){Xv(),++_m;for(var e=D_,t;e;)(t=rp-e._time)>=0&&e._call.call(null,t),e=e._next;--_m}function Ab(){rp=(L_=yg.now())+r1,_m=og=0;try{fL()}finally{_m=0,pL(),rp=0}}function dL(){var e=yg.now(),t=e-L_;t>E4&&(r1-=t,L_=e)}function pL(){for(var e,t=D_,n,c=1/0;t;)t._call?(c>t._time&&(c=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:D_=n);lg=e,sv(c)}function sv(e){if(!_m){og&&(og=clearTimeout(og));var t=e-rp;t>24?(e<1/0&&(og=setTimeout(Ab,e-yg.now()-r1)),Qm&&(Qm=clearInterval(Qm))):(Qm||(L_=yg.now(),Qm=setInterval(dL,E4)),_m=1,C4(Ab))}}function fb(e,t,n){var c=new B_;return t=t==null?0:+t,c.restart(g=>{c.stop(),e(g+t)},t,n),c}var mL=t1("start","end","cancel","interrupt"),gL=[],k4=0,db=1,av=2,l_=3,pb=4,ov=5,u_=6;function s1(e,t,n,c,g,x){var S=e.__transition;if(!S)e.__transition={};else if(n in S)return;_L(e,n,{name:t,index:c,group:g,on:mL,tween:gL,time:x.time,delay:x.delay,duration:x.duration,ease:x.ease,timer:null,state:k4})}function Yv(e,t){var n=AA(e,t);if(n.state>k4)throw new Error("too late; already scheduled");return n}function sf(e,t){var n=AA(e,t);if(n.state>l_)throw new Error("too late; already running");return n}function AA(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function _L(e,t,n){var c=e.__transition,g;c[t]=n,n.timer=T4(x,0,n.time);function x(W){n.state=db,n.timer.restart(S,n.delay,n.time),n.delay<=W&&S(W-n.delay)}function S(W){var he,ae,ue,be;if(n.state!==db)return G();for(he in c)if(be=c[he],be.name===n.name){if(be.state===l_)return fb(S);be.state===pb?(be.state=u_,be.timer.stop(),be.on.call("interrupt",e,e.__data__,be.index,be.group),delete c[he]):+he<t&&(be.state=u_,be.timer.stop(),be.on.call("cancel",e,e.__data__,be.index,be.group),delete c[he])}if(fb(function(){n.state===l_&&(n.state=pb,n.timer.restart(a,n.delay,n.time),a(W))}),n.state=av,n.on.call("start",e,e.__data__,n.index,n.group),n.state===av){for(n.state=l_,g=new Array(ue=n.tween.length),he=0,ae=-1;he<ue;++he)(be=n.tween[he].value.call(e,e.__data__,n.index,n.group))&&(g[++ae]=be);g.length=ae+1}}function a(W){for(var he=W<n.duration?n.ease.call(null,W/n.duration):(n.timer.restart(G),n.state=ov,1),ae=-1,ue=g.length;++ae<ue;)g[ae].call(e,he);n.state===ov&&(n.on.call("end",e,e.__data__,n.index,n.group),G())}function G(){n.state=u_,n.timer.stop(),delete c[t];for(var W in c)return;delete e.__transition}}function Am(e,t){var n=e.__transition,c,g,x=!0,S;if(n){t=t==null?null:t+"";for(S in n){if((c=n[S]).name!==t){x=!1;continue}g=c.state>av&&c.state<ov,c.state=u_,c.timer.stop(),c.on.call(g?"interrupt":"cancel",e,e.__data__,c.index,c.group),delete n[S]}x&&delete e.__transition}}function yL(e){return this.each(function(){Am(this,e)})}function vL(e,t){var n,c;return function(){var g=sf(this,e),x=g.tween;if(x!==n){c=n=x;for(var S=0,a=c.length;S<a;++S)if(c[S].name===t){c=c.slice(),c.splice(S,1);break}}g.tween=c}}function xL(e,t,n){var c,g;if(typeof n!="function")throw new Error;return function(){var x=sf(this,e),S=x.tween;if(S!==c){g=(c=S).slice();for(var a={name:t,value:n},G=0,W=g.length;G<W;++G)if(g[G].name===t){g[G]=a;break}G===W&&g.push(a)}x.tween=g}}function bL(e,t){var n=this._id;if(e+="",arguments.length<2){for(var c=AA(this.node(),n).tween,g=0,x=c.length,S;g<x;++g)if((S=c[g]).name===e)return S.value;return null}return this.each((t==null?vL:xL)(n,e,t))}function Kv(e,t,n){var c=e._id;return e.each(function(){var g=sf(this,c);(g.value||(g.value={}))[t]=n.apply(this,arguments)}),function(g){return AA(g,c).value[t]}}function M4(e,t){var n;return(typeof t=="number"?uA:t instanceof np?P_:(n=np(t))?(t=n,P_):w4)(e,t)}function wL(e){return function(){this.removeAttribute(e)}}function SL(e){return function(){this.removeAttributeNS(e.space,e.local)}}function IL(e,t,n){var c,g=n+"",x;return function(){var S=this.getAttribute(e);return S===g?null:S===c?x:x=t(c=S,n)}}function EL(e,t,n){var c,g=n+"",x;return function(){var S=this.getAttributeNS(e.space,e.local);return S===g?null:S===c?x:x=t(c=S,n)}}function CL(e,t,n){var c,g,x;return function(){var S,a=n(this),G;return a==null?void this.removeAttribute(e):(S=this.getAttribute(e),G=a+"",S===G?null:S===c&&G===g?x:(g=G,x=t(c=S,a)))}}function TL(e,t,n){var c,g,x;return function(){var S,a=n(this),G;return a==null?void this.removeAttributeNS(e.space,e.local):(S=this.getAttributeNS(e.space,e.local),G=a+"",S===G?null:S===c&&G===g?x:(g=G,x=t(c=S,a)))}}function kL(e,t){var n=i1(e),c=n==="transform"?oL:M4;return this.attrTween(e,typeof t=="function"?(n.local?TL:CL)(n,c,Kv(this,"attr."+e,t)):t==null?(n.local?SL:wL)(n):(n.local?EL:IL)(n,c,t))}function ML(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function PL(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function DL(e,t){var n,c;function g(){var x=t.apply(this,arguments);return x!==c&&(n=(c=x)&&PL(e,x)),n}return g._value=t,g}function LL(e,t){var n,c;function g(){var x=t.apply(this,arguments);return x!==c&&(n=(c=x)&&ML(e,x)),n}return g._value=t,g}function BL(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var c=i1(e);return this.tween(n,(c.local?DL:LL)(c,t))}function zL(e,t){return function(){Yv(this,e).delay=+t.apply(this,arguments)}}function RL(e,t){return t=+t,function(){Yv(this,e).delay=t}}function FL(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?zL:RL)(t,e)):AA(this.node(),t).delay}function OL(e,t){return function(){sf(this,e).duration=+t.apply(this,arguments)}}function NL(e,t){return t=+t,function(){sf(this,e).duration=t}}function VL(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?OL:NL)(t,e)):AA(this.node(),t).duration}function UL(e,t){if(typeof t!="function")throw new Error;return function(){sf(this,e).ease=t}}function GL(e){var t=this._id;return arguments.length?this.each(UL(t,e)):AA(this.node(),t).ease}function qL(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;sf(this,e).ease=n}}function HL(e){if(typeof e!="function")throw new Error;return this.each(qL(this._id,e))}function jL(e){typeof e!="function"&&(e=l4(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var x=t[g],S=x.length,a=c[g]=[],G,W=0;W<S;++W)(G=x[W])&&e.call(G,G.__data__,W,x)&&a.push(G);return new n0(c,this._parents,this._name,this._id)}function ZL(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,c=t.length,g=n.length,x=Math.min(c,g),S=new Array(c),a=0;a<x;++a)for(var G=t[a],W=n[a],he=G.length,ae=S[a]=new Array(he),ue,be=0;be<he;++be)(ue=G[be]||W[be])&&(ae[be]=ue);for(;a<c;++a)S[a]=t[a];return new n0(S,this._parents,this._name,this._id)}function QL(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function WL(e,t,n){var c,g,x=QL(t)?Yv:sf;return function(){var S=x(this,e),a=S.on;a!==c&&(g=(c=a).copy()).on(t,n),S.on=g}}function $L(e,t){var n=this._id;return arguments.length<2?AA(this.node(),n).on.on(e):this.each(WL(n,e,t))}function XL(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function YL(){return this.on("end.remove",XL(this._id))}function KL(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Zv(e));for(var c=this._groups,g=c.length,x=new Array(g),S=0;S<g;++S)for(var a=c[S],G=a.length,W=x[S]=new Array(G),he,ae,ue=0;ue<G;++ue)(he=a[ue])&&(ae=e.call(he,he.__data__,ue,a))&&("__data__"in he&&(ae.__data__=he.__data__),W[ue]=ae,s1(W[ue],t,n,ue,W,AA(he,n)));return new n0(x,this._parents,t,n)}function JL(e){var t=this._name,n=this._id;typeof e!="function"&&(e=o4(e));for(var c=this._groups,g=c.length,x=[],S=[],a=0;a<g;++a)for(var G=c[a],W=G.length,he,ae=0;ae<W;++ae)if(he=G[ae]){for(var ue=e.call(he,he.__data__,ae,G),be,je=AA(he,n),nt=0,tt=ue.length;nt<tt;++nt)(be=ue[nt])&&s1(be,t,n,nt,ue,je);x.push(ue),S.push(he)}return new n0(x,S,t,n)}var eB=Pg.prototype.constructor;function tB(){return new eB(this._groups,this._parents)}function iB(e,t){var n,c,g;return function(){var x=gm(this,e),S=(this.style.removeProperty(e),gm(this,e));return x===S?null:x===n&&S===c?g:g=t(n=x,c=S)}}function P4(e){return function(){this.style.removeProperty(e)}}function nB(e,t,n){var c,g=n+"",x;return function(){var S=gm(this,e);return S===g?null:S===c?x:x=t(c=S,n)}}function rB(e,t,n){var c,g,x;return function(){var S=gm(this,e),a=n(this),G=a+"";return a==null&&(G=a=(this.style.removeProperty(e),gm(this,e))),S===G?null:S===c&&G===g?x:(g=G,x=t(c=S,a))}}function sB(e,t){var n,c,g,x="style."+t,S="end."+x,a;return function(){var G=sf(this,e),W=G.on,he=G.value[x]==null?a||(a=P4(t)):void 0;(W!==n||g!==he)&&(c=(n=W).copy()).on(S,g=he),G.on=c}}function aB(e,t,n){var c=(e+="")=="transform"?aL:M4;return t==null?this.styleTween(e,iB(e,c)).on("end.style."+e,P4(e)):typeof t=="function"?this.styleTween(e,rB(e,c,Kv(this,"style."+e,t))).each(sB(this._id,e)):this.styleTween(e,nB(e,c,t),n).on("end.style."+e,null)}function oB(e,t,n){return function(c){this.style.setProperty(e,t.call(this,c),n)}}function lB(e,t,n){var c,g;function x(){var S=t.apply(this,arguments);return S!==g&&(c=(g=S)&&oB(e,S,n)),c}return x._value=t,x}function uB(e,t,n){var c="style."+(e+="");if(arguments.length<2)return(c=this.tween(c))&&c._value;if(t==null)return this.tween(c,null);if(typeof t!="function")throw new Error;return this.tween(c,lB(e,t,n??""))}function cB(e){return function(){this.textContent=e}}function hB(e){return function(){var t=e(this);this.textContent=t??""}}function AB(e){return this.tween("text",typeof e=="function"?hB(Kv(this,"text",e)):cB(e==null?"":e+""))}function fB(e){return function(t){this.textContent=e.call(this,t)}}function dB(e){var t,n;function c(){var g=e.apply(this,arguments);return g!==n&&(t=(n=g)&&fB(g)),t}return c._value=e,c}function pB(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,dB(e))}function mB(){for(var e=this._name,t=this._id,n=D4(),c=this._groups,g=c.length,x=0;x<g;++x)for(var S=c[x],a=S.length,G,W=0;W<a;++W)if(G=S[W]){var he=AA(G,t);s1(G,e,n,W,S,{time:he.time+he.delay+he.duration,delay:0,duration:he.duration,ease:he.ease})}return new n0(c,this._parents,e,n)}function gB(){var e,t,n=this,c=n._id,g=n.size();return new Promise(function(x,S){var a={value:S},G={value:function(){--g===0&&x()}};n.each(function(){var W=sf(this,c),he=W.on;he!==e&&(t=(e=he).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(G)),W.on=t}),g===0&&x()})}var _B=0;function n0(e,t,n,c){this._groups=e,this._parents=t,this._name=n,this._id=c}function D4(){return++_B}var qd=Pg.prototype;n0.prototype={constructor:n0,select:KL,selectAll:JL,filter:jL,merge:ZL,selection:tB,transition:mB,call:qd.call,nodes:qd.nodes,node:qd.node,size:qd.size,empty:qd.empty,each:qd.each,on:$L,attr:kL,attrTween:BL,style:aB,styleTween:uB,text:AB,textTween:pB,remove:YL,tween:bL,delay:FL,duration:VL,ease:GL,easeVarying:HL,end:gB,[Symbol.iterator]:qd[Symbol.iterator]};function yB(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var vB={time:null,delay:0,duration:250,ease:yB};function xB(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function bB(e){var t,n;e instanceof n0?(t=e._id,e=e._name):(t=D4(),(n=vB).time=Xv(),e=e==null?null:e+"");for(var c=this._groups,g=c.length,x=0;x<g;++x)for(var S=c[x],a=S.length,G,W=0;W<a;++W)(G=S[W])&&s1(G,e,t,W,S,n||xB(G,t));return new n0(c,this._parents,e,t)}Pg.prototype.interrupt=yL;Pg.prototype.transition=bB;const Z1=e=>()=>e;function wB(e,{sourceEvent:t,target:n,selection:c,mode:g,dispatch:x}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:c,enumerable:!0,configurable:!0},mode:{value:g,enumerable:!0,configurable:!0},_:{value:x}})}function SB(e){e.stopImmediatePropagation()}function Q1(e){e.preventDefault(),e.stopImmediatePropagation()}var mb={name:"drag"},W1={name:"space"},Wp={name:"handle"},$p={name:"center"};const{abs:gb,max:Ku,min:Ju}=Math;function _b(e){return[+e[0],+e[1]]}function lv(e){return[_b(e[0]),_b(e[1])]}var $1={name:"x",handles:["w","e"].map(vg),input:function(e,t){return e==null?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},X1={name:"y",handles:["n","s"].map(vg),input:function(e,t){return e==null?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},IB={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(vg),input:function(e){return e==null?null:lv(e)},output:function(e){return e}},Wf={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},yb={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},vb={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},EB={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},CB={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function vg(e){return{type:e}}function TB(e){return!e.ctrlKey&&!e.button}function kB(){var e=this.ownerSVGElement||this;return e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function MB(){return navigator.maxTouchPoints||"ontouchstart"in this}function Y1(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function PB(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}function DB(){return LB(IB)}function LB(e){var t=kB,n=TB,c=MB,g=!0,x=t1("start","brush","end"),S=6,a;function G(tt){var at=tt.property("__brush",nt).selectAll(".overlay").data([vg("overlay")]);at.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Wf.overlay).merge(at).each(function(){var xt=Y1(this).extent;dl(this).attr("x",xt[0][0]).attr("y",xt[0][1]).attr("width",xt[1][0]-xt[0][0]).attr("height",xt[1][1]-xt[0][1])}),tt.selectAll(".selection").data([vg("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Wf.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var ut=tt.selectAll(".handle").data(e.handles,function(xt){return xt.type});ut.exit().remove(),ut.enter().append("rect").attr("class",function(xt){return"handle handle--"+xt.type}).attr("cursor",function(xt){return Wf[xt.type]}),tt.each(W).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",ue).filter(c).on("touchstart.brush",ue).on("touchmove.brush",be).on("touchend.brush touchcancel.brush",je).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}G.move=function(tt,at){tt.tween?tt.on("start.brush",function(ut){he(this,arguments).beforestart().start(ut)}).on("interrupt.brush end.brush",function(ut){he(this,arguments).end(ut)}).tween("brush",function(){var ut=this,xt=ut.__brush,Tt=he(ut,arguments),Mt=xt.selection,Oe=e.input(typeof at=="function"?at.apply(this,arguments):at,xt.extent),jt=n1(Mt,Oe);function it(vt){xt.selection=vt===1&&Oe===null?null:jt(vt),W.call(ut),Tt.brush()}return Mt!==null&&Oe!==null?it:it(1)}):tt.each(function(){var ut=this,xt=arguments,Tt=ut.__brush,Mt=e.input(typeof at=="function"?at.apply(ut,xt):at,Tt.extent),Oe=he(ut,xt).beforestart();Am(ut),Tt.selection=Mt===null?null:Mt,W.call(ut),Oe.start().brush().end()})},G.clear=function(tt){G.move(tt,null)};function W(){var tt=dl(this),at=Y1(this).selection;at?(tt.selectAll(".selection").style("display",null).attr("x",at[0][0]).attr("y",at[0][1]).attr("width",at[1][0]-at[0][0]).attr("height",at[1][1]-at[0][1]),tt.selectAll(".handle").style("display",null).attr("x",function(ut){return ut.type[ut.type.length-1]==="e"?at[1][0]-S/2:at[0][0]-S/2}).attr("y",function(ut){return ut.type[0]==="s"?at[1][1]-S/2:at[0][1]-S/2}).attr("width",function(ut){return ut.type==="n"||ut.type==="s"?at[1][0]-at[0][0]+S:S}).attr("height",function(ut){return ut.type==="e"||ut.type==="w"?at[1][1]-at[0][1]+S:S})):tt.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function he(tt,at,ut){var xt=tt.__brush.emitter;return xt&&(!ut||!xt.clean)?xt:new ae(tt,at,ut)}function ae(tt,at,ut){this.that=tt,this.args=at,this.state=tt.__brush,this.active=0,this.clean=ut}ae.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(tt,at){return this.starting?(this.starting=!1,this.emit("start",tt,at)):this.emit("brush",tt),this},brush:function(tt,at){return this.emit("brush",tt,at),this},end:function(tt,at){return--this.active===0&&(delete this.state.emitter,this.emit("end",tt,at)),this},emit:function(tt,at,ut){var xt=dl(this.that).datum();x.call(tt,this.that,new wB(tt,{sourceEvent:at,target:G,selection:e.output(this.state.selection),mode:ut,dispatch:x}),xt)}};function ue(tt){if(a&&!tt.touches||!n.apply(this,arguments))return;var at=this,ut=tt.target.__data__.type,xt=(g&&tt.metaKey?ut="overlay":ut)==="selection"?mb:g&&tt.altKey?$p:Wp,Tt=e===X1?null:EB[ut],Mt=e===$1?null:CB[ut],Oe=Y1(at),jt=Oe.extent,it=Oe.selection,vt=jt[0][0],mt,Et,Pt=jt[0][1],dt,Je,pt=jt[1][0],lt,Nt,zt=jt[1][1],Ot,gi,wi=0,Ti=0,Ni,en=Tt&&Mt&&g&&tt.shiftKey,ji,Vi,nn=Array.from(tt.touches||[tt],ei=>{const _n=ei.identifier;return ei=Yf(ei,at),ei.point0=ei.slice(),ei.identifier=_n,ei});if(ut==="overlay"){it&&(Ni=!0);const ei=[nn[0],nn[1]||nn[0]];Oe.selection=it=[[mt=e===X1?vt:Ju(ei[0][0],ei[1][0]),dt=e===$1?Pt:Ju(ei[0][1],ei[1][1])],[lt=e===X1?pt:Ku(ei[0][0],ei[1][0]),Ot=e===$1?zt:Ku(ei[0][1],ei[1][1])]],nn.length>1&&_i()}else mt=it[0][0],dt=it[0][1],lt=it[1][0],Ot=it[1][1];Et=mt,Je=dt,Nt=lt,gi=Ot;var vn=dl(at).attr("pointer-events","none"),Ci=vn.selectAll(".overlay").attr("cursor",Wf[ut]);Am(at);var mi=he(at,arguments,!0).beforestart();if(tt.touches)mi.moved=Oi,mi.ended=Ji;else{var Ri=dl(tt.view).on("mousemove.brush",Oi,!0).on("mouseup.brush",Ji,!0);g&&Ri.on("keydown.brush",Ai,!0).on("keyup.brush",sn,!0),_4(tt.view)}W.call(at),mi.start(tt,xt.name);function Oi(ei){for(const _n of ei.changedTouches||[ei])for(const Pr of nn)Pr.identifier===_n.identifier&&(Pr.cur=Yf(_n,at));if(en&&!ji&&!Vi&&nn.length===1){const _n=nn[0];gb(_n.cur[0]-_n[0])>gb(_n.cur[1]-_n[1])?Vi=!0:ji=!0}for(const _n of nn)_n.cur&&(_n[0]=_n.cur[0],_n[1]=_n.cur[1]);Ni=!0,Q1(ei),_i(ei)}function _i(ei){const _n=nn[0],Pr=_n.point0;var ci;switch(wi=_n[0]-Pr[0],Ti=_n[1]-Pr[1],xt){case W1:case mb:{Tt&&(wi=Ku(vt-mt,Ju(pt-lt,wi)),Et=mt+wi,Nt=lt+wi),Mt&&(Ti=Ku(Pt-dt,Ju(zt-Ot,Ti)),Je=dt+Ti,gi=Ot+Ti);break}case Wp:{nn[1]?(Tt&&(Et=Ku(vt,Ju(pt,nn[0][0])),Nt=Ku(vt,Ju(pt,nn[1][0])),Tt=1),Mt&&(Je=Ku(Pt,Ju(zt,nn[0][1])),gi=Ku(Pt,Ju(zt,nn[1][1])),Mt=1)):(Tt<0?(wi=Ku(vt-mt,Ju(pt-mt,wi)),Et=mt+wi,Nt=lt):Tt>0&&(wi=Ku(vt-lt,Ju(pt-lt,wi)),Et=mt,Nt=lt+wi),Mt<0?(Ti=Ku(Pt-dt,Ju(zt-dt,Ti)),Je=dt+Ti,gi=Ot):Mt>0&&(Ti=Ku(Pt-Ot,Ju(zt-Ot,Ti)),Je=dt,gi=Ot+Ti));break}case $p:{Tt&&(Et=Ku(vt,Ju(pt,mt-wi*Tt)),Nt=Ku(vt,Ju(pt,lt+wi*Tt))),Mt&&(Je=Ku(Pt,Ju(zt,dt-Ti*Mt)),gi=Ku(Pt,Ju(zt,Ot+Ti*Mt)));break}}Nt<Et&&(Tt*=-1,ci=mt,mt=lt,lt=ci,ci=Et,Et=Nt,Nt=ci,ut in yb&&Ci.attr("cursor",Wf[ut=yb[ut]])),gi<Je&&(Mt*=-1,ci=dt,dt=Ot,Ot=ci,ci=Je,Je=gi,gi=ci,ut in vb&&Ci.attr("cursor",Wf[ut=vb[ut]])),Oe.selection&&(it=Oe.selection),ji&&(Et=it[0][0],Nt=it[1][0]),Vi&&(Je=it[0][1],gi=it[1][1]),(it[0][0]!==Et||it[0][1]!==Je||it[1][0]!==Nt||it[1][1]!==gi)&&(Oe.selection=[[Et,Je],[Nt,gi]],W.call(at),mi.brush(ei,xt.name))}function Ji(ei){if(SB(ei),ei.touches){if(ei.touches.length)return;a&&clearTimeout(a),a=setTimeout(function(){a=null},500)}else y4(ei.view,Ni),Ri.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);vn.attr("pointer-events","all"),Ci.attr("cursor",Wf.overlay),Oe.selection&&(it=Oe.selection),PB(it)&&(Oe.selection=null,W.call(at)),mi.end(ei,xt.name)}function Ai(ei){switch(ei.keyCode){case 16:{en=Tt&&Mt;break}case 18:{xt===Wp&&(Tt&&(lt=Nt-wi*Tt,mt=Et+wi*Tt),Mt&&(Ot=gi-Ti*Mt,dt=Je+Ti*Mt),xt=$p,_i());break}case 32:{(xt===Wp||xt===$p)&&(Tt<0?lt=Nt-wi:Tt>0&&(mt=Et-wi),Mt<0?Ot=gi-Ti:Mt>0&&(dt=Je-Ti),xt=W1,Ci.attr("cursor",Wf.selection),_i());break}default:return}Q1(ei)}function sn(ei){switch(ei.keyCode){case 16:{en&&(ji=Vi=en=!1,_i());break}case 18:{xt===$p&&(Tt<0?lt=Nt:Tt>0&&(mt=Et),Mt<0?Ot=gi:Mt>0&&(dt=Je),xt=Wp,_i());break}case 32:{xt===W1&&(ei.altKey?(Tt&&(lt=Nt-wi*Tt,mt=Et+wi*Tt),Mt&&(Ot=gi-Ti*Mt,dt=Je+Ti*Mt),xt=$p):(Tt<0?lt=Nt:Tt>0&&(mt=Et),Mt<0?Ot=gi:Mt>0&&(dt=Je),xt=Wp),Ci.attr("cursor",Wf[ut]),_i());break}default:return}Q1(ei)}}function be(tt){he(this,arguments).moved(tt)}function je(tt){he(this,arguments).ended(tt)}function nt(){var tt=this.__brush||{selection:null};return tt.extent=lv(t.apply(this,arguments)),tt.dim=e,tt}return G.extent=function(tt){return arguments.length?(t=typeof tt=="function"?tt:Z1(lv(tt)),G):t},G.filter=function(tt){return arguments.length?(n=typeof tt=="function"?tt:Z1(!!tt),G):n},G.touchable=function(tt){return arguments.length?(c=typeof tt=="function"?tt:Z1(!!tt),G):c},G.handleSize=function(tt){return arguments.length?(S=+tt,G):S},G.keyModifiers=function(tt){return arguments.length?(g=!!tt,G):g},G.on=function(){var tt=x.on.apply(x,arguments);return tt===x?G:tt},G}const uv=Math.PI,cv=2*uv,Zd=1e-6,BB=cv-Zd;function hv(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function L4(){return new hv}hv.prototype=L4.prototype={constructor:hv,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,c){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+c)},bezierCurveTo:function(e,t,n,c,g,x){this._+="C"+ +e+","+ +t+","+ +n+","+ +c+","+(this._x1=+g)+","+(this._y1=+x)},arcTo:function(e,t,n,c,g){e=+e,t=+t,n=+n,c=+c,g=+g;var x=this._x1,S=this._y1,a=n-e,G=c-t,W=x-e,he=S-t,ae=W*W+he*he;if(g<0)throw new Error("negative radius: "+g);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(ae>Zd)if(!(Math.abs(he*a-G*W)>Zd)||!g)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var ue=n-x,be=c-S,je=a*a+G*G,nt=ue*ue+be*be,tt=Math.sqrt(je),at=Math.sqrt(ae),ut=g*Math.tan((uv-Math.acos((je+ae-nt)/(2*tt*at)))/2),xt=ut/at,Tt=ut/tt;Math.abs(xt-1)>Zd&&(this._+="L"+(e+xt*W)+","+(t+xt*he)),this._+="A"+g+","+g+",0,0,"+ +(he*ue>W*be)+","+(this._x1=e+Tt*a)+","+(this._y1=t+Tt*G)}},arc:function(e,t,n,c,g,x){e=+e,t=+t,n=+n,x=!!x;var S=n*Math.cos(c),a=n*Math.sin(c),G=e+S,W=t+a,he=1^x,ae=x?c-g:g-c;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+G+","+W:(Math.abs(this._x1-G)>Zd||Math.abs(this._y1-W)>Zd)&&(this._+="L"+G+","+W),n&&(ae<0&&(ae=ae%cv+cv),ae>BB?this._+="A"+n+","+n+",0,1,"+he+","+(e-S)+","+(t-a)+"A"+n+","+n+",0,1,"+he+","+(this._x1=G)+","+(this._y1=W):ae>Zd&&(this._+="A"+n+","+n+",0,"+ +(ae>=uv)+","+he+","+(this._x1=e+n*Math.cos(g))+","+(this._y1=t+n*Math.sin(g))))},rect:function(e,t,n,c){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +c+"h"+-n+"Z"},toString:function(){return this._}};function zB(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function z_(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,c=e.slice(0,n);return[c.length>1?c[0]+c.slice(2):c,+e.slice(n+1)]}function ym(e){return e=z_(Math.abs(e)),e?e[1]:NaN}function RB(e,t){return function(n,c){for(var g=n.length,x=[],S=0,a=e[0],G=0;g>0&&a>0&&(G+a+1>c&&(a=Math.max(1,c-G)),x.push(n.substring(g-=a,g+a)),!((G+=a+1)>c));)a=e[S=(S+1)%e.length];return x.reverse().join(t)}}function FB(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var OB=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function R_(e){if(!(t=OB.exec(e)))throw new Error("invalid format: "+e);var t;return new Jv({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}R_.prototype=Jv.prototype;function Jv(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Jv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function NB(e){e:for(var t=e.length,n=1,c=-1,g;n<t;++n)switch(e[n]){case".":c=g=n;break;case"0":c===0&&(c=n),g=n;break;default:if(!+e[n])break e;c>0&&(c=0);break}return c>0?e.slice(0,c)+e.slice(g+1):e}var B4;function VB(e,t){var n=z_(e,t);if(!n)return e+"";var c=n[0],g=n[1],x=g-(B4=Math.max(-8,Math.min(8,Math.floor(g/3)))*3)+1,S=c.length;return x===S?c:x>S?c+new Array(x-S+1).join("0"):x>0?c.slice(0,x)+"."+c.slice(x):"0."+new Array(1-x).join("0")+z_(e,Math.max(0,t+x-1))[0]}function xb(e,t){var n=z_(e,t);if(!n)return e+"";var c=n[0],g=n[1];return g<0?"0."+new Array(-g).join("0")+c:c.length>g+1?c.slice(0,g+1)+"."+c.slice(g+1):c+new Array(g-c.length+2).join("0")}const bb={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:zB,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>xb(e*100,t),r:xb,s:VB,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function wb(e){return e}var Sb=Array.prototype.map,Ib=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function UB(e){var t=e.grouping===void 0||e.thousands===void 0?wb:RB(Sb.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",c=e.currency===void 0?"":e.currency[1]+"",g=e.decimal===void 0?".":e.decimal+"",x=e.numerals===void 0?wb:FB(Sb.call(e.numerals,String)),S=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"":e.minus+"",G=e.nan===void 0?"NaN":e.nan+"";function W(ae){ae=R_(ae);var ue=ae.fill,be=ae.align,je=ae.sign,nt=ae.symbol,tt=ae.zero,at=ae.width,ut=ae.comma,xt=ae.precision,Tt=ae.trim,Mt=ae.type;Mt==="n"?(ut=!0,Mt="g"):bb[Mt]||(xt===void 0&&(xt=12),Tt=!0,Mt="g"),(tt||ue==="0"&&be==="=")&&(tt=!0,ue="0",be="=");var Oe=nt==="$"?n:nt==="#"&&/[boxX]/.test(Mt)?"0"+Mt.toLowerCase():"",jt=nt==="$"?c:/[%p]/.test(Mt)?S:"",it=bb[Mt],vt=/[defgprs%]/.test(Mt);xt=xt===void 0?6:/[gprs]/.test(Mt)?Math.max(1,Math.min(21,xt)):Math.max(0,Math.min(20,xt));function mt(Et){var Pt=Oe,dt=jt,Je,pt,lt;if(Mt==="c")dt=it(Et)+dt,Et="";else{Et=+Et;var Nt=Et<0||1/Et<0;if(Et=isNaN(Et)?G:it(Math.abs(Et),xt),Tt&&(Et=NB(Et)),Nt&&+Et==0&&je!=="+"&&(Nt=!1),Pt=(Nt?je==="("?je:a:je==="-"||je==="("?"":je)+Pt,dt=(Mt==="s"?Ib[8+B4/3]:"")+dt+(Nt&&je==="("?")":""),vt){for(Je=-1,pt=Et.length;++Je<pt;)if(lt=Et.charCodeAt(Je),48>lt||lt>57){dt=(lt===46?g+Et.slice(Je+1):Et.slice(Je))+dt,Et=Et.slice(0,Je);break}}}ut&&!tt&&(Et=t(Et,1/0));var zt=Pt.length+Et.length+dt.length,Ot=zt<at?new Array(at-zt+1).join(ue):"";switch(ut&&tt&&(Et=t(Ot+Et,Ot.length?at-dt.length:1/0),Ot=""),be){case"<":Et=Pt+Et+dt+Ot;break;case"=":Et=Pt+Ot+Et+dt;break;case"^":Et=Ot.slice(0,zt=Ot.length>>1)+Pt+Et+dt+Ot.slice(zt);break;default:Et=Ot+Pt+Et+dt;break}return x(Et)}return mt.toString=function(){return ae+""},mt}function he(ae,ue){var be=W((ae=R_(ae),ae.type="f",ae)),je=Math.max(-8,Math.min(8,Math.floor(ym(ue)/3)))*3,nt=Math.pow(10,-je),tt=Ib[8+je/3];return function(at){return be(nt*at)+tt}}return{format:W,formatPrefix:he}}var Xg,e2,z4;GB({thousands:",",grouping:[3],currency:["$",""]});function GB(e){return Xg=UB(e),e2=Xg.format,z4=Xg.formatPrefix,Xg}function qB(e){return Math.max(0,-ym(Math.abs(e)))}function HB(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ym(t)/3)))*3-ym(Math.abs(e)))}function jB(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ym(t)-ym(e))+1}function ZB(e){var t=0,n=e.children,c=n&&n.length;if(!c)t=1;else for(;--c>=0;)t+=n[c].value;e.value=t}function QB(){return this.eachAfter(ZB)}function WB(e,t){let n=-1;for(const c of this)e.call(t,c,++n,this);return this}function $B(e,t){for(var n=this,c=[n],g,x,S=-1;n=c.pop();)if(e.call(t,n,++S,this),g=n.children)for(x=g.length-1;x>=0;--x)c.push(g[x]);return this}function XB(e,t){for(var n=this,c=[n],g=[],x,S,a,G=-1;n=c.pop();)if(g.push(n),x=n.children)for(S=0,a=x.length;S<a;++S)c.push(x[S]);for(;n=g.pop();)e.call(t,n,++G,this);return this}function YB(e,t){let n=-1;for(const c of this)if(e.call(t,c,++n,this))return c}function KB(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,c=t.children,g=c&&c.length;--g>=0;)n+=c[g].value;t.value=n})}function JB(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function e7(e){for(var t=this,n=t7(t,e),c=[t];t!==n;)t=t.parent,c.push(t);for(var g=c.length;e!==n;)c.splice(g,0,e),e=e.parent;return c}function t7(e,t){if(e===t)return e;var n=e.ancestors(),c=t.ancestors(),g=null;for(e=n.pop(),t=c.pop();e===t;)g=e,e=n.pop(),t=c.pop();return g}function i7(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function n7(){return Array.from(this)}function r7(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function s7(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*a7(){var e=this,t,n=[e],c,g,x;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,c=e.children)for(g=0,x=c.length;g<x;++g)n.push(c[g]);while(n.length)}function Yd(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=u7)):t===void 0&&(t=l7);for(var n=new F_(e),c,g=[n],x,S,a,G;c=g.pop();)if((S=t(c.data))&&(G=(S=Array.from(S)).length))for(c.children=S,a=G-1;a>=0;--a)g.push(x=S[a]=new F_(S[a])),x.parent=c,x.depth=c.depth+1;return n.eachBefore(h7)}function o7(){return Yd(this).eachBefore(c7)}function l7(e){return e.children}function u7(e){return Array.isArray(e)?e[1]:null}function c7(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function h7(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function F_(e){this.data=e,this.depth=this.height=0,this.parent=null}F_.prototype=Yd.prototype={constructor:F_,count:QB,each:WB,eachAfter:XB,eachBefore:$B,find:YB,sum:KB,sort:JB,path:e7,ancestors:i7,descendants:n7,leaves:r7,links:s7,copy:o7,[Symbol.iterator]:a7};function A7(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function f7(e){return function(){return e}}function d7(e){return+e}var Eb=[0,1];function nm(e){return e}function Av(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:f7(isNaN(t)?NaN:.5)}function p7(e,t){var n;return e>t&&(n=e,e=t,t=n),function(c){return Math.max(e,Math.min(t,c))}}function m7(e,t,n){var c=e[0],g=e[1],x=t[0],S=t[1];return g<c?(c=Av(g,c),x=n(S,x)):(c=Av(c,g),x=n(x,S)),function(a){return x(c(a))}}function g7(e,t,n){var c=Math.min(e.length,t.length)-1,g=new Array(c),x=new Array(c),S=-1;for(e[c]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++S<c;)g[S]=Av(e[S],e[S+1]),x[S]=n(t[S],t[S+1]);return function(a){var G=HM(e,a,1,c)-1;return x[G](g[G](a))}}function _7(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function y7(){var e=Eb,t=Eb,n=n1,c,g,x,S=nm,a,G,W;function he(){var ue=Math.min(e.length,t.length);return S!==nm&&(S=p7(e[0],e[ue-1])),a=ue>2?g7:m7,G=W=null,ae}function ae(ue){return ue==null||isNaN(ue=+ue)?x:(G||(G=a(e.map(c),t,n)))(c(S(ue)))}return ae.invert=function(ue){return S(g((W||(W=a(t,e.map(c),uA)))(ue)))},ae.domain=function(ue){return arguments.length?(e=Array.from(ue,d7),he()):e.slice()},ae.range=function(ue){return arguments.length?(t=Array.from(ue),he()):t.slice()},ae.rangeRound=function(ue){return t=Array.from(ue),n=nL,he()},ae.clamp=function(ue){return arguments.length?(S=ue?!0:nm,he()):S!==nm},ae.interpolate=function(ue){return arguments.length?(n=ue,he()):n},ae.unknown=function(ue){return arguments.length?(x=ue,ae):x},function(ue,be){return c=ue,g=be,he()}}function v7(){return y7()(nm,nm)}function x7(e,t,n,c){var g=ZM(e,t,n),x;switch(c=R_(c??",f"),c.type){case"s":{var S=Math.max(Math.abs(e),Math.abs(t));return c.precision==null&&!isNaN(x=HB(g,S))&&(c.precision=x),z4(c,S)}case"":case"e":case"g":case"p":case"r":{c.precision==null&&!isNaN(x=jB(g,Math.max(Math.abs(e),Math.abs(t))))&&(c.precision=x-(c.type==="e"));break}case"f":case"%":{c.precision==null&&!isNaN(x=qB(g))&&(c.precision=x-(c.type==="%")*2);break}}return e2(c)}function b7(e){var t=e.domain;return e.ticks=function(n){var c=t();return jM(c[0],c[c.length-1],n??10)},e.tickFormat=function(n,c){var g=t();return x7(g[0],g[g.length-1],n??10,c)},e.nice=function(n){n==null&&(n=10);var c=t(),g=0,x=c.length-1,S=c[g],a=c[x],G,W,he=10;for(a<S&&(W=S,S=a,a=W,W=g,g=x,x=W);he-- >0;){if(W=s4(S,a,n),W===G)return c[g]=S,c[x]=a,t(c);if(W>0)S=Math.floor(S/W)*W,a=Math.ceil(a/W)*W;else if(W<0)S=Math.ceil(S*W)/W,a=Math.floor(a*W)/W;else break;G=W}return e},e}function R4(){var e=v7();return e.copy=function(){return _7(e,R4())},A7.apply(e,arguments),b7(e)}var K1=new Date,J1=new Date;function o0(e,t,n,c){function g(x){return e(x=arguments.length===0?new Date:new Date(+x)),x}return g.floor=function(x){return e(x=new Date(+x)),x},g.ceil=function(x){return e(x=new Date(x-1)),t(x,1),e(x),x},g.round=function(x){var S=g(x),a=g.ceil(x);return x-S<a-x?S:a},g.offset=function(x,S){return t(x=new Date(+x),S==null?1:Math.floor(S)),x},g.range=function(x,S,a){var G=[],W;if(x=g.ceil(x),a=a==null?1:Math.floor(a),!(x<S)||!(a>0))return G;do G.push(W=new Date(+x)),t(x,a),e(x);while(W<x&&x<S);return G},g.filter=function(x){return o0(function(S){if(S>=S)for(;e(S),!x(S);)S.setTime(S-1)},function(S,a){if(S>=S)if(a<0)for(;++a<=0;)for(;t(S,-1),!x(S););else for(;--a>=0;)for(;t(S,1),!x(S););})},n&&(g.count=function(x,S){return K1.setTime(+x),J1.setTime(+S),e(K1),e(J1),Math.floor(n(K1,J1))},g.every=function(x){return x=Math.floor(x),!isFinite(x)||!(x>0)?null:x>1?g.filter(c?function(S){return c(S)%x===0}:function(S){return g.count(0,S)%x===0}):g}),g}const w7=1e3,t2=w7*60,S7=t2*60,i2=S7*24,F4=i2*7;var n2=o0(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*t2)/i2,e=>e.getDate()-1);n2.range;function hp(e){return o0(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*t2)/F4})}var O4=hp(0),O_=hp(1),I7=hp(2),E7=hp(3),vm=hp(4),C7=hp(5),T7=hp(6);O4.range;O_.range;I7.range;E7.range;vm.range;C7.range;T7.range;var sp=o0(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});sp.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:o0(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};sp.range;var r2=o0(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/i2},function(e){return e.getUTCDate()-1});r2.range;function Ap(e){return o0(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/F4})}var N4=Ap(0),N_=Ap(1),k7=Ap(2),M7=Ap(3),xm=Ap(4),P7=Ap(5),D7=Ap(6);N4.range;N_.range;k7.range;M7.range;xm.range;P7.range;D7.range;var ap=o0(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});ap.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:o0(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};ap.range;function ey(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function ty(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Wm(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function L7(e){var t=e.dateTime,n=e.date,c=e.time,g=e.periods,x=e.days,S=e.shortDays,a=e.months,G=e.shortMonths,W=$m(g),he=Xm(g),ae=$m(x),ue=Xm(x),be=$m(S),je=Xm(S),nt=$m(a),tt=Xm(a),at=$m(G),ut=Xm(G),xt={a:Nt,A:zt,b:Ot,B:gi,c:null,d:Db,e:Db,f:iz,g:Az,G:dz,H:J7,I:ez,j:tz,L:V4,m:nz,M:rz,p:wi,q:Ti,Q:zb,s:Rb,S:sz,u:az,U:oz,V:lz,w:uz,W:cz,x:null,X:null,y:hz,Y:fz,Z:pz,"%":Bb},Tt={a:Ni,A:en,b:ji,B:Vi,c:null,d:Lb,e:Lb,f:yz,g:kz,G:Pz,H:mz,I:gz,j:_z,L:G4,m:vz,M:xz,p:nn,q:vn,Q:zb,s:Rb,S:bz,u:wz,U:Sz,V:Iz,w:Ez,W:Cz,x:null,X:null,y:Tz,Y:Mz,Z:Dz,"%":Bb},Mt={a:mt,A:Et,b:Pt,B:dt,c:Je,d:Mb,e:Mb,f:$7,g:kb,G:Tb,H:Pb,I:Pb,j:j7,L:W7,m:H7,M:Z7,p:vt,q:q7,Q:Y7,s:K7,S:Q7,u:O7,U:N7,V:V7,w:F7,W:U7,x:pt,X:lt,y:kb,Y:Tb,Z:G7,"%":X7};xt.x=Oe(n,xt),xt.X=Oe(c,xt),xt.c=Oe(t,xt),Tt.x=Oe(n,Tt),Tt.X=Oe(c,Tt),Tt.c=Oe(t,Tt);function Oe(Ci,mi){return function(Ri){var Oi=[],_i=-1,Ji=0,Ai=Ci.length,sn,ei,_n;for(Ri instanceof Date||(Ri=new Date(+Ri));++_i<Ai;)Ci.charCodeAt(_i)===37&&(Oi.push(Ci.slice(Ji,_i)),(ei=Cb[sn=Ci.charAt(++_i)])!=null?sn=Ci.charAt(++_i):ei=sn==="e"?" ":"0",(_n=mi[sn])&&(sn=_n(Ri,ei)),Oi.push(sn),Ji=_i+1);return Oi.push(Ci.slice(Ji,_i)),Oi.join("")}}function jt(Ci,mi){return function(Ri){var Oi=Wm(1900,void 0,1),_i=it(Oi,Ci,Ri+="",0),Ji,Ai;if(_i!=Ri.length)return null;if("Q"in Oi)return new Date(Oi.Q);if("s"in Oi)return new Date(Oi.s*1e3+("L"in Oi?Oi.L:0));if(mi&&!("Z"in Oi)&&(Oi.Z=0),"p"in Oi&&(Oi.H=Oi.H%12+Oi.p*12),Oi.m===void 0&&(Oi.m="q"in Oi?Oi.q:0),"V"in Oi){if(Oi.V<1||Oi.V>53)return null;"w"in Oi||(Oi.w=1),"Z"in Oi?(Ji=ty(Wm(Oi.y,0,1)),Ai=Ji.getUTCDay(),Ji=Ai>4||Ai===0?N_.ceil(Ji):N_(Ji),Ji=r2.offset(Ji,(Oi.V-1)*7),Oi.y=Ji.getUTCFullYear(),Oi.m=Ji.getUTCMonth(),Oi.d=Ji.getUTCDate()+(Oi.w+6)%7):(Ji=ey(Wm(Oi.y,0,1)),Ai=Ji.getDay(),Ji=Ai>4||Ai===0?O_.ceil(Ji):O_(Ji),Ji=n2.offset(Ji,(Oi.V-1)*7),Oi.y=Ji.getFullYear(),Oi.m=Ji.getMonth(),Oi.d=Ji.getDate()+(Oi.w+6)%7)}else("W"in Oi||"U"in Oi)&&("w"in Oi||(Oi.w="u"in Oi?Oi.u%7:"W"in Oi?1:0),Ai="Z"in Oi?ty(Wm(Oi.y,0,1)).getUTCDay():ey(Wm(Oi.y,0,1)).getDay(),Oi.m=0,Oi.d="W"in Oi?(Oi.w+6)%7+Oi.W*7-(Ai+5)%7:Oi.w+Oi.U*7-(Ai+6)%7);return"Z"in Oi?(Oi.H+=Oi.Z/100|0,Oi.M+=Oi.Z%100,ty(Oi)):ey(Oi)}}function it(Ci,mi,Ri,Oi){for(var _i=0,Ji=mi.length,Ai=Ri.length,sn,ei;_i<Ji;){if(Oi>=Ai)return-1;if(sn=mi.charCodeAt(_i++),sn===37){if(sn=mi.charAt(_i++),ei=Mt[sn in Cb?mi.charAt(_i++):sn],!ei||(Oi=ei(Ci,Ri,Oi))<0)return-1}else if(sn!=Ri.charCodeAt(Oi++))return-1}return Oi}function vt(Ci,mi,Ri){var Oi=W.exec(mi.slice(Ri));return Oi?(Ci.p=he.get(Oi[0].toLowerCase()),Ri+Oi[0].length):-1}function mt(Ci,mi,Ri){var Oi=be.exec(mi.slice(Ri));return Oi?(Ci.w=je.get(Oi[0].toLowerCase()),Ri+Oi[0].length):-1}function Et(Ci,mi,Ri){var Oi=ae.exec(mi.slice(Ri));return Oi?(Ci.w=ue.get(Oi[0].toLowerCase()),Ri+Oi[0].length):-1}function Pt(Ci,mi,Ri){var Oi=at.exec(mi.slice(Ri));return Oi?(Ci.m=ut.get(Oi[0].toLowerCase()),Ri+Oi[0].length):-1}function dt(Ci,mi,Ri){var Oi=nt.exec(mi.slice(Ri));return Oi?(Ci.m=tt.get(Oi[0].toLowerCase()),Ri+Oi[0].length):-1}function Je(Ci,mi,Ri){return it(Ci,t,mi,Ri)}function pt(Ci,mi,Ri){return it(Ci,n,mi,Ri)}function lt(Ci,mi,Ri){return it(Ci,c,mi,Ri)}function Nt(Ci){return S[Ci.getDay()]}function zt(Ci){return x[Ci.getDay()]}function Ot(Ci){return G[Ci.getMonth()]}function gi(Ci){return a[Ci.getMonth()]}function wi(Ci){return g[+(Ci.getHours()>=12)]}function Ti(Ci){return 1+~~(Ci.getMonth()/3)}function Ni(Ci){return S[Ci.getUTCDay()]}function en(Ci){return x[Ci.getUTCDay()]}function ji(Ci){return G[Ci.getUTCMonth()]}function Vi(Ci){return a[Ci.getUTCMonth()]}function nn(Ci){return g[+(Ci.getUTCHours()>=12)]}function vn(Ci){return 1+~~(Ci.getUTCMonth()/3)}return{format:function(Ci){var mi=Oe(Ci+="",xt);return mi.toString=function(){return Ci},mi},parse:function(Ci){var mi=jt(Ci+="",!1);return mi.toString=function(){return Ci},mi},utcFormat:function(Ci){var mi=Oe(Ci+="",Tt);return mi.toString=function(){return Ci},mi},utcParse:function(Ci){var mi=jt(Ci+="",!0);return mi.toString=function(){return Ci},mi}}}var Cb={"-":"",_:" ",0:"0"},Bu=/^\s*\d+/,B7=/^%/,z7=/[\\^$*+?|[\]().{}]/g;function Fa(e,t,n){var c=e<0?"-":"",g=(c?-e:e)+"",x=g.length;return c+(x<n?new Array(n-x+1).join(t)+g:g)}function R7(e){return e.replace(z7,"\\$&")}function $m(e){return new RegExp("^(?:"+e.map(R7).join("|")+")","i")}function Xm(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function F7(e,t,n){var c=Bu.exec(t.slice(n,n+1));return c?(e.w=+c[0],n+c[0].length):-1}function O7(e,t,n){var c=Bu.exec(t.slice(n,n+1));return c?(e.u=+c[0],n+c[0].length):-1}function N7(e,t,n){var c=Bu.exec(t.slice(n,n+2));return c?(e.U=+c[0],n+c[0].length):-1}function V7(e,t,n){var c=Bu.exec(t.slice(n,n+2));return c?(e.V=+c[0],n+c[0].length):-1}function U7(e,t,n){var c=Bu.exec(t.slice(n,n+2));return c?(e.W=+c[0],n+c[0].length):-1}function Tb(e,t,n){var c=Bu.exec(t.slice(n,n+4));return c?(e.y=+c[0],n+c[0].length):-1}function kb(e,t,n){var c=Bu.exec(t.slice(n,n+2));return c?(e.y=+c[0]+(+c[0]>68?1900:2e3),n+c[0].length):-1}function G7(e,t,n){var c=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return c?(e.Z=c[1]?0:-(c[2]+(c[3]||"00")),n+c[0].length):-1}function q7(e,t,n){var c=Bu.exec(t.slice(n,n+1));return c?(e.q=c[0]*3-3,n+c[0].length):-1}function H7(e,t,n){var c=Bu.exec(t.slice(n,n+2));return c?(e.m=c[0]-1,n+c[0].length):-1}function Mb(e,t,n){var c=Bu.exec(t.slice(n,n+2));return c?(e.d=+c[0],n+c[0].length):-1}function j7(e,t,n){var c=Bu.exec(t.slice(n,n+3));return c?(e.m=0,e.d=+c[0],n+c[0].length):-1}function Pb(e,t,n){var c=Bu.exec(t.slice(n,n+2));return c?(e.H=+c[0],n+c[0].length):-1}function Z7(e,t,n){var c=Bu.exec(t.slice(n,n+2));return c?(e.M=+c[0],n+c[0].length):-1}function Q7(e,t,n){var c=Bu.exec(t.slice(n,n+2));return c?(e.S=+c[0],n+c[0].length):-1}function W7(e,t,n){var c=Bu.exec(t.slice(n,n+3));return c?(e.L=+c[0],n+c[0].length):-1}function $7(e,t,n){var c=Bu.exec(t.slice(n,n+6));return c?(e.L=Math.floor(c[0]/1e3),n+c[0].length):-1}function X7(e,t,n){var c=B7.exec(t.slice(n,n+1));return c?n+c[0].length:-1}function Y7(e,t,n){var c=Bu.exec(t.slice(n));return c?(e.Q=+c[0],n+c[0].length):-1}function K7(e,t,n){var c=Bu.exec(t.slice(n));return c?(e.s=+c[0],n+c[0].length):-1}function Db(e,t){return Fa(e.getDate(),t,2)}function J7(e,t){return Fa(e.getHours(),t,2)}function ez(e,t){return Fa(e.getHours()%12||12,t,2)}function tz(e,t){return Fa(1+n2.count(sp(e),e),t,3)}function V4(e,t){return Fa(e.getMilliseconds(),t,3)}function iz(e,t){return V4(e,t)+"000"}function nz(e,t){return Fa(e.getMonth()+1,t,2)}function rz(e,t){return Fa(e.getMinutes(),t,2)}function sz(e,t){return Fa(e.getSeconds(),t,2)}function az(e){var t=e.getDay();return t===0?7:t}function oz(e,t){return Fa(O4.count(sp(e)-1,e),t,2)}function U4(e){var t=e.getDay();return t>=4||t===0?vm(e):vm.ceil(e)}function lz(e,t){return e=U4(e),Fa(vm.count(sp(e),e)+(sp(e).getDay()===4),t,2)}function uz(e){return e.getDay()}function cz(e,t){return Fa(O_.count(sp(e)-1,e),t,2)}function hz(e,t){return Fa(e.getFullYear()%100,t,2)}function Az(e,t){return e=U4(e),Fa(e.getFullYear()%100,t,2)}function fz(e,t){return Fa(e.getFullYear()%1e4,t,4)}function dz(e,t){var n=e.getDay();return e=n>=4||n===0?vm(e):vm.ceil(e),Fa(e.getFullYear()%1e4,t,4)}function pz(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Fa(t/60|0,"0",2)+Fa(t%60,"0",2)}function Lb(e,t){return Fa(e.getUTCDate(),t,2)}function mz(e,t){return Fa(e.getUTCHours(),t,2)}function gz(e,t){return Fa(e.getUTCHours()%12||12,t,2)}function _z(e,t){return Fa(1+r2.count(ap(e),e),t,3)}function G4(e,t){return Fa(e.getUTCMilliseconds(),t,3)}function yz(e,t){return G4(e,t)+"000"}function vz(e,t){return Fa(e.getUTCMonth()+1,t,2)}function xz(e,t){return Fa(e.getUTCMinutes(),t,2)}function bz(e,t){return Fa(e.getUTCSeconds(),t,2)}function wz(e){var t=e.getUTCDay();return t===0?7:t}function Sz(e,t){return Fa(N4.count(ap(e)-1,e),t,2)}function q4(e){var t=e.getUTCDay();return t>=4||t===0?xm(e):xm.ceil(e)}function Iz(e,t){return e=q4(e),Fa(xm.count(ap(e),e)+(ap(e).getUTCDay()===4),t,2)}function Ez(e){return e.getUTCDay()}function Cz(e,t){return Fa(N_.count(ap(e)-1,e),t,2)}function Tz(e,t){return Fa(e.getUTCFullYear()%100,t,2)}function kz(e,t){return e=q4(e),Fa(e.getUTCFullYear()%100,t,2)}function Mz(e,t){return Fa(e.getUTCFullYear()%1e4,t,4)}function Pz(e,t){var n=e.getUTCDay();return e=n>=4||n===0?xm(e):xm.ceil(e),Fa(e.getUTCFullYear()%1e4,t,4)}function Dz(){return"+0000"}function Bb(){return"%"}function zb(e){return+e}function Rb(e){return Math.floor(+e/1e3)}var Xp,H4;Lz({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Lz(e){return Xp=L7(e),Xp.format,H4=Xp.parse,Xp.utcFormat,Xp.utcParse,Xp}function Yp(e){return function(){return e}}function Bz(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function j4(e){this._context=e}j4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function zz(e){return new j4(e)}function Rz(e){return e[0]}function Fz(e){return e[1]}function fv(e,t){var n=Yp(!0),c=null,g=zz,x=null;e=typeof e=="function"?e:e===void 0?Rz:Yp(e),t=typeof t=="function"?t:t===void 0?Fz:Yp(t);function S(a){var G,W=(a=Bz(a)).length,he,ae=!1,ue;for(c==null&&(x=g(ue=L4())),G=0;G<=W;++G)!(G<W&&n(he=a[G],G,a))===ae&&((ae=!ae)?x.lineStart():x.lineEnd()),ae&&x.point(+e(he,G,a),+t(he,G,a));if(ue)return x=null,ue+""||null}return S.x=function(a){return arguments.length?(e=typeof a=="function"?a:Yp(+a),S):e},S.y=function(a){return arguments.length?(t=typeof a=="function"?a:Yp(+a),S):t},S.defined=function(a){return arguments.length?(n=typeof a=="function"?a:Yp(!!a),S):n},S.curve=function(a){return arguments.length?(g=a,c!=null&&(x=g(c)),S):g},S.context=function(a){return arguments.length?(a==null?c=x=null:x=g(c=a),S):c},S}function Fb(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Z4(e){this._context=e}Z4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Fb(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Fb(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Ob(e){return new Z4(e)}function Q4(e,t){this._context=e,this._t=t}Q4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function Oz(e){return new Q4(e,0)}const Yg=e=>()=>e;function Nz(e,{sourceEvent:t,target:n,transform:c,dispatch:g}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:c,enumerable:!0,configurable:!0},_:{value:g}})}function e0(e,t,n){this.k=e,this.x=t,this.y=n}e0.prototype={constructor:e0,scale:function(e){return e===1?this:new e0(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new e0(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var W4=new e0(1,0,0);e0.prototype;function iy(e){e.stopImmediatePropagation()}function Ym(e){e.preventDefault(),e.stopImmediatePropagation()}function Vz(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Uz(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Nb(){return this.__zoom||W4}function Gz(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function qz(){return navigator.maxTouchPoints||"ontouchstart"in this}function Hz(e,t,n){var c=e.invertX(t[0][0])-n[0][0],g=e.invertX(t[1][0])-n[1][0],x=e.invertY(t[0][1])-n[0][1],S=e.invertY(t[1][1])-n[1][1];return e.translate(g>c?(c+g)/2:Math.min(0,c)||Math.max(0,g),S>x?(x+S)/2:Math.min(0,x)||Math.max(0,S))}function jz(){var e=Vz,t=Uz,n=Hz,c=Gz,g=qz,x=[0,1/0],S=[[-1/0,-1/0],[1/0,1/0]],a=250,G=hL,W=t1("start","zoom","end"),he,ae,ue,be=500,je=150,nt=0,tt=10;function at(Je){Je.property("__zoom",Nb).on("wheel.zoom",it).on("mousedown.zoom",vt).on("dblclick.zoom",mt).filter(g).on("touchstart.zoom",Et).on("touchmove.zoom",Pt).on("touchend.zoom touchcancel.zoom",dt).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}at.transform=function(Je,pt,lt,Nt){var zt=Je.selection?Je.selection():Je;zt.property("__zoom",Nb),Je!==zt?Mt(Je,pt,lt,Nt):zt.interrupt().each(function(){Oe(this,arguments).event(Nt).start().zoom(null,typeof pt=="function"?pt.apply(this,arguments):pt).end()})},at.scaleBy=function(Je,pt,lt,Nt){at.scaleTo(Je,function(){var zt=this.__zoom.k,Ot=typeof pt=="function"?pt.apply(this,arguments):pt;return zt*Ot},lt,Nt)},at.scaleTo=function(Je,pt,lt,Nt){at.transform(Je,function(){var zt=t.apply(this,arguments),Ot=this.__zoom,gi=lt==null?Tt(zt):typeof lt=="function"?lt.apply(this,arguments):lt,wi=Ot.invert(gi),Ti=typeof pt=="function"?pt.apply(this,arguments):pt;return n(xt(ut(Ot,Ti),gi,wi),zt,S)},lt,Nt)},at.translateBy=function(Je,pt,lt,Nt){at.transform(Je,function(){return n(this.__zoom.translate(typeof pt=="function"?pt.apply(this,arguments):pt,typeof lt=="function"?lt.apply(this,arguments):lt),t.apply(this,arguments),S)},null,Nt)},at.translateTo=function(Je,pt,lt,Nt,zt){at.transform(Je,function(){var Ot=t.apply(this,arguments),gi=this.__zoom,wi=Nt==null?Tt(Ot):typeof Nt=="function"?Nt.apply(this,arguments):Nt;return n(W4.translate(wi[0],wi[1]).scale(gi.k).translate(typeof pt=="function"?-pt.apply(this,arguments):-pt,typeof lt=="function"?-lt.apply(this,arguments):-lt),Ot,S)},Nt,zt)};function ut(Je,pt){return pt=Math.max(x[0],Math.min(x[1],pt)),pt===Je.k?Je:new e0(pt,Je.x,Je.y)}function xt(Je,pt,lt){var Nt=pt[0]-lt[0]*Je.k,zt=pt[1]-lt[1]*Je.k;return Nt===Je.x&&zt===Je.y?Je:new e0(Je.k,Nt,zt)}function Tt(Je){return[(+Je[0][0]+ +Je[1][0])/2,(+Je[0][1]+ +Je[1][1])/2]}function Mt(Je,pt,lt,Nt){Je.on("start.zoom",function(){Oe(this,arguments).event(Nt).start()}).on("interrupt.zoom end.zoom",function(){Oe(this,arguments).event(Nt).end()}).tween("zoom",function(){var zt=this,Ot=arguments,gi=Oe(zt,Ot).event(Nt),wi=t.apply(zt,Ot),Ti=lt==null?Tt(wi):typeof lt=="function"?lt.apply(zt,Ot):lt,Ni=Math.max(wi[1][0]-wi[0][0],wi[1][1]-wi[0][1]),en=zt.__zoom,ji=typeof pt=="function"?pt.apply(zt,Ot):pt,Vi=G(en.invert(Ti).concat(Ni/en.k),ji.invert(Ti).concat(Ni/ji.k));return function(nn){if(nn===1)nn=ji;else{var vn=Vi(nn),Ci=Ni/vn[2];nn=new e0(Ci,Ti[0]-vn[0]*Ci,Ti[1]-vn[1]*Ci)}gi.zoom(null,nn)}})}function Oe(Je,pt,lt){return!lt&&Je.__zooming||new jt(Je,pt)}function jt(Je,pt){this.that=Je,this.args=pt,this.active=0,this.sourceEvent=null,this.extent=t.apply(Je,pt),this.taps=0}jt.prototype={event:function(Je){return Je&&(this.sourceEvent=Je),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(Je,pt){return this.mouse&&Je!=="mouse"&&(this.mouse[1]=pt.invert(this.mouse[0])),this.touch0&&Je!=="touch"&&(this.touch0[1]=pt.invert(this.touch0[0])),this.touch1&&Je!=="touch"&&(this.touch1[1]=pt.invert(this.touch1[0])),this.that.__zoom=pt,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(Je){var pt=dl(this.that).datum();W.call(Je,this.that,new Nz(Je,{sourceEvent:this.sourceEvent,target:at,type:Je,transform:this.that.__zoom,dispatch:W}),pt)}};function it(Je,...pt){if(!e.apply(this,arguments))return;var lt=Oe(this,pt).event(Je),Nt=this.__zoom,zt=Math.max(x[0],Math.min(x[1],Nt.k*Math.pow(2,c.apply(this,arguments)))),Ot=Yf(Je);if(lt.wheel)(lt.mouse[0][0]!==Ot[0]||lt.mouse[0][1]!==Ot[1])&&(lt.mouse[1]=Nt.invert(lt.mouse[0]=Ot)),clearTimeout(lt.wheel);else{if(Nt.k===zt)return;lt.mouse=[Ot,Nt.invert(Ot)],Am(this),lt.start()}Ym(Je),lt.wheel=setTimeout(gi,je),lt.zoom("mouse",n(xt(ut(Nt,zt),lt.mouse[0],lt.mouse[1]),lt.extent,S));function gi(){lt.wheel=null,lt.end()}}function vt(Je,...pt){if(ue||!e.apply(this,arguments))return;var lt=Oe(this,pt,!0).event(Je),Nt=dl(Je.view).on("mousemove.zoom",Ti,!0).on("mouseup.zoom",Ni,!0),zt=Yf(Je,Ot),Ot=Je.currentTarget,gi=Je.clientX,wi=Je.clientY;_4(Je.view),iy(Je),lt.mouse=[zt,this.__zoom.invert(zt)],Am(this),lt.start();function Ti(en){if(Ym(en),!lt.moved){var ji=en.clientX-gi,Vi=en.clientY-wi;lt.moved=ji*ji+Vi*Vi>nt}lt.event(en).zoom("mouse",n(xt(lt.that.__zoom,lt.mouse[0]=Yf(en,Ot),lt.mouse[1]),lt.extent,S))}function Ni(en){Nt.on("mousemove.zoom mouseup.zoom",null),y4(en.view,lt.moved),Ym(en),lt.event(en).end()}}function mt(Je,...pt){if(e.apply(this,arguments)){var lt=this.__zoom,Nt=Yf(Je.changedTouches?Je.changedTouches[0]:Je,this),zt=lt.invert(Nt),Ot=lt.k*(Je.shiftKey?.5:2),gi=n(xt(ut(lt,Ot),Nt,zt),t.apply(this,pt),S);Ym(Je),a>0?dl(this).transition().duration(a).call(Mt,gi,Nt,Je):dl(this).call(at.transform,gi,Nt,Je)}}function Et(Je,...pt){if(e.apply(this,arguments)){var lt=Je.touches,Nt=lt.length,zt=Oe(this,pt,Je.changedTouches.length===Nt).event(Je),Ot,gi,wi,Ti;for(iy(Je),gi=0;gi<Nt;++gi)wi=lt[gi],Ti=Yf(wi,this),Ti=[Ti,this.__zoom.invert(Ti),wi.identifier],zt.touch0?!zt.touch1&&zt.touch0[2]!==Ti[2]&&(zt.touch1=Ti,zt.taps=0):(zt.touch0=Ti,Ot=!0,zt.taps=1+!!he);he&&(he=clearTimeout(he)),Ot&&(zt.taps<2&&(ae=Ti[0],he=setTimeout(function(){he=null},be)),Am(this),zt.start())}}function Pt(Je,...pt){if(this.__zooming){var lt=Oe(this,pt).event(Je),Nt=Je.changedTouches,zt=Nt.length,Ot,gi,wi,Ti;for(Ym(Je),Ot=0;Ot<zt;++Ot)gi=Nt[Ot],wi=Yf(gi,this),lt.touch0&&lt.touch0[2]===gi.identifier?lt.touch0[0]=wi:lt.touch1&&lt.touch1[2]===gi.identifier&&(lt.touch1[0]=wi);if(gi=lt.that.__zoom,lt.touch1){var Ni=lt.touch0[0],en=lt.touch0[1],ji=lt.touch1[0],Vi=lt.touch1[1],nn=(nn=ji[0]-Ni[0])*nn+(nn=ji[1]-Ni[1])*nn,vn=(vn=Vi[0]-en[0])*vn+(vn=Vi[1]-en[1])*vn;gi=ut(gi,Math.sqrt(nn/vn)),wi=[(Ni[0]+ji[0])/2,(Ni[1]+ji[1])/2],Ti=[(en[0]+Vi[0])/2,(en[1]+Vi[1])/2]}else if(lt.touch0)wi=lt.touch0[0],Ti=lt.touch0[1];else return;lt.zoom("touch",n(xt(gi,wi,Ti),lt.extent,S))}}function dt(Je,...pt){if(this.__zooming){var lt=Oe(this,pt).event(Je),Nt=Je.changedTouches,zt=Nt.length,Ot,gi;for(iy(Je),ue&&clearTimeout(ue),ue=setTimeout(function(){ue=null},be),Ot=0;Ot<zt;++Ot)gi=Nt[Ot],lt.touch0&&lt.touch0[2]===gi.identifier?delete lt.touch0:lt.touch1&&lt.touch1[2]===gi.identifier&&delete lt.touch1;if(lt.touch1&&!lt.touch0&&(lt.touch0=lt.touch1,delete lt.touch1),lt.touch0)lt.touch0[1]=this.__zoom.invert(lt.touch0[0]);else if(lt.end(),lt.taps===2&&(gi=Yf(gi,this),Math.hypot(ae[0]-gi[0],ae[1]-gi[1])<tt)){var wi=dl(this).on("dblclick.zoom");wi&&wi.apply(this,arguments)}}}return at.wheelDelta=function(Je){return arguments.length?(c=typeof Je=="function"?Je:Yg(+Je),at):c},at.filter=function(Je){return arguments.length?(e=typeof Je=="function"?Je:Yg(!!Je),at):e},at.touchable=function(Je){return arguments.length?(g=typeof Je=="function"?Je:Yg(!!Je),at):g},at.extent=function(Je){return arguments.length?(t=typeof Je=="function"?Je:Yg([[+Je[0][0],+Je[0][1]],[+Je[1][0],+Je[1][1]]]),at):t},at.scaleExtent=function(Je){return arguments.length?(x[0]=+Je[0],x[1]=+Je[1],at):[x[0],x[1]]},at.translateExtent=function(Je){return arguments.length?(S[0][0]=+Je[0][0],S[1][0]=+Je[1][0],S[0][1]=+Je[0][1],S[1][1]=+Je[1][1],at):[[S[0][0],S[0][1]],[S[1][0],S[1][1]]]},at.constrain=function(Je){return arguments.length?(n=Je,at):n},at.duration=function(Je){return arguments.length?(a=+Je,at):a},at.interpolate=function(Je){return arguments.length?(G=Je,at):G},at.on=function(){var Je=W.on.apply(W,arguments);return Je===W?at:Je},at.clickDistance=function(Je){return arguments.length?(nt=(Je=+Je)*Je,at):Math.sqrt(nt)},at.tapDistance=function(Je){return arguments.length?(tt=+Je,at):tt},at}var $4="1.13.6",Vb=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},a1=Array.prototype,s2=Object.prototype,Ub=typeof Symbol<"u"?Symbol.prototype:null,Zz=a1.push,Lg=a1.slice,xg=s2.toString,Qz=s2.hasOwnProperty,X4=typeof ArrayBuffer<"u",Wz=typeof DataView<"u",$z=Array.isArray,Gb=Object.keys,qb=Object.create,Hb=X4&&ArrayBuffer.isView,Xz=isNaN,Yz=isFinite,Y4=!{toString:null}.propertyIsEnumerable("toString"),jb=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],Kz=Math.pow(2,53)-1;function Hc(e,t){return t=t==null?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),c=Array(n),g=0;g<n;g++)c[g]=arguments[g+t];switch(t){case 0:return e.call(this,c);case 1:return e.call(this,arguments[0],c);case 2:return e.call(this,arguments[0],arguments[1],c)}var x=Array(t+1);for(g=0;g<t;g++)x[g]=arguments[g];return x[t]=c,e.apply(this,x)}}function fp(e){var t=typeof e;return t==="function"||t==="object"&&!!e}function Jz(e){return e===null}function op(e){return e===void 0}function K4(e){return e===!0||e===!1||xg.call(e)==="[object Boolean]"}function e9(e){return!!(e&&e.nodeType===1)}function sc(e){var t="[object "+e+"]";return function(n){return xg.call(n)===t}}const o1=sc("String"),J4=sc("Number"),t9=sc("Date"),i9=sc("RegExp"),n9=sc("Error"),eS=sc("Symbol"),tS=sc("ArrayBuffer");var iS=sc("Function"),r9=Vb.document&&Vb.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof r9!="function"&&(iS=function(e){return typeof e=="function"||!1});const nc=iS,nS=sc("Object");var rS=Wz&&nS(new DataView(new ArrayBuffer(8))),a2=typeof Map<"u"&&nS(new Map),s9=sc("DataView");function a9(e){return e!=null&&nc(e.getInt8)&&tS(e.buffer)}const V_=rS?a9:s9,dp=$z||sc("Array");function q0(e,t){return e!=null&&Qz.call(e,t)}var dv=sc("Arguments");(function(){dv(arguments)||(dv=function(e){return q0(e,"callee")})})();const o2=dv;function o9(e){return!eS(e)&&Yz(e)&&!isNaN(parseFloat(e))}function sS(e){return J4(e)&&Xz(e)}function aS(e){return function(){return e}}function oS(e){return function(t){var n=e(t);return typeof n=="number"&&n>=0&&n<=Kz}}function lS(e){return function(t){return t==null?void 0:t[e]}}const U_=lS("byteLength"),l9=oS(U_);var u9=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function c9(e){return Hb?Hb(e)&&!V_(e):l9(e)&&u9.test(xg.call(e))}const uS=X4?c9:aS(!1),jc=lS("length");function h9(e){for(var t={},n=e.length,c=0;c<n;++c)t[e[c]]=!0;return{contains:function(g){return t[g]===!0},push:function(g){return t[g]=!0,e.push(g)}}}function cS(e,t){t=h9(t);var n=jb.length,c=e.constructor,g=nc(c)&&c.prototype||s2,x="constructor";for(q0(e,x)&&!t.contains(x)&&t.push(x);n--;)x=jb[n],x in e&&e[x]!==g[x]&&!t.contains(x)&&t.push(x)}function pu(e){if(!fp(e))return[];if(Gb)return Gb(e);var t=[];for(var n in e)q0(e,n)&&t.push(n);return Y4&&cS(e,t),t}function A9(e){if(e==null)return!0;var t=jc(e);return typeof t=="number"&&(dp(e)||o1(e)||o2(e))?t===0:jc(pu(e))===0}function hS(e,t){var n=pu(t),c=n.length;if(e==null)return!c;for(var g=Object(e),x=0;x<c;x++){var S=n[x];if(t[S]!==g[S]||!(S in g))return!1}return!0}function ho(e){if(e instanceof ho)return e;if(!(this instanceof ho))return new ho(e);this._wrapped=e}ho.VERSION=$4;ho.prototype.value=function(){return this._wrapped};ho.prototype.valueOf=ho.prototype.toJSON=ho.prototype.value;ho.prototype.toString=function(){return String(this._wrapped)};function Zb(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,U_(e))}var Qb="[object DataView]";function pv(e,t,n,c){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var g=typeof e;return g!=="function"&&g!=="object"&&typeof t!="object"?!1:AS(e,t,n,c)}function AS(e,t,n,c){e instanceof ho&&(e=e._wrapped),t instanceof ho&&(t=t._wrapped);var g=xg.call(e);if(g!==xg.call(t))return!1;if(rS&&g=="[object Object]"&&V_(e)){if(!V_(t))return!1;g=Qb}switch(g){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return Ub.valueOf.call(e)===Ub.valueOf.call(t);case"[object ArrayBuffer]":case Qb:return AS(Zb(e),Zb(t),n,c)}var x=g==="[object Array]";if(!x&&uS(e)){var S=U_(e);if(S!==U_(t))return!1;if(e.buffer===t.buffer&&e.byteOffset===t.byteOffset)return!0;x=!0}if(!x){if(typeof e!="object"||typeof t!="object")return!1;var a=e.constructor,G=t.constructor;if(a!==G&&!(nc(a)&&a instanceof a&&nc(G)&&G instanceof G)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],c=c||[];for(var W=n.length;W--;)if(n[W]===e)return c[W]===t;if(n.push(e),c.push(t),x){if(W=e.length,W!==t.length)return!1;for(;W--;)if(!pv(e[W],t[W],n,c))return!1}else{var he=pu(e),ae;if(W=he.length,pu(t).length!==W)return!1;for(;W--;)if(ae=he[W],!(q0(t,ae)&&pv(e[ae],t[ae],n,c)))return!1}return n.pop(),c.pop(),!0}function f9(e,t){return pv(e,t)}function Bg(e){if(!fp(e))return[];var t=[];for(var n in e)t.push(n);return Y4&&cS(e,t),t}function l2(e){var t=jc(e);return function(n){if(n==null)return!1;var c=Bg(n);if(jc(c))return!1;for(var g=0;g<t;g++)if(!nc(n[e[g]]))return!1;return e!==pS||!nc(n[u2])}}var u2="forEach",fS="has",c2=["clear","delete"],dS=["get",fS,"set"],d9=c2.concat(u2,dS),pS=c2.concat(dS),p9=["add"].concat(c2,u2,fS);const m9=a2?l2(d9):sc("Map"),g9=a2?l2(pS):sc("WeakMap"),_9=a2?l2(p9):sc("Set"),y9=sc("WeakSet");function pp(e){for(var t=pu(e),n=t.length,c=Array(n),g=0;g<n;g++)c[g]=e[t[g]];return c}function v9(e){for(var t=pu(e),n=t.length,c=Array(n),g=0;g<n;g++)c[g]=[t[g],e[t[g]]];return c}function mS(e){for(var t={},n=pu(e),c=0,g=n.length;c<g;c++)t[e[n[c]]]=n[c];return t}function mv(e){var t=[];for(var n in e)nc(e[n])&&t.push(n);return t.sort()}function h2(e,t){return function(n){var c=arguments.length;if(t&&(n=Object(n)),c<2||n==null)return n;for(var g=1;g<c;g++)for(var x=arguments[g],S=e(x),a=S.length,G=0;G<a;G++){var W=S[G];(!t||n[W]===void 0)&&(n[W]=x[W])}return n}}const fA=h2(Bg),bg=h2(pu),A2=h2(Bg,!0);function x9(){return function(){}}function gS(e){if(!fp(e))return{};if(qb)return qb(e);var t=x9();t.prototype=e;var n=new t;return t.prototype=null,n}function b9(e,t){var n=gS(e);return t&&bg(n,t),n}function _S(e){return fp(e)?dp(e)?e.slice():fA({},e):e}function w9(e,t){return t(e),e}function yS(e){return dp(e)?e:[e]}ho.toPath=yS;function zg(e){return ho.toPath(e)}function f2(e,t){for(var n=t.length,c=0;c<n;c++){if(e==null)return;e=e[t[c]]}return n?e:void 0}function vS(e,t,n){var c=f2(e,zg(t));return op(c)?n:c}function l1(e,t){t=zg(t);for(var n=t.length,c=0;c<n;c++){var g=t[c];if(!q0(e,g))return!1;e=e[g]}return!!n}function d2(e){return e}function wg(e){return e=bg({},e),function(t){return hS(t,e)}}function p2(e){return e=zg(e),function(t){return f2(t,e)}}function Rg(e,t,n){if(t===void 0)return e;switch(n??3){case 1:return function(c){return e.call(t,c)};case 3:return function(c,g,x){return e.call(t,c,g,x)};case 4:return function(c,g,x,S){return e.call(t,c,g,x,S)}}return function(){return e.apply(t,arguments)}}function xS(e,t,n){return e==null?d2:nc(e)?Rg(e,t,n):fp(e)&&!dp(e)?wg(e):p2(e)}function m2(e,t){return xS(e,t,1/0)}ho.iteratee=m2;function Wc(e,t,n){return ho.iteratee!==m2?ho.iteratee(e,t):xS(e,t,n)}function bS(e,t,n){t=Wc(t,n);for(var c=pu(e),g=c.length,x={},S=0;S<g;S++){var a=c[S];x[a]=t(e[a],a,e)}return x}function wS(){}function S9(e){return e==null?wS:function(t){return vS(e,t)}}function I9(e,t,n){var c=Array(Math.max(0,e));t=Rg(t,n,1);for(var g=0;g<e;g++)c[g]=t(g);return c}function gv(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}const Sg=Date.now||function(){return new Date().getTime()};function SS(e){var t=function(x){return e[x]},n="(?:"+pu(e).join("|")+")",c=RegExp(n),g=RegExp(n,"g");return function(x){return x=x==null?"":""+x,c.test(x)?x.replace(g,t):x}}const IS={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},E9=SS(IS),C9=mS(IS),T9=SS(C9),k9=ho.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var ny=/(.)^/,M9={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},P9=/\\|'|\r|\n|\u2028|\u2029/g;function D9(e){return"\\"+M9[e]}var L9=/^\s*(\w|\$)+\s*$/;function B9(e,t,n){!t&&n&&(t=n),t=A2({},t,ho.templateSettings);var c=RegExp([(t.escape||ny).source,(t.interpolate||ny).source,(t.evaluate||ny).source].join("|")+"|$","g"),g=0,x="__p+='";e.replace(c,function(W,he,ae,ue,be){return x+=e.slice(g,be).replace(P9,D9),g=be+W.length,he?x+=`'+
((__t=(`+he+`))==null?'':_.escape(__t))+
'`:ae?x+=`'+
((__t=(`+ae+`))==null?'':__t)+
'`:ue&&(x+=`';
`+ue+`
__p+='`),W}),x+=`';
`;var S=t.variable;if(S){if(!L9.test(S))throw new Error("variable is not a bare identifier: "+S)}else x=`with(obj||{}){
`+x+`}
`,S="obj";x=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+x+`return __p;
`;var a;try{a=new Function(S,"_",x)}catch(W){throw W.source=x,W}var G=function(W){return a.call(this,W,ho)};return G.source="function("+S+`){
`+x+"}",G}function z9(e,t,n){t=zg(t);var c=t.length;if(!c)return nc(n)?n.call(e):n;for(var g=0;g<c;g++){var x=e==null?void 0:e[t[g]];x===void 0&&(x=n,g=c),e=nc(x)?x.call(e):x}return e}var R9=0;function F9(e){var t=++R9+"";return e?e+t:t}function O9(e){var t=ho(e);return t._chain=!0,t}function ES(e,t,n,c,g){if(!(c instanceof t))return e.apply(n,g);var x=gS(e.prototype),S=e.apply(x,g);return fp(S)?S:x}var nf=Hc(function(e,t){var n=nf.placeholder,c=function(){for(var g=0,x=t.length,S=Array(x),a=0;a<x;a++)S[a]=t[a]===n?arguments[g++]:t[a];for(;g<arguments.length;)S.push(arguments[g++]);return ES(e,c,this,this,S)};return c});nf.placeholder=ho;const CS=Hc(function(e,t,n){if(!nc(e))throw new TypeError("Bind must be called on a function");var c=Hc(function(g){return ES(e,c,t,this,n.concat(g))});return c}),_h=oS(jc);function mp(e,t,n,c){if(c=c||[],!t&&t!==0)t=1/0;else if(t<=0)return c.concat(e);for(var g=c.length,x=0,S=jc(e);x<S;x++){var a=e[x];if(_h(a)&&(dp(a)||o2(a)))if(t>1)mp(a,t-1,n,c),g=c.length;else for(var G=0,W=a.length;G<W;)c[g++]=a[G++];else n||(c[g++]=a)}return c}const N9=Hc(function(e,t){t=mp(t,!1,!1);var n=t.length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var c=t[n];e[c]=CS(e[c],e)}return e});function V9(e,t){var n=function(c){var g=n.cache,x=""+(t?t.apply(this,arguments):c);return q0(g,x)||(g[x]=e.apply(this,arguments)),g[x]};return n.cache={},n}const TS=Hc(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)}),U9=nf(TS,ho,1);function G9(e,t,n){var c,g,x,S,a=0;n||(n={});var G=function(){a=n.leading===!1?0:Sg(),c=null,S=e.apply(g,x),c||(g=x=null)},W=function(){var he=Sg();!a&&n.leading===!1&&(a=he);var ae=t-(he-a);return g=this,x=arguments,ae<=0||ae>t?(c&&(clearTimeout(c),c=null),a=he,S=e.apply(g,x),c||(g=x=null)):!c&&n.trailing!==!1&&(c=setTimeout(G,ae)),S};return W.cancel=function(){clearTimeout(c),a=0,c=g=x=null},W}function q9(e,t,n){var c,g,x,S,a,G=function(){var he=Sg()-g;t>he?c=setTimeout(G,t-he):(c=null,n||(S=e.apply(a,x)),c||(x=a=null))},W=Hc(function(he){return a=this,x=he,g=Sg(),c||(c=setTimeout(G,t),n&&(S=e.apply(a,x))),S});return W.cancel=function(){clearTimeout(c),c=x=a=null},W}function H9(e,t){return nf(t,e)}function g2(e){return function(){return!e.apply(this,arguments)}}function j9(){var e=arguments,t=e.length-1;return function(){for(var n=t,c=e[t].apply(this,arguments);n--;)c=e[n].call(this,c);return c}}function Z9(e,t){return function(){if(--e<1)return t.apply(this,arguments)}}function kS(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}}const Q9=nf(kS,2);function MS(e,t,n){t=Wc(t,n);for(var c=pu(e),g,x=0,S=c.length;x<S;x++)if(g=c[x],t(e[g],g,e))return g}function PS(e){return function(t,n,c){n=Wc(n,c);for(var g=jc(t),x=e>0?0:g-1;x>=0&&x<g;x+=e)if(n(t[x],x,t))return x;return-1}}const _2=PS(1),DS=PS(-1);function LS(e,t,n,c){n=Wc(n,c,1);for(var g=n(t),x=0,S=jc(e);x<S;){var a=Math.floor((x+S)/2);n(e[a])<g?x=a+1:S=a}return x}function BS(e,t,n){return function(c,g,x){var S=0,a=jc(c);if(typeof x=="number")e>0?S=x>=0?x:Math.max(x+a,S):a=x>=0?Math.min(x+1,a):x+a+1;else if(n&&x&&a)return x=n(c,g),c[x]===g?x:-1;if(g!==g)return x=t(Lg.call(c,S,a),sS),x>=0?x+S:-1;for(x=e>0?S:a-1;x>=0&&x<a;x+=e)if(c[x]===g)return x;return-1}}const zS=BS(1,_2,LS),W9=BS(-1,DS);function _v(e,t,n){var c=_h(e)?_2:MS,g=c(e,t,n);if(g!==void 0&&g!==-1)return e[g]}function $9(e,t){return _v(e,wg(t))}function Zc(e,t,n){t=Rg(t,n);var c,g;if(_h(e))for(c=0,g=e.length;c<g;c++)t(e[c],c,e);else{var x=pu(e);for(c=0,g=x.length;c<g;c++)t(e[x[c]],x[c],e)}return e}function gc(e,t,n){t=Wc(t,n);for(var c=!_h(e)&&pu(e),g=(c||e).length,x=Array(g),S=0;S<g;S++){var a=c?c[S]:S;x[S]=t(e[a],a,e)}return x}function RS(e){var t=function(n,c,g,x){var S=!_h(n)&&pu(n),a=(S||n).length,G=e>0?0:a-1;for(x||(g=n[S?S[G]:G],G+=e);G>=0&&G<a;G+=e){var W=S?S[G]:G;g=c(g,n[W],W,n)}return g};return function(n,c,g,x){var S=arguments.length>=3;return t(n,Rg(c,x,4),g,S)}}const ry=RS(1),Wb=RS(-1);function dh(e,t,n){var c=[];return t=Wc(t,n),Zc(e,function(g,x,S){t(g,x,S)&&c.push(g)}),c}function FS(e,t,n){return dh(e,g2(Wc(t)),n)}function yv(e,t,n){t=Wc(t,n);for(var c=!_h(e)&&pu(e),g=(c||e).length,x=0;x<g;x++){var S=c?c[x]:x;if(!t(e[S],S,e))return!1}return!0}function G_(e,t,n){t=Wc(t,n);for(var c=!_h(e)&&pu(e),g=(c||e).length,x=0;x<g;x++){var S=c?c[x]:x;if(t(e[S],S,e))return!0}return!1}function JA(e,t,n,c){return _h(e)||(e=pp(e)),(typeof n!="number"||c)&&(n=0),zS(e,t,n)>=0}const X9=Hc(function(e,t,n){var c,g;return nc(t)?g=t:(t=zg(t),c=t.slice(0,-1),t=t[t.length-1]),gc(e,function(x){var S=g;if(!S){if(c&&c.length&&(x=f2(x,c)),x==null)return;S=x[t]}return S==null?S:S.apply(x,n)})});function u1(e,t){return gc(e,p2(t))}function Y9(e,t){return dh(e,wg(t))}function y2(e,t,n){var c=-1/0,g=-1/0,x,S;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=_h(e)?e:pp(e);for(var a=0,G=e.length;a<G;a++)x=e[a],x!=null&&x>c&&(c=x)}else t=Wc(t,n),Zc(e,function(W,he,ae){S=t(W,he,ae),(S>g||S===-1/0&&c===-1/0)&&(c=W,g=S)});return c}function OS(e,t,n){var c=1/0,g=1/0,x,S;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=_h(e)?e:pp(e);for(var a=0,G=e.length;a<G;a++)x=e[a],x!=null&&x<c&&(c=x)}else t=Wc(t,n),Zc(e,function(W,he,ae){S=t(W,he,ae),(S<g||S===1/0&&c===1/0)&&(c=W,g=S)});return c}var K9=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function NS(e){return e?dp(e)?Lg.call(e):o1(e)?e.match(K9):_h(e)?gc(e,d2):pp(e):[]}function VS(e,t,n){if(t==null||n)return _h(e)||(e=pp(e)),e[gv(e.length-1)];var c=NS(e),g=jc(c);t=Math.max(Math.min(t,g),0);for(var x=g-1,S=0;S<t;S++){var a=gv(S,x),G=c[S];c[S]=c[a],c[a]=G}return c.slice(0,t)}function J9(e){return VS(e,1/0)}function US(e,t,n){var c=0;return t=Wc(t,n),u1(gc(e,function(g,x,S){return{value:g,index:c++,criteria:t(g,x,S)}}).sort(function(g,x){var S=g.criteria,a=x.criteria;if(S!==a){if(S>a||S===void 0)return 1;if(S<a||a===void 0)return-1}return g.index-x.index}),"value")}function c1(e,t){return function(n,c,g){var x=t?[[],[]]:{};return c=Wc(c,g),Zc(n,function(S,a){var G=c(S,a,n);e(x,S,G)}),x}}const eR=c1(function(e,t,n){q0(e,n)?e[n].push(t):e[n]=[t]}),tR=c1(function(e,t,n){e[n]=t}),iR=c1(function(e,t,n){q0(e,n)?e[n]++:e[n]=1}),nR=c1(function(e,t,n){e[n?0:1].push(t)},!0);function rR(e){return e==null?0:_h(e)?e.length:pu(e).length}function sR(e,t,n){return t in n}const v2=Hc(function(e,t){var n={},c=t[0];if(e==null)return n;nc(c)?(t.length>1&&(c=Rg(c,t[1])),t=Bg(e)):(c=sR,t=mp(t,!1,!1),e=Object(e));for(var g=0,x=t.length;g<x;g++){var S=t[g],a=e[S];c(a,S,e)&&(n[S]=a)}return n}),aR=Hc(function(e,t){var n=t[0],c;return nc(n)?(n=g2(n),t.length>1&&(c=t[1])):(t=gc(mp(t,!1,!1),String),n=function(g,x){return!JA(t,x)}),v2(e,n,c)});function GS(e,t,n){return Lg.call(e,0,Math.max(0,e.length-(t==null||n?1:t)))}function sy(e,t,n){return e==null||e.length<1?t==null||n?void 0:[]:t==null||n?e[0]:GS(e,e.length-t)}function Kd(e,t,n){return Lg.call(e,t==null||n?1:t)}function oR(e,t,n){return e==null||e.length<1?t==null||n?void 0:[]:t==null||n?e[e.length-1]:Kd(e,Math.max(0,e.length-t))}function qS(e){return dh(e,Boolean)}function lR(e,t){return mp(e,t,!1)}const HS=Hc(function(e,t){return t=mp(t,!0,!0),dh(e,function(n){return!JA(t,n)})}),uR=Hc(function(e,t){return HS(e,t)});function vv(e,t,n,c){K4(t)||(c=n,n=t,t=!1),n!=null&&(n=Wc(n,c));for(var g=[],x=[],S=0,a=jc(e);S<a;S++){var G=e[S],W=n?n(G,S,e):G;t&&!n?((!S||x!==W)&&g.push(G),x=W):n?JA(x,W)||(x.push(W),g.push(G)):JA(g,G)||g.push(G)}return g}const jS=Hc(function(e){return vv(mp(e,!0,!0))});function ZS(e){for(var t=[],n=arguments.length,c=0,g=jc(e);c<g;c++){var x=e[c];if(!JA(t,x)){var S;for(S=1;S<n&&JA(arguments[S],x);S++);S===n&&t.push(x)}}return t}function xv(e){for(var t=e&&y2(e,jc).length||0,n=Array(t),c=0;c<t;c++)n[c]=u1(e,c);return n}const cR=Hc(xv);function c_(e,t){for(var n={},c=0,g=jc(e);c<g;c++)t?n[e[c]]=t[c]:n[e[c][0]]=e[c][1];return n}function hR(e,t,n){t==null&&(t=e||0,e=0),n||(n=t<e?-1:1);for(var c=Math.max(Math.ceil((t-e)/n),0),g=Array(c),x=0;x<c;x++,e+=n)g[x]=e;return g}function AR(e,t){if(t==null||t<1)return[];for(var n=[],c=0,g=e.length;c<g;)n.push(Lg.call(e,c,c+=t));return n}function x2(e,t){return e._chain?ho(t).chain():t}function QS(e){return Zc(mv(e),function(t){var n=ho[t]=e[t];ho.prototype[t]=function(){var c=[this._wrapped];return Zz.apply(c,arguments),x2(this,n.apply(ho,c))}}),ho}Zc(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=a1[e];ho.prototype[e]=function(){var n=this._wrapped;return n!=null&&(t.apply(n,arguments),(e==="shift"||e==="splice")&&n.length===0&&delete n[0]),x2(this,n)}});Zc(["concat","join","slice"],function(e){var t=a1[e];ho.prototype[e]=function(){var n=this._wrapped;return n!=null&&(n=t.apply(n,arguments)),x2(this,n)}});const fR=Object.freeze(Object.defineProperty({__proto__:null,VERSION:$4,after:Z9,all:yv,allKeys:Bg,any:G_,assign:bg,before:kS,bind:CS,bindAll:N9,chain:O9,chunk:AR,clone:_S,collect:gc,compact:qS,compose:j9,constant:aS,contains:JA,countBy:iR,create:b9,debounce:q9,default:ho,defaults:A2,defer:U9,delay:TS,detect:_v,difference:HS,drop:Kd,each:Zc,escape:E9,every:yv,extend:fA,extendOwn:bg,filter:dh,find:_v,findIndex:_2,findKey:MS,findLastIndex:DS,findWhere:$9,first:sy,flatten:lR,foldl:ry,foldr:Wb,forEach:Zc,functions:mv,get:vS,groupBy:eR,has:l1,head:sy,identity:d2,include:JA,includes:JA,indexBy:tR,indexOf:zS,initial:GS,inject:ry,intersection:ZS,invert:mS,invoke:X9,isArguments:o2,isArray:dp,isArrayBuffer:tS,isBoolean:K4,isDataView:V_,isDate:t9,isElement:e9,isEmpty:A9,isEqual:f9,isError:n9,isFinite:o9,isFunction:nc,isMap:m9,isMatch:hS,isNaN:sS,isNull:Jz,isNumber:J4,isObject:fp,isRegExp:i9,isSet:_9,isString:o1,isSymbol:eS,isTypedArray:uS,isUndefined:op,isWeakMap:g9,isWeakSet:y9,iteratee:m2,keys:pu,last:oR,lastIndexOf:W9,map:gc,mapObject:bS,matcher:wg,matches:wg,max:y2,memoize:V9,methods:mv,min:OS,mixin:QS,negate:g2,noop:wS,now:Sg,object:c_,omit:aR,once:Q9,pairs:v9,partial:nf,partition:nR,pick:v2,pluck:u1,property:p2,propertyOf:S9,random:gv,range:hR,reduce:ry,reduceRight:Wb,reject:FS,rest:Kd,restArguments:Hc,result:z9,sample:VS,select:dh,shuffle:J9,size:rR,some:G_,sortBy:US,sortedIndex:LS,tail:Kd,take:sy,tap:w9,template:B9,templateSettings:k9,throttle:G9,times:I9,toArray:NS,toPath:yS,transpose:xv,unescape:T9,union:jS,uniq:vv,unique:vv,uniqueId:F9,unzip:xv,values:pp,where:Y9,without:uR,wrap:H9,zip:cR},Symbol.toStringTag,{value:"Module"}));var $b=QS(fR);$b._=$b;var dR=function(e,t){var n;return parseString(e,function(c,g){n=g["nex:nexml"].trees[0].tree.map(function(x){var S=x.node.map(ae=>ae.$),a=S.reduce(function(ae,ue){return ue.edges=[],ue.name=ue.id,ae[ue.id]=ue,ae},{}),G=S.filter(ae=>ae.root),W=G>0?G[0].id:S[0].id;a[W].name="root",x.edge.map(ae=>ae.$).forEach(function(ae){a[ae.source].edges.push(ae)});function he(ae,ue){if(ae.edges){var be=u1(ae.edges,"target");ae.children=pp(v2(a,be)),ae.children.forEach(function(je,nt){je.attribute=ae.edges[nt].length||""}),ae.children.forEach(he),ae.annotation=""}}return he(a[W]),a[W]})}),n};function pR(e,t,n,c){let g=this.nodes.descendants();if(e.parent&&g.indexOf(e)>=0){let S=e.parent.children.indexOf(e),a={name:n,parent:e.parent,attribute:c?c[2]:null,original_child_order:e.original_child_order},G={name:t,parent:a,attribute:c?c[1]:null,original_child_order:2};a.children=[e,G],e.parent.children[S]=a,e.parent=a,e.attribute=c?c[0]:null,e.original_child_order=1}return this}function mR(e,t){return e.children?e.children.push(t):e.children=[t],e}function gR(e,t){return{data:{name:e,attribute:t?t[1]:null},parent:""}}function _R(e){let t=this.nodes.descendants();if(typeof e!="number")return this.deleteANode(t.indexOf(e));if(e>0&&e<t.length){let n=t[e];if(n.parent){let c=n.parent.children.indexOf(n);c>=0&&(t.splice(e,1),n.children&&n.children.forEach(function(g){g.original_child_order=n.parent.children.length,n.parent.children.push(g),g.parent=n.parent}),n.parent.children.length>2?n.parent.children.splice(c,1):n.parent.parent?(n.parent.parent.children[n.parent.parent.children.indexOf(n.parent)]=n.parent.children[1-c],n.parent.children[1-c].parent=n.parent.parent,t.splice(t.indexOf(n.parent),1)):(t.splice(0,1),t.parent=null,delete t.data.attribute,delete t.data.annotation,delete t.data.original_child_order,t.name="root",t.data.name="root"))}}return this}function yR(){return dh(this.nodes.descendants(),e=>!l1(e,"children"))}function vR(){return dh(this.nodes.descendants(),e=>l1(e,"children"))}function xR(){return this.nodes}function bR(){return this.nodes}function wR(e){return dh(this.nodes.descendants(),t=>t.data.name==e)[0]}function SR(e){Zc(this.nodes.descendants(),function(t){t.data&&t.data.name in e&&(t.annotations=e[t.data.name])})}function Sl(e){return!l1(e,"children")}function IR(e,t){return this.nodes.each(function(n){e in n&&(t&&(n[t]=n[e]),delete n[e])}),this}function ER(e){e||this.nodes.each(t=>{Sl(t)||(t[this.selection_attribute_name]=!1,t.data.traits||(t.data.traits={}),t.data.traits[this.selection_attribute_name]=t[this.selection_attribute_name])})}function WS(e,t,n){let c=[];function g(x){Sl(x)?t&&x!=e&&c.push(x):(n&&x!=e&&c.push(x),x.children.forEach(g))}return g(e),c}const CR=Object.freeze(Object.defineProperty({__proto__:null,addChild:mR,assignAttributes:SR,clearInternalNodes:ER,createNode:gR,deleteANode:_R,getInternals:vR,getNodeByName:wR,getNodes:bR,getRootNode:xR,getTips:yR,graftANode:pR,isLeafNode:Sl,selectAllDescendants:WS,updateKeyName:IR},Symbol.toStringTag,{value:"Module"}));function Ig(e,t={}){const n=/^-?\d+(\.\d+)?$/;let c=t.left_delimiter||"{",g=t.right_delimiter||"}",x=[];function S(){let xt={name:null},Tt=x[x.length-1];"children"in Tt||(Tt.children=[]),x.push(xt),Tt.children.push(x[x.length-1]),x[x.length-1].original_child_order=Tt.children.length}function a(){let xt=x.pop();xt.name=he,"children"in xt?xt.bootstrap_values=he:xt.name=he,xt.attribute=ae,c=="["&&ue.includes("&&NHX")?ue.split(":").slice(1).forEach(Tt=>{const[Mt,Oe]=Tt.split("=");xt[Mt]=n.test(Oe)?+Oe:Oe}):xt.annotation=ue,he="",ae="",ue=""}function G(xt){return{json:null,error:"Unexpected '"+e[xt]+"' in '"+e.substring(xt-20,xt+1)+"[ERROR HERE]"+e.substring(xt+1,xt+20)+"'"}}let W=0,he="",ae="",ue="",be=null,je={"'":1,'"':1},nt={name:"root"};x.push(nt);for(var tt=/\s/,at=0;at<e.length;at++)try{var ut=e[at];switch(W){case 0:{ut=="("&&(S(),W=1);break}case 1:case 3:{if(ut==":")W=3;else if(ut==","||ut==")")try{a(),W=1,ut==","&&S()}catch{return G(at)}else if(ut=="("){if(he.length>0)return G(at);S()}else if(ut in je){if(W==1&&he.length===0&&ae.length===0&&ue.length===0){W=2,be=ut;continue}return G(at)}else if(ut==c){if(ue.length)return G(at);W=4}else if(W==3)ae+=ut;else{if(tt.test(ut))continue;if(ut==";"){at=e.length;break}he+=ut}break}case 2:{if(ut==be){if(at<e.length-1&&e[at+1]==be){at++,he+=be;continue}be=0,W=1;continue}else he+=ut;break}case 4:{if(ut==g)W=3;else{if(ut==c)return G(at);ue+=ut}break}}}catch{return G(at)}return x.length!=1?G(e.length-1):{json:nt,error:null}}function TR(e,t){let n=this;e||(e=x=>"");function c(x){if(x.notshown)return;if(Sl(x)||(g.push("("),x.children.forEach(function(a,G){G&&g.push(","),c(a)}),g.push(")")),x.data.name!=="root"){const a=x.data.name.replaceAll("'","''");/\W/.test(a)?g.push("'"+a+"'"):g.push(a)}g.push(e(x));let S=n.branch_length_accessor(x);S!==void 0&&g.push(":"+S)}let g=[];return e=e||"",c(t||this.nodes),g.join("")+";"}function kR(e){let t=e,n=t.toUpperCase().indexOf("BEGIN DATA;"),c=t.slice(n);if(c.length<2)return"";n=c.toUpperCase().indexOf("END;");let g=c.slice(0,n);c=gc(g.split(";"),G=>G.trim());let x=dh(c,G=>G.toUpperCase().startsWith("DIMENSION"));x=x[0].split(" "),x=c_(gc(Kd(x),G=>G.split("=")));let S=dh(c,G=>G.toUpperCase().startsWith("FORMAT"));S=S[0].split(" "),S=c_(gc(Kd(S),G=>G.split("="))),S.symbols=FS(S.symbols.split(""),G=>G=='"');let a=dh(c,G=>G.toUpperCase().startsWith("MATRIX"));return a=a[0].split(`
`),a=c_(gc(Kd(a),G=>qS(G.split(" ")))),a=bS(a,(G,W)=>G=="?"?S.symbols:Array(G)),{dimensions:x,format:S,matrix:a}}function MR(e,t,n){Zc(e.getTips(),c=>{c.data.test=n.matrix[c.data.name]})}function $S(e){let t=e,n=t.toUpperCase().indexOf("BEGIN TREES;"),c=t.slice(n);if(c.length<2)return"";n=c.toUpperCase().indexOf("END;");let x=c.slice(0,n).split(`
`);return x=dh(x,S=>S.trim().toUpperCase().startsWith("TREE")),Ig(x[0])}const PR=Object.freeze(Object.defineProperty({__proto__:null,default:$S,loadAnnotations:MR,parseAnnotations:kR},Symbol.toStringTag,{value:"Module"}));function bv(e){var t={};if(e.nodeType==1){if(e.attributes.length>0){t["@attributes"]={};for(var n=0;n<e.attributes.length;n++){var c=e.attributes.item(n);t["@attributes"][c.nodeName]=c.nodeValue}}}else e.nodeType==3&&(t=e.nodeValue);if(e.hasChildNodes()&&e.childNodes.length===1&&e.childNodes[0].nodeType===3)t=e.childNodes[0].nodeValue;else if(e.hasChildNodes())for(var g=0;g<e.childNodes.length;g++){var x=e.childNodes.item(g),S=x.nodeName;if(typeof t[S]>"u")t[S]=bv(x);else{if(typeof t[S].push>"u"){var a=t[S];t[S]=[],t[S].push(a)}t[S].push(bv(x))}}return t}var XS=function(e,t){function n(g,x){g.clade&&(g.clade.forEach(n),g.children=g.clade,delete g.clade),g.annotation=1,g.attribute="0.01",g.branch_length&&(g.attribute=g.branch_length),g.taxonomy&&(g.name=g.taxonomy.scientific_name),g.annotation=""}var c;return e=bv(e),c=e.phyloxml.phylogeny.clade,c.name="root",n(c),{json:c,error:null}};function DR(e,t){t.left_delimiter="[",t.right_delimiter="]";const n=Ig(e,t);function c(g){if(g.annotation){g.beast={};const S=g.annotation.split(/=|,|{|}/).filter(a=>a);for(var x=0;x<S.length;x+=2){let a=S[x].replace(/&|%/g,"");/[a-df-zA-DF-Z]+/.test(S[x+2])?g.beast[a]=+S[x+1]:(g.beast[a]=[+S[x+1],+S[x+2]],x++)}}g.annotation=void 0,g.children&&g.children.forEach(c)}return c(n.json),n}var ay={nexml:dR,phyloxml:XS,nexus:$S,nwk:Ig,nhx:Ig,beast:DR};function LR(){let t=this.getTips(),n=gc(t,c=>({name:c.data.name,length:parseFloat(c.data.attribute)}));return n=US(n,c=>-c.length),n}function BR(e,t){function n(g,x){if(x.mp=[[0,0],[!1,!1]],Sl(x))x.mp[1][0]=x.mp[1][1]=x[g]||!1,x.mp[0][0]=x.mp[1][0]?1:0,x.mp[0][1]=1-x.mp[0][0];else{x.children.forEach(c);var S=x.children.reduce(function(G,W){return W.mp[0][0]+G},0),a=x.children.reduce(function(G,W){return W.mp[0][1]+G},0);x[g]?(x.mp[0][0]=a+1,x.mp[1][0]=!0,x.mp[0][1]=a,x.mp[1][1]=!0):(S<a+1?(x.mp[0][0]=S,x.mp[1][0]=!1):(x.mp[0][0]=a+1,x.mp[1][0]=!0),a<S+1?(x.mp[0][1]=a,x.mp[1][1]=!0):(x.mp[0][1]=S+1,x.mp[1][1]=!1))}}const c=nf(n,t);c(this.nodes),this.nodes.each(g=>{g.parent?g.mp=g.mp[1][g.parent.mp?1:0]:g.mp=g.mp[1][g.mp[0][0]<g.mp[0][1]?0:1]}),this.display.modifySelection((g,x)=>Sl(g.target)?g.target[t]:g.target.mp)}var q_={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */q_.exports;(function(e,t){(function(){var n,c="4.17.21",g=200,x="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",S="Expected a function",a="Invalid `variable` option passed into `_.template`",G="__lodash_hash_undefined__",W=500,he="__lodash_placeholder__",ae=1,ue=2,be=4,je=1,nt=2,tt=1,at=2,ut=4,xt=8,Tt=16,Mt=32,Oe=64,jt=128,it=256,vt=512,mt=30,Et="...",Pt=800,dt=16,Je=1,pt=2,lt=3,Nt=1/0,zt=9007199254740991,Ot=17976931348623157e292,gi=NaN,wi=4294967295,Ti=wi-1,Ni=wi>>>1,en=[["ary",jt],["bind",tt],["bindKey",at],["curry",xt],["curryRight",Tt],["flip",vt],["partial",Mt],["partialRight",Oe],["rearg",it]],ji="[object Arguments]",Vi="[object Array]",nn="[object AsyncFunction]",vn="[object Boolean]",Ci="[object Date]",mi="[object DOMException]",Ri="[object Error]",Oi="[object Function]",_i="[object GeneratorFunction]",Ji="[object Map]",Ai="[object Number]",sn="[object Null]",ei="[object Object]",_n="[object Promise]",Pr="[object Proxy]",ci="[object RegExp]",rn="[object Set]",tr="[object String]",Pn="[object Symbol]",Qn="[object Undefined]",In="[object WeakMap]",v="[object WeakSet]",k="[object ArrayBuffer]",V="[object DataView]",Y="[object Float32Array]",te="[object Float64Array]",fe="[object Int8Array]",ve="[object Int16Array]",Ie="[object Int32Array]",Ee="[object Uint8Array]",ze="[object Uint8ClampedArray]",We="[object Uint16Array]",He="[object Uint32Array]",Qe=/\b__p \+= '';/g,Ue=/\b(__p \+=) '' \+/g,ft=/(__e\(.*?\)|\b__t\)) \+\n'';/g,st=/&(?:amp|lt|gt|quot|#39);/g,Me=/[&<>"']/g,se=RegExp(st.source),ne=RegExp(Me.source),$=/<%-([\s\S]+?)%>/g,ie=/<%([\s\S]+?)%>/g,de=/<%=([\s\S]+?)%>/g,ye=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ge=/^\w*$/,Pe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Fe=/[\\^$.*+?()[\]{}|]/g,Ve=RegExp(Fe.source),Xe=/^\s+/,Ye=/\s/,De=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ge=/\{\n\/\* \[wrapped with (.+)\] \*/,ht=/,? & /,kt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,o=/[()=,{}\[\]\/\s]/,ke=/\\(\\)?/g,ai=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,fi=/\w*$/,hi=/^[-+]0x[0-9a-f]+$/i,Jt=/^0b[01]+$/i,oi=/^\[object .+?Constructor\]$/,zi=/^0o[0-7]+$/i,xi=/^(?:0|[1-9]\d*)$/,Si=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Yt=/($^)/,bn=/['\n\r\u2028\u2029\\]/g,or="\\ud800-\\udfff",mn="\\u0300-\\u036f",qn="\\ufe20-\\ufe2f",jr="\\u20d0-\\u20ff",Zi=mn+qn+jr,ur="\\u2700-\\u27bf",Vn="a-z\\xdf-\\xf6\\xf8-\\xff",Wt="\\xac\\xb1\\xd7\\xf7",Ki="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ut="\\u2000-\\u206f",Tn=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",cr="A-Z\\xc0-\\xd6\\xd8-\\xde",Vs="\\ufe0e\\ufe0f",Ur=Wt+Ki+Ut+Tn,Vt="[']",hr="["+or+"]",Bt="["+Ur+"]",Fr="["+Zi+"]",Us="\\d+",ua="["+ur+"]",Dr="["+Vn+"]",Na="[^"+or+Ur+Us+ur+Vn+cr+"]",Fo="\\ud83c[\\udffb-\\udfff]",Va="(?:"+Fr+"|"+Fo+")",Xs="[^"+or+"]",Zn="(?:\\ud83c[\\udde6-\\uddff]){2}",aa="[\\ud800-\\udbff][\\udc00-\\udfff]",hs="["+cr+"]",Ua="\\u200d",al="(?:"+Dr+"|"+Na+")",ol="(?:"+hs+"|"+Na+")",no="(?:"+Vt+"(?:d|ll|m|re|s|t|ve))?",Ga="(?:"+Vt+"(?:D|LL|M|RE|S|T|VE))?",N=Va+"?",xe="["+Vs+"]?",rt="(?:"+Ua+"(?:"+[Xs,Zn,aa].join("|")+")"+xe+N+")*",St="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",$t="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ii=xe+N+rt,Li="(?:"+[ua,Zn,aa].join("|")+")"+Ii,An="(?:"+[Xs+Fr+"?",Fr,Zn,aa,hr].join("|")+")",pn=RegExp(Vt,"g"),sr=RegExp(Fr,"g"),Ar=RegExp(Fo+"(?="+Fo+")|"+An+Ii,"g"),Or=RegExp([hs+"?"+Dr+"+"+no+"(?="+[Bt,hs,"$"].join("|")+")",ol+"+"+Ga+"(?="+[Bt,hs+al,"$"].join("|")+")",hs+"?"+al+"+"+no,hs+"+"+Ga,$t,St,Us,Li].join("|"),"g"),qa=RegExp("["+Ua+or+Zi+Vs+"]"),Ha=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ja=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],pl=-1,Gr={};Gr[Y]=Gr[te]=Gr[fe]=Gr[ve]=Gr[Ie]=Gr[Ee]=Gr[ze]=Gr[We]=Gr[He]=!0,Gr[ji]=Gr[Vi]=Gr[k]=Gr[vn]=Gr[V]=Gr[Ci]=Gr[Ri]=Gr[Oi]=Gr[Ji]=Gr[Ai]=Gr[ei]=Gr[ci]=Gr[rn]=Gr[tr]=Gr[In]=!1;var nr={};nr[ji]=nr[Vi]=nr[k]=nr[V]=nr[vn]=nr[Ci]=nr[Y]=nr[te]=nr[fe]=nr[ve]=nr[Ie]=nr[Ji]=nr[Ai]=nr[ei]=nr[ci]=nr[rn]=nr[tr]=nr[Pn]=nr[Ee]=nr[ze]=nr[We]=nr[He]=!0,nr[Ri]=nr[Oi]=nr[In]=!1;var Ir={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Lr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Zs={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},vr={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ks=parseFloat,Br=parseInt,Eo=typeof Jf=="object"&&Jf&&Jf.Object===Object&&Jf,Zo=typeof self=="object"&&self&&self.Object===Object&&self,Bs=Eo||Zo||Function("return this")(),Il=t&&!t.nodeType&&t,mo=Il&&!0&&e&&!e.nodeType&&e,Qo=mo&&mo.exports===Il,ca=Qo&&Eo.process,Ys=function(){try{var pi=mo&&mo.require&&mo.require("util").types;return pi||ca&&ca.binding&&ca.binding("util")}catch{}}(),El=Ys&&Ys.isArrayBuffer,Za=Ys&&Ys.isDate,Ta=Ys&&Ys.isMap,ml=Ys&&Ys.isRegExp,Cl=Ys&&Ys.isSet,mu=Ys&&Ys.isTypedArray;function As(pi,Ui,Di){switch(Di.length){case 0:return pi.call(Ui);case 1:return pi.call(Ui,Di[0]);case 2:return pi.call(Ui,Di[0],Di[1]);case 3:return pi.call(Ui,Di[0],Di[1],Di[2])}return pi.apply(Ui,Di)}function ac(pi,Ui,Di,Ft){for(var ii=-1,bi=pi==null?0:pi.length;++ii<bi;){var Fi=pi[ii];Ui(Ft,Fi,Di(Fi),pi)}return Ft}function ro(pi,Ui){for(var Di=-1,Ft=pi==null?0:pi.length;++Di<Ft&&Ui(pi[Di],Di,pi)!==!1;);return pi}function so(pi,Ui){for(var Di=pi==null?0:pi.length;Di--&&Ui(pi[Di],Di,pi)!==!1;);return pi}function Ql(pi,Ui){for(var Di=-1,Ft=pi==null?0:pi.length;++Di<Ft;)if(!Ui(pi[Di],Di,pi))return!1;return!0}function Oo(pi,Ui){for(var Di=-1,Ft=pi==null?0:pi.length,ii=0,bi=[];++Di<Ft;){var Fi=pi[Di];Ui(Fi,Di,pi)&&(bi[ii++]=Fi)}return bi}function Wo(pi,Ui){var Di=pi==null?0:pi.length;return!!Di&&Ko(pi,Ui,0)>-1}function Co(pi,Ui,Di){for(var Ft=-1,ii=pi==null?0:pi.length;++Ft<ii;)if(Di(Ui,pi[Ft]))return!0;return!1}function Gs(pi,Ui){for(var Di=-1,Ft=pi==null?0:pi.length,ii=Array(Ft);++Di<Ft;)ii[Di]=Ui(pi[Di],Di,pi);return ii}function $o(pi,Ui){for(var Di=-1,Ft=Ui.length,ii=pi.length;++Di<Ft;)pi[ii+Di]=Ui[Di];return pi}function Xo(pi,Ui,Di,Ft){var ii=-1,bi=pi==null?0:pi.length;for(Ft&&bi&&(Di=pi[++ii]);++ii<bi;)Di=Ui(Di,pi[ii],ii,pi);return Di}function Yo(pi,Ui,Di,Ft){var ii=pi==null?0:pi.length;for(Ft&&ii&&(Di=pi[--ii]);ii--;)Di=Ui(Di,pi[ii],ii,pi);return Di}function ba(pi,Ui){for(var Di=-1,Ft=pi==null?0:pi.length;++Di<Ft;)if(Ui(pi[Di],Di,pi))return!0;return!1}var Qa=fr("length");function Cs(pi){return pi.split("")}function gu(pi){return pi.match(kt)||[]}function Er(pi,Ui,Di){var Ft;return Di(pi,function(ii,bi,Fi){if(Ui(ii,bi,Fi))return Ft=bi,!1}),Ft}function $n(pi,Ui,Di,Ft){for(var ii=pi.length,bi=Di+(Ft?1:-1);Ft?bi--:++bi<ii;)if(Ui(pi[bi],bi,pi))return bi;return-1}function Ko(pi,Ui,Di){return Ui===Ui?Nr(pi,Ui,Di):$n(pi,Wa,Di)}function zr(pi,Ui,Di,Ft){for(var ii=Di-1,bi=pi.length;++ii<bi;)if(Ft(pi[ii],Ui))return ii;return-1}function Wa(pi){return pi!==pi}function Jr(pi,Ui){var Di=pi==null?0:pi.length;return Di?es(pi,Ui)/Di:gi}function fr(pi){return function(Ui){return Ui==null?n:Ui[pi]}}function To(pi){return function(Ui){return pi==null?n:pi[Ui]}}function Gn(pi,Ui,Di,Ft,ii){return ii(pi,function(bi,Fi,Bn){Di=Ft?(Ft=!1,bi):Ui(Di,bi,Fi,Bn)}),Di}function Ol(pi,Ui){var Di=pi.length;for(pi.sort(Ui);Di--;)pi[Di]=pi[Di].value;return pi}function es(pi,Ui){for(var Di,Ft=-1,ii=pi.length;++Ft<ii;){var bi=Ui(pi[Ft]);bi!==n&&(Di=Di===n?bi:Di+bi)}return Di}function Zr(pi,Ui){for(var Di=-1,Ft=Array(pi);++Di<pi;)Ft[Di]=Ui(Di);return Ft}function Ts(pi,Ui){return Gs(Ui,function(Di){return[Di,pi[Di]]})}function kr(pi){return pi&&pi.slice(0,Sa(pi)+1).replace(Xe,"")}function rr(pi){return function(Ui){return pi(Ui)}}function ll(pi,Ui){return Gs(Ui,function(Di){return pi[Di]})}function Xr(pi,Ui){return pi.has(Ui)}function ko(pi,Ui){for(var Di=-1,Ft=pi.length;++Di<Ft&&Ko(Ui,pi[Di],0)>-1;);return Di}function ul(pi,Ui){for(var Di=pi.length;Di--&&Ko(Ui,pi[Di],0)>-1;);return Di}function Qr(pi,Ui){for(var Di=pi.length,Ft=0;Di--;)pi[Di]===Ui&&++Ft;return Ft}var ds=To(Ir),wa=To(Lr);function Tl(pi){return"\\"+vr[pi]}function Mo(pi,Ui){return pi==null?n:pi[Ui]}function kl(pi){return qa.test(pi)}function go(pi){return Ha.test(pi)}function Js(pi){for(var Ui,Di=[];!(Ui=pi.next()).done;)Di.push(Ui.value);return Di}function qs(pi){var Ui=-1,Di=Array(pi.size);return pi.forEach(function(Ft,ii){Di[++Ui]=[ii,Ft]}),Di}function $a(pi,Ui){return function(Di){return pi(Ui(Di))}}function Jo(pi,Ui){for(var Di=-1,Ft=pi.length,ii=0,bi=[];++Di<Ft;){var Fi=pi[Di];(Fi===Ui||Fi===he)&&(pi[Di]=he,bi[ii++]=Di)}return bi}function Yr(pi){var Ui=-1,Di=Array(pi.size);return pi.forEach(function(Ft){Di[++Ui]=Ft}),Di}function mr(pi){var Ui=-1,Di=Array(pi.size);return pi.forEach(function(Ft){Di[++Ui]=[Ft,Ft]}),Di}function Nr(pi,Ui,Di){for(var Ft=Di-1,ii=pi.length;++Ft<ii;)if(pi[Ft]===Ui)return Ft;return-1}function ha(pi,Ui,Di){for(var Ft=Di+1;Ft--;)if(pi[Ft]===Ui)return Ft;return Ft}function _o(pi){return kl(pi)?Xa(pi):Qa(pi)}function ea(pi){return kl(pi)?cl(pi):Cs(pi)}function Sa(pi){for(var Ui=pi.length;Ui--&&Ye.test(pi.charAt(Ui)););return Ui}var ka=To(Zs);function Xa(pi){for(var Ui=Ar.lastIndex=0;Ar.test(pi);)++Ui;return Ui}function cl(pi){return pi.match(Ar)||[]}function lu(pi){return pi.match(Or)||[]}var gl=function pi(Ui){Ui=Ui==null?Bs:ao.defaults(Bs.Object(),Ui,ao.pick(Bs,ja));var Di=Ui.Array,Ft=Ui.Date,ii=Ui.Error,bi=Ui.Function,Fi=Ui.Math,Bn=Ui.Object,Hn=Ui.RegExp,lr=Ui.String,Xn=Ui.TypeError,Hs=Di.prototype,ks=bi.prototype,ps=Bn.prototype,Ya=Ui["__core-js_shared__"],yo=ks.toString,rs=ps.hasOwnProperty,Wu=0,Ru=function(){var P=/[^.]+$/.exec(Ya&&Ya.keys&&Ya.keys.IE_PROTO||"");return P?"Symbol(src)_1."+P:""}(),vo=ps.toString,Ml=yo.call(Bn),Dn=Bs._,Ma=Hn("^"+yo.call(rs).replace(Fe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Sn=Qo?Ui.Buffer:n,No=Ui.Symbol,Nl=Ui.Uint8Array,En=Sn?Sn.allocUnsafe:n,Wl=$a(Bn.getPrototypeOf,Bn),Cn=Bn.create,_l=ps.propertyIsEnumerable,uu=Hs.splice,Fu=No?No.isConcatSpreadable:n,Vl=No?No.iterator:n,yl=No?No.toStringTag:n,ta=function(){try{var P=Jh(Bn,"defineProperty");return P({},"",{}),P}catch{}}(),oc=Ui.clearTimeout!==Bs.clearTimeout&&Ui.clearTimeout,$u=Ft&&Ft.now!==Bs.Date.now&&Ft.now,$l=Ui.setTimeout!==Bs.setTimeout&&Ui.setTimeout,ms=Fi.ceil,_a=Fi.floor,el=Bn.getOwnPropertySymbols,_u=Sn?Sn.isBuffer:n,Ou=Ui.isFinite,cu=Hs.join,Nu=$a(Bn.keys,Bn),_r=Fi.max,gs=Fi.min,gn=Ft.now,jn=Ui.parseInt,Jn=Fi.random,tl=Hs.reverse,Tu=Jh(Ui,"DataView"),oa=Jh(Ui,"Map"),yu=Jh(Ui,"Promise"),vs=Jh(Ui,"Set"),Po=Jh(Ui,"WeakMap"),Mi=Jh(Bn,"create"),Bi=Po&&new Po,xs={},vu=th(Tu),Vo=th(oa),fs=th(yu),hl=th(vs),Ms=th(Po),C=No?No.prototype:n,D=C?C.valueOf:n,z=C?C.toString:n;function R(P){if(Rt(P)&&!f(P)&&!(P instanceof we)){if(P instanceof oe)return P;if(rs.call(P,"__wrapped__"))return hd(P)}return new oe(P)}var ee=function(){function P(){}return function(H){if(!Lt(H))return{};if(Cn)return Cn(H);P.prototype=H;var pe=new P;return P.prototype=n,pe}}();function le(){}function oe(P,H){this.__wrapped__=P,this.__actions__=[],this.__chain__=!!H,this.__index__=0,this.__values__=n}R.templateSettings={escape:$,evaluate:ie,interpolate:de,variable:"",imports:{_:R}},R.prototype=le.prototype,R.prototype.constructor=R,oe.prototype=ee(le.prototype),oe.prototype.constructor=oe;function we(P){this.__wrapped__=P,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=wi,this.__views__=[]}function $e(){var P=new we(this.__wrapped__);return P.__actions__=xl(this.__actions__),P.__dir__=this.__dir__,P.__filtered__=this.__filtered__,P.__iteratees__=xl(this.__iteratees__),P.__takeCount__=this.__takeCount__,P.__views__=xl(this.__views__),P}function _t(){if(this.__filtered__){var P=new we(this);P.__dir__=-1,P.__filtered__=!0}else P=this.clone(),P.__dir__*=-1;return P}function Ct(){var P=this.__wrapped__.value(),H=this.__dir__,pe=f(P),Ze=H<0,wt=pe?P.length:0,qt=Mm(0,wt,this.__views__),li=qt.start,di=qt.end,Pi=di-li,hn=Ze?di:li-1,fn=this.__iteratees__,xn=fn.length,Yn=0,xr=gs(Pi,this.__takeCount__);if(!pe||!Ze&&wt==Pi&&xr==Pi)return A0(P,this.__actions__);var Wr=[];e:for(;Pi--&&Yn<xr;){hn+=H;for(var js=-1,$r=P[hn];++js<xn;){var sa=fn[js],da=sa.iteratee,hh=sa.type,pc=da($r);if(hh==pt)$r=pc;else if(!pc){if(hh==Je)continue e;break e}}Wr[Yn++]=$r}return Wr}we.prototype=ee(le.prototype),we.prototype.constructor=we;function ni(P){var H=-1,pe=P==null?0:P.length;for(this.clear();++H<pe;){var Ze=P[H];this.set(Ze[0],Ze[1])}}function Gt(){this.__data__=Mi?Mi(null):{},this.size=0}function Zt(P){var H=this.has(P)&&delete this.__data__[P];return this.size-=H?1:0,H}function Z(P){var H=this.__data__;if(Mi){var pe=H[P];return pe===G?n:pe}return rs.call(H,P)?H[P]:n}function A(P){var H=this.__data__;return Mi?H[P]!==n:rs.call(H,P)}function E(P,H){var pe=this.__data__;return this.size+=this.has(P)?0:1,pe[P]=Mi&&H===n?G:H,this}ni.prototype.clear=Gt,ni.prototype.delete=Zt,ni.prototype.get=Z,ni.prototype.has=A,ni.prototype.set=E;function F(P){var H=-1,pe=P==null?0:P.length;for(this.clear();++H<pe;){var Ze=P[H];this.set(Ze[0],Ze[1])}}function O(){this.__data__=[],this.size=0}function y(P){var H=this.__data__,pe=ti(H,P);if(pe<0)return!1;var Ze=H.length-1;return pe==Ze?H.pop():uu.call(H,pe,1),--this.size,!0}function s(P){var H=this.__data__,pe=ti(H,P);return pe<0?n:H[pe][1]}function i(P){return ti(this.__data__,P)>-1}function r(P,H){var pe=this.__data__,Ze=ti(pe,P);return Ze<0?(++this.size,pe.push([P,H])):pe[Ze][1]=H,this}F.prototype.clear=O,F.prototype.delete=y,F.prototype.get=s,F.prototype.has=i,F.prototype.set=r;function l(P){var H=-1,pe=P==null?0:P.length;for(this.clear();++H<pe;){var Ze=P[H];this.set(Ze[0],Ze[1])}}function d(){this.size=0,this.__data__={hash:new ni,map:new(oa||F),string:new ni}}function _(P){var H=wf(this,P).delete(P);return this.size-=H?1:0,H}function w(P){return wf(this,P).get(P)}function T(P){return wf(this,P).has(P)}function B(P,H){var pe=wf(this,P),Ze=pe.size;return pe.set(P,H),this.size+=pe.size==Ze?0:1,this}l.prototype.clear=d,l.prototype.delete=_,l.prototype.get=w,l.prototype.has=T,l.prototype.set=B;function j(P){var H=-1,pe=P==null?0:P.length;for(this.__data__=new l;++H<pe;)this.add(P[H])}function X(P){return this.__data__.set(P,G),this}function ce(P){return this.__data__.has(P)}j.prototype.add=j.prototype.push=X,j.prototype.has=ce;function Se(P){var H=this.__data__=new F(P);this.size=H.size}function Te(){this.__data__=new F,this.size=0}function Re(P){var H=this.__data__,pe=H.delete(P);return this.size=H.size,pe}function Be(P){return this.__data__.get(P)}function Ke(P){return this.__data__.has(P)}function yt(P,H){var pe=this.__data__;if(pe instanceof F){var Ze=pe.__data__;if(!oa||Ze.length<g-1)return Ze.push([P,H]),this.size=++pe.size,this;pe=this.__data__=new l(Ze)}return pe.set(P,H),this.size=pe.size,this}Se.prototype.clear=Te,Se.prototype.delete=Re,Se.prototype.get=Be,Se.prototype.has=Ke,Se.prototype.set=yt;function ot(P,H){var pe=f(P),Ze=!pe&&Ne(P),wt=!pe&&!Ze&&U(P),qt=!pe&&!Ze&&!wt&&Nn(P),li=pe||Ze||wt||qt,di=li?Zr(P.length,lr):[],Pi=di.length;for(var hn in P)(H||rs.call(P,hn))&&!(li&&(hn=="length"||wt&&(hn=="offset"||hn=="parent")||qt&&(hn=="buffer"||hn=="byteLength"||hn=="byteOffset")||Mc(hn,Pi)))&&di.push(hn);return di}function ct(P){var H=P.length;return H?P[mA(0,H-1)]:n}function It(P,H){return If(xl(P),qi(H,0,P.length))}function bt(P){return If(xl(P))}function ri(P,H,pe){(pe!==n&&!J(P[H],pe)||pe===n&&!(H in P))&&Ei(P,H,pe)}function Xt(P,H,pe){var Ze=P[H];(!(rs.call(P,H)&&J(Ze,pe))||pe===n&&!(H in P))&&Ei(P,H,pe)}function ti(P,H){for(var pe=P.length;pe--;)if(J(P[pe][0],H))return pe;return-1}function si(P,H,pe,Ze){return er(P,function(wt,qt,li){H(Ze,wt,pe(wt),li)}),Ze}function Qi(P,H){return P&&uc(H,co(H),P)}function Wi(P,H){return P&&uc(H,So(H),P)}function Ei(P,H,pe){H=="__proto__"&&ta?ta(P,H,{configurable:!0,enumerable:!0,value:pe,writable:!0}):P[H]=pe}function Gi(P,H){for(var pe=-1,Ze=H.length,wt=Di(Ze),qt=P==null;++pe<Ze;)wt[pe]=qt?n:Jl(P,H[pe]);return wt}function qi(P,H,pe){return P===P&&(pe!==n&&(P=P<=pe?P:pe),H!==n&&(P=P>=H?P:H)),P}function cn(P,H,pe,Ze,wt,qt){var li,di=H&ae,Pi=H&ue,hn=H&be;if(pe&&(li=wt?pe(P,Ze,wt,qt):pe(P)),li!==n)return li;if(!Lt(P))return P;var fn=f(P);if(fn){if(li=Dm(P),!di)return xl(P,li)}else{var xn=Ul(P),Yn=xn==Oi||xn==_i;if(U(P))return $0(P,di);if(xn==ei||xn==ji||Yn&&!wt){if(li=Pi||Yn?{}:id(P),!di)return Pi?gf(P,Wi(li,P)):Qh(P,Qi(li,P))}else{if(!nr[xn])return wt?P:{};li=eA(P,xn,di)}}qt||(qt=new Se);var xr=qt.get(P);if(xr)return xr;qt.set(P,li),an(P)?P.forEach(function($r){li.add(cn($r,H,pe,$r,P,qt))}):Kt(P)&&P.forEach(function($r,sa){li.set(sa,cn($r,H,pe,sa,P,qt))});var Wr=hn?Pi?bf:Eh:Pi?So:co,js=fn?n:Wr(P);return ro(js||P,function($r,sa){js&&(sa=$r,$r=P[sa]),Xt(li,sa,cn($r,H,pe,sa,P,qt))}),li}function zn(P){var H=co(P);return function(pe){return tn(pe,P,H)}}function tn(P,H,pe){var Ze=pe.length;if(P==null)return!Ze;for(P=Bn(P);Ze--;){var wt=pe[Ze],qt=H[wt],li=P[wt];if(li===n&&!(wt in P)||!qt(li))return!1}return!0}function kn(P,H,pe){if(typeof P!="function")throw new Xn(S);return MA(function(){P.apply(n,pe)},H)}function yr(P,H,pe,Ze){var wt=-1,qt=Wo,li=!0,di=P.length,Pi=[],hn=H.length;if(!di)return Pi;pe&&(H=Gs(H,rr(pe))),Ze?(qt=Co,li=!1):H.length>=g&&(qt=Xr,li=!1,H=new j(H));e:for(;++wt<di;){var fn=P[wt],xn=pe==null?fn:pe(fn);if(fn=Ze||fn!==0?fn:0,li&&xn===xn){for(var Yn=hn;Yn--;)if(H[Yn]===xn)continue e;Pi.push(fn)}else qt(H,xn,Ze)||Pi.push(fn)}return Pi}var er=f0(bo),Ia=f0(Qs,!0);function Aa(P,H){var pe=!0;return er(P,function(Ze,wt,qt){return pe=!!H(Ze,wt,qt),pe}),pe}function zs(P,H,pe){for(var Ze=-1,wt=P.length;++Ze<wt;){var qt=P[Ze],li=H(qt);if(li!=null&&(di===n?li===li&&!Ln(li):pe(li,di)))var di=li,Pi=qt}return Pi}function oo(P,H,pe,Ze){var wt=P.length;for(pe=Wn(pe),pe<0&&(pe=-pe>wt?0:wt+pe),Ze=Ze===n||Ze>wt?wt:Wn(Ze),Ze<0&&(Ze+=wt),Ze=pe>Ze?0:ws(Ze);pe<Ze;)P[pe++]=H;return P}function lo(P,H){var pe=[];return er(P,function(Ze,wt,qt){H(Ze,wt,qt)&&pe.push(Ze)}),pe}function qr(P,H,pe,Ze,wt){var qt=-1,li=P.length;for(pe||(pe=Ep),wt||(wt=[]);++qt<li;){var di=P[qt];H>0&&pe(di)?H>1?qr(di,H-1,pe,Ze,wt):$o(wt,di):Ze||(wt[wt.length]=di)}return wt}var ya=_f(),xo=_f(!0);function bo(P,H){return P&&ya(P,H,co)}function Qs(P,H){return P&&xo(P,H,co)}function ts(P,H){return Oo(H,function(pe){return At(P[pe])})}function is(P,H){H=bh(H,P);for(var pe=0,Ze=H.length;P!=null&&pe<Ze;)P=P[ys(H[pe++])];return pe&&pe==Ze?P:n}function Rr(P,H,pe){var Ze=H(P);return f(P)?Ze:$o(Ze,pe(P))}function bs(P){return P==null?P===n?Qn:sn:yl&&yl in Bn(P)?Sf(P):ad(P)}function Ws(P,H){return P>H}function Do(P,H){return P!=null&&rs.call(P,H)}function Uo(P,H){return P!=null&&H in Bn(P)}function Go(P,H,pe){return P>=gs(H,pe)&&P<_r(H,pe)}function Ic(P,H,pe){for(var Ze=pe?Co:Wo,wt=P[0].length,qt=P.length,li=qt,di=Di(qt),Pi=1/0,hn=[];li--;){var fn=P[li];li&&H&&(fn=Gs(fn,rr(H))),Pi=gs(fn.length,Pi),di[li]=!pe&&(H||wt>=120&&fn.length>=120)?new j(li&&fn):n}fn=P[0];var xn=-1,Yn=di[0];e:for(;++xn<wt&&hn.length<Pi;){var xr=fn[xn],Wr=H?H(xr):xr;if(xr=pe||xr!==0?xr:0,!(Yn?Xr(Yn,Wr):Ze(hn,Wr,pe))){for(li=qt;--li;){var js=di[li];if(!(js?Xr(js,Wr):Ze(P[li],Wr,pe)))continue e}Yn&&Yn.push(Wr),hn.push(xr)}}return hn}function $s(P,H,pe,Ze){return bo(P,function(wt,qt,li){H(Ze,pe(wt),qt,li)}),Ze}function Xl(P,H,pe){H=bh(H,P),P=ld(P,H);var Ze=P==null?P:P[ys(ku(H))];return Ze==null?n:As(Ze,P,pe)}function hu(P){return Rt(P)&&bs(P)==ji}function il(P){return Rt(P)&&bs(P)==k}function vl(P){return Rt(P)&&bs(P)==Ci}function Pl(P,H,pe,Ze,wt){return P===H?!0:P==null||H==null||!Rt(P)&&!Rt(H)?P!==P&&H!==H:Au(P,H,pe,Ze,Pl,wt)}function Au(P,H,pe,Ze,wt,qt){var li=f(P),di=f(H),Pi=li?Vi:Ul(P),hn=di?Vi:Ul(H);Pi=Pi==ji?ei:Pi,hn=hn==ji?ei:hn;var fn=Pi==ei,xn=hn==ei,Yn=Pi==hn;if(Yn&&U(P)){if(!U(H))return!1;li=!0,fn=!1}if(Yn&&!fn)return qt||(qt=new Se),li||Nn(P)?J0(P,H,pe,Ze,wt,qt):Ih(P,H,Pi,pe,Ze,wt,qt);if(!(pe&je)){var xr=fn&&rs.call(P,"__wrapped__"),Wr=xn&&rs.call(H,"__wrapped__");if(xr||Wr){var js=xr?P.value():P,$r=Wr?H.value():H;return qt||(qt=new Se),wt(js,$r,pe,Ze,qt)}}return Yn?(qt||(qt=new Se),km(P,H,pe,Ze,wt,qt)):!1}function af(P){return Rt(P)&&Ul(P)==Ji}function Vh(P,H,pe,Ze){var wt=pe.length,qt=wt,li=!Ze;if(P==null)return!qt;for(P=Bn(P);wt--;){var di=pe[wt];if(li&&di[2]?di[1]!==P[di[0]]:!(di[0]in P))return!1}for(;++wt<qt;){di=pe[wt];var Pi=di[0],hn=P[Pi],fn=di[1];if(li&&di[2]){if(hn===n&&!(Pi in P))return!1}else{var xn=new Se;if(Ze)var Yn=Ze(hn,fn,Pi,P,H,xn);if(!(Yn===n?Pl(fn,hn,je|nt,Ze,xn):Yn))return!1}}return!0}function Pa(P){if(!Lt(P)||Cp(P))return!1;var H=At(P)?Ma:oi;return H.test(th(P))}function pA(P){return Rt(P)&&bs(P)==ci}function yh(P){return Rt(P)&&Ul(P)==rn}function Uh(P){return Rt(P)&&Dt(P.length)&&!!Gr[bs(P)]}function Ec(P){return typeof P=="function"?P:P==null?Oc:typeof P=="object"?f(P)?of(P[0],P[1]):qh(P):O2(P)}function Gh(P){if(!TA(P))return Nu(P);var H=[];for(var pe in Bn(P))rs.call(P,pe)&&pe!="constructor"&&H.push(pe);return H}function l0(P){if(!Lt(P))return Al(P);var H=TA(P),pe=[];for(var Ze in P)Ze=="constructor"&&(H||!rs.call(P,Ze))||pe.push(Ze);return pe}function $c(P,H){return P<H}function _p(P,H){var pe=-1,Ze=p(P)?Di(P.length):[];return er(P,function(wt,qt,li){Ze[++pe]=H(wt,qt,li)}),Ze}function qh(P){var H=ed(P);return H.length==1&&H[0][2]?sd(H[0][0],H[0][1]):function(pe){return pe===P||Vh(pe,P,H)}}function of(P,H){return CA(P)&&m0(H)?sd(ys(P),H):function(pe){var Ze=Jl(pe,P);return Ze===n&&Ze===H?sA(pe,P):Pl(H,Ze,je|nt)}}function Xc(P,H,pe,Ze,wt){P!==H&&ya(H,function(qt,li){if(wt||(wt=new Se),Lt(qt))yp(P,H,li,pe,Xc,Ze,wt);else{var di=Ze?Ze(kA(P,li),qt,li+"",P,H,wt):n;di===n&&(di=qt),ri(P,li,di)}},So)}function yp(P,H,pe,Ze,wt,qt,li){var di=kA(P,pe),Pi=kA(H,pe),hn=li.get(Pi);if(hn){ri(P,pe,hn);return}var fn=qt?qt(di,Pi,pe+"",P,H,li):n,xn=fn===n;if(xn){var Yn=f(Pi),xr=!Yn&&U(Pi),Wr=!Yn&&!xr&&Nn(Pi);fn=Pi,Yn||xr||Wr?f(di)?fn=di:I(di)?fn=xl(di):xr?(xn=!1,fn=$0(Pi,!0)):Wr?(xn=!1,fn=Lo(Pi,!0)):fn=[]:on(Pi)||Ne(Pi)?(fn=di,Ne(di)?fn=na(di):(!Lt(di)||At(di))&&(fn=id(Pi))):xn=!1}xn&&(li.set(Pi,fn),wt(fn,Pi,Ze,qt,li),li.delete(Pi)),ri(P,pe,fn)}function lf(P,H){var pe=P.length;if(pe)return H+=H<0?pe:0,Mc(H,pe)?P[H]:n}function H0(P,H,pe){H.length?H=Gs(H,function(qt){return f(qt)?function(li){return is(li,qt.length===1?qt[0]:qt)}:qt}):H=[Oc];var Ze=-1;H=Gs(H,rr(Cr()));var wt=_p(P,function(qt,li,di){var Pi=Gs(H,function(hn){return hn(qt)});return{criteria:Pi,index:++Ze,value:qt}});return Ol(wt,function(qt,li){return xp(qt,li,pe)})}function Yl(P,H){return Xu(P,H,function(pe,Ze){return sA(P,Ze)})}function Xu(P,H,pe){for(var Ze=-1,wt=H.length,qt={};++Ze<wt;){var li=H[Ze],di=is(P,li);pe(di,li)&&jh(qt,bh(li,P),di)}return qt}function j0(P){return function(H){return is(H,P)}}function vh(P,H,pe,Ze){var wt=Ze?zr:Ko,qt=-1,li=H.length,di=P;for(P===H&&(H=xl(H)),pe&&(di=Gs(P,rr(pe)));++qt<li;)for(var Pi=0,hn=H[qt],fn=pe?pe(hn):hn;(Pi=wt(di,fn,Pi,Ze))>-1;)di!==P&&uu.call(di,Pi,1),uu.call(P,Pi,1);return P}function Yc(P,H){for(var pe=P?H.length:0,Ze=pe-1;pe--;){var wt=H[pe];if(pe==Ze||wt!==qt){var qt=wt;Mc(wt)?uu.call(P,wt,1):hf(P,wt)}}return P}function mA(P,H){return P+_a(Jn()*(H-P+1))}function uf(P,H,pe,Ze){for(var wt=-1,qt=_r(ms((H-P)/(pe||1)),0),li=Di(qt);qt--;)li[Ze?qt:++wt]=P,P+=pe;return li}function u0(P,H){var pe="";if(!P||H<1||H>zt)return pe;do H%2&&(pe+=P),H=_a(H/2),H&&(P+=P);while(H);return pe}function _s(P,H){return wu(od(P,H,Oc),P+"")}function Kl(P){return ct(Fc(P))}function Hh(P,H){var pe=Fc(P);return If(pe,qi(H,0,pe.length))}function jh(P,H,pe,Ze){if(!Lt(P))return P;H=bh(H,P);for(var wt=-1,qt=H.length,li=qt-1,di=P;di!=null&&++wt<qt;){var Pi=ys(H[wt]),hn=pe;if(Pi==="__proto__"||Pi==="constructor"||Pi==="prototype")return P;if(wt!=li){var fn=di[Pi];hn=Ze?Ze(fn,Pi,di):n,hn===n&&(hn=Lt(fn)?fn:Mc(H[wt+1])?[]:{})}Xt(di,Pi,hn),di=di[Pi]}return P}var cf=Bi?function(P,H){return Bi.set(P,H),P}:Oc,gA=ta?function(P,H){return ta(P,"toString",{configurable:!0,enumerable:!1,value:I1(H),writable:!0})}:Oc;function Z0(P){return If(Fc(P))}function Dl(P,H,pe){var Ze=-1,wt=P.length;H<0&&(H=-H>wt?0:wt+H),pe=pe>wt?wt:pe,pe<0&&(pe+=wt),wt=H>pe?0:pe-H>>>0,H>>>=0;for(var qt=Di(wt);++Ze<wt;)qt[Ze]=P[Ze+H];return qt}function Vu(P,H){var pe;return er(P,function(Ze,wt,qt){return pe=H(Ze,wt,qt),!pe}),!!pe}function _A(P,H,pe){var Ze=0,wt=P==null?Ze:P.length;if(typeof H=="number"&&H===H&&wt<=Ni){for(;Ze<wt;){var qt=Ze+wt>>>1,li=P[qt];li!==null&&!Ln(li)&&(pe?li<=H:li<H)?Ze=qt+1:wt=qt}return wt}return c0(P,H,Oc,pe)}function c0(P,H,pe,Ze){var wt=0,qt=P==null?0:P.length;if(qt===0)return 0;H=pe(H);for(var li=H!==H,di=H===null,Pi=Ln(H),hn=H===n;wt<qt;){var fn=_a((wt+qt)/2),xn=pe(P[fn]),Yn=xn!==n,xr=xn===null,Wr=xn===xn,js=Ln(xn);if(li)var $r=Ze||Wr;else hn?$r=Wr&&(Ze||Yn):di?$r=Wr&&Yn&&(Ze||!xr):Pi?$r=Wr&&Yn&&!xr&&(Ze||!js):xr||js?$r=!1:$r=Ze?xn<=H:xn<H;$r?wt=fn+1:qt=fn}return gs(qt,Ti)}function h0(P,H){for(var pe=-1,Ze=P.length,wt=0,qt=[];++pe<Ze;){var li=P[pe],di=H?H(li):li;if(!pe||!J(di,Pi)){var Pi=di;qt[wt++]=li===0?0:li}}return qt}function vp(P){return typeof P=="number"?P:Ln(P)?gi:+P}function xu(P){if(typeof P=="string")return P;if(f(P))return Gs(P,xu)+"";if(Ln(P))return z?z.call(P):"";var H=P+"";return H=="0"&&1/P==-Nt?"-0":H}function Kc(P,H,pe){var Ze=-1,wt=Wo,qt=P.length,li=!0,di=[],Pi=di;if(pe)li=!1,wt=Co;else if(qt>=g){var hn=H?null:K0(P);if(hn)return Yr(hn);li=!1,wt=Xr,Pi=new j}else Pi=H?[]:di;e:for(;++Ze<qt;){var fn=P[Ze],xn=H?H(fn):fn;if(fn=pe||fn!==0?fn:0,li&&xn===xn){for(var Yn=Pi.length;Yn--;)if(Pi[Yn]===xn)continue e;H&&Pi.push(xn),di.push(fn)}else wt(Pi,xn,pe)||(Pi!==di&&Pi.push(xn),di.push(fn))}return di}function hf(P,H){return H=bh(H,P),P=ld(P,H),P==null||delete P[ys(ku(H))]}function xh(P,H,pe,Ze){return jh(P,H,pe(is(P,H)),Ze)}function Ll(P,H,pe,Ze){for(var wt=P.length,qt=Ze?wt:-1;(Ze?qt--:++qt<wt)&&H(P[qt],qt,P););return pe?Dl(P,Ze?0:qt,Ze?qt+1:wt):Dl(P,Ze?qt+1:0,Ze?wt:qt)}function A0(P,H){var pe=P;return pe instanceof we&&(pe=pe.value()),Xo(H,function(Ze,wt){return wt.func.apply(wt.thisArg,$o([Ze],wt.args))},pe)}function Jc(P,H,pe){var Ze=P.length;if(Ze<2)return Ze?Kc(P[0]):[];for(var wt=-1,qt=Di(Ze);++wt<Ze;)for(var li=P[wt],di=-1;++di<Ze;)di!=wt&&(qt[wt]=yr(qt[wt]||li,P[di],H,pe));return Kc(qr(qt,1),H,pe)}function Zh(P,H,pe){for(var Ze=-1,wt=P.length,qt=H.length,li={};++Ze<wt;){var di=Ze<qt?H[Ze]:n;pe(li,P[Ze],di)}return li}function Q0(P){return I(P)?P:[]}function W0(P){return typeof P=="function"?P:Oc}function bh(P,H){return f(P)?P:CA(P,H)?[P]:cd(Kn(P))}var Cm=_s;function Cc(P,H,pe){var Ze=P.length;return pe=pe===n?Ze:pe,!H&&pe>=Ze?P:Dl(P,H,pe)}var Af=oc||function(P){return Bs.clearTimeout(P)};function $0(P,H){if(H)return P.slice();var pe=P.length,Ze=En?En(pe):new P.constructor(pe);return P.copy(Ze),Ze}function lc(P){var H=new P.constructor(P.byteLength);return new Nl(H).set(new Nl(P)),H}function ff(P,H){var pe=H?lc(P.buffer):P.buffer;return new P.constructor(pe,P.byteOffset,P.byteLength)}function yA(P){var H=new P.constructor(P.source,fi.exec(P));return H.lastIndex=P.lastIndex,H}function Tm(P){return D?Bn(D.call(P)):{}}function Lo(P,H){var pe=H?lc(P.buffer):P.buffer;return new P.constructor(pe,P.byteOffset,P.length)}function df(P,H){if(P!==H){var pe=P!==n,Ze=P===null,wt=P===P,qt=Ln(P),li=H!==n,di=H===null,Pi=H===H,hn=Ln(H);if(!di&&!hn&&!qt&&P>H||qt&&li&&Pi&&!di&&!hn||Ze&&li&&Pi||!pe&&Pi||!wt)return 1;if(!Ze&&!qt&&!hn&&P<H||hn&&pe&&wt&&!Ze&&!qt||di&&pe&&wt||!li&&wt||!Pi)return-1}return 0}function xp(P,H,pe){for(var Ze=-1,wt=P.criteria,qt=H.criteria,li=wt.length,di=pe.length;++Ze<li;){var Pi=df(wt[Ze],qt[Ze]);if(Pi){if(Ze>=di)return Pi;var hn=pe[Ze];return Pi*(hn=="desc"?-1:1)}}return P.index-H.index}function pf(P,H,pe,Ze){for(var wt=-1,qt=P.length,li=pe.length,di=-1,Pi=H.length,hn=_r(qt-li,0),fn=Di(Pi+hn),xn=!Ze;++di<Pi;)fn[di]=H[di];for(;++wt<li;)(xn||wt<qt)&&(fn[pe[wt]]=P[wt]);for(;hn--;)fn[di++]=P[wt++];return fn}function mf(P,H,pe,Ze){for(var wt=-1,qt=P.length,li=-1,di=pe.length,Pi=-1,hn=H.length,fn=_r(qt-di,0),xn=Di(fn+hn),Yn=!Ze;++wt<fn;)xn[wt]=P[wt];for(var xr=wt;++Pi<hn;)xn[xr+Pi]=H[Pi];for(;++li<di;)(Yn||wt<qt)&&(xn[xr+pe[li]]=P[wt++]);return xn}function xl(P,H){var pe=-1,Ze=P.length;for(H||(H=Di(Ze));++pe<Ze;)H[pe]=P[pe];return H}function uc(P,H,pe,Ze){var wt=!pe;pe||(pe={});for(var qt=-1,li=H.length;++qt<li;){var di=H[qt],Pi=Ze?Ze(pe[di],P[di],di,pe,P):n;Pi===n&&(Pi=P[di]),wt?Ei(pe,di,Pi):Xt(pe,di,Pi)}return pe}function Qh(P,H){return uc(P,IA(P),H)}function gf(P,H){return uc(P,EA(P),H)}function Da(P,H){return function(pe,Ze){var wt=f(pe)?ac:si,qt=H?H():{};return wt(pe,P,Cr(Ze,2),qt)}}function cc(P){return _s(function(H,pe){var Ze=-1,wt=pe.length,qt=wt>1?pe[wt-1]:n,li=wt>2?pe[2]:n;for(qt=P.length>3&&typeof qt=="function"?(wt--,qt):n,li&&bu(pe[0],pe[1],li)&&(qt=wt<3?n:qt,wt=1),H=Bn(H);++Ze<wt;){var di=pe[Ze];di&&P(H,di,Ze,qt)}return H})}function f0(P,H){return function(pe,Ze){if(pe==null)return pe;if(!p(pe))return P(pe,Ze);for(var wt=pe.length,qt=H?wt:-1,li=Bn(pe);(H?qt--:++qt<wt)&&Ze(li[qt],qt,li)!==!1;);return pe}}function _f(P){return function(H,pe,Ze){for(var wt=-1,qt=Bn(H),li=Ze(H),di=li.length;di--;){var Pi=li[P?di:++wt];if(pe(qt[Pi],Pi,qt)===!1)break}return H}}function yf(P,H,pe){var Ze=H&tt,wt=wh(P);function qt(){var li=this&&this!==Bs&&this instanceof qt?wt:P;return li.apply(Ze?pe:this,arguments)}return qt}function Tc(P){return function(H){H=Kn(H);var pe=kl(H)?ea(H):n,Ze=pe?pe[0]:H.charAt(0),wt=pe?Cc(pe,1).join(""):H.slice(1);return Ze[P]()+wt}}function Wh(P){return function(H){return Xo(R2(z2(H).replace(pn,"")),P,"")}}function wh(P){return function(){var H=arguments;switch(H.length){case 0:return new P;case 1:return new P(H[0]);case 2:return new P(H[0],H[1]);case 3:return new P(H[0],H[1],H[2]);case 4:return new P(H[0],H[1],H[2],H[3]);case 5:return new P(H[0],H[1],H[2],H[3],H[4]);case 6:return new P(H[0],H[1],H[2],H[3],H[4],H[5]);case 7:return new P(H[0],H[1],H[2],H[3],H[4],H[5],H[6])}var pe=ee(P.prototype),Ze=P.apply(pe,H);return Lt(Ze)?Ze:pe}}function vf(P,H,pe){var Ze=wh(P);function wt(){for(var qt=arguments.length,li=Di(qt),di=qt,Pi=Kh(wt);di--;)li[di]=arguments[di];var hn=qt<3&&li[0]!==Pi&&li[qt-1]!==Pi?[]:Jo(li,Pi);if(qt-=hn.length,qt<pe)return hc(P,H,$h,wt.placeholder,n,li,hn,n,n,pe-qt);var fn=this&&this!==Bs&&this instanceof wt?Ze:P;return As(fn,this,li)}return wt}function vA(P){return function(H,pe,Ze){var wt=Bn(H);if(!p(H)){var qt=Cr(pe,3);H=co(H),pe=function(di){return qt(wt[di],di,wt)}}var li=P(H,pe,Ze);return li>-1?wt[qt?H[li]:li]:n}}function xA(P){return kc(function(H){var pe=H.length,Ze=pe,wt=oe.prototype.thru;for(P&&H.reverse();Ze--;){var qt=H[Ze];if(typeof qt!="function")throw new Xn(S);if(wt&&!li&&SA(qt)=="wrapper")var li=new oe([],!0)}for(Ze=li?Ze:pe;++Ze<pe;){qt=H[Ze];var di=SA(qt),Pi=di=="wrapper"?Yh(qt):n;Pi&&p0(Pi[0])&&Pi[1]==(jt|xt|Mt|it)&&!Pi[4].length&&Pi[9]==1?li=li[SA(Pi[0])].apply(li,Pi[3]):li=qt.length==1&&p0(qt)?li[di]():li.thru(qt)}return function(){var hn=arguments,fn=hn[0];if(li&&hn.length==1&&f(fn))return li.plant(fn).value();for(var xn=0,Yn=pe?H[xn].apply(this,hn):fn;++xn<pe;)Yn=H[xn].call(this,Yn);return Yn}})}function $h(P,H,pe,Ze,wt,qt,li,di,Pi,hn){var fn=H&jt,xn=H&tt,Yn=H&at,xr=H&(xt|Tt),Wr=H&vt,js=Yn?n:wh(P);function $r(){for(var sa=arguments.length,da=Di(sa),hh=sa;hh--;)da[hh]=arguments[hh];if(xr)var pc=Kh($r),Ah=Qr(da,pc);if(Ze&&(da=pf(da,Ze,wt,xr)),qt&&(da=mf(da,qt,li,xr)),sa-=Ah,xr&&sa<hn){var iu=Jo(da,pc);return hc(P,H,$h,$r.placeholder,pe,da,iu,di,Pi,hn-sa)}var aA=xn?pe:this,Hf=Yn?aA[P]:P;return sa=da.length,di?da=fa(da,di):Wr&&sa>1&&da.reverse(),fn&&Pi<sa&&(da.length=Pi),this&&this!==Bs&&this instanceof $r&&(Hf=js||wh(Hf)),Hf.apply(aA,da)}return $r}function X0(P,H){return function(pe,Ze){return $s(pe,P,H(Ze),{})}}function bA(P,H){return function(pe,Ze){var wt;if(pe===n&&Ze===n)return H;if(pe!==n&&(wt=pe),Ze!==n){if(wt===n)return Ze;typeof pe=="string"||typeof Ze=="string"?(pe=xu(pe),Ze=xu(Ze)):(pe=vp(pe),Ze=vp(Ze)),wt=P(pe,Ze)}return wt}}function Xh(P){return kc(function(H){return H=Gs(H,rr(Cr())),_s(function(pe){var Ze=this;return P(H,function(wt){return As(wt,Ze,pe)})})})}function d0(P,H){H=H===n?" ":xu(H);var pe=H.length;if(pe<2)return pe?u0(H,P):H;var Ze=u0(H,ms(P/_o(H)));return kl(H)?Cc(ea(Ze),0,P).join(""):Ze.slice(0,P)}function Y0(P,H,pe,Ze){var wt=H&tt,qt=wh(P);function li(){for(var di=-1,Pi=arguments.length,hn=-1,fn=Ze.length,xn=Di(fn+Pi),Yn=this&&this!==Bs&&this instanceof li?qt:P;++hn<fn;)xn[hn]=Ze[hn];for(;Pi--;)xn[hn++]=arguments[++di];return As(Yn,wt?pe:this,xn)}return li}function bp(P){return function(H,pe,Ze){return Ze&&typeof Ze!="number"&&bu(H,pe,Ze)&&(pe=Ze=n),H=ns(H),pe===n?(pe=H,H=0):pe=ns(pe),Ze=Ze===n?H<pe?1:-1:ns(Ze),uf(H,pe,Ze,P)}}function wA(P){return function(H,pe){return typeof H=="string"&&typeof pe=="string"||(H=ir(H),pe=ir(pe)),P(H,pe)}}function hc(P,H,pe,Ze,wt,qt,li,di,Pi,hn){var fn=H&xt,xn=fn?li:n,Yn=fn?n:li,xr=fn?qt:n,Wr=fn?n:qt;H|=fn?Mt:Oe,H&=~(fn?Oe:Mt),H&ut||(H&=~(tt|at));var js=[P,H,wt,xr,xn,Wr,Yn,di,Pi,hn],$r=pe.apply(n,js);return p0(P)&&ud($r,js),$r.placeholder=Ze,Ka($r,P,H)}function xf(P){var H=Fi[P];return function(pe,Ze){if(pe=ir(pe),Ze=Ze==null?0:gs(Wn(Ze),292),Ze&&Ou(pe)){var wt=(Kn(pe)+"e").split("e"),qt=H(wt[0]+"e"+(+wt[1]+Ze));return wt=(Kn(qt)+"e").split("e"),+(wt[0]+"e"+(+wt[1]-Ze))}return H(pe)}}var K0=vs&&1/Yr(new vs([,-0]))[1]==Nt?function(P){return new vs(P)}:T1;function Sh(P){return function(H){var pe=Ul(H);return pe==Ji?qs(H):pe==rn?mr(H):Ts(H,P(H))}}function eh(P,H,pe,Ze,wt,qt,li,di){var Pi=H&at;if(!Pi&&typeof P!="function")throw new Xn(S);var hn=Ze?Ze.length:0;if(hn||(H&=~(Mt|Oe),Ze=wt=n),li=li===n?li:_r(Wn(li),0),di=di===n?di:Wn(di),hn-=wt?wt.length:0,H&Oe){var fn=Ze,xn=wt;Ze=wt=n}var Yn=Pi?n:Yh(P),xr=[P,H,pe,Ze,wt,fn,xn,qt,li,di];if(Yn&&Ch(xr,Yn),P=xr[0],H=xr[1],pe=xr[2],Ze=xr[3],wt=xr[4],di=xr[9]=xr[9]===n?Pi?0:P.length:_r(xr[9]-hn,0),!di&&H&(xt|Tt)&&(H&=~(xt|Tt)),!H||H==tt)var Wr=yf(P,H,pe);else H==xt||H==Tt?Wr=vf(P,H,di):(H==Mt||H==(tt|Mt))&&!wt.length?Wr=Y0(P,H,pe,Ze):Wr=$h.apply(n,xr);var js=Yn?cf:ud;return Ka(js(Wr,xr),P,H)}function wp(P,H,pe,Ze){return P===n||J(P,ps[pe])&&!rs.call(Ze,pe)?H:P}function Sp(P,H,pe,Ze,wt,qt){return Lt(P)&&Lt(H)&&(qt.set(H,P),Xc(P,H,n,Sp,qt),qt.delete(H)),P}function Ip(P){return on(P)?n:P}function J0(P,H,pe,Ze,wt,qt){var li=pe&je,di=P.length,Pi=H.length;if(di!=Pi&&!(li&&Pi>di))return!1;var hn=qt.get(P),fn=qt.get(H);if(hn&&fn)return hn==H&&fn==P;var xn=-1,Yn=!0,xr=pe&nt?new j:n;for(qt.set(P,H),qt.set(H,P);++xn<di;){var Wr=P[xn],js=H[xn];if(Ze)var $r=li?Ze(js,Wr,xn,H,P,qt):Ze(Wr,js,xn,P,H,qt);if($r!==n){if($r)continue;Yn=!1;break}if(xr){if(!ba(H,function(sa,da){if(!Xr(xr,da)&&(Wr===sa||wt(Wr,sa,pe,Ze,qt)))return xr.push(da)})){Yn=!1;break}}else if(!(Wr===js||wt(Wr,js,pe,Ze,qt))){Yn=!1;break}}return qt.delete(P),qt.delete(H),Yn}function Ih(P,H,pe,Ze,wt,qt,li){switch(pe){case V:if(P.byteLength!=H.byteLength||P.byteOffset!=H.byteOffset)return!1;P=P.buffer,H=H.buffer;case k:return!(P.byteLength!=H.byteLength||!qt(new Nl(P),new Nl(H)));case vn:case Ci:case Ai:return J(+P,+H);case Ri:return P.name==H.name&&P.message==H.message;case ci:case tr:return P==H+"";case Ji:var di=qs;case rn:var Pi=Ze&je;if(di||(di=Yr),P.size!=H.size&&!Pi)return!1;var hn=li.get(P);if(hn)return hn==H;Ze|=nt,li.set(P,H);var fn=J0(di(P),di(H),Ze,wt,qt,li);return li.delete(P),fn;case Pn:if(D)return D.call(P)==D.call(H)}return!1}function km(P,H,pe,Ze,wt,qt){var li=pe&je,di=Eh(P),Pi=di.length,hn=Eh(H),fn=hn.length;if(Pi!=fn&&!li)return!1;for(var xn=Pi;xn--;){var Yn=di[xn];if(!(li?Yn in H:rs.call(H,Yn)))return!1}var xr=qt.get(P),Wr=qt.get(H);if(xr&&Wr)return xr==H&&Wr==P;var js=!0;qt.set(P,H),qt.set(H,P);for(var $r=li;++xn<Pi;){Yn=di[xn];var sa=P[Yn],da=H[Yn];if(Ze)var hh=li?Ze(da,sa,Yn,H,P,qt):Ze(sa,da,Yn,P,H,qt);if(!(hh===n?sa===da||wt(sa,da,pe,Ze,qt):hh)){js=!1;break}$r||($r=Yn=="constructor")}if(js&&!$r){var pc=P.constructor,Ah=H.constructor;pc!=Ah&&"constructor"in P&&"constructor"in H&&!(typeof pc=="function"&&pc instanceof pc&&typeof Ah=="function"&&Ah instanceof Ah)&&(js=!1)}return qt.delete(P),qt.delete(H),js}function kc(P){return wu(od(P,n,fl),P+"")}function Eh(P){return Rr(P,co,IA)}function bf(P){return Rr(P,So,EA)}var Yh=Bi?function(P){return Bi.get(P)}:T1;function SA(P){for(var H=P.name+"",pe=xs[H],Ze=rs.call(xs,H)?pe.length:0;Ze--;){var wt=pe[Ze],qt=wt.func;if(qt==null||qt==P)return wt.name}return H}function Kh(P){var H=rs.call(R,"placeholder")?R:P;return H.placeholder}function Cr(){var P=R.iteratee||E1;return P=P===E1?Ec:P,arguments.length?P(arguments[0],arguments[1]):P}function wf(P,H){var pe=P.__data__;return Lm(H)?pe[typeof H=="string"?"string":"hash"]:pe.map}function ed(P){for(var H=co(P),pe=H.length;pe--;){var Ze=H[pe],wt=P[Ze];H[pe]=[Ze,wt,m0(wt)]}return H}function Jh(P,H){var pe=Mo(P,H);return Pa(pe)?pe:n}function Sf(P){var H=rs.call(P,yl),pe=P[yl];try{P[yl]=n;var Ze=!0}catch{}var wt=vo.call(P);return Ze&&(H?P[yl]=pe:delete P[yl]),wt}var IA=el?function(P){return P==null?[]:(P=Bn(P),Oo(el(P),function(H){return _l.call(P,H)}))}:k1,EA=el?function(P){for(var H=[];P;)$o(H,IA(P)),P=Wl(P);return H}:k1,Ul=bs;(Tu&&Ul(new Tu(new ArrayBuffer(1)))!=V||oa&&Ul(new oa)!=Ji||yu&&Ul(yu.resolve())!=_n||vs&&Ul(new vs)!=rn||Po&&Ul(new Po)!=In)&&(Ul=function(P){var H=bs(P),pe=H==ei?P.constructor:n,Ze=pe?th(pe):"";if(Ze)switch(Ze){case vu:return V;case Vo:return Ji;case fs:return _n;case hl:return rn;case Ms:return In}return H});function Mm(P,H,pe){for(var Ze=-1,wt=pe.length;++Ze<wt;){var qt=pe[Ze],li=qt.size;switch(qt.type){case"drop":P+=li;break;case"dropRight":H-=li;break;case"take":H=gs(H,P+li);break;case"takeRight":P=_r(P,H-li);break}}return{start:P,end:H}}function Pm(P){var H=P.match(Ge);return H?H[1].split(ht):[]}function td(P,H,pe){H=bh(H,P);for(var Ze=-1,wt=H.length,qt=!1;++Ze<wt;){var li=ys(H[Ze]);if(!(qt=P!=null&&pe(P,li)))break;P=P[li]}return qt||++Ze!=wt?qt:(wt=P==null?0:P.length,!!wt&&Dt(wt)&&Mc(li,wt)&&(f(P)||Ne(P)))}function Dm(P){var H=P.length,pe=new P.constructor(H);return H&&typeof P[0]=="string"&&rs.call(P,"index")&&(pe.index=P.index,pe.input=P.input),pe}function id(P){return typeof P.constructor=="function"&&!TA(P)?ee(Wl(P)):{}}function eA(P,H,pe){var Ze=P.constructor;switch(H){case k:return lc(P);case vn:case Ci:return new Ze(+P);case V:return ff(P,pe);case Y:case te:case fe:case ve:case Ie:case Ee:case ze:case We:case He:return Lo(P,pe);case Ji:return new Ze;case Ai:case tr:return new Ze(P);case ci:return yA(P);case rn:return new Ze;case Pn:return Tm(P)}}function nd(P,H){var pe=H.length;if(!pe)return P;var Ze=pe-1;return H[Ze]=(pe>1?"& ":"")+H[Ze],H=H.join(pe>2?", ":" "),P.replace(De,`{
/* [wrapped with `+H+`] */
`)}function Ep(P){return f(P)||Ne(P)||!!(Fu&&P&&P[Fu])}function Mc(P,H){var pe=typeof P;return H=H??zt,!!H&&(pe=="number"||pe!="symbol"&&xi.test(P))&&P>-1&&P%1==0&&P<H}function bu(P,H,pe){if(!Lt(pe))return!1;var Ze=typeof H;return(Ze=="number"?p(pe)&&Mc(H,pe.length):Ze=="string"&&H in pe)?J(pe[H],P):!1}function CA(P,H){if(f(P))return!1;var pe=typeof P;return pe=="number"||pe=="symbol"||pe=="boolean"||P==null||Ln(P)?!0:ge.test(P)||!ye.test(P)||H!=null&&P in Bn(H)}function Lm(P){var H=typeof P;return H=="string"||H=="number"||H=="symbol"||H=="boolean"?P!=="__proto__":P===null}function p0(P){var H=SA(P),pe=R[H];if(typeof pe!="function"||!(H in we.prototype))return!1;if(P===pe)return!0;var Ze=Yh(pe);return!!Ze&&P===Ze[0]}function Cp(P){return!!Ru&&Ru in P}var rd=Ya?At:M1;function TA(P){var H=P&&P.constructor,pe=typeof H=="function"&&H.prototype||ps;return P===pe}function m0(P){return P===P&&!Lt(P)}function sd(P,H){return function(pe){return pe==null?!1:pe[P]===H&&(H!==n||P in Bn(pe))}}function Bm(P){var H=Mh(P,function(Ze){return pe.size===W&&pe.clear(),Ze}),pe=H.cache;return H}function Ch(P,H){var pe=P[1],Ze=H[1],wt=pe|Ze,qt=wt<(tt|at|jt),li=Ze==jt&&pe==xt||Ze==jt&&pe==it&&P[7].length<=H[8]||Ze==(jt|it)&&H[7].length<=H[8]&&pe==xt;if(!(qt||li))return P;Ze&tt&&(P[2]=H[2],wt|=pe&tt?0:ut);var di=H[3];if(di){var Pi=P[3];P[3]=Pi?pf(Pi,di,H[4]):di,P[4]=Pi?Jo(P[3],he):H[4]}return di=H[5],di&&(Pi=P[5],P[5]=Pi?mf(Pi,di,H[6]):di,P[6]=Pi?Jo(P[5],he):H[6]),di=H[7],di&&(P[7]=di),Ze&jt&&(P[8]=P[8]==null?H[8]:gs(P[8],H[8])),P[9]==null&&(P[9]=H[9]),P[0]=H[0],P[1]=wt,P}function Al(P){var H=[];if(P!=null)for(var pe in Bn(P))H.push(pe);return H}function ad(P){return vo.call(P)}function od(P,H,pe){return H=_r(H===n?P.length-1:H,0),function(){for(var Ze=arguments,wt=-1,qt=_r(Ze.length-H,0),li=Di(qt);++wt<qt;)li[wt]=Ze[H+wt];wt=-1;for(var di=Di(H+1);++wt<H;)di[wt]=Ze[wt];return di[H]=pe(li),As(P,this,di)}}function ld(P,H){return H.length<2?P:is(P,Dl(H,0,-1))}function fa(P,H){for(var pe=P.length,Ze=gs(H.length,pe),wt=xl(P);Ze--;){var qt=H[Ze];P[Ze]=Mc(qt,pe)?wt[qt]:n}return P}function kA(P,H){if(!(H==="constructor"&&typeof P[H]=="function")&&H!="__proto__")return P[H]}var ud=g0(cf),MA=$l||function(P,H){return Bs.setTimeout(P,H)},wu=g0(gA);function Ka(P,H,pe){var Ze=H+"";return wu(P,nd(Ze,Tp(Pm(Ze),pe)))}function g0(P){var H=0,pe=0;return function(){var Ze=gn(),wt=dt-(Ze-pe);if(pe=Ze,wt>0){if(++H>=Pt)return arguments[0]}else H=0;return P.apply(n,arguments)}}function If(P,H){var pe=-1,Ze=P.length,wt=Ze-1;for(H=H===n?Ze:H;++pe<H;){var qt=mA(pe,wt),li=P[qt];P[qt]=P[pe],P[pe]=li}return P.length=H,P}var cd=Bm(function(P){var H=[];return P.charCodeAt(0)===46&&H.push(""),P.replace(Pe,function(pe,Ze,wt,qt){H.push(wt?qt.replace(ke,"$1"):Ze||pe)}),H});function ys(P){if(typeof P=="string"||Ln(P))return P;var H=P+"";return H=="0"&&1/P==-Nt?"-0":H}function th(P){if(P!=null){try{return yo.call(P)}catch{}try{return P+""}catch{}}return""}function Tp(P,H){return ro(en,function(pe){var Ze="_."+pe[0];H&pe[1]&&!Wo(P,Ze)&&P.push(Ze)}),P.sort()}function hd(P){if(P instanceof we)return P.clone();var H=new oe(P.__wrapped__,P.__chain__);return H.__actions__=xl(P.__actions__),H.__index__=P.__index__,H.__values__=P.__values__,H}function ih(P,H,pe){(pe?bu(P,H,pe):H===n)?H=1:H=_r(Wn(H),0);var Ze=P==null?0:P.length;if(!Ze||H<1)return[];for(var wt=0,qt=0,li=Di(ms(Ze/H));wt<Ze;)li[qt++]=Dl(P,wt,wt+=H);return li}function PA(P){for(var H=-1,pe=P==null?0:P.length,Ze=0,wt=[];++H<pe;){var qt=P[H];qt&&(wt[Ze++]=qt)}return wt}function kp(){var P=arguments.length;if(!P)return[];for(var H=Di(P-1),pe=arguments[0],Ze=P;Ze--;)H[Ze-1]=arguments[Ze];return $o(f(pe)?xl(pe):[pe],qr(H,1))}var _0=_s(function(P,H){return I(P)?yr(P,qr(H,1,I,!0)):[]}),DA=_s(function(P,H){var pe=ku(H);return I(pe)&&(pe=n),I(P)?yr(P,qr(H,1,I,!0),Cr(pe,2)):[]}),Mp=_s(function(P,H){var pe=ku(H);return I(pe)&&(pe=n),I(P)?yr(P,qr(H,1,I,!0),n,pe):[]});function Ad(P,H,pe){var Ze=P==null?0:P.length;return Ze?(H=pe||H===n?1:Wn(H),Dl(P,H<0?0:H,Ze)):[]}function fd(P,H,pe){var Ze=P==null?0:P.length;return Ze?(H=pe||H===n?1:Wn(H),H=Ze-H,Dl(P,0,H<0?0:H)):[]}function zm(P,H){return P&&P.length?Ll(P,Cr(H,3),!0,!0):[]}function Rm(P,H){return P&&P.length?Ll(P,Cr(H,3),!0):[]}function Fm(P,H,pe,Ze){var wt=P==null?0:P.length;return wt?(pe&&typeof pe!="number"&&bu(P,H,pe)&&(pe=0,Ze=wt),oo(P,H,pe,Ze)):[]}function dd(P,H,pe){var Ze=P==null?0:P.length;if(!Ze)return-1;var wt=pe==null?0:Wn(pe);return wt<0&&(wt=_r(Ze+wt,0)),$n(P,Cr(H,3),wt)}function LA(P,H,pe){var Ze=P==null?0:P.length;if(!Ze)return-1;var wt=Ze-1;return pe!==n&&(wt=Wn(pe),wt=pe<0?_r(Ze+wt,0):gs(wt,Ze-1)),$n(P,Cr(H,3),wt,!0)}function fl(P){var H=P==null?0:P.length;return H?qr(P,1):[]}function y0(P){var H=P==null?0:P.length;return H?qr(P,Nt):[]}function v0(P,H){var pe=P==null?0:P.length;return pe?(H=H===n?1:Wn(H),qr(P,H)):[]}function Pc(P){for(var H=-1,pe=P==null?0:P.length,Ze={};++H<pe;){var wt=P[H];Ze[wt[0]]=wt[1]}return Ze}function BA(P){return P&&P.length?P[0]:n}function Ef(P,H,pe){var Ze=P==null?0:P.length;if(!Ze)return-1;var wt=pe==null?0:Wn(pe);return wt<0&&(wt=_r(Ze+wt,0)),Ko(P,H,wt)}function zA(P){var H=P==null?0:P.length;return H?Dl(P,0,-1):[]}var Cf=_s(function(P){var H=Gs(P,Q0);return H.length&&H[0]===P[0]?Ic(H):[]}),Tf=_s(function(P){var H=ku(P),pe=Gs(P,Q0);return H===ku(pe)?H=n:pe.pop(),pe.length&&pe[0]===P[0]?Ic(pe,Cr(H,2)):[]}),Su=_s(function(P){var H=ku(P),pe=Gs(P,Q0);return H=typeof H=="function"?H:n,H&&pe.pop(),pe.length&&pe[0]===P[0]?Ic(pe,n,H):[]});function x0(P,H){return P==null?"":cu.call(P,H)}function ku(P){var H=P==null?0:P.length;return H?P[H-1]:n}function Th(P,H,pe){var Ze=P==null?0:P.length;if(!Ze)return-1;var wt=Ze;return pe!==n&&(wt=Wn(pe),wt=wt<0?_r(Ze+wt,0):gs(wt,Ze-1)),H===H?ha(P,H,wt):$n(P,Wa,wt,!0)}function RA(P,H){return P&&P.length?lf(P,Wn(H)):n}var FA=_s(nh);function nh(P,H){return P&&P.length&&H&&H.length?vh(P,H):P}function OA(P,H,pe){return P&&P.length&&H&&H.length?vh(P,H,Cr(pe,2)):P}function b0(P,H,pe){return P&&P.length&&H&&H.length?vh(P,H,n,pe):P}var Om=kc(function(P,H){var pe=P==null?0:P.length,Ze=Gi(P,H);return Yc(P,Gs(H,function(wt){return Mc(wt,pe)?+wt:wt}).sort(df)),Ze});function pd(P,H){var pe=[];if(!(P&&P.length))return pe;var Ze=-1,wt=[],qt=P.length;for(H=Cr(H,3);++Ze<qt;){var li=P[Ze];H(li,Ze,P)&&(pe.push(li),wt.push(Ze))}return Yc(P,wt),pe}function kh(P){return P==null?P:tl.call(P)}function Dc(P,H,pe){var Ze=P==null?0:P.length;return Ze?(pe&&typeof pe!="number"&&bu(P,H,pe)?(H=0,pe=Ze):(H=H==null?0:Wn(H),pe=pe===n?Ze:Wn(pe)),Dl(P,H,pe)):[]}function rh(P,H){return _A(P,H)}function md(P,H,pe){return c0(P,H,Cr(pe,2))}function kf(P,H){var pe=P==null?0:P.length;if(pe){var Ze=_A(P,H);if(Ze<pe&&J(P[Ze],H))return Ze}return-1}function gd(P,H){return _A(P,H,!0)}function Nm(P,H,pe){return c0(P,H,Cr(pe,2),!0)}function w0(P,H){var pe=P==null?0:P.length;if(pe){var Ze=_A(P,H,!0)-1;if(J(P[Ze],H))return Ze}return-1}function S0(P){return P&&P.length?h0(P):[]}function Mf(P,H){return P&&P.length?h0(P,Cr(H,2)):[]}function Yu(P){var H=P==null?0:P.length;return H?Dl(P,1,H):[]}function Lc(P,H,pe){return P&&P.length?(H=pe||H===n?1:Wn(H),Dl(P,0,H<0?0:H)):[]}function tA(P,H,pe){var Ze=P==null?0:P.length;return Ze?(H=pe||H===n?1:Wn(H),H=Ze-H,Dl(P,H<0?0:H,Ze)):[]}function I0(P,H){return P&&P.length?Ll(P,Cr(H,3),!1,!0):[]}function Pp(P,H){return P&&P.length?Ll(P,Cr(H,3)):[]}var _d=_s(function(P){return Kc(qr(P,1,I,!0))}),Pf=_s(function(P){var H=ku(P);return I(H)&&(H=n),Kc(qr(P,1,I,!0),Cr(H,2))}),NA=_s(function(P){var H=ku(P);return H=typeof H=="function"?H:n,Kc(qr(P,1,I,!0),n,H)});function Dp(P){return P&&P.length?Kc(P):[]}function yd(P,H){return P&&P.length?Kc(P,Cr(H,2)):[]}function vd(P,H){return H=typeof H=="function"?H:n,P&&P.length?Kc(P,n,H):[]}function sh(P){if(!(P&&P.length))return[];var H=0;return P=Oo(P,function(pe){if(I(pe))return H=_r(pe.length,H),!0}),Zr(H,function(pe){return Gs(P,fr(pe))})}function xd(P,H){if(!(P&&P.length))return[];var pe=sh(P);return H==null?pe:Gs(pe,function(Ze){return As(H,n,Ze)})}var Lp=_s(function(P,H){return I(P)?yr(P,H):[]}),bd=_s(function(P){return Jc(Oo(P,I))}),Bp=_s(function(P){var H=ku(P);return I(H)&&(H=n),Jc(Oo(P,I),Cr(H,2))}),VA=_s(function(P){var H=ku(P);return H=typeof H=="function"?H:n,Jc(Oo(P,I),n,H)}),ah=_s(sh);function zp(P,H){return Zh(P||[],H||[],Xt)}function Rp(P,H){return Zh(P||[],H||[],jh)}var wd=_s(function(P){var H=P.length,pe=H>1?P[H-1]:n;return pe=typeof pe=="function"?(P.pop(),pe):n,xd(P,pe)});function Sd(P){var H=R(P);return H.__chain__=!0,H}function Fp(P,H){return H(P),P}function UA(P,H){return H(P)}var E0=kc(function(P){var H=P.length,pe=H?P[0]:0,Ze=this.__wrapped__,wt=function(qt){return Gi(qt,P)};return H>1||this.__actions__.length||!(Ze instanceof we)||!Mc(pe)?this.thru(wt):(Ze=Ze.slice(pe,+pe+(H?1:0)),Ze.__actions__.push({func:UA,args:[wt],thisArg:n}),new oe(Ze,this.__chain__).thru(function(qt){return H&&!qt.length&&qt.push(n),qt}))});function C0(){return Sd(this)}function Bc(){return new oe(this.value(),this.__chain__)}function Id(){this.__values__===n&&(this.__values__=ia(this.value()));var P=this.__index__>=this.__values__.length,H=P?n:this.__values__[this.__index__++];return{done:P,value:H}}function Mu(){return this}function GA(P){for(var H,pe=this;pe instanceof le;){var Ze=hd(pe);Ze.__index__=0,Ze.__values__=n,H?wt.__wrapped__=Ze:H=Ze;var wt=Ze;pe=pe.__wrapped__}return wt.__wrapped__=P,H}function Ed(){var P=this.__wrapped__;if(P instanceof we){var H=P;return this.__actions__.length&&(H=new we(this)),H=H.reverse(),H.__actions__.push({func:UA,args:[kh],thisArg:n}),new oe(H,this.__chain__)}return this.thru(kh)}function Cd(){return A0(this.__wrapped__,this.__actions__)}var Td=Da(function(P,H,pe){rs.call(P,pe)?++P[pe]:Ei(P,pe,1)});function T0(P,H,pe){var Ze=f(P)?Ql:Aa;return pe&&bu(P,H,pe)&&(H=n),Ze(P,Cr(H,3))}function Df(P,H){var pe=f(P)?Oo:lo;return pe(P,Cr(H,3))}var kd=vA(dd),Md=vA(LA);function Pd(P,H){return qr(oh(P,H),1)}function bl(P,H){return qr(oh(P,H),Nt)}function qA(P,H,pe){return pe=pe===n?1:Wn(pe),qr(oh(P,H),pe)}function k0(P,H){var pe=f(P)?ro:er;return pe(P,Cr(H,3))}function M0(P,H){var pe=f(P)?so:Ia;return pe(P,Cr(H,3))}var Dd=Da(function(P,H,pe){rs.call(P,pe)?P[pe].push(H):Ei(P,pe,[H])});function Op(P,H,pe,Ze){P=p(P)?P:Fc(P),pe=pe&&!Ze?Wn(pe):0;var wt=P.length;return pe<0&&(pe=_r(wt+pe,0)),Xi(P)?pe<=wt&&P.indexOf(H,pe)>-1:!!wt&&Ko(P,H,pe)>-1}var Np=_s(function(P,H,pe){var Ze=-1,wt=typeof H=="function",qt=p(P)?Di(P.length):[];return er(P,function(li){qt[++Ze]=wt?As(H,li,pe):Xl(li,H,pe)}),qt}),Ld=Da(function(P,H,pe){Ei(P,pe,H)});function oh(P,H){var pe=f(P)?Gs:_p;return pe(P,Cr(H,3))}function Bd(P,H,pe,Ze){return P==null?[]:(f(H)||(H=H==null?[]:[H]),pe=Ze?n:pe,f(pe)||(pe=pe==null?[]:[pe]),H0(P,H,pe))}var Ac=Da(function(P,H,pe){P[pe?0:1].push(H)},function(){return[[],[]]});function zd(P,H,pe){var Ze=f(P)?Xo:Gn,wt=arguments.length<3;return Ze(P,Cr(H,4),pe,wt,er)}function Lf(P,H,pe){var Ze=f(P)?Yo:Gn,wt=arguments.length<3;return Ze(P,Cr(H,4),pe,wt,Ia)}function Bf(P,H){var pe=f(P)?Oo:lo;return pe(P,QA(Cr(H,3)))}function zf(P){var H=f(P)?ct:Kl;return H(P)}function Vm(P,H,pe){(pe?bu(P,H,pe):H===n)?H=1:H=Wn(H);var Ze=f(P)?It:Hh;return Ze(P,H)}function Um(P){var H=f(P)?bt:Z0;return H(P)}function Vp(P){if(P==null)return 0;if(p(P))return Xi(P)?_o(P):P.length;var H=Ul(P);return H==Ji||H==rn?P.size:Gh(P).length}function HA(P,H,pe){var Ze=f(P)?ba:Vu;return pe&&bu(P,H,pe)&&(H=n),Ze(P,Cr(H,3))}var iA=_s(function(P,H){if(P==null)return[];var pe=H.length;return pe>1&&bu(P,H[0],H[1])?H=[]:pe>2&&bu(H[0],H[1],H[2])&&(H=[H[0]]),H0(P,qr(H,1),[])}),Bo=$u||function(){return Bs.Date.now()};function lh(P,H){if(typeof H!="function")throw new Xn(S);return P=Wn(P),function(){if(--P<1)return H.apply(this,arguments)}}function nA(P,H,pe){return H=pe?n:H,H=P&&H==null?P.length:H,eh(P,jt,n,n,n,n,H)}function jA(P,H){var pe;if(typeof H!="function")throw new Xn(S);return P=Wn(P),function(){return--P>0&&(pe=H.apply(this,arguments)),P<=1&&(H=n),pe}}var rA=_s(function(P,H,pe){var Ze=tt;if(pe.length){var wt=Jo(pe,Kh(rA));Ze|=Mt}return eh(P,Ze,H,pe,wt)}),P0=_s(function(P,H,pe){var Ze=tt|at;if(pe.length){var wt=Jo(pe,Kh(P0));Ze|=Mt}return eh(H,Ze,P,pe,wt)});function Up(P,H,pe){H=pe?n:H;var Ze=eh(P,xt,n,n,n,n,n,H);return Ze.placeholder=Up.placeholder,Ze}function Rd(P,H,pe){H=pe?n:H;var Ze=eh(P,Tt,n,n,n,n,n,H);return Ze.placeholder=Rd.placeholder,Ze}function Fd(P,H,pe){var Ze,wt,qt,li,di,Pi,hn=0,fn=!1,xn=!1,Yn=!0;if(typeof P!="function")throw new Xn(S);H=ir(H)||0,Lt(pe)&&(fn=!!pe.leading,xn="maxWait"in pe,qt=xn?_r(ir(pe.maxWait)||0,H):qt,Yn="trailing"in pe?!!pe.trailing:Yn);function xr(iu){var aA=Ze,Hf=wt;return Ze=wt=n,hn=iu,li=P.apply(Hf,aA),li}function Wr(iu){return hn=iu,di=MA(sa,H),fn?xr(iu):li}function js(iu){var aA=iu-Pi,Hf=iu-hn,N2=H-aA;return xn?gs(N2,qt-Hf):N2}function $r(iu){var aA=iu-Pi,Hf=iu-hn;return Pi===n||aA>=H||aA<0||xn&&Hf>=qt}function sa(){var iu=Bo();if($r(iu))return da(iu);di=MA(sa,js(iu))}function da(iu){return di=n,Yn&&Ze?xr(iu):(Ze=wt=n,li)}function hh(){di!==n&&Af(di),hn=0,Ze=Pi=wt=di=n}function pc(){return di===n?li:da(Bo())}function Ah(){var iu=Bo(),aA=$r(iu);if(Ze=arguments,wt=this,Pi=iu,aA){if(di===n)return Wr(Pi);if(xn)return Af(di),di=MA(sa,H),xr(Pi)}return di===n&&(di=MA(sa,H)),li}return Ah.cancel=hh,Ah.flush=pc,Ah}var ZA=_s(function(P,H){return kn(P,1,H)}),Bl=_s(function(P,H,pe){return kn(P,ir(H)||0,pe)});function zc(P){return eh(P,vt)}function Mh(P,H){if(typeof P!="function"||H!=null&&typeof H!="function")throw new Xn(S);var pe=function(){var Ze=arguments,wt=H?H.apply(this,Ze):Ze[0],qt=pe.cache;if(qt.has(wt))return qt.get(wt);var li=P.apply(this,Ze);return pe.cache=qt.set(wt,li)||qt,li};return pe.cache=new(Mh.Cache||l),pe}Mh.Cache=l;function QA(P){if(typeof P!="function")throw new Xn(S);return function(){var H=arguments;switch(H.length){case 0:return!P.call(this);case 1:return!P.call(this,H[0]);case 2:return!P.call(this,H[0],H[1]);case 3:return!P.call(this,H[0],H[1],H[2])}return!P.apply(this,H)}}function WA(P){return jA(2,P)}var Rf=Cm(function(P,H){H=H.length==1&&f(H[0])?Gs(H[0],rr(Cr())):Gs(qr(H,1),rr(Cr()));var pe=H.length;return _s(function(Ze){for(var wt=-1,qt=gs(Ze.length,pe);++wt<qt;)Ze[wt]=H[wt].call(this,Ze[wt]);return As(P,this,Ze)})}),D0=_s(function(P,H){var pe=Jo(H,Kh(D0));return eh(P,Mt,n,H,pe)}),Ff=_s(function(P,H){var pe=Jo(H,Kh(Ff));return eh(P,Oe,n,H,pe)}),Of=kc(function(P,H){return eh(P,it,n,n,n,H)});function Nf(P,H){if(typeof P!="function")throw new Xn(S);return H=H===n?H:Wn(H),_s(P,H)}function L0(P,H){if(typeof P!="function")throw new Xn(S);return H=H==null?0:_r(Wn(H),0),_s(function(pe){var Ze=pe[H],wt=Cc(pe,0,H);return Ze&&$o(wt,Ze),As(P,this,wt)})}function Vf(P,H,pe){var Ze=!0,wt=!0;if(typeof P!="function")throw new Xn(S);return Lt(pe)&&(Ze="leading"in pe?!!pe.leading:Ze,wt="trailing"in pe?!!pe.trailing:wt),Fd(P,H,{leading:Ze,maxWait:H,trailing:wt})}function Uf(P){return nA(P,1)}function Gp(P,H){return D0(W0(H),P)}function m(){if(!arguments.length)return[];var P=arguments[0];return f(P)?P:[P]}function h(P){return cn(P,be)}function b(P,H){return H=typeof H=="function"?H:n,cn(P,be,H)}function M(P){return cn(P,ae|be)}function q(P,H){return H=typeof H=="function"?H:n,cn(P,ae|be,H)}function K(P,H){return H==null||tn(P,H,co(H))}function J(P,H){return P===H||P!==P&&H!==H}var me=wA(Ws),Ce=wA(function(P,H){return P>=H}),Ne=hu(function(){return arguments}())?hu:function(P){return Rt(P)&&rs.call(P,"callee")&&!_l.call(P,"callee")},f=Di.isArray,u=El?rr(El):il;function p(P){return P!=null&&Dt(P.length)&&!At(P)}function I(P){return Rt(P)&&p(P)}function L(P){return P===!0||P===!1||Rt(P)&&bs(P)==vn}var U=_u||M1,Q=Za?rr(Za):vl;function re(P){return Rt(P)&&P.nodeType===1&&!on(P)}function Ae(P){if(P==null)return!0;if(p(P)&&(f(P)||typeof P=="string"||typeof P.splice=="function"||U(P)||Nn(P)||Ne(P)))return!P.length;var H=Ul(P);if(H==Ji||H==rn)return!P.size;if(TA(P))return!Gh(P).length;for(var pe in P)if(rs.call(P,pe))return!1;return!0}function _e(P,H){return Pl(P,H)}function Le(P,H,pe){pe=typeof pe=="function"?pe:n;var Ze=pe?pe(P,H):n;return Ze===n?Pl(P,H,n,pe):!!Ze}function qe(P){if(!Rt(P))return!1;var H=bs(P);return H==Ri||H==mi||typeof P.message=="string"&&typeof P.name=="string"&&!on(P)}function et(P){return typeof P=="number"&&Ou(P)}function At(P){if(!Lt(P))return!1;var H=bs(P);return H==Oi||H==_i||H==nn||H==Pr}function gt(P){return typeof P=="number"&&P==Wn(P)}function Dt(P){return typeof P=="number"&&P>-1&&P%1==0&&P<=zt}function Lt(P){var H=typeof P;return P!=null&&(H=="object"||H=="function")}function Rt(P){return P!=null&&typeof P=="object"}var Kt=Ta?rr(Ta):af;function Ht(P,H){return P===H||Vh(P,H,ed(H))}function Qt(P,H,pe){return pe=typeof pe=="function"?pe:n,Vh(P,H,ed(H),pe)}function ui(P){return un(P)&&P!=+P}function yi(P){if(rd(P))throw new ii(x);return Pa(P)}function Yi(P){return P===null}function wn(P){return P==null}function un(P){return typeof P=="number"||Rt(P)&&bs(P)==Ai}function on(P){if(!Rt(P)||bs(P)!=ei)return!1;var H=Wl(P);if(H===null)return!0;var pe=rs.call(H,"constructor")&&H.constructor;return typeof pe=="function"&&pe instanceof pe&&yo.call(pe)==Ml}var dn=ml?rr(ml):pA;function Rn(P){return gt(P)&&P>=-zt&&P<=zt}var an=Cl?rr(Cl):yh;function Xi(P){return typeof P=="string"||!f(P)&&Rt(P)&&bs(P)==tr}function Ln(P){return typeof P=="symbol"||Rt(P)&&bs(P)==Pn}var Nn=mu?rr(mu):Uh;function pr(P){return P===n}function Vr(P){return Rt(P)&&Ul(P)==In}function Hr(P){return Rt(P)&&bs(P)==v}var Rs=wA($c),Ea=wA(function(P,H){return P<=H});function ia(P){if(!P)return[];if(p(P))return Xi(P)?ea(P):xl(P);if(Vl&&P[Vl])return Js(P[Vl]());var H=Ul(P),pe=H==Ji?qs:H==rn?Yr:Fc;return pe(P)}function ns(P){if(!P)return P===0?P:0;if(P=ir(P),P===Nt||P===-Nt){var H=P<0?-1:1;return H*Ot}return P===P?P:0}function Wn(P){var H=ns(P),pe=H%1;return H===H?pe?H-pe:H:0}function ws(P){return P?qi(Wn(P),0,wi):0}function ir(P){if(typeof P=="number")return P;if(Ln(P))return gi;if(Lt(P)){var H=typeof P.valueOf=="function"?P.valueOf():P;P=Lt(H)?H+"":H}if(typeof P!="string")return P===0?P:+P;P=kr(P);var pe=Jt.test(P);return pe||zi.test(P)?Br(P.slice(2),pe?2:8):hi.test(P)?gi:+P}function na(P){return uc(P,So(P))}function Ps(P){return P?qi(Wn(P),-zt,zt):P===0?P:0}function Kn(P){return P==null?"":xu(P)}var La=cc(function(P,H){if(TA(H)||p(H)){uc(H,co(H),P);return}for(var pe in H)rs.call(H,pe)&&Xt(P,pe,H[pe])}),Ja=cc(function(P,H){uc(H,So(H),P)}),va=cc(function(P,H,pe,Ze){uc(H,So(H),P,Ze)}),qo=cc(function(P,H,pe,Ze){uc(H,co(H),P,Ze)}),uo=kc(Gi);function ra(P,H){var pe=ee(P);return H==null?pe:Qi(pe,H)}var br=_s(function(P,H){P=Bn(P);var pe=-1,Ze=H.length,wt=Ze>2?H[2]:n;for(wt&&bu(H[0],H[1],wt)&&(Ze=1);++pe<Ze;)for(var qt=H[pe],li=So(qt),di=-1,Pi=li.length;++di<Pi;){var hn=li[di],fn=P[hn];(fn===n||J(fn,ps[hn])&&!rs.call(P,hn))&&(P[hn]=qt[hn])}return P}),wo=_s(function(P){return P.push(n,Sp),As(jp,n,P)});function nl(P,H){return Er(P,Cr(H,3),bo)}function rl(P,H){return Er(P,Cr(H,3),Qs)}function Pu(P,H){return P==null?P:ya(P,Cr(H,3),So)}function Uu(P,H){return P==null?P:xo(P,Cr(H,3),So)}function zl(P,H){return P&&bo(P,Cr(H,3))}function Rc(P,H){return P&&Qs(P,Cr(H,3))}function Gu(P){return P==null?[]:ts(P,co(P))}function qu(P){return P==null?[]:ts(P,So(P))}function Jl(P,H,pe){var Ze=P==null?n:is(P,H);return Ze===n?pe:Ze}function uh(P,H){return P!=null&&td(P,H,Do)}function sA(P,H){return P!=null&&td(P,H,Uo)}var qp=X0(function(P,H,pe){H!=null&&typeof H.toString!="function"&&(H=vo.call(H)),P[H]=pe},I1(Oc)),Od=X0(function(P,H,pe){H!=null&&typeof H.toString!="function"&&(H=vo.call(H)),rs.call(P,H)?P[H].push(pe):P[H]=[pe]},Cr),Nd=_s(Xl);function co(P){return p(P)?ot(P):Gh(P)}function So(P){return p(P)?ot(P,!0):l0(P)}function Gf(P,H){var pe={};return H=Cr(H,3),bo(P,function(Ze,wt,qt){Ei(pe,H(Ze,wt,qt),Ze)}),pe}function Hp(P,H){var pe={};return H=Cr(H,3),bo(P,function(Ze,wt,qt){Ei(pe,wt,H(Ze,wt,qt))}),pe}var Gm=cc(function(P,H,pe){Xc(P,H,pe)}),jp=cc(function(P,H,pe,Ze){Xc(P,H,pe,Ze)}),qm=kc(function(P,H){var pe={};if(P==null)return pe;var Ze=!1;H=Gs(H,function(qt){return qt=bh(qt,P),Ze||(Ze=qt.length>1),qt}),uc(P,bf(P),pe),Ze&&(pe=cn(pe,ae|ue|be,Ip));for(var wt=H.length;wt--;)hf(pe,H[wt]);return pe});function eu(P,H){return Ph(P,QA(Cr(H)))}var Hu=kc(function(P,H){return P==null?{}:Yl(P,H)});function Ph(P,H){if(P==null)return{};var pe=Gs(bf(P),function(Ze){return[Ze]});return H=Cr(H),Xu(P,pe,function(Ze,wt){return H(Ze,wt[0])})}function fc(P,H,pe){H=bh(H,P);var Ze=-1,wt=H.length;for(wt||(wt=1,P=n);++Ze<wt;){var qt=P==null?n:P[ys(H[Ze])];qt===n&&(Ze=wt,qt=pe),P=At(qt)?qt.call(P):qt}return P}function tu(P,H,pe){return P==null?P:jh(P,H,pe)}function ju(P,H,pe,Ze){return Ze=typeof Ze=="function"?Ze:n,P==null?P:jh(P,H,pe,Ze)}var Hm=Sh(co),Og=Sh(So);function b1(P,H,pe){var Ze=f(P),wt=Ze||U(P)||Nn(P);if(H=Cr(H,4),pe==null){var qt=P&&P.constructor;wt?pe=Ze?new qt:[]:Lt(P)?pe=At(qt)?ee(Wl(P)):{}:pe={}}return(wt?ro:bo)(P,function(li,di,Pi){return H(pe,li,di,Pi)}),pe}function w1(P,H){return P==null?!0:hf(P,H)}function Iu(P,H,pe){return P==null?P:xh(P,H,W0(pe))}function dc(P,H,pe,Ze){return Ze=typeof Ze=="function"?Ze:n,P==null?P:xh(P,H,W0(pe),Ze)}function Fc(P){return P==null?[]:ll(P,co(P))}function ch(P){return P==null?[]:ll(P,So(P))}function qf(P,H,pe){return pe===n&&(pe=H,H=n),pe!==n&&(pe=ir(pe),pe=pe===pe?pe:0),H!==n&&(H=ir(H),H=H===H?H:0),qi(ir(P),H,pe)}function Dh(P,H,pe){return H=ns(H),pe===n?(pe=H,H=0):pe=ns(pe),P=ir(P),Go(P,H,pe)}function q5(P,H,pe){if(pe&&typeof pe!="boolean"&&bu(P,H,pe)&&(H=pe=n),pe===n&&(typeof H=="boolean"?(pe=H,H=n):typeof P=="boolean"&&(pe=P,P=n)),P===n&&H===n?(P=0,H=1):(P=ns(P),H===n?(H=P,P=0):H=ns(H)),P>H){var Ze=P;P=H,H=Ze}if(pe||P%1||H%1){var wt=Jn();return gs(P+wt*(H-P+Ks("1e-"+((wt+"").length-1))),H)}return mA(P,H)}var H5=Wh(function(P,H,pe){return H=H.toLowerCase(),P+(pe?B2(H):H)});function B2(P){return S1(Kn(P).toLowerCase())}function z2(P){return P=Kn(P),P&&P.replace(Si,ds).replace(sr,"")}function j5(P,H,pe){P=Kn(P),H=xu(H);var Ze=P.length;pe=pe===n?Ze:qi(Wn(pe),0,Ze);var wt=pe;return pe-=H.length,pe>=0&&P.slice(pe,wt)==H}function Z5(P){return P=Kn(P),P&&ne.test(P)?P.replace(Me,wa):P}function Q5(P){return P=Kn(P),P&&Ve.test(P)?P.replace(Fe,"\\$&"):P}var W5=Wh(function(P,H,pe){return P+(pe?"-":"")+H.toLowerCase()}),$5=Wh(function(P,H,pe){return P+(pe?" ":"")+H.toLowerCase()}),X5=Tc("toLowerCase");function Y5(P,H,pe){P=Kn(P),H=Wn(H);var Ze=H?_o(P):0;if(!H||Ze>=H)return P;var wt=(H-Ze)/2;return d0(_a(wt),pe)+P+d0(ms(wt),pe)}function K5(P,H,pe){P=Kn(P),H=Wn(H);var Ze=H?_o(P):0;return H&&Ze<H?P+d0(H-Ze,pe):P}function J5(P,H,pe){P=Kn(P),H=Wn(H);var Ze=H?_o(P):0;return H&&Ze<H?d0(H-Ze,pe)+P:P}function eI(P,H,pe){return pe||H==null?H=0:H&&(H=+H),jn(Kn(P).replace(Xe,""),H||0)}function tI(P,H,pe){return(pe?bu(P,H,pe):H===n)?H=1:H=Wn(H),u0(Kn(P),H)}function iI(){var P=arguments,H=Kn(P[0]);return P.length<3?H:H.replace(P[1],P[2])}var nI=Wh(function(P,H,pe){return P+(pe?"_":"")+H.toLowerCase()});function rI(P,H,pe){return pe&&typeof pe!="number"&&bu(P,H,pe)&&(H=pe=n),pe=pe===n?wi:pe>>>0,pe?(P=Kn(P),P&&(typeof H=="string"||H!=null&&!dn(H))&&(H=xu(H),!H&&kl(P))?Cc(ea(P),0,pe):P.split(H,pe)):[]}var sI=Wh(function(P,H,pe){return P+(pe?" ":"")+S1(H)});function aI(P,H,pe){return P=Kn(P),pe=pe==null?0:qi(Wn(pe),0,P.length),H=xu(H),P.slice(pe,pe+H.length)==H}function oI(P,H,pe){var Ze=R.templateSettings;pe&&bu(P,H,pe)&&(H=n),P=Kn(P),H=va({},H,Ze,wp);var wt=va({},H.imports,Ze.imports,wp),qt=co(wt),li=ll(wt,qt),di,Pi,hn=0,fn=H.interpolate||Yt,xn="__p += '",Yn=Hn((H.escape||Yt).source+"|"+fn.source+"|"+(fn===de?ai:Yt).source+"|"+(H.evaluate||Yt).source+"|$","g"),xr="//# sourceURL="+(rs.call(H,"sourceURL")?(H.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++pl+"]")+`
`;P.replace(Yn,function($r,sa,da,hh,pc,Ah){return da||(da=hh),xn+=P.slice(hn,Ah).replace(bn,Tl),sa&&(di=!0,xn+=`' +
__e(`+sa+`) +
'`),pc&&(Pi=!0,xn+=`';
`+pc+`;
__p += '`),da&&(xn+=`' +
((__t = (`+da+`)) == null ? '' : __t) +
'`),hn=Ah+$r.length,$r}),xn+=`';
`;var Wr=rs.call(H,"variable")&&H.variable;if(!Wr)xn=`with (obj) {
`+xn+`
}
`;else if(o.test(Wr))throw new ii(a);xn=(Pi?xn.replace(Qe,""):xn).replace(Ue,"$1").replace(ft,"$1;"),xn="function("+(Wr||"obj")+`) {
`+(Wr?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(di?", __e = _.escape":"")+(Pi?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+xn+`return __p
}`;var js=F2(function(){return bi(qt,xr+"return "+xn).apply(n,li)});if(js.source=xn,qe(js))throw js;return js}function lI(P){return Kn(P).toLowerCase()}function uI(P){return Kn(P).toUpperCase()}function cI(P,H,pe){if(P=Kn(P),P&&(pe||H===n))return kr(P);if(!P||!(H=xu(H)))return P;var Ze=ea(P),wt=ea(H),qt=ko(Ze,wt),li=ul(Ze,wt)+1;return Cc(Ze,qt,li).join("")}function hI(P,H,pe){if(P=Kn(P),P&&(pe||H===n))return P.slice(0,Sa(P)+1);if(!P||!(H=xu(H)))return P;var Ze=ea(P),wt=ul(Ze,ea(H))+1;return Cc(Ze,0,wt).join("")}function AI(P,H,pe){if(P=Kn(P),P&&(pe||H===n))return P.replace(Xe,"");if(!P||!(H=xu(H)))return P;var Ze=ea(P),wt=ko(Ze,ea(H));return Cc(Ze,wt).join("")}function fI(P,H){var pe=mt,Ze=Et;if(Lt(H)){var wt="separator"in H?H.separator:wt;pe="length"in H?Wn(H.length):pe,Ze="omission"in H?xu(H.omission):Ze}P=Kn(P);var qt=P.length;if(kl(P)){var li=ea(P);qt=li.length}if(pe>=qt)return P;var di=pe-_o(Ze);if(di<1)return Ze;var Pi=li?Cc(li,0,di).join(""):P.slice(0,di);if(wt===n)return Pi+Ze;if(li&&(di+=Pi.length-di),dn(wt)){if(P.slice(di).search(wt)){var hn,fn=Pi;for(wt.global||(wt=Hn(wt.source,Kn(fi.exec(wt))+"g")),wt.lastIndex=0;hn=wt.exec(fn);)var xn=hn.index;Pi=Pi.slice(0,xn===n?di:xn)}}else if(P.indexOf(xu(wt),di)!=di){var Yn=Pi.lastIndexOf(wt);Yn>-1&&(Pi=Pi.slice(0,Yn))}return Pi+Ze}function dI(P){return P=Kn(P),P&&se.test(P)?P.replace(st,ka):P}var pI=Wh(function(P,H,pe){return P+(pe?" ":"")+H.toUpperCase()}),S1=Tc("toUpperCase");function R2(P,H,pe){return P=Kn(P),H=pe?n:H,H===n?go(P)?lu(P):gu(P):P.match(H)||[]}var F2=_s(function(P,H){try{return As(P,n,H)}catch(pe){return qe(pe)?pe:new ii(pe)}}),mI=kc(function(P,H){return ro(H,function(pe){pe=ys(pe),Ei(P,pe,rA(P[pe],P))}),P});function gI(P){var H=P==null?0:P.length,pe=Cr();return P=H?Gs(P,function(Ze){if(typeof Ze[1]!="function")throw new Xn(S);return[pe(Ze[0]),Ze[1]]}):[],_s(function(Ze){for(var wt=-1;++wt<H;){var qt=P[wt];if(As(qt[0],this,Ze))return As(qt[1],this,Ze)}})}function _I(P){return zn(cn(P,ae))}function I1(P){return function(){return P}}function yI(P,H){return P==null||P!==P?H:P}var vI=xA(),xI=xA(!0);function Oc(P){return P}function E1(P){return Ec(typeof P=="function"?P:cn(P,ae))}function bI(P){return qh(cn(P,ae))}function wI(P,H){return of(P,cn(H,ae))}var SI=_s(function(P,H){return function(pe){return Xl(pe,P,H)}}),II=_s(function(P,H){return function(pe){return Xl(P,pe,H)}});function C1(P,H,pe){var Ze=co(H),wt=ts(H,Ze);pe==null&&!(Lt(H)&&(wt.length||!Ze.length))&&(pe=H,H=P,P=this,wt=ts(H,co(H)));var qt=!(Lt(pe)&&"chain"in pe)||!!pe.chain,li=At(P);return ro(wt,function(di){var Pi=H[di];P[di]=Pi,li&&(P.prototype[di]=function(){var hn=this.__chain__;if(qt||hn){var fn=P(this.__wrapped__),xn=fn.__actions__=xl(this.__actions__);return xn.push({func:Pi,args:arguments,thisArg:P}),fn.__chain__=hn,fn}return Pi.apply(P,$o([this.value()],arguments))})}),P}function EI(){return Bs._===this&&(Bs._=Dn),this}function T1(){}function CI(P){return P=Wn(P),_s(function(H){return lf(H,P)})}var TI=Xh(Gs),kI=Xh(Ql),MI=Xh(ba);function O2(P){return CA(P)?fr(ys(P)):j0(P)}function PI(P){return function(H){return P==null?n:is(P,H)}}var DI=bp(),LI=bp(!0);function k1(){return[]}function M1(){return!1}function BI(){return{}}function zI(){return""}function RI(){return!0}function FI(P,H){if(P=Wn(P),P<1||P>zt)return[];var pe=wi,Ze=gs(P,wi);H=Cr(H),P-=wi;for(var wt=Zr(Ze,H);++pe<P;)H(pe);return wt}function OI(P){return f(P)?Gs(P,ys):Ln(P)?[P]:xl(cd(Kn(P)))}function NI(P){var H=++Wu;return Kn(P)+H}var VI=bA(function(P,H){return P+H},0),UI=xf("ceil"),GI=bA(function(P,H){return P/H},1),qI=xf("floor");function HI(P){return P&&P.length?zs(P,Oc,Ws):n}function jI(P,H){return P&&P.length?zs(P,Cr(H,2),Ws):n}function ZI(P){return Jr(P,Oc)}function QI(P,H){return Jr(P,Cr(H,2))}function WI(P){return P&&P.length?zs(P,Oc,$c):n}function $I(P,H){return P&&P.length?zs(P,Cr(H,2),$c):n}var XI=bA(function(P,H){return P*H},1),YI=xf("round"),KI=bA(function(P,H){return P-H},0);function JI(P){return P&&P.length?es(P,Oc):0}function eE(P,H){return P&&P.length?es(P,Cr(H,2)):0}return R.after=lh,R.ary=nA,R.assign=La,R.assignIn=Ja,R.assignInWith=va,R.assignWith=qo,R.at=uo,R.before=jA,R.bind=rA,R.bindAll=mI,R.bindKey=P0,R.castArray=m,R.chain=Sd,R.chunk=ih,R.compact=PA,R.concat=kp,R.cond=gI,R.conforms=_I,R.constant=I1,R.countBy=Td,R.create=ra,R.curry=Up,R.curryRight=Rd,R.debounce=Fd,R.defaults=br,R.defaultsDeep=wo,R.defer=ZA,R.delay=Bl,R.difference=_0,R.differenceBy=DA,R.differenceWith=Mp,R.drop=Ad,R.dropRight=fd,R.dropRightWhile=zm,R.dropWhile=Rm,R.fill=Fm,R.filter=Df,R.flatMap=Pd,R.flatMapDeep=bl,R.flatMapDepth=qA,R.flatten=fl,R.flattenDeep=y0,R.flattenDepth=v0,R.flip=zc,R.flow=vI,R.flowRight=xI,R.fromPairs=Pc,R.functions=Gu,R.functionsIn=qu,R.groupBy=Dd,R.initial=zA,R.intersection=Cf,R.intersectionBy=Tf,R.intersectionWith=Su,R.invert=qp,R.invertBy=Od,R.invokeMap=Np,R.iteratee=E1,R.keyBy=Ld,R.keys=co,R.keysIn=So,R.map=oh,R.mapKeys=Gf,R.mapValues=Hp,R.matches=bI,R.matchesProperty=wI,R.memoize=Mh,R.merge=Gm,R.mergeWith=jp,R.method=SI,R.methodOf=II,R.mixin=C1,R.negate=QA,R.nthArg=CI,R.omit=qm,R.omitBy=eu,R.once=WA,R.orderBy=Bd,R.over=TI,R.overArgs=Rf,R.overEvery=kI,R.overSome=MI,R.partial=D0,R.partialRight=Ff,R.partition=Ac,R.pick=Hu,R.pickBy=Ph,R.property=O2,R.propertyOf=PI,R.pull=FA,R.pullAll=nh,R.pullAllBy=OA,R.pullAllWith=b0,R.pullAt=Om,R.range=DI,R.rangeRight=LI,R.rearg=Of,R.reject=Bf,R.remove=pd,R.rest=Nf,R.reverse=kh,R.sampleSize=Vm,R.set=tu,R.setWith=ju,R.shuffle=Um,R.slice=Dc,R.sortBy=iA,R.sortedUniq=S0,R.sortedUniqBy=Mf,R.split=rI,R.spread=L0,R.tail=Yu,R.take=Lc,R.takeRight=tA,R.takeRightWhile=I0,R.takeWhile=Pp,R.tap=Fp,R.throttle=Vf,R.thru=UA,R.toArray=ia,R.toPairs=Hm,R.toPairsIn=Og,R.toPath=OI,R.toPlainObject=na,R.transform=b1,R.unary=Uf,R.union=_d,R.unionBy=Pf,R.unionWith=NA,R.uniq=Dp,R.uniqBy=yd,R.uniqWith=vd,R.unset=w1,R.unzip=sh,R.unzipWith=xd,R.update=Iu,R.updateWith=dc,R.values=Fc,R.valuesIn=ch,R.without=Lp,R.words=R2,R.wrap=Gp,R.xor=bd,R.xorBy=Bp,R.xorWith=VA,R.zip=ah,R.zipObject=zp,R.zipObjectDeep=Rp,R.zipWith=wd,R.entries=Hm,R.entriesIn=Og,R.extend=Ja,R.extendWith=va,C1(R,R),R.add=VI,R.attempt=F2,R.camelCase=H5,R.capitalize=B2,R.ceil=UI,R.clamp=qf,R.clone=h,R.cloneDeep=M,R.cloneDeepWith=q,R.cloneWith=b,R.conformsTo=K,R.deburr=z2,R.defaultTo=yI,R.divide=GI,R.endsWith=j5,R.eq=J,R.escape=Z5,R.escapeRegExp=Q5,R.every=T0,R.find=kd,R.findIndex=dd,R.findKey=nl,R.findLast=Md,R.findLastIndex=LA,R.findLastKey=rl,R.floor=qI,R.forEach=k0,R.forEachRight=M0,R.forIn=Pu,R.forInRight=Uu,R.forOwn=zl,R.forOwnRight=Rc,R.get=Jl,R.gt=me,R.gte=Ce,R.has=uh,R.hasIn=sA,R.head=BA,R.identity=Oc,R.includes=Op,R.indexOf=Ef,R.inRange=Dh,R.invoke=Nd,R.isArguments=Ne,R.isArray=f,R.isArrayBuffer=u,R.isArrayLike=p,R.isArrayLikeObject=I,R.isBoolean=L,R.isBuffer=U,R.isDate=Q,R.isElement=re,R.isEmpty=Ae,R.isEqual=_e,R.isEqualWith=Le,R.isError=qe,R.isFinite=et,R.isFunction=At,R.isInteger=gt,R.isLength=Dt,R.isMap=Kt,R.isMatch=Ht,R.isMatchWith=Qt,R.isNaN=ui,R.isNative=yi,R.isNil=wn,R.isNull=Yi,R.isNumber=un,R.isObject=Lt,R.isObjectLike=Rt,R.isPlainObject=on,R.isRegExp=dn,R.isSafeInteger=Rn,R.isSet=an,R.isString=Xi,R.isSymbol=Ln,R.isTypedArray=Nn,R.isUndefined=pr,R.isWeakMap=Vr,R.isWeakSet=Hr,R.join=x0,R.kebabCase=W5,R.last=ku,R.lastIndexOf=Th,R.lowerCase=$5,R.lowerFirst=X5,R.lt=Rs,R.lte=Ea,R.max=HI,R.maxBy=jI,R.mean=ZI,R.meanBy=QI,R.min=WI,R.minBy=$I,R.stubArray=k1,R.stubFalse=M1,R.stubObject=BI,R.stubString=zI,R.stubTrue=RI,R.multiply=XI,R.nth=RA,R.noConflict=EI,R.noop=T1,R.now=Bo,R.pad=Y5,R.padEnd=K5,R.padStart=J5,R.parseInt=eI,R.random=q5,R.reduce=zd,R.reduceRight=Lf,R.repeat=tI,R.replace=iI,R.result=fc,R.round=YI,R.runInContext=pi,R.sample=zf,R.size=Vp,R.snakeCase=nI,R.some=HA,R.sortedIndex=rh,R.sortedIndexBy=md,R.sortedIndexOf=kf,R.sortedLastIndex=gd,R.sortedLastIndexBy=Nm,R.sortedLastIndexOf=w0,R.startCase=sI,R.startsWith=aI,R.subtract=KI,R.sum=JI,R.sumBy=eE,R.template=oI,R.times=FI,R.toFinite=ns,R.toInteger=Wn,R.toLength=ws,R.toLower=lI,R.toNumber=ir,R.toSafeInteger=Ps,R.toString=Kn,R.toUpper=uI,R.trim=cI,R.trimEnd=hI,R.trimStart=AI,R.truncate=fI,R.unescape=dI,R.uniqueId=NI,R.upperCase=pI,R.upperFirst=S1,R.each=k0,R.eachRight=M0,R.first=BA,C1(R,function(){var P={};return bo(R,function(H,pe){rs.call(R.prototype,pe)||(P[pe]=H)}),P}(),{chain:!1}),R.VERSION=c,ro(["bind","bindKey","curry","curryRight","partial","partialRight"],function(P){R[P].placeholder=R}),ro(["drop","take"],function(P,H){we.prototype[P]=function(pe){pe=pe===n?1:_r(Wn(pe),0);var Ze=this.__filtered__&&!H?new we(this):this.clone();return Ze.__filtered__?Ze.__takeCount__=gs(pe,Ze.__takeCount__):Ze.__views__.push({size:gs(pe,wi),type:P+(Ze.__dir__<0?"Right":"")}),Ze},we.prototype[P+"Right"]=function(pe){return this.reverse()[P](pe).reverse()}}),ro(["filter","map","takeWhile"],function(P,H){var pe=H+1,Ze=pe==Je||pe==lt;we.prototype[P]=function(wt){var qt=this.clone();return qt.__iteratees__.push({iteratee:Cr(wt,3),type:pe}),qt.__filtered__=qt.__filtered__||Ze,qt}}),ro(["head","last"],function(P,H){var pe="take"+(H?"Right":"");we.prototype[P]=function(){return this[pe](1).value()[0]}}),ro(["initial","tail"],function(P,H){var pe="drop"+(H?"":"Right");we.prototype[P]=function(){return this.__filtered__?new we(this):this[pe](1)}}),we.prototype.compact=function(){return this.filter(Oc)},we.prototype.find=function(P){return this.filter(P).head()},we.prototype.findLast=function(P){return this.reverse().find(P)},we.prototype.invokeMap=_s(function(P,H){return typeof P=="function"?new we(this):this.map(function(pe){return Xl(pe,P,H)})}),we.prototype.reject=function(P){return this.filter(QA(Cr(P)))},we.prototype.slice=function(P,H){P=Wn(P);var pe=this;return pe.__filtered__&&(P>0||H<0)?new we(pe):(P<0?pe=pe.takeRight(-P):P&&(pe=pe.drop(P)),H!==n&&(H=Wn(H),pe=H<0?pe.dropRight(-H):pe.take(H-P)),pe)},we.prototype.takeRightWhile=function(P){return this.reverse().takeWhile(P).reverse()},we.prototype.toArray=function(){return this.take(wi)},bo(we.prototype,function(P,H){var pe=/^(?:filter|find|map|reject)|While$/.test(H),Ze=/^(?:head|last)$/.test(H),wt=R[Ze?"take"+(H=="last"?"Right":""):H],qt=Ze||/^find/.test(H);wt&&(R.prototype[H]=function(){var li=this.__wrapped__,di=Ze?[1]:arguments,Pi=li instanceof we,hn=di[0],fn=Pi||f(li),xn=function(sa){var da=wt.apply(R,$o([sa],di));return Ze&&Yn?da[0]:da};fn&&pe&&typeof hn=="function"&&hn.length!=1&&(Pi=fn=!1);var Yn=this.__chain__,xr=!!this.__actions__.length,Wr=qt&&!Yn,js=Pi&&!xr;if(!qt&&fn){li=js?li:new we(this);var $r=P.apply(li,di);return $r.__actions__.push({func:UA,args:[xn],thisArg:n}),new oe($r,Yn)}return Wr&&js?P.apply(this,di):($r=this.thru(xn),Wr?Ze?$r.value()[0]:$r.value():$r)})}),ro(["pop","push","shift","sort","splice","unshift"],function(P){var H=Hs[P],pe=/^(?:push|sort|unshift)$/.test(P)?"tap":"thru",Ze=/^(?:pop|shift)$/.test(P);R.prototype[P]=function(){var wt=arguments;if(Ze&&!this.__chain__){var qt=this.value();return H.apply(f(qt)?qt:[],wt)}return this[pe](function(li){return H.apply(f(li)?li:[],wt)})}}),bo(we.prototype,function(P,H){var pe=R[H];if(pe){var Ze=pe.name+"";rs.call(xs,Ze)||(xs[Ze]=[]),xs[Ze].push({name:H,func:pe})}}),xs[$h(n,at).name]=[{name:"wrapper",func:n}],we.prototype.clone=$e,we.prototype.reverse=_t,we.prototype.value=Ct,R.prototype.at=E0,R.prototype.chain=C0,R.prototype.commit=Bc,R.prototype.next=Id,R.prototype.plant=GA,R.prototype.reverse=Ed,R.prototype.toJSON=R.prototype.valueOf=R.prototype.value=Cd,R.prototype.first=R.prototype.head,Vl&&(R.prototype[Vl]=Mu),R},ao=gl();mo?((mo.exports=ao)._=ao,Il._=ao):Bs._=ao}).call(Jf)})(q_,q_.exports);var zR=q_.exports;function YS(e,t,n){let c=[e],g=[],x,S,a;for(;e=c.pop();)if(!(n&&n(e))&&(g.push(e),x=e.children,x))for(S=0,a=x.length;S<a;++S)c.push(x[S]);for(;e=g.pop();)t(e);return e}function RR(e,t,n){let c=[e],g,x;for(;e=c.pop();)if(!(n&&n(e))&&(t(e),g=e.children,g))for(x=g.length-1;x>=0;--x)c.push(g[x]);return e}function FR(e,t,n){let c,g=[e],x,S,a;do for(c=g.reverse(),g=[];e=c.pop();)if(!(n&&n(e))&&(t(e),x=e.children,x))for(S=0,a=x.length;S<a;++S)g.push(x[S]);while(g.length);return e}function OR(e){return YS(e,function(c){c.children&&(c.children[0].data.multiway_parent=c,c.children[1].data.multiway_parent=c.parent)}),zR.map(e.descendants(),c=>{let g=c.data.multiway_parent,x="unknown";return g&&(x=g.data.name),{source:c.data.multiway_parent,target:c,name:x}})}function NR(){let e=this.branch_length;return e?yv(this.nodes.descendants(),function(t){return!t.parent||!op(e(t))}):!1}function VR(){let e=this.branch_length;return gc(this.nodes.descendants(),t=>e(t))}function wv(e,t){let n=e.data;if("attribute"in n&&n.attribute&&n.attribute.length){t>0&&(n.attribute=String(t));let c=parseFloat(n.attribute);if(!isNaN(c))return Math.max(0,c)}if(n.name=="root")return 0;console.warn("Undefined branch length at "+n.name+"!")}function UR(e){return arguments.length?(this.branch_length_accessor=e||wv,this):this.branch_length_accessor}function GR(e){let t=this.branch_length,n=gc(this.nodes.descendants(),function(S){return t(S)?t(S):null});const c=y2(n),g=OS(n);let x=function(S){return(S-g)/(c-g)};return Zc(this.nodes.descendants(),S=>{let a=t(S);a&&t(S,x(a))}),this}function qR(e){let t=this.branch_length;return Zc(this.nodes.descendants(),n=>{let c=t(n);c&&t(n,e(c))}),this}function HR(e){return arguments.length?(this.nodeLabel=e,this):this.nodeLabel}function jR(e,t){if(!(e instanceof Yd))throw new Error("node needs to be an instance of a d3.hierarchy node!");let n=this.nodes.copy();if(t=t!==void 0?t:.5,e.parent){var c=Yd({name:"new_root"});c.children=[e.copy()],c.data.__mapped_bl=void 0,n.each(W=>{W.data.__mapped_bl=this.branch_length_accessor(W)}),this.setBranchLength(W=>W.data.__mapped_bl);let x=e,S=e.parent,a=void 0,G=e.data.__mapped_bl===void 0?void 0:e.data.__mapped_bl*t;a=S.data.__mapped_bl,S.data.__mapped_bl=e.data.__mapped_bl===void 0?void 0:e.data.__mapped_bl-G,e.data.__mapped_bl=G;var g;if(S.parent){for(c.children.push(S);S.parent;){g=S.children.indexOf(x),S.parent.parent?S.children.splice(g,1,S.parent):S.children.splice(g,1);let W=S.parent.data.__mapped_bl;W!==void 0&&(S.parent.data.__mapped_bl=a,a=W),x=S,S=S.parent}g=S.children.indexOf(x),S.children.splice(g,1)}else g=S.children.indexOf(x),S.children.splice(g,1),a=S.data.__mapped_bl,x=c;if(S.children.length==1)a&&(S.children[0].data.__mapped_bl+=a),x.children=x.children.concat(S.children);else{let W=new Yd({name:"__reroot_top_clade",__mapped_bl:a});bg(c.children[0],e),W.data.__mapped_bl=a,W.children=S.children.map(function(he){return he.parent=W,he}),W.parent=x,x.children.push(W)}}if(this.update(c),this.traverse_and_compute(x=>{Zc(x.children,S=>{S.parent=x})},"pre-order"),!op(this.display)){let x=this.display.options;dl(this.display.container).select("svg").remove();let S=this.display.selection_attribute_name;delete this.display;let a=this.render(x);a.selectionLabel(S),a.update(),dl(a.container).node().appendChild(a.show()),dl(this.display.container).dispatch("reroot")}return this}function ZR(e,t){if(e=e||"attribute",t=t||"y_scaled","parent"in this){let n=parseFloat(this[e]);this[t]=this.parent[t]+(isNaN(n)?.1:n)}else this[t]=0;return this[t]}function QR(e){let t=[];for(;e;)t.push(e),e=e.parent;return t}const WR=Object.freeze(Object.defineProperty({__proto__:null,pathToRoot:QR,reroot:jR,rootpath:ZR},Symbol.toStringTag,{value:"Module"}));function t0(e){return e.y}function Jd(e){return e.x}function H_(e,t,n){return{x:n+e*Math.sin(t),y:n+e*Math.cos(t)}}function Xb(e,t,n,c,g,x){e.radius=t*(e.radius+n),e.angle=2*Math.PI*e.x*g[0]/x[0];let S=H_(e.radius,e.angle,c);return e.x=S.x,e.y=S.y,e}function Yb(e,t){var n=H_(t[0].radius,t[0].angle,e),c=H_(t[0].radius,t[1].angle,e);return"M "+t0(n)+","+Jd(n)+" A "+t[0].radius+","+t[0].radius+" 0,0, "+(t[1].angle>t[0].angle?1:0)+" "+t0(c)+","+Jd(c)+" L "+t0(t[1])+","+Jd(t[1])}function $R(e,t,n){var c=H_(e.target.radius+(e.source.radius-e.target.radius)*t,e.target.angle,n);return{x:t0(c),y:Jd(c)}}var Kb=fv().x(function(e){return t0(e)}).y(function(e){return Jd(e)}).curve(Oz);function Jb(e,t){return{x:t0(e.target)+(t0(e.source)-t0(e.target))*t,y:Jd(e.target)}}function b2(e){return e.tag||!1}function w2(e,t){return e[t]||!1}const jo={"tree-container":"phylotree-container","tree-scale-bar":"tree-scale-bar",node:"node","internal-node":"internal-node","tagged-node":"node-tagged","selected-node":"node-selected","collapsed-node":"node-collapsed","root-node":"root-node",branch:"branch","selected-branch":"branch-selected","tagged-branch":"branch-tagged","tree-selection-brush":"tree-selection-brush","branch-tracer":"branch-tracer",clade:"clade",node_text:"phylotree-node-text"};function XR(e){return arguments.length?(this.options["internal-names"]=e,this):this.options["internal-names"]}function YR(e){return arguments.length?(this.options["is-radial"]=e,this):this.options["is-radial"]}function KR(e){return arguments.length?(this.options["align-tips"]=e,this):this.options["align-tips"]}function JR(e){return this.options["draw-size-bubbles"]&&this.options["bubble-styler"]?this.options["bubble-styler"](e):this.options["draw-size-bubbles"]?this.relative_nodeSpan(e)*this.scales[0]*.25:0}function eF(e){return this.options["is-radial"]?[(e.text_align=="end"?-1:1)*(this.radius_pad_for_bubbles-e.radius),0]:this.options["right-to-left"]?[this.right_most_leaf-e.screen_x,0]:[this.right_most_leaf-e.screen_x,0]}function tF(e){return arguments.length?(this.layout_listener_handler=e,this):this.layout_listener_handler}function iF(e){return arguments.length?(this.selection_attribute_name=e,this.syncEdgeLabels(),this):this.selection_attribute_name}function h_(e){return arguments.length?(typeof e=="string"&&e=="equal"?h_=function(t){return 1}:h_=e,this):h_}var Sv={all:e=>!0,none:e=>!1,"all-leaf-nodes":e=>Sl(e.target),"all-internal-nodes":e=>!Sl(e.target)};function nF(e){return e?(this.selectionCallback=e,this):this.selectionCallback}const rF=Object.freeze(Object.defineProperty({__proto__:null,alignTips:KR,css_classes:jo,internalNames:XR,layoutHandler:tF,nodeBubbleSize:JR,get nodeSpan(){return h_},predefined_selecters:Sv,radial:YR,selectionCallback:nF,selectionLabel:iF,shiftTip:eF},Symbol.toStringTag,{value:"Module"}));function sF(e){return this.radial()?[(e.text_align=="end"?-1:1)*(this.radius_pad_for_bubbles-e.radius),0]:this.options["right-to-left"]?[this.right_most_leaf-e.screen_x,0]:[this.right_most_leaf-e.screen_x,0]}function aF(e,t,n){e=dl(e);var c=Sl(t);c&&(e=e.attr("data-node-name",t.data.name));var g=e.selectAll("text").data([t]),x=e.selectAll("line");if(c||this.showInternalName(t)&&!lp(t))if(g=g.enter().append("text").classed(this.css_classes.node_text,!0).merge(g).on("click",a=>{this.handle_node_click(t,a)}).attr("dy",a=>this.shown_font_size*.33).text(a=>this.options["show-labels"]?this._nodeLabel(a):"").style("font-size",a=>this.ensure_size_is_in_px(this.shown_font_size)),this.radial()?g=g.attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)+this.d3PhylotreeSvgTranslate(this.alignTips()?this.shiftTip(a):null)).attr("text-anchor",a=>a.text_align):g=g.attr("text-anchor","start").attr("transform",a=>this.options.layout=="right-to-left"?this.d3PhylotreeSvgTranslate([-20,0]):this.d3PhylotreeSvgTranslate(this.alignTips()?this.shiftTip(a):null)),this.alignTips()?(x=x.data([t]),n?x=x.enter().append("line").classed(this.css_classes["branch-tracer"],!0).merge(x).attr("x1",a=>(a.text_align=="end"?-1:1)*this.nodeBubbleSize(t)).attr("x2",0).attr("y1",0).attr("y2",0).attr("x2",a=>this.options.layout=="right-to-left"?a.screen_x:this.shiftTip(a)[0]).attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)).attr("x2",a=>this.options.layout=="right-to-left"?a.screen_x:this.shiftTip(a)[0]).attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)):(x=x.enter().append("line").classed(this.css_classes["branch-tracer"],!0).merge(x).attr("x1",a=>(a.text_align=="end"?-1:1)*this.nodeBubbleSize(t)).attr("y2",0).attr("y1",0).attr("x2",a=>this.shiftTip(a)[0]),x.attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)))):x.remove(),this.options["draw-size-bubbles"]){var S=this.nodeBubbleSize(t);e.selectAll("circle").data([S]).enter().append("circle").attr("r",function(G){return G}),this.shown_font_size>=5&&(g=g.attr("dx",G=>(G.text_align=="end"?-1:1)*((this.alignTips()?0:S)+this.shown_font_size*.33)))}else this.shown_font_size>=5&&(g=g.attr("dx",a=>(a.text_align=="end"?-1:1)*this.shown_font_size*.33));if(!c){let a=e.selectAll("circle").data([t]).enter().append("circle"),G=this.node_circle_size()(t);G>0?a.merge(a).attr("r",W=>Math.min(this.shown_font_size*.75,G)).on("click",W=>{this.handle_node_click(t,W)}):a.remove()}return this.node_styler&&this.node_styler(e,t),t}function oF(){let e=this.phylotree.nodes.descendants();for(let t=e.length-1;t>=0;t-=1)Sl(e[t])?e[t].hasHiddenNodes=e[t].notshown:e[t].hasHiddenNodes=e[t].children.reduce(function(n,c){return c.notshown||n},!1);return this}function lF(e){const t=this.internalNames();return t?typeof t=="function"?t(e):t:!1}function uF(e){return arguments.length?(typeof e=="string"&&e=="equal"?this.nodeSpan=function(t){return 1}:this.nodeSpan=e,this):this.nodeSpan}function cF(e){let t=jo[Sl(e)?"node":"internal-node"];return b2(e)&&(t+=" "+jo["tagged-node"]),w2(e,this.selection_attribute_name)&&(t+=" "+jo["selected-node"]),e.parent||(t+=" "+jo["root-node"]),(lp(e)||S2(e))&&(t+=" "+jo["collapsed-node"]),t}function Iv(e){return!(e.hidden||e.notshown)}function KS(e){return e.notshown}function S2(e){return e.hasHiddenNodes||!1}function lp(e){return e.collapsed||!1}function JS(e){return[e.node,e["internal-node"],e["collapsed-node"],e["tagged-node"],e["root-node"]].reduce(function(t,n,c,g){return t+="g."+n+(c<g.length-1?",":"")},"")}function hF(e,t){this.phylotree.clearInternalNodes(t);for(var n=this.phylotree.nodes.descendants().length-1;n>=0;n--){var c=this.phylotree.nodes.descendants()[n];Sl(c)||w2(c,this.selection_attribute_name)||(c[this.selection_attribute_name]=e(c.children))}this.modifySelection((g,x)=>Sl(g.target)?g.target[this.selection_attribute_name]:g.target[this.selection_attribute_name])}function e5(e){return e=e.data,Sl(e)?e.name||"":this.showInternalName(e)?e.name:""}function AF(e){return arguments.length?(this._nodeLabel=e||e5,this.update(),this):this._nodeLabel}const fF=Object.freeze(Object.defineProperty({__proto__:null,defNodeLabel:e5,drawNode:aF,hasHiddenNodes:S2,internalLabel:hF,isNodeCollapsed:lp,nodeCssSelectors:JS,nodeLabel:AF,nodeNotshown:KS,nodeSpan:uF,nodeVisible:Iv,reclassNode:cF,shiftTip:sF,showInternalName:lF,updateHasHiddenNodes:oF},Symbol.toStringTag,{value:"Module"}));function t5(e){return[e.clade].reduce(function(t,n,c,g){return t+="path."+n+(c<g.length-1?",":"")},"")}function dF(e){let t=this.svg.selectAll("."+this.css_classes["tree-container"]);var n=0;let c=t.selectAll(t5(this.css_classes)).data(this.phylotree.nodes.descendants().filter(lp),function(S){return S.id||(S.id=++n)}),g=function(){},x=void 0;this.radial()?(g=fv().curve(Ob).y(function(S){return S[0]}).x(function(S){return S[1]}),x=function(S,a,G,W,he){return a?[G.screen_y+(S[0]-W)/50,G.screen_x+(S[1]-he)/50]:[G.screen_y,G.screen_x]}):(g=fv().y(function(S){return S[0]}).x(function(S){return S[1]}).curve(Ob),x=function(S,a,G,W,he){return a?[G.screen_y+(S[0]-W)/50,G.screen_x+(S[1]-he)/50]:[G.screen_y,G.screen_x]}),c.exit().each(function(S){S.collapsed_clade=null}).remove(),e?c.enter().insert("path",":first-child").attr("class",this.css_classes.clade).merge(c).attr("d",function(S){if(S.collapsed_clade)return S.collapsed_clade;let a=S.collapsed[0][0],G=S.collapsed[0][1];return g(S.collapsed.map(function(W,he){return x(W,he,S,a,G)}))}).attr("d",function(S){return S.collapsed_clade=g(S.collapsed)}):c.enter().insert("path",":first-child").attr("class",this.css_classes.clade).merge(c).attr("d",function(S){return S.collapsed_clade?S.collapsed_clade:S.collapsed_clade=g(S.collapsed)})}const pF=Object.freeze(Object.defineProperty({__proto__:null,cladeCssSelectors:t5,updateCollapsedClades:dF},Symbol.toStringTag,{value:"Module"}));function mF(e,t,n){e=dl(e),e=e.attr("class",S=>this.reclassEdge(S)).on("click",S=>{this.modifySelection([t.target],this.selection_attribute_name),this.update()});let c=this.draw_branch([t.source,t.target]);n&&e.datum().existing_path&&(e=e.attr("d",function(S){return S.existing_path})),e=e.attr("d",c),t.existing_path=c;var g=this.phylotree.branch_length_accessor(t.target);if(g!==void 0){var x=e.selectAll("title");x.empty()&&(x=e.append("title")),x.text("Length = "+g)}else e.selectAll("title").remove();return this.edge_styler&&this.edge_styler(e,t,n),this.phylotree}function gF(e){let t=jo.branch;return b2(e)&&(t+=" "+jo["tagged-branch"]),w2(e,this.selection_attribute_name)&&(t+=" "+jo["selected-branch"]),t}function _F(){this.links.forEach(e=>{e.target.data.annotation&&(e.target[e.target.data.annotation]=e.target.data.annotation)})}function yF(){if(this.links.forEach(e=>{e[this.selection_attribute_name]=e.target[this.selection_attribute_name]||!1,e.tag=e.target.tag||!1}),this.countHandler()){let e={};e[this.selection_attribute_name]=this.links.reduce((t,n)=>t+(n[this.selection_attribute_name]?1:0),0),e.tagged=this.links.reduce(function(t,n){return t+(b2(n)?1:0)},0),this.countUpdate(this,e,this.countHandler())}}function Ev(e){return!(e.target.hidden||e.target.notshown)}function Cv(e){return[e.branch,e["selected-branch"],e["tagged-branch"]].reduce(function(t,n,c,g){return t+="path."+n+(c<g.length-1?",":"")},"")}function vF(e,t){return this.edge_placer(e,t)}const xF=Object.freeze(Object.defineProperty({__proto__:null,drawEdge:mF,edgeCssSelectors:Cv,edgeVisible:Ev,initializeEdgeLabels:_F,placeAlongAnEdge:vF,reclassEdge:gF,syncEdgeLabels:yF},Symbol.toStringTag,{value:"Module"}));let h1="phylotree.event";function bF(e){if(e.collapsed){e.collapsed=!1;let t=function(n){Sl(n)||n.collapsed||n.children.forEach(t),n.hidden=!1};t(e)}else e.collapsed=!0;return this.placenodes(),this}function wF(e,t,n){let c=this.size;if(this.radial()){let g=this.pad_width(),x=this.options["top-bottom-spacing"]!="fit-to-size"?this.pad_height():0;c=[c[1]+2*g,c[0]+2*g+x],t&&t.selectAll("."+jo["tree-container"]).attr("transform","translate ("+g+","+(g+x)+")")}else c=[c[0]+(this.options["top-bottom-spacing"]!="fit-to-size"?this.pad_height():0),c[1]+(this.options["left-right-spacing"]!="fit-to-size"?this.pad_width():0)];return t&&(n&&(t=t.transition(100)),t.attr("height",c[0]).attr("width",c[1])),this.size=c,c}function SF(e,t){t=t||"y_scaled",t in this&&(this[t]*=e)}function Tv(e){var t=new CustomEvent(h1,{detail:["refresh",e]});document.dispatchEvent(t)}function i5(e,t){var n=new CustomEvent(h1,{detail:["countUpdate",t,e.countHandler()]});document.dispatchEvent(n)}function IF(e){var t=new CustomEvent(h1,{detail:["layout",e,e.layoutHandler()]});document.dispatchEvent(t)}function n5(e){switch(e.detail[0]){case"refresh":e.detail[1].refresh();break;case"countUpdate":e.detail[2](e.detail[1]);break;case"layout":e.detail[2](e.detail[1])}return!0}function r5(){document.addEventListener(h1,n5,!1)}function EF(e){return e&&(e[0]!==null||e[1]!==null)?"translate ("+(e[0]!==null?e[0]:0)+","+(e[1]!==null?e[1]:0)+") ":""}function CF(e){return e!==null?"rotate ("+e+") ":""}const TF=Object.freeze(Object.defineProperty({__proto__:null,countUpdate:i5,d3PhylotreeAddEventListener:r5,d3PhylotreeEventListener:n5,d3PhylotreeSvgRotate:CF,d3PhylotreeSvgTranslate:EF,d3PhylotreeTriggerLayout:IF,rescale:SF,resizeSvg:wF,toggleCollapse:bF,triggerRefresh:Tv},Symbol.toStringTag,{value:"Module"}));let ew="d3_layout_phylotree_context_menu";function kF(e,t,n,c,g){let x=dl(t).select("#"+ew);if(x.empty()&&(x=dl(t).append("div").attr("id",ew).attr("class","dropdown-menu").attr("role","menu")),x.selectAll("a").remove(),x.selectAll("h6").remove(),x.selectAll("div").remove(),e){if(!G_([!!e.menu_items,c.hide,c.selectable,c.collapsible])||!c["show-menu"])return;Sl(e)||(c.collapsible&&(x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text(lp(e)?"Expand Subtree":"Collapse Subtree").on("click",W=>{x.style("display","none"),this.toggleCollapse(e).update()}),c.selectable&&(x.append("div").attr("class","dropdown-divider"),x.append("h6").attr("class","dropdown-header").text("Toggle selection"))),c.selectable&&(x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("All descendant branches").on("click",function(W){x.style("display","none"),n.modifySelection(n.selectAllDescendants(e,!0,!0))}),x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("All terminal branches").on("click",function(W){x.style("display","none"),n.modifySelection(n.selectAllDescendants(e,!0,!1))}),x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("All internal branches").on("click",function(W){x.style("display","none"),n.modifySelection(n.selectAllDescendants(e,!1,!0))}))),e.parent&&(c.selectable&&(x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Incident branch").on("click",function(W){x.style("display","none"),n.modifySelection([e])}),x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Path to root").on("click",W=>{x.style("display","none"),this.modifySelection(this.phylotree.pathToRoot(e))}),(c.reroot||c.hide)&&x.append("div").attr("class","dropdown-divider")),c.reroot&&x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Reroot on this node").on("click",W=>{x.style("display","none"),this.phylotree.reroot(e),this.update()}),c.hide&&x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Hide this "+(Sl(e)?"node":"subtree")).on("click",W=>{x.style("display","none"),this.modifySelection([e],"notshown",!0,!0).updateHasHiddenNodes().update()})),S2(e)&&x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Show all descendant nodes").on("click",function(W){x.style("display","none"),n.modifySelection(n.selectAllDescendants(e,!0,!0),"notshown",!0,!0,"false").updateHasHiddenNodes().update()});var S=[];if("menu_items"in e&&typeof e.menu_items=="object"&&e.menu_items.forEach(function(W){W.length==3&&(!W[2]||W[2](e))&&S.push([W[0],W[1]])}),S.length){const W=[c.hide,c.selectable,c.collapsible];G_(W)&&x.append("div").attr("class","dropdown-divider"),S.forEach(function(he){x.append("a").attr("class","dropdown-item").attr("tabindex","-1").text(he[0](e)).on("click",nf(he[1],e))})}let G=document.querySelector(t).getBoundingClientRect();x.style("position","absolute").style("left",""+(g.clientX-G.x+12)+"px").style("top",""+(g.clientY-G.y)+"px").style("display","block")}else x.style("display","none")}function MF(e,t,n,c){"menu_items"in e||(e.menu_items=[]),e.menu_items.some(function(g){return g[0]==t&&g[1]==n&&g[2]==c})||e.menu_items.push([t,n,c])}function PF(e,t,n,c,g){if(t=t||this.selection_attribute_name,g=g||"toggle",this.options["restricted-selectable"].length)if(JA(pu(Sv),e))e=Sv[e];else return;if((this.options["restricted-selectable"]||this.options.selectable)&&!this.options["binary-selectable"]){var x=!1;typeof e=="function"?this.links.forEach(function(a){let G=e(a);a[t]=a[t]||!1,a[t]!=G&&(a[t]=G,x=!0,a.target[t]=G)}):(e.forEach(function(a){var G;switch(g){case"true":G=!0;break;case"false":G=!1;break;default:G=!a[t];break}a[t]!=G&&(a[t]=G,x=!0)}),this.links.forEach(function(a){a[t]=a.target[t]}));var S;x&&(c||Tv(this),this.countHandler&&(S={},S[t]=this.links.reduce(function(a,G){return a+(G[t]?1:0)},0),i5(this,S,this.countHandler)),n&&this.placenodes())}else this.options["binary-selectable"]&&(typeof e=="function"?this.links.forEach(function(a){var G=e(a);a[t]=a[t]||!1,a[t]!=G&&(a[t]=G,x=!0,a.target[t]=G),this.options["attribute-list"].forEach(function(W){W!=t&&a[t]===!0&&(a[W]=!1,a.target[W]=!1)})}):(e.forEach(function(a){var G;G=!a[t],a[t]!=G&&(a[t]=G,x=!0)}),this.links.forEach(function(a){a[t]=a.target[t],this.options["attribute-list"].forEach(function(G){G!=t&&a[t]!==!0&&(a[G]=!1,a.target[G]=!1)})})),x&&(c||Tv(this),this.countHandler()&&(S={},S[t]=this.links.reduce(function(a,G){return a+(G[t]?1:0)},0),this.countUpdate(this,S,this.countHandler())),n&&this.placenodes()));return this.selectionCallback&&t!="tag"&&this.selectionCallback(this.getSelection()),this.refresh(),this.update(),this}function DF(){return this.nodes.filter(e=>e[this.selection_attribute_name])}function LF(e,t,n){let c=[];function g(x){Sl(x)?t&&x!=e&&c.push(x):(n&&x!=e&&c.push(x),x.children.forEach(g))}return g(e),c}function BF(e){return e?(this.selectionCallback=e,this):this.selectionCallback}const zF=Object.freeze(Object.defineProperty({__proto__:null,addCustomMenu:MF,getSelection:DF,modifySelection:PF,nodeDropdownMenu:kF,selectAllDescendants:LF,selectionCallback:BF},Symbol.toStringTag,{value:"Module"}));function tw(e){return function(){return e}}class gp{constructor(t,n={}){this.css_classes=jo,this.phylotree=t,this.container=n.container,this.separation=function(g,x){return 0},this._nodeLabel=this.defNodeLabel,this.svg=null,this.selectionCallback=null,this.scales=[1,1],this.size=[1,1],this.fixed_width=[14,30],this.scale_bar_font_size=12,this.draw_branch=Kb,this.draw_scale_bar=null,this.edge_placer=Jb,this.count_listener_handler=function(){},this.layout_listener_handler=function(){},this.node_styler=void 0,this.edge_styler=void 0,this.selection_attribute_name="selected",this.right_most_leaf=0,this.label_width=0,this.radial_center=0,this.radius=1,this.radius_pad_for_bubbles=0,this.rescale_nodeSpan=1,this.relative_nodeSpan=function(g){return this.nodeSpan(g)/this.rescale_nodeSpan};let c={layout:"left-to-right",logger:console,branches:"step",scaling:!0,bootstrap:!1,"color-fill":!0,"font-size":14,"internal-names":!1,selectable:!0,"restricted-selectable":!1,collapsible:!0,"left-right-spacing":"fixed-step","top-bottom-spacing":"fixed-step","left-offset":0,"show-scale":"top","draw-size-bubbles":!1,"bubble-styler":this.radius_pad_for_bubbles,"binary-selectable":!1,"is-radial":!1,"attribute-list":[],"max-radius":768,"annular-limit":.38196601125010515,compression:.2,"align-tips":!1,"maximum-per-node-spacing":100,"minimum-per-node-spacing":2,"maximum-per-level-spacing":100,"minimum-per-level-spacing":10,node_circle_size:tw(3),transitions:null,brush:!0,reroot:!0,hide:!0,"label-nodes-with-name":!1,zoom:!1,"show-menu":!0,"show-labels":!0,"node-styler":null,"edge-styler":null,"node-span":null};this.ensure_size_is_in_px=function(g){return typeof g=="number"?g+"px":g},this.options=A2(n,c),this.font_size=this.options["font-size"],this.offsets=[0,this.font_size/2],this.shown_font_size=this.font_size,this.width=this.options.width||800,this.height=this.options.height||600,this.node_styler=this.options["node-styler"],this.edge_styler=this.options["edge-styler"],this.nodeSpan=this.options["node-span"],this.nodeSpan||(this.nodeSpan=function(g){return 1}),this.rescale_nodeSpan=this.phylotree.nodes.children.map(g=>{if(Sl(g)||this.showInternalName(g))return this.nodeSpan(g)}).reduce(function(g,x){return Math.min(x,g||1e200)},null)||1,this.initialize_svg(this.container),this.links=this.phylotree.nodes.links(),this.initializeEdgeLabels(),this.update(),r5()}pad_height(){return this.draw_scale_bar?this.scale_bar_font_size+25:0}pad_width(){this.label_width=this._label_width(this.shown_font_size);const t=this.options["show-labels"]?this.label_width:0;return this.offsets[1]+this.options["left-offset"]+t}collapse_node(t){lp(t)||(t.collapsed=!0)}set_size(t){if(!arguments.length)return this.size;let n=t;return this.options["top-bottom-spacing"]!="fixed-step"&&(this.size[0]=n[0]),this.options["left-right-spacing"]!="fixed-step"&&(this.size[1]=n[1]),this}initialize_svg(t){return this.svg!==t&&(dl(t).select("svg").remove(),this.svg=zD("svg").attr("width",this.width).attr("height",this.height),this.set_size([this.height,this.width]),this.css_classes["tree-container"]=="phylotree-container"&&(this.svg.selectAll("*").remove(),this.svg.append("defs")),dl(this.container).on("click",n=>{this.handle_node_click(null)},!0)),this}update_layout(t,n){n&&(this.nodes=Yd(t),this.nodes.each(function(c){c.id=null})),this.update(),this.syncEdgeLabels()}update(t){var n=this;this.placenodes(),t=this.transitions(t);let c=0,g=this.svg.selectAll("."+jo["tree-container"]).data([0]);if(g=g.enter().append("g").attr("class",jo["tree-container"]).merge(g).attr("transform",W=>this.d3PhylotreeSvgTranslate([this.offsets[1]+this.options["left-offset"],this.pad_height()])),this.draw_scale_bar){let W=this.svg.selectAll("."+jo["tree-scale-bar"]).data([0]);W.enter().append("g").attr("class",jo["tree-scale-bar"]).style("font-size",this.ensure_size_is_in_px(this.scale_bar_font_size)).merge(W).attr("transform",he=>this.d3PhylotreeSvgTranslate([this.offsets[1]+this.options["left-offset"],this.pad_height()-10])).call(this.draw_scale_bar),W.selectAll("text").style("text-anchor","end")}else this.svg.selectAll("."+jo["tree-scale-bar"]).remove();g=this.svg.selectAll("."+jo["tree-container"]).data([0]),this.updateCollapsedClades(t);let x=g.selectAll(Cv(jo)).data(this.links.filter(Ev),W=>W.target.id||(W.target.id=++c));x.exit().remove(),x=x.enter().insert("path",":first-child").merge(x).each(function(W){n.drawEdge(this,W,t)});let S=g.selectAll(JS(jo)).data(this.phylotree.nodes.descendants().filter(Iv),W=>W.id||(W.id=++c));if(S.exit().remove(),S=S.enter().append("g").attr("class",this.reclassNode).merge(S).attr("transform",W=>{const he=this.options.layout=="right-to-left"&&Sl(W);return W.screen_x=t0(W),W.screen_y=Jd(W),this.d3PhylotreeSvgTranslate([he?0:W.screen_x,W.screen_y])}).each(function(W){n.drawNode(this,W,t)}).attr("transform",W=>{if(!op(W.screen_x)&&!op(W.screen_y))return"translate("+W.screen_x+","+W.screen_y+")"}),this.options["label-nodes-with-name"]&&(S=S.attr("id",W=>"node-"+W.name)),this.resizeSvg(this.phylotree,this.svg,t),this.options.brush){var a=g.selectAll("."+jo["tree-selection-brush"]).data([0]).enter().insert("g",":first-child").attr("class",jo["tree-selection-brush"]),G=DB().on("brush",(W,he)=>{var ae=W.selection,ue=this.links.filter(Ev),be=ue.filter((je,nt)=>je.source.screen_x>=ae[0][0]&&je.source.screen_x<=ae[1][0]&&je.source.screen_y>=ae[0][1]&&je.source.screen_y<=ae[1][1]&&je.target.screen_x>=ae[0][0]&&je.target.screen_x<=ae[1][0]&&je.target.screen_y>=ae[0][1]&&je.target.screen_y<=ae[1][1]).map(je=>je.target);this.modifySelection(this.phylotree.links.map(je=>je.target),"tag",!1,be.length>0,"false"),this.modifySelection(be,"tag",!1,!1,"true")}).on("end",()=>{});a.call(G)}if(this.syncEdgeLabels(),this.options.zoom){let W=jz().scaleExtent([.1,10]).on("zoom",he=>{dl("."+jo["tree-container"]).attr("transform",ae=>he.transform),dl("."+jo["tree-scale-bar"]).attr("transform",ae=>{let ue=he.transform;return ue.y-=10,ue})});this.svg.call(W)}return this}_handle_single_node_layout(t){let n=this.nodeSpan(t)/this.rescale_nodeSpan;this.x=t.x=this.x+this.separation(this.last_node,t)+(this.last_span+n)*.5,this._extents[1][1]=Math.max(this._extents[1][1],t.y),this._extents[1][0]=Math.min(this._extents[1][0],t.y-n*.5),this.is_under_collapsed_parent?this._extents[0][1]=Math.max(this._extents[0][1],this.save_x+(t.x-this.save_x)*this.options.compression+this.save_span+(n*.5+this.separation(this.last_node,t))*this.options.compression):this._extents[0][1]=Math.max(this._extents[0][1],this.x+n*.5+this.separation(this.last_node,t)),this.last_node=t,this.last_span=n}tree_layout(t){if(KS(t))return;let n=Sl(t);t.text_angle=null,t.text_align=null,t.radius=null,t.angle=null;let c=!1;if(t.parent)if(this.do_scaling){if(c)return 0;if(t.y=this.phylotree.branch_length_accessor(t),typeof t.y>"u")return c=!0,0;t.y+=t.parent.y}else t.y=n?this.max_depth:t.depth;else this.x=0,t.y=0,this.last_node=null,this.last_span=0,this._extents=[[0,0],[0,0]];if(n&&this._handle_single_node_layout(t),!n)if(lp(t)&&!this.is_under_collapsed_parent){if(this.save_x=this.x,this.save_span=this.last_span*.5,this.is_under_collapsed_parent=!0,this.process_internal_node(t),this.is_under_collapsed_parent=!1,typeof t.x=="number"){t.x=this.save_x+(t.x-this.save_x)*this.options.compression+this.save_span,t.collapsed=[[t.x,t.y]];var g=x=>{x.hidden=!0,Sl(x)?(this.x=x.x=this.save_x+(x.x-this.save_x)*this.options.compression+this.save_span,t.collapsed.push([x.x,x.y])):x.children.map(g)};this.x=this.save_x,g(t),t.collapsed.splice(1,0,[this.save_x,t.y]),t.collapsed.push([this.x,t.y]),t.collapsed.push([t.x,t.y]),t.hidden=!1}}else this.process_internal_node(t);return t.x}process_internal_node(t){let n=0;if(this.showInternalName(t)){let c=t.children.length/2>>0,g=0,x=!1;for(let S=0;S<t.children.length;S++)typeof this.tree_layout(t.children[S])=="number"&&g++,g>=c&&!x&&(this._handle_single_node_layout(t),x=!0);g==0?(t.notshown=!0,t.x=void 0):x||this._handle_single_node_layout(t)}else t.x=t.children.map(this.tree_layout.bind(this)).reduce((c,g)=>typeof g=="number"?c+g:(n+=1,c),0),n==t.children.length?(t.notshown=!0,t.x=void 0):t.x/=t.children.length-n}do_lr(t){if(this.radial()&&t&&(this.offsets[1]=0),this.options["left-right-spacing"]=="fixed-step")this.size[1]=this.max_depth*this.fixed_width[1],this.scales[1]=(this.size[1]-this.offsets[1]-this.options["left-offset"])/this._extents[1][1],this.label_width=this._label_width(this.shown_font_size),this.radial()&&(this.label_width*=2);else{this.label_width=this._label_width(this.shown_font_size),t=!0;let n=this.size[1]-this.offsets[1]-this.options["left-offset"];n*.5<this.label_width&&(this.shown_font_size*=n*.5/this.label_width,this.label_width=n*.5),this.scales[1]=(this.size[1]-this.offsets[1]-this.options["left-offset"]-this.label_width)/this._extents[1][1]}}placenodes(){this._extents=[[0,0],[0,0]],this.x=0,this.last_span=0,this.last_node=null,this.last_span=0,this.save_x=this.x,this.save_span=this.last_span*.5,this.do_scaling=this.options.scaling;let t=!1;this.is_under_collapsed_parent=!1,this.max_depth=1,this.phylotree.nodes.x=this.tree_layout(this.phylotree.nodes,this.do_scaling),this.max_depth=QM(this.phylotree.nodes.descendants(),c=>c.depth),this.do_scaling&&t&&(this.do_scaling=!1,this.phylotree.nodes.x=this.tree_layout(this.phylotree.nodes));let n=!1;if(this.draw_scale_bar=this.options["show-scale"]&&this.do_scaling,this.offsets[1]=Math.max(this.font_size,-this._extents[1][0]*this.fixed_width[0]),this.options["top-bottom-spacing"]=="fixed-step"?(this.size[0]=this._extents[0][1]*this.fixed_width[0],this.scales[0]=this.fixed_width[0]):(this.scales[0]=(this.size[0]-this.pad_height())/this._extents[0][1],n=!0),this.shown_font_size=Math.min(this.font_size,this.scales[0]),this.radial()){this.draw_branch=nf(Yb,this.radial_center),this.edge_placer=$R;let c=null,g=null,x=null,S=0,a=this._extents[0][1]*this.scales[0],G=function(ue,be,je,nt,tt){return tt=tt||0,Math.sqrt((be-ue)*(be-ue)+2*(ue+tt)*(be+tt)*(1-Math.cos(je-nt)))},W=0;this.phylotree.nodes.each(ue=>{let be=ue.x*this.scales[0];ue.angle=2*Math.PI*be/a,ue.text_angle=ue.angle-Math.PI/2,ue.text_angle=ue.text_angle>0&&ue.text_angle<Math.PI,ue.text_align=ue.text_angle?"end":"start",ue.text_angle=(ue.text_angle?180:0)+ue.angle*180/Math.PI}),this.do_lr(n),this.phylotree.nodes.each(ue=>{ue.radius=ue.y*this.scales[1]/this.size[1],W=Math.max(ue.radius,W)});let he=0;this.phylotree.nodes.each(ue=>{if(!ue.children){let be=ue.x*this.scales[0];if(c!==null){let je=be-g,nt=G(ue.radius,x,ue.angle,c,he),tt=nt>0?je/nt:10*this.options["max-radius"];if(tt>this.options["max-radius"]){let at=je/this.options["max-radius"],ut=ue.radius+x,xt=ue.radius*x-(at*at-(x-ue.radius)*(x-ue.radius))/2/(1-Math.cos(c-ue.angle)),Tt=Math.sqrt(ut*ut-4*xt);he=Math.min(this.options["annular-limit"]*W,(-ut+Tt)/2),S=this.options["max-radius"]}else S=Math.max(S,tt)}c=ue.angle,g=be,x=ue.radius}}),this.radius=Math.min(this.options["max-radius"],Math.max(a/2/Math.PI,S)),n&&(this.radius=Math.min(this.radius,(Math.min(a,this._extents[1][1]*this.scales[1])-this.label_width)*.5-this.radius*he)),this.radial_center=this.radius_pad_for_bubbles=this.radius,this.draw_branch=nf(Yb,this.radial_center);let ae=1;he&&(ae=W/(W+he),this.radius*=ae),this.phylotree.nodes.each(ue=>{if(Xb(ue,this.radius,he,this.radial_center,this.scales,this.size),W=Math.max(W,ue.radius),this.options["draw-size-bubbles"]?this.radius_pad_for_bubbles=Math.max(this.radius_pad_for_bubbles,ue.radius+this.nodeBubbleSize(ue)):this.radius_pad_for_bubbles=Math.max(this.radius_pad_for_bubbles,ue.radius),ue.collapsed){ue.collapsed=ue.collapsed.map(je=>{let nt={};return nt.x=je[0],nt.y=je[1],nt=Xb(nt,this.radius,he,this.radial_center,this.scales,this.size),[nt.x,nt.y]});let be=ue.collapsed[1];ue.collapsed=ue.collapsed.filter(function(je,nt){return nt<3||nt>ue.collapsed.length-4?!0:Math.sqrt(Math.pow(je[0]-be[0],2)+Math.pow(je[1]-be[1],2))>3?(be=je,!0):!1})}}),this.size[0]=this.radial_center+this.radius/ae,this.size[1]=this.radial_center+this.radius/ae}else this.do_lr(),this.draw_branch=Kb,this.edge_placer=Jb,this.right_most_leaf=0,this.phylotree.nodes.each(c=>{if(c.x*=this.scales[0],c.y*=this.scales[1]*.8,this.options.layout=="right-to-left"&&(c.y=this._extents[1][1]*this.scales[1]-c.y),Sl(c)&&(this.right_most_leaf=Math.max(this.right_most_leaf,c.y+this.nodeBubbleSize(c))),c.collapsed){c.collapsed.forEach(x=>{x[0]*=this.scales[0],x[1]*=this.scales[1]*.8});let g=c.collapsed[1][0];c.collapsed=c.collapsed.filter(function(x,S){return S<3||S>c.collapsed.length-4?!0:x[0]-g>3?(g=x[0],!0):!1})}});if(this.draw_scale_bar){let c,g;if(this.radial()){if(g=Math.min(this.radius/5,50),c=Math.pow(10,Math.ceil(Math.log(this._extents[1][1]*g/this.radius)/Math.log(10))),g=c*(this.radius/this._extents[1][1]),g<30){let a=Math.ceil(30/g);g*=a,c*=a}}else c=this._extents[1][1],g=this.size[1]-this.offsets[1]-this.options["left-offset"]-this.shown_font_size;let x=R4().domain([0,c]).range([0,g]),S=e2(".2f");if(this.draw_scale_bar=tP().scale(x).tickFormat(function(a){return a===0?"":S(a)}),this.radial())this.draw_scale_bar.tickValues([c]);else{let a=function(W,he){return he?Math.round(W*(he=Math.pow(10,he)))/he:Math.round(W)},G=x.ticks();G=G.length>1?G[1]:G[0],this.draw_scale_bar.ticks(Math.min(10,a(g/(this.shown_font_size*S(G).length*2),0)))}}else this.draw_scale_bar=null;return this}spacing_x(t,n){return arguments.length?(this.fixed_width[0]!=t&&t>=this.options["minimum-per-node-spacing"]&&t<=this.options["maximum-per-node-spacing"]&&(this.fixed_width[0]=t,n||this.placenodes()),this):this.fixed_width[0]}spacing_y(t,n){return arguments.length?(this.fixed_width[1]!=t&&t>=this.options["minimum-per-level-spacing"]&&t<=this.options["maximum-per-level-spacing"]&&(this.fixed_width[1]=t,n||this.placenodes()),this):this.fixed_width[1]}_label_width(t){t=t||this.shown_font_size;let n=0;return this.phylotree.nodes.descendants().filter(Iv).forEach(c=>{let g=12+this._nodeLabel(c).length*t*.8;c.angle!==null&&(g*=Math.max(Math.abs(Math.cos(c.angle)),Math.abs(Math.sin(c.angle)))),n=Math.max(g,n)}),n}font_size(t){return arguments.length?(this.font_size=t===void 0?12:t,this):this.font_size}scale_bar_font_size(t){return arguments.length?(this.scale_bar_font_size=t===void 0?12:t,this):this.scale_bar_font_size}node_circle_size(t,n){return arguments.length?(this.options.node_circle_size=tw(t===void 0?3:t),this):this.options.node_circle_size}css(t){if(arguments.length===0)return this.css_classes;if(arguments.length>2){var n={};return n[t[0]]=t[1],this.css(n)}for(var c in jo)c in t&&t[c]!=jo[c]&&(jo[c]=t[c]);return this}transitions(t){return t!==void 0?t:this.options.transitions!==null?this.options.transitions:this.phylotree.nodes.descendants().length<=300}css_classes(t,n){if(!arguments.length)return this.css_classes;let c=!1;for(var g in jo)g in t&&t[g]!=this.css_classes[g]&&(c=!0,this.css_classes[g]=t[g]);return n&&c&&this.layout(),this}layout(t){return this.svg?(this.svg.selectAll("."+this.css_classes["tree-container"]+",."+this.css_classes["tree-scale-bar"]+",."+this.css_classes["tree-selection-brush"]),this.d3PhylotreeTriggerLayout(this),this.update()):(this.d3PhylotreeTriggerLayout(this),this)}handle_node_click(t,n){this.nodeDropdownMenu(t,this.container,this,this.options,n)}refresh(){if(this.svg){let n=this.svg.selectAll("."+this.css_classes["tree-container"]).selectAll(Cv(this.css_classes)).attr("class",this.reclassEdge.bind(this));this.edge_styler&&n.each(c=>{this.edge_styler(dl(this),c)})}return this}countHandler(t){return arguments.length?(this.count_listener_handler=t,this):this.count_listener_handler}style_nodes(t){return arguments.length?(this.node_styler=t,this):this.node_styler}style_edges(t){return arguments.length?(this.edge_styler=t.bind(this),this):this.edge_styler}itemSelected(t,n){return t[n]||!1}show(){return this.svg.node()}}fA(gp.prototype,pF);fA(gp.prototype,fF);fA(gp.prototype,xF);fA(gp.prototype,TF);fA(gp.prototype,zF);fA(gp.prototype,rF);function RF(e,t,n){return this.nodes.sum(function(c){return c.value}).sort(e),this.display&&(this.display.update_layout(this.nodes),this.display.update()),this}function FF(e){var t;return e=e.map(function(n){return typeof n=="string"?n:n.data.name}),this.traverse_and_compute(function(n){n.children?n.parent?(n.data.mrca=jS(...n.descendants().map(c=>c.data.mrca)),!t&&n.data.mrca.length==e.length&&(t=n)):t||(t=n):n.data.mrca=ZS([n.data.name],e)}),t}let zu=class{constructor(e,t={}){this.newick_string="",this.nodes=[],this.links=[],this.parsed_tags=[],this.partitions=[],this.branch_length_accessor=wv,this.branch_length=wv,this.logger=t.logger||console,this.selection_attribute_name="selected";var n=t.type||void 0,c=[],g=this;if(o1(n))n in ay?c=ay[n](e,t):g.logger.error("type "+n+" not in registry! Available types are "+pu(ay));else if(nc(n))try{c=n(e,t)}catch{g.logger.error("Could not parse custom format!")}else e.name=="root"?c={json:e,error:null}:typeof e!="string"?c=e:e.contentType=="application/xml"?c=XS(e):(this.newick_string=e,c=Ig(e,t));if(!c.json)g.nodes=[];else{g.nodes=Yd(c.json);let x={};g.nodes.each(S=>{S.data.annotation&&(x[S.data.annotation]=!0)}),g.parsed_tags=Object.keys(x)}return g.links=g.nodes.links(),this.hasBranchLengths()||(console.warn("Phylotree User Warning : NO BRANCH LENGTHS DETECTED, SETTING ALL LENGTHS TO 1"),this.setBranchLength(x=>1)),g}json(e){var t=0;this.traverse_and_compute(function(c){c.json_export_index=t++},e);var n=new Array(t);return t=0,this.traverse_and_compute(function(c){let g=_S(c);delete g.json_export_index,c.parent&&(g.parent=c.parent.json_export_index),c.children&&(g.children=gc(c.children,function(x){return x.json_export_index})),n[t++]=g},e),this.traverse_and_compute(function(c){delete c.json_export_index},e),JSON.stringify(n)}traverse_and_compute(e,t,n,c){t=t||"post-order";function g(a){op(a)||YS(a,e,c)}function x(a){RR(a,e,c)}function S(a){FR(a,e,c)}return t=="pre-order"?t=x:t=="in-order"?t=S:t=g,t(n||this.nodes),this}get_parsed_tags(){return this.parsed_tags}update(e){this.nodes=e}render(e){return this.display=new gp(this,e),this.display}};zu.prototype.isLeafNode=Sl;zu.prototype.selectAllDescendants=WS;zu.prototype.mrca=FF;zu.prototype.hasBranchLengths=NR;zu.prototype.getBranchLengths=VR;zu.prototype.branchName=HR;zu.prototype.normalizeBranchLengths=GR;zu.prototype.scaleBranchLengths=qR;zu.prototype.getNewick=TR;zu.prototype.resortChildren=RF;zu.prototype.setBranchLength=UR;zu.prototype.maxParsimony=BR;zu.prototype.getTipLengths=LR;zu.prototype.leftChildRightSibling=OR;fA(zu.prototype,CR);fA(zu.prototype,WR);fA(zu.prototype,PR);H4("%Y%m%d");function OF(e){let t,n,c="Taxa found in this area",g,x,S,a,G,W,he;return{c(){t=Fn("div"),n=Fn("h2"),n.textContent=c,g=wr(),x=Fn("div"),S=Fn("div"),a=Fn("span"),G=to(e[4]),this.h()},l(ae){t=On(ae,"DIV",{class:!0});var ue=yn(t);n=On(ue,"H2",{class:!0,"data-svelte-h":!0}),Zu(n)!=="svelte-bg4wlc"&&(n.textContent=c),g=Sr(ue),x=On(ue,"DIV",{id:!0,class:!0});var be=yn(x);S=On(be,"DIV",{class:!0,style:!0});var je=yn(S);a=On(je,"SPAN",{class:!0});var nt=yn(a);G=io(nt,e[4]),nt.forEach(vi),je.forEach(vi),be.forEach(vi),ue.forEach(vi),this.h()},h(){ki(n,"class","svelte-vxmxuk"),ki(a,"class","svelte-vxmxuk"),ki(S,"class",W=ep(`tree_tooltip ${e[3]?"shown":"hidden"} ${e[5]?"flip":""}`)+" svelte-vxmxuk"),ki(S,"style",he=`margin-top: calc(${e[2]}px - 2rem); left: ${e[1]}px;`),ki(x,"id","tree_container"),ki(x,"class","svelte-vxmxuk"),ki(t,"class","phylo-container svelte-vxmxuk")},m(ae,ue){Un(ae,t,ue),Hi(t,n),Hi(t,g),Hi(t,x),Hi(x,S),Hi(S,a),Hi(a,G),e[10](x)},p(ae,[ue]){ue&16&&su(G,ae[4]),ue&40&&W!==(W=ep(`tree_tooltip ${ae[3]?"shown":"hidden"} ${ae[5]?"flip":""}`)+" svelte-vxmxuk")&&ki(S,"class",W),ue&6&&he!==(he=`margin-top: calc(${ae[2]}px - 2rem); left: ${ae[1]}px;`)&&ki(S,"style",he)},i:Ra,o:Ra,d(ae){ae&&vi(t),e[10](null)}}}let oy=2e3,ly=2e3;function NF(e,t,n){let{newick:c}=t,{hex_id:g}=t,{clade:x}=t,S,a,G,W,he=!1,ae="",ue=!1;function be(tt){if(!S)return;let at="((((((((((((((((Tyrannus_melancholicus:0.619902,Tyrannus_couchii:0.619902):0.85678,Tyrannus_crassirostris:1.476682):0.29907,Tyrannus_savana:1.775751):0.825334,(Tyrannus_forficatus:0.749239,Tyrannus_verticalis:0.749239):1.851846):1.400348,(Tyrannus_tyrannus:3.53811,Tyrannus_vociferans:3.53811):0.463323):0.78852,Myiodynastes_luteiventris:4.789953):2.170634,(((Myiarchus_crinitus:1.804538,Myiarchus_cinerascens:1.804538):0.209707,Myiarchus_tyrannulus:2.014245):1.743441,Myiarchus_tuberculifer:3.757685):3.202901):1.597191,(((((((Empidonax_occidentalis:0.327604,Empidonax_difficilis:0.327604):2.426494,Empidonax_flaviventris:2.754098):1.696517,(((((Empidonax_oberholseri:2.161306,Empidonax_hammondii:2.161306):0.842122,Empidonax_minimus:3.003428):0.213631,Empidonax_wrightii:3.217059):0.333535,Empidonax_fulvifrons:3.550594):0.595988,(Empidonax_alnorum:1.979938,Empidonax_traillii:1.979938):2.166644):0.304032):0.148682,((Contopus_sordidulus:2.62665,Contopus_virens:2.626649):0.899922,Contopus_cooperi:3.526571):1.072725):0.325545,(Sayornis_saya:3.781439,(Sayornis_phoebe:1.096253,Sayornis_nigricans:1.096253):2.685186):1.143402):1.218483,Contopus_pertinax:6.143324):1.851513,Pyrocephalus_rubinus:7.994837):0.56294):19.243085,(((((((Zosterops_palpebrosus:11.24656,Chamaea_fasciata:11.246559):0.809274,Pycnonotus_jocosus:12.055832):0.37388,((((Riparia_riparia:6.967223,(Tachycineta_thalassina:4.679356,Tachycineta_bicolor:4.679355):2.287867):0.197341,(Stelgidopteryx_serripennis:6.278306,Progne_subis:6.278307):0.886257):0.999496,((Petrochelidon_pyrrhonota:2.705651,Petrochelidon_fulva:2.705651):4.890525,Hirundo_rustica:7.596175):0.567883):3.908347,(((Phylloscopus_fuscatus:7.144214,Phylloscopus_inornatus:7.144215):1.039892,Phylloscopus_borealis:8.184107):3.386782,Psaltriparus_minimus:11.57089):0.501517):0.357305):3.198033,(Alauda_arvensis:7.291984,Eremophila_alpestris:7.291985):8.33576):0.954938,(((Poecile_rufescens:3.381344,(Poecile_gambeli:2.366328,Poecile_atricapillus:2.366328):1.015016):2.5912,(Baeolophus_inornatus:1.885773,Baeolophus_ridgwayi:1.885773):4.086771):6.604761,Auriparus_flaviceps:12.577305):4.005378):1.204803,(((((((Oenanthe_oenanthe:8.401653,(Tarsiger_cyanurus:7.742944,Ficedula_albicilla:7.742944):0.658707):4.637699,Cinclus_mexicanus:13.03935):1.218385,((((Turdus_migratorius:3.909873,Turdus_obscurus:3.909873):0.383141,Turdus_rufopalliatus:4.293014):5.352109,((((Catharus_guttatus:3.89296,(Catharus_minimus:0.719248,Catharus_fuscescens:0.719248):3.173712):1.217916,Catharus_ustulatus:5.110876):2.898328,Hylocichla_mustelina:8.009204):0.832821,Ixoreus_naevius:8.842026):0.803098):2.400322,(Myadestes_townsendi:11.383646,(Sialia_currucoides:3.141333,Sialia_mexicana:3.141332):8.242315):0.661799):2.21229):0.472993,(Sturnus_vulgaris:11.154101,(((Mimus_polyglottos:5.122579,Oreoscoptes_montanus:5.12258):1.517727,((Toxostoma_curvirostre:4.120545,Toxostoma_rufum:4.120544):1.352213,(Toxostoma_bendirei:4.640856,((Toxostoma_lecontei:2.747447,Toxostoma_crissale:2.747447):0.857103,Toxostoma_redivivum:3.60455):1.036307):0.831901):1.167548):1.301648,Dumetella_carolinensis:7.941955):3.212146):3.576628):2.188836,((((((Campylorhynchus_brunneicapillus:6.585247,Thryomanes_bewickii:6.585247):0.601549,(Troglodytes_aedon:5.644158,(Cistothorus_platensis:4.091648,Cistothorus_palustris:4.091648):1.552511):1.542638):0.934231,(Catherpes_mexicanus:6.20663,Salpinctes_obsoletus:6.20663):1.914396):3.05437,((Polioptila_californica:1.690149,Polioptila_melanura:1.690149):1.702386,Polioptila_caerulea:3.392536):7.782861):2.80982,Certhia_americana:13.985217):1.128942,((Sitta_canadensis:6.561379,Sitta_pygmaea:6.56138):1.810662,Sitta_carolinensis:8.37204):6.742118):1.805406):0.407621,(((Bombycilla_garrulus:3.757978,Bombycilla_cedrorum:3.757978):8.174507,(Ptilogonys_cinereus:8.485107,Phainopepla_nitens:8.485108):3.447377):4.887578,(Regulus_calendula:7.083885,Regulus_satrapa:7.083885):9.736178):0.507124):0.145318,(((((((Sporophila_torqueola:8.419777,(((Spiza_americana:5.82027,(((Passerina_versicolor:1.374144,Passerina_ciris:1.374144):2.404035,(Passerina_caerulea:2.570987,Passerina_amoena:2.570987):1.207191):0.473037,Passerina_cyanea:4.251215):1.569056):1.286765,((((Piranga_ludoviciana:3.489746,Piranga_flava:3.489746):0.442277,Piranga_olivacea:3.932023):0.411935,Piranga_rubra:4.343958):2.254702,(Cardinalis_sinuatus:4.01511,Cardinalis_cardinalis:4.01511):2.583551):0.508374):0.258533,(Pheucticus_ludovicianus:2.914679,Pheucticus_melanocephalus:2.914679):4.450888):1.05421):0.750985,(((((((((Quiscalus_quiscula:1.355442,Quiscalus_mexicanus:1.355442):1.537226,(Euphagus_carolinus:2.263857,Euphagus_cyanocephalus:2.263857):0.628811):1.191256,(Molothrus_aeneus:1.212313,Molothrus_ater:1.212313):2.871611):0.187559,(Agelaius_phoeniceus:3.000792,Agelaius_tricolor:3.000792):1.270691):2.148377,((Icterus_spurius:2.256428,Icterus_cucullatus:2.256428):2.245507,(Icterus_parisorum:3.486088,((Icterus_bullockii:1.296631,Icterus_pustulatus:1.296631):0.372399,Icterus_galbula:1.66903):1.817059):1.015845):1.917926):0.524545,((Sturnella_neglecta:1.887192,Sturnella_magna:1.887192):4.476338,(Xanthocephalus_xanthocephalus:5.394765,Dolichonyx_oryzivorus:5.394765):0.968765):0.580875):0.481912,Icteria_virens:7.426317):0.371308,(Seiurus_aurocapilla:5.3139,((((((((((((((((Setophaga_virens:0.55378,(Setophaga_townsendi:0.205227,Setophaga_occidentalis:0.205227):0.348552):0.601999,(Setophaga_graciae:0.393728,Setophaga_nigrescens:0.393728):0.76205):0.347084,Setophaga_discolor:1.502861):0.578854,((Setophaga_pinus:1.670331,(Setophaga_coronata:1.537147,Setophaga_dominica:1.537147):0.133184):0.165304,Setophaga_palmarum:1.835635):0.246081):0.080749,Setophaga_caerulescens:2.162464):0.069445,((((Setophaga_petechia:1.220713,Setophaga_pensylvanica:1.220713):0.146616,Setophaga_striata:1.367329):0.597451,(Setophaga_castanea:1.781327,Setophaga_fusca:1.781327):0.183453):0.175384,Setophaga_magnolia:2.140164):0.091745):0.054758,Setophaga_cerulea:2.286667):0.160767,(Setophaga_americana:0.422318,Setophaga_pitiayumi:0.422318):2.025116):0.061881,Setophaga_tigrina:2.509315):0.142911,Setophaga_ruticilla:2.652226):0.113792,Setophaga_citrina:2.766018):1.230111,(((Cardellina_rubrifrons:2.573805,Cardellina_pusilla:2.573805):0.271427,Cardellina_canadensis:2.845232):0.450177,Myioborus_pictus:3.295408):0.700721):0.307199,(Geothlypis_trichas:3.17745,(Geothlypis_formosa:2.8138,(Oporornis_agilis:2.076081,(Geothlypis_tolmiei:0.877845,Geothlypis_philadelphia:0.877845):1.198236):0.73772):0.363649):1.125879):0.086537,Helmitheros_vermivorum:4.389866):0.161013,(Protonotaria_citrea:4.303031,((Parkesia_motacilla:2.097399,Parkesia_noveboracensis:2.097399):1.823707,Mniotilta_varia:3.921106):0.381926):0.247847):0.241013,(Vermivora_cyanoptera:1.250469,Vermivora_chrysoptera:1.250469):3.541423):0.522008):2.483725):0.860785,((((Ammodramus_savannarum:5.32378,Peucaea_cassinii:5.323781):1.90225,((((Spizella_pusilla:3.070337,Spizella_atrogularis:3.070337):0.256848,(Spizella_breweri:2.319898,Spizella_passerina:2.319898):1.007287):0.299515,Spizella_pallida:3.6267):3.119963,((Calamospiza_melanocorys:5.462612,Amphispiza_bilineata:5.462613):0.473245,Chondestes_grammacus:5.935857):0.810805):0.479369):0.284235,((((Ammodramus_leconteii:4.163338,Pooecetes_gramineus:4.163338):0.318831,(((Melospiza_lincolnii:1.264886,Melospiza_georgiana:1.264886):0.837596,Melospiza_melodia:2.102483):1.773568,Passerculus_sandwichensis:3.876051):0.606118):1.04583,((Pipilo_maculatus:2.033152,Pipilo_chlorurus:2.033153):2.918452,((Melozone_aberti:0.89701,Melozone_crissalis:0.89701):3.214586,Aimophila_ruficeps:4.111597):0.840007):0.576396):0.208553,((Junco_hyemalis:4.32944,((Zonotrichia_albicollis:1.15955,Zonotrichia_querula:1.15955):0.322813,(Zonotrichia_atricapilla:0.331305,Zonotrichia_leucophrys:0.331305):1.151058):2.847076):0.487674,Passerella_iliaca:4.817114):0.919439):1.773713):0.743769,(Emberiza_pusilla:3.209884,Emberiza_rustica:3.209884):5.04415):0.404376):0.512351):0.561069,(((Calcarius_ornatus:1.735516,Calcarius_pictus:1.735516):4.618411,(Plectrophenax_nivalis:5.426424,Calcarius_lapponicus:5.426425):0.927502):0.908811,Rhynchophanes_mccownii:7.262738):2.469093):1.359019,(((Chloris_sinica:5.358973,(((Spinus_pinus:3.142395,(Spinus_tristis:2.540467,(Spinus_psaltria:1.162173,Spinus_lawrencei:1.162173):1.378294):0.601928):1.090077,Carduelis_carduelis:4.232471):0.540023,((Loxia_leucoptera:1.210478,Loxia_curvirostra:1.210477):2.332016,Acanthis_flammea:3.542493):1.230001):0.586479):2.183821,((Leucosticte_tephrocotis:0.267407,Leucosticte_atrata:0.267407):6.156445,Pinicola_enucleator:6.423852):1.11894):2.79669,Fringilla_montifringilla:10.339483):0.751366):0.547327,((Motacilla_cinerea:3.178243,(Motacilla_alba:2.460116,(Motacilla_tschutschensis:1.809206,Motacilla_citreola:1.809207):0.650909):0.718127):4.53481,(((Anthus_rubescens:3.227962,Anthus_cervinus:3.227962):1.32247,Anthus_hodgsoni:4.550432):1.385479,Anthus_spragueii:5.935912):1.777141):3.925124):0.415079,Passer_domesticus:12.053257):1.148099,((Vidua_macroura:10.518889,(Estrilda_melpoda:6.721624,(Lonchura_punctulata:4.62458,Euodice_malabarica:4.62458):2.097043):3.797268):0.93593,Euplectes_franciscanus:11.454819):1.746534):4.27115):0.314981):2.469957,((((Vireo_flavoviridis:1.321439,Vireo_olivaceus:1.321439):1.199697,(Vireo_philadelphicus:1.956385,Vireo_gilvus:1.956385):0.564752):0.781661,((((Vireo_solitarius:0.707618,(Vireo_cassinii:0.402464,Vireo_plumbeus:0.402464):0.305154):0.801472,Vireo_flavifrons:1.50909):0.835561,(Vireo_vicinior:2.056349,Vireo_huttoni:2.056349):0.288302):0.466454,(Vireo_griseus:1.632751,Vireo_bellii:1.632751):1.178355):0.491692):12.019837,((Lanius_cristatus:5.837545,Lanius_ludovicianus:5.837545):5.571762,(((((Corvus_corax:4.701119,Corvus_brachyrhynchos:4.701119):1.990164,Nucifraga_columbiana:6.691283):1.298672,(Pica_nuttalli:0.392281,Pica_hudsonia:0.392281):7.597672):0.514906,(((Gymnorhinus_cyanocephalus:6.126222,((Aphelocoma_woodhouseii:0.76393,Aphelocoma_californica:0.76393):1.557404,Aphelocoma_insularis:2.321334):3.804888):0.683341,(Cyanocitta_stelleri:4.846486,Cyanocitta_cristata:4.846486):1.963078):0.455185,Calocitta_colliei:7.264749):1.240112):0.40107,Perisoreus_canadensis:8.905929):2.503378):3.913326):4.934811):7.543419):10.368133,(Psittacula_krameri:14.70458,((((Brotogeris_chiriri:1.035507,Brotogeris_versicolurus:1.035507):6.349329,Myiopsitta_monachus:7.384836):2.724171,(Amazona_albifrons:3.384577,((Amazona_autumnalis:2.541056,(Amazona_finschi:1.862114,Amazona_viridigenalis:1.862114):0.678941):0.625662,(Amazona_ochrocephala:1.165411,Amazona_aestiva:1.16541):2.001307):0.217859):6.72443):0.370969,(((Aratinga_acuticaudata:4.733532,Nandayus_nenday:4.733532):0.572154,Cyanoliseus_patagonus:5.305686):0.227193,Aratinga_mitrata:5.532878):4.947097):4.224603):23.464415):0.875789,((Falco_tinnunculus:6.236443,((Falco_mexicanus:3.250519,Falco_peregrinus:3.250519):1.551005,(Falco_columbarius:4.340078,Falco_sparverius:4.340078):0.461445):1.434919):11.560534,Caracara_plancus:17.796978):21.247806):18.167212,(((((Colaptes_auratus:7.439905,Dryocopus_pileatus:7.439906):2.995574,((((Sphyrapicus_ruber:0.691321,(Sphyrapicus_nuchalis:0.686021,Sphyrapicus_varius:0.686021):0.0053):4.673796,Sphyrapicus_thyroideus:5.365118):3.383365,(Melanerpes_uropygialis:7.684308,(Melanerpes_formicivorus:7.035306,(Melanerpes_lewis:6.403656,Melanerpes_erythrocephalus:6.403656):0.63165):0.649002):1.064176):0.729339,Picoides_arcticus:9.477822):0.957657):25.154227,Megaceryle_alcyon:35.589708):21.232651,(((((Megascops_kennicottii:9.535534,(Bubo_scandiacus:4.38794,Bubo_virginianus:4.38794):5.147594):0.399666,Strix_varia:9.935201):0.688896,(Asio_otus:6.154249,Asio_flammeus:6.154249):4.469847):2.862398,(((Glaucidium_gnoma:10.483593,Athene_cunicularia:10.483593):0.73703,Aegolius_acadicus:11.220624):0.978771,Micrathene_whitneyi:12.199394):1.2871):8.747286,Tyto_alba:22.233781):34.588578):0.214221,(((((Aquila_chrysaetos:7.964539,((((Buteogallus_anthracinus:4.536991,((((((Buteo_swainsoni:1.391803,(Buteo_albonotatus:1.258194,(Buteo_regalis:0.408815,Buteo_lagopus:0.408815):0.84938):0.13361):0.246285,Buteo_jamaicensis:1.638089):0.474275,Buteo_platypterus:2.112364):0.127968,Buteo_lineatus:2.240332):0.063671,Buteo_nitidus:2.304003):1.83132,Parabuteo_unicinctus:4.135322):0.401669):0.814523,Ictinia_mississippiensis:5.351515):1.030262,Haliaeetus_leucocephalus:6.381778):0.568816,(Accipiter_striatus:5.309671,(Circus_cyaneus:5.06055,(Accipiter_cooperii:3.903353,Accipiter_gentilis:3.903353):1.157197):0.24912):1.640922):1.013948):1.914107,Elanoides_forficatus:9.878649):1.074487,Elanus_leucurus:10.953135):1.124614,Pandion_haliaetus:12.07775):4.511346,((Coragyps_atratus:3.554197,Gymnogyps_californianus:3.554197):2.188988,Cathartes_aura:5.743185):10.84591):40.447484):0.175416):0.552342,((((((((((((((((Tryngites_subruficollis:3.158973,Calidris_bairdii:3.158973):1.069381,Calidris_melanotos:4.228355):0.721063,(Calidris_pusilla:2.559828,Calidris_mauri:2.559828):2.389589):0.443639,Calidris_himantopus:5.393057):0.153549,(((Calidris_alba:3.699876,Calidris_fuscicollis:3.699876):0.589353,Calidris_minuta:4.289229):0.510028,Calidris_minutilla:4.799257):0.747348):0.500986,Calidris_ferruginea:6.047591):0.427549,((Calidris_maritima:1.198421,Calidris_ptilocnemis:1.198421):3.144061,Calidris_alpina:4.342482):2.132658):0.368787,Calidris_subminuta:6.843928):0.480821,Philomachus_pugnax:7.324748):0.299471,(Calidris_acuminata:6.399253,(Calidris_canutus:5.09979,Aphriza_virgata:5.09979):1.299464):1.224966):3.509313,(Arenaria_interpres:3.533248,Arenaria_melanocephala:3.533248):7.600284):1.234303,((((Scolopax_minor:10.211308,(Gallinago_gallinago:3.83163,Gallinago_delicata:3.831629):6.379678):0.499977,(Limnodromus_griseus:5.529963,Limnodromus_scolopaceus:5.529963):5.181322):0.726366,Lymnocryptes_minimus:11.437651):0.649326,(((Tringa_solitaria:7.846535,((((Tringa_stagnatilis:3.841335,Tringa_glareola:3.841335):1.894987,((Tringa_nebularia:3.640261,Tringa_melanoleuca:3.640261):1.182161,Tringa_erythropus:4.822422):0.913899):0.484985,(Tringa_flavipes:5.250045,Tringa_semipalmata:5.250045):0.971262):0.372349,(Tringa_brevipes:3.111692,Tringa_incana:3.111692):3.481964):1.252879):2.273961,(((Phalaropus_fulicarius:3.166781,Phalaropus_lobatus:3.166781):4.461625,Phalaropus_tricolor:7.628406):1.797383,Xenus_cinereus:9.425789):0.694707):0.508933,Actitis_macularius:10.629429):1.457548):0.280858):0.808214,((Limosa_fedoa:4.758084,Limosa_haemastica:4.758084):2.792013,Limosa_lapponica:7.550097):5.625952):0.875709,(((Numenius_americanus:3.902998,Numenius_minutus:3.902999):3.114172,(Numenius_phaeopus:3.809099,Numenius_tahitiensis:3.809099):3.208071):3.460888,Bartramia_longicauda:10.478058):3.5737):7.503049,((((((((Chlidonias_niger:1.1619,Chlidonias_leucopterus:1.1619):3.555137,(((Sterna_paradisaea:2.604915,Sterna_hirundo:2.604915):1.016325,Sterna_forsteri:3.62124):0.268369,((Thalasseus_sandvicensis:0.607261,Thalasseus_elegans:0.607261):0.62365,Thalasseus_maximus:1.230912):2.658698):0.827428):0.955816,(Gelochelidon_nilotica:4.350884,Hydroprogne_caspia:4.350884):1.321968):1.505717,Sternula_antillarum:7.178569):0.558345,(Onychoprion_anaethetus:3.582945,Onychoprion_fuscatus:3.582945):4.153969):3.975227,Rynchops_niger:11.712141):0.654253,((((Chroicocephalus_ridibundus:1.999968,Chroicocephalus_philadelphia:1.999969):1.479186,((((((((((((Larus_hyperboreus:0.185546,(Larus_schistisagus:0.105983,Larus_glaucoides:0.105983):0.079563):0.003055,Larus_glaucescens:0.188601):0.155986,Larus_argentatus:0.344587):0.107021,Larus_californicus:0.451609):0.012053,Larus_dominicanus:0.463661):0.005221,Larus_fuscus:0.468882):0.150475,Larus_marinus:0.619357):0.206717,Larus_occidentalis:0.826074):0.18028,Larus_delawarensis:1.006355):0.196994,Larus_heermanni:1.203348):0.44514,(Larus_crassirostris:1.024276,Larus_belcheri:1.024276):0.624212):1.18797,(Leucophaeus_atricilla:0.919175,Leucophaeus_pipixcan:0.919175):1.917283):0.642696):0.981991,((Xema_sabini:2.721958,Pagophila_eburnea:2.721958):0.757049,(Rissa_tridactyla:2.551241,Rissa_brevirostris:2.551241):0.927766):0.982139):1.134354,((Hydrocoloeus_minutus:3.254208,Rhodostethia_rosea:3.254208):0.77621,Creagrus_furcatus:4.030417):1.565082):6.770894):0.839622,((((Cerorhinca_monocerata:4.962971,(Fratercula_corniculata:2.833483,Fratercula_cirrhata:2.833483):2.129488):4.069719,((Aethia_pusilla:3.348323,(Aethia_cristatella:2.915151,Aethia_psittacula:2.91515):0.433173):0.992254,Ptychoramphus_aleuticus:4.340578):4.692112):0.727745,((((Uria_lomvia:3.0028,Uria_aalge:3.0028):4.920853,(Synthliboramphus_antiquus:3.720373,(Synthliboramphus_hypoleucus:0.671056,Synthliboramphus_craveri:0.671056):3.049317):4.20328):0.407386,Cepphus_columba:8.331039):0.426139,(Brachyramphus_brevirostris:5.628663,(Brachyramphus_marmoratus:3.830719,Brachyramphus_perdix:3.830719):1.797944):3.128515):1.003257):1.771281,((Stercorarius_parasiticus:2.970954,Stercorarius_pomarinus:2.970954):1.751772,Stercorarius_longicaudus:4.722725):6.80899):1.6743):8.348792):1.743606,((((Charadrius_montanus:5.551928,((Charadrius_leschenaultii:0.169672,Charadrius_mongolus:0.169672):4.612515,Charadrius_wilsonia:4.782187):0.769741):4.443245,(((Charadrius_semipalmatus:5.377763,(Charadrius_melodus:3.821625,Charadrius_hiaticula:3.821625):1.556139):1.15835,Charadrius_vociferus:6.536113):2.319533,Charadrius_morinellus:8.855646):1.139527):1.702327,((Recurvirostra_americana:5.643946,Himantopus_mexicanus:5.643946):2.680725,(Haematopus_palliatus:0.491965,Haematopus_bachmani:0.491965):7.832705):3.37283):0.798071,((Pluvialis_fulva:2.455897,Pluvialis_dominica:2.455897):1.178289,Pluvialis_squatarola:3.634185):8.861386):10.802842):34.465924):0.473736,((((Columbina_inca:3.404918,(Columbina_talpacoti:2.266537,Columbina_passerina:2.266537):1.138381):8.482142,((Zenaida_asiatica:6.129893,Zenaida_macroura:6.129893):3.814154,((Columba_livia:6.40713,(Streptopelia_orientalis:4.04789,(Streptopelia_decaocto:0.772012,Streptopelia_roseogrisea:0.772012):3.275878):2.359239):1.408266,Patagioenas_fasciata:7.815396):2.128651):1.943014):22.893088,((Podilymbus_podiceps:7.533322,((((Podiceps_auritus:3.080437,Podiceps_grisegena:3.080437):1.451611,Podiceps_nigricollis:4.532048):0.835204,(Aechmophorus_clarkii:0.649792,Aechmophorus_occidentalis:0.649792):4.71746):0.982984,Tachybaptus_dominicus:6.350235):1.183087):15.975136,(Phaethon_lepturus:3.683466,Phaethon_aethereus:3.683465):19.824993):11.27169):0.63047,((((Cypseloides_niger:5.980303,Streptoprocne_zonaris:5.980303):4.57189,((Aeronautes_saxatalis:6.888602,Apus_apus:6.888602):0.820048,(Chaetura_vauxi:1.732059,Chaetura_pelagica:1.732059):5.97659):2.843543):21.460899,(((Eugenes_fulgens:10.670111,Lampornis_clemenciae:10.67011):0.56568,((Archilochus_colubris:1.306099,Archilochus_alexandri:1.306099):3.186673,(((Selasphorus_sasin:1.25153,(Selasphorus_calliope:0.828849,Selasphorus_rufus:0.828849):0.422681):0.256848,Selasphorus_platycercus:1.508378):0.915832,(Calypte_anna:1.752307,Calypte_costae:1.752307):0.671904):2.068562):6.743019):2.456092,Colibri_thalassinus:13.691884):18.321209):2.173856,(Phalaenoptilus_nuttallii:9.381208,(Chordeiles_acutipennis:4.827009,Chordeiles_minor:4.827009):4.554198):24.805739):1.223671):22.827456):3.416457,(((((((((Botaurus_lentiginosus:7.844435,Ixobrychus_exilis:7.844434):4.109641,(((((Bubulcus_ibis:5.166884,Ardea_alba:5.166884):0.893851,Ardea_herodias:6.060735):2.16869,Butorides_virescens:8.229425):0.603762,(Nyctanassa_violacea:8.188923,Nycticorax_nycticorax:8.188923):0.644264):0.574409,(((Egretta_rufescens:2.458797,Egretta_tricolor:2.458797):0.831606,Egretta_caerulea:3.290403):0.72769,Egretta_thula:4.018093):5.389502):2.546481):12.342126,(Pelecanus_erythrorhynchos:4.196515,Pelecanus_occidentalis:4.196516):20.099686):1.029739,((Platalea_ajaja:10.269775,(Plegadis_chihi:1.91568,Plegadis_falcinellus:1.915681):8.354095):2.358493,Eudocimus_albus:12.628269):12.697674):23.512005,(((((Phalacrocorax_auritus:1.697021,Phalacrocorax_brasilianus:1.697021):4.515643,Phalacrocorax_pelagicus:6.212664):4.997287,Anhinga_anhinga:11.209951):0.906335,(Morus_bassanus:9.617198,((Sula_leucogaster:2.47621,((Sula_dactylatra:0.004781,Sula_granti:0.004781):1.517391,Sula_nebouxii:1.522171):0.954038):2.140455,Sula_sula:4.616665):5.000533):2.499087):3.324854,((Fregata_magnificens:1.44266,Fregata_minor:1.44266):0.346144,Fregata_ariel:1.788804):13.652335):33.396807):1.031774,Mycteria_americana:49.869719):10.866735,((((((Pterodroma_macroptera:4.865339,((Pterodroma_sandwichensis:2.79345,Pterodroma_inexpectata:2.79345):1.365143,Pterodroma_cookii:4.158592):0.706747):4.068484,(((((Puffinus_newelli:1.381885,Puffinus_opisthomelas:1.381886):0.190289,Puffinus_puffinus:1.572175):3.181206,(Calonectris_leucomelas:1.592278,Calonectris_diomedea:1.592278):3.161103):1.064218,(((((Puffinus_carneipes:0.252926,Puffinus_creatopus:0.252926):0.973591,Puffinus_gravis:1.226516):0.48506,Puffinus_griseus:1.711576):0.09139,Puffinus_tenuirostris:1.802967):0.861427,(Puffinus_pacificus:1.416031,Puffinus_bulleri:1.416031):1.248363):3.153204):2.328164,(Procellaria_aequinoctialis:6.579741,Bulweria_bulwerii:6.579741):1.566021):0.788063):0.331096,Fulmarus_glacialis:9.26492):2.922377,((Oceanodroma_leucorhoa:7.765483,Oceanodroma_furcata:7.765483):0.356616,(Oceanodroma_microsoma:4.768379,Oceanodroma_tethys:4.768379):3.353719):4.065199):0.620175,Oceanites_oceanicus:12.807472):0.306744,(((Phoebastria_immutabilis:1.85668,Phoebastria_nigripes:1.85668):0.562903,Phoebastria_albatrus:2.419582):3.929057,((Thalassarche_cauta:0.262255,Diomedea_exulans:0.262255):0.760039,Thalassarche_eremita:1.022293):5.326347):6.765577):47.622239):0.137649,((((Gavia_adamsii:0.408341,Gavia_immer:0.408341):1.063572,Gavia_pacifica:1.471913):0.976038,Gavia_arctica:2.447951):3.809025,Gavia_stellata:6.256976):54.617128):0.372954,(((Cuculus_canorus:15.46785,(Coccyzus_erythropthalmus:9.696905,Coccyzus_americanus:9.696905):5.770947):5.16665,(Crotophaga_sulcirostris:16.315965,Geococcyx_californianus:16.315966):4.318537):10.43379,((Grus_canadensis:4.416436,(Grus_grus:3.717184,Anthropoides_virgo:3.717186):0.69925):19.831011,(((Fulica_americana:5.83685,Gallinula_chloropus:5.836849):3.314091,Porzana_carolina:9.15094):2.511697,((Coturnicops_noveboracensis:9.425769,Porphyrio_martinica:9.42577):1.910547,Rallus_limicola:11.336317):0.32632):12.584809):6.820845):30.178765):0.407474):2.979476,(((((((((Anas_clypeata:0.896522,(Anas_cyanoptera:0.02564,Anas_discors:0.02564):0.870882):1.980189,Anas_querquedula:2.876711):1.426198,Anas_formosa:4.302908):0.61938,(((Anas_rubripes:0.509299,Anas_platyrhynchos:0.509298):2.714019,(Anas_crecca:2.915976,Anas_acuta:2.915976):0.307342):0.754771,((Anas_falcata:0.775449,Anas_strepera:0.775449):1.386797,(Anas_americana:1.223151,Anas_penelope:1.223151):0.939095):1.815842):0.9442):0.899565,(((Aythya_marila:0.342269,Aythya_affinis:0.342269):0.646013,Aythya_fuligula:0.988282):0.508005,((Aythya_americana:0.805757,Aythya_collaris:0.805757):0.461603,(Aythya_valisineria:0.396165,Aythya_ferina:0.396165):0.871195):0.228926):4.325566):1.213051,((((Aix_sponsa:2.982111,Aix_galericulata:2.982111):1.486653,Cairina_moschata:4.468764):1.560604,Alopochen_aegyptiaca:6.029367):0.673042,((((Bucephala_albeola:3.701376,(Bucephala_clangula:1.11771,Bucephala_islandica:1.11771):2.583666):1.514894,(((Mergus_merganser:1.873201,Mergus_serrator:1.873201):1.916388,Lophodytes_cucullatus:3.789589):0.829361,Mergellus_albellus:4.618949):0.59732):0.502879,(Melanitta_nigra:4.674791,(Melanitta_fusca:2.340277,Melanitta_perspicillata:2.340277):2.334514):1.044358):0.771899,((((Somateria_mollissima:0.295178,Somateria_spectabilis:0.295178):3.689931,Polysticta_stelleri:3.985109):1.109118,Histrionicus_histrionicus:5.094227):0.811149,Clangula_hyemalis:5.905376):0.585672):0.211362):0.332494):2.655406,(((((Branta_hutchinsii:0.999185,Branta_canadensis:0.999184):2.080501,Branta_bernicla:3.079685):1.059406,((Chen_rossii:0.014032,Chen_caerulescens:0.014032):1.252823,((Anser_albifrons:0.492808,Anser_fabalis:0.492808):0.615209,Chen_canagica:1.108017):0.158837):2.872236):2.225437,(Cygnus_olor:4.159087,((Cygnus_cygnus:0.684532,Cygnus_columbianus:0.684532):0.189911,Cygnus_buccinator:0.874443):3.284644):2.205441):2.888657,Oxyura_jamaicensis:9.253185):0.437126):3.174907,(Dendrocygna_bicolor:9.39956,Dendrocygna_autumnalis:9.39956):3.465657):41.141001,((((((Lagopus_leucura:4.060241,Centrocercus_urophasianus:4.06024):1.450073,Bonasa_umbellus:5.510314):1.796859,Meleagris_gallopavo:7.307173):0.657843,Phasianus_colchicus:7.965017):3.942481,Alectoris_chukar:11.907496):3.85599,((Callipepla_californica:0.906981,Callipepla_gambelii:0.906981):6.06878,Oreortyx_pictus:6.975761):8.787725):38.242733):10.627788);",ut=new zu(at),xt=ut.render({height:ly,width:oy,"left-right-spacing":"fit-to-size","top-bottom-spacing":"fit-to-size","is-radial":!0,brush:!1,collapsible:!1,selectable:!1,reroot:!1,hide:!1,container:"#tree_container"});console.log(xt),console.log(ut.display),a&&xt.style_edges(function(Mt,Oe){a[g].includes(Oe.target.data.name)&&(Mt.style("stroke",fm()[500]),Mt.style("stroke-width","2px"))}),xt.update();let Tt=ut.display.show();if(Tt.querySelectorAll(".node-circle").forEach(Mt=>Mt.attr("r",0)),a)for(let Mt of a[g]){let Oe=Tt.querySelector(`[data-node-name="${Mt}"]`);Oe.firstChild,n_(Oe).append("circle").classed("node-circle",!0).attr("r",3).attr("title",Mt).style("fill",fm()[500])}Tt.setAttribute("width",oy),Tt.setAttribute("height",ly),Tt.setAttribute("viewBox",`0 0 ${oy/4} ${ly/4}`),console.log(Tt),S.appendChild(Tt),console.log(S.querySelectorAll(".node-circle")),S.querySelectorAll(".node-circle").forEach(Mt=>{Mt.addEventListener("mouseover",Oe=>{console.log(Oe),console.log(document.querySelector("#tree_container"));let jt=document.querySelector("#tree_container").clientWidth;n(5,ue=!1),G>jt/2&&n(5,ue=!0),n(3,he=!0),n(4,ae=Oe.target.attributes.title.value)}),Mt.addEventListener("mouseout",Oe=>{n(3,he=!1)})}),Tt.addEventListener("mousemove",Mt=>{console.log(Mt),Mt.target.localName==="svg"&&(n(1,G=Mt.layerX),n(2,W=Mt.layerY))})}async function je(tt){return fetch(`/phast/data/${tt}_hex_species.json`).then(at=>at.json()).then(at=>(n(9,a=JSON.parse(at[0])),a))}xc(async()=>{je(x).then(tt=>be()).then(()=>console.log("built node map"))});function nt(tt){pa[tt?"unshift":"push"](()=>{S=tt,n(0,S)})}return e.$$set=tt=>{"newick"in tt&&n(6,c=tt.newick),"hex_id"in tt&&n(7,g=tt.hex_id),"clade"in tt&&n(8,x=tt.clade)},e.$$.update=()=>{e.$$.dirty&321&&c&&S&&be(),e.$$.dirty&768&&x&&!a&&je(x)},[S,G,W,he,ae,ue,c,g,x,a,nt]}class VF extends fo{constructor(t){super(),po(this,t,NF,OF,Oa,{newick:6,hex_id:7,clade:8})}}function iw(e){let t;return{c(){t=Fn("div"),this.h()},l(n){t=On(n,"DIV",{class:!0}),yn(t).forEach(vi),this.h()},h(){ki(t,"class","mdc-button__touch")},m(n,c){Un(n,t,c)},d(n){n&&vi(t)}}}function UF(e){let t,n,c,g;const x=e[28].default,S=ql(x,e,e[30],null);let a=e[6]&&iw();return{c(){t=Fn("div"),n=wr(),S&&S.c(),a&&a.c(),c=Ls(),this.h()},l(G){t=On(G,"DIV",{class:!0}),yn(t).forEach(vi),n=Sr(G),S&&S.l(G),a&&a.l(G),c=Ls(),this.h()},h(){ki(t,"class","mdc-button__ripple")},m(G,W){Un(G,t,W),Un(G,n,W),S&&S.m(G,W),a&&a.m(G,W),Un(G,c,W),g=!0},p(G,W){S&&S.p&&(!g||W[0]&1073741824)&&Hl(S,x,G,G[30],g?Zl(x,G[30],W,null):jl(G[30]),null),G[6]?a||(a=iw(),a.c(),a.m(c.parentNode,c)):a&&(a.d(1),a=null)},i(G){g||($i(S,G),g=!0)},o(G){ln(S,G),g=!1},d(G){G&&(vi(t),vi(n),vi(c)),S&&S.d(G),a&&a.d(G)}}}function GF(e){let t,n,c;const g=[{tag:e[10]},{use:[[$d,{ripple:e[3],unbounded:!1,color:e[4],disabled:!!e[23].disabled,addClass:e[19],removeClass:e[20],addStyle:e[21]}],e[17],...e[0]]},{class:Es({[e[1]]:!0,"mdc-button":!0,"mdc-button--raised":e[5]==="raised","mdc-button--unelevated":e[5]==="unelevated","mdc-button--outlined":e[5]==="outlined","smui-button--color-secondary":e[4]==="secondary","mdc-button--touch":e[6],"mdc-card__action":e[18]==="card:action","mdc-card__action--button":e[18]==="card:action","mdc-dialog__button":e[18]==="dialog:action","mdc-top-app-bar__navigation-icon":e[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":e[18]==="top-app-bar:action","mdc-snackbar__action":e[18]==="snackbar:actions","mdc-banner__secondary-action":e[18]==="banner"&&e[8],"mdc-banner__primary-action":e[18]==="banner"&&!e[8],"mdc-tooltip__action":e[18]==="tooltip:rich-actions",...e[12]})},{style:Object.entries(e[13]).map(uy).concat([e[2]]).join(" ")},e[16],e[15],e[14],{href:e[7]},e[23]];var x=e[9];function S(a,G){let W={$$slots:{default:[UF]},$$scope:{ctx:a}};if(G!==void 0&&G[0]&12580351)W=ma(g,[G[0]&1024&&{tag:a[10]},G[0]&12189721&&{use:[[$d,{ripple:a[3],unbounded:!1,color:a[4],disabled:!!a[23].disabled,addClass:a[19],removeClass:a[20],addStyle:a[21]}],a[17],...a[0]]},G[0]&266610&&{class:Es({[a[1]]:!0,"mdc-button":!0,"mdc-button--raised":a[5]==="raised","mdc-button--unelevated":a[5]==="unelevated","mdc-button--outlined":a[5]==="outlined","smui-button--color-secondary":a[4]==="secondary","mdc-button--touch":a[6],"mdc-card__action":a[18]==="card:action","mdc-card__action--button":a[18]==="card:action","mdc-dialog__button":a[18]==="dialog:action","mdc-top-app-bar__navigation-icon":a[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":a[18]==="top-app-bar:action","mdc-snackbar__action":a[18]==="snackbar:actions","mdc-banner__secondary-action":a[18]==="banner"&&a[8],"mdc-banner__primary-action":a[18]==="banner"&&!a[8],"mdc-tooltip__action":a[18]==="tooltip:rich-actions",...a[12]})},G[0]&8196&&{style:Object.entries(a[13]).map(uy).concat([a[2]]).join(" ")},G[0]&65536&&Os(a[16]),G[0]&32768&&Os(a[15]),G[0]&16384&&Os(a[14]),G[0]&128&&{href:a[7]},G[0]&8388608&&Os(a[23])]);else for(let he=0;he<g.length;he+=1)W=gr(W,g[he]);return{props:W}}return x&&(t=ef(x,S(e)),e[29](t),t.$on("click",e[22])),{c(){t&&ls(t.$$.fragment),n=Ls()},l(a){t&&Ds(t.$$.fragment,a),n=Ls()},m(a,G){t&&us(t,a,G),Un(a,n,G),c=!0},p(a,G){if(G[0]&512&&x!==(x=a[9])){if(t){zo();const W=t;ln(W.$$.fragment,1,0,()=>{cs(W,1)}),Ro()}x?(t=ef(x,S(a,G)),a[29](t),t.$on("click",a[22]),ls(t.$$.fragment),$i(t.$$.fragment,1),us(t,n.parentNode,n)):t=null}else if(x){const W=G[0]&12580351?ma(g,[G[0]&1024&&{tag:a[10]},G[0]&12189721&&{use:[[$d,{ripple:a[3],unbounded:!1,color:a[4],disabled:!!a[23].disabled,addClass:a[19],removeClass:a[20],addStyle:a[21]}],a[17],...a[0]]},G[0]&266610&&{class:Es({[a[1]]:!0,"mdc-button":!0,"mdc-button--raised":a[5]==="raised","mdc-button--unelevated":a[5]==="unelevated","mdc-button--outlined":a[5]==="outlined","smui-button--color-secondary":a[4]==="secondary","mdc-button--touch":a[6],"mdc-card__action":a[18]==="card:action","mdc-card__action--button":a[18]==="card:action","mdc-dialog__button":a[18]==="dialog:action","mdc-top-app-bar__navigation-icon":a[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":a[18]==="top-app-bar:action","mdc-snackbar__action":a[18]==="snackbar:actions","mdc-banner__secondary-action":a[18]==="banner"&&a[8],"mdc-banner__primary-action":a[18]==="banner"&&!a[8],"mdc-tooltip__action":a[18]==="tooltip:rich-actions",...a[12]})},G[0]&8196&&{style:Object.entries(a[13]).map(uy).concat([a[2]]).join(" ")},G[0]&65536&&Os(a[16]),G[0]&32768&&Os(a[15]),G[0]&16384&&Os(a[14]),G[0]&128&&{href:a[7]},G[0]&8388608&&Os(a[23])]):{};G[0]&1073741888&&(W.$$scope={dirty:G,ctx:a}),t.$set(W)}},i(a){c||(t&&$i(t.$$.fragment,a),c=!0)},o(a){t&&ln(t.$$.fragment,a),c=!1},d(a){a&&vi(n),e[29](null),t&&cs(t,a)}}}const uy=([e,t])=>`${e}: ${t};`;function qF(e,t,n){let c,g,x;const S=["use","class","style","ripple","color","variant","touch","href","action","defaultAction","secondary","component","tag","getElement"];let a=Ao(t,S),{$$slots:G={},$$scope:W}=t;const he=Sc(vc());let{use:ae=[]}=t,{class:ue=""}=t,{style:be=""}=t,{ripple:je=!0}=t,{color:nt="primary"}=t,{variant:tt="text"}=t,{touch:at=!1}=t,{href:ut=void 0}=t,{action:xt="close"}=t,{defaultAction:Tt=!1}=t,{secondary:Mt=!1}=t,Oe,jt={},it={},vt=Cu("SMUI:button:context"),{component:mt=tf}=t,{tag:Et=mt===tf?ut==null?"button":"a":void 0}=t,Pt=a.disabled;du("SMUI:label:context","button"),du("SMUI:icon:context","button");function dt(Ot){jt[Ot]||n(12,jt[Ot]=!0,jt)}function Je(Ot){(!(Ot in jt)||jt[Ot])&&n(12,jt[Ot]=!1,jt)}function pt(Ot,gi){it[Ot]!=gi&&(gi===""||gi==null?(delete it[Ot],n(13,it)):n(13,it[Ot]=gi,it))}function lt(){vt==="banner"&&au(Nt(),Mt?"SMUIBannerButton:secondaryActionClick":"SMUIBannerButton:primaryActionClick")}function Nt(){return Oe.getElement()}function zt(Ot){pa[Ot?"unshift":"push"](()=>{Oe=Ot,n(11,Oe)})}return e.$$set=Ot=>{n(31,t=gr(gr({},t),ic(Ot))),n(23,a=Ao(t,S)),"use"in Ot&&n(0,ae=Ot.use),"class"in Ot&&n(1,ue=Ot.class),"style"in Ot&&n(2,be=Ot.style),"ripple"in Ot&&n(3,je=Ot.ripple),"color"in Ot&&n(4,nt=Ot.color),"variant"in Ot&&n(5,tt=Ot.variant),"touch"in Ot&&n(6,at=Ot.touch),"href"in Ot&&n(7,ut=Ot.href),"action"in Ot&&n(24,xt=Ot.action),"defaultAction"in Ot&&n(25,Tt=Ot.defaultAction),"secondary"in Ot&&n(8,Mt=Ot.secondary),"component"in Ot&&n(9,mt=Ot.component),"tag"in Ot&&n(10,Et=Ot.tag),"$$scope"in Ot&&n(30,W=Ot.$$scope)},e.$$.update=()=>{if(n(16,c=vt==="dialog:action"&&xt!=null?{"data-mdc-dialog-action":xt}:{action:t.action}),n(15,g=vt==="dialog:action"&&Tt?{"data-mdc-dialog-button-default":""}:{default:t.default}),n(14,x=vt==="banner"?{}:{secondary:t.secondary}),Pt!==a.disabled){const Ot=Nt();"blur"in Ot&&Ot.blur(),n(27,Pt=a.disabled)}},t=ic(t),[ae,ue,be,je,nt,tt,at,ut,Mt,mt,Et,Oe,jt,it,x,g,c,he,vt,dt,Je,pt,lt,a,xt,Tt,Nt,Pt,G,zt,W]}class HF extends fo{constructor(t){super(),po(this,t,qF,GF,Oa,{use:0,class:1,style:2,ripple:3,color:4,variant:5,touch:6,href:7,action:24,defaultAction:25,secondary:8,component:9,tag:10,getElement:26},null,[-1,-1])}get getElement(){return this.$$.ctx[26]}}function jF(e){let t,n,c;const g=e[2].default,x=ql(g,e,e[1],null);return{c(){t=Fn("div"),x&&x.c(),this.h()},l(S){t=On(S,"DIV",{class:!0});var a=yn(t);x&&x.l(a),a.forEach(vi),this.h()},h(){ki(t,"class",n="s-app theme--"+e[0])},m(S,a){Un(S,t,a),x&&x.m(t,null),c=!0},p(S,[a]){x&&x.p&&(!c||a&2)&&Hl(x,g,S,S[1],c?Zl(g,S[1],a,null):jl(S[1]),null),(!c||a&1&&n!==(n="s-app theme--"+S[0]))&&ki(t,"class",n)},i(S){c||($i(x,S),c=!0)},o(S){ln(x,S),c=!1},d(S){S&&vi(t),x&&x.d(S)}}}function ZF(e,t,n){let{$$slots:c={},$$scope:g}=t,{theme:x="light"}=t;return e.$$set=S=>{"theme"in S&&n(0,x=S.theme),"$$scope"in S&&n(1,g=S.$$scope)},[x,g,c]}class QF extends fo{constructor(t){super(),po(this,t,ZF,jF,Oa,{theme:0})}}function WF(e){return e.split(" ").map(t=>/^(lighten|darken|accent)-/.test(t)?`text-${t}`:`${t}-text`)}function nw(e,t){if(/^(#|rgb|hsl|currentColor)/.test(t))return e.style.color=t,!1;if(t.startsWith("--"))return e.style.color=`var(${t})`,!1;const n=WF(t);return e.classList.add(...n),n}const $F=(e,t)=>{let n;return typeof t=="string"&&(n=nw(e,t)),{update(c){n?e.classList.remove(...n):e.style.color=null,typeof c=="string"&&(n=nw(e,c))}}};let rw=36,XF="";for(;rw--;)XF+=rw.toString(36);function sw(e){let t,n=[{class:"underlay"},e[9],{"stroke-dashoffset":"0"}],c={};for(let g=0;g<n.length;g+=1)c=gr(c,n[g]);return{c(){t=Ba("circle"),this.h()},l(g){t=za(g,"circle",{class:!0,"stroke-dashoffset":!0}),yn(t).forEach(vi),this.h()},h(){p_(t,c),em(t,"svelte-kiaiot",!0)},m(g,x){Un(g,t,x)},p(g,x){em(t,"svelte-kiaiot",!0)},d(g){g&&vi(t)}}}function YF(e){let t,n,c,g,x,S,a,G,W,he,ae,ue=!e[1]&&sw(e),be=[{class:"overlay"},e[9],{"stroke-dashoffset":e[8]}],je={};for(let at=0;at<be.length;at+=1)je=gr(je,be[at]);const nt=e[12].default,tt=ql(nt,e,e[11],null);return{c(){t=Fn("div"),n=Ba("svg"),ue&&ue.c(),c=Ba("circle"),g=wr(),x=Fn("div"),tt&&tt.c(),this.h()},l(at){t=On(at,"DIV",{role:!0,"aria-valuemin":!0,"aria-valuemax":!0,"aria-valuenow":!0,class:!0,style:!0});var ut=yn(t);n=za(ut,"svg",{xmlns:!0,viewBox:!0,style:!0,class:!0});var xt=yn(n);ue&&ue.l(xt),c=za(xt,"circle",{class:!0,"stroke-dashoffset":!0}),yn(c).forEach(vi),xt.forEach(vi),g=Sr(ut),x=On(ut,"DIV",{class:!0});var Tt=yn(x);tt&&tt.l(Tt),Tt.forEach(vi),ut.forEach(vi),this.h()},h(){p_(c,je),em(c,"svelte-kiaiot",!0),ki(n,"xmlns","http://www.w3.org/2000/svg"),ki(n,"viewBox",e[7]+`
    `+e[7]+`
    `+2*e[7]+`
    `+2*e[7]),By(n,"transform","rotate("+e[3]+"deg)"),ki(n,"class","svelte-kiaiot"),ki(x,"class","s-progress-circular__content svelte-kiaiot"),ki(t,"role","progressbar"),ki(t,"aria-valuemin","0"),ki(t,"aria-valuemax","100"),ki(t,"aria-valuenow",e[5]),ki(t,"class",S="s-progress-circular "+e[0]+" svelte-kiaiot"),ki(t,"style",a="width:"+e[4]+"px;height:"+e[4]+"px;"+e[6]),em(t,"indeterminate",e[1])},m(at,ut){Un(at,t,ut),Hi(t,n),ue&&ue.m(n,null),Hi(n,c),Hi(t,g),Hi(t,x),tt&&tt.m(x,null),W=!0,he||(ae=Io(G=$F.call(null,t,e[2])),he=!0)},p(at,[ut]){at[1]?ue&&(ue.d(1),ue=null):ue?ue.p(at,ut):(ue=sw(at),ue.c(),ue.m(n,c)),em(c,"svelte-kiaiot",!0),(!W||ut&8)&&By(n,"transform","rotate("+at[3]+"deg)"),tt&&tt.p&&(!W||ut&2048)&&Hl(tt,nt,at,at[11],W?Zl(nt,at[11],ut,null):jl(at[11]),null),(!W||ut&32)&&ki(t,"aria-valuenow",at[5]),(!W||ut&1&&S!==(S="s-progress-circular "+at[0]+" svelte-kiaiot"))&&ki(t,"class",S),(!W||ut&80&&a!==(a="width:"+at[4]+"px;height:"+at[4]+"px;"+at[6]))&&ki(t,"style",a),G&&Eu(G.update)&&ut&4&&G.update.call(null,at[2]),(!W||ut&3)&&em(t,"indeterminate",at[1])},i(at){W||($i(tt,at),W=!0)},o(at){ln(tt,at),W=!1},d(at){at&&vi(t),ue&&ue.d(),tt&&tt.d(at),he=!1,ae()}}}const cy=20;function KF(e,t,n){let{$$slots:c={},$$scope:g}=t,{class:x=""}=t,{indeterminate:S=!1}=t,{color:a="secondary"}=t,{rotate:G=0}=t,{size:W=32}=t,{value:he=0}=t,{width:ae=4}=t,{style:ue=""}=t;const be=2*3.1416*cy,je=cy/(1-Number(ae)/+W),nt=Number(ae)/+W*je*2,tt=(100-he)/100*be,at={fill:"transparent",cx:2*je,cy:2*je,r:cy,"stroke-width":nt,"stroke-dasharray":be};return e.$$set=ut=>{"class"in ut&&n(0,x=ut.class),"indeterminate"in ut&&n(1,S=ut.indeterminate),"color"in ut&&n(2,a=ut.color),"rotate"in ut&&n(3,G=ut.rotate),"size"in ut&&n(4,W=ut.size),"value"in ut&&n(5,he=ut.value),"width"in ut&&n(10,ae=ut.width),"style"in ut&&n(6,ue=ut.style),"$$scope"in ut&&n(11,g=ut.$$scope)},[x,S,a,G,W,he,ue,je,tt,at,ae,g,c]}class JF extends fo{constructor(t){super(),po(this,t,KF,YF,Oa,{class:0,indeterminate:1,color:2,rotate:3,size:4,value:5,width:10,style:6})}}function eO(e){let t,n;return t=new JF({props:{size:50,indeterminate:!0,color:fm()[500]}}),{c(){ls(t.$$.fragment)},l(c){Ds(t.$$.fragment,c)},m(c,g){us(t,c,g),n=!0},p:Ra,i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){ln(t.$$.fragment,c),n=!1},d(c){cs(t,c)}}}function aw(e){let t,n;return{c(){t=Fn("h3"),n=to(e[0]),this.h()},l(c){t=On(c,"H3",{class:!0});var g=yn(t);n=io(g,e[0]),g.forEach(vi),this.h()},h(){ki(t,"class","svelte-10jlhi")},m(c,g){Un(c,t,g),Hi(t,n)},p(c,g){g&1&&su(n,c[0])},d(c){c&&vi(t)}}}function tO(e){let t,n,c,g;n=new QF({props:{$$slots:{default:[eO]},$$scope:{ctx:e}}});let x=e[0]&&aw(e);return{c(){t=Fn("div"),ls(n.$$.fragment),c=wr(),x&&x.c(),this.h()},l(S){t=On(S,"DIV",{class:!0});var a=yn(t);Ds(n.$$.fragment,a),c=Sr(a),x&&x.l(a),a.forEach(vi),this.h()},h(){ki(t,"class","loading-container svelte-10jlhi")},m(S,a){Un(S,t,a),us(n,t,null),Hi(t,c),x&&x.m(t,null),g=!0},p(S,[a]){const G={};a&2&&(G.$$scope={dirty:a,ctx:S}),n.$set(G),S[0]?x?x.p(S,a):(x=aw(S),x.c(),x.m(t,null)):x&&(x.d(1),x=null)},i(S){g||($i(n.$$.fragment,S),g=!0)},o(S){ln(n.$$.fragment,S),g=!1},d(S){S&&vi(t),cs(n),x&&x.d()}}}function iO(e,t,n){let{message:c}=t;return e.$$set=g=>{"message"in g&&n(0,c=g.message)},[c]}class s5 extends fo{constructor(t){super(),po(this,t,iO,tO,Oa,{message:0})}}function ow(e,t,n){const c=e.slice();return c[16]=t[n],c}function lw(e,t,n){const c=e.slice();return c[16]=t[n],c}function uw(e,t,n){const c=e.slice();return c[16]=t[n],c}function nO(e){let t=e[16].name+"",n;return{c(){n=to(t)},l(c){n=io(c,t)},m(c,g){Un(c,n,g)},p(c,g){g&16&&t!==(t=c[16].name+"")&&su(n,t)},d(c){c&&vi(n)}}}function cw(e){let t,n;return t=new Tg({props:{value:e[16],$$slots:{default:[nO]},$$scope:{ctx:e}}}),{c(){ls(t.$$.fragment)},l(c){Ds(t.$$.fragment,c)},m(c,g){us(t,c,g),n=!0},p(c,g){const x={};g&16&&(x.value=c[16]),g&8388624&&(x.$$scope={dirty:g,ctx:c}),t.$set(x)},i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){ln(t.$$.fragment,c),n=!1},d(c){cs(t,c)}}}function rO(e){let t,n,c=ph(e[4]),g=[];for(let S=0;S<c.length;S+=1)g[S]=cw(uw(e,c,S));const x=S=>ln(g[S],1,1,()=>{g[S]=null});return{c(){for(let S=0;S<g.length;S+=1)g[S].c();t=Ls()},l(S){for(let a=0;a<g.length;a+=1)g[a].l(S);t=Ls()},m(S,a){for(let G=0;G<g.length;G+=1)g[G]&&g[G].m(S,a);Un(S,t,a),n=!0},p(S,a){if(a&16){c=ph(S[4]);let G;for(G=0;G<c.length;G+=1){const W=uw(S,c,G);g[G]?(g[G].p(W,a),$i(g[G],1)):(g[G]=cw(W),g[G].c(),$i(g[G],1),g[G].m(t.parentNode,t))}for(zo(),G=c.length;G<g.length;G+=1)x(G);Ro()}},i(S){if(!n){for(let a=0;a<c.length;a+=1)$i(g[a]);n=!0}},o(S){g=g.filter(Boolean);for(let a=0;a<g.length;a+=1)ln(g[a]);n=!1},d(S){S&&vi(t),up(g,S)}}}function hw(e){var be,je,nt,tt,at,ut;let t,n,c,g=((je=(be=e[0])==null?void 0:be.next)==null?void 0:je.name)+"",x,S,a,G,W,he,ae=((tt=(nt=e[0])==null?void 0:nt.next)==null?void 0:tt.options.length)>0&&Aw(e),ue=((ut=(at=e[0])==null?void 0:at.next)==null?void 0:ut.options.length)==0&&dw();return{c(){t=Fn("div"),n=Fn("h2"),c=to("Select which "),x=to(g),S=to(" to use"),a=wr(),ae&&ae.c(),G=wr(),ue&&ue.c(),this.h()},l(xt){t=On(xt,"DIV",{class:!0});var Tt=yn(t);n=On(Tt,"H2",{class:!0});var Mt=yn(n);c=io(Mt,"Select which "),x=io(Mt,g),S=io(Mt," to use"),Mt.forEach(vi),a=Sr(Tt),ae&&ae.l(Tt),G=Sr(Tt),ue&&ue.l(Tt),Tt.forEach(vi),this.h()},h(){var xt;ki(n,"class","svelte-wgfovm"),ki(t,"class",W=ep(`step ${!((xt=e[0])!=null&&xt.next)||!e[3]&&"grayed"}`)+" svelte-wgfovm")},m(xt,Tt){Un(xt,t,Tt),Hi(t,n),Hi(n,c),Hi(n,x),Hi(n,S),Hi(t,a),ae&&ae.m(t,null),Hi(t,G),ue&&ue.m(t,null),he=!0},p(xt,Tt){var Mt,Oe,jt,it,vt,mt,Et;(!he||Tt&1)&&g!==(g=((Oe=(Mt=xt[0])==null?void 0:Mt.next)==null?void 0:Oe.name)+"")&&su(x,g),((it=(jt=xt[0])==null?void 0:jt.next)==null?void 0:it.options.length)>0?ae?(ae.p(xt,Tt),Tt&1&&$i(ae,1)):(ae=Aw(xt),ae.c(),$i(ae,1),ae.m(t,G)):ae&&(zo(),ln(ae,1,1,()=>{ae=null}),Ro()),((mt=(vt=xt[0])==null?void 0:vt.next)==null?void 0:mt.options.length)==0?ue?Tt&1&&$i(ue,1):(ue=dw(),ue.c(),$i(ue,1),ue.m(t,null)):ue&&(zo(),ln(ue,1,1,()=>{ue=null}),Ro()),(!he||Tt&9&&W!==(W=ep(`step ${!((Et=xt[0])!=null&&Et.next)||!xt[3]&&"grayed"}`)+" svelte-wgfovm"))&&ki(t,"class",W)},i(xt){he||($i(ae),$i(ue),he=!0)},o(xt){ln(ae),ln(ue),he=!1},d(xt){xt&&vi(t),ae&&ae.d(),ue&&ue.d()}}}function Aw(e){let t,n,c;function g(S){e[10](S)}let x={class:"shaped",variant:"filled",$$slots:{default:[aO]},$$scope:{ctx:e}};return e[1]!==void 0&&(x.value=e[1]),t=new fg({props:x}),pa.push(()=>N0(t,"value",g)),{c(){ls(t.$$.fragment)},l(S){Ds(t.$$.fragment,S)},m(S,a){us(t,S,a),c=!0},p(S,a){const G={};a&8388609&&(G.$$scope={dirty:a,ctx:S}),!n&&a&2&&(n=!0,G.value=S[1],O0(()=>n=!1)),t.$set(G)},i(S){c||($i(t.$$.fragment,S),c=!0)},o(S){ln(t.$$.fragment,S),c=!1},d(S){cs(t,S)}}}function sO(e){let t=e[16].name+"",n;return{c(){n=to(t)},l(c){n=io(c,t)},m(c,g){Un(c,n,g)},p(c,g){g&1&&t!==(t=c[16].name+"")&&su(n,t)},d(c){c&&vi(n)}}}function fw(e){let t,n;return t=new Tg({props:{value:e[16],$$slots:{default:[sO]},$$scope:{ctx:e}}}),{c(){ls(t.$$.fragment)},l(c){Ds(t.$$.fragment,c)},m(c,g){us(t,c,g),n=!0},p(c,g){const x={};g&1&&(x.value=c[16]),g&8388609&&(x.$$scope={dirty:g,ctx:c}),t.$set(x)},i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){ln(t.$$.fragment,c),n=!1},d(c){cs(t,c)}}}function aO(e){var S,a;let t,n,c=ph((a=(S=e[0])==null?void 0:S.next)==null?void 0:a.options),g=[];for(let G=0;G<c.length;G+=1)g[G]=fw(lw(e,c,G));const x=G=>ln(g[G],1,1,()=>{g[G]=null});return{c(){for(let G=0;G<g.length;G+=1)g[G].c();t=Ls()},l(G){for(let W=0;W<g.length;W+=1)g[W].l(G);t=Ls()},m(G,W){for(let he=0;he<g.length;he+=1)g[he]&&g[he].m(G,W);Un(G,t,W),n=!0},p(G,W){var he,ae;if(W&1){c=ph((ae=(he=G[0])==null?void 0:he.next)==null?void 0:ae.options);let ue;for(ue=0;ue<c.length;ue+=1){const be=lw(G,c,ue);g[ue]?(g[ue].p(be,W),$i(g[ue],1)):(g[ue]=fw(be),g[ue].c(),$i(g[ue],1),g[ue].m(t.parentNode,t))}for(zo(),ue=c.length;ue<g.length;ue+=1)x(ue);Ro()}},i(G){if(!n){for(let W=0;W<c.length;W+=1)$i(g[W]);n=!0}},o(G){g=g.filter(Boolean);for(let W=0;W<g.length;W+=1)ln(g[W]);n=!1},d(G){G&&vi(t),up(g,G)}}}function dw(e){let t,n;return t=new s5({}),{c(){ls(t.$$.fragment)},l(c){Ds(t.$$.fragment,c)},m(c,g){us(t,c,g),n=!0},i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){ln(t.$$.fragment,c),n=!1},d(c){cs(t,c)}}}function oO(e){let t=e[16]+"",n;return{c(){n=to(t)},l(c){n=io(c,t)},m(c,g){Un(c,n,g)},p:Ra,d(c){c&&vi(n)}}}function pw(e){let t,n;return t=new Tg({props:{value:e[16],$$slots:{default:[oO]},$$scope:{ctx:e}}}),{c(){ls(t.$$.fragment)},l(c){Ds(t.$$.fragment,c)},m(c,g){us(t,c,g),n=!0},p(c,g){const x={};g&8388608&&(x.$$scope={dirty:g,ctx:c}),t.$set(x)},i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){ln(t.$$.fragment,c),n=!1},d(c){cs(t,c)}}}function lO(e){let t,n,c=ph(e[5]),g=[];for(let S=0;S<c.length;S+=1)g[S]=pw(ow(e,c,S));const x=S=>ln(g[S],1,1,()=>{g[S]=null});return{c(){for(let S=0;S<g.length;S+=1)g[S].c();t=Ls()},l(S){for(let a=0;a<g.length;a+=1)g[a].l(S);t=Ls()},m(S,a){for(let G=0;G<g.length;G+=1)g[G]&&g[G].m(S,a);Un(S,t,a),n=!0},p(S,a){if(a&32){c=ph(S[5]);let G;for(G=0;G<c.length;G+=1){const W=ow(S,c,G);g[G]?(g[G].p(W,a),$i(g[G],1)):(g[G]=pw(W),g[G].c(),$i(g[G],1),g[G].m(t.parentNode,t))}for(zo(),G=c.length;G<g.length;G+=1)x(G);Ro()}},i(S){if(!n){for(let a=0;a<c.length;a+=1)$i(g[a]);n=!0}},o(S){g=g.filter(Boolean);for(let a=0;a<g.length;a+=1)ln(g[a]);n=!1},d(S){S&&vi(t),up(g,S)}}}function uO(e){let t=e[0]?"Build":"Select a null model",n;return{c(){n=to(t)},l(c){n=io(c,t)},m(c,g){Un(c,n,g)},p(c,g){g&1&&t!==(t=c[0]?"Build":"Select a null model")&&su(n,t)},d(c){c&&vi(n)}}}function cO(e){let t,n;return t=new sC({props:{$$slots:{default:[uO]},$$scope:{ctx:e}}}),{c(){ls(t.$$.fragment)},l(c){Ds(t.$$.fragment,c)},m(c,g){us(t,c,g),n=!0},p(c,g){const x={};g&8388609&&(x.$$scope={dirty:g,ctx:c}),t.$set(x)},i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){ln(t.$$.fragment,c),n=!1},d(c){cs(t,c)}}}function hO(e){var dt;let t,n,c,g,x,S,a,G="Select a null model",W,he,ae,ue,be,je,nt,tt="Select a different region to compare",at,ut,xt,Tt,Mt,Oe,jt;c=new g3({});function it(Je){e[9](Je)}let vt={class:"shaped",variant:"filled",$$slots:{default:[rO]},$$scope:{ctx:e}};e[0]!==void 0&&(vt.value=e[0]),he=new fg({props:vt}),pa.push(()=>N0(he,"value",it));let mt=((dt=e[0])==null?void 0:dt.next)&&hw(e);function Et(Je){e[11](Je)}let Pt={class:"shaped",variant:"filled",$$slots:{default:[lO]},$$scope:{ctx:e}};return e[2]!==void 0&&(Pt.value=e[2]),ut=new fg({props:Pt}),pa.push(()=>N0(ut,"value",Et)),Oe=new HF({props:{class:"theme-button",variant:"raised",disabled:!e[0],$$slots:{default:[cO]},$$scope:{ctx:e}}}),Oe.$on("click",e[12]),{c(){t=Fn("div"),n=Fn("div"),ls(c.$$.fragment),g=wr(),x=Fn("div"),S=Fn("div"),a=Fn("h2"),a.textContent=G,W=wr(),ls(he.$$.fragment),ue=wr(),mt&&mt.c(),be=wr(),je=Fn("div"),nt=Fn("h2"),nt.textContent=tt,at=wr(),ls(ut.$$.fragment),Mt=wr(),ls(Oe.$$.fragment),this.h()},l(Je){t=On(Je,"DIV",{class:!0});var pt=yn(t);n=On(pt,"DIV",{class:!0});var lt=yn(n);Ds(c.$$.fragment,lt),lt.forEach(vi),g=Sr(pt),x=On(pt,"DIV",{class:!0});var Nt=yn(x);S=On(Nt,"DIV",{class:!0});var zt=yn(S);a=On(zt,"H2",{class:!0,"data-svelte-h":!0}),Zu(a)!=="svelte-1vw7qz9"&&(a.textContent=G),W=Sr(zt),Ds(he.$$.fragment,zt),zt.forEach(vi),ue=Sr(Nt),mt&&mt.l(Nt),be=Sr(Nt),je=On(Nt,"DIV",{class:!0});var Ot=yn(je);nt=On(Ot,"H2",{class:!0,"data-svelte-h":!0}),Zu(nt)!=="svelte-1y5wjwe"&&(nt.textContent=tt),at=Sr(Ot),Ds(ut.$$.fragment,Ot),Ot.forEach(vi),Mt=Sr(Nt),Ds(Oe.$$.fragment,Nt),Nt.forEach(vi),pt.forEach(vi),this.h()},h(){ki(n,"class","logo svelte-wgfovm"),ki(a,"class","svelte-wgfovm"),ki(S,"class","step svelte-wgfovm"),ki(nt,"class","svelte-wgfovm"),ki(je,"class",Tt=ep(`step ${!e[0]&&"grayed"}`)+" svelte-wgfovm"),ki(x,"class","steps svelte-wgfovm"),ki(t,"class","builder svelte-wgfovm")},m(Je,pt){Un(Je,t,pt),Hi(t,n),us(c,n,null),Hi(t,g),Hi(t,x),Hi(x,S),Hi(S,a),Hi(S,W),us(he,S,null),Hi(x,ue),mt&&mt.m(x,null),Hi(x,be),Hi(x,je),Hi(je,nt),Hi(je,at),us(ut,je,null),Hi(x,Mt),us(Oe,x,null),jt=!0},p(Je,[pt]){var Ot;const lt={};pt&8388624&&(lt.$$scope={dirty:pt,ctx:Je}),!ae&&pt&1&&(ae=!0,lt.value=Je[0],O0(()=>ae=!1)),he.$set(lt),(Ot=Je[0])!=null&&Ot.next?mt?(mt.p(Je,pt),pt&1&&$i(mt,1)):(mt=hw(Je),mt.c(),$i(mt,1),mt.m(x,be)):mt&&(zo(),ln(mt,1,1,()=>{mt=null}),Ro());const Nt={};pt&8388608&&(Nt.$$scope={dirty:pt,ctx:Je}),!xt&&pt&4&&(xt=!0,Nt.value=Je[2],O0(()=>xt=!1)),ut.$set(Nt),(!jt||pt&1&&Tt!==(Tt=ep(`step ${!Je[0]&&"grayed"}`)+" svelte-wgfovm"))&&ki(je,"class",Tt);const zt={};pt&1&&(zt.disabled=!Je[0]),pt&8388609&&(zt.$$scope={dirty:pt,ctx:Je}),Oe.$set(zt)},i(Je){jt||($i(c.$$.fragment,Je),$i(he.$$.fragment,Je),$i(mt),$i(ut.$$.fragment,Je),$i(Oe.$$.fragment,Je),jt=!0)},o(Je){ln(c.$$.fragment,Je),ln(he.$$.fragment,Je),ln(mt),ln(ut.$$.fragment,Je),ln(Oe.$$.fragment,Je),jt=!1},d(Je){Je&&vi(t),cs(c),cs(he),mt&&mt.d(),cs(ut),cs(Oe)}}}function AO(e,t,n){let c;tc(e,Kp,ut=>n(8,c=ut));let{showEcoregions:g}=t,x=!1,{nullRegion:S}=t;const a=[{name:"All of California",type:"CALIFORNIA",next:null},{name:"By Ecoregion",type:"ECOREGION",next:{name:"ecoregion",options:[{name:"Ecoregion 1"},{name:"Ecoregion 2"},{name:"Ecoregion 3"}]}},{name:"Surface",next:"object"}];let{subNullRegion:G}=t,{altRegion:W}=t;const he=a;function ae(){if(!c.querySourceFeatures)return;let ut=c.querySourceFeatures("ecoregions"),xt=[];for(let Tt of ut)if(xt.filter(Mt=>Mt.ids.includes(Tt.id)).length==0){let Mt=`${Tt.properties.US_L3NAME}`,Oe=xt.filter(jt=>jt.name===Mt)[0];!Oe||(Oe==null?void 0:Oe.length)==0?xt.push({ids:[Tt.id],name:`${Tt.properties.US_L3NAME}`,type:"ECOREGION",value:`${Tt.properties.US_L3CODE}`}):Oe.ids=[...Oe.ids,Tt.id]}xt=xt.sort((Tt,Mt)=>Tt.name.localeCompare(Mt.name)),n(4,a[1].next.options=xt,a),n(3,x=!0)}function ue(ut){if(!ut)return;let xt=c.querySourceFeatures("ecoregions");for(let Tt of xt)c.setFeatureState({source:"ecoregions",id:Tt.id},{hover:!1});for(let Tt of ut.ids)c.setFeatureState({source:"ecoregions",id:Tt},{hover:!0})}async function be(){Y_.set({type:S.type,sub:G})}xc(()=>{ae()});function je(ut){S=ut,n(0,S)}function nt(ut){G=ut,n(1,G)}function tt(ut){W=ut,n(2,W)}const at=()=>be();return e.$$set=ut=>{"showEcoregions"in ut&&n(7,g=ut.showEcoregions),"nullRegion"in ut&&n(0,S=ut.nullRegion),"subNullRegion"in ut&&n(1,G=ut.subNullRegion),"altRegion"in ut&&n(2,W=ut.altRegion)},e.$$.update=()=>{var ut;e.$$.dirty&256&&c&&ae(),e.$$.dirty&129&&(S&&((ut=S.next)==null?void 0:ut.name)==="ecoregion"?g(!0):g(!1)),e.$$.dirty&2&&ue(G)},[S,G,W,x,a,he,be,g,c,je,nt,tt,at]}class fO extends fo{constructor(t){super(),po(this,t,AO,hO,Oa,{showEcoregions:7,nullRegion:0,subNullRegion:1,altRegion:2})}}function dO(e){let t,n,c,g='<td class="svelte-123tfyw">Hex</td> <td class="svelte-123tfyw">Tree Size</td> <td class="svelte-123tfyw">PD</td> <td class="svelte-123tfyw">MPD</td> <td class="svelte-123tfyw">MNTD</td>',x,S,a,G=e[0].hex+"",W,he,ae,ue=(e[1](e[0].properties.tree_sizes)??"Unknown")+"",be,je,nt,tt=(e[1](e[0].properties.pd)??"Unknown")+"",at,ut,xt,Tt=(e[1](e[0].properties.mpd)??"Unknown")+"",Mt,Oe,jt,it=(e[1](e[0].properties.mntd)??"Unknown")+"",vt;return{c(){t=Fn("div"),n=Fn("table"),c=Fn("thead"),c.innerHTML=g,x=wr(),S=Fn("tr"),a=Fn("td"),W=to(G),he=wr(),ae=Fn("td"),be=to(ue),je=wr(),nt=Fn("td"),at=to(tt),ut=wr(),xt=Fn("td"),Mt=to(Tt),Oe=wr(),jt=Fn("td"),vt=to(it),this.h()},l(mt){t=On(mt,"DIV",{class:!0});var Et=yn(t);n=On(Et,"TABLE",{});var Pt=yn(n);c=On(Pt,"THEAD",{class:!0,"data-svelte-h":!0}),Zu(c)!=="svelte-i8fsz9"&&(c.innerHTML=g),x=Sr(Pt),S=On(Pt,"TR",{class:!0});var dt=yn(S);a=On(dt,"TD",{class:!0});var Je=yn(a);W=io(Je,G),Je.forEach(vi),he=Sr(dt),ae=On(dt,"TD",{class:!0});var pt=yn(ae);be=io(pt,ue),pt.forEach(vi),je=Sr(dt),nt=On(dt,"TD",{class:!0});var lt=yn(nt);at=io(lt,tt),lt.forEach(vi),ut=Sr(dt),xt=On(dt,"TD",{class:!0});var Nt=yn(xt);Mt=io(Nt,Tt),Nt.forEach(vi),Oe=Sr(dt),jt=On(dt,"TD",{class:!0});var zt=yn(jt);vt=io(zt,it),zt.forEach(vi),dt.forEach(vi),Pt.forEach(vi),Et.forEach(vi),this.h()},h(){ki(c,"class","svelte-123tfyw"),ki(a,"class","svelte-123tfyw"),ki(ae,"class","svelte-123tfyw"),ki(nt,"class","svelte-123tfyw"),ki(xt,"class","svelte-123tfyw"),ki(jt,"class","svelte-123tfyw"),ki(S,"class","mono svelte-123tfyw"),ki(t,"class","summary-container svelte-123tfyw")},m(mt,Et){Un(mt,t,Et),Hi(t,n),Hi(n,c),Hi(n,x),Hi(n,S),Hi(S,a),Hi(a,W),Hi(S,he),Hi(S,ae),Hi(ae,be),Hi(S,je),Hi(S,nt),Hi(nt,at),Hi(S,ut),Hi(S,xt),Hi(xt,Mt),Hi(S,Oe),Hi(S,jt),Hi(jt,vt)},p(mt,[Et]){Et&1&&G!==(G=mt[0].hex+"")&&su(W,G),Et&1&&ue!==(ue=(mt[1](mt[0].properties.tree_sizes)??"Unknown")+"")&&su(be,ue),Et&1&&tt!==(tt=(mt[1](mt[0].properties.pd)??"Unknown")+"")&&su(at,tt),Et&1&&Tt!==(Tt=(mt[1](mt[0].properties.mpd)??"Unknown")+"")&&su(Mt,Tt),Et&1&&it!==(it=(mt[1](mt[0].properties.mntd)??"Unknown")+"")&&su(vt,it)},i:Ra,o:Ra,d(mt){mt&&vi(t)}}}const mw=3;function pO(e,t,n){let{data:c}=t;const g=x=>Math.round(x*10**mw)/10**mw;return e.$$set=x=>{"data"in x&&n(0,c=x.data)},[c,g]}class mO extends fo{constructor(t){super(),po(this,t,pO,dO,Oa,{data:0})}}function gO(e){let t,n,c,g,x,S='<strong class="svelte-1b48uq5">PH</strong>ylogenetic <strong class="svelte-1b48uq5">A</strong>nalysis at <strong class="svelte-1b48uq5">S</strong>peedy <strong class="svelte-1b48uq5">T</strong>ime',a,G,W="To start, set the options at the top right to the metric and taxon you want to look at.",he,ae,ue="This is a description of the program for users to be able to read in lieu of specific metrics so that we don't have a big white space when users start the application. This way we can describe useful information and context about the project at the right time, while also making the most of the whitespace on the page. This description should change once we decide exactly what information we want to convey to the user and finalize certain UX flows that are in development.",be;return c=new g3({}),{c(){t=Fn("div"),n=Fn("h1"),ls(c.$$.fragment),g=wr(),x=Fn("h3"),x.innerHTML=S,a=wr(),G=Fn("p"),G.textContent=W,he=wr(),ae=Fn("p"),ae.textContent=ue,this.h()},l(je){t=On(je,"DIV",{class:!0});var nt=yn(t);n=On(nt,"H1",{});var tt=yn(n);Ds(c.$$.fragment,tt),tt.forEach(vi),g=Sr(nt),x=On(nt,"H3",{class:!0,"data-svelte-h":!0}),Zu(x)!=="svelte-12h6mrz"&&(x.innerHTML=S),a=Sr(nt),G=On(nt,"P",{"data-svelte-h":!0}),Zu(G)!=="svelte-4cip2g"&&(G.textContent=W),he=Sr(nt),ae=On(nt,"P",{"data-svelte-h":!0}),Zu(ae)!=="svelte-1icmnw4"&&(ae.textContent=ue),nt.forEach(vi),this.h()},h(){ki(x,"class","svelte-1b48uq5"),ki(t,"class","about svelte-1b48uq5")},m(je,nt){Un(je,t,nt),Hi(t,n),us(c,n,null),Hi(t,g),Hi(t,x),Hi(t,a),Hi(t,G),Hi(t,he),Hi(t,ae),be=!0},p:Ra,i(je){be||($i(c.$$.fragment,je),be=!0)},o(je){ln(c.$$.fragment,je),be=!1},d(je){je&&vi(t),cs(c)}}}class _O extends fo{constructor(t){super(),po(this,t,null,gO,Oa,{})}}function gw(e,t,n){const c=e.slice();return c[17]=t[n],c}function yO(e,t,n){const c=e.slice();return c[17]=t[n],c}function _w(e){let t,n,c,g,x,S,a,G,W,he,ae,ue,be,je;function nt(jt){e[13](jt)}let tt={class:"shaped",variant:"outlined",$$slots:{default:[bO]},$$scope:{ctx:e}};e[0]!==void 0&&(tt.value=e[0]),g=new fg({props:tt}),pa.push(()=>N0(g,"value",nt)),g.$on("change",e[14]);function at(jt){e[15](jt)}let ut={class:"shaped",variant:"outlined",$$slots:{default:[SO]},$$scope:{ctx:e}};e[1]!==void 0&&(ut.value=e[1]),a=new fg({props:ut}),pa.push(()=>N0(a,"value",at));let xt=e[8]&&vw(e),Tt=!e[6]&&xw(),Mt=!e[8]&&bw(),Oe=e[8]&&ww(e);return{c(){t=Fn("div"),n=Fn("div"),c=to(`Testing
                `),ls(g.$$.fragment),S=to(`
                of
                `),ls(a.$$.fragment),W=wr(),xt&&xt.c(),he=wr(),Tt&&Tt.c(),ae=wr(),Mt&&Mt.c(),ue=wr(),Oe&&Oe.c(),be=Ls(),this.h()},l(jt){t=On(jt,"DIV",{class:!0});var it=yn(t);n=On(it,"DIV",{class:!0});var vt=yn(n);c=io(vt,`Testing
                `),Ds(g.$$.fragment,vt),S=io(vt,`
                of
                `),Ds(a.$$.fragment,vt),vt.forEach(vi),W=Sr(it),xt&&xt.l(it),it.forEach(vi),he=Sr(jt),Tt&&Tt.l(jt),ae=Sr(jt),Mt&&Mt.l(jt),ue=Sr(jt),Oe&&Oe.l(jt),be=Ls(),this.h()},h(){ki(n,"class","test svelte-8myhro"),ki(t,"class","header svelte-8myhro")},m(jt,it){Un(jt,t,it),Hi(t,n),Hi(n,c),us(g,n,null),Hi(n,S),us(a,n,null),Hi(t,W),xt&&xt.m(t,null),Un(jt,he,it),Tt&&Tt.m(jt,it),Un(jt,ae,it),Mt&&Mt.m(jt,it),Un(jt,ue,it),Oe&&Oe.m(jt,it),Un(jt,be,it),je=!0},p(jt,it){const vt={};it&4194304&&(vt.$$scope={dirty:it,ctx:jt}),!x&&it&1&&(x=!0,vt.value=jt[0],O0(()=>x=!1)),g.$set(vt);const mt={};it&4194320&&(mt.$$scope={dirty:it,ctx:jt}),!G&&it&2&&(G=!0,mt.value=jt[1],O0(()=>G=!1)),a.$set(mt),jt[8]?xt?xt.p(jt,it):(xt=vw(jt),xt.c(),xt.m(t,null)):xt&&(xt.d(1),xt=null),jt[6]?Tt&&(zo(),ln(Tt,1,1,()=>{Tt=null}),Ro()):Tt?it&64&&$i(Tt,1):(Tt=xw(),Tt.c(),$i(Tt,1),Tt.m(ae.parentNode,ae)),jt[8]?Mt&&(zo(),ln(Mt,1,1,()=>{Mt=null}),Ro()):Mt?it&256&&$i(Mt,1):(Mt=bw(),Mt.c(),$i(Mt,1),Mt.m(ue.parentNode,ue)),jt[8]?Oe?(Oe.p(jt,it),it&256&&$i(Oe,1)):(Oe=ww(jt),Oe.c(),$i(Oe,1),Oe.m(be.parentNode,be)):Oe&&(zo(),ln(Oe,1,1,()=>{Oe=null}),Ro())},i(jt){je||($i(g.$$.fragment,jt),$i(a.$$.fragment,jt),$i(Tt),$i(Mt),$i(Oe),je=!0)},o(jt){ln(g.$$.fragment,jt),ln(a.$$.fragment,jt),ln(Tt),ln(Mt),ln(Oe),je=!1},d(jt){jt&&(vi(t),vi(he),vi(ae),vi(ue),vi(be)),cs(g),cs(a),xt&&xt.d(),Tt&&Tt.d(jt),Mt&&Mt.d(jt),Oe&&Oe.d(jt)}}}function vO(e){let t;return{c(){t=to(e[17])},l(n){t=io(n,e[17])},m(n,c){Un(n,t,c)},p:Ra,d(n){n&&vi(t)}}}function xO(e){let t,n;return t=new Tg({props:{value:e[17],$$slots:{default:[vO]},$$scope:{ctx:e}}}),{c(){ls(t.$$.fragment)},l(c){Ds(t.$$.fragment,c)},m(c,g){us(t,c,g),n=!0},p(c,g){const x={};g&4194304&&(x.$$scope={dirty:g,ctx:c}),t.$set(x)},i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){ln(t.$$.fragment,c),n=!1},d(c){cs(t,c)}}}function bO(e){let t,n,c=ph(__),g=[];for(let x=0;x<c.length;x+=1)g[x]=xO(yO(e,c,x));return{c(){for(let x=0;x<g.length;x+=1)g[x].c();t=Ls()},l(x){for(let S=0;S<g.length;S+=1)g[S].l(x);t=Ls()},m(x,S){for(let a=0;a<g.length;a+=1)g[a]&&g[a].m(x,S);Un(x,t,S),n=!0},p:Ra,i(x){if(!n){for(let S=0;S<c.length;S+=1)$i(g[S]);n=!0}},o(x){g=g.filter(Boolean);for(let S=0;S<g.length;S+=1)ln(g[S]);n=!1},d(x){x&&vi(t),up(g,x)}}}function wO(e){let t=e[17]+"",n;return{c(){n=to(t)},l(c){n=io(c,t)},m(c,g){Un(c,n,g)},p(c,g){g&16&&t!==(t=c[17]+"")&&su(n,t)},d(c){c&&vi(n)}}}function yw(e){let t,n;return t=new Tg({props:{value:e[17],$$slots:{default:[wO]},$$scope:{ctx:e}}}),{c(){ls(t.$$.fragment)},l(c){Ds(t.$$.fragment,c)},m(c,g){us(t,c,g),n=!0},p(c,g){const x={};g&16&&(x.value=c[17]),g&4194320&&(x.$$scope={dirty:g,ctx:c}),t.$set(x)},i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){ln(t.$$.fragment,c),n=!1},d(c){cs(t,c)}}}function SO(e){let t,n,c=ph(e[4]),g=[];for(let S=0;S<c.length;S+=1)g[S]=yw(gw(e,c,S));const x=S=>ln(g[S],1,1,()=>{g[S]=null});return{c(){for(let S=0;S<g.length;S+=1)g[S].c();t=Ls()},l(S){for(let a=0;a<g.length;a+=1)g[a].l(S);t=Ls()},m(S,a){for(let G=0;G<g.length;G+=1)g[G]&&g[G].m(S,a);Un(S,t,a),n=!0},p(S,a){if(a&16){c=ph(S[4]);let G;for(G=0;G<c.length;G+=1){const W=gw(S,c,G);g[G]?(g[G].p(W,a),$i(g[G],1)):(g[G]=yw(W),g[G].c(),$i(g[G],1),g[G].m(t.parentNode,t))}for(zo(),G=c.length;G<g.length;G+=1)x(G);Ro()}},i(S){if(!n){for(let a=0;a<c.length;a+=1)$i(g[a]);n=!0}},o(S){g=g.filter(Boolean);for(let a=0;a<g.length;a+=1)ln(g[a]);n=!1},d(S){S&&vi(t),up(g,S)}}}function vw(e){let t,n,c="x",g,x;return{c(){t=Fn("div"),n=Fn("button"),n.textContent=c,this.h()},l(S){t=On(S,"DIV",{class:!0});var a=yn(t);n=On(a,"BUTTON",{class:!0,"data-svelte-h":!0}),Zu(n)!=="svelte-1iv3129"&&(n.textContent=c),a.forEach(vi),this.h()},h(){ki(n,"class","svelte-8myhro"),ki(t,"class","close svelte-8myhro")},m(S,a){Un(S,t,a),Hi(t,n),g||(x=Gl(n,"click",e[16]),g=!0)},p:Ra,d(S){S&&vi(t),g=!1,x()}}}function xw(e){let t,n,c;return n=new s5({props:{message:"Building model..."}}),{c(){t=Fn("div"),ls(n.$$.fragment),this.h()},l(g){t=On(g,"DIV",{class:!0});var x=yn(t);Ds(n.$$.fragment,x),x.forEach(vi),this.h()},h(){ki(t,"class","load svelte-8myhro")},m(g,x){Un(g,t,x),us(n,t,null),c=!0},i(g){c||($i(n.$$.fragment,g),c=!0)},o(g){ln(n.$$.fragment,g),c=!1},d(g){g&&vi(t),cs(n)}}}function bw(e){let t,n;return t=new _O({}),{c(){ls(t.$$.fragment)},l(c){Ds(t.$$.fragment,c)},m(c,g){us(t,c,g),n=!0},i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){ln(t.$$.fragment,c),n=!1},d(c){cs(t,c)}}}function ww(e){var a,G,W,he,ae,ue,be;let t,n,c,g,x,S;return t=new mO({props:{data:e[7]}}),c=new VM({props:{colorScheme:e[2],metric:e[0],point:[[(G=(a=e[7])==null?void 0:a.properties)==null?void 0:G.tree_sizes,(W=e[7])==null?void 0:W.properties[e[0]]]]}}),x=new VF({props:{clade:e[1],newick:(ae=(he=e[7])==null?void 0:he.properties)==null?void 0:ae.tree,hex_id:(be=(ue=e[7])==null?void 0:ue.properties)==null?void 0:be.id}}),{c(){ls(t.$$.fragment),n=wr(),ls(c.$$.fragment),g=wr(),ls(x.$$.fragment)},l(je){Ds(t.$$.fragment,je),n=Sr(je),Ds(c.$$.fragment,je),g=Sr(je),Ds(x.$$.fragment,je)},m(je,nt){us(t,je,nt),Un(je,n,nt),us(c,je,nt),Un(je,g,nt),us(x,je,nt),S=!0},p(je,nt){var xt,Tt,Mt,Oe,jt,it,vt;const tt={};nt&128&&(tt.data=je[7]),t.$set(tt);const at={};nt&4&&(at.colorScheme=je[2]),nt&1&&(at.metric=je[0]),nt&129&&(at.point=[[(Tt=(xt=je[7])==null?void 0:xt.properties)==null?void 0:Tt.tree_sizes,(Mt=je[7])==null?void 0:Mt.properties[je[0]]]]),c.$set(at);const ut={};nt&2&&(ut.clade=je[1]),nt&128&&(ut.newick=(jt=(Oe=je[7])==null?void 0:Oe.properties)==null?void 0:jt.tree),nt&128&&(ut.hex_id=(vt=(it=je[7])==null?void 0:it.properties)==null?void 0:vt.id),x.$set(ut)},i(je){S||($i(t.$$.fragment,je),$i(c.$$.fragment,je),$i(x.$$.fragment,je),S=!0)},o(je){ln(t.$$.fragment,je),ln(c.$$.fragment,je),ln(x.$$.fragment,je),S=!1},d(je){je&&(vi(n),vi(g)),cs(t,je),cs(c,je),cs(x,je)}}}function Sw(e){let t,n;return t=new fO({props:{showEcoregions:e[5]}}),{c(){ls(t.$$.fragment)},l(c){Ds(t.$$.fragment,c)},m(c,g){us(t,c,g),n=!0},p(c,g){const x={};g&32&&(x.showEcoregions=c[5]),t.$set(x)},i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){ln(t.$$.fragment,c),n=!1},d(c){cs(t,c)}}}function IO(e){let t,n,c,g=e[9]&&_w(e),x=!e[9]&&Sw(e);return{c(){t=Fn("div"),g&&g.c(),n=wr(),x&&x.c(),this.h()},l(S){t=On(S,"DIV",{class:!0});var a=yn(t);g&&g.l(a),n=Sr(a),x&&x.l(a),a.forEach(vi),this.h()},h(){ki(t,"class",ep("modal")+" svelte-8myhro")},m(S,a){Un(S,t,a),g&&g.m(t,null),Hi(t,n),x&&x.m(t,null),c=!0},p(S,[a]){S[9]?g?(g.p(S,a),a&512&&$i(g,1)):(g=_w(S),g.c(),$i(g,1),g.m(t,n)):g&&(zo(),ln(g,1,1,()=>{g=null}),Ro()),S[9]?x&&(zo(),ln(x,1,1,()=>{x=null}),Ro()):x?(x.p(S,a),a&512&&$i(x,1)):(x=Sw(S),x.c(),$i(x,1),x.m(t,null))},i(S){c||($i(g),$i(x),c=!0)},o(S){ln(g),ln(x),c=!1},d(S){S&&vi(t),g&&g.d(),x&&x.d()}}}function EO(e,t,n){let c,g;tc(e,cg,Tt=>n(7,c=Tt)),tc(e,Y_,Tt=>n(9,g=Tt));let{metric:x}=t,{colorScheme:S}=t,{updateMetricLayer:a}=t,{clade:G}=t,{updateClade:W}=t,{clades:he}=t,{isBuilt:ae}=t,{showEcoregions:ue}=t,{isFinishedBuilding:be}=t,je;const nt=Tt=>{n(8,je=(Tt==null?void 0:Tt.properties)&&(Tt==null?void 0:Tt.properties[x])!==-1)};function tt(Tt){x=Tt,n(0,x)}const at=()=>a(x);function ut(Tt){G=Tt,n(1,G)}const xt=()=>{nt(null),cg.set(null),console.log(c)};return e.$$set=Tt=>{"metric"in Tt&&n(0,x=Tt.metric),"colorScheme"in Tt&&n(2,S=Tt.colorScheme),"updateMetricLayer"in Tt&&n(3,a=Tt.updateMetricLayer),"clade"in Tt&&n(1,G=Tt.clade),"updateClade"in Tt&&n(11,W=Tt.updateClade),"clades"in Tt&&n(4,he=Tt.clades),"isBuilt"in Tt&&n(12,ae=Tt.isBuilt),"showEcoregions"in Tt&&n(5,ue=Tt.showEcoregions),"isFinishedBuilding"in Tt&&n(6,be=Tt.isFinishedBuilding)},e.$$.update=()=>{e.$$.dirty&128&&nt(c),e.$$.dirty&2050&&W(G),e.$$.dirty&9&&a(x)},[x,G,S,a,he,ue,be,c,je,g,nt,W,ae,tt,at,ut,xt]}class CO extends fo{constructor(t){super(),po(this,t,EO,IO,Oa,{metric:0,colorScheme:2,updateMetricLayer:3,clade:1,updateClade:11,clades:4,isBuilt:12,showEcoregions:5,isFinishedBuilding:6})}}var TO={exports:{}};(function(e,t){(function(n,c){e.exports=c()})(Jf,function(){var n,c,g;function x(a,G){if(!n)n=G;else if(!c)c=G;else{var W="var sharedChunk = {}; ("+n+")(sharedChunk); ("+c+")(sharedChunk);",he={};n(he),g=G(he),typeof window<"u"&&(g.workerUrl=window.URL.createObjectURL(new Blob([W],{type:"text/javascript"})))}}x(["exports"],function(a){function G(f,u,p,I){return new(p||(p=Promise))(function(L,U){function Q(_e){try{Ae(I.next(_e))}catch(Le){U(Le)}}function re(_e){try{Ae(I.throw(_e))}catch(Le){U(Le)}}function Ae(_e){var Le;_e.done?L(_e.value):(Le=_e.value,Le instanceof p?Le:new p(function(qe){qe(Le)})).then(Q,re)}Ae((I=I.apply(f,u||[])).next())})}function W(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}typeof SuppressedError=="function"&&SuppressedError;var he=ae;function ae(f,u){this.x=f,this.y=u}ae.prototype={clone:function(){return new ae(this.x,this.y)},add:function(f){return this.clone()._add(f)},sub:function(f){return this.clone()._sub(f)},multByPoint:function(f){return this.clone()._multByPoint(f)},divByPoint:function(f){return this.clone()._divByPoint(f)},mult:function(f){return this.clone()._mult(f)},div:function(f){return this.clone()._div(f)},rotate:function(f){return this.clone()._rotate(f)},rotateAround:function(f,u){return this.clone()._rotateAround(f,u)},matMult:function(f){return this.clone()._matMult(f)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(f){return this.x===f.x&&this.y===f.y},dist:function(f){return Math.sqrt(this.distSqr(f))},distSqr:function(f){var u=f.x-this.x,p=f.y-this.y;return u*u+p*p},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(f){return Math.atan2(this.y-f.y,this.x-f.x)},angleWith:function(f){return this.angleWithSep(f.x,f.y)},angleWithSep:function(f,u){return Math.atan2(this.x*u-this.y*f,this.x*f+this.y*u)},_matMult:function(f){var u=f[2]*this.x+f[3]*this.y;return this.x=f[0]*this.x+f[1]*this.y,this.y=u,this},_add:function(f){return this.x+=f.x,this.y+=f.y,this},_sub:function(f){return this.x-=f.x,this.y-=f.y,this},_mult:function(f){return this.x*=f,this.y*=f,this},_div:function(f){return this.x/=f,this.y/=f,this},_multByPoint:function(f){return this.x*=f.x,this.y*=f.y,this},_divByPoint:function(f){return this.x/=f.x,this.y/=f.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var f=this.y;return this.y=this.x,this.x=-f,this},_rotate:function(f){var u=Math.cos(f),p=Math.sin(f),I=p*this.x+u*this.y;return this.x=u*this.x-p*this.y,this.y=I,this},_rotateAround:function(f,u){var p=Math.cos(f),I=Math.sin(f),L=u.y+I*(this.x-u.x)+p*(this.y-u.y);return this.x=u.x+p*(this.x-u.x)-I*(this.y-u.y),this.y=L,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ae.convert=function(f){return f instanceof ae?f:Array.isArray(f)?new ae(f[0],f[1]):f};var ue=W(he),be=je;function je(f,u,p,I){this.cx=3*f,this.bx=3*(p-f)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(I-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=f,this.p1y=u,this.p2x=p,this.p2y=I}je.prototype={sampleCurveX:function(f){return((this.ax*f+this.bx)*f+this.cx)*f},sampleCurveY:function(f){return((this.ay*f+this.by)*f+this.cy)*f},sampleCurveDerivativeX:function(f){return(3*this.ax*f+2*this.bx)*f+this.cx},solveCurveX:function(f,u){if(u===void 0&&(u=1e-6),f<0)return 0;if(f>1)return 1;for(var p=f,I=0;I<8;I++){var L=this.sampleCurveX(p)-f;if(Math.abs(L)<u)return p;var U=this.sampleCurveDerivativeX(p);if(Math.abs(U)<1e-6)break;p-=L/U}var Q=0,re=1;for(p=f,I=0;I<20&&(L=this.sampleCurveX(p),!(Math.abs(L-f)<u));I++)f>L?Q=p:re=p,p=.5*(re-Q)+Q;return p},solve:function(f,u){return this.sampleCurveY(this.solveCurveX(f,u))}};var nt=W(be);let tt,at;function ut(){return tt==null&&(tt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),tt}function xt(){if(at==null&&(at=!1,ut())){const u=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(u){for(let I=0;I<5*5;I++){const L=4*I;u.fillStyle=`rgb(${L},${L+1},${L+2})`,u.fillRect(I%5,Math.floor(I/5),1,1)}const p=u.getImageData(0,0,5,5).data;for(let I=0;I<5*5*4;I++)if(I%4!=3&&p[I]!==I){at=!0;break}}}return at||!1}function Tt(f,u,p,I){const L=new nt(f,u,p,I);return function(U){return L.solve(U)}}const Mt=Tt(.25,.1,.25,1);function Oe(f,u,p){return Math.min(p,Math.max(u,f))}function jt(f,u,p){const I=p-u,L=((f-u)%I+I)%I+u;return L===u?p:L}function it(f,...u){for(const p of u)for(const I in p)f[I]=p[I];return f}let vt=1;function mt(f,u,p){const I={};for(const L in f)I[L]=u.call(p||this,f[L],L,f);return I}function Et(f,u,p){const I={};for(const L in f)u.call(p||this,f[L],L,f)&&(I[L]=f[L]);return I}function Pt(f){return Array.isArray(f)?f.map(Pt):typeof f=="object"&&f?mt(f,Pt):f}const dt={};function Je(f){dt[f]||(typeof console<"u"&&console.warn(f),dt[f]=!0)}function pt(f,u,p){return(p.y-f.y)*(u.x-f.x)>(u.y-f.y)*(p.x-f.x)}function lt(f){let u=0;for(let p,I,L=0,U=f.length,Q=U-1;L<U;Q=L++)p=f[L],I=f[Q],u+=(I.x-p.x)*(p.y+I.y);return u}function Nt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let zt=null;function Ot(f){return typeof ImageBitmap<"u"&&f instanceof ImageBitmap}const gi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function wi(f,u,p,I,L){return G(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const U=new VideoFrame(f,{timestamp:0});try{const Q=U==null?void 0:U.format;if(!Q||!Q.startsWith("BGR")&&!Q.startsWith("RGB"))throw new Error(`Unrecognized format ${Q}`);const re=Q.startsWith("BGR"),Ae=new Uint8ClampedArray(I*L*4);if(yield U.copyTo(Ae,function(_e,Le,qe,et,At){const gt=4*Math.max(-Le,0),Dt=(Math.max(0,qe)-qe)*et*4+gt,Lt=4*et,Rt=Math.max(0,Le),Kt=Math.max(0,qe);return{rect:{x:Rt,y:Kt,width:Math.min(_e.width,Le+et)-Rt,height:Math.min(_e.height,qe+At)-Kt},layout:[{offset:Dt,stride:Lt}]}}(f,u,p,I,L)),re)for(let _e=0;_e<Ae.length;_e+=4){const Le=Ae[_e];Ae[_e]=Ae[_e+2],Ae[_e+2]=Le}return Ae}finally{U.close()}})}let Ti,Ni,en,ji;const Vi={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f){const u=requestAnimationFrame(f);return{cancel:()=>cancelAnimationFrame(u)}},getImageData(f,u=0){return this.getImageCanvasContext(f).getImageData(-u,-u,f.width+2*u,f.height+2*u)},getImageCanvasContext(f){const u=window.document.createElement("canvas"),p=u.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return u.width=f.width,u.height=f.height,p.drawImage(f,0,0,f.width,f.height),p},resolveURL:f=>(en||(en=document.createElement("a")),en.href=f,en.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(ji==null&&(ji=matchMedia("(prefers-reduced-motion: reduce)")),ji.matches)}},nn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class vn extends Error{constructor(u,p,I,L){super(`AJAXError: ${p} (${u}): ${I}`),this.status=u,this.statusText=p,this.url=I,this.body=L}}const Ci=Nt()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,mi=f=>nn.REGISTERED_PROTOCOLS[f.substring(0,f.indexOf("://"))];function Ri(f,u){const p=new AbortController,I=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,cache:f.cache,referrer:Ci(),signal:p.signal});let L=!1,U=!1;return f.type==="json"&&I.headers.set("Accept","application/json"),U||fetch(I).then(Q=>Q.ok?(re=>{(f.type==="arrayBuffer"||f.type==="image"?re.arrayBuffer():f.type==="json"?re.json():re.text()).then(Ae=>{U||(L=!0,u(null,Ae,re.headers.get("Cache-Control"),re.headers.get("Expires")))}).catch(Ae=>{U||u(new Error(Ae.message))})})(Q):Q.blob().then(re=>u(new vn(Q.status,Q.statusText,f.url,re)))).catch(Q=>{Q.code!==20&&u(new Error(Q.message))}),{cancel:()=>{U=!0,L||p.abort()}}}const Oi=function(f,u){if(/:\/\//.test(f.url)&&!/^https?:|^file:/.test(f.url)){if(Nt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u);if(!Nt())return(mi(f.url)||Ri)(f,u)}if(!(/^file:/.test(p=f.url)||/^file:/.test(Ci())&&!/^\w+:/.test(p))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Ri(f,u);if(Nt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u,void 0,!0)}var p;return function(I,L){const U=new XMLHttpRequest;U.open(I.method||"GET",I.url,!0),I.type!=="arrayBuffer"&&I.type!=="image"||(U.responseType="arraybuffer");for(const Q in I.headers)U.setRequestHeader(Q,I.headers[Q]);return I.type==="json"&&(U.responseType="text",U.setRequestHeader("Accept","application/json")),U.withCredentials=I.credentials==="include",U.onerror=()=>{L(new Error(U.statusText))},U.onload=()=>{if((U.status>=200&&U.status<300||U.status===0)&&U.response!==null){let Q=U.response;if(I.type==="json")try{Q=JSON.parse(U.response)}catch(re){return L(re)}L(null,Q,U.getResponseHeader("Cache-Control"),U.getResponseHeader("Expires"))}else{const Q=new Blob([U.response],{type:U.getResponseHeader("Content-Type")});L(new vn(U.status,U.statusText,I.url,Q))}},U.send(I.body),{cancel:()=>U.abort()}}(f,u)},_i=function(f,u){return Oi(it(f,{type:"arrayBuffer"}),u)};function Ji(f){if(!f||f.indexOf("://")<=0||f.indexOf("data:image/")===0||f.indexOf("blob:")===0)return!0;const u=new URL(f),p=window.location;return u.protocol===p.protocol&&u.host===p.host}function Ai(f,u,p){p[f]&&p[f].indexOf(u)!==-1||(p[f]=p[f]||[],p[f].push(u))}function sn(f,u,p){if(p&&p[f]){const I=p[f].indexOf(u);I!==-1&&p[f].splice(I,1)}}class ei{constructor(u,p={}){it(this,p),this.type=u}}class _n extends ei{constructor(u,p={}){super("error",it({error:u},p))}}class Pr{on(u,p){return this._listeners=this._listeners||{},Ai(u,p,this._listeners),this}off(u,p){return sn(u,p,this._listeners),sn(u,p,this._oneTimeListeners),this}once(u,p){return p?(this._oneTimeListeners=this._oneTimeListeners||{},Ai(u,p,this._oneTimeListeners),this):new Promise(I=>this.once(u,I))}fire(u,p){typeof u=="string"&&(u=new ei(u,p||{}));const I=u.type;if(this.listens(I)){u.target=this;const L=this._listeners&&this._listeners[I]?this._listeners[I].slice():[];for(const re of L)re.call(this,u);const U=this._oneTimeListeners&&this._oneTimeListeners[I]?this._oneTimeListeners[I].slice():[];for(const re of U)sn(I,re,this._oneTimeListeners),re.call(this,u);const Q=this._eventedParent;Q&&(it(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),Q.fire(u))}else u instanceof _n&&console.error(u.error);return this}listens(u){return this._listeners&&this._listeners[u]&&this._listeners[u].length>0||this._oneTimeListeners&&this._oneTimeListeners[u]&&this._oneTimeListeners[u].length>0||this._eventedParent&&this._eventedParent.listens(u)}setEventedParent(u,p){return this._eventedParent=u,this._eventedParentData=p,this}}var ci={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const rn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function tr(f,u){const p={};for(const I in f)I!=="ref"&&(p[I]=f[I]);return rn.forEach(I=>{I in u&&(p[I]=u[I])}),p}function Pn(f,u){if(Array.isArray(f)){if(!Array.isArray(u)||f.length!==u.length)return!1;for(let p=0;p<f.length;p++)if(!Pn(f[p],u[p]))return!1;return!0}if(typeof f=="object"&&f!==null&&u!==null){if(typeof u!="object"||Object.keys(f).length!==Object.keys(u).length)return!1;for(const p in f)if(!Pn(f[p],u[p]))return!1;return!0}return f===u}const Qn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function In(f,u,p){p.push({command:Qn.addSource,args:[f,u[f]]})}function v(f,u,p){u.push({command:Qn.removeSource,args:[f]}),p[f]=!0}function k(f,u,p,I){v(f,p,I),In(f,u,p)}function V(f,u,p){let I;for(I in f[p])if(Object.prototype.hasOwnProperty.call(f[p],I)&&I!=="data"&&!Pn(f[p][I],u[p][I]))return!1;for(I in u[p])if(Object.prototype.hasOwnProperty.call(u[p],I)&&I!=="data"&&!Pn(f[p][I],u[p][I]))return!1;return!0}function Y(f,u,p,I,L,U){let Q;for(Q in u=u||{},f=f||{})Object.prototype.hasOwnProperty.call(f,Q)&&(Pn(f[Q],u[Q])||p.push({command:U,args:[I,Q,u[Q],L]}));for(Q in u)Object.prototype.hasOwnProperty.call(u,Q)&&!Object.prototype.hasOwnProperty.call(f,Q)&&(Pn(f[Q],u[Q])||p.push({command:U,args:[I,Q,u[Q],L]}))}function te(f){return f.id}function fe(f,u){return f[u.id]=u,f}class ve{constructor(u,p,I,L){this.message=(u?`${u}: `:"")+I,L&&(this.identifier=L),p!=null&&p.__line__&&(this.line=p.__line__)}}function Ie(f,...u){for(const p of u)for(const I in p)f[I]=p[I];return f}class Ee extends Error{constructor(u,p){super(p),this.message=p,this.key=u}}class ze{constructor(u,p=[]){this.parent=u,this.bindings={};for(const[I,L]of p)this.bindings[I]=L}concat(u){return new ze(this,u)}get(u){if(this.bindings[u])return this.bindings[u];if(this.parent)return this.parent.get(u);throw new Error(`${u} not found in scope.`)}has(u){return!!this.bindings[u]||!!this.parent&&this.parent.has(u)}}const We={kind:"null"},He={kind:"number"},Qe={kind:"string"},Ue={kind:"boolean"},ft={kind:"color"},st={kind:"object"},Me={kind:"value"},se={kind:"collator"},ne={kind:"formatted"},$={kind:"padding"},ie={kind:"resolvedImage"},de={kind:"variableAnchorOffsetCollection"};function ye(f,u){return{kind:"array",itemType:f,N:u}}function ge(f){if(f.kind==="array"){const u=ge(f.itemType);return typeof f.N=="number"?`array<${u}, ${f.N}>`:f.itemType.kind==="value"?"array":`array<${u}>`}return f.kind}const Pe=[We,He,Qe,Ue,ft,ne,st,ye(Me),$,ie,de];function Fe(f,u){if(u.kind==="error")return null;if(f.kind==="array"){if(u.kind==="array"&&(u.N===0&&u.itemType.kind==="value"||!Fe(f.itemType,u.itemType))&&(typeof f.N!="number"||f.N===u.N))return null}else{if(f.kind===u.kind)return null;if(f.kind==="value"){for(const p of Pe)if(!Fe(p,u))return null}}return`Expected ${ge(f)} but found ${ge(u)} instead.`}function Ve(f,u){return u.some(p=>p.kind===f.kind)}function Xe(f,u){return u.some(p=>p==="null"?f===null:p==="array"?Array.isArray(f):p==="object"?f&&!Array.isArray(f)&&typeof f=="object":p===typeof f)}function Ye(f,u){return f.kind==="array"&&u.kind==="array"?f.itemType.kind===u.itemType.kind&&typeof f.N=="number":f.kind===u.kind}const De=.96422,Ge=.82521,ht=4/29,kt=6/29,o=3*kt*kt,ke=kt*kt*kt,ai=Math.PI/180,fi=180/Math.PI;function hi(f){return(f%=360)<0&&(f+=360),f}function Jt([f,u,p,I]){let L,U;const Q=zi((.2225045*(f=oi(f))+.7168786*(u=oi(u))+.0606169*(p=oi(p)))/1);f===u&&u===p?L=U=Q:(L=zi((.4360747*f+.3850649*u+.1430804*p)/De),U=zi((.0139322*f+.0971045*u+.7141733*p)/Ge));const re=116*Q-16;return[re<0?0:re,500*(L-Q),200*(Q-U),I]}function oi(f){return f<=.04045?f/12.92:Math.pow((f+.055)/1.055,2.4)}function zi(f){return f>ke?Math.pow(f,1/3):f/o+ht}function xi([f,u,p,I]){let L=(f+16)/116,U=isNaN(u)?L:L+u/500,Q=isNaN(p)?L:L-p/200;return L=1*Yt(L),U=De*Yt(U),Q=Ge*Yt(Q),[Si(3.1338561*U-1.6168667*L-.4906146*Q),Si(-.9787684*U+1.9161415*L+.033454*Q),Si(.0719453*U-.2289914*L+1.4052427*Q),I]}function Si(f){return(f=f<=.00304?12.92*f:1.055*Math.pow(f,1/2.4)-.055)<0?0:f>1?1:f}function Yt(f){return f>kt?f*f*f:o*(f-ht)}function bn(f){return parseInt(f.padEnd(2,f),16)/255}function or(f,u){return mn(u?f/100:f,0,1)}function mn(f,u,p){return Math.min(Math.max(u,f),p)}function qn(f){return!f.some(Number.isNaN)}const jr={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Zi{constructor(u,p,I,L=1,U=!0){this.r=u,this.g=p,this.b=I,this.a=L,U||(this.r*=L,this.g*=L,this.b*=L,L||this.overwriteGetter("rgb",[u,p,I,L]))}static parse(u){if(u instanceof Zi)return u;if(typeof u!="string")return;const p=function(I){if((I=I.toLowerCase().trim())==="transparent")return[0,0,0,0];const L=jr[I];if(L){const[Q,re,Ae]=L;return[Q/255,re/255,Ae/255,1]}if(I.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(I)){const Q=I.length<6?1:2;let re=1;return[bn(I.slice(re,re+=Q)),bn(I.slice(re,re+=Q)),bn(I.slice(re,re+=Q)),bn(I.slice(re,re+Q)||"ff")]}if(I.startsWith("rgb")){const Q=I.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(Q){const[re,Ae,_e,Le,qe,et,At,gt,Dt,Lt,Rt,Kt]=Q,Ht=[Le||" ",At||" ",Lt].join("");if(Ht==="  "||Ht==="  /"||Ht===",,"||Ht===",,,"){const Qt=[_e,et,Dt].join(""),ui=Qt==="%%%"?100:Qt===""?255:0;if(ui){const yi=[mn(+Ae/ui,0,1),mn(+qe/ui,0,1),mn(+gt/ui,0,1),Rt?or(+Rt,Kt):1];if(qn(yi))return yi}}return}}const U=I.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(U){const[Q,re,Ae,_e,Le,qe,et,At,gt]=U,Dt=[Ae||" ",Le||" ",et].join("");if(Dt==="  "||Dt==="  /"||Dt===",,"||Dt===",,,"){const Lt=[+re,mn(+_e,0,100),mn(+qe,0,100),At?or(+At,gt):1];if(qn(Lt))return function([Rt,Kt,Ht,Qt]){function ui(yi){const Yi=(yi+Rt/30)%12,wn=Kt*Math.min(Ht,1-Ht);return Ht-wn*Math.max(-1,Math.min(Yi-3,9-Yi,1))}return Rt=hi(Rt),Kt/=100,Ht/=100,[ui(0),ui(8),ui(4),Qt]}(Lt)}}}(u);return p?new Zi(...p,!1):void 0}get rgb(){const{r:u,g:p,b:I,a:L}=this,U=L||1/0;return this.overwriteGetter("rgb",[u/U,p/U,I/U,L])}get hcl(){return this.overwriteGetter("hcl",function(u){const[p,I,L,U]=Jt(u),Q=Math.sqrt(I*I+L*L);return[Math.round(1e4*Q)?hi(Math.atan2(L,I)*fi):NaN,Q,p,U]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Jt(this.rgb))}overwriteGetter(u,p){return Object.defineProperty(this,u,{value:p}),p}toString(){const[u,p,I,L]=this.rgb;return`rgba(${[u,p,I].map(U=>Math.round(255*U)).join(",")},${L})`}}Zi.black=new Zi(0,0,0,1),Zi.white=new Zi(1,1,1,1),Zi.transparent=new Zi(0,0,0,0),Zi.red=new Zi(1,0,0,1);class ur{constructor(u,p,I){this.sensitivity=u?p?"variant":"case":p?"accent":"base",this.locale=I,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(u,p){return this.collator.compare(u,p)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Vn{constructor(u,p,I,L,U){this.text=u,this.image=p,this.scale=I,this.fontStack=L,this.textColor=U}}class Wt{constructor(u){this.sections=u}static fromString(u){return new Wt([new Vn(u,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(u=>u.text.length!==0||u.image&&u.image.name.length!==0)}static factory(u){return u instanceof Wt?u:Wt.fromString(u)}toString(){return this.sections.length===0?"":this.sections.map(u=>u.text).join("")}}class Ki{constructor(u){this.values=u.slice()}static parse(u){if(u instanceof Ki)return u;if(typeof u=="number")return new Ki([u,u,u,u]);if(Array.isArray(u)&&!(u.length<1||u.length>4)){for(const p of u)if(typeof p!="number")return;switch(u.length){case 1:u=[u[0],u[0],u[0],u[0]];break;case 2:u=[u[0],u[1],u[0],u[1]];break;case 3:u=[u[0],u[1],u[2],u[1]]}return new Ki(u)}}toString(){return JSON.stringify(this.values)}}const Ut=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Tn{constructor(u){this.values=u.slice()}static parse(u){if(u instanceof Tn)return u;if(Array.isArray(u)&&!(u.length<1)&&u.length%2==0){for(let p=0;p<u.length;p+=2){const I=u[p],L=u[p+1];if(typeof I!="string"||!Ut.has(I)||!Array.isArray(L)||L.length!==2||typeof L[0]!="number"||typeof L[1]!="number")return}return new Tn(u)}}toString(){return JSON.stringify(this.values)}}class cr{constructor(u){this.name=u.name,this.available=u.available}toString(){return this.name}static fromString(u){return u?new cr({name:u,available:!1}):null}}function Vs(f,u,p,I){return typeof f=="number"&&f>=0&&f<=255&&typeof u=="number"&&u>=0&&u<=255&&typeof p=="number"&&p>=0&&p<=255?I===void 0||typeof I=="number"&&I>=0&&I<=1?null:`Invalid rgba value [${[f,u,p,I].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof I=="number"?[f,u,p,I]:[f,u,p]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ur(f){if(f===null||typeof f=="string"||typeof f=="boolean"||typeof f=="number"||f instanceof Zi||f instanceof ur||f instanceof Wt||f instanceof Ki||f instanceof Tn||f instanceof cr)return!0;if(Array.isArray(f)){for(const u of f)if(!Ur(u))return!1;return!0}if(typeof f=="object"){for(const u in f)if(!Ur(f[u]))return!1;return!0}return!1}function Vt(f){if(f===null)return We;if(typeof f=="string")return Qe;if(typeof f=="boolean")return Ue;if(typeof f=="number")return He;if(f instanceof Zi)return ft;if(f instanceof ur)return se;if(f instanceof Wt)return ne;if(f instanceof Ki)return $;if(f instanceof Tn)return de;if(f instanceof cr)return ie;if(Array.isArray(f)){const u=f.length;let p;for(const I of f){const L=Vt(I);if(p){if(p===L)continue;p=Me;break}p=L}return ye(p||Me,u)}return st}function hr(f){const u=typeof f;return f===null?"":u==="string"||u==="number"||u==="boolean"?String(f):f instanceof Zi||f instanceof Wt||f instanceof Ki||f instanceof Tn||f instanceof cr?f.toString():JSON.stringify(f)}class Bt{constructor(u,p){this.type=u,this.value=p}static parse(u,p){if(u.length!==2)return p.error(`'literal' expression requires exactly one argument, but found ${u.length-1} instead.`);if(!Ur(u[1]))return p.error("invalid value");const I=u[1];let L=Vt(I);const U=p.expectedType;return L.kind!=="array"||L.N!==0||!U||U.kind!=="array"||typeof U.N=="number"&&U.N!==0||(L=U),new Bt(L,I)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Fr{constructor(u){this.name="ExpressionEvaluationError",this.message=u}toJSON(){return this.message}}const Us={string:Qe,number:He,boolean:Ue,object:st};class ua{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");let I,L=1;const U=u[0];if(U==="array"){let re,Ae;if(u.length>2){const _e=u[1];if(typeof _e!="string"||!(_e in Us)||_e==="object")return p.error('The item type argument of "array" must be one of string, number, boolean',1);re=Us[_e],L++}else re=Me;if(u.length>3){if(u[2]!==null&&(typeof u[2]!="number"||u[2]<0||u[2]!==Math.floor(u[2])))return p.error('The length argument to "array" must be a positive integer literal',2);Ae=u[2],L++}I=ye(re,Ae)}else{if(!Us[U])throw new Error(`Types doesn't contain name = ${U}`);I=Us[U]}const Q=[];for(;L<u.length;L++){const re=p.parse(u[L],L,Me);if(!re)return null;Q.push(re)}return new ua(I,Q)}evaluate(u){for(let p=0;p<this.args.length;p++){const I=this.args[p].evaluate(u);if(!Fe(this.type,Vt(I)))return I;if(p===this.args.length-1)throw new Fr(`Expected value to be of type ${ge(this.type)}, but found ${ge(Vt(I))} instead.`)}throw new Error}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const Dr={"to-boolean":Ue,"to-color":ft,"to-number":He,"to-string":Qe};class Na{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");const I=u[0];if(!Dr[I])throw new Error(`Can't parse ${I} as it is not part of the known types`);if((I==="to-boolean"||I==="to-string")&&u.length!==2)return p.error("Expected one argument.");const L=Dr[I],U=[];for(let Q=1;Q<u.length;Q++){const re=p.parse(u[Q],Q,Me);if(!re)return null;U.push(re)}return new Na(L,U)}evaluate(u){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(u);case"color":{let p,I;for(const L of this.args){if(p=L.evaluate(u),I=null,p instanceof Zi)return p;if(typeof p=="string"){const U=u.parseColor(p);if(U)return U}else if(Array.isArray(p)&&(I=p.length<3||p.length>4?`Invalid rbga value ${JSON.stringify(p)}: expected an array containing either three or four numeric values.`:Vs(p[0],p[1],p[2],p[3]),!I))return new Zi(p[0]/255,p[1]/255,p[2]/255,p[3])}throw new Fr(I||`Could not parse color from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"padding":{let p;for(const I of this.args){p=I.evaluate(u);const L=Ki.parse(p);if(L)return L}throw new Fr(`Could not parse padding from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"variableAnchorOffsetCollection":{let p;for(const I of this.args){p=I.evaluate(u);const L=Tn.parse(p);if(L)return L}throw new Fr(`Could not parse variableAnchorOffsetCollection from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"number":{let p=null;for(const I of this.args){if(p=I.evaluate(u),p===null)return 0;const L=Number(p);if(!isNaN(L))return L}throw new Fr(`Could not convert ${JSON.stringify(p)} to number.`)}case"formatted":return Wt.fromString(hr(this.args[0].evaluate(u)));case"resolvedImage":return cr.fromString(hr(this.args[0].evaluate(u)));default:return hr(this.args[0].evaluate(u))}}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const Fo=["Unknown","Point","LineString","Polygon"];class Va{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Fo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(u){let p=this._parseColorCache[u];return p||(p=this._parseColorCache[u]=Zi.parse(u)),p}}class Xs{constructor(u,p,I=[],L,U=new ze,Q=[]){this.registry=u,this.path=I,this.key=I.map(re=>`[${re}]`).join(""),this.scope=U,this.errors=Q,this.expectedType=L,this._isConstant=p}parse(u,p,I,L,U={}){return p?this.concat(p,I,L)._parse(u,U):this._parse(u,U)}_parse(u,p){function I(L,U,Q){return Q==="assert"?new ua(U,[L]):Q==="coerce"?new Na(U,[L]):L}if(u!==null&&typeof u!="string"&&typeof u!="boolean"&&typeof u!="number"||(u=["literal",u]),Array.isArray(u)){if(u.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const L=u[0];if(typeof L!="string")return this.error(`Expression name must be a string, but found ${typeof L} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const U=this.registry[L];if(U){let Q=U.parse(u,this);if(!Q)return null;if(this.expectedType){const re=this.expectedType,Ae=Q.type;if(re.kind!=="string"&&re.kind!=="number"&&re.kind!=="boolean"&&re.kind!=="object"&&re.kind!=="array"||Ae.kind!=="value")if(re.kind!=="color"&&re.kind!=="formatted"&&re.kind!=="resolvedImage"||Ae.kind!=="value"&&Ae.kind!=="string")if(re.kind!=="padding"||Ae.kind!=="value"&&Ae.kind!=="number"&&Ae.kind!=="array")if(re.kind!=="variableAnchorOffsetCollection"||Ae.kind!=="value"&&Ae.kind!=="array"){if(this.checkSubtype(re,Ae))return null}else Q=I(Q,re,p.typeAnnotation||"coerce");else Q=I(Q,re,p.typeAnnotation||"coerce");else Q=I(Q,re,p.typeAnnotation||"coerce");else Q=I(Q,re,p.typeAnnotation||"assert")}if(!(Q instanceof Bt)&&Q.type.kind!=="resolvedImage"&&this._isConstant(Q)){const re=new Va;try{Q=new Bt(Q.type,Q.evaluate(re))}catch(Ae){return this.error(Ae.message),null}}return Q}return this.error(`Unknown expression "${L}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(u===void 0?"'undefined' value invalid. Use null instead.":typeof u=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof u} instead.`)}concat(u,p,I){const L=typeof u=="number"?this.path.concat(u):this.path,U=I?this.scope.concat(I):this.scope;return new Xs(this.registry,this._isConstant,L,p||null,U,this.errors)}error(u,...p){const I=`${this.key}${p.map(L=>`[${L}]`).join("")}`;this.errors.push(new Ee(I,u))}checkSubtype(u,p){const I=Fe(u,p);return I&&this.error(I),I}}class Zn{constructor(u,p,I){this.type=se,this.locale=I,this.caseSensitive=u,this.diacriticSensitive=p}static parse(u,p){if(u.length!==2)return p.error("Expected one argument.");const I=u[1];if(typeof I!="object"||Array.isArray(I))return p.error("Collator options argument must be an object.");const L=p.parse(I["case-sensitive"]!==void 0&&I["case-sensitive"],1,Ue);if(!L)return null;const U=p.parse(I["diacritic-sensitive"]!==void 0&&I["diacritic-sensitive"],1,Ue);if(!U)return null;let Q=null;return I.locale&&(Q=p.parse(I.locale,1,Qe),!Q)?null:new Zn(L,U,Q)}evaluate(u){return new ur(this.caseSensitive.evaluate(u),this.diacriticSensitive.evaluate(u),this.locale?this.locale.evaluate(u):null)}eachChild(u){u(this.caseSensitive),u(this.diacriticSensitive),this.locale&&u(this.locale)}outputDefined(){return!1}}const aa=8192;function hs(f,u){f[0]=Math.min(f[0],u[0]),f[1]=Math.min(f[1],u[1]),f[2]=Math.max(f[2],u[0]),f[3]=Math.max(f[3],u[1])}function Ua(f,u){return!(f[0]<=u[0]||f[2]>=u[2]||f[1]<=u[1]||f[3]>=u[3])}function al(f,u){const p=(180+f[0])/360,I=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f[1]*Math.PI/360)))/360,L=Math.pow(2,u.z);return[Math.round(p*L*aa),Math.round(I*L*aa)]}function ol(f,u,p){const I=f[0]-u[0],L=f[1]-u[1],U=f[0]-p[0],Q=f[1]-p[1];return I*Q-U*L==0&&I*U<=0&&L*Q<=0}function no(f,u){let p=!1;for(let Q=0,re=u.length;Q<re;Q++){const Ae=u[Q];for(let _e=0,Le=Ae.length;_e<Le-1;_e++){if(ol(f,Ae[_e],Ae[_e+1]))return!1;(L=Ae[_e])[1]>(I=f)[1]!=(U=Ae[_e+1])[1]>I[1]&&I[0]<(U[0]-L[0])*(I[1]-L[1])/(U[1]-L[1])+L[0]&&(p=!p)}}var I,L,U;return p}function Ga(f,u){for(let p=0;p<u.length;p++)if(no(f,u[p]))return!0;return!1}function N(f,u,p,I){const L=I[0]-p[0],U=I[1]-p[1],Q=(f[0]-p[0])*U-L*(f[1]-p[1]),re=(u[0]-p[0])*U-L*(u[1]-p[1]);return Q>0&&re<0||Q<0&&re>0}function xe(f,u,p){for(const _e of p)for(let Le=0;Le<_e.length-1;++Le)if((re=[(Q=_e[Le+1])[0]-(U=_e[Le])[0],Q[1]-U[1]])[0]*(Ae=[(L=u)[0]-(I=f)[0],L[1]-I[1]])[1]-re[1]*Ae[0]!=0&&N(I,L,U,Q)&&N(U,Q,I,L))return!0;var I,L,U,Q,re,Ae;return!1}function rt(f,u){for(let p=0;p<f.length;++p)if(!no(f[p],u))return!1;for(let p=0;p<f.length-1;++p)if(xe(f[p],f[p+1],u))return!1;return!0}function St(f,u){for(let p=0;p<u.length;p++)if(rt(f,u[p]))return!0;return!1}function $t(f,u,p){const I=[];for(let L=0;L<f.length;L++){const U=[];for(let Q=0;Q<f[L].length;Q++){const re=al(f[L][Q],p);hs(u,re),U.push(re)}I.push(U)}return I}function Ii(f,u,p){const I=[];for(let L=0;L<f.length;L++){const U=$t(f[L],u,p);I.push(U)}return I}function Li(f,u,p,I){if(f[0]<p[0]||f[0]>p[2]){const L=.5*I;let U=f[0]-p[0]>L?-I:p[0]-f[0]>L?I:0;U===0&&(U=f[0]-p[2]>L?-I:p[2]-f[0]>L?I:0),f[0]+=U}hs(u,f)}function An(f,u,p,I){const L=Math.pow(2,I.z)*aa,U=[I.x*aa,I.y*aa],Q=[];for(const re of f)for(const Ae of re){const _e=[Ae.x+U[0],Ae.y+U[1]];Li(_e,u,p,L),Q.push(_e)}return Q}function pn(f,u,p,I){const L=Math.pow(2,I.z)*aa,U=[I.x*aa,I.y*aa],Q=[];for(const Ae of f){const _e=[];for(const Le of Ae){const qe=[Le.x+U[0],Le.y+U[1]];hs(u,qe),_e.push(qe)}Q.push(_e)}if(u[2]-u[0]<=L/2){(re=u)[0]=re[1]=1/0,re[2]=re[3]=-1/0;for(const Ae of Q)for(const _e of Ae)Li(_e,u,p,L)}var re;return Q}class sr{constructor(u,p){this.type=Ue,this.geojson=u,this.geometries=p}static parse(u,p){if(u.length!==2)return p.error(`'within' expression requires exactly one argument, but found ${u.length-1} instead.`);if(Ur(u[1])){const I=u[1];if(I.type==="FeatureCollection")for(let L=0;L<I.features.length;++L){const U=I.features[L].geometry.type;if(U==="Polygon"||U==="MultiPolygon")return new sr(I,I.features[L].geometry)}else if(I.type==="Feature"){const L=I.geometry.type;if(L==="Polygon"||L==="MultiPolygon")return new sr(I,I.geometry)}else if(I.type==="Polygon"||I.type==="MultiPolygon")return new sr(I,I)}return p.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(u){if(u.geometry()!=null&&u.canonicalID()!=null){if(u.geometryType()==="Point")return function(p,I){const L=[1/0,1/0,-1/0,-1/0],U=[1/0,1/0,-1/0,-1/0],Q=p.canonicalID();if(I.type==="Polygon"){const re=$t(I.coordinates,U,Q),Ae=An(p.geometry(),L,U,Q);if(!Ua(L,U))return!1;for(const _e of Ae)if(!no(_e,re))return!1}if(I.type==="MultiPolygon"){const re=Ii(I.coordinates,U,Q),Ae=An(p.geometry(),L,U,Q);if(!Ua(L,U))return!1;for(const _e of Ae)if(!Ga(_e,re))return!1}return!0}(u,this.geometries);if(u.geometryType()==="LineString")return function(p,I){const L=[1/0,1/0,-1/0,-1/0],U=[1/0,1/0,-1/0,-1/0],Q=p.canonicalID();if(I.type==="Polygon"){const re=$t(I.coordinates,U,Q),Ae=pn(p.geometry(),L,U,Q);if(!Ua(L,U))return!1;for(const _e of Ae)if(!rt(_e,re))return!1}if(I.type==="MultiPolygon"){const re=Ii(I.coordinates,U,Q),Ae=pn(p.geometry(),L,U,Q);if(!Ua(L,U))return!1;for(const _e of Ae)if(!St(_e,re))return!1}return!0}(u,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Ar{constructor(u,p){this.type=p.type,this.name=u,this.boundExpression=p}static parse(u,p){if(u.length!==2||typeof u[1]!="string")return p.error("'var' expression requires exactly one string literal argument.");const I=u[1];return p.scope.has(I)?new Ar(I,p.scope.get(I)):p.error(`Unknown variable "${I}". Make sure "${I}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(u){return this.boundExpression.evaluate(u)}eachChild(){}outputDefined(){return!1}}class Or{constructor(u,p,I,L){this.name=u,this.type=p,this._evaluate=I,this.args=L}evaluate(u){return this._evaluate(u,this.args)}eachChild(u){this.args.forEach(u)}outputDefined(){return!1}static parse(u,p){const I=u[0],L=Or.definitions[I];if(!L)return p.error(`Unknown expression "${I}". If you wanted a literal array, use ["literal", [...]].`,0);const U=Array.isArray(L)?L[0]:L.type,Q=Array.isArray(L)?[[L[1],L[2]]]:L.overloads,re=Q.filter(([_e])=>!Array.isArray(_e)||_e.length===u.length-1);let Ae=null;for(const[_e,Le]of re){Ae=new Xs(p.registry,qa,p.path,null,p.scope);const qe=[];let et=!1;for(let At=1;At<u.length;At++){const gt=u[At],Dt=Array.isArray(_e)?_e[At-1]:_e.type,Lt=Ae.parse(gt,1+qe.length,Dt);if(!Lt){et=!0;break}qe.push(Lt)}if(!et)if(Array.isArray(_e)&&_e.length!==qe.length)Ae.error(`Expected ${_e.length} arguments, but found ${qe.length} instead.`);else{for(let At=0;At<qe.length;At++){const gt=Array.isArray(_e)?_e[At]:_e.type,Dt=qe[At];Ae.concat(At+1).checkSubtype(gt,Dt.type)}if(Ae.errors.length===0)return new Or(I,U,Le,qe)}}if(re.length===1)p.errors.push(...Ae.errors);else{const _e=(re.length?re:Q).map(([qe])=>{return et=qe,Array.isArray(et)?`(${et.map(ge).join(", ")})`:`(${ge(et.type)}...)`;var et}).join(" | "),Le=[];for(let qe=1;qe<u.length;qe++){const et=p.parse(u[qe],1+Le.length);if(!et)return null;Le.push(ge(et.type))}p.error(`Expected arguments of type ${_e}, but found (${Le.join(", ")}) instead.`)}return null}static register(u,p){Or.definitions=p;for(const I in p)u[I]=Or}}function qa(f){if(f instanceof Ar)return qa(f.boundExpression);if(f instanceof Or&&f.name==="error"||f instanceof Zn||f instanceof sr)return!1;const u=f instanceof Na||f instanceof ua;let p=!0;return f.eachChild(I=>{p=u?p&&qa(I):p&&I instanceof Bt}),!!p&&Ha(f)&&pl(f,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ha(f){if(f instanceof Or&&(f.name==="get"&&f.args.length===1||f.name==="feature-state"||f.name==="has"&&f.args.length===1||f.name==="properties"||f.name==="geometry-type"||f.name==="id"||/^filter-/.test(f.name))||f instanceof sr)return!1;let u=!0;return f.eachChild(p=>{u&&!Ha(p)&&(u=!1)}),u}function ja(f){if(f instanceof Or&&f.name==="feature-state")return!1;let u=!0;return f.eachChild(p=>{u&&!ja(p)&&(u=!1)}),u}function pl(f,u){if(f instanceof Or&&u.indexOf(f.name)>=0)return!1;let p=!0;return f.eachChild(I=>{p&&!pl(I,u)&&(p=!1)}),p}function Gr(f,u){const p=f.length-1;let I,L,U=0,Q=p,re=0;for(;U<=Q;)if(re=Math.floor((U+Q)/2),I=f[re],L=f[re+1],I<=u){if(re===p||u<L)return re;U=re+1}else{if(!(I>u))throw new Fr("Input is not a number.");Q=re-1}return 0}class nr{constructor(u,p,I){this.type=u,this.input=p,this.labels=[],this.outputs=[];for(const[L,U]of I)this.labels.push(L),this.outputs.push(U)}static parse(u,p){if(u.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return p.error("Expected an even number of arguments.");const I=p.parse(u[1],1,He);if(!I)return null;const L=[];let U=null;p.expectedType&&p.expectedType.kind!=="value"&&(U=p.expectedType);for(let Q=1;Q<u.length;Q+=2){const re=Q===1?-1/0:u[Q],Ae=u[Q+1],_e=Q,Le=Q+1;if(typeof re!="number")return p.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',_e);if(L.length&&L[L.length-1][0]>=re)return p.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',_e);const qe=p.parse(Ae,Le,U);if(!qe)return null;U=U||qe.type,L.push([re,qe])}return new nr(U,I,L)}evaluate(u){const p=this.labels,I=this.outputs;if(p.length===1)return I[0].evaluate(u);const L=this.input.evaluate(u);if(L<=p[0])return I[0].evaluate(u);const U=p.length;return L>=p[U-1]?I[U-1].evaluate(u):I[Gr(p,L)].evaluate(u)}eachChild(u){u(this.input);for(const p of this.outputs)u(p)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function Ir(f,u,p){return f+p*(u-f)}function Lr(f,u,p){return f.map((I,L)=>Ir(I,u[L],p))}const Zs={number:Ir,color:function(f,u,p,I="rgb"){switch(I){case"rgb":{const[L,U,Q,re]=Lr(f.rgb,u.rgb,p);return new Zi(L,U,Q,re,!1)}case"hcl":{const[L,U,Q,re]=f.hcl,[Ae,_e,Le,qe]=u.hcl;let et,At;if(isNaN(L)||isNaN(Ae))isNaN(L)?isNaN(Ae)?et=NaN:(et=Ae,Q!==1&&Q!==0||(At=_e)):(et=L,Le!==1&&Le!==0||(At=U));else{let Kt=Ae-L;Ae>L&&Kt>180?Kt-=360:Ae<L&&L-Ae>180&&(Kt+=360),et=L+p*Kt}const[gt,Dt,Lt,Rt]=function([Kt,Ht,Qt,ui]){return Kt=isNaN(Kt)?0:Kt*ai,xi([Qt,Math.cos(Kt)*Ht,Math.sin(Kt)*Ht,ui])}([et,At??Ir(U,_e,p),Ir(Q,Le,p),Ir(re,qe,p)]);return new Zi(gt,Dt,Lt,Rt,!1)}case"lab":{const[L,U,Q,re]=xi(Lr(f.lab,u.lab,p));return new Zi(L,U,Q,re,!1)}}},array:Lr,padding:function(f,u,p){return new Ki(Lr(f.values,u.values,p))},variableAnchorOffsetCollection:function(f,u,p){const I=f.values,L=u.values;if(I.length!==L.length)throw new Fr(`Cannot interpolate values of different length. from: ${f.toString()}, to: ${u.toString()}`);const U=[];for(let Q=0;Q<I.length;Q+=2){if(I[Q]!==L[Q])throw new Fr(`Cannot interpolate values containing mismatched anchors. from[${Q}]: ${I[Q]}, to[${Q}]: ${L[Q]}`);U.push(I[Q]);const[re,Ae]=I[Q+1],[_e,Le]=L[Q+1];U.push([Ir(re,_e,p),Ir(Ae,Le,p)])}return new Tn(U)}};class vr{constructor(u,p,I,L,U){this.type=u,this.operator=p,this.interpolation=I,this.input=L,this.labels=[],this.outputs=[];for(const[Q,re]of U)this.labels.push(Q),this.outputs.push(re)}static interpolationFactor(u,p,I,L){let U=0;if(u.name==="exponential")U=Ks(p,u.base,I,L);else if(u.name==="linear")U=Ks(p,1,I,L);else if(u.name==="cubic-bezier"){const Q=u.controlPoints;U=new nt(Q[0],Q[1],Q[2],Q[3]).solve(Ks(p,1,I,L))}return U}static parse(u,p){let[I,L,U,...Q]=u;if(!Array.isArray(L)||L.length===0)return p.error("Expected an interpolation type expression.",1);if(L[0]==="linear")L={name:"linear"};else if(L[0]==="exponential"){const _e=L[1];if(typeof _e!="number")return p.error("Exponential interpolation requires a numeric base.",1,1);L={name:"exponential",base:_e}}else{if(L[0]!=="cubic-bezier")return p.error(`Unknown interpolation type ${String(L[0])}`,1,0);{const _e=L.slice(1);if(_e.length!==4||_e.some(Le=>typeof Le!="number"||Le<0||Le>1))return p.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);L={name:"cubic-bezier",controlPoints:_e}}}if(u.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return p.error("Expected an even number of arguments.");if(U=p.parse(U,2,He),!U)return null;const re=[];let Ae=null;I==="interpolate-hcl"||I==="interpolate-lab"?Ae=ft:p.expectedType&&p.expectedType.kind!=="value"&&(Ae=p.expectedType);for(let _e=0;_e<Q.length;_e+=2){const Le=Q[_e],qe=Q[_e+1],et=_e+3,At=_e+4;if(typeof Le!="number")return p.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',et);if(re.length&&re[re.length-1][0]>=Le)return p.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',et);const gt=p.parse(qe,At,Ae);if(!gt)return null;Ae=Ae||gt.type,re.push([Le,gt])}return Ye(Ae,He)||Ye(Ae,ft)||Ye(Ae,$)||Ye(Ae,de)||Ye(Ae,ye(He))?new vr(Ae,I,L,U,re):p.error(`Type ${ge(Ae)} is not interpolatable.`)}evaluate(u){const p=this.labels,I=this.outputs;if(p.length===1)return I[0].evaluate(u);const L=this.input.evaluate(u);if(L<=p[0])return I[0].evaluate(u);const U=p.length;if(L>=p[U-1])return I[U-1].evaluate(u);const Q=Gr(p,L),re=vr.interpolationFactor(this.interpolation,L,p[Q],p[Q+1]),Ae=I[Q].evaluate(u),_e=I[Q+1].evaluate(u);switch(this.operator){case"interpolate":return Zs[this.type.kind](Ae,_e,re);case"interpolate-hcl":return Zs.color(Ae,_e,re,"hcl");case"interpolate-lab":return Zs.color(Ae,_e,re,"lab")}}eachChild(u){u(this.input);for(const p of this.outputs)u(p)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function Ks(f,u,p,I){const L=I-p,U=f-p;return L===0?0:u===1?U/L:(Math.pow(u,U)-1)/(Math.pow(u,L)-1)}class Br{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expectected at least one argument.");let I=null;const L=p.expectedType;L&&L.kind!=="value"&&(I=L);const U=[];for(const re of u.slice(1)){const Ae=p.parse(re,1+U.length,I,void 0,{typeAnnotation:"omit"});if(!Ae)return null;I=I||Ae.type,U.push(Ae)}if(!I)throw new Error("No output type");const Q=L&&U.some(re=>Fe(L,re.type));return new Br(Q?Me:I,U)}evaluate(u){let p,I=null,L=0;for(const U of this.args)if(L++,I=U.evaluate(u),I&&I instanceof cr&&!I.available&&(p||(p=I.name),I=null,L===this.args.length&&(I=p)),I!==null)break;return I}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}class Eo{constructor(u,p){this.type=p.type,this.bindings=[].concat(u),this.result=p}evaluate(u){return this.result.evaluate(u)}eachChild(u){for(const p of this.bindings)u(p[1]);u(this.result)}static parse(u,p){if(u.length<4)return p.error(`Expected at least 3 arguments, but found ${u.length-1} instead.`);const I=[];for(let U=1;U<u.length-1;U+=2){const Q=u[U];if(typeof Q!="string")return p.error(`Expected string, but found ${typeof Q} instead.`,U);if(/[^a-zA-Z0-9_]/.test(Q))return p.error("Variable names must contain only alphanumeric characters or '_'.",U);const re=p.parse(u[U+1],U+1);if(!re)return null;I.push([Q,re])}const L=p.parse(u[u.length-1],u.length-1,p.expectedType,I);return L?new Eo(I,L):null}outputDefined(){return this.result.outputDefined()}}class Zo{constructor(u,p,I){this.type=u,this.index=p,this.input=I}static parse(u,p){if(u.length!==3)return p.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const I=p.parse(u[1],1,He),L=p.parse(u[2],2,ye(p.expectedType||Me));return I&&L?new Zo(L.type.itemType,I,L):null}evaluate(u){const p=this.index.evaluate(u),I=this.input.evaluate(u);if(p<0)throw new Fr(`Array index out of bounds: ${p} < 0.`);if(p>=I.length)throw new Fr(`Array index out of bounds: ${p} > ${I.length-1}.`);if(p!==Math.floor(p))throw new Fr(`Array index must be an integer, but found ${p} instead.`);return I[p]}eachChild(u){u(this.index),u(this.input)}outputDefined(){return!1}}class Bs{constructor(u,p){this.type=Ue,this.needle=u,this.haystack=p}static parse(u,p){if(u.length!==3)return p.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const I=p.parse(u[1],1,Me),L=p.parse(u[2],2,Me);return I&&L?Ve(I.type,[Ue,Qe,He,We,Me])?new Bs(I,L):p.error(`Expected first argument to be of type boolean, string, number or null, but found ${ge(I.type)} instead`):null}evaluate(u){const p=this.needle.evaluate(u),I=this.haystack.evaluate(u);if(!I)return!1;if(!Xe(p,["boolean","string","number","null"]))throw new Fr(`Expected first argument to be of type boolean, string, number or null, but found ${ge(Vt(p))} instead.`);if(!Xe(I,["string","array"]))throw new Fr(`Expected second argument to be of type array or string, but found ${ge(Vt(I))} instead.`);return I.indexOf(p)>=0}eachChild(u){u(this.needle),u(this.haystack)}outputDefined(){return!0}}class Il{constructor(u,p,I){this.type=He,this.needle=u,this.haystack=p,this.fromIndex=I}static parse(u,p){if(u.length<=2||u.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const I=p.parse(u[1],1,Me),L=p.parse(u[2],2,Me);if(!I||!L)return null;if(!Ve(I.type,[Ue,Qe,He,We,Me]))return p.error(`Expected first argument to be of type boolean, string, number or null, but found ${ge(I.type)} instead`);if(u.length===4){const U=p.parse(u[3],3,He);return U?new Il(I,L,U):null}return new Il(I,L)}evaluate(u){const p=this.needle.evaluate(u),I=this.haystack.evaluate(u);if(!Xe(p,["boolean","string","number","null"]))throw new Fr(`Expected first argument to be of type boolean, string, number or null, but found ${ge(Vt(p))} instead.`);if(!Xe(I,["string","array"]))throw new Fr(`Expected second argument to be of type array or string, but found ${ge(Vt(I))} instead.`);if(this.fromIndex){const L=this.fromIndex.evaluate(u);return I.indexOf(p,L)}return I.indexOf(p)}eachChild(u){u(this.needle),u(this.haystack),this.fromIndex&&u(this.fromIndex)}outputDefined(){return!1}}class mo{constructor(u,p,I,L,U,Q){this.inputType=u,this.type=p,this.input=I,this.cases=L,this.outputs=U,this.otherwise=Q}static parse(u,p){if(u.length<5)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if(u.length%2!=1)return p.error("Expected an even number of arguments.");let I,L;p.expectedType&&p.expectedType.kind!=="value"&&(L=p.expectedType);const U={},Q=[];for(let _e=2;_e<u.length-1;_e+=2){let Le=u[_e];const qe=u[_e+1];Array.isArray(Le)||(Le=[Le]);const et=p.concat(_e);if(Le.length===0)return et.error("Expected at least one branch label.");for(const gt of Le){if(typeof gt!="number"&&typeof gt!="string")return et.error("Branch labels must be numbers or strings.");if(typeof gt=="number"&&Math.abs(gt)>Number.MAX_SAFE_INTEGER)return et.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof gt=="number"&&Math.floor(gt)!==gt)return et.error("Numeric branch labels must be integer values.");if(I){if(et.checkSubtype(I,Vt(gt)))return null}else I=Vt(gt);if(U[String(gt)]!==void 0)return et.error("Branch labels must be unique.");U[String(gt)]=Q.length}const At=p.parse(qe,_e,L);if(!At)return null;L=L||At.type,Q.push(At)}const re=p.parse(u[1],1,Me);if(!re)return null;const Ae=p.parse(u[u.length-1],u.length-1,L);return Ae?re.type.kind!=="value"&&p.concat(1).checkSubtype(I,re.type)?null:new mo(I,L,re,U,Q,Ae):null}evaluate(u){const p=this.input.evaluate(u);return(Vt(p)===this.inputType&&this.outputs[this.cases[p]]||this.otherwise).evaluate(u)}eachChild(u){u(this.input),this.outputs.forEach(u),u(this.otherwise)}outputDefined(){return this.outputs.every(u=>u.outputDefined())&&this.otherwise.outputDefined()}}class Qo{constructor(u,p,I){this.type=u,this.branches=p,this.otherwise=I}static parse(u,p){if(u.length<4)return p.error(`Expected at least 3 arguments, but found only ${u.length-1}.`);if(u.length%2!=0)return p.error("Expected an odd number of arguments.");let I;p.expectedType&&p.expectedType.kind!=="value"&&(I=p.expectedType);const L=[];for(let Q=1;Q<u.length-1;Q+=2){const re=p.parse(u[Q],Q,Ue);if(!re)return null;const Ae=p.parse(u[Q+1],Q+1,I);if(!Ae)return null;L.push([re,Ae]),I=I||Ae.type}const U=p.parse(u[u.length-1],u.length-1,I);if(!U)return null;if(!I)throw new Error("Can't infer output type");return new Qo(I,L,U)}evaluate(u){for(const[p,I]of this.branches)if(p.evaluate(u))return I.evaluate(u);return this.otherwise.evaluate(u)}eachChild(u){for(const[p,I]of this.branches)u(p),u(I);u(this.otherwise)}outputDefined(){return this.branches.every(([u,p])=>p.outputDefined())&&this.otherwise.outputDefined()}}class ca{constructor(u,p,I,L){this.type=u,this.input=p,this.beginIndex=I,this.endIndex=L}static parse(u,p){if(u.length<=2||u.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const I=p.parse(u[1],1,Me),L=p.parse(u[2],2,He);if(!I||!L)return null;if(!Ve(I.type,[ye(Me),Qe,Me]))return p.error(`Expected first argument to be of type array or string, but found ${ge(I.type)} instead`);if(u.length===4){const U=p.parse(u[3],3,He);return U?new ca(I.type,I,L,U):null}return new ca(I.type,I,L)}evaluate(u){const p=this.input.evaluate(u),I=this.beginIndex.evaluate(u);if(!Xe(p,["string","array"]))throw new Fr(`Expected first argument to be of type array or string, but found ${ge(Vt(p))} instead.`);if(this.endIndex){const L=this.endIndex.evaluate(u);return p.slice(I,L)}return p.slice(I)}eachChild(u){u(this.input),u(this.beginIndex),this.endIndex&&u(this.endIndex)}outputDefined(){return!1}}function Ys(f,u){return f==="=="||f==="!="?u.kind==="boolean"||u.kind==="string"||u.kind==="number"||u.kind==="null"||u.kind==="value":u.kind==="string"||u.kind==="number"||u.kind==="value"}function El(f,u,p,I){return I.compare(u,p)===0}function Za(f,u,p){const I=f!=="=="&&f!=="!=";return class a5{constructor(U,Q,re){this.type=Ue,this.lhs=U,this.rhs=Q,this.collator=re,this.hasUntypedArgument=U.type.kind==="value"||Q.type.kind==="value"}static parse(U,Q){if(U.length!==3&&U.length!==4)return Q.error("Expected two or three arguments.");const re=U[0];let Ae=Q.parse(U[1],1,Me);if(!Ae)return null;if(!Ys(re,Ae.type))return Q.concat(1).error(`"${re}" comparisons are not supported for type '${ge(Ae.type)}'.`);let _e=Q.parse(U[2],2,Me);if(!_e)return null;if(!Ys(re,_e.type))return Q.concat(2).error(`"${re}" comparisons are not supported for type '${ge(_e.type)}'.`);if(Ae.type.kind!==_e.type.kind&&Ae.type.kind!=="value"&&_e.type.kind!=="value")return Q.error(`Cannot compare types '${ge(Ae.type)}' and '${ge(_e.type)}'.`);I&&(Ae.type.kind==="value"&&_e.type.kind!=="value"?Ae=new ua(_e.type,[Ae]):Ae.type.kind!=="value"&&_e.type.kind==="value"&&(_e=new ua(Ae.type,[_e])));let Le=null;if(U.length===4){if(Ae.type.kind!=="string"&&_e.type.kind!=="string"&&Ae.type.kind!=="value"&&_e.type.kind!=="value")return Q.error("Cannot use collator to compare non-string types.");if(Le=Q.parse(U[3],3,se),!Le)return null}return new a5(Ae,_e,Le)}evaluate(U){const Q=this.lhs.evaluate(U),re=this.rhs.evaluate(U);if(I&&this.hasUntypedArgument){const Ae=Vt(Q),_e=Vt(re);if(Ae.kind!==_e.kind||Ae.kind!=="string"&&Ae.kind!=="number")throw new Fr(`Expected arguments for "${f}" to be (string, string) or (number, number), but found (${Ae.kind}, ${_e.kind}) instead.`)}if(this.collator&&!I&&this.hasUntypedArgument){const Ae=Vt(Q),_e=Vt(re);if(Ae.kind!=="string"||_e.kind!=="string")return u(U,Q,re)}return this.collator?p(U,Q,re,this.collator.evaluate(U)):u(U,Q,re)}eachChild(U){U(this.lhs),U(this.rhs),this.collator&&U(this.collator)}outputDefined(){return!0}}}const Ta=Za("==",function(f,u,p){return u===p},El),ml=Za("!=",function(f,u,p){return u!==p},function(f,u,p,I){return!El(0,u,p,I)}),Cl=Za("<",function(f,u,p){return u<p},function(f,u,p,I){return I.compare(u,p)<0}),mu=Za(">",function(f,u,p){return u>p},function(f,u,p,I){return I.compare(u,p)>0}),As=Za("<=",function(f,u,p){return u<=p},function(f,u,p,I){return I.compare(u,p)<=0}),ac=Za(">=",function(f,u,p){return u>=p},function(f,u,p,I){return I.compare(u,p)>=0});class ro{constructor(u,p,I,L,U){this.type=Qe,this.number=u,this.locale=p,this.currency=I,this.minFractionDigits=L,this.maxFractionDigits=U}static parse(u,p){if(u.length!==3)return p.error("Expected two arguments.");const I=p.parse(u[1],1,He);if(!I)return null;const L=u[2];if(typeof L!="object"||Array.isArray(L))return p.error("NumberFormat options argument must be an object.");let U=null;if(L.locale&&(U=p.parse(L.locale,1,Qe),!U))return null;let Q=null;if(L.currency&&(Q=p.parse(L.currency,1,Qe),!Q))return null;let re=null;if(L["min-fraction-digits"]&&(re=p.parse(L["min-fraction-digits"],1,He),!re))return null;let Ae=null;return L["max-fraction-digits"]&&(Ae=p.parse(L["max-fraction-digits"],1,He),!Ae)?null:new ro(I,U,Q,re,Ae)}evaluate(u){return new Intl.NumberFormat(this.locale?this.locale.evaluate(u):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(u):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(u):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(u):void 0}).format(this.number.evaluate(u))}eachChild(u){u(this.number),this.locale&&u(this.locale),this.currency&&u(this.currency),this.minFractionDigits&&u(this.minFractionDigits),this.maxFractionDigits&&u(this.maxFractionDigits)}outputDefined(){return!1}}class so{constructor(u){this.type=ne,this.sections=u}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");const I=u[1];if(!Array.isArray(I)&&typeof I=="object")return p.error("First argument must be an image or text section.");const L=[];let U=!1;for(let Q=1;Q<=u.length-1;++Q){const re=u[Q];if(U&&typeof re=="object"&&!Array.isArray(re)){U=!1;let Ae=null;if(re["font-scale"]&&(Ae=p.parse(re["font-scale"],1,He),!Ae))return null;let _e=null;if(re["text-font"]&&(_e=p.parse(re["text-font"],1,ye(Qe)),!_e))return null;let Le=null;if(re["text-color"]&&(Le=p.parse(re["text-color"],1,ft),!Le))return null;const qe=L[L.length-1];qe.scale=Ae,qe.font=_e,qe.textColor=Le}else{const Ae=p.parse(u[Q],1,Me);if(!Ae)return null;const _e=Ae.type.kind;if(_e!=="string"&&_e!=="value"&&_e!=="null"&&_e!=="resolvedImage")return p.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");U=!0,L.push({content:Ae,scale:null,font:null,textColor:null})}}return new so(L)}evaluate(u){return new Wt(this.sections.map(p=>{const I=p.content.evaluate(u);return Vt(I)===ie?new Vn("",I,null,null,null):new Vn(hr(I),null,p.scale?p.scale.evaluate(u):null,p.font?p.font.evaluate(u).join(","):null,p.textColor?p.textColor.evaluate(u):null)}))}eachChild(u){for(const p of this.sections)u(p.content),p.scale&&u(p.scale),p.font&&u(p.font),p.textColor&&u(p.textColor)}outputDefined(){return!1}}class Ql{constructor(u){this.type=ie,this.input=u}static parse(u,p){if(u.length!==2)return p.error("Expected two arguments.");const I=p.parse(u[1],1,Qe);return I?new Ql(I):p.error("No image name provided.")}evaluate(u){const p=this.input.evaluate(u),I=cr.fromString(p);return I&&u.availableImages&&(I.available=u.availableImages.indexOf(p)>-1),I}eachChild(u){u(this.input)}outputDefined(){return!1}}class Oo{constructor(u){this.type=He,this.input=u}static parse(u,p){if(u.length!==2)return p.error(`Expected 1 argument, but found ${u.length-1} instead.`);const I=p.parse(u[1],1);return I?I.type.kind!=="array"&&I.type.kind!=="string"&&I.type.kind!=="value"?p.error(`Expected argument of type string or array, but found ${ge(I.type)} instead.`):new Oo(I):null}evaluate(u){const p=this.input.evaluate(u);if(typeof p=="string"||Array.isArray(p))return p.length;throw new Fr(`Expected value to be of type string or array, but found ${ge(Vt(p))} instead.`)}eachChild(u){u(this.input)}outputDefined(){return!1}}const Wo={"==":Ta,"!=":ml,">":mu,"<":Cl,">=":ac,"<=":As,array:ua,at:Zo,boolean:ua,case:Qo,coalesce:Br,collator:Zn,format:so,image:Ql,in:Bs,"index-of":Il,interpolate:vr,"interpolate-hcl":vr,"interpolate-lab":vr,length:Oo,let:Eo,literal:Bt,match:mo,number:ua,"number-format":ro,object:ua,slice:ca,step:nr,string:ua,"to-boolean":Na,"to-color":Na,"to-number":Na,"to-string":Na,var:Ar,within:sr};function Co(f,[u,p,I,L]){u=u.evaluate(f),p=p.evaluate(f),I=I.evaluate(f);const U=L?L.evaluate(f):1,Q=Vs(u,p,I,U);if(Q)throw new Fr(Q);return new Zi(u/255,p/255,I/255,U,!1)}function Gs(f,u){return f in u}function $o(f,u){const p=u[f];return p===void 0?null:p}function Xo(f){return{type:f}}function Yo(f){return{result:"success",value:f}}function ba(f){return{result:"error",value:f}}function Qa(f){return f["property-type"]==="data-driven"||f["property-type"]==="cross-faded-data-driven"}function Cs(f){return!!f.expression&&f.expression.parameters.indexOf("zoom")>-1}function gu(f){return!!f.expression&&f.expression.interpolated}function Er(f){return f instanceof Number?"number":f instanceof String?"string":f instanceof Boolean?"boolean":Array.isArray(f)?"array":f===null?"null":typeof f}function $n(f){return typeof f=="object"&&f!==null&&!Array.isArray(f)}function Ko(f){return f}function zr(f,u){const p=u.type==="color",I=f.stops&&typeof f.stops[0][0]=="object",L=I||!(I||f.property!==void 0),U=f.type||(gu(u)?"exponential":"interval");if(p||u.type==="padding"){const Le=p?Zi.parse:Ki.parse;(f=Ie({},f)).stops&&(f.stops=f.stops.map(qe=>[qe[0],Le(qe[1])])),f.default=Le(f.default?f.default:u.default)}if(f.colorSpace&&(Q=f.colorSpace)!=="rgb"&&Q!=="hcl"&&Q!=="lab")throw new Error(`Unknown color space: "${f.colorSpace}"`);var Q;let re,Ae,_e;if(U==="exponential")re=To;else if(U==="interval")re=fr;else if(U==="categorical"){re=Jr,Ae=Object.create(null);for(const Le of f.stops)Ae[Le[0]]=Le[1];_e=typeof f.stops[0][0]}else{if(U!=="identity")throw new Error(`Unknown function type "${U}"`);re=Gn}if(I){const Le={},qe=[];for(let gt=0;gt<f.stops.length;gt++){const Dt=f.stops[gt],Lt=Dt[0].zoom;Le[Lt]===void 0&&(Le[Lt]={zoom:Lt,type:f.type,property:f.property,default:f.default,stops:[]},qe.push(Lt)),Le[Lt].stops.push([Dt[0].value,Dt[1]])}const et=[];for(const gt of qe)et.push([Le[gt].zoom,zr(Le[gt],u)]);const At={name:"linear"};return{kind:"composite",interpolationType:At,interpolationFactor:vr.interpolationFactor.bind(void 0,At),zoomStops:et.map(gt=>gt[0]),evaluate:({zoom:gt},Dt)=>To({stops:et,base:f.base},u,gt).evaluate(gt,Dt)}}if(L){const Le=U==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:Le,interpolationFactor:vr.interpolationFactor.bind(void 0,Le),zoomStops:f.stops.map(qe=>qe[0]),evaluate:({zoom:qe})=>re(f,u,qe,Ae,_e)}}return{kind:"source",evaluate(Le,qe){const et=qe&&qe.properties?qe.properties[f.property]:void 0;return et===void 0?Wa(f.default,u.default):re(f,u,et,Ae,_e)}}}function Wa(f,u,p){return f!==void 0?f:u!==void 0?u:p!==void 0?p:void 0}function Jr(f,u,p,I,L){return Wa(typeof p===L?I[p]:void 0,f.default,u.default)}function fr(f,u,p){if(Er(p)!=="number")return Wa(f.default,u.default);const I=f.stops.length;if(I===1||p<=f.stops[0][0])return f.stops[0][1];if(p>=f.stops[I-1][0])return f.stops[I-1][1];const L=Gr(f.stops.map(U=>U[0]),p);return f.stops[L][1]}function To(f,u,p){const I=f.base!==void 0?f.base:1;if(Er(p)!=="number")return Wa(f.default,u.default);const L=f.stops.length;if(L===1||p<=f.stops[0][0])return f.stops[0][1];if(p>=f.stops[L-1][0])return f.stops[L-1][1];const U=Gr(f.stops.map(Le=>Le[0]),p),Q=function(Le,qe,et,At){const gt=At-et,Dt=Le-et;return gt===0?0:qe===1?Dt/gt:(Math.pow(qe,Dt)-1)/(Math.pow(qe,gt)-1)}(p,I,f.stops[U][0],f.stops[U+1][0]),re=f.stops[U][1],Ae=f.stops[U+1][1],_e=Zs[u.type]||Ko;return typeof re.evaluate=="function"?{evaluate(...Le){const qe=re.evaluate.apply(void 0,Le),et=Ae.evaluate.apply(void 0,Le);if(qe!==void 0&&et!==void 0)return _e(qe,et,Q,f.colorSpace)}}:_e(re,Ae,Q,f.colorSpace)}function Gn(f,u,p){switch(u.type){case"color":p=Zi.parse(p);break;case"formatted":p=Wt.fromString(p.toString());break;case"resolvedImage":p=cr.fromString(p.toString());break;case"padding":p=Ki.parse(p);break;default:Er(p)===u.type||u.type==="enum"&&u.values[p]||(p=void 0)}return Wa(p,f.default,u.default)}Or.register(Wo,{error:[{kind:"error"},[Qe],(f,[u])=>{throw new Fr(u.evaluate(f))}],typeof:[Qe,[Me],(f,[u])=>ge(Vt(u.evaluate(f)))],"to-rgba":[ye(He,4),[ft],(f,[u])=>{const[p,I,L,U]=u.evaluate(f).rgb;return[255*p,255*I,255*L,U]}],rgb:[ft,[He,He,He],Co],rgba:[ft,[He,He,He,He],Co],has:{type:Ue,overloads:[[[Qe],(f,[u])=>Gs(u.evaluate(f),f.properties())],[[Qe,st],(f,[u,p])=>Gs(u.evaluate(f),p.evaluate(f))]]},get:{type:Me,overloads:[[[Qe],(f,[u])=>$o(u.evaluate(f),f.properties())],[[Qe,st],(f,[u,p])=>$o(u.evaluate(f),p.evaluate(f))]]},"feature-state":[Me,[Qe],(f,[u])=>$o(u.evaluate(f),f.featureState||{})],properties:[st,[],f=>f.properties()],"geometry-type":[Qe,[],f=>f.geometryType()],id:[Me,[],f=>f.id()],zoom:[He,[],f=>f.globals.zoom],"heatmap-density":[He,[],f=>f.globals.heatmapDensity||0],"line-progress":[He,[],f=>f.globals.lineProgress||0],accumulated:[Me,[],f=>f.globals.accumulated===void 0?null:f.globals.accumulated],"+":[He,Xo(He),(f,u)=>{let p=0;for(const I of u)p+=I.evaluate(f);return p}],"*":[He,Xo(He),(f,u)=>{let p=1;for(const I of u)p*=I.evaluate(f);return p}],"-":{type:He,overloads:[[[He,He],(f,[u,p])=>u.evaluate(f)-p.evaluate(f)],[[He],(f,[u])=>-u.evaluate(f)]]},"/":[He,[He,He],(f,[u,p])=>u.evaluate(f)/p.evaluate(f)],"%":[He,[He,He],(f,[u,p])=>u.evaluate(f)%p.evaluate(f)],ln2:[He,[],()=>Math.LN2],pi:[He,[],()=>Math.PI],e:[He,[],()=>Math.E],"^":[He,[He,He],(f,[u,p])=>Math.pow(u.evaluate(f),p.evaluate(f))],sqrt:[He,[He],(f,[u])=>Math.sqrt(u.evaluate(f))],log10:[He,[He],(f,[u])=>Math.log(u.evaluate(f))/Math.LN10],ln:[He,[He],(f,[u])=>Math.log(u.evaluate(f))],log2:[He,[He],(f,[u])=>Math.log(u.evaluate(f))/Math.LN2],sin:[He,[He],(f,[u])=>Math.sin(u.evaluate(f))],cos:[He,[He],(f,[u])=>Math.cos(u.evaluate(f))],tan:[He,[He],(f,[u])=>Math.tan(u.evaluate(f))],asin:[He,[He],(f,[u])=>Math.asin(u.evaluate(f))],acos:[He,[He],(f,[u])=>Math.acos(u.evaluate(f))],atan:[He,[He],(f,[u])=>Math.atan(u.evaluate(f))],min:[He,Xo(He),(f,u)=>Math.min(...u.map(p=>p.evaluate(f)))],max:[He,Xo(He),(f,u)=>Math.max(...u.map(p=>p.evaluate(f)))],abs:[He,[He],(f,[u])=>Math.abs(u.evaluate(f))],round:[He,[He],(f,[u])=>{const p=u.evaluate(f);return p<0?-Math.round(-p):Math.round(p)}],floor:[He,[He],(f,[u])=>Math.floor(u.evaluate(f))],ceil:[He,[He],(f,[u])=>Math.ceil(u.evaluate(f))],"filter-==":[Ue,[Qe,Me],(f,[u,p])=>f.properties()[u.value]===p.value],"filter-id-==":[Ue,[Me],(f,[u])=>f.id()===u.value],"filter-type-==":[Ue,[Qe],(f,[u])=>f.geometryType()===u.value],"filter-<":[Ue,[Qe,Me],(f,[u,p])=>{const I=f.properties()[u.value],L=p.value;return typeof I==typeof L&&I<L}],"filter-id-<":[Ue,[Me],(f,[u])=>{const p=f.id(),I=u.value;return typeof p==typeof I&&p<I}],"filter->":[Ue,[Qe,Me],(f,[u,p])=>{const I=f.properties()[u.value],L=p.value;return typeof I==typeof L&&I>L}],"filter-id->":[Ue,[Me],(f,[u])=>{const p=f.id(),I=u.value;return typeof p==typeof I&&p>I}],"filter-<=":[Ue,[Qe,Me],(f,[u,p])=>{const I=f.properties()[u.value],L=p.value;return typeof I==typeof L&&I<=L}],"filter-id-<=":[Ue,[Me],(f,[u])=>{const p=f.id(),I=u.value;return typeof p==typeof I&&p<=I}],"filter->=":[Ue,[Qe,Me],(f,[u,p])=>{const I=f.properties()[u.value],L=p.value;return typeof I==typeof L&&I>=L}],"filter-id->=":[Ue,[Me],(f,[u])=>{const p=f.id(),I=u.value;return typeof p==typeof I&&p>=I}],"filter-has":[Ue,[Me],(f,[u])=>u.value in f.properties()],"filter-has-id":[Ue,[],f=>f.id()!==null&&f.id()!==void 0],"filter-type-in":[Ue,[ye(Qe)],(f,[u])=>u.value.indexOf(f.geometryType())>=0],"filter-id-in":[Ue,[ye(Me)],(f,[u])=>u.value.indexOf(f.id())>=0],"filter-in-small":[Ue,[Qe,ye(Me)],(f,[u,p])=>p.value.indexOf(f.properties()[u.value])>=0],"filter-in-large":[Ue,[Qe,ye(Me)],(f,[u,p])=>function(I,L,U,Q){for(;U<=Q;){const re=U+Q>>1;if(L[re]===I)return!0;L[re]>I?Q=re-1:U=re+1}return!1}(f.properties()[u.value],p.value,0,p.value.length-1)],all:{type:Ue,overloads:[[[Ue,Ue],(f,[u,p])=>u.evaluate(f)&&p.evaluate(f)],[Xo(Ue),(f,u)=>{for(const p of u)if(!p.evaluate(f))return!1;return!0}]]},any:{type:Ue,overloads:[[[Ue,Ue],(f,[u,p])=>u.evaluate(f)||p.evaluate(f)],[Xo(Ue),(f,u)=>{for(const p of u)if(p.evaluate(f))return!0;return!1}]]},"!":[Ue,[Ue],(f,[u])=>!u.evaluate(f)],"is-supported-script":[Ue,[Qe],(f,[u])=>{const p=f.globals&&f.globals.isSupportedScript;return!p||p(u.evaluate(f))}],upcase:[Qe,[Qe],(f,[u])=>u.evaluate(f).toUpperCase()],downcase:[Qe,[Qe],(f,[u])=>u.evaluate(f).toLowerCase()],concat:[Qe,Xo(Me),(f,u)=>u.map(p=>hr(p.evaluate(f))).join("")],"resolved-locale":[Qe,[se],(f,[u])=>u.evaluate(f).resolvedLocale()]});class Ol{constructor(u,p){var I;this.expression=u,this._warningHistory={},this._evaluator=new Va,this._defaultValue=p?(I=p).type==="color"&&$n(I.default)?new Zi(0,0,0,0):I.type==="color"?Zi.parse(I.default)||null:I.type==="padding"?Ki.parse(I.default)||null:I.type==="variableAnchorOffsetCollection"?Tn.parse(I.default)||null:I.default===void 0?null:I.default:null,this._enumValues=p&&p.type==="enum"?p.values:null}evaluateWithoutErrorHandling(u,p,I,L,U,Q){return this._evaluator.globals=u,this._evaluator.feature=p,this._evaluator.featureState=I,this._evaluator.canonical=L,this._evaluator.availableImages=U||null,this._evaluator.formattedSection=Q,this.expression.evaluate(this._evaluator)}evaluate(u,p,I,L,U,Q){this._evaluator.globals=u,this._evaluator.feature=p||null,this._evaluator.featureState=I||null,this._evaluator.canonical=L,this._evaluator.availableImages=U||null,this._evaluator.formattedSection=Q||null;try{const re=this.expression.evaluate(this._evaluator);if(re==null||typeof re=="number"&&re!=re)return this._defaultValue;if(this._enumValues&&!(re in this._enumValues))throw new Fr(`Expected value to be one of ${Object.keys(this._enumValues).map(Ae=>JSON.stringify(Ae)).join(", ")}, but found ${JSON.stringify(re)} instead.`);return re}catch(re){return this._warningHistory[re.message]||(this._warningHistory[re.message]=!0,typeof console<"u"&&console.warn(re.message)),this._defaultValue}}}function es(f){return Array.isArray(f)&&f.length>0&&typeof f[0]=="string"&&f[0]in Wo}function Zr(f,u){const p=new Xs(Wo,qa,[],u?function(L){const U={color:ft,string:Qe,number:He,enum:Qe,boolean:Ue,formatted:ne,padding:$,resolvedImage:ie,variableAnchorOffsetCollection:de};return L.type==="array"?ye(U[L.value]||Me,L.length):U[L.type]}(u):void 0),I=p.parse(f,void 0,void 0,void 0,u&&u.type==="string"?{typeAnnotation:"coerce"}:void 0);return I?Yo(new Ol(I,u)):ba(p.errors)}class Ts{constructor(u,p){this.kind=u,this._styleExpression=p,this.isStateDependent=u!=="constant"&&!ja(p.expression)}evaluateWithoutErrorHandling(u,p,I,L,U,Q){return this._styleExpression.evaluateWithoutErrorHandling(u,p,I,L,U,Q)}evaluate(u,p,I,L,U,Q){return this._styleExpression.evaluate(u,p,I,L,U,Q)}}class kr{constructor(u,p,I,L){this.kind=u,this.zoomStops=I,this._styleExpression=p,this.isStateDependent=u!=="camera"&&!ja(p.expression),this.interpolationType=L}evaluateWithoutErrorHandling(u,p,I,L,U,Q){return this._styleExpression.evaluateWithoutErrorHandling(u,p,I,L,U,Q)}evaluate(u,p,I,L,U,Q){return this._styleExpression.evaluate(u,p,I,L,U,Q)}interpolationFactor(u,p,I){return this.interpolationType?vr.interpolationFactor(this.interpolationType,u,p,I):0}}function rr(f,u){const p=Zr(f,u);if(p.result==="error")return p;const I=p.value.expression,L=Ha(I);if(!L&&!Qa(u))return ba([new Ee("","data expressions not supported")]);const U=pl(I,["zoom"]);if(!U&&!Cs(u))return ba([new Ee("","zoom expressions not supported")]);const Q=Xr(I);return Q||U?Q instanceof Ee?ba([Q]):Q instanceof vr&&!gu(u)?ba([new Ee("",'"interpolate" expressions cannot be used with this property')]):Yo(Q?new kr(L?"camera":"composite",p.value,Q.labels,Q instanceof vr?Q.interpolation:void 0):new Ts(L?"constant":"source",p.value)):ba([new Ee("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ll{constructor(u,p){this._parameters=u,this._specification=p,Ie(this,zr(this._parameters,this._specification))}static deserialize(u){return new ll(u._parameters,u._specification)}static serialize(u){return{_parameters:u._parameters,_specification:u._specification}}}function Xr(f){let u=null;if(f instanceof Eo)u=Xr(f.result);else if(f instanceof Br){for(const p of f.args)if(u=Xr(p),u)break}else(f instanceof nr||f instanceof vr)&&f.input instanceof Or&&f.input.name==="zoom"&&(u=f);return u instanceof Ee||f.eachChild(p=>{const I=Xr(p);I instanceof Ee?u=I:!u&&I?u=new Ee("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):u&&I&&u!==I&&(u=new Ee("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),u}function ko(f){if(f===!0||f===!1)return!0;if(!Array.isArray(f)||f.length===0)return!1;switch(f[0]){case"has":return f.length>=2&&f[1]!=="$id"&&f[1]!=="$type";case"in":return f.length>=3&&(typeof f[1]!="string"||Array.isArray(f[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return f.length!==3||Array.isArray(f[1])||Array.isArray(f[2]);case"any":case"all":for(const u of f.slice(1))if(!ko(u)&&typeof u!="boolean")return!1;return!0;default:return!0}}const ul={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Qr(f){if(f==null)return{filter:()=>!0,needGeometry:!1};ko(f)||(f=Tl(f));const u=Zr(f,ul);if(u.result==="error")throw new Error(u.value.map(p=>`${p.key}: ${p.message}`).join(", "));return{filter:(p,I,L)=>u.value.evaluate(p,I,{},L),needGeometry:wa(f)}}function ds(f,u){return f<u?-1:f>u?1:0}function wa(f){if(!Array.isArray(f))return!1;if(f[0]==="within")return!0;for(let u=1;u<f.length;u++)if(wa(f[u]))return!0;return!1}function Tl(f){if(!f)return!0;const u=f[0];return f.length<=1?u!=="any":u==="=="?Mo(f[1],f[2],"=="):u==="!="?Js(Mo(f[1],f[2],"==")):u==="<"||u===">"||u==="<="||u===">="?Mo(f[1],f[2],u):u==="any"?(p=f.slice(1),["any"].concat(p.map(Tl))):u==="all"?["all"].concat(f.slice(1).map(Tl)):u==="none"?["all"].concat(f.slice(1).map(Tl).map(Js)):u==="in"?kl(f[1],f.slice(2)):u==="!in"?Js(kl(f[1],f.slice(2))):u==="has"?go(f[1]):u==="!has"?Js(go(f[1])):u!=="within"||f;var p}function Mo(f,u,p){switch(f){case"$type":return[`filter-type-${p}`,u];case"$id":return[`filter-id-${p}`,u];default:return[`filter-${p}`,f,u]}}function kl(f,u){if(u.length===0)return!1;switch(f){case"$type":return["filter-type-in",["literal",u]];case"$id":return["filter-id-in",["literal",u]];default:return u.length>200&&!u.some(p=>typeof p!=typeof u[0])?["filter-in-large",f,["literal",u.sort(ds)]]:["filter-in-small",f,["literal",u]]}}function go(f){switch(f){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",f]}}function Js(f){return["!",f]}function qs(f){const u=typeof f;if(u==="number"||u==="boolean"||u==="string"||f==null)return JSON.stringify(f);if(Array.isArray(f)){let L="[";for(const U of f)L+=`${qs(U)},`;return`${L}]`}const p=Object.keys(f).sort();let I="{";for(let L=0;L<p.length;L++)I+=`${JSON.stringify(p[L])}:${qs(f[p[L]])},`;return`${I}}`}function $a(f){let u="";for(const p of rn)u+=`/${qs(f[p])}`;return u}function Jo(f){const u=f.value;return u?[new ve(f.key,u,"constants have been deprecated as of v8")]:[]}function Yr(f){return f instanceof Number||f instanceof String||f instanceof Boolean?f.valueOf():f}function mr(f){if(Array.isArray(f))return f.map(mr);if(f instanceof Object&&!(f instanceof Number||f instanceof String||f instanceof Boolean)){const u={};for(const p in f)u[p]=mr(f[p]);return u}return Yr(f)}function Nr(f){const u=f.key,p=f.value,I=f.valueSpec||{},L=f.objectElementValidators||{},U=f.style,Q=f.styleSpec,re=f.validateSpec;let Ae=[];const _e=Er(p);if(_e!=="object")return[new ve(u,p,`object expected, ${_e} found`)];for(const Le in p){const qe=Le.split(".")[0],et=I[qe]||I["*"];let At;if(L[qe])At=L[qe];else if(I[qe])At=re;else if(L["*"])At=L["*"];else{if(!I["*"]){Ae.push(new ve(u,p[Le],`unknown property "${Le}"`));continue}At=re}Ae=Ae.concat(At({key:(u&&`${u}.`)+Le,value:p[Le],valueSpec:et,style:U,styleSpec:Q,object:p,objectKey:Le,validateSpec:re},p))}for(const Le in I)L[Le]||I[Le].required&&I[Le].default===void 0&&p[Le]===void 0&&Ae.push(new ve(u,p,`missing required property "${Le}"`));return Ae}function ha(f){const u=f.value,p=f.valueSpec,I=f.style,L=f.styleSpec,U=f.key,Q=f.arrayElementValidator||f.validateSpec;if(Er(u)!=="array")return[new ve(U,u,`array expected, ${Er(u)} found`)];if(p.length&&u.length!==p.length)return[new ve(U,u,`array length ${p.length} expected, length ${u.length} found`)];if(p["min-length"]&&u.length<p["min-length"])return[new ve(U,u,`array length at least ${p["min-length"]} expected, length ${u.length} found`)];let re={type:p.value,values:p.values};L.$version<7&&(re.function=p.function),Er(p.value)==="object"&&(re=p.value);let Ae=[];for(let _e=0;_e<u.length;_e++)Ae=Ae.concat(Q({array:u,arrayIndex:_e,value:u[_e],valueSpec:re,validateSpec:f.validateSpec,style:I,styleSpec:L,key:`${U}[${_e}]`}));return Ae}function _o(f){const u=f.key,p=f.value,I=f.valueSpec;let L=Er(p);return L==="number"&&p!=p&&(L="NaN"),L!=="number"?[new ve(u,p,`number expected, ${L} found`)]:"minimum"in I&&p<I.minimum?[new ve(u,p,`${p} is less than the minimum value ${I.minimum}`)]:"maximum"in I&&p>I.maximum?[new ve(u,p,`${p} is greater than the maximum value ${I.maximum}`)]:[]}function ea(f){const u=f.valueSpec,p=Yr(f.value.type);let I,L,U,Q={};const re=p!=="categorical"&&f.value.property===void 0,Ae=!re,_e=Er(f.value.stops)==="array"&&Er(f.value.stops[0])==="array"&&Er(f.value.stops[0][0])==="object",Le=Nr({key:f.key,value:f.value,valueSpec:f.styleSpec.function,validateSpec:f.validateSpec,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(At){if(p==="identity")return[new ve(At.key,At.value,'identity function may not have a "stops" property')];let gt=[];const Dt=At.value;return gt=gt.concat(ha({key:At.key,value:Dt,valueSpec:At.valueSpec,validateSpec:At.validateSpec,style:At.style,styleSpec:At.styleSpec,arrayElementValidator:qe})),Er(Dt)==="array"&&Dt.length===0&&gt.push(new ve(At.key,Dt,"array must have at least one stop")),gt},default:function(At){return At.validateSpec({key:At.key,value:At.value,valueSpec:u,validateSpec:At.validateSpec,style:At.style,styleSpec:At.styleSpec})}}});return p==="identity"&&re&&Le.push(new ve(f.key,f.value,'missing required property "property"')),p==="identity"||f.value.stops||Le.push(new ve(f.key,f.value,'missing required property "stops"')),p==="exponential"&&f.valueSpec.expression&&!gu(f.valueSpec)&&Le.push(new ve(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(Ae&&!Qa(f.valueSpec)?Le.push(new ve(f.key,f.value,"property functions not supported")):re&&!Cs(f.valueSpec)&&Le.push(new ve(f.key,f.value,"zoom functions not supported"))),p!=="categorical"&&!_e||f.value.property!==void 0||Le.push(new ve(f.key,f.value,'"property" property is required')),Le;function qe(At){let gt=[];const Dt=At.value,Lt=At.key;if(Er(Dt)!=="array")return[new ve(Lt,Dt,`array expected, ${Er(Dt)} found`)];if(Dt.length!==2)return[new ve(Lt,Dt,`array length 2 expected, length ${Dt.length} found`)];if(_e){if(Er(Dt[0])!=="object")return[new ve(Lt,Dt,`object expected, ${Er(Dt[0])} found`)];if(Dt[0].zoom===void 0)return[new ve(Lt,Dt,"object stop key must have zoom")];if(Dt[0].value===void 0)return[new ve(Lt,Dt,"object stop key must have value")];if(U&&U>Yr(Dt[0].zoom))return[new ve(Lt,Dt[0].zoom,"stop zoom values must appear in ascending order")];Yr(Dt[0].zoom)!==U&&(U=Yr(Dt[0].zoom),L=void 0,Q={}),gt=gt.concat(Nr({key:`${Lt}[0]`,value:Dt[0],valueSpec:{zoom:{}},validateSpec:At.validateSpec,style:At.style,styleSpec:At.styleSpec,objectElementValidators:{zoom:_o,value:et}}))}else gt=gt.concat(et({key:`${Lt}[0]`,value:Dt[0],valueSpec:{},validateSpec:At.validateSpec,style:At.style,styleSpec:At.styleSpec},Dt));return es(mr(Dt[1]))?gt.concat([new ve(`${Lt}[1]`,Dt[1],"expressions are not allowed in function stops.")]):gt.concat(At.validateSpec({key:`${Lt}[1]`,value:Dt[1],valueSpec:u,validateSpec:At.validateSpec,style:At.style,styleSpec:At.styleSpec}))}function et(At,gt){const Dt=Er(At.value),Lt=Yr(At.value),Rt=At.value!==null?At.value:gt;if(I){if(Dt!==I)return[new ve(At.key,Rt,`${Dt} stop domain type must match previous stop domain type ${I}`)]}else I=Dt;if(Dt!=="number"&&Dt!=="string"&&Dt!=="boolean")return[new ve(At.key,Rt,"stop domain value must be a number, string, or boolean")];if(Dt!=="number"&&p!=="categorical"){let Kt=`number expected, ${Dt} found`;return Qa(u)&&p===void 0&&(Kt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ve(At.key,Rt,Kt)]}return p!=="categorical"||Dt!=="number"||isFinite(Lt)&&Math.floor(Lt)===Lt?p!=="categorical"&&Dt==="number"&&L!==void 0&&Lt<L?[new ve(At.key,Rt,"stop domain values must appear in ascending order")]:(L=Lt,p==="categorical"&&Lt in Q?[new ve(At.key,Rt,"stop domain values must be unique")]:(Q[Lt]=!0,[])):[new ve(At.key,Rt,`integer expected, found ${Lt}`)]}}function Sa(f){const u=(f.expressionContext==="property"?rr:Zr)(mr(f.value),f.valueSpec);if(u.result==="error")return u.value.map(I=>new ve(`${f.key}${I.key}`,f.value,I.message));const p=u.value.expression||u.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!p.outputDefined())return[new ve(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!ja(p))return[new ve(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter"&&!ja(p))return[new ve(f.key,f.value,'"feature-state" data expressions are not supported with filters.')];if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!pl(p,["zoom","feature-state"]))return[new ve(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!Ha(p))return[new ve(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ka(f){const u=f.key,p=f.value,I=f.valueSpec,L=[];return Array.isArray(I.values)?I.values.indexOf(Yr(p))===-1&&L.push(new ve(u,p,`expected one of [${I.values.join(", ")}], ${JSON.stringify(p)} found`)):Object.keys(I.values).indexOf(Yr(p))===-1&&L.push(new ve(u,p,`expected one of [${Object.keys(I.values).join(", ")}], ${JSON.stringify(p)} found`)),L}function Xa(f){return ko(mr(f.value))?Sa(Ie({},f,{expressionContext:"filter",valueSpec:{value:"boolean"}})):cl(f)}function cl(f){const u=f.value,p=f.key;if(Er(u)!=="array")return[new ve(p,u,`array expected, ${Er(u)} found`)];const I=f.styleSpec;let L,U=[];if(u.length<1)return[new ve(p,u,"filter array must have at least 1 element")];switch(U=U.concat(ka({key:`${p}[0]`,value:u[0],valueSpec:I.filter_operator,style:f.style,styleSpec:f.styleSpec})),Yr(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&Yr(u[1])==="$type"&&U.push(new ve(p,u,`"$type" cannot be use with operator "${u[0]}"`));case"==":case"!=":u.length!==3&&U.push(new ve(p,u,`filter array for operator "${u[0]}" must have 3 elements`));case"in":case"!in":u.length>=2&&(L=Er(u[1]),L!=="string"&&U.push(new ve(`${p}[1]`,u[1],`string expected, ${L} found`)));for(let Q=2;Q<u.length;Q++)L=Er(u[Q]),Yr(u[1])==="$type"?U=U.concat(ka({key:`${p}[${Q}]`,value:u[Q],valueSpec:I.geometry_type,style:f.style,styleSpec:f.styleSpec})):L!=="string"&&L!=="number"&&L!=="boolean"&&U.push(new ve(`${p}[${Q}]`,u[Q],`string, number, or boolean expected, ${L} found`));break;case"any":case"all":case"none":for(let Q=1;Q<u.length;Q++)U=U.concat(cl({key:`${p}[${Q}]`,value:u[Q],style:f.style,styleSpec:f.styleSpec}));break;case"has":case"!has":L=Er(u[1]),u.length!==2?U.push(new ve(p,u,`filter array for "${u[0]}" operator must have 2 elements`)):L!=="string"&&U.push(new ve(`${p}[1]`,u[1],`string expected, ${L} found`));break;case"within":L=Er(u[1]),u.length!==2?U.push(new ve(p,u,`filter array for "${u[0]}" operator must have 2 elements`)):L!=="object"&&U.push(new ve(`${p}[1]`,u[1],`object expected, ${L} found`))}return U}function lu(f,u){const p=f.key,I=f.validateSpec,L=f.style,U=f.styleSpec,Q=f.value,re=f.objectKey,Ae=U[`${u}_${f.layerType}`];if(!Ae)return[];const _e=re.match(/^(.*)-transition$/);if(u==="paint"&&_e&&Ae[_e[1]]&&Ae[_e[1]].transition)return I({key:p,value:Q,valueSpec:U.transition,style:L,styleSpec:U});const Le=f.valueSpec||Ae[re];if(!Le)return[new ve(p,Q,`unknown property "${re}"`)];let qe;if(Er(Q)==="string"&&Qa(Le)&&!Le.tokens&&(qe=/^{([^}]+)}$/.exec(Q)))return[new ve(p,Q,`"${re}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(qe[1])} }\`.`)];const et=[];return f.layerType==="symbol"&&(re==="text-field"&&L&&!L.glyphs&&et.push(new ve(p,Q,'use of "text-field" requires a style "glyphs" property')),re==="text-font"&&$n(mr(Q))&&Yr(Q.type)==="identity"&&et.push(new ve(p,Q,'"text-font" does not support identity functions'))),et.concat(I({key:f.key,value:Q,valueSpec:Le,style:L,styleSpec:U,expressionContext:"property",propertyType:u,propertyKey:re}))}function gl(f){return lu(f,"paint")}function ao(f){return lu(f,"layout")}function pi(f){let u=[];const p=f.value,I=f.key,L=f.style,U=f.styleSpec;p.type||p.ref||u.push(new ve(I,p,'either "type" or "ref" is required'));let Q=Yr(p.type);const re=Yr(p.ref);if(p.id){const Ae=Yr(p.id);for(let _e=0;_e<f.arrayIndex;_e++){const Le=L.layers[_e];Yr(Le.id)===Ae&&u.push(new ve(I,p.id,`duplicate layer id "${p.id}", previously used at line ${Le.id.__line__}`))}}if("ref"in p){let Ae;["type","source","source-layer","filter","layout"].forEach(_e=>{_e in p&&u.push(new ve(I,p[_e],`"${_e}" is prohibited for ref layers`))}),L.layers.forEach(_e=>{Yr(_e.id)===re&&(Ae=_e)}),Ae?Ae.ref?u.push(new ve(I,p.ref,"ref cannot reference another ref layer")):Q=Yr(Ae.type):u.push(new ve(I,p.ref,`ref layer "${re}" not found`))}else if(Q!=="background")if(p.source){const Ae=L.sources&&L.sources[p.source],_e=Ae&&Yr(Ae.type);Ae?_e==="vector"&&Q==="raster"?u.push(new ve(I,p.source,`layer "${p.id}" requires a raster source`)):_e!=="raster-dem"&&Q==="hillshade"?u.push(new ve(I,p.source,`layer "${p.id}" requires a raster-dem source`)):_e==="raster"&&Q!=="raster"?u.push(new ve(I,p.source,`layer "${p.id}" requires a vector source`)):_e!=="vector"||p["source-layer"]?_e==="raster-dem"&&Q!=="hillshade"?u.push(new ve(I,p.source,"raster-dem source can only be used with layer type 'hillshade'.")):Q!=="line"||!p.paint||!p.paint["line-gradient"]||_e==="geojson"&&Ae.lineMetrics||u.push(new ve(I,p,`layer "${p.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):u.push(new ve(I,p,`layer "${p.id}" must specify a "source-layer"`)):u.push(new ve(I,p.source,`source "${p.source}" not found`))}else u.push(new ve(I,p,'missing required property "source"'));return u=u.concat(Nr({key:I,value:p,valueSpec:U.layer,style:f.style,styleSpec:f.styleSpec,validateSpec:f.validateSpec,objectElementValidators:{"*":()=>[],type:()=>f.validateSpec({key:`${I}.type`,value:p.type,valueSpec:U.layer.type,style:f.style,styleSpec:f.styleSpec,validateSpec:f.validateSpec,object:p,objectKey:"type"}),filter:Xa,layout:Ae=>Nr({layer:p,key:Ae.key,value:Ae.value,style:Ae.style,styleSpec:Ae.styleSpec,validateSpec:Ae.validateSpec,objectElementValidators:{"*":_e=>ao(Ie({layerType:Q},_e))}}),paint:Ae=>Nr({layer:p,key:Ae.key,value:Ae.value,style:Ae.style,styleSpec:Ae.styleSpec,validateSpec:Ae.validateSpec,objectElementValidators:{"*":_e=>gl(Ie({layerType:Q},_e))}})}})),u}function Ui(f){const u=f.value,p=f.key,I=Er(u);return I!=="string"?[new ve(p,u,`string expected, ${I} found`)]:[]}const Di={promoteId:function({key:f,value:u}){if(Er(u)==="string")return Ui({key:f,value:u});{const p=[];for(const I in u)p.push(...Ui({key:`${f}.${I}`,value:u[I]}));return p}}};function Ft(f){const u=f.value,p=f.key,I=f.styleSpec,L=f.style,U=f.validateSpec;if(!u.type)return[new ve(p,u,'"type" is required')];const Q=Yr(u.type);let re;switch(Q){case"vector":case"raster":return re=Nr({key:p,value:u,valueSpec:I[`source_${Q.replace("-","_")}`],style:f.style,styleSpec:I,objectElementValidators:Di,validateSpec:U}),re;case"raster-dem":return re=function(Ae){var _e;const Le=(_e=Ae.sourceName)!==null&&_e!==void 0?_e:"",qe=Ae.value,et=Ae.styleSpec,At=et.source_raster_dem,gt=Ae.style;let Dt=[];const Lt=Er(qe);if(qe===void 0)return Dt;if(Lt!=="object")return Dt.push(new ve("source_raster_dem",qe,`object expected, ${Lt} found`)),Dt;const Rt=Yr(qe.encoding)==="custom",Kt=["redFactor","greenFactor","blueFactor","baseShift"],Ht=Ae.value.encoding?`"${Ae.value.encoding}"`:"Default";for(const Qt in qe)!Rt&&Kt.includes(Qt)?Dt.push(new ve(Qt,qe[Qt],`In "${Le}": "${Qt}" is only valid when "encoding" is set to "custom". ${Ht} encoding found`)):At[Qt]?Dt=Dt.concat(Ae.validateSpec({key:Qt,value:qe[Qt],valueSpec:At[Qt],validateSpec:Ae.validateSpec,style:gt,styleSpec:et})):Dt.push(new ve(Qt,qe[Qt],`unknown property "${Qt}"`));return Dt}({sourceName:p,value:u,style:f.style,styleSpec:I,validateSpec:U}),re;case"geojson":if(re=Nr({key:p,value:u,valueSpec:I.source_geojson,style:L,styleSpec:I,validateSpec:U,objectElementValidators:Di}),u.cluster)for(const Ae in u.clusterProperties){const[_e,Le]=u.clusterProperties[Ae],qe=typeof _e=="string"?[_e,["accumulated"],["get",Ae]]:_e;re.push(...Sa({key:`${p}.${Ae}.map`,value:Le,validateSpec:U,expressionContext:"cluster-map"})),re.push(...Sa({key:`${p}.${Ae}.reduce`,value:qe,validateSpec:U,expressionContext:"cluster-reduce"}))}return re;case"video":return Nr({key:p,value:u,valueSpec:I.source_video,style:L,validateSpec:U,styleSpec:I});case"image":return Nr({key:p,value:u,valueSpec:I.source_image,style:L,validateSpec:U,styleSpec:I});case"canvas":return[new ve(p,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ka({key:`${p}.type`,value:u.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:L,validateSpec:U,styleSpec:I})}}function ii(f){const u=f.value,p=f.styleSpec,I=p.light,L=f.style;let U=[];const Q=Er(u);if(u===void 0)return U;if(Q!=="object")return U=U.concat([new ve("light",u,`object expected, ${Q} found`)]),U;for(const re in u){const Ae=re.match(/^(.*)-transition$/);U=U.concat(Ae&&I[Ae[1]]&&I[Ae[1]].transition?f.validateSpec({key:re,value:u[re],valueSpec:p.transition,validateSpec:f.validateSpec,style:L,styleSpec:p}):I[re]?f.validateSpec({key:re,value:u[re],valueSpec:I[re],validateSpec:f.validateSpec,style:L,styleSpec:p}):[new ve(re,u[re],`unknown property "${re}"`)])}return U}function bi(f){const u=f.value,p=f.styleSpec,I=p.terrain,L=f.style;let U=[];const Q=Er(u);if(u===void 0)return U;if(Q!=="object")return U=U.concat([new ve("terrain",u,`object expected, ${Q} found`)]),U;for(const re in u)U=U.concat(I[re]?f.validateSpec({key:re,value:u[re],valueSpec:I[re],validateSpec:f.validateSpec,style:L,styleSpec:p}):[new ve(re,u[re],`unknown property "${re}"`)]);return U}function Fi(f){let u=[];const p=f.value,I=f.key;if(Array.isArray(p)){const L=[],U=[];for(const Q in p)p[Q].id&&L.includes(p[Q].id)&&u.push(new ve(I,p,`all the sprites' ids must be unique, but ${p[Q].id} is duplicated`)),L.push(p[Q].id),p[Q].url&&U.includes(p[Q].url)&&u.push(new ve(I,p,`all the sprites' URLs must be unique, but ${p[Q].url} is duplicated`)),U.push(p[Q].url),u=u.concat(Nr({key:`${I}[${Q}]`,value:p[Q],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:f.validateSpec}));return u}return Ui({key:I,value:p})}const Bn={"*":()=>[],array:ha,boolean:function(f){const u=f.value,p=f.key,I=Er(u);return I!=="boolean"?[new ve(p,u,`boolean expected, ${I} found`)]:[]},number:_o,color:function(f){const u=f.key,p=f.value,I=Er(p);return I!=="string"?[new ve(u,p,`color expected, ${I} found`)]:Zi.parse(String(p))?[]:[new ve(u,p,`color expected, "${p}" found`)]},constants:Jo,enum:ka,filter:Xa,function:ea,layer:pi,object:Nr,source:Ft,light:ii,terrain:bi,string:Ui,formatted:function(f){return Ui(f).length===0?[]:Sa(f)},resolvedImage:function(f){return Ui(f).length===0?[]:Sa(f)},padding:function(f){const u=f.key,p=f.value;if(Er(p)==="array"){if(p.length<1||p.length>4)return[new ve(u,p,`padding requires 1 to 4 values; ${p.length} values found`)];const I={type:"number"};let L=[];for(let U=0;U<p.length;U++)L=L.concat(f.validateSpec({key:`${u}[${U}]`,value:p[U],validateSpec:f.validateSpec,valueSpec:I}));return L}return _o({key:u,value:p,valueSpec:{}})},variableAnchorOffsetCollection:function(f){const u=f.key,p=f.value,I=Er(p),L=f.styleSpec;if(I!=="array"||p.length<1||p.length%2!=0)return[new ve(u,p,"variableAnchorOffsetCollection requires a non-empty array of even length")];let U=[];for(let Q=0;Q<p.length;Q+=2)U=U.concat(ka({key:`${u}[${Q}]`,value:p[Q],valueSpec:L.layout_symbol["text-anchor"]})),U=U.concat(ha({key:`${u}[${Q+1}]`,value:p[Q+1],valueSpec:{length:2,value:"number"},validateSpec:f.validateSpec,style:f.style,styleSpec:L}));return U},sprite:Fi};function Hn(f){const u=f.value,p=f.valueSpec,I=f.styleSpec;return f.validateSpec=Hn,p.expression&&$n(Yr(u))?ea(f):p.expression&&es(mr(u))?Sa(f):p.type&&Bn[p.type]?Bn[p.type](f):Nr(Ie({},f,{valueSpec:p.type?I[p.type]:p}))}function lr(f){const u=f.value,p=f.key,I=Ui(f);return I.length||(u.indexOf("{fontstack}")===-1&&I.push(new ve(p,u,'"glyphs" url must include a "{fontstack}" token')),u.indexOf("{range}")===-1&&I.push(new ve(p,u,'"glyphs" url must include a "{range}" token'))),I}function Xn(f,u=ci){let p=[];return p=p.concat(Hn({key:"",value:f,valueSpec:u.$root,styleSpec:u,style:f,validateSpec:Hn,objectElementValidators:{glyphs:lr,"*":()=>[]}})),f.constants&&(p=p.concat(Jo({key:"constants",value:f.constants,style:f,styleSpec:u,validateSpec:Hn}))),ks(p)}function Hs(f){return function(u){return f({...u,validateSpec:Hn})}}function ks(f){return[].concat(f).sort((u,p)=>u.line-p.line)}function ps(f){return function(...u){return ks(f.apply(this,u))}}Xn.source=ps(Hs(Ft)),Xn.sprite=ps(Hs(Fi)),Xn.glyphs=ps(Hs(lr)),Xn.light=ps(Hs(ii)),Xn.terrain=ps(Hs(bi)),Xn.layer=ps(Hs(pi)),Xn.filter=ps(Hs(Xa)),Xn.paintProperty=ps(Hs(gl)),Xn.layoutProperty=ps(Hs(ao));const Ya=Xn,yo=Ya.light,rs=Ya.paintProperty,Wu=Ya.layoutProperty;function Ru(f,u){let p=!1;if(u&&u.length)for(const I of u)f.fire(new _n(new Error(I.message))),p=!0;return p}class vo{constructor(u,p,I){const L=this.cells=[];if(u instanceof ArrayBuffer){this.arrayBuffer=u;const Q=new Int32Array(this.arrayBuffer);u=Q[0],this.d=(p=Q[1])+2*(I=Q[2]);for(let Ae=0;Ae<this.d*this.d;Ae++){const _e=Q[3+Ae],Le=Q[3+Ae+1];L.push(_e===Le?null:Q.subarray(_e,Le))}const re=Q[3+L.length+1];this.keys=Q.subarray(Q[3+L.length],re),this.bboxes=Q.subarray(re),this.insert=this._insertReadonly}else{this.d=p+2*I;for(let Q=0;Q<this.d*this.d;Q++)L.push([]);this.keys=[],this.bboxes=[]}this.n=p,this.extent=u,this.padding=I,this.scale=p/u,this.uid=0;const U=I/p*u;this.min=-U,this.max=u+U}insert(u,p,I,L,U){this._forEachCell(p,I,L,U,this._insertCell,this.uid++,void 0,void 0),this.keys.push(u),this.bboxes.push(p),this.bboxes.push(I),this.bboxes.push(L),this.bboxes.push(U)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(u,p,I,L,U,Q){this.cells[U].push(Q)}query(u,p,I,L,U){const Q=this.min,re=this.max;if(u<=Q&&p<=Q&&re<=I&&re<=L&&!U)return Array.prototype.slice.call(this.keys);{const Ae=[];return this._forEachCell(u,p,I,L,this._queryCell,Ae,{},U),Ae}}_queryCell(u,p,I,L,U,Q,re,Ae){const _e=this.cells[U];if(_e!==null){const Le=this.keys,qe=this.bboxes;for(let et=0;et<_e.length;et++){const At=_e[et];if(re[At]===void 0){const gt=4*At;(Ae?Ae(qe[gt+0],qe[gt+1],qe[gt+2],qe[gt+3]):u<=qe[gt+2]&&p<=qe[gt+3]&&I>=qe[gt+0]&&L>=qe[gt+1])?(re[At]=!0,Q.push(Le[At])):re[At]=!1}}}}_forEachCell(u,p,I,L,U,Q,re,Ae){const _e=this._convertToCellCoord(u),Le=this._convertToCellCoord(p),qe=this._convertToCellCoord(I),et=this._convertToCellCoord(L);for(let At=_e;At<=qe;At++)for(let gt=Le;gt<=et;gt++){const Dt=this.d*gt+At;if((!Ae||Ae(this._convertFromCellCoord(At),this._convertFromCellCoord(gt),this._convertFromCellCoord(At+1),this._convertFromCellCoord(gt+1)))&&U.call(this,u,p,I,L,Dt,Q,re,Ae))return}}_convertFromCellCoord(u){return(u-this.padding)/this.scale}_convertToCellCoord(u){return Math.max(0,Math.min(this.d-1,Math.floor(u*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const u=this.cells,p=3+this.cells.length+1+1;let I=0;for(let Q=0;Q<this.cells.length;Q++)I+=this.cells[Q].length;const L=new Int32Array(p+I+this.keys.length+this.bboxes.length);L[0]=this.extent,L[1]=this.n,L[2]=this.padding;let U=p;for(let Q=0;Q<u.length;Q++){const re=u[Q];L[3+Q]=U,L.set(re,U),U+=re.length}return L[3+u.length]=U,L.set(this.keys,U),U+=this.keys.length,L[3+u.length+1]=U,L.set(this.bboxes,U),U+=this.bboxes.length,L.buffer}static serialize(u,p){const I=u.toArrayBuffer();return p&&p.push(I),{buffer:I}}static deserialize(u){return new vo(u.buffer)}}const Ml={};function Dn(f,u,p={}){if(Ml[f])throw new Error(`${f} is already registered.`);Object.defineProperty(u,"_classRegistryKey",{value:f,writeable:!1}),Ml[f]={klass:u,omit:p.omit||[],shallow:p.shallow||[]}}Dn("Object",Object),Dn("TransferableGridIndex",vo),Dn("Color",Zi),Dn("Error",Error),Dn("AJAXError",vn),Dn("ResolvedImage",cr),Dn("StylePropertyFunction",ll),Dn("StyleExpression",Ol,{omit:["_evaluator"]}),Dn("ZoomDependentExpression",kr),Dn("ZoomConstantExpression",Ts),Dn("CompoundExpression",Or,{omit:["_evaluate"]});for(const f in Wo)Wo[f]._classRegistryKey||Dn(`Expression_${f}`,Wo[f]);function Ma(f){return f&&typeof ArrayBuffer<"u"&&(f instanceof ArrayBuffer||f.constructor&&f.constructor.name==="ArrayBuffer")}function Sn(f,u){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob)return f;if(Ma(f)||Ot(f))return u&&u.push(f),f;if(ArrayBuffer.isView(f)){const p=f;return u&&u.push(p.buffer),p}if(f instanceof ImageData)return u&&u.push(f.data.buffer),f;if(Array.isArray(f)){const p=[];for(const I of f)p.push(Sn(I,u));return p}if(typeof f=="object"){const p=f.constructor,I=p._classRegistryKey;if(!I)throw new Error("can't serialize object of unregistered class");if(!Ml[I])throw new Error(`${I} is not registered.`);const L=p.serialize?p.serialize(f,u):{};if(p.serialize){if(u&&L===u[u.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const U in f){if(!f.hasOwnProperty(U)||Ml[I].omit.indexOf(U)>=0)continue;const Q=f[U];L[U]=Ml[I].shallow.indexOf(U)>=0?Q:Sn(Q,u)}f instanceof Error&&(L.message=f.message)}if(L.$name)throw new Error("$name property is reserved for worker serialization logic.");return I!=="Object"&&(L.$name=I),L}throw new Error("can't serialize object of type "+typeof f)}function No(f){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob||Ma(f)||Ot(f)||ArrayBuffer.isView(f)||f instanceof ImageData)return f;if(Array.isArray(f))return f.map(No);if(typeof f=="object"){const u=f.$name||"Object";if(!Ml[u])throw new Error(`can't deserialize unregistered class ${u}`);const{klass:p}=Ml[u];if(!p)throw new Error(`can't deserialize unregistered class ${u}`);if(p.deserialize)return p.deserialize(f);const I=Object.create(p.prototype);for(const L of Object.keys(f)){if(L==="$name")continue;const U=f[L];I[L]=Ml[u].shallow.indexOf(L)>=0?U:No(U)}return I}throw new Error("can't deserialize object of type "+typeof f)}class Nl{constructor(){this.first=!0}update(u,p){const I=Math.floor(u);return this.first?(this.first=!1,this.lastIntegerZoom=I,this.lastIntegerZoomTime=0,this.lastZoom=u,this.lastFloorZoom=I,!0):(this.lastFloorZoom>I?(this.lastIntegerZoom=I+1,this.lastIntegerZoomTime=p):this.lastFloorZoom<I&&(this.lastIntegerZoom=I,this.lastIntegerZoomTime=p),u!==this.lastZoom&&(this.lastZoom=u,this.lastFloorZoom=I,!0))}}const En={"Latin-1 Supplement":f=>f>=128&&f<=255,Arabic:f=>f>=1536&&f<=1791,"Arabic Supplement":f=>f>=1872&&f<=1919,"Arabic Extended-A":f=>f>=2208&&f<=2303,"Hangul Jamo":f=>f>=4352&&f<=4607,"Unified Canadian Aboriginal Syllabics":f=>f>=5120&&f<=5759,Khmer:f=>f>=6016&&f<=6143,"Unified Canadian Aboriginal Syllabics Extended":f=>f>=6320&&f<=6399,"General Punctuation":f=>f>=8192&&f<=8303,"Letterlike Symbols":f=>f>=8448&&f<=8527,"Number Forms":f=>f>=8528&&f<=8591,"Miscellaneous Technical":f=>f>=8960&&f<=9215,"Control Pictures":f=>f>=9216&&f<=9279,"Optical Character Recognition":f=>f>=9280&&f<=9311,"Enclosed Alphanumerics":f=>f>=9312&&f<=9471,"Geometric Shapes":f=>f>=9632&&f<=9727,"Miscellaneous Symbols":f=>f>=9728&&f<=9983,"Miscellaneous Symbols and Arrows":f=>f>=11008&&f<=11263,"CJK Radicals Supplement":f=>f>=11904&&f<=12031,"Kangxi Radicals":f=>f>=12032&&f<=12255,"Ideographic Description Characters":f=>f>=12272&&f<=12287,"CJK Symbols and Punctuation":f=>f>=12288&&f<=12351,Hiragana:f=>f>=12352&&f<=12447,Katakana:f=>f>=12448&&f<=12543,Bopomofo:f=>f>=12544&&f<=12591,"Hangul Compatibility Jamo":f=>f>=12592&&f<=12687,Kanbun:f=>f>=12688&&f<=12703,"Bopomofo Extended":f=>f>=12704&&f<=12735,"CJK Strokes":f=>f>=12736&&f<=12783,"Katakana Phonetic Extensions":f=>f>=12784&&f<=12799,"Enclosed CJK Letters and Months":f=>f>=12800&&f<=13055,"CJK Compatibility":f=>f>=13056&&f<=13311,"CJK Unified Ideographs Extension A":f=>f>=13312&&f<=19903,"Yijing Hexagram Symbols":f=>f>=19904&&f<=19967,"CJK Unified Ideographs":f=>f>=19968&&f<=40959,"Yi Syllables":f=>f>=40960&&f<=42127,"Yi Radicals":f=>f>=42128&&f<=42191,"Hangul Jamo Extended-A":f=>f>=43360&&f<=43391,"Hangul Syllables":f=>f>=44032&&f<=55215,"Hangul Jamo Extended-B":f=>f>=55216&&f<=55295,"Private Use Area":f=>f>=57344&&f<=63743,"CJK Compatibility Ideographs":f=>f>=63744&&f<=64255,"Arabic Presentation Forms-A":f=>f>=64336&&f<=65023,"Vertical Forms":f=>f>=65040&&f<=65055,"CJK Compatibility Forms":f=>f>=65072&&f<=65103,"Small Form Variants":f=>f>=65104&&f<=65135,"Arabic Presentation Forms-B":f=>f>=65136&&f<=65279,"Halfwidth and Fullwidth Forms":f=>f>=65280&&f<=65519};function Wl(f){for(const u of f)if(uu(u.charCodeAt(0)))return!0;return!1}function Cn(f){for(const u of f)if(!_l(u.charCodeAt(0)))return!1;return!0}function _l(f){return!(En.Arabic(f)||En["Arabic Supplement"](f)||En["Arabic Extended-A"](f)||En["Arabic Presentation Forms-A"](f)||En["Arabic Presentation Forms-B"](f))}function uu(f){return!(f!==746&&f!==747&&(f<4352||!(En["Bopomofo Extended"](f)||En.Bopomofo(f)||En["CJK Compatibility Forms"](f)&&!(f>=65097&&f<=65103)||En["CJK Compatibility Ideographs"](f)||En["CJK Compatibility"](f)||En["CJK Radicals Supplement"](f)||En["CJK Strokes"](f)||!(!En["CJK Symbols and Punctuation"](f)||f>=12296&&f<=12305||f>=12308&&f<=12319||f===12336)||En["CJK Unified Ideographs Extension A"](f)||En["CJK Unified Ideographs"](f)||En["Enclosed CJK Letters and Months"](f)||En["Hangul Compatibility Jamo"](f)||En["Hangul Jamo Extended-A"](f)||En["Hangul Jamo Extended-B"](f)||En["Hangul Jamo"](f)||En["Hangul Syllables"](f)||En.Hiragana(f)||En["Ideographic Description Characters"](f)||En.Kanbun(f)||En["Kangxi Radicals"](f)||En["Katakana Phonetic Extensions"](f)||En.Katakana(f)&&f!==12540||!(!En["Halfwidth and Fullwidth Forms"](f)||f===65288||f===65289||f===65293||f>=65306&&f<=65310||f===65339||f===65341||f===65343||f>=65371&&f<=65503||f===65507||f>=65512&&f<=65519)||!(!En["Small Form Variants"](f)||f>=65112&&f<=65118||f>=65123&&f<=65126)||En["Unified Canadian Aboriginal Syllabics"](f)||En["Unified Canadian Aboriginal Syllabics Extended"](f)||En["Vertical Forms"](f)||En["Yijing Hexagram Symbols"](f)||En["Yi Syllables"](f)||En["Yi Radicals"](f))))}function Fu(f){return!(uu(f)||function(u){return!!(En["Latin-1 Supplement"](u)&&(u===167||u===169||u===174||u===177||u===188||u===189||u===190||u===215||u===247)||En["General Punctuation"](u)&&(u===8214||u===8224||u===8225||u===8240||u===8241||u===8251||u===8252||u===8258||u===8263||u===8264||u===8265||u===8273)||En["Letterlike Symbols"](u)||En["Number Forms"](u)||En["Miscellaneous Technical"](u)&&(u>=8960&&u<=8967||u>=8972&&u<=8991||u>=8996&&u<=9e3||u===9003||u>=9085&&u<=9114||u>=9150&&u<=9165||u===9167||u>=9169&&u<=9179||u>=9186&&u<=9215)||En["Control Pictures"](u)&&u!==9251||En["Optical Character Recognition"](u)||En["Enclosed Alphanumerics"](u)||En["Geometric Shapes"](u)||En["Miscellaneous Symbols"](u)&&!(u>=9754&&u<=9759)||En["Miscellaneous Symbols and Arrows"](u)&&(u>=11026&&u<=11055||u>=11088&&u<=11097||u>=11192&&u<=11243)||En["CJK Symbols and Punctuation"](u)||En.Katakana(u)||En["Private Use Area"](u)||En["CJK Compatibility Forms"](u)||En["Small Form Variants"](u)||En["Halfwidth and Fullwidth Forms"](u)||u===8734||u===8756||u===8757||u>=9984&&u<=10087||u>=10102&&u<=10131||u===65532||u===65533)}(f))}function Vl(f){return f>=1424&&f<=2303||En["Arabic Presentation Forms-A"](f)||En["Arabic Presentation Forms-B"](f)}function yl(f,u){return!(!u&&Vl(f)||f>=2304&&f<=3583||f>=3840&&f<=4255||En.Khmer(f))}function ta(f){for(const u of f)if(Vl(u.charCodeAt(0)))return!0;return!1}const oc="deferred",$u="loading",$l="loaded";let ms=null,_a="unavailable",el=null;const _u=function(f){f&&typeof f=="string"&&f.indexOf("NetworkError")>-1&&(_a="error"),ms&&ms(f)};function Ou(){cu.fire(new ei("pluginStateChange",{pluginStatus:_a,pluginURL:el}))}const cu=new Pr,Nu=function(){return _a},_r=function(){if(_a!==oc||!el)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");_a=$u,Ou(),el&&_i({url:el},f=>{f?_u(f):(_a=$l,Ou())})},gs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>_a===$l||gs.applyArabicShaping!=null,isLoading:()=>_a===$u,setState(f){if(!Nt())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");_a=f.pluginStatus,el=f.pluginURL},isParsed(){if(!Nt())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return gs.applyArabicShaping!=null&&gs.processBidirectionalText!=null&&gs.processStyledBidirectionalText!=null},getPluginURL(){if(!Nt())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return el}};class gn{constructor(u,p){this.zoom=u,p?(this.now=p.now,this.fadeDuration=p.fadeDuration,this.zoomHistory=p.zoomHistory,this.transition=p.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Nl,this.transition={})}isSupportedScript(u){return function(p,I){for(const L of p)if(!yl(L.charCodeAt(0),I))return!1;return!0}(u,gs.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const u=this.zoom,p=u-Math.floor(u),I=this.crossFadingFactor();return u>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:p+(1-p)*I}:{fromScale:.5,toScale:1,t:1-(1-I)*p}}}class jn{constructor(u,p){this.property=u,this.value=p,this.expression=function(I,L){if($n(I))return new ll(I,L);if(es(I)){const U=rr(I,L);if(U.result==="error")throw new Error(U.value.map(Q=>`${Q.key}: ${Q.message}`).join(", "));return U.value}{let U=I;return L.type==="color"&&typeof I=="string"?U=Zi.parse(I):L.type!=="padding"||typeof I!="number"&&!Array.isArray(I)?L.type==="variableAnchorOffsetCollection"&&Array.isArray(I)&&(U=Tn.parse(I)):U=Ki.parse(I),{kind:"constant",evaluate:()=>U}}}(p===void 0?u.specification.default:p,u.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(u,p,I){return this.property.possiblyEvaluate(this,u,p,I)}}class Jn{constructor(u){this.property=u,this.value=new jn(u,void 0)}transitioned(u,p){return new Tu(this.property,this.value,p,it({},u.transition,this.transition),u.now)}untransitioned(){return new Tu(this.property,this.value,null,{},0)}}class tl{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitionablePropertyValues)}getValue(u){return Pt(this._values[u].value.value)}setValue(u,p){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new Jn(this._values[u].property)),this._values[u].value=new jn(this._values[u].property,p===null?void 0:Pt(p))}getTransition(u){return Pt(this._values[u].transition)}setTransition(u,p){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new Jn(this._values[u].property)),this._values[u].transition=Pt(p)||void 0}serialize(){const u={};for(const p of Object.keys(this._values)){const I=this.getValue(p);I!==void 0&&(u[p]=I);const L=this.getTransition(p);L!==void 0&&(u[`${p}-transition`]=L)}return u}transitioned(u,p){const I=new oa(this._properties);for(const L of Object.keys(this._values))I._values[L]=this._values[L].transitioned(u,p._values[L]);return I}untransitioned(){const u=new oa(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].untransitioned();return u}}class Tu{constructor(u,p,I,L,U){this.property=u,this.value=p,this.begin=U+L.delay||0,this.end=this.begin+L.duration||0,u.specification.transition&&(L.delay||L.duration)&&(this.prior=I)}possiblyEvaluate(u,p,I){const L=u.now||0,U=this.value.possiblyEvaluate(u,p,I),Q=this.prior;if(Q){if(L>this.end)return this.prior=null,U;if(this.value.isDataDriven())return this.prior=null,U;if(L<this.begin)return Q.possiblyEvaluate(u,p,I);{const re=(L-this.begin)/(this.end-this.begin);return this.property.interpolate(Q.possiblyEvaluate(u,p,I),U,function(Ae){if(Ae<=0)return 0;if(Ae>=1)return 1;const _e=Ae*Ae,Le=_e*Ae;return 4*(Ae<.5?Le:3*(Ae-_e)+Le-.75)}(re))}}return U}}class oa{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitioningPropertyValues)}possiblyEvaluate(u,p,I){const L=new Po(this._properties);for(const U of Object.keys(this._values))L._values[U]=this._values[U].possiblyEvaluate(u,p,I);return L}hasTransition(){for(const u of Object.keys(this._values))if(this._values[u].prior)return!0;return!1}}class yu{constructor(u){this._properties=u,this._values=Object.create(u.defaultPropertyValues)}hasValue(u){return this._values[u].value!==void 0}getValue(u){return Pt(this._values[u].value)}setValue(u,p){this._values[u]=new jn(this._values[u].property,p===null?void 0:Pt(p))}serialize(){const u={};for(const p of Object.keys(this._values)){const I=this.getValue(p);I!==void 0&&(u[p]=I)}return u}possiblyEvaluate(u,p,I){const L=new Po(this._properties);for(const U of Object.keys(this._values))L._values[U]=this._values[U].possiblyEvaluate(u,p,I);return L}}class vs{constructor(u,p,I){this.property=u,this.value=p,this.parameters=I}isConstant(){return this.value.kind==="constant"}constantOr(u){return this.value.kind==="constant"?this.value.value:u}evaluate(u,p,I,L){return this.property.evaluate(this.value,this.parameters,u,p,I,L)}}class Po{constructor(u){this._properties=u,this._values=Object.create(u.defaultPossiblyEvaluatedValues)}get(u){return this._values[u]}}class Mi{constructor(u){this.specification=u}possiblyEvaluate(u,p){if(u.isDataDriven())throw new Error("Value should not be data driven");return u.expression.evaluate(p)}interpolate(u,p,I){const L=Zs[this.specification.type];return L?L(u,p,I):u}}class Bi{constructor(u,p){this.specification=u,this.overrides=p}possiblyEvaluate(u,p,I,L){return new vs(this,u.expression.kind==="constant"||u.expression.kind==="camera"?{kind:"constant",value:u.expression.evaluate(p,null,{},I,L)}:u.expression,p)}interpolate(u,p,I){if(u.value.kind!=="constant"||p.value.kind!=="constant")return u;if(u.value.value===void 0||p.value.value===void 0)return new vs(this,{kind:"constant",value:void 0},u.parameters);const L=Zs[this.specification.type];if(L){const U=L(u.value.value,p.value.value,I);return new vs(this,{kind:"constant",value:U},u.parameters)}return u}evaluate(u,p,I,L,U,Q){return u.kind==="constant"?u.value:u.evaluate(p,I,L,U,Q)}}class xs extends Bi{possiblyEvaluate(u,p,I,L){if(u.value===void 0)return new vs(this,{kind:"constant",value:void 0},p);if(u.expression.kind==="constant"){const U=u.expression.evaluate(p,null,{},I,L),Q=u.property.specification.type==="resolvedImage"&&typeof U!="string"?U.name:U,re=this._calculate(Q,Q,Q,p);return new vs(this,{kind:"constant",value:re},p)}if(u.expression.kind==="camera"){const U=this._calculate(u.expression.evaluate({zoom:p.zoom-1}),u.expression.evaluate({zoom:p.zoom}),u.expression.evaluate({zoom:p.zoom+1}),p);return new vs(this,{kind:"constant",value:U},p)}return new vs(this,u.expression,p)}evaluate(u,p,I,L,U,Q){if(u.kind==="source"){const re=u.evaluate(p,I,L,U,Q);return this._calculate(re,re,re,p)}return u.kind==="composite"?this._calculate(u.evaluate({zoom:Math.floor(p.zoom)-1},I,L),u.evaluate({zoom:Math.floor(p.zoom)},I,L),u.evaluate({zoom:Math.floor(p.zoom)+1},I,L),p):u.value}_calculate(u,p,I,L){return L.zoom>L.zoomHistory.lastIntegerZoom?{from:u,to:p}:{from:I,to:p}}interpolate(u){return u}}class vu{constructor(u){this.specification=u}possiblyEvaluate(u,p,I,L){if(u.value!==void 0){if(u.expression.kind==="constant"){const U=u.expression.evaluate(p,null,{},I,L);return this._calculate(U,U,U,p)}return this._calculate(u.expression.evaluate(new gn(Math.floor(p.zoom-1),p)),u.expression.evaluate(new gn(Math.floor(p.zoom),p)),u.expression.evaluate(new gn(Math.floor(p.zoom+1),p)),p)}}_calculate(u,p,I,L){return L.zoom>L.zoomHistory.lastIntegerZoom?{from:u,to:p}:{from:I,to:p}}interpolate(u){return u}}class Vo{constructor(u){this.specification=u}possiblyEvaluate(u,p,I,L){return!!u.expression.evaluate(p,null,{},I,L)}interpolate(){return!1}}class fs{constructor(u){this.properties=u,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const p in u){const I=u[p];I.specification.overridable&&this.overridableProperties.push(p);const L=this.defaultPropertyValues[p]=new jn(I,void 0),U=this.defaultTransitionablePropertyValues[p]=new Jn(I);this.defaultTransitioningPropertyValues[p]=U.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=L.possiblyEvaluate({})}}}Dn("DataDrivenProperty",Bi),Dn("DataConstantProperty",Mi),Dn("CrossFadedDataDrivenProperty",xs),Dn("CrossFadedProperty",vu),Dn("ColorRampProperty",Vo);const hl="-transition";class Ms extends Pr{constructor(u,p){if(super(),this.id=u.id,this.type=u.type,this._featureFilter={filter:()=>!0,needGeometry:!1},u.type!=="custom"&&(this.metadata=u.metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,u.type!=="background"&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),p.layout&&(this._unevaluatedLayout=new yu(p.layout)),p.paint)){this._transitionablePaint=new tl(p.paint);for(const I in u.paint)this.setPaintProperty(I,u.paint[I],{validate:!1});for(const I in u.layout)this.setLayoutProperty(I,u.layout[I],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Po(p.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(u){return u==="visibility"?this.visibility:this._unevaluatedLayout.getValue(u)}setLayoutProperty(u,p,I={}){p!=null&&this._validate(Wu,`layers.${this.id}.layout.${u}`,u,p,I)||(u!=="visibility"?this._unevaluatedLayout.setValue(u,p):this.visibility=p)}getPaintProperty(u){return u.endsWith(hl)?this._transitionablePaint.getTransition(u.slice(0,-11)):this._transitionablePaint.getValue(u)}setPaintProperty(u,p,I={}){if(p!=null&&this._validate(rs,`layers.${this.id}.paint.${u}`,u,p,I))return!1;if(u.endsWith(hl))return this._transitionablePaint.setTransition(u.slice(0,-11),p||void 0),!1;{const L=this._transitionablePaint._values[u],U=L.property.specification["property-type"]==="cross-faded-data-driven",Q=L.value.isDataDriven(),re=L.value;this._transitionablePaint.setValue(u,p),this._handleSpecialPaintPropertyUpdate(u);const Ae=this._transitionablePaint._values[u].value;return Ae.isDataDriven()||Q||U||this._handleOverridablePaintPropertyUpdate(u,re,Ae)}}_handleSpecialPaintPropertyUpdate(u){}_handleOverridablePaintPropertyUpdate(u,p,I){return!1}isHidden(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||this.visibility==="none"}updateTransitions(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(u,p){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,p)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,p)}serialize(){const u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),Et(u,(p,I)=>!(p===void 0||I==="layout"&&!Object.keys(p).length||I==="paint"&&!Object.keys(p).length))}_validate(u,p,I,L,U={}){return(!U||U.validate!==!1)&&Ru(this,u.call(Ya,{key:p,layerType:this.type,objectKey:I,value:L,styleSpec:ci,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const u in this.paint._values){const p=this.paint.get(u);if(p instanceof vs&&Qa(p.property.specification)&&(p.value.kind==="source"||p.value.kind==="composite")&&p.value.isStateDependent)return!0}return!1}}const C={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class D{constructor(u,p){this._structArray=u,this._pos1=p*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class z{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(u,p){return u._trim(),p&&(u.isTransferred=!0,p.push(u.arrayBuffer)),{length:u.length,arrayBuffer:u.arrayBuffer}}static deserialize(u){const p=Object.create(this.prototype);return p.arrayBuffer=u.arrayBuffer,p.length=u.length,p.capacity=u.arrayBuffer.byteLength/p.bytesPerElement,p._refreshViews(),p}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(u){this.reserve(u),this.length=u}reserve(u){if(u>this.capacity){this.capacity=Math.max(u,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const p=this.uint8;this._refreshViews(),p&&this.uint8.set(p)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function R(f,u=1){let p=0,I=0;return{members:f.map(L=>{const U=C[L.type].BYTES_PER_ELEMENT,Q=p=ee(p,Math.max(u,U)),re=L.components||1;return I=Math.max(I,U),p+=U*re,{name:L.name,type:L.type,components:re,offset:Q}}),size:ee(p,Math.max(I,u)),alignment:u}}function ee(f,u){return Math.ceil(f/u)*u}class le extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p){const I=this.length;return this.resize(I+1),this.emplace(I,u,p)}emplace(u,p,I){const L=2*u;return this.int16[L+0]=p,this.int16[L+1]=I,u}}le.prototype.bytesPerElement=4,Dn("StructArrayLayout2i4",le);class oe extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,I){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,I)}emplace(u,p,I,L){const U=3*u;return this.int16[U+0]=p,this.int16[U+1]=I,this.int16[U+2]=L,u}}oe.prototype.bytesPerElement=6,Dn("StructArrayLayout3i6",oe);class we extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,I,L){const U=this.length;return this.resize(U+1),this.emplace(U,u,p,I,L)}emplace(u,p,I,L,U){const Q=4*u;return this.int16[Q+0]=p,this.int16[Q+1]=I,this.int16[Q+2]=L,this.int16[Q+3]=U,u}}we.prototype.bytesPerElement=8,Dn("StructArrayLayout4i8",we);class $e extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,I,L,U,Q){const re=this.length;return this.resize(re+1),this.emplace(re,u,p,I,L,U,Q)}emplace(u,p,I,L,U,Q,re){const Ae=6*u;return this.int16[Ae+0]=p,this.int16[Ae+1]=I,this.int16[Ae+2]=L,this.int16[Ae+3]=U,this.int16[Ae+4]=Q,this.int16[Ae+5]=re,u}}$e.prototype.bytesPerElement=12,Dn("StructArrayLayout2i4i12",$e);class _t extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,I,L,U,Q){const re=this.length;return this.resize(re+1),this.emplace(re,u,p,I,L,U,Q)}emplace(u,p,I,L,U,Q,re){const Ae=4*u,_e=8*u;return this.int16[Ae+0]=p,this.int16[Ae+1]=I,this.uint8[_e+4]=L,this.uint8[_e+5]=U,this.uint8[_e+6]=Q,this.uint8[_e+7]=re,u}}_t.prototype.bytesPerElement=8,Dn("StructArrayLayout2i4ub8",_t);class Ct extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p){const I=this.length;return this.resize(I+1),this.emplace(I,u,p)}emplace(u,p,I){const L=2*u;return this.float32[L+0]=p,this.float32[L+1]=I,u}}Ct.prototype.bytesPerElement=8,Dn("StructArrayLayout2f8",Ct);class ni extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,I,L,U,Q,re,Ae,_e,Le){const qe=this.length;return this.resize(qe+1),this.emplace(qe,u,p,I,L,U,Q,re,Ae,_e,Le)}emplace(u,p,I,L,U,Q,re,Ae,_e,Le,qe){const et=10*u;return this.uint16[et+0]=p,this.uint16[et+1]=I,this.uint16[et+2]=L,this.uint16[et+3]=U,this.uint16[et+4]=Q,this.uint16[et+5]=re,this.uint16[et+6]=Ae,this.uint16[et+7]=_e,this.uint16[et+8]=Le,this.uint16[et+9]=qe,u}}ni.prototype.bytesPerElement=20,Dn("StructArrayLayout10ui20",ni);class Gt extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,I,L,U,Q,re,Ae,_e,Le,qe,et){const At=this.length;return this.resize(At+1),this.emplace(At,u,p,I,L,U,Q,re,Ae,_e,Le,qe,et)}emplace(u,p,I,L,U,Q,re,Ae,_e,Le,qe,et,At){const gt=12*u;return this.int16[gt+0]=p,this.int16[gt+1]=I,this.int16[gt+2]=L,this.int16[gt+3]=U,this.uint16[gt+4]=Q,this.uint16[gt+5]=re,this.uint16[gt+6]=Ae,this.uint16[gt+7]=_e,this.int16[gt+8]=Le,this.int16[gt+9]=qe,this.int16[gt+10]=et,this.int16[gt+11]=At,u}}Gt.prototype.bytesPerElement=24,Dn("StructArrayLayout4i4ui4i24",Gt);class Zt extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,I){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,I)}emplace(u,p,I,L){const U=3*u;return this.float32[U+0]=p,this.float32[U+1]=I,this.float32[U+2]=L,u}}Zt.prototype.bytesPerElement=12,Dn("StructArrayLayout3f12",Zt);class Z extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.uint32[1*u+0]=p,u}}Z.prototype.bytesPerElement=4,Dn("StructArrayLayout1ul4",Z);class A extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,I,L,U,Q,re,Ae,_e){const Le=this.length;return this.resize(Le+1),this.emplace(Le,u,p,I,L,U,Q,re,Ae,_e)}emplace(u,p,I,L,U,Q,re,Ae,_e,Le){const qe=10*u,et=5*u;return this.int16[qe+0]=p,this.int16[qe+1]=I,this.int16[qe+2]=L,this.int16[qe+3]=U,this.int16[qe+4]=Q,this.int16[qe+5]=re,this.uint32[et+3]=Ae,this.uint16[qe+8]=_e,this.uint16[qe+9]=Le,u}}A.prototype.bytesPerElement=20,Dn("StructArrayLayout6i1ul2ui20",A);class E extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,I,L,U,Q){const re=this.length;return this.resize(re+1),this.emplace(re,u,p,I,L,U,Q)}emplace(u,p,I,L,U,Q,re){const Ae=6*u;return this.int16[Ae+0]=p,this.int16[Ae+1]=I,this.int16[Ae+2]=L,this.int16[Ae+3]=U,this.int16[Ae+4]=Q,this.int16[Ae+5]=re,u}}E.prototype.bytesPerElement=12,Dn("StructArrayLayout2i2i2i12",E);class F extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,I,L,U){const Q=this.length;return this.resize(Q+1),this.emplace(Q,u,p,I,L,U)}emplace(u,p,I,L,U,Q){const re=4*u,Ae=8*u;return this.float32[re+0]=p,this.float32[re+1]=I,this.float32[re+2]=L,this.int16[Ae+6]=U,this.int16[Ae+7]=Q,u}}F.prototype.bytesPerElement=16,Dn("StructArrayLayout2f1f2i16",F);class O extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,I,L){const U=this.length;return this.resize(U+1),this.emplace(U,u,p,I,L)}emplace(u,p,I,L,U){const Q=12*u,re=3*u;return this.uint8[Q+0]=p,this.uint8[Q+1]=I,this.float32[re+1]=L,this.float32[re+2]=U,u}}O.prototype.bytesPerElement=12,Dn("StructArrayLayout2ub2f12",O);class y extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,I){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,I)}emplace(u,p,I,L){const U=3*u;return this.uint16[U+0]=p,this.uint16[U+1]=I,this.uint16[U+2]=L,u}}y.prototype.bytesPerElement=6,Dn("StructArrayLayout3ui6",y);class s extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,I,L,U,Q,re,Ae,_e,Le,qe,et,At,gt,Dt,Lt,Rt){const Kt=this.length;return this.resize(Kt+1),this.emplace(Kt,u,p,I,L,U,Q,re,Ae,_e,Le,qe,et,At,gt,Dt,Lt,Rt)}emplace(u,p,I,L,U,Q,re,Ae,_e,Le,qe,et,At,gt,Dt,Lt,Rt,Kt){const Ht=24*u,Qt=12*u,ui=48*u;return this.int16[Ht+0]=p,this.int16[Ht+1]=I,this.uint16[Ht+2]=L,this.uint16[Ht+3]=U,this.uint32[Qt+2]=Q,this.uint32[Qt+3]=re,this.uint32[Qt+4]=Ae,this.uint16[Ht+10]=_e,this.uint16[Ht+11]=Le,this.uint16[Ht+12]=qe,this.float32[Qt+7]=et,this.float32[Qt+8]=At,this.uint8[ui+36]=gt,this.uint8[ui+37]=Dt,this.uint8[ui+38]=Lt,this.uint32[Qt+10]=Rt,this.int16[Ht+22]=Kt,u}}s.prototype.bytesPerElement=48,Dn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",s);class i extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,I,L,U,Q,re,Ae,_e,Le,qe,et,At,gt,Dt,Lt,Rt,Kt,Ht,Qt,ui,yi,Yi,wn,un,on,dn,Rn){const an=this.length;return this.resize(an+1),this.emplace(an,u,p,I,L,U,Q,re,Ae,_e,Le,qe,et,At,gt,Dt,Lt,Rt,Kt,Ht,Qt,ui,yi,Yi,wn,un,on,dn,Rn)}emplace(u,p,I,L,U,Q,re,Ae,_e,Le,qe,et,At,gt,Dt,Lt,Rt,Kt,Ht,Qt,ui,yi,Yi,wn,un,on,dn,Rn,an){const Xi=32*u,Ln=16*u;return this.int16[Xi+0]=p,this.int16[Xi+1]=I,this.int16[Xi+2]=L,this.int16[Xi+3]=U,this.int16[Xi+4]=Q,this.int16[Xi+5]=re,this.int16[Xi+6]=Ae,this.int16[Xi+7]=_e,this.uint16[Xi+8]=Le,this.uint16[Xi+9]=qe,this.uint16[Xi+10]=et,this.uint16[Xi+11]=At,this.uint16[Xi+12]=gt,this.uint16[Xi+13]=Dt,this.uint16[Xi+14]=Lt,this.uint16[Xi+15]=Rt,this.uint16[Xi+16]=Kt,this.uint16[Xi+17]=Ht,this.uint16[Xi+18]=Qt,this.uint16[Xi+19]=ui,this.uint16[Xi+20]=yi,this.uint16[Xi+21]=Yi,this.uint16[Xi+22]=wn,this.uint32[Ln+12]=un,this.float32[Ln+13]=on,this.float32[Ln+14]=dn,this.uint16[Xi+30]=Rn,this.uint16[Xi+31]=an,u}}i.prototype.bytesPerElement=64,Dn("StructArrayLayout8i15ui1ul2f2ui64",i);class r extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.float32[1*u+0]=p,u}}r.prototype.bytesPerElement=4,Dn("StructArrayLayout1f4",r);class l extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,I){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,I)}emplace(u,p,I,L){const U=3*u;return this.uint16[6*u+0]=p,this.float32[U+1]=I,this.float32[U+2]=L,u}}l.prototype.bytesPerElement=12,Dn("StructArrayLayout1ui2f12",l);class d extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,I){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,I)}emplace(u,p,I,L){const U=4*u;return this.uint32[2*u+0]=p,this.uint16[U+2]=I,this.uint16[U+3]=L,u}}d.prototype.bytesPerElement=8,Dn("StructArrayLayout1ul2ui8",d);class _ extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p){const I=this.length;return this.resize(I+1),this.emplace(I,u,p)}emplace(u,p,I){const L=2*u;return this.uint16[L+0]=p,this.uint16[L+1]=I,u}}_.prototype.bytesPerElement=4,Dn("StructArrayLayout2ui4",_);class w extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.uint16[1*u+0]=p,u}}w.prototype.bytesPerElement=2,Dn("StructArrayLayout1ui2",w);class T extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,I,L){const U=this.length;return this.resize(U+1),this.emplace(U,u,p,I,L)}emplace(u,p,I,L,U){const Q=4*u;return this.float32[Q+0]=p,this.float32[Q+1]=I,this.float32[Q+2]=L,this.float32[Q+3]=U,u}}T.prototype.bytesPerElement=16,Dn("StructArrayLayout4f16",T);class B extends D{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ue(this.anchorPointX,this.anchorPointY)}}B.prototype.size=20;class j extends A{get(u){return new B(this,u)}}Dn("CollisionBoxArray",j);class X extends D{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(u){this._structArray.uint8[this._pos1+37]=u}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(u){this._structArray.uint8[this._pos1+38]=u}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(u){this._structArray.uint32[this._pos4+10]=u}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}X.prototype.size=48;class ce extends s{get(u){return new X(this,u)}}Dn("PlacedSymbolArray",ce);class Se extends D{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(u){this._structArray.uint32[this._pos4+12]=u}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Se.prototype.size=64;class Te extends i{get(u){return new Se(this,u)}}Dn("SymbolInstanceArray",Te);class Re extends r{getoffsetX(u){return this.float32[1*u+0]}}Dn("GlyphOffsetArray",Re);class Be extends oe{getx(u){return this.int16[3*u+0]}gety(u){return this.int16[3*u+1]}gettileUnitDistanceFromAnchor(u){return this.int16[3*u+2]}}Dn("SymbolLineVertexArray",Be);class Ke extends D{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ke.prototype.size=12;class yt extends l{get(u){return new Ke(this,u)}}Dn("TextAnchorOffsetArray",yt);class ot extends D{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ot.prototype.size=8;class ct extends d{get(u){return new ot(this,u)}}Dn("FeatureIndexArray",ct);class It extends le{}class bt extends le{}class ri extends le{}class Xt extends $e{}class ti extends _t{}class si extends Ct{}class Qi extends ni{}class Wi extends Gt{}class Ei extends Zt{}class Gi extends Z{}class qi extends E{}class cn extends O{}class zn extends y{}class tn extends _{}const kn=R([{name:"a_pos",components:2,type:"Int16"}],4),{members:yr}=kn;class er{constructor(u=[]){this.segments=u}prepareSegment(u,p,I,L){let U=this.segments[this.segments.length-1];return u>er.MAX_VERTEX_ARRAY_LENGTH&&Je(`Max vertices per segment is ${er.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${u}`),(!U||U.vertexLength+u>er.MAX_VERTEX_ARRAY_LENGTH||U.sortKey!==L)&&(U={vertexOffset:p.length,primitiveOffset:I.length,vertexLength:0,primitiveLength:0},L!==void 0&&(U.sortKey=L),this.segments.push(U)),U}get(){return this.segments}destroy(){for(const u of this.segments)for(const p in u.vaos)u.vaos[p].destroy()}static simpleSegment(u,p,I,L){return new er([{vertexOffset:u,primitiveOffset:p,vertexLength:I,primitiveLength:L,vaos:{},sortKey:0}])}}function Ia(f,u){return 256*(f=Oe(Math.floor(f),0,255))+Oe(Math.floor(u),0,255)}er.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Dn("SegmentVector",er);const Aa=R([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var zs={exports:{}},oo={exports:{}};oo.exports=function(f,u){var p,I,L,U,Q,re,Ae,_e;for(I=f.length-(p=3&f.length),L=u,Q=3432918353,re=461845907,_e=0;_e<I;)Ae=255&f.charCodeAt(_e)|(255&f.charCodeAt(++_e))<<8|(255&f.charCodeAt(++_e))<<16|(255&f.charCodeAt(++_e))<<24,++_e,L=27492+(65535&(U=5*(65535&(L=(L^=Ae=(65535&(Ae=(Ae=(65535&Ae)*Q+(((Ae>>>16)*Q&65535)<<16)&4294967295)<<15|Ae>>>17))*re+(((Ae>>>16)*re&65535)<<16)&4294967295)<<13|L>>>19))+((5*(L>>>16)&65535)<<16)&4294967295))+((58964+(U>>>16)&65535)<<16);switch(Ae=0,p){case 3:Ae^=(255&f.charCodeAt(_e+2))<<16;case 2:Ae^=(255&f.charCodeAt(_e+1))<<8;case 1:L^=Ae=(65535&(Ae=(Ae=(65535&(Ae^=255&f.charCodeAt(_e)))*Q+(((Ae>>>16)*Q&65535)<<16)&4294967295)<<15|Ae>>>17))*re+(((Ae>>>16)*re&65535)<<16)&4294967295}return L^=f.length,L=2246822507*(65535&(L^=L>>>16))+((2246822507*(L>>>16)&65535)<<16)&4294967295,L=3266489909*(65535&(L^=L>>>13))+((3266489909*(L>>>16)&65535)<<16)&4294967295,(L^=L>>>16)>>>0};var lo=oo.exports,qr={exports:{}};qr.exports=function(f,u){for(var p,I=f.length,L=u^I,U=0;I>=4;)p=1540483477*(65535&(p=255&f.charCodeAt(U)|(255&f.charCodeAt(++U))<<8|(255&f.charCodeAt(++U))<<16|(255&f.charCodeAt(++U))<<24))+((1540483477*(p>>>16)&65535)<<16),L=1540483477*(65535&L)+((1540483477*(L>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),I-=4,++U;switch(I){case 3:L^=(255&f.charCodeAt(U+2))<<16;case 2:L^=(255&f.charCodeAt(U+1))<<8;case 1:L=1540483477*(65535&(L^=255&f.charCodeAt(U)))+((1540483477*(L>>>16)&65535)<<16)}return L=1540483477*(65535&(L^=L>>>13))+((1540483477*(L>>>16)&65535)<<16),(L^=L>>>15)>>>0};var ya=lo,xo=qr.exports;zs.exports=ya,zs.exports.murmur3=ya,zs.exports.murmur2=xo;var bo=W(zs.exports);class Qs{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(u,p,I,L){this.ids.push(ts(u)),this.positions.push(p,I,L)}getPositions(u){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const p=ts(u);let I=0,L=this.ids.length-1;for(;I<L;){const Q=I+L>>1;this.ids[Q]>=p?L=Q:I=Q+1}const U=[];for(;this.ids[I]===p;)U.push({index:this.positions[3*I],start:this.positions[3*I+1],end:this.positions[3*I+2]}),I++;return U}static serialize(u,p){const I=new Float64Array(u.ids),L=new Uint32Array(u.positions);return is(I,L,0,I.length-1),p&&p.push(I.buffer,L.buffer),{ids:I,positions:L}}static deserialize(u){const p=new Qs;return p.ids=u.ids,p.positions=u.positions,p.indexed=!0,p}}function ts(f){const u=+f;return!isNaN(u)&&u<=Number.MAX_SAFE_INTEGER?u:bo(String(f))}function is(f,u,p,I){for(;p<I;){const L=f[p+I>>1];let U=p-1,Q=I+1;for(;;){do U++;while(f[U]<L);do Q--;while(f[Q]>L);if(U>=Q)break;Rr(f,U,Q),Rr(u,3*U,3*Q),Rr(u,3*U+1,3*Q+1),Rr(u,3*U+2,3*Q+2)}Q-p<I-Q?(is(f,u,p,Q),p=Q+1):(is(f,u,Q+1,I),I=Q)}}function Rr(f,u,p){const I=f[u];f[u]=f[p],f[p]=I}Dn("FeaturePositionMap",Qs);class bs{constructor(u,p){this.gl=u.gl,this.location=p}}class Ws extends bs{constructor(u,p){super(u,p),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class Do extends bs{constructor(u,p){super(u,p),this.current=[0,0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))}}class Uo extends bs{constructor(u,p){super(u,p),this.current=Zi.transparent}set(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))}}const Go=new Float32Array(16);function Ic(f){return[Ia(255*f.r,255*f.g),Ia(255*f.b,255*f.a)]}class $s{constructor(u,p,I){this.value=u,this.uniformNames=p.map(L=>`u_${L}`),this.type=I}setUniform(u,p,I){u.set(I.constantOr(this.value))}getBinding(u,p,I){return this.type==="color"?new Uo(u,p):new Ws(u,p)}}class Xl{constructor(u,p){this.uniformNames=p.map(I=>`u_${I}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(u,p){this.pixelRatioFrom=p.pixelRatio,this.pixelRatioTo=u.pixelRatio,this.patternFrom=p.tlbr,this.patternTo=u.tlbr}setUniform(u,p,I,L){const U=L==="u_pattern_to"?this.patternTo:L==="u_pattern_from"?this.patternFrom:L==="u_pixel_ratio_to"?this.pixelRatioTo:L==="u_pixel_ratio_from"?this.pixelRatioFrom:null;U&&u.set(U)}getBinding(u,p,I){return I.substr(0,9)==="u_pattern"?new Do(u,p):new Ws(u,p)}}class hu{constructor(u,p,I,L){this.expression=u,this.type=I,this.maxValue=0,this.paintVertexAttributes=p.map(U=>({name:`a_${U}`,type:"Float32",components:I==="color"?2:1,offset:0})),this.paintVertexArray=new L}populatePaintArray(u,p,I,L,U){const Q=this.paintVertexArray.length,re=this.expression.evaluate(new gn(0),p,{},L,[],U);this.paintVertexArray.resize(u),this._setPaintValue(Q,u,re)}updatePaintArray(u,p,I,L){const U=this.expression.evaluate({zoom:0},I,L);this._setPaintValue(u,p,U)}_setPaintValue(u,p,I){if(this.type==="color"){const L=Ic(I);for(let U=u;U<p;U++)this.paintVertexArray.emplace(U,L[0],L[1])}else{for(let L=u;L<p;L++)this.paintVertexArray.emplace(L,I);this.maxValue=Math.max(this.maxValue,Math.abs(I))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class il{constructor(u,p,I,L,U,Q){this.expression=u,this.uniformNames=p.map(re=>`u_${re}_t`),this.type=I,this.useIntegerZoom=L,this.zoom=U,this.maxValue=0,this.paintVertexAttributes=p.map(re=>({name:`a_${re}`,type:"Float32",components:I==="color"?4:2,offset:0})),this.paintVertexArray=new Q}populatePaintArray(u,p,I,L,U){const Q=this.expression.evaluate(new gn(this.zoom),p,{},L,[],U),re=this.expression.evaluate(new gn(this.zoom+1),p,{},L,[],U),Ae=this.paintVertexArray.length;this.paintVertexArray.resize(u),this._setPaintValue(Ae,u,Q,re)}updatePaintArray(u,p,I,L){const U=this.expression.evaluate({zoom:this.zoom},I,L),Q=this.expression.evaluate({zoom:this.zoom+1},I,L);this._setPaintValue(u,p,U,Q)}_setPaintValue(u,p,I,L){if(this.type==="color"){const U=Ic(I),Q=Ic(L);for(let re=u;re<p;re++)this.paintVertexArray.emplace(re,U[0],U[1],Q[0],Q[1])}else{for(let U=u;U<p;U++)this.paintVertexArray.emplace(U,I,L);this.maxValue=Math.max(this.maxValue,Math.abs(I),Math.abs(L))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(u,p){const I=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,L=Oe(this.expression.interpolationFactor(I,this.zoom,this.zoom+1),0,1);u.set(L)}getBinding(u,p,I){return new Ws(u,p)}}class vl{constructor(u,p,I,L,U,Q){this.expression=u,this.type=p,this.useIntegerZoom=I,this.zoom=L,this.layerId=Q,this.zoomInPaintVertexArray=new U,this.zoomOutPaintVertexArray=new U}populatePaintArray(u,p,I){const L=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(u),this.zoomOutPaintVertexArray.resize(u),this._setPaintValues(L,u,p.patterns&&p.patterns[this.layerId],I)}updatePaintArray(u,p,I,L,U){this._setPaintValues(u,p,I.patterns&&I.patterns[this.layerId],U)}_setPaintValues(u,p,I,L){if(!L||!I)return;const{min:U,mid:Q,max:re}=I,Ae=L[U],_e=L[Q],Le=L[re];if(Ae&&_e&&Le)for(let qe=u;qe<p;qe++)this.zoomInPaintVertexArray.emplace(qe,_e.tl[0],_e.tl[1],_e.br[0],_e.br[1],Ae.tl[0],Ae.tl[1],Ae.br[0],Ae.br[1],_e.pixelRatio,Ae.pixelRatio),this.zoomOutPaintVertexArray.emplace(qe,_e.tl[0],_e.tl[1],_e.br[0],_e.br[1],Le.tl[0],Le.tl[1],Le.br[0],Le.br[1],_e.pixelRatio,Le.pixelRatio)}upload(u){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=u.createVertexBuffer(this.zoomInPaintVertexArray,Aa.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=u.createVertexBuffer(this.zoomOutPaintVertexArray,Aa.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Pl{constructor(u,p,I){this.binders={},this._buffers=[];const L=[];for(const U in u.paint._values){if(!I(U))continue;const Q=u.paint.get(U);if(!(Q instanceof vs&&Qa(Q.property.specification)))continue;const re=af(U,u.type),Ae=Q.value,_e=Q.property.specification.type,Le=Q.property.useIntegerZoom,qe=Q.property.specification["property-type"],et=qe==="cross-faded"||qe==="cross-faded-data-driven";if(Ae.kind==="constant")this.binders[U]=et?new Xl(Ae.value,re):new $s(Ae.value,re,_e),L.push(`/u_${U}`);else if(Ae.kind==="source"||et){const At=Vh(U,_e,"source");this.binders[U]=et?new vl(Ae,_e,Le,p,At,u.id):new hu(Ae,re,_e,At),L.push(`/a_${U}`)}else{const At=Vh(U,_e,"composite");this.binders[U]=new il(Ae,re,_e,Le,p,At),L.push(`/z_${U}`)}}this.cacheKey=L.sort().join("")}getMaxValue(u){const p=this.binders[u];return p instanceof hu||p instanceof il?p.maxValue:0}populatePaintArrays(u,p,I,L,U){for(const Q in this.binders){const re=this.binders[Q];(re instanceof hu||re instanceof il||re instanceof vl)&&re.populatePaintArray(u,p,I,L,U)}}setConstantPatternPositions(u,p){for(const I in this.binders){const L=this.binders[I];L instanceof Xl&&L.setConstantPatternPositions(u,p)}}updatePaintArrays(u,p,I,L,U){let Q=!1;for(const re in u){const Ae=p.getPositions(re);for(const _e of Ae){const Le=I.feature(_e.index);for(const qe in this.binders){const et=this.binders[qe];if((et instanceof hu||et instanceof il||et instanceof vl)&&et.expression.isStateDependent===!0){const At=L.paint.get(qe);et.expression=At.value,et.updatePaintArray(_e.start,_e.end,Le,u[re],U),Q=!0}}}}return Q}defines(){const u=[];for(const p in this.binders){const I=this.binders[p];(I instanceof $s||I instanceof Xl)&&u.push(...I.uniformNames.map(L=>`#define HAS_UNIFORM_${L}`))}return u}getBinderAttributes(){const u=[];for(const p in this.binders){const I=this.binders[p];if(I instanceof hu||I instanceof il)for(let L=0;L<I.paintVertexAttributes.length;L++)u.push(I.paintVertexAttributes[L].name);else if(I instanceof vl)for(let L=0;L<Aa.members.length;L++)u.push(Aa.members[L].name)}return u}getBinderUniforms(){const u=[];for(const p in this.binders){const I=this.binders[p];if(I instanceof $s||I instanceof Xl||I instanceof il)for(const L of I.uniformNames)u.push(L)}return u}getPaintVertexBuffers(){return this._buffers}getUniforms(u,p){const I=[];for(const L in this.binders){const U=this.binders[L];if(U instanceof $s||U instanceof Xl||U instanceof il){for(const Q of U.uniformNames)if(p[Q]){const re=U.getBinding(u,p[Q],Q);I.push({name:Q,property:L,binding:re})}}}return I}setUniforms(u,p,I,L){for(const{name:U,property:Q,binding:re}of p)this.binders[Q].setUniform(re,L,I.get(Q),U)}updatePaintBuffers(u){this._buffers=[];for(const p in this.binders){const I=this.binders[p];if(u&&I instanceof vl){const L=u.fromScale===2?I.zoomInPaintVertexBuffer:I.zoomOutPaintVertexBuffer;L&&this._buffers.push(L)}else(I instanceof hu||I instanceof il)&&I.paintVertexBuffer&&this._buffers.push(I.paintVertexBuffer)}}upload(u){for(const p in this.binders){const I=this.binders[p];(I instanceof hu||I instanceof il||I instanceof vl)&&I.upload(u)}this.updatePaintBuffers()}destroy(){for(const u in this.binders){const p=this.binders[u];(p instanceof hu||p instanceof il||p instanceof vl)&&p.destroy()}}}class Au{constructor(u,p,I=()=>!0){this.programConfigurations={};for(const L of u)this.programConfigurations[L.id]=new Pl(L,p,I);this.needsUpload=!1,this._featureMap=new Qs,this._bufferOffset=0}populatePaintArrays(u,p,I,L,U,Q){for(const re in this.programConfigurations)this.programConfigurations[re].populatePaintArrays(u,p,L,U,Q);p.id!==void 0&&this._featureMap.add(p.id,I,this._bufferOffset,u),this._bufferOffset=u,this.needsUpload=!0}updatePaintArrays(u,p,I,L){for(const U of I)this.needsUpload=this.programConfigurations[U.id].updatePaintArrays(u,this._featureMap,p,U,L)||this.needsUpload}get(u){return this.programConfigurations[u]}upload(u){if(this.needsUpload){for(const p in this.programConfigurations)this.programConfigurations[p].upload(u);this.needsUpload=!1}}destroy(){for(const u in this.programConfigurations)this.programConfigurations[u].destroy()}}function af(f,u){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[f]||[f.replace(`${u}-`,"").replace(/-/g,"_")]}function Vh(f,u,p){const I={color:{source:Ct,composite:T},number:{source:r,composite:Ct}},L=function(U){return{"line-pattern":{source:Qi,composite:Qi},"fill-pattern":{source:Qi,composite:Qi},"fill-extrusion-pattern":{source:Qi,composite:Qi}}[U]}(f);return L&&L[p]||I[u][p]}Dn("ConstantBinder",$s),Dn("CrossFadedConstantBinder",Xl),Dn("SourceExpressionBinder",hu),Dn("CrossFadedCompositeBinder",vl),Dn("CompositeExpressionBinder",il),Dn("ProgramConfiguration",Pl,{omit:["_buffers"]}),Dn("ProgramConfigurationSet",Au);const Pa=8192,pA=Math.pow(2,14)-1,yh=-pA-1;function Uh(f){const u=Pa/f.extent,p=f.loadGeometry();for(let I=0;I<p.length;I++){const L=p[I];for(let U=0;U<L.length;U++){const Q=L[U],re=Math.round(Q.x*u),Ae=Math.round(Q.y*u);Q.x=Oe(re,yh,pA),Q.y=Oe(Ae,yh,pA),(re<Q.x||re>Q.x+1||Ae<Q.y||Ae>Q.y+1)&&Je("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return p}function Ec(f,u){return{type:f.type,id:f.id,properties:f.properties,geometry:u?Uh(f):[]}}function Gh(f,u,p,I,L){f.emplaceBack(2*u+(I+1)/2,2*p+(L+1)/2)}class l0{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new bt,this.indexArray=new zn,this.segments=new er,this.programConfigurations=new Au(u.layers,u.zoom),this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,I){const L=this.layers[0],U=[];let Q=null,re=!1;L.type==="circle"&&(Q=L.layout.get("circle-sort-key"),re=!Q.isConstant());for(const{feature:Ae,id:_e,index:Le,sourceLayerIndex:qe}of u){const et=this.layers[0]._featureFilter.needGeometry,At=Ec(Ae,et);if(!this.layers[0]._featureFilter.filter(new gn(this.zoom),At,I))continue;const gt=re?Q.evaluate(At,{},I):void 0,Dt={id:_e,properties:Ae.properties,type:Ae.type,sourceLayerIndex:qe,index:Le,geometry:et?At.geometry:Uh(Ae),patterns:{},sortKey:gt};U.push(Dt)}re&&U.sort((Ae,_e)=>Ae.sortKey-_e.sortKey);for(const Ae of U){const{geometry:_e,index:Le,sourceLayerIndex:qe}=Ae,et=u[Le].feature;this.addFeature(Ae,_e,Le,I),p.featureIndex.insert(et,_e,Le,qe,this.index)}}update(u,p,I){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,I)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,yr),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(u,p,I,L){for(const U of p)for(const Q of U){const re=Q.x,Ae=Q.y;if(re<0||re>=Pa||Ae<0||Ae>=Pa)continue;const _e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,u.sortKey),Le=_e.vertexLength;Gh(this.layoutVertexArray,re,Ae,-1,-1),Gh(this.layoutVertexArray,re,Ae,1,-1),Gh(this.layoutVertexArray,re,Ae,1,1),Gh(this.layoutVertexArray,re,Ae,-1,1),this.indexArray.emplaceBack(Le,Le+1,Le+2),this.indexArray.emplaceBack(Le,Le+3,Le+2),_e.vertexLength+=4,_e.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,I,{},L)}}function $c(f,u){for(let p=0;p<f.length;p++)if(Xu(u,f[p]))return!0;for(let p=0;p<u.length;p++)if(Xu(f,u[p]))return!0;return!!Xc(f,u)}function _p(f,u,p){return!!Xu(f,u)||!!lf(u,f,p)}function qh(f,u){if(f.length===1)return Yl(u,f[0]);for(let p=0;p<u.length;p++){const I=u[p];for(let L=0;L<I.length;L++)if(Xu(f,I[L]))return!0}for(let p=0;p<f.length;p++)if(Yl(u,f[p]))return!0;for(let p=0;p<u.length;p++)if(Xc(f,u[p]))return!0;return!1}function of(f,u,p){if(f.length>1){if(Xc(f,u))return!0;for(let I=0;I<u.length;I++)if(lf(u[I],f,p))return!0}for(let I=0;I<f.length;I++)if(lf(f[I],u,p))return!0;return!1}function Xc(f,u){if(f.length===0||u.length===0)return!1;for(let p=0;p<f.length-1;p++){const I=f[p],L=f[p+1];for(let U=0;U<u.length-1;U++)if(yp(I,L,u[U],u[U+1]))return!0}return!1}function yp(f,u,p,I){return pt(f,p,I)!==pt(u,p,I)&&pt(f,u,p)!==pt(f,u,I)}function lf(f,u,p){const I=p*p;if(u.length===1)return f.distSqr(u[0])<I;for(let L=1;L<u.length;L++)if(H0(f,u[L-1],u[L])<I)return!0;return!1}function H0(f,u,p){const I=u.distSqr(p);if(I===0)return f.distSqr(u);const L=((f.x-u.x)*(p.x-u.x)+(f.y-u.y)*(p.y-u.y))/I;return f.distSqr(L<0?u:L>1?p:p.sub(u)._mult(L)._add(u))}function Yl(f,u){let p,I,L,U=!1;for(let Q=0;Q<f.length;Q++){p=f[Q];for(let re=0,Ae=p.length-1;re<p.length;Ae=re++)I=p[re],L=p[Ae],I.y>u.y!=L.y>u.y&&u.x<(L.x-I.x)*(u.y-I.y)/(L.y-I.y)+I.x&&(U=!U)}return U}function Xu(f,u){let p=!1;for(let I=0,L=f.length-1;I<f.length;L=I++){const U=f[I],Q=f[L];U.y>u.y!=Q.y>u.y&&u.x<(Q.x-U.x)*(u.y-U.y)/(Q.y-U.y)+U.x&&(p=!p)}return p}function j0(f,u,p){const I=p[0],L=p[2];if(f.x<I.x&&u.x<I.x||f.x>L.x&&u.x>L.x||f.y<I.y&&u.y<I.y||f.y>L.y&&u.y>L.y)return!1;const U=pt(f,u,p[0]);return U!==pt(f,u,p[1])||U!==pt(f,u,p[2])||U!==pt(f,u,p[3])}function vh(f,u,p){const I=u.paint.get(f).value;return I.kind==="constant"?I.value:p.programConfigurations.get(u.id).getMaxValue(f)}function Yc(f){return Math.sqrt(f[0]*f[0]+f[1]*f[1])}function mA(f,u,p,I,L){if(!u[0]&&!u[1])return f;const U=ue.convert(u)._mult(L);p==="viewport"&&U._rotate(-I);const Q=[];for(let re=0;re<f.length;re++)Q.push(f[re].sub(U));return Q}let uf,u0;Dn("CircleBucket",l0,{omit:["layers"]});var _s={get paint(){return u0=u0||new fs({"circle-radius":new Bi(ci.paint_circle["circle-radius"]),"circle-color":new Bi(ci.paint_circle["circle-color"]),"circle-blur":new Bi(ci.paint_circle["circle-blur"]),"circle-opacity":new Bi(ci.paint_circle["circle-opacity"]),"circle-translate":new Mi(ci.paint_circle["circle-translate"]),"circle-translate-anchor":new Mi(ci.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Mi(ci.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Mi(ci.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Bi(ci.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Bi(ci.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Bi(ci.paint_circle["circle-stroke-opacity"])})},get layout(){return uf=uf||new fs({"circle-sort-key":new Bi(ci.layout_circle["circle-sort-key"])})}},Kl=1e-6,Hh=typeof Float32Array<"u"?Float32Array:Array;function jh(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function cf(f,u,p){var I=u[0],L=u[1],U=u[2],Q=u[3],re=u[4],Ae=u[5],_e=u[6],Le=u[7],qe=u[8],et=u[9],At=u[10],gt=u[11],Dt=u[12],Lt=u[13],Rt=u[14],Kt=u[15],Ht=p[0],Qt=p[1],ui=p[2],yi=p[3];return f[0]=Ht*I+Qt*re+ui*qe+yi*Dt,f[1]=Ht*L+Qt*Ae+ui*et+yi*Lt,f[2]=Ht*U+Qt*_e+ui*At+yi*Rt,f[3]=Ht*Q+Qt*Le+ui*gt+yi*Kt,f[4]=(Ht=p[4])*I+(Qt=p[5])*re+(ui=p[6])*qe+(yi=p[7])*Dt,f[5]=Ht*L+Qt*Ae+ui*et+yi*Lt,f[6]=Ht*U+Qt*_e+ui*At+yi*Rt,f[7]=Ht*Q+Qt*Le+ui*gt+yi*Kt,f[8]=(Ht=p[8])*I+(Qt=p[9])*re+(ui=p[10])*qe+(yi=p[11])*Dt,f[9]=Ht*L+Qt*Ae+ui*et+yi*Lt,f[10]=Ht*U+Qt*_e+ui*At+yi*Rt,f[11]=Ht*Q+Qt*Le+ui*gt+yi*Kt,f[12]=(Ht=p[12])*I+(Qt=p[13])*re+(ui=p[14])*qe+(yi=p[15])*Dt,f[13]=Ht*L+Qt*Ae+ui*et+yi*Lt,f[14]=Ht*U+Qt*_e+ui*At+yi*Rt,f[15]=Ht*Q+Qt*Le+ui*gt+yi*Kt,f}Math.hypot||(Math.hypot=function(){for(var f=0,u=arguments.length;u--;)f+=arguments[u]*arguments[u];return Math.sqrt(f)});var gA,Z0=cf;function Dl(f,u,p){var I=u[0],L=u[1],U=u[2],Q=u[3];return f[0]=p[0]*I+p[4]*L+p[8]*U+p[12]*Q,f[1]=p[1]*I+p[5]*L+p[9]*U+p[13]*Q,f[2]=p[2]*I+p[6]*L+p[10]*U+p[14]*Q,f[3]=p[3]*I+p[7]*L+p[11]*U+p[15]*Q,f}gA=new Hh(4),Hh!=Float32Array&&(gA[0]=0,gA[1]=0,gA[2]=0,gA[3]=0);class Vu extends Ms{constructor(u){super(u,_s)}createBucket(u){return new l0(u)}queryRadius(u){const p=u;return vh("circle-radius",this,p)+vh("circle-stroke-width",this,p)+Yc(this.paint.get("circle-translate"))}queryIntersectsFeature(u,p,I,L,U,Q,re,Ae){const _e=mA(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),Q.angle,re),Le=this.paint.get("circle-radius").evaluate(p,I)+this.paint.get("circle-stroke-width").evaluate(p,I),qe=this.paint.get("circle-pitch-alignment")==="map",et=qe?_e:function(gt,Dt){return gt.map(Lt=>_A(Lt,Dt))}(_e,Ae),At=qe?Le*re:Le;for(const gt of L)for(const Dt of gt){const Lt=qe?Dt:_A(Dt,Ae);let Rt=At;const Kt=Dl([],[Dt.x,Dt.y,0,1],Ae);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Rt*=Kt[3]/Q.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Rt*=Q.cameraToCenterDistance/Kt[3]),_p(et,Lt,Rt))return!0}return!1}}function _A(f,u){const p=Dl([],[f.x,f.y,0,1],u);return new ue(p[0]/p[3],p[1]/p[3])}class c0 extends l0{}let h0;Dn("HeatmapBucket",c0,{omit:["layers"]});var vp={get paint(){return h0=h0||new fs({"heatmap-radius":new Bi(ci.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Bi(ci.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Mi(ci.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Vo(ci.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Mi(ci.paint_heatmap["heatmap-opacity"])})}};function xu(f,{width:u,height:p},I,L){if(L){if(L instanceof Uint8ClampedArray)L=new Uint8Array(L.buffer);else if(L.length!==u*p*I)throw new RangeError(`mismatched image size. expected: ${L.length} but got: ${u*p*I}`)}else L=new Uint8Array(u*p*I);return f.width=u,f.height=p,f.data=L,f}function Kc(f,{width:u,height:p},I){if(u===f.width&&p===f.height)return;const L=xu({},{width:u,height:p},I);hf(f,L,{x:0,y:0},{x:0,y:0},{width:Math.min(f.width,u),height:Math.min(f.height,p)},I),f.width=u,f.height=p,f.data=L.data}function hf(f,u,p,I,L,U){if(L.width===0||L.height===0)return u;if(L.width>f.width||L.height>f.height||p.x>f.width-L.width||p.y>f.height-L.height)throw new RangeError("out of range source coordinates for image copy");if(L.width>u.width||L.height>u.height||I.x>u.width-L.width||I.y>u.height-L.height)throw new RangeError("out of range destination coordinates for image copy");const Q=f.data,re=u.data;if(Q===re)throw new Error("srcData equals dstData, so image is already copied");for(let Ae=0;Ae<L.height;Ae++){const _e=((p.y+Ae)*f.width+p.x)*U,Le=((I.y+Ae)*u.width+I.x)*U;for(let qe=0;qe<L.width*U;qe++)re[Le+qe]=Q[_e+qe]}return u}class xh{constructor(u,p){xu(this,u,1,p)}resize(u){Kc(this,u,1)}clone(){return new xh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,p,I,L,U){hf(u,p,I,L,U,1)}}class Ll{constructor(u,p){xu(this,u,4,p)}resize(u){Kc(this,u,4)}replace(u,p){p?this.data.set(u):this.data=u instanceof Uint8ClampedArray?new Uint8Array(u.buffer):u}clone(){return new Ll({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,p,I,L,U){hf(u,p,I,L,U,4)}}function A0(f){const u={},p=f.resolution||256,I=f.clips?f.clips.length:1,L=f.image||new Ll({width:p,height:I});if(Math.log(p)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${p}`);const U=(Q,re,Ae)=>{u[f.evaluationKey]=Ae;const _e=f.expression.evaluate(u);L.data[Q+re+0]=Math.floor(255*_e.r/_e.a),L.data[Q+re+1]=Math.floor(255*_e.g/_e.a),L.data[Q+re+2]=Math.floor(255*_e.b/_e.a),L.data[Q+re+3]=Math.floor(255*_e.a)};if(f.clips)for(let Q=0,re=0;Q<I;++Q,re+=4*p)for(let Ae=0,_e=0;Ae<p;Ae++,_e+=4){const Le=Ae/(p-1),{start:qe,end:et}=f.clips[Q];U(re,_e,qe*(1-Le)+et*Le)}else for(let Q=0,re=0;Q<p;Q++,re+=4)U(0,re,Q/(p-1));return L}Dn("AlphaImage",xh),Dn("RGBAImage",Ll);class Jc extends Ms{createBucket(u){return new c0(u)}constructor(u){super(u,vp),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=A0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Zh;var Q0={get paint(){return Zh=Zh||new fs({"hillshade-illumination-direction":new Mi(ci.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Mi(ci.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Mi(ci.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Mi(ci.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Mi(ci.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Mi(ci.paint_hillshade["hillshade-accent-color"])})}};class W0 extends Ms{constructor(u){super(u,Q0)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const bh=R([{name:"a_pos",components:2,type:"Int16"}],4),{members:Cm}=bh;var Cc={exports:{}};function Af(f,u,p){p=p||2;var I,L,U,Q,re,Ae,_e,Le=u&&u.length,qe=Le?u[0]*p:f.length,et=$0(f,0,qe,p,!0),At=[];if(!et||et.next===et.prev)return At;if(Le&&(et=function(Dt,Lt,Rt,Kt){var Ht,Qt,ui,yi=[];for(Ht=0,Qt=Lt.length;Ht<Qt;Ht++)(ui=$0(Dt,Lt[Ht]*Kt,Ht<Qt-1?Lt[Ht+1]*Kt:Dt.length,Kt,!1))===ui.next&&(ui.steiner=!0),yi.push(uc(ui));for(yi.sort(xp),Ht=0;Ht<yi.length;Ht++)Rt=pf(yi[Ht],Rt);return Rt}(f,u,et,p)),f.length>80*p){I=U=f[0],L=Q=f[1];for(var gt=p;gt<qe;gt+=p)(re=f[gt])<I&&(I=re),(Ae=f[gt+1])<L&&(L=Ae),re>U&&(U=re),Ae>Q&&(Q=Ae);_e=(_e=Math.max(U-I,Q-L))!==0?32767/_e:0}return ff(et,At,p,I,L,_e,0),At}function $0(f,u,p,I,L){var U,Q;if(L===xA(f,u,p,I)>0)for(U=u;U<p;U+=I)Q=wh(U,f[U],f[U+1],Q);else for(U=p-I;U>=u;U-=I)Q=wh(U,f[U],f[U+1],Q);return Q&&cc(Q,Q.next)&&(vf(Q),Q=Q.next),Q}function lc(f,u){if(!f)return f;u||(u=f);var p,I=f;do if(p=!1,I.steiner||!cc(I,I.next)&&Da(I.prev,I,I.next)!==0)I=I.next;else{if(vf(I),(I=u=I.prev)===I.next)break;p=!0}while(p||I!==u);return u}function ff(f,u,p,I,L,U,Q){if(f){!Q&&U&&function(Le,qe,et,At){var gt=Le;do gt.z===0&&(gt.z=xl(gt.x,gt.y,qe,et,At)),gt.prevZ=gt.prev,gt.nextZ=gt.next,gt=gt.next;while(gt!==Le);gt.prevZ.nextZ=null,gt.prevZ=null,function(Dt){var Lt,Rt,Kt,Ht,Qt,ui,yi,Yi,wn=1;do{for(Rt=Dt,Dt=null,Qt=null,ui=0;Rt;){for(ui++,Kt=Rt,yi=0,Lt=0;Lt<wn&&(yi++,Kt=Kt.nextZ);Lt++);for(Yi=wn;yi>0||Yi>0&&Kt;)yi!==0&&(Yi===0||!Kt||Rt.z<=Kt.z)?(Ht=Rt,Rt=Rt.nextZ,yi--):(Ht=Kt,Kt=Kt.nextZ,Yi--),Qt?Qt.nextZ=Ht:Dt=Ht,Ht.prevZ=Qt,Qt=Ht;Rt=Kt}Qt.nextZ=null,wn*=2}while(ui>1)}(gt)}(f,I,L,U);for(var re,Ae,_e=f;f.prev!==f.next;)if(re=f.prev,Ae=f.next,U?Tm(f,I,L,U):yA(f))u.push(re.i/p|0),u.push(f.i/p|0),u.push(Ae.i/p|0),vf(f),f=Ae.next,_e=Ae.next;else if((f=Ae)===_e){Q?Q===1?ff(f=Lo(lc(f),u,p),u,p,I,L,U,2):Q===2&&df(f,u,p,I,L,U):ff(lc(f),u,p,I,L,U,1);break}}}function yA(f){var u=f.prev,p=f,I=f.next;if(Da(u,p,I)>=0)return!1;for(var L=u.x,U=p.x,Q=I.x,re=u.y,Ae=p.y,_e=I.y,Le=L<U?L<Q?L:Q:U<Q?U:Q,qe=re<Ae?re<_e?re:_e:Ae<_e?Ae:_e,et=L>U?L>Q?L:Q:U>Q?U:Q,At=re>Ae?re>_e?re:_e:Ae>_e?Ae:_e,gt=I.next;gt!==u;){if(gt.x>=Le&&gt.x<=et&&gt.y>=qe&&gt.y<=At&&Qh(L,re,U,Ae,Q,_e,gt.x,gt.y)&&Da(gt.prev,gt,gt.next)>=0)return!1;gt=gt.next}return!0}function Tm(f,u,p,I){var L=f.prev,U=f,Q=f.next;if(Da(L,U,Q)>=0)return!1;for(var re=L.x,Ae=U.x,_e=Q.x,Le=L.y,qe=U.y,et=Q.y,At=re<Ae?re<_e?re:_e:Ae<_e?Ae:_e,gt=Le<qe?Le<et?Le:et:qe<et?qe:et,Dt=re>Ae?re>_e?re:_e:Ae>_e?Ae:_e,Lt=Le>qe?Le>et?Le:et:qe>et?qe:et,Rt=xl(At,gt,u,p,I),Kt=xl(Dt,Lt,u,p,I),Ht=f.prevZ,Qt=f.nextZ;Ht&&Ht.z>=Rt&&Qt&&Qt.z<=Kt;){if(Ht.x>=At&&Ht.x<=Dt&&Ht.y>=gt&&Ht.y<=Lt&&Ht!==L&&Ht!==Q&&Qh(re,Le,Ae,qe,_e,et,Ht.x,Ht.y)&&Da(Ht.prev,Ht,Ht.next)>=0||(Ht=Ht.prevZ,Qt.x>=At&&Qt.x<=Dt&&Qt.y>=gt&&Qt.y<=Lt&&Qt!==L&&Qt!==Q&&Qh(re,Le,Ae,qe,_e,et,Qt.x,Qt.y)&&Da(Qt.prev,Qt,Qt.next)>=0))return!1;Qt=Qt.nextZ}for(;Ht&&Ht.z>=Rt;){if(Ht.x>=At&&Ht.x<=Dt&&Ht.y>=gt&&Ht.y<=Lt&&Ht!==L&&Ht!==Q&&Qh(re,Le,Ae,qe,_e,et,Ht.x,Ht.y)&&Da(Ht.prev,Ht,Ht.next)>=0)return!1;Ht=Ht.prevZ}for(;Qt&&Qt.z<=Kt;){if(Qt.x>=At&&Qt.x<=Dt&&Qt.y>=gt&&Qt.y<=Lt&&Qt!==L&&Qt!==Q&&Qh(re,Le,Ae,qe,_e,et,Qt.x,Qt.y)&&Da(Qt.prev,Qt,Qt.next)>=0)return!1;Qt=Qt.nextZ}return!0}function Lo(f,u,p){var I=f;do{var L=I.prev,U=I.next.next;!cc(L,U)&&f0(L,I,I.next,U)&&Tc(L,U)&&Tc(U,L)&&(u.push(L.i/p|0),u.push(I.i/p|0),u.push(U.i/p|0),vf(I),vf(I.next),I=f=U),I=I.next}while(I!==f);return lc(I)}function df(f,u,p,I,L,U){var Q=f;do{for(var re=Q.next.next;re!==Q.prev;){if(Q.i!==re.i&&gf(Q,re)){var Ae=Wh(Q,re);return Q=lc(Q,Q.next),Ae=lc(Ae,Ae.next),ff(Q,u,p,I,L,U,0),void ff(Ae,u,p,I,L,U,0)}re=re.next}Q=Q.next}while(Q!==f)}function xp(f,u){return f.x-u.x}function pf(f,u){var p=function(L,U){var Q,re=U,Ae=L.x,_e=L.y,Le=-1/0;do{if(_e<=re.y&&_e>=re.next.y&&re.next.y!==re.y){var qe=re.x+(_e-re.y)*(re.next.x-re.x)/(re.next.y-re.y);if(qe<=Ae&&qe>Le&&(Le=qe,Q=re.x<re.next.x?re:re.next,qe===Ae))return Q}re=re.next}while(re!==U);if(!Q)return null;var et,At=Q,gt=Q.x,Dt=Q.y,Lt=1/0;re=Q;do Ae>=re.x&&re.x>=gt&&Ae!==re.x&&Qh(_e<Dt?Ae:Le,_e,gt,Dt,_e<Dt?Le:Ae,_e,re.x,re.y)&&(et=Math.abs(_e-re.y)/(Ae-re.x),Tc(re,L)&&(et<Lt||et===Lt&&(re.x>Q.x||re.x===Q.x&&mf(Q,re)))&&(Q=re,Lt=et)),re=re.next;while(re!==At);return Q}(f,u);if(!p)return u;var I=Wh(p,f);return lc(I,I.next),lc(p,p.next)}function mf(f,u){return Da(f.prev,f,u.prev)<0&&Da(u.next,f,f.next)<0}function xl(f,u,p,I,L){return(f=1431655765&((f=858993459&((f=252645135&((f=16711935&((f=(f-p)*L|0)|f<<8))|f<<4))|f<<2))|f<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-I)*L|0)|u<<8))|u<<4))|u<<2))|u<<1))<<1}function uc(f){var u=f,p=f;do(u.x<p.x||u.x===p.x&&u.y<p.y)&&(p=u),u=u.next;while(u!==f);return p}function Qh(f,u,p,I,L,U,Q,re){return(L-Q)*(u-re)>=(f-Q)*(U-re)&&(f-Q)*(I-re)>=(p-Q)*(u-re)&&(p-Q)*(U-re)>=(L-Q)*(I-re)}function gf(f,u){return f.next.i!==u.i&&f.prev.i!==u.i&&!function(p,I){var L=p;do{if(L.i!==p.i&&L.next.i!==p.i&&L.i!==I.i&&L.next.i!==I.i&&f0(L,L.next,p,I))return!0;L=L.next}while(L!==p);return!1}(f,u)&&(Tc(f,u)&&Tc(u,f)&&function(p,I){var L=p,U=!1,Q=(p.x+I.x)/2,re=(p.y+I.y)/2;do L.y>re!=L.next.y>re&&L.next.y!==L.y&&Q<(L.next.x-L.x)*(re-L.y)/(L.next.y-L.y)+L.x&&(U=!U),L=L.next;while(L!==p);return U}(f,u)&&(Da(f.prev,f,u.prev)||Da(f,u.prev,u))||cc(f,u)&&Da(f.prev,f,f.next)>0&&Da(u.prev,u,u.next)>0)}function Da(f,u,p){return(u.y-f.y)*(p.x-u.x)-(u.x-f.x)*(p.y-u.y)}function cc(f,u){return f.x===u.x&&f.y===u.y}function f0(f,u,p,I){var L=yf(Da(f,u,p)),U=yf(Da(f,u,I)),Q=yf(Da(p,I,f)),re=yf(Da(p,I,u));return L!==U&&Q!==re||!(L!==0||!_f(f,p,u))||!(U!==0||!_f(f,I,u))||!(Q!==0||!_f(p,f,I))||!(re!==0||!_f(p,u,I))}function _f(f,u,p){return u.x<=Math.max(f.x,p.x)&&u.x>=Math.min(f.x,p.x)&&u.y<=Math.max(f.y,p.y)&&u.y>=Math.min(f.y,p.y)}function yf(f){return f>0?1:f<0?-1:0}function Tc(f,u){return Da(f.prev,f,f.next)<0?Da(f,u,f.next)>=0&&Da(f,f.prev,u)>=0:Da(f,u,f.prev)<0||Da(f,f.next,u)<0}function Wh(f,u){var p=new vA(f.i,f.x,f.y),I=new vA(u.i,u.x,u.y),L=f.next,U=u.prev;return f.next=u,u.prev=f,p.next=L,L.prev=p,I.next=p,p.prev=I,U.next=I,I.prev=U,I}function wh(f,u,p,I){var L=new vA(f,u,p);return I?(L.next=I.next,L.prev=I,I.next.prev=L,I.next=L):(L.prev=L,L.next=L),L}function vf(f){f.next.prev=f.prev,f.prev.next=f.next,f.prevZ&&(f.prevZ.nextZ=f.nextZ),f.nextZ&&(f.nextZ.prevZ=f.prevZ)}function vA(f,u,p){this.i=f,this.x=u,this.y=p,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function xA(f,u,p,I){for(var L=0,U=u,Q=p-I;U<p;U+=I)L+=(f[Q]-f[U])*(f[U+1]+f[Q+1]),Q=U;return L}Cc.exports=Af,Cc.exports.default=Af,Af.deviation=function(f,u,p,I){var L=u&&u.length,U=Math.abs(xA(f,0,L?u[0]*p:f.length,p));if(L)for(var Q=0,re=u.length;Q<re;Q++)U-=Math.abs(xA(f,u[Q]*p,Q<re-1?u[Q+1]*p:f.length,p));var Ae=0;for(Q=0;Q<I.length;Q+=3){var _e=I[Q]*p,Le=I[Q+1]*p,qe=I[Q+2]*p;Ae+=Math.abs((f[_e]-f[qe])*(f[Le+1]-f[_e+1])-(f[_e]-f[Le])*(f[qe+1]-f[_e+1]))}return U===0&&Ae===0?0:Math.abs((Ae-U)/U)},Af.flatten=function(f){for(var u=f[0][0].length,p={vertices:[],holes:[],dimensions:u},I=0,L=0;L<f.length;L++){for(var U=0;U<f[L].length;U++)for(var Q=0;Q<u;Q++)p.vertices.push(f[L][U][Q]);L>0&&p.holes.push(I+=f[L-1].length)}return p};var $h=W(Cc.exports);function X0(f,u,p,I,L){bA(f,u,p||0,I||f.length-1,L||d0)}function bA(f,u,p,I,L){for(;I>p;){if(I-p>600){var U=I-p+1,Q=u-p+1,re=Math.log(U),Ae=.5*Math.exp(2*re/3),_e=.5*Math.sqrt(re*Ae*(U-Ae)/U)*(Q-U/2<0?-1:1);bA(f,u,Math.max(p,Math.floor(u-Q*Ae/U+_e)),Math.min(I,Math.floor(u+(U-Q)*Ae/U+_e)),L)}var Le=f[u],qe=p,et=I;for(Xh(f,p,u),L(f[I],Le)>0&&Xh(f,p,I);qe<et;){for(Xh(f,qe,et),qe++,et--;L(f[qe],Le)<0;)qe++;for(;L(f[et],Le)>0;)et--}L(f[p],Le)===0?Xh(f,p,et):Xh(f,++et,I),et<=u&&(p=et+1),u<=et&&(I=et-1)}}function Xh(f,u,p){var I=f[u];f[u]=f[p],f[p]=I}function d0(f,u){return f<u?-1:f>u?1:0}function Y0(f,u){const p=f.length;if(p<=1)return[f];const I=[];let L,U;for(let Q=0;Q<p;Q++){const re=lt(f[Q]);re!==0&&(f[Q].area=Math.abs(re),U===void 0&&(U=re<0),U===re<0?(L&&I.push(L),L=[f[Q]]):L.push(f[Q]))}if(L&&I.push(L),u>1)for(let Q=0;Q<I.length;Q++)I[Q].length<=u||(X0(I[Q],u,1,I[Q].length-1,bp),I[Q]=I[Q].slice(0,u));return I}function bp(f,u){return u.area-f.area}function wA(f,u,p){const I=p.patternDependencies;let L=!1;for(const U of u){const Q=U.paint.get(`${f}-pattern`);Q.isConstant()||(L=!0);const re=Q.constantOr(null);re&&(L=!0,I[re.to]=!0,I[re.from]=!0)}return L}function hc(f,u,p,I,L){const U=L.patternDependencies;for(const Q of u){const re=Q.paint.get(`${f}-pattern`).value;if(re.kind!=="constant"){let Ae=re.evaluate({zoom:I-1},p,{},L.availableImages),_e=re.evaluate({zoom:I},p,{},L.availableImages),Le=re.evaluate({zoom:I+1},p,{},L.availableImages);Ae=Ae&&Ae.name?Ae.name:Ae,_e=_e&&_e.name?_e.name:_e,Le=Le&&Le.name?Le.name:Le,U[Ae]=!0,U[_e]=!0,U[Le]=!0,p.patterns[Q.id]={min:Ae,mid:_e,max:Le}}}return p}class xf{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ri,this.indexArray=new zn,this.indexArray2=new tn,this.programConfigurations=new Au(u.layers,u.zoom),this.segments=new er,this.segments2=new er,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,I){this.hasPattern=wA("fill",this.layers,p);const L=this.layers[0].layout.get("fill-sort-key"),U=!L.isConstant(),Q=[];for(const{feature:re,id:Ae,index:_e,sourceLayerIndex:Le}of u){const qe=this.layers[0]._featureFilter.needGeometry,et=Ec(re,qe);if(!this.layers[0]._featureFilter.filter(new gn(this.zoom),et,I))continue;const At=U?L.evaluate(et,{},I,p.availableImages):void 0,gt={id:Ae,properties:re.properties,type:re.type,sourceLayerIndex:Le,index:_e,geometry:qe?et.geometry:Uh(re),patterns:{},sortKey:At};Q.push(gt)}U&&Q.sort((re,Ae)=>re.sortKey-Ae.sortKey);for(const re of Q){const{geometry:Ae,index:_e,sourceLayerIndex:Le}=re;if(this.hasPattern){const qe=hc("fill",this.layers,re,this.zoom,p);this.patternFeatures.push(qe)}else this.addFeature(re,Ae,_e,I,{});p.featureIndex.insert(u[_e].feature,Ae,_e,Le,this.index)}}update(u,p,I){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,I)}addFeatures(u,p,I){for(const L of this.patternFeatures)this.addFeature(L,L.geometry,L.index,p,I)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,Cm),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.indexBuffer2=u.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(u,p,I,L,U){for(const Q of Y0(p,500)){let re=0;for(const At of Q)re+=At.length;const Ae=this.segments.prepareSegment(re,this.layoutVertexArray,this.indexArray),_e=Ae.vertexLength,Le=[],qe=[];for(const At of Q){if(At.length===0)continue;At!==Q[0]&&qe.push(Le.length/2);const gt=this.segments2.prepareSegment(At.length,this.layoutVertexArray,this.indexArray2),Dt=gt.vertexLength;this.layoutVertexArray.emplaceBack(At[0].x,At[0].y),this.indexArray2.emplaceBack(Dt+At.length-1,Dt),Le.push(At[0].x),Le.push(At[0].y);for(let Lt=1;Lt<At.length;Lt++)this.layoutVertexArray.emplaceBack(At[Lt].x,At[Lt].y),this.indexArray2.emplaceBack(Dt+Lt-1,Dt+Lt),Le.push(At[Lt].x),Le.push(At[Lt].y);gt.vertexLength+=At.length,gt.primitiveLength+=At.length}const et=$h(Le,qe);for(let At=0;At<et.length;At+=3)this.indexArray.emplaceBack(_e+et[At],_e+et[At+1],_e+et[At+2]);Ae.vertexLength+=re,Ae.primitiveLength+=et.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,I,U,L)}}let K0,Sh;Dn("FillBucket",xf,{omit:["layers","patternFeatures"]});var eh={get paint(){return Sh=Sh||new fs({"fill-antialias":new Mi(ci.paint_fill["fill-antialias"]),"fill-opacity":new Bi(ci.paint_fill["fill-opacity"]),"fill-color":new Bi(ci.paint_fill["fill-color"]),"fill-outline-color":new Bi(ci.paint_fill["fill-outline-color"]),"fill-translate":new Mi(ci.paint_fill["fill-translate"]),"fill-translate-anchor":new Mi(ci.paint_fill["fill-translate-anchor"]),"fill-pattern":new xs(ci.paint_fill["fill-pattern"])})},get layout(){return K0=K0||new fs({"fill-sort-key":new Bi(ci.layout_fill["fill-sort-key"])})}};class wp extends Ms{constructor(u){super(u,eh)}recalculate(u,p){super.recalculate(u,p);const I=this.paint._values["fill-outline-color"];I.value.kind==="constant"&&I.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new xf(u)}queryRadius(){return Yc(this.paint.get("fill-translate"))}queryIntersectsFeature(u,p,I,L,U,Q,re){return qh(mA(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),Q.angle,re),L)}isTileClipped(){return!0}}const Sp=R([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Ip=R([{name:"a_centroid",components:2,type:"Int16"}],4),{members:J0}=Sp;var Ih={},km=he,kc=Eh;function Eh(f,u,p,I,L){this.properties={},this.extent=p,this.type=0,this._pbf=f,this._geometry=-1,this._keys=I,this._values=L,f.readFields(bf,this,u)}function bf(f,u,p){f==1?u.id=p.readVarint():f==2?function(I,L){for(var U=I.readVarint()+I.pos;I.pos<U;){var Q=L._keys[I.readVarint()],re=L._values[I.readVarint()];L.properties[Q]=re}}(p,u):f==3?u.type=p.readVarint():f==4&&(u._geometry=p.pos)}function Yh(f){for(var u,p,I=0,L=0,U=f.length,Q=U-1;L<U;Q=L++)I+=((p=f[Q]).x-(u=f[L]).x)*(u.y+p.y);return I}Eh.types=["Unknown","Point","LineString","Polygon"],Eh.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var u,p=f.readVarint()+f.pos,I=1,L=0,U=0,Q=0,re=[];f.pos<p;){if(L<=0){var Ae=f.readVarint();I=7&Ae,L=Ae>>3}if(L--,I===1||I===2)U+=f.readSVarint(),Q+=f.readSVarint(),I===1&&(u&&re.push(u),u=[]),u.push(new km(U,Q));else{if(I!==7)throw new Error("unknown command "+I);u&&u.push(u[0].clone())}}return u&&re.push(u),re},Eh.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var u=f.readVarint()+f.pos,p=1,I=0,L=0,U=0,Q=1/0,re=-1/0,Ae=1/0,_e=-1/0;f.pos<u;){if(I<=0){var Le=f.readVarint();p=7&Le,I=Le>>3}if(I--,p===1||p===2)(L+=f.readSVarint())<Q&&(Q=L),L>re&&(re=L),(U+=f.readSVarint())<Ae&&(Ae=U),U>_e&&(_e=U);else if(p!==7)throw new Error("unknown command "+p)}return[Q,Ae,re,_e]},Eh.prototype.toGeoJSON=function(f,u,p){var I,L,U=this.extent*Math.pow(2,p),Q=this.extent*f,re=this.extent*u,Ae=this.loadGeometry(),_e=Eh.types[this.type];function Le(At){for(var gt=0;gt<At.length;gt++){var Dt=At[gt];At[gt]=[360*(Dt.x+Q)/U-180,360/Math.PI*Math.atan(Math.exp((180-360*(Dt.y+re)/U)*Math.PI/180))-90]}}switch(this.type){case 1:var qe=[];for(I=0;I<Ae.length;I++)qe[I]=Ae[I][0];Le(Ae=qe);break;case 2:for(I=0;I<Ae.length;I++)Le(Ae[I]);break;case 3:for(Ae=function(At){var gt=At.length;if(gt<=1)return[At];for(var Dt,Lt,Rt=[],Kt=0;Kt<gt;Kt++){var Ht=Yh(At[Kt]);Ht!==0&&(Lt===void 0&&(Lt=Ht<0),Lt===Ht<0?(Dt&&Rt.push(Dt),Dt=[At[Kt]]):Dt.push(At[Kt]))}return Dt&&Rt.push(Dt),Rt}(Ae),I=0;I<Ae.length;I++)for(L=0;L<Ae[I].length;L++)Le(Ae[I][L])}Ae.length===1?Ae=Ae[0]:_e="Multi"+_e;var et={type:"Feature",geometry:{type:_e,coordinates:Ae},properties:this.properties};return"id"in this&&(et.id=this.id),et};var SA=kc,Kh=Cr;function Cr(f,u){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=f,this._keys=[],this._values=[],this._features=[],f.readFields(wf,this,u),this.length=this._features.length}function wf(f,u,p){f===15?u.version=p.readVarint():f===1?u.name=p.readString():f===5?u.extent=p.readVarint():f===2?u._features.push(p.pos):f===3?u._keys.push(p.readString()):f===4&&u._values.push(function(I){for(var L=null,U=I.readVarint()+I.pos;I.pos<U;){var Q=I.readVarint()>>3;L=Q===1?I.readString():Q===2?I.readFloat():Q===3?I.readDouble():Q===4?I.readVarint64():Q===5?I.readVarint():Q===6?I.readSVarint():Q===7?I.readBoolean():null}return L}(p))}Cr.prototype.feature=function(f){if(f<0||f>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[f];var u=this._pbf.readVarint()+this._pbf.pos;return new SA(this._pbf,u,this.extent,this._keys,this._values)};var ed=Kh;function Jh(f,u,p){if(f===3){var I=new ed(p,p.readVarint()+p.pos);I.length&&(u[I.name]=I)}}Ih.VectorTile=function(f,u){this.layers=f.readFields(Jh,{},u)},Ih.VectorTileFeature=kc,Ih.VectorTileLayer=Kh;const Sf=Ih.VectorTileFeature.types,IA=Math.pow(2,13);function EA(f,u,p,I,L,U,Q,re){f.emplaceBack(u,p,2*Math.floor(I*IA)+Q,L*IA*2,U*IA*2,Math.round(re))}class Ul{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new Xt,this.centroidVertexArray=new It,this.indexArray=new zn,this.programConfigurations=new Au(u.layers,u.zoom),this.segments=new er,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,I){this.features=[],this.hasPattern=wA("fill-extrusion",this.layers,p);for(const{feature:L,id:U,index:Q,sourceLayerIndex:re}of u){const Ae=this.layers[0]._featureFilter.needGeometry,_e=Ec(L,Ae);if(!this.layers[0]._featureFilter.filter(new gn(this.zoom),_e,I))continue;const Le={id:U,sourceLayerIndex:re,index:Q,geometry:Ae?_e.geometry:Uh(L),properties:L.properties,type:L.type,patterns:{}};this.hasPattern?this.features.push(hc("fill-extrusion",this.layers,Le,this.zoom,p)):this.addFeature(Le,Le.geometry,Q,I,{}),p.featureIndex.insert(L,Le.geometry,Q,re,this.index,!0)}}addFeatures(u,p,I){for(const L of this.features){const{geometry:U}=L;this.addFeature(L,U,L.index,p,I)}}update(u,p,I){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,I)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,J0),this.centroidVertexBuffer=u.createVertexBuffer(this.centroidVertexArray,Ip.members,!0),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(u,p,I,L,U){const Q={x:0,y:0,vertexCount:0};for(const re of Y0(p,500)){let Ae=0;for(const gt of re)Ae+=gt.length;let _e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const gt of re){if(gt.length===0||Pm(gt))continue;let Dt=0;for(let Lt=0;Lt<gt.length;Lt++){const Rt=gt[Lt];if(Lt>=1){const Kt=gt[Lt-1];if(!Mm(Rt,Kt)){_e.vertexLength+4>er.MAX_VERTEX_ARRAY_LENGTH&&(_e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ht=Rt.sub(Kt)._perp()._unit(),Qt=Kt.dist(Rt);Dt+Qt>32768&&(Dt=0),EA(this.layoutVertexArray,Rt.x,Rt.y,Ht.x,Ht.y,0,0,Dt),EA(this.layoutVertexArray,Rt.x,Rt.y,Ht.x,Ht.y,0,1,Dt),Q.x+=2*Rt.x,Q.y+=2*Rt.y,Q.vertexCount+=2,Dt+=Qt,EA(this.layoutVertexArray,Kt.x,Kt.y,Ht.x,Ht.y,0,0,Dt),EA(this.layoutVertexArray,Kt.x,Kt.y,Ht.x,Ht.y,0,1,Dt),Q.x+=2*Kt.x,Q.y+=2*Kt.y,Q.vertexCount+=2;const ui=_e.vertexLength;this.indexArray.emplaceBack(ui,ui+2,ui+1),this.indexArray.emplaceBack(ui+1,ui+2,ui+3),_e.vertexLength+=4,_e.primitiveLength+=2}}}}if(_e.vertexLength+Ae>er.MAX_VERTEX_ARRAY_LENGTH&&(_e=this.segments.prepareSegment(Ae,this.layoutVertexArray,this.indexArray)),Sf[u.type]!=="Polygon")continue;const Le=[],qe=[],et=_e.vertexLength;for(const gt of re)if(gt.length!==0){gt!==re[0]&&qe.push(Le.length/2);for(let Dt=0;Dt<gt.length;Dt++){const Lt=gt[Dt];EA(this.layoutVertexArray,Lt.x,Lt.y,0,0,1,1,0),Q.x+=Lt.x,Q.y+=Lt.y,Q.vertexCount+=1,Le.push(Lt.x),Le.push(Lt.y)}}const At=$h(Le,qe);for(let gt=0;gt<At.length;gt+=3)this.indexArray.emplaceBack(et+At[gt],et+At[gt+2],et+At[gt+1]);_e.primitiveLength+=At.length/3,_e.vertexLength+=Ae}for(let re=0;re<Q.vertexCount;re++)this.centroidVertexArray.emplaceBack(Math.floor(Q.x/Q.vertexCount),Math.floor(Q.y/Q.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,I,U,L)}}function Mm(f,u){return f.x===u.x&&(f.x<0||f.x>Pa)||f.y===u.y&&(f.y<0||f.y>Pa)}function Pm(f){return f.every(u=>u.x<0)||f.every(u=>u.x>Pa)||f.every(u=>u.y<0)||f.every(u=>u.y>Pa)}let td;Dn("FillExtrusionBucket",Ul,{omit:["layers","features"]});var Dm={get paint(){return td=td||new fs({"fill-extrusion-opacity":new Mi(ci["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Bi(ci["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Mi(ci["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Mi(ci["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new xs(ci["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Bi(ci["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Bi(ci["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Mi(ci["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class id extends Ms{constructor(u){super(u,Dm)}createBucket(u){return new Ul(u)}queryRadius(){return Yc(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(u,p,I,L,U,Q,re,Ae){const _e=mA(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),Q.angle,re),Le=this.paint.get("fill-extrusion-height").evaluate(p,I),qe=this.paint.get("fill-extrusion-base").evaluate(p,I),et=function(gt,Dt,Lt,Rt){const Kt=[];for(const Ht of gt){const Qt=[Ht.x,Ht.y,0,1];Dl(Qt,Qt,Dt),Kt.push(new ue(Qt[0]/Qt[3],Qt[1]/Qt[3]))}return Kt}(_e,Ae),At=function(gt,Dt,Lt,Rt){const Kt=[],Ht=[],Qt=Rt[8]*Dt,ui=Rt[9]*Dt,yi=Rt[10]*Dt,Yi=Rt[11]*Dt,wn=Rt[8]*Lt,un=Rt[9]*Lt,on=Rt[10]*Lt,dn=Rt[11]*Lt;for(const Rn of gt){const an=[],Xi=[];for(const Ln of Rn){const Nn=Ln.x,pr=Ln.y,Vr=Rt[0]*Nn+Rt[4]*pr+Rt[12],Hr=Rt[1]*Nn+Rt[5]*pr+Rt[13],Rs=Rt[2]*Nn+Rt[6]*pr+Rt[14],Ea=Rt[3]*Nn+Rt[7]*pr+Rt[15],ia=Rs+yi,ns=Ea+Yi,Wn=Vr+wn,ws=Hr+un,ir=Rs+on,na=Ea+dn,Ps=new ue((Vr+Qt)/ns,(Hr+ui)/ns);Ps.z=ia/ns,an.push(Ps);const Kn=new ue(Wn/na,ws/na);Kn.z=ir/na,Xi.push(Kn)}Kt.push(an),Ht.push(Xi)}return[Kt,Ht]}(L,qe,Le,Ae);return function(gt,Dt,Lt){let Rt=1/0;qh(Lt,Dt)&&(Rt=nd(Lt,Dt[0]));for(let Kt=0;Kt<Dt.length;Kt++){const Ht=Dt[Kt],Qt=gt[Kt];for(let ui=0;ui<Ht.length-1;ui++){const yi=Ht[ui],Yi=[yi,Ht[ui+1],Qt[ui+1],Qt[ui],yi];$c(Lt,Yi)&&(Rt=Math.min(Rt,nd(Lt,Yi)))}}return Rt!==1/0&&Rt}(At[0],At[1],et)}}function eA(f,u){return f.x*u.x+f.y*u.y}function nd(f,u){if(f.length===1){let p=0;const I=u[p++];let L;for(;!L||I.equals(L);)if(L=u[p++],!L)return 1/0;for(;p<u.length;p++){const U=u[p],Q=f[0],re=L.sub(I),Ae=U.sub(I),_e=Q.sub(I),Le=eA(re,re),qe=eA(re,Ae),et=eA(Ae,Ae),At=eA(_e,re),gt=eA(_e,Ae),Dt=Le*et-qe*qe,Lt=(et*At-qe*gt)/Dt,Rt=(Le*gt-qe*At)/Dt,Kt=I.z*(1-Lt-Rt)+L.z*Lt+U.z*Rt;if(isFinite(Kt))return Kt}return 1/0}{let p=1/0;for(const I of u)p=Math.min(p,I.z);return p}}const Ep=R([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Mc}=Ep,bu=R([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:CA}=bu,Lm=Ih.VectorTileFeature.types,p0=Math.cos(Math.PI/180*37.5),Cp=Math.pow(2,14)/.5;class rd{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(p=>{this.gradients[p.id]={}}),this.layoutVertexArray=new ti,this.layoutVertexArray2=new si,this.indexArray=new zn,this.programConfigurations=new Au(u.layers,u.zoom),this.segments=new er,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,I){this.hasPattern=wA("line",this.layers,p);const L=this.layers[0].layout.get("line-sort-key"),U=!L.isConstant(),Q=[];for(const{feature:re,id:Ae,index:_e,sourceLayerIndex:Le}of u){const qe=this.layers[0]._featureFilter.needGeometry,et=Ec(re,qe);if(!this.layers[0]._featureFilter.filter(new gn(this.zoom),et,I))continue;const At=U?L.evaluate(et,{},I):void 0,gt={id:Ae,properties:re.properties,type:re.type,sourceLayerIndex:Le,index:_e,geometry:qe?et.geometry:Uh(re),patterns:{},sortKey:At};Q.push(gt)}U&&Q.sort((re,Ae)=>re.sortKey-Ae.sortKey);for(const re of Q){const{geometry:Ae,index:_e,sourceLayerIndex:Le}=re;if(this.hasPattern){const qe=hc("line",this.layers,re,this.zoom,p);this.patternFeatures.push(qe)}else this.addFeature(re,Ae,_e,I,{});p.featureIndex.insert(u[_e].feature,Ae,_e,Le,this.index)}}update(u,p,I){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,I)}addFeatures(u,p,I){for(const L of this.patternFeatures)this.addFeature(L,L.geometry,L.index,p,I)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=u.createVertexBuffer(this.layoutVertexArray2,CA)),this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,Mc),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(u){if(u.properties&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_end"))return{start:+u.properties.mapbox_clip_start,end:+u.properties.mapbox_clip_end}}addFeature(u,p,I,L,U){const Q=this.layers[0].layout,re=Q.get("line-join").evaluate(u,{}),Ae=Q.get("line-cap"),_e=Q.get("line-miter-limit"),Le=Q.get("line-round-limit");this.lineClips=this.lineFeatureClips(u);for(const qe of p)this.addLine(qe,u,re,Ae,_e,Le);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,I,U,L)}addLine(u,p,I,L,U,Q){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Rt=0;Rt<u.length-1;Rt++)this.totalDistance+=u[Rt].dist(u[Rt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const re=Lm[p.type]==="Polygon";let Ae=u.length;for(;Ae>=2&&u[Ae-1].equals(u[Ae-2]);)Ae--;let _e=0;for(;_e<Ae-1&&u[_e].equals(u[_e+1]);)_e++;if(Ae<(re?3:2))return;I==="bevel"&&(U=1.05);const Le=this.overscaling<=16?15*Pa/(512*this.overscaling):0,qe=this.segments.prepareSegment(10*Ae,this.layoutVertexArray,this.indexArray);let et,At,gt,Dt,Lt;this.e1=this.e2=-1,re&&(et=u[Ae-2],Lt=u[_e].sub(et)._unit()._perp());for(let Rt=_e;Rt<Ae;Rt++){if(gt=Rt===Ae-1?re?u[_e+1]:void 0:u[Rt+1],gt&&u[Rt].equals(gt))continue;Lt&&(Dt=Lt),et&&(At=et),et=u[Rt],Lt=gt?gt.sub(et)._unit()._perp():Dt,Dt=Dt||Lt;let Kt=Dt.add(Lt);Kt.x===0&&Kt.y===0||Kt._unit();const Ht=Dt.x*Lt.x+Dt.y*Lt.y,Qt=Kt.x*Lt.x+Kt.y*Lt.y,ui=Qt!==0?1/Qt:1/0,yi=2*Math.sqrt(2-2*Qt),Yi=Qt<p0&&At&&gt,wn=Dt.x*Lt.y-Dt.y*Lt.x>0;if(Yi&&Rt>_e){const dn=et.dist(At);if(dn>2*Le){const Rn=et.sub(et.sub(At)._mult(Le/dn)._round());this.updateDistance(At,Rn),this.addCurrentVertex(Rn,Dt,0,0,qe),At=Rn}}const un=At&&gt;let on=un?I:re?"butt":L;if(un&&on==="round"&&(ui<Q?on="miter":ui<=2&&(on="fakeround")),on==="miter"&&ui>U&&(on="bevel"),on==="bevel"&&(ui>2&&(on="flipbevel"),ui<U&&(on="miter")),At&&this.updateDistance(At,et),on==="miter")Kt._mult(ui),this.addCurrentVertex(et,Kt,0,0,qe);else if(on==="flipbevel"){if(ui>100)Kt=Lt.mult(-1);else{const dn=ui*Dt.add(Lt).mag()/Dt.sub(Lt).mag();Kt._perp()._mult(dn*(wn?-1:1))}this.addCurrentVertex(et,Kt,0,0,qe),this.addCurrentVertex(et,Kt.mult(-1),0,0,qe)}else if(on==="bevel"||on==="fakeround"){const dn=-Math.sqrt(ui*ui-1),Rn=wn?dn:0,an=wn?0:dn;if(At&&this.addCurrentVertex(et,Dt,Rn,an,qe),on==="fakeround"){const Xi=Math.round(180*yi/Math.PI/20);for(let Ln=1;Ln<Xi;Ln++){let Nn=Ln/Xi;if(Nn!==.5){const Vr=Nn-.5;Nn+=Nn*Vr*(Nn-1)*((1.0904+Ht*(Ht*(3.55645-1.43519*Ht)-3.2452))*Vr*Vr+(.848013+Ht*(.215638*Ht-1.06021)))}const pr=Lt.sub(Dt)._mult(Nn)._add(Dt)._unit()._mult(wn?-1:1);this.addHalfVertex(et,pr.x,pr.y,!1,wn,0,qe)}}gt&&this.addCurrentVertex(et,Lt,-Rn,-an,qe)}else if(on==="butt")this.addCurrentVertex(et,Kt,0,0,qe);else if(on==="square"){const dn=At?1:-1;this.addCurrentVertex(et,Kt,dn,dn,qe)}else on==="round"&&(At&&(this.addCurrentVertex(et,Dt,0,0,qe),this.addCurrentVertex(et,Dt,1,1,qe,!0)),gt&&(this.addCurrentVertex(et,Lt,-1,-1,qe,!0),this.addCurrentVertex(et,Lt,0,0,qe)));if(Yi&&Rt<Ae-1){const dn=et.dist(gt);if(dn>2*Le){const Rn=et.add(gt.sub(et)._mult(Le/dn)._round());this.updateDistance(et,Rn),this.addCurrentVertex(Rn,Lt,0,0,qe),et=Rn}}}}addCurrentVertex(u,p,I,L,U,Q=!1){const re=p.y*L-p.x,Ae=-p.y-p.x*L;this.addHalfVertex(u,p.x+p.y*I,p.y-p.x*I,Q,!1,I,U),this.addHalfVertex(u,re,Ae,Q,!0,-L,U),this.distance>Cp/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(u,p,I,L,U,Q))}addHalfVertex({x:u,y:p},I,L,U,Q,re,Ae){const _e=.5*(this.lineClips?this.scaledDistance*(Cp-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((u<<1)+(U?1:0),(p<<1)+(Q?1:0),Math.round(63*I)+128,Math.round(63*L)+128,1+(re===0?0:re<0?-1:1)|(63&_e)<<2,_e>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Le=Ae.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Le),Ae.primitiveLength++),Q?this.e2=Le:this.e1=Le}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(u,p){this.distance+=u.dist(p),this.updateScaledDistance()}}let TA,m0;Dn("LineBucket",rd,{omit:["layers","patternFeatures"]});var sd={get paint(){return m0=m0||new fs({"line-opacity":new Bi(ci.paint_line["line-opacity"]),"line-color":new Bi(ci.paint_line["line-color"]),"line-translate":new Mi(ci.paint_line["line-translate"]),"line-translate-anchor":new Mi(ci.paint_line["line-translate-anchor"]),"line-width":new Bi(ci.paint_line["line-width"]),"line-gap-width":new Bi(ci.paint_line["line-gap-width"]),"line-offset":new Bi(ci.paint_line["line-offset"]),"line-blur":new Bi(ci.paint_line["line-blur"]),"line-dasharray":new vu(ci.paint_line["line-dasharray"]),"line-pattern":new xs(ci.paint_line["line-pattern"]),"line-gradient":new Vo(ci.paint_line["line-gradient"])})},get layout(){return TA=TA||new fs({"line-cap":new Mi(ci.layout_line["line-cap"]),"line-join":new Bi(ci.layout_line["line-join"]),"line-miter-limit":new Mi(ci.layout_line["line-miter-limit"]),"line-round-limit":new Mi(ci.layout_line["line-round-limit"]),"line-sort-key":new Bi(ci.layout_line["line-sort-key"])})}};class Bm extends Bi{possiblyEvaluate(u,p){return p=new gn(Math.floor(p.zoom),{now:p.now,fadeDuration:p.fadeDuration,zoomHistory:p.zoomHistory,transition:p.transition}),super.possiblyEvaluate(u,p)}evaluate(u,p,I,L){return p=it({},p,{zoom:Math.floor(p.zoom)}),super.evaluate(u,p,I,L)}}let Ch;class Al extends Ms{constructor(u){super(u,sd),this.gradientVersion=0,Ch||(Ch=new Bm(sd.paint.properties["line-width"].specification),Ch.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){const p=this.gradientExpression();this.stepInterpolant=!!function(I){return I._styleExpression!==void 0}(p)&&p._styleExpression.expression instanceof nr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(u,p){super.recalculate(u,p),this.paint._values["line-floorwidth"]=Ch.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new rd(u)}queryRadius(u){const p=u,I=ad(vh("line-width",this,p),vh("line-gap-width",this,p)),L=vh("line-offset",this,p);return I/2+Math.abs(L)+Yc(this.paint.get("line-translate"))}queryIntersectsFeature(u,p,I,L,U,Q,re){const Ae=mA(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),Q.angle,re),_e=re/2*ad(this.paint.get("line-width").evaluate(p,I),this.paint.get("line-gap-width").evaluate(p,I)),Le=this.paint.get("line-offset").evaluate(p,I);return Le&&(L=function(qe,et){const At=[];for(let gt=0;gt<qe.length;gt++){const Dt=qe[gt],Lt=[];for(let Rt=0;Rt<Dt.length;Rt++){const Kt=Dt[Rt-1],Ht=Dt[Rt],Qt=Dt[Rt+1],ui=Rt===0?new ue(0,0):Ht.sub(Kt)._unit()._perp(),yi=Rt===Dt.length-1?new ue(0,0):Qt.sub(Ht)._unit()._perp(),Yi=ui._add(yi)._unit(),wn=Yi.x*yi.x+Yi.y*yi.y;wn!==0&&Yi._mult(1/wn),Lt.push(Yi._mult(et)._add(Ht))}At.push(Lt)}return At}(L,Le*re)),function(qe,et,At){for(let gt=0;gt<et.length;gt++){const Dt=et[gt];if(qe.length>=3){for(let Lt=0;Lt<Dt.length;Lt++)if(Xu(qe,Dt[Lt]))return!0}if(of(qe,Dt,At))return!0}return!1}(Ae,L,_e)}isTileClipped(){return!0}}function ad(f,u){return u>0?u+2*f:f}const od=R([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ld=R([{name:"a_projected_pos",components:3,type:"Float32"}],4);R([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const fa=R([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);R([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const kA=R([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ud=R([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function MA(f,u,p){return f.sections.forEach(I=>{I.text=function(L,U,Q){const re=U.layout.get("text-transform").evaluate(Q,{});return re==="uppercase"?L=L.toLocaleUpperCase():re==="lowercase"&&(L=L.toLocaleLowerCase()),gs.applyArabicShaping&&(L=gs.applyArabicShaping(L)),L}(I.text,u,p)}),f}R([{name:"triangle",components:3,type:"Uint16"}]),R([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),R([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),R([{type:"Float32",name:"offsetX"}]),R([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),R([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const wu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Ka=24,g0=ys,If=function(f,u,p,I,L){var U,Q,re=8*L-I-1,Ae=(1<<re)-1,_e=Ae>>1,Le=-7,qe=p?L-1:0,et=p?-1:1,At=f[u+qe];for(qe+=et,U=At&(1<<-Le)-1,At>>=-Le,Le+=re;Le>0;U=256*U+f[u+qe],qe+=et,Le-=8);for(Q=U&(1<<-Le)-1,U>>=-Le,Le+=I;Le>0;Q=256*Q+f[u+qe],qe+=et,Le-=8);if(U===0)U=1-_e;else{if(U===Ae)return Q?NaN:1/0*(At?-1:1);Q+=Math.pow(2,I),U-=_e}return(At?-1:1)*Q*Math.pow(2,U-I)},cd=function(f,u,p,I,L,U){var Q,re,Ae,_e=8*U-L-1,Le=(1<<_e)-1,qe=Le>>1,et=L===23?Math.pow(2,-24)-Math.pow(2,-77):0,At=I?0:U-1,gt=I?1:-1,Dt=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(re=isNaN(u)?1:0,Q=Le):(Q=Math.floor(Math.log(u)/Math.LN2),u*(Ae=Math.pow(2,-Q))<1&&(Q--,Ae*=2),(u+=Q+qe>=1?et/Ae:et*Math.pow(2,1-qe))*Ae>=2&&(Q++,Ae/=2),Q+qe>=Le?(re=0,Q=Le):Q+qe>=1?(re=(u*Ae-1)*Math.pow(2,L),Q+=qe):(re=u*Math.pow(2,qe-1)*Math.pow(2,L),Q=0));L>=8;f[p+At]=255&re,At+=gt,re/=256,L-=8);for(Q=Q<<L|re,_e+=L;_e>0;f[p+At]=255&Q,At+=gt,Q/=256,_e-=8);f[p+At-gt]|=128*Dt};function ys(f){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(f)?f:new Uint8Array(f||0),this.pos=0,this.type=0,this.length=this.buf.length}ys.Varint=0,ys.Fixed64=1,ys.Bytes=2,ys.Fixed32=5;var th=4294967296,Tp=1/th,hd=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function ih(f){return f.type===ys.Bytes?f.readVarint()+f.pos:f.pos+1}function PA(f,u,p){return p?4294967296*u+(f>>>0):4294967296*(u>>>0)+(f>>>0)}function kp(f,u,p){var I=u<=16383?1:u<=2097151?2:u<=268435455?3:Math.floor(Math.log(u)/(7*Math.LN2));p.realloc(I);for(var L=p.pos-1;L>=f;L--)p.buf[L+I]=p.buf[L]}function _0(f,u){for(var p=0;p<f.length;p++)u.writeVarint(f[p])}function DA(f,u){for(var p=0;p<f.length;p++)u.writeSVarint(f[p])}function Mp(f,u){for(var p=0;p<f.length;p++)u.writeFloat(f[p])}function Ad(f,u){for(var p=0;p<f.length;p++)u.writeDouble(f[p])}function fd(f,u){for(var p=0;p<f.length;p++)u.writeBoolean(f[p])}function zm(f,u){for(var p=0;p<f.length;p++)u.writeFixed32(f[p])}function Rm(f,u){for(var p=0;p<f.length;p++)u.writeSFixed32(f[p])}function Fm(f,u){for(var p=0;p<f.length;p++)u.writeFixed64(f[p])}function dd(f,u){for(var p=0;p<f.length;p++)u.writeSFixed64(f[p])}function LA(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+16777216*f[u+3]}function fl(f,u,p){f[p]=u,f[p+1]=u>>>8,f[p+2]=u>>>16,f[p+3]=u>>>24}function y0(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+(f[u+3]<<24)}ys.prototype={destroy:function(){this.buf=null},readFields:function(f,u,p){for(p=p||this.length;this.pos<p;){var I=this.readVarint(),L=I>>3,U=this.pos;this.type=7&I,f(L,u,this),this.pos===U&&this.skip(I)}return u},readMessage:function(f,u){return this.readFields(f,u,this.readVarint()+this.pos)},readFixed32:function(){var f=LA(this.buf,this.pos);return this.pos+=4,f},readSFixed32:function(){var f=y0(this.buf,this.pos);return this.pos+=4,f},readFixed64:function(){var f=LA(this.buf,this.pos)+LA(this.buf,this.pos+4)*th;return this.pos+=8,f},readSFixed64:function(){var f=LA(this.buf,this.pos)+y0(this.buf,this.pos+4)*th;return this.pos+=8,f},readFloat:function(){var f=If(this.buf,this.pos,!0,23,4);return this.pos+=4,f},readDouble:function(){var f=If(this.buf,this.pos,!0,52,8);return this.pos+=8,f},readVarint:function(f){var u,p,I=this.buf;return u=127&(p=I[this.pos++]),p<128?u:(u|=(127&(p=I[this.pos++]))<<7,p<128?u:(u|=(127&(p=I[this.pos++]))<<14,p<128?u:(u|=(127&(p=I[this.pos++]))<<21,p<128?u:function(L,U,Q){var re,Ae,_e=Q.buf;if(re=(112&(Ae=_e[Q.pos++]))>>4,Ae<128||(re|=(127&(Ae=_e[Q.pos++]))<<3,Ae<128)||(re|=(127&(Ae=_e[Q.pos++]))<<10,Ae<128)||(re|=(127&(Ae=_e[Q.pos++]))<<17,Ae<128)||(re|=(127&(Ae=_e[Q.pos++]))<<24,Ae<128)||(re|=(1&(Ae=_e[Q.pos++]))<<31,Ae<128))return PA(L,re,U);throw new Error("Expected varint not more than 10 bytes")}(u|=(15&(p=I[this.pos]))<<28,f,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var f=this.readVarint();return f%2==1?(f+1)/-2:f/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var f=this.readVarint()+this.pos,u=this.pos;return this.pos=f,f-u>=12&&hd?function(p,I,L){return hd.decode(p.subarray(I,L))}(this.buf,u,f):function(p,I,L){for(var U="",Q=I;Q<L;){var re,Ae,_e,Le=p[Q],qe=null,et=Le>239?4:Le>223?3:Le>191?2:1;if(Q+et>L)break;et===1?Le<128&&(qe=Le):et===2?(192&(re=p[Q+1]))==128&&(qe=(31&Le)<<6|63&re)<=127&&(qe=null):et===3?(Ae=p[Q+2],(192&(re=p[Q+1]))==128&&(192&Ae)==128&&((qe=(15&Le)<<12|(63&re)<<6|63&Ae)<=2047||qe>=55296&&qe<=57343)&&(qe=null)):et===4&&(Ae=p[Q+2],_e=p[Q+3],(192&(re=p[Q+1]))==128&&(192&Ae)==128&&(192&_e)==128&&((qe=(15&Le)<<18|(63&re)<<12|(63&Ae)<<6|63&_e)<=65535||qe>=1114112)&&(qe=null)),qe===null?(qe=65533,et=1):qe>65535&&(qe-=65536,U+=String.fromCharCode(qe>>>10&1023|55296),qe=56320|1023&qe),U+=String.fromCharCode(qe),Q+=et}return U}(this.buf,u,f)},readBytes:function(){var f=this.readVarint()+this.pos,u=this.buf.subarray(this.pos,f);return this.pos=f,u},readPackedVarint:function(f,u){if(this.type!==ys.Bytes)return f.push(this.readVarint(u));var p=ih(this);for(f=f||[];this.pos<p;)f.push(this.readVarint(u));return f},readPackedSVarint:function(f){if(this.type!==ys.Bytes)return f.push(this.readSVarint());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readSVarint());return f},readPackedBoolean:function(f){if(this.type!==ys.Bytes)return f.push(this.readBoolean());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readBoolean());return f},readPackedFloat:function(f){if(this.type!==ys.Bytes)return f.push(this.readFloat());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readFloat());return f},readPackedDouble:function(f){if(this.type!==ys.Bytes)return f.push(this.readDouble());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readDouble());return f},readPackedFixed32:function(f){if(this.type!==ys.Bytes)return f.push(this.readFixed32());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readFixed32());return f},readPackedSFixed32:function(f){if(this.type!==ys.Bytes)return f.push(this.readSFixed32());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed32());return f},readPackedFixed64:function(f){if(this.type!==ys.Bytes)return f.push(this.readFixed64());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readFixed64());return f},readPackedSFixed64:function(f){if(this.type!==ys.Bytes)return f.push(this.readSFixed64());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed64());return f},skip:function(f){var u=7&f;if(u===ys.Varint)for(;this.buf[this.pos++]>127;);else if(u===ys.Bytes)this.pos=this.readVarint()+this.pos;else if(u===ys.Fixed32)this.pos+=4;else{if(u!==ys.Fixed64)throw new Error("Unimplemented type: "+u);this.pos+=8}},writeTag:function(f,u){this.writeVarint(f<<3|u)},realloc:function(f){for(var u=this.length||16;u<this.pos+f;)u*=2;if(u!==this.length){var p=new Uint8Array(u);p.set(this.buf),this.buf=p,this.length=u}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(f){this.realloc(4),fl(this.buf,f,this.pos),this.pos+=4},writeSFixed32:function(f){this.realloc(4),fl(this.buf,f,this.pos),this.pos+=4},writeFixed64:function(f){this.realloc(8),fl(this.buf,-1&f,this.pos),fl(this.buf,Math.floor(f*Tp),this.pos+4),this.pos+=8},writeSFixed64:function(f){this.realloc(8),fl(this.buf,-1&f,this.pos),fl(this.buf,Math.floor(f*Tp),this.pos+4),this.pos+=8},writeVarint:function(f){(f=+f||0)>268435455||f<0?function(u,p){var I,L;if(u>=0?(I=u%4294967296|0,L=u/4294967296|0):(L=~(-u/4294967296),4294967295^(I=~(-u%4294967296))?I=I+1|0:(I=0,L=L+1|0)),u>=18446744073709552e3||u<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");p.realloc(10),function(U,Q,re){re.buf[re.pos++]=127&U|128,U>>>=7,re.buf[re.pos++]=127&U|128,U>>>=7,re.buf[re.pos++]=127&U|128,U>>>=7,re.buf[re.pos++]=127&U|128,re.buf[re.pos]=127&(U>>>=7)}(I,0,p),function(U,Q){var re=(7&U)<<4;Q.buf[Q.pos++]|=re|((U>>>=3)?128:0),U&&(Q.buf[Q.pos++]=127&U|((U>>>=7)?128:0),U&&(Q.buf[Q.pos++]=127&U|((U>>>=7)?128:0),U&&(Q.buf[Q.pos++]=127&U|((U>>>=7)?128:0),U&&(Q.buf[Q.pos++]=127&U|((U>>>=7)?128:0),U&&(Q.buf[Q.pos++]=127&U)))))}(L,p)}(f,this):(this.realloc(4),this.buf[this.pos++]=127&f|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=f>>>7&127))))},writeSVarint:function(f){this.writeVarint(f<0?2*-f-1:2*f)},writeBoolean:function(f){this.writeVarint(!!f)},writeString:function(f){f=String(f),this.realloc(4*f.length),this.pos++;var u=this.pos;this.pos=function(I,L,U){for(var Q,re,Ae=0;Ae<L.length;Ae++){if((Q=L.charCodeAt(Ae))>55295&&Q<57344){if(!re){Q>56319||Ae+1===L.length?(I[U++]=239,I[U++]=191,I[U++]=189):re=Q;continue}if(Q<56320){I[U++]=239,I[U++]=191,I[U++]=189,re=Q;continue}Q=re-55296<<10|Q-56320|65536,re=null}else re&&(I[U++]=239,I[U++]=191,I[U++]=189,re=null);Q<128?I[U++]=Q:(Q<2048?I[U++]=Q>>6|192:(Q<65536?I[U++]=Q>>12|224:(I[U++]=Q>>18|240,I[U++]=Q>>12&63|128),I[U++]=Q>>6&63|128),I[U++]=63&Q|128)}return U}(this.buf,f,this.pos);var p=this.pos-u;p>=128&&kp(u,p,this),this.pos=u-1,this.writeVarint(p),this.pos+=p},writeFloat:function(f){this.realloc(4),cd(this.buf,f,this.pos,!0,23,4),this.pos+=4},writeDouble:function(f){this.realloc(8),cd(this.buf,f,this.pos,!0,52,8),this.pos+=8},writeBytes:function(f){var u=f.length;this.writeVarint(u),this.realloc(u);for(var p=0;p<u;p++)this.buf[this.pos++]=f[p]},writeRawMessage:function(f,u){this.pos++;var p=this.pos;f(u,this);var I=this.pos-p;I>=128&&kp(p,I,this),this.pos=p-1,this.writeVarint(I),this.pos+=I},writeMessage:function(f,u,p){this.writeTag(f,ys.Bytes),this.writeRawMessage(u,p)},writePackedVarint:function(f,u){u.length&&this.writeMessage(f,_0,u)},writePackedSVarint:function(f,u){u.length&&this.writeMessage(f,DA,u)},writePackedBoolean:function(f,u){u.length&&this.writeMessage(f,fd,u)},writePackedFloat:function(f,u){u.length&&this.writeMessage(f,Mp,u)},writePackedDouble:function(f,u){u.length&&this.writeMessage(f,Ad,u)},writePackedFixed32:function(f,u){u.length&&this.writeMessage(f,zm,u)},writePackedSFixed32:function(f,u){u.length&&this.writeMessage(f,Rm,u)},writePackedFixed64:function(f,u){u.length&&this.writeMessage(f,Fm,u)},writePackedSFixed64:function(f,u){u.length&&this.writeMessage(f,dd,u)},writeBytesField:function(f,u){this.writeTag(f,ys.Bytes),this.writeBytes(u)},writeFixed32Field:function(f,u){this.writeTag(f,ys.Fixed32),this.writeFixed32(u)},writeSFixed32Field:function(f,u){this.writeTag(f,ys.Fixed32),this.writeSFixed32(u)},writeFixed64Field:function(f,u){this.writeTag(f,ys.Fixed64),this.writeFixed64(u)},writeSFixed64Field:function(f,u){this.writeTag(f,ys.Fixed64),this.writeSFixed64(u)},writeVarintField:function(f,u){this.writeTag(f,ys.Varint),this.writeVarint(u)},writeSVarintField:function(f,u){this.writeTag(f,ys.Varint),this.writeSVarint(u)},writeStringField:function(f,u){this.writeTag(f,ys.Bytes),this.writeString(u)},writeFloatField:function(f,u){this.writeTag(f,ys.Fixed32),this.writeFloat(u)},writeDoubleField:function(f,u){this.writeTag(f,ys.Fixed64),this.writeDouble(u)},writeBooleanField:function(f,u){this.writeVarintField(f,!!u)}};var v0=W(g0);const Pc=3;function BA(f,u,p){f===1&&p.readMessage(Ef,u)}function Ef(f,u,p){if(f===3){const{id:I,bitmap:L,width:U,height:Q,left:re,top:Ae,advance:_e}=p.readMessage(zA,{});u.push({id:I,bitmap:new xh({width:U+2*Pc,height:Q+2*Pc},L),metrics:{width:U,height:Q,left:re,top:Ae,advance:_e}})}}function zA(f,u,p){f===1?u.id=p.readVarint():f===2?u.bitmap=p.readBytes():f===3?u.width=p.readVarint():f===4?u.height=p.readVarint():f===5?u.left=p.readSVarint():f===6?u.top=p.readSVarint():f===7&&(u.advance=p.readVarint())}const Cf=Pc;function Tf(f){let u=0,p=0;for(const Q of f)u+=Q.w*Q.h,p=Math.max(p,Q.w);f.sort((Q,re)=>re.h-Q.h);const I=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(u/.95)),p),h:1/0}];let L=0,U=0;for(const Q of f)for(let re=I.length-1;re>=0;re--){const Ae=I[re];if(!(Q.w>Ae.w||Q.h>Ae.h)){if(Q.x=Ae.x,Q.y=Ae.y,U=Math.max(U,Q.y+Q.h),L=Math.max(L,Q.x+Q.w),Q.w===Ae.w&&Q.h===Ae.h){const _e=I.pop();re<I.length&&(I[re]=_e)}else Q.h===Ae.h?(Ae.x+=Q.w,Ae.w-=Q.w):Q.w===Ae.w?(Ae.y+=Q.h,Ae.h-=Q.h):(I.push({x:Ae.x+Q.w,y:Ae.y,w:Ae.w-Q.w,h:Q.h}),Ae.y+=Q.h,Ae.h-=Q.h);break}}return{w:L,h:U,fill:u/(L*U)||0}}const Su=1;class x0{constructor(u,{pixelRatio:p,version:I,stretchX:L,stretchY:U,content:Q}){this.paddedRect=u,this.pixelRatio=p,this.stretchX=L,this.stretchY=U,this.content=Q,this.version=I}get tl(){return[this.paddedRect.x+Su,this.paddedRect.y+Su]}get br(){return[this.paddedRect.x+this.paddedRect.w-Su,this.paddedRect.y+this.paddedRect.h-Su]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Su)/this.pixelRatio,(this.paddedRect.h-2*Su)/this.pixelRatio]}}class ku{constructor(u,p){const I={},L={};this.haveRenderCallbacks=[];const U=[];this.addImages(u,I,U),this.addImages(p,L,U);const{w:Q,h:re}=Tf(U),Ae=new Ll({width:Q||1,height:re||1});for(const _e in u){const Le=u[_e],qe=I[_e].paddedRect;Ll.copy(Le.data,Ae,{x:0,y:0},{x:qe.x+Su,y:qe.y+Su},Le.data)}for(const _e in p){const Le=p[_e],qe=L[_e].paddedRect,et=qe.x+Su,At=qe.y+Su,gt=Le.data.width,Dt=Le.data.height;Ll.copy(Le.data,Ae,{x:0,y:0},{x:et,y:At},Le.data),Ll.copy(Le.data,Ae,{x:0,y:Dt-1},{x:et,y:At-1},{width:gt,height:1}),Ll.copy(Le.data,Ae,{x:0,y:0},{x:et,y:At+Dt},{width:gt,height:1}),Ll.copy(Le.data,Ae,{x:gt-1,y:0},{x:et-1,y:At},{width:1,height:Dt}),Ll.copy(Le.data,Ae,{x:0,y:0},{x:et+gt,y:At},{width:1,height:Dt})}this.image=Ae,this.iconPositions=I,this.patternPositions=L}addImages(u,p,I){for(const L in u){const U=u[L],Q={x:0,y:0,w:U.data.width+2*Su,h:U.data.height+2*Su};I.push(Q),p[L]=new x0(Q,U),U.hasRenderCallback&&this.haveRenderCallbacks.push(L)}}patchUpdatedImages(u,p){u.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const I in u.updatedImages)this.patchUpdatedImage(this.iconPositions[I],u.getImage(I),p),this.patchUpdatedImage(this.patternPositions[I],u.getImage(I),p)}patchUpdatedImage(u,p,I){if(!u||!p||u.version===p.version)return;u.version=p.version;const[L,U]=u.tl;I.update(p.data,void 0,{x:L,y:U})}}var Th;Dn("ImagePosition",x0),Dn("ImageAtlas",ku),a.ai=void 0,(Th=a.ai||(a.ai={}))[Th.none=0]="none",Th[Th.horizontal=1]="horizontal",Th[Th.vertical=2]="vertical",Th[Th.horizontalOnly=3]="horizontalOnly";const RA=-17;class FA{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(u,p){const I=new FA;return I.scale=u||1,I.fontStack=p,I}static forImage(u){const p=new FA;return p.imageName=u,p}}class nh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(u,p){const I=new nh;for(let L=0;L<u.sections.length;L++){const U=u.sections[L];U.image?I.addImageSection(U):I.addTextSection(U,p)}return I}length(){return this.text.length}getSection(u){return this.sections[this.sectionIndex[u]]}getSectionIndex(u){return this.sectionIndex[u]}getCharCode(u){return this.text.charCodeAt(u)}verticalizePunctuation(){this.text=function(u){let p="";for(let I=0;I<u.length;I++){const L=u.charCodeAt(I+1)||null,U=u.charCodeAt(I-1)||null;p+=L&&Fu(L)&&!wu[u[I+1]]||U&&Fu(U)&&!wu[u[I-1]]||!wu[u[I]]?u[I]:wu[u[I]]}return p}(this.text)}trim(){let u=0;for(let I=0;I<this.text.length&&b0[this.text.charCodeAt(I)];I++)u++;let p=this.text.length;for(let I=this.text.length-1;I>=0&&I>=u&&b0[this.text.charCodeAt(I)];I--)p--;this.text=this.text.substring(u,p),this.sectionIndex=this.sectionIndex.slice(u,p)}substring(u,p){const I=new nh;return I.text=this.text.substring(u,p),I.sectionIndex=this.sectionIndex.slice(u,p),I.sections=this.sections,I}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((u,p)=>Math.max(u,this.sections[p].scale),0)}addTextSection(u,p){this.text+=u.text,this.sections.push(FA.forText(u.scale,u.fontStack||p));const I=this.sections.length-1;for(let L=0;L<u.text.length;++L)this.sectionIndex.push(I)}addImageSection(u){const p=u.image?u.image.name:"";if(p.length===0)return void Je("Can't add FormattedSection with an empty image.");const I=this.getNextImageSectionCharCode();I?(this.text+=String.fromCharCode(I),this.sections.push(FA.forImage(p)),this.sectionIndex.push(this.sections.length-1)):Je("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function OA(f,u,p,I,L,U,Q,re,Ae,_e,Le,qe,et,At,gt,Dt){const Lt=nh.fromFeature(f,L);let Rt;qe===a.ai.vertical&&Lt.verticalizePunctuation();const{processBidirectionalText:Kt,processStyledBidirectionalText:Ht}=gs;if(Kt&&Lt.sections.length===1){Rt=[];const yi=Kt(Lt.toString(),kf(Lt,_e,U,u,I,At,gt));for(const Yi of yi){const wn=new nh;wn.text=Yi,wn.sections=Lt.sections;for(let un=0;un<Yi.length;un++)wn.sectionIndex.push(0);Rt.push(wn)}}else if(Ht){Rt=[];const yi=Ht(Lt.text,Lt.sectionIndex,kf(Lt,_e,U,u,I,At,gt));for(const Yi of yi){const wn=new nh;wn.text=Yi[0],wn.sectionIndex=Yi[1],wn.sections=Lt.sections,Rt.push(wn)}}else Rt=function(yi,Yi){const wn=[],un=yi.text;let on=0;for(const dn of Yi)wn.push(yi.substring(on,dn)),on=dn;return on<un.length&&wn.push(yi.substring(on,un.length)),wn}(Lt,kf(Lt,_e,U,u,I,At,gt));const Qt=[],ui={positionedLines:Qt,text:Lt.toString(),top:Le[1],bottom:Le[1],left:Le[0],right:Le[0],writingMode:qe,iconsInText:!1,verticalizable:!1};return function(yi,Yi,wn,un,on,dn,Rn,an,Xi,Ln,Nn,pr){let Vr=0,Hr=RA,Rs=0,Ea=0;const ia=an==="right"?1:an==="left"?0:.5;let ns=0;for(const Ps of on){Ps.trim();const Kn=Ps.getMaxScale(),La=(Kn-1)*Ka,Ja={positionedGlyphs:[],lineOffset:0};yi.positionedLines[ns]=Ja;const va=Ja.positionedGlyphs;let qo=0;if(!Ps.length()){Hr+=dn,++ns;continue}for(let ra=0;ra<Ps.length();ra++){const br=Ps.getSection(ra),wo=Ps.getSectionIndex(ra),nl=Ps.getCharCode(ra);let rl=0,Pu=null,Uu=null,zl=null,Rc=Ka;const Gu=!(Xi===a.ai.horizontal||!Nn&&!uu(nl)||Nn&&(b0[nl]||(Wn=nl,En.Arabic(Wn)||En["Arabic Supplement"](Wn)||En["Arabic Extended-A"](Wn)||En["Arabic Presentation Forms-A"](Wn)||En["Arabic Presentation Forms-B"](Wn))));if(br.imageName){const qu=un[br.imageName];if(!qu)continue;zl=br.imageName,yi.iconsInText=yi.iconsInText||!0,Uu=qu.paddedRect;const Jl=qu.displaySize;br.scale=br.scale*Ka/pr,Pu={width:Jl[0],height:Jl[1],left:Su,top:-Cf,advance:Gu?Jl[1]:Jl[0]},rl=La+(Ka-Jl[1]*br.scale),Rc=Pu.advance;const uh=Gu?Jl[0]*br.scale-Ka*Kn:Jl[1]*br.scale-Ka*Kn;uh>0&&uh>qo&&(qo=uh)}else{const qu=wn[br.fontStack],Jl=qu&&qu[nl];if(Jl&&Jl.rect)Uu=Jl.rect,Pu=Jl.metrics;else{const uh=Yi[br.fontStack],sA=uh&&uh[nl];if(!sA)continue;Pu=sA.metrics}rl=(Kn-br.scale)*Ka}Gu?(yi.verticalizable=!0,va.push({glyph:nl,imageName:zl,x:Vr,y:Hr+rl,vertical:Gu,scale:br.scale,fontStack:br.fontStack,sectionIndex:wo,metrics:Pu,rect:Uu}),Vr+=Rc*br.scale+Ln):(va.push({glyph:nl,imageName:zl,x:Vr,y:Hr+rl,vertical:Gu,scale:br.scale,fontStack:br.fontStack,sectionIndex:wo,metrics:Pu,rect:Uu}),Vr+=Pu.advance*br.scale+Ln)}va.length!==0&&(Rs=Math.max(Vr-Ln,Rs),Nm(va,0,va.length-1,ia,qo)),Vr=0;const uo=dn*Kn+qo;Ja.lineOffset=Math.max(qo,La),Hr+=uo,Ea=Math.max(uo,Ea),++ns}var Wn;const ws=Hr-RA,{horizontalAlign:ir,verticalAlign:na}=gd(Rn);(function(Ps,Kn,La,Ja,va,qo,uo,ra,br){const wo=(Kn-La)*va;let nl=0;nl=qo!==uo?-ra*Ja-RA:(-Ja*br+.5)*uo;for(const rl of Ps)for(const Pu of rl.positionedGlyphs)Pu.x+=wo,Pu.y+=nl})(yi.positionedLines,ia,ir,na,Rs,Ea,dn,ws,on.length),yi.top+=-na*ws,yi.bottom=yi.top+ws,yi.left+=-ir*Rs,yi.right=yi.left+Rs}(ui,u,p,I,Rt,Q,re,Ae,qe,_e,et,Dt),!function(yi){for(const Yi of yi)if(Yi.positionedGlyphs.length!==0)return!1;return!0}(Qt)&&ui}const b0={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Om={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function pd(f,u,p,I,L,U){if(u.imageName){const Q=I[u.imageName];return Q?Q.displaySize[0]*u.scale*Ka/U+L:0}{const Q=p[u.fontStack],re=Q&&Q[f];return re?re.metrics.advance*u.scale+L:0}}function kh(f,u,p,I){const L=Math.pow(f-u,2);return I?f<u?L/2:2*L:L+Math.abs(p)*p}function Dc(f,u,p){let I=0;return f===10&&(I-=1e4),p&&(I+=150),f!==40&&f!==65288||(I+=50),u!==41&&u!==65289||(I+=50),I}function rh(f,u,p,I,L,U){let Q=null,re=kh(u,p,L,U);for(const Ae of I){const _e=kh(u-Ae.x,p,L,U)+Ae.badness;_e<=re&&(Q=Ae,re=_e)}return{index:f,x:u,priorBreak:Q,badness:re}}function md(f){return f?md(f.priorBreak).concat(f.index):[]}function kf(f,u,p,I,L,U,Q){if(U!=="point")return[];if(!f)return[];const re=[],Ae=function(et,At,gt,Dt,Lt,Rt){let Kt=0;for(let Ht=0;Ht<et.length();Ht++){const Qt=et.getSection(Ht);Kt+=pd(et.getCharCode(Ht),Qt,Dt,Lt,At,Rt)}return Kt/Math.max(1,Math.ceil(Kt/gt))}(f,u,p,I,L,Q),_e=f.text.indexOf("")>=0;let Le=0;for(let et=0;et<f.length();et++){const At=f.getSection(et),gt=f.getCharCode(et);if(b0[gt]||(Le+=pd(gt,At,I,L,u,Q)),et<f.length()-1){const Dt=!((qe=gt)<11904||!(En["Bopomofo Extended"](qe)||En.Bopomofo(qe)||En["CJK Compatibility Forms"](qe)||En["CJK Compatibility Ideographs"](qe)||En["CJK Compatibility"](qe)||En["CJK Radicals Supplement"](qe)||En["CJK Strokes"](qe)||En["CJK Symbols and Punctuation"](qe)||En["CJK Unified Ideographs Extension A"](qe)||En["CJK Unified Ideographs"](qe)||En["Enclosed CJK Letters and Months"](qe)||En["Halfwidth and Fullwidth Forms"](qe)||En.Hiragana(qe)||En["Ideographic Description Characters"](qe)||En["Kangxi Radicals"](qe)||En["Katakana Phonetic Extensions"](qe)||En.Katakana(qe)||En["Vertical Forms"](qe)||En["Yi Radicals"](qe)||En["Yi Syllables"](qe)));(Om[gt]||Dt||At.imageName)&&re.push(rh(et+1,Le,Ae,re,Dc(gt,f.getCharCode(et+1),Dt&&_e),!1))}}var qe;return md(rh(f.length(),Le,Ae,re,0,!0))}function gd(f){let u=.5,p=.5;switch(f){case"right":case"top-right":case"bottom-right":u=1;break;case"left":case"top-left":case"bottom-left":u=0}switch(f){case"bottom":case"bottom-right":case"bottom-left":p=1;break;case"top":case"top-right":case"top-left":p=0}return{horizontalAlign:u,verticalAlign:p}}function Nm(f,u,p,I,L){if(!I&&!L)return;const U=f[p],Q=(f[p].x+U.metrics.advance*U.scale)*I;for(let re=u;re<=p;re++)f[re].x-=Q,f[re].y+=L}function w0(f,u,p){const{horizontalAlign:I,verticalAlign:L}=gd(p),U=u[0]-f.displaySize[0]*I,Q=u[1]-f.displaySize[1]*L;return{image:f,top:Q,bottom:Q+f.displaySize[1],left:U,right:U+f.displaySize[0]}}function S0(f,u,p,I,L,U){const Q=f.image;let re;if(Q.content){const Lt=Q.content,Rt=Q.pixelRatio||1;re=[Lt[0]/Rt,Lt[1]/Rt,Q.displaySize[0]-Lt[2]/Rt,Q.displaySize[1]-Lt[3]/Rt]}const Ae=u.left*U,_e=u.right*U;let Le,qe,et,At;p==="width"||p==="both"?(At=L[0]+Ae-I[3],qe=L[0]+_e+I[1]):(At=L[0]+(Ae+_e-Q.displaySize[0])/2,qe=At+Q.displaySize[0]);const gt=u.top*U,Dt=u.bottom*U;return p==="height"||p==="both"?(Le=L[1]+gt-I[0],et=L[1]+Dt+I[2]):(Le=L[1]+(gt+Dt-Q.displaySize[1])/2,et=Le+Q.displaySize[1]),{image:Q,top:Le,right:qe,bottom:et,left:At,collisionPadding:re}}const Mf=255,Yu=128,Lc=Mf*Yu;function tA(f,u){const{expression:p}=u;if(p.kind==="constant")return{kind:"constant",layoutSize:p.evaluate(new gn(f+1))};if(p.kind==="source")return{kind:"source"};{const{zoomStops:I,interpolationType:L}=p;let U=0;for(;U<I.length&&I[U]<=f;)U++;U=Math.max(0,U-1);let Q=U;for(;Q<I.length&&I[Q]<f+1;)Q++;Q=Math.min(I.length-1,Q);const re=I[U],Ae=I[Q];return p.kind==="composite"?{kind:"composite",minZoom:re,maxZoom:Ae,interpolationType:L}:{kind:"camera",minZoom:re,maxZoom:Ae,minSize:p.evaluate(new gn(re)),maxSize:p.evaluate(new gn(Ae)),interpolationType:L}}}function I0(f,u,p){let I="never";const L=f.get(u);return L?I=L:f.get(p)&&(I="always"),I}const Pp=Ih.VectorTileFeature.types,_d=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Pf(f,u,p,I,L,U,Q,re,Ae,_e,Le,qe,et){const At=re?Math.min(Lc,Math.round(re[0])):0,gt=re?Math.min(Lc,Math.round(re[1])):0;f.emplaceBack(u,p,Math.round(32*I),Math.round(32*L),U,Q,(At<<1)+(Ae?1:0),gt,16*_e,16*Le,256*qe,256*et)}function NA(f,u,p){f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p)}function Dp(f){for(const u of f.sections)if(ta(u.text))return!0;return!1}class yd{constructor(u){this.layoutVertexArray=new Wi,this.indexArray=new zn,this.programConfigurations=u,this.segments=new er,this.dynamicLayoutVertexArray=new Ei,this.opacityVertexArray=new Gi,this.hasVisibleVertices=!1,this.placedSymbolArray=new ce}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(u,p,I,L){this.isEmpty()||(I&&(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,od.members),this.indexBuffer=u.createIndexBuffer(this.indexArray,p),this.dynamicLayoutVertexBuffer=u.createVertexBuffer(this.dynamicLayoutVertexArray,ld.members,!0),this.opacityVertexBuffer=u.createVertexBuffer(this.opacityVertexArray,_d,!0),this.opacityVertexBuffer.itemSize=1),(I||L)&&this.programConfigurations.upload(u))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Dn("SymbolBuffers",yd);class vd{constructor(u,p,I){this.layoutVertexArray=new u,this.layoutAttributes=p,this.indexArray=new I,this.segments=new er,this.collisionVertexArray=new cn}upload(u){this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=u.createVertexBuffer(this.collisionVertexArray,fa.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Dn("CollisionBuffers",vd);class sh{constructor(u){this.collisionBoxArray=u.collisionBoxArray,this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(Q=>Q.id),this.index=u.index,this.pixelRatio=u.pixelRatio,this.sourceLayerIndex=u.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=jh([]),this.placementViewportMatrix=jh([]);const p=this.layers[0]._unevaluatedLayout._values;this.textSizeData=tA(this.zoom,p["text-size"]),this.iconSizeData=tA(this.zoom,p["icon-size"]);const I=this.layers[0].layout,L=I.get("symbol-sort-key"),U=I.get("symbol-z-order");this.canOverlap=I0(I,"text-overlap","text-allow-overlap")!=="never"||I0(I,"icon-overlap","icon-allow-overlap")!=="never"||I.get("text-ignore-placement")||I.get("icon-ignore-placement"),this.sortFeaturesByKey=U!=="viewport-y"&&!L.isConstant(),this.sortFeaturesByY=(U==="viewport-y"||U==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,I.get("symbol-placement")==="point"&&(this.writingModes=I.get("text-writing-mode").map(Q=>a.ai[Q])),this.stateDependentLayerIds=this.layers.filter(Q=>Q.isStateDependent()).map(Q=>Q.id),this.sourceID=u.sourceID}createArrays(){this.text=new yd(new Au(this.layers,this.zoom,u=>/^text/.test(u))),this.icon=new yd(new Au(this.layers,this.zoom,u=>/^icon/.test(u))),this.glyphOffsetArray=new Re,this.lineVertexArray=new Be,this.symbolInstances=new Te,this.textAnchorOffsets=new yt}calculateGlyphDependencies(u,p,I,L,U){for(let Q=0;Q<u.length;Q++)if(p[u.charCodeAt(Q)]=!0,(I||L)&&U){const re=wu[u.charAt(Q)];re&&(p[re.charCodeAt(0)]=!0)}}populate(u,p,I){const L=this.layers[0],U=L.layout,Q=U.get("text-font"),re=U.get("text-field"),Ae=U.get("icon-image"),_e=(re.value.kind!=="constant"||re.value.value instanceof Wt&&!re.value.value.isEmpty()||re.value.value.toString().length>0)&&(Q.value.kind!=="constant"||Q.value.value.length>0),Le=Ae.value.kind!=="constant"||!!Ae.value.value||Object.keys(Ae.parameters).length>0,qe=U.get("symbol-sort-key");if(this.features=[],!_e&&!Le)return;const et=p.iconDependencies,At=p.glyphDependencies,gt=p.availableImages,Dt=new gn(this.zoom);for(const{feature:Lt,id:Rt,index:Kt,sourceLayerIndex:Ht}of u){const Qt=L._featureFilter.needGeometry,ui=Ec(Lt,Qt);if(!L._featureFilter.filter(Dt,ui,I))continue;let yi,Yi;if(Qt||(ui.geometry=Uh(Lt)),_e){const un=L.getValueAndResolveTokens("text-field",ui,I,gt),on=Wt.factory(un);Dp(on)&&(this.hasRTLText=!0),(!this.hasRTLText||Nu()==="unavailable"||this.hasRTLText&&gs.isParsed())&&(yi=MA(on,L,ui))}if(Le){const un=L.getValueAndResolveTokens("icon-image",ui,I,gt);Yi=un instanceof cr?un:cr.fromString(un)}if(!yi&&!Yi)continue;const wn=this.sortFeaturesByKey?qe.evaluate(ui,{},I):void 0;if(this.features.push({id:Rt,text:yi,icon:Yi,index:Kt,sourceLayerIndex:Ht,geometry:ui.geometry,properties:Lt.properties,type:Pp[Lt.type],sortKey:wn}),Yi&&(et[Yi.name]=!0),yi){const un=Q.evaluate(ui,{},I).join(","),on=U.get("text-rotation-alignment")!=="viewport"&&U.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(a.ai.vertical)>=0;for(const dn of yi.sections)if(dn.image)et[dn.image.name]=!0;else{const Rn=Wl(yi.toString()),an=dn.fontStack||un,Xi=At[an]=At[an]||{};this.calculateGlyphDependencies(dn.text,Xi,on,this.allowVerticalPlacement,Rn)}}}U.get("symbol-placement")==="line"&&(this.features=function(Lt){const Rt={},Kt={},Ht=[];let Qt=0;function ui(un){Ht.push(Lt[un]),Qt++}function yi(un,on,dn){const Rn=Kt[un];return delete Kt[un],Kt[on]=Rn,Ht[Rn].geometry[0].pop(),Ht[Rn].geometry[0]=Ht[Rn].geometry[0].concat(dn[0]),Rn}function Yi(un,on,dn){const Rn=Rt[on];return delete Rt[on],Rt[un]=Rn,Ht[Rn].geometry[0].shift(),Ht[Rn].geometry[0]=dn[0].concat(Ht[Rn].geometry[0]),Rn}function wn(un,on,dn){const Rn=dn?on[0][on[0].length-1]:on[0][0];return`${un}:${Rn.x}:${Rn.y}`}for(let un=0;un<Lt.length;un++){const on=Lt[un],dn=on.geometry,Rn=on.text?on.text.toString():null;if(!Rn){ui(un);continue}const an=wn(Rn,dn),Xi=wn(Rn,dn,!0);if(an in Kt&&Xi in Rt&&Kt[an]!==Rt[Xi]){const Ln=Yi(an,Xi,dn),Nn=yi(an,Xi,Ht[Ln].geometry);delete Rt[an],delete Kt[Xi],Kt[wn(Rn,Ht[Nn].geometry,!0)]=Nn,Ht[Ln].geometry=null}else an in Kt?yi(an,Xi,dn):Xi in Rt?Yi(an,Xi,dn):(ui(un),Rt[an]=Qt-1,Kt[Xi]=Qt-1)}return Ht.filter(un=>un.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Lt,Rt)=>Lt.sortKey-Rt.sortKey)}update(u,p,I){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(u,p,this.layers,I),this.icon.programConfigurations.updatePaintArrays(u,p,this.layers,I))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(u){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(u),this.iconCollisionBox.upload(u)),this.text.upload(u,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(u,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(u,p){const I=this.lineVertexArray.length;if(u.segment!==void 0){let L=u.dist(p[u.segment+1]),U=u.dist(p[u.segment]);const Q={};for(let re=u.segment+1;re<p.length;re++)Q[re]={x:p[re].x,y:p[re].y,tileUnitDistanceFromAnchor:L},re<p.length-1&&(L+=p[re+1].dist(p[re]));for(let re=u.segment||0;re>=0;re--)Q[re]={x:p[re].x,y:p[re].y,tileUnitDistanceFromAnchor:U},re>0&&(U+=p[re-1].dist(p[re]));for(let re=0;re<p.length;re++){const Ae=Q[re];this.lineVertexArray.emplaceBack(Ae.x,Ae.y,Ae.tileUnitDistanceFromAnchor)}}return{lineStartIndex:I,lineLength:this.lineVertexArray.length-I}}addSymbols(u,p,I,L,U,Q,re,Ae,_e,Le,qe,et){const At=u.indexArray,gt=u.layoutVertexArray,Dt=u.segments.prepareSegment(4*p.length,gt,At,this.canOverlap?Q.sortKey:void 0),Lt=this.glyphOffsetArray.length,Rt=Dt.vertexLength,Kt=this.allowVerticalPlacement&&re===a.ai.vertical?Math.PI/2:0,Ht=Q.text&&Q.text.sections;for(let Qt=0;Qt<p.length;Qt++){const{tl:ui,tr:yi,bl:Yi,br:wn,tex:un,pixelOffsetTL:on,pixelOffsetBR:dn,minFontScaleX:Rn,minFontScaleY:an,glyphOffset:Xi,isSDF:Ln,sectionIndex:Nn}=p[Qt],pr=Dt.vertexLength,Vr=Xi[1];Pf(gt,Ae.x,Ae.y,ui.x,Vr+ui.y,un.x,un.y,I,Ln,on.x,on.y,Rn,an),Pf(gt,Ae.x,Ae.y,yi.x,Vr+yi.y,un.x+un.w,un.y,I,Ln,dn.x,on.y,Rn,an),Pf(gt,Ae.x,Ae.y,Yi.x,Vr+Yi.y,un.x,un.y+un.h,I,Ln,on.x,dn.y,Rn,an),Pf(gt,Ae.x,Ae.y,wn.x,Vr+wn.y,un.x+un.w,un.y+un.h,I,Ln,dn.x,dn.y,Rn,an),NA(u.dynamicLayoutVertexArray,Ae,Kt),At.emplaceBack(pr,pr+1,pr+2),At.emplaceBack(pr+1,pr+2,pr+3),Dt.vertexLength+=4,Dt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Xi[0]),Qt!==p.length-1&&Nn===p[Qt+1].sectionIndex||u.programConfigurations.populatePaintArrays(gt.length,Q,Q.index,{},et,Ht&&Ht[Nn])}u.placedSymbolArray.emplaceBack(Ae.x,Ae.y,Lt,this.glyphOffsetArray.length-Lt,Rt,_e,Le,Ae.segment,I?I[0]:0,I?I[1]:0,L[0],L[1],re,0,!1,0,qe)}_addCollisionDebugVertex(u,p,I,L,U,Q){return p.emplaceBack(0,0),u.emplaceBack(I.x,I.y,L,U,Math.round(Q.x),Math.round(Q.y))}addCollisionDebugVertices(u,p,I,L,U,Q,re){const Ae=U.segments.prepareSegment(4,U.layoutVertexArray,U.indexArray),_e=Ae.vertexLength,Le=U.layoutVertexArray,qe=U.collisionVertexArray,et=re.anchorX,At=re.anchorY;this._addCollisionDebugVertex(Le,qe,Q,et,At,new ue(u,p)),this._addCollisionDebugVertex(Le,qe,Q,et,At,new ue(I,p)),this._addCollisionDebugVertex(Le,qe,Q,et,At,new ue(I,L)),this._addCollisionDebugVertex(Le,qe,Q,et,At,new ue(u,L)),Ae.vertexLength+=4;const gt=U.indexArray;gt.emplaceBack(_e,_e+1),gt.emplaceBack(_e+1,_e+2),gt.emplaceBack(_e+2,_e+3),gt.emplaceBack(_e+3,_e),Ae.primitiveLength+=4}addDebugCollisionBoxes(u,p,I,L){for(let U=u;U<p;U++){const Q=this.collisionBoxArray.get(U);this.addCollisionDebugVertices(Q.x1,Q.y1,Q.x2,Q.y2,L?this.textCollisionBox:this.iconCollisionBox,Q.anchorPoint,I)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new vd(qi,kA.members,tn),this.iconCollisionBox=new vd(qi,kA.members,tn);for(let u=0;u<this.symbolInstances.length;u++){const p=this.symbolInstances.get(u);this.addDebugCollisionBoxes(p.textBoxStartIndex,p.textBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.iconBoxStartIndex,p.iconBoxEndIndex,p,!1),this.addDebugCollisionBoxes(p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p,!1)}}_deserializeCollisionBoxesForSymbol(u,p,I,L,U,Q,re,Ae,_e){const Le={};for(let qe=p;qe<I;qe++){const et=u.get(qe);Le.textBox={x1:et.x1,y1:et.y1,x2:et.x2,y2:et.y2,anchorPointX:et.anchorPointX,anchorPointY:et.anchorPointY},Le.textFeatureIndex=et.featureIndex;break}for(let qe=L;qe<U;qe++){const et=u.get(qe);Le.verticalTextBox={x1:et.x1,y1:et.y1,x2:et.x2,y2:et.y2,anchorPointX:et.anchorPointX,anchorPointY:et.anchorPointY},Le.verticalTextFeatureIndex=et.featureIndex;break}for(let qe=Q;qe<re;qe++){const et=u.get(qe);Le.iconBox={x1:et.x1,y1:et.y1,x2:et.x2,y2:et.y2,anchorPointX:et.anchorPointX,anchorPointY:et.anchorPointY},Le.iconFeatureIndex=et.featureIndex;break}for(let qe=Ae;qe<_e;qe++){const et=u.get(qe);Le.verticalIconBox={x1:et.x1,y1:et.y1,x2:et.x2,y2:et.y2,anchorPointX:et.anchorPointX,anchorPointY:et.anchorPointY},Le.verticalIconFeatureIndex=et.featureIndex;break}return Le}deserializeCollisionBoxes(u){this.collisionArrays=[];for(let p=0;p<this.symbolInstances.length;p++){const I=this.symbolInstances.get(p);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(u,I.textBoxStartIndex,I.textBoxEndIndex,I.verticalTextBoxStartIndex,I.verticalTextBoxEndIndex,I.iconBoxStartIndex,I.iconBoxEndIndex,I.verticalIconBoxStartIndex,I.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(u,p){const I=u.placedSymbolArray.get(p),L=I.vertexStartIndex+4*I.numGlyphs;for(let U=I.vertexStartIndex;U<L;U+=4)u.indexArray.emplaceBack(U,U+1,U+2),u.indexArray.emplaceBack(U+1,U+2,U+3)}getSortedSymbolIndexes(u){if(this.sortedAngle===u&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const p=Math.sin(u),I=Math.cos(u),L=[],U=[],Q=[];for(let re=0;re<this.symbolInstances.length;++re){Q.push(re);const Ae=this.symbolInstances.get(re);L.push(0|Math.round(p*Ae.anchorX+I*Ae.anchorY)),U.push(Ae.featureIndex)}return Q.sort((re,Ae)=>L[re]-L[Ae]||U[Ae]-U[re]),Q}addToSortKeyRanges(u,p){const I=this.sortKeyRanges[this.sortKeyRanges.length-1];I&&I.sortKey===p?I.symbolInstanceEnd=u+1:this.sortKeyRanges.push({sortKey:p,symbolInstanceStart:u,symbolInstanceEnd:u+1})}sortFeatures(u){if(this.sortFeaturesByY&&this.sortedAngle!==u&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(u),this.sortedAngle=u,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const p of this.symbolInstanceIndexes){const I=this.symbolInstances.get(p);this.featureSortOrder.push(I.featureIndex),[I.rightJustifiedTextSymbolIndex,I.centerJustifiedTextSymbolIndex,I.leftJustifiedTextSymbolIndex].forEach((L,U,Q)=>{L>=0&&Q.indexOf(L)===U&&this.addIndicesForPlacedSymbol(this.text,L)}),I.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,I.verticalPlacedTextSymbolIndex),I.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,I.placedIconSymbolIndex),I.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,I.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let xd,Lp;Dn("SymbolBucket",sh,{omit:["layers","collisionBoxArray","features","compareText"]}),sh.MAX_GLYPHS=65535,sh.addDynamicAttributes=NA;var bd={get paint(){return Lp=Lp||new fs({"icon-opacity":new Bi(ci.paint_symbol["icon-opacity"]),"icon-color":new Bi(ci.paint_symbol["icon-color"]),"icon-halo-color":new Bi(ci.paint_symbol["icon-halo-color"]),"icon-halo-width":new Bi(ci.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Bi(ci.paint_symbol["icon-halo-blur"]),"icon-translate":new Mi(ci.paint_symbol["icon-translate"]),"icon-translate-anchor":new Mi(ci.paint_symbol["icon-translate-anchor"]),"text-opacity":new Bi(ci.paint_symbol["text-opacity"]),"text-color":new Bi(ci.paint_symbol["text-color"],{runtimeType:ft,getOverride:f=>f.textColor,hasOverride:f=>!!f.textColor}),"text-halo-color":new Bi(ci.paint_symbol["text-halo-color"]),"text-halo-width":new Bi(ci.paint_symbol["text-halo-width"]),"text-halo-blur":new Bi(ci.paint_symbol["text-halo-blur"]),"text-translate":new Mi(ci.paint_symbol["text-translate"]),"text-translate-anchor":new Mi(ci.paint_symbol["text-translate-anchor"])})},get layout(){return xd=xd||new fs({"symbol-placement":new Mi(ci.layout_symbol["symbol-placement"]),"symbol-spacing":new Mi(ci.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Mi(ci.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Bi(ci.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Mi(ci.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Mi(ci.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Mi(ci.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Mi(ci.layout_symbol["icon-ignore-placement"]),"icon-optional":new Mi(ci.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Mi(ci.layout_symbol["icon-rotation-alignment"]),"icon-size":new Bi(ci.layout_symbol["icon-size"]),"icon-text-fit":new Mi(ci.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Mi(ci.layout_symbol["icon-text-fit-padding"]),"icon-image":new Bi(ci.layout_symbol["icon-image"]),"icon-rotate":new Bi(ci.layout_symbol["icon-rotate"]),"icon-padding":new Bi(ci.layout_symbol["icon-padding"]),"icon-keep-upright":new Mi(ci.layout_symbol["icon-keep-upright"]),"icon-offset":new Bi(ci.layout_symbol["icon-offset"]),"icon-anchor":new Bi(ci.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Mi(ci.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Mi(ci.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Mi(ci.layout_symbol["text-rotation-alignment"]),"text-field":new Bi(ci.layout_symbol["text-field"]),"text-font":new Bi(ci.layout_symbol["text-font"]),"text-size":new Bi(ci.layout_symbol["text-size"]),"text-max-width":new Bi(ci.layout_symbol["text-max-width"]),"text-line-height":new Mi(ci.layout_symbol["text-line-height"]),"text-letter-spacing":new Bi(ci.layout_symbol["text-letter-spacing"]),"text-justify":new Bi(ci.layout_symbol["text-justify"]),"text-radial-offset":new Bi(ci.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Mi(ci.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Bi(ci.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Bi(ci.layout_symbol["text-anchor"]),"text-max-angle":new Mi(ci.layout_symbol["text-max-angle"]),"text-writing-mode":new Mi(ci.layout_symbol["text-writing-mode"]),"text-rotate":new Bi(ci.layout_symbol["text-rotate"]),"text-padding":new Mi(ci.layout_symbol["text-padding"]),"text-keep-upright":new Mi(ci.layout_symbol["text-keep-upright"]),"text-transform":new Bi(ci.layout_symbol["text-transform"]),"text-offset":new Bi(ci.layout_symbol["text-offset"]),"text-allow-overlap":new Mi(ci.layout_symbol["text-allow-overlap"]),"text-overlap":new Mi(ci.layout_symbol["text-overlap"]),"text-ignore-placement":new Mi(ci.layout_symbol["text-ignore-placement"]),"text-optional":new Mi(ci.layout_symbol["text-optional"])})}};class Bp{constructor(u){if(u.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=u.property.overrides?u.property.overrides.runtimeType:We,this.defaultValue=u}evaluate(u){if(u.formattedSection){const p=this.defaultValue.property.overrides;if(p&&p.hasOverride(u.formattedSection))return p.getOverride(u.formattedSection)}return u.feature&&u.featureState?this.defaultValue.evaluate(u.feature,u.featureState):this.defaultValue.property.specification.default}eachChild(u){this.defaultValue.isConstant()||u(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Dn("FormatSectionOverride",Bp,{omit:["defaultValue"]});class VA extends Ms{constructor(u){super(u,bd)}recalculate(u,p){if(super.recalculate(u,p),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const I=this.layout.get("text-writing-mode");if(I){const L=[];for(const U of I)L.indexOf(U)<0&&L.push(U);this.layout._values["text-writing-mode"]=L}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(u,p,I,L){const U=this.layout.get(u).evaluate(p,{},I,L),Q=this._unevaluatedLayout._values[u];return Q.isDataDriven()||es(Q.value)||!U?U:function(re,Ae){return Ae.replace(/{([^{}]+)}/g,(_e,Le)=>re&&Le in re?String(re[Le]):"")}(p.properties,U)}createBucket(u){return new sh(u)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const u of bd.paint.overridableProperties){if(!VA.hasPaintOverride(this.layout,u))continue;const p=this.paint.get(u),I=new Bp(p),L=new Ol(I,p.property.specification);let U=null;U=p.value.kind==="constant"||p.value.kind==="source"?new Ts("source",L):new kr("composite",L,p.value.zoomStops),this.paint._values[u]=new vs(p.property,U,p.parameters)}}_handleOverridablePaintPropertyUpdate(u,p,I){return!(!this.layout||p.isDataDriven()||I.isDataDriven())&&VA.hasPaintOverride(this.layout,u)}static hasPaintOverride(u,p){const I=u.get("text-field"),L=bd.paint.properties[p];let U=!1;const Q=re=>{for(const Ae of re)if(L.overrides&&L.overrides.hasOverride(Ae))return void(U=!0)};if(I.value.kind==="constant"&&I.value.value instanceof Wt)Q(I.value.value.sections);else if(I.value.kind==="source"){const re=_e=>{U||(_e instanceof Bt&&Vt(_e.value)===ne?Q(_e.value.sections):_e instanceof so?Q(_e.sections):_e.eachChild(re))},Ae=I.value;Ae._styleExpression&&re(Ae._styleExpression.expression)}return U}}let ah;var zp={get paint(){return ah=ah||new fs({"background-color":new Mi(ci.paint_background["background-color"]),"background-pattern":new vu(ci.paint_background["background-pattern"]),"background-opacity":new Mi(ci.paint_background["background-opacity"])})}};class Rp extends Ms{constructor(u){super(u,zp)}}let wd;var Sd={get paint(){return wd=wd||new fs({"raster-opacity":new Mi(ci.paint_raster["raster-opacity"]),"raster-hue-rotate":new Mi(ci.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Mi(ci.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Mi(ci.paint_raster["raster-brightness-max"]),"raster-saturation":new Mi(ci.paint_raster["raster-saturation"]),"raster-contrast":new Mi(ci.paint_raster["raster-contrast"]),"raster-resampling":new Mi(ci.paint_raster["raster-resampling"]),"raster-fade-duration":new Mi(ci.paint_raster["raster-fade-duration"])})}};class Fp extends Ms{constructor(u){super(u,Sd)}}class UA extends Ms{constructor(u){super(u,{}),this.onAdd=p=>{this.implementation.onAdd&&this.implementation.onAdd(p,p.painter.context.gl)},this.onRemove=p=>{this.implementation.onRemove&&this.implementation.onRemove(p,p.painter.context.gl)},this.implementation=u}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class E0{constructor(u){this._callback=u,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const C0=63710088e-1;class Bc{constructor(u,p){if(isNaN(u)||isNaN(p))throw new Error(`Invalid LngLat object: (${u}, ${p})`);if(this.lng=+u,this.lat=+p,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Bc(jt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(u){const p=Math.PI/180,I=this.lat*p,L=u.lat*p,U=Math.sin(I)*Math.sin(L)+Math.cos(I)*Math.cos(L)*Math.cos((u.lng-this.lng)*p);return C0*Math.acos(Math.min(U,1))}static convert(u){if(u instanceof Bc)return u;if(Array.isArray(u)&&(u.length===2||u.length===3))return new Bc(Number(u[0]),Number(u[1]));if(!Array.isArray(u)&&typeof u=="object"&&u!==null)return new Bc(Number("lng"in u?u.lng:u.lon),Number(u.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Id=2*Math.PI*C0;function Mu(f){return Id*Math.cos(f*Math.PI/180)}function GA(f){return(180+f)/360}function Ed(f){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f*Math.PI/360)))/360}function Cd(f,u){return f/Mu(u)}function Td(f){return 360*f-180}function T0(f){return 360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90}class Df{constructor(u,p,I=0){this.x=+u,this.y=+p,this.z=+I}static fromLngLat(u,p=0){const I=Bc.convert(u);return new Df(GA(I.lng),Ed(I.lat),Cd(p,I.lat))}toLngLat(){return new Bc(Td(this.x),T0(this.y))}toAltitude(){return this.z*Mu(T0(this.y))}meterInMercatorCoordinateUnits(){return 1/Id*(u=T0(this.y),1/Math.cos(u*Math.PI/180));var u}}function kd(f,u,p){var I=2*Math.PI*6378137/256/Math.pow(2,p);return[f*I-2*Math.PI*6378137/2,u*I-2*Math.PI*6378137/2]}class Md{constructor(u,p,I){if(u<0||u>25||I<0||I>=Math.pow(2,u)||p<0||p>=Math.pow(2,u))throw new Error(`x=${p}, y=${I}, z=${u} outside of bounds. 0<=x<${Math.pow(2,u)}, 0<=y<${Math.pow(2,u)} 0<=z<=25 `);this.z=u,this.x=p,this.y=I,this.key=qA(0,u,u,p,I)}equals(u){return this.z===u.z&&this.x===u.x&&this.y===u.y}url(u,p,I){const L=(Q=this.y,re=this.z,Ae=kd(256*(U=this.x),256*(Q=Math.pow(2,re)-Q-1),re),_e=kd(256*(U+1),256*(Q+1),re),Ae[0]+","+Ae[1]+","+_e[0]+","+_e[1]);var U,Q,re,Ae,_e;const Le=function(qe,et,At){let gt,Dt="";for(let Lt=qe;Lt>0;Lt--)gt=1<<Lt-1,Dt+=(et&gt?1:0)+(At&gt?2:0);return Dt}(this.z,this.x,this.y);return u[(this.x+this.y)%u.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(I==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,p>1?"@2x":"").replace(/{quadkey}/g,Le).replace(/{bbox-epsg-3857}/g,L)}isChildOf(u){const p=this.z-u.z;return p>0&&u.x===this.x>>p&&u.y===this.y>>p}getTilePoint(u){const p=Math.pow(2,this.z);return new ue((u.x*p-this.x)*Pa,(u.y*p-this.y)*Pa)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Pd{constructor(u,p){this.wrap=u,this.canonical=p,this.key=qA(u,p.z,p.z,p.x,p.y)}}class bl{constructor(u,p,I,L,U){if(u<I)throw new Error(`overscaledZ should be >= z; overscaledZ = ${u}; z = ${I}`);this.overscaledZ=u,this.wrap=p,this.canonical=new Md(I,+L,+U),this.key=qA(p,u,I,L,U)}clone(){return new bl(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(u){return this.overscaledZ===u.overscaledZ&&this.wrap===u.wrap&&this.canonical.equals(u.canonical)}scaledTo(u){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-u;return u>this.canonical.z?new bl(u,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new bl(u,this.wrap,u,this.canonical.x>>p,this.canonical.y>>p)}calculateScaledKey(u,p){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const I=this.canonical.z-u;return u>this.canonical.z?qA(this.wrap*+p,u,this.canonical.z,this.canonical.x,this.canonical.y):qA(this.wrap*+p,u,u,this.canonical.x>>I,this.canonical.y>>I)}isChildOf(u){if(u.wrap!==this.wrap)return!1;const p=this.canonical.z-u.canonical.z;return u.overscaledZ===0||u.overscaledZ<this.overscaledZ&&u.canonical.x===this.canonical.x>>p&&u.canonical.y===this.canonical.y>>p}children(u){if(this.overscaledZ>=u)return[new bl(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const p=this.canonical.z+1,I=2*this.canonical.x,L=2*this.canonical.y;return[new bl(p,this.wrap,p,I,L),new bl(p,this.wrap,p,I+1,L),new bl(p,this.wrap,p,I,L+1),new bl(p,this.wrap,p,I+1,L+1)]}isLessThan(u){return this.wrap<u.wrap||!(this.wrap>u.wrap)&&(this.overscaledZ<u.overscaledZ||!(this.overscaledZ>u.overscaledZ)&&(this.canonical.x<u.canonical.x||!(this.canonical.x>u.canonical.x)&&this.canonical.y<u.canonical.y))}wrapped(){return new bl(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(u){return new bl(this.overscaledZ,u,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Pd(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(u){return this.canonical.getTilePoint(new Df(u.x-this.wrap,u.y))}}function qA(f,u,p,I,L){(f*=2)<0&&(f=-1*f-1);const U=1<<p;return(U*U*f+U*L+I).toString(36)+p.toString(36)+u.toString(36)}Dn("CanonicalTileID",Md),Dn("OverscaledTileID",bl,{omit:["posMatrix"]});class k0{constructor(u,p,I,L=1,U=1,Q=1,re=0){if(this.uid=u,p.height!==p.width)throw new RangeError("DEM tiles must be square");if(I&&!["mapbox","terrarium","custom"].includes(I))return void Je(`"${I}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=p.height;const Ae=this.dim=p.height-2;switch(this.data=new Uint32Array(p.data.buffer),I){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=L,this.greenFactor=U,this.blueFactor=Q,this.baseShift=re;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let _e=0;_e<Ae;_e++)this.data[this._idx(-1,_e)]=this.data[this._idx(0,_e)],this.data[this._idx(Ae,_e)]=this.data[this._idx(Ae-1,_e)],this.data[this._idx(_e,-1)]=this.data[this._idx(_e,0)],this.data[this._idx(_e,Ae)]=this.data[this._idx(_e,Ae-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(Ae,-1)]=this.data[this._idx(Ae-1,0)],this.data[this._idx(-1,Ae)]=this.data[this._idx(0,Ae-1)],this.data[this._idx(Ae,Ae)]=this.data[this._idx(Ae-1,Ae-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let _e=0;_e<Ae;_e++)for(let Le=0;Le<Ae;Le++){const qe=this.get(_e,Le);qe>this.max&&(this.max=qe),qe<this.min&&(this.min=qe)}}get(u,p){const I=new Uint8Array(this.data.buffer),L=4*this._idx(u,p);return this.unpack(I[L],I[L+1],I[L+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(u,p){if(u<-1||u>=this.dim+1||p<-1||p>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(p+1)*this.stride+(u+1)}unpack(u,p,I){return u*this.redFactor+p*this.greenFactor+I*this.blueFactor-this.baseShift}getPixels(){return new Ll({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(u,p,I){if(this.dim!==u.dim)throw new Error("dem dimension mismatch");let L=p*this.dim,U=p*this.dim+this.dim,Q=I*this.dim,re=I*this.dim+this.dim;switch(p){case-1:L=U-1;break;case 1:U=L+1}switch(I){case-1:Q=re-1;break;case 1:re=Q+1}const Ae=-p*this.dim,_e=-I*this.dim;for(let Le=Q;Le<re;Le++)for(let qe=L;qe<U;qe++)this.data[this._idx(qe,Le)]=u.data[this._idx(qe+Ae,Le+_e)]}}Dn("DEMData",k0);class M0{constructor(u){this._stringToNumber={},this._numberToString=[];for(let p=0;p<u.length;p++){const I=u[p];this._stringToNumber[I]=p,this._numberToString[p]=I}}encode(u){return this._stringToNumber[u]}decode(u){if(u>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${u} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[u]}}class Dd{constructor(u,p,I,L,U){this.type="Feature",this._vectorTileFeature=u,u._z=p,u._x=I,u._y=L,this.properties=u.properties,this.id=U}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(u){this._geometry=u}toJSON(){const u={geometry:this.geometry};for(const p in this)p!=="_geometry"&&p!=="_vectorTileFeature"&&(u[p]=this[p]);return u}}class Op{constructor(u,p){this.tileID=u,this.x=u.canonical.x,this.y=u.canonical.y,this.z=u.canonical.z,this.grid=new vo(Pa,16,0),this.grid3D=new vo(Pa,16,0),this.featureIndexArray=new ct,this.promoteId=p}insert(u,p,I,L,U,Q){const re=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(I,L,U);const Ae=Q?this.grid3D:this.grid;for(let _e=0;_e<p.length;_e++){const Le=p[_e],qe=[1/0,1/0,-1/0,-1/0];for(let et=0;et<Le.length;et++){const At=Le[et];qe[0]=Math.min(qe[0],At.x),qe[1]=Math.min(qe[1],At.y),qe[2]=Math.max(qe[2],At.x),qe[3]=Math.max(qe[3],At.y)}qe[0]<Pa&&qe[1]<Pa&&qe[2]>=0&&qe[3]>=0&&Ae.insert(re,qe[0],qe[1],qe[2],qe[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Ih.VectorTile(new v0(this.rawTileData)).layers,this.sourceLayerCoder=new M0(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(u,p,I,L){this.loadVTLayers();const U=u.params||{},Q=Pa/u.tileSize/u.scale,re=Qr(U.filter),Ae=u.queryGeometry,_e=u.queryPadding*Q,Le=Ld(Ae),qe=this.grid.query(Le.minX-_e,Le.minY-_e,Le.maxX+_e,Le.maxY+_e),et=Ld(u.cameraQueryGeometry),At=this.grid3D.query(et.minX-_e,et.minY-_e,et.maxX+_e,et.maxY+_e,(Lt,Rt,Kt,Ht)=>function(Qt,ui,yi,Yi,wn){for(const on of Qt)if(ui<=on.x&&yi<=on.y&&Yi>=on.x&&wn>=on.y)return!0;const un=[new ue(ui,yi),new ue(ui,wn),new ue(Yi,wn),new ue(Yi,yi)];if(Qt.length>2){for(const on of un)if(Xu(Qt,on))return!0}for(let on=0;on<Qt.length-1;on++)if(j0(Qt[on],Qt[on+1],un))return!0;return!1}(u.cameraQueryGeometry,Lt-_e,Rt-_e,Kt+_e,Ht+_e));for(const Lt of At)qe.push(Lt);qe.sort(oh);const gt={};let Dt;for(let Lt=0;Lt<qe.length;Lt++){const Rt=qe[Lt];if(Rt===Dt)continue;Dt=Rt;const Kt=this.featureIndexArray.get(Rt);let Ht=null;this.loadMatchingFeature(gt,Kt.bucketIndex,Kt.sourceLayerIndex,Kt.featureIndex,re,U.layers,U.availableImages,p,I,L,(Qt,ui,yi)=>(Ht||(Ht=Uh(Qt)),ui.queryIntersectsFeature(Ae,Qt,yi,Ht,this.z,u.transform,Q,u.pixelPosMatrix)))}return gt}loadMatchingFeature(u,p,I,L,U,Q,re,Ae,_e,Le,qe){const et=this.bucketLayerIDs[p];if(Q&&!function(Lt,Rt){for(let Kt=0;Kt<Lt.length;Kt++)if(Rt.indexOf(Lt[Kt])>=0)return!0;return!1}(Q,et))return;const At=this.sourceLayerCoder.decode(I),gt=this.vtLayers[At].feature(L);if(U.needGeometry){const Lt=Ec(gt,!0);if(!U.filter(new gn(this.tileID.overscaledZ),Lt,this.tileID.canonical))return}else if(!U.filter(new gn(this.tileID.overscaledZ),gt))return;const Dt=this.getId(gt,At);for(let Lt=0;Lt<et.length;Lt++){const Rt=et[Lt];if(Q&&Q.indexOf(Rt)<0)continue;const Kt=Ae[Rt];if(!Kt)continue;let Ht={};Dt&&Le&&(Ht=Le.getState(Kt.sourceLayer||"_geojsonTileLayer",Dt));const Qt=it({},_e[Rt]);Qt.paint=Np(Qt.paint,Kt.paint,gt,Ht,re),Qt.layout=Np(Qt.layout,Kt.layout,gt,Ht,re);const ui=!qe||qe(gt,Kt,Ht);if(!ui)continue;const yi=new Dd(gt,this.z,this.x,this.y,Dt);yi.layer=Qt;let Yi=u[Rt];Yi===void 0&&(Yi=u[Rt]=[]),Yi.push({featureIndex:L,feature:yi,intersectionZ:ui})}}lookupSymbolFeatures(u,p,I,L,U,Q,re,Ae){const _e={};this.loadVTLayers();const Le=Qr(U);for(const qe of u)this.loadMatchingFeature(_e,I,L,qe,Le,Q,re,Ae,p);return _e}hasLayer(u){for(const p of this.bucketLayerIDs)for(const I of p)if(u===I)return!0;return!1}getId(u,p){let I=u.id;return this.promoteId&&(I=u.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[p]],typeof I=="boolean"&&(I=Number(I))),I}}function Np(f,u,p,I,L){return mt(f,(U,Q)=>{const re=u instanceof Po?u.get(Q):null;return re&&re.evaluate?re.evaluate(p,I,L):re})}function Ld(f){let u=1/0,p=1/0,I=-1/0,L=-1/0;for(const U of f)u=Math.min(u,U.x),p=Math.min(p,U.y),I=Math.max(I,U.x),L=Math.max(L,U.y);return{minX:u,minY:p,maxX:I,maxY:L}}function oh(f,u){return u-f}function Bd(f,u,p,I,L){const U=[];for(let Q=0;Q<f.length;Q++){const re=f[Q];let Ae;for(let _e=0;_e<re.length-1;_e++){let Le=re[_e],qe=re[_e+1];Le.x<u&&qe.x<u||(Le.x<u?Le=new ue(u,Le.y+(u-Le.x)/(qe.x-Le.x)*(qe.y-Le.y))._round():qe.x<u&&(qe=new ue(u,Le.y+(u-Le.x)/(qe.x-Le.x)*(qe.y-Le.y))._round()),Le.y<p&&qe.y<p||(Le.y<p?Le=new ue(Le.x+(p-Le.y)/(qe.y-Le.y)*(qe.x-Le.x),p)._round():qe.y<p&&(qe=new ue(Le.x+(p-Le.y)/(qe.y-Le.y)*(qe.x-Le.x),p)._round()),Le.x>=I&&qe.x>=I||(Le.x>=I?Le=new ue(I,Le.y+(I-Le.x)/(qe.x-Le.x)*(qe.y-Le.y))._round():qe.x>=I&&(qe=new ue(I,Le.y+(I-Le.x)/(qe.x-Le.x)*(qe.y-Le.y))._round()),Le.y>=L&&qe.y>=L||(Le.y>=L?Le=new ue(Le.x+(L-Le.y)/(qe.y-Le.y)*(qe.x-Le.x),L)._round():qe.y>=L&&(qe=new ue(Le.x+(L-Le.y)/(qe.y-Le.y)*(qe.x-Le.x),L)._round()),Ae&&Le.equals(Ae[Ae.length-1])||(Ae=[Le],U.push(Ae)),Ae.push(qe)))))}}return U}Dn("FeatureIndex",Op,{omit:["rawTileData","sourceLayerCoder"]});class Ac extends ue{constructor(u,p,I,L){super(u,p),this.angle=I,L!==void 0&&(this.segment=L)}clone(){return new Ac(this.x,this.y,this.angle,this.segment)}}function zd(f,u,p,I,L){if(u.segment===void 0||p===0)return!0;let U=u,Q=u.segment+1,re=0;for(;re>-p/2;){if(Q--,Q<0)return!1;re-=f[Q].dist(U),U=f[Q]}re+=f[Q].dist(f[Q+1]),Q++;const Ae=[];let _e=0;for(;re<p/2;){const Le=f[Q],qe=f[Q+1];if(!qe)return!1;let et=f[Q-1].angleTo(Le)-Le.angleTo(qe);for(et=Math.abs((et+3*Math.PI)%(2*Math.PI)-Math.PI),Ae.push({distance:re,angleDelta:et}),_e+=et;re-Ae[0].distance>I;)_e-=Ae.shift().angleDelta;if(_e>L)return!1;Q++,re+=Le.dist(qe)}return!0}function Lf(f){let u=0;for(let p=0;p<f.length-1;p++)u+=f[p].dist(f[p+1]);return u}function Bf(f,u,p){return f?.6*u*p:0}function zf(f,u){return Math.max(f?f.right-f.left:0,u?u.right-u.left:0)}function Vm(f,u,p,I,L,U){const Q=Bf(p,L,U),re=zf(p,I)*U;let Ae=0;const _e=Lf(f)/2;for(let Le=0;Le<f.length-1;Le++){const qe=f[Le],et=f[Le+1],At=qe.dist(et);if(Ae+At>_e){const gt=(_e-Ae)/At,Dt=Zs.number(qe.x,et.x,gt),Lt=Zs.number(qe.y,et.y,gt),Rt=new Ac(Dt,Lt,et.angleTo(qe),Le);return Rt._round(),!Q||zd(f,Rt,re,Q,u)?Rt:void 0}Ae+=At}}function Um(f,u,p,I,L,U,Q,re,Ae){const _e=Bf(I,U,Q),Le=zf(I,L),qe=Le*Q,et=f[0].x===0||f[0].x===Ae||f[0].y===0||f[0].y===Ae;return u-qe<u/4&&(u=qe+u/4),Vp(f,et?u/2*re%u:(Le/2+2*U)*Q*re%u,u,_e,p,qe,et,!1,Ae)}function Vp(f,u,p,I,L,U,Q,re,Ae){const _e=U/2,Le=Lf(f);let qe=0,et=u-p,At=[];for(let gt=0;gt<f.length-1;gt++){const Dt=f[gt],Lt=f[gt+1],Rt=Dt.dist(Lt),Kt=Lt.angleTo(Dt);for(;et+p<qe+Rt;){et+=p;const Ht=(et-qe)/Rt,Qt=Zs.number(Dt.x,Lt.x,Ht),ui=Zs.number(Dt.y,Lt.y,Ht);if(Qt>=0&&Qt<Ae&&ui>=0&&ui<Ae&&et-_e>=0&&et+_e<=Le){const yi=new Ac(Qt,ui,Kt,gt);yi._round(),I&&!zd(f,yi,U,I,L)||At.push(yi)}}qe+=Rt}return re||At.length||Q||(At=Vp(f,qe/2,p,I,L,U,Q,!0,Ae)),At}Dn("Anchor",Ac);const HA=Su;function iA(f,u,p,I){const L=[],U=f.image,Q=U.pixelRatio,re=U.paddedRect.w-2*HA,Ae=U.paddedRect.h-2*HA,_e=f.right-f.left,Le=f.bottom-f.top,qe=U.stretchX||[[0,re]],et=U.stretchY||[[0,Ae]],At=(dn,Rn)=>dn+Rn[1]-Rn[0],gt=qe.reduce(At,0),Dt=et.reduce(At,0),Lt=re-gt,Rt=Ae-Dt;let Kt=0,Ht=gt,Qt=0,ui=Dt,yi=0,Yi=Lt,wn=0,un=Rt;if(U.content&&I){const dn=U.content;Kt=Bo(qe,0,dn[0]),Qt=Bo(et,0,dn[1]),Ht=Bo(qe,dn[0],dn[2]),ui=Bo(et,dn[1],dn[3]),yi=dn[0]-Kt,wn=dn[1]-Qt,Yi=dn[2]-dn[0]-Ht,un=dn[3]-dn[1]-ui}const on=(dn,Rn,an,Xi)=>{const Ln=nA(dn.stretch-Kt,Ht,_e,f.left),Nn=jA(dn.fixed-yi,Yi,dn.stretch,gt),pr=nA(Rn.stretch-Qt,ui,Le,f.top),Vr=jA(Rn.fixed-wn,un,Rn.stretch,Dt),Hr=nA(an.stretch-Kt,Ht,_e,f.left),Rs=jA(an.fixed-yi,Yi,an.stretch,gt),Ea=nA(Xi.stretch-Qt,ui,Le,f.top),ia=jA(Xi.fixed-wn,un,Xi.stretch,Dt),ns=new ue(Ln,pr),Wn=new ue(Hr,pr),ws=new ue(Hr,Ea),ir=new ue(Ln,Ea),na=new ue(Nn/Q,Vr/Q),Ps=new ue(Rs/Q,ia/Q),Kn=u*Math.PI/180;if(Kn){const va=Math.sin(Kn),qo=Math.cos(Kn),uo=[qo,-va,va,qo];ns._matMult(uo),Wn._matMult(uo),ir._matMult(uo),ws._matMult(uo)}const La=dn.stretch+dn.fixed,Ja=Rn.stretch+Rn.fixed;return{tl:ns,tr:Wn,bl:ir,br:ws,tex:{x:U.paddedRect.x+HA+La,y:U.paddedRect.y+HA+Ja,w:an.stretch+an.fixed-La,h:Xi.stretch+Xi.fixed-Ja},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:na,pixelOffsetBR:Ps,minFontScaleX:Yi/Q/_e,minFontScaleY:un/Q/Le,isSDF:p}};if(I&&(U.stretchX||U.stretchY)){const dn=lh(qe,Lt,gt),Rn=lh(et,Rt,Dt);for(let an=0;an<dn.length-1;an++){const Xi=dn[an],Ln=dn[an+1];for(let Nn=0;Nn<Rn.length-1;Nn++)L.push(on(Xi,Rn[Nn],Ln,Rn[Nn+1]))}}else L.push(on({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:re+1},{fixed:0,stretch:Ae+1}));return L}function Bo(f,u,p){let I=0;for(const L of f)I+=Math.max(u,Math.min(p,L[1]))-Math.max(u,Math.min(p,L[0]));return I}function lh(f,u,p){const I=[{fixed:-HA,stretch:0}];for(const[L,U]of f){const Q=I[I.length-1];I.push({fixed:L-Q.stretch,stretch:Q.stretch}),I.push({fixed:L-Q.stretch,stretch:Q.stretch+(U-L)})}return I.push({fixed:u+HA,stretch:p}),I}function nA(f,u,p,I){return f/u*p+I}function jA(f,u,p,I){return f-u*p/I}class rA{constructor(u,p,I,L,U,Q,re,Ae,_e,Le){if(this.boxStartIndex=u.length,_e){let qe=Q.top,et=Q.bottom;const At=Q.collisionPadding;At&&(qe-=At[1],et+=At[3]);let gt=et-qe;gt>0&&(gt=Math.max(10,gt),this.circleDiameter=gt)}else{let qe=Q.top*re-Ae[0],et=Q.bottom*re+Ae[2],At=Q.left*re-Ae[3],gt=Q.right*re+Ae[1];const Dt=Q.collisionPadding;if(Dt&&(At-=Dt[0]*re,qe-=Dt[1]*re,gt+=Dt[2]*re,et+=Dt[3]*re),Le){const Lt=new ue(At,qe),Rt=new ue(gt,qe),Kt=new ue(At,et),Ht=new ue(gt,et),Qt=Le*Math.PI/180;Lt._rotate(Qt),Rt._rotate(Qt),Kt._rotate(Qt),Ht._rotate(Qt),At=Math.min(Lt.x,Rt.x,Kt.x,Ht.x),gt=Math.max(Lt.x,Rt.x,Kt.x,Ht.x),qe=Math.min(Lt.y,Rt.y,Kt.y,Ht.y),et=Math.max(Lt.y,Rt.y,Kt.y,Ht.y)}u.emplaceBack(p.x,p.y,At,qe,gt,et,I,L,U)}this.boxEndIndex=u.length}}class P0{constructor(u=[],p=Up){if(this.data=u,this.length=this.data.length,this.compare=p,this.length>0)for(let I=(this.length>>1)-1;I>=0;I--)this._down(I)}push(u){this.data.push(u),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const u=this.data[0],p=this.data.pop();return this.length--,this.length>0&&(this.data[0]=p,this._down(0)),u}peek(){return this.data[0]}_up(u){const{data:p,compare:I}=this,L=p[u];for(;u>0;){const U=u-1>>1,Q=p[U];if(I(L,Q)>=0)break;p[u]=Q,u=U}p[u]=L}_down(u){const{data:p,compare:I}=this,L=this.length>>1,U=p[u];for(;u<L;){let Q=1+(u<<1),re=p[Q];const Ae=Q+1;if(Ae<this.length&&I(p[Ae],re)<0&&(Q=Ae,re=p[Ae]),I(re,U)>=0)break;p[u]=re,u=Q}p[u]=U}}function Up(f,u){return f<u?-1:f>u?1:0}function Rd(f,u=1,p=!1){let I=1/0,L=1/0,U=-1/0,Q=-1/0;const re=f[0];for(let At=0;At<re.length;At++){const gt=re[At];(!At||gt.x<I)&&(I=gt.x),(!At||gt.y<L)&&(L=gt.y),(!At||gt.x>U)&&(U=gt.x),(!At||gt.y>Q)&&(Q=gt.y)}const Ae=Math.min(U-I,Q-L);let _e=Ae/2;const Le=new P0([],Fd);if(Ae===0)return new ue(I,L);for(let At=I;At<U;At+=Ae)for(let gt=L;gt<Q;gt+=Ae)Le.push(new ZA(At+_e,gt+_e,_e,f));let qe=function(At){let gt=0,Dt=0,Lt=0;const Rt=At[0];for(let Kt=0,Ht=Rt.length,Qt=Ht-1;Kt<Ht;Qt=Kt++){const ui=Rt[Kt],yi=Rt[Qt],Yi=ui.x*yi.y-yi.x*ui.y;Dt+=(ui.x+yi.x)*Yi,Lt+=(ui.y+yi.y)*Yi,gt+=3*Yi}return new ZA(Dt/gt,Lt/gt,0,At)}(f),et=Le.length;for(;Le.length;){const At=Le.pop();(At.d>qe.d||!qe.d)&&(qe=At,p&&console.log("found best %d after %d probes",Math.round(1e4*At.d)/1e4,et)),At.max-qe.d<=u||(_e=At.h/2,Le.push(new ZA(At.p.x-_e,At.p.y-_e,_e,f)),Le.push(new ZA(At.p.x+_e,At.p.y-_e,_e,f)),Le.push(new ZA(At.p.x-_e,At.p.y+_e,_e,f)),Le.push(new ZA(At.p.x+_e,At.p.y+_e,_e,f)),et+=4)}return p&&(console.log(`num probes: ${et}`),console.log(`best distance: ${qe.d}`)),qe.p}function Fd(f,u){return u.max-f.max}function ZA(f,u,p,I){this.p=new ue(f,u),this.h=p,this.d=function(L,U){let Q=!1,re=1/0;for(let Ae=0;Ae<U.length;Ae++){const _e=U[Ae];for(let Le=0,qe=_e.length,et=qe-1;Le<qe;et=Le++){const At=_e[Le],gt=_e[et];At.y>L.y!=gt.y>L.y&&L.x<(gt.x-At.x)*(L.y-At.y)/(gt.y-At.y)+At.x&&(Q=!Q),re=Math.min(re,H0(L,At,gt))}}return(Q?1:-1)*Math.sqrt(re)}(this.p,I),this.max=this.d+this.h*Math.SQRT2}var Bl;a.aq=void 0,(Bl=a.aq||(a.aq={}))[Bl.center=1]="center",Bl[Bl.left=2]="left",Bl[Bl.right=3]="right",Bl[Bl.top=4]="top",Bl[Bl.bottom=5]="bottom",Bl[Bl["top-left"]=6]="top-left",Bl[Bl["top-right"]=7]="top-right",Bl[Bl["bottom-left"]=8]="bottom-left",Bl[Bl["bottom-right"]=9]="bottom-right";const zc=7,Mh=Number.POSITIVE_INFINITY;function QA(f,u){return u[1]!==Mh?function(p,I,L){let U=0,Q=0;switch(I=Math.abs(I),L=Math.abs(L),p){case"top-right":case"top-left":case"top":Q=L-zc;break;case"bottom-right":case"bottom-left":case"bottom":Q=-L+zc}switch(p){case"top-right":case"bottom-right":case"right":U=-I;break;case"top-left":case"bottom-left":case"left":U=I}return[U,Q]}(f,u[0],u[1]):function(p,I){let L=0,U=0;I<0&&(I=0);const Q=I/Math.SQRT2;switch(p){case"top-right":case"top-left":U=Q-zc;break;case"bottom-right":case"bottom-left":U=-Q+zc;break;case"bottom":U=-I+zc;break;case"top":U=I-zc}switch(p){case"top-right":case"bottom-right":L=-Q;break;case"top-left":case"bottom-left":L=Q;break;case"left":L=I;break;case"right":L=-I}return[L,U]}(f,u[0])}function WA(f,u,p){var I;const L=f.layout,U=(I=L.get("text-variable-anchor-offset"))===null||I===void 0?void 0:I.evaluate(u,{},p);if(U){const re=U.values,Ae=[];for(let _e=0;_e<re.length;_e+=2){const Le=Ae[_e]=re[_e],qe=re[_e+1].map(et=>et*Ka);Le.startsWith("top")?qe[1]-=zc:Le.startsWith("bottom")&&(qe[1]+=zc),Ae[_e+1]=qe}return new Tn(Ae)}const Q=L.get("text-variable-anchor");if(Q){let re;re=f._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[L.get("text-radial-offset").evaluate(u,{},p)*Ka,Mh]:L.get("text-offset").evaluate(u,{},p).map(_e=>_e*Ka);const Ae=[];for(const _e of Q)Ae.push(_e,QA(_e,re));return new Tn(Ae)}return null}function Rf(f){switch(f){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function D0(f,u,p,I,L,U,Q,re,Ae,_e,Le){let qe=U.textMaxSize.evaluate(u,{});qe===void 0&&(qe=Q);const et=f.layers[0].layout,At=et.get("icon-offset").evaluate(u,{},Le),gt=Of(p.horizontal),Dt=Q/24,Lt=f.tilePixelRatio*Dt,Rt=f.tilePixelRatio*qe/24,Kt=f.tilePixelRatio*re,Ht=f.tilePixelRatio*et.get("symbol-spacing"),Qt=et.get("text-padding")*f.tilePixelRatio,ui=function(Xi,Ln,Nn,pr=1){const Vr=Xi.get("icon-padding").evaluate(Ln,{},Nn),Hr=Vr&&Vr.values;return[Hr[0]*pr,Hr[1]*pr,Hr[2]*pr,Hr[3]*pr]}(et,u,Le,f.tilePixelRatio),yi=et.get("text-max-angle")/180*Math.PI,Yi=et.get("text-rotation-alignment")!=="viewport"&&et.get("symbol-placement")!=="point",wn=et.get("icon-rotation-alignment")==="map"&&et.get("symbol-placement")!=="point",un=et.get("symbol-placement"),on=Ht/2,dn=et.get("icon-text-fit");let Rn;I&&dn!=="none"&&(f.allowVerticalPlacement&&p.vertical&&(Rn=S0(I,p.vertical,dn,et.get("icon-text-fit-padding"),At,Dt)),gt&&(I=S0(I,gt,dn,et.get("icon-text-fit-padding"),At,Dt)));const an=(Xi,Ln)=>{Ln.x<0||Ln.x>=Pa||Ln.y<0||Ln.y>=Pa||function(Nn,pr,Vr,Hr,Rs,Ea,ia,ns,Wn,ws,ir,na,Ps,Kn,La,Ja,va,qo,uo,ra,br,wo,nl,rl,Pu){const Uu=Nn.addToLineVertexArray(pr,Vr);let zl,Rc,Gu,qu,Jl=0,uh=0,sA=0,qp=0,Od=-1,Nd=-1;const co={};let So=bo("");if(Nn.allowVerticalPlacement&&Hr.vertical){const Iu=ns.layout.get("text-rotate").evaluate(br,{},rl)+90;Gu=new rA(Wn,pr,ws,ir,na,Hr.vertical,Ps,Kn,La,Iu),ia&&(qu=new rA(Wn,pr,ws,ir,na,ia,va,qo,La,Iu))}if(Rs){const Iu=ns.layout.get("icon-rotate").evaluate(br,{}),dc=ns.layout.get("icon-text-fit")!=="none",Fc=iA(Rs,Iu,nl,dc),ch=ia?iA(ia,Iu,nl,dc):void 0;Rc=new rA(Wn,pr,ws,ir,na,Rs,va,qo,!1,Iu),Jl=4*Fc.length;const qf=Nn.iconSizeData;let Dh=null;qf.kind==="source"?(Dh=[Yu*ns.layout.get("icon-size").evaluate(br,{})],Dh[0]>Lc&&Je(`${Nn.layerIds[0]}: Value for "icon-size" is >= ${Mf}. Reduce your "icon-size".`)):qf.kind==="composite"&&(Dh=[Yu*wo.compositeIconSizes[0].evaluate(br,{},rl),Yu*wo.compositeIconSizes[1].evaluate(br,{},rl)],(Dh[0]>Lc||Dh[1]>Lc)&&Je(`${Nn.layerIds[0]}: Value for "icon-size" is >= ${Mf}. Reduce your "icon-size".`)),Nn.addSymbols(Nn.icon,Fc,Dh,ra,uo,br,a.ai.none,pr,Uu.lineStartIndex,Uu.lineLength,-1,rl),Od=Nn.icon.placedSymbolArray.length-1,ch&&(uh=4*ch.length,Nn.addSymbols(Nn.icon,ch,Dh,ra,uo,br,a.ai.vertical,pr,Uu.lineStartIndex,Uu.lineLength,-1,rl),Nd=Nn.icon.placedSymbolArray.length-1)}const Gf=Object.keys(Hr.horizontal);for(const Iu of Gf){const dc=Hr.horizontal[Iu];if(!zl){So=bo(dc.text);const ch=ns.layout.get("text-rotate").evaluate(br,{},rl);zl=new rA(Wn,pr,ws,ir,na,dc,Ps,Kn,La,ch)}const Fc=dc.positionedLines.length===1;if(sA+=Ff(Nn,pr,dc,Ea,ns,La,br,Ja,Uu,Hr.vertical?a.ai.horizontal:a.ai.horizontalOnly,Fc?Gf:[Iu],co,Od,wo,rl),Fc)break}Hr.vertical&&(qp+=Ff(Nn,pr,Hr.vertical,Ea,ns,La,br,Ja,Uu,a.ai.vertical,["vertical"],co,Nd,wo,rl));const Hp=zl?zl.boxStartIndex:Nn.collisionBoxArray.length,Gm=zl?zl.boxEndIndex:Nn.collisionBoxArray.length,jp=Gu?Gu.boxStartIndex:Nn.collisionBoxArray.length,qm=Gu?Gu.boxEndIndex:Nn.collisionBoxArray.length,eu=Rc?Rc.boxStartIndex:Nn.collisionBoxArray.length,Hu=Rc?Rc.boxEndIndex:Nn.collisionBoxArray.length,Ph=qu?qu.boxStartIndex:Nn.collisionBoxArray.length,fc=qu?qu.boxEndIndex:Nn.collisionBoxArray.length;let tu=-1;const ju=(Iu,dc)=>Iu&&Iu.circleDiameter?Math.max(Iu.circleDiameter,dc):dc;tu=ju(zl,tu),tu=ju(Gu,tu),tu=ju(Rc,tu),tu=ju(qu,tu);const Hm=tu>-1?1:0;Hm&&(tu*=Pu/Ka),Nn.glyphOffsetArray.length>=sh.MAX_GLYPHS&&Je("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),br.sortKey!==void 0&&Nn.addToSortKeyRanges(Nn.symbolInstances.length,br.sortKey);const Og=WA(ns,br,rl),[b1,w1]=function(Iu,dc){const Fc=Iu.length,ch=dc==null?void 0:dc.values;if((ch==null?void 0:ch.length)>0)for(let qf=0;qf<ch.length;qf+=2){const Dh=ch[qf+1];Iu.emplaceBack(a.aq[ch[qf]],Dh[0],Dh[1])}return[Fc,Iu.length]}(Nn.textAnchorOffsets,Og);Nn.symbolInstances.emplaceBack(pr.x,pr.y,co.right>=0?co.right:-1,co.center>=0?co.center:-1,co.left>=0?co.left:-1,co.vertical||-1,Od,Nd,So,Hp,Gm,jp,qm,eu,Hu,Ph,fc,ws,sA,qp,Jl,uh,Hm,0,Ps,tu,b1,w1)}(f,Ln,Xi,p,I,L,Rn,f.layers[0],f.collisionBoxArray,u.index,u.sourceLayerIndex,f.index,Lt,[Qt,Qt,Qt,Qt],Yi,Ae,Kt,ui,wn,At,u,U,_e,Le,Q)};if(un==="line")for(const Xi of Bd(u.geometry,0,0,Pa,Pa)){const Ln=Um(Xi,Ht,yi,p.vertical||gt,I,24,Rt,f.overscaling,Pa);for(const Nn of Ln)gt&&Nf(f,gt.text,on,Nn)||an(Xi,Nn)}else if(un==="line-center"){for(const Xi of u.geometry)if(Xi.length>1){const Ln=Vm(Xi,yi,p.vertical||gt,I,24,Rt);Ln&&an(Xi,Ln)}}else if(u.type==="Polygon")for(const Xi of Y0(u.geometry,0)){const Ln=Rd(Xi,16);an(Xi[0],new Ac(Ln.x,Ln.y,0))}else if(u.type==="LineString")for(const Xi of u.geometry)an(Xi,new Ac(Xi[0].x,Xi[0].y,0));else if(u.type==="Point")for(const Xi of u.geometry)for(const Ln of Xi)an([Ln],new Ac(Ln.x,Ln.y,0))}function Ff(f,u,p,I,L,U,Q,re,Ae,_e,Le,qe,et,At,gt){const Dt=function(Kt,Ht,Qt,ui,yi,Yi,wn,un){const on=ui.layout.get("text-rotate").evaluate(Yi,{})*Math.PI/180,dn=[];for(const Rn of Ht.positionedLines)for(const an of Rn.positionedGlyphs){if(!an.rect)continue;const Xi=an.rect||{};let Ln=Cf+1,Nn=!0,pr=1,Vr=0;const Hr=(yi||un)&&an.vertical,Rs=an.metrics.advance*an.scale/2;if(un&&Ht.verticalizable&&(Vr=Rn.lineOffset/2-(an.imageName?-(Ka-an.metrics.width*an.scale)/2:(an.scale-1)*Ka)),an.imageName){const ra=wn[an.imageName];Nn=ra.sdf,pr=ra.pixelRatio,Ln=Su/pr}const Ea=yi?[an.x+Rs,an.y]:[0,0];let ia=yi?[0,0]:[an.x+Rs+Qt[0],an.y+Qt[1]-Vr],ns=[0,0];Hr&&(ns=ia,ia=[0,0]);const Wn=an.metrics.isDoubleResolution?2:1,ws=(an.metrics.left-Ln)*an.scale-Rs+ia[0],ir=(-an.metrics.top-Ln)*an.scale+ia[1],na=ws+Xi.w/Wn*an.scale/pr,Ps=ir+Xi.h/Wn*an.scale/pr,Kn=new ue(ws,ir),La=new ue(na,ir),Ja=new ue(ws,Ps),va=new ue(na,Ps);if(Hr){const ra=new ue(-Rs,Rs-RA),br=-Math.PI/2,wo=Ka/2-Rs,nl=new ue(5-RA-wo,-(an.imageName?wo:0)),rl=new ue(...ns);Kn._rotateAround(br,ra)._add(nl)._add(rl),La._rotateAround(br,ra)._add(nl)._add(rl),Ja._rotateAround(br,ra)._add(nl)._add(rl),va._rotateAround(br,ra)._add(nl)._add(rl)}if(on){const ra=Math.sin(on),br=Math.cos(on),wo=[br,-ra,ra,br];Kn._matMult(wo),La._matMult(wo),Ja._matMult(wo),va._matMult(wo)}const qo=new ue(0,0),uo=new ue(0,0);dn.push({tl:Kn,tr:La,bl:Ja,br:va,tex:Xi,writingMode:Ht.writingMode,glyphOffset:Ea,sectionIndex:an.sectionIndex,isSDF:Nn,pixelOffsetTL:qo,pixelOffsetBR:uo,minFontScaleX:0,minFontScaleY:0})}return dn}(0,p,re,L,U,Q,I,f.allowVerticalPlacement),Lt=f.textSizeData;let Rt=null;Lt.kind==="source"?(Rt=[Yu*L.layout.get("text-size").evaluate(Q,{})],Rt[0]>Lc&&Je(`${f.layerIds[0]}: Value for "text-size" is >= ${Mf}. Reduce your "text-size".`)):Lt.kind==="composite"&&(Rt=[Yu*At.compositeTextSizes[0].evaluate(Q,{},gt),Yu*At.compositeTextSizes[1].evaluate(Q,{},gt)],(Rt[0]>Lc||Rt[1]>Lc)&&Je(`${f.layerIds[0]}: Value for "text-size" is >= ${Mf}. Reduce your "text-size".`)),f.addSymbols(f.text,Dt,Rt,re,U,Q,_e,u,Ae.lineStartIndex,Ae.lineLength,et,gt);for(const Kt of Le)qe[Kt]=f.text.placedSymbolArray.length-1;return 4*Dt.length}function Of(f){for(const u in f)return f[u];return null}function Nf(f,u,p,I){const L=f.compareText;if(u in L){const U=L[u];for(let Q=U.length-1;Q>=0;Q--)if(I.dist(U[Q])<p)return!0}else L[u]=[];return L[u].push(I),!1}const L0=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Vf{static from(u){if(!(u instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[p,I]=new Uint8Array(u,0,2);if(p!==219)throw new Error("Data does not appear to be in a KDBush format.");const L=I>>4;if(L!==1)throw new Error(`Got v${L} data when expected v1.`);const U=L0[15&I];if(!U)throw new Error("Unrecognized array type.");const[Q]=new Uint16Array(u,2,1),[re]=new Uint32Array(u,4,1);return new Vf(re,Q,U,u)}constructor(u,p=64,I=Float64Array,L){if(isNaN(u)||u<0)throw new Error(`Unpexpected numItems value: ${u}.`);this.numItems=+u,this.nodeSize=Math.min(Math.max(+p,2),65535),this.ArrayType=I,this.IndexArrayType=u<65536?Uint16Array:Uint32Array;const U=L0.indexOf(this.ArrayType),Q=2*u*this.ArrayType.BYTES_PER_ELEMENT,re=u*this.IndexArrayType.BYTES_PER_ELEMENT,Ae=(8-re%8)%8;if(U<0)throw new Error(`Unexpected typed array class: ${I}.`);L&&L instanceof ArrayBuffer?(this.data=L,this.ids=new this.IndexArrayType(this.data,8,u),this.coords=new this.ArrayType(this.data,8+re+Ae,2*u),this._pos=2*u,this._finished=!0):(this.data=new ArrayBuffer(8+Q+re+Ae),this.ids=new this.IndexArrayType(this.data,8,u),this.coords=new this.ArrayType(this.data,8+re+Ae,2*u),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+U]),new Uint16Array(this.data,2,1)[0]=p,new Uint32Array(this.data,4,1)[0]=u)}add(u,p){const I=this._pos>>1;return this.ids[I]=I,this.coords[this._pos++]=u,this.coords[this._pos++]=p,I}finish(){const u=this._pos>>1;if(u!==this.numItems)throw new Error(`Added ${u} items when expected ${this.numItems}.`);return Uf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(u,p,I,L){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:U,coords:Q,nodeSize:re}=this,Ae=[0,U.length-1,0],_e=[];for(;Ae.length;){const Le=Ae.pop()||0,qe=Ae.pop()||0,et=Ae.pop()||0;if(qe-et<=re){for(let Lt=et;Lt<=qe;Lt++){const Rt=Q[2*Lt],Kt=Q[2*Lt+1];Rt>=u&&Rt<=I&&Kt>=p&&Kt<=L&&_e.push(U[Lt])}continue}const At=et+qe>>1,gt=Q[2*At],Dt=Q[2*At+1];gt>=u&&gt<=I&&Dt>=p&&Dt<=L&&_e.push(U[At]),(Le===0?u<=gt:p<=Dt)&&(Ae.push(et),Ae.push(At-1),Ae.push(1-Le)),(Le===0?I>=gt:L>=Dt)&&(Ae.push(At+1),Ae.push(qe),Ae.push(1-Le))}return _e}within(u,p,I){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:L,coords:U,nodeSize:Q}=this,re=[0,L.length-1,0],Ae=[],_e=I*I;for(;re.length;){const Le=re.pop()||0,qe=re.pop()||0,et=re.pop()||0;if(qe-et<=Q){for(let Lt=et;Lt<=qe;Lt++)b(U[2*Lt],U[2*Lt+1],u,p)<=_e&&Ae.push(L[Lt]);continue}const At=et+qe>>1,gt=U[2*At],Dt=U[2*At+1];b(gt,Dt,u,p)<=_e&&Ae.push(L[At]),(Le===0?u-I<=gt:p-I<=Dt)&&(re.push(et),re.push(At-1),re.push(1-Le)),(Le===0?u+I>=gt:p+I>=Dt)&&(re.push(At+1),re.push(qe),re.push(1-Le))}return Ae}}function Uf(f,u,p,I,L,U){if(L-I<=p)return;const Q=I+L>>1;Gp(f,u,Q,I,L,U),Uf(f,u,p,I,Q-1,1-U),Uf(f,u,p,Q+1,L,1-U)}function Gp(f,u,p,I,L,U){for(;L>I;){if(L-I>600){const _e=L-I+1,Le=p-I+1,qe=Math.log(_e),et=.5*Math.exp(2*qe/3),At=.5*Math.sqrt(qe*et*(_e-et)/_e)*(Le-_e/2<0?-1:1);Gp(f,u,p,Math.max(I,Math.floor(p-Le*et/_e+At)),Math.min(L,Math.floor(p+(_e-Le)*et/_e+At)),U)}const Q=u[2*p+U];let re=I,Ae=L;for(m(f,u,I,p),u[2*L+U]>Q&&m(f,u,I,L);re<Ae;){for(m(f,u,re,Ae),re++,Ae--;u[2*re+U]<Q;)re++;for(;u[2*Ae+U]>Q;)Ae--}u[2*I+U]===Q?m(f,u,I,Ae):(Ae++,m(f,u,Ae,L)),Ae<=p&&(I=Ae+1),p<=Ae&&(L=Ae-1)}}function m(f,u,p,I){h(f,p,I),h(u,2*p,2*I),h(u,2*p+1,2*I+1)}function h(f,u,p){const I=f[u];f[u]=f[p],f[p]=I}function b(f,u,p,I){const L=f-p,U=u-I;return L*L+U*U}var M;a.bh=void 0,(M=a.bh||(a.bh={})).create="create",M.load="load",M.fullLoad="fullLoad";let q=null,K=[];const J=1e3/60,me="loadTime",Ce="fullLoadTime",Ne={mark(f){performance.mark(f)},frame(f){const u=f;q!=null&&K.push(u-q),q=u},clearMetrics(){q=null,K=[],performance.clearMeasures(me),performance.clearMeasures(Ce);for(const f in a.bh)performance.clearMarks(a.bh[f])},getPerformanceMetrics(){performance.measure(me,a.bh.create,a.bh.load),performance.measure(Ce,a.bh.create,a.bh.fullLoad);const f=performance.getEntriesByName(me)[0].duration,u=performance.getEntriesByName(Ce)[0].duration,p=K.length,I=1/(K.reduce((U,Q)=>U+Q,0)/p/1e3),L=K.filter(U=>U>J).reduce((U,Q)=>U+(Q-J)/J,0);return{loadTime:f,fullLoadTime:u,fps:I,percentDroppedFrames:L/(p+L)*100,totalFrames:p}}};a.$=function(f,u,p){var I,L,U,Q,re,Ae,_e,Le,qe,et,At,gt,Dt=p[0],Lt=p[1],Rt=p[2];return u===f?(f[12]=u[0]*Dt+u[4]*Lt+u[8]*Rt+u[12],f[13]=u[1]*Dt+u[5]*Lt+u[9]*Rt+u[13],f[14]=u[2]*Dt+u[6]*Lt+u[10]*Rt+u[14],f[15]=u[3]*Dt+u[7]*Lt+u[11]*Rt+u[15]):(L=u[1],U=u[2],Q=u[3],re=u[4],Ae=u[5],_e=u[6],Le=u[7],qe=u[8],et=u[9],At=u[10],gt=u[11],f[0]=I=u[0],f[1]=L,f[2]=U,f[3]=Q,f[4]=re,f[5]=Ae,f[6]=_e,f[7]=Le,f[8]=qe,f[9]=et,f[10]=At,f[11]=gt,f[12]=I*Dt+re*Lt+qe*Rt+u[12],f[13]=L*Dt+Ae*Lt+et*Rt+u[13],f[14]=U*Dt+_e*Lt+At*Rt+u[14],f[15]=Q*Dt+Le*Lt+gt*Rt+u[15]),f},a.A=Hh,a.B=Zs,a.C=class{constructor(f,u,p){this.receive=I=>{const L=I.data,U=L.id;if(U&&(!L.targetMapId||this.mapId===L.targetMapId))if(L.type==="<cancel>"){delete this.tasks[U];const Q=this.cancelCallbacks[U];delete this.cancelCallbacks[U],Q&&Q()}else Nt()||L.mustQueue?(this.tasks[U]=L,this.taskQueue.push(U),this.invoker.trigger()):this.processTask(U,L)},this.process=()=>{if(!this.taskQueue.length)return;const I=this.taskQueue.shift(),L=this.tasks[I];delete this.tasks[I],this.taskQueue.length&&this.invoker.trigger(),L&&this.processTask(I,L)},this.target=f,this.parent=u,this.mapId=p,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new E0(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Nt()?f:window}send(f,u,p,I,L=!1){const U=Math.round(1e18*Math.random()).toString(36).substring(0,10);p&&(this.callbacks[U]=p);const Q=[],re={id:U,type:f,hasCallback:!!p,targetMapId:I,mustQueue:L,sourceMapId:this.mapId,data:Sn(u,Q)};return this.target.postMessage(re,{transfer:Q}),{cancel:()=>{p&&delete this.callbacks[U],this.target.postMessage({id:U,type:"<cancel>",targetMapId:I,sourceMapId:this.mapId})}}}processTask(f,u){if(u.type==="<response>"){const p=this.callbacks[f];delete this.callbacks[f],p&&(u.error?p(No(u.error)):p(null,No(u.data)))}else{let p=!1;const I=[],L=u.hasCallback?(re,Ae)=>{p=!0,delete this.cancelCallbacks[f];const _e={id:f,type:"<response>",sourceMapId:this.mapId,error:re?Sn(re):null,data:Sn(Ae,I)};this.target.postMessage(_e,{transfer:I})}:re=>{p=!0};let U=null;const Q=No(u.data);if(this.parent[u.type])U=this.parent[u.type](u.sourceMapId,Q,L);else if("getWorkerSource"in this.parent){const re=u.type.split(".");U=this.parent.getWorkerSource(u.sourceMapId,re[0],Q.source)[re[1]](Q,L)}else L(new Error(`Could not find function ${u.type}`));!p&&U&&U.cancel&&(this.cancelCallbacks[f]=U.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.D=Mi,a.E=Pr,a.F=function(f,u){const p={};for(let I=0;I<u.length;I++){const L=u[I];L in f&&(p[L]=f[L])}return p},a.G=GA,a.H=Ed,a.I=x0,a.J=ut,a.K=xt,a.L=Bc,a.M=wi,a.N=Pa,a.O=bl,a.P=ue,a.Q=R,a.R=Ll,a.S=er,a.T=tl,a.U=Df,a.V=class extends we{},a.W=Md,a.X=function(f,u){const p=window.document.createElement("video");p.muted=!0,p.onloadstart=function(){u(null,p)};for(let I=0;I<f.length;I++){const L=window.document.createElement("source");Ji(f[I])||(p.crossOrigin="Anonymous"),L.src=f[I],p.appendChild(L)}return{cancel:()=>{}}},a.Y=ve,a.Z=function(){var f=new Hh(16);return Hh!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0),f[0]=1,f[5]=1,f[10]=1,f[15]=1,f},a._=G,a.a=Ot,a.a$=class extends w{},a.a0=function(f,u,p){var I=p[0],L=p[1],U=p[2];return f[0]=u[0]*I,f[1]=u[1]*I,f[2]=u[2]*I,f[3]=u[3]*I,f[4]=u[4]*L,f[5]=u[5]*L,f[6]=u[6]*L,f[7]=u[7]*L,f[8]=u[8]*U,f[9]=u[9]*U,f[10]=u[10]*U,f[11]=u[11]*U,f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},a.a1=cf,a.a2=function(){return vt++},a.a3=j,a.a4=sh,a.a5=function(){gs.isLoading()||gs.isLoaded()||Nu()!=="deferred"||_r()},a.a6=Qr,a.a7=Ec,a.a8=gn,a.a9=Dd,a.aA=_u,a.aB=function(f){f=f.slice();const u=Object.create(null);for(let p=0;p<f.length;p++)u[f[p].id]=f[p];for(let p=0;p<f.length;p++)"ref"in f[p]&&(f[p]=tr(f[p],u[f[p].ref]));return f},a.aC=function(f){if(f.type==="custom")return new UA(f);switch(f.type){case"background":return new Rp(f);case"circle":return new Vu(f);case"fill":return new wp(f);case"fill-extrusion":return new id(f);case"heatmap":return new Jc(f);case"hillshade":return new W0(f);case"line":return new Al(f);case"raster":return new Fp(f);case"symbol":return new VA(f)}},a.aD=Pt,a.aE=function(f,u){if(!f)return[{command:Qn.setStyle,args:[u]}];let p=[];try{if(!Pn(f.version,u.version))return[{command:Qn.setStyle,args:[u]}];Pn(f.center,u.center)||p.push({command:Qn.setCenter,args:[u.center]}),Pn(f.zoom,u.zoom)||p.push({command:Qn.setZoom,args:[u.zoom]}),Pn(f.bearing,u.bearing)||p.push({command:Qn.setBearing,args:[u.bearing]}),Pn(f.pitch,u.pitch)||p.push({command:Qn.setPitch,args:[u.pitch]}),Pn(f.sprite,u.sprite)||p.push({command:Qn.setSprite,args:[u.sprite]}),Pn(f.glyphs,u.glyphs)||p.push({command:Qn.setGlyphs,args:[u.glyphs]}),Pn(f.transition,u.transition)||p.push({command:Qn.setTransition,args:[u.transition]}),Pn(f.light,u.light)||p.push({command:Qn.setLight,args:[u.light]});const I={},L=[];(function(Q,re,Ae,_e){let Le;for(Le in re=re||{},Q=Q||{})Object.prototype.hasOwnProperty.call(Q,Le)&&(Object.prototype.hasOwnProperty.call(re,Le)||v(Le,Ae,_e));for(Le in re)Object.prototype.hasOwnProperty.call(re,Le)&&(Object.prototype.hasOwnProperty.call(Q,Le)?Pn(Q[Le],re[Le])||(Q[Le].type==="geojson"&&re[Le].type==="geojson"&&V(Q,re,Le)?Ae.push({command:Qn.setGeoJSONSourceData,args:[Le,re[Le].data]}):k(Le,re,Ae,_e)):In(Le,re,Ae))})(f.sources,u.sources,L,I);const U=[];f.layers&&f.layers.forEach(Q=>{I[Q.source]?p.push({command:Qn.removeLayer,args:[Q.id]}):U.push(Q)}),p=p.concat(L),function(Q,re,Ae){re=re||[];const _e=(Q=Q||[]).map(te),Le=re.map(te),qe=Q.reduce(fe,{}),et=re.reduce(fe,{}),At=_e.slice(),gt=Object.create(null);let Dt,Lt,Rt,Kt,Ht,Qt,ui;for(Dt=0,Lt=0;Dt<_e.length;Dt++)Rt=_e[Dt],Object.prototype.hasOwnProperty.call(et,Rt)?Lt++:(Ae.push({command:Qn.removeLayer,args:[Rt]}),At.splice(At.indexOf(Rt,Lt),1));for(Dt=0,Lt=0;Dt<Le.length;Dt++)Rt=Le[Le.length-1-Dt],At[At.length-1-Dt]!==Rt&&(Object.prototype.hasOwnProperty.call(qe,Rt)?(Ae.push({command:Qn.removeLayer,args:[Rt]}),At.splice(At.lastIndexOf(Rt,At.length-Lt),1)):Lt++,Qt=At[At.length-Dt],Ae.push({command:Qn.addLayer,args:[et[Rt],Qt]}),At.splice(At.length-Dt,0,Rt),gt[Rt]=!0);for(Dt=0;Dt<Le.length;Dt++)if(Rt=Le[Dt],Kt=qe[Rt],Ht=et[Rt],!gt[Rt]&&!Pn(Kt,Ht))if(Pn(Kt.source,Ht.source)&&Pn(Kt["source-layer"],Ht["source-layer"])&&Pn(Kt.type,Ht.type)){for(ui in Y(Kt.layout,Ht.layout,Ae,Rt,null,Qn.setLayoutProperty),Y(Kt.paint,Ht.paint,Ae,Rt,null,Qn.setPaintProperty),Pn(Kt.filter,Ht.filter)||Ae.push({command:Qn.setFilter,args:[Rt,Ht.filter]}),Pn(Kt.minzoom,Ht.minzoom)&&Pn(Kt.maxzoom,Ht.maxzoom)||Ae.push({command:Qn.setLayerZoomRange,args:[Rt,Ht.minzoom,Ht.maxzoom]}),Kt)Object.prototype.hasOwnProperty.call(Kt,ui)&&ui!=="layout"&&ui!=="paint"&&ui!=="filter"&&ui!=="metadata"&&ui!=="minzoom"&&ui!=="maxzoom"&&(ui.indexOf("paint.")===0?Y(Kt[ui],Ht[ui],Ae,Rt,ui.slice(6),Qn.setPaintProperty):Pn(Kt[ui],Ht[ui])||Ae.push({command:Qn.setLayerProperty,args:[Rt,ui,Ht[ui]]}));for(ui in Ht)Object.prototype.hasOwnProperty.call(Ht,ui)&&!Object.prototype.hasOwnProperty.call(Kt,ui)&&ui!=="layout"&&ui!=="paint"&&ui!=="filter"&&ui!=="metadata"&&ui!=="minzoom"&&ui!=="maxzoom"&&(ui.indexOf("paint.")===0?Y(Kt[ui],Ht[ui],Ae,Rt,ui.slice(6),Qn.setPaintProperty):Pn(Kt[ui],Ht[ui])||Ae.push({command:Qn.setLayerProperty,args:[Rt,ui,Ht[ui]]}))}else Ae.push({command:Qn.removeLayer,args:[Rt]}),Qt=At[At.lastIndexOf(Rt)+1],Ae.push({command:Qn.addLayer,args:[Ht,Qt]})}(U,u.layers,p)}catch(I){console.warn("Unable to compute style diff:",I),p=[{command:Qn.setStyle,args:[u]}]}return p},a.aF=function(f){const u=[],p=f.id;return p===void 0&&u.push({message:`layers.${p}: missing required property "id"`}),f.render===void 0&&u.push({message:`layers.${p}: missing required method "render"`}),f.renderingMode&&f.renderingMode!=="2d"&&f.renderingMode!=="3d"&&u.push({message:`layers.${p}: property "renderingMode" must be either "2d" or "3d"`}),u},a.aG=function f(u,p){if(Array.isArray(u)){if(!Array.isArray(p)||u.length!==p.length)return!1;for(let I=0;I<u.length;I++)if(!f(u[I],p[I]))return!1;return!0}if(typeof u=="object"&&u!==null&&p!==null){if(typeof p!="object"||Object.keys(u).length!==Object.keys(p).length)return!1;for(const I in u)if(!f(u[I],p[I]))return!1;return!0}return u===p},a.aH=mt,a.aI=Et,a.aJ=cu,a.aK=function(f){return f({pluginStatus:_a,pluginURL:el}),cu.on("pluginStateChange",f),f},a.aL=class extends bs{constructor(f,u){super(f,u),this.current=0}set(f){this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}},a.aM=Ws,a.aN=class extends bs{constructor(f,u){super(f,u),this.current=Go}set(f){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let u=1;u<16;u++)if(f[u]!==this.current[u]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}},a.aO=Do,a.aP=class extends bs{constructor(f,u){super(f,u),this.current=[0,0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2]))}},a.aQ=class extends bs{constructor(f,u){super(f,u),this.current=[0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1]))}},a.aR=Uo,a.aS=function(f,u,p,I,L,U,Q){var re=1/(u-p),Ae=1/(I-L),_e=1/(U-Q);return f[0]=-2*re,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=-2*Ae,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=2*_e,f[11]=0,f[12]=(u+p)*re,f[13]=(L+I)*Ae,f[14]=(Q+U)*_e,f[15]=1,f},a.aT=Zi,a.aU=Z0,a.aV=class extends F{},a.aW=ud,a.aX=class extends y{},a.aY=function(f){return f<=1?1:Math.pow(2,Math.ceil(Math.log(f)/Math.LN2))},a.aZ=A0,a.a_=It,a.aa=function(f){const u={};if(f.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(p,I,L,U)=>{const Q=L||U;return u[I]=!Q||Q.toLowerCase(),""}),u["max-age"]){const p=parseInt(u["max-age"],10);isNaN(p)?delete u["max-age"]:u["max-age"]=p}return u},a.ab=function(f,u){const p=[];for(const I in f)I in u||p.push(I);return p},a.ac=function(f){if(zt==null){const u=f.navigator?f.navigator.userAgent:null;zt=!!f.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return zt},a.ad=Oe,a.ae=function(f,u,p){var I=Math.sin(p),L=Math.cos(p),U=u[0],Q=u[1],re=u[2],Ae=u[3],_e=u[4],Le=u[5],qe=u[6],et=u[7];return u!==f&&(f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[0]=U*L+_e*I,f[1]=Q*L+Le*I,f[2]=re*L+qe*I,f[3]=Ae*L+et*I,f[4]=_e*L-U*I,f[5]=Le*L-Q*I,f[6]=qe*L-re*I,f[7]=et*L-Ae*I,f},a.af=function(f){var u=new Hh(16);return u[0]=f[0],u[1]=f[1],u[2]=f[2],u[3]=f[3],u[4]=f[4],u[5]=f[5],u[6]=f[6],u[7]=f[7],u[8]=f[8],u[9]=f[9],u[10]=f[10],u[11]=f[11],u[12]=f[12],u[13]=f[13],u[14]=f[14],u[15]=f[15],u},a.ag=Dl,a.ah=function(f,u){let p=0,I=0;if(f.kind==="constant")I=f.layoutSize;else if(f.kind!=="source"){const{interpolationType:L,minZoom:U,maxZoom:Q}=f,re=L?Oe(vr.interpolationFactor(L,u,U,Q),0,1):0;f.kind==="camera"?I=Zs.number(f.minSize,f.maxSize,re):p=re}return{uSizeT:p,uSize:I}},a.aj=function(f,{uSize:u,uSizeT:p},{lowerSize:I,upperSize:L}){return f.kind==="source"?I/Yu:f.kind==="composite"?Zs.number(I/Yu,L/Yu,p):u},a.ak=NA,a.al=function(f,u,p,I){const L=u.y-f.y,U=u.x-f.x,Q=I.y-p.y,re=I.x-p.x,Ae=Q*U-re*L;if(Ae===0)return null;const _e=(re*(f.y-p.y)-Q*(f.x-p.x))/Ae;return new ue(f.x+_e*U,f.y+_e*L)},a.am=Bd,a.an=$c,a.ao=jh,a.ap=Ka,a.ar=I0,a.as=function(f,u){var p=u[0],I=u[1],L=u[2],U=u[3],Q=u[4],re=u[5],Ae=u[6],_e=u[7],Le=u[8],qe=u[9],et=u[10],At=u[11],gt=u[12],Dt=u[13],Lt=u[14],Rt=u[15],Kt=p*re-I*Q,Ht=p*Ae-L*Q,Qt=p*_e-U*Q,ui=I*Ae-L*re,yi=I*_e-U*re,Yi=L*_e-U*Ae,wn=Le*Dt-qe*gt,un=Le*Lt-et*gt,on=Le*Rt-At*gt,dn=qe*Lt-et*Dt,Rn=qe*Rt-At*Dt,an=et*Rt-At*Lt,Xi=Kt*an-Ht*Rn+Qt*dn+ui*on-yi*un+Yi*wn;return Xi?(f[0]=(re*an-Ae*Rn+_e*dn)*(Xi=1/Xi),f[1]=(L*Rn-I*an-U*dn)*Xi,f[2]=(Dt*Yi-Lt*yi+Rt*ui)*Xi,f[3]=(et*yi-qe*Yi-At*ui)*Xi,f[4]=(Ae*on-Q*an-_e*un)*Xi,f[5]=(p*an-L*on+U*un)*Xi,f[6]=(Lt*Qt-gt*Yi-Rt*Ht)*Xi,f[7]=(Le*Yi-et*Qt+At*Ht)*Xi,f[8]=(Q*Rn-re*on+_e*wn)*Xi,f[9]=(I*on-p*Rn-U*wn)*Xi,f[10]=(gt*yi-Dt*Qt+Rt*Kt)*Xi,f[11]=(qe*Qt-Le*yi-At*Kt)*Xi,f[12]=(re*un-Q*dn-Ae*wn)*Xi,f[13]=(p*dn-I*un+L*wn)*Xi,f[14]=(Dt*Ht-gt*ui-Lt*Kt)*Xi,f[15]=(Le*ui-qe*Ht+et*Kt)*Xi,f):null},a.at=Rf,a.au=gd,a.av=Vf,a.aw=function(){const f={},u=ci.$version;for(const p in ci.$root){const I=ci.$root[p];if(I.required){let L=null;L=p==="version"?u:I.type==="array"?[]:{},L!=null&&(f[p]=L)}}return f},a.ax=Qn,a.ay=Nl,a.az=Ci,a.b=function(f,u){const p=new Blob([new Uint8Array(f)],{type:"image/png"});createImageBitmap(p).then(I=>{u(null,I)}).catch(I=>{u(new Error(`Could not load image because of ${I.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},a.b0=zn,a.b1=function(f,u){var p=f[0],I=f[1],L=f[2],U=f[3],Q=f[4],re=f[5],Ae=f[6],_e=f[7],Le=f[8],qe=f[9],et=f[10],At=f[11],gt=f[12],Dt=f[13],Lt=f[14],Rt=f[15],Kt=u[0],Ht=u[1],Qt=u[2],ui=u[3],yi=u[4],Yi=u[5],wn=u[6],un=u[7],on=u[8],dn=u[9],Rn=u[10],an=u[11],Xi=u[12],Ln=u[13],Nn=u[14],pr=u[15];return Math.abs(p-Kt)<=Kl*Math.max(1,Math.abs(p),Math.abs(Kt))&&Math.abs(I-Ht)<=Kl*Math.max(1,Math.abs(I),Math.abs(Ht))&&Math.abs(L-Qt)<=Kl*Math.max(1,Math.abs(L),Math.abs(Qt))&&Math.abs(U-ui)<=Kl*Math.max(1,Math.abs(U),Math.abs(ui))&&Math.abs(Q-yi)<=Kl*Math.max(1,Math.abs(Q),Math.abs(yi))&&Math.abs(re-Yi)<=Kl*Math.max(1,Math.abs(re),Math.abs(Yi))&&Math.abs(Ae-wn)<=Kl*Math.max(1,Math.abs(Ae),Math.abs(wn))&&Math.abs(_e-un)<=Kl*Math.max(1,Math.abs(_e),Math.abs(un))&&Math.abs(Le-on)<=Kl*Math.max(1,Math.abs(Le),Math.abs(on))&&Math.abs(qe-dn)<=Kl*Math.max(1,Math.abs(qe),Math.abs(dn))&&Math.abs(et-Rn)<=Kl*Math.max(1,Math.abs(et),Math.abs(Rn))&&Math.abs(At-an)<=Kl*Math.max(1,Math.abs(At),Math.abs(an))&&Math.abs(gt-Xi)<=Kl*Math.max(1,Math.abs(gt),Math.abs(Xi))&&Math.abs(Dt-Ln)<=Kl*Math.max(1,Math.abs(Dt),Math.abs(Ln))&&Math.abs(Lt-Nn)<=Kl*Math.max(1,Math.abs(Lt),Math.abs(Nn))&&Math.abs(Rt-pr)<=Kl*Math.max(1,Math.abs(Rt),Math.abs(pr))},a.b2=function(f,u){return f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[4]=u[4],f[5]=u[5],f[6]=u[6],f[7]=u[7],f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},a.b3=function(f,u,p){return f[0]=u[0]*p[0],f[1]=u[1]*p[1],f[2]=u[2]*p[2],f[3]=u[3]*p[3],f},a.b4=function(f,u){return f[0]*u[0]+f[1]*u[1]+f[2]*u[2]+f[3]*u[3]},a.b5=jt,a.b6=Pd,a.b7=Cd,a.b8=function(f,u,p,I,L){var U,Q=1/Math.tan(u/2);return f[0]=Q/p,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=Q,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=-1,f[12]=0,f[13]=0,f[15]=0,L!=null&&L!==1/0?(f[10]=(L+I)*(U=1/(I-L)),f[14]=2*L*I*U):(f[10]=-1,f[14]=-2*I),f},a.b9=function(f,u,p){var I=Math.sin(p),L=Math.cos(p),U=u[4],Q=u[5],re=u[6],Ae=u[7],_e=u[8],Le=u[9],qe=u[10],et=u[11];return u!==f&&(f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[4]=U*L+_e*I,f[5]=Q*L+Le*I,f[6]=re*L+qe*I,f[7]=Ae*L+et*I,f[8]=_e*L-U*I,f[9]=Le*L-Q*I,f[10]=qe*L-re*I,f[11]=et*L-Ae*I,f},a.bA=he,a.bB=g0,a.bC=Zr,a.bD=gs,a.ba=Tt,a.bb=Mt,a.bc=function(f,u){return f[0]=u[0],f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=u[1],f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=u[2],f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f},a.bd=class extends oe{},a.be=C0,a.bf=Td,a.bg=Ne,a.bi=vn,a.bj=function(f,u,p=!1){if(_a===oc||_a===$u||_a===$l)throw new Error("setRTLTextPlugin cannot be called multiple times.");el=Vi.resolveURL(f),_a=oc,ms=u,Ou(),p||_r()},a.bk=Nu,a.bl=function(f,u){const p={};for(let L=0;L<f.length;L++){const U=u&&u[f[L].id]||$a(f[L]);u&&(u[f[L].id]=U);let Q=p[U];Q||(Q=p[U]=[]),Q.push(f[L])}const I=[];for(const L in p)I.push(p[L]);return I},a.bm=Dn,a.bn=M0,a.bo=Op,a.bp=ku,a.bq=function(f){f.bucket.createArrays(),f.bucket.tilePixelRatio=Pa/(512*f.bucket.overscaling),f.bucket.compareText={},f.bucket.iconsNeedLinear=!1;const u=f.bucket.layers[0],p=u.layout,I=u._unevaluatedLayout._values,L={layoutIconSize:I["icon-size"].possiblyEvaluate(new gn(f.bucket.zoom+1),f.canonical),layoutTextSize:I["text-size"].possiblyEvaluate(new gn(f.bucket.zoom+1),f.canonical),textMaxSize:I["text-size"].possiblyEvaluate(new gn(18))};if(f.bucket.textSizeData.kind==="composite"){const{minZoom:_e,maxZoom:Le}=f.bucket.textSizeData;L.compositeTextSizes=[I["text-size"].possiblyEvaluate(new gn(_e),f.canonical),I["text-size"].possiblyEvaluate(new gn(Le),f.canonical)]}if(f.bucket.iconSizeData.kind==="composite"){const{minZoom:_e,maxZoom:Le}=f.bucket.iconSizeData;L.compositeIconSizes=[I["icon-size"].possiblyEvaluate(new gn(_e),f.canonical),I["icon-size"].possiblyEvaluate(new gn(Le),f.canonical)]}const U=p.get("text-line-height")*Ka,Q=p.get("text-rotation-alignment")!=="viewport"&&p.get("symbol-placement")!=="point",re=p.get("text-keep-upright"),Ae=p.get("text-size");for(const _e of f.bucket.features){const Le=p.get("text-font").evaluate(_e,{},f.canonical).join(","),qe=Ae.evaluate(_e,{},f.canonical),et=L.layoutTextSize.evaluate(_e,{},f.canonical),At=L.layoutIconSize.evaluate(_e,{},f.canonical),gt={horizontal:{},vertical:void 0},Dt=_e.text;let Lt,Rt=[0,0];if(Dt){const Qt=Dt.toString(),ui=p.get("text-letter-spacing").evaluate(_e,{},f.canonical)*Ka,yi=Cn(Qt)?ui:0,Yi=p.get("text-anchor").evaluate(_e,{},f.canonical),wn=WA(u,_e,f.canonical);if(!wn){const an=p.get("text-radial-offset").evaluate(_e,{},f.canonical);Rt=an?QA(Yi,[an*Ka,Mh]):p.get("text-offset").evaluate(_e,{},f.canonical).map(Xi=>Xi*Ka)}let un=Q?"center":p.get("text-justify").evaluate(_e,{},f.canonical);const on=p.get("symbol-placement"),dn=on==="point"?p.get("text-max-width").evaluate(_e,{},f.canonical)*Ka:0,Rn=()=>{f.bucket.allowVerticalPlacement&&Wl(Qt)&&(gt.vertical=OA(Dt,f.glyphMap,f.glyphPositions,f.imagePositions,Le,dn,U,Yi,"left",yi,Rt,a.ai.vertical,!0,on,et,qe))};if(!Q&&wn){const an=new Set;if(un==="auto")for(let Ln=0;Ln<wn.values.length;Ln+=2)an.add(Rf(wn.values[Ln]));else an.add(un);let Xi=!1;for(const Ln of an)if(!gt.horizontal[Ln])if(Xi)gt.horizontal[Ln]=gt.horizontal[0];else{const Nn=OA(Dt,f.glyphMap,f.glyphPositions,f.imagePositions,Le,dn,U,"center",Ln,yi,Rt,a.ai.horizontal,!1,on,et,qe);Nn&&(gt.horizontal[Ln]=Nn,Xi=Nn.positionedLines.length===1)}Rn()}else{un==="auto"&&(un=Rf(Yi));const an=OA(Dt,f.glyphMap,f.glyphPositions,f.imagePositions,Le,dn,U,Yi,un,yi,Rt,a.ai.horizontal,!1,on,et,qe);an&&(gt.horizontal[un]=an),Rn(),Wl(Qt)&&Q&&re&&(gt.vertical=OA(Dt,f.glyphMap,f.glyphPositions,f.imagePositions,Le,dn,U,Yi,un,yi,Rt,a.ai.vertical,!1,on,et,qe))}}let Kt=!1;if(_e.icon&&_e.icon.name){const Qt=f.imageMap[_e.icon.name];Qt&&(Lt=w0(f.imagePositions[_e.icon.name],p.get("icon-offset").evaluate(_e,{},f.canonical),p.get("icon-anchor").evaluate(_e,{},f.canonical)),Kt=!!Qt.sdf,f.bucket.sdfIcons===void 0?f.bucket.sdfIcons=Kt:f.bucket.sdfIcons!==Kt&&Je("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Qt.pixelRatio!==f.bucket.pixelRatio||p.get("icon-rotate").constantOr(1)!==0)&&(f.bucket.iconsNeedLinear=!0))}const Ht=Of(gt.horizontal)||gt.vertical;f.bucket.iconsInText=!!Ht&&Ht.iconsInText,(Ht||Lt)&&D0(f.bucket,_e,gt,Lt,f.imageMap,L,et,At,Rt,Kt,f.canonical)}f.showCollisionBoxes&&f.bucket.generateCollisionDebugBuffers()},a.br=rd,a.bs=xf,a.bt=Ul,a.bu=class{constructor(f){this._marks={start:[f.url,"start"].join("#"),end:[f.url,"end"].join("#"),measure:f.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let f=performance.getEntriesByName(this._marks.measure);return f.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),f=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),f}},a.bv=v0,a.bw=Ih,a.bx=function(f,u,p,I,L){return G(this,void 0,void 0,function*(){if(xt())try{return yield wi(f,u,p,I,L)}catch{}return function(U,Q,re,Ae,_e){const Le=U.width,qe=U.height;Ti&&Ni||(Ti=new OffscreenCanvas(Le,qe),Ni=Ti.getContext("2d",{willReadFrequently:!0})),Ti.width=Le,Ti.height=qe,Ni.drawImage(U,0,0,Le,qe);const et=Ni.getImageData(Q,re,Ae,_e);return Ni.clearRect(0,0,Le,qe),et.data}(f,u,p,I,L)})},a.by=k0,a.bz=W,a.c=nn,a.d=function(f,u){const p=new Image;p.onload=()=>{u(null,p),URL.revokeObjectURL(p.src),p.onload=null,window.requestAnimationFrame(()=>{p.src=gi})},p.onerror=()=>u(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const I=new Blob([new Uint8Array(f)],{type:"image/png"});p.src=f.byteLength?URL.createObjectURL(I):gi},a.e=it,a.f=function(f,u){return Oi(it(f,{type:"json"}),u)},a.g=mi,a.h=Vi,a.i=Nt,a.j=_n,a.k=ei,a.l=_i,a.m=Oi,a.n=function(f){return new v0(f).readFields(BA,[])},a.o=function(f,u,p){if(!f.length)return p(null,[]);let I=f.length;const L=new Array(f.length);let U=null;f.forEach((Q,re)=>{u(Q,(Ae,_e)=>{Ae&&(U=Ae),L[re]=_e,--I==0&&p(U,L)})})},a.p=Tf,a.q=xh,a.r=fs,a.s=Ji,a.t=yo,a.u=En,a.v=ci,a.w=Je,a.x=Ru,a.y=Ya,a.z=function([f,u,p]){return u+=90,u*=Math.PI/180,p*=Math.PI/180,{x:f*Math.cos(u)*Math.sin(p),y:f*Math.sin(u)*Math.sin(p),z:f*Math.cos(p)}}}),x(["./shared"],function(a){class G{constructor($){this.keyCache={},$&&this.replace($)}replace($){this._layerConfigs={},this._layers={},this.update($,[])}update($,ie){for(const ye of $){this._layerConfigs[ye.id]=ye;const ge=this._layers[ye.id]=a.aC(ye);ge._featureFilter=a.a6(ge.filter),this.keyCache[ye.id]&&delete this.keyCache[ye.id]}for(const ye of ie)delete this.keyCache[ye],delete this._layerConfigs[ye],delete this._layers[ye];this.familiesBySource={};const de=a.bl(Object.values(this._layerConfigs),this.keyCache);for(const ye of de){const ge=ye.map(De=>this._layers[De.id]),Pe=ge[0];if(Pe.visibility==="none")continue;const Fe=Pe.source||"";let Ve=this.familiesBySource[Fe];Ve||(Ve=this.familiesBySource[Fe]={});const Xe=Pe.sourceLayer||"_geojsonTileLayer";let Ye=Ve[Xe];Ye||(Ye=Ve[Xe]=[]),Ye.push(ge)}}}class W{constructor($){const ie={},de=[];for(const Fe in $){const Ve=$[Fe],Xe=ie[Fe]={};for(const Ye in Ve){const De=Ve[+Ye];if(!De||De.bitmap.width===0||De.bitmap.height===0)continue;const Ge={x:0,y:0,w:De.bitmap.width+2,h:De.bitmap.height+2};de.push(Ge),Xe[Ye]={rect:Ge,metrics:De.metrics}}}const{w:ye,h:ge}=a.p(de),Pe=new a.q({width:ye||1,height:ge||1});for(const Fe in $){const Ve=$[Fe];for(const Xe in Ve){const Ye=Ve[+Xe];if(!Ye||Ye.bitmap.width===0||Ye.bitmap.height===0)continue;const De=ie[Fe][Xe].rect;a.q.copy(Ye.bitmap,Pe,{x:0,y:0},{x:De.x+1,y:De.y+1},Ye.bitmap)}}this.image=Pe,this.positions=ie}}a.bm("GlyphAtlas",W);class he{constructor($){this.tileID=new a.O($.tileID.overscaledZ,$.tileID.wrap,$.tileID.canonical.z,$.tileID.canonical.x,$.tileID.canonical.y),this.uid=$.uid,this.zoom=$.zoom,this.pixelRatio=$.pixelRatio,this.tileSize=$.tileSize,this.source=$.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=$.showCollisionBoxes,this.collectResourceTiming=!!$.collectResourceTiming,this.returnDependencies=!!$.returnDependencies,this.promoteId=$.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse($,ie,de,ye,ge){this.status="parsing",this.data=$,this.collisionBoxArray=new a.a3;const Pe=new a.bn(Object.keys($.layers).sort()),Fe=new a.bo(this.tileID,this.promoteId);Fe.bucketLayerIDs=[];const Ve={},Xe={featureIndex:Fe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:de},Ye=ie.familiesBySource[this.source];for(const Jt in Ye){const oi=$.layers[Jt];if(!oi)continue;oi.version===1&&a.w(`Vector tile source "${this.source}" layer "${Jt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const zi=Pe.encode(Jt),xi=[];for(let Si=0;Si<oi.length;Si++){const Yt=oi.feature(Si),bn=Fe.getId(Yt,Jt);xi.push({feature:Yt,id:bn,index:Si,sourceLayerIndex:zi})}for(const Si of Ye[Jt]){const Yt=Si[0];Yt.source!==this.source&&a.w(`layer.source = ${Yt.source} does not equal this.source = ${this.source}`),Yt.minzoom&&this.zoom<Math.floor(Yt.minzoom)||Yt.maxzoom&&this.zoom>=Yt.maxzoom||Yt.visibility!=="none"&&(ae(Si,this.zoom,de),(Ve[Yt.id]=Yt.createBucket({index:Fe.bucketLayerIDs.length,layers:Si,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:zi,sourceID:this.source})).populate(xi,Xe,this.tileID.canonical),Fe.bucketLayerIDs.push(Si.map(bn=>bn.id)))}}let De,Ge,ht,kt;const o=a.aH(Xe.glyphDependencies,Jt=>Object.keys(Jt).map(Number));this.inFlightDependencies.forEach(Jt=>Jt==null?void 0:Jt.cancel()),this.inFlightDependencies=[];const ke=++this.dependencySentinel;Object.keys(o).length?this.inFlightDependencies.push(ye.send("getGlyphs",{uid:this.uid,stacks:o,source:this.source,tileID:this.tileID,type:"glyphs"},(Jt,oi)=>{ke===this.dependencySentinel&&(De||(De=Jt,Ge=oi,hi.call(this)))})):Ge={};const ai=Object.keys(Xe.iconDependencies);ai.length?this.inFlightDependencies.push(ye.send("getImages",{icons:ai,source:this.source,tileID:this.tileID,type:"icons"},(Jt,oi)=>{ke===this.dependencySentinel&&(De||(De=Jt,ht=oi,hi.call(this)))})):ht={};const fi=Object.keys(Xe.patternDependencies);function hi(){if(De)return ge(De);if(Ge&&ht&&kt){const Jt=new W(Ge),oi=new a.bp(ht,kt);for(const zi in Ve){const xi=Ve[zi];xi instanceof a.a4?(ae(xi.layers,this.zoom,de),a.bq({bucket:xi,glyphMap:Ge,glyphPositions:Jt.positions,imageMap:ht,imagePositions:oi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):xi.hasPattern&&(xi instanceof a.br||xi instanceof a.bs||xi instanceof a.bt)&&(ae(xi.layers,this.zoom,de),xi.addFeatures(Xe,this.tileID.canonical,oi.patternPositions))}this.status="done",ge(null,{buckets:Object.values(Ve).filter(zi=>!zi.isEmpty()),featureIndex:Fe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Jt.image,imageAtlas:oi,glyphMap:this.returnDependencies?Ge:null,iconMap:this.returnDependencies?ht:null,glyphPositions:this.returnDependencies?Jt.positions:null})}}fi.length?this.inFlightDependencies.push(ye.send("getImages",{icons:fi,source:this.source,tileID:this.tileID,type:"patterns"},(Jt,oi)=>{ke===this.dependencySentinel&&(De||(De=Jt,kt=oi,hi.call(this)))})):kt={},hi.call(this)}}function ae(ne,$,ie){const de=new a.a8($);for(const ye of ne)ye.recalculate(de,ie)}function ue(ne,$){const ie=a.l(ne.request,(de,ye,ge,Pe)=>{if(de)$(de);else if(ye)try{const Fe=new a.bw.VectorTile(new a.bv(ye));$(null,{vectorTile:Fe,rawData:ye,cacheControl:ge,expires:Pe})}catch(Fe){const Ve=new Uint8Array(ye);let Xe=`Unable to parse the tile at ${ne.request.url}, `;Xe+=Ve[0]===31&&Ve[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Fe.messge}`,$(new Error(Xe))}});return()=>{ie.cancel(),$()}}class be{constructor($,ie,de,ye){this.actor=$,this.layerIndex=ie,this.availableImages=de,this.loadVectorData=ye||ue,this.fetching={},this.loading={},this.loaded={}}loadTile($,ie){const de=$.uid;this.loading||(this.loading={});const ye=!!($&&$.request&&$.request.collectResourceTiming)&&new a.bu($.request),ge=this.loading[de]=new he($);ge.abort=this.loadVectorData($,(Pe,Fe)=>{if(delete this.loading[de],Pe||!Fe)return ge.status="done",this.loaded[de]=ge,ie(Pe);const Ve=Fe.rawData,Xe={};Fe.expires&&(Xe.expires=Fe.expires),Fe.cacheControl&&(Xe.cacheControl=Fe.cacheControl);const Ye={};if(ye){const De=ye.finish();De&&(Ye.resourceTiming=JSON.parse(JSON.stringify(De)))}ge.vectorTile=Fe.vectorTile,ge.parse(Fe.vectorTile,this.layerIndex,this.availableImages,this.actor,(De,Ge)=>{if(delete this.fetching[de],De||!Ge)return ie(De);ie(null,a.e({rawTileData:Ve.slice(0)},Ge,Xe,Ye))}),this.loaded=this.loaded||{},this.loaded[de]=ge,this.fetching[de]={rawTileData:Ve,cacheControl:Xe,resourceTiming:Ye}})}reloadTile($,ie){const de=this.loaded,ye=$.uid;if(de&&de[ye]){const ge=de[ye];ge.showCollisionBoxes=$.showCollisionBoxes,ge.status==="parsing"?ge.parse(ge.vectorTile,this.layerIndex,this.availableImages,this.actor,(Pe,Fe)=>{if(Pe||!Fe)return ie(Pe,Fe);let Ve;if(this.fetching[ye]){const{rawTileData:Xe,cacheControl:Ye,resourceTiming:De}=this.fetching[ye];delete this.fetching[ye],Ve=a.e({rawTileData:Xe.slice(0)},Fe,Ye,De)}else Ve=Fe;ie(null,Ve)}):ge.status==="done"&&(ge.vectorTile?ge.parse(ge.vectorTile,this.layerIndex,this.availableImages,this.actor,ie):ie())}}abortTile($,ie){const de=this.loading,ye=$.uid;de&&de[ye]&&de[ye].abort&&(de[ye].abort(),delete de[ye]),ie()}removeTile($,ie){const de=this.loaded,ye=$.uid;de&&de[ye]&&delete de[ye],ie()}}class je{constructor(){this.loaded={}}loadTile($,ie){return a._(this,void 0,void 0,function*(){const{uid:de,encoding:ye,rawImageData:ge,redFactor:Pe,greenFactor:Fe,blueFactor:Ve,baseShift:Xe}=$,Ye=ge.width+2,De=ge.height+2,Ge=a.a(ge)?new a.R({width:Ye,height:De},yield a.bx(ge,-1,-1,Ye,De)):ge,ht=new a.by(de,Ge,ye,Pe,Fe,Ve,Xe);this.loaded=this.loaded||{},this.loaded[de]=ht,ie(null,ht)})}removeTile($){const ie=this.loaded,de=$.uid;ie&&ie[de]&&delete ie[de]}}function nt(ne,$){if(ne.length!==0){tt(ne[0],$);for(var ie=1;ie<ne.length;ie++)tt(ne[ie],!$)}}function tt(ne,$){for(var ie=0,de=0,ye=0,ge=ne.length,Pe=ge-1;ye<ge;Pe=ye++){var Fe=(ne[ye][0]-ne[Pe][0])*(ne[Pe][1]+ne[ye][1]),Ve=ie+Fe;de+=Math.abs(ie)>=Math.abs(Fe)?ie-Ve+Fe:Fe-Ve+ie,ie=Ve}ie+de>=0!=!!$&&ne.reverse()}var at=a.bz(function ne($,ie){var de,ye=$&&$.type;if(ye==="FeatureCollection")for(de=0;de<$.features.length;de++)ne($.features[de],ie);else if(ye==="GeometryCollection")for(de=0;de<$.geometries.length;de++)ne($.geometries[de],ie);else if(ye==="Feature")ne($.geometry,ie);else if(ye==="Polygon")nt($.coordinates,ie);else if(ye==="MultiPolygon")for(de=0;de<$.coordinates.length;de++)nt($.coordinates[de],ie);return $});const ut=a.bw.VectorTileFeature.prototype.toGeoJSON;var xt={exports:{}},Tt=a.bA,Mt=a.bw.VectorTileFeature,Oe=jt;function jt(ne,$){this.options=$||{},this.features=ne,this.length=ne.length}function it(ne,$){this.id=typeof ne.id=="number"?ne.id:void 0,this.type=ne.type,this.rawGeometry=ne.type===1?[ne.geometry]:ne.geometry,this.properties=ne.tags,this.extent=$||4096}jt.prototype.feature=function(ne){return new it(this.features[ne],this.options.extent)},it.prototype.loadGeometry=function(){var ne=this.rawGeometry;this.geometry=[];for(var $=0;$<ne.length;$++){for(var ie=ne[$],de=[],ye=0;ye<ie.length;ye++)de.push(new Tt(ie[ye][0],ie[ye][1]));this.geometry.push(de)}return this.geometry},it.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ne=this.geometry,$=1/0,ie=-1/0,de=1/0,ye=-1/0,ge=0;ge<ne.length;ge++)for(var Pe=ne[ge],Fe=0;Fe<Pe.length;Fe++){var Ve=Pe[Fe];$=Math.min($,Ve.x),ie=Math.max(ie,Ve.x),de=Math.min(de,Ve.y),ye=Math.max(ye,Ve.y)}return[$,de,ie,ye]},it.prototype.toGeoJSON=Mt.prototype.toGeoJSON;var vt=a.bB,mt=Oe;function Et(ne){var $=new vt;return function(ie,de){for(var ye in ie.layers)de.writeMessage(3,Pt,ie.layers[ye])}(ne,$),$.finish()}function Pt(ne,$){var ie;$.writeVarintField(15,ne.version||1),$.writeStringField(1,ne.name||""),$.writeVarintField(5,ne.extent||4096);var de={keys:[],values:[],keycache:{},valuecache:{}};for(ie=0;ie<ne.length;ie++)de.feature=ne.feature(ie),$.writeMessage(2,dt,de);var ye=de.keys;for(ie=0;ie<ye.length;ie++)$.writeStringField(3,ye[ie]);var ge=de.values;for(ie=0;ie<ge.length;ie++)$.writeMessage(4,zt,ge[ie])}function dt(ne,$){var ie=ne.feature;ie.id!==void 0&&$.writeVarintField(1,ie.id),$.writeMessage(2,Je,ne),$.writeVarintField(3,ie.type),$.writeMessage(4,Nt,ie)}function Je(ne,$){var ie=ne.feature,de=ne.keys,ye=ne.values,ge=ne.keycache,Pe=ne.valuecache;for(var Fe in ie.properties){var Ve=ie.properties[Fe],Xe=ge[Fe];if(Ve!==null){Xe===void 0&&(de.push(Fe),ge[Fe]=Xe=de.length-1),$.writeVarint(Xe);var Ye=typeof Ve;Ye!=="string"&&Ye!=="boolean"&&Ye!=="number"&&(Ve=JSON.stringify(Ve));var De=Ye+":"+Ve,Ge=Pe[De];Ge===void 0&&(ye.push(Ve),Pe[De]=Ge=ye.length-1),$.writeVarint(Ge)}}}function pt(ne,$){return($<<3)+(7&ne)}function lt(ne){return ne<<1^ne>>31}function Nt(ne,$){for(var ie=ne.loadGeometry(),de=ne.type,ye=0,ge=0,Pe=ie.length,Fe=0;Fe<Pe;Fe++){var Ve=ie[Fe],Xe=1;de===1&&(Xe=Ve.length),$.writeVarint(pt(1,Xe));for(var Ye=de===3?Ve.length-1:Ve.length,De=0;De<Ye;De++){De===1&&de!==1&&$.writeVarint(pt(2,Ye-1));var Ge=Ve[De].x-ye,ht=Ve[De].y-ge;$.writeVarint(lt(Ge)),$.writeVarint(lt(ht)),ye+=Ge,ge+=ht}de===3&&$.writeVarint(pt(7,1))}}function zt(ne,$){var ie=typeof ne;ie==="string"?$.writeStringField(1,ne):ie==="boolean"?$.writeBooleanField(7,ne):ie==="number"&&(ne%1!=0?$.writeDoubleField(3,ne):ne<0?$.writeSVarintField(6,ne):$.writeVarintField(5,ne))}xt.exports=Et,xt.exports.fromVectorTileJs=Et,xt.exports.fromGeojsonVt=function(ne,$){$=$||{};var ie={};for(var de in ne)ie[de]=new mt(ne[de].features,$),ie[de].name=de,ie[de].version=$.version,ie[de].extent=$.extent;return Et({layers:ie})},xt.exports.GeoJSONWrapper=mt;var Ot=a.bz(xt.exports);const gi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ne=>ne},wi=Math.fround||(Ti=new Float32Array(1),ne=>(Ti[0]=+ne,Ti[0]));var Ti;const Ni=3,en=5,ji=6;class Vi{constructor($){this.options=Object.assign(Object.create(gi),$),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load($){const{log:ie,minZoom:de,maxZoom:ye}=this.options;ie&&console.time("total time");const ge=`prepare ${$.length} points`;ie&&console.time(ge),this.points=$;const Pe=[];for(let Ve=0;Ve<$.length;Ve++){const Xe=$[Ve];if(!Xe.geometry)continue;const[Ye,De]=Xe.geometry.coordinates,Ge=wi(Ci(Ye)),ht=wi(mi(De));Pe.push(Ge,ht,1/0,Ve,-1,1),this.options.reduce&&Pe.push(0)}let Fe=this.trees[ye+1]=this._createTree(Pe);ie&&console.timeEnd(ge);for(let Ve=ye;Ve>=de;Ve--){const Xe=+Date.now();Fe=this.trees[Ve]=this._createTree(this._cluster(Fe,Ve)),ie&&console.log("z%d: %d clusters in %dms",Ve,Fe.numItems,+Date.now()-Xe)}return ie&&console.timeEnd("total time"),this}getClusters($,ie){let de=(($[0]+180)%360+360)%360-180;const ye=Math.max(-90,Math.min(90,$[1]));let ge=$[2]===180?180:(($[2]+180)%360+360)%360-180;const Pe=Math.max(-90,Math.min(90,$[3]));if($[2]-$[0]>=360)de=-180,ge=180;else if(de>ge){const De=this.getClusters([de,ye,180,Pe],ie),Ge=this.getClusters([-180,ye,ge,Pe],ie);return De.concat(Ge)}const Fe=this.trees[this._limitZoom(ie)],Ve=Fe.range(Ci(de),mi(Pe),Ci(ge),mi(ye)),Xe=Fe.data,Ye=[];for(const De of Ve){const Ge=this.stride*De;Ye.push(Xe[Ge+en]>1?nn(Xe,Ge,this.clusterProps):this.points[Xe[Ge+Ni]])}return Ye}getChildren($){const ie=this._getOriginId($),de=this._getOriginZoom($),ye="No cluster with the specified id.",ge=this.trees[de];if(!ge)throw new Error(ye);const Pe=ge.data;if(ie*this.stride>=Pe.length)throw new Error(ye);const Fe=this.options.radius/(this.options.extent*Math.pow(2,de-1)),Ve=ge.within(Pe[ie*this.stride],Pe[ie*this.stride+1],Fe),Xe=[];for(const Ye of Ve){const De=Ye*this.stride;Pe[De+4]===$&&Xe.push(Pe[De+en]>1?nn(Pe,De,this.clusterProps):this.points[Pe[De+Ni]])}if(Xe.length===0)throw new Error(ye);return Xe}getLeaves($,ie,de){const ye=[];return this._appendLeaves(ye,$,ie=ie||10,de=de||0,0),ye}getTile($,ie,de){const ye=this.trees[this._limitZoom($)],ge=Math.pow(2,$),{extent:Pe,radius:Fe}=this.options,Ve=Fe/Pe,Xe=(de-Ve)/ge,Ye=(de+1+Ve)/ge,De={features:[]};return this._addTileFeatures(ye.range((ie-Ve)/ge,Xe,(ie+1+Ve)/ge,Ye),ye.data,ie,de,ge,De),ie===0&&this._addTileFeatures(ye.range(1-Ve/ge,Xe,1,Ye),ye.data,ge,de,ge,De),ie===ge-1&&this._addTileFeatures(ye.range(0,Xe,Ve/ge,Ye),ye.data,-1,de,ge,De),De.features.length?De:null}getClusterExpansionZoom($){let ie=this._getOriginZoom($)-1;for(;ie<=this.options.maxZoom;){const de=this.getChildren($);if(ie++,de.length!==1)break;$=de[0].properties.cluster_id}return ie}_appendLeaves($,ie,de,ye,ge){const Pe=this.getChildren(ie);for(const Fe of Pe){const Ve=Fe.properties;if(Ve&&Ve.cluster?ge+Ve.point_count<=ye?ge+=Ve.point_count:ge=this._appendLeaves($,Ve.cluster_id,de,ye,ge):ge<ye?ge++:$.push(Fe),$.length===de)break}return ge}_createTree($){const ie=new a.av($.length/this.stride|0,this.options.nodeSize,Float32Array);for(let de=0;de<$.length;de+=this.stride)ie.add($[de],$[de+1]);return ie.finish(),ie.data=$,ie}_addTileFeatures($,ie,de,ye,ge,Pe){for(const Fe of $){const Ve=Fe*this.stride,Xe=ie[Ve+en]>1;let Ye,De,Ge;if(Xe)Ye=vn(ie,Ve,this.clusterProps),De=ie[Ve],Ge=ie[Ve+1];else{const o=this.points[ie[Ve+Ni]];Ye=o.properties;const[ke,ai]=o.geometry.coordinates;De=Ci(ke),Ge=mi(ai)}const ht={type:1,geometry:[[Math.round(this.options.extent*(De*ge-de)),Math.round(this.options.extent*(Ge*ge-ye))]],tags:Ye};let kt;kt=Xe||this.options.generateId?ie[Ve+Ni]:this.points[ie[Ve+Ni]].id,kt!==void 0&&(ht.id=kt),Pe.features.push(ht)}}_limitZoom($){return Math.max(this.options.minZoom,Math.min(Math.floor(+$),this.options.maxZoom+1))}_cluster($,ie){const{radius:de,extent:ye,reduce:ge,minPoints:Pe}=this.options,Fe=de/(ye*Math.pow(2,ie)),Ve=$.data,Xe=[],Ye=this.stride;for(let De=0;De<Ve.length;De+=Ye){if(Ve[De+2]<=ie)continue;Ve[De+2]=ie;const Ge=Ve[De],ht=Ve[De+1],kt=$.within(Ve[De],Ve[De+1],Fe),o=Ve[De+en];let ke=o;for(const ai of kt){const fi=ai*Ye;Ve[fi+2]>ie&&(ke+=Ve[fi+en])}if(ke>o&&ke>=Pe){let ai,fi=Ge*o,hi=ht*o,Jt=-1;const oi=((De/Ye|0)<<5)+(ie+1)+this.points.length;for(const zi of kt){const xi=zi*Ye;if(Ve[xi+2]<=ie)continue;Ve[xi+2]=ie;const Si=Ve[xi+en];fi+=Ve[xi]*Si,hi+=Ve[xi+1]*Si,Ve[xi+4]=oi,ge&&(ai||(ai=this._map(Ve,De,!0),Jt=this.clusterProps.length,this.clusterProps.push(ai)),ge(ai,this._map(Ve,xi)))}Ve[De+4]=oi,Xe.push(fi/ke,hi/ke,1/0,oi,-1,ke),ge&&Xe.push(Jt)}else{for(let ai=0;ai<Ye;ai++)Xe.push(Ve[De+ai]);if(ke>1)for(const ai of kt){const fi=ai*Ye;if(!(Ve[fi+2]<=ie)){Ve[fi+2]=ie;for(let hi=0;hi<Ye;hi++)Xe.push(Ve[fi+hi])}}}}return Xe}_getOriginId($){return $-this.points.length>>5}_getOriginZoom($){return($-this.points.length)%32}_map($,ie,de){if($[ie+en]>1){const Pe=this.clusterProps[$[ie+ji]];return de?Object.assign({},Pe):Pe}const ye=this.points[$[ie+Ni]].properties,ge=this.options.map(ye);return de&&ge===ye?Object.assign({},ge):ge}}function nn(ne,$,ie){return{type:"Feature",id:ne[$+Ni],properties:vn(ne,$,ie),geometry:{type:"Point",coordinates:[(de=ne[$],360*(de-.5)),Ri(ne[$+1])]}};var de}function vn(ne,$,ie){const de=ne[$+en],ye=de>=1e4?`${Math.round(de/1e3)}k`:de>=1e3?Math.round(de/100)/10+"k":de,ge=ne[$+ji],Pe=ge===-1?{}:Object.assign({},ie[ge]);return Object.assign(Pe,{cluster:!0,cluster_id:ne[$+Ni],point_count:de,point_count_abbreviated:ye})}function Ci(ne){return ne/360+.5}function mi(ne){const $=Math.sin(ne*Math.PI/180),ie=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return ie<0?0:ie>1?1:ie}function Ri(ne){const $=(180-360*ne)*Math.PI/180;return 360*Math.atan(Math.exp($))/Math.PI-90}function Oi(ne,$,ie,de){for(var ye,ge=de,Pe=ie-$>>1,Fe=ie-$,Ve=ne[$],Xe=ne[$+1],Ye=ne[ie],De=ne[ie+1],Ge=$+3;Ge<ie;Ge+=3){var ht=_i(ne[Ge],ne[Ge+1],Ve,Xe,Ye,De);if(ht>ge)ye=Ge,ge=ht;else if(ht===ge){var kt=Math.abs(Ge-Pe);kt<Fe&&(ye=Ge,Fe=kt)}}ge>de&&(ye-$>3&&Oi(ne,$,ye,de),ne[ye+2]=ge,ie-ye>3&&Oi(ne,ye,ie,de))}function _i(ne,$,ie,de,ye,ge){var Pe=ye-ie,Fe=ge-de;if(Pe!==0||Fe!==0){var Ve=((ne-ie)*Pe+($-de)*Fe)/(Pe*Pe+Fe*Fe);Ve>1?(ie=ye,de=ge):Ve>0&&(ie+=Pe*Ve,de+=Fe*Ve)}return(Pe=ne-ie)*Pe+(Fe=$-de)*Fe}function Ji(ne,$,ie,de){var ye={id:ne===void 0?null:ne,type:$,geometry:ie,tags:de,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ge){var Pe=ge.geometry,Fe=ge.type;if(Fe==="Point"||Fe==="MultiPoint"||Fe==="LineString")Ai(ge,Pe);else if(Fe==="Polygon"||Fe==="MultiLineString")for(var Ve=0;Ve<Pe.length;Ve++)Ai(ge,Pe[Ve]);else if(Fe==="MultiPolygon")for(Ve=0;Ve<Pe.length;Ve++)for(var Xe=0;Xe<Pe[Ve].length;Xe++)Ai(ge,Pe[Ve][Xe])}(ye),ye}function Ai(ne,$){for(var ie=0;ie<$.length;ie+=3)ne.minX=Math.min(ne.minX,$[ie]),ne.minY=Math.min(ne.minY,$[ie+1]),ne.maxX=Math.max(ne.maxX,$[ie]),ne.maxY=Math.max(ne.maxY,$[ie+1])}function sn(ne,$,ie,de){if($.geometry){var ye=$.geometry.coordinates,ge=$.geometry.type,Pe=Math.pow(ie.tolerance/((1<<ie.maxZoom)*ie.extent),2),Fe=[],Ve=$.id;if(ie.promoteId?Ve=$.properties[ie.promoteId]:ie.generateId&&(Ve=de||0),ge==="Point")ei(ye,Fe);else if(ge==="MultiPoint")for(var Xe=0;Xe<ye.length;Xe++)ei(ye[Xe],Fe);else if(ge==="LineString")_n(ye,Fe,Pe,!1);else if(ge==="MultiLineString"){if(ie.lineMetrics){for(Xe=0;Xe<ye.length;Xe++)_n(ye[Xe],Fe=[],Pe,!1),ne.push(Ji(Ve,"LineString",Fe,$.properties));return}Pr(ye,Fe,Pe,!1)}else if(ge==="Polygon")Pr(ye,Fe,Pe,!0);else{if(ge!=="MultiPolygon"){if(ge==="GeometryCollection"){for(Xe=0;Xe<$.geometry.geometries.length;Xe++)sn(ne,{id:Ve,geometry:$.geometry.geometries[Xe],properties:$.properties},ie,de);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Xe=0;Xe<ye.length;Xe++){var Ye=[];Pr(ye[Xe],Ye,Pe,!0),Fe.push(Ye)}}ne.push(Ji(Ve,ge,Fe,$.properties))}}function ei(ne,$){$.push(ci(ne[0])),$.push(rn(ne[1])),$.push(0)}function _n(ne,$,ie,de){for(var ye,ge,Pe=0,Fe=0;Fe<ne.length;Fe++){var Ve=ci(ne[Fe][0]),Xe=rn(ne[Fe][1]);$.push(Ve),$.push(Xe),$.push(0),Fe>0&&(Pe+=de?(ye*Xe-Ve*ge)/2:Math.sqrt(Math.pow(Ve-ye,2)+Math.pow(Xe-ge,2))),ye=Ve,ge=Xe}var Ye=$.length-3;$[2]=1,Oi($,0,Ye,ie),$[Ye+2]=1,$.size=Math.abs(Pe),$.start=0,$.end=$.size}function Pr(ne,$,ie,de){for(var ye=0;ye<ne.length;ye++){var ge=[];_n(ne[ye],ge,ie,de),$.push(ge)}}function ci(ne){return ne/360+.5}function rn(ne){var $=Math.sin(ne*Math.PI/180),ie=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return ie<0?0:ie>1?1:ie}function tr(ne,$,ie,de,ye,ge,Pe,Fe){if(de/=$,ge>=(ie/=$)&&Pe<de)return ne;if(Pe<ie||ge>=de)return null;for(var Ve=[],Xe=0;Xe<ne.length;Xe++){var Ye=ne[Xe],De=Ye.geometry,Ge=Ye.type,ht=ye===0?Ye.minX:Ye.minY,kt=ye===0?Ye.maxX:Ye.maxY;if(ht>=ie&&kt<de)Ve.push(Ye);else if(!(kt<ie||ht>=de)){var o=[];if(Ge==="Point"||Ge==="MultiPoint")Pn(De,o,ie,de,ye);else if(Ge==="LineString")Qn(De,o,ie,de,ye,!1,Fe.lineMetrics);else if(Ge==="MultiLineString")v(De,o,ie,de,ye,!1);else if(Ge==="Polygon")v(De,o,ie,de,ye,!0);else if(Ge==="MultiPolygon")for(var ke=0;ke<De.length;ke++){var ai=[];v(De[ke],ai,ie,de,ye,!0),ai.length&&o.push(ai)}if(o.length){if(Fe.lineMetrics&&Ge==="LineString"){for(ke=0;ke<o.length;ke++)Ve.push(Ji(Ye.id,Ge,o[ke],Ye.tags));continue}Ge!=="LineString"&&Ge!=="MultiLineString"||(o.length===1?(Ge="LineString",o=o[0]):Ge="MultiLineString"),Ge!=="Point"&&Ge!=="MultiPoint"||(Ge=o.length===3?"Point":"MultiPoint"),Ve.push(Ji(Ye.id,Ge,o,Ye.tags))}}}return Ve.length?Ve:null}function Pn(ne,$,ie,de,ye){for(var ge=0;ge<ne.length;ge+=3){var Pe=ne[ge+ye];Pe>=ie&&Pe<=de&&($.push(ne[ge]),$.push(ne[ge+1]),$.push(ne[ge+2]))}}function Qn(ne,$,ie,de,ye,ge,Pe){for(var Fe,Ve,Xe=In(ne),Ye=ye===0?V:Y,De=ne.start,Ge=0;Ge<ne.length-3;Ge+=3){var ht=ne[Ge],kt=ne[Ge+1],o=ne[Ge+2],ke=ne[Ge+3],ai=ne[Ge+4],fi=ye===0?ht:kt,hi=ye===0?ke:ai,Jt=!1;Pe&&(Fe=Math.sqrt(Math.pow(ht-ke,2)+Math.pow(kt-ai,2))),fi<ie?hi>ie&&(Ve=Ye(Xe,ht,kt,ke,ai,ie),Pe&&(Xe.start=De+Fe*Ve)):fi>de?hi<de&&(Ve=Ye(Xe,ht,kt,ke,ai,de),Pe&&(Xe.start=De+Fe*Ve)):k(Xe,ht,kt,o),hi<ie&&fi>=ie&&(Ve=Ye(Xe,ht,kt,ke,ai,ie),Jt=!0),hi>de&&fi<=de&&(Ve=Ye(Xe,ht,kt,ke,ai,de),Jt=!0),!ge&&Jt&&(Pe&&(Xe.end=De+Fe*Ve),$.push(Xe),Xe=In(ne)),Pe&&(De+=Fe)}var oi=ne.length-3;ht=ne[oi],kt=ne[oi+1],o=ne[oi+2],(fi=ye===0?ht:kt)>=ie&&fi<=de&&k(Xe,ht,kt,o),oi=Xe.length-3,ge&&oi>=3&&(Xe[oi]!==Xe[0]||Xe[oi+1]!==Xe[1])&&k(Xe,Xe[0],Xe[1],Xe[2]),Xe.length&&$.push(Xe)}function In(ne){var $=[];return $.size=ne.size,$.start=ne.start,$.end=ne.end,$}function v(ne,$,ie,de,ye,ge){for(var Pe=0;Pe<ne.length;Pe++)Qn(ne[Pe],$,ie,de,ye,ge,!1)}function k(ne,$,ie,de){ne.push($),ne.push(ie),ne.push(de)}function V(ne,$,ie,de,ye,ge){var Pe=(ge-$)/(de-$);return ne.push(ge),ne.push(ie+(ye-ie)*Pe),ne.push(1),Pe}function Y(ne,$,ie,de,ye,ge){var Pe=(ge-ie)/(ye-ie);return ne.push($+(de-$)*Pe),ne.push(ge),ne.push(1),Pe}function te(ne,$){for(var ie=[],de=0;de<ne.length;de++){var ye,ge=ne[de],Pe=ge.type;if(Pe==="Point"||Pe==="MultiPoint"||Pe==="LineString")ye=fe(ge.geometry,$);else if(Pe==="MultiLineString"||Pe==="Polygon"){ye=[];for(var Fe=0;Fe<ge.geometry.length;Fe++)ye.push(fe(ge.geometry[Fe],$))}else if(Pe==="MultiPolygon")for(ye=[],Fe=0;Fe<ge.geometry.length;Fe++){for(var Ve=[],Xe=0;Xe<ge.geometry[Fe].length;Xe++)Ve.push(fe(ge.geometry[Fe][Xe],$));ye.push(Ve)}ie.push(Ji(ge.id,Pe,ye,ge.tags))}return ie}function fe(ne,$){var ie=[];ie.size=ne.size,ne.start!==void 0&&(ie.start=ne.start,ie.end=ne.end);for(var de=0;de<ne.length;de+=3)ie.push(ne[de]+$,ne[de+1],ne[de+2]);return ie}function ve(ne,$){if(ne.transformed)return ne;var ie,de,ye,ge=1<<ne.z,Pe=ne.x,Fe=ne.y;for(ie=0;ie<ne.features.length;ie++){var Ve=ne.features[ie],Xe=Ve.geometry,Ye=Ve.type;if(Ve.geometry=[],Ye===1)for(de=0;de<Xe.length;de+=2)Ve.geometry.push(Ie(Xe[de],Xe[de+1],$,ge,Pe,Fe));else for(de=0;de<Xe.length;de++){var De=[];for(ye=0;ye<Xe[de].length;ye+=2)De.push(Ie(Xe[de][ye],Xe[de][ye+1],$,ge,Pe,Fe));Ve.geometry.push(De)}}return ne.transformed=!0,ne}function Ie(ne,$,ie,de,ye,ge){return[Math.round(ie*(ne*de-ye)),Math.round(ie*($*de-ge))]}function Ee(ne,$,ie,de,ye){for(var ge=$===ye.maxZoom?0:ye.tolerance/((1<<$)*ye.extent),Pe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ie,y:de,z:$,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Fe=0;Fe<ne.length;Fe++){Pe.numFeatures++,ze(Pe,ne[Fe],ge,ye);var Ve=ne[Fe].minX,Xe=ne[Fe].minY,Ye=ne[Fe].maxX,De=ne[Fe].maxY;Ve<Pe.minX&&(Pe.minX=Ve),Xe<Pe.minY&&(Pe.minY=Xe),Ye>Pe.maxX&&(Pe.maxX=Ye),De>Pe.maxY&&(Pe.maxY=De)}return Pe}function ze(ne,$,ie,de){var ye=$.geometry,ge=$.type,Pe=[];if(ge==="Point"||ge==="MultiPoint")for(var Fe=0;Fe<ye.length;Fe+=3)Pe.push(ye[Fe]),Pe.push(ye[Fe+1]),ne.numPoints++,ne.numSimplified++;else if(ge==="LineString")We(Pe,ye,ne,ie,!1,!1);else if(ge==="MultiLineString"||ge==="Polygon")for(Fe=0;Fe<ye.length;Fe++)We(Pe,ye[Fe],ne,ie,ge==="Polygon",Fe===0);else if(ge==="MultiPolygon")for(var Ve=0;Ve<ye.length;Ve++){var Xe=ye[Ve];for(Fe=0;Fe<Xe.length;Fe++)We(Pe,Xe[Fe],ne,ie,!0,Fe===0)}if(Pe.length){var Ye=$.tags||null;if(ge==="LineString"&&de.lineMetrics){for(var De in Ye={},$.tags)Ye[De]=$.tags[De];Ye.mapbox_clip_start=ye.start/ye.size,Ye.mapbox_clip_end=ye.end/ye.size}var Ge={geometry:Pe,type:ge==="Polygon"||ge==="MultiPolygon"?3:ge==="LineString"||ge==="MultiLineString"?2:1,tags:Ye};$.id!==null&&(Ge.id=$.id),ne.features.push(Ge)}}function We(ne,$,ie,de,ye,ge){var Pe=de*de;if(de>0&&$.size<(ye?Pe:de))ie.numPoints+=$.length/3;else{for(var Fe=[],Ve=0;Ve<$.length;Ve+=3)(de===0||$[Ve+2]>Pe)&&(ie.numSimplified++,Fe.push($[Ve]),Fe.push($[Ve+1])),ie.numPoints++;ye&&function(Xe,Ye){for(var De=0,Ge=0,ht=Xe.length,kt=ht-2;Ge<ht;kt=Ge,Ge+=2)De+=(Xe[Ge]-Xe[kt])*(Xe[Ge+1]+Xe[kt+1]);if(De>0===Ye)for(Ge=0,ht=Xe.length;Ge<ht/2;Ge+=2){var o=Xe[Ge],ke=Xe[Ge+1];Xe[Ge]=Xe[ht-2-Ge],Xe[Ge+1]=Xe[ht-1-Ge],Xe[ht-2-Ge]=o,Xe[ht-1-Ge]=ke}}(Fe,ge),ne.push(Fe)}}function He(ne,$){var ie=($=this.options=function(ye,ge){for(var Pe in ge)ye[Pe]=ge[Pe];return ye}(Object.create(this.options),$)).debug;if(ie&&console.time("preprocess data"),$.maxZoom<0||$.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if($.promoteId&&$.generateId)throw new Error("promoteId and generateId cannot be used together.");var de=function(ye,ge){var Pe=[];if(ye.type==="FeatureCollection")for(var Fe=0;Fe<ye.features.length;Fe++)sn(Pe,ye.features[Fe],ge,Fe);else sn(Pe,ye.type==="Feature"?ye:{geometry:ye},ge);return Pe}(ne,$);this.tiles={},this.tileCoords=[],ie&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",$.indexMaxZoom,$.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),de=function(ye,ge){var Pe=ge.buffer/ge.extent,Fe=ye,Ve=tr(ye,1,-1-Pe,Pe,0,-1,2,ge),Xe=tr(ye,1,1-Pe,2+Pe,0,-1,2,ge);return(Ve||Xe)&&(Fe=tr(ye,1,-Pe,1+Pe,0,-1,2,ge)||[],Ve&&(Fe=te(Ve,1).concat(Fe)),Xe&&(Fe=Fe.concat(te(Xe,-1)))),Fe}(de,$),de.length&&this.splitTile(de,0,0,0),ie&&(de.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Qe(ne,$,ie){return 32*((1<<ne)*ie+$)+ne}function Ue(ne,$){return $?ne.properties[$]:ne.id}function ft(ne,$){if(ne==null)return!0;if(ne.type==="Feature")return Ue(ne,$)!=null;if(ne.type==="FeatureCollection"){const ie=new Set;for(const de of ne.features){const ye=Ue(de,$);if(ye==null||ie.has(ye))return!1;ie.add(ye)}return!0}return!1}function st(ne,$){const ie=new Map;if(ne!=null)if(ne.type==="Feature")ie.set(Ue(ne,$),ne);else for(const de of ne.features)ie.set(Ue(de,$),de);return ie}He.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},He.prototype.splitTile=function(ne,$,ie,de,ye,ge,Pe){for(var Fe=[ne,$,ie,de],Ve=this.options,Xe=Ve.debug;Fe.length;){de=Fe.pop(),ie=Fe.pop(),$=Fe.pop(),ne=Fe.pop();var Ye=1<<$,De=Qe($,ie,de),Ge=this.tiles[De];if(!Ge&&(Xe>1&&console.time("creation"),Ge=this.tiles[De]=Ee(ne,$,ie,de,Ve),this.tileCoords.push({z:$,x:ie,y:de}),Xe)){Xe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",$,ie,de,Ge.numFeatures,Ge.numPoints,Ge.numSimplified),console.timeEnd("creation"));var ht="z"+$;this.stats[ht]=(this.stats[ht]||0)+1,this.total++}if(Ge.source=ne,ye){if($===Ve.maxZoom||$===ye)continue;var kt=1<<ye-$;if(ie!==Math.floor(ge/kt)||de!==Math.floor(Pe/kt))continue}else if($===Ve.indexMaxZoom||Ge.numPoints<=Ve.indexMaxPoints)continue;if(Ge.source=null,ne.length!==0){Xe>1&&console.time("clipping");var o,ke,ai,fi,hi,Jt,oi=.5*Ve.buffer/Ve.extent,zi=.5-oi,xi=.5+oi,Si=1+oi;o=ke=ai=fi=null,hi=tr(ne,Ye,ie-oi,ie+xi,0,Ge.minX,Ge.maxX,Ve),Jt=tr(ne,Ye,ie+zi,ie+Si,0,Ge.minX,Ge.maxX,Ve),ne=null,hi&&(o=tr(hi,Ye,de-oi,de+xi,1,Ge.minY,Ge.maxY,Ve),ke=tr(hi,Ye,de+zi,de+Si,1,Ge.minY,Ge.maxY,Ve),hi=null),Jt&&(ai=tr(Jt,Ye,de-oi,de+xi,1,Ge.minY,Ge.maxY,Ve),fi=tr(Jt,Ye,de+zi,de+Si,1,Ge.minY,Ge.maxY,Ve),Jt=null),Xe>1&&console.timeEnd("clipping"),Fe.push(o||[],$+1,2*ie,2*de),Fe.push(ke||[],$+1,2*ie,2*de+1),Fe.push(ai||[],$+1,2*ie+1,2*de),Fe.push(fi||[],$+1,2*ie+1,2*de+1)}}},He.prototype.getTile=function(ne,$,ie){var de=this.options,ye=de.extent,ge=de.debug;if(ne<0||ne>24)return null;var Pe=1<<ne,Fe=Qe(ne,$=($%Pe+Pe)%Pe,ie);if(this.tiles[Fe])return ve(this.tiles[Fe],ye);ge>1&&console.log("drilling down to z%d-%d-%d",ne,$,ie);for(var Ve,Xe=ne,Ye=$,De=ie;!Ve&&Xe>0;)Xe--,Ye=Math.floor(Ye/2),De=Math.floor(De/2),Ve=this.tiles[Qe(Xe,Ye,De)];return Ve&&Ve.source?(ge>1&&console.log("found parent tile z%d-%d-%d",Xe,Ye,De),ge>1&&console.time("drilling down"),this.splitTile(Ve.source,Xe,Ye,De,ne,$,ie),ge>1&&console.timeEnd("drilling down"),this.tiles[Fe]?ve(this.tiles[Fe],ye):null):null};class Me extends be{constructor($,ie,de,ye){super($,ie,de),this._dataUpdateable=new Map,this.loadGeoJSON=(ge,Pe)=>{const{promoteId:Fe}=ge;if(ge.request)return a.f(ge.request,(Ve,Xe,Ye,De)=>{this._dataUpdateable=ft(Xe,Fe)?st(Xe,Fe):void 0,Pe(Ve,Xe,Ye,De)});if(typeof ge.data=="string")try{const Ve=JSON.parse(ge.data);this._dataUpdateable=ft(Ve,Fe)?st(Ve,Fe):void 0,Pe(null,Ve)}catch{Pe(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`))}else ge.dataDiff?this._dataUpdateable?(function(Ve,Xe,Ye){var De,Ge,ht,kt;if(Xe.removeAll&&Ve.clear(),Xe.remove)for(const o of Xe.remove)Ve.delete(o);if(Xe.add)for(const o of Xe.add){const ke=Ue(o,Ye);ke!=null&&Ve.set(ke,o)}if(Xe.update)for(const o of Xe.update){let ke=Ve.get(o.id);if(ke==null)continue;const ai=!o.removeAllProperties&&(((De=o.removeProperties)===null||De===void 0?void 0:De.length)>0||((Ge=o.addOrUpdateProperties)===null||Ge===void 0?void 0:Ge.length)>0);if((o.newGeometry||o.removeAllProperties||ai)&&(ke=Object.assign({},ke),Ve.set(o.id,ke),ai&&(ke.properties=Object.assign({},ke.properties))),o.newGeometry&&(ke.geometry=o.newGeometry),o.removeAllProperties)ke.properties={};else if(((ht=o.removeProperties)===null||ht===void 0?void 0:ht.length)>0)for(const fi of o.removeProperties)Object.prototype.hasOwnProperty.call(ke.properties,fi)&&delete ke.properties[fi];if(((kt=o.addOrUpdateProperties)===null||kt===void 0?void 0:kt.length)>0)for(const{key:fi,value:hi}of o.addOrUpdateProperties)ke.properties[fi]=hi}}(this._dataUpdateable,ge.dataDiff,Fe),Pe(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):Pe(new Error(`Cannot update existing geojson data in ${ge.source}`)):Pe(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,ye&&(this.loadGeoJSON=ye)}loadGeoJSONTile($,ie){const de=$.tileID.canonical;if(!this._geoJSONIndex)return ie(null,null);const ye=this._geoJSONIndex.getTile(de.z,de.x,de.y);if(!ye)return ie(null,null);const ge=new class{constructor(Fe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.N,this.length=Fe.length,this._features=Fe}feature(Fe){return new class{constructor(Ve){this._feature=Ve,this.extent=a.N,this.type=Ve.type,this.properties=Ve.tags,"id"in Ve&&!isNaN(Ve.id)&&(this.id=parseInt(Ve.id,10))}loadGeometry(){if(this._feature.type===1){const Ve=[];for(const Xe of this._feature.geometry)Ve.push([new a.P(Xe[0],Xe[1])]);return Ve}{const Ve=[];for(const Xe of this._feature.geometry){const Ye=[];for(const De of Xe)Ye.push(new a.P(De[0],De[1]));Ve.push(Ye)}return Ve}}toGeoJSON(Ve,Xe,Ye){return ut.call(this,Ve,Xe,Ye)}}(this._features[Fe])}}(ye.features);let Pe=Ot(ge);Pe.byteOffset===0&&Pe.byteLength===Pe.buffer.byteLength||(Pe=new Uint8Array(Pe)),ie(null,{vectorTile:ge,rawData:Pe.buffer})}loadData($,ie){var de;(de=this._pendingRequest)===null||de===void 0||de.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const ye=!!($&&$.request&&$.request.collectResourceTiming)&&new a.bu($.request);this._pendingCallback=ie,this._pendingRequest=this.loadGeoJSON($,(ge,Pe)=>{if(delete this._pendingCallback,delete this._pendingRequest,ge||!Pe)return ie(ge);if(typeof Pe!="object")return ie(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`));{at(Pe,!0);try{if($.filter){const Ve=a.bC($.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ve.result==="error")throw new Error(Ve.value.map(Ye=>`${Ye.key}: ${Ye.message}`).join(", "));Pe={type:"FeatureCollection",features:Pe.features.filter(Ye=>Ve.value.evaluate({zoom:0},Ye))}}this._geoJSONIndex=$.cluster?new Vi(function({superclusterOptions:Ve,clusterProperties:Xe}){if(!Xe||!Ve)return Ve;const Ye={},De={},Ge={accumulated:null,zoom:0},ht={properties:null},kt=Object.keys(Xe);for(const o of kt){const[ke,ai]=Xe[o],fi=a.bC(ai),hi=a.bC(typeof ke=="string"?[ke,["accumulated"],["get",o]]:ke);Ye[o]=fi.value,De[o]=hi.value}return Ve.map=o=>{ht.properties=o;const ke={};for(const ai of kt)ke[ai]=Ye[ai].evaluate(Ge,ht);return ke},Ve.reduce=(o,ke)=>{ht.properties=ke;for(const ai of kt)Ge.accumulated=o[ai],o[ai]=De[ai].evaluate(Ge,ht)},Ve}($)).load(Pe.features):function(Ve,Xe){return new He(Ve,Xe)}(Pe,$.geojsonVtOptions)}catch(Ve){return ie(Ve)}this.loaded={};const Fe={};if(ye){const Ve=ye.finish();Ve&&(Fe.resourceTiming={},Fe.resourceTiming[$.source]=JSON.parse(JSON.stringify(Ve)))}ie(null,Fe)}})}reloadTile($,ie){const de=this.loaded;return de&&de[$.uid]?super.reloadTile($,ie):this.loadTile($,ie)}removeSource($,ie){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ie()}getClusterExpansionZoom($,ie){try{ie(null,this._geoJSONIndex.getClusterExpansionZoom($.clusterId))}catch(de){ie(de)}}getClusterChildren($,ie){try{ie(null,this._geoJSONIndex.getChildren($.clusterId))}catch(de){ie(de)}}getClusterLeaves($,ie){try{ie(null,this._geoJSONIndex.getLeaves($.clusterId,$.limit,$.offset))}catch(de){ie(de)}}}class se{constructor($){this.self=$,this.actor=new a.C($,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:be,geojson:Me},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ie,de)=>{if(this.workerSourceTypes[ie])throw new Error(`Worker source with name "${ie}" already registered.`);this.workerSourceTypes[ie]=de},this.self.registerRTLTextPlugin=ie=>{if(a.bD.isParsed())throw new Error("RTL text plugin already registered.");a.bD.applyArabicShaping=ie.applyArabicShaping,a.bD.processBidirectionalText=ie.processBidirectionalText,a.bD.processStyledBidirectionalText=ie.processStyledBidirectionalText}}setReferrer($,ie){this.referrer=ie}setImages($,ie,de){this.availableImages[$]=ie;for(const ye in this.workerSources[$]){const ge=this.workerSources[$][ye];for(const Pe in ge)ge[Pe].availableImages=ie}de()}setLayers($,ie,de){this.getLayerIndex($).replace(ie),de()}updateLayers($,ie,de){this.getLayerIndex($).update(ie.layers,ie.removedIds),de()}loadTile($,ie,de){this.getWorkerSource($,ie.type,ie.source).loadTile(ie,de)}loadDEMTile($,ie,de){this.getDEMWorkerSource($,ie.source).loadTile(ie,de)}reloadTile($,ie,de){this.getWorkerSource($,ie.type,ie.source).reloadTile(ie,de)}abortTile($,ie,de){this.getWorkerSource($,ie.type,ie.source).abortTile(ie,de)}removeTile($,ie,de){this.getWorkerSource($,ie.type,ie.source).removeTile(ie,de)}removeDEMTile($,ie){this.getDEMWorkerSource($,ie.source).removeTile(ie)}removeSource($,ie,de){if(!this.workerSources[$]||!this.workerSources[$][ie.type]||!this.workerSources[$][ie.type][ie.source])return;const ye=this.workerSources[$][ie.type][ie.source];delete this.workerSources[$][ie.type][ie.source],ye.removeSource!==void 0?ye.removeSource(ie,de):de()}loadWorkerSource($,ie,de){try{this.self.importScripts(ie.url),de()}catch(ye){de(ye.toString())}}syncRTLPluginState($,ie,de){try{a.bD.setState(ie);const ye=a.bD.getPluginURL();if(a.bD.isLoaded()&&!a.bD.isParsed()&&ye!=null){this.self.importScripts(ye);const ge=a.bD.isParsed();de(ge?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ye}`),ge)}}catch(ye){de(ye.toString())}}getAvailableImages($){let ie=this.availableImages[$];return ie||(ie=[]),ie}getLayerIndex($){let ie=this.layerIndexes[$];return ie||(ie=this.layerIndexes[$]=new G),ie}getWorkerSource($,ie,de){return this.workerSources[$]||(this.workerSources[$]={}),this.workerSources[$][ie]||(this.workerSources[$][ie]={}),this.workerSources[$][ie][de]||(this.workerSources[$][ie][de]=new this.workerSourceTypes[ie]({send:(ye,ge,Pe)=>{this.actor.send(ye,ge,Pe,$)}},this.getLayerIndex($),this.getAvailableImages($))),this.workerSources[$][ie][de]}getDEMWorkerSource($,ie){return this.demWorkerSources[$]||(this.demWorkerSources[$]={}),this.demWorkerSources[$][ie]||(this.demWorkerSources[$][ie]=new je),this.demWorkerSources[$][ie]}}return a.i()&&(self.worker=new se(self)),se}),x(["./shared"],function(a){var G="3.6.2";class W{static testProp(A){if(!W.docStyle)return A[0];for(let E=0;E<A.length;E++)if(A[E]in W.docStyle)return A[E];return A[0]}static create(A,E,F){const O=window.document.createElement(A);return E!==void 0&&(O.className=E),F&&F.appendChild(O),O}static createNS(A,E){return window.document.createElementNS(A,E)}static disableDrag(){W.docStyle&&W.selectProp&&(W.userSelect=W.docStyle[W.selectProp],W.docStyle[W.selectProp]="none")}static enableDrag(){W.docStyle&&W.selectProp&&(W.docStyle[W.selectProp]=W.userSelect)}static setTransform(A,E){A.style[W.transformProp]=E}static addEventListener(A,E,F,O={}){A.addEventListener(E,F,"passive"in O?O:O.capture)}static removeEventListener(A,E,F,O={}){A.removeEventListener(E,F,"passive"in O?O:O.capture)}static suppressClickInternal(A){A.preventDefault(),A.stopPropagation(),window.removeEventListener("click",W.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",W.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",W.suppressClickInternal,!0)},0)}static mousePos(A,E){const F=A.getBoundingClientRect();return new a.P(E.clientX-F.left-A.clientLeft,E.clientY-F.top-A.clientTop)}static touchPos(A,E){const F=A.getBoundingClientRect(),O=[];for(let y=0;y<E.length;y++)O.push(new a.P(E[y].clientX-F.left-A.clientLeft,E[y].clientY-F.top-A.clientTop));return O}static mouseButton(A){return A.button}static remove(A){A.parentNode&&A.parentNode.removeChild(A)}}W.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,W.selectProp=W.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),W.transformProp=W.testProp(["transform","WebkitTransform"]);const he={supported:!1,testSupport:function(Z){!be&&ue&&(je?nt(Z):ae=Z)}};let ae,ue,be=!1,je=!1;function nt(Z){const A=Z.createTexture();Z.bindTexture(Z.TEXTURE_2D,A);try{if(Z.texImage2D(Z.TEXTURE_2D,0,Z.RGBA,Z.RGBA,Z.UNSIGNED_BYTE,ue),Z.isContextLost())return;he.supported=!0}catch{}Z.deleteTexture(A),be=!0}var tt,at;typeof document<"u"&&(ue=document.createElement("img"),ue.onload=function(){ae&&nt(ae),ae=null,je=!0},ue.onerror=function(){be=!0,ae=null},ue.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(Z){let A,E,F,O;Z.resetRequestQueue=()=>{A=[],E=0,F=0,O={}},Z.addThrottleControl=l=>{const d=F++;return O[d]=l,d},Z.removeThrottleControl=l=>{delete O[l],i()},Z.getImage=(l,d,_=!0)=>{he.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*");const w={requestParameters:l,supportImageRefresh:_,callback:d,cancelled:!1,completed:!1,cancel:()=>{w.completed||w.cancelled||(w.cancelled=!0,w.innerRequest&&(w.innerRequest.cancel(),E--),i())}};return A.push(w),i(),w};const y=l=>{const{requestParameters:d,supportImageRefresh:_,callback:w}=l;return a.e(d,{type:"image"}),(_!==!1||a.i()||a.g(d.url)||d.headers&&!Object.keys(d.headers).reduce((T,B)=>T&&B==="accept",!0)?a.m:r)(d,(T,B,j,X)=>{s(l,w,T,B,j,X)})},s=(l,d,_,w,T,B)=>{_?d(_):w instanceof HTMLImageElement||a.a(w)?d(null,w):w&&((j,X)=>{typeof createImageBitmap=="function"?a.b(j,X):a.d(j,X)})(w,(j,X)=>{j!=null?d(j):X!=null&&d(null,X,{cacheControl:T,expires:B})}),l.cancelled||(l.completed=!0,E--,i())},i=()=>{const l=(()=>{const d=Object.keys(O);let _=!1;if(d.length>0){for(const w of d)if(_=O[w](),_)break}return _})()?a.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let d=E;d<l&&A.length>0;d++){const _=A.shift();if(_.cancelled){d--;continue}const w=y(_);E++,_.innerRequest=w}},r=(l,d)=>{const _=new Image,w=l.url;let T=!1;const B=l.credentials;return B&&B==="include"?_.crossOrigin="use-credentials":(B&&B==="same-origin"||!a.s(w))&&(_.crossOrigin="anonymous"),_.fetchPriority="high",_.onload=()=>{d(null,_),_.onerror=_.onload=null},_.onerror=()=>{T||d(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),_.onerror=_.onload=null},_.src=w,{cancel:()=>{T=!0,_.src=""}}}}(tt||(tt={})),tt.resetRequestQueue(),function(Z){Z.Glyphs="Glyphs",Z.Image="Image",Z.Source="Source",Z.SpriteImage="SpriteImage",Z.SpriteJSON="SpriteJSON",Z.Style="Style",Z.Tile="Tile",Z.Unknown="Unknown"}(at||(at={}));class ut{constructor(A){this._transformRequestFn=A}transformRequest(A,E){return this._transformRequestFn&&this._transformRequestFn(A,E)||{url:A}}normalizeSpriteURL(A,E,F){const O=function(y){const s=y.match(xt);if(!s)throw new Error(`Unable to parse URL "${y}"`);return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}(A);return O.path+=`${E}${F}`,function(y){const s=y.params.length?`?${y.params.join("&")}`:"";return`${y.protocol}://${y.authority}${y.path}${s}`}(O)}setTransformRequest(A){this._transformRequestFn=A}}const xt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Tt(Z){var A=new a.A(3);return A[0]=Z[0],A[1]=Z[1],A[2]=Z[2],A}var Mt,Oe=function(Z,A,E){return Z[0]=A[0]-E[0],Z[1]=A[1]-E[1],Z[2]=A[2]-E[2],Z};Mt=new a.A(3),a.A!=Float32Array&&(Mt[0]=0,Mt[1]=0,Mt[2]=0);var jt=function(Z){var A=Z[0],E=Z[1];return A*A+E*E};function it(Z){const A=[];if(typeof Z=="string")A.push({id:"default",url:Z});else if(Z&&Z.length>0){const E=[];for(const{id:F,url:O}of Z){const y=`${F}${O}`;E.indexOf(y)===-1&&(E.push(y),A.push({id:F,url:O}))}}return A}function vt(Z,A,E,F,O){if(F)return void Z(F);if(O!==Object.values(A).length||O!==Object.values(E).length)return;const y={};for(const s in A){y[s]={};const i=a.h.getImageCanvasContext(E[s]),r=A[s];for(const l in r){const{width:d,height:_,x:w,y:T,sdf:B,pixelRatio:j,stretchX:X,stretchY:ce,content:Se}=r[l];y[s][l]={data:null,pixelRatio:j,sdf:B,stretchX:X,stretchY:ce,content:Se,spriteData:{width:d,height:_,x:w,y:T,context:i}}}}Z(null,y)}(function(){var Z=new a.A(2);a.A!=Float32Array&&(Z[0]=0,Z[1]=0)})();class mt{constructor(A,E,F,O){this.context=A,this.format=F,this.texture=A.gl.createTexture(),this.update(E,O)}update(A,E,F){const{width:O,height:y}=A,s=!(this.size&&this.size[0]===O&&this.size[1]===y||F),{context:i}=this,{gl:r}=i;if(this.useMipmap=!!(E&&E.useMipmap),r.bindTexture(r.TEXTURE_2D,this.texture),i.pixelStoreUnpackFlipY.set(!1),i.pixelStoreUnpack.set(1),i.pixelStoreUnpackPremultiplyAlpha.set(this.format===r.RGBA&&(!E||E.premultiply!==!1)),s)this.size=[O,y],A instanceof HTMLImageElement||A instanceof HTMLCanvasElement||A instanceof HTMLVideoElement||A instanceof ImageData||a.a(A)?r.texImage2D(r.TEXTURE_2D,0,this.format,this.format,r.UNSIGNED_BYTE,A):r.texImage2D(r.TEXTURE_2D,0,this.format,O,y,0,this.format,r.UNSIGNED_BYTE,A.data);else{const{x:l,y:d}=F||{x:0,y:0};A instanceof HTMLImageElement||A instanceof HTMLCanvasElement||A instanceof HTMLVideoElement||A instanceof ImageData||a.a(A)?r.texSubImage2D(r.TEXTURE_2D,0,l,d,r.RGBA,r.UNSIGNED_BYTE,A):r.texSubImage2D(r.TEXTURE_2D,0,l,d,O,y,r.RGBA,r.UNSIGNED_BYTE,A.data)}this.useMipmap&&this.isSizePowerOfTwo()&&r.generateMipmap(r.TEXTURE_2D)}bind(A,E,F){const{context:O}=this,{gl:y}=O;y.bindTexture(y.TEXTURE_2D,this.texture),F!==y.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(F=y.LINEAR),A!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,A),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,F||A),this.filter=A),E!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,E),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,E),this.wrap=E)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:A}=this.context;A.deleteTexture(this.texture),this.texture=null}}function Et(Z){const{userImage:A}=Z;return!!(A&&A.render&&A.render())&&(Z.data.replace(new Uint8Array(A.data.buffer)),!0)}class Pt extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(A){if(this.loaded!==A&&(this.loaded=A,A)){for(const{ids:E,callback:F}of this.requestors)this._notify(E,F);this.requestors=[]}}getImage(A){const E=this.images[A];if(E&&!E.data&&E.spriteData){const F=E.spriteData;E.data=new a.R({width:F.width,height:F.height},F.context.getImageData(F.x,F.y,F.width,F.height).data),E.spriteData=null}return E}addImage(A,E){if(this.images[A])throw new Error(`Image id ${A} already exist, use updateImage instead`);this._validate(A,E)&&(this.images[A]=E)}_validate(A,E){let F=!0;const O=E.data||E.spriteData;return this._validateStretch(E.stretchX,O&&O.width)||(this.fire(new a.j(new Error(`Image "${A}" has invalid "stretchX" value`))),F=!1),this._validateStretch(E.stretchY,O&&O.height)||(this.fire(new a.j(new Error(`Image "${A}" has invalid "stretchY" value`))),F=!1),this._validateContent(E.content,E)||(this.fire(new a.j(new Error(`Image "${A}" has invalid "content" value`))),F=!1),F}_validateStretch(A,E){if(!A)return!0;let F=0;for(const O of A){if(O[0]<F||O[1]<O[0]||E<O[1])return!1;F=O[1]}return!0}_validateContent(A,E){if(!A)return!0;if(A.length!==4)return!1;const F=E.spriteData,O=F&&F.width||E.data.width,y=F&&F.height||E.data.height;return!(A[0]<0||O<A[0]||A[1]<0||y<A[1]||A[2]<0||O<A[2]||A[3]<0||y<A[3]||A[2]<A[0]||A[3]<A[1])}updateImage(A,E,F=!0){const O=this.getImage(A);if(F&&(O.data.width!==E.data.width||O.data.height!==E.data.height))throw new Error(`size mismatch between old image (${O.data.width}x${O.data.height}) and new image (${E.data.width}x${E.data.height}).`);E.version=O.version+1,this.images[A]=E,this.updatedImages[A]=!0}removeImage(A){const E=this.images[A];delete this.images[A],delete this.patterns[A],E.userImage&&E.userImage.onRemove&&E.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(A,E){let F=!0;if(!this.isLoaded())for(const O of A)this.images[O]||(F=!1);this.isLoaded()||F?this._notify(A,E):this.requestors.push({ids:A,callback:E})}_notify(A,E){const F={};for(const O of A){let y=this.getImage(O);y||(this.fire(new a.k("styleimagemissing",{id:O})),y=this.getImage(O)),y?F[O]={data:y.data.clone(),pixelRatio:y.pixelRatio,sdf:y.sdf,version:y.version,stretchX:y.stretchX,stretchY:y.stretchY,content:y.content,hasRenderCallback:!!(y.userImage&&y.userImage.render)}:a.w(`Image "${O}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}E(null,F)}getPixelSize(){const{width:A,height:E}=this.atlasImage;return{width:A,height:E}}getPattern(A){const E=this.patterns[A],F=this.getImage(A);if(!F)return null;if(E&&E.position.version===F.version)return E.position;if(E)E.position.version=F.version;else{const O={w:F.data.width+2,h:F.data.height+2,x:0,y:0},y=new a.I(O,F);this.patterns[A]={bin:O,position:y}}return this._updatePatternAtlas(),this.patterns[A].position}bind(A){const E=A.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new mt(A,this.atlasImage,E.RGBA),this.atlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE)}_updatePatternAtlas(){const A=[];for(const y in this.patterns)A.push(this.patterns[y].bin);const{w:E,h:F}=a.p(A),O=this.atlasImage;O.resize({width:E||1,height:F||1});for(const y in this.patterns){const{bin:s}=this.patterns[y],i=s.x+1,r=s.y+1,l=this.getImage(y).data,d=l.width,_=l.height;a.R.copy(l,O,{x:0,y:0},{x:i,y:r},{width:d,height:_}),a.R.copy(l,O,{x:0,y:_-1},{x:i,y:r-1},{width:d,height:1}),a.R.copy(l,O,{x:0,y:0},{x:i,y:r+_},{width:d,height:1}),a.R.copy(l,O,{x:d-1,y:0},{x:i-1,y:r},{width:1,height:_}),a.R.copy(l,O,{x:0,y:0},{x:i+d,y:r},{width:1,height:_})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(A){for(const E of A){if(this.callbackDispatchedThisFrame[E])continue;this.callbackDispatchedThisFrame[E]=!0;const F=this.getImage(E);F||a.w(`Image with ID: "${E}" was not found`),Et(F)&&this.updateImage(E,F)}}}const dt=1e20;function Je(Z,A,E,F,O,y,s,i,r){for(let l=A;l<A+F;l++)pt(Z,E*y+l,y,O,s,i,r);for(let l=E;l<E+O;l++)pt(Z,l*y+A,1,F,s,i,r)}function pt(Z,A,E,F,O,y,s){y[0]=0,s[0]=-dt,s[1]=dt,O[0]=Z[A];for(let i=1,r=0,l=0;i<F;i++){O[i]=Z[A+i*E];const d=i*i;do{const _=y[r];l=(O[i]-O[_]+d-_*_)/(i-_)/2}while(l<=s[r]&&--r>-1);r++,y[r]=i,s[r]=l,s[r+1]=dt}for(let i=0,r=0;i<F;i++){for(;s[r+1]<i;)r++;const l=y[r],d=i-l;Z[A+i*E]=O[l]+d*d}}class lt{constructor(A,E){this.requestManager=A,this.localIdeographFontFamily=E,this.entries={}}setURL(A){this.url=A}getGlyphs(A,E){const F=[];for(const O in A)for(const y of A[O])F.push({stack:O,id:y});a.o(F,({stack:O,id:y},s)=>{let i=this.entries[O];i||(i=this.entries[O]={glyphs:{},requests:{},ranges:{}});let r=i.glyphs[y];if(r!==void 0)return void s(null,{stack:O,id:y,glyph:r});if(r=this._tinySDF(i,O,y),r)return i.glyphs[y]=r,void s(null,{stack:O,id:y,glyph:r});const l=Math.floor(y/256);if(256*l>65535)return void s(new Error("glyphs > 65535 not supported"));if(i.ranges[l])return void s(null,{stack:O,id:y,glyph:r});if(!this.url)return void s(new Error("glyphsUrl is not set"));let d=i.requests[l];d||(d=i.requests[l]=[],lt.loadGlyphRange(O,l,this.url,this.requestManager,(_,w)=>{if(w){for(const T in w)this._doesCharSupportLocalGlyph(+T)||(i.glyphs[+T]=w[+T]);i.ranges[l]=!0}for(const T of d)T(_,w);delete i.requests[l]})),d.push((_,w)=>{_?s(_):w&&s(null,{stack:O,id:y,glyph:w[y]||null})})},(O,y)=>{if(O)E(O);else if(y){const s={};for(const{stack:i,id:r,glyph:l}of y)(s[i]||(s[i]={}))[r]=l&&{id:l.id,bitmap:l.bitmap.clone(),metrics:l.metrics};E(null,s)}})}_doesCharSupportLocalGlyph(A){return!!this.localIdeographFontFamily&&(a.u["CJK Unified Ideographs"](A)||a.u["Hangul Syllables"](A)||a.u.Hiragana(A)||a.u.Katakana(A))}_tinySDF(A,E,F){const O=this.localIdeographFontFamily;if(!O||!this._doesCharSupportLocalGlyph(F))return;let y=A.tinySDF;if(!y){let i="400";/bold/i.test(E)?i="900":/medium/i.test(E)?i="500":/light/i.test(E)&&(i="200"),y=A.tinySDF=new lt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:O,fontWeight:i})}const s=y.draw(String.fromCharCode(F));return{id:F,bitmap:new a.q({width:s.width||60,height:s.height||60},s.data),metrics:{width:s.glyphWidth/2||24,height:s.glyphHeight/2||24,left:s.glyphLeft/2+.5||0,top:s.glyphTop/2-27.5||-8,advance:s.glyphAdvance/2||24,isDoubleResolution:!0}}}}lt.loadGlyphRange=function(Z,A,E,F,O){const y=256*A,s=y+255,i=F.transformRequest(E.replace("{fontstack}",Z).replace("{range}",`${y}-${s}`),at.Glyphs);a.l(i,(r,l)=>{if(r)O(r);else if(l){const d={};for(const _ of a.n(l))d[_.id]=_;O(null,d)}})},lt.TinySDF=class{constructor({fontSize:Z=24,buffer:A=3,radius:E=8,cutoff:F=.25,fontFamily:O="sans-serif",fontWeight:y="normal",fontStyle:s="normal"}={}){this.buffer=A,this.cutoff=F,this.radius=E;const i=this.size=Z+4*A,r=this._createCanvas(i),l=this.ctx=r.getContext("2d",{willReadFrequently:!0});l.font=`${s} ${y} ${Z}px ${O}`,l.textBaseline="alphabetic",l.textAlign="left",l.fillStyle="black",this.gridOuter=new Float64Array(i*i),this.gridInner=new Float64Array(i*i),this.f=new Float64Array(i),this.z=new Float64Array(i+1),this.v=new Uint16Array(i)}_createCanvas(Z){const A=document.createElement("canvas");return A.width=A.height=Z,A}draw(Z){const{width:A,actualBoundingBoxAscent:E,actualBoundingBoxDescent:F,actualBoundingBoxLeft:O,actualBoundingBoxRight:y}=this.ctx.measureText(Z),s=Math.ceil(E),i=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-O))),r=Math.min(this.size-this.buffer,s+Math.ceil(F)),l=i+2*this.buffer,d=r+2*this.buffer,_=Math.max(l*d,0),w=new Uint8ClampedArray(_),T={data:w,width:l,height:d,glyphWidth:i,glyphHeight:r,glyphTop:s,glyphLeft:0,glyphAdvance:A};if(i===0||r===0)return T;const{ctx:B,buffer:j,gridInner:X,gridOuter:ce}=this;B.clearRect(j,j,i,r),B.fillText(Z,j,j+s);const Se=B.getImageData(j,j,i,r);ce.fill(dt,0,_),X.fill(0,0,_);for(let Te=0;Te<r;Te++)for(let Re=0;Re<i;Re++){const Be=Se.data[4*(Te*i+Re)+3]/255;if(Be===0)continue;const Ke=(Te+j)*l+Re+j;if(Be===1)ce[Ke]=0,X[Ke]=dt;else{const yt=.5-Be;ce[Ke]=yt>0?yt*yt:0,X[Ke]=yt<0?yt*yt:0}}Je(ce,0,0,l,d,l,this.f,this.v,this.z),Je(X,j,j,i,r,l,this.f,this.v,this.z);for(let Te=0;Te<_;Te++){const Re=Math.sqrt(ce[Te])-Math.sqrt(X[Te]);w[Te]=Math.round(255-255*(Re/this.radius+this.cutoff))}return T}};class Nt{constructor(){this.specification=a.v.light.position}possiblyEvaluate(A,E){return a.z(A.expression.evaluate(E))}interpolate(A,E,F){return{x:a.B.number(A.x,E.x,F),y:a.B.number(A.y,E.y,F),z:a.B.number(A.z,E.z,F)}}}let zt;class Ot extends a.E{constructor(A){super(),zt=zt||new a.r({anchor:new a.D(a.v.light.anchor),position:new Nt,color:new a.D(a.v.light.color),intensity:new a.D(a.v.light.intensity)}),this._transitionable=new a.T(zt),this.setLight(A),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(A,E={}){if(!this._validate(a.t,A,E))for(const F in A){const O=A[F];F.endsWith("-transition")?this._transitionable.setTransition(F.slice(0,-11),O):this._transitionable.setValue(F,O)}}updateTransitions(A){this._transitioning=this._transitionable.transitioned(A,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(A){this.properties=this._transitioning.possiblyEvaluate(A)}_validate(A,E,F){return(!F||F.validate!==!1)&&a.x(this,A.call(a.y,a.e({value:E,style:{glyphs:!0,sprite:!0},styleSpec:a.v})))}}class gi{constructor(A,E){this.width=A,this.height=E,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(A,E){const F=A.join(",")+String(E);return this.dashEntry[F]||(this.dashEntry[F]=this.addDash(A,E)),this.dashEntry[F]}getDashRanges(A,E,F){const O=[];let y=A.length%2==1?-A[A.length-1]*F:0,s=A[0]*F,i=!0;O.push({left:y,right:s,isDash:i,zeroLength:A[0]===0});let r=A[0];for(let l=1;l<A.length;l++){i=!i;const d=A[l];y=r*F,r+=d,s=r*F,O.push({left:y,right:s,isDash:i,zeroLength:d===0})}return O}addRoundDash(A,E,F){const O=E/2;for(let y=-F;y<=F;y++){const s=this.width*(this.nextRow+F+y);let i=0,r=A[i];for(let l=0;l<this.width;l++){l/r.right>1&&(r=A[++i]);const d=Math.abs(l-r.left),_=Math.abs(l-r.right),w=Math.min(d,_);let T;const B=y/F*(O+1);if(r.isDash){const j=O-Math.abs(B);T=Math.sqrt(w*w+j*j)}else T=O-Math.sqrt(w*w+B*B);this.data[s+l]=Math.max(0,Math.min(255,T+128))}}}addRegularDash(A){for(let i=A.length-1;i>=0;--i){const r=A[i],l=A[i+1];r.zeroLength?A.splice(i,1):l&&l.isDash===r.isDash&&(l.left=r.left,A.splice(i,1))}const E=A[0],F=A[A.length-1];E.isDash===F.isDash&&(E.left=F.left-this.width,F.right=E.right+this.width);const O=this.width*this.nextRow;let y=0,s=A[y];for(let i=0;i<this.width;i++){i/s.right>1&&(s=A[++y]);const r=Math.abs(i-s.left),l=Math.abs(i-s.right),d=Math.min(r,l);this.data[O+i]=Math.max(0,Math.min(255,(s.isDash?d:-d)+128))}}addDash(A,E){const F=E?7:0,O=2*F+1;if(this.nextRow+O>this.height)return a.w("LineAtlas out of space"),null;let y=0;for(let i=0;i<A.length;i++)y+=A[i];if(y!==0){const i=this.width/y,r=this.getDashRanges(A,this.width,i);E?this.addRoundDash(r,i,F):this.addRegularDash(r)}const s={y:(this.nextRow+F+.5)/this.height,height:2*F/this.height,width:y};return this.nextRow+=O,this.dirty=!0,s}bind(A){const E=A.gl;this.texture?(E.bindTexture(E.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,E.texSubImage2D(E.TEXTURE_2D,0,0,0,this.width,this.height,E.ALPHA,E.UNSIGNED_BYTE,this.data))):(this.texture=E.createTexture(),E.bindTexture(E.TEXTURE_2D,this.texture),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,E.REPEAT),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,E.REPEAT),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,E.LINEAR),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,E.LINEAR),E.texImage2D(E.TEXTURE_2D,0,E.ALPHA,this.width,this.height,0,E.ALPHA,E.UNSIGNED_BYTE,this.data))}}class wi{constructor(A,E,F){this.workerPool=A,this.actors=[],this.currentActor=0,this.id=F;const O=this.workerPool.acquire(F);for(let y=0;y<O.length;y++){const s=new a.C(O[y],E,F);s.name=`Worker ${y}`,this.actors.push(s)}if(!this.actors.length)throw new Error("No actors found")}broadcast(A,E,F){a.o(this.actors,(O,y)=>{O.send(A,E,y)},F=F||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(A=!0){this.actors.forEach(E=>{E.remove()}),this.actors=[],A&&this.workerPool.release(this.id)}}function Ti(Z,A,E){const F=function(O,y){if(O)return E(O);if(y){const s=a.F(a.e(y,Z),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);y.vector_layers&&(s.vectorLayers=y.vector_layers,s.vectorLayerIds=s.vectorLayers.map(i=>i.id)),E(null,s)}};return Z.url?a.f(A.transformRequest(Z.url,at.Source),F):a.h.frame(()=>F(null,Z))}class Ni{constructor(A,E){A&&(E?this.setSouthWest(A).setNorthEast(E):Array.isArray(A)&&(A.length===4?this.setSouthWest([A[0],A[1]]).setNorthEast([A[2],A[3]]):this.setSouthWest(A[0]).setNorthEast(A[1])))}setNorthEast(A){return this._ne=A instanceof a.L?new a.L(A.lng,A.lat):a.L.convert(A),this}setSouthWest(A){return this._sw=A instanceof a.L?new a.L(A.lng,A.lat):a.L.convert(A),this}extend(A){const E=this._sw,F=this._ne;let O,y;if(A instanceof a.L)O=A,y=A;else{if(!(A instanceof Ni))return Array.isArray(A)?A.length===4||A.every(Array.isArray)?this.extend(Ni.convert(A)):this.extend(a.L.convert(A)):A&&("lng"in A||"lon"in A)&&"lat"in A?this.extend(a.L.convert(A)):this;if(O=A._sw,y=A._ne,!O||!y)return this}return E||F?(E.lng=Math.min(O.lng,E.lng),E.lat=Math.min(O.lat,E.lat),F.lng=Math.max(y.lng,F.lng),F.lat=Math.max(y.lat,F.lat)):(this._sw=new a.L(O.lng,O.lat),this._ne=new a.L(y.lng,y.lat)),this}getCenter(){return new a.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.L(this.getWest(),this.getNorth())}getSouthEast(){return new a.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(A){const{lng:E,lat:F}=a.L.convert(A);let O=this._sw.lng<=E&&E<=this._ne.lng;return this._sw.lng>this._ne.lng&&(O=this._sw.lng>=E&&E>=this._ne.lng),this._sw.lat<=F&&F<=this._ne.lat&&O}static convert(A){return A instanceof Ni?A:A&&new Ni(A)}static fromLngLat(A,E=0){const F=360*E/40075017,O=F/Math.cos(Math.PI/180*A.lat);return new Ni(new a.L(A.lng-O,A.lat-F),new a.L(A.lng+O,A.lat+F))}}class en{constructor(A,E,F){this.bounds=Ni.convert(this.validateBounds(A)),this.minzoom=E||0,this.maxzoom=F||24}validateBounds(A){return Array.isArray(A)&&A.length===4?[Math.max(-180,A[0]),Math.max(-90,A[1]),Math.min(180,A[2]),Math.min(90,A[3])]:[-180,-90,180,90]}contains(A){const E=Math.pow(2,A.z),F=Math.floor(a.G(this.bounds.getWest())*E),O=Math.floor(a.H(this.bounds.getNorth())*E),y=Math.ceil(a.G(this.bounds.getEast())*E),s=Math.ceil(a.H(this.bounds.getSouth())*E);return A.x>=F&&A.x<y&&A.y>=O&&A.y<s}}class ji extends a.E{constructor(A,E,F,O){if(super(),this.load=()=>{this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Ti(this._options,this.map._requestManager,(y,s)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),y?this.fire(new a.j(y)):s&&(a.e(this,s),s.bounds&&(this.tileBounds=new en(s.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>a.e({},this._options),this.id=A,this.dispatcher=F,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.F(E,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},E),this._collectResourceTiming=E.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(O)}loaded(){return this._loaded}hasTile(A){return!this.tileBounds||this.tileBounds.contains(A.canonical)}onAdd(A){this.map=A,this.load()}setSourceProperty(A){this._tileJSONRequest&&this._tileJSONRequest.cancel(),A(),this.load()}setTiles(A){return this.setSourceProperty(()=>{this._options.tiles=A}),this}setUrl(A){return this.setSourceProperty(()=>{this.url=A,this._options.url=A}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(A,E){const F=A.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),O={request:this.map._requestManager.transformRequest(F,at.Tile),uid:A.uid,tileID:A.tileID,zoom:A.tileID.overscaledZ,tileSize:this.tileSize*A.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function y(s,i){return delete A.request,A.aborted?E(null):s&&s.status!==404?E(s):(i&&i.resourceTiming&&(A.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&i&&A.setExpiryData(i),A.loadVectorData(i,this.map.painter),E(null),void(A.reloadCallback&&(this.loadTile(A,A.reloadCallback),A.reloadCallback=null)))}O.request.collectResourceTiming=this._collectResourceTiming,A.actor&&A.state!=="expired"?A.state==="loading"?A.reloadCallback=E:A.request=A.actor.send("reloadTile",O,y.bind(this)):(A.actor=this.dispatcher.getActor(),A.request=A.actor.send("loadTile",O,y.bind(this)))}abortTile(A){A.request&&(A.request.cancel(),delete A.request),A.actor&&A.actor.send("abortTile",{uid:A.uid,type:this.type,source:this.id},void 0)}unloadTile(A){A.unloadVectorData(),A.actor&&A.actor.send("removeTile",{uid:A.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class Vi extends a.E{constructor(A,E,F,O){super(),this.id=A,this.dispatcher=F,this.setEventedParent(O),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},E),a.e(this,a.F(E,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Ti(this._options,this.map._requestManager,(A,E)=>{this._tileJSONRequest=null,this._loaded=!0,A?this.fire(new a.j(A)):E&&(a.e(this,E),E.bounds&&(this.tileBounds=new en(E.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(A){this.map=A,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(A){this._tileJSONRequest&&this._tileJSONRequest.cancel(),A(),this.load()}setTiles(A){return this.setSourceProperty(()=>{this._options.tiles=A}),this}serialize(){return a.e({},this._options)}hasTile(A){return!this.tileBounds||this.tileBounds.contains(A.canonical)}loadTile(A,E){const F=A.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);A.request=tt.getImage(this.map._requestManager.transformRequest(F,at.Tile),(O,y,s)=>{if(delete A.request,A.aborted)A.state="unloaded",E(null);else if(O)A.state="errored",E(O);else if(y){this.map._refreshExpiredTiles&&s&&A.setExpiryData(s);const i=this.map.painter.context,r=i.gl;A.texture=this.map.painter.getTileTexture(y.width),A.texture?A.texture.update(y,{useMipmap:!0}):(A.texture=new mt(i,y,r.RGBA,{useMipmap:!0}),A.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE,r.LINEAR_MIPMAP_NEAREST),i.extTextureFilterAnisotropic&&r.texParameterf(r.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax)),A.state="loaded",E(null)}},this.map._refreshExpiredTiles)}abortTile(A,E){A.request&&(A.request.cancel(),delete A.request),E()}unloadTile(A,E){A.texture&&this.map.painter.saveTileTexture(A.texture),E()}hasTransition(){return!1}}class nn extends Vi{constructor(A,E,F,O){super(A,E,F,O),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},E),this.encoding=E.encoding||"mapbox",this.redFactor=E.redFactor,this.greenFactor=E.greenFactor,this.blueFactor=E.blueFactor,this.baseShift=E.baseShift}loadTile(A,E){const F=A.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),O=this.map._requestManager.transformRequest(F,at.Tile);function y(s,i){s&&(A.state="errored",E(s)),i&&(A.dem=i,A.needsHillshadePrepare=!0,A.needsTerrainPrepare=!0,A.state="loaded",E(null))}A.neighboringTiles=this._getNeighboringTiles(A.tileID),A.request=tt.getImage(O,(s,i,r)=>a._(this,void 0,void 0,function*(){if(delete A.request,A.aborted)A.state="unloaded",E(null);else if(s)A.state="errored",E(s);else if(i){this.map._refreshExpiredTiles&&A.setExpiryData(r);const l=a.a(i)&&a.J()?i:yield function(_){return a._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&a.K()){const w=_.width+2,T=_.height+2;try{return new a.R({width:w,height:T},yield a.M(_,-1,-1,w,T))}catch{}}return a.h.getImageData(_,1)})}(i),d={uid:A.uid,coord:A.tileID,source:this.id,rawImageData:l,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};A.actor&&A.state!=="expired"||(A.actor=this.dispatcher.getActor(),A.actor.send("loadDEMTile",d,y))}}),this.map._refreshExpiredTiles)}_getNeighboringTiles(A){const E=A.canonical,F=Math.pow(2,E.z),O=(E.x-1+F)%F,y=E.x===0?A.wrap-1:A.wrap,s=(E.x+1+F)%F,i=E.x+1===F?A.wrap+1:A.wrap,r={};return r[new a.O(A.overscaledZ,y,E.z,O,E.y).key]={backfilled:!1},r[new a.O(A.overscaledZ,i,E.z,s,E.y).key]={backfilled:!1},E.y>0&&(r[new a.O(A.overscaledZ,y,E.z,O,E.y-1).key]={backfilled:!1},r[new a.O(A.overscaledZ,A.wrap,E.z,E.x,E.y-1).key]={backfilled:!1},r[new a.O(A.overscaledZ,i,E.z,s,E.y-1).key]={backfilled:!1}),E.y+1<F&&(r[new a.O(A.overscaledZ,y,E.z,O,E.y+1).key]={backfilled:!1},r[new a.O(A.overscaledZ,A.wrap,E.z,E.x,E.y+1).key]={backfilled:!1},r[new a.O(A.overscaledZ,i,E.z,s,E.y+1).key]={backfilled:!1}),r}unloadTile(A){A.demTexture&&this.map.painter.saveTileTexture(A.demTexture),A.fbo&&(A.fbo.destroy(),delete A.fbo),A.dem&&delete A.dem,delete A.neighboringTiles,A.state="unloaded",A.actor&&A.actor.send("removeDEMTile",{uid:A.uid,source:this.id})}}class vn extends a.E{constructor(A,E,F,O){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>a.e({},this._options,{type:this.type,data:this._data}),this.id=A,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=F.getActor(),this.setEventedParent(O),this._data=E.data,this._options=a.e({},E),this._collectResourceTiming=E.collectResourceTiming,E.maxzoom!==void 0&&(this.maxzoom=E.maxzoom),E.type&&(this.type=E.type),E.attribution&&(this.attribution=E.attribution),this.promoteId=E.promoteId;const y=a.N/this.tileSize;this.workerOptions=a.e({source:this.id,cluster:E.cluster||!1,geojsonVtOptions:{buffer:(E.buffer!==void 0?E.buffer:128)*y,tolerance:(E.tolerance!==void 0?E.tolerance:.375)*y,extent:a.N,maxZoom:this.maxzoom,lineMetrics:E.lineMetrics||!1,generateId:E.generateId||!1},superclusterOptions:{maxZoom:E.clusterMaxZoom!==void 0?E.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,E.clusterMinPoints||2),extent:a.N,radius:(E.clusterRadius||50)*y,log:!1,generateId:E.generateId||!1},clusterProperties:E.clusterProperties,filter:E.filter},E.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(A){this.map=A,this.load()}setData(A){return this._data=A,this._updateWorkerData(),this}updateData(A){return this._updateWorkerData(A),this}setClusterOptions(A){return this.workerOptions.cluster=A.cluster,A&&(A.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=A.clusterRadius),A.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=A.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(A,E){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:A,source:this.id},E),this}getClusterChildren(A,E){return this.actor.send("geojson.getClusterChildren",{clusterId:A,source:this.id},E),this}getClusterLeaves(A,E,F,O){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:A,limit:E,offset:F},O),this}_updateWorkerData(A){const E=a.e({},this.workerOptions);A?E.dataDiff=A:typeof this._data=="string"?(E.request=this.map._requestManager.transformRequest(a.h.resolveURL(this._data),at.Source),E.request.collectResourceTiming=this._collectResourceTiming):E.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new a.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,E,(F,O)=>{if(this._pendingLoads--,this._removed||O&&O.abandoned)return void this.fire(new a.k("dataabort",{dataType:"source"}));let y=null;if(O&&O.resourceTiming&&O.resourceTiming[this.id]&&(y=O.resourceTiming[this.id].slice(0)),F)return void this.fire(new a.j(F));const s={dataType:"source"};this._collectResourceTiming&&y&&y.length>0&&a.e(s,{resourceTiming:y}),this.fire(new a.k("data",Object.assign(Object.assign({},s),{sourceDataType:"metadata"}))),this.fire(new a.k("data",Object.assign(Object.assign({},s),{sourceDataType:"content"})))})}loaded(){return this._pendingLoads===0}loadTile(A,E){const F=A.actor?"reloadTile":"loadTile";A.actor=this.actor;const O={type:this.type,uid:A.uid,tileID:A.tileID,zoom:A.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};A.request=this.actor.send(F,O,(y,s)=>(delete A.request,A.unloadVectorData(),A.aborted?E(null):y?E(y):(A.loadVectorData(s,this.map.painter,F==="reloadTile"),E(null))))}abortTile(A){A.request&&(A.request.cancel(),delete A.request),A.aborted=!0}unloadTile(A){A.unloadVectorData(),this.actor.send("removeTile",{uid:A.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var Ci=a.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class mi extends a.E{constructor(A,E,F,O){super(),this.load=(y,s)=>{this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=tt.getImage(this.map._requestManager.transformRequest(this.url,at.Image),(i,r)=>{this._request=null,this._loaded=!0,i?this.fire(new a.j(i)):r&&(this.image=r,y&&(this.coordinates=y),s&&s(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const y=this.map.painter.context,s=y.gl;this.boundsBuffer||(this.boundsBuffer=y.createVertexBuffer(this._boundsArray,Ci.members)),this.boundsSegments||(this.boundsSegments=a.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new mt(y,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let i=!1;for(const r in this.tiles){const l=this.tiles[r];l.state!=="loaded"&&(l.state="loaded",l.texture=this.texture,i=!0)}i&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=A,this.dispatcher=F,this.coordinates=E.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(O),this.options=E}loaded(){return this._loaded}updateImage(A){return A.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=A.url,this.load(A.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(A){this.map=A,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(A){this.coordinates=A;const E=A.map(a.U.fromLngLat);this.tileID=function(O){let y=1/0,s=1/0,i=-1/0,r=-1/0;for(const w of O)y=Math.min(y,w.x),s=Math.min(s,w.y),i=Math.max(i,w.x),r=Math.max(r,w.y);const l=Math.max(i-y,r-s),d=Math.max(0,Math.floor(-Math.log(l)/Math.LN2)),_=Math.pow(2,d);return new a.W(d,Math.floor((y+i)/2*_),Math.floor((s+r)/2*_))}(E),this.minzoom=this.maxzoom=this.tileID.z;const F=E.map(O=>this.tileID.getTilePoint(O)._round());return this._boundsArray=new a.V,this._boundsArray.emplaceBack(F[0].x,F[0].y,0,0),this._boundsArray.emplaceBack(F[1].x,F[1].y,a.N,0),this._boundsArray.emplaceBack(F[3].x,F[3].y,0,a.N),this._boundsArray.emplaceBack(F[2].x,F[2].y,a.N,a.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(A,E){this.tileID&&this.tileID.equals(A.tileID.canonical)?(this.tiles[String(A.tileID.wrap)]=A,A.buckets={},E(null)):(A.state="errored",E(null))}hasTransition(){return!1}}class Ri extends mi{constructor(A,E,F,O){super(A,E,F,O),this.load=()=>{this._loaded=!1;const y=this.options;this.urls=[];for(const s of y.urls)this.urls.push(this.map._requestManager.transformRequest(s,at.Source).url);a.X(this.urls,(s,i)=>{this._loaded=!0,s?this.fire(new a.j(s)):i&&(this.video=i,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const y=this.map.painter.context,s=y.gl;this.boundsBuffer||(this.boundsBuffer=y.createVertexBuffer(this._boundsArray,Ci.members)),this.boundsSegments||(this.boundsSegments=a.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new mt(y,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let i=!1;for(const r in this.tiles){const l=this.tiles[r];l.state!=="loaded"&&(l.state="loaded",l.texture=this.texture,i=!0)}i&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=E}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(A){if(this.video){const E=this.video.seekable;A<E.start(0)||A>E.end(0)?this.fire(new a.j(new a.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${E.start(0)} and ${E.end(0)}-second mark.`))):this.video.currentTime=A}}getVideo(){return this.video}onAdd(A){this.map||(this.map=A,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class Oi extends mi{constructor(A,E,F,O){super(A,E,F,O),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let y=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,y=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,y=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context,i=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,Ci.members)),this.boundsSegments||(this.boundsSegments=a.S.simpleSegment(0,0,4,2)),this.texture?(y||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new mt(s,this.canvas,i.RGBA,{premultiply:!0});let r=!1;for(const l in this.tiles){const d=this.tiles[l];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture,r=!0)}r&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),E.coordinates?Array.isArray(E.coordinates)&&E.coordinates.length===4&&!E.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(s=>typeof s!="number"))||this.fire(new a.j(new a.Y(`sources.${A}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.j(new a.Y(`sources.${A}`,null,'missing required property "coordinates"'))),E.animate&&typeof E.animate!="boolean"&&this.fire(new a.j(new a.Y(`sources.${A}`,null,'optional "animate" property must be a boolean value'))),E.canvas?typeof E.canvas=="string"||E.canvas instanceof HTMLCanvasElement||this.fire(new a.j(new a.Y(`sources.${A}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.j(new a.Y(`sources.${A}`,null,'missing required property "canvas"'))),this.options=E,this.animate=E.animate===void 0||E.animate}getCanvas(){return this.canvas}onAdd(A){this.map=A,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const A of[this.canvas.width,this.canvas.height])if(isNaN(A)||A<=0)return!0;return!1}}const _i={},Ji=Z=>{switch(Z){case"geojson":return vn;case"image":return mi;case"raster":return Vi;case"raster-dem":return nn;case"vector":return ji;case"video":return Ri;case"canvas":return Oi}return _i[Z]};function Ai(Z,A){const E=a.Z();return a.$(E,E,[1,1,0]),a.a0(E,E,[.5*Z.width,.5*Z.height,1]),a.a1(E,E,Z.calculatePosMatrix(A.toUnwrapped()))}function sn(Z,A,E,F,O,y){const s=function(_,w,T){if(_)for(const B of _){const j=w[B];if(j&&j.source===T&&j.type==="fill-extrusion")return!0}else for(const B in w){const j=w[B];if(j.source===T&&j.type==="fill-extrusion")return!0}return!1}(O&&O.layers,A,Z.id),i=y.maxPitchScaleFactor(),r=Z.tilesIn(F,i,s);r.sort(ei);const l=[];for(const _ of r)l.push({wrappedTileID:_.tileID.wrapped().key,queryResults:_.tile.queryRenderedFeatures(A,E,Z._state,_.queryGeometry,_.cameraQueryGeometry,_.scale,O,y,i,Ai(Z.transform,_.tileID))});const d=function(_){const w={},T={};for(const B of _){const j=B.queryResults,X=B.wrappedTileID,ce=T[X]=T[X]||{};for(const Se in j){const Te=j[Se],Re=ce[Se]=ce[Se]||{},Be=w[Se]=w[Se]||[];for(const Ke of Te)Re[Ke.featureIndex]||(Re[Ke.featureIndex]=!0,Be.push(Ke))}}return w}(l);for(const _ in d)d[_].forEach(w=>{const T=w.feature,B=Z.getFeatureState(T.layer["source-layer"],T.id);T.source=T.layer.source,T.layer["source-layer"]&&(T.sourceLayer=T.layer["source-layer"]),T.state=B});return d}function ei(Z,A){const E=Z.tileID,F=A.tileID;return E.overscaledZ-F.overscaledZ||E.canonical.y-F.canonical.y||E.wrap-F.wrap||E.canonical.x-F.canonical.x}class _n{constructor(A,E){this.timeAdded=0,this.fadeEndTime=0,this.tileID=A,this.uid=a.a2(),this.uses=0,this.tileSize=E,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(A){const E=A+this.timeAdded;E<this.fadeEndTime||(this.fadeEndTime=E)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(A){this.demTexture&&A.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(A,E,F){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",A){A.featureIndex&&(this.latestFeatureIndex=A.featureIndex,A.rawTileData?(this.latestRawTileData=A.rawTileData,this.latestFeatureIndex.rawTileData=A.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=A.collisionBoxArray,this.buckets=function(O,y){const s={};if(!y)return s;for(const i of O){const r=i.layerIds.map(l=>y.getLayer(l)).filter(Boolean);if(r.length!==0){i.layers=r,i.stateDependentLayerIds&&(i.stateDependentLayers=i.stateDependentLayerIds.map(l=>r.filter(d=>d.id===l)[0]));for(const l of r)s[l.id]=i}}return s}(A.buckets,E.style),this.hasSymbolBuckets=!1;for(const O in this.buckets){const y=this.buckets[O];if(y instanceof a.a4){if(this.hasSymbolBuckets=!0,!F)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const O in this.buckets){const y=this.buckets[O];if(y instanceof a.a4&&y.hasRTLText){this.hasRTLText=!0,a.a5();break}}this.queryPadding=0;for(const O in this.buckets){const y=this.buckets[O];this.queryPadding=Math.max(this.queryPadding,E.style.getLayer(O).queryRadius(y))}A.imageAtlas&&(this.imageAtlas=A.imageAtlas),A.glyphAtlasImage&&(this.glyphAtlasImage=A.glyphAtlasImage)}else this.collisionBoxArray=new a.a3}unloadVectorData(){for(const A in this.buckets)this.buckets[A].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(A){return this.buckets[A.id]}upload(A){for(const F in this.buckets){const O=this.buckets[F];O.uploadPending()&&O.upload(A)}const E=A.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new mt(A,this.imageAtlas.image,E.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new mt(A,this.glyphAtlasImage,E.ALPHA),this.glyphAtlasImage=null)}prepare(A){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(A,this.imageAtlasTexture)}queryRenderedFeatures(A,E,F,O,y,s,i,r,l,d){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:O,cameraQueryGeometry:y,scale:s,tileSize:this.tileSize,pixelPosMatrix:d,transform:r,params:i,queryPadding:this.queryPadding*l},A,E,F):{}}querySourceFeatures(A,E){const F=this.latestFeatureIndex;if(!F||!F.rawTileData)return;const O=F.loadVTLayers(),y=E&&E.sourceLayer?E.sourceLayer:"",s=O._geojsonTileLayer||O[y];if(!s)return;const i=a.a6(E&&E.filter),{z:r,x:l,y:d}=this.tileID.canonical,_={z:r,x:l,y:d};for(let w=0;w<s.length;w++){const T=s.feature(w);if(i.needGeometry){const X=a.a7(T,!0);if(!i.filter(new a.a8(this.tileID.overscaledZ),X,this.tileID.canonical))continue}else if(!i.filter(new a.a8(this.tileID.overscaledZ),T))continue;const B=F.getId(T,y),j=new a.a9(T,r,l,d,B);j.tile=_,A.push(j)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(A){const E=this.expirationTime;if(A.cacheControl){const F=a.aa(A.cacheControl);F["max-age"]&&(this.expirationTime=Date.now()+1e3*F["max-age"])}else A.expires&&(this.expirationTime=new Date(A.expires).getTime());if(this.expirationTime){const F=Date.now();let O=!1;if(this.expirationTime>F)O=!1;else if(E)if(this.expirationTime<E)O=!0;else{const y=this.expirationTime-E;y?this.expirationTime=F+Math.max(y,3e4):O=!0}else O=!0;O?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(A,E){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(A).length===0)return;const F=this.latestFeatureIndex.loadVTLayers();for(const O in this.buckets){if(!E.style.hasLayer(O))continue;const y=this.buckets[O],s=y.layers[0].sourceLayer||"_geojsonTileLayer",i=F[s],r=A[s];if(!i||!r||Object.keys(r).length===0)continue;y.update(r,i,this.imageAtlas&&this.imageAtlas.patternPositions||{});const l=E&&E.style&&E.style.getLayer(O);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(A){this.symbolFadeHoldUntil=a.h.now()+A}setDependencies(A,E){const F={};for(const O of E)F[O]=!0;this.dependencies[A]=F}hasDependency(A,E){for(const F of A){const O=this.dependencies[F];if(O){for(const y of E)if(O[y])return!0}}return!1}}class Pr{constructor(A,E){this.max=A,this.onRemove=E,this.reset()}reset(){for(const A in this.data)for(const E of this.data[A])E.timeout&&clearTimeout(E.timeout),this.onRemove(E.value);return this.data={},this.order=[],this}add(A,E,F){const O=A.wrapped().key;this.data[O]===void 0&&(this.data[O]=[]);const y={value:E,timeout:void 0};if(F!==void 0&&(y.timeout=setTimeout(()=>{this.remove(A,y)},F)),this.data[O].push(y),this.order.push(O),this.order.length>this.max){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}has(A){return A.wrapped().key in this.data}getAndRemove(A){return this.has(A)?this._getAndRemoveByKey(A.wrapped().key):null}_getAndRemoveByKey(A){const E=this.data[A].shift();return E.timeout&&clearTimeout(E.timeout),this.data[A].length===0&&delete this.data[A],this.order.splice(this.order.indexOf(A),1),E.value}getByKey(A){const E=this.data[A];return E?E[0].value:null}get(A){return this.has(A)?this.data[A.wrapped().key][0].value:null}remove(A,E){if(!this.has(A))return this;const F=A.wrapped().key,O=E===void 0?0:this.data[F].indexOf(E),y=this.data[F][O];return this.data[F].splice(O,1),y.timeout&&clearTimeout(y.timeout),this.data[F].length===0&&delete this.data[F],this.onRemove(y.value),this.order.splice(this.order.indexOf(F),1),this}setMaxSize(A){for(this.max=A;this.order.length>this.max;){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}filter(A){const E=[];for(const F in this.data)for(const O of this.data[F])A(O.value)||E.push(O);for(const F of E)this.remove(F.value.tileID,F)}}class ci{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(A,E,F){const O=String(E);if(this.stateChanges[A]=this.stateChanges[A]||{},this.stateChanges[A][O]=this.stateChanges[A][O]||{},a.e(this.stateChanges[A][O],F),this.deletedStates[A]===null){this.deletedStates[A]={};for(const y in this.state[A])y!==O&&(this.deletedStates[A][y]=null)}else if(this.deletedStates[A]&&this.deletedStates[A][O]===null){this.deletedStates[A][O]={};for(const y in this.state[A][O])F[y]||(this.deletedStates[A][O][y]=null)}else for(const y in F)this.deletedStates[A]&&this.deletedStates[A][O]&&this.deletedStates[A][O][y]===null&&delete this.deletedStates[A][O][y]}removeFeatureState(A,E,F){if(this.deletedStates[A]===null)return;const O=String(E);if(this.deletedStates[A]=this.deletedStates[A]||{},F&&E!==void 0)this.deletedStates[A][O]!==null&&(this.deletedStates[A][O]=this.deletedStates[A][O]||{},this.deletedStates[A][O][F]=null);else if(E!==void 0)if(this.stateChanges[A]&&this.stateChanges[A][O])for(F in this.deletedStates[A][O]={},this.stateChanges[A][O])this.deletedStates[A][O][F]=null;else this.deletedStates[A][O]=null;else this.deletedStates[A]=null}getState(A,E){const F=String(E),O=a.e({},(this.state[A]||{})[F],(this.stateChanges[A]||{})[F]);if(this.deletedStates[A]===null)return{};if(this.deletedStates[A]){const y=this.deletedStates[A][E];if(y===null)return{};for(const s in y)delete O[s]}return O}initializeTileState(A,E){A.setFeatureState(this.state,E)}coalesceChanges(A,E){const F={};for(const O in this.stateChanges){this.state[O]=this.state[O]||{};const y={};for(const s in this.stateChanges[O])this.state[O][s]||(this.state[O][s]={}),a.e(this.state[O][s],this.stateChanges[O][s]),y[s]=this.state[O][s];F[O]=y}for(const O in this.deletedStates){this.state[O]=this.state[O]||{};const y={};if(this.deletedStates[O]===null)for(const s in this.state[O])y[s]={},this.state[O][s]={};else for(const s in this.deletedStates[O]){if(this.deletedStates[O][s]===null)this.state[O][s]={};else for(const i of Object.keys(this.deletedStates[O][s]))delete this.state[O][s][i];y[s]=this.state[O][s]}F[O]=F[O]||{},a.e(F[O],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(F).length!==0)for(const O in A)A[O].setFeatureState(F,E)}}class rn extends a.E{constructor(A,E,F){super(),this.id=A,this.dispatcher=F,this.on("data",O=>{O.dataType==="source"&&O.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&O.dataType==="source"&&O.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((O,y,s,i)=>{const r=new(Ji(y.type))(O,y,s,i);if(r.id!==O)throw new Error(`Expected Source id to be ${O} instead of ${r.id}`);return r})(A,E,F,this),this._tiles={},this._cache=new Pr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ci,this._didEmitContent=!1,this._updated=!1}onAdd(A){this.map=A,this._maxTileCacheSize=A?A._maxTileCacheSize:null,this._maxTileCacheZoomLevels=A?A._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(A)}onRemove(A){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(A)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const A in this._tiles){const E=this._tiles[A];if(E.state!=="loaded"&&E.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const A=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,A&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(A,E){return this._source.loadTile(A,E)}_unloadTile(A){if(this._source.unloadTile)return this._source.unloadTile(A,()=>{})}_abortTile(A){this._source.abortTile&&this._source.abortTile(A,()=>{}),this._source.fire(new a.k("dataabort",{tile:A,coord:A.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(A){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const E in this._tiles){const F=this._tiles[E];F.upload(A),F.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(A=>A.tileID).sort(tr).map(A=>A.key)}getRenderableIds(A){const E=[];for(const F in this._tiles)this._isIdRenderable(F,A)&&E.push(this._tiles[F]);return A?E.sort((F,O)=>{const y=F.tileID,s=O.tileID,i=new a.P(y.canonical.x,y.canonical.y)._rotate(this.transform.angle),r=new a.P(s.canonical.x,s.canonical.y)._rotate(this.transform.angle);return y.overscaledZ-s.overscaledZ||r.y-i.y||r.x-i.x}).map(F=>F.tileID.key):E.map(F=>F.tileID).sort(tr).map(F=>F.key)}hasRenderableParent(A){const E=this.findLoadedParent(A,0);return!!E&&this._isIdRenderable(E.tileID.key)}_isIdRenderable(A,E){return this._tiles[A]&&this._tiles[A].hasData()&&!this._coveredTiles[A]&&(E||!this._tiles[A].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const A in this._tiles)this._tiles[A].state!=="errored"&&this._reloadTile(A,"reloading")}}_reloadTile(A,E){const F=this._tiles[A];F&&(F.state!=="loading"&&(F.state=E),this._loadTile(F,this._tileLoaded.bind(this,F,A,E)))}_tileLoaded(A,E,F,O){if(O)return A.state="errored",void(O.status!==404?this._source.fire(new a.j(O,{tile:A})):this.update(this.transform,this.terrain));A.timeAdded=a.h.now(),F==="expired"&&(A.refreshedUponExpiration=!0),this._setTileReloadTimer(E,A),this.getSource().type==="raster-dem"&&A.dem&&this._backfillDEM(A),this._state.initializeTileState(A,this.map?this.map.painter:null),A.aborted||this._source.fire(new a.k("data",{dataType:"source",tile:A,coord:A.tileID}))}_backfillDEM(A){const E=this.getRenderableIds();for(let O=0;O<E.length;O++){const y=E[O];if(A.neighboringTiles&&A.neighboringTiles[y]){const s=this.getTileByID(y);F(A,s),F(s,A)}}function F(O,y){O.needsHillshadePrepare=!0,O.needsTerrainPrepare=!0;let s=y.tileID.canonical.x-O.tileID.canonical.x;const i=y.tileID.canonical.y-O.tileID.canonical.y,r=Math.pow(2,O.tileID.canonical.z),l=y.tileID.key;s===0&&i===0||Math.abs(i)>1||(Math.abs(s)>1&&(Math.abs(s+r)===1?s+=r:Math.abs(s-r)===1&&(s-=r)),y.dem&&O.dem&&(O.dem.backfillBorder(y.dem,s,i),O.neighboringTiles&&O.neighboringTiles[l]&&(O.neighboringTiles[l].backfilled=!0)))}}getTile(A){return this.getTileByID(A.key)}getTileByID(A){return this._tiles[A]}_retainLoadedChildren(A,E,F,O){for(const y in this._tiles){let s=this._tiles[y];if(O[y]||!s.hasData()||s.tileID.overscaledZ<=E||s.tileID.overscaledZ>F)continue;let i=s.tileID;for(;s&&s.tileID.overscaledZ>E+1;){const l=s.tileID.scaledTo(s.tileID.overscaledZ-1);s=this._tiles[l.key],s&&s.hasData()&&(i=l)}let r=i;for(;r.overscaledZ>E;)if(r=r.scaledTo(r.overscaledZ-1),A[r.key]){O[i.key]=i;break}}}findLoadedParent(A,E){if(A.key in this._loadedParentTiles){const F=this._loadedParentTiles[A.key];return F&&F.tileID.overscaledZ>=E?F:null}for(let F=A.overscaledZ-1;F>=E;F--){const O=A.scaledTo(F),y=this._getLoadedTile(O);if(y)return y}}_getLoadedTile(A){const E=this._tiles[A.key];return E&&E.hasData()?E:this._cache.getByKey(A.wrapped().key)}updateCacheSize(A){const E=Math.ceil(A.width/this._source.tileSize)+1,F=Math.ceil(A.height/this._source.tileSize)+1,O=Math.floor(E*F*(this._maxTileCacheZoomLevels===null?a.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,O):O;this._cache.setMaxSize(y)}handleWrapJump(A){const E=Math.round((A-(this._prevLng===void 0?A:this._prevLng))/360);if(this._prevLng=A,E){const F={};for(const O in this._tiles){const y=this._tiles[O];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+E),F[y.tileID.key]=y}this._tiles=F;for(const O in this._timers)clearTimeout(this._timers[O]),delete this._timers[O];for(const O in this._tiles)this._setTileReloadTimer(O,this._tiles[O])}}update(A,E){if(this.transform=A,this.terrain=E,!this._sourceLoaded||this._paused)return;let F;this.updateCacheSize(A),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?F=A.getVisibleUnwrappedCoordinates(this._source.tileID).map(d=>new a.O(d.canonical.z,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y)):(F=A.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:E}),this._source.hasTile&&(F=F.filter(d=>this._source.hasTile(d)))):F=[];const O=A.coveringZoomLevel(this._source),y=Math.max(O-rn.maxOverzooming,this._source.minzoom),s=Math.max(O+rn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const d={};for(const _ of F)if(_.canonical.z>this._source.minzoom){const w=_.scaledTo(_.canonical.z-1);d[w.key]=w;const T=_.scaledTo(Math.max(this._source.minzoom,Math.min(_.canonical.z,5)));d[T.key]=T}F=F.concat(Object.values(d))}const i=F.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,i&&this.fire(new a.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const r=this._updateRetainedTiles(F,O);if(Pn(this._source.type)){const d={},_={},w=Object.keys(r),T=a.h.now();for(const B of w){const j=r[B],X=this._tiles[B];if(!X||X.fadeEndTime!==0&&X.fadeEndTime<=T)continue;const ce=this.findLoadedParent(j,y);ce&&(this._addTile(ce.tileID),d[ce.tileID.key]=ce.tileID),_[B]=j}this._retainLoadedChildren(_,O,s,r);for(const B in d)r[B]||(this._coveredTiles[B]=!0,r[B]=d[B]);if(E){const B={},j={};for(const X of F)this._tiles[X.key].hasData()?B[X.key]=X:j[X.key]=X;for(const X in j){const ce=j[X].children(this._source.maxzoom);this._tiles[ce[0].key]&&this._tiles[ce[1].key]&&this._tiles[ce[2].key]&&this._tiles[ce[3].key]&&(B[ce[0].key]=r[ce[0].key]=ce[0],B[ce[1].key]=r[ce[1].key]=ce[1],B[ce[2].key]=r[ce[2].key]=ce[2],B[ce[3].key]=r[ce[3].key]=ce[3],delete j[X])}for(const X in j){const ce=this.findLoadedParent(j[X],this._source.minzoom);if(ce){B[ce.tileID.key]=r[ce.tileID.key]=ce.tileID;for(const Se in B)B[Se].isChildOf(ce.tileID)&&delete B[Se]}}for(const X in this._tiles)B[X]||(this._coveredTiles[X]=!0)}}for(const d in r)this._tiles[d].clearFadeHold();const l=a.ab(this._tiles,r);for(const d of l){const _=this._tiles[d];_.hasSymbolBuckets&&!_.holdingForFade()?_.setHoldDuration(this.map._fadeDuration):_.hasSymbolBuckets&&!_.symbolFadeFinished()||this._removeTile(d)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const A in this._tiles)this._tiles[A].holdingForFade()&&this._removeTile(A)}_updateRetainedTiles(A,E){const F={},O={},y=Math.max(E-rn.maxOverzooming,this._source.minzoom),s=Math.max(E+rn.maxUnderzooming,this._source.minzoom),i={};for(const r of A){const l=this._addTile(r);F[r.key]=r,l.hasData()||E<this._source.maxzoom&&(i[r.key]=r)}this._retainLoadedChildren(i,E,s,F);for(const r of A){let l=this._tiles[r.key];if(l.hasData())continue;if(E+1>this._source.maxzoom){const _=r.children(this._source.maxzoom)[0],w=this.getTile(_);if(w&&w.hasData()){F[_.key]=_;continue}}else{const _=r.children(this._source.maxzoom);if(F[_[0].key]&&F[_[1].key]&&F[_[2].key]&&F[_[3].key])continue}let d=l.wasRequested();for(let _=r.overscaledZ-1;_>=y;--_){const w=r.scaledTo(_);if(O[w.key])break;if(O[w.key]=!0,l=this.getTile(w),!l&&d&&(l=this._addTile(w)),l){const T=l.hasData();if((d||T)&&(F[w.key]=w),d=l.wasRequested(),T)break}}}return F}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const A in this._tiles){const E=[];let F,O=this._tiles[A].tileID;for(;O.overscaledZ>0;){if(O.key in this._loadedParentTiles){F=this._loadedParentTiles[O.key];break}E.push(O.key);const y=O.scaledTo(O.overscaledZ-1);if(F=this._getLoadedTile(y),F)break;O=y}for(const y of E)this._loadedParentTiles[y]=F}}_addTile(A){let E=this._tiles[A.key];if(E)return E;E=this._cache.getAndRemove(A),E&&(this._setTileReloadTimer(A.key,E),E.tileID=A,this._state.initializeTileState(E,this.map?this.map.painter:null),this._cacheTimers[A.key]&&(clearTimeout(this._cacheTimers[A.key]),delete this._cacheTimers[A.key],this._setTileReloadTimer(A.key,E)));const F=E;return E||(E=new _n(A,this._source.tileSize*A.overscaleFactor()),this._loadTile(E,this._tileLoaded.bind(this,E,A.key,E.state))),E.uses++,this._tiles[A.key]=E,F||this._source.fire(new a.k("dataloading",{tile:E,coord:E.tileID,dataType:"source"})),E}_setTileReloadTimer(A,E){A in this._timers&&(clearTimeout(this._timers[A]),delete this._timers[A]);const F=E.getExpiryTimeout();F&&(this._timers[A]=setTimeout(()=>{this._reloadTile(A,"expired"),delete this._timers[A]},F))}_removeTile(A){const E=this._tiles[A];E&&(E.uses--,delete this._tiles[A],this._timers[A]&&(clearTimeout(this._timers[A]),delete this._timers[A]),E.uses>0||(E.hasData()&&E.state!=="reloading"?this._cache.add(E.tileID,E,E.getExpiryTimeout()):(E.aborted=!0,this._abortTile(E),this._unloadTile(E))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const A in this._tiles)this._removeTile(A);this._cache.reset()}tilesIn(A,E,F){const O=[],y=this.transform;if(!y)return O;const s=F?y.getCameraQueryGeometry(A):A,i=A.map(B=>y.pointCoordinate(B,this.terrain)),r=s.map(B=>y.pointCoordinate(B,this.terrain)),l=this.getIds();let d=1/0,_=1/0,w=-1/0,T=-1/0;for(const B of r)d=Math.min(d,B.x),_=Math.min(_,B.y),w=Math.max(w,B.x),T=Math.max(T,B.y);for(let B=0;B<l.length;B++){const j=this._tiles[l[B]];if(j.holdingForFade())continue;const X=j.tileID,ce=Math.pow(2,y.zoom-j.tileID.overscaledZ),Se=E*j.queryPadding*a.N/j.tileSize/ce,Te=[X.getTilePoint(new a.U(d,_)),X.getTilePoint(new a.U(w,T))];if(Te[0].x-Se<a.N&&Te[0].y-Se<a.N&&Te[1].x+Se>=0&&Te[1].y+Se>=0){const Re=i.map(Ke=>X.getTilePoint(Ke)),Be=r.map(Ke=>X.getTilePoint(Ke));O.push({tile:j,tileID:X,queryGeometry:Re,cameraQueryGeometry:Be,scale:ce})}}return O}getVisibleCoordinates(A){const E=this.getRenderableIds(A).map(F=>this._tiles[F].tileID);for(const F of E)F.posMatrix=this.transform.calculatePosMatrix(F.toUnwrapped());return E}hasTransition(){if(this._source.hasTransition())return!0;if(Pn(this._source.type)){const A=a.h.now();for(const E in this._tiles)if(this._tiles[E].fadeEndTime>=A)return!0}return!1}setFeatureState(A,E,F){this._state.updateState(A=A||"_geojsonTileLayer",E,F)}removeFeatureState(A,E,F){this._state.removeFeatureState(A=A||"_geojsonTileLayer",E,F)}getFeatureState(A,E){return this._state.getState(A=A||"_geojsonTileLayer",E)}setDependencies(A,E,F){const O=this._tiles[A];O&&O.setDependencies(E,F)}reloadTilesForDependencies(A,E){for(const F in this._tiles)this._tiles[F].hasDependency(A,E)&&this._reloadTile(F,"reloading");this._cache.filter(F=>!F.hasDependency(A,E))}}function tr(Z,A){const E=Math.abs(2*Z.wrap)-+(Z.wrap<0),F=Math.abs(2*A.wrap)-+(A.wrap<0);return Z.overscaledZ-A.overscaledZ||F-E||A.canonical.y-Z.canonical.y||A.canonical.x-Z.canonical.x}function Pn(Z){return Z==="raster"||Z==="image"||Z==="video"}rn.maxOverzooming=10,rn.maxUnderzooming=3;const Qn="mapboxgl_preloaded_worker_pool";class In{constructor(){this.active={}}acquire(A){if(!this.workers)for(this.workers=[];this.workers.length<In.workerCount;)this.workers.push(new Worker(a.c.WORKER_URL));return this.active[A]=!0,this.workers.slice()}release(A){delete this.active[A],this.numActive()===0&&(this.workers.forEach(E=>{E.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Qn]}numActive(){return Object.keys(this.active).length}}const v=Math.floor(a.h.hardwareConcurrency/2);let k;function V(){return k||(k=new In),k}In.workerCount=a.ac(globalThis)?Math.max(Math.min(v,3),1):1;class Y{constructor(A,E){this.reset(A,E)}reset(A,E){this.points=A||[],this._distances=[0];for(let F=1;F<this.points.length;F++)this._distances[F]=this._distances[F-1]+this.points[F].dist(this.points[F-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(E||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(A){if(this.points.length===1)return this.points[0];A=a.ad(A,0,1);let E=1,F=this._distances[E];const O=A*this.paddedLength+this.padding;for(;F<O&&E<this._distances.length;)F=this._distances[++E];const y=E-1,s=this._distances[y],i=F-s,r=i>0?(O-s)/i:0;return this.points[y].mult(1-r).add(this.points[E].mult(r))}}function te(Z,A){let E=!0;return Z==="always"||Z!=="never"&&A!=="never"||(E=!1),E}class fe{constructor(A,E,F){const O=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(A/F),this.yCellCount=Math.ceil(E/F);for(let s=0;s<this.xCellCount*this.yCellCount;s++)O.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=A,this.height=E,this.xScale=this.xCellCount/A,this.yScale=this.yCellCount/E,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(A,E,F,O,y){this._forEachCell(E,F,O,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(A),this.bboxes.push(E),this.bboxes.push(F),this.bboxes.push(O),this.bboxes.push(y)}insertCircle(A,E,F,O){this._forEachCell(E-O,F-O,E+O,F+O,this._insertCircleCell,this.circleUid++),this.circleKeys.push(A),this.circles.push(E),this.circles.push(F),this.circles.push(O)}_insertBoxCell(A,E,F,O,y,s){this.boxCells[y].push(s)}_insertCircleCell(A,E,F,O,y,s){this.circleCells[y].push(s)}_query(A,E,F,O,y,s,i){if(F<0||A>this.width||O<0||E>this.height)return[];const r=[];if(A<=0&&E<=0&&this.width<=F&&this.height<=O){if(y)return[{key:null,x1:A,y1:E,x2:F,y2:O}];for(let l=0;l<this.boxKeys.length;l++)r.push({key:this.boxKeys[l],x1:this.bboxes[4*l],y1:this.bboxes[4*l+1],x2:this.bboxes[4*l+2],y2:this.bboxes[4*l+3]});for(let l=0;l<this.circleKeys.length;l++){const d=this.circles[3*l],_=this.circles[3*l+1],w=this.circles[3*l+2];r.push({key:this.circleKeys[l],x1:d-w,y1:_-w,x2:d+w,y2:_+w})}}else this._forEachCell(A,E,F,O,this._queryCell,r,{hitTest:y,overlapMode:s,seenUids:{box:{},circle:{}}},i);return r}query(A,E,F,O){return this._query(A,E,F,O,!1,null)}hitTest(A,E,F,O,y,s){return this._query(A,E,F,O,!0,y,s).length>0}hitTestCircle(A,E,F,O,y){const s=A-F,i=A+F,r=E-F,l=E+F;if(i<0||s>this.width||l<0||r>this.height)return!1;const d=[];return this._forEachCell(s,r,i,l,this._queryCellCircle,d,{hitTest:!0,overlapMode:O,circle:{x:A,y:E,radius:F},seenUids:{box:{},circle:{}}},y),d.length>0}_queryCell(A,E,F,O,y,s,i,r){const{seenUids:l,hitTest:d,overlapMode:_}=i,w=this.boxCells[y];if(w!==null){const B=this.bboxes;for(const j of w)if(!l.box[j]){l.box[j]=!0;const X=4*j,ce=this.boxKeys[j];if(A<=B[X+2]&&E<=B[X+3]&&F>=B[X+0]&&O>=B[X+1]&&(!r||r(ce))&&(!d||!te(_,ce.overlapMode))&&(s.push({key:ce,x1:B[X],y1:B[X+1],x2:B[X+2],y2:B[X+3]}),d))return!0}}const T=this.circleCells[y];if(T!==null){const B=this.circles;for(const j of T)if(!l.circle[j]){l.circle[j]=!0;const X=3*j,ce=this.circleKeys[j];if(this._circleAndRectCollide(B[X],B[X+1],B[X+2],A,E,F,O)&&(!r||r(ce))&&(!d||!te(_,ce.overlapMode))){const Se=B[X],Te=B[X+1],Re=B[X+2];if(s.push({key:ce,x1:Se-Re,y1:Te-Re,x2:Se+Re,y2:Te+Re}),d)return!0}}}return!1}_queryCellCircle(A,E,F,O,y,s,i,r){const{circle:l,seenUids:d,overlapMode:_}=i,w=this.boxCells[y];if(w!==null){const B=this.bboxes;for(const j of w)if(!d.box[j]){d.box[j]=!0;const X=4*j,ce=this.boxKeys[j];if(this._circleAndRectCollide(l.x,l.y,l.radius,B[X+0],B[X+1],B[X+2],B[X+3])&&(!r||r(ce))&&!te(_,ce.overlapMode))return s.push(!0),!0}}const T=this.circleCells[y];if(T!==null){const B=this.circles;for(const j of T)if(!d.circle[j]){d.circle[j]=!0;const X=3*j,ce=this.circleKeys[j];if(this._circlesCollide(B[X],B[X+1],B[X+2],l.x,l.y,l.radius)&&(!r||r(ce))&&!te(_,ce.overlapMode))return s.push(!0),!0}}}_forEachCell(A,E,F,O,y,s,i,r){const l=this._convertToXCellCoord(A),d=this._convertToYCellCoord(E),_=this._convertToXCellCoord(F),w=this._convertToYCellCoord(O);for(let T=l;T<=_;T++)for(let B=d;B<=w;B++)if(y.call(this,A,E,F,O,this.xCellCount*B+T,s,i,r))return}_convertToXCellCoord(A){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(A*this.xScale)))}_convertToYCellCoord(A){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(A*this.yScale)))}_circlesCollide(A,E,F,O,y,s){const i=O-A,r=y-E,l=F+s;return l*l>i*i+r*r}_circleAndRectCollide(A,E,F,O,y,s,i){const r=(s-O)/2,l=Math.abs(A-(O+r));if(l>r+F)return!1;const d=(i-y)/2,_=Math.abs(E-(y+d));if(_>d+F)return!1;if(l<=r||_<=d)return!0;const w=l-r,T=_-d;return w*w+T*T<=F*F}}function ve(Z,A,E,F,O){const y=a.Z();return A?(a.a0(y,y,[1/O,1/O,1]),E||a.ae(y,y,F.angle)):a.a1(y,F.labelPlaneMatrix,Z),y}function Ie(Z,A,E,F,O){if(A){const y=a.af(Z);return a.a0(y,y,[O,O,1]),E||a.ae(y,y,-F.angle),y}return F.glCoordMatrix}function Ee(Z,A,E){let F;E?(F=[Z.x,Z.y,E(Z.x,Z.y),1],a.ag(F,F,A)):(F=[Z.x,Z.y,0,1],ye(F,F,A));const O=F[3];return{point:new a.P(F[0]/O,F[1]/O),signedDistanceFromCamera:O}}function ze(Z,A){return .5+Z/A*.5}function We(Z,A){const E=Z[0]/Z[3],F=Z[1]/Z[3];return E>=-A[0]&&E<=A[0]&&F>=-A[1]&&F<=A[1]}function He(Z,A,E,F,O,y,s,i,r,l){const d=F?Z.textSizeData:Z.iconSizeData,_=a.ah(d,E.transform.zoom),w=[256/E.width*2+1,256/E.height*2+1],T=F?Z.text.dynamicLayoutVertexArray:Z.icon.dynamicLayoutVertexArray;T.clear();const B=Z.lineVertexArray,j=F?Z.text.placedSymbolArray:Z.icon.placedSymbolArray,X=E.transform.width/E.transform.height;let ce=!1;for(let Se=0;Se<j.length;Se++){const Te=j.get(Se);if(Te.hidden||Te.writingMode===a.ai.vertical&&!ce){de(Te.numGlyphs,T);continue}let Re;if(ce=!1,l?(Re=[Te.anchorX,Te.anchorY,l(Te.anchorX,Te.anchorY),1],a.ag(Re,Re,A)):(Re=[Te.anchorX,Te.anchorY,0,1],ye(Re,Re,A)),!We(Re,w)){de(Te.numGlyphs,T);continue}const Be=ze(E.transform.cameraToCenterDistance,Re[3]),Ke=a.aj(d,_,Te),yt=s?Ke/Be:Ke*Be,ot=new a.P(Te.anchorX,Te.anchorY),ct=Ee(ot,O,l).point,It={projections:{},offsets:{}},bt=ft(Te,yt,!1,i,A,O,y,Z.glyphOffsetArray,B,T,ct,ot,It,X,r,l);ce=bt.useVertical,(bt.notEnoughRoom||ce||bt.needsFlipping&&ft(Te,yt,!0,i,A,O,y,Z.glyphOffsetArray,B,T,ct,ot,It,X,r,l).notEnoughRoom)&&de(Te.numGlyphs,T)}F?Z.text.dynamicLayoutVertexBuffer.updateData(T):Z.icon.dynamicLayoutVertexBuffer.updateData(T)}function Qe(Z,A,E,F,O,y,s,i,r,l,d,_,w){const T=i.glyphStartIndex+i.numGlyphs,B=i.lineStartIndex,j=i.lineStartIndex+i.lineLength,X=A.getoffsetX(i.glyphStartIndex),ce=A.getoffsetX(T-1),Se=$(Z*X,E,F,O,y,s,i.segment,B,j,r,l,d,_,w);if(!Se)return null;const Te=$(Z*ce,E,F,O,y,s,i.segment,B,j,r,l,d,_,w);return Te?{first:Se,last:Te}:null}function Ue(Z,A,E,F){return Z===a.ai.horizontal&&Math.abs(E.y-A.y)>Math.abs(E.x-A.x)*F?{useVertical:!0}:(Z===a.ai.vertical?A.y<E.y:A.x>E.x)?{needsFlipping:!0}:null}function ft(Z,A,E,F,O,y,s,i,r,l,d,_,w,T,B,j){const X=A/24,ce=Z.lineOffsetX*X,Se=Z.lineOffsetY*X;let Te;if(Z.numGlyphs>1){const Re=Z.glyphStartIndex+Z.numGlyphs,Be=Z.lineStartIndex,Ke=Z.lineStartIndex+Z.lineLength,yt=Qe(X,i,ce,Se,E,d,_,Z,r,y,w,B,j);if(!yt)return{notEnoughRoom:!0};const ot=Ee(yt.first.point,s,j).point,ct=Ee(yt.last.point,s,j).point;if(F&&!E){const It=Ue(Z.writingMode,ot,ct,T);if(It)return It}Te=[yt.first];for(let It=Z.glyphStartIndex+1;It<Re-1;It++)Te.push($(X*i.getoffsetX(It),ce,Se,E,d,_,Z.segment,Be,Ke,r,y,w,B,j));Te.push(yt.last)}else{if(F&&!E){const Be=Ee(_,O,j).point,Ke=Z.lineStartIndex+Z.segment+1,yt=new a.P(r.getx(Ke),r.gety(Ke)),ot=Ee(yt,O,j),ct=ot.signedDistanceFromCamera>0?ot.point:st(_,yt,Be,1,O,j),It=Ue(Z.writingMode,Be,ct,T);if(It)return It}const Re=$(X*i.getoffsetX(Z.glyphStartIndex),ce,Se,E,d,_,Z.segment,Z.lineStartIndex,Z.lineStartIndex+Z.lineLength,r,y,w,B,j);if(!Re)return{notEnoughRoom:!0};Te=[Re]}for(const Re of Te)a.ak(l,Re.point,Re.angle);return{}}function st(Z,A,E,F,O,y){const s=Ee(Z.add(Z.sub(A)._unit()),O,y).point,i=E.sub(s);return E.add(i._mult(F/i.mag()))}function Me(Z,A){const{projectionCache:E,lineVertexArray:F,labelPlaneMatrix:O,tileAnchorPoint:y,distanceFromAnchor:s,getElevation:i,previousVertex:r,direction:l,absOffsetX:d}=A;if(E.projections[Z])return E.projections[Z];const _=new a.P(F.getx(Z),F.gety(Z)),w=Ee(_,O,i);if(w.signedDistanceFromCamera>0)return E.projections[Z]=w.point,w.point;const T=Z-l;return st(s===0?y:new a.P(F.getx(T),F.gety(T)),_,r,d-s+1,O,i)}function se(Z,A,E){return Z._unit()._perp()._mult(A*E)}function ne(Z,A,E,F,O,y,s,i){const{projectionCache:r,direction:l}=i;if(r.offsets[Z])return r.offsets[Z];const d=E.add(A);if(Z+l<F||Z+l>=O)return r.offsets[Z]=d,d;const _=Me(Z+l,i),w=se(_.sub(E),s,l),T=E.add(w),B=_.add(w);return r.offsets[Z]=a.al(y,d,T,B)||d,r.offsets[Z]}function $(Z,A,E,F,O,y,s,i,r,l,d,_,w,T){const B=F?Z-A:Z+A;let j=B>0?1:-1,X=0;F&&(j*=-1,X=Math.PI),j<0&&(X+=Math.PI);let ce,Se,Te=j>0?i+s:i+s+1,Re=O,Be=O,Ke=0,yt=0;const ot=Math.abs(B),ct=[];let It;for(;Ke+yt<=ot;){if(Te+=j,Te<i||Te>=r)return null;Ke+=yt,Be=Re,Se=ce;const Xt={projectionCache:_,lineVertexArray:l,labelPlaneMatrix:d,tileAnchorPoint:y,distanceFromAnchor:Ke,getElevation:T,previousVertex:Be,direction:j,absOffsetX:ot};if(Re=Me(Te,Xt),E===0)ct.push(Be),It=Re.sub(Be);else{let ti;const si=Re.sub(Be);ti=si.mag()===0?se(Me(Te+j,Xt).sub(Re),E,j):se(si,E,j),Se||(Se=Be.add(ti)),ce=ne(Te,ti,Re,i,r,Se,E,Xt),ct.push(Se),It=ce.sub(Se)}yt=It.mag()}const bt=It._mult((ot-Ke)/yt)._add(Se||Be),ri=X+Math.atan2(Re.y-Be.y,Re.x-Be.x);return ct.push(bt),{point:bt,angle:w?ri:0,path:ct}}const ie=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function de(Z,A){for(let E=0;E<Z;E++){const F=A.length;A.resize(F+4),A.float32.set(ie,3*F)}}function ye(Z,A,E){const F=A[0],O=A[1];return Z[0]=E[0]*F+E[4]*O+E[12],Z[1]=E[1]*F+E[5]*O+E[13],Z[3]=E[3]*F+E[7]*O+E[15],Z}const ge=100;class Pe{constructor(A,E=new fe(A.width+200,A.height+200,25),F=new fe(A.width+200,A.height+200,25)){this.transform=A,this.grid=E,this.ignoredGrid=F,this.pitchfactor=Math.cos(A._pitch)*A.cameraToCenterDistance,this.screenRightBoundary=A.width+ge,this.screenBottomBoundary=A.height+ge,this.gridRightBoundary=A.width+200,this.gridBottomBoundary=A.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(A,E,F,O,y,s){const i=this.projectAndGetPerspectiveRatio(O,A.anchorPointX,A.anchorPointY,s),r=F*i.perspectiveRatio,l=A.x1*r+i.point.x,d=A.y1*r+i.point.y,_=A.x2*r+i.point.x,w=A.y2*r+i.point.y;return!this.isInsideGrid(l,d,_,w)||E!=="always"&&this.grid.hitTest(l,d,_,w,E,y)||i.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[l,d,_,w],offscreen:this.isOffscreen(l,d,_,w)}}placeCollisionCircles(A,E,F,O,y,s,i,r,l,d,_,w,T,B){const j=[],X=new a.P(E.anchorX,E.anchorY),ce=Ee(X,s,B),Se=ze(this.transform.cameraToCenterDistance,ce.signedDistanceFromCamera),Te=(d?y/Se:y*Se)/a.ap,Re=Ee(X,i,B).point,Be=Qe(Te,O,E.lineOffsetX*Te,E.lineOffsetY*Te,!1,Re,X,E,F,i,{projections:{},offsets:{}},!1,B);let Ke=!1,yt=!1,ot=!0;if(Be){const ct=.5*w*Se+T,It=new a.P(-100,-100),bt=new a.P(this.screenRightBoundary,this.screenBottomBoundary),ri=new Y,Xt=Be.first,ti=Be.last;let si=[];for(let Ei=Xt.path.length-1;Ei>=1;Ei--)si.push(Xt.path[Ei]);for(let Ei=1;Ei<ti.path.length;Ei++)si.push(ti.path[Ei]);const Qi=2.5*ct;if(r){const Ei=si.map(Gi=>Ee(Gi,r,B));si=Ei.some(Gi=>Gi.signedDistanceFromCamera<=0)?[]:Ei.map(Gi=>Gi.point)}let Wi=[];if(si.length>0){const Ei=si[0].clone(),Gi=si[0].clone();for(let qi=1;qi<si.length;qi++)Ei.x=Math.min(Ei.x,si[qi].x),Ei.y=Math.min(Ei.y,si[qi].y),Gi.x=Math.max(Gi.x,si[qi].x),Gi.y=Math.max(Gi.y,si[qi].y);Wi=Ei.x>=It.x&&Gi.x<=bt.x&&Ei.y>=It.y&&Gi.y<=bt.y?[si]:Gi.x<It.x||Ei.x>bt.x||Gi.y<It.y||Ei.y>bt.y?[]:a.am([si],It.x,It.y,bt.x,bt.y)}for(const Ei of Wi){ri.reset(Ei,.25*ct);let Gi=0;Gi=ri.length<=.5*ct?1:Math.ceil(ri.paddedLength/Qi)+1;for(let qi=0;qi<Gi;qi++){const cn=qi/Math.max(Gi-1,1),zn=ri.lerp(cn),tn=zn.x+ge,kn=zn.y+ge;j.push(tn,kn,ct,0);const yr=tn-ct,er=kn-ct,Ia=tn+ct,Aa=kn+ct;if(ot=ot&&this.isOffscreen(yr,er,Ia,Aa),yt=yt||this.isInsideGrid(yr,er,Ia,Aa),A!=="always"&&this.grid.hitTestCircle(tn,kn,ct,A,_)&&(Ke=!0,!l))return{circles:[],offscreen:!1,collisionDetected:Ke}}}}return{circles:!l&&Ke||!yt||Se<this.perspectiveRatioCutoff?[]:j,offscreen:ot,collisionDetected:Ke}}queryRenderedSymbols(A){if(A.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const E=[];let F=1/0,O=1/0,y=-1/0,s=-1/0;for(const d of A){const _=new a.P(d.x+ge,d.y+ge);F=Math.min(F,_.x),O=Math.min(O,_.y),y=Math.max(y,_.x),s=Math.max(s,_.y),E.push(_)}const i=this.grid.query(F,O,y,s).concat(this.ignoredGrid.query(F,O,y,s)),r={},l={};for(const d of i){const _=d.key;if(r[_.bucketInstanceId]===void 0&&(r[_.bucketInstanceId]={}),r[_.bucketInstanceId][_.featureIndex])continue;const w=[new a.P(d.x1,d.y1),new a.P(d.x2,d.y1),new a.P(d.x2,d.y2),new a.P(d.x1,d.y2)];a.an(E,w)&&(r[_.bucketInstanceId][_.featureIndex]=!0,l[_.bucketInstanceId]===void 0&&(l[_.bucketInstanceId]=[]),l[_.bucketInstanceId].push(_.featureIndex))}return l}insertCollisionBox(A,E,F,O,y,s){(F?this.ignoredGrid:this.grid).insert({bucketInstanceId:O,featureIndex:y,collisionGroupID:s,overlapMode:E},A[0],A[1],A[2],A[3])}insertCollisionCircles(A,E,F,O,y,s){const i=F?this.ignoredGrid:this.grid,r={bucketInstanceId:O,featureIndex:y,collisionGroupID:s,overlapMode:E};for(let l=0;l<A.length;l+=4)i.insertCircle(r,A[l],A[l+1],A[l+2])}projectAndGetPerspectiveRatio(A,E,F,O){let y;return O?(y=[E,F,O(E,F),1],a.ag(y,y,A)):(y=[E,F,0,1],ye(y,y,A)),{point:new a.P((y[0]/y[3]+1)/2*this.transform.width+ge,(-y[1]/y[3]+1)/2*this.transform.height+ge),perspectiveRatio:.5+this.transform.cameraToCenterDistance/y[3]*.5}}isOffscreen(A,E,F,O){return F<ge||A>=this.screenRightBoundary||O<ge||E>this.screenBottomBoundary}isInsideGrid(A,E,F,O){return F>=0&&A<this.gridRightBoundary&&O>=0&&E<this.gridBottomBoundary}getViewportMatrix(){const A=a.ao([]);return a.$(A,A,[-100,-100,0]),A}}function Fe(Z,A,E){return A*(a.N/(Z.tileSize*Math.pow(2,E-Z.tileID.overscaledZ)))}class Ve{constructor(A,E,F,O){this.opacity=A?Math.max(0,Math.min(1,A.opacity+(A.placed?E:-E))):O&&F?1:0,this.placed=F}isHidden(){return this.opacity===0&&!this.placed}}class Xe{constructor(A,E,F,O,y){this.text=new Ve(A?A.text:null,E,F,y),this.icon=new Ve(A?A.icon:null,E,O,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ye{constructor(A,E,F){this.text=A,this.icon=E,this.skipFade=F}}class De{constructor(){this.invProjMatrix=a.Z(),this.viewportMatrix=a.Z(),this.circles=[]}}class Ge{constructor(A,E,F,O,y){this.bucketInstanceId=A,this.featureIndex=E,this.sourceLayerIndex=F,this.bucketIndex=O,this.tileID=y}}class ht{constructor(A){this.crossSourceCollisions=A,this.maxGroupID=0,this.collisionGroups={}}get(A){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[A]){const E=++this.maxGroupID;this.collisionGroups[A]={ID:E,predicate:F=>F.collisionGroupID===E}}return this.collisionGroups[A]}}function kt(Z,A,E,F,O){const{horizontalAlign:y,verticalAlign:s}=a.au(Z);return new a.P(-(y-.5)*A+F[0]*O,-(s-.5)*E+F[1]*O)}function o(Z,A,E,F,O,y){const{x1:s,x2:i,y1:r,y2:l,anchorPointX:d,anchorPointY:_}=Z,w=new a.P(A,E);return F&&w._rotate(O?y:-y),{x1:s+w.x,y1:r+w.y,x2:i+w.x,y2:l+w.y,anchorPointX:d,anchorPointY:_}}class ke{constructor(A,E,F,O,y){this.transform=A.clone(),this.terrain=E,this.collisionIndex=new Pe(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=F,this.retainedQueryData={},this.collisionGroups=new ht(O),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(A,E,F,O){const y=F.getBucket(E),s=F.latestFeatureIndex;if(!y||!s||E.id!==y.layerIds[0])return;const i=F.collisionBoxArray,r=y.layers[0].layout,l=Math.pow(2,this.transform.zoom-F.tileID.overscaledZ),d=F.tileSize/a.N,_=this.transform.calculatePosMatrix(F.tileID.toUnwrapped()),w=r.get("text-pitch-alignment")==="map",T=r.get("text-rotation-alignment")==="map",B=Fe(F,1,this.transform.zoom),j=ve(_,w,T,this.transform,B);let X=null;if(w){const Se=Ie(_,w,T,this.transform,B);X=a.a1([],this.transform.labelPlaneMatrix,Se)}this.retainedQueryData[y.bucketInstanceId]=new Ge(y.bucketInstanceId,s,y.sourceLayerIndex,y.index,F.tileID);const ce={bucket:y,layout:r,posMatrix:_,textLabelPlaneMatrix:j,labelToScreenMatrix:X,scale:l,textPixelRatio:d,holdingForFade:F.holdingForFade(),collisionBoxArray:i,partiallyEvaluatedTextSize:a.ah(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(O)for(const Se of y.sortKeyRanges){const{sortKey:Te,symbolInstanceStart:Re,symbolInstanceEnd:Be}=Se;A.push({sortKey:Te,symbolInstanceStart:Re,symbolInstanceEnd:Be,parameters:ce})}else A.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:ce})}attemptAnchorPlacement(A,E,F,O,y,s,i,r,l,d,_,w,T,B,j,X){const ce=a.aq[A.textAnchor],Se=[A.textOffset0,A.textOffset1],Te=kt(ce,F,O,Se,y),Re=this.collisionIndex.placeCollisionBox(o(E,Te.x,Te.y,s,i,this.transform.angle),_,r,l,d.predicate,X);if((!j||this.collisionIndex.placeCollisionBox(o(j,Te.x,Te.y,s,i,this.transform.angle),_,r,l,d.predicate,X).box.length!==0)&&Re.box.length>0){let Be;if(this.prevPlacement&&this.prevPlacement.variableOffsets[w.crossTileID]&&this.prevPlacement.placements[w.crossTileID]&&this.prevPlacement.placements[w.crossTileID].text&&(Be=this.prevPlacement.variableOffsets[w.crossTileID].anchor),w.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[w.crossTileID]={textOffset:Se,width:F,height:O,anchor:ce,textBoxScale:y,prevAnchor:Be},this.markUsedJustification(T,ce,w,B),T.allowVerticalPlacement&&(this.markUsedOrientation(T,B,w),this.placedOrientations[w.crossTileID]=B),{shift:Te,placedGlyphBoxes:Re}}}placeLayerBucketPart(A,E,F){const{bucket:O,layout:y,posMatrix:s,textLabelPlaneMatrix:i,labelToScreenMatrix:r,textPixelRatio:l,holdingForFade:d,collisionBoxArray:_,partiallyEvaluatedTextSize:w,collisionGroup:T}=A.parameters,B=y.get("text-optional"),j=y.get("icon-optional"),X=a.ar(y,"text-overlap","text-allow-overlap"),ce=X==="always",Se=a.ar(y,"icon-overlap","icon-allow-overlap"),Te=Se==="always",Re=y.get("text-rotation-alignment")==="map",Be=y.get("text-pitch-alignment")==="map",Ke=y.get("icon-text-fit")!=="none",yt=y.get("symbol-z-order")==="viewport-y",ot=ce&&(Te||!O.hasIconData()||j),ct=Te&&(ce||!O.hasTextData()||B);!O.collisionArrays&&_&&O.deserializeCollisionBoxes(_);const It=this.retainedQueryData[O.bucketInstanceId].tileID,bt=this.terrain?(Xt,ti)=>this.terrain.getElevation(It,Xt,ti):null,ri=(Xt,ti)=>{var si,Qi;if(E[Xt.crossTileID])return;if(d)return void(this.placements[Xt.crossTileID]=new Ye(!1,!1,!1));let Wi=!1,Ei=!1,Gi=!0,qi=null,cn={box:null,offscreen:null},zn={box:null,offscreen:null},tn=null,kn=null,yr=null,er=0,Ia=0,Aa=0;ti.textFeatureIndex?er=ti.textFeatureIndex:Xt.useRuntimeCollisionCircles&&(er=Xt.featureIndex),ti.verticalTextFeatureIndex&&(Ia=ti.verticalTextFeatureIndex);const zs=ti.textBox;if(zs){const qr=Qs=>{let ts=a.ai.horizontal;if(O.allowVerticalPlacement&&!Qs&&this.prevPlacement){const is=this.prevPlacement.placedOrientations[Xt.crossTileID];is&&(this.placedOrientations[Xt.crossTileID]=is,ts=is,this.markUsedOrientation(O,ts,Xt))}return ts},ya=(Qs,ts)=>{if(O.allowVerticalPlacement&&Xt.numVerticalGlyphVertices>0&&ti.verticalTextBox){for(const is of O.writingModes)if(is===a.ai.vertical?(cn=ts(),zn=cn):cn=Qs(),cn&&cn.box&&cn.box.length)break}else cn=Qs()},xo=Xt.textAnchorOffsetStartIndex,bo=Xt.textAnchorOffsetEndIndex;if(bo===xo){const Qs=(ts,is)=>{const Rr=this.collisionIndex.placeCollisionBox(ts,X,l,s,T.predicate,bt);return Rr&&Rr.box&&Rr.box.length&&(this.markUsedOrientation(O,is,Xt),this.placedOrientations[Xt.crossTileID]=is),Rr};ya(()=>Qs(zs,a.ai.horizontal),()=>{const ts=ti.verticalTextBox;return O.allowVerticalPlacement&&Xt.numVerticalGlyphVertices>0&&ts?Qs(ts,a.ai.vertical):{box:null,offscreen:null}}),qr(cn&&cn.box&&cn.box.length)}else{let Qs=a.aq[(Qi=(si=this.prevPlacement)===null||si===void 0?void 0:si.variableOffsets[Xt.crossTileID])===null||Qi===void 0?void 0:Qi.anchor];const ts=(Rr,bs,Ws)=>{const Do=Rr.x2-Rr.x1,Uo=Rr.y2-Rr.y1,Go=Xt.textBoxScale,Ic=Ke&&Se==="never"?bs:null;let $s={box:[],offscreen:!1},Xl=X==="never"?1:2,hu="never";Qs&&Xl++;for(let il=0;il<Xl;il++){for(let vl=xo;vl<bo;vl++){const Pl=O.textAnchorOffsets.get(vl);if(Qs&&Pl.textAnchor!==Qs)continue;const Au=this.attemptAnchorPlacement(Pl,Rr,Do,Uo,Go,Re,Be,l,s,T,hu,Xt,O,Ws,Ic,bt);if(Au&&($s=Au.placedGlyphBoxes,$s&&$s.box&&$s.box.length))return Wi=!0,qi=Au.shift,$s}Qs?Qs=null:hu=X}return $s};ya(()=>ts(zs,ti.iconBox,a.ai.horizontal),()=>{const Rr=ti.verticalTextBox;return O.allowVerticalPlacement&&!(cn&&cn.box&&cn.box.length)&&Xt.numVerticalGlyphVertices>0&&Rr?ts(Rr,ti.verticalIconBox,a.ai.vertical):{box:null,offscreen:null}}),cn&&(Wi=cn.box,Gi=cn.offscreen);const is=qr(cn&&cn.box);if(!Wi&&this.prevPlacement){const Rr=this.prevPlacement.variableOffsets[Xt.crossTileID];Rr&&(this.variableOffsets[Xt.crossTileID]=Rr,this.markUsedJustification(O,Rr.anchor,Xt,is))}}}if(tn=cn,Wi=tn&&tn.box&&tn.box.length>0,Gi=tn&&tn.offscreen,Xt.useRuntimeCollisionCircles){const qr=O.text.placedSymbolArray.get(Xt.centerJustifiedTextSymbolIndex),ya=a.aj(O.textSizeData,w,qr),xo=y.get("text-padding");kn=this.collisionIndex.placeCollisionCircles(X,qr,O.lineVertexArray,O.glyphOffsetArray,ya,s,i,r,F,Be,T.predicate,Xt.collisionCircleDiameter,xo,bt),kn.circles.length&&kn.collisionDetected&&!F&&a.w("Collisions detected, but collision boxes are not shown"),Wi=ce||kn.circles.length>0&&!kn.collisionDetected,Gi=Gi&&kn.offscreen}if(ti.iconFeatureIndex&&(Aa=ti.iconFeatureIndex),ti.iconBox){const qr=ya=>{const xo=Ke&&qi?o(ya,qi.x,qi.y,Re,Be,this.transform.angle):ya;return this.collisionIndex.placeCollisionBox(xo,Se,l,s,T.predicate,bt)};zn&&zn.box&&zn.box.length&&ti.verticalIconBox?(yr=qr(ti.verticalIconBox),Ei=yr.box.length>0):(yr=qr(ti.iconBox),Ei=yr.box.length>0),Gi=Gi&&yr.offscreen}const oo=B||Xt.numHorizontalGlyphVertices===0&&Xt.numVerticalGlyphVertices===0,lo=j||Xt.numIconVertices===0;if(oo||lo?lo?oo||(Ei=Ei&&Wi):Wi=Ei&&Wi:Ei=Wi=Ei&&Wi,Wi&&tn&&tn.box&&this.collisionIndex.insertCollisionBox(tn.box,X,y.get("text-ignore-placement"),O.bucketInstanceId,zn&&zn.box&&Ia?Ia:er,T.ID),Ei&&yr&&this.collisionIndex.insertCollisionBox(yr.box,Se,y.get("icon-ignore-placement"),O.bucketInstanceId,Aa,T.ID),kn&&(Wi&&this.collisionIndex.insertCollisionCircles(kn.circles,X,y.get("text-ignore-placement"),O.bucketInstanceId,er,T.ID),F)){const qr=O.bucketInstanceId;let ya=this.collisionCircleArrays[qr];ya===void 0&&(ya=this.collisionCircleArrays[qr]=new De);for(let xo=0;xo<kn.circles.length;xo+=4)ya.circles.push(kn.circles[xo+0]),ya.circles.push(kn.circles[xo+1]),ya.circles.push(kn.circles[xo+2]),ya.circles.push(kn.collisionDetected?1:0)}if(Xt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(O.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Xt.crossTileID]=new Ye(Wi||ot,Ei||ct,Gi||O.justReloaded),E[Xt.crossTileID]=!0};if(yt){if(A.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Xt=O.getSortedSymbolIndexes(this.transform.angle);for(let ti=Xt.length-1;ti>=0;--ti){const si=Xt[ti];ri(O.symbolInstances.get(si),O.collisionArrays[si])}}else for(let Xt=A.symbolInstanceStart;Xt<A.symbolInstanceEnd;Xt++)ri(O.symbolInstances.get(Xt),O.collisionArrays[Xt]);if(F&&O.bucketInstanceId in this.collisionCircleArrays){const Xt=this.collisionCircleArrays[O.bucketInstanceId];a.as(Xt.invProjMatrix,s),Xt.viewportMatrix=this.collisionIndex.getViewportMatrix()}O.justReloaded=!1}markUsedJustification(A,E,F,O){let y;y=O===a.ai.vertical?F.verticalPlacedTextSymbolIndex:{left:F.leftJustifiedTextSymbolIndex,center:F.centerJustifiedTextSymbolIndex,right:F.rightJustifiedTextSymbolIndex}[a.at(E)];const s=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex,F.verticalPlacedTextSymbolIndex];for(const i of s)i>=0&&(A.text.placedSymbolArray.get(i).crossTileID=y>=0&&i!==y?0:F.crossTileID)}markUsedOrientation(A,E,F){const O=E===a.ai.horizontal||E===a.ai.horizontalOnly?E:0,y=E===a.ai.vertical?E:0,s=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex];for(const i of s)A.text.placedSymbolArray.get(i).placedOrientation=O;F.verticalPlacedTextSymbolIndex&&(A.text.placedSymbolArray.get(F.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(A){this.commitTime=A,this.zoomAtLastRecencyCheck=this.transform.zoom;const E=this.prevPlacement;let F=!1;this.prevZoomAdjustment=E?E.zoomAdjustment(this.transform.zoom):0;const O=E?E.symbolFadeChange(A):1,y=E?E.opacities:{},s=E?E.variableOffsets:{},i=E?E.placedOrientations:{};for(const r in this.placements){const l=this.placements[r],d=y[r];d?(this.opacities[r]=new Xe(d,O,l.text,l.icon),F=F||l.text!==d.text.placed||l.icon!==d.icon.placed):(this.opacities[r]=new Xe(null,O,l.text,l.icon,l.skipFade),F=F||l.text||l.icon)}for(const r in y){const l=y[r];if(!this.opacities[r]){const d=new Xe(l,O,!1,!1);d.isHidden()||(this.opacities[r]=d,F=F||l.text.placed||l.icon.placed)}}for(const r in s)this.variableOffsets[r]||!this.opacities[r]||this.opacities[r].isHidden()||(this.variableOffsets[r]=s[r]);for(const r in i)this.placedOrientations[r]||!this.opacities[r]||this.opacities[r].isHidden()||(this.placedOrientations[r]=i[r]);if(E&&E.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");F?this.lastPlacementChangeTime=A:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=E?E.lastPlacementChangeTime:A)}updateLayerOpacities(A,E){const F={};for(const O of E){const y=O.getBucket(A);y&&O.latestFeatureIndex&&A.id===y.layerIds[0]&&this.updateBucketOpacities(y,F,O.collisionBoxArray)}}updateBucketOpacities(A,E,F){A.hasTextData()&&(A.text.opacityVertexArray.clear(),A.text.hasVisibleVertices=!1),A.hasIconData()&&(A.icon.opacityVertexArray.clear(),A.icon.hasVisibleVertices=!1),A.hasIconCollisionBoxData()&&A.iconCollisionBox.collisionVertexArray.clear(),A.hasTextCollisionBoxData()&&A.textCollisionBox.collisionVertexArray.clear();const O=A.layers[0],y=O.layout,s=new Xe(null,0,!1,!1,!0),i=y.get("text-allow-overlap"),r=y.get("icon-allow-overlap"),l=O._unevaluatedLayout.hasValue("text-variable-anchor")||O._unevaluatedLayout.hasValue("text-variable-anchor-offset"),d=y.get("text-rotation-alignment")==="map",_=y.get("text-pitch-alignment")==="map",w=y.get("icon-text-fit")!=="none",T=new Xe(null,0,i&&(r||!A.hasIconData()||y.get("icon-optional")),r&&(i||!A.hasTextData()||y.get("text-optional")),!0);!A.collisionArrays&&F&&(A.hasIconCollisionBoxData()||A.hasTextCollisionBoxData())&&A.deserializeCollisionBoxes(F);const B=(j,X,ce)=>{for(let Se=0;Se<X/4;Se++)j.opacityVertexArray.emplaceBack(ce);j.hasVisibleVertices=j.hasVisibleVertices||ce!==bn};for(let j=0;j<A.symbolInstances.length;j++){const X=A.symbolInstances.get(j),{numHorizontalGlyphVertices:ce,numVerticalGlyphVertices:Se,crossTileID:Te}=X;let Re=this.opacities[Te];E[Te]?Re=s:Re||(Re=T,this.opacities[Te]=Re),E[Te]=!0;const Be=X.numIconVertices>0,Ke=this.placedOrientations[X.crossTileID],yt=Ke===a.ai.vertical,ot=Ke===a.ai.horizontal||Ke===a.ai.horizontalOnly;if(ce>0||Se>0){const ct=Yt(Re.text);B(A.text,ce,yt?bn:ct),B(A.text,Se,ot?bn:ct);const It=Re.text.isHidden();[X.rightJustifiedTextSymbolIndex,X.centerJustifiedTextSymbolIndex,X.leftJustifiedTextSymbolIndex].forEach(Xt=>{Xt>=0&&(A.text.placedSymbolArray.get(Xt).hidden=It||yt?1:0)}),X.verticalPlacedTextSymbolIndex>=0&&(A.text.placedSymbolArray.get(X.verticalPlacedTextSymbolIndex).hidden=It||ot?1:0);const bt=this.variableOffsets[X.crossTileID];bt&&this.markUsedJustification(A,bt.anchor,X,Ke);const ri=this.placedOrientations[X.crossTileID];ri&&(this.markUsedJustification(A,"left",X,ri),this.markUsedOrientation(A,ri,X))}if(Be){const ct=Yt(Re.icon),It=!(w&&X.verticalPlacedIconSymbolIndex&&yt);X.placedIconSymbolIndex>=0&&(B(A.icon,X.numIconVertices,It?ct:bn),A.icon.placedSymbolArray.get(X.placedIconSymbolIndex).hidden=Re.icon.isHidden()),X.verticalPlacedIconSymbolIndex>=0&&(B(A.icon,X.numVerticalIconVertices,It?bn:ct),A.icon.placedSymbolArray.get(X.verticalPlacedIconSymbolIndex).hidden=Re.icon.isHidden())}if(A.hasIconCollisionBoxData()||A.hasTextCollisionBoxData()){const ct=A.collisionArrays[j];if(ct){let It=new a.P(0,0);if(ct.textBox||ct.verticalTextBox){let ri=!0;if(l){const Xt=this.variableOffsets[Te];Xt?(It=kt(Xt.anchor,Xt.width,Xt.height,Xt.textOffset,Xt.textBoxScale),d&&It._rotate(_?this.transform.angle:-this.transform.angle)):ri=!1}ct.textBox&&ai(A.textCollisionBox.collisionVertexArray,Re.text.placed,!ri||yt,It.x,It.y),ct.verticalTextBox&&ai(A.textCollisionBox.collisionVertexArray,Re.text.placed,!ri||ot,It.x,It.y)}const bt=!!(!ot&&ct.verticalIconBox);ct.iconBox&&ai(A.iconCollisionBox.collisionVertexArray,Re.icon.placed,bt,w?It.x:0,w?It.y:0),ct.verticalIconBox&&ai(A.iconCollisionBox.collisionVertexArray,Re.icon.placed,!bt,w?It.x:0,w?It.y:0)}}}if(A.sortFeatures(this.transform.angle),this.retainedQueryData[A.bucketInstanceId]&&(this.retainedQueryData[A.bucketInstanceId].featureSortOrder=A.featureSortOrder),A.hasTextData()&&A.text.opacityVertexBuffer&&A.text.opacityVertexBuffer.updateData(A.text.opacityVertexArray),A.hasIconData()&&A.icon.opacityVertexBuffer&&A.icon.opacityVertexBuffer.updateData(A.icon.opacityVertexArray),A.hasIconCollisionBoxData()&&A.iconCollisionBox.collisionVertexBuffer&&A.iconCollisionBox.collisionVertexBuffer.updateData(A.iconCollisionBox.collisionVertexArray),A.hasTextCollisionBoxData()&&A.textCollisionBox.collisionVertexBuffer&&A.textCollisionBox.collisionVertexBuffer.updateData(A.textCollisionBox.collisionVertexArray),A.text.opacityVertexArray.length!==A.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${A.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${A.text.layoutVertexArray.length}) / 4`);if(A.icon.opacityVertexArray.length!==A.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${A.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${A.icon.layoutVertexArray.length}) / 4`);if(A.bucketInstanceId in this.collisionCircleArrays){const j=this.collisionCircleArrays[A.bucketInstanceId];A.placementInvProjMatrix=j.invProjMatrix,A.placementViewportMatrix=j.viewportMatrix,A.collisionCircleArray=j.circles,delete this.collisionCircleArrays[A.bucketInstanceId]}}symbolFadeChange(A){return this.fadeDuration===0?1:(A-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(A){return Math.max(0,(this.transform.zoom-A)/1.5)}hasTransitions(A){return this.stale||A-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(A,E){const F=this.zoomAtLastRecencyCheck===E?1-this.zoomAdjustment(E):1;return this.zoomAtLastRecencyCheck=E,this.commitTime+this.fadeDuration*F>A}setStale(){this.stale=!0}}function ai(Z,A,E,F,O){Z.emplaceBack(A?1:0,E?1:0,F||0,O||0),Z.emplaceBack(A?1:0,E?1:0,F||0,O||0),Z.emplaceBack(A?1:0,E?1:0,F||0,O||0),Z.emplaceBack(A?1:0,E?1:0,F||0,O||0)}const fi=Math.pow(2,25),hi=Math.pow(2,24),Jt=Math.pow(2,17),oi=Math.pow(2,16),zi=Math.pow(2,9),xi=Math.pow(2,8),Si=Math.pow(2,1);function Yt(Z){if(Z.opacity===0&&!Z.placed)return 0;if(Z.opacity===1&&Z.placed)return 4294967295;const A=Z.placed?1:0,E=Math.floor(127*Z.opacity);return E*fi+A*hi+E*Jt+A*oi+E*zi+A*xi+E*Si+A}const bn=0;class or{constructor(A){this._sortAcrossTiles=A.layout.get("symbol-z-order")!=="viewport-y"&&!A.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(A,E,F,O,y){const s=this._bucketParts;for(;this._currentTileIndex<A.length;)if(E.getBucketParts(s,O,A[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,s.sort((i,r)=>i.sortKey-r.sortKey));this._currentPartIndex<s.length;)if(E.placeLayerBucketPart(s[this._currentPartIndex],this._seenCrossTileIDs,F),this._currentPartIndex++,y())return!0;return!1}}class mn{constructor(A,E,F,O,y,s,i,r){this.placement=new ke(A,E,s,i,r),this._currentPlacementIndex=F.length-1,this._forceFullPlacement=O,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(A,E,F){const O=a.h.now(),y=()=>!this._forceFullPlacement&&a.h.now()-O>2;for(;this._currentPlacementIndex>=0;){const s=E[A[this._currentPlacementIndex]],i=this.placement.collisionIndex.transform.zoom;if(s.type==="symbol"&&(!s.minzoom||s.minzoom<=i)&&(!s.maxzoom||s.maxzoom>i)){if(this._inProgressLayer||(this._inProgressLayer=new or(s)),this._inProgressLayer.continuePlacement(F[s.source],this.placement,this._showCollisionBoxes,s,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(A){return this.placement.commit(A),this.placement}}const qn=512/a.N/2;class jr{constructor(A,E,F){this.tileID=A,this.bucketInstanceId=F,this._symbolsByKey={};const O=new Map;for(let y=0;y<E.length;y++){const s=E.get(y),i=s.key,r=O.get(i);r?r.push(s):O.set(i,[s])}for(const[y,s]of O){const i={positions:s.map(r=>({x:Math.floor(r.anchorX*qn),y:Math.floor(r.anchorY*qn)})),crossTileIDs:s.map(r=>r.crossTileID)};if(i.positions.length>128){const r=new a.av(i.positions.length,16,Uint16Array);for(const{x:l,y:d}of i.positions)r.add(l,d);r.finish(),delete i.positions,i.index=r}this._symbolsByKey[y]=i}}getScaledCoordinates(A,E){const{x:F,y:O,z:y}=this.tileID.canonical,{x:s,y:i,z:r}=E.canonical,l=qn/Math.pow(2,r-y),d=(i*a.N+A.anchorY)*l,_=O*a.N*qn;return{x:Math.floor((s*a.N+A.anchorX)*l-F*a.N*qn),y:Math.floor(d-_)}}findMatches(A,E,F){const O=this.tileID.canonical.z<E.canonical.z?1:Math.pow(2,this.tileID.canonical.z-E.canonical.z);for(let y=0;y<A.length;y++){const s=A.get(y);if(s.crossTileID)continue;const i=this._symbolsByKey[s.key];if(!i)continue;const r=this.getScaledCoordinates(s,E);if(i.index){const l=i.index.range(r.x-O,r.y-O,r.x+O,r.y+O).sort();for(const d of l){const _=i.crossTileIDs[d];if(!F[_]){F[_]=!0,s.crossTileID=_;break}}}else if(i.positions)for(let l=0;l<i.positions.length;l++){const d=i.positions[l],_=i.crossTileIDs[l];if(Math.abs(d.x-r.x)<=O&&Math.abs(d.y-r.y)<=O&&!F[_]){F[_]=!0,s.crossTileID=_;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:A})=>A)}}class Zi{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ur{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(A){const E=Math.round((A-this.lng)/360);if(E!==0)for(const F in this.indexes){const O=this.indexes[F],y={};for(const s in O){const i=O[s];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+E),y[i.tileID.key]=i}this.indexes[F]=y}this.lng=A}addBucket(A,E,F){if(this.indexes[A.overscaledZ]&&this.indexes[A.overscaledZ][A.key]){if(this.indexes[A.overscaledZ][A.key].bucketInstanceId===E.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(A.overscaledZ,this.indexes[A.overscaledZ][A.key])}for(let y=0;y<E.symbolInstances.length;y++)E.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[A.overscaledZ]||(this.usedCrossTileIDs[A.overscaledZ]={});const O=this.usedCrossTileIDs[A.overscaledZ];for(const y in this.indexes){const s=this.indexes[y];if(Number(y)>A.overscaledZ)for(const i in s){const r=s[i];r.tileID.isChildOf(A)&&r.findMatches(E.symbolInstances,A,O)}else{const i=s[A.scaledTo(Number(y)).key];i&&i.findMatches(E.symbolInstances,A,O)}}for(let y=0;y<E.symbolInstances.length;y++){const s=E.symbolInstances.get(y);s.crossTileID||(s.crossTileID=F.generate(),O[s.crossTileID]=!0)}return this.indexes[A.overscaledZ]===void 0&&(this.indexes[A.overscaledZ]={}),this.indexes[A.overscaledZ][A.key]=new jr(A,E.symbolInstances,E.bucketInstanceId),!0}removeBucketCrossTileIDs(A,E){for(const F of E.getCrossTileIDsLists())for(const O of F)delete this.usedCrossTileIDs[A][O]}removeStaleBuckets(A){let E=!1;for(const F in this.indexes){const O=this.indexes[F];for(const y in O)A[O[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(F,O[y]),delete O[y],E=!0)}return E}}class Vn{constructor(){this.layerIndexes={},this.crossTileIDs=new Zi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(A,E,F){let O=this.layerIndexes[A.id];O===void 0&&(O=this.layerIndexes[A.id]=new ur);let y=!1;const s={};O.handleWrapJump(F);for(const i of E){const r=i.getBucket(A);r&&A.id===r.layerIds[0]&&(r.bucketInstanceId||(r.bucketInstanceId=++this.maxBucketInstanceId),O.addBucket(i.tileID,r,this.crossTileIDs)&&(y=!0),s[r.bucketInstanceId]=!0)}return O.removeStaleBuckets(s)&&(y=!0),y}pruneUnusedLayers(A){const E={};A.forEach(F=>{E[F]=!0});for(const F in this.layerIndexes)E[F]||delete this.layerIndexes[F]}}const Wt=(Z,A)=>a.x(Z,A&&A.filter(E=>E.identifier!=="source.canvas")),Ki=a.F(a.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Ut=a.F(a.ax,["setCenter","setZoom","setBearing","setPitch"]),Tn=a.aw();class cr extends a.E{constructor(A,E={}){super(),this.map=A,this.dispatcher=new wi(V(),this,A._getMapId()),this.imageManager=new Pt,this.imageManager.setEventedParent(this),this.glyphManager=new lt(A._requestManager,E.localIdeographFontFamily),this.lineAtlas=new gi(256,512),this.crossTileSymbolIndex=new Vn,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.az());const F=this;this._rtlTextPluginCallback=cr.registerForPluginStateChange(O=>{F.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:O.pluginStatus,pluginURL:O.pluginURL},(y,s)=>{if(a.aA(y),s&&s.every(i=>i))for(const i in F.sourceCaches){const r=F.sourceCaches[i].getSource().type;r!=="vector"&&r!=="geojson"||F.sourceCaches[i].reload()}})}),this.on("data",O=>{if(O.dataType!=="source"||O.sourceDataType!=="metadata")return;const y=this.sourceCaches[O.sourceId];if(!y)return;const s=y.getSource();if(s&&s.vectorLayerIds)for(const i in this._layers){const r=this._layers[i];r.source===s.id&&this._validateLayer(r)}})}loadURL(A,E={},F){this.fire(new a.k("dataloading",{dataType:"style"})),E.validate=typeof E.validate!="boolean"||E.validate;const O=this.map._requestManager.transformRequest(A,at.Style);this._request=a.f(O,(y,s)=>{this._request=null,y?this.fire(new a.j(y)):s&&this._load(s,E,F)})}loadJSON(A,E={},F){this.fire(new a.k("dataloading",{dataType:"style"})),this._request=a.h.frame(()=>{this._request=null,E.validate=E.validate!==!1,this._load(A,E,F)})}loadEmpty(){this.fire(new a.k("dataloading",{dataType:"style"})),this._load(Tn,{validate:!1})}_load(A,E,F){var O;const y=E.transformStyle?E.transformStyle(F,A):A;if(!E.validate||!Wt(this,a.y(y))){this._loaded=!0,this.stylesheet=y;for(const s in y.sources)this.addSource(s,y.sources[s],{validate:!1});y.sprite?this._loadSprite(y.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(y.glyphs),this._createLayers(),this.light=new Ot(this.stylesheet.light),this.map.setTerrain((O=this.stylesheet.terrain)!==null&&O!==void 0?O:null),this.fire(new a.k("data",{dataType:"style"})),this.fire(new a.k("style.load"))}}_createLayers(){const A=a.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",A),this._order=A.map(E=>E.id),this._layers={},this._serializedLayers=null;for(const E of A){const F=a.aC(E);F.setEventedParent(this,{layer:{id:E.id}}),this._layers[E.id]=F}}_loadSprite(A,E=!1,F=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(O,y,s,i){const r=it(O),l=r.length,d=s>1?"@2x":"",_={},w={},T={};for(const{id:B,url:j}of r){const X=y.transformRequest(y.normalizeSpriteURL(j,d,".json"),at.SpriteJSON),ce=`${B}_${X.url}`;_[ce]=a.f(X,(Re,Be)=>{delete _[ce],w[B]=Be,vt(i,w,T,Re,l)});const Se=y.transformRequest(y.normalizeSpriteURL(j,d,".png"),at.SpriteImage),Te=`${B}_${Se.url}`;_[Te]=tt.getImage(Se,(Re,Be)=>{delete _[Te],T[B]=Be,vt(i,w,T,Re,l)})}return{cancel(){for(const B of Object.values(_))B.cancel()}}}(A,this.map._requestManager,this.map.getPixelRatio(),(O,y)=>{if(this._spriteRequest=null,O)this.fire(new a.j(O));else if(y)for(const s in y){this._spritesImagesIds[s]=[];const i=this._spritesImagesIds[s]?this._spritesImagesIds[s].filter(r=>!(r in y)):[];for(const r of i)this.imageManager.removeImage(r),this._changedImages[r]=!0;for(const r in y[s]){const l=s==="default"?r:`${s}:${r}`;this._spritesImagesIds[s].push(l),l in this.imageManager.images?this.imageManager.updateImage(l,y[s][r],!1):this.imageManager.addImage(l,y[s][r]),E&&(this._changedImages[l]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),E&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"})),F&&F(O)})}_unloadSprite(){for(const A of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(A),this._changedImages[A]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}_validateLayer(A){const E=this.sourceCaches[A.source];if(!E)return;const F=A.sourceLayer;if(!F)return;const O=E.getSource();(O.type==="geojson"||O.vectorLayerIds&&O.vectorLayerIds.indexOf(F)===-1)&&this.fire(new a.j(new Error(`Source layer "${F}" does not exist on source "${O.id}" as specified by style layer "${A.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const A in this.sourceCaches)if(!this.sourceCaches[A].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(A){const E=this._serializedAllLayers();if(!A||A.length===0)return Object.values(E);const F=[];for(const O of A)E[O]&&F.push(E[O]);return F}_serializedAllLayers(){let A=this._serializedLayers;if(A)return A;A=this._serializedLayers={};const E=Object.keys(this._layers);for(const F of E){const O=this._layers[F];O.type!=="custom"&&(A[F]=O.serialize())}return A}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const A in this.sourceCaches)if(this.sourceCaches[A].hasTransition())return!0;for(const A in this._layers)if(this._layers[A].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(A){if(!this._loaded)return;const E=this._changed;if(this._changed){const O=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(O.length||y.length)&&this._updateWorkerLayers(O,y);for(const s in this._updatedSources){const i=this._updatedSources[s];if(i==="reload")this._reloadSource(s);else{if(i!=="clear")throw new Error(`Invalid action ${i}`);this._clearSource(s)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const s in this._updatedPaintProps)this._layers[s].updateTransitions(A);this.light.updateTransitions(A),this._resetUpdates()}const F={};for(const O in this.sourceCaches){const y=this.sourceCaches[O];F[O]=y.used,y.used=!1}for(const O of this._order){const y=this._layers[O];y.recalculate(A,this._availableImages),!y.isHidden(A.zoom)&&y.source&&(this.sourceCaches[y.source].used=!0)}for(const O in F){const y=this.sourceCaches[O];F[O]!==y.used&&y.fire(new a.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:O}))}this.light.recalculate(A),this.z=A.zoom,E&&this.fire(new a.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const A=Object.keys(this._changedImages);if(A.length){for(const E in this.sourceCaches)this.sourceCaches[E].reloadTilesForDependencies(["icons","patterns"],A);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const A in this.sourceCaches)this.sourceCaches[A].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(A,E){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(A),removedIds:E})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(A,E={}){this._checkLoaded();const F=this.serialize();if(A=E.transformStyle?E.transformStyle(F,A):A,Wt(this,a.y(A)))return!1;(A=a.aD(A)).layers=a.aB(A.layers);const O=a.aE(F,A).filter(s=>!(s.command in Ut));if(O.length===0)return!1;const y=O.filter(s=>!(s.command in Ki));if(y.length>0)throw new Error(`Unimplemented: ${y.map(s=>s.command).join(", ")}.`);for(const s of O)s.command!=="setTransition"&&this[s.command].apply(this,s.args);return this.stylesheet=A,this._serializedLayers=null,!0}addImage(A,E){if(this.getImage(A))return this.fire(new a.j(new Error(`An image named "${A}" already exists.`)));this.imageManager.addImage(A,E),this._afterImageUpdated(A)}updateImage(A,E){this.imageManager.updateImage(A,E)}getImage(A){return this.imageManager.getImage(A)}removeImage(A){if(!this.getImage(A))return this.fire(new a.j(new Error(`An image named "${A}" does not exist.`)));this.imageManager.removeImage(A),this._afterImageUpdated(A)}_afterImageUpdated(A){this._availableImages=this.imageManager.listImages(),this._changedImages[A]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(A,E,F={}){if(this._checkLoaded(),this.sourceCaches[A]!==void 0)throw new Error(`Source "${A}" already exists.`);if(!E.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(E).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(E.type)>=0&&this._validate(a.y.source,`sources.${A}`,E,null,F))return;this.map&&this.map._collectResourceTiming&&(E.collectResourceTiming=!0);const O=this.sourceCaches[A]=new rn(A,E,this.dispatcher);O.style=this,O.setEventedParent(this,()=>({isSourceLoaded:O.loaded(),source:O.serialize(),sourceId:A})),O.onAdd(this.map),this._changed=!0}removeSource(A){if(this._checkLoaded(),this.sourceCaches[A]===void 0)throw new Error("There is no source with this ID");for(const F in this._layers)if(this._layers[F].source===A)return this.fire(new a.j(new Error(`Source "${A}" cannot be removed while layer "${F}" is using it.`)));const E=this.sourceCaches[A];delete this.sourceCaches[A],delete this._updatedSources[A],E.fire(new a.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:A})),E.setEventedParent(null),E.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(A,E){if(this._checkLoaded(),this.sourceCaches[A]===void 0)throw new Error(`There is no source with this ID=${A}`);const F=this.sourceCaches[A].getSource();if(F.type!=="geojson")throw new Error(`geojsonSource.type is ${F.type}, which is !== 'geojson`);F.setData(E),this._changed=!0}getSource(A){return this.sourceCaches[A]&&this.sourceCaches[A].getSource()}addLayer(A,E,F={}){this._checkLoaded();const O=A.id;if(this.getLayer(O))return void this.fire(new a.j(new Error(`Layer "${O}" already exists on this map.`)));let y;if(A.type==="custom"){if(Wt(this,a.aF(A)))return;y=a.aC(A)}else{if("source"in A&&typeof A.source=="object"&&(this.addSource(O,A.source),A=a.aD(A),A=a.e(A,{source:O})),this._validate(a.y.layer,`layers.${O}`,A,{arrayIndex:-1},F))return;y=a.aC(A),this._validateLayer(y),y.setEventedParent(this,{layer:{id:O}})}const s=E?this._order.indexOf(E):this._order.length;if(E&&s===-1)this.fire(new a.j(new Error(`Cannot add layer "${O}" before non-existing layer "${E}".`)));else{if(this._order.splice(s,0,O),this._layerOrderChanged=!0,this._layers[O]=y,this._removedLayers[O]&&y.source&&y.type!=="custom"){const i=this._removedLayers[O];delete this._removedLayers[O],i.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(A,E){if(this._checkLoaded(),this._changed=!0,!this._layers[A])return void this.fire(new a.j(new Error(`The layer '${A}' does not exist in the map's style and cannot be moved.`)));if(A===E)return;const F=this._order.indexOf(A);this._order.splice(F,1);const O=E?this._order.indexOf(E):this._order.length;E&&O===-1?this.fire(new a.j(new Error(`Cannot move layer "${A}" before non-existing layer "${E}".`))):(this._order.splice(O,0,A),this._layerOrderChanged=!0)}removeLayer(A){this._checkLoaded();const E=this._layers[A];if(!E)return void this.fire(new a.j(new Error(`Cannot remove non-existing layer "${A}".`)));E.setEventedParent(null);const F=this._order.indexOf(A);this._order.splice(F,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[A]=E,delete this._layers[A],this._serializedLayers&&delete this._serializedLayers[A],delete this._updatedLayers[A],delete this._updatedPaintProps[A],E.onRemove&&E.onRemove(this.map)}getLayer(A){return this._layers[A]}getLayersOrder(){return[...this._order]}hasLayer(A){return A in this._layers}setLayerZoomRange(A,E,F){this._checkLoaded();const O=this.getLayer(A);O?O.minzoom===E&&O.maxzoom===F||(E!=null&&(O.minzoom=E),F!=null&&(O.maxzoom=F),this._updateLayer(O)):this.fire(new a.j(new Error(`Cannot set the zoom range of non-existing layer "${A}".`)))}setFilter(A,E,F={}){this._checkLoaded();const O=this.getLayer(A);if(O){if(!a.aG(O.filter,E))return E==null?(O.filter=void 0,void this._updateLayer(O)):void(this._validate(a.y.filter,`layers.${O.id}.filter`,E,null,F)||(O.filter=a.aD(E),this._updateLayer(O)))}else this.fire(new a.j(new Error(`Cannot filter non-existing layer "${A}".`)))}getFilter(A){return a.aD(this.getLayer(A).filter)}setLayoutProperty(A,E,F,O={}){this._checkLoaded();const y=this.getLayer(A);y?a.aG(y.getLayoutProperty(E),F)||(y.setLayoutProperty(E,F,O),this._updateLayer(y)):this.fire(new a.j(new Error(`Cannot style non-existing layer "${A}".`)))}getLayoutProperty(A,E){const F=this.getLayer(A);if(F)return F.getLayoutProperty(E);this.fire(new a.j(new Error(`Cannot get style of non-existing layer "${A}".`)))}setPaintProperty(A,E,F,O={}){this._checkLoaded();const y=this.getLayer(A);y?a.aG(y.getPaintProperty(E),F)||(y.setPaintProperty(E,F,O)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[A]=!0):this.fire(new a.j(new Error(`Cannot style non-existing layer "${A}".`)))}getPaintProperty(A,E){return this.getLayer(A).getPaintProperty(E)}setFeatureState(A,E){this._checkLoaded();const F=A.source,O=A.sourceLayer,y=this.sourceCaches[F];if(y===void 0)return void this.fire(new a.j(new Error(`The source '${F}' does not exist in the map's style.`)));const s=y.getSource().type;s==="geojson"&&O?this.fire(new a.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):s!=="vector"||O?(A.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),y.setFeatureState(O,A.id,E)):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(A,E){this._checkLoaded();const F=A.source,O=this.sourceCaches[F];if(O===void 0)return void this.fire(new a.j(new Error(`The source '${F}' does not exist in the map's style.`)));const y=O.getSource().type,s=y==="vector"?A.sourceLayer:void 0;y!=="vector"||s?E&&typeof A.id!="string"&&typeof A.id!="number"?this.fire(new a.j(new Error("A feature id is required to remove its specific state property."))):O.removeFeatureState(s,A.id,E):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(A){this._checkLoaded();const E=A.source,F=A.sourceLayer,O=this.sourceCaches[E];if(O!==void 0)return O.getSource().type!=="vector"||F?(A.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),O.getFeatureState(F,A.id)):void this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.j(new Error(`The source '${E}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const A=a.aH(this.sourceCaches,y=>y.serialize()),E=this._serializeByIds(this._order),F=this.map.getTerrain()||void 0,O=this.stylesheet;return a.aI({version:O.version,name:O.name,metadata:O.metadata,light:O.light,center:O.center,zoom:O.zoom,bearing:O.bearing,pitch:O.pitch,sprite:O.sprite,glyphs:O.glyphs,transition:O.transition,sources:A,layers:E,terrain:F},y=>y!==void 0)}_updateLayer(A){this._updatedLayers[A.id]=!0,A.source&&!this._updatedSources[A.source]&&this.sourceCaches[A.source].getSource().type!=="raster"&&(this._updatedSources[A.source]="reload",this.sourceCaches[A.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(A){const E=s=>this._layers[s].type==="fill-extrusion",F={},O=[];for(let s=this._order.length-1;s>=0;s--){const i=this._order[s];if(E(i)){F[i]=s;for(const r of A){const l=r[i];if(l)for(const d of l)O.push(d)}}}O.sort((s,i)=>i.intersectionZ-s.intersectionZ);const y=[];for(let s=this._order.length-1;s>=0;s--){const i=this._order[s];if(E(i))for(let r=O.length-1;r>=0;r--){const l=O[r].feature;if(F[l.layer.id]<s)break;y.push(l),O.pop()}else for(const r of A){const l=r[i];if(l)for(const d of l)y.push(d.feature)}}return y}queryRenderedFeatures(A,E,F){E&&E.filter&&this._validate(a.y.filter,"queryRenderedFeatures.filter",E.filter,null,E);const O={};if(E&&E.layers){if(!Array.isArray(E.layers))return this.fire(new a.j(new Error("parameters.layers must be an Array."))),[];for(const i of E.layers){const r=this._layers[i];if(!r)return this.fire(new a.j(new Error(`The layer '${i}' does not exist in the map's style and cannot be queried for features.`))),[];O[r.source]=!0}}const y=[];E.availableImages=this._availableImages;const s=this._serializedAllLayers();for(const i in this.sourceCaches)E.layers&&!O[i]||y.push(sn(this.sourceCaches[i],this._layers,s,A,E,F));return this.placement&&y.push(function(i,r,l,d,_,w,T){const B={},j=w.queryRenderedSymbols(d),X=[];for(const ce of Object.keys(j).map(Number))X.push(T[ce]);X.sort(ei);for(const ce of X){const Se=ce.featureIndex.lookupSymbolFeatures(j[ce.bucketInstanceId],r,ce.bucketIndex,ce.sourceLayerIndex,_.filter,_.layers,_.availableImages,i);for(const Te in Se){const Re=B[Te]=B[Te]||[],Be=Se[Te];Be.sort((Ke,yt)=>{const ot=ce.featureSortOrder;if(ot){const ct=ot.indexOf(Ke.featureIndex);return ot.indexOf(yt.featureIndex)-ct}return yt.featureIndex-Ke.featureIndex});for(const Ke of Be)Re.push(Ke)}}for(const ce in B)B[ce].forEach(Se=>{const Te=Se.feature,Re=l[i[ce].source].getFeatureState(Te.layer["source-layer"],Te.id);Te.source=Te.layer.source,Te.layer["source-layer"]&&(Te.sourceLayer=Te.layer["source-layer"]),Te.state=Re});return B}(this._layers,s,this.sourceCaches,A,E,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(A,E){E&&E.filter&&this._validate(a.y.filter,"querySourceFeatures.filter",E.filter,null,E);const F=this.sourceCaches[A];return F?function(O,y){const s=O.getRenderableIds().map(l=>O.getTileByID(l)),i=[],r={};for(let l=0;l<s.length;l++){const d=s[l],_=d.tileID.canonical.key;r[_]||(r[_]=!0,d.querySourceFeatures(i,y))}return i}(F,E):[]}addSourceType(A,E,F){return Ji(A)?F(new Error(`A source type called "${A}" already exists.`)):(((O,y)=>{_i[O]=y})(A,E),E.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:A,url:E.workerSourceURL},F):F(null,null))}getLight(){return this.light.getLight()}setLight(A,E={}){this._checkLoaded();const F=this.light.getLight();let O=!1;for(const s in A)if(!a.aG(A[s],F[s])){O=!0;break}if(!O)return;const y={now:a.h.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(A,E),this.light.updateTransitions(y)}_validate(A,E,F,O,y={}){return(!y||y.validate!==!1)&&Wt(this,A.call(a.y,a.e({key:E,style:this.serialize(),value:F,styleSpec:a.v},O)))}_remove(A=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(const E in this._layers)this._layers[E].setEventedParent(null);for(const E in this.sourceCaches){const F=this.sourceCaches[E];F.setEventedParent(null),F.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(A)}_clearSource(A){this.sourceCaches[A].clearTiles()}_reloadSource(A){this.sourceCaches[A].resume(),this.sourceCaches[A].reload()}_updateSources(A){for(const E in this.sourceCaches)this.sourceCaches[E].update(A,this.map.terrain)}_generateCollisionBoxes(){for(const A in this.sourceCaches)this._reloadSource(A)}_updatePlacement(A,E,F,O,y=!1){let s=!1,i=!1;const r={};for(const l of this._order){const d=this._layers[l];if(d.type!=="symbol")continue;if(!r[d.source]){const w=this.sourceCaches[d.source];r[d.source]=w.getRenderableIds(!0).map(T=>w.getTileByID(T)).sort((T,B)=>B.tileID.overscaledZ-T.tileID.overscaledZ||(T.tileID.isLessThan(B.tileID)?-1:1))}const _=this.crossTileSymbolIndex.addLayer(d,r[d.source],A.center.lng);s=s||_}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||F===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.h.now(),A.zoom))&&(this.pauseablePlacement=new mn(A,this.map.terrain,this._order,y,E,F,O,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,r),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.h.now()),i=!0),s&&this.pauseablePlacement.placement.setStale()),i||s)for(const l of this._order){const d=this._layers[l];d.type==="symbol"&&this.placement.updateLayerOpacities(d,r[d.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.h.now())}_releaseSymbolFadeTiles(){for(const A in this.sourceCaches)this.sourceCaches[A].releaseSymbolFadeTiles()}getImages(A,E,F){this.imageManager.getImages(E.icons,F),this._updateTilesForChangedImages();const O=this.sourceCaches[E.source];O&&O.setDependencies(E.tileID.key,E.type,E.icons)}getGlyphs(A,E,F){this.glyphManager.getGlyphs(E.stacks,F);const O=this.sourceCaches[E.source];O&&O.setDependencies(E.tileID.key,E.type,[""])}getResource(A,E,F){return a.m(E,F)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(A,E={}){this._checkLoaded(),A&&this._validate(a.y.glyphs,"glyphs",A,null,E)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=A,this.glyphManager.entries={},this.glyphManager.setURL(A))}addSprite(A,E,F={},O){this._checkLoaded();const y=[{id:A,url:E}],s=[...it(this.stylesheet.sprite),...y];this._validate(a.y.sprite,"sprite",s,null,F)||(this.stylesheet.sprite=s,this._loadSprite(y,!0,O))}removeSprite(A){this._checkLoaded();const E=it(this.stylesheet.sprite);if(E.find(F=>F.id===A)){if(this._spritesImagesIds[A])for(const F of this._spritesImagesIds[A])this.imageManager.removeImage(F),this._changedImages[F]=!0;E.splice(E.findIndex(F=>F.id===A),1),this.stylesheet.sprite=E.length>0?E:void 0,delete this._spritesImagesIds[A],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}else this.fire(new a.j(new Error(`Sprite "${A}" doesn't exists on this map.`)))}getSprite(){return it(this.stylesheet.sprite)}setSprite(A,E={},F){this._checkLoaded(),A&&this._validate(a.y.sprite,"sprite",A,null,E)||(this.stylesheet.sprite=A,A?this._loadSprite(A,!0,F):(this._unloadSprite(),F&&F(null)))}}cr.registerForPluginStateChange=a.aK;var Vs=a.Q([{name:"a_pos",type:"Int16",components:2}]),Ur="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Vt={prelude:hr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:hr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:hr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:hr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:hr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:hr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:hr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:hr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:hr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:hr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:hr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:hr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:hr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:hr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:hr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:hr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:hr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:hr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:hr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:hr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:hr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:hr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:hr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:hr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:hr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:hr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:hr("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Ur),terrainDepth:hr("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Ur),terrainCoords:hr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Ur)};function hr(Z,A){const E=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,F=A.match(/attribute ([\w]+) ([\w]+)/g),O=Z.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=A.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),s=y?y.concat(O):O,i={};return{fragmentSource:Z=Z.replace(E,(r,l,d,_,w)=>(i[w]=!0,l==="define"?`
#ifndef HAS_UNIFORM_u_${w}
varying ${d} ${_} ${w};
#else
uniform ${d} ${_} u_${w};
#endif
`:`
#ifdef HAS_UNIFORM_u_${w}
    ${d} ${_} ${w} = u_${w};
#endif
`)),vertexSource:A=A.replace(E,(r,l,d,_,w)=>{const T=_==="float"?"vec2":"vec4",B=w.match(/color/)?"color":T;return i[w]?l==="define"?`
#ifndef HAS_UNIFORM_u_${w}
uniform lowp float u_${w}_t;
attribute ${d} ${T} a_${w};
varying ${d} ${_} ${w};
#else
uniform ${d} ${_} u_${w};
#endif
`:B==="vec4"?`
#ifndef HAS_UNIFORM_u_${w}
    ${w} = a_${w};
#else
    ${d} ${_} ${w} = u_${w};
#endif
`:`
#ifndef HAS_UNIFORM_u_${w}
    ${w} = unpack_mix_${B}(a_${w}, u_${w}_t);
#else
    ${d} ${_} ${w} = u_${w};
#endif
`:l==="define"?`
#ifndef HAS_UNIFORM_u_${w}
uniform lowp float u_${w}_t;
attribute ${d} ${T} a_${w};
#else
uniform ${d} ${_} u_${w};
#endif
`:B==="vec4"?`
#ifndef HAS_UNIFORM_u_${w}
    ${d} ${_} ${w} = a_${w};
#else
    ${d} ${_} ${w} = u_${w};
#endif
`:`
#ifndef HAS_UNIFORM_u_${w}
    ${d} ${_} ${w} = unpack_mix_${B}(a_${w}, u_${w}_t);
#else
    ${d} ${_} ${w} = u_${w};
#endif
`}),staticAttributes:F,staticUniforms:s}}class Bt{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(A,E,F,O,y,s,i,r,l){this.context=A;let d=this.boundPaintVertexBuffers.length!==O.length;for(let _=0;!d&&_<O.length;_++)this.boundPaintVertexBuffers[_]!==O[_]&&(d=!0);!this.vao||this.boundProgram!==E||this.boundLayoutVertexBuffer!==F||d||this.boundIndexBuffer!==y||this.boundVertexOffset!==s||this.boundDynamicVertexBuffer!==i||this.boundDynamicVertexBuffer2!==r||this.boundDynamicVertexBuffer3!==l?this.freshBind(E,F,O,y,s,i,r,l):(A.bindVertexArray.set(this.vao),i&&i.bind(),y&&y.dynamicDraw&&y.bind(),r&&r.bind(),l&&l.bind())}freshBind(A,E,F,O,y,s,i,r){const l=A.numAttributes,d=this.context,_=d.gl;this.vao&&this.destroy(),this.vao=d.createVertexArray(),d.bindVertexArray.set(this.vao),this.boundProgram=A,this.boundLayoutVertexBuffer=E,this.boundPaintVertexBuffers=F,this.boundIndexBuffer=O,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=s,this.boundDynamicVertexBuffer2=i,this.boundDynamicVertexBuffer3=r,E.enableAttributes(_,A);for(const w of F)w.enableAttributes(_,A);s&&s.enableAttributes(_,A),i&&i.enableAttributes(_,A),r&&r.enableAttributes(_,A),E.bind(),E.setVertexAttribPointers(_,A,y);for(const w of F)w.bind(),w.setVertexAttribPointers(_,A,y);s&&(s.bind(),s.setVertexAttribPointers(_,A,y)),O&&O.bind(),i&&(i.bind(),i.setVertexAttribPointers(_,A,y)),r&&(r.bind(),r.setVertexAttribPointers(_,A,y)),d.currentNumAttributes=l}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Fr(Z){const A=[];for(let E=0;E<Z.length;E++){if(Z[E]===null)continue;const F=Z[E].split(" ");A.push(F.pop())}return A}class Us{constructor(A,E,F,O,y,s){const i=A.gl;this.program=i.createProgram();const r=Fr(E.staticAttributes),l=F?F.getBinderAttributes():[],d=r.concat(l),_=Vt.prelude.staticUniforms?Fr(Vt.prelude.staticUniforms):[],w=E.staticUniforms?Fr(E.staticUniforms):[],T=F?F.getBinderUniforms():[],B=_.concat(w).concat(T),j=[];for(const Ke of B)j.indexOf(Ke)<0&&j.push(Ke);const X=F?F.defines():[];y&&X.push("#define OVERDRAW_INSPECTOR;"),s&&X.push("#define TERRAIN3D;");const ce=X.concat(Vt.prelude.fragmentSource,E.fragmentSource).join(`
`),Se=X.concat(Vt.prelude.vertexSource,E.vertexSource).join(`
`),Te=i.createShader(i.FRAGMENT_SHADER);if(i.isContextLost())return void(this.failedToCreate=!0);if(i.shaderSource(Te,ce),i.compileShader(Te),!i.getShaderParameter(Te,i.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${i.getShaderInfoLog(Te)}`);i.attachShader(this.program,Te);const Re=i.createShader(i.VERTEX_SHADER);if(i.isContextLost())return void(this.failedToCreate=!0);if(i.shaderSource(Re,Se),i.compileShader(Re),!i.getShaderParameter(Re,i.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${i.getShaderInfoLog(Re)}`);i.attachShader(this.program,Re),this.attributes={};const Be={};this.numAttributes=d.length;for(let Ke=0;Ke<this.numAttributes;Ke++)d[Ke]&&(i.bindAttribLocation(this.program,Ke,d[Ke]),this.attributes[d[Ke]]=Ke);if(i.linkProgram(this.program),!i.getProgramParameter(this.program,i.LINK_STATUS))throw new Error(`Program failed to link: ${i.getProgramInfoLog(this.program)}`);i.deleteShader(Re),i.deleteShader(Te);for(let Ke=0;Ke<j.length;Ke++){const yt=j[Ke];if(yt&&!Be[yt]){const ot=i.getUniformLocation(this.program,yt);ot&&(Be[yt]=ot)}}this.fixedUniforms=O(A,Be),this.terrainUniforms=((Ke,yt)=>({u_depth:new a.aL(Ke,yt.u_depth),u_terrain:new a.aL(Ke,yt.u_terrain),u_terrain_dim:new a.aM(Ke,yt.u_terrain_dim),u_terrain_matrix:new a.aN(Ke,yt.u_terrain_matrix),u_terrain_unpack:new a.aO(Ke,yt.u_terrain_unpack),u_terrain_exaggeration:new a.aM(Ke,yt.u_terrain_exaggeration)}))(A,Be),this.binderUniforms=F?F.getUniforms(A,Be):[]}draw(A,E,F,O,y,s,i,r,l,d,_,w,T,B,j,X,ce,Se){const Te=A.gl;if(this.failedToCreate)return;if(A.program.set(this.program),A.setDepthMode(F),A.setStencilMode(O),A.setColorMode(y),A.setCullFace(s),r){A.activeTexture.set(Te.TEXTURE2),Te.bindTexture(Te.TEXTURE_2D,r.depthTexture),A.activeTexture.set(Te.TEXTURE3),Te.bindTexture(Te.TEXTURE_2D,r.texture);for(const Be in this.terrainUniforms)this.terrainUniforms[Be].set(r[Be])}for(const Be in this.fixedUniforms)this.fixedUniforms[Be].set(i[Be]);j&&j.setUniforms(A,this.binderUniforms,T,{zoom:B});let Re=0;switch(E){case Te.LINES:Re=2;break;case Te.TRIANGLES:Re=3;break;case Te.LINE_STRIP:Re=1}for(const Be of w.get()){const Ke=Be.vaos||(Be.vaos={});(Ke[l]||(Ke[l]=new Bt)).bind(A,this,d,j?j.getPaintVertexBuffers():[],_,Be.vertexOffset,X,ce,Se),Te.drawElements(E,Be.primitiveLength*Re,Te.UNSIGNED_SHORT,Be.primitiveOffset*Re*2)}}}function ua(Z,A,E){const F=1/Fe(E,1,A.transform.tileZoom),O=Math.pow(2,E.tileID.overscaledZ),y=E.tileSize*Math.pow(2,A.transform.tileZoom)/O,s=y*(E.tileID.canonical.x+E.tileID.wrap*O),i=y*E.tileID.canonical.y;return{u_image:0,u_texsize:E.imageAtlasTexture.size,u_scale:[F,Z.fromScale,Z.toScale],u_fade:Z.t,u_pixel_coord_upper:[s>>16,i>>16],u_pixel_coord_lower:[65535&s,65535&i]}}const Dr=(Z,A,E,F)=>{const O=A.style.light,y=O.properties.get("position"),s=[y.x,y.y,y.z],i=function(){var l=new a.A(9);return a.A!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}();O.properties.get("anchor")==="viewport"&&function(l,d){var _=Math.sin(d),w=Math.cos(d);l[0]=w,l[1]=_,l[2]=0,l[3]=-_,l[4]=w,l[5]=0,l[6]=0,l[7]=0,l[8]=1}(i,-A.transform.angle),function(l,d,_){var w=d[0],T=d[1],B=d[2];l[0]=w*_[0]+T*_[3]+B*_[6],l[1]=w*_[1]+T*_[4]+B*_[7],l[2]=w*_[2]+T*_[5]+B*_[8]}(s,s,i);const r=O.properties.get("color");return{u_matrix:Z,u_lightpos:s,u_lightintensity:O.properties.get("intensity"),u_lightcolor:[r.r,r.g,r.b],u_vertical_gradient:+E,u_opacity:F}},Na=(Z,A,E,F,O,y,s)=>a.e(Dr(Z,A,E,F),ua(y,A,s),{u_height_factor:-Math.pow(2,O.overscaledZ)/s.tileSize/8}),Fo=Z=>({u_matrix:Z}),Va=(Z,A,E,F)=>a.e(Fo(Z),ua(E,A,F)),Xs=(Z,A)=>({u_matrix:Z,u_world:A}),Zn=(Z,A,E,F,O)=>a.e(Va(Z,A,E,F),{u_world:O}),aa=(Z,A,E,F)=>{const O=Z.transform;let y,s;if(F.paint.get("circle-pitch-alignment")==="map"){const i=Fe(E,1,O.zoom);y=!0,s=[i,i]}else y=!1,s=O.pixelsToGLUnits;return{u_camera_to_center_distance:O.cameraToCenterDistance,u_scale_with_map:+(F.paint.get("circle-pitch-scale")==="map"),u_matrix:Z.translatePosMatrix(A.posMatrix,E,F.paint.get("circle-translate"),F.paint.get("circle-translate-anchor")),u_pitch_with_map:+y,u_device_pixel_ratio:Z.pixelRatio,u_extrude_scale:s}},hs=(Z,A,E)=>{const F=Fe(E,1,A.zoom),O=Math.pow(2,A.zoom-E.tileID.overscaledZ),y=E.tileID.overscaleFactor();return{u_matrix:Z,u_camera_to_center_distance:A.cameraToCenterDistance,u_pixels_to_tile_units:F,u_extrude_scale:[A.pixelsToGLUnits[0]/(F*O),A.pixelsToGLUnits[1]/(F*O)],u_overscale_factor:y}},Ua=(Z,A,E=1)=>({u_matrix:Z,u_color:A,u_overlay:0,u_overlay_scale:E}),al=Z=>({u_matrix:Z}),ol=(Z,A,E,F)=>({u_matrix:Z,u_extrude_scale:Fe(A,1,E),u_intensity:F});function no(Z,A){const E=Math.pow(2,A.canonical.z),F=A.canonical.y;return[new a.U(0,F/E).toLngLat().lat,new a.U(0,(F+1)/E).toLngLat().lat]}const Ga=(Z,A,E,F)=>{const O=Z.transform;return{u_matrix:$t(Z,A,E,F),u_ratio:1/Fe(A,1,O.zoom),u_device_pixel_ratio:Z.pixelRatio,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]]}},N=(Z,A,E,F,O)=>a.e(Ga(Z,A,E,O),{u_image:0,u_image_height:F}),xe=(Z,A,E,F,O)=>{const y=Z.transform,s=St(A,y);return{u_matrix:$t(Z,A,E,O),u_texsize:A.imageAtlasTexture.size,u_ratio:1/Fe(A,1,y.zoom),u_device_pixel_ratio:Z.pixelRatio,u_image:0,u_scale:[s,F.fromScale,F.toScale],u_fade:F.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},rt=(Z,A,E,F,O,y)=>{const s=Z.lineAtlas,i=St(A,Z.transform),r=E.layout.get("line-cap")==="round",l=s.getDash(F.from,r),d=s.getDash(F.to,r),_=l.width*O.fromScale,w=d.width*O.toScale;return a.e(Ga(Z,A,E,y),{u_patternscale_a:[i/_,-l.height/2],u_patternscale_b:[i/w,-d.height/2],u_sdfgamma:s.width/(256*Math.min(_,w)*Z.pixelRatio)/2,u_image:0,u_tex_y_a:l.y,u_tex_y_b:d.y,u_mix:O.t})};function St(Z,A){return 1/Fe(Z,1,A.tileZoom)}function $t(Z,A,E,F){return Z.translatePosMatrix(F?F.posMatrix:A.tileID.posMatrix,A,E.paint.get("line-translate"),E.paint.get("line-translate-anchor"))}const Ii=(Z,A,E,F,O)=>{return{u_matrix:Z,u_tl_parent:A,u_scale_parent:E,u_buffer_scale:1,u_fade_t:F.mix,u_opacity:F.opacity*O.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:O.paint.get("raster-brightness-min"),u_brightness_high:O.paint.get("raster-brightness-max"),u_saturation_factor:(s=O.paint.get("raster-saturation"),s>0?1-1/(1.001-s):-s),u_contrast_factor:(y=O.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:Li(O.paint.get("raster-hue-rotate"))};var y,s};function Li(Z){Z*=Math.PI/180;const A=Math.sin(Z),E=Math.cos(Z);return[(2*E+1)/3,(-Math.sqrt(3)*A-E+1)/3,(Math.sqrt(3)*A-E+1)/3]}const An=(Z,A,E,F,O,y,s,i,r,l)=>{const d=O.transform;return{u_is_size_zoom_constant:+(Z==="constant"||Z==="source"),u_is_size_feature_constant:+(Z==="constant"||Z==="camera"),u_size_t:A?A.uSizeT:0,u_size:A?A.uSize:0,u_camera_to_center_distance:d.cameraToCenterDistance,u_pitch:d.pitch/360*2*Math.PI,u_rotate_symbol:+E,u_aspect_ratio:d.width/d.height,u_fade_change:O.options.fadeDuration?O.symbolFadeChange:1,u_matrix:y,u_label_plane_matrix:s,u_coord_matrix:i,u_is_text:+r,u_pitch_with_map:+F,u_texsize:l,u_texture:0}},pn=(Z,A,E,F,O,y,s,i,r,l,d)=>{const _=O.transform;return a.e(An(Z,A,E,F,O,y,s,i,r,l),{u_gamma_scale:F?Math.cos(_._pitch)*_.cameraToCenterDistance:1,u_device_pixel_ratio:O.pixelRatio,u_is_halo:+d})},sr=(Z,A,E,F,O,y,s,i,r,l)=>a.e(pn(Z,A,E,F,O,y,s,i,!0,r,!0),{u_texsize_icon:l,u_texture_icon:1}),Ar=(Z,A,E)=>({u_matrix:Z,u_opacity:A,u_color:E}),Or=(Z,A,E,F,O,y)=>a.e(function(s,i,r,l){const d=r.imageManager.getPattern(s.from.toString()),_=r.imageManager.getPattern(s.to.toString()),{width:w,height:T}=r.imageManager.getPixelSize(),B=Math.pow(2,l.tileID.overscaledZ),j=l.tileSize*Math.pow(2,r.transform.tileZoom)/B,X=j*(l.tileID.canonical.x+l.tileID.wrap*B),ce=j*l.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:d.tl,u_pattern_br_a:d.br,u_pattern_tl_b:_.tl,u_pattern_br_b:_.br,u_texsize:[w,T],u_mix:i.t,u_pattern_size_a:d.displaySize,u_pattern_size_b:_.displaySize,u_scale_a:i.fromScale,u_scale_b:i.toScale,u_tile_units_to_pixels:1/Fe(l,1,r.transform.tileZoom),u_pixel_coord_upper:[X>>16,ce>>16],u_pixel_coord_lower:[65535&X,65535&ce]}}(F,y,E,O),{u_matrix:Z,u_opacity:A}),qa={fillExtrusion:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_lightpos:new a.aP(Z,A.u_lightpos),u_lightintensity:new a.aM(Z,A.u_lightintensity),u_lightcolor:new a.aP(Z,A.u_lightcolor),u_vertical_gradient:new a.aM(Z,A.u_vertical_gradient),u_opacity:new a.aM(Z,A.u_opacity)}),fillExtrusionPattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_lightpos:new a.aP(Z,A.u_lightpos),u_lightintensity:new a.aM(Z,A.u_lightintensity),u_lightcolor:new a.aP(Z,A.u_lightcolor),u_vertical_gradient:new a.aM(Z,A.u_vertical_gradient),u_height_factor:new a.aM(Z,A.u_height_factor),u_image:new a.aL(Z,A.u_image),u_texsize:new a.aQ(Z,A.u_texsize),u_pixel_coord_upper:new a.aQ(Z,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Z,A.u_pixel_coord_lower),u_scale:new a.aP(Z,A.u_scale),u_fade:new a.aM(Z,A.u_fade),u_opacity:new a.aM(Z,A.u_opacity)}),fill:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix)}),fillPattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_image:new a.aL(Z,A.u_image),u_texsize:new a.aQ(Z,A.u_texsize),u_pixel_coord_upper:new a.aQ(Z,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Z,A.u_pixel_coord_lower),u_scale:new a.aP(Z,A.u_scale),u_fade:new a.aM(Z,A.u_fade)}),fillOutline:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_world:new a.aQ(Z,A.u_world)}),fillOutlinePattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_world:new a.aQ(Z,A.u_world),u_image:new a.aL(Z,A.u_image),u_texsize:new a.aQ(Z,A.u_texsize),u_pixel_coord_upper:new a.aQ(Z,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Z,A.u_pixel_coord_lower),u_scale:new a.aP(Z,A.u_scale),u_fade:new a.aM(Z,A.u_fade)}),circle:(Z,A)=>({u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_scale_with_map:new a.aL(Z,A.u_scale_with_map),u_pitch_with_map:new a.aL(Z,A.u_pitch_with_map),u_extrude_scale:new a.aQ(Z,A.u_extrude_scale),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_matrix:new a.aN(Z,A.u_matrix)}),collisionBox:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_pixels_to_tile_units:new a.aM(Z,A.u_pixels_to_tile_units),u_extrude_scale:new a.aQ(Z,A.u_extrude_scale),u_overscale_factor:new a.aM(Z,A.u_overscale_factor)}),collisionCircle:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_inv_matrix:new a.aN(Z,A.u_inv_matrix),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_viewport_size:new a.aQ(Z,A.u_viewport_size)}),debug:(Z,A)=>({u_color:new a.aR(Z,A.u_color),u_matrix:new a.aN(Z,A.u_matrix),u_overlay:new a.aL(Z,A.u_overlay),u_overlay_scale:new a.aM(Z,A.u_overlay_scale)}),clippingMask:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix)}),heatmap:(Z,A)=>({u_extrude_scale:new a.aM(Z,A.u_extrude_scale),u_intensity:new a.aM(Z,A.u_intensity),u_matrix:new a.aN(Z,A.u_matrix)}),heatmapTexture:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_world:new a.aQ(Z,A.u_world),u_image:new a.aL(Z,A.u_image),u_color_ramp:new a.aL(Z,A.u_color_ramp),u_opacity:new a.aM(Z,A.u_opacity)}),hillshade:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_image:new a.aL(Z,A.u_image),u_latrange:new a.aQ(Z,A.u_latrange),u_light:new a.aQ(Z,A.u_light),u_shadow:new a.aR(Z,A.u_shadow),u_highlight:new a.aR(Z,A.u_highlight),u_accent:new a.aR(Z,A.u_accent)}),hillshadePrepare:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_image:new a.aL(Z,A.u_image),u_dimension:new a.aQ(Z,A.u_dimension),u_zoom:new a.aM(Z,A.u_zoom),u_unpack:new a.aO(Z,A.u_unpack)}),line:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_ratio:new a.aM(Z,A.u_ratio),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_units_to_pixels:new a.aQ(Z,A.u_units_to_pixels)}),lineGradient:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_ratio:new a.aM(Z,A.u_ratio),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_units_to_pixels:new a.aQ(Z,A.u_units_to_pixels),u_image:new a.aL(Z,A.u_image),u_image_height:new a.aM(Z,A.u_image_height)}),linePattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_texsize:new a.aQ(Z,A.u_texsize),u_ratio:new a.aM(Z,A.u_ratio),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_image:new a.aL(Z,A.u_image),u_units_to_pixels:new a.aQ(Z,A.u_units_to_pixels),u_scale:new a.aP(Z,A.u_scale),u_fade:new a.aM(Z,A.u_fade)}),lineSDF:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_ratio:new a.aM(Z,A.u_ratio),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_units_to_pixels:new a.aQ(Z,A.u_units_to_pixels),u_patternscale_a:new a.aQ(Z,A.u_patternscale_a),u_patternscale_b:new a.aQ(Z,A.u_patternscale_b),u_sdfgamma:new a.aM(Z,A.u_sdfgamma),u_image:new a.aL(Z,A.u_image),u_tex_y_a:new a.aM(Z,A.u_tex_y_a),u_tex_y_b:new a.aM(Z,A.u_tex_y_b),u_mix:new a.aM(Z,A.u_mix)}),raster:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_tl_parent:new a.aQ(Z,A.u_tl_parent),u_scale_parent:new a.aM(Z,A.u_scale_parent),u_buffer_scale:new a.aM(Z,A.u_buffer_scale),u_fade_t:new a.aM(Z,A.u_fade_t),u_opacity:new a.aM(Z,A.u_opacity),u_image0:new a.aL(Z,A.u_image0),u_image1:new a.aL(Z,A.u_image1),u_brightness_low:new a.aM(Z,A.u_brightness_low),u_brightness_high:new a.aM(Z,A.u_brightness_high),u_saturation_factor:new a.aM(Z,A.u_saturation_factor),u_contrast_factor:new a.aM(Z,A.u_contrast_factor),u_spin_weights:new a.aP(Z,A.u_spin_weights)}),symbolIcon:(Z,A)=>({u_is_size_zoom_constant:new a.aL(Z,A.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aL(Z,A.u_is_size_feature_constant),u_size_t:new a.aM(Z,A.u_size_t),u_size:new a.aM(Z,A.u_size),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_pitch:new a.aM(Z,A.u_pitch),u_rotate_symbol:new a.aL(Z,A.u_rotate_symbol),u_aspect_ratio:new a.aM(Z,A.u_aspect_ratio),u_fade_change:new a.aM(Z,A.u_fade_change),u_matrix:new a.aN(Z,A.u_matrix),u_label_plane_matrix:new a.aN(Z,A.u_label_plane_matrix),u_coord_matrix:new a.aN(Z,A.u_coord_matrix),u_is_text:new a.aL(Z,A.u_is_text),u_pitch_with_map:new a.aL(Z,A.u_pitch_with_map),u_texsize:new a.aQ(Z,A.u_texsize),u_texture:new a.aL(Z,A.u_texture)}),symbolSDF:(Z,A)=>({u_is_size_zoom_constant:new a.aL(Z,A.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aL(Z,A.u_is_size_feature_constant),u_size_t:new a.aM(Z,A.u_size_t),u_size:new a.aM(Z,A.u_size),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_pitch:new a.aM(Z,A.u_pitch),u_rotate_symbol:new a.aL(Z,A.u_rotate_symbol),u_aspect_ratio:new a.aM(Z,A.u_aspect_ratio),u_fade_change:new a.aM(Z,A.u_fade_change),u_matrix:new a.aN(Z,A.u_matrix),u_label_plane_matrix:new a.aN(Z,A.u_label_plane_matrix),u_coord_matrix:new a.aN(Z,A.u_coord_matrix),u_is_text:new a.aL(Z,A.u_is_text),u_pitch_with_map:new a.aL(Z,A.u_pitch_with_map),u_texsize:new a.aQ(Z,A.u_texsize),u_texture:new a.aL(Z,A.u_texture),u_gamma_scale:new a.aM(Z,A.u_gamma_scale),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_is_halo:new a.aL(Z,A.u_is_halo)}),symbolTextAndIcon:(Z,A)=>({u_is_size_zoom_constant:new a.aL(Z,A.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aL(Z,A.u_is_size_feature_constant),u_size_t:new a.aM(Z,A.u_size_t),u_size:new a.aM(Z,A.u_size),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_pitch:new a.aM(Z,A.u_pitch),u_rotate_symbol:new a.aL(Z,A.u_rotate_symbol),u_aspect_ratio:new a.aM(Z,A.u_aspect_ratio),u_fade_change:new a.aM(Z,A.u_fade_change),u_matrix:new a.aN(Z,A.u_matrix),u_label_plane_matrix:new a.aN(Z,A.u_label_plane_matrix),u_coord_matrix:new a.aN(Z,A.u_coord_matrix),u_is_text:new a.aL(Z,A.u_is_text),u_pitch_with_map:new a.aL(Z,A.u_pitch_with_map),u_texsize:new a.aQ(Z,A.u_texsize),u_texsize_icon:new a.aQ(Z,A.u_texsize_icon),u_texture:new a.aL(Z,A.u_texture),u_texture_icon:new a.aL(Z,A.u_texture_icon),u_gamma_scale:new a.aM(Z,A.u_gamma_scale),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_is_halo:new a.aL(Z,A.u_is_halo)}),background:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_opacity:new a.aM(Z,A.u_opacity),u_color:new a.aR(Z,A.u_color)}),backgroundPattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_opacity:new a.aM(Z,A.u_opacity),u_image:new a.aL(Z,A.u_image),u_pattern_tl_a:new a.aQ(Z,A.u_pattern_tl_a),u_pattern_br_a:new a.aQ(Z,A.u_pattern_br_a),u_pattern_tl_b:new a.aQ(Z,A.u_pattern_tl_b),u_pattern_br_b:new a.aQ(Z,A.u_pattern_br_b),u_texsize:new a.aQ(Z,A.u_texsize),u_mix:new a.aM(Z,A.u_mix),u_pattern_size_a:new a.aQ(Z,A.u_pattern_size_a),u_pattern_size_b:new a.aQ(Z,A.u_pattern_size_b),u_scale_a:new a.aM(Z,A.u_scale_a),u_scale_b:new a.aM(Z,A.u_scale_b),u_pixel_coord_upper:new a.aQ(Z,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Z,A.u_pixel_coord_lower),u_tile_units_to_pixels:new a.aM(Z,A.u_tile_units_to_pixels)}),terrain:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_texture:new a.aL(Z,A.u_texture),u_ele_delta:new a.aM(Z,A.u_ele_delta)}),terrainDepth:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_ele_delta:new a.aM(Z,A.u_ele_delta)}),terrainCoords:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_texture:new a.aL(Z,A.u_texture),u_terrain_coords_id:new a.aM(Z,A.u_terrain_coords_id),u_ele_delta:new a.aM(Z,A.u_ele_delta)})};class Ha{constructor(A,E,F){this.context=A;const O=A.gl;this.buffer=O.createBuffer(),this.dynamicDraw=!!F,this.context.unbindVAO(),A.bindElementBuffer.set(this.buffer),O.bufferData(O.ELEMENT_ARRAY_BUFFER,E.arrayBuffer,this.dynamicDraw?O.DYNAMIC_DRAW:O.STATIC_DRAW),this.dynamicDraw||delete E.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(A){const E=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),E.bufferSubData(E.ELEMENT_ARRAY_BUFFER,0,A.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ja={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class pl{constructor(A,E,F,O){this.length=E.length,this.attributes=F,this.itemSize=E.bytesPerElement,this.dynamicDraw=O,this.context=A;const y=A.gl;this.buffer=y.createBuffer(),A.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,E.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete E.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(A){if(A.length!==this.length)throw new Error(`Length of new data is ${A.length}, which doesn't match current length of ${this.length}`);const E=this.context.gl;this.bind(),E.bufferSubData(E.ARRAY_BUFFER,0,A.arrayBuffer)}enableAttributes(A,E){for(let F=0;F<this.attributes.length;F++){const O=E.attributes[this.attributes[F].name];O!==void 0&&A.enableVertexAttribArray(O)}}setVertexAttribPointers(A,E,F){for(let O=0;O<this.attributes.length;O++){const y=this.attributes[O],s=E.attributes[y.name];s!==void 0&&A.vertexAttribPointer(s,y.components,A[ja[y.type]],!1,this.itemSize,y.offset+this.itemSize*(F||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Gr=new WeakMap;function nr(Z){var A;if(Gr.has(Z))return Gr.get(Z);{const E=(A=Z.getParameter(Z.VERSION))===null||A===void 0?void 0:A.startsWith("WebGL 2.0");return Gr.set(Z,E),E}}class Ir{constructor(A){this.gl=A.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(A){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Lr extends Ir{getDefault(){return a.aT.transparent}set(A){const E=this.current;(A.r!==E.r||A.g!==E.g||A.b!==E.b||A.a!==E.a||this.dirty)&&(this.gl.clearColor(A.r,A.g,A.b,A.a),this.current=A,this.dirty=!1)}}class Zs extends Ir{getDefault(){return 1}set(A){(A!==this.current||this.dirty)&&(this.gl.clearDepth(A),this.current=A,this.dirty=!1)}}class vr extends Ir{getDefault(){return 0}set(A){(A!==this.current||this.dirty)&&(this.gl.clearStencil(A),this.current=A,this.dirty=!1)}}class Ks extends Ir{getDefault(){return[!0,!0,!0,!0]}set(A){const E=this.current;(A[0]!==E[0]||A[1]!==E[1]||A[2]!==E[2]||A[3]!==E[3]||this.dirty)&&(this.gl.colorMask(A[0],A[1],A[2],A[3]),this.current=A,this.dirty=!1)}}class Br extends Ir{getDefault(){return!0}set(A){(A!==this.current||this.dirty)&&(this.gl.depthMask(A),this.current=A,this.dirty=!1)}}class Eo extends Ir{getDefault(){return 255}set(A){(A!==this.current||this.dirty)&&(this.gl.stencilMask(A),this.current=A,this.dirty=!1)}}class Zo extends Ir{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(A){const E=this.current;(A.func!==E.func||A.ref!==E.ref||A.mask!==E.mask||this.dirty)&&(this.gl.stencilFunc(A.func,A.ref,A.mask),this.current=A,this.dirty=!1)}}class Bs extends Ir{getDefault(){const A=this.gl;return[A.KEEP,A.KEEP,A.KEEP]}set(A){const E=this.current;(A[0]!==E[0]||A[1]!==E[1]||A[2]!==E[2]||this.dirty)&&(this.gl.stencilOp(A[0],A[1],A[2]),this.current=A,this.dirty=!1)}}class Il extends Ir{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;A?E.enable(E.STENCIL_TEST):E.disable(E.STENCIL_TEST),this.current=A,this.dirty=!1}}class mo extends Ir{getDefault(){return[0,1]}set(A){const E=this.current;(A[0]!==E[0]||A[1]!==E[1]||this.dirty)&&(this.gl.depthRange(A[0],A[1]),this.current=A,this.dirty=!1)}}class Qo extends Ir{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;A?E.enable(E.DEPTH_TEST):E.disable(E.DEPTH_TEST),this.current=A,this.dirty=!1}}class ca extends Ir{getDefault(){return this.gl.LESS}set(A){(A!==this.current||this.dirty)&&(this.gl.depthFunc(A),this.current=A,this.dirty=!1)}}class Ys extends Ir{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;A?E.enable(E.BLEND):E.disable(E.BLEND),this.current=A,this.dirty=!1}}class El extends Ir{getDefault(){const A=this.gl;return[A.ONE,A.ZERO]}set(A){const E=this.current;(A[0]!==E[0]||A[1]!==E[1]||this.dirty)&&(this.gl.blendFunc(A[0],A[1]),this.current=A,this.dirty=!1)}}class Za extends Ir{getDefault(){return a.aT.transparent}set(A){const E=this.current;(A.r!==E.r||A.g!==E.g||A.b!==E.b||A.a!==E.a||this.dirty)&&(this.gl.blendColor(A.r,A.g,A.b,A.a),this.current=A,this.dirty=!1)}}class Ta extends Ir{getDefault(){return this.gl.FUNC_ADD}set(A){(A!==this.current||this.dirty)&&(this.gl.blendEquation(A),this.current=A,this.dirty=!1)}}class ml extends Ir{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;A?E.enable(E.CULL_FACE):E.disable(E.CULL_FACE),this.current=A,this.dirty=!1}}class Cl extends Ir{getDefault(){return this.gl.BACK}set(A){(A!==this.current||this.dirty)&&(this.gl.cullFace(A),this.current=A,this.dirty=!1)}}class mu extends Ir{getDefault(){return this.gl.CCW}set(A){(A!==this.current||this.dirty)&&(this.gl.frontFace(A),this.current=A,this.dirty=!1)}}class As extends Ir{getDefault(){return null}set(A){(A!==this.current||this.dirty)&&(this.gl.useProgram(A),this.current=A,this.dirty=!1)}}class ac extends Ir{getDefault(){return this.gl.TEXTURE0}set(A){(A!==this.current||this.dirty)&&(this.gl.activeTexture(A),this.current=A,this.dirty=!1)}}class ro extends Ir{getDefault(){const A=this.gl;return[0,0,A.drawingBufferWidth,A.drawingBufferHeight]}set(A){const E=this.current;(A[0]!==E[0]||A[1]!==E[1]||A[2]!==E[2]||A[3]!==E[3]||this.dirty)&&(this.gl.viewport(A[0],A[1],A[2],A[3]),this.current=A,this.dirty=!1)}}class so extends Ir{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.bindFramebuffer(E.FRAMEBUFFER,A),this.current=A,this.dirty=!1}}class Ql extends Ir{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.bindRenderbuffer(E.RENDERBUFFER,A),this.current=A,this.dirty=!1}}class Oo extends Ir{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.bindTexture(E.TEXTURE_2D,A),this.current=A,this.dirty=!1}}class Wo extends Ir{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.bindBuffer(E.ARRAY_BUFFER,A),this.current=A,this.dirty=!1}}class Co extends Ir{getDefault(){return null}set(A){const E=this.gl;E.bindBuffer(E.ELEMENT_ARRAY_BUFFER,A),this.current=A,this.dirty=!1}}class Gs extends Ir{getDefault(){return null}set(A){var E;if(A===this.current&&!this.dirty)return;const F=this.gl;nr(F)?F.bindVertexArray(A):(E=F.getExtension("OES_vertex_array_object"))===null||E===void 0||E.bindVertexArrayOES(A),this.current=A,this.dirty=!1}}class $o extends Ir{getDefault(){return 4}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.pixelStorei(E.UNPACK_ALIGNMENT,A),this.current=A,this.dirty=!1}}class Xo extends Ir{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.pixelStorei(E.UNPACK_PREMULTIPLY_ALPHA_WEBGL,A),this.current=A,this.dirty=!1}}class Yo extends Ir{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,A),this.current=A,this.dirty=!1}}class ba extends Ir{constructor(A,E){super(A),this.context=A,this.parent=E}getDefault(){return null}}class Qa extends ba{setDirty(){this.dirty=!0}set(A){if(A===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const E=this.gl;E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_2D,A,0),this.current=A,this.dirty=!1}}class Cs extends ba{set(A){if(A===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const E=this.gl;E.framebufferRenderbuffer(E.FRAMEBUFFER,E.DEPTH_ATTACHMENT,E.RENDERBUFFER,A),this.current=A,this.dirty=!1}}class gu extends ba{set(A){if(A===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const E=this.gl;E.framebufferRenderbuffer(E.FRAMEBUFFER,E.DEPTH_STENCIL_ATTACHMENT,E.RENDERBUFFER,A),this.current=A,this.dirty=!1}}class Er{constructor(A,E,F,O,y){this.context=A,this.width=E,this.height=F;const s=A.gl,i=this.framebuffer=s.createFramebuffer();if(this.colorAttachment=new Qa(A,i),O)this.depthAttachment=y?new gu(A,i):new Cs(A,i);else if(y)throw new Error("Stencil cannot be setted without depth");if(s.checkFramebufferStatus(s.FRAMEBUFFER)!==s.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const A=this.context.gl,E=this.colorAttachment.get();if(E&&A.deleteTexture(E),this.depthAttachment){const F=this.depthAttachment.get();F&&A.deleteRenderbuffer(F)}A.deleteFramebuffer(this.framebuffer)}}class $n{constructor(A,E,F){this.blendFunction=A,this.blendColor=E,this.mask=F}}$n.Replace=[1,0],$n.disabled=new $n($n.Replace,a.aT.transparent,[!1,!1,!1,!1]),$n.unblended=new $n($n.Replace,a.aT.transparent,[!0,!0,!0,!0]),$n.alphaBlended=new $n([1,771],a.aT.transparent,[!0,!0,!0,!0]);class Ko{constructor(A){var E,F;if(this.gl=A,this.clearColor=new Lr(this),this.clearDepth=new Zs(this),this.clearStencil=new vr(this),this.colorMask=new Ks(this),this.depthMask=new Br(this),this.stencilMask=new Eo(this),this.stencilFunc=new Zo(this),this.stencilOp=new Bs(this),this.stencilTest=new Il(this),this.depthRange=new mo(this),this.depthTest=new Qo(this),this.depthFunc=new ca(this),this.blend=new Ys(this),this.blendFunc=new El(this),this.blendColor=new Za(this),this.blendEquation=new Ta(this),this.cullFace=new ml(this),this.cullFaceSide=new Cl(this),this.frontFace=new mu(this),this.program=new As(this),this.activeTexture=new ac(this),this.viewport=new ro(this),this.bindFramebuffer=new so(this),this.bindRenderbuffer=new Ql(this),this.bindTexture=new Oo(this),this.bindVertexBuffer=new Wo(this),this.bindElementBuffer=new Co(this),this.bindVertexArray=new Gs(this),this.pixelStoreUnpack=new $o(this),this.pixelStoreUnpackPremultiplyAlpha=new Xo(this),this.pixelStoreUnpackFlipY=new Yo(this),this.extTextureFilterAnisotropic=A.getExtension("EXT_texture_filter_anisotropic")||A.getExtension("MOZ_EXT_texture_filter_anisotropic")||A.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=A.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=A.getParameter(A.MAX_TEXTURE_SIZE),nr(A)){this.HALF_FLOAT=A.HALF_FLOAT;const O=A.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(E=A.RGBA16F)!==null&&E!==void 0?E:O==null?void 0:O.RGBA16F_EXT,this.RGB16F=(F=A.RGB16F)!==null&&F!==void 0?F:O==null?void 0:O.RGB16F_EXT,A.getExtension("EXT_color_buffer_float")}else{A.getExtension("EXT_color_buffer_half_float"),A.getExtension("OES_texture_half_float_linear");const O=A.getExtension("OES_texture_half_float");this.HALF_FLOAT=O==null?void 0:O.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(A,E){return new Ha(this,A,E)}createVertexBuffer(A,E,F){return new pl(this,A,E,F)}createRenderbuffer(A,E,F){const O=this.gl,y=O.createRenderbuffer();return this.bindRenderbuffer.set(y),O.renderbufferStorage(O.RENDERBUFFER,A,E,F),this.bindRenderbuffer.set(null),y}createFramebuffer(A,E,F,O){return new Er(this,A,E,F,O)}clear({color:A,depth:E,stencil:F}){const O=this.gl;let y=0;A&&(y|=O.COLOR_BUFFER_BIT,this.clearColor.set(A),this.colorMask.set([!0,!0,!0,!0])),E!==void 0&&(y|=O.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(E),this.depthMask.set(!0)),F!==void 0&&(y|=O.STENCIL_BUFFER_BIT,this.clearStencil.set(F),this.stencilMask.set(255)),O.clear(y)}setCullFace(A){A.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(A.mode),this.frontFace.set(A.frontFace))}setDepthMode(A){A.func!==this.gl.ALWAYS||A.mask?(this.depthTest.set(!0),this.depthFunc.set(A.func),this.depthMask.set(A.mask),this.depthRange.set(A.range)):this.depthTest.set(!1)}setStencilMode(A){A.test.func!==this.gl.ALWAYS||A.mask?(this.stencilTest.set(!0),this.stencilMask.set(A.mask),this.stencilOp.set([A.fail,A.depthFail,A.pass]),this.stencilFunc.set({func:A.test.func,ref:A.ref,mask:A.test.mask})):this.stencilTest.set(!1)}setColorMode(A){a.aG(A.blendFunction,$n.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(A.blendFunction),this.blendColor.set(A.blendColor)),this.colorMask.set(A.mask)}createVertexArray(){var A;return nr(this.gl)?this.gl.createVertexArray():(A=this.gl.getExtension("OES_vertex_array_object"))===null||A===void 0?void 0:A.createVertexArrayOES()}deleteVertexArray(A){var E;return nr(this.gl)?this.gl.deleteVertexArray(A):(E=this.gl.getExtension("OES_vertex_array_object"))===null||E===void 0?void 0:E.deleteVertexArrayOES(A)}unbindVAO(){this.bindVertexArray.set(null)}}class zr{constructor(A,E,F){this.func=A,this.mask=E,this.range=F}}zr.ReadOnly=!1,zr.ReadWrite=!0,zr.disabled=new zr(519,zr.ReadOnly,[0,1]);const Wa=7680;class Jr{constructor(A,E,F,O,y,s){this.test=A,this.ref=E,this.mask=F,this.fail=O,this.depthFail=y,this.pass=s}}Jr.disabled=new Jr({func:519,mask:0},0,0,Wa,Wa,Wa);class fr{constructor(A,E,F){this.enable=A,this.mode=E,this.frontFace=F}}let To;function Gn(Z,A,E,F,O,y,s){const i=Z.context,r=i.gl,l=Z.useProgram("collisionBox"),d=[];let _=0,w=0;for(let Te=0;Te<F.length;Te++){const Re=F[Te],Be=A.getTile(Re),Ke=Be.getBucket(E);if(!Ke)continue;let yt=Re.posMatrix;O[0]===0&&O[1]===0||(yt=Z.translatePosMatrix(Re.posMatrix,Be,O,y));const ot=s?Ke.textCollisionBox:Ke.iconCollisionBox,ct=Ke.collisionCircleArray;if(ct.length>0){const It=a.Z(),bt=yt;a.aU(It,Ke.placementInvProjMatrix,Z.transform.glCoordMatrix),a.aU(It,It,Ke.placementViewportMatrix),d.push({circleArray:ct,circleOffset:w,transform:bt,invTransform:It,coord:Re}),_+=ct.length/4,w=_}ot&&l.draw(i,r.LINES,zr.disabled,Jr.disabled,Z.colorModeForRenderPass(),fr.disabled,hs(yt,Z.transform,Be),Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(Re),E.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,null,Z.transform.zoom,null,null,ot.collisionVertexBuffer)}if(!s||!d.length)return;const T=Z.useProgram("collisionCircle"),B=new a.aV;B.resize(4*_),B._trim();let j=0;for(const Te of d)for(let Re=0;Re<Te.circleArray.length/4;Re++){const Be=4*Re,Ke=Te.circleArray[Be+0],yt=Te.circleArray[Be+1],ot=Te.circleArray[Be+2],ct=Te.circleArray[Be+3];B.emplace(j++,Ke,yt,ot,ct,0),B.emplace(j++,Ke,yt,ot,ct,1),B.emplace(j++,Ke,yt,ot,ct,2),B.emplace(j++,Ke,yt,ot,ct,3)}(!To||To.length<2*_)&&(To=function(Te){const Re=2*Te,Be=new a.aX;Be.resize(Re),Be._trim();for(let Ke=0;Ke<Re;Ke++){const yt=6*Ke;Be.uint16[yt+0]=4*Ke+0,Be.uint16[yt+1]=4*Ke+1,Be.uint16[yt+2]=4*Ke+2,Be.uint16[yt+3]=4*Ke+2,Be.uint16[yt+4]=4*Ke+3,Be.uint16[yt+5]=4*Ke+0}return Be}(_));const X=i.createIndexBuffer(To,!0),ce=i.createVertexBuffer(B,a.aW.members,!0);for(const Te of d){const Re={u_matrix:Te.transform,u_inv_matrix:Te.invTransform,u_camera_to_center_distance:(Se=Z.transform).cameraToCenterDistance,u_viewport_size:[Se.width,Se.height]};T.draw(i,r.TRIANGLES,zr.disabled,Jr.disabled,Z.colorModeForRenderPass(),fr.disabled,Re,Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(Te.coord),E.id,ce,X,a.S.simpleSegment(0,2*Te.circleOffset,Te.circleArray.length,Te.circleArray.length/2),null,Z.transform.zoom,null,null,null)}var Se;ce.destroy(),X.destroy()}fr.disabled=new fr(!1,1029,2305),fr.backCCW=new fr(!0,1029,2305);const Ol=a.ao(new Float32Array(16));function es(Z,A,E,F,O,y){const{horizontalAlign:s,verticalAlign:i}=a.au(Z);return new a.P((-(s-.5)*A/O+F[0])*y,(-(i-.5)*E/O+F[1])*y)}function Zr(Z,A,E,F,O,y,s,i,r,l,d){const _=Z.text.placedSymbolArray,w=Z.text.dynamicLayoutVertexArray,T=Z.icon.dynamicLayoutVertexArray,B={};w.clear();for(let j=0;j<_.length;j++){const X=_.get(j),ce=X.hidden||!X.crossTileID||Z.allowVerticalPlacement&&!X.placedOrientation?null:F[X.crossTileID];if(ce){const Se=new a.P(X.anchorX,X.anchorY),Te=Ee(Se,E?s:y,d),Re=ze(O.cameraToCenterDistance,Te.signedDistanceFromCamera);let Be=a.aj(Z.textSizeData,r,X)*Re/a.ap;E&&(Be*=Z.tilePixelRatio/i);const{width:Ke,height:yt,anchor:ot,textOffset:ct,textBoxScale:It}=ce,bt=es(ot,Ke,yt,ct,It,Be),ri=E?Ee(Se.add(bt),y,d).point:Te.point.add(A?bt.rotate(-O.angle):bt),Xt=Z.allowVerticalPlacement&&X.placedOrientation===a.ai.vertical?Math.PI/2:0;for(let ti=0;ti<X.numGlyphs;ti++)a.ak(w,ri,Xt);l&&X.associatedIconIndex>=0&&(B[X.associatedIconIndex]={shiftedAnchor:ri,angle:Xt})}else de(X.numGlyphs,w)}if(l){T.clear();const j=Z.icon.placedSymbolArray;for(let X=0;X<j.length;X++){const ce=j.get(X);if(ce.hidden)de(ce.numGlyphs,T);else{const Se=B[X];if(Se)for(let Te=0;Te<ce.numGlyphs;Te++)a.ak(T,Se.shiftedAnchor,Se.angle);else de(ce.numGlyphs,T)}}Z.icon.dynamicLayoutVertexBuffer.updateData(T)}Z.text.dynamicLayoutVertexBuffer.updateData(w)}function Ts(Z,A,E){return E.iconsInText&&A?"symbolTextAndIcon":Z?"symbolSDF":"symbolIcon"}function kr(Z,A,E,F,O,y,s,i,r,l,d,_){const w=Z.context,T=w.gl,B=Z.transform,j=i==="map",X=r==="map",ce=i!=="viewport"&&E.layout.get("symbol-placement")!=="point",Se=j&&!X&&!ce,Te=!E.layout.get("symbol-sort-key").isConstant();let Re=!1;const Be=Z.depthModeForSublayer(0,zr.ReadOnly),Ke=E._unevaluatedLayout.hasValue("text-variable-anchor")||E._unevaluatedLayout.hasValue("text-variable-anchor-offset"),yt=[];for(const ot of F){const ct=A.getTile(ot),It=ct.getBucket(E);if(!It)continue;const bt=O?It.text:It.icon;if(!bt||!bt.segments.get().length||!bt.hasVisibleVertices)continue;const ri=bt.programConfigurations.get(E.id),Xt=O||It.sdfIcons,ti=O?It.textSizeData:It.iconSizeData,si=X||B.pitch!==0,Qi=Z.useProgram(Ts(Xt,O,It),ri),Wi=a.ah(ti,B.zoom),Ei=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(ot);let Gi,qi,cn,zn,tn=[0,0],kn=null;if(O)qi=ct.glyphAtlasTexture,cn=T.LINEAR,Gi=ct.glyphAtlasTexture.size,It.iconsInText&&(tn=ct.imageAtlasTexture.size,kn=ct.imageAtlasTexture,zn=si||Z.options.rotating||Z.options.zooming||ti.kind==="composite"||ti.kind==="camera"?T.LINEAR:T.NEAREST);else{const Qs=E.layout.get("icon-size").constantOr(0)!==1||It.iconsNeedLinear;qi=ct.imageAtlasTexture,cn=Xt||Z.options.rotating||Z.options.zooming||Qs||si?T.LINEAR:T.NEAREST,Gi=ct.imageAtlasTexture.size}const yr=Fe(ct,1,Z.transform.zoom),er=ve(ot.posMatrix,X,j,Z.transform,yr),Ia=Ie(ot.posMatrix,X,j,Z.transform,yr),Aa=Ke&&It.hasTextData(),zs=E.layout.get("icon-text-fit")!=="none"&&Aa&&It.hasIconData();if(ce){const Qs=Z.style.map.terrain?(is,Rr)=>Z.style.map.terrain.getElevation(ot,is,Rr):null,ts=E.layout.get("text-rotation-alignment")==="map";He(It,ot.posMatrix,Z,O,er,Ia,X,l,ts,Qs)}const oo=Z.translatePosMatrix(ot.posMatrix,ct,y,s),lo=ce||O&&Ke||zs?Ol:er,qr=Z.translatePosMatrix(Ia,ct,y,s,!0),ya=Xt&&E.paint.get(O?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let xo;xo=Xt?It.iconsInText?sr(ti.kind,Wi,Se,X,Z,oo,lo,qr,Gi,tn):pn(ti.kind,Wi,Se,X,Z,oo,lo,qr,O,Gi,!0):An(ti.kind,Wi,Se,X,Z,oo,lo,qr,O,Gi);const bo={program:Qi,buffers:bt,uniformValues:xo,atlasTexture:qi,atlasTextureIcon:kn,atlasInterpolation:cn,atlasInterpolationIcon:zn,isSDF:Xt,hasHalo:ya};if(Te&&It.canOverlap){Re=!0;const Qs=bt.segments.get();for(const ts of Qs)yt.push({segments:new a.S([ts]),sortKey:ts.sortKey,state:bo,terrainData:Ei})}else yt.push({segments:bt.segments,sortKey:0,state:bo,terrainData:Ei})}Re&&yt.sort((ot,ct)=>ot.sortKey-ct.sortKey);for(const ot of yt){const ct=ot.state;if(w.activeTexture.set(T.TEXTURE0),ct.atlasTexture.bind(ct.atlasInterpolation,T.CLAMP_TO_EDGE),ct.atlasTextureIcon&&(w.activeTexture.set(T.TEXTURE1),ct.atlasTextureIcon&&ct.atlasTextureIcon.bind(ct.atlasInterpolationIcon,T.CLAMP_TO_EDGE)),ct.isSDF){const It=ct.uniformValues;ct.hasHalo&&(It.u_is_halo=1,rr(ct.buffers,ot.segments,E,Z,ct.program,Be,d,_,It,ot.terrainData)),It.u_is_halo=0}rr(ct.buffers,ot.segments,E,Z,ct.program,Be,d,_,ct.uniformValues,ot.terrainData)}}function rr(Z,A,E,F,O,y,s,i,r,l){const d=F.context;O.draw(d,d.gl.TRIANGLES,y,s,i,fr.disabled,r,l,E.id,Z.layoutVertexBuffer,Z.indexBuffer,A,E.paint,F.transform.zoom,Z.programConfigurations.get(E.id),Z.dynamicLayoutVertexBuffer,Z.opacityVertexBuffer)}function ll(Z,A,E,F,O){if(!E||!F||!F.imageAtlas)return;const y=F.imageAtlas.patternPositions;let s=y[E.to.toString()],i=y[E.from.toString()];if(!s&&i&&(s=i),!i&&s&&(i=s),!s||!i){const r=O.getPaintProperty(A);s=y[r],i=y[r]}s&&i&&Z.setConstantPatternPositions(s,i)}function Xr(Z,A,E,F,O,y,s){const i=Z.context.gl,r="fill-pattern",l=E.paint.get(r),d=l&&l.constantOr(1),_=E.getCrossfadeParameters();let w,T,B,j,X;s?(T=d&&!E.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",w=i.LINES):(T=d?"fillPattern":"fill",w=i.TRIANGLES);const ce=l.constantOr(null);for(const Se of F){const Te=A.getTile(Se);if(d&&!Te.patternsLoaded())continue;const Re=Te.getBucket(E);if(!Re)continue;const Be=Re.programConfigurations.get(E.id),Ke=Z.useProgram(T,Be),yt=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(Se);d&&(Z.context.activeTexture.set(i.TEXTURE0),Te.imageAtlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE),Be.updatePaintBuffers(_)),ll(Be,r,ce,Te,E);const ot=yt?Se:null,ct=Z.translatePosMatrix(ot?ot.posMatrix:Se.posMatrix,Te,E.paint.get("fill-translate"),E.paint.get("fill-translate-anchor"));if(s){j=Re.indexBuffer2,X=Re.segments2;const It=[i.drawingBufferWidth,i.drawingBufferHeight];B=T==="fillOutlinePattern"&&d?Zn(ct,Z,_,Te,It):Xs(ct,It)}else j=Re.indexBuffer,X=Re.segments,B=d?Va(ct,Z,_,Te):Fo(ct);Ke.draw(Z.context,w,O,Z.stencilModeForClipping(Se),y,fr.disabled,B,yt,E.id,Re.layoutVertexBuffer,j,X,E.paint,Z.transform.zoom,Be)}}function ko(Z,A,E,F,O,y,s){const i=Z.context,r=i.gl,l="fill-extrusion-pattern",d=E.paint.get(l),_=d.constantOr(1),w=E.getCrossfadeParameters(),T=E.paint.get("fill-extrusion-opacity"),B=d.constantOr(null);for(const j of F){const X=A.getTile(j),ce=X.getBucket(E);if(!ce)continue;const Se=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(j),Te=ce.programConfigurations.get(E.id),Re=Z.useProgram(_?"fillExtrusionPattern":"fillExtrusion",Te);_&&(Z.context.activeTexture.set(r.TEXTURE0),X.imageAtlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE),Te.updatePaintBuffers(w)),ll(Te,l,B,X,E);const Be=Z.translatePosMatrix(j.posMatrix,X,E.paint.get("fill-extrusion-translate"),E.paint.get("fill-extrusion-translate-anchor")),Ke=E.paint.get("fill-extrusion-vertical-gradient"),yt=_?Na(Be,Z,Ke,T,j,w,X):Dr(Be,Z,Ke,T);Re.draw(i,i.gl.TRIANGLES,O,y,s,fr.backCCW,yt,Se,E.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,E.paint,Z.transform.zoom,Te,Z.style.map.terrain&&ce.centroidVertexBuffer)}}function ul(Z,A,E,F,O,y,s){const i=Z.context,r=i.gl,l=E.fbo;if(!l)return;const d=Z.useProgram("hillshade"),_=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(A);i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,l.colorAttachment.get()),d.draw(i,r.TRIANGLES,O,y,s,fr.disabled,((w,T,B,j)=>{const X=B.paint.get("hillshade-shadow-color"),ce=B.paint.get("hillshade-highlight-color"),Se=B.paint.get("hillshade-accent-color");let Te=B.paint.get("hillshade-illumination-direction")*(Math.PI/180);B.paint.get("hillshade-illumination-anchor")==="viewport"&&(Te-=w.transform.angle);const Re=!w.options.moving;return{u_matrix:j?j.posMatrix:w.transform.calculatePosMatrix(T.tileID.toUnwrapped(),Re),u_image:0,u_latrange:no(0,T.tileID),u_light:[B.paint.get("hillshade-exaggeration"),Te],u_shadow:X,u_highlight:ce,u_accent:Se}})(Z,E,F,_?A:null),_,F.id,Z.rasterBoundsBuffer,Z.quadTriangleIndexBuffer,Z.rasterBoundsSegments)}function Qr(Z,A,E,F,O,y){const s=Z.context,i=s.gl,r=A.dem;if(r&&r.data){const l=r.dim,d=r.stride,_=r.getPixels();if(s.activeTexture.set(i.TEXTURE1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),A.demTexture=A.demTexture||Z.getTileTexture(d),A.demTexture){const T=A.demTexture;T.update(_,{premultiply:!1}),T.bind(i.NEAREST,i.CLAMP_TO_EDGE)}else A.demTexture=new mt(s,_,i.RGBA,{premultiply:!1}),A.demTexture.bind(i.NEAREST,i.CLAMP_TO_EDGE);s.activeTexture.set(i.TEXTURE0);let w=A.fbo;if(!w){const T=new mt(s,{width:l,height:l,data:null},i.RGBA);T.bind(i.LINEAR,i.CLAMP_TO_EDGE),w=A.fbo=s.createFramebuffer(l,l,!0,!1),w.colorAttachment.set(T.texture)}s.bindFramebuffer.set(w.framebuffer),s.viewport.set([0,0,l,l]),Z.useProgram("hillshadePrepare").draw(s,i.TRIANGLES,F,O,y,fr.disabled,((T,B)=>{const j=B.stride,X=a.Z();return a.aS(X,0,a.N,-a.N,0,0,1),a.$(X,X,[0,-a.N,0]),{u_matrix:X,u_image:1,u_dimension:[j,j],u_zoom:T.overscaledZ,u_unpack:B.getUnpackVector()}})(A.tileID,r),null,E.id,Z.rasterBoundsBuffer,Z.quadTriangleIndexBuffer,Z.rasterBoundsSegments),A.needsHillshadePrepare=!1}}function ds(Z,A,E,F,O,y){const s=F.paint.get("raster-fade-duration");if(!y&&s>0){const i=a.h.now(),r=(i-Z.timeAdded)/s,l=A?(i-A.timeAdded)/s:-1,d=E.getSource(),_=O.coveringZoomLevel({tileSize:d.tileSize,roundZoom:d.roundZoom}),w=!A||Math.abs(A.tileID.overscaledZ-_)>Math.abs(Z.tileID.overscaledZ-_),T=w&&Z.refreshedUponExpiration?1:a.ad(w?r:1-l,0,1);return Z.refreshedUponExpiration&&r>=1&&(Z.refreshedUponExpiration=!1),A?{opacity:1,mix:1-T}:{opacity:T,mix:0}}return{opacity:1,mix:0}}const wa=new a.aT(1,0,0,1),Tl=new a.aT(0,1,0,1),Mo=new a.aT(0,0,1,1),kl=new a.aT(1,0,1,1),go=new a.aT(0,1,1,1);function Js(Z,A,E,F){$a(Z,0,A+E/2,Z.transform.width,E,F)}function qs(Z,A,E,F){$a(Z,A-E/2,0,E,Z.transform.height,F)}function $a(Z,A,E,F,O,y){const s=Z.context,i=s.gl;i.enable(i.SCISSOR_TEST),i.scissor(A*Z.pixelRatio,E*Z.pixelRatio,F*Z.pixelRatio,O*Z.pixelRatio),s.clear({color:y}),i.disable(i.SCISSOR_TEST)}function Jo(Z,A,E){const F=Z.context,O=F.gl,y=E.posMatrix,s=Z.useProgram("debug"),i=zr.disabled,r=Jr.disabled,l=Z.colorModeForRenderPass(),d="$debug",_=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(E);F.activeTexture.set(O.TEXTURE0);const w=A.getTileByID(E.key).latestRawTileData,T=Math.floor((w&&w.byteLength||0)/1024),B=A.getTile(E).tileSize,j=512/Math.min(B,512)*(E.overscaledZ/Z.transform.zoom)*.5;let X=E.canonical.toString();E.overscaledZ!==E.canonical.z&&(X+=` => ${E.overscaledZ}`),function(ce,Se){ce.initDebugOverlayCanvas();const Te=ce.debugOverlayCanvas,Re=ce.context.gl,Be=ce.debugOverlayCanvas.getContext("2d");Be.clearRect(0,0,Te.width,Te.height),Be.shadowColor="white",Be.shadowBlur=2,Be.lineWidth=1.5,Be.strokeStyle="white",Be.textBaseline="top",Be.font="bold 36px Open Sans, sans-serif",Be.fillText(Se,5,5),Be.strokeText(Se,5,5),ce.debugOverlayTexture.update(Te),ce.debugOverlayTexture.bind(Re.LINEAR,Re.CLAMP_TO_EDGE)}(Z,`${X} ${T}kB`),s.draw(F,O.TRIANGLES,i,r,$n.alphaBlended,fr.disabled,Ua(y,a.aT.transparent,j),null,d,Z.debugBuffer,Z.quadTriangleIndexBuffer,Z.debugSegments),s.draw(F,O.LINE_STRIP,i,r,l,fr.disabled,Ua(y,a.aT.red),_,d,Z.debugBuffer,Z.tileBorderIndexBuffer,Z.debugSegments)}function Yr(Z,A,E){const F=Z.context,O=F.gl,y=Z.colorModeForRenderPass(),s=new zr(O.LEQUAL,zr.ReadWrite,Z.depthRangeFor3D),i=Z.useProgram("terrain"),r=A.getTerrainMesh();F.bindFramebuffer.set(null),F.viewport.set([0,0,Z.width,Z.height]);for(const l of E){const d=Z.renderToTexture.getTexture(l),_=A.getTerrainData(l.tileID);F.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,d.texture);const w={u_matrix:Z.transform.calculatePosMatrix(l.tileID.toUnwrapped()),u_texture:0,u_ele_delta:A.getMeshFrameDelta(Z.transform.zoom)};i.draw(F,O.TRIANGLES,s,Jr.disabled,y,fr.backCCW,w,_,"terrain",r.vertexBuffer,r.indexBuffer,r.segments)}}class mr{constructor(A,E){this.context=new Ko(A),this.transform=E,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.Z(),renderTime:0},this.setup(),this.numSublayers=rn.maxUnderzooming+rn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Vn}resize(A,E,F){if(this.width=Math.floor(A*F),this.height=Math.floor(E*F),this.pixelRatio=F,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const O of this.style._order)this.style._layers[O].resize()}setup(){const A=this.context,E=new a.a_;E.emplaceBack(0,0),E.emplaceBack(a.N,0),E.emplaceBack(0,a.N),E.emplaceBack(a.N,a.N),this.tileExtentBuffer=A.createVertexBuffer(E,Vs.members),this.tileExtentSegments=a.S.simpleSegment(0,0,4,2);const F=new a.a_;F.emplaceBack(0,0),F.emplaceBack(a.N,0),F.emplaceBack(0,a.N),F.emplaceBack(a.N,a.N),this.debugBuffer=A.createVertexBuffer(F,Vs.members),this.debugSegments=a.S.simpleSegment(0,0,4,5);const O=new a.V;O.emplaceBack(0,0,0,0),O.emplaceBack(a.N,0,a.N,0),O.emplaceBack(0,a.N,0,a.N),O.emplaceBack(a.N,a.N,a.N,a.N),this.rasterBoundsBuffer=A.createVertexBuffer(O,Ci.members),this.rasterBoundsSegments=a.S.simpleSegment(0,0,4,2);const y=new a.a_;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=A.createVertexBuffer(y,Vs.members),this.viewportSegments=a.S.simpleSegment(0,0,4,2);const s=new a.a$;s.emplaceBack(0),s.emplaceBack(1),s.emplaceBack(3),s.emplaceBack(2),s.emplaceBack(0),this.tileBorderIndexBuffer=A.createIndexBuffer(s);const i=new a.b0;i.emplaceBack(0,1,2),i.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=A.createIndexBuffer(i);const r=this.context.gl;this.stencilClearMode=new Jr({func:r.ALWAYS,mask:0},0,255,r.ZERO,r.ZERO,r.ZERO)}clearStencil(){const A=this.context,E=A.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const F=a.Z();a.aS(F,0,this.width,this.height,0,0,1),a.a0(F,F,[E.drawingBufferWidth,E.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(A,E.TRIANGLES,zr.disabled,this.stencilClearMode,$n.disabled,fr.disabled,al(F),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(A,E){if(this.currentStencilSource===A.source||!A.isTileClipped()||!E||!E.length)return;this.currentStencilSource=A.source;const F=this.context,O=F.gl;this.nextStencilID+E.length>256&&this.clearStencil(),F.setColorMode($n.disabled),F.setDepthMode(zr.disabled);const y=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const s of E){const i=this._tileClippingMaskIDs[s.key]=this.nextStencilID++,r=this.style.map.terrain&&this.style.map.terrain.getTerrainData(s);y.draw(F,O.TRIANGLES,zr.disabled,new Jr({func:O.ALWAYS,mask:0},i,255,O.KEEP,O.KEEP,O.REPLACE),$n.disabled,fr.disabled,al(s.posMatrix),r,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const A=this.nextStencilID++,E=this.context.gl;return new Jr({func:E.NOTEQUAL,mask:255},A,255,E.KEEP,E.KEEP,E.REPLACE)}stencilModeForClipping(A){const E=this.context.gl;return new Jr({func:E.EQUAL,mask:255},this._tileClippingMaskIDs[A.key],0,E.KEEP,E.KEEP,E.REPLACE)}stencilConfigForOverlap(A){const E=this.context.gl,F=A.sort((s,i)=>i.overscaledZ-s.overscaledZ),O=F[F.length-1].overscaledZ,y=F[0].overscaledZ-O+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const s={};for(let i=0;i<y;i++)s[i+O]=new Jr({func:E.GEQUAL,mask:255},i+this.nextStencilID,255,E.KEEP,E.KEEP,E.REPLACE);return this.nextStencilID+=y,[s,F]}return[{[O]:Jr.disabled},F]}colorModeForRenderPass(){const A=this.context.gl;return this._showOverdrawInspector?new $n([A.CONSTANT_COLOR,A.ONE],new a.aT(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?$n.unblended:$n.alphaBlended}depthModeForSublayer(A,E,F){if(!this.opaquePassEnabledForLayer())return zr.disabled;const O=1-((1+this.currentLayer)*this.numSublayers+A)*this.depthEpsilon;return new zr(F||this.context.gl.LEQUAL,E,[O,O])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(A,E){this.style=A,this.options=E,this.lineAtlas=A.lineAtlas,this.imageManager=A.imageManager,this.glyphManager=A.glyphManager,this.symbolFadeChange=A.placement.symbolFadeChange(a.h.now()),this.imageManager.beginFrame();const F=this.style._order,O=this.style.sourceCaches,y={},s={},i={};for(const r in O){const l=O[r];l.used&&l.prepare(this.context),y[r]=l.getVisibleCoordinates(),s[r]=y[r].slice().reverse(),i[r]=l.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let r=0;r<F.length;r++)if(this.style._layers[F[r]].is3D()){this.opaquePassCutoff=r;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const r=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!a.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||r.length)&&(a.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(l,d){const _=l.context,w=_.gl,T=$n.unblended,B=new zr(w.LEQUAL,zr.ReadWrite,[0,1]),j=d.getTerrainMesh(),X=d.sourceCache.getRenderableTiles(),ce=l.useProgram("terrainDepth");_.bindFramebuffer.set(d.getFramebuffer("depth").framebuffer),_.viewport.set([0,0,l.width/devicePixelRatio,l.height/devicePixelRatio]),_.clear({color:a.aT.transparent,depth:1});for(const Se of X){const Te=d.getTerrainData(Se.tileID),Re={u_matrix:l.transform.calculatePosMatrix(Se.tileID.toUnwrapped()),u_ele_delta:d.getMeshFrameDelta(l.transform.zoom)};ce.draw(_,w.TRIANGLES,B,Jr.disabled,T,fr.backCCW,Re,Te,"terrain",j.vertexBuffer,j.indexBuffer,j.segments)}_.bindFramebuffer.set(null),_.viewport.set([0,0,l.width,l.height])}(this,this.style.map.terrain),function(l,d){const _=l.context,w=_.gl,T=$n.unblended,B=new zr(w.LEQUAL,zr.ReadWrite,[0,1]),j=d.getTerrainMesh(),X=d.getCoordsTexture(),ce=d.sourceCache.getRenderableTiles(),Se=l.useProgram("terrainCoords");_.bindFramebuffer.set(d.getFramebuffer("coords").framebuffer),_.viewport.set([0,0,l.width/devicePixelRatio,l.height/devicePixelRatio]),_.clear({color:a.aT.transparent,depth:1}),d.coordsIndex=[];for(const Te of ce){const Re=d.getTerrainData(Te.tileID);_.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,X.texture);const Be={u_matrix:l.transform.calculatePosMatrix(Te.tileID.toUnwrapped()),u_terrain_coords_id:(255-d.coordsIndex.length)/255,u_texture:0,u_ele_delta:d.getMeshFrameDelta(l.transform.zoom)};Se.draw(_,w.TRIANGLES,B,Jr.disabled,T,fr.backCCW,Be,Re,"terrain",j.vertexBuffer,j.indexBuffer,j.segments),d.coordsIndex.push(Te.tileID.key)}_.bindFramebuffer.set(null),_.viewport.set([0,0,l.width,l.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const r of F){const l=this.style._layers[r];if(!l.hasOffscreenPass()||l.isHidden(this.transform.zoom))continue;const d=s[l.source];(l.type==="custom"||d.length)&&this.renderLayer(this,O[l.source],l,d)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:E.showOverdrawInspector?a.aT.black:a.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=E.showOverdrawInspector,this.depthRangeFor3D=[0,1-(A._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=F.length-1;this.currentLayer>=0;this.currentLayer--){const r=this.style._layers[F[this.currentLayer]],l=O[r.source],d=y[r.source];this._renderTileClippingMasks(r,d),this.renderLayer(this,l,r,d)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<F.length;this.currentLayer++){const r=this.style._layers[F[this.currentLayer]],l=O[r.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(r))continue;const d=(r.type==="symbol"?i:s)[r.source];this._renderTileClippingMasks(r,y[r.source]),this.renderLayer(this,l,r,d)}if(this.options.showTileBoundaries){const r=function(l,d){let _=null;const w=Object.values(l._layers).flatMap(X=>X.source&&!X.isHidden(d)?[l.sourceCaches[X.source]]:[]),T=w.filter(X=>X.getSource().type==="vector"),B=w.filter(X=>X.getSource().type!=="vector"),j=X=>{(!_||_.getSource().maxzoom<X.getSource().maxzoom)&&(_=X)};return T.forEach(X=>j(X)),_||B.forEach(X=>j(X)),_}(this.style,this.transform.zoom);r&&function(l,d,_){for(let w=0;w<_.length;w++)Jo(l,d,_[w])}(this,r,r.getVisibleCoordinates())}this.options.showPadding&&function(r){const l=r.transform.padding;Js(r,r.transform.height-(l.top||0),3,wa),Js(r,l.bottom||0,3,Tl),qs(r,l.left||0,3,Mo),qs(r,r.transform.width-(l.right||0),3,kl);const d=r.transform.centerPoint;(function(_,w,T,B){$a(_,w-1,T-10,2,20,B),$a(_,w-10,T-1,20,2,B)})(r,d.x,r.transform.height-d.y,go)}(this),this.context.setDefault()}renderLayer(A,E,F,O){if(!F.isHidden(this.transform.zoom)&&(F.type==="background"||F.type==="custom"||(O||[]).length))switch(this.id=F.id,F.type){case"symbol":(function(y,s,i,r,l){if(y.renderPass!=="translucent")return;const d=Jr.disabled,_=y.colorModeForRenderPass();(i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(w,T,B,j,X,ce,Se){const Te=T.transform,Re=X==="map",Be=ce==="map";for(const Ke of w){const yt=j.getTile(Ke),ot=yt.getBucket(B);if(!ot||!ot.text||!ot.text.segments.get().length)continue;const ct=a.ah(ot.textSizeData,Te.zoom),It=Fe(yt,1,T.transform.zoom),bt=ve(Ke.posMatrix,Be,Re,T.transform,It),ri=B.layout.get("icon-text-fit")!=="none"&&ot.hasIconData();if(ct){const Xt=Math.pow(2,Te.zoom-yt.tileID.overscaledZ);Zr(ot,Re,Be,Se,Te,bt,Ke.posMatrix,Xt,ct,ri,T.style.map.terrain?(ti,si)=>T.style.map.terrain.getElevation(Ke,ti,si):null)}}}(r,y,i,s,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),l),i.paint.get("icon-opacity").constantOr(1)!==0&&kr(y,s,i,r,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),d,_),i.paint.get("text-opacity").constantOr(1)!==0&&kr(y,s,i,r,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),d,_),s.map.showCollisionBoxes&&(Gn(y,s,i,r,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),Gn(y,s,i,r,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))})(A,E,F,O,this.style.placement.variableOffsets);break;case"circle":(function(y,s,i,r){if(y.renderPass!=="translucent")return;const l=i.paint.get("circle-opacity"),d=i.paint.get("circle-stroke-width"),_=i.paint.get("circle-stroke-opacity"),w=!i.layout.get("circle-sort-key").isConstant();if(l.constantOr(1)===0&&(d.constantOr(1)===0||_.constantOr(1)===0))return;const T=y.context,B=T.gl,j=y.depthModeForSublayer(0,zr.ReadOnly),X=Jr.disabled,ce=y.colorModeForRenderPass(),Se=[];for(let Te=0;Te<r.length;Te++){const Re=r[Te],Be=s.getTile(Re),Ke=Be.getBucket(i);if(!Ke)continue;const yt=Ke.programConfigurations.get(i.id),ot=y.useProgram("circle",yt),ct=Ke.layoutVertexBuffer,It=Ke.indexBuffer,bt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Re),ri={programConfiguration:yt,program:ot,layoutVertexBuffer:ct,indexBuffer:It,uniformValues:aa(y,Re,Be,i),terrainData:bt};if(w){const Xt=Ke.segments.get();for(const ti of Xt)Se.push({segments:new a.S([ti]),sortKey:ti.sortKey,state:ri})}else Se.push({segments:Ke.segments,sortKey:0,state:ri})}w&&Se.sort((Te,Re)=>Te.sortKey-Re.sortKey);for(const Te of Se){const{programConfiguration:Re,program:Be,layoutVertexBuffer:Ke,indexBuffer:yt,uniformValues:ot,terrainData:ct}=Te.state;Be.draw(T,B.TRIANGLES,j,X,ce,fr.disabled,ot,ct,i.id,Ke,yt,Te.segments,i.paint,y.transform.zoom,Re)}})(A,E,F,O);break;case"heatmap":(function(y,s,i,r){if(i.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){const l=y.context,d=l.gl,_=Jr.disabled,w=new $n([d.ONE,d.ONE],a.aT.transparent,[!0,!0,!0,!0]);(function(T,B,j){const X=T.gl;T.activeTexture.set(X.TEXTURE1),T.viewport.set([0,0,B.width/4,B.height/4]);let ce=j.heatmapFbo;if(ce)X.bindTexture(X.TEXTURE_2D,ce.colorAttachment.get()),T.bindFramebuffer.set(ce.framebuffer);else{const Se=X.createTexture();X.bindTexture(X.TEXTURE_2D,Se),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MAG_FILTER,X.LINEAR),ce=j.heatmapFbo=T.createFramebuffer(B.width/4,B.height/4,!1,!1),function(Te,Re,Be,Ke){var yt,ot;const ct=Te.gl,It=(yt=Te.HALF_FLOAT)!==null&&yt!==void 0?yt:ct.UNSIGNED_BYTE,bt=(ot=Te.RGBA16F)!==null&&ot!==void 0?ot:ct.RGBA;ct.texImage2D(ct.TEXTURE_2D,0,bt,Re.width/4,Re.height/4,0,ct.RGBA,It,null),Ke.colorAttachment.set(Be)}(T,B,Se,ce)}})(l,y,i),l.clear({color:a.aT.transparent});for(let T=0;T<r.length;T++){const B=r[T];if(s.hasRenderableParent(B))continue;const j=s.getTile(B),X=j.getBucket(i);if(!X)continue;const ce=X.programConfigurations.get(i.id),Se=y.useProgram("heatmap",ce),{zoom:Te}=y.transform;Se.draw(l,d.TRIANGLES,zr.disabled,_,w,fr.disabled,ol(B.posMatrix,j,Te,i.paint.get("heatmap-intensity")),null,i.id,X.layoutVertexBuffer,X.indexBuffer,X.segments,i.paint,y.transform.zoom,ce)}l.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(l,d){const _=l.context,w=_.gl,T=d.heatmapFbo;if(!T)return;_.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,T.colorAttachment.get()),_.activeTexture.set(w.TEXTURE1);let B=d.colorRampTexture;B||(B=d.colorRampTexture=new mt(_,d.colorRamp,w.RGBA)),B.bind(w.LINEAR,w.CLAMP_TO_EDGE),l.useProgram("heatmapTexture").draw(_,w.TRIANGLES,zr.disabled,Jr.disabled,l.colorModeForRenderPass(),fr.disabled,((j,X,ce,Se)=>{const Te=a.Z();a.aS(Te,0,j.width,j.height,0,0,1);const Re=j.context.gl;return{u_matrix:Te,u_world:[Re.drawingBufferWidth,Re.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:X.paint.get("heatmap-opacity")}})(l,d),null,d.id,l.viewportBuffer,l.quadTriangleIndexBuffer,l.viewportSegments,d.paint,l.transform.zoom)}(y,i))})(A,E,F,O);break;case"line":(function(y,s,i,r){if(y.renderPass!=="translucent")return;const l=i.paint.get("line-opacity"),d=i.paint.get("line-width");if(l.constantOr(1)===0||d.constantOr(1)===0)return;const _=y.depthModeForSublayer(0,zr.ReadOnly),w=y.colorModeForRenderPass(),T=i.paint.get("line-dasharray"),B=i.paint.get("line-pattern"),j=B.constantOr(1),X=i.paint.get("line-gradient"),ce=i.getCrossfadeParameters(),Se=j?"linePattern":T?"lineSDF":X?"lineGradient":"line",Te=y.context,Re=Te.gl;let Be=!0;for(const Ke of r){const yt=s.getTile(Ke);if(j&&!yt.patternsLoaded())continue;const ot=yt.getBucket(i);if(!ot)continue;const ct=ot.programConfigurations.get(i.id),It=y.context.program.get(),bt=y.useProgram(Se,ct),ri=Be||bt.program!==It,Xt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Ke),ti=B.constantOr(null);if(ti&&yt.imageAtlas){const Wi=yt.imageAtlas,Ei=Wi.patternPositions[ti.to.toString()],Gi=Wi.patternPositions[ti.from.toString()];Ei&&Gi&&ct.setConstantPatternPositions(Ei,Gi)}const si=Xt?Ke:null,Qi=j?xe(y,yt,i,ce,si):T?rt(y,yt,i,T,ce,si):X?N(y,yt,i,ot.lineClipsArray.length,si):Ga(y,yt,i,si);if(j)Te.activeTexture.set(Re.TEXTURE0),yt.imageAtlasTexture.bind(Re.LINEAR,Re.CLAMP_TO_EDGE),ct.updatePaintBuffers(ce);else if(T&&(ri||y.lineAtlas.dirty))Te.activeTexture.set(Re.TEXTURE0),y.lineAtlas.bind(Te);else if(X){const Wi=ot.gradients[i.id];let Ei=Wi.texture;if(i.gradientVersion!==Wi.version){let Gi=256;if(i.stepInterpolant){const qi=s.getSource().maxzoom,cn=Ke.canonical.z===qi?Math.ceil(1<<y.transform.maxZoom-Ke.canonical.z):1;Gi=a.ad(a.aY(ot.maxLineLength/a.N*1024*cn),256,Te.maxTextureSize)}Wi.gradient=a.aZ({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:Gi,image:Wi.gradient||void 0,clips:ot.lineClipsArray}),Wi.texture?Wi.texture.update(Wi.gradient):Wi.texture=new mt(Te,Wi.gradient,Re.RGBA),Wi.version=i.gradientVersion,Ei=Wi.texture}Te.activeTexture.set(Re.TEXTURE0),Ei.bind(i.stepInterpolant?Re.NEAREST:Re.LINEAR,Re.CLAMP_TO_EDGE)}bt.draw(Te,Re.TRIANGLES,_,y.stencilModeForClipping(Ke),w,fr.disabled,Qi,Xt,i.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,i.paint,y.transform.zoom,ct,ot.layoutVertexBuffer2),Be=!1}})(A,E,F,O);break;case"fill":(function(y,s,i,r){const l=i.paint.get("fill-color"),d=i.paint.get("fill-opacity");if(d.constantOr(1)===0)return;const _=y.colorModeForRenderPass(),w=i.paint.get("fill-pattern"),T=y.opaquePassEnabledForLayer()&&!w.constantOr(1)&&l.constantOr(a.aT.transparent).a===1&&d.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===T){const B=y.depthModeForSublayer(1,y.renderPass==="opaque"?zr.ReadWrite:zr.ReadOnly);Xr(y,s,i,r,B,_,!1)}if(y.renderPass==="translucent"&&i.paint.get("fill-antialias")){const B=y.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,zr.ReadOnly);Xr(y,s,i,r,B,_,!0)}})(A,E,F,O);break;case"fill-extrusion":(function(y,s,i,r){const l=i.paint.get("fill-extrusion-opacity");if(l!==0&&y.renderPass==="translucent"){const d=new zr(y.context.gl.LEQUAL,zr.ReadWrite,y.depthRangeFor3D);if(l!==1||i.paint.get("fill-extrusion-pattern").constantOr(1))ko(y,s,i,r,d,Jr.disabled,$n.disabled),ko(y,s,i,r,d,y.stencilModeFor3D(),y.colorModeForRenderPass());else{const _=y.colorModeForRenderPass();ko(y,s,i,r,d,Jr.disabled,_)}}})(A,E,F,O);break;case"hillshade":(function(y,s,i,r){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const l=y.context,d=y.depthModeForSublayer(0,zr.ReadOnly),_=y.colorModeForRenderPass(),[w,T]=y.renderPass==="translucent"?y.stencilConfigForOverlap(r):[{},r];for(const B of T){const j=s.getTile(B);j.needsHillshadePrepare!==void 0&&j.needsHillshadePrepare&&y.renderPass==="offscreen"?Qr(y,j,i,d,Jr.disabled,_):y.renderPass==="translucent"&&ul(y,B,j,i,d,w[B.overscaledZ],_)}l.viewport.set([0,0,y.width,y.height])})(A,E,F,O);break;case"raster":(function(y,s,i,r){if(y.renderPass!=="translucent"||i.paint.get("raster-opacity")===0||!r.length)return;const l=y.context,d=l.gl,_=s.getSource(),w=y.useProgram("raster"),T=y.colorModeForRenderPass(),[B,j]=_ instanceof mi?[{},r]:y.stencilConfigForOverlap(r),X=j[j.length-1].overscaledZ,ce=!y.options.moving;for(const Se of j){const Te=y.depthModeForSublayer(Se.overscaledZ-X,i.paint.get("raster-opacity")===1?zr.ReadWrite:zr.ReadOnly,d.LESS),Re=s.getTile(Se);Re.registerFadeDuration(i.paint.get("raster-fade-duration"));const Be=s.findLoadedParent(Se,0),Ke=ds(Re,Be,s,i,y.transform,y.style.map.terrain);let yt,ot;const ct=i.paint.get("raster-resampling")==="nearest"?d.NEAREST:d.LINEAR;l.activeTexture.set(d.TEXTURE0),Re.texture.bind(ct,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),l.activeTexture.set(d.TEXTURE1),Be?(Be.texture.bind(ct,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),yt=Math.pow(2,Be.tileID.overscaledZ-Re.tileID.overscaledZ),ot=[Re.tileID.canonical.x*yt%1,Re.tileID.canonical.y*yt%1]):Re.texture.bind(ct,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST);const It=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Se),bt=It?Se:null,ri=bt?bt.posMatrix:y.transform.calculatePosMatrix(Se.toUnwrapped(),ce),Xt=Ii(ri,ot||[0,0],yt||1,Ke,i);_ instanceof mi?w.draw(l,d.TRIANGLES,Te,Jr.disabled,T,fr.disabled,Xt,It,i.id,_.boundsBuffer,y.quadTriangleIndexBuffer,_.boundsSegments):w.draw(l,d.TRIANGLES,Te,B[Se.overscaledZ],T,fr.disabled,Xt,It,i.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}})(A,E,F,O);break;case"background":(function(y,s,i,r){const l=i.paint.get("background-color"),d=i.paint.get("background-opacity");if(d===0)return;const _=y.context,w=_.gl,T=y.transform,B=T.tileSize,j=i.paint.get("background-pattern");if(y.isPatternMissing(j))return;const X=!j&&l.a===1&&d===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==X)return;const ce=Jr.disabled,Se=y.depthModeForSublayer(0,X==="opaque"?zr.ReadWrite:zr.ReadOnly),Te=y.colorModeForRenderPass(),Re=y.useProgram(j?"backgroundPattern":"background"),Be=r||T.coveringTiles({tileSize:B,terrain:y.style.map.terrain});j&&(_.activeTexture.set(w.TEXTURE0),y.imageManager.bind(y.context));const Ke=i.getCrossfadeParameters();for(const yt of Be){const ot=r?yt.posMatrix:y.transform.calculatePosMatrix(yt.toUnwrapped()),ct=j?Or(ot,d,y,j,{tileID:yt,tileSize:B},Ke):Ar(ot,d,l),It=y.style.map.terrain&&y.style.map.terrain.getTerrainData(yt);Re.draw(_,w.TRIANGLES,Se,ce,Te,fr.disabled,ct,It,i.id,y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}})(A,0,F,O);break;case"custom":(function(y,s,i){const r=y.context,l=i.implementation;if(y.renderPass==="offscreen"){const d=l.prerender;d&&(y.setCustomLayerDefaults(),r.setColorMode(y.colorModeForRenderPass()),d.call(l,r.gl,y.transform.customLayerMatrix()),r.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),r.setColorMode(y.colorModeForRenderPass()),r.setStencilMode(Jr.disabled);const d=l.renderingMode==="3d"?new zr(y.context.gl.LEQUAL,zr.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,zr.ReadOnly);r.setDepthMode(d),l.render(r.gl,y.transform.customLayerMatrix()),r.setDirty(),y.setBaseState(),r.bindFramebuffer.set(null)}})(A,0,F)}}translatePosMatrix(A,E,F,O,y){if(!F[0]&&!F[1])return A;const s=y?O==="map"?this.transform.angle:0:O==="viewport"?-this.transform.angle:0;if(s){const l=Math.sin(s),d=Math.cos(s);F=[F[0]*d-F[1]*l,F[0]*l+F[1]*d]}const i=[y?F[0]:Fe(E,F[0],this.transform.zoom),y?F[1]:Fe(E,F[1],this.transform.zoom),0],r=new Float32Array(16);return a.$(r,A,i),r}saveTileTexture(A){const E=this._tileTextures[A.size[0]];E?E.push(A):this._tileTextures[A.size[0]]=[A]}getTileTexture(A){const E=this._tileTextures[A];return E&&E.length>0?E.pop():null}isPatternMissing(A){if(!A)return!1;if(!A.from||!A.to)return!0;const E=this.imageManager.getPattern(A.from.toString()),F=this.imageManager.getPattern(A.to.toString());return!E||!F}useProgram(A,E){this.cache=this.cache||{};const F=A+(E?E.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[F]||(this.cache[F]=new Us(this.context,Vt[A],E,qa[A],this._showOverdrawInspector,this.style.map.terrain)),this.cache[F]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const A=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(A.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new mt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:A,drawingBufferHeight:E}=this.context.gl;return this.width!==A||this.height!==E}}class Nr{constructor(A,E){this.points=A,this.planes=E}static fromInvProjectionMatrix(A,E,F){const O=Math.pow(2,F),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(i=>{const r=1/(i=a.ag([],i,A))[3]/E*O;return a.b3(i,i,[r,r,1/i[3],r])}),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(i=>{const r=function(w,T){var B=T[0],j=T[1],X=T[2],ce=B*B+j*j+X*X;return ce>0&&(ce=1/Math.sqrt(ce)),w[0]=T[0]*ce,w[1]=T[1]*ce,w[2]=T[2]*ce,w}([],function(w,T,B){var j=T[0],X=T[1],ce=T[2],Se=B[0],Te=B[1],Re=B[2];return w[0]=X*Re-ce*Te,w[1]=ce*Se-j*Re,w[2]=j*Te-X*Se,w}([],Oe([],y[i[0]],y[i[1]]),Oe([],y[i[2]],y[i[1]]))),l=-((d=r)[0]*(_=y[i[1]])[0]+d[1]*_[1]+d[2]*_[2]);var d,_;return r.concat(l)});return new Nr(y,s)}}class ha{constructor(A,E){this.min=A,this.max=E,this.center=function(F,O,y){return F[0]=.5*O[0],F[1]=.5*O[1],F[2]=.5*O[2],F}([],function(F,O,y){return F[0]=O[0]+y[0],F[1]=O[1]+y[1],F[2]=O[2]+y[2],F}([],this.min,this.max))}quadrant(A){const E=[A%2==0,A<2],F=Tt(this.min),O=Tt(this.max);for(let y=0;y<E.length;y++)F[y]=E[y]?this.min[y]:this.center[y],O[y]=E[y]?this.center[y]:this.max[y];return O[2]=this.max[2],new ha(F,O)}distanceX(A){return Math.max(Math.min(this.max[0],A[0]),this.min[0])-A[0]}distanceY(A){return Math.max(Math.min(this.max[1],A[1]),this.min[1])-A[1]}intersects(A){const E=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let F=!0;for(let O=0;O<A.planes.length;O++){const y=A.planes[O];let s=0;for(let i=0;i<E.length;i++)a.b4(y,E[i])>=0&&s++;if(s===0)return 0;s!==E.length&&(F=!1)}if(F)return 2;for(let O=0;O<3;O++){let y=Number.MAX_VALUE,s=-Number.MAX_VALUE;for(let i=0;i<A.points.length;i++){const r=A.points[i][O]-this.min[O];y=Math.min(y,r),s=Math.max(s,r)}if(s<0||y>this.max[O]-this.min[O])return 0}return 1}}class _o{constructor(A=0,E=0,F=0,O=0){if(isNaN(A)||A<0||isNaN(E)||E<0||isNaN(F)||F<0||isNaN(O)||O<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=A,this.bottom=E,this.left=F,this.right=O}interpolate(A,E,F){return E.top!=null&&A.top!=null&&(this.top=a.B.number(A.top,E.top,F)),E.bottom!=null&&A.bottom!=null&&(this.bottom=a.B.number(A.bottom,E.bottom,F)),E.left!=null&&A.left!=null&&(this.left=a.B.number(A.left,E.left,F)),E.right!=null&&A.right!=null&&(this.right=a.B.number(A.right,E.right,F)),this}getCenter(A,E){const F=a.ad((this.left+A-this.right)/2,0,A),O=a.ad((this.top+E-this.bottom)/2,0,E);return new a.P(F,O)}equals(A){return this.top===A.top&&this.bottom===A.bottom&&this.left===A.left&&this.right===A.right}clone(){return new _o(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class ea{constructor(A,E,F,O,y){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=y===void 0||!!y,this._minZoom=A||0,this._maxZoom=E||22,this._minPitch=F??0,this._maxPitch=O??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new _o,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const A=new ea(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return A.apply(this),A}apply(A){this.tileSize=A.tileSize,this.latRange=A.latRange,this.width=A.width,this.height=A.height,this._center=A._center,this._elevation=A._elevation,this._minEleveationForCurrentTile=A._minEleveationForCurrentTile,this.zoom=A.zoom,this.angle=A.angle,this._fov=A._fov,this._pitch=A._pitch,this._unmodified=A._unmodified,this._edgeInsets=A._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(A){this._minZoom!==A&&(this._minZoom=A,this.zoom=Math.max(this.zoom,A))}get maxZoom(){return this._maxZoom}set maxZoom(A){this._maxZoom!==A&&(this._maxZoom=A,this.zoom=Math.min(this.zoom,A))}get minPitch(){return this._minPitch}set minPitch(A){this._minPitch!==A&&(this._minPitch=A,this.pitch=Math.max(this.pitch,A))}get maxPitch(){return this._maxPitch}set maxPitch(A){this._maxPitch!==A&&(this._maxPitch=A,this.pitch=Math.min(this.pitch,A))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(A){A===void 0?A=!0:A===null&&(A=!1),this._renderWorldCopies=A}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(A){const E=-a.b5(A,-180,180)*Math.PI/180;this.angle!==E&&(this._unmodified=!1,this.angle=E,this._calcMatrices(),this.rotationMatrix=function(){var F=new a.A(4);return a.A!=Float32Array&&(F[1]=0,F[2]=0),F[0]=1,F[3]=1,F}(),function(F,O,y){var s=O[0],i=O[1],r=O[2],l=O[3],d=Math.sin(y),_=Math.cos(y);F[0]=s*_+r*d,F[1]=i*_+l*d,F[2]=s*-d+r*_,F[3]=i*-d+l*_}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(A){const E=a.ad(A,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==E&&(this._unmodified=!1,this._pitch=E,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(A){A=Math.max(.01,Math.min(60,A)),this._fov!==A&&(this._unmodified=!1,this._fov=A/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(A){const E=Math.min(Math.max(A,this.minZoom),this.maxZoom);this._zoom!==E&&(this._unmodified=!1,this._zoom=E,this.tileZoom=Math.max(0,Math.floor(E)),this.scale=this.zoomScale(E),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(A){A.lat===this._center.lat&&A.lng===this._center.lng||(this._unmodified=!1,this._center=A,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(A){A!==this._elevation&&(this._elevation=A,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(A){this._edgeInsets.equals(A)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,A,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(A){return this._edgeInsets.equals(A)}interpolatePadding(A,E,F){this._unmodified=!1,this._edgeInsets.interpolate(A,E,F),this._constrain(),this._calcMatrices()}coveringZoomLevel(A){const E=(A.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/A.tileSize));return Math.max(0,E)}getVisibleUnwrappedCoordinates(A){const E=[new a.b6(0,A)];if(this._renderWorldCopies){const F=this.pointCoordinate(new a.P(0,0)),O=this.pointCoordinate(new a.P(this.width,0)),y=this.pointCoordinate(new a.P(this.width,this.height)),s=this.pointCoordinate(new a.P(0,this.height)),i=Math.floor(Math.min(F.x,O.x,y.x,s.x)),r=Math.floor(Math.max(F.x,O.x,y.x,s.x)),l=1;for(let d=i-l;d<=r+l;d++)d!==0&&E.push(new a.b6(d,A))}return E}coveringTiles(A){var E,F;let O=this.coveringZoomLevel(A);const y=O;if(A.minzoom!==void 0&&O<A.minzoom)return[];A.maxzoom!==void 0&&O>A.maxzoom&&(O=A.maxzoom);const s=this.pointCoordinate(this.getCameraPoint()),i=a.U.fromLngLat(this.center),r=Math.pow(2,O),l=[r*s.x,r*s.y,0],d=[r*i.x,r*i.y,0],_=Nr.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,O);let w=A.minzoom||0;!A.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(w=O);const T=A.terrain?2/Math.min(this.tileSize,A.tileSize)*this.tileSize:3,B=Te=>({aabb:new ha([Te*r,0,0],[(Te+1)*r,r,0]),zoom:0,x:0,y:0,wrap:Te,fullyVisible:!1}),j=[],X=[],ce=O,Se=A.reparseOverscaled?y:O;if(this._renderWorldCopies)for(let Te=1;Te<=3;Te++)j.push(B(-Te)),j.push(B(Te));for(j.push(B(0));j.length>0;){const Te=j.pop(),Re=Te.x,Be=Te.y;let Ke=Te.fullyVisible;if(!Ke){const bt=Te.aabb.intersects(_);if(bt===0)continue;Ke=bt===2}const yt=A.terrain?l:d,ot=Te.aabb.distanceX(yt),ct=Te.aabb.distanceY(yt),It=Math.max(Math.abs(ot),Math.abs(ct));if(Te.zoom===ce||It>T+(1<<ce-Te.zoom)-2&&Te.zoom>=w){const bt=ce-Te.zoom,ri=l[0]-.5-(Re<<bt),Xt=l[1]-.5-(Be<<bt);X.push({tileID:new a.O(Te.zoom===ce?Se:Te.zoom,Te.wrap,Te.zoom,Re,Be),distanceSq:jt([d[0]-.5-Re,d[1]-.5-Be]),tileDistanceToCamera:Math.sqrt(ri*ri+Xt*Xt)})}else for(let bt=0;bt<4;bt++){const ri=(Re<<1)+bt%2,Xt=(Be<<1)+(bt>>1),ti=Te.zoom+1;let si=Te.aabb.quadrant(bt);if(A.terrain){const Qi=new a.O(ti,Te.wrap,ti,ri,Xt),Wi=A.terrain.getMinMaxElevation(Qi),Ei=(E=Wi.minElevation)!==null&&E!==void 0?E:this.elevation,Gi=(F=Wi.maxElevation)!==null&&F!==void 0?F:this.elevation;si=new ha([si.min[0],si.min[1],Ei],[si.max[0],si.max[1],Gi])}j.push({aabb:si,zoom:ti,x:ri,y:Xt,wrap:Te.wrap,fullyVisible:Ke})}}return X.sort((Te,Re)=>Te.distanceSq-Re.distanceSq).map(Te=>Te.tileID)}resize(A,E){this.width=A,this.height=E,this.pixelsToGLUnits=[2/A,-2/E],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(A){return Math.pow(2,A)}scaleZoom(A){return Math.log(A)/Math.LN2}project(A){const E=a.ad(A.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.P(a.G(A.lng)*this.worldSize,a.H(E)*this.worldSize)}unproject(A){return new a.U(A.x/this.worldSize,A.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(A){const E=this.pointLocation(this.centerPoint,A),F=A.getElevationForLngLatZoom(E,this.tileZoom);if(!(this.elevation-F))return;const O=this.getCameraPosition(),y=a.U.fromLngLat(O.lngLat,O.altitude),s=a.U.fromLngLat(E,F),i=y.x-s.x,r=y.y-s.y,l=y.z-s.z,d=Math.sqrt(i*i+r*r+l*l),_=this.scaleZoom(this.cameraToCenterDistance/d/this.tileSize);this._elevation=F,this._center=E,this.zoom=_}setLocationAtPoint(A,E){const F=this.pointCoordinate(E),O=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(A),s=new a.U(y.x-(F.x-O.x),y.y-(F.y-O.y));this.center=this.coordinateLocation(s),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(A,E){return E?this.coordinatePoint(this.locationCoordinate(A),E.getElevationForLngLatZoom(A,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(A))}pointLocation(A,E){return this.coordinateLocation(this.pointCoordinate(A,E))}locationCoordinate(A){return a.U.fromLngLat(A)}coordinateLocation(A){return A&&A.toLngLat()}pointCoordinate(A,E){if(E){const w=E.pointCoordinate(A);if(w!=null)return w}const F=[A.x,A.y,0,1],O=[A.x,A.y,1,1];a.ag(F,F,this.pixelMatrixInverse),a.ag(O,O,this.pixelMatrixInverse);const y=F[3],s=O[3],i=F[1]/y,r=O[1]/s,l=F[2]/y,d=O[2]/s,_=l===d?0:(0-l)/(d-l);return new a.U(a.B.number(F[0]/y,O[0]/s,_)/this.worldSize,a.B.number(i,r,_)/this.worldSize)}coordinatePoint(A,E=0,F=this.pixelMatrix){const O=[A.x*this.worldSize,A.y*this.worldSize,E,1];return a.ag(O,O,F),new a.P(O[0]/O[3],O[1]/O[3])}getBounds(){const A=Math.max(0,this.height/2-this.getHorizon());return new Ni().extend(this.pointLocation(new a.P(0,A))).extend(this.pointLocation(new a.P(this.width,A))).extend(this.pointLocation(new a.P(this.width,this.height))).extend(this.pointLocation(new a.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Ni([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(A){A?(this.lngRange=[A.getWest(),A.getEast()],this.latRange=[A.getSouth(),A.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(A,E=!1){const F=A.key,O=E?this._alignedPosMatrixCache:this._posMatrixCache;if(O[F])return O[F];const y=A.canonical,s=this.worldSize/this.zoomScale(y.z),i=y.x+Math.pow(2,y.z)*A.wrap,r=a.ao(new Float64Array(16));return a.$(r,r,[i*s,y.y*s,0]),a.a0(r,r,[s/a.N,s/a.N,1]),a.a1(r,E?this.alignedProjMatrix:this.projMatrix,r),O[F]=new Float32Array(r),O[F]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let A,E,F,O,y=-90,s=90,i=-180,r=180;const l=this.size,d=this._unmodified;if(this.latRange){const T=this.latRange;y=a.H(T[1])*this.worldSize,s=a.H(T[0])*this.worldSize,A=s-y<l.y?l.y/(s-y):0}if(this.lngRange){const T=this.lngRange;i=a.b5(a.G(T[0])*this.worldSize,0,this.worldSize),r=a.b5(a.G(T[1])*this.worldSize,0,this.worldSize),r<i&&(r+=this.worldSize),E=r-i<l.x?l.x/(r-i):0}const _=this.point,w=Math.max(E||0,A||0);if(w)return this.center=this.unproject(new a.P(E?(r+i)/2:_.x,A?(s+y)/2:_.y)),this.zoom+=this.scaleZoom(w),this._unmodified=d,void(this._constraining=!1);if(this.latRange){const T=_.y,B=l.y/2;T-B<y&&(O=y+B),T+B>s&&(O=s-B)}if(this.lngRange){const T=(i+r)/2,B=a.b5(_.x,T-this.worldSize/2,T+this.worldSize/2),j=l.x/2;B-j<i&&(F=i+j),B+j>r&&(F=r-j)}F===void 0&&O===void 0||(this.center=this.unproject(new a.P(F!==void 0?F:_.x,O!==void 0?O:_.y)).wrap()),this._unmodified=d,this._constraining=!1}_calcMatrices(){if(!this.height)return;const A=this.centerOffset,E=this.point.x,F=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=a.b7(1,this.center.lat)*this.worldSize;let O=a.ao(new Float64Array(16));a.a0(O,O,[this.width/2,-this.height/2,1]),a.$(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=a.ao(new Float64Array(16)),a.a0(O,O,[1,-1,1]),a.$(O,O,[-1,-1,0]),a.a0(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O;const y=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),s=Math.min(this.elevation,this._minEleveationForCurrentTile),i=y-s*this._pixelPerMeter/Math.cos(this._pitch),r=s<0?i:y,l=Math.PI/2+this._pitch,d=this._fov*(.5+A.y/this.height),_=Math.sin(d)*r/Math.sin(a.ad(Math.PI-l-d,.01,Math.PI-.01)),w=this.getHorizon(),T=2*Math.atan(w/this.cameraToCenterDistance)*(.5+A.y/(2*w)),B=Math.sin(T)*r/Math.sin(a.ad(Math.PI-l-T,.01,Math.PI-.01)),j=Math.min(_,B),X=1.01*(Math.cos(Math.PI/2-this._pitch)*j+r),ce=this.height/50;O=new Float64Array(16),a.b8(O,this._fov,this.width/this.height,ce,X),O[8]=2*-A.x/this.width,O[9]=2*A.y/this.height,a.a0(O,O,[1,-1,1]),a.$(O,O,[0,0,-this.cameraToCenterDistance]),a.b9(O,O,this._pitch),a.ae(O,O,this.angle),a.$(O,O,[-E,-F,0]),this.mercatorMatrix=a.a0([],O,[this.worldSize,this.worldSize,this.worldSize]),a.a0(O,O,[1,1,this._pixelPerMeter]),this.pixelMatrix=a.a1(new Float64Array(16),this.labelPlaneMatrix,O),a.$(O,O,[0,0,-this.elevation]),this.projMatrix=O,this.invProjMatrix=a.as([],O),this.pixelMatrix3D=a.a1(new Float64Array(16),this.labelPlaneMatrix,O);const Se=this.width%2/2,Te=this.height%2/2,Re=Math.cos(this.angle),Be=Math.sin(this.angle),Ke=E-Math.round(E)+Re*Se+Be*Te,yt=F-Math.round(F)+Re*Te+Be*Se,ot=new Float64Array(O);if(a.$(ot,ot,[Ke>.5?Ke-1:Ke,yt>.5?yt-1:yt,0]),this.alignedProjMatrix=ot,O=a.as(new Float64Array(16),this.pixelMatrix),!O)throw new Error("failed to invert matrix");this.pixelMatrixInverse=O,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const A=this.pointCoordinate(new a.P(0,0)),E=[A.x*this.worldSize,A.y*this.worldSize,0,1];return a.ag(E,E,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const A=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,A))}getCameraQueryGeometry(A){const E=this.getCameraPoint();if(A.length===1)return[A[0],E];{let F=E.x,O=E.y,y=E.x,s=E.y;for(const i of A)F=Math.min(F,i.x),O=Math.min(O,i.y),y=Math.max(y,i.x),s=Math.max(s,i.y);return[new a.P(F,O),new a.P(y,O),new a.P(y,s),new a.P(F,s),new a.P(F,O)]}}}function Sa(Z,A){let E,F=!1,O=null,y=null;const s=()=>{O=null,F&&(Z.apply(y,E),O=setTimeout(s,A),F=!1)};return(...i)=>(F=!0,y=this,E=i,O||s(),O)}class ka{constructor(A){this._getCurrentHash=()=>{const E=window.location.hash.replace("#","");if(this._hashName){let F;return E.split("&").map(O=>O.split("=")).forEach(O=>{O[0]===this._hashName&&(F=O)}),(F&&F[1]||"").split("/")}return E.split("/")},this._onHashChange=()=>{const E=this._getCurrentHash();if(E.length>=3&&!E.some(F=>isNaN(F))){const F=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(E[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+E[2],+E[1]],zoom:+E[0],bearing:F,pitch:+(E[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const E=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,E)}catch{}},this._updateHash=Sa(this._updateHashUnthrottled,300),this._hashName=A&&encodeURIComponent(A)}addTo(A){return this._map=A,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(A){const E=this._map.getCenter(),F=Math.round(100*this._map.getZoom())/100,O=Math.ceil((F*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,O),s=Math.round(E.lng*y)/y,i=Math.round(E.lat*y)/y,r=this._map.getBearing(),l=this._map.getPitch();let d="";if(d+=A?`/${s}/${i}/${F}`:`${F}/${i}/${s}`,(r||l)&&(d+="/"+Math.round(10*r)/10),l&&(d+=`/${Math.round(l)}`),this._hashName){const _=this._hashName;let w=!1;const T=window.location.hash.slice(1).split("&").map(B=>{const j=B.split("=")[0];return j===_?(w=!0,`${j}=${d}`):B}).filter(B=>B);return w||T.push(`${_}=${d}`),`#${T.join("&")}`}return`#${d}`}}const Xa={linearity:.3,easing:a.ba(0,0,.3,1)},cl=a.e({deceleration:2500,maxSpeed:1400},Xa),lu=a.e({deceleration:20,maxSpeed:1400},Xa),gl=a.e({deceleration:1e3,maxSpeed:360},Xa),ao=a.e({deceleration:1e3,maxSpeed:90},Xa);class pi{constructor(A){this._map=A,this.clear()}clear(){this._inertiaBuffer=[]}record(A){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.h.now(),settings:A})}_drainInertiaBuffer(){const A=this._inertiaBuffer,E=a.h.now();for(;A.length>0&&E-A[0].time>160;)A.shift()}_onMoveEnd(A){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const E={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)E.zoom+=y.zoomDelta||0,E.bearing+=y.bearingDelta||0,E.pitch+=y.pitchDelta||0,y.panDelta&&E.pan._add(y.panDelta),y.around&&(E.around=y.around),y.pinchAround&&(E.pinchAround=y.pinchAround);const F=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,O={};if(E.pan.mag()){const y=Di(E.pan.mag(),F,a.e({},cl,A||{}));O.offset=E.pan.mult(y.amount/E.pan.mag()),O.center=this._map.transform.center,Ui(O,y)}if(E.zoom){const y=Di(E.zoom,F,lu);O.zoom=this._map.transform.zoom+y.amount,Ui(O,y)}if(E.bearing){const y=Di(E.bearing,F,gl);O.bearing=this._map.transform.bearing+a.ad(y.amount,-179,179),Ui(O,y)}if(E.pitch){const y=Di(E.pitch,F,ao);O.pitch=this._map.transform.pitch+y.amount,Ui(O,y)}if(O.zoom||O.bearing){const y=E.pinchAround===void 0?E.around:E.pinchAround;O.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),a.e(O,{noMoveStart:!0})}}function Ui(Z,A){(!Z.duration||Z.duration<A.duration)&&(Z.duration=A.duration,Z.easing=A.easing)}function Di(Z,A,E){const{maxSpeed:F,linearity:O,deceleration:y}=E,s=a.ad(Z*O/(A/1e3),-F,F),i=Math.abs(s)/(y*O);return{easing:E.easing,duration:1e3*i,amount:s*(i/2)}}class Ft extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(A,E,F,O={}){const y=W.mousePos(E.getCanvasContainer(),F),s=E.unproject(y);super(A,a.e({point:y,lngLat:s,originalEvent:F},O)),this._defaultPrevented=!1,this.target=E}}class ii extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(A,E,F){const O=A==="touchend"?F.changedTouches:F.touches,y=W.touchPos(E.getCanvasContainer(),O),s=y.map(r=>E.unproject(r)),i=y.reduce((r,l,d,_)=>r.add(l.div(_.length)),new a.P(0,0));super(A,{points:y,point:i,lngLats:s,lngLat:E.unproject(i),originalEvent:F}),this._defaultPrevented=!1}}class bi extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(A,E,F){super(A,{originalEvent:F}),this._defaultPrevented=!1}}class Fi{constructor(A,E){this._map=A,this._clickTolerance=E.clickTolerance}reset(){delete this._mousedownPos}wheel(A){return this._firePreventable(new bi(A.type,this._map,A))}mousedown(A,E){return this._mousedownPos=E,this._firePreventable(new Ft(A.type,this._map,A))}mouseup(A){this._map.fire(new Ft(A.type,this._map,A))}click(A,E){this._mousedownPos&&this._mousedownPos.dist(E)>=this._clickTolerance||this._map.fire(new Ft(A.type,this._map,A))}dblclick(A){return this._firePreventable(new Ft(A.type,this._map,A))}mouseover(A){this._map.fire(new Ft(A.type,this._map,A))}mouseout(A){this._map.fire(new Ft(A.type,this._map,A))}touchstart(A){return this._firePreventable(new ii(A.type,this._map,A))}touchmove(A){this._map.fire(new ii(A.type,this._map,A))}touchend(A){this._map.fire(new ii(A.type,this._map,A))}touchcancel(A){this._map.fire(new ii(A.type,this._map,A))}_firePreventable(A){if(this._map.fire(A),A.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Bn{constructor(A){this._map=A}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(A){this._map.fire(new Ft(A.type,this._map,A))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ft("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(A){this._delayContextMenu?this._contextMenuEvent=A:this._ignoreContextMenu||this._map.fire(new Ft(A.type,this._map,A)),this._map.listens("contextmenu")&&A.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Hn{constructor(A){this._map=A}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(A){return this.transform.pointLocation(a.P.convert(A),this._map.terrain)}}class lr{constructor(A,E){this._map=A,this._tr=new Hn(A),this._el=A.getCanvasContainer(),this._container=A.getContainer(),this._clickTolerance=E.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(A,E){this.isEnabled()&&A.shiftKey&&A.button===0&&(W.disableDrag(),this._startPos=this._lastPos=E,this._active=!0)}mousemoveWindow(A,E){if(!this._active)return;const F=E;if(this._lastPos.equals(F)||!this._box&&F.dist(this._startPos)<this._clickTolerance)return;const O=this._startPos;this._lastPos=F,this._box||(this._box=W.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",A));const y=Math.min(O.x,F.x),s=Math.max(O.x,F.x),i=Math.min(O.y,F.y),r=Math.max(O.y,F.y);W.setTransform(this._box,`translate(${y}px,${i}px)`),this._box.style.width=s-y+"px",this._box.style.height=r-i+"px"}mouseupWindow(A,E){if(!this._active||A.button!==0)return;const F=this._startPos,O=E;if(this.reset(),W.suppressClick(),F.x!==O.x||F.y!==O.y)return this._map.fire(new a.k("boxzoomend",{originalEvent:A})),{cameraAnimation:y=>y.fitScreenCoordinates(F,O,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",A)}keydown(A){this._active&&A.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",A))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(W.remove(this._box),this._box=null),W.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(A,E){return this._map.fire(new a.k(A,{originalEvent:E}))}}function Xn(Z,A){if(Z.length!==A.length)throw new Error(`The number of touches and points are not equal - touches ${Z.length}, points ${A.length}`);const E={};for(let F=0;F<Z.length;F++)E[Z[F].identifier]=A[F];return E}class Hs{constructor(A){this.reset(),this.numTouches=A.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(A,E,F){(this.centroid||F.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=A.timeStamp),F.length===this.numTouches&&(this.centroid=function(O){const y=new a.P(0,0);for(const s of O)y._add(s);return y.div(O.length)}(E),this.touches=Xn(F,E)))}touchmove(A,E,F){if(this.aborted||!this.centroid)return;const O=Xn(F,E);for(const y in this.touches){const s=O[y];(!s||s.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(A,E,F){if((!this.centroid||A.timeStamp-this.startTime>500)&&(this.aborted=!0),F.length===0){const O=!this.aborted&&this.centroid;if(this.reset(),O)return O}}}class ks{constructor(A){this.singleTap=new Hs(A),this.numTaps=A.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(A,E,F){this.singleTap.touchstart(A,E,F)}touchmove(A,E,F){this.singleTap.touchmove(A,E,F)}touchend(A,E,F){const O=this.singleTap.touchend(A,E,F);if(O){const y=A.timeStamp-this.lastTime<500,s=!this.lastTap||this.lastTap.dist(O)<30;if(y&&s||this.reset(),this.count++,this.lastTime=A.timeStamp,this.lastTap=O,this.count===this.numTaps)return this.reset(),O}}}class ps{constructor(A){this._tr=new Hn(A),this._zoomIn=new ks({numTouches:1,numTaps:2}),this._zoomOut=new ks({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(A,E,F){this._zoomIn.touchstart(A,E,F),this._zoomOut.touchstart(A,E,F)}touchmove(A,E,F){this._zoomIn.touchmove(A,E,F),this._zoomOut.touchmove(A,E,F)}touchend(A,E,F){const O=this._zoomIn.touchend(A,E,F),y=this._zoomOut.touchend(A,E,F),s=this._tr;return O?(this._active=!0,A.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:i=>i.easeTo({duration:300,zoom:s.zoom+1,around:s.unproject(O)},{originalEvent:A})}):y?(this._active=!0,A.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:i=>i.easeTo({duration:300,zoom:s.zoom-1,around:s.unproject(y)},{originalEvent:A})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ya{constructor(A){this._enabled=!!A.enable,this._moveStateManager=A.moveStateManager,this._clickTolerance=A.clickTolerance||1,this._moveFunction=A.move,this._activateOnStart=!!A.activateOnStart,A.assignEvents(this),this.reset()}reset(A){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(A)}_move(...A){const E=this._moveFunction(...A);if(E.bearingDelta||E.pitchDelta||E.around||E.panDelta)return this._active=!0,E}dragStart(A,E){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(A)&&(this._moveStateManager.startMove(A),this._lastPoint=E.length?E[0]:E,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(A,E){if(!this.isEnabled())return;const F=this._lastPoint;if(!F)return;if(A.preventDefault(),!this._moveStateManager.isValidMoveEvent(A))return void this.reset(A);const O=E.length?E[0]:E;return!this._moved&&O.dist(F)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=O,this._move(F,O))}dragEnd(A){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(A)&&(this._moved&&W.suppressClick(),this.reset(A))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const yo={0:1,2:2};class rs{constructor(A){this._correctEvent=A.checkCorrectEvent}startMove(A){const E=W.mouseButton(A);this._eventButton=E}endMove(A){delete this._eventButton}isValidStartEvent(A){return this._correctEvent(A)}isValidMoveEvent(A){return!function(E,F){const O=yo[F];return E.buttons===void 0||(E.buttons&O)!==O}(A,this._eventButton)}isValidEndEvent(A){return W.mouseButton(A)===this._eventButton}}class Wu{constructor(){this._firstTouch=void 0}_isOneFingerTouch(A){return A.targetTouches.length===1}_isSameTouchEvent(A){return A.targetTouches[0].identifier===this._firstTouch}startMove(A){this._firstTouch=A.targetTouches[0].identifier}endMove(A){delete this._firstTouch}isValidStartEvent(A){return this._isOneFingerTouch(A)}isValidMoveEvent(A){return this._isOneFingerTouch(A)&&this._isSameTouchEvent(A)}isValidEndEvent(A){return this._isOneFingerTouch(A)&&this._isSameTouchEvent(A)}}const Ru=Z=>{Z.mousedown=Z.dragStart,Z.mousemoveWindow=Z.dragMove,Z.mouseup=Z.dragEnd,Z.contextmenu=function(A){A.preventDefault()}},vo=({enable:Z,clickTolerance:A,bearingDegreesPerPixelMoved:E=.8})=>{const F=new rs({checkCorrectEvent:O=>W.mouseButton(O)===0&&O.ctrlKey||W.mouseButton(O)===2});return new Ya({clickTolerance:A,move:(O,y)=>({bearingDelta:(y.x-O.x)*E}),moveStateManager:F,enable:Z,assignEvents:Ru})},Ml=({enable:Z,clickTolerance:A,pitchDegreesPerPixelMoved:E=-.5})=>{const F=new rs({checkCorrectEvent:O=>W.mouseButton(O)===0&&O.ctrlKey||W.mouseButton(O)===2});return new Ya({clickTolerance:A,move:(O,y)=>({pitchDelta:(y.y-O.y)*E}),moveStateManager:F,enable:Z,assignEvents:Ru})};class Dn{constructor(A,E){this._minTouches=A.cooperativeGestures?2:1,this._clickTolerance=A.clickTolerance||1,this._map=E,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(A,E,F){return this._calculateTransform(A,E,F)}touchmove(A,E,F){if(this._map._cooperativeGestures&&(this._minTouches===2&&F.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(A,!1,F.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(F.length<this._minTouches))return A.preventDefault(),this._calculateTransform(A,E,F)}touchend(A,E,F){this._calculateTransform(A,E,F),this._active&&F.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(A,E,F){F.length>0&&(this._active=!0);const O=Xn(F,E),y=new a.P(0,0),s=new a.P(0,0);let i=0;for(const l in O){const d=O[l],_=this._touches[l];_&&(y._add(d),s._add(d.sub(_)),i++,O[l]=d)}if(this._touches=O,i<this._minTouches||!s.mag())return;const r=s.div(i);return this._sum._add(r),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(i),panDelta:r}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ma{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(A,E,F){this._firstTwoTouches||F.length<2||(this._firstTwoTouches=[F[0].identifier,F[1].identifier],this._start([E[0],E[1]]))}touchmove(A,E,F){if(!this._firstTwoTouches)return;A.preventDefault();const[O,y]=this._firstTwoTouches,s=Sn(F,E,O),i=Sn(F,E,y);if(!s||!i)return;const r=this._aroundCenter?null:s.add(i).div(2);return this._move([s,i],r,A)}touchend(A,E,F){if(!this._firstTwoTouches)return;const[O,y]=this._firstTwoTouches,s=Sn(F,E,O),i=Sn(F,E,y);s&&i||(this._active&&W.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(A){this._enabled=!0,this._aroundCenter=!!A&&A.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Sn(Z,A,E){for(let F=0;F<Z.length;F++)if(Z[F].identifier===E)return A[F]}function No(Z,A){return Math.log(Z/A)/Math.LN2}class Nl extends Ma{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(A){this._startDistance=this._distance=A[0].dist(A[1])}_move(A,E){const F=this._distance;if(this._distance=A[0].dist(A[1]),this._active||!(Math.abs(No(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:No(this._distance,F),pinchAround:E}}}function En(Z,A){return 180*Z.angleWith(A)/Math.PI}class Wl extends Ma{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(A){this._startVector=this._vector=A[0].sub(A[1]),this._minDiameter=A[0].dist(A[1])}_move(A,E){const F=this._vector;if(this._vector=A[0].sub(A[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:En(this._vector,F),pinchAround:E}}_isBelowThreshold(A){this._minDiameter=Math.min(this._minDiameter,A.mag());const E=25/(Math.PI*this._minDiameter)*360,F=En(A,this._startVector);return Math.abs(F)<E}}function Cn(Z){return Math.abs(Z.y)>Math.abs(Z.x)}class _l extends Ma{constructor(A){super(),this._map=A}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(A,E,F){super.touchstart(A,E,F),this._currentTouchCount=F.length}_start(A){this._lastPoints=A,Cn(A[0].sub(A[1]))&&(this._valid=!1)}_move(A,E,F){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const O=A[0].sub(this._lastPoints[0]),y=A[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(O,y,F.timeStamp),this._valid?(this._lastPoints=A,this._active=!0,{pitchDelta:(O.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(A,E,F){if(this._valid!==void 0)return this._valid;const O=A.mag()>=2,y=E.mag()>=2;if(!O&&!y)return;if(!O||!y)return this._firstMove===void 0&&(this._firstMove=F),F-this._firstMove<100&&void 0;const s=A.y>0==E.y>0;return Cn(A)&&Cn(E)&&s}}const uu={panStep:100,bearingStep:15,pitchStep:10};class Fu{constructor(A){this._tr=new Hn(A);const E=uu;this._panStep=E.panStep,this._bearingStep=E.bearingStep,this._pitchStep=E.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(A){if(A.altKey||A.ctrlKey||A.metaKey)return;let E=0,F=0,O=0,y=0,s=0;switch(A.keyCode){case 61:case 107:case 171:case 187:E=1;break;case 189:case 109:case 173:E=-1;break;case 37:A.shiftKey?F=-1:(A.preventDefault(),y=-1);break;case 39:A.shiftKey?F=1:(A.preventDefault(),y=1);break;case 38:A.shiftKey?O=1:(A.preventDefault(),s=-1);break;case 40:A.shiftKey?O=-1:(A.preventDefault(),s=1);break;default:return}return this._rotationDisabled&&(F=0,O=0),{cameraAnimation:i=>{const r=this._tr;i.easeTo({duration:300,easeId:"keyboardHandler",easing:Vl,zoom:E?Math.round(r.zoom)+E*(A.shiftKey?2:1):r.zoom,bearing:r.bearing+F*this._bearingStep,pitch:r.pitch+O*this._pitchStep,offset:[-y*this._panStep,-s*this._panStep],center:r.center},{originalEvent:A})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Vl(Z){return Z*(2-Z)}const yl=4.000244140625;class ta{constructor(A,E){this._onTimeout=F=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(F)},this._map=A,this._tr=new Hn(A),this._el=A.getCanvasContainer(),this._triggerRenderFrame=E,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(A){this._defaultZoomRate=A}setWheelZoomRate(A){this._wheelZoomRate=A}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(A){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!A&&A.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(A){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!A[this._map._metaKey])return;A.preventDefault()}let E=A.deltaMode===WheelEvent.DOM_DELTA_LINE?40*A.deltaY:A.deltaY;const F=a.h.now(),O=F-(this._lastWheelEventTime||0);this._lastWheelEventTime=F,E!==0&&E%yl==0?this._type="wheel":E!==0&&Math.abs(E)<4?this._type="trackpad":O>400?(this._type=null,this._lastValue=E,this._timeout=setTimeout(this._onTimeout,40,A)):this._type||(this._type=Math.abs(O*E)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,E+=this._lastValue)),A.shiftKey&&E&&(E/=4),this._type&&(this._lastWheelEvent=A,this._delta-=E,this._active||this._start(A)),A.preventDefault()}_start(A){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const E=W.mousePos(this._el,A),F=this._tr;this._around=a.L.convert(this._aroundCenter?F.center:F.unproject(E)),this._aroundPoint=F.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const A=this._tr.transform;if(this._delta!==0){const i=this._type==="wheel"&&Math.abs(this._delta)>yl?this._wheelZoomRate:this._defaultZoomRate;let r=2/(1+Math.exp(-Math.abs(this._delta*i)));this._delta<0&&r!==0&&(r=1/r);const l=typeof this._targetZoom=="number"?A.zoomScale(this._targetZoom):A.scale;this._targetZoom=Math.min(A.maxZoom,Math.max(A.minZoom,A.scaleZoom(l*r))),this._type==="wheel"&&(this._startZoom=A.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const E=typeof this._targetZoom=="number"?this._targetZoom:A.zoom,F=this._startZoom,O=this._easing;let y,s=!1;if(this._type==="wheel"&&F&&O){const i=Math.min((a.h.now()-this._lastWheelEventTime)/200,1),r=O(i);y=a.B.number(F,E,r),i<1?this._frameId||(this._frameId=!0):s=!0}else y=E,s=!0;return this._active=!0,s&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!s,zoomDelta:y-A.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(A){let E=a.bb;if(this._prevEase){const F=this._prevEase,O=(a.h.now()-F.start)/F.duration,y=F.easing(O+.01)-F.easing(O),s=.27/Math.sqrt(y*y+1e-4)*.01,i=Math.sqrt(.0729-s*s);E=a.ba(s,i,.25,1)}return this._prevEase={start:a.h.now(),duration:A,easing:E},E}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class oc{constructor(A,E){this._clickZoom=A,this._tapZoom=E}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class $u{constructor(A){this._tr=new Hn(A),this.reset()}reset(){this._active=!1}dblclick(A,E){return A.preventDefault(),{cameraAnimation:F=>{F.easeTo({duration:300,zoom:this._tr.zoom+(A.shiftKey?-1:1),around:this._tr.unproject(E)},{originalEvent:A})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $l{constructor(){this._tap=new ks({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(A,E,F){if(!this._swipePoint)if(this._tapTime){const O=E[0],y=A.timeStamp-this._tapTime<500,s=this._tapPoint.dist(O)<30;y&&s?F.length>0&&(this._swipePoint=O,this._swipeTouch=F[0].identifier):this.reset()}else this._tap.touchstart(A,E,F)}touchmove(A,E,F){if(this._tapTime){if(this._swipePoint){if(F[0].identifier!==this._swipeTouch)return;const O=E[0],y=O.y-this._swipePoint.y;return this._swipePoint=O,A.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(A,E,F)}touchend(A,E,F){if(this._tapTime)this._swipePoint&&F.length===0&&this.reset();else{const O=this._tap.touchend(A,E,F);O&&(this._tapTime=A.timeStamp,this._tapPoint=O)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ms{constructor(A,E,F){this._el=A,this._mousePan=E,this._touchPan=F}enable(A){this._inertiaOptions=A||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class _a{constructor(A,E,F){this._pitchWithRotate=A.pitchWithRotate,this._mouseRotate=E,this._mousePitch=F}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class el{constructor(A,E,F,O){this._el=A,this._touchZoom=E,this._touchRotate=F,this._tapDragZoom=O,this._rotationDisabled=!1,this._enabled=!0}enable(A){this._touchZoom.enable(A),this._rotationDisabled||this._touchRotate.enable(A),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const _u=Z=>Z.zoom||Z.drag||Z.pitch||Z.rotate;class Ou extends a.k{}function cu(Z){return Z.panDelta&&Z.panDelta.mag()||Z.zoomDelta||Z.bearingDelta||Z.pitchDelta}class Nu{constructor(A,E){this.handleWindowEvent=O=>{this.handleEvent(O,`${O.type}Window`)},this.handleEvent=(O,y)=>{if(O.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const s=O.type==="renderFrame"?void 0:O,i={needsRenderFrame:!1},r={},l={},d=O.touches,_=d?this._getMapTouches(d):void 0,w=_?W.touchPos(this._el,_):W.mousePos(this._el,O);for(const{handlerName:j,handler:X,allowed:ce}of this._handlers){if(!X.isEnabled())continue;let Se;this._blockedByActive(l,ce,j)?X.reset():X[y||O.type]&&(Se=X[y||O.type](O,w,_),this.mergeHandlerResult(i,r,Se,j,s),Se&&Se.needsRenderFrame&&this._triggerRenderFrame()),(Se||X.isActive())&&(l[j]=X)}const T={};for(const j in this._previousActiveHandlers)l[j]||(T[j]=s);this._previousActiveHandlers=l,(Object.keys(T).length||cu(i))&&(this._changes.push([i,r,T]),this._triggerRenderFrame()),(Object.keys(l).length||cu(i))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:B}=i;B&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],B(this._map))},this._map=A,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new pi(A),this._bearingSnap=E.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(E);const F=this._el;this._listeners=[[F,"touchstart",{passive:!0}],[F,"touchmove",{passive:!1}],[F,"touchend",void 0],[F,"touchcancel",void 0],[F,"mousedown",void 0],[F,"mousemove",void 0],[F,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[F,"mouseover",void 0],[F,"mouseout",void 0],[F,"dblclick",void 0],[F,"click",void 0],[F,"keydown",{capture:!1}],[F,"keyup",void 0],[F,"wheel",{passive:!1}],[F,"contextmenu",void 0],[window,"blur",void 0]];for(const[O,y,s]of this._listeners)W.addEventListener(O,y,O===document?this.handleWindowEvent:this.handleEvent,s)}destroy(){for(const[A,E,F]of this._listeners)W.removeEventListener(A,E,A===document?this.handleWindowEvent:this.handleEvent,F)}_addDefaultHandlers(A){const E=this._map,F=E.getCanvasContainer();this._add("mapEvent",new Fi(E,A));const O=E.boxZoom=new lr(E,A);this._add("boxZoom",O),A.interactive&&A.boxZoom&&O.enable();const y=new ps(E),s=new $u(E);E.doubleClickZoom=new oc(s,y),this._add("tapZoom",y),this._add("clickZoom",s),A.interactive&&A.doubleClickZoom&&E.doubleClickZoom.enable();const i=new $l;this._add("tapDragZoom",i);const r=E.touchPitch=new _l(E);this._add("touchPitch",r),A.interactive&&A.touchPitch&&E.touchPitch.enable(A.touchPitch);const l=vo(A),d=Ml(A);E.dragRotate=new _a(A,l,d),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",d,["mouseRotate"]),A.interactive&&A.dragRotate&&E.dragRotate.enable();const _=(({enable:ce,clickTolerance:Se})=>{const Te=new rs({checkCorrectEvent:Re=>W.mouseButton(Re)===0&&!Re.ctrlKey});return new Ya({clickTolerance:Se,move:(Re,Be)=>({around:Be,panDelta:Be.sub(Re)}),activateOnStart:!0,moveStateManager:Te,enable:ce,assignEvents:Ru})})(A),w=new Dn(A,E);E.dragPan=new ms(F,_,w),this._add("mousePan",_),this._add("touchPan",w,["touchZoom","touchRotate"]),A.interactive&&A.dragPan&&E.dragPan.enable(A.dragPan);const T=new Wl,B=new Nl;E.touchZoomRotate=new el(F,B,T,i),this._add("touchRotate",T,["touchPan","touchZoom"]),this._add("touchZoom",B,["touchPan","touchRotate"]),A.interactive&&A.touchZoomRotate&&E.touchZoomRotate.enable(A.touchZoomRotate);const j=E.scrollZoom=new ta(E,()=>this._triggerRenderFrame());this._add("scrollZoom",j,["mousePan"]),A.interactive&&A.scrollZoom&&E.scrollZoom.enable(A.scrollZoom);const X=E.keyboard=new Fu(E);this._add("keyboard",X),A.interactive&&A.keyboard&&E.keyboard.enable(),this._add("blockableMapEvent",new Bn(E))}_add(A,E,F){this._handlers.push({handlerName:A,handler:E,allowed:F}),this._handlersById[A]=E}stop(A){if(!this._updatingCamera){for(const{handler:E}of this._handlers)E.reset();this._inertia.clear(),this._fireEvents({},{},A),this._changes=[]}}isActive(){for(const{handler:A}of this._handlers)if(A.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!_u(this._eventsInProgress)||this.isZooming()}_blockedByActive(A,E,F){for(const O in A)if(O!==F&&(!E||E.indexOf(O)<0))return!0;return!1}_getMapTouches(A){const E=[];for(const F of A)this._el.contains(F.target)&&E.push(F);return E}mergeHandlerResult(A,E,F,O,y){if(!F)return;a.e(A,F);const s={handlerName:O,originalEvent:F.originalEvent||y};F.zoomDelta!==void 0&&(E.zoom=s),F.panDelta!==void 0&&(E.drag=s),F.pitchDelta!==void 0&&(E.pitch=s),F.bearingDelta!==void 0&&(E.rotate=s)}_applyChanges(){const A={},E={},F={};for(const[O,y,s]of this._changes)O.panDelta&&(A.panDelta=(A.panDelta||new a.P(0,0))._add(O.panDelta)),O.zoomDelta&&(A.zoomDelta=(A.zoomDelta||0)+O.zoomDelta),O.bearingDelta&&(A.bearingDelta=(A.bearingDelta||0)+O.bearingDelta),O.pitchDelta&&(A.pitchDelta=(A.pitchDelta||0)+O.pitchDelta),O.around!==void 0&&(A.around=O.around),O.pinchAround!==void 0&&(A.pinchAround=O.pinchAround),O.noInertia&&(A.noInertia=O.noInertia),a.e(E,y),a.e(F,s);this._updateMapTransform(A,E,F),this._changes=[]}_updateMapTransform(A,E,F){const O=this._map,y=O._getTransformForUpdate(),s=O.terrain;if(!(cu(A)||s&&this._terrainMovement))return this._fireEvents(E,F,!0);let{panDelta:i,zoomDelta:r,bearingDelta:l,pitchDelta:d,around:_,pinchAround:w}=A;w!==void 0&&(_=w),O._stop(!0),_=_||O.transform.centerPoint;const T=y.pointLocation(i?_.sub(i):_);l&&(y.bearing+=l),d&&(y.pitch+=d),r&&(y.zoom+=r),s?this._terrainMovement||!E.drag&&!E.zoom?E.drag&&this._terrainMovement?y.center=y.pointLocation(y.centerPoint.sub(i)):y.setLocationAtPoint(T,_):(this._terrainMovement=!0,this._map._elevationFreeze=!0,y.setLocationAtPoint(T,_),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,y.recalculateZoom(O.terrain)})):y.setLocationAtPoint(T,_),O._applyUpdatedTransform(y),this._map._update(),A.noInertia||this._inertia.record(A),this._fireEvents(E,F,!0)}_fireEvents(A,E,F){const O=_u(this._eventsInProgress),y=_u(A),s={};for(const d in A){const{originalEvent:_}=A[d];this._eventsInProgress[d]||(s[`${d}start`]=_),this._eventsInProgress[d]=A[d]}!O&&y&&this._fireEvent("movestart",y.originalEvent);for(const d in s)this._fireEvent(d,s[d]);y&&this._fireEvent("move",y.originalEvent);for(const d in A){const{originalEvent:_}=A[d];this._fireEvent(d,_)}const i={};let r;for(const d in this._eventsInProgress){const{handlerName:_,originalEvent:w}=this._eventsInProgress[d];this._handlersById[_].isActive()||(delete this._eventsInProgress[d],r=E[_]||w,i[`${d}end`]=r)}for(const d in i)this._fireEvent(d,i[d]);const l=_u(this._eventsInProgress);if(F&&(O||y)&&!l){this._updatingCamera=!0;const d=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),_=w=>w!==0&&-this._bearingSnap<w&&w<this._bearingSnap;!d||!d.essential&&a.h.prefersReducedMotion?(this._map.fire(new a.k("moveend",{originalEvent:r})),_(this._map.getBearing())&&this._map.resetNorth()):(_(d.bearing||this._map.getBearing())&&(d.bearing=0),d.freezeElevation=!0,this._map.easeTo(d,{originalEvent:r})),this._updatingCamera=!1}}_fireEvent(A,E){this._map.fire(new a.k(A,E?{originalEvent:E}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(A=>{delete this._frameId,this.handleEvent(new Ou("renderFrame",{timeStamp:A})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class _r extends a.E{constructor(A,E){super(),this._renderFrameCallback=()=>{const F=Math.min((a.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(F)),F<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=A,this._bearingSnap=E.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new a.L(this.transform.center.lng,this.transform.center.lat)}setCenter(A,E){return this.jumpTo({center:A},E)}panBy(A,E,F){return A=a.P.convert(A).mult(-1),this.panTo(this.transform.center,a.e({offset:A},E),F)}panTo(A,E,F){return this.easeTo(a.e({center:A},E),F)}getZoom(){return this.transform.zoom}setZoom(A,E){return this.jumpTo({zoom:A},E),this}zoomTo(A,E,F){return this.easeTo(a.e({zoom:A},E),F)}zoomIn(A,E){return this.zoomTo(this.getZoom()+1,A,E),this}zoomOut(A,E){return this.zoomTo(this.getZoom()-1,A,E),this}getBearing(){return this.transform.bearing}setBearing(A,E){return this.jumpTo({bearing:A},E),this}getPadding(){return this.transform.padding}setPadding(A,E){return this.jumpTo({padding:A},E),this}rotateTo(A,E,F){return this.easeTo(a.e({bearing:A},E),F)}resetNorth(A,E){return this.rotateTo(0,a.e({duration:1e3},A),E),this}resetNorthPitch(A,E){return this.easeTo(a.e({bearing:0,pitch:0,duration:1e3},A),E),this}snapToNorth(A,E){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(A,E):this}getPitch(){return this.transform.pitch}setPitch(A,E){return this.jumpTo({pitch:A},E),this}cameraForBounds(A,E){A=Ni.convert(A);const F=E&&E.bearing||0;return this._cameraForBoxAndBearing(A.getNorthWest(),A.getSouthEast(),F,E)}_cameraForBoxAndBearing(A,E,F,O){const y={top:0,bottom:0,right:0,left:0};if(typeof(O=a.e({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},O)).padding=="number"){const Be=O.padding;O.padding={top:Be,bottom:Be,right:Be,left:Be}}O.padding=a.e(y,O.padding);const s=this.transform,i=s.padding,r=s.project(a.L.convert(A)),l=s.project(a.L.convert(E)),d=r.rotate(-F*Math.PI/180),_=l.rotate(-F*Math.PI/180),w=new a.P(Math.max(d.x,_.x),Math.max(d.y,_.y)),T=new a.P(Math.min(d.x,_.x),Math.min(d.y,_.y)),B=w.sub(T),j=(s.width-(i.left+i.right+O.padding.left+O.padding.right))/B.x,X=(s.height-(i.top+i.bottom+O.padding.top+O.padding.bottom))/B.y;if(X<0||j<0)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ce=Math.min(s.scaleZoom(s.scale*Math.min(j,X)),O.maxZoom),Se=a.P.convert(O.offset),Te=new a.P((O.padding.left-O.padding.right)/2,(O.padding.top-O.padding.bottom)/2).rotate(F*Math.PI/180),Re=Se.add(Te).mult(s.scale/s.zoomScale(ce));return{center:s.unproject(r.add(l).div(2).sub(Re)),zoom:ce,bearing:F}}fitBounds(A,E,F){return this._fitInternal(this.cameraForBounds(A,E),E,F)}fitScreenCoordinates(A,E,F,O,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.P.convert(A)),this.transform.pointLocation(a.P.convert(E)),F,O),O,y)}_fitInternal(A,E,F){return A?(delete(E=a.e(A,E)).padding,E.linear?this.easeTo(E,F):this.flyTo(E,F)):this}jumpTo(A,E){this.stop();const F=this._getTransformForUpdate();let O=!1,y=!1,s=!1;return"zoom"in A&&F.zoom!==+A.zoom&&(O=!0,F.zoom=+A.zoom),A.center!==void 0&&(F.center=a.L.convert(A.center)),"bearing"in A&&F.bearing!==+A.bearing&&(y=!0,F.bearing=+A.bearing),"pitch"in A&&F.pitch!==+A.pitch&&(s=!0,F.pitch=+A.pitch),A.padding==null||F.isPaddingEqual(A.padding)||(F.padding=A.padding),this._applyUpdatedTransform(F),this.fire(new a.k("movestart",E)).fire(new a.k("move",E)),O&&this.fire(new a.k("zoomstart",E)).fire(new a.k("zoom",E)).fire(new a.k("zoomend",E)),y&&this.fire(new a.k("rotatestart",E)).fire(new a.k("rotate",E)).fire(new a.k("rotateend",E)),s&&this.fire(new a.k("pitchstart",E)).fire(new a.k("pitch",E)).fire(new a.k("pitchend",E)),this.fire(new a.k("moveend",E))}calculateCameraOptionsFromTo(A,E,F,O=0){const y=a.U.fromLngLat(A,E),s=a.U.fromLngLat(F,O),i=s.x-y.x,r=s.y-y.y,l=s.z-y.z,d=Math.hypot(i,r,l);if(d===0)throw new Error("Can't calculate camera options with same From and To");const _=Math.hypot(i,r),w=this.transform.scaleZoom(this.transform.cameraToCenterDistance/d/this.transform.tileSize),T=180*Math.atan2(i,-r)/Math.PI;let B=180*Math.acos(_/d)/Math.PI;return B=l<0?90-B:90+B,{center:s.toLngLat(),zoom:w,pitch:B,bearing:T}}easeTo(A,E){this._stop(!1,A.easeId),((A=a.e({offset:[0,0],duration:500,easing:a.bb},A)).animate===!1||!A.essential&&a.h.prefersReducedMotion)&&(A.duration=0);const F=this._getTransformForUpdate(),O=this.getZoom(),y=this.getBearing(),s=this.getPitch(),i=this.getPadding(),r="zoom"in A?+A.zoom:O,l="bearing"in A?this._normalizeBearing(A.bearing,y):y,d="pitch"in A?+A.pitch:s,_="padding"in A?A.padding:F.padding,w=a.P.convert(A.offset);let T=F.centerPoint.add(w);const B=F.pointLocation(T),j=a.L.convert(A.center||B);this._normalizeCenter(j);const X=F.project(B),ce=F.project(j).sub(X),Se=F.zoomScale(r-O);let Te,Re;A.around&&(Te=a.L.convert(A.around),Re=F.locationPoint(Te));const Be={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||r!==O,this._rotating=this._rotating||y!==l,this._pitching=this._pitching||d!==s,this._padding=!F.isPaddingEqual(_),this._easeId=A.easeId,this._prepareEase(E,A.noMoveStart,Be),this.terrain&&this._prepareElevation(j),this._ease(Ke=>{if(this._zooming&&(F.zoom=a.B.number(O,r,Ke)),this._rotating&&(F.bearing=a.B.number(y,l,Ke)),this._pitching&&(F.pitch=a.B.number(s,d,Ke)),this._padding&&(F.interpolatePadding(i,_,Ke),T=F.centerPoint.add(w)),this.terrain&&!A.freezeElevation&&this._updateElevation(Ke),Te)F.setLocationAtPoint(Te,Re);else{const yt=F.zoomScale(F.zoom-O),ot=r>O?Math.min(2,Se):Math.max(.5,Se),ct=Math.pow(ot,1-Ke),It=F.unproject(X.add(ce.mult(Ke*ct)).mult(yt));F.setLocationAtPoint(F.renderWorldCopies?It.wrap():It,T)}this._applyUpdatedTransform(F),this._fireMoveEvents(E)},Ke=>{this.terrain&&this._finalizeElevation(),this._afterEase(E,Ke)},A),this}_prepareEase(A,E,F={}){this._moving=!0,E||F.moving||this.fire(new a.k("movestart",A)),this._zooming&&!F.zooming&&this.fire(new a.k("zoomstart",A)),this._rotating&&!F.rotating&&this.fire(new a.k("rotatestart",A)),this._pitching&&!F.pitching&&this.fire(new a.k("pitchstart",A))}_prepareElevation(A){this._elevationCenter=A,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(A,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(A){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const E=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(A<1&&E!==this._elevationTarget){const F=this._elevationTarget-this._elevationStart;this._elevationStart+=A*(F-(E-(F*A+this._elevationStart))/(1-A)),this._elevationTarget=E}this.transform.elevation=a.B.number(this._elevationStart,this._elevationTarget,A)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(A){if(!this.transformCameraUpdate)return;const E=A.clone(),{center:F,zoom:O,pitch:y,bearing:s,elevation:i}=this.transformCameraUpdate(E);F&&(E.center=F),O!==void 0&&(E.zoom=O),y!==void 0&&(E.pitch=y),s!==void 0&&(E.bearing=s),i!==void 0&&(E.elevation=i),this.transform.apply(E)}_fireMoveEvents(A){this.fire(new a.k("move",A)),this._zooming&&this.fire(new a.k("zoom",A)),this._rotating&&this.fire(new a.k("rotate",A)),this._pitching&&this.fire(new a.k("pitch",A))}_afterEase(A,E){if(this._easeId&&E&&this._easeId===E)return;delete this._easeId;const F=this._zooming,O=this._rotating,y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,F&&this.fire(new a.k("zoomend",A)),O&&this.fire(new a.k("rotateend",A)),y&&this.fire(new a.k("pitchend",A)),this.fire(new a.k("moveend",A))}flyTo(A,E){if(!A.essential&&a.h.prefersReducedMotion){const si=a.F(A,["center","zoom","bearing","pitch","around"]);return this.jumpTo(si,E)}this.stop(),A=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.bb},A);const F=this._getTransformForUpdate(),O=this.getZoom(),y=this.getBearing(),s=this.getPitch(),i=this.getPadding(),r="zoom"in A?a.ad(+A.zoom,F.minZoom,F.maxZoom):O,l="bearing"in A?this._normalizeBearing(A.bearing,y):y,d="pitch"in A?+A.pitch:s,_="padding"in A?A.padding:F.padding,w=F.zoomScale(r-O),T=a.P.convert(A.offset);let B=F.centerPoint.add(T);const j=F.pointLocation(B),X=a.L.convert(A.center||j);this._normalizeCenter(X);const ce=F.project(j),Se=F.project(X).sub(ce);let Te=A.curve;const Re=Math.max(F.width,F.height),Be=Re/w,Ke=Se.mag();if("minZoom"in A){const si=a.ad(Math.min(A.minZoom,O,r),F.minZoom,F.maxZoom),Qi=Re/F.zoomScale(si-O);Te=Math.sqrt(Qi/Ke*2)}const yt=Te*Te;function ot(si){const Qi=(Be*Be-Re*Re+(si?-1:1)*yt*yt*Ke*Ke)/(2*(si?Be:Re)*yt*Ke);return Math.log(Math.sqrt(Qi*Qi+1)-Qi)}function ct(si){return(Math.exp(si)-Math.exp(-si))/2}function It(si){return(Math.exp(si)+Math.exp(-si))/2}const bt=ot(!1);let ri=function(si){return It(bt)/It(bt+Te*si)},Xt=function(si){return Re*((It(bt)*(ct(Qi=bt+Te*si)/It(Qi))-ct(bt))/yt)/Ke;var Qi},ti=(ot(!0)-bt)/Te;if(Math.abs(Ke)<1e-6||!isFinite(ti)){if(Math.abs(Re-Be)<1e-6)return this.easeTo(A,E);const si=Be<Re?-1:1;ti=Math.abs(Math.log(Be/Re))/Te,Xt=function(){return 0},ri=function(Qi){return Math.exp(si*Te*Qi)}}return A.duration="duration"in A?+A.duration:1e3*ti/("screenSpeed"in A?+A.screenSpeed/Te:+A.speed),A.maxDuration&&A.duration>A.maxDuration&&(A.duration=0),this._zooming=!0,this._rotating=y!==l,this._pitching=d!==s,this._padding=!F.isPaddingEqual(_),this._prepareEase(E,!1),this.terrain&&this._prepareElevation(X),this._ease(si=>{const Qi=si*ti,Wi=1/ri(Qi);F.zoom=si===1?r:O+F.scaleZoom(Wi),this._rotating&&(F.bearing=a.B.number(y,l,si)),this._pitching&&(F.pitch=a.B.number(s,d,si)),this._padding&&(F.interpolatePadding(i,_,si),B=F.centerPoint.add(T)),this.terrain&&!A.freezeElevation&&this._updateElevation(si);const Ei=si===1?X:F.unproject(ce.add(Se.mult(Xt(Qi))).mult(Wi));F.setLocationAtPoint(F.renderWorldCopies?Ei.wrap():Ei,B),this._applyUpdatedTransform(F),this._fireMoveEvents(E)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(E)},A),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(A,E){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const F=this._onEaseEnd;delete this._onEaseEnd,F.call(this,E)}if(!A){const F=this.handlers;F&&F.stop(!1)}return this}_ease(A,E,F){F.animate===!1||F.duration===0?(A(1),E()):(this._easeStart=a.h.now(),this._easeOptions=F,this._onEaseFrame=A,this._onEaseEnd=E,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(A,E){A=a.b5(A,-180,180);const F=Math.abs(A-E);return Math.abs(A-360-E)<F&&(A-=360),Math.abs(A+360-E)<F&&(A+=360),A}_normalizeCenter(A){const E=this.transform;if(!E.renderWorldCopies||E.lngRange)return;const F=A.lng-E.center.lng;A.lng+=F>180?-360:F<-180?360:0}queryTerrainElevation(A){return this.terrain?this.terrain.getElevationForLngLatZoom(a.L.convert(A),this.transform.tileZoom)-this.transform.elevation:null}}class gs{constructor(A={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=E=>{!E||E.sourceDataType!=="metadata"&&E.sourceDataType!=="visibility"&&E.dataType!=="style"&&E.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=A}getDefaultPosition(){return"bottom-right"}onAdd(A){return this._map=A,this._compact=this.options&&this.options.compact,this._container=W.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=W.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=W.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){W.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(A,E){const F=this._map._getUIString(`AttributionControl.${E}`);A.title=F,A.setAttribute("aria-label",F)}_updateAttributions(){if(!this._map.style)return;let A=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?A=A.concat(this.options.customAttribution.map(O=>typeof O!="string"?"":O)):typeof this.options.customAttribution=="string"&&A.push(this.options.customAttribution)),this._map.style.stylesheet){const O=this._map.style.stylesheet;this.styleOwner=O.owner,this.styleId=O.id}const E=this._map.style.sourceCaches;for(const O in E){const y=E[O];if(y.used||y.usedForTerrain){const s=y.getSource();s.attribution&&A.indexOf(s.attribution)<0&&A.push(s.attribution)}}A=A.filter(O=>String(O).trim()),A.sort((O,y)=>O.length-y.length),A=A.filter((O,y)=>{for(let s=y+1;s<A.length;s++)if(A[s].indexOf(O)>=0)return!1;return!0});const F=A.join(" | ");F!==this._attribHTML&&(this._attribHTML=F,A.length?(this._innerContainer.innerHTML=F,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class gn{constructor(A={}){this._updateCompact=()=>{const E=this._container.children;if(E.length){const F=E[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&F.classList.add("maplibregl-compact"):F.classList.remove("maplibregl-compact")}},this.options=A}getDefaultPosition(){return"bottom-left"}onAdd(A){this._map=A,this._compact=this.options&&this.options.compact,this._container=W.create("div","maplibregl-ctrl");const E=W.create("a","maplibregl-ctrl-logo");return E.target="_blank",E.rel="noopener nofollow",E.href="https://maplibre.org/",E.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),E.setAttribute("rel","noopener nofollow"),this._container.appendChild(E),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){W.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class jn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(A){const E=++this._id;return this._queue.push({callback:A,id:E,cancelled:!1}),E}remove(A){const E=this._currentlyRunning,F=E?this._queue.concat(E):this._queue;for(const O of F)if(O.id===A)return void(O.cancelled=!0)}run(A=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const E=this._currentlyRunning=this._queue;this._queue=[];for(const F of E)if(!F.cancelled&&(F.callback(A),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Jn={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var tl=a.Q([{name:"a_pos3d",type:"Int16",components:3}]);class Tu extends a.E{constructor(A){super(),this.sourceCache=A,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,A.usedForTerrain=!0,A.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(A,E){this.sourceCache.update(A,E),this._renderableTilesKeys=[];const F={};for(const O of A.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:E}))F[O.key]=!0,this._renderableTilesKeys.push(O.key),this._tiles[O.key]||(O.posMatrix=new Float64Array(16),a.aS(O.posMatrix,0,a.N,0,a.N,0,1),this._tiles[O.key]=new _n(O,this.tileSize));for(const O in this._tiles)F[O]||delete this._tiles[O]}freeRtt(A){for(const E in this._tiles){const F=this._tiles[E];(!A||F.tileID.equals(A)||F.tileID.isChildOf(A)||A.isChildOf(F.tileID))&&(F.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(A=>this.getTileByID(A))}getTileByID(A){return this._tiles[A]}getTerrainCoords(A){const E={};for(const F of this._renderableTilesKeys){const O=this._tiles[F].tileID;if(O.canonical.equals(A.canonical)){const y=A.clone();y.posMatrix=new Float64Array(16),a.aS(y.posMatrix,0,a.N,0,a.N,0,1),E[F]=y}else if(O.canonical.isChildOf(A.canonical)){const y=A.clone();y.posMatrix=new Float64Array(16);const s=O.canonical.z-A.canonical.z,i=O.canonical.x-(O.canonical.x>>s<<s),r=O.canonical.y-(O.canonical.y>>s<<s),l=a.N>>s;a.aS(y.posMatrix,0,l,0,l,0,1),a.$(y.posMatrix,y.posMatrix,[-i*l,-r*l,0]),E[F]=y}else if(A.canonical.isChildOf(O.canonical)){const y=A.clone();y.posMatrix=new Float64Array(16);const s=A.canonical.z-O.canonical.z,i=A.canonical.x-(A.canonical.x>>s<<s),r=A.canonical.y-(A.canonical.y>>s<<s),l=a.N>>s;a.aS(y.posMatrix,0,a.N,0,a.N,0,1),a.$(y.posMatrix,y.posMatrix,[i*l,r*l,0]),a.a0(y.posMatrix,y.posMatrix,[1/2**s,1/2**s,0]),E[F]=y}}return E}getSourceTile(A,E){const F=this.sourceCache._source;let O=A.overscaledZ-this.deltaZoom;if(O>F.maxzoom&&(O=F.maxzoom),O<F.minzoom)return null;this._sourceTileCache[A.key]||(this._sourceTileCache[A.key]=A.scaledTo(O).key);let y=this.sourceCache.getTileByID(this._sourceTileCache[A.key]);if((!y||!y.dem)&&E)for(;O>=F.minzoom&&(!y||!y.dem);)y=this.sourceCache.getTileByID(A.scaledTo(O--).key);return y}tilesAfterTime(A=Date.now()){return Object.values(this._tiles).filter(E=>E.timeAdded>=A)}}class oa{constructor(A,E,F){this.painter=A,this.sourceCache=new Tu(E),this.options=F,this.exaggeration=typeof F.exaggeration=="number"?F.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(A,E,F,O=a.N){var y;if(!(E>=0&&E<O&&F>=0&&F<O))return 0;const s=this.getTerrainData(A),i=(y=s.tile)===null||y===void 0?void 0:y.dem;if(!i)return 0;const r=function(B,j,X){var ce=j[0],Se=j[1];return B[0]=X[0]*ce+X[4]*Se+X[12],B[1]=X[1]*ce+X[5]*Se+X[13],B}([],[E/O*a.N,F/O*a.N],s.u_terrain_matrix),l=[r[0]*i.dim,r[1]*i.dim],d=Math.floor(l[0]),_=Math.floor(l[1]),w=l[0]-d,T=l[1]-_;return i.get(d,_)*(1-w)*(1-T)+i.get(d+1,_)*w*(1-T)+i.get(d,_+1)*(1-w)*T+i.get(d+1,_+1)*w*T}getElevationForLngLatZoom(A,E){const{tileID:F,mercatorX:O,mercatorY:y}=this._getOverscaledTileIDFromLngLatZoom(A,E);return this.getElevation(F,O%a.N,y%a.N,a.N)}getElevation(A,E,F,O=a.N){return this.getDEMElevation(A,E,F,O)*this.exaggeration}getTerrainData(A){if(!this._emptyDemTexture){const O=this.painter.context,y=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new mt(O,y,O.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new mt(O,new a.R({width:1,height:1}),O.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(O.gl.NEAREST,O.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.ao([])}const E=this.sourceCache.getSourceTile(A,!0);if(E&&E.dem&&(!E.demTexture||E.needsTerrainPrepare)){const O=this.painter.context;E.demTexture=this.painter.getTileTexture(E.dem.stride),E.demTexture?E.demTexture.update(E.dem.getPixels(),{premultiply:!1}):E.demTexture=new mt(O,E.dem.getPixels(),O.gl.RGBA,{premultiply:!1}),E.demTexture.bind(O.gl.NEAREST,O.gl.CLAMP_TO_EDGE),E.needsTerrainPrepare=!1}const F=E&&E+E.tileID.key+A.key;if(F&&!this._demMatrixCache[F]){const O=this.sourceCache.sourceCache._source.maxzoom;let y=A.canonical.z-E.tileID.canonical.z;A.overscaledZ>A.canonical.z&&(A.canonical.z>=O?y=A.canonical.z-O:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const s=A.canonical.x-(A.canonical.x>>y<<y),i=A.canonical.y-(A.canonical.y>>y<<y),r=a.bc(new Float64Array(16),[1/(a.N<<y),1/(a.N<<y),0]);a.$(r,r,[s*a.N,i*a.N,0]),this._demMatrixCache[A.key]={matrix:r,coord:A}}return{u_depth:2,u_terrain:3,u_terrain_dim:E&&E.dem&&E.dem.dim||1,u_terrain_matrix:F?this._demMatrixCache[A.key].matrix:this._emptyDemMatrix,u_terrain_unpack:E&&E.dem&&E.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(E&&E.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:E}}getFramebuffer(A){const E=this.painter,F=E.width/devicePixelRatio,O=E.height/devicePixelRatio;return!this._fbo||this._fbo.width===F&&this._fbo.height===O||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new mt(E.context,{width:F,height:O,data:null},E.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(E.context.gl.NEAREST,E.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new mt(E.context,{width:F,height:O,data:null},E.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(E.context.gl.NEAREST,E.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=E.context.createFramebuffer(F,O,!0,!1),this._fbo.depthAttachment.set(E.context.createRenderbuffer(E.context.gl.DEPTH_COMPONENT16,F,O))),this._fbo.colorAttachment.set(A==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const A=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const E=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,s=0;y<this._coordsTextureSize;y++)for(let i=0;i<this._coordsTextureSize;i++,s+=4)E[s+0]=255&i,E[s+1]=255&y,E[s+2]=i>>8<<4|y>>8,E[s+3]=0;const F=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(E.buffer)),O=new mt(A,F,A.gl.RGBA,{premultiply:!1});return O.bind(A.gl.NEAREST,A.gl.CLAMP_TO_EDGE),this._coordsTexture=O,O}pointCoordinate(A){const E=new Uint8Array(4),F=this.painter.context,O=F.gl;F.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),O.readPixels(A.x,this.painter.height/devicePixelRatio-A.y-1,1,1,O.RGBA,O.UNSIGNED_BYTE,E),F.bindFramebuffer.set(null);const y=E[0]+(E[2]>>4<<8),s=E[1]+((15&E[2])<<8),i=this.coordsIndex[255-E[3]],r=i&&this.sourceCache.getTileByID(i);if(!r)return null;const l=this._coordsTextureSize,d=(1<<r.tileID.canonical.z)*l;return new a.U(this._allowMercatorOverflow(A,(r.tileID.canonical.x*l+y)/d),(r.tileID.canonical.y*l+s)/d,this.getElevation(r.tileID,y,s,l))}getTerrainMesh(){if(this._mesh)return this._mesh;const A=this.painter.context,E=new a.bd,F=new a.b0,O=this.meshSize,y=a.N/O,s=O*O;for(let _=0;_<=O;_++)for(let w=0;w<=O;w++)E.emplaceBack(w*y,_*y,0);for(let _=0;_<s;_+=O+1)for(let w=0;w<O;w++)F.emplaceBack(w+_,O+w+_+1,O+w+_+2),F.emplaceBack(w+_,O+w+_+2,w+_+1);const i=E.length,r=i+2*(O+1);for(const _ of[0,1])for(let w=0;w<=O;w++)for(const T of[0,1])E.emplaceBack(w*y,_*a.N,T);for(let _=0;_<2*O;_+=2)F.emplaceBack(r+_,r+_+1,r+_+3),F.emplaceBack(r+_,r+_+3,r+_+2),F.emplaceBack(i+_,i+_+3,i+_+1),F.emplaceBack(i+_,i+_+2,i+_+3);const l=E.length,d=l+2*(O+1);for(const _ of[0,1])for(let w=0;w<=O;w++)for(const T of[0,1])E.emplaceBack(_*a.N,w*y,T);for(let _=0;_<2*O;_+=2)F.emplaceBack(l+_,l+_+1,l+_+3),F.emplaceBack(l+_,l+_+3,l+_+2),F.emplaceBack(d+_,d+_+3,d+_+1),F.emplaceBack(d+_,d+_+2,d+_+3);return this._mesh={indexBuffer:A.createIndexBuffer(F),vertexBuffer:A.createVertexBuffer(E,tl.members),segments:a.S.simpleSegment(0,0,E.length,F.length)},this._mesh}getMeshFrameDelta(A){return 2*Math.PI*a.be/Math.pow(2,A)/5}getMinTileElevationForLngLatZoom(A,E){var F;const{tileID:O}=this._getOverscaledTileIDFromLngLatZoom(A,E);return(F=this.getMinMaxElevation(O).minElevation)!==null&&F!==void 0?F:0}getMinMaxElevation(A){const E=this.getTerrainData(A).tile,F={minElevation:null,maxElevation:null};return E&&E.dem&&(F.minElevation=E.dem.min*this.exaggeration,F.maxElevation=E.dem.max*this.exaggeration),F}_getOverscaledTileIDFromLngLatZoom(A,E){const F=a.U.fromLngLat(A.wrap()),O=(1<<E)*a.N,y=F.x*O,s=F.y*O,i=Math.floor(y/a.N),r=Math.floor(s/a.N);return{tileID:new a.O(E,0,E,i,r),mercatorX:y,mercatorY:s}}_allowMercatorOverflow(A,E){const F=A.x<this.painter.width/2;let O=a.bf(E);const y=this.painter.transform.center.lng;return F&&Math.sign(O)>0&&Math.sign(y)<0||!F&&Math.sign(O)<0&&Math.sign(y)>0?(O=360*Math.sign(y)+O,a.G(O)):E}}class yu{constructor(A,E,F){this._context=A,this._size=E,this._tileSize=F,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const A of this._objects)A.texture.destroy(),A.fbo.destroy()}_createObject(A){const E=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),F=new mt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return F.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),E.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),E.colorAttachment.set(F.texture),{id:A,fbo:E,texture:F,stamp:-1,inUse:!1}}getObjectForId(A){return this._objects[A]}useObject(A){A.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(E=>A.id!==E),this._recentlyUsed.push(A.id)}stampObject(A){A.stamp=++this._stamp}getOrCreateFreeObject(){for(const E of this._recentlyUsed)if(!this._objects[E].inUse)return this._objects[E];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const A=this._createObject(this._objects.length);return this._objects.push(A),A}freeObject(A){A.inUse=!1}freeAllObjects(){for(const A of this._objects)this.freeObject(A)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(A=>!A.inUse)===!1}}const vs={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Po{constructor(A,E){this.painter=A,this.terrain=E,this.pool=new yu(A.context,30,E.sourceCache.tileSize*E.qualityFactor)}destruct(){this.pool.destruct()}getTexture(A){return this.pool.getObjectForId(A.rtt[this._stacks.length-1].id).texture}prepareForRender(A,E){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=A._order.filter(F=>!A._layers[F].isHidden(E)),this._coordsDescendingInv={};for(const F in A.sourceCaches){this._coordsDescendingInv[F]={};const O=A.sourceCaches[F].getVisibleCoordinates();for(const y of O){const s=this.terrain.sourceCache.getTerrainCoords(y);for(const i in s)this._coordsDescendingInv[F][i]||(this._coordsDescendingInv[F][i]=[]),this._coordsDescendingInv[F][i].push(s[i])}}this._coordsDescendingInvStr={};for(const F of A._order){const O=A._layers[F],y=O.source;if(vs[O.type]&&!this._coordsDescendingInvStr[y]){this._coordsDescendingInvStr[y]={};for(const s in this._coordsDescendingInv[y])this._coordsDescendingInvStr[y][s]=this._coordsDescendingInv[y][s].map(i=>i.key).sort().join()}}for(const F of this._renderableTiles)for(const O in this._coordsDescendingInvStr){const y=this._coordsDescendingInvStr[O][F.tileID.key];y&&y!==F.rttCoords[O]&&(F.rtt=[])}}renderLayer(A){if(A.isHidden(this.painter.transform.zoom))return!1;const E=A.type,F=this.painter,O=this._renderableLayerIds[this._renderableLayerIds.length-1]===A.id;if(vs[E]&&(this._prevType&&vs[this._prevType]||this._stacks.push([]),this._prevType=E,this._stacks[this._stacks.length-1].push(A.id),!O))return!0;if(vs[this._prevType]||vs[E]&&O){this._prevType=E;const y=this._stacks.length-1,s=this._stacks[y]||[];for(const i of this._renderableTiles){if(this.pool.isFull()&&(Yr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(i),i.rtt[y]){const l=this.pool.getObjectForId(i.rtt[y].id);if(l.stamp===i.rtt[y].stamp){this.pool.useObject(l);continue}}const r=this.pool.getOrCreateFreeObject();this.pool.useObject(r),this.pool.stampObject(r),i.rtt[y]={id:r.id,stamp:r.stamp},F.context.bindFramebuffer.set(r.fbo.framebuffer),F.context.clear({color:a.aT.transparent,stencil:0}),F.currentStencilSource=void 0;for(let l=0;l<s.length;l++){const d=F.style._layers[s[l]],_=d.source?this._coordsDescendingInv[d.source][i.tileID.key]:[i.tileID];F.context.viewport.set([0,0,r.fbo.width,r.fbo.height]),F._renderTileClippingMasks(d,_),F.renderLayer(F,F.style.sourceCaches[d.source],d,_),d.source&&(i.rttCoords[d.source]=this._coordsDescendingInvStr[d.source][i.tileID.key])}}return Yr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),vs[E]}return!1}}const Mi=G,Bi={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},xs=Z=>{Z.touchstart=Z.dragStart,Z.touchmoveWindow=Z.dragMove,Z.touchend=Z.dragEnd},vu={showCompass:!0,showZoom:!0,visualizePitch:!1};class Vo{constructor(A,E,F=!1){this.mousedown=s=>{this.startMouse(a.e({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),W.mousePos(this.element,s)),W.addEventListener(window,"mousemove",this.mousemove),W.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=s=>{this.moveMouse(s,W.mousePos(this.element,s))},this.mouseup=s=>{this.mouseRotate.dragEnd(s),this.mousePitch&&this.mousePitch.dragEnd(s),this.offTemp()},this.touchstart=s=>{s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=W.touchPos(this.element,s.targetTouches)[0],this.startTouch(s,this._startPos),W.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),W.addEventListener(window,"touchend",this.touchend))},this.touchmove=s=>{s.targetTouches.length!==1?this.reset():(this._lastPos=W.touchPos(this.element,s.targetTouches)[0],this.moveTouch(s,this._lastPos))},this.touchend=s=>{s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const O=A.dragRotate._mouseRotate.getClickTolerance(),y=A.dragRotate._mousePitch.getClickTolerance();this.element=E,this.mouseRotate=vo({clickTolerance:O,enable:!0}),this.touchRotate=(({enable:s,clickTolerance:i,bearingDegreesPerPixelMoved:r=.8})=>{const l=new Wu;return new Ya({clickTolerance:i,move:(d,_)=>({bearingDelta:(_.x-d.x)*r}),moveStateManager:l,enable:s,assignEvents:xs})})({clickTolerance:O,enable:!0}),this.map=A,F&&(this.mousePitch=Ml({clickTolerance:y,enable:!0}),this.touchPitch=(({enable:s,clickTolerance:i,pitchDegreesPerPixelMoved:r=-.5})=>{const l=new Wu;return new Ya({clickTolerance:i,move:(d,_)=>({pitchDelta:(_.y-d.y)*r}),moveStateManager:l,enable:s,assignEvents:xs})})({clickTolerance:y,enable:!0})),W.addEventListener(E,"mousedown",this.mousedown),W.addEventListener(E,"touchstart",this.touchstart,{passive:!1}),W.addEventListener(E,"touchcancel",this.reset)}startMouse(A,E){this.mouseRotate.dragStart(A,E),this.mousePitch&&this.mousePitch.dragStart(A,E),W.disableDrag()}startTouch(A,E){this.touchRotate.dragStart(A,E),this.touchPitch&&this.touchPitch.dragStart(A,E),W.disableDrag()}moveMouse(A,E){const F=this.map,{bearingDelta:O}=this.mouseRotate.dragMove(A,E)||{};if(O&&F.setBearing(F.getBearing()+O),this.mousePitch){const{pitchDelta:y}=this.mousePitch.dragMove(A,E)||{};y&&F.setPitch(F.getPitch()+y)}}moveTouch(A,E){const F=this.map,{bearingDelta:O}=this.touchRotate.dragMove(A,E)||{};if(O&&F.setBearing(F.getBearing()+O),this.touchPitch){const{pitchDelta:y}=this.touchPitch.dragMove(A,E)||{};y&&F.setPitch(F.getPitch()+y)}}off(){const A=this.element;W.removeEventListener(A,"mousedown",this.mousedown),W.removeEventListener(A,"touchstart",this.touchstart,{passive:!1}),W.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),W.removeEventListener(window,"touchend",this.touchend),W.removeEventListener(A,"touchcancel",this.reset),this.offTemp()}offTemp(){W.enableDrag(),W.removeEventListener(window,"mousemove",this.mousemove),W.removeEventListener(window,"mouseup",this.mouseup),W.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),W.removeEventListener(window,"touchend",this.touchend)}}let fs;function hl(Z,A,E){if(Z=new a.L(Z.lng,Z.lat),A){const F=new a.L(Z.lng-360,Z.lat),O=new a.L(Z.lng+360,Z.lat),y=E.locationPoint(Z).distSqr(A);E.locationPoint(F).distSqr(A)<y?Z=F:E.locationPoint(O).distSqr(A)<y&&(Z=O)}for(;Math.abs(Z.lng-E.center.lng)>180;){const F=E.locationPoint(Z);if(F.x>=0&&F.y>=0&&F.x<=E.width&&F.y<=E.height)break;Z.lng>E.center.lng?Z.lng-=360:Z.lng+=360}return Z}const Ms={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function C(Z,A,E){const F=Z.classList;for(const O in Ms)F.remove(`maplibregl-${E}-anchor-${O}`);F.add(`maplibregl-${E}-anchor-${A}`)}class D extends a.E{constructor(A){if(super(),this._onKeyPress=E=>{const F=E.code,O=E.charCode||E.keyCode;F!=="Space"&&F!=="Enter"&&O!==32&&O!==13||this.togglePopup()},this._onMapClick=E=>{const F=E.originalEvent.target,O=this._element;this._popup&&(F===O||O.contains(F))&&this.togglePopup()},this._update=E=>{if(!this._map)return;const F=this._map.loaded()&&!this._map.isMoving();((E==null?void 0:E.type)==="terrain"||(E==null?void 0:E.type)==="render"&&!F)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=hl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let O="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?O=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(O=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y=`rotateX(${this._map.getPitch()}deg)`),E&&E.type!=="moveend"||(this._pos=this._pos.round()),W.setTransform(this._element,`${Ms[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${O}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const s=this._map.unproject(this._pos),i=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=s.distanceTo(this._lngLat)>20*i?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=E=>{if(!this._isDragging){const F=this._clickTolerance||this._map._clickTolerance;this._isDragging=E.point.dist(this._pointerdownPos)>=F}this._isDragging&&(this._pos=E.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.k("dragstart"))),this.fire(new a.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.k("dragend")),this._state="inactive"},this._addDragHandler=E=>{this._element.contains(E.originalEvent.target)&&(E.preventDefault(),this._positionDelta=E.point.sub(this._pos).add(this._offset),this._pointerdownPos=E.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=A&&A.anchor||"center",this._color=A&&A.color||"#3FB1CE",this._scale=A&&A.scale||1,this._draggable=A&&A.draggable||!1,this._clickTolerance=A&&A.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=A&&A.rotation||0,this._rotationAlignment=A&&A.rotationAlignment||"auto",this._pitchAlignment=A&&A.pitchAlignment&&A.pitchAlignment!=="auto"?A.pitchAlignment:this._rotationAlignment,A&&A.element)this._element=A.element,this._offset=a.P.convert(A&&A.offset||[0,0]);else{this._defaultMarker=!0,this._element=W.create("div"),this._element.setAttribute("aria-label","Map marker");const E=W.createNS("http://www.w3.org/2000/svg","svg"),F=41,O=27;E.setAttributeNS(null,"display","block"),E.setAttributeNS(null,"height",`${F}px`),E.setAttributeNS(null,"width",`${O}px`),E.setAttributeNS(null,"viewBox",`0 0 ${O} ${F}`);const y=W.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");const s=W.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");const i=W.createNS("http://www.w3.org/2000/svg","g");i.setAttributeNS(null,"transform","translate(3.0, 29.0)"),i.setAttributeNS(null,"fill","#000000");const r=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ce of r){const Se=W.createNS("http://www.w3.org/2000/svg","ellipse");Se.setAttributeNS(null,"opacity","0.04"),Se.setAttributeNS(null,"cx","10.5"),Se.setAttributeNS(null,"cy","5.80029008"),Se.setAttributeNS(null,"rx",ce.rx),Se.setAttributeNS(null,"ry",ce.ry),i.appendChild(Se)}const l=W.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"fill",this._color);const d=W.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),l.appendChild(d);const _=W.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"opacity","0.25"),_.setAttributeNS(null,"fill","#000000");const w=W.createNS("http://www.w3.org/2000/svg","path");w.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),_.appendChild(w);const T=W.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(6.0, 7.0)"),T.setAttributeNS(null,"fill","#FFFFFF");const B=W.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"transform","translate(8.0, 8.0)");const j=W.createNS("http://www.w3.org/2000/svg","circle");j.setAttributeNS(null,"fill","#000000"),j.setAttributeNS(null,"opacity","0.25"),j.setAttributeNS(null,"cx","5.5"),j.setAttributeNS(null,"cy","5.5"),j.setAttributeNS(null,"r","5.4999962");const X=W.createNS("http://www.w3.org/2000/svg","circle");X.setAttributeNS(null,"fill","#FFFFFF"),X.setAttributeNS(null,"cx","5.5"),X.setAttributeNS(null,"cy","5.5"),X.setAttributeNS(null,"r","5.4999962"),B.appendChild(j),B.appendChild(X),s.appendChild(i),s.appendChild(l),s.appendChild(_),s.appendChild(T),s.appendChild(B),E.appendChild(s),E.setAttributeNS(null,"height",F*this._scale+"px"),E.setAttributeNS(null,"width",O*this._scale+"px"),this._element.appendChild(E),this._offset=a.P.convert(A&&A.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",E=>{E.preventDefault()}),this._element.addEventListener("mousedown",E=>{E.preventDefault()}),C(this._element,this._anchor,"marker"),A&&A.className)for(const E of A.className.split(" "))this._element.classList.add(E);this._popup=null}addTo(A){return this.remove(),this._map=A,A.getCanvasContainer().appendChild(this._element),A.on("move",this._update),A.on("moveend",this._update),A.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),W.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(A){return this._lngLat=a.L.convert(A),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(A){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),A){if(!("offset"in A.options)){const O=Math.abs(13.5)/Math.SQRT2;A.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[O,-1*(38.1-13.5+O)],"bottom-right":[-O,-1*(38.1-13.5+O)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=A,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const A=this._popup;return A?(A.isOpen()?A.remove():A.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(A){return this._offset=a.P.convert(A),this._update(),this}addClassName(A){this._element.classList.add(A)}removeClassName(A){this._element.classList.remove(A)}toggleClassName(A){return this._element.classList.toggle(A)}setDraggable(A){return this._draggable=!!A,this._map&&(A?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(A){return this._rotation=A||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(A){return this._rotationAlignment=A||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(A){return this._pitchAlignment=A&&A!=="auto"?A:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const z={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let R=0,ee=!1;const le={maxWidth:100,unit:"metric"};function oe(Z,A,E){const F=E&&E.maxWidth||100,O=Z._container.clientHeight/2,y=Z.unproject([0,O]),s=Z.unproject([F,O]),i=y.distanceTo(s);if(E&&E.unit==="imperial"){const r=3.2808*i;r>5280?we(A,F,r/5280,Z._getUIString("ScaleControl.Miles")):we(A,F,r,Z._getUIString("ScaleControl.Feet"))}else E&&E.unit==="nautical"?we(A,F,i/1852,Z._getUIString("ScaleControl.NauticalMiles")):i>=1e3?we(A,F,i/1e3,Z._getUIString("ScaleControl.Kilometers")):we(A,F,i,Z._getUIString("ScaleControl.Meters"))}function we(Z,A,E,F){const O=function(y){const s=Math.pow(10,`${Math.floor(y)}`.length-1);let i=y/s;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:i>=1?1:function(r){const l=Math.pow(10,Math.ceil(-Math.log(r)/Math.LN10));return Math.round(r*l)/l}(i),s*i}(E);Z.style.width=A*(O/E)+"px",Z.innerHTML=`${O}&nbsp;${F}`}const $e={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},_t=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ct(Z){if(Z){if(typeof Z=="number"){const A=Math.round(Math.abs(Z)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,Z),"top-left":new a.P(A,A),"top-right":new a.P(-A,A),bottom:new a.P(0,-Z),"bottom-left":new a.P(A,-A),"bottom-right":new a.P(-A,-A),left:new a.P(Z,0),right:new a.P(-Z,0)}}if(Z instanceof a.P||Array.isArray(Z)){const A=a.P.convert(Z);return{center:A,top:A,"top-left":A,"top-right":A,bottom:A,"bottom-left":A,"bottom-right":A,left:A,right:A}}return{center:a.P.convert(Z.center||[0,0]),top:a.P.convert(Z.top||[0,0]),"top-left":a.P.convert(Z["top-left"]||[0,0]),"top-right":a.P.convert(Z["top-right"]||[0,0]),bottom:a.P.convert(Z.bottom||[0,0]),"bottom-left":a.P.convert(Z["bottom-left"]||[0,0]),"bottom-right":a.P.convert(Z["bottom-right"]||[0,0]),left:a.P.convert(Z.left||[0,0]),right:a.P.convert(Z.right||[0,0])}}return Ct(new a.P(0,0))}const ni={extend:(Z,...A)=>a.e(Z,...A),run(Z){Z()},logToElement(Z,A=!1,E="log"){const F=window.document.getElementById(E);F&&(A&&(F.innerHTML=""),F.innerHTML+=`<br>${Z}`)}},Gt=G;class Zt{static get version(){return Gt}static get workerCount(){return In.workerCount}static set workerCount(A){In.workerCount=A}static get maxParallelImageRequests(){return a.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(A){a.c.MAX_PARALLEL_IMAGE_REQUESTS=A}static get workerUrl(){return a.c.WORKER_URL}static set workerUrl(A){a.c.WORKER_URL=A}static addProtocol(A,E){a.c.REGISTERED_PROTOCOLS[A]=E}static removeProtocol(A){delete a.c.REGISTERED_PROTOCOLS[A]}}return Zt.Map=class extends _r{constructor(Z){if(a.bg.mark(a.bh.create),(Z=a.e({},Bi,Z)).minZoom!=null&&Z.maxZoom!=null&&Z.minZoom>Z.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(Z.minPitch!=null&&Z.maxPitch!=null&&Z.minPitch>Z.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(Z.minPitch!=null&&Z.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(Z.maxPitch!=null&&Z.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new ea(Z.minZoom,Z.maxZoom,Z.minPitch,Z.maxPitch,Z.renderWorldCopies),{bearingSnap:Z.bearingSnap}),this._cooperativeGesturesOnWheel=A=>{this._onCooperativeGesture(A,A[this._metaKey],1)},this._contextLost=A=>{A.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.k("webglcontextlost",{originalEvent:A}))},this._contextRestored=A=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.k("webglcontextrestored",{originalEvent:A}))},this._onMapScroll=A=>{if(A.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=Z.interactive,this._cooperativeGestures=Z.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=Z.maxTileCacheSize,this._maxTileCacheZoomLevels=Z.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=Z.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=Z.preserveDrawingBuffer,this._antialias=Z.antialias,this._trackResize=Z.trackResize,this._bearingSnap=Z.bearingSnap,this._refreshExpiredTiles=Z.refreshExpiredTiles,this._fadeDuration=Z.fadeDuration,this._crossSourceCollisions=Z.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=Z.collectResourceTiming,this._renderTaskQueue=new jn,this._controls=[],this._mapId=a.a2(),this._locale=a.e({},Jn,Z.locale),this._clickTolerance=Z.clickTolerance,this._overridePixelRatio=Z.pixelRatio,this._maxCanvasSize=Z.maxCanvasSize,this.transformCameraUpdate=Z.transformCameraUpdate,this._imageQueueHandle=tt.addThrottleControl(()=>this.isMoving()),this._requestManager=new ut(Z.transformRequest),typeof Z.container=="string"){if(this._container=document.getElementById(Z.container),!this._container)throw new Error(`Container '${Z.container}' not found.`)}else{if(!(Z.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=Z.container}if(Z.maxBounds&&this.setMaxBounds(Z.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let A=!1;const E=Sa(F=>{this._trackResize&&!this._removed&&this.resize(F)._update()},50);this._resizeObserver=new ResizeObserver(F=>{A?E(F):A=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Nu(this,Z),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=Z.hash&&new ka(typeof Z.hash=="string"&&Z.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:Z.center,zoom:Z.zoom,bearing:Z.bearing,pitch:Z.pitch}),Z.bounds&&(this.resize(),this.fitBounds(Z.bounds,a.e({},Z.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=Z.localIdeographFontFamily,this._validateStyle=Z.validateStyle,Z.style&&this.setStyle(Z.style,{localIdeographFontFamily:Z.localIdeographFontFamily}),Z.attributionControl&&this.addControl(new gs({customAttribution:Z.customAttribution})),Z.maplibreLogo&&this.addControl(new gn,Z.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",A=>{this._update(A.dataType==="style"),this.fire(new a.k(`${A.dataType}data`,A))}),this.on("dataloading",A=>{this.fire(new a.k(`${A.dataType}dataloading`,A))}),this.on("dataabort",A=>{this.fire(new a.k("sourcedataabort",A))})}_getMapId(){return this._mapId}addControl(Z,A){if(A===void 0&&(A=Z.getDefaultPosition?Z.getDefaultPosition():"top-right"),!Z||!Z.onAdd)return this.fire(new a.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const E=Z.onAdd(this);this._controls.push(Z);const F=this._controlPositions[A];return A.indexOf("bottom")!==-1?F.insertBefore(E,F.firstChild):F.appendChild(E),this}removeControl(Z){if(!Z||!Z.onRemove)return this.fire(new a.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const A=this._controls.indexOf(Z);return A>-1&&this._controls.splice(A,1),Z.onRemove(this),this}hasControl(Z){return this._controls.indexOf(Z)>-1}calculateCameraOptionsFromTo(Z,A,E,F){return F==null&&this.terrain&&(F=this.terrain.getElevationForLngLatZoom(E,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(Z,A,E,F)}resize(Z){var A;const E=this._containerDimensions(),F=E[0],O=E[1],y=this._getClampedPixelRatio(F,O);if(this._resizeCanvas(F,O,y),this.painter.resize(F,O,y),this.painter.overLimit()){const i=this.painter.context.gl;this._maxCanvasSize=[i.drawingBufferWidth,i.drawingBufferHeight];const r=this._getClampedPixelRatio(F,O);this._resizeCanvas(F,O,r),this.painter.resize(F,O,r)}this.transform.resize(F,O),(A=this._requestedCameraState)===null||A===void 0||A.resize(F,O);const s=!this._moving;return s&&(this.stop(),this.fire(new a.k("movestart",Z)).fire(new a.k("move",Z))),this.fire(new a.k("resize",Z)),s&&this.fire(new a.k("moveend",Z)),this}_getClampedPixelRatio(Z,A){const{0:E,1:F}=this._maxCanvasSize,O=this.getPixelRatio(),y=Z*O,s=A*O;return Math.min(y>E?E/y:1,s>F?F/s:1)*O}getPixelRatio(){var Z;return(Z=this._overridePixelRatio)!==null&&Z!==void 0?Z:devicePixelRatio}setPixelRatio(Z){this._overridePixelRatio=Z,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(Z){return this.transform.setMaxBounds(Ni.convert(Z)),this._update()}setMinZoom(Z){if((Z=Z??-2)>=-2&&Z<=this.transform.maxZoom)return this.transform.minZoom=Z,this._update(),this.getZoom()<Z&&this.setZoom(Z),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(Z){if((Z=Z??22)>=this.transform.minZoom)return this.transform.maxZoom=Z,this._update(),this.getZoom()>Z&&this.setZoom(Z),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(Z){if((Z=Z??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(Z>=0&&Z<=this.transform.maxPitch)return this.transform.minPitch=Z,this._update(),this.getPitch()<Z&&this.setPitch(Z),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(Z){if((Z=Z??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(Z>=this.transform.minPitch)return this.transform.maxPitch=Z,this._update(),this.getPitch()>Z&&this.setPitch(Z),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(Z){return this.transform.renderWorldCopies=Z,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(Z){return this._cooperativeGestures=Z,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(Z){return this.transform.locationPoint(a.L.convert(Z),this.style&&this.terrain)}unproject(Z){return this.transform.pointLocation(a.P.convert(Z),this.terrain)}isMoving(){var Z;return this._moving||((Z=this.handlers)===null||Z===void 0?void 0:Z.isMoving())}isZooming(){var Z;return this._zooming||((Z=this.handlers)===null||Z===void 0?void 0:Z.isZooming())}isRotating(){var Z;return this._rotating||((Z=this.handlers)===null||Z===void 0?void 0:Z.isRotating())}_createDelegatedListener(Z,A,E){if(Z==="mouseenter"||Z==="mouseover"){let F=!1;return{layer:A,listener:E,delegates:{mousemove:y=>{const s=this.getLayer(A)?this.queryRenderedFeatures(y.point,{layers:[A]}):[];s.length?F||(F=!0,E.call(this,new Ft(Z,this,y.originalEvent,{features:s}))):F=!1},mouseout:()=>{F=!1}}}}if(Z==="mouseleave"||Z==="mouseout"){let F=!1;return{layer:A,listener:E,delegates:{mousemove:s=>{(this.getLayer(A)?this.queryRenderedFeatures(s.point,{layers:[A]}):[]).length?F=!0:F&&(F=!1,E.call(this,new Ft(Z,this,s.originalEvent)))},mouseout:s=>{F&&(F=!1,E.call(this,new Ft(Z,this,s.originalEvent)))}}}}{const F=O=>{const y=this.getLayer(A)?this.queryRenderedFeatures(O.point,{layers:[A]}):[];y.length&&(O.features=y,E.call(this,O),delete O.features)};return{layer:A,listener:E,delegates:{[Z]:F}}}}on(Z,A,E){if(E===void 0)return super.on(Z,A);const F=this._createDelegatedListener(Z,A,E);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[Z]=this._delegatedListeners[Z]||[],this._delegatedListeners[Z].push(F);for(const O in F.delegates)this.on(O,F.delegates[O]);return this}once(Z,A,E){if(E===void 0)return super.once(Z,A);const F=this._createDelegatedListener(Z,A,E);for(const O in F.delegates)this.once(O,F.delegates[O]);return this}off(Z,A,E){return E===void 0?super.off(Z,A):(this._delegatedListeners&&this._delegatedListeners[Z]&&(F=>{const O=this._delegatedListeners[Z];for(let y=0;y<O.length;y++){const s=O[y];if(s.layer===A&&s.listener===E){for(const i in s.delegates)this.off(i,s.delegates[i]);return O.splice(y,1),this}}})(),this)}queryRenderedFeatures(Z,A){if(!this.style)return[];let E;const F=Z instanceof a.P||Array.isArray(Z),O=F?Z:[[0,0],[this.transform.width,this.transform.height]];if(A=A||(F?{}:Z)||{},O instanceof a.P||typeof O[0]=="number")E=[a.P.convert(O)];else{const y=a.P.convert(O[0]),s=a.P.convert(O[1]);E=[y,new a.P(s.x,y.y),s,new a.P(y.x,s.y),y]}return this.style.queryRenderedFeatures(E,A,this.transform)}querySourceFeatures(Z,A){return this.style.querySourceFeatures(Z,A)}setStyle(Z,A){return(A=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},A)).diff!==!1&&A.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&Z?(this._diffStyle(Z,A),this):(this._localIdeographFontFamily=A.localIdeographFontFamily,this._updateStyle(Z,A))}setTransformRequest(Z){return this._requestManager.setTransformRequest(Z),this}_getUIString(Z){const A=this._locale[Z];if(A==null)throw new Error(`Missing UI string '${Z}'`);return A}_updateStyle(Z,A){if(A.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(Z,A));const E=this.style&&A.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!Z)),Z?(this.style=new cr(this,A||{}),this.style.setEventedParent(this,{style:this.style}),typeof Z=="string"?this.style.loadURL(Z,A,E):this.style.loadJSON(Z,A,E),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new cr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(Z,A){if(typeof Z=="string"){const E=this._requestManager.transformRequest(Z,at.Style);a.f(E,(F,O)=>{F?this.fire(new a.j(F)):O&&this._updateDiff(O,A)})}else typeof Z=="object"&&this._updateDiff(Z,A)}_updateDiff(Z,A){try{this.style.setState(Z,A)&&this._update(!0)}catch(E){a.w(`Unable to perform style diff: ${E.message||E.error||E}.  Rebuilding the style from scratch.`),this._updateStyle(Z,A)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(Z,A){return this._lazyInitEmptyStyle(),this.style.addSource(Z,A),this._update(!0)}isSourceLoaded(Z){const A=this.style&&this.style.sourceCaches[Z];if(A!==void 0)return A.loaded();this.fire(new a.j(new Error(`There is no source with ID '${Z}'`)))}setTerrain(Z){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),Z){const A=this.style.sourceCaches[Z.source];if(!A)throw new Error(`cannot load terrain, because there exists no source with ID: ${Z.source}`);for(const E in this.style._layers){const F=this.style._layers[E];F.type==="hillshade"&&F.source===Z.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new oa(this.painter,A,Z),this.painter.renderToTexture=new Po(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=E=>{E.dataType==="style"?this.terrain.sourceCache.freeRtt():E.dataType==="source"&&E.tile&&(E.sourceId!==Z.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(E.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new a.k("terrain",{terrain:Z})),this}getTerrain(){var Z,A;return(A=(Z=this.terrain)===null||Z===void 0?void 0:Z.options)!==null&&A!==void 0?A:null}areTilesLoaded(){const Z=this.style&&this.style.sourceCaches;for(const A in Z){const E=Z[A]._tiles;for(const F in E){const O=E[F];if(O.state!=="loaded"&&O.state!=="errored")return!1}}return!0}addSourceType(Z,A,E){return this._lazyInitEmptyStyle(),this.style.addSourceType(Z,A,E)}removeSource(Z){return this.style.removeSource(Z),this._update(!0)}getSource(Z){return this.style.getSource(Z)}addImage(Z,A,E={}){const{pixelRatio:F=1,sdf:O=!1,stretchX:y,stretchY:s,content:i}=E;if(this._lazyInitEmptyStyle(),!(A instanceof HTMLImageElement||a.a(A))){if(A.width===void 0||A.height===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:r,height:l,data:d}=A,_=A;return this.style.addImage(Z,{data:new a.R({width:r,height:l},new Uint8Array(d)),pixelRatio:F,stretchX:y,stretchY:s,content:i,sdf:O,version:0,userImage:_}),_.onAdd&&_.onAdd(this,Z),this}}{const{width:r,height:l,data:d}=a.h.getImageData(A);this.style.addImage(Z,{data:new a.R({width:r,height:l},d),pixelRatio:F,stretchX:y,stretchY:s,content:i,sdf:O,version:0})}}updateImage(Z,A){const E=this.style.getImage(Z);if(!E)return this.fire(new a.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const F=A instanceof HTMLImageElement||a.a(A)?a.h.getImageData(A):A,{width:O,height:y,data:s}=F;if(O===void 0||y===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(O!==E.data.width||y!==E.data.height)return this.fire(new a.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const i=!(A instanceof HTMLImageElement||a.a(A));return E.data.replace(s,i),this.style.updateImage(Z,E),this}getImage(Z){return this.style.getImage(Z)}hasImage(Z){return Z?!!this.style.getImage(Z):(this.fire(new a.j(new Error("Missing required image id"))),!1)}removeImage(Z){this.style.removeImage(Z)}loadImage(Z,A){tt.getImage(this._requestManager.transformRequest(Z,at.Image),A)}listImages(){return this.style.listImages()}addLayer(Z,A){return this._lazyInitEmptyStyle(),this.style.addLayer(Z,A),this._update(!0)}moveLayer(Z,A){return this.style.moveLayer(Z,A),this._update(!0)}removeLayer(Z){return this.style.removeLayer(Z),this._update(!0)}getLayer(Z){return this.style.getLayer(Z)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(Z,A,E){return this.style.setLayerZoomRange(Z,A,E),this._update(!0)}setFilter(Z,A,E={}){return this.style.setFilter(Z,A,E),this._update(!0)}getFilter(Z){return this.style.getFilter(Z)}setPaintProperty(Z,A,E,F={}){return this.style.setPaintProperty(Z,A,E,F),this._update(!0)}getPaintProperty(Z,A){return this.style.getPaintProperty(Z,A)}setLayoutProperty(Z,A,E,F={}){return this.style.setLayoutProperty(Z,A,E,F),this._update(!0)}getLayoutProperty(Z,A){return this.style.getLayoutProperty(Z,A)}setGlyphs(Z,A={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(Z,A),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(Z,A,E={}){return this._lazyInitEmptyStyle(),this.style.addSprite(Z,A,E,F=>{F||this._update(!0)}),this}removeSprite(Z){return this._lazyInitEmptyStyle(),this.style.removeSprite(Z),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(Z,A={}){return this._lazyInitEmptyStyle(),this.style.setSprite(Z,A,E=>{E||this._update(!0)}),this}setLight(Z,A={}){return this._lazyInitEmptyStyle(),this.style.setLight(Z,A),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(Z,A){return this.style.setFeatureState(Z,A),this._update()}removeFeatureState(Z,A){return this.style.removeFeatureState(Z,A),this._update()}getFeatureState(Z){return this.style.getFeatureState(Z)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let Z=0,A=0;return this._container&&(Z=this._container.clientWidth||400,A=this._container.clientHeight||300),[Z,A]}_setupContainer(){const Z=this._container;Z.classList.add("maplibregl-map");const A=this._canvasContainer=W.create("div","maplibregl-canvas-container",Z);this._interactive&&A.classList.add("maplibregl-interactive"),this._canvas=W.create("canvas","maplibregl-canvas",A),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const E=this._containerDimensions(),F=this._getClampedPixelRatio(E[0],E[1]);this._resizeCanvas(E[0],E[1],F);const O=this._controlContainer=W.create("div","maplibregl-control-container",Z),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(s=>{y[s]=W.create("div",`maplibregl-ctrl-${s} `,O)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=W.create("div","maplibregl-cooperative-gesture-screen",this._container);let Z=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(Z=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${Z}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){W.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(Z,A,E){this._canvas.width=Math.floor(E*Z),this._canvas.height=Math.floor(E*A),this._canvas.style.width=`${Z}px`,this._canvas.style.height=`${A}px`}_setupPainter(){const Z={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let A=null;this._canvas.addEventListener("webglcontextcreationerror",F=>{A={requestedAttributes:Z},F&&(A.statusMessage=F.statusMessage,A.type=F.type)},{once:!0});const E=this._canvas.getContext("webgl2",Z)||this._canvas.getContext("webgl",Z);if(!E){const F="Failed to initialize WebGL";throw A?(A.message=F,new Error(JSON.stringify(A))):new Error(F)}this.painter=new mr(E,this.transform),he.testSupport(E)}_onCooperativeGesture(Z,A,E){return!A&&E<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(Z){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||Z,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(Z){return this._update(),this._renderTaskQueue.add(Z)}_cancelRenderFrame(Z){this._renderTaskQueue.remove(Z)}_render(Z){const A=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(Z),this._removed)return;let E=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,y=a.h.now();this.style.zoomHistory.update(O,y);const s=new a.a8(O,{now:y,fadeDuration:A,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),i=s.crossFadingFactor();i===1&&i===this._crossFadingFactor||(E=!0,this._crossFadingFactor=i),this.style.update(s)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,A,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:A,showPadding:this.showPadding}),this.fire(new a.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.bg.mark(a.bh.load),this.fire(new a.k("load"))),this.style&&(this.style.hasTransitions()||E)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const F=this._sourcesDirty||this._styleDirty||this._placementDirty;return F||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.k("idle")),!this._loaded||this._fullyLoaded||F||(this._fullyLoaded=!0,a.bg.mark(a.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var Z;this._hash&&this._hash.remove();for(const E of this._controls)E.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),tt.removeThrottleControl(this._imageQueueHandle),(Z=this._resizeObserver)===null||Z===void 0||Z.disconnect();const A=this.painter.context.gl.getExtension("WEBGL_lose_context");A&&A.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),W.remove(this._canvasContainer),W.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),a.bg.clearMetrics(),this._removed=!0,this.fire(new a.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=a.h.frame(Z=>{a.bg.frame(Z),this._frame=null,this._render(Z)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(Z){this._showTileBoundaries!==Z&&(this._showTileBoundaries=Z,this._update())}get showPadding(){return!!this._showPadding}set showPadding(Z){this._showPadding!==Z&&(this._showPadding=Z,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(Z){this._showCollisionBoxes!==Z&&(this._showCollisionBoxes=Z,Z?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(Z){this._showOverdrawInspector!==Z&&(this._showOverdrawInspector=Z,this._update())}get repaint(){return!!this._repaint}set repaint(Z){this._repaint!==Z&&(this._repaint=Z,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(Z){this._vertices=Z,this._update()}get version(){return Mi}getCameraTargetElevation(){return this.transform.elevation}},Zt.NavigationControl=class{constructor(Z){this._updateZoomButtons=()=>{const A=this._map.getZoom(),E=A===this._map.getMaxZoom(),F=A===this._map.getMinZoom();this._zoomInButton.disabled=E,this._zoomOutButton.disabled=F,this._zoomInButton.setAttribute("aria-disabled",E.toString()),this._zoomOutButton.setAttribute("aria-disabled",F.toString())},this._rotateCompassArrow=()=>{const A=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=A},this._setButtonTitle=(A,E)=>{const F=this._map._getUIString(`NavigationControl.${E}`);A.title=F,A.setAttribute("aria-label",F)},this.options=a.e({},vu,Z),this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",A=>A.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",A=>this._map.zoomIn({},{originalEvent:A})),W.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",A=>this._map.zoomOut({},{originalEvent:A})),W.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",A=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:A}):this._map.resetNorth({},{originalEvent:A})}),this._compassIcon=W.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(Z){return this._map=Z,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Vo(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){W.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(Z,A){const E=W.create("button",Z,this._container);return E.type="button",E.addEventListener("click",A),E}},Zt.GeolocateControl=class extends a.E{constructor(Z){super(),this._onSuccess=A=>{if(this._map){if(this._isOutOfMapMaxBounds(A))return this._setErrorState(),this.fire(new a.k("outofmaxbounds",A)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=A,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(A),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(A),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.k("geolocate",A)),this._finish()}},this._updateCamera=A=>{const E=new a.L(A.coords.longitude,A.coords.latitude),F=A.coords.accuracy,O=this._map.getBearing(),y=a.e({bearing:O},this.options.fitBoundsOptions),s=Ni.fromLngLat(E,F);this._map.fitBounds(s,y,{geolocateSource:!0})},this._updateMarker=A=>{if(A){const E=new a.L(A.coords.longitude,A.coords.latitude);this._accuracyCircleMarker.setLngLat(E).addTo(this._map),this._userLocationDotMarker.setLngLat(E).addTo(this._map),this._accuracy=A.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=A=>{if(this._map){if(this.options.trackUserLocation)if(A.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const E=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=E,this._geolocateButton.setAttribute("aria-label",E),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(A.code===3&&ee)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.k("error",A)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=A=>{if(this._map){if(this._container.addEventListener("contextmenu",E=>E.preventDefault()),this._geolocateButton=W.create("button","maplibregl-ctrl-geolocate",this._container),W.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",A===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const E=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=E,this._geolocateButton.setAttribute("aria-label",E)}else{const E=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=E,this._geolocateButton.setAttribute("aria-label",E)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=W.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new D({element:this._dotElement}),this._circleElement=W.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new D({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",E=>{E.geolocateSource||this._watchState!=="ACTIVE_LOCK"||E.originalEvent&&E.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.k("trackuserlocationend")))})}},this.options=a.e({},z,Z)}onAdd(Z){return this._map=Z,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(A,E=!1){fs===void 0||E?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(F=>{fs=F.state!=="denied",A(fs)}).catch(()=>{fs=!!window.navigator.geolocation,A(fs)}):(fs=!!window.navigator.geolocation,A(fs)):A(fs)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),W.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,R=0,ee=!1}_isOutOfMapMaxBounds(Z){const A=this._map.getMaxBounds(),E=Z.coords;return A&&(E.longitude<A.getWest()||E.longitude>A.getEast()||E.latitude<A.getSouth()||E.latitude>A.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const Z=this._map.getBounds(),A=Z.getSouthEast(),E=Z.getNorthEast(),F=A.distanceTo(E),O=Math.ceil(this._accuracy/(F/this._map._container.clientHeight)*2);this._circleElement.style.width=`${O}px`,this._circleElement.style.height=`${O}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":R--,ee=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let Z;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),R++,R>1?(Z={maximumAge:6e5,timeout:0},ee=!0):(Z=this.options.positionOptions,ee=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,Z)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},Zt.AttributionControl=gs,Zt.LogoControl=gn,Zt.ScaleControl=class{constructor(Z){this._onMove=()=>{oe(this._map,this._container,this.options)},this.setUnit=A=>{this.options.unit=A,oe(this._map,this._container,this.options)},this.options=a.e({},le,Z)}getDefaultPosition(){return"bottom-left"}onAdd(Z){return this._map=Z,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-scale",Z.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){W.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},Zt.FullscreenControl=class extends a.E{constructor(Z={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,Z&&Z.container&&(Z.container instanceof HTMLElement?this._container=Z.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(Z){return this._map=Z,this._container||(this._container=this._map.getContainer()),this._controlContainer=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){W.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const Z=this._fullscreenButton=W.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);W.create("span","maplibregl-ctrl-icon",Z).setAttribute("aria-hidden","true"),Z.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const Z=this._getTitle();this._fullscreenButton.setAttribute("aria-label",Z),this._fullscreenButton.title=Z}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new a.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},Zt.TerrainControl=class{constructor(Z){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=Z}onAdd(Z){return this._map=Z,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=W.create("button","maplibregl-ctrl-terrain",this._container),W.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){W.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},Zt.Popup=class extends a.E{constructor(Z){super(),this.remove=()=>(this._content&&W.remove(this._content),this._container&&(W.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.k("close")),this),this._onMouseUp=A=>{this._update(A.point)},this._onMouseMove=A=>{this._update(A.point)},this._onDrag=A=>{this._update(A.point)},this._update=A=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=W.create("div","maplibregl-popup",this._map.getContainer()),this._tip=W.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const s of this.options.className.split(" "))this._container.classList.add(s);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=hl(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!A)return;const E=this._pos=this._trackPointer&&A?A:this._map.project(this._lngLat);let F=this.options.anchor;const O=Ct(this.options.offset);if(!F){const s=this._container.offsetWidth,i=this._container.offsetHeight;let r;r=E.y+O.bottom.y<i?["top"]:E.y>this._map.transform.height-i?["bottom"]:[],E.x<s/2?r.push("left"):E.x>this._map.transform.width-s/2&&r.push("right"),F=r.length===0?"bottom":r.join("-")}const y=E.add(O[F]).round();W.setTransform(this._container,`${Ms[F]} translate(${y.x}px,${y.y}px)`),C(this._container,F,"popup")},this._onClose=()=>{this.remove()},this.options=a.e(Object.create($e),Z)}addTo(Z){return this._map&&this.remove(),this._map=Z,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(Z){return this._lngLat=a.L.convert(Z),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(Z){return this.setDOMContent(document.createTextNode(Z))}setHTML(Z){const A=document.createDocumentFragment(),E=document.createElement("body");let F;for(E.innerHTML=Z;F=E.firstChild,F;)A.appendChild(F);return this.setDOMContent(A)}getMaxWidth(){var Z;return(Z=this._container)===null||Z===void 0?void 0:Z.style.maxWidth}setMaxWidth(Z){return this.options.maxWidth=Z,this._update(),this}setDOMContent(Z){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=W.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(Z),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(Z){this._container&&this._container.classList.add(Z)}removeClassName(Z){this._container&&this._container.classList.remove(Z)}setOffset(Z){return this.options.offset=Z,this._update(),this}toggleClassName(Z){if(this._container)return this._container.classList.toggle(Z)}_createCloseButton(){this.options.closeButton&&(this._closeButton=W.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const Z=this._container.querySelector(_t);Z&&Z.focus()}},Zt.Marker=D,Zt.Style=cr,Zt.LngLat=a.L,Zt.LngLatBounds=Ni,Zt.Point=a.P,Zt.MercatorCoordinate=a.U,Zt.Evented=a.E,Zt.AJAXError=a.bi,Zt.config=a.c,Zt.CanvasSource=Oi,Zt.GeoJSONSource=vn,Zt.ImageSource=mi,Zt.RasterDEMTileSource=nn,Zt.RasterTileSource=Vi,Zt.VectorTileSource=ji,Zt.VideoSource=Ri,Zt.setRTLTextPlugin=a.bj,Zt.getRTLTextPluginStatus=a.bk,Zt.prewarm=function(){V().acquire(Qn)},Zt.clearPrewarmedResources=function(){const Z=k;Z&&(Z.isPreloaded()&&Z.numActive()===1?(Z.release(Qn),k=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},ni.extend(Zt,{isSafari:a.ac,getPerformanceMetrics:a.bg.getPerformanceMetrics}),Zt});var S=g;return S})})(TO);var Fg=Uint8Array,o5=Uint16Array,kO=Int32Array,MO=new Fg([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),PO=new Fg([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),l5=function(e,t){for(var n=new o5(31),c=0;c<31;++c)n[c]=t+=1<<e[c-1];for(var g=new kO(n[30]),c=1;c<30;++c)for(var x=n[c];x<n[c+1];++x)g[x]=x-n[c]<<5|c;return{b:n,r:g}},u5=l5(MO,2),DO=u5.b,LO=u5.r;DO[28]=258,LO[258]=28;l5(PO,0);var BO=new o5(32768);for(eo=0;eo<32768;++eo)$f=(eo&43690)>>1|(eo&21845)<<1,$f=($f&52428)>>2|($f&13107)<<2,$f=($f&61680)>>4|($f&3855)<<4,BO[eo]=(($f&65280)>>8|($f&255)<<8)>>1;var $f,eo,A1=new Fg(288);for(eo=0;eo<144;++eo)A1[eo]=8;var eo;for(eo=144;eo<256;++eo)A1[eo]=9;var eo;for(eo=256;eo<280;++eo)A1[eo]=7;var eo;for(eo=280;eo<288;++eo)A1[eo]=8;var eo,zO=new Fg(32);for(eo=0;eo<32;++eo)zO[eo]=5;var eo,RO=new Fg(0),FO=typeof TextDecoder<"u"&&new TextDecoder,OO=0;try{FO.decode(RO,{stream:!0}),OO=1}catch{}var I2={exports:{}},NO=UO,VO={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function UO(e){if(!e||!e.type)return null;var t=VO[e.type];if(!t)return null;if(t==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]};if(t==="feature")return{type:"FeatureCollection",features:[e]};if(t==="featurecollection")return e}function A_(e){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.reduce(function(t,n){return t.concat(A_(n))},[]),e;case"Feature":return e.geometry?A_(e.geometry).map(function(t){var n={type:"Feature",properties:JSON.parse(JSON.stringify(e.properties)),geometry:t};return e.id!==void 0&&(n.id=e.id),n}):[e];case"MultiPoint":return e.coordinates.map(function(t){return{type:"Point",coordinates:t}});case"MultiPolygon":return e.coordinates.map(function(t){return{type:"Polygon",coordinates:t}});case"MultiLineString":return e.coordinates.map(function(t){return{type:"LineString",coordinates:t}});case"GeometryCollection":return e.geometries.map(A_).reduce(function(t,n){return t.concat(n)},[]);case"Point":case"Polygon":case"LineString":return[e]}}const GO=Object.freeze(Object.defineProperty({__proto__:null,default:A_},Symbol.toStringTag,{value:"Module"})),qO=zv(GO);var HO=function(t){return n(t);function n(c){return Array.isArray(c)&&c.length&&typeof c[0]=="number"?[c]:c.reduce(function(g,x){return Array.isArray(x)&&Array.isArray(x[0])?g.concat(n(x)):(g.push(x),g)},[])}},jO=NO,f_=qO,ZO=HO;f_ instanceof Function||(f_=f_.default);var QO=function(e){if(!e)return[];var t=f_(jO(e)),n=[];return t.features.forEach(function(c){c.geometry&&(n=n.concat(ZO(c.geometry.coordinates)))}),n};function Sm(e){return Object.prototype.toString.call(e)}function WO(e){return Sm(e)==="[object Date]"}function $O(e){return Sm(e)==="[object RegExp]"}function XO(e){return Sm(e)==="[object Error]"}function YO(e){return Sm(e)==="[object Boolean]"}function KO(e){return Sm(e)==="[object Number]"}function JO(e){return Sm(e)==="[object String]"}var c5=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function f1(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n++)t(e[n],n,e)}var eN=Object.keys||function(t){var n=[];for(var c in t)n.push(c);return n},tN=Object.prototype.propertyIsEnumerable,Iw=Object.getOwnPropertySymbols;function d1(e){var t=eN(e);if(Iw)for(var n=Iw(e),c=0;c<n.length;c++)tN.call(e,n[c])&&t.push(n[c]);return t}var p1=Object.prototype.hasOwnProperty||function(e,t){return t in e};function h5(e){if(typeof e=="object"&&e!==null){var t;if(c5(e))t=[];else if(WO(e))t=new Date(e.getTime?e.getTime():e);else if($O(e))t=new RegExp(e);else if(XO(e))t={message:e.message};else if(YO(e)||KO(e)||JO(e))t=Object(e);else if(Object.create&&Object.getPrototypeOf)t=Object.create(Object.getPrototypeOf(e));else if(e.constructor===Object)t={};else{var n=e.constructor&&e.constructor.prototype||e.__proto__||{},c=function(){};c.prototype=n,t=new c}return f1(d1(e),function(g){t[g]=e[g]}),t}return e}function A5(e,t,n){var c=[],g=[],x=!0;return function S(a){var G=n?h5(a):a,W={},he=!0,ae={node:G,node_:a,path:[].concat(c),parent:g[g.length-1],parents:g,key:c[c.length-1],isRoot:c.length===0,level:c.length,circular:null,update:function(je,nt){ae.isRoot||(ae.parent.node[ae.key]=je),ae.node=je,nt&&(he=!1)},delete:function(je){delete ae.parent.node[ae.key],je&&(he=!1)},remove:function(je){c5(ae.parent.node)?ae.parent.node.splice(ae.key,1):delete ae.parent.node[ae.key],je&&(he=!1)},keys:null,before:function(je){W.before=je},after:function(je){W.after=je},pre:function(je){W.pre=je},post:function(je){W.post=je},stop:function(){x=!1},block:function(){he=!1}};if(!x)return ae;function ue(){if(typeof ae.node=="object"&&ae.node!==null){(!ae.keys||ae.node_!==ae.node)&&(ae.keys=d1(ae.node)),ae.isLeaf=ae.keys.length===0;for(var je=0;je<g.length;je++)if(g[je].node_===a){ae.circular=g[je];break}}else ae.isLeaf=!0,ae.keys=null;ae.notLeaf=!ae.isLeaf,ae.notRoot=!ae.isRoot}ue();var be=t.call(ae,ae.node);return be!==void 0&&ae.update&&ae.update(be),W.before&&W.before.call(ae,ae.node),he&&(typeof ae.node=="object"&&ae.node!==null&&!ae.circular&&(g.push(ae),ue(),f1(ae.keys,function(je,nt){c.push(je),W.pre&&W.pre.call(ae,ae.node[je],je);var tt=S(ae.node[je]);n&&p1.call(ae.node,je)&&(ae.node[je]=tt.node),tt.isLast=nt===ae.keys.length-1,tt.isFirst=nt===0,W.post&&W.post.call(ae,tt),c.pop()}),g.pop()),W.after&&W.after.call(ae,ae.node)),ae}(e).node}function Oh(e){this.value=e}Oh.prototype.get=function(e){for(var t=this.value,n=0;n<e.length;n++){var c=e[n];if(!t||!p1.call(t,c))return;t=t[c]}return t};Oh.prototype.has=function(e){for(var t=this.value,n=0;n<e.length;n++){var c=e[n];if(!t||!p1.call(t,c))return!1;t=t[c]}return!0};Oh.prototype.set=function(e,t){for(var n=this.value,c=0;c<e.length-1;c++){var g=e[c];p1.call(n,g)||(n[g]={}),n=n[g]}return n[e[c]]=t,t};Oh.prototype.map=function(e){return A5(this.value,e,!0)};Oh.prototype.forEach=function(e){return this.value=A5(this.value,e,!1),this.value};Oh.prototype.reduce=function(e,t){var n=arguments.length===1,c=n?this.value:t;return this.forEach(function(g){(!this.isRoot||!n)&&(c=e.call(this,c,g))}),c};Oh.prototype.paths=function(){var e=[];return this.forEach(function(){e.push(this.path)}),e};Oh.prototype.nodes=function(){var e=[];return this.forEach(function(){e.push(this.node)}),e};Oh.prototype.clone=function(){var e=[],t=[];return function n(c){for(var g=0;g<e.length;g++)if(e[g]===c)return t[g];if(typeof c=="object"&&c!==null){var x=h5(c);return e.push(c),t.push(x),f1(d1(c),function(S){x[S]=n(c[S])}),e.pop(),t.pop(),x}return c}(this.value)};function f5(e){return new Oh(e)}f1(d1(Oh.prototype),function(e){f5[e]=function(t){var n=[].slice.call(arguments,1),c=new Oh(t);return c[e].apply(c,n)}});var iN=f5,nN=yc;function yc(e){if(!(this instanceof yc))return new yc(e);this._bbox=e||[1/0,1/0,-1/0,-1/0],this._valid=!!e}yc.prototype.include=function(e){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[0]),this._bbox[3]=Math.max(this._bbox[3],e[1]),this};yc.prototype.equals=function(e){var t;return e instanceof yc?t=e.bbox():t=e,this._bbox[0]==t[0]&&this._bbox[1]==t[1]&&this._bbox[2]==t[2]&&this._bbox[3]==t[3]};yc.prototype.center=function(e){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null};yc.prototype.union=function(e){this._valid=!0;var t;return e instanceof yc?t=e.bbox():t=e,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[2]),this._bbox[3]=Math.max(this._bbox[3],t[3]),this};yc.prototype.bbox=function(){return this._valid?this._bbox:null};yc.prototype.contains=function(e){if(!e)return this._fastContains();if(!this._valid)return null;var t=e[0],n=e[1];return this._bbox[0]<=t&&this._bbox[1]<=n&&this._bbox[2]>=t&&this._bbox[3]>=n};yc.prototype.intersect=function(e){if(!this._valid)return null;var t;return e instanceof yc?t=e.bbox():t=e,!(this._bbox[0]>t[2]||this._bbox[2]<t[0]||this._bbox[3]<t[1]||this._bbox[1]>t[3])};yc.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var e="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",e)};yc.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var rN=QO,sN=iN,aN=nN,d5={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},oN=Object.keys(d5);I2.exports=function(e){return E2(e).bbox()};I2.exports.polygon=function(e){return E2(e).polygon()};I2.exports.bboxify=function(e){return sN(e).map(function(t){if(t){var n=oN.some(function(c){return t[c]?d5[c].indexOf(t.type)!==-1:!1});n&&(t.bbox=E2(t).bbox(),this.update(t))}})};function E2(e){for(var t=aN(),n=rN(e),c=0;c<n.length;c++)t.include(n[c]);return t}var Mn=function(e){e=e||{};var t=typeof e<"u"?e:{},n={},c;for(c in t)t.hasOwnProperty(c)&&(n[c]=t[c]);var g="";function x(De){return t.locateFile?t.locateFile(De,g):g+De}var S;document.currentScript&&(g=document.currentScript.src),g.indexOf("blob:")!==0?g=g.substr(0,g.lastIndexOf("/")+1):g="",S=function(Ge,ht,kt){var o=new XMLHttpRequest;o.open("GET",Ge,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status==200||o.status==0&&o.response){ht(o.response);return}var ai=ft(Ge);if(ai){ht(ai.buffer);return}kt()},o.onerror=kt,o.send(null)};var a=t.print||console.log.bind(console),G=t.printErr||console.warn.bind(console);for(c in n)n.hasOwnProperty(c)&&(t[c]=n[c]);n=null,t.arguments&&t.arguments;var W=0,he=function(De){W=De},ae=function(){return W},ue=8;function be(De,Ge,ht,kt){switch(ht=ht||"i8",ht.charAt(ht.length-1)==="*"&&(ht="i32"),ht){case"i1":Pt[De>>0]=Ge;break;case"i8":Pt[De>>0]=Ge;break;case"i16":Je[De>>1]=Ge;break;case"i32":pt[De>>2]=Ge;break;case"i64":In=[Ge>>>0,(Qn=Ge,+_i(Qn)>=1?Qn>0?(sn(+Ai(Qn/4294967296),4294967295)|0)>>>0:~~+Ji((Qn-+(~~Qn>>>0))/4294967296)>>>0:0)],pt[De>>2]=In[0],pt[De+4>>2]=In[1];break;case"float":lt[De>>2]=Ge;break;case"double":Nt[De>>3]=Ge;break;default:Ye("invalid type for setValue: "+ht)}}function je(De,Ge,ht){switch(Ge=Ge||"i8",Ge.charAt(Ge.length-1)==="*"&&(Ge="i32"),Ge){case"i1":return Pt[De>>0];case"i8":return Pt[De>>0];case"i16":return Je[De>>1];case"i32":return pt[De>>2];case"i64":return pt[De>>2];case"float":return lt[De>>2];case"double":return Nt[De>>3];default:Ye("invalid type for getValue: "+Ge)}return null}var nt=!1;function tt(De,Ge){De||Ye("Assertion failed: "+Ge)}function at(De){var Ge=t["_"+De];return tt(Ge,"Cannot call unknown function "+De+", make sure it is exported"),Ge}function ut(De,Ge,ht,kt,o){var ke={string:function(Si){var Yt=0;if(Si!=null&&Si!==0){var bn=(Si.length<<2)+1;Yt=$(bn),it(Si,Yt,bn)}return Yt},array:function(Si){var Yt=$(Si.length);return vt(Si,Yt),Yt}};function ai(Si){return Ge==="string"?Oe(Si):Ge==="boolean"?!!Si:Si}var fi=at(De),hi=[],Jt=0;if(kt)for(var oi=0;oi<kt.length;oi++){var zi=ke[ht[oi]];zi?(Jt===0&&(Jt=de()),hi[oi]=zi(kt[oi])):hi[oi]=kt[oi]}var xi=fi.apply(null,hi);return xi=ai(xi),Jt!==0&&ie(Jt),xi}function xt(De,Ge,ht,kt){ht=ht||[];var o=ht.every(function(ai){return ai==="number"}),ke=Ge!=="string";return ke&&o&&!kt?at(De):function(){return ut(De,Ge,ht,arguments)}}var Tt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Mt(De,Ge,ht){for(var kt=Ge+ht,o=Ge;De[o]&&!(o>=kt);)++o;if(o-Ge>16&&De.subarray&&Tt)return Tt.decode(De.subarray(Ge,o));for(var ke="";Ge<o;){var ai=De[Ge++];if(!(ai&128)){ke+=String.fromCharCode(ai);continue}var fi=De[Ge++]&63;if((ai&224)==192){ke+=String.fromCharCode((ai&31)<<6|fi);continue}var hi=De[Ge++]&63;if((ai&240)==224?ai=(ai&15)<<12|fi<<6|hi:ai=(ai&7)<<18|fi<<12|hi<<6|De[Ge++]&63,ai<65536)ke+=String.fromCharCode(ai);else{var Jt=ai-65536;ke+=String.fromCharCode(55296|Jt>>10,56320|Jt&1023)}}return ke}function Oe(De,Ge){return De?Mt(dt,De,Ge):""}function jt(De,Ge,ht,kt){if(!(kt>0))return 0;for(var o=ht,ke=ht+kt-1,ai=0;ai<De.length;++ai){var fi=De.charCodeAt(ai);if(fi>=55296&&fi<=57343){var hi=De.charCodeAt(++ai);fi=65536+((fi&1023)<<10)|hi&1023}if(fi<=127){if(ht>=ke)break;Ge[ht++]=fi}else if(fi<=2047){if(ht+1>=ke)break;Ge[ht++]=192|fi>>6,Ge[ht++]=128|fi&63}else if(fi<=65535){if(ht+2>=ke)break;Ge[ht++]=224|fi>>12,Ge[ht++]=128|fi>>6&63,Ge[ht++]=128|fi&63}else{if(ht+3>=ke)break;Ge[ht++]=240|fi>>18,Ge[ht++]=128|fi>>12&63,Ge[ht++]=128|fi>>6&63,Ge[ht++]=128|fi&63}}return Ge[ht]=0,ht-o}function it(De,Ge,ht){return jt(De,dt,Ge,ht)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function vt(De,Ge){Pt.set(De,Ge)}function mt(De,Ge){return De%Ge>0&&(De+=Ge-De%Ge),De}var Et,Pt,dt,Je,pt,lt,Nt;function zt(De){Et=De,t.HEAP8=Pt=new Int8Array(De),t.HEAP16=Je=new Int16Array(De),t.HEAP32=pt=new Int32Array(De),t.HEAPU8=dt=new Uint8Array(De),t.HEAPU16=new Uint16Array(De),t.HEAPU32=new Uint32Array(De),t.HEAPF32=lt=new Float32Array(De),t.HEAPF64=Nt=new Float64Array(De)}var Ot=5266928,gi=24016,wi=t.TOTAL_MEMORY||33554432;t.buffer?Et=t.buffer:Et=new ArrayBuffer(wi),wi=Et.byteLength,zt(Et),pt[gi>>2]=Ot;function Ti(De){for(;De.length>0;){var Ge=De.shift();if(typeof Ge=="function"){Ge();continue}var ht=Ge.func;typeof ht=="number"?Ge.arg===void 0?t.dynCall_v(ht):t.dynCall_vi(ht,Ge.arg):ht(Ge.arg===void 0?null:Ge.arg)}}var Ni=[],en=[],ji=[],Vi=[];function nn(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)Ri(t.preRun.shift());Ti(Ni)}function vn(){Ti(en)}function Ci(){Ti(ji)}function mi(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)Oi(t.postRun.shift());Ti(Vi)}function Ri(De){Ni.unshift(De)}function Oi(De){Vi.unshift(De)}var _i=Math.abs,Ji=Math.ceil,Ai=Math.floor,sn=Math.min,ei=0,_n=null;function Pr(De){ei++,t.monitorRunDependencies&&t.monitorRunDependencies(ei)}function ci(De){if(ei--,t.monitorRunDependencies&&t.monitorRunDependencies(ei),ei==0&&_n){var Ge=_n;_n=null,Ge()}}t.preloadedImages={},t.preloadedAudios={};var rn=null,tr="data:application/octet-stream;base64,";function Pn(De){return String.prototype.startsWith?De.startsWith(tr):De.indexOf(tr)===0}var Qn,In;rn="data:application/octet-stream;base64,AAAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAABAAAAAMAAAAGAAAABQAAAAIAAAAAAAAAAgAAAAMAAAABAAAABAAAAAYAAAAAAAAABQAAAAMAAAAGAAAABAAAAAUAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAABAAAABQAAAAIAAAAAAAAAAQAAAAMAAAAGAAAABAAAAAYAAAAAAAAABQAAAAIAAAABAAAABAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABgAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAAAAAAABgAAAAAAAAADAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAUAAAAEAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAEAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAUAAAACAAAABAAAAAMAAAAIAAAAAQAAAAcAAAAGAAAACQAAAAAAAAADAAAAAgAAAAIAAAAGAAAACgAAAAsAAAAAAAAAAQAAAAUAAAADAAAADQAAAAEAAAAHAAAABAAAAAwAAAAAAAAABAAAAH8AAAAPAAAACAAAAAMAAAAAAAAADAAAAAUAAAACAAAAEgAAAAoAAAAIAAAAAAAAABAAAAAGAAAADgAAAAsAAAARAAAAAQAAAAkAAAACAAAABwAAABUAAAAJAAAAEwAAAAMAAAANAAAAAQAAAAgAAAAFAAAAFgAAABAAAAAEAAAAAAAAAA8AAAAJAAAAEwAAAA4AAAAUAAAAAQAAAAcAAAAGAAAACgAAAAsAAAAYAAAAFwAAAAUAAAACAAAAEgAAAAsAAAARAAAAFwAAABkAAAACAAAABgAAAAoAAAAMAAAAHAAAAA0AAAAaAAAABAAAAA8AAAADAAAADQAAABoAAAAVAAAAHQAAAAMAAAAMAAAABwAAAA4AAAB/AAAAEQAAABsAAAAJAAAAFAAAAAYAAAAPAAAAFgAAABwAAAAfAAAABAAAAAgAAAAMAAAAEAAAABIAAAAhAAAAHgAAAAgAAAAFAAAAFgAAABEAAAALAAAADgAAAAYAAAAjAAAAGQAAABsAAAASAAAAGAAAAB4AAAAgAAAABQAAAAoAAAAQAAAAEwAAACIAAAAUAAAAJAAAAAcAAAAVAAAACQAAABQAAAAOAAAAEwAAAAkAAAAoAAAAGwAAACQAAAAVAAAAJgAAABMAAAAiAAAADQAAAB0AAAAHAAAAFgAAABAAAAApAAAAIQAAAA8AAAAIAAAAHwAAABcAAAAYAAAACwAAAAoAAAAnAAAAJQAAABkAAAAYAAAAfwAAACAAAAAlAAAACgAAABcAAAASAAAAGQAAABcAAAARAAAACwAAAC0AAAAnAAAAIwAAABoAAAAqAAAAHQAAACsAAAAMAAAAHAAAAA0AAAAbAAAAKAAAACMAAAAuAAAADgAAABQAAAARAAAAHAAAAB8AAAAqAAAALAAAAAwAAAAPAAAAGgAAAB0AAAArAAAAJgAAAC8AAAANAAAAGgAAABUAAAAeAAAAIAAAADAAAAAyAAAAEAAAABIAAAAhAAAAHwAAACkAAAAsAAAANQAAAA8AAAAWAAAAHAAAACAAAAAeAAAAGAAAABIAAAA0AAAAMgAAACUAAAAhAAAAHgAAADEAAAAwAAAAFgAAABAAAAApAAAAIgAAABMAAAAmAAAAFQAAADYAAAAkAAAAMwAAACMAAAAuAAAALQAAADgAAAARAAAAGwAAABkAAAAkAAAAFAAAACIAAAATAAAANwAAACgAAAA2AAAAJQAAACcAAAA0AAAAOQAAABgAAAAXAAAAIAAAACYAAAB/AAAAIgAAADMAAAAdAAAALwAAABUAAAAnAAAAJQAAABkAAAAXAAAAOwAAADkAAAAtAAAAKAAAABsAAAAkAAAAFAAAADwAAAAuAAAANwAAACkAAAAxAAAANQAAAD0AAAAWAAAAIQAAAB8AAAAqAAAAOgAAACsAAAA+AAAAHAAAACwAAAAaAAAAKwAAAD4AAAAvAAAAQAAAABoAAAAqAAAAHQAAACwAAAA1AAAAOgAAAEEAAAAcAAAAHwAAACoAAAAtAAAAJwAAACMAAAAZAAAAPwAAADsAAAA4AAAALgAAADwAAAA4AAAARAAAABsAAAAoAAAAIwAAAC8AAAAmAAAAKwAAAB0AAABFAAAAMwAAAEAAAAAwAAAAMQAAAB4AAAAhAAAAQwAAAEIAAAAyAAAAMQAAAH8AAAA9AAAAQgAAACEAAAAwAAAAKQAAADIAAAAwAAAAIAAAAB4AAABGAAAAQwAAADQAAAAzAAAARQAAADYAAABHAAAAJgAAAC8AAAAiAAAANAAAADkAAABGAAAASgAAACAAAAAlAAAAMgAAADUAAAA9AAAAQQAAAEsAAAAfAAAAKQAAACwAAAA2AAAARwAAADcAAABJAAAAIgAAADMAAAAkAAAANwAAACgAAAA2AAAAJAAAAEgAAAA8AAAASQAAADgAAABEAAAAPwAAAE0AAAAjAAAALgAAAC0AAAA5AAAAOwAAAEoAAABOAAAAJQAAACcAAAA0AAAAOgAAAH8AAAA+AAAATAAAACwAAABBAAAAKgAAADsAAAA/AAAATgAAAE8AAAAnAAAALQAAADkAAAA8AAAASAAAAEQAAABQAAAAKAAAADcAAAAuAAAAPQAAADUAAAAxAAAAKQAAAFEAAABLAAAAQgAAAD4AAAArAAAAOgAAACoAAABSAAAAQAAAAEwAAAA/AAAAfwAAADgAAAAtAAAATwAAADsAAABNAAAAQAAAAC8AAAA+AAAAKwAAAFQAAABFAAAAUgAAAEEAAAA6AAAANQAAACwAAABWAAAATAAAAEsAAABCAAAAQwAAAFEAAABVAAAAMQAAADAAAAA9AAAAQwAAAEIAAAAyAAAAMAAAAFcAAABVAAAARgAAAEQAAAA4AAAAPAAAAC4AAABaAAAATQAAAFAAAABFAAAAMwAAAEAAAAAvAAAAWQAAAEcAAABUAAAARgAAAEMAAAA0AAAAMgAAAFMAAABXAAAASgAAAEcAAABZAAAASQAAAFsAAAAzAAAARQAAADYAAABIAAAAfwAAAEkAAAA3AAAAUAAAADwAAABYAAAASQAAAFsAAABIAAAAWAAAADYAAABHAAAANwAAAEoAAABOAAAAUwAAAFwAAAA0AAAAOQAAAEYAAABLAAAAQQAAAD0AAAA1AAAAXgAAAFYAAABRAAAATAAAAFYAAABSAAAAYAAAADoAAABBAAAAPgAAAE0AAAA/AAAARAAAADgAAABdAAAATwAAAFoAAABOAAAASgAAADsAAAA5AAAAXwAAAFwAAABPAAAATwAAAE4AAAA/AAAAOwAAAF0AAABfAAAATQAAAFAAAABEAAAASAAAADwAAABjAAAAWgAAAFgAAABRAAAAVQAAAF4AAABlAAAAPQAAAEIAAABLAAAAUgAAAGAAAABUAAAAYgAAAD4AAABMAAAAQAAAAFMAAAB/AAAASgAAAEYAAABkAAAAVwAAAFwAAABUAAAARQAAAFIAAABAAAAAYQAAAFkAAABiAAAAVQAAAFcAAABlAAAAZgAAAEIAAABDAAAAUQAAAFYAAABMAAAASwAAAEEAAABoAAAAYAAAAF4AAABXAAAAUwAAAGYAAABkAAAAQwAAAEYAAABVAAAAWAAAAEgAAABbAAAASQAAAGMAAABQAAAAaQAAAFkAAABhAAAAWwAAAGcAAABFAAAAVAAAAEcAAABaAAAATQAAAFAAAABEAAAAagAAAF0AAABjAAAAWwAAAEkAAABZAAAARwAAAGkAAABYAAAAZwAAAFwAAABTAAAATgAAAEoAAABsAAAAZAAAAF8AAABdAAAATwAAAFoAAABNAAAAbQAAAF8AAABqAAAAXgAAAFYAAABRAAAASwAAAGsAAABoAAAAZQAAAF8AAABcAAAATwAAAE4AAABtAAAAbAAAAF0AAABgAAAAaAAAAGIAAABuAAAATAAAAFYAAABSAAAAYQAAAH8AAABiAAAAVAAAAGcAAABZAAAAbwAAAGIAAABuAAAAYQAAAG8AAABSAAAAYAAAAFQAAABjAAAAUAAAAGkAAABYAAAAagAAAFoAAABxAAAAZAAAAGYAAABTAAAAVwAAAGwAAAByAAAAXAAAAGUAAABmAAAAawAAAHAAAABRAAAAVQAAAF4AAABmAAAAZQAAAFcAAABVAAAAcgAAAHAAAABkAAAAZwAAAFsAAABhAAAAWQAAAHQAAABpAAAAbwAAAGgAAABrAAAAbgAAAHMAAABWAAAAXgAAAGAAAABpAAAAWAAAAGcAAABbAAAAcQAAAGMAAAB0AAAAagAAAF0AAABjAAAAWgAAAHUAAABtAAAAcQAAAGsAAAB/AAAAZQAAAF4AAABzAAAAaAAAAHAAAABsAAAAZAAAAF8AAABcAAAAdgAAAHIAAABtAAAAbQAAAGwAAABdAAAAXwAAAHUAAAB2AAAAagAAAG4AAABiAAAAaAAAAGAAAAB3AAAAbwAAAHMAAABvAAAAYQAAAG4AAABiAAAAdAAAAGcAAAB3AAAAcAAAAGsAAABmAAAAZQAAAHgAAABzAAAAcgAAAHEAAABjAAAAdAAAAGkAAAB1AAAAagAAAHkAAAByAAAAcAAAAGQAAABmAAAAdgAAAHgAAABsAAAAcwAAAG4AAABrAAAAaAAAAHgAAAB3AAAAcAAAAHQAAABnAAAAdwAAAG8AAABxAAAAaQAAAHkAAAB1AAAAfwAAAG0AAAB2AAAAcQAAAHkAAABqAAAAdgAAAHgAAABsAAAAcgAAAHUAAAB5AAAAbQAAAHcAAABvAAAAcwAAAG4AAAB5AAAAdAAAAHgAAAB4AAAAcwAAAHIAAABwAAAAeQAAAHcAAAB2AAAAeQAAAHQAAAB4AAAAdwAAAHUAAABxAAAAdgAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAQAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAADAAAABQAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAgAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAABQAAAAUAAAAAAAAAAAAAAP////8BAAAAAAAAAAMAAAAEAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAQAAAP//////////AQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAIAAAAAAAAAAAAAAAEAAAACAAAABgAAAAQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAoAAAACAAAAAAAAAAAAAAABAAAAAQAAAAUAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAAAAAAAAAAAAAEAAAADAAAABwAAAAYAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAJAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAAAAAAAAAAABAAAACwAAAA8AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAgAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAAAAAAAAAAABAAAADAAAABAAAAAMAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAEAAAAKAAAAEwAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAA0AAAARAAAADQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAAAAAAAAAAAAAEAAAAOAAAAEgAAAA8AAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAAAAAABAAAA//////////8TAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABIAAAAAAAAAGAAAAAAAAAAhAAAAAAAAAB4AAAAAAAAAIAAAAAMAAAAxAAAAAQAAADAAAAADAAAAMgAAAAMAAAAIAAAAAAAAAAUAAAAFAAAACgAAAAUAAAAWAAAAAAAAABAAAAAAAAAAEgAAAAAAAAApAAAAAQAAACEAAAAAAAAAHgAAAAAAAAAEAAAAAAAAAAAAAAAFAAAAAgAAAAUAAAAPAAAAAQAAAAgAAAAAAAAABQAAAAUAAAAfAAAAAQAAABYAAAAAAAAAEAAAAAAAAAACAAAAAAAAAAYAAAAAAAAADgAAAAAAAAAKAAAAAAAAAAsAAAAAAAAAEQAAAAMAAAAYAAAAAQAAABcAAAADAAAAGQAAAAMAAAAAAAAAAAAAAAEAAAAFAAAACQAAAAUAAAAFAAAAAAAAAAIAAAAAAAAABgAAAAAAAAASAAAAAQAAAAoAAAAAAAAACwAAAAAAAAAEAAAAAQAAAAMAAAAFAAAABwAAAAUAAAAIAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAQAAAAAQAAAAUAAAAAAAAAAgAAAAAAAAAHAAAAAAAAABUAAAAAAAAAJgAAAAAAAAAJAAAAAAAAABMAAAAAAAAAIgAAAAMAAAAOAAAAAQAAABQAAAADAAAAJAAAAAMAAAADAAAAAAAAAA0AAAAFAAAAHQAAAAUAAAABAAAAAAAAAAcAAAAAAAAAFQAAAAAAAAAGAAAAAQAAAAkAAAAAAAAAEwAAAAAAAAAEAAAAAgAAAAwAAAAFAAAAGgAAAAUAAAAAAAAAAQAAAAMAAAAAAAAADQAAAAUAAAACAAAAAQAAAAEAAAAAAAAABwAAAAAAAAAaAAAAAAAAACoAAAAAAAAAOgAAAAAAAAAdAAAAAAAAACsAAAAAAAAAPgAAAAMAAAAmAAAAAQAAAC8AAAADAAAAQAAAAAMAAAAMAAAAAAAAABwAAAAFAAAALAAAAAUAAAANAAAAAAAAABoAAAAAAAAAKgAAAAAAAAAVAAAAAQAAAB0AAAAAAAAAKwAAAAAAAAAEAAAAAwAAAA8AAAAFAAAAHwAAAAUAAAADAAAAAQAAAAwAAAAAAAAAHAAAAAUAAAAHAAAAAQAAAA0AAAAAAAAAGgAAAAAAAAAfAAAAAAAAACkAAAAAAAAAMQAAAAAAAAAsAAAAAAAAADUAAAAAAAAAPQAAAAMAAAA6AAAAAQAAAEEAAAADAAAASwAAAAMAAAAPAAAAAAAAABYAAAAFAAAAIQAAAAUAAAAcAAAAAAAAAB8AAAAAAAAAKQAAAAAAAAAqAAAAAQAAACwAAAAAAAAANQAAAAAAAAAEAAAABAAAAAgAAAAFAAAAEAAAAAUAAAAMAAAAAQAAAA8AAAAAAAAAFgAAAAUAAAAaAAAAAQAAABwAAAAAAAAAHwAAAAAAAAAyAAAAAAAAADAAAAAAAAAAMQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAIQAAAAMAAAAYAAAAAwAAABIAAAADAAAAEAAAAAMAAABGAAAAAAAAAEMAAAAAAAAAQgAAAAMAAAA0AAAAAwAAADIAAAAAAAAAMAAAAAAAAAAlAAAAAwAAACAAAAAAAAAAHgAAAAMAAABTAAAAAAAAAFcAAAADAAAAVQAAAAMAAABKAAAAAwAAAEYAAAAAAAAAQwAAAAAAAAA5AAAAAQAAADQAAAADAAAAMgAAAAAAAAAZAAAAAAAAABcAAAAAAAAAGAAAAAMAAAARAAAAAAAAAAsAAAADAAAACgAAAAMAAAAOAAAAAwAAAAYAAAADAAAAAgAAAAMAAAAtAAAAAAAAACcAAAAAAAAAJQAAAAMAAAAjAAAAAwAAABkAAAAAAAAAFwAAAAAAAAAbAAAAAwAAABEAAAAAAAAACwAAAAMAAAA/AAAAAAAAADsAAAADAAAAOQAAAAMAAAA4AAAAAwAAAC0AAAAAAAAAJwAAAAAAAAAuAAAAAwAAACMAAAADAAAAGQAAAAAAAAAkAAAAAAAAABQAAAAAAAAADgAAAAMAAAAiAAAAAAAAABMAAAADAAAACQAAAAMAAAAmAAAAAwAAABUAAAADAAAABwAAAAMAAAA3AAAAAAAAACgAAAAAAAAAGwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAFAAAAAAAAAAzAAAAAwAAACIAAAAAAAAAEwAAAAMAAABIAAAAAAAAADwAAAADAAAALgAAAAMAAABJAAAAAwAAADcAAAAAAAAAKAAAAAAAAABHAAAAAwAAADYAAAADAAAAJAAAAAAAAABAAAAAAAAAAC8AAAAAAAAAJgAAAAMAAAA+AAAAAAAAACsAAAADAAAAHQAAAAMAAAA6AAAAAwAAACoAAAADAAAAGgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAMwAAAAMAAABSAAAAAwAAAEAAAAAAAAAALwAAAAAAAABMAAAAAwAAAD4AAAAAAAAAKwAAAAMAAABhAAAAAAAAAFkAAAADAAAARwAAAAMAAABiAAAAAwAAAFQAAAAAAAAARQAAAAAAAABgAAAAAwAAAFIAAAADAAAAQAAAAAAAAABLAAAAAAAAAEEAAAAAAAAAOgAAAAMAAAA9AAAAAAAAADUAAAADAAAALAAAAAMAAAAxAAAAAwAAACkAAAADAAAAHwAAAAMAAABeAAAAAAAAAFYAAAAAAAAATAAAAAMAAABRAAAAAwAAAEsAAAAAAAAAQQAAAAAAAABCAAAAAwAAAD0AAAAAAAAANQAAAAMAAABrAAAAAAAAAGgAAAADAAAAYAAAAAMAAABlAAAAAwAAAF4AAAAAAAAAVgAAAAAAAABVAAAAAwAAAFEAAAADAAAASwAAAAAAAAA5AAAAAAAAADsAAAAAAAAAPwAAAAMAAABKAAAAAAAAAE4AAAADAAAATwAAAAMAAABTAAAAAwAAAFwAAAADAAAAXwAAAAMAAAAlAAAAAAAAACcAAAADAAAALQAAAAMAAAA0AAAAAAAAADkAAAAAAAAAOwAAAAAAAABGAAAAAwAAAEoAAAAAAAAATgAAAAMAAAAYAAAAAAAAABcAAAADAAAAGQAAAAMAAAAgAAAAAwAAACUAAAAAAAAAJwAAAAMAAAAyAAAAAwAAADQAAAAAAAAAOQAAAAAAAAAuAAAAAAAAADwAAAAAAAAASAAAAAMAAAA4AAAAAAAAAEQAAAADAAAAUAAAAAMAAAA/AAAAAwAAAE0AAAADAAAAWgAAAAMAAAAbAAAAAAAAACgAAAADAAAANwAAAAMAAAAjAAAAAAAAAC4AAAAAAAAAPAAAAAAAAAAtAAAAAwAAADgAAAAAAAAARAAAAAMAAAAOAAAAAAAAABQAAAADAAAAJAAAAAMAAAARAAAAAwAAABsAAAAAAAAAKAAAAAMAAAAZAAAAAwAAACMAAAAAAAAALgAAAAAAAABHAAAAAAAAAFkAAAAAAAAAYQAAAAMAAABJAAAAAAAAAFsAAAADAAAAZwAAAAMAAABIAAAAAwAAAFgAAAADAAAAaQAAAAMAAAAzAAAAAAAAAEUAAAADAAAAVAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAWQAAAAAAAAA3AAAAAwAAAEkAAAAAAAAAWwAAAAMAAAAmAAAAAAAAAC8AAAADAAAAQAAAAAMAAAAiAAAAAwAAADMAAAAAAAAARQAAAAMAAAAkAAAAAwAAADYAAAAAAAAARwAAAAAAAABgAAAAAAAAAGgAAAAAAAAAawAAAAMAAABiAAAAAAAAAG4AAAADAAAAcwAAAAMAAABhAAAAAwAAAG8AAAADAAAAdwAAAAMAAABMAAAAAAAAAFYAAAADAAAAXgAAAAMAAABSAAAAAAAAAGAAAAAAAAAAaAAAAAAAAABUAAAAAwAAAGIAAAAAAAAAbgAAAAMAAAA6AAAAAAAAAEEAAAADAAAASwAAAAMAAAA+AAAAAwAAAEwAAAAAAAAAVgAAAAMAAABAAAAAAwAAAFIAAAAAAAAAYAAAAAAAAABVAAAAAAAAAFcAAAAAAAAAUwAAAAMAAABlAAAAAAAAAGYAAAADAAAAZAAAAAMAAABrAAAAAwAAAHAAAAADAAAAcgAAAAMAAABCAAAAAAAAAEMAAAADAAAARgAAAAMAAABRAAAAAAAAAFUAAAAAAAAAVwAAAAAAAABeAAAAAwAAAGUAAAAAAAAAZgAAAAMAAAAxAAAAAAAAADAAAAADAAAAMgAAAAMAAAA9AAAAAwAAAEIAAAAAAAAAQwAAAAMAAABLAAAAAwAAAFEAAAAAAAAAVQAAAAAAAABfAAAAAAAAAFwAAAAAAAAAUwAAAAAAAABPAAAAAAAAAE4AAAAAAAAASgAAAAMAAAA/AAAAAQAAADsAAAADAAAAOQAAAAMAAABtAAAAAAAAAGwAAAAAAAAAZAAAAAUAAABdAAAAAQAAAF8AAAAAAAAAXAAAAAAAAABNAAAAAQAAAE8AAAAAAAAATgAAAAAAAAB1AAAABAAAAHYAAAAFAAAAcgAAAAUAAABqAAAAAQAAAG0AAAAAAAAAbAAAAAAAAABaAAAAAQAAAF0AAAABAAAAXwAAAAAAAABaAAAAAAAAAE0AAAAAAAAAPwAAAAAAAABQAAAAAAAAAEQAAAAAAAAAOAAAAAMAAABIAAAAAQAAADwAAAADAAAALgAAAAMAAABqAAAAAAAAAF0AAAAAAAAATwAAAAUAAABjAAAAAQAAAFoAAAAAAAAATQAAAAAAAABYAAAAAQAAAFAAAAAAAAAARAAAAAAAAAB1AAAAAwAAAG0AAAAFAAAAXwAAAAUAAABxAAAAAQAAAGoAAAAAAAAAXQAAAAAAAABpAAAAAQAAAGMAAAABAAAAWgAAAAAAAABpAAAAAAAAAFgAAAAAAAAASAAAAAAAAABnAAAAAAAAAFsAAAAAAAAASQAAAAMAAABhAAAAAQAAAFkAAAADAAAARwAAAAMAAABxAAAAAAAAAGMAAAAAAAAAUAAAAAUAAAB0AAAAAQAAAGkAAAAAAAAAWAAAAAAAAABvAAAAAQAAAGcAAAAAAAAAWwAAAAAAAAB1AAAAAgAAAGoAAAAFAAAAWgAAAAUAAAB5AAAAAQAAAHEAAAAAAAAAYwAAAAAAAAB3AAAAAQAAAHQAAAABAAAAaQAAAAAAAAB3AAAAAAAAAG8AAAAAAAAAYQAAAAAAAABzAAAAAAAAAG4AAAAAAAAAYgAAAAMAAABrAAAAAQAAAGgAAAADAAAAYAAAAAMAAAB5AAAAAAAAAHQAAAAAAAAAZwAAAAUAAAB4AAAAAQAAAHcAAAAAAAAAbwAAAAAAAABwAAAAAQAAAHMAAAAAAAAAbgAAAAAAAAB1AAAAAQAAAHEAAAAFAAAAaQAAAAUAAAB2AAAAAQAAAHkAAAAAAAAAdAAAAAAAAAByAAAAAQAAAHgAAAABAAAAdwAAAAAAAAByAAAAAAAAAHAAAAAAAAAAawAAAAAAAABkAAAAAAAAAGYAAAAAAAAAZQAAAAMAAABTAAAAAQAAAFcAAAADAAAAVQAAAAMAAAB2AAAAAAAAAHgAAAAAAAAAcwAAAAUAAABsAAAAAQAAAHIAAAAAAAAAcAAAAAAAAABcAAAAAQAAAGQAAAAAAAAAZgAAAAAAAAB1AAAAAAAAAHkAAAAFAAAAdwAAAAUAAABtAAAAAQAAAHYAAAAAAAAAeAAAAAAAAABfAAAAAQAAAGwAAAABAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB+ogX28rbpPxqumpJv+fM/165tC4ns9D+XaEnTqUsEQFrOtNlC4PA/3U+0XG6P9b9TdUUBxTTjP4PUp8ex1ty/B1rD/EN43z+lcDi6LLrZP/a45NWEHMY/oJ5ijLDZ+j/xw3rjxWPjP2B8A46ioQdAotff3wla2z+FMSpA1jj+v6b5Y1mtPbS/cIu8K0F457/2esiyJpDNv98k5Ts2NeA/pvljWa09tD88ClUJ60MDQPZ6yLImkM0/4ONKxa0UBcD2uOTVhBzGv5G7JRxGave/8cN648Vj47+HCwtkjAXIv6LX398JWtu/qyheaCAL9D9TdUUBxTTjv4gyTxslhwVAB1rD/EN4378EH/28teoFwH6iBfbytum/F6ztFYdK/r/Xrm0Liez0vwcS6wNGWeO/Ws602ULg8L9TCtRLiLT8P8pi5RexJsw/BlIKPVwR5T95Wyu0/QjnP5PjoT7YYcu/mBhKZ6zrwj8wRYS7NebuP3qW6geh+Ls/SLrixebL3r+pcyymN9XrPwmkNHp7xec/GWNMZVAA17+82s+x2BLiPwn2ytbJ9ek/LgEH1sMS1j8yp/2LhTfeP+SnWwtQBbu/d38gkp5X7z8ytsuHaADGPzUYObdf1+m/7IauECWhwz+cjSACjzniP76Z+wUhN9K/1+GEKzup67+/GYr/04baPw6idWOvsuc/ZedTWsRa5b/EJQOuRzi0v/OncYhHPes/h49PixY53j+i8wWfC03Nvw2idWOvsue/ZedTWsRa5T/EJQOuRzi0P/KncYhHPeu/iY9PixY53r+i8wWfC03NP9anWwtQBbs/d38gkp5X778ytsuHaADGvzUYObdf1+k/74auECWhw7+cjSACjzniv8CZ+wUhN9I/1uGEKzup6z+/GYr/04bavwmkNHp7xee/F2NMZVAA1z+82s+x2BLivwr2ytbJ9em/KwEH1sMS1r8yp/2LhTfev81i5RexJsy/BlIKPVwR5b95Wyu0/Qjnv5DjoT7YYcs/nBhKZ6zrwr8wRYS7Nebuv3OW6geh+Lu/SLrixebL3j+pcyymN9Xrv8rHIFfWehZAMBwUdlo0DECTUc17EOb2PxpVB1SWChdAzjbhb9pTDUDQhmdvECX5P9FlMKCC9+g/IIAzjELgE0DajDngMv8GQFhWDmDPjNs/y1guLh96EkAxPi8k7DIEQJCc4URlhRhA3eLKKLwkEECqpNAyTBD/P6xpjXcDiwVAFtl//cQm4z+Ibt3XKiYTQM7mCLUb3QdAoM1t8yVv7D8aLZv2Nk8UQEAJPV5nQwxAtSsfTCoE9z9TPjXLXIIWQBVanC5W9AtAYM3d7Adm9j++5mQz1FoWQBUThyaVBghAwH5muQsV7T89Q1qv82MUQJoWGOfNuBdAzrkClkmwDkDQjKq77t37Py+g0dtitsE/ZwAMTwVPEUBojepluNwBQGYbtuW+t9w/HNWIJs6MEkDTNuQUSlgEQKxktPP5TcQ/ixbLB8JjEUCwuWjXMQYCQAS/R09FkRdAowpiZjhhDkB7LmlczD/7P01iQmhhsAVAnrtTwDy84z/Z6jfQ2TgTQChOCXMnWwpAhrW3daoz8z/HYJvVPI4VQLT3ik5FcA5Angi7LOZd+z+NNVzDy5gXQBXdvVTFUA1AYNMgOeYe+T8+qHXGCwkXQKQTOKwa5AJA8gFVoEMW0T+FwzJyttIRQAEAAAD/////BwAAAP////8xAAAA/////1cBAAD/////YQkAAP////+nQQAA/////5HLAQD/////95AMAP/////B9lcAAAAAAAAAAAAAAAAAAgAAAP////8OAAAA/////2IAAAD/////rgIAAP/////CEgAA/////06DAAD/////IpcDAP/////uIRkA/////4LtrwAAAAAAAAAAAAAAAAAAAAAAAgAAAP//////////AQAAAAMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////wIAAAD//////////wEAAAAAAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA/////////////////////wEAAAD///////////////8CAAAA////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD///////////////////////////////8CAAAA////////////////AQAAAP////////////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAAAQAAAP//////////AgAAAP//////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAAEAAAD//////////wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAgAAAAAAAAACAAAAAQAAAAEAAAACAAAAAgAAAAAAAAAFAAAABQAAAAAAAAACAAAAAgAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACAAAAAAAAAAUAAAAGAAAAAAAAAAIAAAACAAAAAwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAAAAAAAgAAAAEAAAADAAAAAgAAAAIAAAAAAAAABQAAAAcAAAAAAAAAAgAAAAIAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAACAAAAAQAAAAQAAAACAAAAAgAAAAAAAAAFAAAACAAAAAAAAAACAAAAAgAAAAMAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAUAAAAJAAAAAAAAAAIAAAACAAAAAwAAAAUAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAIAAAACAAAAAAAAAAMAAAAOAAAAAgAAAAAAAAACAAAAAwAAAAAAAAAAAAAAAgAAAAIAAAADAAAABgAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAgAAAAIAAAAAAAAAAwAAAAoAAAACAAAAAAAAAAIAAAADAAAAAQAAAAAAAAACAAAAAgAAAAMAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAgAAAAAAAAADAAAACwAAAAIAAAAAAAAAAgAAAAMAAAACAAAAAAAAAAIAAAACAAAAAwAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAACAAAAAAAAAAMAAAAMAAAAAgAAAAAAAAACAAAAAwAAAAMAAAAAAAAAAgAAAAIAAAADAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAIAAAAAAAAAAwAAAA0AAAACAAAAAAAAAAIAAAADAAAABAAAAAAAAAACAAAAAgAAAAMAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAgAAAAAAAAADAAAABgAAAAIAAAAAAAAAAgAAAAMAAAAPAAAAAAAAAAIAAAACAAAAAwAAAAsAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAIAAAACAAAAAAAAAAMAAAAHAAAAAgAAAAAAAAACAAAAAwAAABAAAAAAAAAAAgAAAAIAAAADAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAIAAAAAAAAAAwAAAAgAAAACAAAAAAAAAAIAAAADAAAAEQAAAAAAAAACAAAAAgAAAAMAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAACAAAAAgAAAAAAAAADAAAACQAAAAIAAAAAAAAAAgAAAAMAAAASAAAAAAAAAAIAAAACAAAAAwAAAA4AAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAACAAAAAAAAAAMAAAAFAAAAAgAAAAAAAAACAAAAAwAAABMAAAAAAAAAAgAAAAIAAAADAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAgAAAAAAAAACAAAAAQAAABMAAAACAAAAAgAAAAAAAAAFAAAACgAAAAAAAAACAAAAAgAAAAMAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABEAAAACAAAAAAAAAAIAAAABAAAADwAAAAIAAAACAAAAAAAAAAUAAAALAAAAAAAAAAIAAAACAAAAAwAAABEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAIAAAAAAAAAAgAAAAEAAAAQAAAAAgAAAAIAAAAAAAAABQAAAAwAAAAAAAAAAgAAAAIAAAADAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAACAAAAAQAAABEAAAACAAAAAgAAAAAAAAAFAAAADQAAAAAAAAACAAAAAgAAAAMAAAATAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAACAAAAAAAAAAIAAAABAAAAEgAAAAIAAAACAAAAAAAAAAUAAAAOAAAAAAAAAAIAAAACAAAAAwAAAAIAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAEAAAAAAAAAAgAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAMuhRbbsNlBBYqHW9OmHIkF9XBuqnS31QAK37uYhNMhAOSo3UUupm0DC+6pc6JxvQHV9eseEEEJAzURsCyqlFEB8BQ4NMJjnPyy3tBoS97o/xawXQznRjj89J2K2CZxhP6vX43RIIDQ/S8isgygEBz+LvFHQkmzaPjFFFO7wMq4+AADMLkTtjkIAAOgkJqxhQgAAU7B0MjRCAADwpBcVB0IAAACYP2HaQQAAAIn/Ja5BzczM4Eg6gUHNzMxMU7BTQTMzMzNfgCZBAAAAAEi3+UAAAAAAwGPNQDMzMzMzy6BAmpmZmZkxc0AzMzMzM/NFQDMzMzMzMxlAzczMzMzM7D+ygXSx2U6RQKimJOvQKnpA23hmONTHY0A/AGcxyudNQNb3K647mzZA+S56rrwWIUAm4kUQ+9UJQKre9hGzh/M/BLvoy9WG3T+LmqMf8VHGP2m3nYNV37A/gbFHcyeCmT+cBPWBckiDP61tZACjKW0/q2RbYVUYVj8uDypVyLNAP6jGS5cA5zBBwcqhBdCNGUEGEhQ/JVEDQT6WPnRbNO1AB/AWSJgT1kDfUWNCNLDAQNk+5C33OqlAchWL34QSk0DKvtDIrNV8QNF0G3kFzGVASSeWhBl6UED+/0mNGuk4QGjA/dm/1CJALPLPMql6DEDSHoDrwpP1P2jouzWST+A/egAAAAAAAABKAwAAAAAAAPoWAAAAAAAAyqAAAAAAAAB6ZQQAAAAAAErGHgAAAAAA+mvXAAAAAADK8+MFAAAAAHqqOykAAAAASqmhIAEAAAD6oGvkBwAAAMpm8T43AAAAes+ZuIIBAABKrDQMkwoAAPq1cFUFSgAAyvkUViUGAgAAAAAAAwAAAAYAAAACAAAABQAAAAEAAAAEAAAAAAAAAAAAAAAFAAAAAwAAAAEAAAAGAAAABAAAAAIAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAA/////wAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAAABAAAAAAAAAAAAAAD/////AAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAAAAABAAEAAAEBAAAAAAABAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAHAAAABwAAAAEAAAACAAAABAAAAAMAAAAAAAAAAAAAAAcAAAADAAAAAQAAAAIAAAAFAAAABAAAAAAAAAAAAAAAYWxnb3MuYwBfcG9seWZpbGxJbnRlcm5hbABhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0dlb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9HZW9Cb3VuZGFyeQBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGgzVG9Mb2NhbElqawBiYXNlQ2VsbCAhPSBvcmlnaW5CYXNlQ2VsbAAhKG9yaWdpbk9uUGVudCAmJiBpbmRleE9uUGVudCkAcGVudGFnb25Sb3RhdGlvbnMgPj0gMABkaXJlY3Rpb25Sb3RhdGlvbnMgPj0gMABiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvSDMAIV9pc0Jhc2VDZWxsUGVudGFnb24oYmFzZUNlbGwpAGJhc2VDZWxsUm90YXRpb25zID49IDAAd2l0aGluUGVudGFnb25Sb3RhdGlvbnMgPj0gMABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var v=24032;function k(De){return De}function V(De){var Ge=/\b__Z[\w\d_]+/g;return De.replace(Ge,function(ht){var kt=ht;return ht===kt?ht:kt+" ["+ht+"]"})}function Y(){var De=new Error;if(!De.stack){try{throw new Error(0)}catch(Ge){De=Ge}if(!De.stack)return"(no stack trace available)"}return De.stack.toString()}function te(){var De=Y();return t.extraStackTrace&&(De+=`
`+t.extraStackTrace()),V(De)}function fe(De,Ge,ht,kt){Ye("Assertion failed: "+Oe(De)+", at: "+[Ge?Oe(Ge):"unknown filename",ht,kt?Oe(kt):"unknown function"])}function ve(){return Pt.length}function Ie(De,Ge,ht){dt.set(dt.subarray(Ge,Ge+ht),De)}function Ee(De){return t.___errno_location&&(pt[t.___errno_location()>>2]=De),De}function ze(De){Ye("OOM")}function We(De){try{var Ge=new ArrayBuffer(De);return Ge.byteLength!=De?void 0:(new Int8Array(Ge).set(Pt),ne(Ge),zt(Ge),1)}catch{}}function He(De){var Ge=ve(),ht=16777216,kt=2147483648-ht;if(De>kt)return!1;for(var o=16777216,ke=Math.max(Ge,o);ke<De;)ke<=536870912?ke=mt(2*ke,ht):ke=Math.min(mt((3*ke+2147483648)/4,ht),kt);var ai=We(ke);return!!ai}var Qe=typeof atob=="function"?atob:function(De){var Ge="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ht="",kt,o,ke,ai,fi,hi,Jt,oi=0;De=De.replace(/[^A-Za-z0-9\+\/\=]/g,"");do ai=Ge.indexOf(De.charAt(oi++)),fi=Ge.indexOf(De.charAt(oi++)),hi=Ge.indexOf(De.charAt(oi++)),Jt=Ge.indexOf(De.charAt(oi++)),kt=ai<<2|fi>>4,o=(fi&15)<<4|hi>>2,ke=(hi&3)<<6|Jt,ht=ht+String.fromCharCode(kt),hi!==64&&(ht=ht+String.fromCharCode(o)),Jt!==64&&(ht=ht+String.fromCharCode(ke));while(oi<De.length);return ht};function Ue(De){try{for(var Ge=Qe(De),ht=new Uint8Array(Ge.length),kt=0;kt<Ge.length;++kt)ht[kt]=Ge.charCodeAt(kt);return ht}catch{throw new Error("Converting base64 string to bytes failed.")}}function ft(De){if(Pn(De))return Ue(De.slice(tr.length))}var st={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Me={a:Ye,b:he,c:ae,d:fe,e:Ee,f:ve,g:Ie,h:He,i:ze,j:k,k:V,l:We,m:Y,n:te,o:v,p:gi},se=function(De,Ge,ht){"almost asm";var kt=new De.Int8Array(ht),o=new De.Int32Array(ht);new De.Uint8Array(ht),new De.Float32Array(ht);var ke=new De.Float64Array(ht),ai=Ge.p|0,fi=De.Math.floor,hi=De.Math.abs,Jt=De.Math.sqrt,oi=De.Math.pow,zi=De.Math.cos,xi=De.Math.sin,Si=De.Math.tan,Yt=De.Math.acos,bn=De.Math.asin,or=De.Math.atan,mn=De.Math.atan2,qn=De.Math.ceil,jr=De.Math.imul,Zi=De.Math.min,ur=De.Math.clz32,Vn=Ge.b,Wt=Ge.c,Ki=Ge.d,Ut=Ge.e,Tn=Ge.f,cr=Ge.g,Vs=Ge.h,Ur=Ge.i,Vt=24048;function hr(C){return kt=new Int8Array(C),o=new Int32Array(C),ke=new Float64Array(C),ht=C,!0}function Bt(C){C=C|0;var D=0;return D=Vt,Vt=Vt+C|0,Vt=Vt+15&-16,D|0}function Fr(){return Vt|0}function Us(C){C=C|0,Vt=C}function ua(C,D){C=C|0,Vt=C}function Dr(C){return C=C|0,(jr(C*3|0,C+1|0)|0)+1|0}function Na(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0;Va(C,D,z,R,0)|0&&(le=(jr(z*3|0,z+1|0)|0)+1|0,fs(R|0,0,le<<3|0)|0,ee=tl(le,4)|0,ee&&(Xs(C,D,z,R,ee,le,0),Jn(ee)))}function Fo(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0;if(Va(C,D,z,R,ee)|0){if(le=(jr(z*3|0,z+1|0)|0)+1|0,fs(R|0,0,le<<3|0)|0,ee|0){fs(ee|0,0,le<<2|0)|0,Xs(C,D,z,R,ee,le,0);return}ee=tl(le,4)|0,ee&&(Xs(C,D,z,R,ee,le,0),Jn(ee))}}function Va(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0,Zt=0;if(Zt=Vt,Vt=Vt+16|0,Gt=Zt,le=R,o[le>>2]=C,o[le+4>>2]=D,le=(ee|0)!=0,le&&(o[ee>>2]=0),ds(C,D)|0)return Gt=1,Vt=Zt,Gt|0;o[Gt>>2]=0;e:do if((z|0)>=1)if(le)for(_t=0,Ct=1,ni=1,oe=0,le=C;;){if(!(oe|_t)){if(le=Zn(le,D,4,Gt)|0,D=Wt()|0,(le|0)==0&(D|0)==0){le=2;break e}if(ds(le,D)|0){le=1;break e}}if(le=Zn(le,D,o[16+(_t<<2)>>2]|0,Gt)|0,D=Wt()|0,(le|0)==0&(D|0)==0){le=2;break e}if(C=R+(ni<<3)|0,o[C>>2]=le,o[C+4>>2]=D,o[ee+(ni<<2)>>2]=Ct,oe=oe+1|0,C=(oe|0)==(Ct|0),we=_t+1|0,$e=(we|0)==6,ds(le,D)|0){le=1;break e}if(Ct=Ct+($e&C&1)|0,(Ct|0)>(z|0)){le=0;break}else _t=C?$e?0:we:_t,ni=ni+1|0,oe=C?0:oe}else for(_t=0,Ct=1,ni=1,oe=0,le=C;;){if(!(oe|_t)){if(le=Zn(le,D,4,Gt)|0,D=Wt()|0,(le|0)==0&(D|0)==0){le=2;break e}if(ds(le,D)|0){le=1;break e}}if(le=Zn(le,D,o[16+(_t<<2)>>2]|0,Gt)|0,D=Wt()|0,(le|0)==0&(D|0)==0){le=2;break e}if(C=R+(ni<<3)|0,o[C>>2]=le,o[C+4>>2]=D,oe=oe+1|0,C=(oe|0)==(Ct|0),we=_t+1|0,$e=(we|0)==6,ds(le,D)|0){le=1;break e}if(Ct=Ct+($e&C&1)|0,(Ct|0)>(z|0)){le=0;break}else _t=C?$e?0:we:_t,ni=ni+1|0,oe=C?0:oe}else le=0;while(!1);return Gt=le,Vt=Zt,Gt|0}function Xs(C,D,z,R,ee,le,oe){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0,le=le|0,oe=oe|0;var we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0,Zt=0;if(ni=Vt,Vt=Vt+16|0,Ct=ni,(C|0)==0&(D|0)==0){Vt=ni;return}if(we=Po(C|0,D|0,le|0,((le|0)<0)<<31>>31|0)|0,Wt()|0,$e=R+(we<<3)|0,Gt=$e,Zt=o[Gt>>2]|0,Gt=o[Gt+4>>2]|0,_t=(Zt|0)==(C|0)&(Gt|0)==(D|0),!((Zt|0)==0&(Gt|0)==0|_t))do we=(we+1|0)%(le|0)|0,$e=R+(we<<3)|0,Zt=$e,Gt=o[Zt>>2]|0,Zt=o[Zt+4>>2]|0,_t=(Gt|0)==(C|0)&(Zt|0)==(D|0);while(!((Gt|0)==0&(Zt|0)==0|_t));if(we=ee+(we<<2)|0,_t&&(o[we>>2]|0)<=(oe|0)){Vt=ni;return}if(Zt=$e,o[Zt>>2]=C,o[Zt+4>>2]=D,o[we>>2]=oe,(oe|0)>=(z|0)){Vt=ni;return}Zt=oe+1|0,o[Ct>>2]=0,Gt=Zn(C,D,2,Ct)|0,Xs(Gt,Wt()|0,z,R,ee,le,Zt),o[Ct>>2]=0,Gt=Zn(C,D,3,Ct)|0,Xs(Gt,Wt()|0,z,R,ee,le,Zt),o[Ct>>2]=0,Gt=Zn(C,D,1,Ct)|0,Xs(Gt,Wt()|0,z,R,ee,le,Zt),o[Ct>>2]=0,Gt=Zn(C,D,5,Ct)|0,Xs(Gt,Wt()|0,z,R,ee,le,Zt),o[Ct>>2]=0,Gt=Zn(C,D,4,Ct)|0,Xs(Gt,Wt()|0,z,R,ee,le,Zt),o[Ct>>2]=0,Gt=Zn(C,D,6,Ct)|0,Xs(Gt,Wt()|0,z,R,ee,le,Zt),Vt=ni}function Zn(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0,Zt=0;if((o[R>>2]|0)>0){ee=0;do z=ca(z)|0,ee=ee+1|0;while((ee|0)<(o[R>>2]|0))}we=Mi(C|0,D|0,45)|0,Wt()|0,$e=we&127,le=Js(C,D)|0,ee=Mi(C|0,D|0,52)|0,Wt()|0,ee=ee&15;e:do if(!ee)oe=6;else for(;;){if(ni=(15-ee|0)*3|0,Gt=Mi(C|0,D|0,ni|0)|0,Wt()|0,Gt=Gt&7,Zt=(Nr(ee)|0)==0,ee=ee+-1|0,Ct=Bi(7,0,ni|0)|0,D=D&~(Wt()|0),ni=Bi(o[(Zt?464:48)+(Gt*28|0)+(z<<2)>>2]|0,0,ni|0)|0,_t=Wt()|0,z=o[(Zt?672:256)+(Gt*28|0)+(z<<2)>>2]|0,C=ni|C&~Ct,D=_t|D,!z){z=0;break e}if(!ee){oe=6;break}}while(!1);(oe|0)==6&&(Zt=o[880+($e*28|0)+(z<<2)>>2]|0,Gt=Bi(Zt|0,0,45)|0,C=Gt|C,D=Wt()|0|D&-1040385,z=o[4304+($e*28|0)+(z<<2)>>2]|0,(Zt&127|0)==127&&(Zt=Bi(o[880+($e*28|0)+20>>2]|0,0,45)|0,D=Wt()|0|D&-1040385,z=o[4304+($e*28|0)+20>>2]|0,C=$a(Zt|C,D)|0,D=Wt()|0,o[R>>2]=(o[R>>2]|0)+1)),oe=Mi(C|0,D|0,45)|0,Wt()|0,oe=oe&127;e:do if(N(oe)|0){t:do if((Js(C,D)|0)==1){if(($e|0)!=(oe|0))if(Li(oe,o[7728+($e*28|0)>>2]|0)|0){C=Yr(C,D)|0,le=1,D=Wt()|0;break}else{C=$a(C,D)|0,le=1,D=Wt()|0;break}switch(le|0){case 5:{C=Yr(C,D)|0,D=Wt()|0,o[R>>2]=(o[R>>2]|0)+5,le=0;break t}case 3:{C=$a(C,D)|0,D=Wt()|0,o[R>>2]=(o[R>>2]|0)+1,le=0;break t}default:return Gt=0,Zt=0,Vn(Gt|0),Zt|0}}else le=0;while(!1);if((z|0)>0){ee=0;do C=qs(C,D)|0,D=Wt()|0,ee=ee+1|0;while((ee|0)!=(z|0))}if(($e|0)!=(oe|0)){if(!(xe(oe)|0)){if((le|0)!=0|(Js(C,D)|0)!=5)break;o[R>>2]=(o[R>>2]|0)+1;break}switch(we&127){case 8:case 118:break e}(Js(C,D)|0)!=3&&(o[R>>2]=(o[R>>2]|0)+1)}}else if((z|0)>0){ee=0;do C=$a(C,D)|0,D=Wt()|0,ee=ee+1|0;while((ee|0)!=(z|0))}while(!1);return o[R>>2]=((o[R>>2]|0)+z|0)%6|0,Gt=D,Zt=C,Vn(Gt|0),Zt|0}function aa(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0;if(ni=Vt,Vt=Vt+16|0,Ct=ni,!z)return Ct=R,o[Ct>>2]=C,o[Ct+4>>2]=D,Ct=0,Vt=ni,Ct|0;o[Ct>>2]=0;e:do if(ds(C,D)|0)C=1;else{if(le=(z|0)>0,le){ee=0,_t=C;do{if(_t=Zn(_t,D,4,Ct)|0,D=Wt()|0,(_t|0)==0&(D|0)==0){C=2;break e}if(ee=ee+1|0,ds(_t,D)|0){C=1;break e}}while((ee|0)<(z|0));if($e=R,o[$e>>2]=_t,o[$e+4>>2]=D,$e=z+-1|0,le){le=0,oe=1,ee=_t,C=D;do{if(ee=Zn(ee,C,2,Ct)|0,C=Wt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(we=R+(oe<<3)|0,o[we>>2]=ee,o[we+4>>2]=C,oe=oe+1|0,ds(ee,C)|0){C=1;break e}le=le+1|0}while((le|0)<(z|0));we=0,le=oe;do{if(ee=Zn(ee,C,3,Ct)|0,C=Wt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(oe=R+(le<<3)|0,o[oe>>2]=ee,o[oe+4>>2]=C,le=le+1|0,ds(ee,C)|0){C=1;break e}we=we+1|0}while((we|0)<(z|0));oe=0;do{if(ee=Zn(ee,C,1,Ct)|0,C=Wt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(we=R+(le<<3)|0,o[we>>2]=ee,o[we+4>>2]=C,le=le+1|0,ds(ee,C)|0){C=1;break e}oe=oe+1|0}while((oe|0)<(z|0));oe=0;do{if(ee=Zn(ee,C,5,Ct)|0,C=Wt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(we=R+(le<<3)|0,o[we>>2]=ee,o[we+4>>2]=C,le=le+1|0,ds(ee,C)|0){C=1;break e}oe=oe+1|0}while((oe|0)<(z|0));oe=0;do{if(ee=Zn(ee,C,4,Ct)|0,C=Wt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(we=R+(le<<3)|0,o[we>>2]=ee,o[we+4>>2]=C,le=le+1|0,ds(ee,C)|0){C=1;break e}oe=oe+1|0}while((oe|0)<(z|0));for(oe=0;;){if(ee=Zn(ee,C,6,Ct)|0,C=Wt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if((oe|0)!=($e|0))if(we=R+(le<<3)|0,o[we>>2]=ee,o[we+4>>2]=C,!(ds(ee,C)|0))le=le+1|0;else{C=1;break e}if(oe=oe+1|0,(oe|0)>=(z|0)){oe=_t,le=D;break}}}else oe=_t,ee=_t,le=D,C=D}else oe=R,o[oe>>2]=C,o[oe+4>>2]=D,oe=C,ee=C,le=D,C=D;C=((oe|0)!=(ee|0)|(le|0)!=(C|0))&1}while(!1);return Ct=C,Vt=ni,Ct|0}function hs(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0;if(le=Vt,Vt=Vt+48|0,ee=le+8|0,R=le,we=C,oe=o[we+4>>2]|0,z=R,o[z>>2]=o[we>>2],o[z+4>>2]=oe,Dn(R,ee),ee=Ha(ee,D)|0,D=o[R>>2]|0,R=o[C+8>>2]|0,(R|0)<=0)return we=D,oe=(ee|0)<(we|0),we=oe?we:ee,we=we+12|0,Vt=le,we|0;z=o[C+12>>2]|0,C=0;do D=(o[z+(C<<3)>>2]|0)+D|0,C=C+1|0;while((C|0)<(R|0));return we=(ee|0)<(D|0),we=we?D:ee,we=we+12|0,Vt=le,we|0}function Ua(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,$e=0;if(we=Vt,Vt=Vt+48|0,R=we+8|0,ee=we,!(al(C,D,z)|0)){Vt=we;return}if($e=C,le=o[$e+4>>2]|0,oe=ee,o[oe>>2]=o[$e>>2],o[oe+4>>2]=le,Dn(ee,R),oe=Ha(R,D)|0,D=o[ee>>2]|0,le=o[C+8>>2]|0,(le|0)>0){ee=o[C+12>>2]|0,R=0;do D=(o[ee+(R<<3)>>2]|0)+D|0,R=R+1|0;while((R|0)!=(le|0))}if(D=(oe|0)<(D|0)?D:oe,(D|0)<=-12){Vt=we;return}$e=D+11|0,fs(z|0,0,((($e|0)>0?$e:0)<<3)+8|0)|0,Vt=we}function al(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0,ce=0,Se=0;if(Se=Vt,Vt=Vt+112|0,B=Se+80|0,$e=Se+72|0,j=Se,X=Se+56|0,_t=C+8|0,ce=jn((o[_t>>2]<<5)+32|0)|0,ce||Ki(22848,22448,800,22456),Ma(C,ce),le=C,R=o[le+4>>2]|0,we=$e,o[we>>2]=o[le>>2],o[we+4>>2]=R,Dn($e,B),we=Ha(B,D)|0,R=o[$e>>2]|0,le=o[_t>>2]|0,(le|0)>0){oe=o[C+12>>2]|0,ee=0;do R=(o[oe+(ee<<3)>>2]|0)+R|0,ee=ee+1|0;while((ee|0)!=(le|0))}if(we=(we|0)<(R|0)?R:we,T=we+12|0,ee=tl(T,8)|0,Ct=tl(T,8)|0,o[B>>2]=0,_=C,w=o[_+4>>2]|0,R=$e,o[R>>2]=o[_>>2],o[R+4>>2]=w,R=ol($e,T,D,B,ee,Ct)|0,R|0)return Jn(ee),Jn(Ct),Jn(ce),ce=R,Vt=Se,ce|0;e:do if((o[_t>>2]|0)>0){for(le=C+12|0,R=0;oe=ol((o[le>>2]|0)+(R<<3)|0,T,D,B,ee,Ct)|0,R=R+1|0,!(oe|0);)if((R|0)>=(o[_t>>2]|0))break e;return Jn(ee),Jn(Ct),Jn(ce),ce=oe,Vt=Se,ce|0}while(!1);(we|0)>-12&&fs(Ct|0,0,((T|0)>1?T:1)<<3|0)|0;e:do if((o[B>>2]|0)>0){w=((T|0)<0)<<31>>31,s=ee,i=Ct,r=ee,l=ee,d=Ct,_=ee,R=ee,E=ee,F=Ct,O=Ct,y=Ct,ee=Ct;t:for(;;){for(A=o[B>>2]|0,Zt=0,Z=0,le=0;;){oe=j,we=oe+56|0;do o[oe>>2]=0,oe=oe+4|0;while((oe|0)<(we|0));if(D=s+(Zt<<3)|0,$e=o[D>>2]|0,D=o[D+4>>2]|0,Va($e,D,1,j,0)|0){oe=j,we=oe+56|0;do o[oe>>2]=0,oe=oe+4|0;while((oe|0)<(we|0));oe=tl(7,4)|0,oe|0&&(Xs($e,D,1,j,oe,7,0),Jn(oe))}Gt=0;do{ni=j+(Gt<<3)|0,Ct=o[ni>>2]|0,ni=o[ni+4>>2]|0;i:do if(!((Ct|0)==0&(ni|0)==0)){if($e=Po(Ct|0,ni|0,T|0,w|0)|0,Wt()|0,oe=z+($e<<3)|0,we=oe,D=o[we>>2]|0,we=o[we+4>>2]|0,!((D|0)==0&(we|0)==0))for(_t=0;;){if((_t|0)>(T|0))break t;if((D|0)==(Ct|0)&(we|0)==(ni|0))break i;if($e=($e+1|0)%(T|0)|0,oe=z+($e<<3)|0,we=oe,D=o[we>>2]|0,we=o[we+4>>2]|0,(D|0)==0&(we|0)==0)break;_t=_t+1|0}(Ct|0)==0&(ni|0)==0||(Sa(Ct,ni,X),Sn(C,ce,X)|0&&(_t=oe,o[_t>>2]=Ct,o[_t+4>>2]=ni,_t=i+(le<<3)|0,o[_t>>2]=Ct,o[_t+4>>2]=ni,le=le+1|0))}while(!1);Gt=Gt+1|0}while(Gt>>>0<7);if(Z=Z+1|0,(Z|0)>=(A|0))break;Zt=Zt+1|0}if((A|0)>0&&fs(r|0,0,A<<3|0)|0,o[B>>2]=le,(le|0)>0)Ct=ee,ni=y,Gt=_,Zt=O,Z=F,A=i,ee=E,y=R,O=l,F=r,E=Ct,R=ni,_=d,d=Gt,l=Zt,r=Z,i=s,s=A;else break e}return Jn(l),Jn(d),Jn(ce),ce=-1,Vt=Se,ce|0}else R=Ct;while(!1);return Jn(ce),Jn(ee),Jn(R),ce=0,Vt=Se,ce|0}function ol(C,D,z,R,ee,le){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0,le=le|0;var oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0,B=0;if(w=Vt,Vt=Vt+48|0,r=w+32|0,l=w+16|0,d=w,oe=o[C>>2]|0,(oe|0)<=0)return _=0,Vt=w,_|0;F=C+4|0,O=r+8|0,y=l+8|0,s=d+8|0,i=((D|0)<0)<<31>>31,E=0;e:for(;;){we=o[F>>2]|0,Z=we+(E<<4)|0,o[r>>2]=o[Z>>2],o[r+4>>2]=o[Z+4>>2],o[r+8>>2]=o[Z+8>>2],o[r+12>>2]=o[Z+12>>2],(E|0)==(oe+-1|0)?(o[l>>2]=o[we>>2],o[l+4>>2]=o[we+4>>2],o[l+8>>2]=o[we+8>>2],o[l+12>>2]=o[we+12>>2]):(Z=we+(E+1<<4)|0,o[l>>2]=o[Z>>2],o[l+4>>2]=o[Z+4>>2],o[l+8>>2]=o[Z+8>>2],o[l+12>>2]=o[Z+12>>2]),Z=ja(r,l,z)|0;t:do if((Z|0)>0){A=+(Z|0),Zt=0;i:for(;;){B=+(Z-Zt|0),T=+(Zt|0),ke[d>>3]=+ke[r>>3]*B/A+ +ke[l>>3]*T/A,ke[s>>3]=+ke[O>>3]*B/A+ +ke[y>>3]*T/A,ni=ha(d,z)|0,Gt=Wt()|0,we=Po(ni|0,Gt|0,D|0,i|0)|0,Wt()|0,oe=le+(we<<3)|0,$e=oe,_t=o[$e>>2]|0,$e=o[$e+4>>2]|0;n:do if((_t|0)==0&($e|0)==0)_=14;else for(Ct=0;;){if((Ct|0)>(D|0)){oe=1;break n}if((_t|0)==(ni|0)&($e|0)==(Gt|0)){oe=7;break n}if(we=(we+1|0)%(D|0)|0,oe=le+(we<<3)|0,$e=oe,_t=o[$e>>2]|0,$e=o[$e+4>>2]|0,(_t|0)==0&($e|0)==0){_=14;break}else Ct=Ct+1|0}while(!1);switch((_|0)==14&&(_=0,(ni|0)==0&(Gt|0)==0?oe=7:(o[oe>>2]=ni,o[oe+4>>2]=Gt,oe=o[R>>2]|0,Ct=ee+(oe<<3)|0,o[Ct>>2]=ni,o[Ct+4>>2]=Gt,o[R>>2]=oe+1,oe=0)),oe&7){case 7:case 0:break;default:break i}if(Zt=Zt+1|0,(Z|0)<=(Zt|0)){_=8;break t}}if(oe|0){oe=-1,_=20;break e}}else _=8;while(!1);if((_|0)==8&&(_=0),E=E+1|0,oe=o[C>>2]|0,(E|0)>=(oe|0)){oe=0,_=20;break}}return(_|0)==20?(Vt=w,oe|0):0}function no(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0;if(_t=Vt,Vt=Vt+176|0,$e=_t,(D|0)<1){ms(z,0,0),Vt=_t;return}oe=C,oe=Mi(o[oe>>2]|0,o[oe+4>>2]|0,52)|0,Wt()|0,ms(z,(D|0)>6?D:6,oe&15),oe=0;do{if(R=C+(oe<<3)|0,ka(o[R>>2]|0,o[R+4>>2]|0,$e),R=o[$e>>2]|0,(R|0)>0){we=0;do le=$e+8+(we<<4)|0,we=we+1|0,R=$e+8+(((we|0)%(R|0)|0)<<4)|0,ee=cu(z,R,le)|0,ee?_u(z,ee)|0:Ou(z,le,R)|0,R=o[$e>>2]|0;while((we|0)<(R|0))}oe=oe+1|0}while((oe|0)!=(D|0));Vt=_t}function Ga(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0;if(le=Vt,Vt=Vt+32|0,R=le,ee=le+16|0,no(C,D,ee),o[z>>2]=0,o[z+4>>2]=0,o[z+8>>2]=0,C=el(ee)|0,!C){Xn(z)|0,_a(ee),Vt=le;return}do{D=Bn(z)|0;do Hn(D,C)|0,oe=C+16|0,o[R>>2]=o[oe>>2],o[R+4>>2]=o[oe+4>>2],o[R+8>>2]=o[oe+8>>2],o[R+12>>2]=o[oe+12>>2],_u(ee,C)|0,C=Nu(ee,R)|0;while(C|0);C=el(ee)|0}while(C|0);Xn(z)|0,_a(ee),Vt=le}function N(C){return C=C|0,o[7728+(C*28|0)+16>>2]|0}function xe(C){return C=C|0,(C|0)==4|(C|0)==117|0}function rt(C){return C=C|0,o[11152+((o[C>>2]|0)*216|0)+((o[C+4>>2]|0)*72|0)+((o[C+8>>2]|0)*24|0)+(o[C+12>>2]<<3)>>2]|0}function St(C){return C=C|0,o[11152+((o[C>>2]|0)*216|0)+((o[C+4>>2]|0)*72|0)+((o[C+8>>2]|0)*24|0)+(o[C+12>>2]<<3)+4>>2]|0}function $t(C,D){C=C|0,D=D|0,C=7728+(C*28|0)|0,o[D>>2]=o[C>>2],o[D+4>>2]=o[C+4>>2],o[D+8>>2]=o[C+8>>2],o[D+12>>2]=o[C+12>>2]}function Ii(C,D){C=C|0,D=D|0;var z=0,R=0;if(D>>>0>20)return D=-1,D|0;do if((o[11152+(D*216|0)>>2]|0)!=(C|0))if((o[11152+(D*216|0)+8>>2]|0)!=(C|0))if((o[11152+(D*216|0)+16>>2]|0)!=(C|0))if((o[11152+(D*216|0)+24>>2]|0)!=(C|0))if((o[11152+(D*216|0)+32>>2]|0)!=(C|0))if((o[11152+(D*216|0)+40>>2]|0)!=(C|0))if((o[11152+(D*216|0)+48>>2]|0)!=(C|0))if((o[11152+(D*216|0)+56>>2]|0)!=(C|0))if((o[11152+(D*216|0)+64>>2]|0)!=(C|0))if((o[11152+(D*216|0)+72>>2]|0)!=(C|0))if((o[11152+(D*216|0)+80>>2]|0)!=(C|0))if((o[11152+(D*216|0)+88>>2]|0)!=(C|0))if((o[11152+(D*216|0)+96>>2]|0)!=(C|0))if((o[11152+(D*216|0)+104>>2]|0)!=(C|0))if((o[11152+(D*216|0)+112>>2]|0)!=(C|0))if((o[11152+(D*216|0)+120>>2]|0)!=(C|0))if((o[11152+(D*216|0)+128>>2]|0)!=(C|0))if((o[11152+(D*216|0)+136>>2]|0)==(C|0))C=2,z=1,R=2;else{if((o[11152+(D*216|0)+144>>2]|0)==(C|0)){C=0,z=2,R=0;break}if((o[11152+(D*216|0)+152>>2]|0)==(C|0)){C=0,z=2,R=1;break}if((o[11152+(D*216|0)+160>>2]|0)==(C|0)){C=0,z=2,R=2;break}if((o[11152+(D*216|0)+168>>2]|0)==(C|0)){C=1,z=2,R=0;break}if((o[11152+(D*216|0)+176>>2]|0)==(C|0)){C=1,z=2,R=1;break}if((o[11152+(D*216|0)+184>>2]|0)==(C|0)){C=1,z=2,R=2;break}if((o[11152+(D*216|0)+192>>2]|0)==(C|0)){C=2,z=2,R=0;break}if((o[11152+(D*216|0)+200>>2]|0)==(C|0)){C=2,z=2,R=1;break}if((o[11152+(D*216|0)+208>>2]|0)==(C|0)){C=2,z=2,R=2;break}else C=-1;return C|0}else C=2,z=1,R=1;else C=2,z=1,R=0;else C=1,z=1,R=2;else C=1,z=1,R=1;else C=1,z=1,R=0;else C=0,z=1,R=2;else C=0,z=1,R=1;else C=0,z=1,R=0;else C=2,z=0,R=2;else C=2,z=0,R=1;else C=2,z=0,R=0;else C=1,z=0,R=2;else C=1,z=0,R=1;else C=1,z=0,R=0;else C=0,z=0,R=2;else C=0,z=0,R=1;else C=0,z=0,R=0;while(!1);return D=o[11152+(D*216|0)+(z*72|0)+(C*24|0)+(R<<3)+4>>2]|0,D|0}function Li(C,D){return C=C|0,D=D|0,(o[7728+(C*28|0)+20>>2]|0)==(D|0)?(D=1,D|0):(D=(o[7728+(C*28|0)+24>>2]|0)==(D|0),D|0)}function An(C,D){return C=C|0,D=D|0,o[880+(C*28|0)+(D<<2)>>2]|0}function pn(C,D){return C=C|0,D=D|0,(o[880+(C*28|0)>>2]|0)==(D|0)?(D=0,D|0):(o[880+(C*28|0)+4>>2]|0)==(D|0)?(D=1,D|0):(o[880+(C*28|0)+8>>2]|0)==(D|0)?(D=2,D|0):(o[880+(C*28|0)+12>>2]|0)==(D|0)?(D=3,D|0):(o[880+(C*28|0)+16>>2]|0)==(D|0)?(D=4,D|0):(o[880+(C*28|0)+20>>2]|0)==(D|0)?(D=5,D|0):((o[880+(C*28|0)+24>>2]|0)==(D|0)?6:7)|0}function sr(){return 122}function Ar(C){C=C|0;var D=0,z=0,R=0;D=0;do Bi(D|0,0,45)|0,R=Wt()|0|134225919,z=C+(D<<3)|0,o[z>>2]=-1,o[z+4>>2]=R,D=D+1|0;while((D|0)!=122)}function Or(C){return C=C|0,+ke[C+16>>3]<+ke[C+24>>3]|0}function qa(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;return z=+ke[D>>3],!(z>=+ke[C+8>>3])||!(z<=+ke[C>>3])?(D=0,D|0):(R=+ke[C+16>>3],z=+ke[C+24>>3],ee=+ke[D+8>>3],D=ee>=z,C=ee<=R&1,R<z?D&&(C=1):D||(C=0),D=(C|0)!=0,D|0)}function Ha(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0;oe=Vt,Vt=Vt+288|0,z=oe+264|0,R=oe+96|0,ee=oe,le=ee,we=le+96|0;do o[le>>2]=0,le=le+4|0;while((le|0)<(we|0));return gl(D,ee),le=ee,we=o[le>>2]|0,le=o[le+4>>2]|0,Sa(we,le,z),ka(we,le,R),$e=+Cs(z,R+8|0),ke[z>>3]=+ke[C>>3],le=z+8|0,ke[le>>3]=+ke[C+16>>3],ke[R>>3]=+ke[C+8>>3],we=R+8|0,ke[we>>3]=+ke[C+24>>3],_t=+Cs(z,R),we=~~+qn(+(_t*_t/+xs(+ +hi(+((+ke[le>>3]-+ke[we>>3])/(+ke[z>>3]-+ke[R>>3]))),3)/($e*($e*2.59807621135)*.8))),Vt=oe,(we|0?we:1)|0}function ja(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0;we=Vt,Vt=Vt+288|0,R=we+264|0,ee=we+96|0,le=we,oe=le,$e=oe+96|0;do o[oe>>2]=0,oe=oe+4|0;while((oe|0)<($e|0));return gl(z,le),$e=le,oe=o[$e>>2]|0,$e=o[$e+4>>2]|0,Sa(oe,$e,R),ka(oe,$e,ee),_t=+Cs(R,ee+8|0),$e=~~+qn(+(+Cs(C,D)/(_t*2))),Vt=we,($e|0?$e:1)|0}function pl(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0,o[C>>2]=D,o[C+4>>2]=z,o[C+8>>2]=R}function Gr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0;ni=D+8|0,o[ni>>2]=0,$e=+ke[C>>3],oe=+hi(+$e),_t=+ke[C+8>>3],we=+hi(+_t)/.8660254037844386,oe=oe+we*.5,z=~~oe,C=~~we,oe=oe-+(z|0),we=we-+(C|0);do if(oe<.5)if(oe<.3333333333333333)if(o[D>>2]=z,we<(oe+1)*.5){o[D+4>>2]=C;break}else{C=C+1|0,o[D+4>>2]=C;break}else if(Gt=1-oe,C=(!(we<Gt)&1)+C|0,o[D+4>>2]=C,Gt<=we&we<oe*2){z=z+1|0,o[D>>2]=z;break}else{o[D>>2]=z;break}else{if(!(oe<.6666666666666666))if(z=z+1|0,o[D>>2]=z,we<oe*.5){o[D+4>>2]=C;break}else{C=C+1|0,o[D+4>>2]=C;break}if(we<1-oe){if(o[D+4>>2]=C,oe*2+-1<we){o[D>>2]=z;break}}else C=C+1|0,o[D+4>>2]=C;z=z+1|0,o[D>>2]=z}while(!1);do if($e<0)if(C&1){Ct=(C+1|0)/2|0,Ct=oa(z|0,((z|0)<0)<<31>>31|0,Ct|0,((Ct|0)<0)<<31>>31|0)|0,z=~~(+(z|0)-((+(Ct>>>0)+4294967296*+(Wt()|0))*2+1)),o[D>>2]=z;break}else{Ct=(C|0)/2|0,Ct=oa(z|0,((z|0)<0)<<31>>31|0,Ct|0,((Ct|0)<0)<<31>>31|0)|0,z=~~(+(z|0)-(+(Ct>>>0)+4294967296*+(Wt()|0))*2),o[D>>2]=z;break}while(!1);Ct=D+4|0,_t<0&&(z=z-((C<<1|1|0)/2|0)|0,o[D>>2]=z,C=0-C|0,o[Ct>>2]=C),R=C-z|0,(z|0)<0?(ee=0-z|0,o[Ct>>2]=R,o[ni>>2]=ee,o[D>>2]=0,C=R,z=0):ee=0,(C|0)<0&&(z=z-C|0,o[D>>2]=z,ee=ee-C|0,o[ni>>2]=ee,o[Ct>>2]=0,C=0),le=z-ee|0,R=C-ee|0,(ee|0)<0&&(o[D>>2]=le,o[Ct>>2]=R,o[ni>>2]=0,C=R,z=le,ee=0),R=(C|0)<(z|0)?C:z,R=(ee|0)<(R|0)?ee:R,!((R|0)<=0)&&(o[D>>2]=z-R,o[Ct>>2]=C-R,o[ni>>2]=ee-R)}function nr(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0;D=o[C>>2]|0,oe=C+4|0,z=o[oe>>2]|0,(D|0)<0&&(z=z-D|0,o[oe>>2]=z,le=C+8|0,o[le>>2]=(o[le>>2]|0)-D,o[C>>2]=0,D=0),(z|0)<0?(D=D-z|0,o[C>>2]=D,le=C+8|0,ee=(o[le>>2]|0)-z|0,o[le>>2]=ee,o[oe>>2]=0,z=0):(ee=C+8|0,le=ee,ee=o[ee>>2]|0),(ee|0)<0&&(D=D-ee|0,o[C>>2]=D,z=z-ee|0,o[oe>>2]=z,o[le>>2]=0,ee=0),R=(z|0)<(D|0)?z:D,R=(ee|0)<(R|0)?ee:R,!((R|0)<=0)&&(o[C>>2]=D-R,o[oe>>2]=z-R,o[le>>2]=ee-R)}function Ir(C,D){C=C|0,D=D|0;var z=0,R=0;R=o[C+8>>2]|0,z=+((o[C+4>>2]|0)-R|0),ke[D>>3]=+((o[C>>2]|0)-R|0)-z*.5,ke[D+8>>3]=z*.8660254037844386}function Lr(C,D,z){C=C|0,D=D|0,z=z|0,o[z>>2]=(o[D>>2]|0)+(o[C>>2]|0),o[z+4>>2]=(o[D+4>>2]|0)+(o[C+4>>2]|0),o[z+8>>2]=(o[D+8>>2]|0)+(o[C+8>>2]|0)}function Zs(C,D,z){C=C|0,D=D|0,z=z|0,o[z>>2]=(o[C>>2]|0)-(o[D>>2]|0),o[z+4>>2]=(o[C+4>>2]|0)-(o[D+4>>2]|0),o[z+8>>2]=(o[C+8>>2]|0)-(o[D+8>>2]|0)}function vr(C,D){C=C|0,D=D|0;var z=0,R=0;z=jr(o[C>>2]|0,D)|0,o[C>>2]=z,z=C+4|0,R=jr(o[z>>2]|0,D)|0,o[z>>2]=R,C=C+8|0,D=jr(o[C>>2]|0,D)|0,o[C>>2]=D}function Ks(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;oe=o[C>>2]|0,we=(oe|0)<0,R=(o[C+4>>2]|0)-(we?oe:0)|0,le=(R|0)<0,ee=(le?0-R|0:0)+((o[C+8>>2]|0)-(we?oe:0))|0,z=(ee|0)<0,C=z?0:ee,D=(le?0:R)-(z?ee:0)|0,ee=(we?0:oe)-(le?R:0)-(z?ee:0)|0,z=(D|0)<(ee|0)?D:ee,z=(C|0)<(z|0)?C:z,R=(z|0)>0,C=C-(R?z:0)|0,D=D-(R?z:0)|0;e:do switch(ee-(R?z:0)|0){case 0:switch(D|0){case 0:return we=C|0?(C|0)==1?1:7:0,we|0;case 1:return we=C|0?(C|0)==1?3:7:2,we|0;default:break e}case 1:switch(D|0){case 0:return we=C|0?(C|0)==1?5:7:4,we|0;case 1:{if(!C)C=6;else break e;return C|0}default:break e}}while(!1);return we=7,we|0}function Br(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;oe=C+8|0,z=o[oe>>2]|0,D=(o[C>>2]|0)-z|0,we=C+4|0,z=(o[we>>2]|0)-z|0,R=gn(+((D*3|0)-z|0)/7)|0,o[C>>2]=R,D=gn(+((z<<1)+D|0)/7)|0,o[we>>2]=D,o[oe>>2]=0,z=D-R|0,(R|0)<0?(le=0-R|0,o[we>>2]=z,o[oe>>2]=le,o[C>>2]=0,D=z,R=0,z=le):z=0,(D|0)<0&&(R=R-D|0,o[C>>2]=R,z=z-D|0,o[oe>>2]=z,o[we>>2]=0,D=0),le=R-z|0,ee=D-z|0,(z|0)<0?(o[C>>2]=le,o[we>>2]=ee,o[oe>>2]=0,D=ee,ee=le,z=0):ee=R,R=(D|0)<(ee|0)?D:ee,R=(z|0)<(R|0)?z:R,!((R|0)<=0)&&(o[C>>2]=ee-R,o[we>>2]=D-R,o[oe>>2]=z-R)}function Eo(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;oe=C+8|0,z=o[oe>>2]|0,D=(o[C>>2]|0)-z|0,we=C+4|0,z=(o[we>>2]|0)-z|0,R=gn(+((D<<1)+z|0)/7)|0,o[C>>2]=R,D=gn(+((z*3|0)-D|0)/7)|0,o[we>>2]=D,o[oe>>2]=0,z=D-R|0,(R|0)<0?(le=0-R|0,o[we>>2]=z,o[oe>>2]=le,o[C>>2]=0,D=z,R=0,z=le):z=0,(D|0)<0&&(R=R-D|0,o[C>>2]=R,z=z-D|0,o[oe>>2]=z,o[we>>2]=0,D=0),le=R-z|0,ee=D-z|0,(z|0)<0?(o[C>>2]=le,o[we>>2]=ee,o[oe>>2]=0,D=ee,ee=le,z=0):ee=R,R=(D|0)<(ee|0)?D:ee,R=(z|0)<(R|0)?z:R,!((R|0)<=0)&&(o[C>>2]=ee-R,o[we>>2]=D-R,o[oe>>2]=z-R)}function Zo(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;D=o[C>>2]|0,oe=C+4|0,z=o[oe>>2]|0,we=C+8|0,R=o[we>>2]|0,ee=z+(D*3|0)|0,o[C>>2]=ee,z=R+(z*3|0)|0,o[oe>>2]=z,D=(R*3|0)+D|0,o[we>>2]=D,R=z-ee|0,(ee|0)<0?(D=D-ee|0,o[oe>>2]=R,o[we>>2]=D,o[C>>2]=0,z=R,R=0):R=ee,(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[we>>2]=D,o[oe>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[oe>>2]=ee,o[we>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[oe>>2]=ee-z,o[we>>2]=D-z)}function Bs(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;ee=o[C>>2]|0,oe=C+4|0,D=o[oe>>2]|0,we=C+8|0,z=o[we>>2]|0,R=(D*3|0)+ee|0,ee=z+(ee*3|0)|0,o[C>>2]=ee,o[oe>>2]=R,D=(z*3|0)+D|0,o[we>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[oe>>2]=z,o[we>>2]=D,o[C>>2]=0,ee=0):z=R,(z|0)<0&&(ee=ee-z|0,o[C>>2]=ee,D=D-z|0,o[we>>2]=D,o[oe>>2]=0,z=0),le=ee-D|0,R=z-D|0,(D|0)<0?(o[C>>2]=le,o[oe>>2]=R,o[we>>2]=0,ee=le,D=0):R=z,z=(R|0)<(ee|0)?R:ee,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=ee-z,o[oe>>2]=R-z,o[we>>2]=D-z)}function Il(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0;(D+-1|0)>>>0>=6||(ee=(o[15472+(D*12|0)>>2]|0)+(o[C>>2]|0)|0,o[C>>2]=ee,we=C+4|0,R=(o[15472+(D*12|0)+4>>2]|0)+(o[we>>2]|0)|0,o[we>>2]=R,oe=C+8|0,D=(o[15472+(D*12|0)+8>>2]|0)+(o[oe>>2]|0)|0,o[oe>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[we>>2]=z,o[oe>>2]=D,o[C>>2]=0,R=0):(z=R,R=ee),(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[oe>>2]=D,o[we>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[we>>2]=ee,o[oe>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[we>>2]=ee-z,o[oe>>2]=D-z))}function mo(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;ee=o[C>>2]|0,oe=C+4|0,D=o[oe>>2]|0,we=C+8|0,z=o[we>>2]|0,R=D+ee|0,ee=z+ee|0,o[C>>2]=ee,o[oe>>2]=R,D=z+D|0,o[we>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[oe>>2]=z,o[we>>2]=D,o[C>>2]=0,R=0):(z=R,R=ee),(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[we>>2]=D,o[oe>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[oe>>2]=ee,o[we>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[oe>>2]=ee-z,o[we>>2]=D-z)}function Qo(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;D=o[C>>2]|0,oe=C+4|0,R=o[oe>>2]|0,we=C+8|0,z=o[we>>2]|0,ee=R+D|0,o[C>>2]=ee,R=z+R|0,o[oe>>2]=R,D=z+D|0,o[we>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[oe>>2]=z,o[we>>2]=D,o[C>>2]=0,R=0):(z=R,R=ee),(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[we>>2]=D,o[oe>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[oe>>2]=ee,o[we>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[oe>>2]=ee-z,o[we>>2]=D-z)}function ca(C){switch(C=C|0,C|0){case 1:{C=5;break}case 5:{C=4;break}case 4:{C=6;break}case 6:{C=2;break}case 2:{C=3;break}case 3:{C=1;break}}return C|0}function Ys(C){switch(C=C|0,C|0){case 1:{C=3;break}case 3:{C=2;break}case 2:{C=6;break}case 6:{C=4;break}case 4:{C=5;break}case 5:{C=1;break}}return C|0}function El(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;D=o[C>>2]|0,oe=C+4|0,z=o[oe>>2]|0,we=C+8|0,R=o[we>>2]|0,ee=z+(D<<1)|0,o[C>>2]=ee,z=R+(z<<1)|0,o[oe>>2]=z,D=(R<<1)+D|0,o[we>>2]=D,R=z-ee|0,(ee|0)<0?(D=D-ee|0,o[oe>>2]=R,o[we>>2]=D,o[C>>2]=0,z=R,R=0):R=ee,(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[we>>2]=D,o[oe>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[oe>>2]=ee,o[we>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[oe>>2]=ee-z,o[we>>2]=D-z)}function Za(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;ee=o[C>>2]|0,oe=C+4|0,D=o[oe>>2]|0,we=C+8|0,z=o[we>>2]|0,R=(D<<1)+ee|0,ee=z+(ee<<1)|0,o[C>>2]=ee,o[oe>>2]=R,D=(z<<1)+D|0,o[we>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[oe>>2]=z,o[we>>2]=D,o[C>>2]=0,ee=0):z=R,(z|0)<0&&(ee=ee-z|0,o[C>>2]=ee,D=D-z|0,o[we>>2]=D,o[oe>>2]=0,z=0),le=ee-D|0,R=z-D|0,(D|0)<0?(o[C>>2]=le,o[oe>>2]=R,o[we>>2]=0,ee=le,D=0):R=z,z=(R|0)<(ee|0)?R:ee,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=ee-z,o[oe>>2]=R-z,o[we>>2]=D-z)}function Ta(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0;return oe=(o[C>>2]|0)-(o[D>>2]|0)|0,we=(oe|0)<0,R=(o[C+4>>2]|0)-(o[D+4>>2]|0)-(we?oe:0)|0,le=(R|0)<0,ee=(we?0-oe|0:0)+(o[C+8>>2]|0)-(o[D+8>>2]|0)+(le?0-R|0:0)|0,C=(ee|0)<0,D=C?0:ee,z=(le?0:R)-(C?ee:0)|0,ee=(we?0:oe)-(le?R:0)-(C?ee:0)|0,C=(z|0)<(ee|0)?z:ee,C=(D|0)<(C|0)?D:C,R=(C|0)>0,D=D-(R?C:0)|0,z=z-(R?C:0)|0,C=ee-(R?C:0)|0,C=(C|0)>-1?C:0-C|0,z=(z|0)>-1?z:0-z|0,D=(D|0)>-1?D:0-D|0,D=(z|0)>(D|0)?z:D,((C|0)>(D|0)?C:D)|0}function ml(C,D){C=C|0,D=D|0;var z=0;z=o[C+8>>2]|0,o[D>>2]=(o[C>>2]|0)-z,o[D+4>>2]=(o[C+4>>2]|0)-z}function Cl(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0;R=o[C>>2]|0,o[D>>2]=R,C=o[C+4>>2]|0,oe=D+4|0,o[oe>>2]=C,we=D+8|0,o[we>>2]=0,z=C-R|0,(R|0)<0?(C=0-R|0,o[oe>>2]=z,o[we>>2]=C,o[D>>2]=0,R=0):(z=C,C=0),(z|0)<0&&(R=R-z|0,o[D>>2]=R,C=C-z|0,o[we>>2]=C,o[oe>>2]=0,z=0),le=R-C|0,ee=z-C|0,(C|0)<0?(o[D>>2]=le,o[oe>>2]=ee,o[we>>2]=0,z=ee,ee=le,C=0):ee=R,R=(z|0)<(ee|0)?z:ee,R=(C|0)<(R|0)?C:R,!((R|0)<=0)&&(o[D>>2]=ee-R,o[oe>>2]=z-R,o[we>>2]=C-R)}function mu(C){C=C|0;var D=0,z=0,R=0,ee=0;D=C+8|0,ee=o[D>>2]|0,z=ee-(o[C>>2]|0)|0,o[C>>2]=z,R=C+4|0,C=(o[R>>2]|0)-ee|0,o[R>>2]=C,o[D>>2]=0-(C+z)}function As(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;z=o[C>>2]|0,D=0-z|0,o[C>>2]=D,oe=C+8|0,o[oe>>2]=0,we=C+4|0,R=o[we>>2]|0,ee=R+z|0,(z|0)>0?(o[we>>2]=ee,o[oe>>2]=z,o[C>>2]=0,D=0,R=ee):z=0,(R|0)<0?(le=D-R|0,o[C>>2]=le,z=z-R|0,o[oe>>2]=z,o[we>>2]=0,ee=le-z|0,D=0-z|0,(z|0)<0?(o[C>>2]=ee,o[we>>2]=D,o[oe>>2]=0,R=D,z=0):(R=0,ee=le)):ee=D,D=(R|0)<(ee|0)?R:ee,D=(z|0)<(D|0)?z:D,!((D|0)<=0)&&(o[C>>2]=ee-D,o[we>>2]=R-D,o[oe>>2]=z-D)}function ac(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;R=Vt,Vt=Vt+16|0,ee=R,ro(C,D,z,ee),Gr(ee,z+4|0),Vt=R}function ro(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,$e=0;if($e=Vt,Vt=Vt+32|0,le=$e,oc(C,le),o[z>>2]=0,ee=+ta(15888,le),oe=+ta(15912,le),oe<ee&&(o[z>>2]=1,ee=oe),oe=+ta(15936,le),oe<ee&&(o[z>>2]=2,ee=oe),oe=+ta(15960,le),oe<ee&&(o[z>>2]=3,ee=oe),oe=+ta(15984,le),oe<ee&&(o[z>>2]=4,ee=oe),oe=+ta(16008,le),oe<ee&&(o[z>>2]=5,ee=oe),oe=+ta(16032,le),oe<ee&&(o[z>>2]=6,ee=oe),oe=+ta(16056,le),oe<ee&&(o[z>>2]=7,ee=oe),oe=+ta(16080,le),oe<ee&&(o[z>>2]=8,ee=oe),oe=+ta(16104,le),oe<ee&&(o[z>>2]=9,ee=oe),oe=+ta(16128,le),oe<ee&&(o[z>>2]=10,ee=oe),oe=+ta(16152,le),oe<ee&&(o[z>>2]=11,ee=oe),oe=+ta(16176,le),oe<ee&&(o[z>>2]=12,ee=oe),oe=+ta(16200,le),oe<ee&&(o[z>>2]=13,ee=oe),oe=+ta(16224,le),oe<ee&&(o[z>>2]=14,ee=oe),oe=+ta(16248,le),oe<ee&&(o[z>>2]=15,ee=oe),oe=+ta(16272,le),oe<ee&&(o[z>>2]=16,ee=oe),oe=+ta(16296,le),oe<ee&&(o[z>>2]=17,ee=oe),oe=+ta(16320,le),oe<ee&&(o[z>>2]=18,ee=oe),oe=+ta(16344,le),oe<ee&&(o[z>>2]=19,ee=oe),oe=+Yt(+(1-ee*.5)),oe<1e-16){o[R>>2]=0,o[R+4>>2]=0,o[R+8>>2]=0,o[R+12>>2]=0,Vt=$e;return}if(z=o[z>>2]|0,ee=+ke[16368+(z*24|0)>>3],ee=+Yo(ee-+Yo(+Er(15568+(z<<4)|0,C))),Nr(D)|0?we=+Yo(ee+-.3334731722518321):we=ee,ee=+Si(+oe)/.381966011250105,(D|0)>0){le=0;do ee=ee*2.6457513110645907,le=le+1|0;while((le|0)!=(D|0))}oe=+zi(+we)*ee,ke[R>>3]=oe,we=+xi(+we)*ee,ke[R+8>>3]=we,Vt=$e}function so(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0;if(le=+Fu(C),le<1e-16){D=15568+(D<<4)|0,o[ee>>2]=o[D>>2],o[ee+4>>2]=o[D+4>>2],o[ee+8>>2]=o[D+8>>2],o[ee+12>>2]=o[D+12>>2];return}if(oe=+mn(+ +ke[C+8>>3],+ +ke[C>>3]),(z|0)>0){C=0;do le=le/2.6457513110645907,C=C+1|0;while((C|0)!=(z|0))}R?(le=le/3,z=(Nr(z)|0)==0,le=+or(+((z?le:le/2.6457513110645907)*.381966011250105))):(le=+or(+(le*.381966011250105)),Nr(z)|0&&(oe=+Yo(oe+.3334731722518321))),$n(15568+(D<<4)|0,+Yo(+ke[16368+(D*24|0)>>3]-oe),le,ee)}function Ql(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;R=Vt,Vt=Vt+16|0,ee=R,Ir(C+4|0,ee),so(ee,o[C>>2]|0,D,0,z),Vt=R}function Oo(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0,ce=0,Se=0;if(X=Vt,Vt=Vt+272|0,le=X+256|0,O=X+240|0,T=X,B=X+224|0,j=X+208|0,y=X+176|0,s=X+160|0,i=X+192|0,r=X+144|0,l=X+128|0,d=X+112|0,_=X+96|0,w=X+80|0,o[le>>2]=D,o[O>>2]=o[C>>2],o[O+4>>2]=o[C+4>>2],o[O+8>>2]=o[C+8>>2],o[O+12>>2]=o[C+12>>2],Wo(O,le,T),o[ee>>2]=0,O=R+z+((R|0)==5&1)|0,(O|0)<=(z|0)){Vt=X;return}$e=o[le>>2]|0,_t=B+4|0,Ct=y+4|0,ni=z+5|0,Gt=16848+($e<<2)|0,Zt=16928+($e<<2)|0,Z=l+8|0,A=d+8|0,E=_+8|0,F=j+4|0,we=z;e:for(;;){oe=T+(((we|0)%5|0)<<4)|0,o[j>>2]=o[oe>>2],o[j+4>>2]=o[oe+4>>2],o[j+8>>2]=o[oe+8>>2],o[j+12>>2]=o[oe+12>>2];do;while((Co(j,$e,0,1)|0)==2);if((we|0)>(z|0)&(Nr(D)|0)!=0){if(o[y>>2]=o[j>>2],o[y+4>>2]=o[j+4>>2],o[y+8>>2]=o[j+8>>2],o[y+12>>2]=o[j+12>>2],Ir(_t,s),R=o[y>>2]|0,le=o[17008+(R*80|0)+(o[B>>2]<<2)>>2]|0,o[y>>2]=o[18608+(R*80|0)+(le*20|0)>>2],oe=o[18608+(R*80|0)+(le*20|0)+16>>2]|0,(oe|0)>0){C=0;do mo(Ct),C=C+1|0;while((C|0)<(oe|0))}switch(oe=18608+(R*80|0)+(le*20|0)+4|0,o[i>>2]=o[oe>>2],o[i+4>>2]=o[oe+4>>2],o[i+8>>2]=o[oe+8>>2],vr(i,(o[Gt>>2]|0)*3|0),Lr(Ct,i,Ct),nr(Ct),Ir(Ct,r),ce=+(o[Zt>>2]|0),ke[l>>3]=ce*3,ke[Z>>3]=0,Se=ce*-1.5,ke[d>>3]=Se,ke[A>>3]=ce*2.598076211353316,ke[_>>3]=Se,ke[E>>3]=ce*-2.598076211353316,o[17008+((o[y>>2]|0)*80|0)+(o[j>>2]<<2)>>2]|0){case 1:{C=d,R=l;break}case 3:{C=_,R=d;break}case 2:{C=l,R=_;break}default:{C=12;break e}}Vl(s,r,R,C,w),so(w,o[y>>2]|0,$e,1,ee+8+(o[ee>>2]<<4)|0),o[ee>>2]=(o[ee>>2]|0)+1}if((we|0)<(ni|0)&&(Ir(F,y),so(y,o[j>>2]|0,$e,1,ee+8+(o[ee>>2]<<4)|0),o[ee>>2]=(o[ee>>2]|0)+1),o[B>>2]=o[j>>2],o[B+4>>2]=o[j+4>>2],o[B+8>>2]=o[j+8>>2],o[B+12>>2]=o[j+12>>2],we=we+1|0,(we|0)>=(O|0)){C=3;break}}if((C|0)==3){Vt=X;return}else(C|0)==12&&Ki(22474,22521,581,22531)}function Wo(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,$e=0;$e=Vt,Vt=Vt+128|0,R=$e+64|0,ee=$e,le=R,oe=20208,we=le+60|0;do o[le>>2]=o[oe>>2],le=le+4|0,oe=oe+4|0;while((le|0)<(we|0));le=ee,oe=20272,we=le+60|0;do o[le>>2]=o[oe>>2],le=le+4|0,oe=oe+4|0;while((le|0)<(we|0));we=(Nr(o[D>>2]|0)|0)==0,R=we?R:ee,ee=C+4|0,El(ee),Za(ee),Nr(o[D>>2]|0)|0&&(Bs(ee),o[D>>2]=(o[D>>2]|0)+1),o[z>>2]=o[C>>2],D=z+4|0,Lr(ee,R,D),nr(D),o[z+16>>2]=o[C>>2],D=z+20|0,Lr(ee,R+12|0,D),nr(D),o[z+32>>2]=o[C>>2],D=z+36|0,Lr(ee,R+24|0,D),nr(D),o[z+48>>2]=o[C>>2],D=z+52|0,Lr(ee,R+36|0,D),nr(D),o[z+64>>2]=o[C>>2],z=z+68|0,Lr(ee,R+48|0,z),nr(z),Vt=$e}function Co(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0,Zt=0,Z=0;if(Z=Vt,Vt=Vt+32|0,Gt=Z+12|0,we=Z,Zt=C+4|0,ni=o[16928+(D<<2)>>2]|0,Ct=(R|0)!=0,ni=Ct?ni*3|0:ni,ee=o[Zt>>2]|0,_t=C+8|0,oe=o[_t>>2]|0,Ct){if(le=C+12|0,R=o[le>>2]|0,ee=oe+ee+R|0,(ee|0)==(ni|0))return Zt=1,Vt=Z,Zt|0;$e=le}else $e=C+12|0,R=o[$e>>2]|0,ee=oe+ee+R|0;if((ee|0)<=(ni|0))return Zt=0,Vt=Z,Zt|0;do if((R|0)>0){if(R=o[C>>2]|0,(oe|0)>0){le=18608+(R*80|0)+60|0,R=C;break}R=18608+(R*80|0)+40|0,z?(pl(Gt,ni,0,0),Zs(Zt,Gt,we),Qo(we),Lr(we,Gt,Zt),le=R,R=C):(le=R,R=C)}else le=18608+((o[C>>2]|0)*80|0)+20|0,R=C;while(!1);if(o[R>>2]=o[le>>2],ee=le+16|0,(o[ee>>2]|0)>0){R=0;do mo(Zt),R=R+1|0;while((R|0)<(o[ee>>2]|0))}return C=le+4|0,o[Gt>>2]=o[C>>2],o[Gt+4>>2]=o[C+4>>2],o[Gt+8>>2]=o[C+8>>2],D=o[16848+(D<<2)>>2]|0,vr(Gt,Ct?D*3|0:D),Lr(Zt,Gt,Zt),nr(Zt),Ct?R=((o[_t>>2]|0)+(o[Zt>>2]|0)+(o[$e>>2]|0)|0)==(ni|0)?1:2:R=2,Zt=R,Vt=Z,Zt|0}function Gs(C,D){C=C|0,D=D|0;var z=0;do z=Co(C,D,0,1)|0;while((z|0)==2);return z|0}function $o(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0;if(_=Vt,Vt=Vt+240|0,le=_+224|0,i=_+208|0,r=_,l=_+192|0,d=_+176|0,E=_+160|0,F=_+144|0,O=_+128|0,y=_+112|0,s=_+96|0,o[le>>2]=D,o[i>>2]=o[C>>2],o[i+4>>2]=o[C+4>>2],o[i+8>>2]=o[C+8>>2],o[i+12>>2]=o[C+12>>2],Xo(i,le,r),o[ee>>2]=0,A=R+z+((R|0)==6&1)|0,(A|0)<=(z|0)){Vt=_;return}$e=o[le>>2]|0,_t=z+6|0,Ct=16928+($e<<2)|0,ni=F+8|0,Gt=O+8|0,Zt=y+8|0,Z=l+4|0,oe=0,we=z,R=-1;e:for(;;){if(le=(we|0)%6|0,C=r+(le<<4)|0,o[l>>2]=o[C>>2],o[l+4>>2]=o[C+4>>2],o[l+8>>2]=o[C+8>>2],o[l+12>>2]=o[C+12>>2],C=oe,oe=Co(l,$e,0,1)|0,(we|0)>(z|0)&(Nr(D)|0)!=0&&(C|0)!=1&&(o[l>>2]|0)!=(R|0)){switch(Ir(r+(((le+5|0)%6|0)<<4)+4|0,d),Ir(r+(le<<4)+4|0,E),w=+(o[Ct>>2]|0),ke[F>>3]=w*3,ke[ni>>3]=0,T=w*-1.5,ke[O>>3]=T,ke[Gt>>3]=w*2.598076211353316,ke[y>>3]=T,ke[Zt>>3]=w*-2.598076211353316,le=o[i>>2]|0,o[17008+(le*80|0)+(((R|0)==(le|0)?o[l>>2]|0:R)<<2)>>2]|0){case 1:{C=O,R=F;break}case 3:{C=y,R=O;break}case 2:{C=F,R=y;break}default:{C=8;break e}}Vl(d,E,R,C,s),!(yl(d,s)|0)&&!(yl(E,s)|0)&&(so(s,o[i>>2]|0,$e,1,ee+8+(o[ee>>2]<<4)|0),o[ee>>2]=(o[ee>>2]|0)+1)}if((we|0)<(_t|0)&&(Ir(Z,d),so(d,o[l>>2]|0,$e,1,ee+8+(o[ee>>2]<<4)|0),o[ee>>2]=(o[ee>>2]|0)+1),we=we+1|0,(we|0)>=(A|0)){C=3;break}else R=o[l>>2]|0}if((C|0)==3){Vt=_;return}else(C|0)==8&&Ki(22557,22521,746,22602)}function Xo(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,$e=0;$e=Vt,Vt=Vt+160|0,R=$e+80|0,ee=$e,le=R,oe=20336,we=le+72|0;do o[le>>2]=o[oe>>2],le=le+4|0,oe=oe+4|0;while((le|0)<(we|0));le=ee,oe=20416,we=le+72|0;do o[le>>2]=o[oe>>2],le=le+4|0,oe=oe+4|0;while((le|0)<(we|0));we=(Nr(o[D>>2]|0)|0)==0,R=we?R:ee,ee=C+4|0,El(ee),Za(ee),Nr(o[D>>2]|0)|0&&(Bs(ee),o[D>>2]=(o[D>>2]|0)+1),o[z>>2]=o[C>>2],D=z+4|0,Lr(ee,R,D),nr(D),o[z+16>>2]=o[C>>2],D=z+20|0,Lr(ee,R+12|0,D),nr(D),o[z+32>>2]=o[C>>2],D=z+36|0,Lr(ee,R+24|0,D),nr(D),o[z+48>>2]=o[C>>2],D=z+52|0,Lr(ee,R+36|0,D),nr(D),o[z+64>>2]=o[C>>2],D=z+68|0,Lr(ee,R+48|0,D),nr(D),o[z+80>>2]=o[C>>2],z=z+84|0,Lr(ee,R+60|0,z),nr(z),Vt=$e}function Yo(C){C=+C;var D=0;return D=C<0?C+6.283185307179586:C,+(C>=6.283185307179586?D+-6.283185307179586:D)}function ba(C,D){return C=C|0,D=D|0,+hi(+(+ke[C>>3]-+ke[D>>3]))<17453292519943298e-27?(D=+hi(+(+ke[C+8>>3]-+ke[D+8>>3]))<17453292519943298e-27,D|0):(D=0,D|0)}function Qa(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0;return ee=+ke[D>>3],R=+ke[C>>3],le=+xi(+((ee-R)*.5)),z=+xi(+((+ke[D+8>>3]-+ke[C+8>>3])*.5)),z=le*le+z*(+zi(+ee)*+zi(+R)*z),+(+mn(+ +Jt(+z),+ +Jt(+(1-z)))*2)}function Cs(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0;return ee=+ke[D>>3],R=+ke[C>>3],le=+xi(+((ee-R)*.5)),z=+xi(+((+ke[D+8>>3]-+ke[C+8>>3])*.5)),z=le*le+z*(+zi(+ee)*+zi(+R)*z),+(+mn(+ +Jt(+z),+ +Jt(+(1-z)))*2*6371.007180918475)}function gu(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0;return ee=+ke[D>>3],R=+ke[C>>3],le=+xi(+((ee-R)*.5)),z=+xi(+((+ke[D+8>>3]-+ke[C+8>>3])*.5)),z=le*le+z*(+zi(+ee)*+zi(+R)*z),+(+mn(+ +Jt(+z),+ +Jt(+(1-z)))*2*6371.007180918475*1e3)}function Er(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0;return le=+ke[D>>3],R=+zi(+le),ee=+ke[D+8>>3]-+ke[C+8>>3],oe=R*+xi(+ee),z=+ke[C>>3],+ +mn(+oe,+(+xi(+le)*+zi(+z)-+zi(+ee)*(R*+xi(+z))))}function $n(C,D,z,R){C=C|0,D=+D,z=+z,R=R|0;var ee=0,le=0,oe=0,we=0;if(z<1e-16){o[R>>2]=o[C>>2],o[R+4>>2]=o[C+4>>2],o[R+8>>2]=o[C+8>>2],o[R+12>>2]=o[C+12>>2];return}le=D<0?D+6.283185307179586:D,le=D>=6.283185307179586?le+-6.283185307179586:le;do if(le<1e-16)D=+ke[C>>3]+z,ke[R>>3]=D,ee=R;else{if(ee=+hi(+(le+-3.141592653589793))<1e-16,D=+ke[C>>3],ee){D=D-z,ke[R>>3]=D,ee=R;break}if(oe=+zi(+z),z=+xi(+z),D=oe*+xi(+D)+ +zi(+le)*(z*+zi(+D)),D=D>1?1:D,D=+bn(+(D<-1?-1:D)),ke[R>>3]=D,+hi(+(D+-1.5707963267948966))<1e-16){ke[R>>3]=1.5707963267948966,ke[R+8>>3]=0;return}if(+hi(+(D+1.5707963267948966))<1e-16){ke[R>>3]=-1.5707963267948966,ke[R+8>>3]=0;return}if(we=+zi(+D),le=z*+xi(+le)/we,z=+ke[C>>3],D=(oe-+xi(+D)*+xi(+z))/+zi(+z)/we,oe=le>1?1:le,D=D>1?1:D,D=+ke[C+8>>3]+ +mn(+(oe<-1?-1:oe),+(D<-1?-1:D)),D>3.141592653589793)do D=D+-6.283185307179586;while(D>3.141592653589793);if(D<-3.141592653589793)do D=D+6.283185307179586;while(D<-3.141592653589793);ke[R+8>>3]=D;return}while(!1);if(+hi(+(D+-1.5707963267948966))<1e-16){ke[ee>>3]=1.5707963267948966,ke[R+8>>3]=0;return}if(+hi(+(D+1.5707963267948966))<1e-16){ke[ee>>3]=-1.5707963267948966,ke[R+8>>3]=0;return}if(D=+ke[C+8>>3],D>3.141592653589793)do D=D+-6.283185307179586;while(D>3.141592653589793);if(D<-3.141592653589793)do D=D+6.283185307179586;while(D<-3.141592653589793);ke[R+8>>3]=D}function Ko(C){return C=C|0,+ +ke[20496+(C<<3)>>3]}function zr(C){return C=C|0,+ +ke[20624+(C<<3)>>3]}function Wa(C){return C=C|0,+ +ke[20752+(C<<3)>>3]}function Jr(C){return C=C|0,+ +ke[20880+(C<<3)>>3]}function fr(C){C=C|0;var D=0;return D=21008+(C<<3)|0,C=o[D>>2]|0,Vn(o[D+4>>2]|0),C|0}function To(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0;return Gt=+ke[D>>3],Ct=+ke[C>>3],$e=+xi(+((Gt-Ct)*.5)),le=+ke[D+8>>3],_t=+ke[C+8>>3],oe=+xi(+((le-_t)*.5)),we=+zi(+Ct),ni=+zi(+Gt),oe=$e*$e+oe*(ni*we*oe),oe=+mn(+ +Jt(+oe),+ +Jt(+(1-oe)))*2,$e=+ke[z>>3],Gt=+xi(+(($e-Gt)*.5)),R=+ke[z+8>>3],le=+xi(+((R-le)*.5)),ee=+zi(+$e),le=Gt*Gt+le*(ni*ee*le),le=+mn(+ +Jt(+le),+ +Jt(+(1-le)))*2,$e=+xi(+((Ct-$e)*.5)),R=+xi(+((_t-R)*.5)),R=$e*$e+R*(we*ee*R),R=+mn(+ +Jt(+R),+ +Jt(+(1-R)))*2,ee=(oe+le+R)*.5,+(+or(+ +Jt(+(+Si(+(ee*.5))*+Si(+((ee-oe)*.5))*+Si(+((ee-le)*.5))*+Si(+((ee-R)*.5)))))*4)}function Gn(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0;if(le=Vt,Vt=Vt+192|0,R=le+168|0,ee=le,Sa(C,D,R),ka(C,D,ee),D=o[ee>>2]|0,(D|0)<=0)return z=0,Vt=le,+z;if(z=+To(ee+8|0,ee+8+(((D|0)!=1&1)<<4)|0,R)+0,(D|0)==1)return Vt=le,+z;C=1;do oe=C,C=C+1|0,z=z+ +To(ee+8+(oe<<4)|0,ee+8+(((C|0)%(D|0)|0)<<4)|0,R);while((C|0)<(D|0));return Vt=le,+z}function Ol(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0;if(le=Vt,Vt=Vt+192|0,R=le+168|0,ee=le,Sa(C,D,R),ka(C,D,ee),D=o[ee>>2]|0,(D|0)>0){if(z=+To(ee+8|0,ee+8+(((D|0)!=1&1)<<4)|0,R)+0,(D|0)!=1){C=1;do oe=C,C=C+1|0,z=z+ +To(ee+8+(oe<<4)|0,ee+8+(((C|0)%(D|0)|0)<<4)|0,R);while((C|0)<(D|0))}}else z=0;return Vt=le,+(z*6371.007180918475*6371.007180918475)}function es(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0;if(le=Vt,Vt=Vt+192|0,R=le+168|0,ee=le,Sa(C,D,R),ka(C,D,ee),D=o[ee>>2]|0,(D|0)>0){if(z=+To(ee+8|0,ee+8+(((D|0)!=1&1)<<4)|0,R)+0,(D|0)!=1){C=1;do oe=C,C=C+1|0,z=z+ +To(ee+8+(oe<<4)|0,ee+8+(((C|0)%(D|0)|0)<<4)|0,R);while((C|0)<(D|0))}}else z=0;return Vt=le,+(z*6371.007180918475*6371.007180918475*1e3*1e3)}function Zr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0;if(oe=Vt,Vt=Vt+176|0,le=oe,Fi(C,D,le),C=o[le>>2]|0,(C|0)<=1)return ee=0,Vt=oe,+ee;D=C+-1|0,C=0,z=0,R=+ke[le+8>>3],ee=+ke[le+16>>3];do C=C+1|0,$e=R,R=+ke[le+8+(C<<4)>>3],_t=+xi(+((R-$e)*.5)),we=ee,ee=+ke[le+8+(C<<4)+8>>3],we=+xi(+((ee-we)*.5)),we=_t*_t+we*(+zi(+R)*+zi(+$e)*we),z=z+ +mn(+ +Jt(+we),+ +Jt(+(1-we)))*2;while((C|0)<(D|0));return Vt=oe,+z}function Ts(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0;if(oe=Vt,Vt=Vt+176|0,le=oe,Fi(C,D,le),C=o[le>>2]|0,(C|0)<=1)return ee=0,Vt=oe,+ee;D=C+-1|0,C=0,z=0,R=+ke[le+8>>3],ee=+ke[le+16>>3];do C=C+1|0,$e=R,R=+ke[le+8+(C<<4)>>3],_t=+xi(+((R-$e)*.5)),we=ee,ee=+ke[le+8+(C<<4)+8>>3],we=+xi(+((ee-we)*.5)),we=_t*_t+we*(+zi(+$e)*+zi(+R)*we),z=z+ +mn(+ +Jt(+we),+ +Jt(+(1-we)))*2;while((C|0)!=(D|0));return _t=z*6371.007180918475,Vt=oe,+_t}function kr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0;if(oe=Vt,Vt=Vt+176|0,le=oe,Fi(C,D,le),C=o[le>>2]|0,(C|0)<=1)return ee=0,Vt=oe,+ee;D=C+-1|0,C=0,z=0,R=+ke[le+8>>3],ee=+ke[le+16>>3];do C=C+1|0,$e=R,R=+ke[le+8+(C<<4)>>3],_t=+xi(+((R-$e)*.5)),we=ee,ee=+ke[le+8+(C<<4)+8>>3],we=+xi(+((ee-we)*.5)),we=_t*_t+we*(+zi(+$e)*+zi(+R)*we),z=z+ +mn(+ +Jt(+we),+ +Jt(+(1-we)))*2;while((C|0)!=(D|0));return _t=z*6371.007180918475*1e3,Vt=oe,+_t}function rr(C,D){return C=C|0,D=D|0,D=Mi(C|0,D|0,52)|0,Wt()|0,D&15|0}function ll(C,D){return C=C|0,D=D|0,D=Mi(C|0,D|0,45)|0,Wt()|0,D&127|0}function Xr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0;if(!(!0&(D&-16777216|0)==134217728)||(oe=Mi(C|0,D|0,45)|0,Wt()|0,oe=oe&127,oe>>>0>121))return D=0,D|0;z=Mi(C|0,D|0,52)|0,Wt()|0,z=z&15;do if(z|0){for(ee=1,R=0;;){if(le=Mi(C|0,D|0,(15-ee|0)*3|0)|0,Wt()|0,le=le&7,(le|0)!=0&(R^1))if((le|0)==1&(N(oe)|0)!=0){we=0,R=13;break}else R=1;if((le|0)==7){we=0,R=13;break}if(ee>>>0<z>>>0)ee=ee+1|0;else{R=9;break}}if((R|0)==9){if((z|0)==15)we=1;else break;return we|0}else if((R|0)==13)return we|0}while(!1);for(;;){if(we=Mi(C|0,D|0,(14-z|0)*3|0)|0,Wt()|0,!((we&7|0)==7&!0)){we=0,R=13;break}if(z>>>0<14)z=z+1|0;else{we=1,R=13;break}}return(R|0)==13?we|0:0}function ko(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;if(R=Mi(C|0,D|0,52)|0,Wt()|0,R=R&15,(R|0)>=(z|0)){if((R|0)!=(z|0))if(z>>>0<=15){if(ee=Bi(z|0,0,52)|0,C=ee|C,D=Wt()|0|D&-15728641,(R|0)>(z|0))do ee=Bi(7,0,(14-z|0)*3|0)|0,z=z+1|0,C=ee|C,D=Wt()|0|D;while((z|0)<(R|0))}else D=0,C=0}else D=0,C=0;return Vn(D|0),C|0}function ul(C,D,z){return C=C|0,D=D|0,z=z|0,C=Mi(C|0,D|0,52)|0,Wt()|0,C=C&15,(z|0)<16&(C|0)<=(z|0)?(z=vo(7,z-C|0)|0,z|0):(z=0,z|0)}function Qr(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,$e=0,_t=0,Ct=0;if(oe=Mi(C|0,D|0,52)|0,Wt()|0,oe=oe&15,!!((z|0)<16&(oe|0)<=(z|0))){if((oe|0)==(z|0)){z=R,o[z>>2]=C,o[z+4>>2]=D;return}if($e=vo(7,z-oe|0)|0,_t=($e|0)/7|0,we=Mi(C|0,D|0,45)|0,Wt()|0,!(N(we&127)|0))le=0;else{e:do if(!oe)ee=0;else for(le=1;;){if(ee=Mi(C|0,D|0,(15-le|0)*3|0)|0,Wt()|0,ee=ee&7,ee|0)break e;if(le>>>0<oe>>>0)le=le+1|0;else{ee=0;break}}while(!1);le=(ee|0)==0}if(Ct=Bi(oe+1|0,0,52)|0,ee=Wt()|0|D&-15728641,we=(14-oe|0)*3|0,D=Bi(7,0,we|0)|0,D=(Ct|C)&~D,oe=ee&~(Wt()|0),Qr(D,oe,z,R),ee=R+(_t<<3)|0,!le){Ct=Bi(1,0,we|0)|0,Qr(Ct|D,Wt()|0|oe,z,ee),Ct=ee+(_t<<3)|0,$e=Bi(2,0,we|0)|0,Qr($e|D,Wt()|0|oe,z,Ct),Ct=Ct+(_t<<3)|0,$e=Bi(3,0,we|0)|0,Qr($e|D,Wt()|0|oe,z,Ct),Ct=Ct+(_t<<3)|0,$e=Bi(4,0,we|0)|0,Qr($e|D,Wt()|0|oe,z,Ct),Ct=Ct+(_t<<3)|0,$e=Bi(5,0,we|0)|0,Qr($e|D,Wt()|0|oe,z,Ct),$e=Bi(6,0,we|0)|0,Qr($e|D,Wt()|0|oe,z,Ct+(_t<<3)|0);return}le=ee+(_t<<3)|0,($e|0)>6&&($e=ee+8|0,Ct=(le>>>0>$e>>>0?le:$e)+-1+(0-ee)|0,fs(ee|0,0,Ct+8&-8|0)|0,ee=$e+(Ct>>>3<<3)|0),Ct=Bi(2,0,we|0)|0,Qr(Ct|D,Wt()|0|oe,z,ee),Ct=ee+(_t<<3)|0,$e=Bi(3,0,we|0)|0,Qr($e|D,Wt()|0|oe,z,Ct),Ct=Ct+(_t<<3)|0,$e=Bi(4,0,we|0)|0,Qr($e|D,Wt()|0|oe,z,Ct),Ct=Ct+(_t<<3)|0,$e=Bi(5,0,we|0)|0,Qr($e|D,Wt()|0|oe,z,Ct),$e=Bi(6,0,we|0)|0,Qr($e|D,Wt()|0|oe,z,Ct+(_t<<3)|0)}}function ds(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;if(ee=Mi(C|0,D|0,45)|0,Wt()|0,!(N(ee&127)|0))return ee=0,ee|0;ee=Mi(C|0,D|0,52)|0,Wt()|0,ee=ee&15;e:do if(!ee)z=0;else for(R=1;;){if(z=Mi(C|0,D|0,(15-R|0)*3|0)|0,Wt()|0,z=z&7,z|0)break e;if(R>>>0<ee>>>0)R=R+1|0;else{z=0;break}}while(!1);return ee=(z|0)==0&1,ee|0}function wa(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;if(R=Mi(C|0,D|0,52)|0,Wt()|0,R=R&15,(z|0)<16&(R|0)<=(z|0)){if((R|0)!=(z|0)&&(ee=Bi(z|0,0,52)|0,C=ee|C,D=Wt()|0|D&-15728641,(R|0)<(z|0)))do ee=Bi(7,0,(14-R|0)*3|0)|0,R=R+1|0,C=C&~ee,D=D&~(Wt()|0);while((R|0)<(z|0))}else D=0,C=0;return Vn(D|0),C|0}function Tl(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0;if(!z)return l=0,l|0;if(ee=C,R=o[ee>>2]|0,ee=o[ee+4>>2]|0,!0&(ee&15728640|0)==0){if((z|0)<=0||(l=D,o[l>>2]=R,o[l+4>>2]=ee,(z|0)==1))return l=0,l|0;R=1;do i=C+(R<<3)|0,r=o[i+4>>2]|0,l=D+(R<<3)|0,o[l>>2]=o[i>>2],o[l+4>>2]=r,R=R+1|0;while((R|0)!=(z|0));return R=0,R|0}if(i=z<<3,r=jn(i)|0,!r)return l=-3,l|0;if(Vo(r|0,C|0,i|0)|0,s=tl(z,8)|0,!s)return Jn(r),l=-3,l|0;R=z;e:for(;;){oe=r,Ct=o[oe>>2]|0,oe=o[oe+4>>2]|0,O=Mi(Ct|0,oe|0,52)|0,Wt()|0,O=O&15,y=O+-1|0,F=(R|0)>0;t:do if(F){if(E=((R|0)<0)<<31>>31,Z=Bi(y|0,0,52)|0,A=Wt()|0,y>>>0>15)for(ee=0,C=Ct,z=oe;;){if(!((C|0)==0&(z|0)==0)){if(le=Mi(C|0,z|0,52)|0,Wt()|0,le=le&15,we=(le|0)<(y|0),le=(le|0)==(y|0),_t=we?0:le?C:0,C=we?0:le?z:0,z=Po(_t|0,C|0,R|0,E|0)|0,Wt()|0,le=s+(z<<3)|0,we=le,$e=o[we>>2]|0,we=o[we+4>>2]|0,($e|0)==0&(we|0)==0)z=_t;else for(Z=0,Zt=z,Gt=we,z=_t;;){if((Z|0)>(R|0)){l=41;break e}if(($e|0)==(z|0)&(Gt&-117440513|0)==(C|0)){_t=Mi($e|0,Gt|0,56)|0,Wt()|0,_t=_t&7,ni=_t+1|0,A=Mi($e|0,Gt|0,45)|0,Wt()|0;i:do if(!(N(A&127)|0))we=7;else{if($e=Mi($e|0,Gt|0,52)|0,Wt()|0,$e=$e&15,!$e){we=6;break}for(we=1;;){if(A=Bi(7,0,(15-we|0)*3|0)|0,!((A&z|0)==0&((Wt()|0)&C|0)==0)){we=7;break i}if(we>>>0<$e>>>0)we=we+1|0;else{we=6;break}}}while(!1);if((_t+2|0)>>>0>we>>>0){l=51;break e}A=Bi(ni|0,0,56)|0,C=Wt()|0|C&-117440513,we=le,o[we>>2]=0,o[we+4>>2]=0,we=Zt,z=A|z}else we=(Zt+1|0)%(R|0)|0;if(le=s+(we<<3)|0,Gt=le,$e=o[Gt>>2]|0,Gt=o[Gt+4>>2]|0,($e|0)==0&(Gt|0)==0)break;Z=Z+1|0,Zt=we}A=le,o[A>>2]=z,o[A+4>>2]=C}if(ee=ee+1|0,(ee|0)>=(R|0))break t;z=r+(ee<<3)|0,C=o[z>>2]|0,z=o[z+4>>2]|0}for(ee=0,C=Ct,z=oe;;){if(!((C|0)==0&(z|0)==0)){if(we=Mi(C|0,z|0,52)|0,Wt()|0,we=we&15,(we|0)>=(y|0)){if((we|0)!=(y|0)&&(C=C|Z,z=z&-15728641|A,we>>>0>=O>>>0)){le=y;do Zt=Bi(7,0,(14-le|0)*3|0)|0,le=le+1|0,C=Zt|C,z=Wt()|0|z;while(le>>>0<we>>>0)}}else C=0,z=0;if(we=Po(C|0,z|0,R|0,E|0)|0,Wt()|0,le=s+(we<<3)|0,$e=le,_t=o[$e>>2]|0,$e=o[$e+4>>2]|0,!((_t|0)==0&($e|0)==0))for(Zt=0;;){if((Zt|0)>(R|0)){l=41;break e}if((_t|0)==(C|0)&($e&-117440513|0)==(z|0)){ni=Mi(_t|0,$e|0,56)|0,Wt()|0,ni=ni&7,Gt=ni+1|0,d=Mi(_t|0,$e|0,45)|0,Wt()|0;i:do if(!(N(d&127)|0))$e=7;else{if(_t=Mi(_t|0,$e|0,52)|0,Wt()|0,_t=_t&15,!_t){$e=6;break}for($e=1;;){if(d=Bi(7,0,(15-$e|0)*3|0)|0,!((d&C|0)==0&((Wt()|0)&z|0)==0)){$e=7;break i}if($e>>>0<_t>>>0)$e=$e+1|0;else{$e=6;break}}}while(!1);if((ni+2|0)>>>0>$e>>>0){l=51;break e}d=Bi(Gt|0,0,56)|0,z=Wt()|0|z&-117440513,Gt=le,o[Gt>>2]=0,o[Gt+4>>2]=0,C=d|C}else we=(we+1|0)%(R|0)|0;if(le=s+(we<<3)|0,$e=le,_t=o[$e>>2]|0,$e=o[$e+4>>2]|0,(_t|0)==0&($e|0)==0)break;Zt=Zt+1|0}d=le,o[d>>2]=C,o[d+4>>2]=z}if(ee=ee+1|0,(ee|0)>=(R|0))break t;z=r+(ee<<3)|0,C=o[z>>2]|0,z=o[z+4>>2]|0}}while(!1);if((R+5|0)>>>0<11){l=99;break}if(A=tl((R|0)/6|0,8)|0,!A){l=58;break}t:do if(F){Zt=0,Gt=0;do{if(we=s+(Zt<<3)|0,C=we,ee=o[C>>2]|0,C=o[C+4>>2]|0,!((ee|0)==0&(C|0)==0)){$e=Mi(ee|0,C|0,56)|0,Wt()|0,$e=$e&7,z=$e+1|0,_t=C&-117440513,d=Mi(ee|0,C|0,45)|0,Wt()|0;i:do if(N(d&127)|0){if(ni=Mi(ee|0,C|0,52)|0,Wt()|0,ni=ni&15,ni|0)for(le=1;;){if(d=Bi(7,0,(15-le|0)*3|0)|0,!((ee&d|0)==0&(_t&(Wt()|0)|0)==0))break i;if(le>>>0<ni>>>0)le=le+1|0;else break}C=Bi(z|0,0,56)|0,ee=C|ee,C=Wt()|0|_t,z=we,o[z>>2]=ee,o[z+4>>2]=C,z=$e+2|0}while(!1);(z|0)==7&&(d=A+(Gt<<3)|0,o[d>>2]=ee,o[d+4>>2]=C&-117440513,Gt=Gt+1|0)}Zt=Zt+1|0}while((Zt|0)!=(R|0));if(F){if(Z=((R|0)<0)<<31>>31,ni=Bi(y|0,0,52)|0,Zt=Wt()|0,y>>>0>15)for(C=0,ee=0;;){do if(!((Ct|0)==0&(oe|0)==0)){for($e=Mi(Ct|0,oe|0,52)|0,Wt()|0,$e=$e&15,le=($e|0)<(y|0),$e=($e|0)==(y|0),we=le?0:$e?Ct:0,$e=le?0:$e?oe:0,le=Po(we|0,$e|0,R|0,Z|0)|0,Wt()|0,z=0;;){if((z|0)>(R|0)){l=98;break e}if(d=s+(le<<3)|0,_t=o[d+4>>2]|0,(_t&-117440513|0)==($e|0)&&(o[d>>2]|0)==(we|0)){l=70;break}if(le=(le+1|0)%(R|0)|0,d=s+(le<<3)|0,(o[d>>2]|0)==(we|0)&&(o[d+4>>2]|0)==($e|0))break;z=z+1|0}if((l|0)==70&&(l=0,!0&(_t&117440512|0)==100663296))break;d=D+(ee<<3)|0,o[d>>2]=Ct,o[d+4>>2]=oe,ee=ee+1|0}while(!1);if(C=C+1|0,(C|0)>=(R|0)){R=Gt;break t}oe=r+(C<<3)|0,Ct=o[oe>>2]|0,oe=o[oe+4>>2]|0}for(C=0,ee=0;;){do if(!((Ct|0)==0&(oe|0)==0)){if($e=Mi(Ct|0,oe|0,52)|0,Wt()|0,$e=$e&15,($e|0)>=(y|0))if(($e|0)!=(y|0))if(z=Ct|ni,le=oe&-15728641|Zt,$e>>>0<O>>>0)$e=le;else{we=y;do d=Bi(7,0,(14-we|0)*3|0)|0,we=we+1|0,z=d|z,le=Wt()|0|le;while(we>>>0<$e>>>0);$e=le}else z=Ct,$e=oe;else z=0,$e=0;for(we=Po(z|0,$e|0,R|0,Z|0)|0,Wt()|0,le=0;;){if((le|0)>(R|0)){l=98;break e}if(d=s+(we<<3)|0,_t=o[d+4>>2]|0,(_t&-117440513|0)==($e|0)&&(o[d>>2]|0)==(z|0)){l=93;break}if(we=(we+1|0)%(R|0)|0,d=s+(we<<3)|0,(o[d>>2]|0)==(z|0)&&(o[d+4>>2]|0)==($e|0))break;le=le+1|0}if((l|0)==93&&(l=0,!0&(_t&117440512|0)==100663296))break;d=D+(ee<<3)|0,o[d>>2]=Ct,o[d+4>>2]=oe,ee=ee+1|0}while(!1);if(C=C+1|0,(C|0)>=(R|0)){R=Gt;break t}oe=r+(C<<3)|0,Ct=o[oe>>2]|0,oe=o[oe+4>>2]|0}}else ee=0,R=Gt}else ee=0,R=0;while(!1);if(fs(s|0,0,i|0)|0,Vo(r|0,A|0,R<<3|0)|0,Jn(A),R)D=D+(ee<<3)|0;else break}return(l|0)==41?(Jn(r),Jn(s),d=-1,d|0):(l|0)==51?(Jn(r),Jn(s),d=-2,d|0):(l|0)==58?(Jn(r),Jn(s),d=-3,d|0):(l|0)==98?(Jn(A),Jn(r),Jn(s),d=-1,d|0):((l|0)==99&&Vo(D|0,r|0,R<<3|0)|0,Jn(r),Jn(s),d=0,d|0)}function Mo(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,$e=0,_t=0,Ct=0;if((D|0)<=0)return ee=0,ee|0;if((ee|0)>=16){for(le=0;;){if(Ct=C+(le<<3)|0,!((o[Ct>>2]|0)==0&(o[Ct+4>>2]|0)==0)){le=14;break}if(le=le+1|0,(le|0)>=(D|0)){oe=0,le=16;break}}if((le|0)==14)return((R|0)>0?-2:-1)|0;if((le|0)==16)return oe|0}le=0,Ct=0;e:for(;;){_t=C+(Ct<<3)|0,we=_t,oe=o[we>>2]|0,we=o[we+4>>2]|0;do if(!((oe|0)==0&(we|0)==0)){if((le|0)>=(R|0)){oe=-1,le=16;break e}if($e=Mi(oe|0,we|0,52)|0,Wt()|0,$e=$e&15,($e|0)>(ee|0)){oe=-2,le=16;break e}if(($e|0)==(ee|0)){_t=z+(le<<3)|0,o[_t>>2]=oe,o[_t+4>>2]=we,le=le+1|0;break}if(oe=(vo(7,ee-$e|0)|0)+le|0,(oe|0)>(R|0)){oe=-1,le=16;break e}Qr(o[_t>>2]|0,o[_t+4>>2]|0,ee,z+(le<<3)|0),le=oe}while(!1);if(Ct=Ct+1|0,(Ct|0)>=(D|0)){oe=0,le=16;break}}return(le|0)==16?oe|0:0}function kl(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0;if((D|0)<=0)return z=0,z|0;if((z|0)>=16){for(R=0;;){if(oe=C+(R<<3)|0,!((o[oe>>2]|0)==0&(o[oe+4>>2]|0)==0)){R=-1,ee=13;break}if(R=R+1|0,(R|0)>=(D|0)){R=0,ee=13;break}}if((ee|0)==13)return R|0}R=0,oe=0;e:for(;;){ee=C+(oe<<3)|0,le=o[ee>>2]|0,ee=o[ee+4>>2]|0;do if(!((le|0)==0&(ee|0)==0)){if(ee=Mi(le|0,ee|0,52)|0,Wt()|0,ee=ee&15,(ee|0)>(z|0)){R=-1,ee=13;break e}if((ee|0)==(z|0)){R=R+1|0;break}else{R=(vo(7,z-ee|0)|0)+R|0;break}}while(!1);if(oe=oe+1|0,(oe|0)>=(D|0)){ee=13;break}}return(ee|0)==13?R|0:0}function go(C,D){return C=C|0,D=D|0,D=Mi(C|0,D|0,52)|0,Wt()|0,D&1|0}function Js(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;if(ee=Mi(C|0,D|0,52)|0,Wt()|0,ee=ee&15,!ee)return ee=0,ee|0;for(R=1;;){if(z=Mi(C|0,D|0,(15-R|0)*3|0)|0,Wt()|0,z=z&7,z|0){R=5;break}if(R>>>0<ee>>>0)R=R+1|0;else{z=0,R=5;break}}return(R|0)==5?z|0:0}function qs(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,$e=0;if($e=Mi(C|0,D|0,52)|0,Wt()|0,$e=$e&15,!$e)return we=D,$e=C,Vn(we|0),$e|0;for(we=1,z=0;;){le=(15-we|0)*3|0,R=Bi(7,0,le|0)|0,ee=Wt()|0,oe=Mi(C|0,D|0,le|0)|0,Wt()|0,le=Bi(ca(oe&7)|0,0,le|0)|0,oe=Wt()|0,C=le|C&~R,D=oe|D&~ee;e:do if(!z)if((le&R|0)==0&(oe&ee|0)==0)z=0;else if(R=Mi(C|0,D|0,52)|0,Wt()|0,R=R&15,!R)z=1;else{z=1;t:for(;;){switch(oe=Mi(C|0,D|0,(15-z|0)*3|0)|0,Wt()|0,oe&7){case 1:break t;case 0:break;default:{z=1;break e}}if(z>>>0<R>>>0)z=z+1|0;else{z=1;break e}}for(z=1;;)if(oe=(15-z|0)*3|0,ee=Mi(C|0,D|0,oe|0)|0,Wt()|0,le=Bi(7,0,oe|0)|0,D=D&~(Wt()|0),oe=Bi(ca(ee&7)|0,0,oe|0)|0,C=C&~le|oe,D=D|(Wt()|0),z>>>0<R>>>0)z=z+1|0;else{z=1;break}}while(!1);if(we>>>0<$e>>>0)we=we+1|0;else break}return Vn(D|0),C|0}function $a(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0;if(R=Mi(C|0,D|0,52)|0,Wt()|0,R=R&15,!R)return z=D,R=C,Vn(z|0),R|0;for(z=1;le=(15-z|0)*3|0,oe=Mi(C|0,D|0,le|0)|0,Wt()|0,ee=Bi(7,0,le|0)|0,D=D&~(Wt()|0),le=Bi(ca(oe&7)|0,0,le|0)|0,C=le|C&~ee,D=Wt()|0|D,z>>>0<R>>>0;)z=z+1|0;return Vn(D|0),C|0}function Jo(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,$e=0;if($e=Mi(C|0,D|0,52)|0,Wt()|0,$e=$e&15,!$e)return we=D,$e=C,Vn(we|0),$e|0;for(we=1,z=0;;){le=(15-we|0)*3|0,R=Bi(7,0,le|0)|0,ee=Wt()|0,oe=Mi(C|0,D|0,le|0)|0,Wt()|0,le=Bi(Ys(oe&7)|0,0,le|0)|0,oe=Wt()|0,C=le|C&~R,D=oe|D&~ee;e:do if(!z)if((le&R|0)==0&(oe&ee|0)==0)z=0;else if(R=Mi(C|0,D|0,52)|0,Wt()|0,R=R&15,!R)z=1;else{z=1;t:for(;;){switch(oe=Mi(C|0,D|0,(15-z|0)*3|0)|0,Wt()|0,oe&7){case 1:break t;case 0:break;default:{z=1;break e}}if(z>>>0<R>>>0)z=z+1|0;else{z=1;break e}}for(z=1;;)if(ee=(15-z|0)*3|0,le=Bi(7,0,ee|0)|0,oe=D&~(Wt()|0),D=Mi(C|0,D|0,ee|0)|0,Wt()|0,D=Bi(Ys(D&7)|0,0,ee|0)|0,C=C&~le|D,D=oe|(Wt()|0),z>>>0<R>>>0)z=z+1|0;else{z=1;break}}while(!1);if(we>>>0<$e>>>0)we=we+1|0;else break}return Vn(D|0),C|0}function Yr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0;if(R=Mi(C|0,D|0,52)|0,Wt()|0,R=R&15,!R)return z=D,R=C,Vn(z|0),R|0;for(z=1;oe=(15-z|0)*3|0,le=Bi(7,0,oe|0)|0,ee=D&~(Wt()|0),D=Mi(C|0,D|0,oe|0)|0,Wt()|0,D=Bi(Ys(D&7)|0,0,oe|0)|0,C=D|C&~le,D=Wt()|0|ee,z>>>0<R>>>0;)z=z+1|0;return Vn(D|0),C|0}function mr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0,Ct=0;if($e=Vt,Vt=Vt+64|0,we=$e+40|0,R=$e+24|0,ee=$e+12|0,le=$e,Bi(D|0,0,52)|0,z=Wt()|0|134225919,!D)return(o[C+4>>2]|0)>2||(o[C+8>>2]|0)>2||(o[C+12>>2]|0)>2?(oe=0,we=0,Vn(oe|0),Vt=$e,we|0):(Bi(rt(C)|0,0,45)|0,oe=Wt()|0|z,we=-1,Vn(oe|0),Vt=$e,we|0);if(o[we>>2]=o[C>>2],o[we+4>>2]=o[C+4>>2],o[we+8>>2]=o[C+8>>2],o[we+12>>2]=o[C+12>>2],oe=we+4|0,(D|0)>0)for(C=-1;o[R>>2]=o[oe>>2],o[R+4>>2]=o[oe+4>>2],o[R+8>>2]=o[oe+8>>2],D&1?(Br(oe),o[ee>>2]=o[oe>>2],o[ee+4>>2]=o[oe+4>>2],o[ee+8>>2]=o[oe+8>>2],Zo(ee)):(Eo(oe),o[ee>>2]=o[oe>>2],o[ee+4>>2]=o[oe+4>>2],o[ee+8>>2]=o[oe+8>>2],Bs(ee)),Zs(R,ee,le),nr(le),Ct=(15-D|0)*3|0,_t=Bi(7,0,Ct|0)|0,z=z&~(Wt()|0),Ct=Bi(Ks(le)|0,0,Ct|0)|0,C=Ct|C&~_t,z=Wt()|0|z,(D|0)>1;)D=D+-1|0;else C=-1;e:do if((o[oe>>2]|0)<=2&&(o[we+8>>2]|0)<=2&&(o[we+12>>2]|0)<=2){if(R=rt(we)|0,D=Bi(R|0,0,45)|0,D=D|C,C=Wt()|0|z&-1040385,le=St(we)|0,!(N(R)|0)){if((le|0)<=0)break;for(ee=0;;){if(R=Mi(D|0,C|0,52)|0,Wt()|0,R=R&15,R)for(z=1;Ct=(15-z|0)*3|0,we=Mi(D|0,C|0,Ct|0)|0,Wt()|0,_t=Bi(7,0,Ct|0)|0,C=C&~(Wt()|0),Ct=Bi(ca(we&7)|0,0,Ct|0)|0,D=D&~_t|Ct,C=C|(Wt()|0),z>>>0<R>>>0;)z=z+1|0;if(ee=ee+1|0,(ee|0)==(le|0))break e}}ee=Mi(D|0,C|0,52)|0,Wt()|0,ee=ee&15;t:do if(ee){z=1;i:for(;;){switch(Ct=Mi(D|0,C|0,(15-z|0)*3|0)|0,Wt()|0,Ct&7){case 1:break i;case 0:break;default:break t}if(z>>>0<ee>>>0)z=z+1|0;else break t}if(Li(R,o[we>>2]|0)|0)for(z=1;we=(15-z|0)*3|0,_t=Bi(7,0,we|0)|0,Ct=C&~(Wt()|0),C=Mi(D|0,C|0,we|0)|0,Wt()|0,C=Bi(Ys(C&7)|0,0,we|0)|0,D=D&~_t|C,C=Ct|(Wt()|0),z>>>0<ee>>>0;)z=z+1|0;else for(z=1;Ct=(15-z|0)*3|0,we=Mi(D|0,C|0,Ct|0)|0,Wt()|0,_t=Bi(7,0,Ct|0)|0,C=C&~(Wt()|0),Ct=Bi(ca(we&7)|0,0,Ct|0)|0,D=D&~_t|Ct,C=C|(Wt()|0),z>>>0<ee>>>0;)z=z+1|0}while(!1);if((le|0)>0){z=0;do D=qs(D,C)|0,C=Wt()|0,z=z+1|0;while((z|0)!=(le|0))}}else D=0,C=0;while(!1);return _t=C,Ct=D,Vn(_t|0),Vt=$e,Ct|0}function Nr(C){return C=C|0,(C|0)%2|0|0}function ha(C,D){C=C|0,D=D|0;var z=0,R=0;return R=Vt,Vt=Vt+16|0,z=R,D>>>0<=15&&(o[C+4>>2]&2146435072|0)!=2146435072&&(o[C+8+4>>2]&2146435072|0)!=2146435072?(ac(C,D,z),D=mr(z,D)|0,C=Wt()|0):(C=0,D=0),Vn(C|0),Vt=R,D|0}function _o(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0;if(ee=z+4|0,le=Mi(C|0,D|0,52)|0,Wt()|0,le=le&15,oe=Mi(C|0,D|0,45)|0,Wt()|0,R=(le|0)==0,N(oe&127)|0){if(R)return oe=1,oe|0;R=1}else{if(R)return oe=0,oe|0;!(o[ee>>2]|0)&&!(o[z+8>>2]|0)?R=(o[z+12>>2]|0)!=0&1:R=1}for(z=1;z&1?Zo(ee):Bs(ee),oe=Mi(C|0,D|0,(15-z|0)*3|0)|0,Wt()|0,Il(ee,oe&7),z>>>0<le>>>0;)z=z+1|0;return R|0}function ea(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0,Ct=0;Ct=Vt,Vt=Vt+16|0,$e=Ct,_t=Mi(C|0,D|0,45)|0,Wt()|0,_t=_t&127;e:do if(N(_t)|0&&(le=Mi(C|0,D|0,52)|0,Wt()|0,le=le&15,(le|0)!=0)){R=1;t:for(;;){switch(we=Mi(C|0,D|0,(15-R|0)*3|0)|0,Wt()|0,we&7){case 5:break t;case 0:break;default:{R=D;break e}}if(R>>>0<le>>>0)R=R+1|0;else{R=D;break e}}for(ee=1,R=D;D=(15-ee|0)*3|0,oe=Bi(7,0,D|0)|0,we=R&~(Wt()|0),R=Mi(C|0,R|0,D|0)|0,Wt()|0,R=Bi(Ys(R&7)|0,0,D|0)|0,C=C&~oe|R,R=we|(Wt()|0),ee>>>0<le>>>0;)ee=ee+1|0}else R=D;while(!1);if(we=7728+(_t*28|0)|0,o[z>>2]=o[we>>2],o[z+4>>2]=o[we+4>>2],o[z+8>>2]=o[we+8>>2],o[z+12>>2]=o[we+12>>2],!(_o(C,R,z)|0)){Vt=Ct;return}if(oe=z+4|0,o[$e>>2]=o[oe>>2],o[$e+4>>2]=o[oe+4>>2],o[$e+8>>2]=o[oe+8>>2],le=Mi(C|0,R|0,52)|0,Wt()|0,we=le&15,le&1?(Bs(oe),le=we+1|0):le=we,!(N(_t)|0))R=0;else{e:do if(!we)R=0;else for(D=1;;){if(ee=Mi(C|0,R|0,(15-D|0)*3|0)|0,Wt()|0,ee=ee&7,ee|0){R=ee;break e}if(D>>>0<we>>>0)D=D+1|0;else{R=0;break}}while(!1);R=(R|0)==4&1}if(!(Co(z,le,R,0)|0))(le|0)!=(we|0)&&(o[oe>>2]=o[$e>>2],o[oe+4>>2]=o[$e+4>>2],o[oe+8>>2]=o[$e+8>>2]);else{if(N(_t)|0)do;while(Co(z,le,0,0)|0);(le|0)!=(we|0)&&Eo(oe)}Vt=Ct}function Sa(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;R=Vt,Vt=Vt+16|0,ee=R,ea(C,D,ee),D=Mi(C|0,D|0,52)|0,Wt()|0,Ql(ee,D&15,z),Vt=R}function ka(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0;oe=Vt,Vt=Vt+16|0,le=oe,ea(C,D,le),R=Mi(C|0,D|0,45)|0,Wt()|0,R=(N(R&127)|0)==0,ee=Mi(C|0,D|0,52)|0,Wt()|0,ee=ee&15;e:do if(!R){if(ee|0)for(R=1;;){if(we=Bi(7,0,(15-R|0)*3|0)|0,!((we&C|0)==0&((Wt()|0)&D|0)==0))break e;if(R>>>0<ee>>>0)R=R+1|0;else break}Oo(le,ee,0,5,z),Vt=oe;return}while(!1);$o(le,ee,0,6,z),Vt=oe}function Xa(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;if(R=Mi(C|0,D|0,45)|0,Wt()|0,!(N(R&127)|0))return R=2,R|0;if(R=Mi(C|0,D|0,52)|0,Wt()|0,R=R&15,!R)return R=5,R|0;for(z=1;;){if(ee=Bi(7,0,(15-z|0)*3|0)|0,!((ee&C|0)==0&((Wt()|0)&D|0)==0)){z=2,C=6;break}if(z>>>0<R>>>0)z=z+1|0;else{z=5,C=6;break}}return(C|0)==6?z|0:0}function cl(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0;ni=Vt,Vt=Vt+128|0,_t=ni+112|0,le=ni+96|0,Ct=ni,ee=Mi(C|0,D|0,52)|0,Wt()|0,we=ee&15,o[_t>>2]=we,oe=Mi(C|0,D|0,45)|0,Wt()|0,oe=oe&127;e:do if(N(oe)|0){if(we|0)for(R=1;;){if($e=Bi(7,0,(15-R|0)*3|0)|0,!(($e&C|0)==0&((Wt()|0)&D|0)==0)){ee=0;break e}if(R>>>0<we>>>0)R=R+1|0;else break}if(ee&1)ee=1;else{$e=Bi(we+1|0,0,52)|0,Ct=Wt()|0|D&-15728641,_t=Bi(7,0,(14-we|0)*3|0)|0,cl(($e|C)&~_t,Ct&~(Wt()|0),z),Vt=ni;return}}else ee=0;while(!1);ea(C,D,le),ee?(Wo(le,_t,Ct),$e=5):(Xo(le,_t,Ct),$e=6);e:do if(N(oe)|0)if(!we)R=20;else for(R=1;;){if(oe=Bi(7,0,(15-R|0)*3|0)|0,!((oe&C|0)==0&((Wt()|0)&D|0)==0)){R=8;break e}if(R>>>0<we>>>0)R=R+1|0;else{R=20;break}}else R=8;while(!1);if(fs(z|0,-1,R|0)|0,ee){ee=0;do{for(le=Ct+(ee<<4)|0,Gs(le,o[_t>>2]|0)|0,le=o[le>>2]|0,R=0;oe=z+(R<<2)|0,we=o[oe>>2]|0,!((we|0)==-1|(we|0)==(le|0));)R=R+1|0;o[oe>>2]=le,ee=ee+1|0}while((ee|0)!=($e|0))}else{ee=0;do{for(le=Ct+(ee<<4)|0,Co(le,o[_t>>2]|0,0,1)|0,le=o[le>>2]|0,R=0;oe=z+(R<<2)|0,we=o[oe>>2]|0,!((we|0)==-1|(we|0)==(le|0));)R=R+1|0;o[oe>>2]=le,ee=ee+1|0}while((ee|0)!=($e|0))}Vt=ni}function lu(){return 12}function gl(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,$e=0;if(Bi(C|0,0,52)|0,we=Wt()|0|134225919,(C|0)<1){R=0,z=0;do N(R)|0&&(Bi(R|0,0,45)|0,oe=we|(Wt()|0),C=D+(z<<3)|0,o[C>>2]=-1,o[C+4>>2]=oe,z=z+1|0),R=R+1|0;while((R|0)!=122);return}oe=0,z=0;do{if(N(oe)|0){for(Bi(oe|0,0,45)|0,R=1,ee=-1,le=we|(Wt()|0);$e=Bi(7,0,(15-R|0)*3|0)|0,ee=ee&~$e,le=le&~(Wt()|0),(R|0)!=(C|0);)R=R+1|0;$e=D+(z<<3)|0,o[$e>>2]=ee,o[$e+4>>2]=le,z=z+1|0}oe=oe+1|0}while((oe|0)!=122)}function ao(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,$e=0,_t=0;if(we=Vt,Vt=Vt+64|0,oe=we,(C|0)==(z|0)&(D|0)==(R|0)|(!1|(D&2013265920|0)!=134217728|(!1|(R&2013265920|0)!=134217728))||(ee=Mi(C|0,D|0,52)|0,Wt()|0,ee=ee&15,le=Mi(z|0,R|0,52)|0,Wt()|0,(ee|0)!=(le&15|0)))return oe=0,Vt=we,oe|0;if(le=ee+-1|0,ee>>>0>1&&(_t=ko(C,D,le)|0,$e=Wt()|0,le=ko(z,R,le)|0,(_t|0)==(le|0)&($e|0)==(Wt()|0))&&(le=(ee^15)*3|0,ee=Mi(C|0,D|0,le|0)|0,Wt()|0,ee=ee&7,le=Mi(z|0,R|0,le|0)|0,Wt()|0,le=le&7,(ee|0)==0|(le|0)==0||(o[21136+(ee<<2)>>2]|0)==(le|0)||(o[21168+(ee<<2)>>2]|0)==(le|0)))return _t=1,Vt=we,_t|0;ee=oe,le=ee+56|0;do o[ee>>2]=0,ee=ee+4|0;while((ee|0)<(le|0));return Na(C,D,1,oe),_t=oe,!((o[_t>>2]|0)==(z|0)&&(o[_t+4>>2]|0)==(R|0))&&(_t=oe+8|0,!((o[_t>>2]|0)==(z|0)&&(o[_t+4>>2]|0)==(R|0)))&&(_t=oe+16|0,!((o[_t>>2]|0)==(z|0)&&(o[_t+4>>2]|0)==(R|0)))&&(_t=oe+24|0,!((o[_t>>2]|0)==(z|0)&&(o[_t+4>>2]|0)==(R|0)))&&(_t=oe+32|0,!((o[_t>>2]|0)==(z|0)&&(o[_t+4>>2]|0)==(R|0)))&&(_t=oe+40|0,!((o[_t>>2]|0)==(z|0)&&(o[_t+4>>2]|0)==(R|0)))?(ee=oe+48|0,ee=((o[ee>>2]|0)==(z|0)?(o[ee+4>>2]|0)==(R|0):0)&1):ee=1,_t=ee,Vt=we,_t|0}function pi(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,$e=0,_t=0,Ct=0;if(_t=Vt,Vt=Vt+16|0,oe=_t,!(ao(C,D,z,R)|0))return we=0,$e=0,Vn(we|0),Vt=_t,$e|0;for(we=D&-2130706433,ee=(ds(C,D)|0)==0,ee=ee?1:2;o[oe>>2]=0,Ct=Zn(C,D,ee,oe)|0,le=ee+1|0,!((Ct|0)==(z|0)&(Wt()|0)==(R|0));)if(le>>>0<7)ee=le;else{ee=0,C=0,$e=6;break}return($e|0)==6?(Vn(ee|0),Vt=_t,C|0):(Ct=Bi(ee|0,0,56)|0,$e=we|(Wt()|0)|268435456,Ct=C|Ct,Vn($e|0),Vt=_t,Ct|0)}function Ui(C,D){C=C|0,D=D|0;var z=0;return z=!0&(D&2013265920|0)==268435456,Vn((z?D&-2130706433|134217728:0)|0),(z?C:0)|0}function Di(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;return R=Vt,Vt=Vt+16|0,z=R,!0&(D&2013265920|0)==268435456?(ee=Mi(C|0,D|0,56)|0,Wt()|0,o[z>>2]=0,z=Zn(C,D&-2130706433|134217728,ee&7,z)|0,D=Wt()|0,Vn(D|0),Vt=R,z|0):(D=0,z=0,Vn(D|0),Vt=R,z|0)}function Ft(C,D){C=C|0,D=D|0;var z=0;if(!(!0&(D&2013265920|0)==268435456))return z=0,z|0;switch(z=Mi(C|0,D|0,56)|0,Wt()|0,z&7){case 0:case 7:return z=0,z|0}return z=D&-2130706433|134217728,!0&(D&117440512|0)==16777216&(ds(C,z)|0)!=0?(z=0,z|0):(z=Xr(C,z)|0,z|0)}function ii(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0;le=Vt,Vt=Vt+16|0,R=le,oe=!0&(D&2013265920|0)==268435456,ee=D&-2130706433|134217728,we=z,o[we>>2]=oe?C:0,o[we+4>>2]=oe?ee:0,oe?(D=Mi(C|0,D|0,56)|0,Wt()|0,o[R>>2]=0,C=Zn(C,ee,D&7,R)|0,D=Wt()|0):(C=0,D=0),we=z+8|0,o[we>>2]=C,o[we+4>>2]=D,Vt=le}function bi(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;ee=(ds(C,D)|0)==0,D=D&-2130706433,R=z,o[R>>2]=ee?C:0,o[R+4>>2]=ee?D|285212672:0,R=z+8|0,o[R>>2]=C,o[R+4>>2]=D|301989888,R=z+16|0,o[R>>2]=C,o[R+4>>2]=D|318767104,R=z+24|0,o[R>>2]=C,o[R+4>>2]=D|335544320,R=z+32|0,o[R>>2]=C,o[R+4>>2]=D|352321536,z=z+40|0,o[z>>2]=C,o[z+4>>2]=D|369098752}function Fi(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0;if(oe=Vt,Vt=Vt+16|0,le=oe,R=Mi(C|0,D|0,56)|0,Wt()|0,we=!0&(D&2013265920|0)==268435456,ee=we?C:0,C=we?D&-2130706433|134217728:0,D=$l(ee,C,R&7)|0,(D|0)==-1){o[z>>2]=0,Vt=oe;return}ea(ee,C,le),R=Mi(ee|0,C|0,52)|0,Wt()|0,R=R&15,ds(ee,C)|0?Oo(le,R,D,2,z):$o(le,R,D,2,z),Vt=oe}function Bn(C){C=C|0;var D=0,z=0,R=0;return D=tl(1,12)|0,D||Ki(22691,22646,49,22704),z=C+4|0,R=o[z>>2]|0,R|0?(R=R+8|0,o[R>>2]=D,o[z>>2]=D,D|0):(o[C>>2]|0&&Ki(22721,22646,61,22744),R=C,o[R>>2]=D,o[z>>2]=D,D|0)}function Hn(C,D){C=C|0,D=D|0;var z=0,R=0;return R=jn(24)|0,R||Ki(22758,22646,78,22772),o[R>>2]=o[D>>2],o[R+4>>2]=o[D+4>>2],o[R+8>>2]=o[D+8>>2],o[R+12>>2]=o[D+12>>2],o[R+16>>2]=0,D=C+4|0,z=o[D>>2]|0,z|0?(o[z+16>>2]=R,o[D>>2]=R,R|0):(o[C>>2]|0&&Ki(22787,22646,82,22772),o[C>>2]=R,o[D>>2]=R,R|0)}function lr(C){C=C|0;var D=0,z=0,R=0,ee=0;if(C)for(R=1;;){if(D=o[C>>2]|0,D|0)do{if(z=o[D>>2]|0,z|0)do ee=z,z=o[z+16>>2]|0,Jn(ee);while(z|0);ee=D,D=o[D+8>>2]|0,Jn(ee)}while(D|0);if(D=C,C=o[C+8>>2]|0,R||Jn(D),C)R=0;else break}}function Xn(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0,ce=0,Se=0;if(ee=C+8|0,o[ee>>2]|0)return Se=1,Se|0;if(R=o[C>>2]|0,!R)return Se=0,Se|0;D=R,z=0;do z=z+1|0,D=o[D+8>>2]|0;while(D|0);if(z>>>0<2)return Se=0,Se|0;X=jn(z<<2)|0,X||Ki(22807,22646,317,22826),j=jn(z<<5)|0,j||Ki(22848,22646,321,22826),o[C>>2]=0,r=C+4|0,o[r>>2]=0,o[ee>>2]=0,z=0,B=0,i=0,ni=0;e:for(;;){if(Ct=o[R>>2]|0,Ct){le=0,oe=Ct;do{if($e=+ke[oe+8>>3],D=oe,oe=o[oe+16>>2]|0,_t=(oe|0)==0,ee=_t?Ct:oe,we=+ke[ee+8>>3],+hi(+($e-we))>3.141592653589793){Se=14;break}le=le+(we-$e)*(+ke[D>>3]+ +ke[ee>>3])}while(!_t);if((Se|0)==14){Se=0,le=0,D=Ct;do s=+ke[D+8>>3],T=D+16|0,w=o[T>>2]|0,w=w|0?w:Ct,y=+ke[w+8>>3],le=le+(+ke[D>>3]+ +ke[w>>3])*((y<0?y+6.283185307179586:y)-(s<0?s+6.283185307179586:s)),D=o[(D|0?T:R)>>2]|0;while(D|0)}le>0?(o[X+(B<<2)>>2]=R,B=B+1|0,ee=i,D=ni):Se=19}else Se=19;if((Se|0)==19){Se=0;do if(z){if(D=z+8|0,o[D>>2]|0){Se=21;break e}if(z=tl(1,12)|0,!z){Se=23;break e}o[D>>2]=z,ee=z+4|0,oe=z,D=ni}else if(ni){ee=r,oe=ni+8|0,D=R,z=C;break}else if(o[C>>2]|0){Se=27;break e}else{ee=r,oe=C,D=R,z=C;break}while(!1);if(o[oe>>2]=R,o[ee>>2]=R,oe=j+(i<<5)|0,_t=o[R>>2]|0,_t){for(Ct=j+(i<<5)+8|0,ke[Ct>>3]=17976931348623157e292,ni=j+(i<<5)+24|0,ke[ni>>3]=17976931348623157e292,ke[oe>>3]=-17976931348623157e292,Gt=j+(i<<5)+16|0,ke[Gt>>3]=-17976931348623157e292,F=17976931348623157e292,O=-17976931348623157e292,ee=0,Zt=_t,$e=17976931348623157e292,A=17976931348623157e292,E=-17976931348623157e292,we=-17976931348623157e292;le=+ke[Zt>>3],s=+ke[Zt+8>>3],Zt=o[Zt+16>>2]|0,Z=(Zt|0)==0,y=+ke[(Z?_t:Zt)+8>>3],le<$e&&(ke[Ct>>3]=le,$e=le),s<A&&(ke[ni>>3]=s,A=s),le>E?ke[oe>>3]=le:le=E,s>we&&(ke[Gt>>3]=s,we=s),F=s>0&s<F?s:F,O=s<0&s>O?s:O,ee=ee|+hi(+(s-y))>3.141592653589793,!Z;)E=le;ee&&(ke[Gt>>3]=O,ke[ni>>3]=F)}else o[oe>>2]=0,o[oe+4>>2]=0,o[oe+8>>2]=0,o[oe+12>>2]=0,o[oe+16>>2]=0,o[oe+20>>2]=0,o[oe+24>>2]=0,o[oe+28>>2]=0;ee=i+1|0}if(T=R+8|0,R=o[T>>2]|0,o[T>>2]=0,R)i=ee,ni=D;else{Se=45;break}}if((Se|0)==21)Ki(22624,22646,35,22658);else if((Se|0)==23)Ki(22678,22646,37,22658);else if((Se|0)==27)Ki(22721,22646,61,22744);else if((Se|0)==45){e:do if((B|0)>0){for(T=(ee|0)==0,_=ee<<2,w=(C|0)==0,d=0,D=0;;){if(l=o[X+(d<<2)>>2]|0,T)Se=73;else{if(i=jn(_)|0,!i){Se=50;break}if(r=jn(_)|0,!r){Se=52;break}t:do if(w)z=0;else{for(ee=0,z=0,oe=C;R=j+(ee<<5)|0,Hs(o[oe>>2]|0,R,o[l>>2]|0)|0?(o[i+(z<<2)>>2]=oe,o[r+(z<<2)>>2]=R,Z=z+1|0):Z=z,oe=o[oe+8>>2]|0,oe;)ee=ee+1|0,z=Z;if((Z|0)>0)if(R=o[i>>2]|0,(Z|0)==1)z=R;else for(Gt=0,Zt=-1,z=R,ni=R;;){for(_t=o[ni>>2]|0,R=0,oe=0;ee=o[o[i+(oe<<2)>>2]>>2]|0,(ee|0)==(_t|0)?Ct=R:Ct=R+((Hs(ee,o[r+(oe<<2)>>2]|0,o[_t>>2]|0)|0)&1)|0,oe=oe+1|0,(oe|0)!=(Z|0);)R=Ct;if(ee=(Ct|0)>(Zt|0),z=ee?ni:z,R=Gt+1|0,(R|0)==(Z|0))break t;Gt=R,Zt=ee?Ct:Zt,ni=o[i+(R<<2)>>2]|0}else z=0}while(!1);if(Jn(i),Jn(r),z){if(ee=z+4|0,R=o[ee>>2]|0,R)z=R+8|0;else if(o[z>>2]|0){Se=70;break}o[z>>2]=l,o[ee>>2]=l}else Se=73}if((Se|0)==73){if(Se=0,D=o[l>>2]|0,D|0)do r=D,D=o[D+16>>2]|0,Jn(r);while(D|0);Jn(l),D=2}if(d=d+1|0,(d|0)>=(B|0)){ce=D;break e}}(Se|0)==50?Ki(22863,22646,249,22882):(Se|0)==52?Ki(22901,22646,252,22882):(Se|0)==70&&Ki(22721,22646,61,22744)}else ce=0;while(!1);return Jn(X),Jn(j),Se=ce,Se|0}return 0}function Hs(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0,Ct=0;if(!(qa(D,z)|0)||(D=Or(D)|0,_t=+ke[z>>3],R=+ke[z+8>>3],R=D&R<0?R+6.283185307179586:R,C=o[C>>2]|0,!C))return C=0,C|0;if(D){D=0,z=C;e:for(;;){for(;oe=+ke[z>>3],$e=+ke[z+8>>3],z=z+16|0,Ct=o[z>>2]|0,Ct=Ct|0?Ct:C,le=+ke[Ct>>3],ee=+ke[Ct+8>>3],oe>le?(we=oe,oe=$e):(we=le,le=oe,oe=ee,ee=$e),!!(_t<le|_t>we);)if(z=o[z>>2]|0,!z){z=22;break e}if($e=ee<0?ee+6.283185307179586:ee,oe=oe<0?oe+6.283185307179586:oe,R=oe==R|$e==R?R+-2220446049250313e-31:R,$e=$e+(_t-le)/(we-le)*(oe-$e),($e<0?$e+6.283185307179586:$e)>R&&(D=D^1),z=o[z>>2]|0,!z){z=22;break}}if((z|0)==22)return D|0}else{D=0,z=C;e:for(;;){for(;oe=+ke[z>>3],$e=+ke[z+8>>3],z=z+16|0,Ct=o[z>>2]|0,Ct=Ct|0?Ct:C,le=+ke[Ct>>3],ee=+ke[Ct+8>>3],oe>le?(we=oe,oe=$e):(we=le,le=oe,oe=ee,ee=$e),!!(_t<le|_t>we);)if(z=o[z>>2]|0,!z){z=22;break e}if(R=oe==R|ee==R?R+-2220446049250313e-31:R,ee+(_t-le)/(we-le)*(oe-ee)>R&&(D=D^1),z=o[z>>2]|0,!z){z=22;break}}if((z|0)==22)return D|0}return 0}function ks(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0;if(O=Vt,Vt=Vt+32|0,F=O+16|0,E=O,le=Mi(C|0,D|0,52)|0,Wt()|0,le=le&15,Zt=Mi(z|0,R|0,52)|0,Wt()|0,(le|0)!=(Zt&15|0))return F=1,Vt=O,F|0;if(_t=Mi(C|0,D|0,45)|0,Wt()|0,_t=_t&127,Ct=Mi(z|0,R|0,45)|0,Wt()|0,Ct=Ct&127,Zt=(_t|0)!=(Ct|0),Zt){if(we=pn(_t,Ct)|0,(we|0)==7)return F=2,Vt=O,F|0;$e=pn(Ct,_t)|0,($e|0)==7?Ki(22925,22949,151,22959):(Z=we,oe=$e)}else Z=0,oe=0;ni=N(_t)|0,Gt=N(Ct)|0,o[F>>2]=0,o[F+4>>2]=0,o[F+8>>2]=0,o[F+12>>2]=0;do if(Z){if(Ct=o[4304+(_t*28|0)+(Z<<2)>>2]|0,we=(Ct|0)>0,Gt)if(we){_t=0,$e=z,we=R;do $e=Jo($e,we)|0,we=Wt()|0,oe=Ys(oe)|0,(oe|0)==1&&(oe=Ys(1)|0),_t=_t+1|0;while((_t|0)!=(Ct|0));Ct=oe,_t=$e,$e=we}else Ct=oe,_t=z,$e=R;else if(we){_t=0,$e=z,we=R;do $e=Yr($e,we)|0,we=Wt()|0,oe=Ys(oe)|0,_t=_t+1|0;while((_t|0)!=(Ct|0));Ct=oe,_t=$e,$e=we}else Ct=oe,_t=z,$e=R;if(_o(_t,$e,F)|0,Zt||Ki(22972,22949,181,22959),we=(ni|0)!=0,oe=(Gt|0)!=0,we&oe&&Ki(22999,22949,182,22959),we){if(oe=Js(C,D)|0,kt[22032+(oe*7|0)+Z>>0]|0){le=3;break}$e=o[21200+(oe*28|0)+(Z<<2)>>2]|0,_t=$e,A=26}else if(oe){if(oe=Js(_t,$e)|0,kt[22032+(oe*7|0)+Ct>>0]|0){le=4;break}_t=0,$e=o[21200+(Ct*28|0)+(oe<<2)>>2]|0,A=26}else oe=0;if((A|0)==26)if(($e|0)<=-1&&Ki(23030,22949,212,22959),(_t|0)<=-1&&Ki(23053,22949,213,22959),($e|0)>0){we=F+4|0,oe=0;do Qo(we),oe=oe+1|0;while((oe|0)!=($e|0));oe=_t}else oe=_t;if(o[E>>2]=0,o[E+4>>2]=0,o[E+8>>2]=0,Il(E,Z),le|0)for(;Nr(le)|0?Zo(E):Bs(E),(le|0)>1;)le=le+-1|0;if((oe|0)>0){le=0;do Qo(E),le=le+1|0;while((le|0)!=(oe|0))}A=F+4|0,Lr(A,E,A),nr(A),A=50}else if(_o(z,R,F)|0,(ni|0)!=0&(Gt|0)!=0)if((Ct|0)!=(_t|0)&&Ki(23077,22949,243,22959),oe=Js(C,D)|0,le=Js(z,R)|0,kt[22032+(oe*7|0)+le>>0]|0)le=5;else if(oe=o[21200+(oe*28|0)+(le<<2)>>2]|0,(oe|0)>0){we=F+4|0,le=0;do Qo(we),le=le+1|0;while((le|0)!=(oe|0));A=50}else A=50;else A=50;while(!1);return(A|0)==50&&(le=F+4|0,o[ee>>2]=o[le>>2],o[ee+4>>2]=o[le+4>>2],o[ee+8>>2]=o[le+8>>2],le=0),F=le,Vt=O,F|0}function ps(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0;if(Z=Vt,Vt=Vt+48|0,oe=Z+36|0,we=Z+24|0,$e=Z+12|0,_t=Z,le=Mi(C|0,D|0,52)|0,Wt()|0,le=le&15,Gt=Mi(C|0,D|0,45)|0,Wt()|0,Gt=Gt&127,Ct=N(Gt)|0,Bi(le|0,0,52)|0,E=Wt()|0|134225919,A=R,o[A>>2]=-1,o[A+4>>2]=E,!le)return(o[z>>2]|0)>1||(o[z+4>>2]|0)>1||(o[z+8>>2]|0)>1||(ee=An(Gt,Ks(z)|0)|0,(ee|0)==127)?(E=1,Vt=Z,E|0):(Zt=Bi(ee|0,0,45)|0,A=Wt()|0,Gt=R,A=o[Gt+4>>2]&-1040385|A,E=R,o[E>>2]=o[Gt>>2]|Zt,o[E+4>>2]=A,E=0,Vt=Z,E|0);for(o[oe>>2]=o[z>>2],o[oe+4>>2]=o[z+4>>2],o[oe+8>>2]=o[z+8>>2];o[we>>2]=o[oe>>2],o[we+4>>2]=o[oe+4>>2],o[we+8>>2]=o[oe+8>>2],Nr(le)|0?(Br(oe),o[$e>>2]=o[oe>>2],o[$e+4>>2]=o[oe+4>>2],o[$e+8>>2]=o[oe+8>>2],Zo($e)):(Eo(oe),o[$e>>2]=o[oe>>2],o[$e+4>>2]=o[oe+4>>2],o[$e+8>>2]=o[oe+8>>2],Bs($e)),Zs(we,$e,_t),nr(_t),A=R,F=o[A>>2]|0,A=o[A+4>>2]|0,O=(15-le|0)*3|0,z=Bi(7,0,O|0)|0,A=A&~(Wt()|0),O=Bi(Ks(_t)|0,0,O|0)|0,A=Wt()|0|A,E=R,o[E>>2]=O|F&~z,o[E+4>>2]=A,(le|0)>1;)le=le+-1|0;e:do if((o[oe>>2]|0)<=1&&(o[oe+4>>2]|0)<=1&&(o[oe+8>>2]|0)<=1){le=Ks(oe)|0,we=An(Gt,le)|0,(we|0)==127?_t=0:_t=N(we)|0;t:do if(le){if(Ct){if(oe=21408+((Js(C,D)|0)*28|0)+(le<<2)|0,oe=o[oe>>2]|0,(oe|0)>0){z=0;do le=ca(le)|0,z=z+1|0;while((z|0)!=(oe|0))}if((le|0)==1){ee=3;break e}z=An(Gt,le)|0,(z|0)==127&&Ki(23104,22949,376,23134),N(z)|0?Ki(23147,22949,377,23134):(Zt=oe,ni=le,ee=z)}else Zt=0,ni=le,ee=we;if($e=o[4304+(Gt*28|0)+(ni<<2)>>2]|0,($e|0)<=-1&&Ki(23178,22949,384,23134),!_t){if((Zt|0)<=-1&&Ki(23030,22949,417,23134),Zt|0){oe=R,le=0,z=o[oe>>2]|0,oe=o[oe+4>>2]|0;do z=$a(z,oe)|0,oe=Wt()|0,O=R,o[O>>2]=z,o[O+4>>2]=oe,le=le+1|0;while((le|0)<(Zt|0))}if(($e|0)<=0){le=54;break}for(oe=R,le=0,z=o[oe>>2]|0,oe=o[oe+4>>2]|0;;)if(z=$a(z,oe)|0,oe=Wt()|0,O=R,o[O>>2]=z,o[O+4>>2]=oe,le=le+1|0,(le|0)==($e|0)){le=54;break t}}if(we=pn(ee,Gt)|0,(we|0)==7&&Ki(22925,22949,393,23134),le=R,z=o[le>>2]|0,le=o[le+4>>2]|0,($e|0)>0){oe=0;do z=$a(z,le)|0,le=Wt()|0,O=R,o[O>>2]=z,o[O+4>>2]=le,oe=oe+1|0;while((oe|0)!=($e|0))}if(z=Js(z,le)|0,O=xe(ee)|0,z=o[(O?21824:21616)+(we*28|0)+(z<<2)>>2]|0,(z|0)<=-1&&Ki(23030,22949,412,23134),!z)le=54;else{we=R,le=0,oe=o[we>>2]|0,we=o[we+4>>2]|0;do oe=qs(oe,we)|0,we=Wt()|0,O=R,o[O>>2]=oe,o[O+4>>2]=we,le=le+1|0;while((le|0)<(z|0));le=54}}else if((Ct|0)!=0&(_t|0)!=0)if(O=Js(C,D)|0,le=R,le=21408+(O*28|0)+((Js(o[le>>2]|0,o[le+4>>2]|0)|0)<<2)|0,le=o[le>>2]|0,(le|0)<=-1&&Ki(23201,22949,433,23134),!le)ee=we,le=55;else{oe=R,ee=0,z=o[oe>>2]|0,oe=o[oe+4>>2]|0;do z=$a(z,oe)|0,oe=Wt()|0,O=R,o[O>>2]=z,o[O+4>>2]=oe,ee=ee+1|0;while((ee|0)<(le|0));ee=we,le=54}else ee=we,le=54;while(!1);if((le|0)==54&&_t&&(le=55),(le|0)==55&&(O=R,(Js(o[O>>2]|0,o[O+4>>2]|0)|0)==1)){ee=4;break}O=R,E=o[O>>2]|0,O=o[O+4>>2]&-1040385,F=Bi(ee|0,0,45)|0,O=O|(Wt()|0),ee=R,o[ee>>2]=E|F,o[ee+4>>2]=O,ee=0}else ee=2;while(!1);return O=ee,Vt=Z,O|0}function Ya(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0;return oe=Vt,Vt=Vt+16|0,le=oe,C=ks(C,D,z,R,le)|0,C||(ml(le,ee),C=0),Vt=oe,C|0}function yo(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0;return ee=Vt,Vt=Vt+16|0,le=ee,Cl(z,le),R=ps(C,D,le,R)|0,Vt=ee,R|0}function rs(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0;return oe=Vt,Vt=Vt+32|0,ee=oe+12|0,le=oe,!(ks(C,D,C,D,ee)|0)&&!(ks(C,D,z,R,le)|0)?C=Ta(ee,le)|0:C=-1,Vt=oe,C|0}function Wu(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0;return oe=Vt,Vt=Vt+32|0,ee=oe+12|0,le=oe,!(ks(C,D,C,D,ee)|0)&&!(ks(C,D,z,R,le)|0)?C=Ta(ee,le)|0:C=-1,Vt=oe,(C>>>31^1)+C|0}function Ru(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0;if(i=Vt,Vt=Vt+48|0,le=i+24|0,oe=i+12|0,s=i,!(ks(C,D,C,D,le)|0)&&!(ks(C,D,z,R,oe)|0)){if(y=Ta(le,oe)|0,(y|0)<0)return s=y,Vt=i,s|0;for(o[le>>2]=0,o[le+4>>2]=0,o[le+8>>2]=0,o[oe>>2]=0,o[oe+4>>2]=0,o[oe+8>>2]=0,ks(C,D,C,D,le)|0,ks(C,D,z,R,oe)|0,mu(le),mu(oe),y?(Ct=o[le>>2]|0,Zt=+(y|0),E=le+4|0,ni=o[E>>2]|0,F=le+8|0,Gt=o[F>>2]|0,O=le,z=Ct,R=ni,le=Gt,Z=+((o[oe>>2]|0)-Ct|0)/Zt,A=+((o[oe+4>>2]|0)-ni|0)/Zt,Zt=+((o[oe+8>>2]|0)-Gt|0)/Zt):(R=le+4|0,Gt=le+8|0,E=R,F=Gt,O=le,z=o[le>>2]|0,R=o[R>>2]|0,le=o[Gt>>2]|0,Z=0,A=0,Zt=0),o[s>>2]=z,Gt=s+4|0,o[Gt>>2]=R,ni=s+8|0,o[ni>>2]=le,Ct=0;;){$e=+(Ct|0),r=Z*$e+ +(z|0),we=A*$e+ +(o[E>>2]|0),$e=Zt*$e+ +(o[F>>2]|0),R=~~+vu(+r),oe=~~+vu(+we),z=~~+vu(+$e),r=+hi(+(+(R|0)-r)),we=+hi(+(+(oe|0)-we)),$e=+hi(+(+(z|0)-$e));do if(r>we&r>$e)R=0-(oe+z)|0,le=oe;else if(_t=0-R|0,we>$e){le=_t-z|0;break}else{le=oe,z=_t-oe|0;break}while(!1);if(o[s>>2]=R,o[Gt>>2]=le,o[ni>>2]=z,As(s),ps(C,D,s,ee+(Ct<<3)|0)|0,(Ct|0)==(y|0))break;Ct=Ct+1|0,z=o[O>>2]|0}return s=0,Vt=i,s|0}return s=-1,Vt=i,s|0}function vo(C,D){C=C|0,D=D|0;var z=0;if(!D)return z=1,z|0;z=C,C=1;do C=jr(D&1|0?z:1,C)|0,D=D>>1,z=jr(z,z)|0;while(D|0);return C|0}function Ml(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0;if(!(qa(D,z)|0)||(D=Or(D)|0,Gt=+ke[z>>3],R=+ke[z+8>>3],R=D&R<0?R+6.283185307179586:R,ni=o[C>>2]|0,(ni|0)<=0))return ni=0,ni|0;if(Ct=o[C+4>>2]|0,D){D=0,z=-1,C=0;e:for(;;){for(_t=C;oe=+ke[Ct+(_t<<4)>>3],$e=+ke[Ct+(_t<<4)+8>>3],C=(z+2|0)%(ni|0)|0,le=+ke[Ct+(C<<4)>>3],ee=+ke[Ct+(C<<4)+8>>3],oe>le?(we=oe,oe=$e):(we=le,le=oe,oe=ee,ee=$e),!!(Gt<le|Gt>we);)if(z=_t+1|0,(z|0)<(ni|0))C=_t,_t=z,z=C;else{z=22;break e}if($e=ee<0?ee+6.283185307179586:ee,oe=oe<0?oe+6.283185307179586:oe,R=oe==R|$e==R?R+-2220446049250313e-31:R,$e=$e+(Gt-le)/(we-le)*(oe-$e),($e<0?$e+6.283185307179586:$e)>R&&(D=D^1),C=_t+1|0,(C|0)>=(ni|0)){z=22;break}else z=_t}if((z|0)==22)return D|0}else{D=0,z=-1,C=0;e:for(;;){for(_t=C;oe=+ke[Ct+(_t<<4)>>3],$e=+ke[Ct+(_t<<4)+8>>3],C=(z+2|0)%(ni|0)|0,le=+ke[Ct+(C<<4)>>3],ee=+ke[Ct+(C<<4)+8>>3],oe>le?(we=oe,oe=$e):(we=le,le=oe,oe=ee,ee=$e),!!(Gt<le|Gt>we);)if(z=_t+1|0,(z|0)<(ni|0))C=_t,_t=z,z=C;else{z=22;break e}if(R=oe==R|ee==R?R+-2220446049250313e-31:R,ee+(Gt-le)/(we-le)*(oe-ee)>R&&(D=D^1),C=_t+1|0,(C|0)>=(ni|0)){z=22;break}else z=_t}if((z|0)==22)return D|0}return 0}function Dn(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0;if(Z=o[C>>2]|0,!Z){o[D>>2]=0,o[D+4>>2]=0,o[D+8>>2]=0,o[D+12>>2]=0,o[D+16>>2]=0,o[D+20>>2]=0,o[D+24>>2]=0,o[D+28>>2]=0;return}if(A=D+8|0,ke[A>>3]=17976931348623157e292,E=D+24|0,ke[E>>3]=17976931348623157e292,ke[D>>3]=-17976931348623157e292,F=D+16|0,ke[F>>3]=-17976931348623157e292,!((Z|0)<=0)){for(Gt=o[C+4>>2]|0,_t=17976931348623157e292,Ct=-17976931348623157e292,ni=0,C=-1,le=17976931348623157e292,oe=17976931348623157e292,$e=-17976931348623157e292,R=-17976931348623157e292,Zt=0;z=+ke[Gt+(Zt<<4)>>3],we=+ke[Gt+(Zt<<4)+8>>3],C=C+2|0,ee=+ke[Gt+(((C|0)==(Z|0)?0:C)<<4)+8>>3],z<le&&(ke[A>>3]=z,le=z),we<oe&&(ke[E>>3]=we,oe=we),z>$e?ke[D>>3]=z:z=$e,we>R&&(ke[F>>3]=we,R=we),_t=we>0&we<_t?we:_t,Ct=we<0&we>Ct?we:Ct,ni=ni|+hi(+(we-ee))>3.141592653589793,C=Zt+1|0,(C|0)!=(Z|0);)O=Zt,$e=z,Zt=C,C=O;ni&&(ke[F>>3]=Ct,ke[E>>3]=_t)}}function Ma(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0;if(Z=o[C>>2]|0,Z){if(A=D+8|0,ke[A>>3]=17976931348623157e292,E=D+24|0,ke[E>>3]=17976931348623157e292,ke[D>>3]=-17976931348623157e292,F=D+16|0,ke[F>>3]=-17976931348623157e292,(Z|0)>0){for(ee=o[C+4>>2]|0,Gt=17976931348623157e292,Zt=-17976931348623157e292,R=0,z=-1,$e=17976931348623157e292,_t=17976931348623157e292,ni=-17976931348623157e292,oe=-17976931348623157e292,O=0;le=+ke[ee+(O<<4)>>3],Ct=+ke[ee+(O<<4)+8>>3],r=z+2|0,we=+ke[ee+(((r|0)==(Z|0)?0:r)<<4)+8>>3],le<$e&&(ke[A>>3]=le,$e=le),Ct<_t&&(ke[E>>3]=Ct,_t=Ct),le>ni?ke[D>>3]=le:le=ni,Ct>oe&&(ke[F>>3]=Ct,oe=Ct),Gt=Ct>0&Ct<Gt?Ct:Gt,Zt=Ct<0&Ct>Zt?Ct:Zt,R=R|+hi(+(Ct-we))>3.141592653589793,z=O+1|0,(z|0)!=(Z|0);)r=O,ni=le,O=z,z=r;R&&(ke[F>>3]=Zt,ke[E>>3]=Gt)}}else o[D>>2]=0,o[D+4>>2]=0,o[D+8>>2]=0,o[D+12>>2]=0,o[D+16>>2]=0,o[D+20>>2]=0,o[D+24>>2]=0,o[D+28>>2]=0;if(r=C+8|0,z=o[r>>2]|0,!((z|0)<=0)){i=C+12|0,s=0;do if(ee=o[i>>2]|0,R=s,s=s+1|0,E=D+(s<<5)|0,F=o[ee+(R<<3)>>2]|0,F){if(O=D+(s<<5)+8|0,ke[O>>3]=17976931348623157e292,C=D+(s<<5)+24|0,ke[C>>3]=17976931348623157e292,ke[E>>3]=-17976931348623157e292,y=D+(s<<5)+16|0,ke[y>>3]=-17976931348623157e292,(F|0)>0){for(Z=o[ee+(R<<3)+4>>2]|0,Gt=17976931348623157e292,Zt=-17976931348623157e292,ee=0,R=-1,A=0,$e=17976931348623157e292,_t=17976931348623157e292,Ct=-17976931348623157e292,oe=-17976931348623157e292;le=+ke[Z+(A<<4)>>3],ni=+ke[Z+(A<<4)+8>>3],R=R+2|0,we=+ke[Z+(((R|0)==(F|0)?0:R)<<4)+8>>3],le<$e&&(ke[O>>3]=le,$e=le),ni<_t&&(ke[C>>3]=ni,_t=ni),le>Ct?ke[E>>3]=le:le=Ct,ni>oe&&(ke[y>>3]=ni,oe=ni),Gt=ni>0&ni<Gt?ni:Gt,Zt=ni<0&ni>Zt?ni:Zt,ee=ee|+hi(+(ni-we))>3.141592653589793,R=A+1|0,(R|0)!=(F|0);)l=A,A=R,Ct=le,R=l;ee&&(ke[y>>3]=Zt,ke[C>>3]=Gt)}}else o[E>>2]=0,o[E+4>>2]=0,o[E+8>>2]=0,o[E+12>>2]=0,o[E+16>>2]=0,o[E+20>>2]=0,o[E+24>>2]=0,o[E+28>>2]=0,z=o[r>>2]|0;while((s|0)<(z|0))}}function Sn(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0;if(!(Ml(C,D,z)|0))return ee=0,ee|0;if(ee=C+8|0,(o[ee>>2]|0)<=0)return ee=1,ee|0;for(R=C+12|0,C=0;;){if(le=C,C=C+1|0,Ml((o[R>>2]|0)+(le<<3)|0,D+(C<<5)|0,z)|0){C=0,R=6;break}if((C|0)>=(o[ee>>2]|0)){C=1,R=6;break}}return(R|0)==6?C|0:0}function No(){return 8}function Nl(){return 16}function En(){return 168}function Wl(){return 8}function Cn(){return 16}function _l(){return 12}function uu(){return 8}function Fu(C){C=C|0;var D=0,z=0;return z=+ke[C>>3],D=+ke[C+8>>3],+ +Jt(+(z*z+D*D))}function Vl(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0;_t=+ke[C>>3],$e=+ke[D>>3]-_t,we=+ke[C+8>>3],oe=+ke[D+8>>3]-we,ni=+ke[z>>3],le=+ke[R>>3]-ni,Gt=+ke[z+8>>3],Ct=+ke[R+8>>3]-Gt,le=(le*(we-Gt)-(_t-ni)*Ct)/($e*Ct-oe*le),ke[ee>>3]=_t+$e*le,ke[ee+8>>3]=we+oe*le}function yl(C,D){return C=C|0,D=D|0,+ke[C>>3]!=+ke[D>>3]?(D=0,D|0):(D=+ke[C+8>>3]==+ke[D+8>>3],D|0)}function ta(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;return ee=+ke[C>>3]-+ke[D>>3],R=+ke[C+8>>3]-+ke[D+8>>3],z=+ke[C+16>>3]-+ke[D+16>>3],+(ee*ee+R*R+z*z)}function oc(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;z=+ke[C>>3],R=+zi(+z),z=+xi(+z),ke[D+16>>3]=z,z=+ke[C+8>>3],ee=R*+zi(+z),ke[D>>3]=ee,z=R*+xi(+z),ke[D+8>>3]=z}function $u(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0;if(_t=Vt,Vt=Vt+32|0,ee=_t+16|0,le=_t,ea(C,D,ee),oe=ll(C,D)|0,$e=Js(C,D)|0,$t(oe,le),D=Ii(oe,o[ee>>2]|0)|0,!(N(oe)|0))return $e=D,Vt=_t,$e|0;do switch(oe|0){case 4:{C=0,z=14;break}case 14:{C=1,z=14;break}case 24:{C=2,z=14;break}case 38:{C=3,z=14;break}case 49:{C=4,z=14;break}case 58:{C=5,z=14;break}case 63:{C=6,z=14;break}case 72:{C=7,z=14;break}case 83:{C=8,z=14;break}case 97:{C=9,z=14;break}case 107:{C=10,z=14;break}case 117:{C=11,z=14;break}default:we=0,R=0}while(!1);return(z|0)==14&&(we=o[22096+(C*24|0)+8>>2]|0,R=o[22096+(C*24|0)+16>>2]|0),C=o[ee>>2]|0,(C|0)!=(o[le>>2]|0)&&(oe=xe(oe)|0,C=o[ee>>2]|0,oe|(C|0)==(R|0)&&(D=(D+1|0)%6|0)),($e|0)==3&(C|0)==(R|0)?($e=(D+5|0)%6|0,Vt=_t,$e|0):($e|0)==5&(C|0)==(we|0)?($e=(D+1|0)%6|0,Vt=_t,$e|0):($e=D,Vt=_t,$e|0)}function $l(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;return R=ds(C,D)|0,(z+-1|0)>>>0>5||(ee=(R|0)!=0,(z|0)==1&ee)?(z=-1,z|0):(R=$u(C,D)|0,ee?(z=(5-R+(o[22384+(z<<2)>>2]|0)|0)%5|0,z|0):(z=(6-R+(o[22416+(z<<2)>>2]|0)|0)%6|0,z|0))}function ms(C,D,z){C=C|0,D=D|0,z=z|0;var R=0;(D|0)>0?(R=tl(D,4)|0,o[C>>2]=R,R||Ki(23230,23253,40,23267)):o[C>>2]=0,o[C+4>>2]=D,o[C+8>>2]=0,o[C+12>>2]=z}function _a(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;ee=C+4|0,le=C+12|0,oe=C+8|0;e:for(;;){for(z=o[ee>>2]|0,D=0;;){if((D|0)>=(z|0))break e;if(R=o[C>>2]|0,we=o[R+(D<<2)>>2]|0,!we)D=D+1|0;else break}D=R+(~~(+hi(+(+oi(10,+ +(15-(o[le>>2]|0)|0))*(+ke[we>>3]+ +ke[we+8>>3])))%+(z|0))>>>0<<2)|0,z=o[D>>2]|0;t:do if(z|0){if(R=we+32|0,(z|0)==(we|0))o[D>>2]=o[R>>2];else{if(z=z+32|0,D=o[z>>2]|0,!D)break;for(;(D|0)!=(we|0);)if(z=D+32|0,D=o[z>>2]|0,!D)break t;o[z>>2]=o[R>>2]}Jn(we),o[oe>>2]=(o[oe>>2]|0)+-1}while(!1)}Jn(o[C>>2]|0)}function el(C){C=C|0;var D=0,z=0,R=0;for(R=o[C+4>>2]|0,z=0;;){if((z|0)>=(R|0)){D=0,z=4;break}if(D=o[(o[C>>2]|0)+(z<<2)>>2]|0,!D)z=z+1|0;else{z=4;break}}return(z|0)==4?D|0:0}function _u(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0;if(z=~~(+hi(+(+oi(10,+ +(15-(o[C+12>>2]|0)|0))*(+ke[D>>3]+ +ke[D+8>>3])))%+(o[C+4>>2]|0))>>>0,z=(o[C>>2]|0)+(z<<2)|0,R=o[z>>2]|0,!R)return le=1,le|0;le=D+32|0;do if((R|0)!=(D|0)){if(z=o[R+32>>2]|0,!z)return le=1,le|0;for(ee=z;;){if((ee|0)==(D|0)){ee=8;break}if(z=o[ee+32>>2]|0,z)R=ee,ee=z;else{z=1,ee=10;break}}if((ee|0)==8){o[R+32>>2]=o[le>>2];break}else if((ee|0)==10)return z|0}else o[z>>2]=o[le>>2];while(!1);return Jn(D),le=C+8|0,o[le>>2]=(o[le>>2]|0)+-1,le=0,le|0}function Ou(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0;le=jn(40)|0,le||Ki(23283,23253,98,23296),o[le>>2]=o[D>>2],o[le+4>>2]=o[D+4>>2],o[le+8>>2]=o[D+8>>2],o[le+12>>2]=o[D+12>>2],ee=le+16|0,o[ee>>2]=o[z>>2],o[ee+4>>2]=o[z+4>>2],o[ee+8>>2]=o[z+8>>2],o[ee+12>>2]=o[z+12>>2],o[le+32>>2]=0,ee=~~(+hi(+(+oi(10,+ +(15-(o[C+12>>2]|0)|0))*(+ke[D>>3]+ +ke[D+8>>3])))%+(o[C+4>>2]|0))>>>0,ee=(o[C>>2]|0)+(ee<<2)|0,R=o[ee>>2]|0;do if(!R)o[ee>>2]=le;else{for(;!(ba(R,D)|0&&ba(R+16|0,z)|0);)if(ee=o[R+32>>2]|0,R=ee|0?ee:R,!(o[R+32>>2]|0)){oe=10;break}if((oe|0)==10){o[R+32>>2]=le;break}return Jn(le),oe=R,oe|0}while(!1);return oe=C+8|0,o[oe>>2]=(o[oe>>2]|0)+1,oe=le,oe|0}function cu(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;if(ee=~~(+hi(+(+oi(10,+ +(15-(o[C+12>>2]|0)|0))*(+ke[D>>3]+ +ke[D+8>>3])))%+(o[C+4>>2]|0))>>>0,ee=o[(o[C>>2]|0)+(ee<<2)>>2]|0,!ee)return z=0,z|0;if(!z){for(C=ee;;){if(ba(C,D)|0){R=10;break}if(C=o[C+32>>2]|0,!C){C=0,R=10;break}}if((R|0)==10)return C|0}for(C=ee;;){if(ba(C,D)|0&&ba(C+16|0,z)|0){R=10;break}if(C=o[C+32>>2]|0,!C){C=0,R=10;break}}return(R|0)==10?C|0:0}function Nu(C,D){C=C|0,D=D|0;var z=0;if(z=~~(+hi(+(+oi(10,+ +(15-(o[C+12>>2]|0)|0))*(+ke[D>>3]+ +ke[D+8>>3])))%+(o[C+4>>2]|0))>>>0,C=o[(o[C>>2]|0)+(z<<2)>>2]|0,!C)return z=0,z|0;for(;;){if(ba(C,D)|0){D=5;break}if(C=o[C+32>>2]|0,!C){C=0,D=5;break}}return(D|0)==5?C|0:0}function _r(){return 23312}function gs(C){return C=+C,+ +hl(+C)}function gn(C){return C=+C,~~+gs(C)|0}function jn(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0,Zt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0;i=Vt,Vt=Vt+16|0,Gt=i;do if(C>>>0<245){if(_t=C>>>0<11?16:C+11&-8,C=_t>>>3,ni=o[5829]|0,z=ni>>>C,z&3|0)return D=(z&1^1)+C|0,C=23356+(D<<1<<2)|0,z=C+8|0,R=o[z>>2]|0,ee=R+8|0,le=o[ee>>2]|0,(le|0)==(C|0)?o[5829]=ni&~(1<<D):(o[le+12>>2]=C,o[z>>2]=le),s=D<<3,o[R+4>>2]=s|3,s=R+s+4|0,o[s>>2]=o[s>>2]|1,s=ee,Vt=i,s|0;if(Ct=o[5831]|0,_t>>>0>Ct>>>0){if(z|0)return D=2<<C,D=z<<C&(D|0-D),D=(D&0-D)+-1|0,we=D>>>12&16,D=D>>>we,z=D>>>5&8,D=D>>>z,le=D>>>2&4,D=D>>>le,C=D>>>1&2,D=D>>>C,R=D>>>1&1,R=(z|we|le|C|R)+(D>>>R)|0,D=23356+(R<<1<<2)|0,C=D+8|0,le=o[C>>2]|0,we=le+8|0,z=o[we>>2]|0,(z|0)==(D|0)?(C=ni&~(1<<R),o[5829]=C):(o[z+12>>2]=D,o[C>>2]=z,C=ni),s=R<<3,oe=s-_t|0,o[le+4>>2]=_t|3,ee=le+_t|0,o[ee+4>>2]=oe|1,o[le+s>>2]=oe,Ct|0&&(R=o[5834]|0,D=Ct>>>3,z=23356+(D<<1<<2)|0,D=1<<D,C&D?(C=z+8|0,D=o[C>>2]|0):(o[5829]=C|D,D=z,C=z+8|0),o[C>>2]=R,o[D+12>>2]=R,o[R+8>>2]=D,o[R+12>>2]=z),o[5831]=oe,o[5834]=ee,s=we,Vt=i,s|0;if(le=o[5830]|0,le){for(z=(le&0-le)+-1|0,ee=z>>>12&16,z=z>>>ee,R=z>>>5&8,z=z>>>R,oe=z>>>2&4,z=z>>>oe,we=z>>>1&2,z=z>>>we,$e=z>>>1&1,$e=o[23620+((R|ee|oe|we|$e)+(z>>>$e)<<2)>>2]|0,z=$e,we=$e,$e=(o[$e+4>>2]&-8)-_t|0;C=o[z+16>>2]|0,!(!C&&(C=o[z+20>>2]|0,!C));)oe=(o[C+4>>2]&-8)-_t|0,ee=oe>>>0<$e>>>0,z=C,we=ee?C:we,$e=ee?oe:$e;if(oe=we+_t|0,oe>>>0>we>>>0){ee=o[we+24>>2]|0,D=o[we+12>>2]|0;do if((D|0)==(we|0)){if(C=we+20|0,D=o[C>>2]|0,!D&&(C=we+16|0,D=o[C>>2]|0,!D)){z=0;break}for(;;)if(R=D+20|0,z=o[R>>2]|0,z)D=z,C=R;else if(R=D+16|0,z=o[R>>2]|0,z)D=z,C=R;else break;o[C>>2]=0,z=D}else z=o[we+8>>2]|0,o[z+12>>2]=D,o[D+8>>2]=z,z=D;while(!1);do if(ee|0){if(D=o[we+28>>2]|0,C=23620+(D<<2)|0,(we|0)==(o[C>>2]|0)){if(o[C>>2]=z,!z){o[5830]=le&~(1<<D);break}}else if(s=ee+16|0,o[((o[s>>2]|0)==(we|0)?s:ee+20|0)>>2]=z,!z)break;o[z+24>>2]=ee,D=o[we+16>>2]|0,D|0&&(o[z+16>>2]=D,o[D+24>>2]=z),D=o[we+20>>2]|0,D|0&&(o[z+20>>2]=D,o[D+24>>2]=z)}while(!1);return $e>>>0<16?(s=$e+_t|0,o[we+4>>2]=s|3,s=we+s+4|0,o[s>>2]=o[s>>2]|1):(o[we+4>>2]=_t|3,o[oe+4>>2]=$e|1,o[oe+$e>>2]=$e,Ct|0&&(R=o[5834]|0,D=Ct>>>3,z=23356+(D<<1<<2)|0,D=1<<D,D&ni?(C=z+8|0,D=o[C>>2]|0):(o[5829]=D|ni,D=z,C=z+8|0),o[C>>2]=R,o[D+12>>2]=R,o[R+8>>2]=D,o[R+12>>2]=z),o[5831]=$e,o[5834]=oe),s=we+8|0,Vt=i,s|0}else ni=_t}else ni=_t}else ni=_t}else if(C>>>0<=4294967231)if(C=C+11|0,_t=C&-8,R=o[5830]|0,R){ee=0-_t|0,C=C>>>8,C?_t>>>0>16777215?$e=31:(ni=(C+1048320|0)>>>16&8,A=C<<ni,we=(A+520192|0)>>>16&4,A=A<<we,$e=(A+245760|0)>>>16&2,$e=14-(we|ni|$e)+(A<<$e>>>15)|0,$e=_t>>>($e+7|0)&1|$e<<1):$e=0,z=o[23620+($e<<2)>>2]|0;e:do if(!z)z=0,C=0,A=61;else for(C=0,we=_t<<(($e|0)==31?0:25-($e>>>1)|0),le=0;;){if(oe=(o[z+4>>2]&-8)-_t|0,oe>>>0<ee>>>0)if(oe)C=z,ee=oe;else{C=z,ee=0,A=65;break e}if(A=o[z+20>>2]|0,z=o[z+16+(we>>>31<<2)>>2]|0,le=(A|0)==0|(A|0)==(z|0)?le:A,z)we=we<<1;else{z=le,A=61;break}}while(!1);if((A|0)==61){if((z|0)==0&(C|0)==0){if(C=2<<$e,C=(C|0-C)&R,!C){ni=_t;break}ni=(C&0-C)+-1|0,oe=ni>>>12&16,ni=ni>>>oe,le=ni>>>5&8,ni=ni>>>le,we=ni>>>2&4,ni=ni>>>we,$e=ni>>>1&2,ni=ni>>>$e,z=ni>>>1&1,C=0,z=o[23620+((le|oe|we|$e|z)+(ni>>>z)<<2)>>2]|0}z?A=65:(we=C,oe=ee)}if((A|0)==65)for(le=z;;)if(ni=(o[le+4>>2]&-8)-_t|0,z=ni>>>0<ee>>>0,ee=z?ni:ee,C=z?le:C,z=o[le+16>>2]|0,z||(z=o[le+20>>2]|0),z)le=z;else{we=C,oe=ee;break}if(we|0&&oe>>>0<((o[5831]|0)-_t|0)>>>0&&(Ct=we+_t|0,Ct>>>0>we>>>0)){le=o[we+24>>2]|0,D=o[we+12>>2]|0;do if((D|0)==(we|0)){if(C=we+20|0,D=o[C>>2]|0,!D&&(C=we+16|0,D=o[C>>2]|0,!D)){D=0;break}for(;;)if(ee=D+20|0,z=o[ee>>2]|0,z)D=z,C=ee;else if(ee=D+16|0,z=o[ee>>2]|0,z)D=z,C=ee;else break;o[C>>2]=0}else s=o[we+8>>2]|0,o[s+12>>2]=D,o[D+8>>2]=s;while(!1);do if(le){if(C=o[we+28>>2]|0,z=23620+(C<<2)|0,(we|0)==(o[z>>2]|0)){if(o[z>>2]=D,!D){R=R&~(1<<C),o[5830]=R;break}}else if(s=le+16|0,o[((o[s>>2]|0)==(we|0)?s:le+20|0)>>2]=D,!D)break;o[D+24>>2]=le,C=o[we+16>>2]|0,C|0&&(o[D+16>>2]=C,o[C+24>>2]=D),C=o[we+20>>2]|0,C&&(o[D+20>>2]=C,o[C+24>>2]=D)}while(!1);e:do if(oe>>>0<16)s=oe+_t|0,o[we+4>>2]=s|3,s=we+s+4|0,o[s>>2]=o[s>>2]|1;else{if(o[we+4>>2]=_t|3,o[Ct+4>>2]=oe|1,o[Ct+oe>>2]=oe,D=oe>>>3,oe>>>0<256){z=23356+(D<<1<<2)|0,C=o[5829]|0,D=1<<D,C&D?(C=z+8|0,D=o[C>>2]|0):(o[5829]=C|D,D=z,C=z+8|0),o[C>>2]=Ct,o[D+12>>2]=Ct,o[Ct+8>>2]=D,o[Ct+12>>2]=z;break}if(D=oe>>>8,D?oe>>>0>16777215?z=31:(y=(D+1048320|0)>>>16&8,s=D<<y,O=(s+520192|0)>>>16&4,s=s<<O,z=(s+245760|0)>>>16&2,z=14-(O|y|z)+(s<<z>>>15)|0,z=oe>>>(z+7|0)&1|z<<1):z=0,D=23620+(z<<2)|0,o[Ct+28>>2]=z,C=Ct+16|0,o[C+4>>2]=0,o[C>>2]=0,C=1<<z,!(R&C)){o[5830]=R|C,o[D>>2]=Ct,o[Ct+24>>2]=D,o[Ct+12>>2]=Ct,o[Ct+8>>2]=Ct;break}D=o[D>>2]|0;t:do if((o[D+4>>2]&-8|0)!=(oe|0)){for(R=oe<<((z|0)==31?0:25-(z>>>1)|0);z=D+16+(R>>>31<<2)|0,C=o[z>>2]|0,!!C;)if((o[C+4>>2]&-8|0)==(oe|0)){D=C;break t}else R=R<<1,D=C;o[z>>2]=Ct,o[Ct+24>>2]=D,o[Ct+12>>2]=Ct,o[Ct+8>>2]=Ct;break e}while(!1);y=D+8|0,s=o[y>>2]|0,o[s+12>>2]=Ct,o[y>>2]=Ct,o[Ct+8>>2]=s,o[Ct+12>>2]=D,o[Ct+24>>2]=0}while(!1);return s=we+8|0,Vt=i,s|0}else ni=_t}else ni=_t;else ni=-1;while(!1);if(z=o[5831]|0,z>>>0>=ni>>>0)return D=z-ni|0,C=o[5834]|0,D>>>0>15?(s=C+ni|0,o[5834]=s,o[5831]=D,o[s+4>>2]=D|1,o[C+z>>2]=D,o[C+4>>2]=ni|3):(o[5831]=0,o[5834]=0,o[C+4>>2]=z|3,s=C+z+4|0,o[s>>2]=o[s>>2]|1),s=C+8|0,Vt=i,s|0;if(oe=o[5832]|0,oe>>>0>ni>>>0)return O=oe-ni|0,o[5832]=O,s=o[5835]|0,y=s+ni|0,o[5835]=y,o[y+4>>2]=O|1,o[s+4>>2]=ni|3,s=s+8|0,Vt=i,s|0;if(o[5947]|0?C=o[5949]|0:(o[5949]=4096,o[5948]=4096,o[5950]=-1,o[5951]=-1,o[5952]=0,o[5940]=0,o[5947]=Gt&-16^1431655768,C=4096),we=ni+48|0,$e=ni+47|0,le=C+$e|0,ee=0-C|0,_t=le&ee,_t>>>0<=ni>>>0||(C=o[5939]|0,C|0&&(Ct=o[5937]|0,Gt=Ct+_t|0,Gt>>>0<=Ct>>>0|Gt>>>0>C>>>0)))return s=0,Vt=i,s|0;e:do if(o[5940]&4)D=0,A=143;else{z=o[5835]|0;t:do if(z){for(R=23764;Gt=o[R>>2]|0,!(Gt>>>0<=z>>>0&&(Gt+(o[R+4>>2]|0)|0)>>>0>z>>>0);)if(C=o[R+8>>2]|0,C)R=C;else{A=128;break t}if(D=le-oe&ee,D>>>0<2147483647)if(C=Ms(D|0)|0,(C|0)==((o[R>>2]|0)+(o[R+4>>2]|0)|0)){if((C|0)!=-1){oe=D,le=C,A=145;break e}}else R=C,A=136;else D=0}else A=128;while(!1);do if((A|0)==128)if(z=Ms(0)|0,(z|0)!=-1&&(D=z,Zt=o[5948]|0,Z=Zt+-1|0,D=(Z&D|0?(Z+D&0-Zt)-D|0:0)+_t|0,Zt=o[5937]|0,Z=D+Zt|0,D>>>0>ni>>>0&D>>>0<2147483647)){if(Gt=o[5939]|0,Gt|0&&Z>>>0<=Zt>>>0|Z>>>0>Gt>>>0){D=0;break}if(C=Ms(D|0)|0,(C|0)==(z|0)){oe=D,le=z,A=145;break e}else R=C,A=136}else D=0;while(!1);do if((A|0)==136){if(z=0-D|0,!(we>>>0>D>>>0&(D>>>0<2147483647&(R|0)!=-1)))if((R|0)==-1){D=0;break}else{oe=D,le=R,A=145;break e}if(C=o[5949]|0,C=$e-D+C&0-C,C>>>0>=2147483647){oe=D,le=R,A=145;break e}if((Ms(C|0)|0)==-1){Ms(z|0)|0,D=0;break}else{oe=C+D|0,le=R,A=145;break e}}while(!1);o[5940]=o[5940]|4,A=143}while(!1);if((A|0)==143&&_t>>>0<2147483647&&(O=Ms(_t|0)|0,Z=Ms(0)|0,E=Z-O|0,F=E>>>0>(ni+40|0)>>>0,!((O|0)==-1|F^1|O>>>0<Z>>>0&((O|0)!=-1&(Z|0)!=-1)^1))&&(oe=F?E:D,le=O,A=145),(A|0)==145){D=(o[5937]|0)+oe|0,o[5937]=D,D>>>0>(o[5938]|0)>>>0&&(o[5938]=D),$e=o[5835]|0;e:do if($e){for(D=23764;;){if(C=o[D>>2]|0,z=o[D+4>>2]|0,(le|0)==(C+z|0)){A=154;break}if(R=o[D+8>>2]|0,R)D=R;else break}if((A|0)==154&&(y=D+4|0,(o[D+12>>2]&8|0)==0)&&le>>>0>$e>>>0&C>>>0<=$e>>>0){o[y>>2]=z+oe,s=(o[5832]|0)+oe|0,O=$e+8|0,O=O&7|0?0-O&7:0,y=$e+O|0,O=s-O|0,o[5835]=y,o[5832]=O,o[y+4>>2]=O|1,o[$e+s+4>>2]=40,o[5836]=o[5951];break}for(le>>>0<(o[5833]|0)>>>0&&(o[5833]=le),z=le+oe|0,D=23764;;){if((o[D>>2]|0)==(z|0)){A=162;break}if(C=o[D+8>>2]|0,C)D=C;else break}if((A|0)==162&&!(o[D+12>>2]&8|0)){o[D>>2]=le,Ct=D+4|0,o[Ct>>2]=(o[Ct>>2]|0)+oe,Ct=le+8|0,Ct=le+(Ct&7|0?0-Ct&7:0)|0,D=z+8|0,D=z+(D&7|0?0-D&7:0)|0,_t=Ct+ni|0,we=D-Ct-ni|0,o[Ct+4>>2]=ni|3;t:do if(($e|0)==(D|0))s=(o[5832]|0)+we|0,o[5832]=s,o[5835]=_t,o[_t+4>>2]=s|1;else{if((o[5834]|0)==(D|0)){s=(o[5831]|0)+we|0,o[5831]=s,o[5834]=_t,o[_t+4>>2]=s|1,o[_t+s>>2]=s;break}if(C=o[D+4>>2]|0,(C&3|0)==1){oe=C&-8,R=C>>>3;i:do if(C>>>0<256)if(C=o[D+8>>2]|0,z=o[D+12>>2]|0,(z|0)==(C|0)){o[5829]=o[5829]&~(1<<R);break}else{o[C+12>>2]=z,o[z+8>>2]=C;break}else{le=o[D+24>>2]|0,C=o[D+12>>2]|0;do if((C|0)==(D|0)){if(z=D+16|0,R=z+4|0,C=o[R>>2]|0,C)z=R;else if(C=o[z>>2]|0,!C){C=0;break}for(;;)if(ee=C+20|0,R=o[ee>>2]|0,R)C=R,z=ee;else if(ee=C+16|0,R=o[ee>>2]|0,R)C=R,z=ee;else break;o[z>>2]=0}else s=o[D+8>>2]|0,o[s+12>>2]=C,o[C+8>>2]=s;while(!1);if(!le)break;z=o[D+28>>2]|0,R=23620+(z<<2)|0;do if((o[R>>2]|0)!=(D|0)){if(s=le+16|0,o[((o[s>>2]|0)==(D|0)?s:le+20|0)>>2]=C,!C)break i}else{if(o[R>>2]=C,C|0)break;o[5830]=o[5830]&~(1<<z);break i}while(!1);if(o[C+24>>2]=le,z=D+16|0,R=o[z>>2]|0,R|0&&(o[C+16>>2]=R,o[R+24>>2]=C),z=o[z+4>>2]|0,!z)break;o[C+20>>2]=z,o[z+24>>2]=C}while(!1);D=D+oe|0,ee=oe+we|0}else ee=we;if(D=D+4|0,o[D>>2]=o[D>>2]&-2,o[_t+4>>2]=ee|1,o[_t+ee>>2]=ee,D=ee>>>3,ee>>>0<256){z=23356+(D<<1<<2)|0,C=o[5829]|0,D=1<<D,C&D?(C=z+8|0,D=o[C>>2]|0):(o[5829]=C|D,D=z,C=z+8|0),o[C>>2]=_t,o[D+12>>2]=_t,o[_t+8>>2]=D,o[_t+12>>2]=z;break}D=ee>>>8;do if(!D)R=0;else{if(ee>>>0>16777215){R=31;break}y=(D+1048320|0)>>>16&8,s=D<<y,O=(s+520192|0)>>>16&4,s=s<<O,R=(s+245760|0)>>>16&2,R=14-(O|y|R)+(s<<R>>>15)|0,R=ee>>>(R+7|0)&1|R<<1}while(!1);if(D=23620+(R<<2)|0,o[_t+28>>2]=R,C=_t+16|0,o[C+4>>2]=0,o[C>>2]=0,C=o[5830]|0,z=1<<R,!(C&z)){o[5830]=C|z,o[D>>2]=_t,o[_t+24>>2]=D,o[_t+12>>2]=_t,o[_t+8>>2]=_t;break}D=o[D>>2]|0;i:do if((o[D+4>>2]&-8|0)!=(ee|0)){for(R=ee<<((R|0)==31?0:25-(R>>>1)|0);z=D+16+(R>>>31<<2)|0,C=o[z>>2]|0,!!C;)if((o[C+4>>2]&-8|0)==(ee|0)){D=C;break i}else R=R<<1,D=C;o[z>>2]=_t,o[_t+24>>2]=D,o[_t+12>>2]=_t,o[_t+8>>2]=_t;break t}while(!1);y=D+8|0,s=o[y>>2]|0,o[s+12>>2]=_t,o[y>>2]=_t,o[_t+8>>2]=s,o[_t+12>>2]=D,o[_t+24>>2]=0}while(!1);return s=Ct+8|0,Vt=i,s|0}for(D=23764;C=o[D>>2]|0,!(C>>>0<=$e>>>0&&(s=C+(o[D+4>>2]|0)|0,s>>>0>$e>>>0));)D=o[D+8>>2]|0;ee=s+-47|0,C=ee+8|0,C=ee+(C&7|0?0-C&7:0)|0,ee=$e+16|0,C=C>>>0<ee>>>0?$e:C,D=C+8|0,z=oe+-40|0,O=le+8|0,O=O&7|0?0-O&7:0,y=le+O|0,O=z-O|0,o[5835]=y,o[5832]=O,o[y+4>>2]=O|1,o[le+z+4>>2]=40,o[5836]=o[5951],z=C+4|0,o[z>>2]=27,o[D>>2]=o[5941],o[D+4>>2]=o[5942],o[D+8>>2]=o[5943],o[D+12>>2]=o[5944],o[5941]=le,o[5942]=oe,o[5944]=0,o[5943]=D,D=C+24|0;do y=D,D=D+4|0,o[D>>2]=7;while((y+8|0)>>>0<s>>>0);if((C|0)!=($e|0)){if(le=C-$e|0,o[z>>2]=o[z>>2]&-2,o[$e+4>>2]=le|1,o[C>>2]=le,D=le>>>3,le>>>0<256){z=23356+(D<<1<<2)|0,C=o[5829]|0,D=1<<D,C&D?(C=z+8|0,D=o[C>>2]|0):(o[5829]=C|D,D=z,C=z+8|0),o[C>>2]=$e,o[D+12>>2]=$e,o[$e+8>>2]=D,o[$e+12>>2]=z;break}if(D=le>>>8,D?le>>>0>16777215?R=31:(y=(D+1048320|0)>>>16&8,s=D<<y,O=(s+520192|0)>>>16&4,s=s<<O,R=(s+245760|0)>>>16&2,R=14-(O|y|R)+(s<<R>>>15)|0,R=le>>>(R+7|0)&1|R<<1):R=0,z=23620+(R<<2)|0,o[$e+28>>2]=R,o[$e+20>>2]=0,o[ee>>2]=0,D=o[5830]|0,C=1<<R,!(D&C)){o[5830]=D|C,o[z>>2]=$e,o[$e+24>>2]=z,o[$e+12>>2]=$e,o[$e+8>>2]=$e;break}D=o[z>>2]|0;t:do if((o[D+4>>2]&-8|0)!=(le|0)){for(R=le<<((R|0)==31?0:25-(R>>>1)|0);z=D+16+(R>>>31<<2)|0,C=o[z>>2]|0,!!C;)if((o[C+4>>2]&-8|0)==(le|0)){D=C;break t}else R=R<<1,D=C;o[z>>2]=$e,o[$e+24>>2]=D,o[$e+12>>2]=$e,o[$e+8>>2]=$e;break e}while(!1);y=D+8|0,s=o[y>>2]|0,o[s+12>>2]=$e,o[y>>2]=$e,o[$e+8>>2]=s,o[$e+12>>2]=D,o[$e+24>>2]=0}}else s=o[5833]|0,(s|0)==0|le>>>0<s>>>0&&(o[5833]=le),o[5941]=le,o[5942]=oe,o[5944]=0,o[5838]=o[5947],o[5837]=-1,o[5842]=23356,o[5841]=23356,o[5844]=23364,o[5843]=23364,o[5846]=23372,o[5845]=23372,o[5848]=23380,o[5847]=23380,o[5850]=23388,o[5849]=23388,o[5852]=23396,o[5851]=23396,o[5854]=23404,o[5853]=23404,o[5856]=23412,o[5855]=23412,o[5858]=23420,o[5857]=23420,o[5860]=23428,o[5859]=23428,o[5862]=23436,o[5861]=23436,o[5864]=23444,o[5863]=23444,o[5866]=23452,o[5865]=23452,o[5868]=23460,o[5867]=23460,o[5870]=23468,o[5869]=23468,o[5872]=23476,o[5871]=23476,o[5874]=23484,o[5873]=23484,o[5876]=23492,o[5875]=23492,o[5878]=23500,o[5877]=23500,o[5880]=23508,o[5879]=23508,o[5882]=23516,o[5881]=23516,o[5884]=23524,o[5883]=23524,o[5886]=23532,o[5885]=23532,o[5888]=23540,o[5887]=23540,o[5890]=23548,o[5889]=23548,o[5892]=23556,o[5891]=23556,o[5894]=23564,o[5893]=23564,o[5896]=23572,o[5895]=23572,o[5898]=23580,o[5897]=23580,o[5900]=23588,o[5899]=23588,o[5902]=23596,o[5901]=23596,o[5904]=23604,o[5903]=23604,s=oe+-40|0,O=le+8|0,O=O&7|0?0-O&7:0,y=le+O|0,O=s-O|0,o[5835]=y,o[5832]=O,o[y+4>>2]=O|1,o[le+s+4>>2]=40,o[5836]=o[5951];while(!1);if(D=o[5832]|0,D>>>0>ni>>>0)return O=D-ni|0,o[5832]=O,s=o[5835]|0,y=s+ni|0,o[5835]=y,o[y+4>>2]=O|1,o[s+4>>2]=ni|3,s=s+8|0,Vt=i,s|0}return s=_r()|0,o[s>>2]=12,s=0,Vt=i,s|0}function Jn(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0,$e=0;if(C){z=C+-8|0,ee=o[5833]|0,C=o[C+-4>>2]|0,D=C&-8,$e=z+D|0;do if(C&1)we=z,oe=z;else{if(R=o[z>>2]|0,!(C&3)||(oe=z+(0-R)|0,le=R+D|0,oe>>>0<ee>>>0))return;if((o[5834]|0)==(oe|0)){if(C=$e+4|0,D=o[C>>2]|0,(D&3|0)!=3){we=oe,D=le;break}o[5831]=le,o[C>>2]=D&-2,o[oe+4>>2]=le|1,o[oe+le>>2]=le;return}if(z=R>>>3,R>>>0<256)if(C=o[oe+8>>2]|0,D=o[oe+12>>2]|0,(D|0)==(C|0)){o[5829]=o[5829]&~(1<<z),we=oe,D=le;break}else{o[C+12>>2]=D,o[D+8>>2]=C,we=oe,D=le;break}ee=o[oe+24>>2]|0,C=o[oe+12>>2]|0;do if((C|0)==(oe|0)){if(D=oe+16|0,z=D+4|0,C=o[z>>2]|0,C)D=z;else if(C=o[D>>2]|0,!C){C=0;break}for(;;)if(R=C+20|0,z=o[R>>2]|0,z)C=z,D=R;else if(R=C+16|0,z=o[R>>2]|0,z)C=z,D=R;else break;o[D>>2]=0}else we=o[oe+8>>2]|0,o[we+12>>2]=C,o[C+8>>2]=we;while(!1);if(ee){if(D=o[oe+28>>2]|0,z=23620+(D<<2)|0,(o[z>>2]|0)==(oe|0)){if(o[z>>2]=C,!C){o[5830]=o[5830]&~(1<<D),we=oe,D=le;break}}else if(we=ee+16|0,o[((o[we>>2]|0)==(oe|0)?we:ee+20|0)>>2]=C,!C){we=oe,D=le;break}o[C+24>>2]=ee,D=oe+16|0,z=o[D>>2]|0,z|0&&(o[C+16>>2]=z,o[z+24>>2]=C),D=o[D+4>>2]|0,D?(o[C+20>>2]=D,o[D+24>>2]=C,we=oe,D=le):(we=oe,D=le)}else we=oe,D=le}while(!1);if(!(oe>>>0>=$e>>>0)&&(C=$e+4|0,R=o[C>>2]|0,!!(R&1))){if(R&2)o[C>>2]=R&-2,o[we+4>>2]=D|1,o[oe+D>>2]=D,ee=D;else{if((o[5835]|0)==($e|0)){if($e=(o[5832]|0)+D|0,o[5832]=$e,o[5835]=we,o[we+4>>2]=$e|1,(we|0)!=(o[5834]|0))return;o[5834]=0,o[5831]=0;return}if((o[5834]|0)==($e|0)){$e=(o[5831]|0)+D|0,o[5831]=$e,o[5834]=oe,o[we+4>>2]=$e|1,o[oe+$e>>2]=$e;return}ee=(R&-8)+D|0,z=R>>>3;do if(R>>>0<256)if(D=o[$e+8>>2]|0,C=o[$e+12>>2]|0,(C|0)==(D|0)){o[5829]=o[5829]&~(1<<z);break}else{o[D+12>>2]=C,o[C+8>>2]=D;break}else{le=o[$e+24>>2]|0,C=o[$e+12>>2]|0;do if((C|0)==($e|0)){if(D=$e+16|0,z=D+4|0,C=o[z>>2]|0,C)D=z;else if(C=o[D>>2]|0,!C){z=0;break}for(;;)if(R=C+20|0,z=o[R>>2]|0,z)C=z,D=R;else if(R=C+16|0,z=o[R>>2]|0,z)C=z,D=R;else break;o[D>>2]=0,z=C}else z=o[$e+8>>2]|0,o[z+12>>2]=C,o[C+8>>2]=z,z=C;while(!1);if(le|0){if(C=o[$e+28>>2]|0,D=23620+(C<<2)|0,(o[D>>2]|0)==($e|0)){if(o[D>>2]=z,!z){o[5830]=o[5830]&~(1<<C);break}}else if(R=le+16|0,o[((o[R>>2]|0)==($e|0)?R:le+20|0)>>2]=z,!z)break;o[z+24>>2]=le,C=$e+16|0,D=o[C>>2]|0,D|0&&(o[z+16>>2]=D,o[D+24>>2]=z),C=o[C+4>>2]|0,C|0&&(o[z+20>>2]=C,o[C+24>>2]=z)}}while(!1);if(o[we+4>>2]=ee|1,o[oe+ee>>2]=ee,(we|0)==(o[5834]|0)){o[5831]=ee;return}}if(C=ee>>>3,ee>>>0<256){z=23356+(C<<1<<2)|0,D=o[5829]|0,C=1<<C,D&C?(D=z+8|0,C=o[D>>2]|0):(o[5829]=D|C,C=z,D=z+8|0),o[D>>2]=we,o[C+12>>2]=we,o[we+8>>2]=C,o[we+12>>2]=z;return}C=ee>>>8,C?ee>>>0>16777215?R=31:(oe=(C+1048320|0)>>>16&8,$e=C<<oe,le=($e+520192|0)>>>16&4,$e=$e<<le,R=($e+245760|0)>>>16&2,R=14-(le|oe|R)+($e<<R>>>15)|0,R=ee>>>(R+7|0)&1|R<<1):R=0,C=23620+(R<<2)|0,o[we+28>>2]=R,o[we+20>>2]=0,o[we+16>>2]=0,D=o[5830]|0,z=1<<R;e:do if(!(D&z))o[5830]=D|z,o[C>>2]=we,o[we+24>>2]=C,o[we+12>>2]=we,o[we+8>>2]=we;else{C=o[C>>2]|0;t:do if((o[C+4>>2]&-8|0)!=(ee|0)){for(R=ee<<((R|0)==31?0:25-(R>>>1)|0);z=C+16+(R>>>31<<2)|0,D=o[z>>2]|0,!!D;)if((o[D+4>>2]&-8|0)==(ee|0)){C=D;break t}else R=R<<1,C=D;o[z>>2]=we,o[we+24>>2]=C,o[we+12>>2]=we,o[we+8>>2]=we;break e}while(!1);oe=C+8|0,$e=o[oe>>2]|0,o[$e+12>>2]=we,o[oe>>2]=we,o[we+8>>2]=$e,o[we+12>>2]=C,o[we+24>>2]=0}while(!1);if($e=(o[5837]|0)+-1|0,o[5837]=$e,!($e|0)){for(C=23772;C=o[C>>2]|0,C;)C=C+8|0;o[5837]=-1}}}}function tl(C,D){C=C|0,D=D|0;var z=0;return C?(z=jr(D,C)|0,(D|C)>>>0>65535&&(z=((z>>>0)/(C>>>0)|0|0)==(D|0)?z:-1)):z=0,C=jn(z)|0,!C||!(o[C+-4>>2]&3)||fs(C|0,0,z|0)|0,C|0}function Tu(C,D,z,R){return C=C|0,D=D|0,z=z|0,R=R|0,z=C+z>>>0,Vn(D+R+(z>>>0<C>>>0|0)>>>0|0),z|0|0}function oa(C,D,z,R){return C=C|0,D=D|0,z=z|0,R=R|0,R=D-R-(z>>>0>C>>>0|0)>>>0,Vn(R|0),C-z>>>0|0|0}function yu(C){return C=C|0,(C?31-(ur(C^C-1)|0)|0:32)|0}function vs(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,$e=0,_t=0,Ct=0,ni=0,Gt=0,Zt=0,Z=0;if(Ct=C,$e=D,_t=$e,oe=z,Gt=R,we=Gt,!_t)return le=(ee|0)!=0,we?le?(o[ee>>2]=C|0,o[ee+4>>2]=D&0,Gt=0,ee=0,Vn(Gt|0),ee|0):(Gt=0,ee=0,Vn(Gt|0),ee|0):(le&&(o[ee>>2]=(Ct>>>0)%(oe>>>0),o[ee+4>>2]=0),Gt=0,ee=(Ct>>>0)/(oe>>>0)>>>0,Vn(Gt|0),ee|0);le=(we|0)==0;do if(oe){if(!le){if(le=(ur(we|0)|0)-(ur(_t|0)|0)|0,le>>>0<=31){ni=le+1|0,we=31-le|0,D=le-31>>31,oe=ni,C=Ct>>>(ni>>>0)&D|_t<<we,D=_t>>>(ni>>>0)&D,le=0,we=Ct<<we;break}return ee?(o[ee>>2]=C|0,o[ee+4>>2]=$e|D&0,Gt=0,ee=0,Vn(Gt|0),ee|0):(Gt=0,ee=0,Vn(Gt|0),ee|0)}if(le=oe-1|0,le&oe|0){we=(ur(oe|0)|0)+33-(ur(_t|0)|0)|0,Z=64-we|0,ni=32-we|0,$e=ni>>31,Zt=we-32|0,D=Zt>>31,oe=we,C=ni-1>>31&_t>>>(Zt>>>0)|(_t<<ni|Ct>>>(we>>>0))&D,D=D&_t>>>(we>>>0),le=Ct<<Z&$e,we=(_t<<Z|Ct>>>(Zt>>>0))&$e|Ct<<ni&we-33>>31;break}return ee|0&&(o[ee>>2]=le&Ct,o[ee+4>>2]=0),(oe|0)==1?(Zt=$e|D&0,Z=C|0|0,Vn(Zt|0),Z|0):(Z=yu(oe|0)|0,Zt=_t>>>(Z>>>0)|0,Z=_t<<32-Z|Ct>>>(Z>>>0)|0,Vn(Zt|0),Z|0)}else{if(le)return ee|0&&(o[ee>>2]=(_t>>>0)%(oe>>>0),o[ee+4>>2]=0),Zt=0,Z=(_t>>>0)/(oe>>>0)>>>0,Vn(Zt|0),Z|0;if(!Ct)return ee|0&&(o[ee>>2]=0,o[ee+4>>2]=(_t>>>0)%(we>>>0)),Zt=0,Z=(_t>>>0)/(we>>>0)>>>0,Vn(Zt|0),Z|0;if(le=we-1|0,!(le&we))return ee|0&&(o[ee>>2]=C|0,o[ee+4>>2]=le&_t|D&0),Zt=0,Z=_t>>>((yu(we|0)|0)>>>0),Vn(Zt|0),Z|0;if(le=(ur(we|0)|0)-(ur(_t|0)|0)|0,le>>>0<=30){D=le+1|0,we=31-le|0,oe=D,C=_t<<we|Ct>>>(D>>>0),D=_t>>>(D>>>0),le=0,we=Ct<<we;break}return ee?(o[ee>>2]=C|0,o[ee+4>>2]=$e|D&0,Zt=0,Z=0,Vn(Zt|0),Z|0):(Zt=0,Z=0,Vn(Zt|0),Z|0)}while(!1);if(!oe)_t=we,$e=0,we=0;else{ni=z|0|0,Ct=Gt|R&0,_t=Tu(ni|0,Ct|0,-1,-1)|0,z=Wt()|0,$e=we,we=0;do R=$e,$e=le>>>31|$e<<1,le=we|le<<1,R=C<<1|R>>>31|0,Gt=C>>>31|D<<1|0,oa(_t|0,z|0,R|0,Gt|0)|0,Z=Wt()|0,Zt=Z>>31|((Z|0)<0?-1:0)<<1,we=Zt&1,C=oa(R|0,Gt|0,Zt&ni|0,(((Z|0)<0?-1:0)>>31|((Z|0)<0?-1:0)<<1)&Ct|0)|0,D=Wt()|0,oe=oe-1|0;while(oe|0);_t=$e,$e=0}return oe=0,ee|0&&(o[ee>>2]=C,o[ee+4>>2]=D),Zt=(le|0)>>>31|(_t|oe)<<1|(oe<<1|le>>>31)&0|$e,Z=(le<<1|0)&-2|we,Vn(Zt|0),Z|0}function Po(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0;return le=Vt,Vt=Vt+16|0,ee=le|0,vs(C,D,z,R,ee)|0,Vt=le,Vn(o[ee+4>>2]|0),o[ee>>2]|0|0}function Mi(C,D,z){return C=C|0,D=D|0,z=z|0,(z|0)<32?(Vn(D>>>z|0),C>>>z|(D&(1<<z)-1)<<32-z):(Vn(0),D>>>z-32|0)}function Bi(C,D,z){return C=C|0,D=D|0,z=z|0,(z|0)<32?(Vn(D<<z|(C&(1<<z)-1<<32-z)>>>32-z|0),C<<z):(Vn(C<<z-32|0),0)}function xs(C,D){return C=+C,D=+D,C!=C?+D:D!=D?+C:+Zi(+C,+D)}function vu(C){return C=+C,C>=0?+fi(C+.5):+qn(C-.5)}function Vo(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0;if((z|0)>=8192)return cr(C|0,D|0,z|0)|0,C|0;if(le=C|0,ee=C+z|0,(C&3)==(D&3)){for(;C&3;){if(!z)return le|0;kt[C>>0]=kt[D>>0]|0,C=C+1|0,D=D+1|0,z=z-1|0}for(z=ee&-4|0,R=z-64|0;(C|0)<=(R|0);)o[C>>2]=o[D>>2],o[C+4>>2]=o[D+4>>2],o[C+8>>2]=o[D+8>>2],o[C+12>>2]=o[D+12>>2],o[C+16>>2]=o[D+16>>2],o[C+20>>2]=o[D+20>>2],o[C+24>>2]=o[D+24>>2],o[C+28>>2]=o[D+28>>2],o[C+32>>2]=o[D+32>>2],o[C+36>>2]=o[D+36>>2],o[C+40>>2]=o[D+40>>2],o[C+44>>2]=o[D+44>>2],o[C+48>>2]=o[D+48>>2],o[C+52>>2]=o[D+52>>2],o[C+56>>2]=o[D+56>>2],o[C+60>>2]=o[D+60>>2],C=C+64|0,D=D+64|0;for(;(C|0)<(z|0);)o[C>>2]=o[D>>2],C=C+4|0,D=D+4|0}else for(z=ee-4|0;(C|0)<(z|0);)kt[C>>0]=kt[D>>0]|0,kt[C+1>>0]=kt[D+1>>0]|0,kt[C+2>>0]=kt[D+2>>0]|0,kt[C+3>>0]=kt[D+3>>0]|0,C=C+4|0,D=D+4|0;for(;(C|0)<(ee|0);)kt[C>>0]=kt[D>>0]|0,C=C+1|0,D=D+1|0;return le|0}function fs(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0;if(le=C+z|0,D=D&255,(z|0)>=67){for(;C&3;)kt[C>>0]=D,C=C+1|0;for(R=le&-4|0,oe=D|D<<8|D<<16|D<<24,ee=R-64|0;(C|0)<=(ee|0);)o[C>>2]=oe,o[C+4>>2]=oe,o[C+8>>2]=oe,o[C+12>>2]=oe,o[C+16>>2]=oe,o[C+20>>2]=oe,o[C+24>>2]=oe,o[C+28>>2]=oe,o[C+32>>2]=oe,o[C+36>>2]=oe,o[C+40>>2]=oe,o[C+44>>2]=oe,o[C+48>>2]=oe,o[C+52>>2]=oe,o[C+56>>2]=oe,o[C+60>>2]=oe,C=C+64|0;for(;(C|0)<(R|0);)o[C>>2]=oe,C=C+4|0}for(;(C|0)<(le|0);)kt[C>>0]=D,C=C+1|0;return le-z|0}function hl(C){return C=+C,C>=0?+fi(C+.5):+qn(C-.5)}function Ms(C){C=C|0;var D=0,z=0,R=0;return R=Tn()|0,z=o[ai>>2]|0,D=z+C|0,(C|0)>0&(D|0)<(z|0)|(D|0)<0?(Ur(D|0)|0,Ut(12),-1):(D|0)>(R|0)&&!(Vs(D|0)|0)?(Ut(12),-1):(o[ai>>2]=D,z|0)}return{___uremdi3:Po,_bitshift64Lshr:Mi,_bitshift64Shl:Bi,_calloc:tl,_cellAreaKm2:Ol,_cellAreaM2:es,_cellAreaRads2:Gn,_compact:Tl,_destroyLinkedPolygon:lr,_edgeLengthKm:Wa,_edgeLengthM:Jr,_emscripten_replace_memory:hr,_exactEdgeLengthKm:Ts,_exactEdgeLengthM:kr,_exactEdgeLengthRads:Zr,_experimentalH3ToLocalIj:Ya,_experimentalLocalIjToH3:yo,_free:Jn,_geoToH3:ha,_getDestinationH3IndexFromUnidirectionalEdge:Di,_getH3IndexesFromUnidirectionalEdge:ii,_getH3UnidirectionalEdge:pi,_getH3UnidirectionalEdgeBoundary:Fi,_getH3UnidirectionalEdgesFromHexagon:bi,_getOriginH3IndexFromUnidirectionalEdge:Ui,_getPentagonIndexes:gl,_getRes0Indexes:Ar,_h3Distance:rs,_h3GetBaseCell:ll,_h3GetFaces:cl,_h3GetResolution:rr,_h3IndexesAreNeighbors:ao,_h3IsPentagon:ds,_h3IsResClassIII:go,_h3IsValid:Xr,_h3Line:Ru,_h3LineSize:Wu,_h3SetToLinkedGeo:Ga,_h3ToCenterChild:wa,_h3ToChildren:Qr,_h3ToGeo:Sa,_h3ToGeoBoundary:ka,_h3ToParent:ko,_h3UnidirectionalEdgeIsValid:Ft,_hexAreaKm2:Ko,_hexAreaM2:zr,_hexRing:aa,_i64Subtract:oa,_kRing:Na,_kRingDistances:Fo,_llvm_minnum_f64:xs,_llvm_round_f64:vu,_malloc:jn,_maxFaceCount:Xa,_maxH3ToChildrenSize:ul,_maxKringSize:Dr,_maxPolyfillSize:hs,_maxUncompactSize:kl,_memcpy:Vo,_memset:fs,_numHexagons:fr,_pentagonIndexCount:lu,_pointDistKm:Cs,_pointDistM:gu,_pointDistRads:Qa,_polyfill:Ua,_res0IndexCount:sr,_round:hl,_sbrk:Ms,_sizeOfCoordIJ:uu,_sizeOfGeoBoundary:En,_sizeOfGeoCoord:Nl,_sizeOfGeoPolygon:Cn,_sizeOfGeofence:Wl,_sizeOfH3Index:No,_sizeOfLinkedGeoPolygon:_l,_uncompact:Mo,establishStackSpace:ua,stackAlloc:Bt,stackRestore:Us,stackSave:Fr}}(st,Me,Et);t.___uremdi3=se.___uremdi3,t._bitshift64Lshr=se._bitshift64Lshr,t._bitshift64Shl=se._bitshift64Shl,t._calloc=se._calloc,t._cellAreaKm2=se._cellAreaKm2,t._cellAreaM2=se._cellAreaM2,t._cellAreaRads2=se._cellAreaRads2,t._compact=se._compact,t._destroyLinkedPolygon=se._destroyLinkedPolygon,t._edgeLengthKm=se._edgeLengthKm,t._edgeLengthM=se._edgeLengthM;var ne=t._emscripten_replace_memory=se._emscripten_replace_memory;t._exactEdgeLengthKm=se._exactEdgeLengthKm,t._exactEdgeLengthM=se._exactEdgeLengthM,t._exactEdgeLengthRads=se._exactEdgeLengthRads,t._experimentalH3ToLocalIj=se._experimentalH3ToLocalIj,t._experimentalLocalIjToH3=se._experimentalLocalIjToH3,t._free=se._free,t._geoToH3=se._geoToH3,t._getDestinationH3IndexFromUnidirectionalEdge=se._getDestinationH3IndexFromUnidirectionalEdge,t._getH3IndexesFromUnidirectionalEdge=se._getH3IndexesFromUnidirectionalEdge,t._getH3UnidirectionalEdge=se._getH3UnidirectionalEdge,t._getH3UnidirectionalEdgeBoundary=se._getH3UnidirectionalEdgeBoundary,t._getH3UnidirectionalEdgesFromHexagon=se._getH3UnidirectionalEdgesFromHexagon,t._getOriginH3IndexFromUnidirectionalEdge=se._getOriginH3IndexFromUnidirectionalEdge,t._getPentagonIndexes=se._getPentagonIndexes,t._getRes0Indexes=se._getRes0Indexes,t._h3Distance=se._h3Distance,t._h3GetBaseCell=se._h3GetBaseCell,t._h3GetFaces=se._h3GetFaces,t._h3GetResolution=se._h3GetResolution,t._h3IndexesAreNeighbors=se._h3IndexesAreNeighbors,t._h3IsPentagon=se._h3IsPentagon,t._h3IsResClassIII=se._h3IsResClassIII,t._h3IsValid=se._h3IsValid,t._h3Line=se._h3Line,t._h3LineSize=se._h3LineSize,t._h3SetToLinkedGeo=se._h3SetToLinkedGeo,t._h3ToCenterChild=se._h3ToCenterChild,t._h3ToChildren=se._h3ToChildren,t._h3ToGeo=se._h3ToGeo,t._h3ToGeoBoundary=se._h3ToGeoBoundary,t._h3ToParent=se._h3ToParent,t._h3UnidirectionalEdgeIsValid=se._h3UnidirectionalEdgeIsValid,t._hexAreaKm2=se._hexAreaKm2,t._hexAreaM2=se._hexAreaM2,t._hexRing=se._hexRing,t._i64Subtract=se._i64Subtract,t._kRing=se._kRing,t._kRingDistances=se._kRingDistances,t._llvm_minnum_f64=se._llvm_minnum_f64,t._llvm_round_f64=se._llvm_round_f64,t._malloc=se._malloc,t._maxFaceCount=se._maxFaceCount,t._maxH3ToChildrenSize=se._maxH3ToChildrenSize,t._maxKringSize=se._maxKringSize,t._maxPolyfillSize=se._maxPolyfillSize,t._maxUncompactSize=se._maxUncompactSize,t._memcpy=se._memcpy,t._memset=se._memset,t._numHexagons=se._numHexagons,t._pentagonIndexCount=se._pentagonIndexCount,t._pointDistKm=se._pointDistKm,t._pointDistM=se._pointDistM,t._pointDistRads=se._pointDistRads,t._polyfill=se._polyfill,t._res0IndexCount=se._res0IndexCount,t._round=se._round,t._sbrk=se._sbrk,t._sizeOfCoordIJ=se._sizeOfCoordIJ,t._sizeOfGeoBoundary=se._sizeOfGeoBoundary,t._sizeOfGeoCoord=se._sizeOfGeoCoord,t._sizeOfGeoPolygon=se._sizeOfGeoPolygon,t._sizeOfGeofence=se._sizeOfGeofence,t._sizeOfH3Index=se._sizeOfH3Index,t._sizeOfLinkedGeoPolygon=se._sizeOfLinkedGeoPolygon,t._uncompact=se._uncompact,t.establishStackSpace=se.establishStackSpace;var $=t.stackAlloc=se.stackAlloc,ie=t.stackRestore=se.stackRestore,de=t.stackSave=se.stackSave;if(t.asm=se,t.cwrap=xt,t.setValue=be,t.getValue=je,t.getTempRet0=ae,rn){Pn(rn)||(rn=x(rn));{Pr();var ye=function(De){De.byteLength&&(De=new Uint8Array(De)),dt.set(De,ue),t.memoryInitializerRequest&&delete t.memoryInitializerRequest.response,ci()},ge=function(){S(rn,ye,function(){throw"could not load memory initializer "+rn})},Pe=ft(rn);if(Pe)ye(Pe.buffer);else if(t.memoryInitializerRequest){var Fe=function(){var De=t.memoryInitializerRequest,Ge=De.response;if(De.status!==200&&De.status!==0){var ht=ft(t.memoryInitializerRequestURL);if(ht)Ge=ht.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+De.status+", retrying "+rn),ge();return}}ye(Ge)};t.memoryInitializerRequest.response?setTimeout(Fe,0):t.memoryInitializerRequest.addEventListener("load",Fe)}else ge()}}var Ve;_n=function De(){Ve||Xe(),Ve||(_n=De)};function Xe(De){if(ei>0||(nn(),ei>0))return;function Ge(){Ve||(Ve=!0,!nt&&(vn(),Ci(),t.onRuntimeInitialized&&t.onRuntimeInitialized(),mi()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),Ge()},1)):Ge()}t.run=Xe;function Ye(De){throw t.onAbort&&t.onAbort(De),De+="",a(De),G(De),nt=!0,"abort("+De+"). Build with -s ASSERTIONS=1 for more info."}if(t.abort=Ye,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return Xe(),e}(typeof Mn=="object"?Mn:{}),Mr="number",Km=Mr,ss=Mr,Fs=Mr,Nc=Mr,xa=Mr,lN=[["sizeOfH3Index",Mr],["sizeOfGeoCoord",Mr],["sizeOfGeoBoundary",Mr],["sizeOfGeoPolygon",Mr],["sizeOfGeofence",Mr],["sizeOfLinkedGeoPolygon",Mr],["sizeOfCoordIJ",Mr],["h3IsValid",Km,[ss,Fs]],["geoToH3",ss,[Mr,Mr,Nc]],["h3ToGeo",null,[ss,Fs,xa]],["h3ToGeoBoundary",null,[ss,Fs,xa]],["maxKringSize",Mr,[Mr]],["kRing",null,[ss,Fs,Mr,xa]],["kRingDistances",null,[ss,Fs,Mr,xa,xa]],["hexRing",null,[ss,Fs,Mr,xa]],["maxPolyfillSize",Mr,[xa,Nc]],["polyfill",null,[xa,Nc,xa]],["h3SetToLinkedGeo",null,[xa,Mr,xa]],["destroyLinkedPolygon",null,[xa]],["compact",Mr,[xa,xa,Mr]],["uncompact",Mr,[xa,Mr,xa,Mr,Nc]],["maxUncompactSize",Mr,[xa,Mr,Nc]],["h3IsPentagon",Km,[ss,Fs]],["h3IsResClassIII",Km,[ss,Fs]],["h3GetBaseCell",Mr,[ss,Fs]],["h3GetResolution",Mr,[ss,Fs]],["maxFaceCount",Mr,[ss,Fs]],["h3GetFaces",null,[ss,Fs,xa]],["h3ToParent",ss,[ss,Fs,Nc]],["h3ToChildren",null,[ss,Fs,Nc,xa]],["h3ToCenterChild",ss,[ss,Fs,Nc]],["maxH3ToChildrenSize",Mr,[ss,Fs,Nc]],["h3IndexesAreNeighbors",Km,[ss,Fs,ss,Fs]],["getH3UnidirectionalEdge",ss,[ss,Fs,ss,Fs]],["getOriginH3IndexFromUnidirectionalEdge",ss,[ss,Fs]],["getDestinationH3IndexFromUnidirectionalEdge",ss,[ss,Fs]],["h3UnidirectionalEdgeIsValid",Km,[ss,Fs]],["getH3IndexesFromUnidirectionalEdge",null,[ss,Fs,xa]],["getH3UnidirectionalEdgesFromHexagon",null,[ss,Fs,xa]],["getH3UnidirectionalEdgeBoundary",null,[ss,Fs,xa]],["h3Distance",Mr,[ss,Fs,ss,Fs]],["h3Line",Mr,[ss,Fs,ss,Fs,xa]],["h3LineSize",Mr,[ss,Fs,ss,Fs]],["experimentalH3ToLocalIj",Mr,[ss,Fs,ss,Fs,xa]],["experimentalLocalIjToH3",Mr,[ss,Fs,xa,xa]],["hexAreaM2",Mr,[Nc]],["hexAreaKm2",Mr,[Nc]],["edgeLengthM",Mr,[Nc]],["edgeLengthKm",Mr,[Nc]],["pointDistM",Mr,[xa,xa]],["pointDistKm",Mr,[xa,xa]],["pointDistRads",Mr,[xa,xa]],["cellAreaM2",Mr,[ss,Fs]],["cellAreaKm2",Mr,[ss,Fs]],["cellAreaRads2",Mr,[ss,Fs]],["exactEdgeLengthM",Mr,[ss,Fs]],["exactEdgeLengthKm",Mr,[ss,Fs]],["exactEdgeLengthRads",Mr,[ss,Fs]],["numHexagons",Mr,[Nc]],["getRes0Indexes",null,[xa]],["res0IndexCount",Mr],["getPentagonIndexes",null,[Mr,xa]],["pentagonIndexCount",Mr]],ar={};lN.forEach(function(t){ar[t[0]]=Mn.cwrap.apply(Mn,t)});var rm=16,_c=4,Ew=4,U0=8,rc=ar.sizeOfH3Index(),m1=ar.sizeOfGeoCoord(),p5=ar.sizeOfGeoBoundary(),uN=ar.sizeOfGeoPolygon(),hg=ar.sizeOfGeofence(),cN=ar.sizeOfLinkedGeoPolygon(),m5=ar.sizeOfCoordIJ(),Gc={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function Im(e){if(typeof e!="number"||e<0||e>15||Math.floor(e)!==e)throw new Error("Invalid resolution: "+e)}var hN=/[^0-9a-fA-F]/;function ga(e){if(Array.isArray(e)&&e.length===2&&Number.isInteger(e[0])&&Number.isInteger(e[1]))return e;if(typeof e!="string"||hN.test(e))return[0,0];var t=parseInt(e.substring(0,e.length-8),rm),n=parseInt(e.substring(e.length-8),rm);return[n,t]}function Cw(e){if(e>=0)return e.toString(rm);e=e&2147483647;var t=g5(8,e.toString(rm)),n=(parseInt(t[0],rm)+8).toString(rm);return t=n+t.substring(1),t}function g1(e,t){return Cw(t)+g5(8,Cw(e))}function g5(e,t){for(var n=e-t.length,c="",g=0;g<n;g++)c+="0";return c=c+t,c}function Tw(e,t,n){for(var c=e.length,g=Mn._calloc(c,m1),x=n?1:0,S=n?0:1,a=0;a<c*2;a+=2)Mn.HEAPF64.set([e[a/2][x],e[a/2][S]].map(_1),g/U0+a);return Mn.HEAPU32.set([c,g],t/_c),t}function AN(e,t){var n=e.length-1,c=Mn._calloc(uN),g=0,x=g+hg,S=x+_c;Tw(e[0],c+g,t);var a;if(n>0){a=Mn._calloc(n,hg);for(var G=0;G<n;G++)Tw(e[G+1],a+hg*G,t)}return Mn.setValue(c+x,n,"i32"),Mn.setValue(c+S,a,"i32"),c}function fN(e){var t=0,n=t+hg,c=n+_c,g=_c;Mn._free(Mn.getValue(e+t+g,"i8*"));var x=Mn.getValue(e+n,"i32");if(x>0){for(var S=Mn.getValue(e+c,"i32"),a=0;a<x;a++)Mn._free(Mn.getValue(S+hg*a+g,"i8*"));Mn._free(S)}Mn._free(e)}function _5(e){var t=Mn.getTempRet0();return[e,t]}function Em(e){var t=_5(e),n=t[0],c=t[1];return c?g1(n,c):null}function y5(e,t){t===void 0&&(t=0);var n=Mn.getValue(e+_c*t*2,"i32"),c=Mn.getValue(e+_c*(t*2+1),"i32");return c?g1(n,c):null}function dN(e,t,n){Mn.HEAPU32.set(ga(e),t/_c+2*n)}function dA(e,t){for(var n=[],c=0;c<t;c++){var g=y5(e,c);g!==null&&n.push(g)}return n}function C2(e,t){for(var n=t.length,c=0;c<n;c++)dN(t[c],e,c)}function kw(e,t){var n=Mn._calloc(1,m1);return Mn.HEAPF64.set([e,t].map(_1),n/U0),n}function j_(e){return w5(Mn.getValue(e,"double"))}function T2(e){return[j_(e),j_(e+U0)]}function v5(e){return[j_(e+U0),j_(e)]}function x5(e,t,n){for(var c=Mn.getValue(e,"i32"),g=e+U0,x=[],S=t?v5:T2,a=0;a<c*2;a+=2)x.push(S(g+U0*a));return n&&x.push(x[0]),x}function pN(e,t){for(var n=[],c=t?v5:T2,g,x,S,a;e;){for(n.push(g=[]),x=Mn.getValue(e,"i8*");x;){for(g.push(S=[]),a=Mn.getValue(x,"i8*");a;)S.push(c(a)),a=Mn.getValue(a+U0*2,"i8*");t&&S.push(S[0]),x=Mn.getValue(x+Ew*2,"i8*")}e=Mn.getValue(e+Ew*2,"i8*")}return n}function mN(e){return{i:Mn.getValue(e,"i32"),j:Mn.getValue(e+_c,"i32")}}function gN(e,t){var n=t.i,c=t.j;Mn.setValue(e,n,"i32"),Mn.setValue(e+_c,c,"i32")}function _N(e,t){for(var n=[],c=0;c<t;c++){var g=Mn.getValue(e+_c*c,"i32");g>=0&&n.push(g)}return n}function b5(e){var t=ga(e),n=t[0],c=t[1];return!!ar.h3IsValid(n,c)}function yN(e){var t=ga(e),n=t[0],c=t[1];return!!ar.h3IsPentagon(n,c)}function vN(e){var t=ga(e),n=t[0],c=t[1];return!!ar.h3IsResClassIII(n,c)}function xN(e){var t=ga(e),n=t[0],c=t[1];return ar.h3GetBaseCell(n,c)}function bN(e){var t=ga(e),n=t[0],c=t[1],g=ar.maxFaceCount(n,c),x=Mn._malloc(_c*g);ar.h3GetFaces(n,c,x);var S=_N(x,g);return Mn._free(x),S}function wN(e){var t=ga(e),n=t[0],c=t[1];return ar.h3IsValid(n,c)?ar.h3GetResolution(n,c):-1}function SN(e,t,n){var c=Mn._malloc(m1);Mn.HEAPF64.set([e,t].map(_1),c/U0);var g=Em(ar.geoToH3(c,n));return Mn._free(c),g}function IN(e){var t=Mn._malloc(m1),n=ga(e),c=n[0],g=n[1];ar.h3ToGeo(c,g,t);var x=T2(t);return Mn._free(t),x}function EN(e,t){var n=Mn._malloc(p5),c=ga(e),g=c[0],x=c[1];ar.h3ToGeoBoundary(g,x,n);var S=x5(n,t,t);return Mn._free(n),S}function CN(e,t){var n=ga(e),c=n[0],g=n[1];return Em(ar.h3ToParent(c,g,t))}function TN(e,t){if(!b5(e))return[];var n=ga(e),c=n[0],g=n[1],x=ar.maxH3ToChildrenSize(c,g,t),S=Mn._calloc(x,rc);ar.h3ToChildren(c,g,t,S);var a=dA(S,x);return Mn._free(S),a}function kN(e,t){var n=ga(e),c=n[0],g=n[1];return Em(ar.h3ToCenterChild(c,g,t))}function MN(e,t){var n=ga(e),c=n[0],g=n[1],x=ar.maxKringSize(t),S=Mn._calloc(x,rc);ar.kRing(c,g,t,S);var a=dA(S,x);return Mn._free(S),a}function PN(e,t){var n=ga(e),c=n[0],g=n[1],x=ar.maxKringSize(t),S=Mn._calloc(x,rc),a=Mn._calloc(x,_c);ar.kRingDistances(c,g,t,S,a);for(var G=[],W=0;W<t+1;W++)G.push([]);for(var he=0;he<x*2;he+=2){var ae=Mn.getValue(S+_c*he,"i32"),ue=Mn.getValue(S+_c*(he+1),"i32"),be=Mn.getValue(a+_c*(he/2),"i32");(ae!==0||ue!==0)&&G[be].push(g1(ae,ue))}return Mn._free(S),Mn._free(a),G}function DN(e,t){var n=t===0?1:6*t,c=Mn._calloc(n,rc),g=ar.hexRing.apply(ar,ga(e).concat([t],[c]));if(g!==0)throw Mn._free(c),new Error("Failed to get hexRing (encountered a pentagon?)");var x=dA(c,n);return Mn._free(c),x}function LN(e,t,n){if(Im(t),n=!!n,e.length===0||e[0].length===0)return[];typeof e[0][0]=="number"&&(e=[e]);var c=AN(e,n),g=ar.maxPolyfillSize(c,t),x=Mn._calloc(g,rc);ar.polyfill(c,t,x);var S=dA(x,g);return Mn._free(x),fN(c),S}function BN(e,t){if(!e||!e.length)return[];var n=e.length,c=Mn._calloc(n,rc);C2(c,e);var g=Mn._calloc(cN),x=g;ar.h3SetToLinkedGeo(c,n,g);var S=pN(g,t);return ar.destroyLinkedPolygon(x),Mn._free(x),Mn._free(c),S}function zN(e){if(!e||!e.length)return[];var t=e.length,n=Mn._calloc(t,rc);C2(n,e);var c=Mn._calloc(t,rc),g=ar.compact(n,c,t);if(g!==0)throw Mn._free(n),Mn._free(c),new Error("Failed to compact, malformed input data (duplicate hexagons?)");var x=dA(c,t);return Mn._free(n),Mn._free(c),x}function RN(e,t){if(Im(t),!e||!e.length)return[];var n=e.length,c=Mn._calloc(n,rc);C2(c,e);var g=ar.maxUncompactSize(c,n,t),x=Mn._calloc(g,rc),S=ar.uncompact(c,n,x,g,t);if(S!==0)throw Mn._free(c),Mn._free(x),new Error("Failed to uncompact (bad resolution?)");var a=dA(x,g);return Mn._free(c),Mn._free(x),a}function FN(e,t){var n=ga(e),c=n[0],g=n[1],x=ga(t),S=x[0],a=x[1];return!!ar.h3IndexesAreNeighbors(c,g,S,a)}function ON(e,t){var n=ga(e),c=n[0],g=n[1],x=ga(t),S=x[0],a=x[1];return Em(ar.getH3UnidirectionalEdge(c,g,S,a))}function NN(e){var t=ga(e),n=t[0],c=t[1];return Em(ar.getOriginH3IndexFromUnidirectionalEdge(n,c))}function VN(e){var t=ga(e),n=t[0],c=t[1];return Em(ar.getDestinationH3IndexFromUnidirectionalEdge(n,c))}function UN(e){var t=ga(e),n=t[0],c=t[1];return!!ar.h3UnidirectionalEdgeIsValid(n,c)}function GN(e){var t=ga(e),n=t[0],c=t[1],g=2,x=Mn._calloc(g,rc);ar.getH3IndexesFromUnidirectionalEdge(n,c,x);var S=dA(x,g);return Mn._free(x),S}function qN(e){var t=ga(e),n=t[0],c=t[1],g=6,x=Mn._calloc(g,rc);ar.getH3UnidirectionalEdgesFromHexagon(n,c,x);var S=dA(x,g);return Mn._free(x),S}function HN(e,t){var n=Mn._malloc(p5),c=ga(e),g=c[0],x=c[1];ar.getH3UnidirectionalEdgeBoundary(g,x,n);var S=x5(n,t);return Mn._free(n),S}function jN(e,t){var n=ga(e),c=n[0],g=n[1],x=ga(t),S=x[0],a=x[1];return ar.h3Distance(c,g,S,a)}function ZN(e,t){var n=ga(e),c=n[0],g=n[1],x=ga(t),S=x[0],a=x[1],G=ar.h3LineSize(c,g,S,a);if(G<0)throw new Error("Line cannot be calculated");var W=Mn._calloc(G,rc);ar.h3Line(c,g,S,a,W);var he=dA(W,G);return Mn._free(W),he}function QN(e,t){var n=Mn._malloc(m5),c=ar.experimentalH3ToLocalIj.apply(ar,ga(e).concat(ga(t),[n])),g=mN(n);switch(Mn._free(n),c){case 0:return g;case 1:throw new Error("Incompatible origin and index.");case 2:default:throw new Error("Local IJ coordinates undefined for this origin and index pair. The index may be too far from the origin.");case 3:case 4:case 5:throw new Error("Encountered possible pentagon distortion")}}function WN(e,t){if(!t||typeof t.i!="number"||typeof t.j!="number")throw new Error("Coordinates must be provided as an {i, j} object");var n=Mn._malloc(m5),c=Mn._malloc(rc);gN(n,t);var g=ar.experimentalLocalIjToH3.apply(ar,ga(e).concat([n],[c])),x=y5(c);if(Mn._free(n),Mn._free(c),g!==0)throw new Error("Index not defined for this origin and IJ coordinates pair. IJ coordinates may be too far from origin, or a pentagon distortion was encountered.");return x}function $N(e,t,n){var c=kw(e[0],e[1]),g=kw(t[0],t[1]),x;switch(n){case Gc.m:x=ar.pointDistM(c,g);break;case Gc.km:x=ar.pointDistKm(c,g);break;case Gc.rads:x=ar.pointDistRads(c,g);break;default:x=null}if(Mn._free(c),Mn._free(g),x===null)throw new Error("Unknown unit: "+n);return x}function XN(e,t){var n=ga(e),c=n[0],g=n[1];switch(t){case Gc.m2:return ar.cellAreaM2(c,g);case Gc.km2:return ar.cellAreaKm2(c,g);case Gc.rads2:return ar.cellAreaRads2(c,g);default:throw new Error("Unknown unit: "+t)}}function YN(e,t){var n=ga(e),c=n[0],g=n[1];switch(t){case Gc.m:return ar.exactEdgeLengthM(c,g);case Gc.km:return ar.exactEdgeLengthKm(c,g);case Gc.rads:return ar.exactEdgeLengthRads(c,g);default:throw new Error("Unknown unit: "+t)}}function KN(e,t){switch(Im(e),t){case Gc.m2:return ar.hexAreaM2(e);case Gc.km2:return ar.hexAreaKm2(e);default:throw new Error("Unknown unit: "+t)}}function JN(e,t){switch(Im(e),t){case Gc.m:return ar.edgeLengthM(e);case Gc.km:return ar.edgeLengthKm(e);default:throw new Error("Unknown unit: "+t)}}function eV(e){Im(e);var t=_5(ar.numHexagons(e)),n=t[0],c=t[1];return c?c*Math.pow(2,32)+n:n}function tV(){var e=ar.res0IndexCount(),t=Mn._malloc(rc*e);ar.getRes0Indexes(t);var n=dA(t,e);return Mn._free(t),n}function iV(e){Im(e);var t=ar.pentagonIndexCount(),n=Mn._malloc(rc*t);ar.getPentagonIndexes(e,n);var c=dA(n,t);return Mn._free(n),c}function _1(e){return e*Math.PI/180}function w5(e){return e*180/Math.PI}const nV=Object.freeze(Object.defineProperty({__proto__:null,UNITS:Gc,cellArea:XN,compact:zN,degsToRads:_1,edgeLength:JN,exactEdgeLength:YN,experimentalH3ToLocalIj:QN,experimentalLocalIjToH3:WN,geoToH3:SN,getDestinationH3IndexFromUnidirectionalEdge:VN,getH3IndexesFromUnidirectionalEdge:GN,getH3UnidirectionalEdge:ON,getH3UnidirectionalEdgeBoundary:HN,getH3UnidirectionalEdgesFromHexagon:qN,getOriginH3IndexFromUnidirectionalEdge:NN,getPentagonIndexes:iV,getRes0Indexes:tV,h3Distance:jN,h3GetBaseCell:xN,h3GetFaces:bN,h3GetResolution:wN,h3IndexToSplitLong:ga,h3IndexesAreNeighbors:FN,h3IsPentagon:yN,h3IsResClassIII:vN,h3IsValid:b5,h3Line:ZN,h3SetToMultiPolygon:BN,h3ToCenterChild:kN,h3ToChildren:TN,h3ToGeo:IN,h3ToGeoBoundary:EN,h3ToParent:CN,h3UnidirectionalEdgeIsValid:UN,hexArea:KN,hexRing:DN,kRing:MN,kRingDistances:PN,numHexagons:eV,pointDist:$N,polyfill:LN,radsToDegs:w5,splitLongToh3Index:g1,uncompact:RN},Symbol.toStringTag,{value:"Module"})),rV=zv(nV);var Eg=rV,y1="Feature",S5="FeatureCollection",Z_="Polygon",k2="MultiPolygon";function I5(e){for(var t=null,n=0;n<e.length;n++)if(t!==null)for(var c=0;c<e[n].length;c++)t.push(e[n][c]);else t=e[n];return Array.from(new Set(t))}function sV(e){for(var t=0,n=0,c=0,g=e[0],x=0;x<g.length;x++)t+=g[x][0],n+=g[x][1],c++;return[t/c,n/c]}function aV(e,t){var n=e.features;if(!n)throw new Error("No features found");return I5(n.map(function(c){return E5(c,t)}))}function E5(e,t,n){n===void 0&&(n={});var c=e.type,g=e.geometry,x=g&&g.type;if(c===S5)return aV(e,t);if(c!==y1)throw new Error("Unhandled type: "+c);if(x!==Z_&&x!==k2)throw new Error("Unhandled geometry type: "+x);var S=x===Z_?[g.coordinates]:g.coordinates;return I5(S.map(function(a){var G=Eg.polyfill(a,t,!0);if(G.length||!n.ensureOutput)return G;var W=sV(a),he=W[0],ae=W[1];return[Eg.geoToH3(ae,he,t)]}))}function C5(e,t){t===void 0&&(t={});var n=[Eg.h3ToGeoBoundary(e,!0)];return{type:y1,id:e,properties:t,geometry:{type:Z_,coordinates:n}}}function oV(e,t){t===void 0&&(t={});var n=Eg.h3SetToMultiPolygon(e,!0),c=n.length>1,g=c?k2:Z_,x=c?n:n[0]||[];return{type:y1,properties:t,geometry:{type:g,coordinates:x}}}function lV(e,t){t===void 0&&(t={});var n=e.map(function(c){return[Eg.h3ToGeoBoundary(c,{geoJson:!0})]});return{type:y1,properties:t,geometry:{type:k2,coordinates:n}}}function uV(e,t){for(var n=[],c=0;c<e.length;c++){var g=e[c],x=t?t(g):{};n.push(C5(g,x))}return{type:S5,features:n}}var cV={featureToH3Set:E5,h3ToFeature:C5,h3SetToFeature:oV,h3SetToMultiPolygonFeature:lV,h3SetToFeatureCollection:uV},T5=cV,Ca=function(e){e=e||{};var t=typeof e<"u"?e:{},n={},c;for(c in t)t.hasOwnProperty(c)&&(n[c]=t[c]);var g="";function x(De){return t.locateFile?t.locateFile(De,g):g+De}var S;typeof document<"u"&&document.currentScript&&(g=document.currentScript.src),g.indexOf("blob:")!==0?g=g.substr(0,g.lastIndexOf("/")+1):g="",S=function(Ge,ht,kt){var o=new XMLHttpRequest;o.open("GET",Ge,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status==200||o.status==0&&o.response){ht(o.response);return}var ai=ft(Ge);if(ai){ht(ai.buffer);return}kt()},o.onerror=kt,o.send(null)};var a=t.print||console.log.bind(console),G=t.printErr||console.warn.bind(console);for(c in n)n.hasOwnProperty(c)&&(t[c]=n[c]);n=null,t.arguments&&t.arguments;var W=0,he=function(De){W=De},ae=function(){return W},ue=8;function be(De,Ge,ht,kt){switch(ht=ht||"i8",ht.charAt(ht.length-1)==="*"&&(ht="i32"),ht){case"i1":Pt[De>>0]=Ge;break;case"i8":Pt[De>>0]=Ge;break;case"i16":Je[De>>1]=Ge;break;case"i32":pt[De>>2]=Ge;break;case"i64":In=[Ge>>>0,(Qn=Ge,+_i(Qn)>=1?Qn>0?(sn(+Ai(Qn/4294967296),4294967295)|0)>>>0:~~+Ji((Qn-+(~~Qn>>>0))/4294967296)>>>0:0)],pt[De>>2]=In[0],pt[De+4>>2]=In[1];break;case"float":lt[De>>2]=Ge;break;case"double":Nt[De>>3]=Ge;break;default:Ye("invalid type for setValue: "+ht)}}function je(De,Ge,ht){switch(Ge=Ge||"i8",Ge.charAt(Ge.length-1)==="*"&&(Ge="i32"),Ge){case"i1":return Pt[De>>0];case"i8":return Pt[De>>0];case"i16":return Je[De>>1];case"i32":return pt[De>>2];case"i64":return pt[De>>2];case"float":return lt[De>>2];case"double":return Nt[De>>3];default:Ye("invalid type for getValue: "+Ge)}return null}var nt=!1;function tt(De,Ge){De||Ye("Assertion failed: "+Ge)}function at(De){var Ge=t["_"+De];return tt(Ge,"Cannot call unknown function "+De+", make sure it is exported"),Ge}function ut(De,Ge,ht,kt,o){var ke={string:function(Si){var Yt=0;if(Si!=null&&Si!==0){var bn=(Si.length<<2)+1;Yt=$(bn),it(Si,Yt,bn)}return Yt},array:function(Si){var Yt=$(Si.length);return vt(Si,Yt),Yt}};function ai(Si){return Ge==="string"?Oe(Si):Ge==="boolean"?!!Si:Si}var fi=at(De),hi=[],Jt=0;if(kt)for(var oi=0;oi<kt.length;oi++){var zi=ke[ht[oi]];zi?(Jt===0&&(Jt=de()),hi[oi]=zi(kt[oi])):hi[oi]=kt[oi]}var xi=fi.apply(null,hi);return xi=ai(xi),Jt!==0&&ie(Jt),xi}function xt(De,Ge,ht,kt){ht=ht||[];var o=ht.every(function(ai){return ai==="number"}),ke=Ge!=="string";return ke&&o&&!kt?at(De):function(){return ut(De,Ge,ht,arguments)}}var Tt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Mt(De,Ge,ht){for(var kt=Ge+ht,o=Ge;De[o]&&!(o>=kt);)++o;if(o-Ge>16&&De.subarray&&Tt)return Tt.decode(De.subarray(Ge,o));for(var ke="";Ge<o;){var ai=De[Ge++];if(!(ai&128)){ke+=String.fromCharCode(ai);continue}var fi=De[Ge++]&63;if((ai&224)==192){ke+=String.fromCharCode((ai&31)<<6|fi);continue}var hi=De[Ge++]&63;if((ai&240)==224?ai=(ai&15)<<12|fi<<6|hi:ai=(ai&7)<<18|fi<<12|hi<<6|De[Ge++]&63,ai<65536)ke+=String.fromCharCode(ai);else{var Jt=ai-65536;ke+=String.fromCharCode(55296|Jt>>10,56320|Jt&1023)}}return ke}function Oe(De,Ge){return De?Mt(dt,De,Ge):""}function jt(De,Ge,ht,kt){if(!(kt>0))return 0;for(var o=ht,ke=ht+kt-1,ai=0;ai<De.length;++ai){var fi=De.charCodeAt(ai);if(fi>=55296&&fi<=57343){var hi=De.charCodeAt(++ai);fi=65536+((fi&1023)<<10)|hi&1023}if(fi<=127){if(ht>=ke)break;Ge[ht++]=fi}else if(fi<=2047){if(ht+1>=ke)break;Ge[ht++]=192|fi>>6,Ge[ht++]=128|fi&63}else if(fi<=65535){if(ht+2>=ke)break;Ge[ht++]=224|fi>>12,Ge[ht++]=128|fi>>6&63,Ge[ht++]=128|fi&63}else{if(ht+3>=ke)break;Ge[ht++]=240|fi>>18,Ge[ht++]=128|fi>>12&63,Ge[ht++]=128|fi>>6&63,Ge[ht++]=128|fi&63}}return Ge[ht]=0,ht-o}function it(De,Ge,ht){return jt(De,dt,Ge,ht)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function vt(De,Ge){Pt.set(De,Ge)}function mt(De,Ge){return De%Ge>0&&(De+=Ge-De%Ge),De}var Et,Pt,dt,Je,pt,lt,Nt;function zt(De){Et=De,t.HEAP8=Pt=new Int8Array(De),t.HEAP16=Je=new Int16Array(De),t.HEAP32=pt=new Int32Array(De),t.HEAPU8=dt=new Uint8Array(De),t.HEAPU16=new Uint16Array(De),t.HEAPU32=new Uint32Array(De),t.HEAPF32=lt=new Float32Array(De),t.HEAPF64=Nt=new Float64Array(De)}var Ot=5267040,gi=24128,wi=t.TOTAL_MEMORY||33554432;t.buffer?Et=t.buffer:Et=new ArrayBuffer(wi),wi=Et.byteLength,zt(Et),pt[gi>>2]=Ot;function Ti(De){for(;De.length>0;){var Ge=De.shift();if(typeof Ge=="function"){Ge();continue}var ht=Ge.func;typeof ht=="number"?Ge.arg===void 0?t.dynCall_v(ht):t.dynCall_vi(ht,Ge.arg):ht(Ge.arg===void 0?null:Ge.arg)}}var Ni=[],en=[],ji=[],Vi=[];function nn(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)Ri(t.preRun.shift());Ti(Ni)}function vn(){Ti(en)}function Ci(){Ti(ji)}function mi(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)Oi(t.postRun.shift());Ti(Vi)}function Ri(De){Ni.unshift(De)}function Oi(De){Vi.unshift(De)}var _i=Math.abs,Ji=Math.ceil,Ai=Math.floor,sn=Math.min,ei=0,_n=null;function Pr(De){ei++,t.monitorRunDependencies&&t.monitorRunDependencies(ei)}function ci(De){if(ei--,t.monitorRunDependencies&&t.monitorRunDependencies(ei),ei==0&&_n){var Ge=_n;_n=null,Ge()}}t.preloadedImages={},t.preloadedAudios={};var rn=null,tr="data:application/octet-stream;base64,";function Pn(De){return String.prototype.startsWith?De.startsWith(tr):De.indexOf(tr)===0}var Qn,In;rn="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var v=24144;function k(De){return De}function V(De){var Ge=/\b__Z[\w\d_]+/g;return De.replace(Ge,function(ht){var kt=ht;return ht===kt?ht:kt+" ["+ht+"]"})}function Y(){var De=new Error;if(!De.stack){try{throw new Error(0)}catch(Ge){De=Ge}if(!De.stack)return"(no stack trace available)"}return De.stack.toString()}function te(){var De=Y();return t.extraStackTrace&&(De+=`
`+t.extraStackTrace()),V(De)}function fe(De,Ge,ht,kt){Ye("Assertion failed: "+Oe(De)+", at: "+[Ge?Oe(Ge):"unknown filename",ht,kt?Oe(kt):"unknown function"])}function ve(){return Pt.length}function Ie(De,Ge,ht){dt.set(dt.subarray(Ge,Ge+ht),De)}function Ee(De){return t.___errno_location&&(pt[t.___errno_location()>>2]=De),De}function ze(De){Ye("OOM")}function We(De){try{var Ge=new ArrayBuffer(De);return Ge.byteLength!=De?void 0:(new Int8Array(Ge).set(Pt),ne(Ge),zt(Ge),1)}catch{}}function He(De){var Ge=ve(),ht=16777216,kt=2147483648-ht;if(De>kt)return!1;for(var o=16777216,ke=Math.max(Ge,o);ke<De;)ke<=536870912?ke=mt(2*ke,ht):ke=Math.min(mt((3*ke+2147483648)/4,ht),kt);var ai=We(ke);return!!ai}var Qe=typeof atob=="function"?atob:function(De){var Ge="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ht="",kt,o,ke,ai,fi,hi,Jt,oi=0;De=De.replace(/[^A-Za-z0-9\+\/\=]/g,"");do ai=Ge.indexOf(De.charAt(oi++)),fi=Ge.indexOf(De.charAt(oi++)),hi=Ge.indexOf(De.charAt(oi++)),Jt=Ge.indexOf(De.charAt(oi++)),kt=ai<<2|fi>>4,o=(fi&15)<<4|hi>>2,ke=(hi&3)<<6|Jt,ht=ht+String.fromCharCode(kt),hi!==64&&(ht=ht+String.fromCharCode(o)),Jt!==64&&(ht=ht+String.fromCharCode(ke));while(oi<De.length);return ht};function Ue(De){try{for(var Ge=Qe(De),ht=new Uint8Array(Ge.length),kt=0;kt<Ge.length;++kt)ht[kt]=Ge.charCodeAt(kt);return ht}catch{throw new Error("Converting base64 string to bytes failed.")}}function ft(De){if(Pn(De))return Ue(De.slice(tr.length))}var st={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Me={a:Ye,b:he,c:ae,d:fe,e:Ee,f:ve,g:Ie,h:He,i:ze,j:k,k:V,l:We,m:Y,n:te,o:v,p:gi},se=function(De,Ge,ht){"almost asm";var kt=new De.Int8Array(ht),o=new De.Int32Array(ht);new De.Uint8Array(ht),new De.Float32Array(ht);var ke=new De.Float64Array(ht),ai=Ge.o|0,fi=Ge.p|0,hi=De.Math.floor,Jt=De.Math.abs,oi=De.Math.sqrt,zi=De.Math.pow,xi=De.Math.cos,Si=De.Math.sin,Yt=De.Math.tan,bn=De.Math.acos,or=De.Math.asin,mn=De.Math.atan,qn=De.Math.atan2,jr=De.Math.ceil,Zi=De.Math.imul,ur=De.Math.min,Vn=De.Math.max,Wt=De.Math.clz32,Ki=Ge.b,Ut=Ge.c,Tn=Ge.d,cr=Ge.e,Vs=Ge.f,Ur=Ge.g,Vt=Ge.h,hr=Ge.i,Bt=24160;function Fr(i){return kt=new Int8Array(i),o=new Int32Array(i),ke=new Float64Array(i),ht=i,!0}function Us(i){i=i|0;var r=0;return r=Bt,Bt=Bt+i|0,Bt=Bt+15&-16,r|0}function ua(){return Bt|0}function Dr(i){i=i|0,Bt=i}function Na(i,r){i=i|0,Bt=i}function Fo(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;return(i|0)<0?(r=2,r|0):(i|0)>13780509?(r=lr(15,r)|0,r|0):(l=((i|0)<0)<<31>>31,_=$e(i|0,l|0,3,0)|0,d=Ut()|0,l=z(i|0,l|0,1,0)|0,l=$e(_|0,d|0,l|0,Ut()|0)|0,l=z(l|0,Ut()|0,1,0)|0,i=Ut()|0,o[r>>2]=l,o[r+4>>2]=i,r=0,r|0)}function Va(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,Xs(i,r,l,d,0)|0}function Xs(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0;if(j=Bt,Bt=Bt+16|0,T=j,!(Zn(i,r,l,d,_)|0))return d=0,Bt=j,d|0;do if((l|0)>=0){if((l|0)>13780509){if(w=lr(15,T)|0,w|0)break;B=T,T=o[B>>2]|0,B=o[B+4>>2]|0}else w=((l|0)<0)<<31>>31,X=$e(l|0,w|0,3,0)|0,B=Ut()|0,w=z(l|0,w|0,1,0)|0,w=$e(X|0,B|0,w|0,Ut()|0)|0,w=z(w|0,Ut()|0,1,0)|0,B=Ut()|0,o[T>>2]=w,o[T+4>>2]=B,T=w;if(O(d|0,0,T<<3|0)|0,_|0){O(_|0,0,T<<2|0)|0,w=aa(i,r,l,d,_,T,B,0)|0;break}w=D(T,4)|0,w?(X=aa(i,r,l,d,w,T,B,0)|0,C(w),w=X):w=13}else w=2;while(!1);return X=w,Bt=j,X|0}function Zn(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0,Ke=0;if(Ke=Bt,Bt=Bt+16|0,Re=Ke,Be=Ke+8|0,Te=Re,o[Te>>2]=i,o[Te+4>>2]=r,(l|0)<0)return Be=2,Bt=Ke,Be|0;if(w=d,o[w>>2]=i,o[w+4>>2]=r,w=(_|0)!=0,w&&(o[_>>2]=0),kr(i,r)|0)return Be=9,Bt=Ke,Be|0;o[Be>>2]=0;e:do if((l|0)>=1)if(w)for(ce=1,X=0,Se=0,Te=1,w=i;;){if(!(X|Se)){if(w=hs(w,r,4,Be,Re)|0,w|0)break e;if(r=Re,w=o[r>>2]|0,r=o[r+4>>2]|0,kr(w,r)|0){w=9;break e}}if(w=hs(w,r,o[22384+(Se<<2)>>2]|0,Be,Re)|0,w|0)break e;if(r=Re,w=o[r>>2]|0,r=o[r+4>>2]|0,i=d+(ce<<3)|0,o[i>>2]=w,o[i+4>>2]=r,o[_+(ce<<2)>>2]=Te,i=X+1|0,T=(i|0)==(Te|0),B=Se+1|0,j=(B|0)==6,kr(w,r)|0){w=9;break e}if(Te=Te+(j&T&1)|0,(Te|0)>(l|0)){w=0;break}else ce=ce+1|0,X=T?0:i,Se=T?j?0:B:Se}else for(ce=1,X=0,Se=0,Te=1,w=i;;){if(!(X|Se)){if(w=hs(w,r,4,Be,Re)|0,w|0)break e;if(r=Re,w=o[r>>2]|0,r=o[r+4>>2]|0,kr(w,r)|0){w=9;break e}}if(w=hs(w,r,o[22384+(Se<<2)>>2]|0,Be,Re)|0,w|0)break e;if(r=Re,w=o[r>>2]|0,r=o[r+4>>2]|0,i=d+(ce<<3)|0,o[i>>2]=w,o[i+4>>2]=r,i=X+1|0,T=(i|0)==(Te|0),B=Se+1|0,j=(B|0)==6,kr(w,r)|0){w=9;break e}if(Te=Te+(j&T&1)|0,(Te|0)>(l|0)){w=0;break}else ce=ce+1|0,X=T?0:i,Se=T?j?0:B:Se}else w=0;while(!1);return Be=w,Bt=Ke,Be|0}function aa(i,r,l,d,_,w,T,B){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0,T=T|0,B=B|0;var j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0,Ke=0,yt=0,ot=0;if(Ke=Bt,Bt=Bt+16|0,Re=Ke+8|0,Be=Ke,j=Ct(i|0,r|0,w|0,T|0)|0,ce=Ut()|0,Se=d+(j<<3)|0,yt=Se,ot=o[yt>>2]|0,yt=o[yt+4>>2]|0,X=(ot|0)==(i|0)&(yt|0)==(r|0),!((ot|0)==0&(yt|0)==0|X))do j=z(j|0,ce|0,1,0)|0,j=_t(j|0,Ut()|0,w|0,T|0)|0,ce=Ut()|0,Se=d+(j<<3)|0,ot=Se,yt=o[ot>>2]|0,ot=o[ot+4>>2]|0,X=(yt|0)==(i|0)&(ot|0)==(r|0);while(!((yt|0)==0&(ot|0)==0|X));if(j=_+(j<<2)|0,X&&(o[j>>2]|0)<=(B|0)||(ot=Se,o[ot>>2]=i,o[ot+4>>2]=r,o[j>>2]=B,(B|0)>=(l|0)))return ot=0,Bt=Ke,ot|0;switch(X=B+1|0,o[Re>>2]=0,j=hs(i,r,2,Re,Be)|0,j|0){case 9:{Te=9;break}case 0:{j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,X)|0,j||(Te=9);break}}e:do if((Te|0)==9){switch(o[Re>>2]=0,j=hs(i,r,3,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,X)|0,j|0)break e;break}default:break e}switch(o[Re>>2]=0,j=hs(i,r,1,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,X)|0,j|0)break e;break}default:break e}switch(o[Re>>2]=0,j=hs(i,r,5,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,X)|0,j|0)break e;break}default:break e}switch(o[Re>>2]=0,j=hs(i,r,4,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,X)|0,j|0)break e;break}default:break e}switch(o[Re>>2]=0,j=hs(i,r,6,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,X)|0,j|0)break e;break}default:break e}return ot=0,Bt=Ke,ot|0}while(!1);return ot=j,Bt=Ke,ot|0}function hs(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0;if(l>>>0>6)return _=1,_|0;if(Se=(o[d>>2]|0)%6|0,o[d>>2]=Se,(Se|0)>0){w=0;do l=Ta(l)|0,w=w+1|0;while((w|0)<(o[d>>2]|0))}if(Se=Gt(i|0,r|0,45)|0,Ut()|0,ce=Se&127,ce>>>0>121)return _=5,_|0;j=wa(i,r)|0,w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15;e:do if(!w)X=8;else{for(;;){if(T=(15-w|0)*3|0,B=Gt(i|0,r|0,T|0)|0,Ut()|0,B=B&7,(B|0)==7){r=5;break}if(Be=(qs(w)|0)==0,w=w+-1|0,Te=Zt(7,0,T|0)|0,r=r&~(Ut()|0),Re=Zt(o[(Be?432:16)+(B*28|0)+(l<<2)>>2]|0,0,T|0)|0,T=Ut()|0,l=o[(Be?640:224)+(B*28|0)+(l<<2)>>2]|0,i=Re|i&~Te,r=T|r,!l){l=0;break e}if(!w){X=8;break e}}return r|0}while(!1);(X|0)==8&&(Be=o[848+(ce*28|0)+(l<<2)>>2]|0,Re=Zt(Be|0,0,45)|0,i=Re|i,r=Ut()|0|r&-1040385,l=o[4272+(ce*28|0)+(l<<2)>>2]|0,(Be&127|0)==127&&(Be=Zt(o[848+(ce*28|0)+20>>2]|0,0,45)|0,r=Ut()|0|r&-1040385,l=o[4272+(ce*28|0)+20>>2]|0,i=Mo(Be|i,r)|0,r=Ut()|0,o[d>>2]=(o[d>>2]|0)+1)),B=Gt(i|0,r|0,45)|0,Ut()|0,B=B&127;e:do if(rt(B)|0){t:do if((wa(i,r)|0)==1){if((ce|0)!=(B|0))if(pn(B,o[7696+(ce*28|0)>>2]|0)|0){i=go(i,r)|0,T=1,r=Ut()|0;break}else Tn(23313,22416,436,22424);switch(j|0){case 3:{i=Mo(i,r)|0,r=Ut()|0,o[d>>2]=(o[d>>2]|0)+1,T=0;break t}case 5:{i=go(i,r)|0,r=Ut()|0,o[d>>2]=(o[d>>2]|0)+5,T=0;break t}case 0:return Be=9,Be|0;default:return Be=1,Be|0}}else T=0;while(!1);if((l|0)>0){w=0;do i=Tl(i,r)|0,r=Ut()|0,w=w+1|0;while((w|0)!=(l|0))}if((ce|0)!=(B|0)){if(!(St(B)|0)){if((T|0)!=0|(wa(i,r)|0)!=5)break;o[d>>2]=(o[d>>2]|0)+1;break}switch(Se&127){case 8:case 118:break e}(wa(i,r)|0)!=3&&(o[d>>2]=(o[d>>2]|0)+1)}}else if((l|0)>0){w=0;do i=Mo(i,r)|0,r=Ut()|0,w=w+1|0;while((w|0)!=(l|0))}while(!1);return o[d>>2]=((o[d>>2]|0)+l|0)%6|0,Be=_,o[Be>>2]=i,o[Be+4>>2]=r,Be=0,Be|0}function Ua(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0;for(B=Bt,Bt=Bt+16|0,w=B,T=B+8|0,_=(kr(i,r)|0)==0,_=_?1:2;;){if(o[T>>2]=0,X=(hs(i,r,_,T,w)|0)==0,j=w,X&((o[j>>2]|0)==(l|0)?(o[j+4>>2]|0)==(d|0):0)){i=4;break}if(_=_+1|0,_>>>0>=7){_=7,i=4;break}}return(i|0)==4?(Bt=B,_|0):0}function al(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0;if(Be=Bt,Bt=Bt+16|0,Te=Be,Re=Be+8|0,Se=Te,o[Se>>2]=i,o[Se+4>>2]=r,!l)return Re=d,o[Re>>2]=i,o[Re+4>>2]=r,Re=0,Bt=Be,Re|0;o[Re>>2]=0;e:do if(kr(i,r)|0)i=9;else{if(w=(l|0)>0,w){_=0,Se=i;do{if(i=hs(Se,r,4,Re,Te)|0,i|0)break e;if(r=Te,Se=o[r>>2]|0,r=o[r+4>>2]|0,_=_+1|0,kr(Se,r)|0){i=9;break e}}while((_|0)<(l|0));if(ce=d,o[ce>>2]=Se,o[ce+4>>2]=r,ce=l+-1|0,w){X=0,i=1;do{if(_=22384+(X<<2)|0,(X|0)==5)for(T=o[_>>2]|0,w=0,_=i;;){if(i=Te,i=hs(o[i>>2]|0,o[i+4>>2]|0,T,Re,Te)|0,i|0)break e;if((w|0)!=(ce|0))if(j=Te,B=o[j>>2]|0,j=o[j+4>>2]|0,i=d+(_<<3)|0,o[i>>2]=B,o[i+4>>2]=j,!(kr(B,j)|0))i=_+1|0;else{i=9;break e}else i=_;if(w=w+1|0,(w|0)>=(l|0))break;_=i}else for(T=Te,j=o[_>>2]|0,B=0,_=i,w=o[T>>2]|0,T=o[T+4>>2]|0;;){if(i=hs(w,T,j,Re,Te)|0,i|0)break e;if(T=Te,w=o[T>>2]|0,T=o[T+4>>2]|0,i=d+(_<<3)|0,o[i>>2]=w,o[i+4>>2]=T,i=_+1|0,kr(w,T)|0){i=9;break e}if(B=B+1|0,(B|0)>=(l|0))break;_=i}X=X+1|0}while(X>>>0<6);i=Te,T=Se,_=o[i>>2]|0,w=r,i=o[i+4>>2]|0}else T=Se,_=Se,w=r,i=r}else T=d,o[T>>2]=i,o[T+4>>2]=r,T=i,_=i,w=r,i=r;i=(T|0)==(_|0)&(w|0)==(i|0)?0:9}while(!1);return Re=i,Bt=Be,Re|0}function ol(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0;if(B=Bt,Bt=Bt+48|0,_=B+16|0,w=B+8|0,T=B,l|0)return T=15,Bt=B,T|0;if(X=i,j=o[X+4>>2]|0,l=w,o[l>>2]=o[X>>2],o[l+4>>2]=j,Fu(w,_),r=pl(_,r,T)|0,!r){if(l=o[w>>2]|0,w=o[i+8>>2]|0,(w|0)>0){_=o[i+12>>2]|0,r=0;do l=(o[_+(r<<3)>>2]|0)+l|0,r=r+1|0;while((r|0)<(w|0))}r=T,_=o[r>>2]|0,r=o[r+4>>2]|0,w=((l|0)<0)<<31>>31,(r|0)<(w|0)|(r|0)==(w|0)&_>>>0<l>>>0?(r=T,o[r>>2]=l,o[r+4>>2]=w,r=w):l=_,j=z(l|0,r|0,12,0)|0,X=Ut()|0,r=T,o[r>>2]=j,o[r+4>>2]=X,r=d,o[r>>2]=j,o[r+4>>2]=X,r=0}return X=r,Bt=B,X|0}function no(i,r,l,d,_,w,T){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0,T=T|0;var B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0,Ke=0,yt=0,ot=0,ct=0,It=0,bt=0,ri=0,Xt=0,ti=0,si=0,Qi=0,Wi=0,Ei=0,Gi=0,qi=0,cn=0,zn=0,tn=0,kn=0,yr=0,er=0;if(zn=Bt,Bt=Bt+64|0,Ei=zn+48|0,Gi=zn+32|0,qi=zn+24|0,ri=zn+8|0,Xt=zn,j=o[i>>2]|0,(j|0)<=0)return cn=0,Bt=zn,cn|0;for(ti=i+4|0,si=Ei+8|0,Qi=Gi+8|0,Wi=ri+8|0,B=0,It=0;;){X=o[ti>>2]|0,ct=X+(It<<4)|0,o[Ei>>2]=o[ct>>2],o[Ei+4>>2]=o[ct+4>>2],o[Ei+8>>2]=o[ct+8>>2],o[Ei+12>>2]=o[ct+12>>2],(It|0)==(j+-1|0)?(o[Gi>>2]=o[X>>2],o[Gi+4>>2]=o[X+4>>2],o[Gi+8>>2]=o[X+8>>2],o[Gi+12>>2]=o[X+12>>2]):(ct=X+(It+1<<4)|0,o[Gi>>2]=o[ct>>2],o[Gi+4>>2]=o[ct+4>>2],o[Gi+8>>2]=o[ct+8>>2],o[Gi+12>>2]=o[ct+12>>2]),j=Gr(Ei,Gi,d,qi)|0;e:do if(j)X=0,B=j;else if(X=qi,j=o[X>>2]|0,X=o[X+4>>2]|0,(X|0)>0|(X|0)==0&j>>>0>0){ot=0,ct=0;t:for(;;){if(er=+ke[Ei>>3],yt=R(j|0,X|0,ot|0,ct|0)|0,yr=+(yt>>>0)+4294967296*+(Ut()|0),tn=+(j>>>0)+4294967296*+(X|0),kn=+(ot>>>0)+4294967296*+(ct|0),ke[ri>>3]=er*yr/tn+ +ke[Gi>>3]*kn/tn,ke[Wi>>3]=+ke[si>>3]*yr/tn+ +ke[Qi>>3]*kn/tn,j=$a(ri,d,Xt)|0,j|0){B=j;break}yt=Xt,Ke=o[yt>>2]|0,yt=o[yt+4>>2]|0,Te=Ct(Ke|0,yt|0,r|0,l|0)|0,ce=Ut()|0,j=T+(Te<<3)|0,Se=j,X=o[Se>>2]|0,Se=o[Se+4>>2]|0;i:do if((X|0)==0&(Se|0)==0)bt=j,cn=16;else for(Re=0,Be=0;;){if((Re|0)>(l|0)|(Re|0)==(l|0)&Be>>>0>r>>>0){B=1;break t}if((X|0)==(Ke|0)&(Se|0)==(yt|0))break i;if(j=z(Te|0,ce|0,1,0)|0,Te=_t(j|0,Ut()|0,r|0,l|0)|0,ce=Ut()|0,Be=z(Be|0,Re|0,1,0)|0,Re=Ut()|0,j=T+(Te<<3)|0,Se=j,X=o[Se>>2]|0,Se=o[Se+4>>2]|0,(X|0)==0&(Se|0)==0){bt=j,cn=16;break}}while(!1);if((cn|0)==16&&(cn=0,!((Ke|0)==0&(yt|0)==0))&&(Be=bt,o[Be>>2]=Ke,o[Be+4>>2]=yt,Be=w+(o[_>>2]<<3)|0,o[Be>>2]=Ke,o[Be+4>>2]=yt,Be=_,Be=z(o[Be>>2]|0,o[Be+4>>2]|0,1,0)|0,Ke=Ut()|0,yt=_,o[yt>>2]=Be,o[yt+4>>2]=Ke),ot=z(ot|0,ct|0,1,0)|0,ct=Ut()|0,X=qi,j=o[X>>2]|0,X=o[X+4>>2]|0,!((X|0)>(ct|0)|(X|0)==(ct|0)&j>>>0>ot>>>0)){X=1;break e}}X=0}else X=1;while(!1);if(It=It+1|0,!X){cn=21;break}if(j=o[i>>2]|0,(It|0)>=(j|0)){B=0,cn=21;break}}return(cn|0)==21?(Bt=zn,B|0):0}function Ga(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0,Ke=0,yt=0,ot=0,ct=0,It=0,bt=0,ri=0,Xt=0,ti=0,si=0,Qi=0,Wi=0,Ei=0,Gi=0,qi=0,cn=0,zn=0,tn=0,kn=0,yr=0;if(yr=Bt,Bt=Bt+112|0,cn=yr+80|0,j=yr+72|0,zn=yr,tn=yr+56|0,l|0)return kn=15,Bt=yr,kn|0;if(X=i+8|0,kn=Ms((o[X>>2]<<5)+32|0)|0,!kn)return kn=13,Bt=yr,kn|0;if(Vl(i,kn),Gi=i,qi=o[Gi+4>>2]|0,l=j,o[l>>2]=o[Gi>>2],o[l+4>>2]=qi,Fu(j,cn),l=pl(cn,r,zn)|0,l)Gi=0,qi=0;else{if(l=o[j>>2]|0,w=o[X>>2]|0,(w|0)>0){T=o[i+12>>2]|0,_=0;do l=(o[T+(_<<3)>>2]|0)+l|0,_=_+1|0;while((_|0)!=(w|0));_=l}else _=l;l=zn,w=o[l>>2]|0,l=o[l+4>>2]|0,T=((_|0)<0)<<31>>31,(l|0)<(T|0)|(l|0)==(T|0)&w>>>0<_>>>0?(l=zn,o[l>>2]=_,o[l+4>>2]=T,l=T):_=w,Gi=z(_|0,l|0,12,0)|0,qi=Ut()|0,l=zn,o[l>>2]=Gi,o[l+4>>2]=qi,l=0}if(l|0)return C(kn),kn=l,Bt=yr,kn|0;if(_=D(Gi,8)|0,!_)return C(kn),kn=13,Bt=yr,kn|0;if(B=D(Gi,8)|0,!B)return C(kn),C(_),kn=13,Bt=yr,kn|0;Wi=cn,o[Wi>>2]=0,o[Wi+4>>2]=0,Wi=i,Ei=o[Wi+4>>2]|0,l=j,o[l>>2]=o[Wi>>2],o[l+4>>2]=Ei,l=no(j,Gi,qi,r,cn,_,B)|0;e:do if(l)C(_),C(B),C(kn);else{t:do if((o[X>>2]|0)>0){for(T=i+12|0,w=0;l=no((o[T>>2]|0)+(w<<3)|0,Gi,qi,r,cn,_,B)|0,w=w+1|0,!(l|0);)if((w|0)>=(o[X>>2]|0))break t;C(_),C(B),C(kn);break e}while(!1);(qi|0)>0|(qi|0)==0&Gi>>>0>0&&O(B|0,0,Gi<<3|0)|0,Ei=cn,Wi=o[Ei+4>>2]|0;t:do if((Wi|0)>0|(Wi|0)==0&(o[Ei>>2]|0)>>>0>0){ti=_,si=B,Qi=_,Wi=B,Ei=_,l=_,bt=_,ri=B,Xt=B,_=B;i:for(;;){for(yt=0,ot=0,ct=0,It=0,w=0,T=0;;){B=zn,j=B+56|0;do o[B>>2]=0,B=B+4|0;while((B|0)<(j|0));if(r=ti+(yt<<3)|0,X=o[r>>2]|0,r=o[r+4>>2]|0,Zn(X,r,1,zn,0)|0){B=zn,j=B+56|0;do o[B>>2]=0,B=B+4|0;while((B|0)<(j|0));B=D(7,4)|0,B|0&&(aa(X,r,1,zn,B,7,0,0)|0,C(B))}for(Ke=0;;){Be=zn+(Ke<<3)|0,Re=o[Be>>2]|0,Be=o[Be+4>>2]|0;n:do if((Re|0)==0&(Be|0)==0)B=w,j=T;else{if(ce=Ct(Re|0,Be|0,Gi|0,qi|0)|0,X=Ut()|0,B=d+(ce<<3)|0,r=B,j=o[r>>2]|0,r=o[r+4>>2]|0,!((j|0)==0&(r|0)==0)){Se=0,Te=0;do{if((Se|0)>(qi|0)|(Se|0)==(qi|0)&Te>>>0>Gi>>>0)break i;if((j|0)==(Re|0)&(r|0)==(Be|0)){B=w,j=T;break n}B=z(ce|0,X|0,1,0)|0,ce=_t(B|0,Ut()|0,Gi|0,qi|0)|0,X=Ut()|0,Te=z(Te|0,Se|0,1,0)|0,Se=Ut()|0,B=d+(ce<<3)|0,r=B,j=o[r>>2]|0,r=o[r+4>>2]|0}while(!((j|0)==0&(r|0)==0))}(Re|0)==0&(Be|0)==0?(B=w,j=T):(mr(Re,Be,tn)|0,yl(i,kn,tn)|0&&(Te=z(w|0,T|0,1,0)|0,T=Ut()|0,Se=B,o[Se>>2]=Re,o[Se+4>>2]=Be,w=si+(w<<3)|0,o[w>>2]=Re,o[w+4>>2]=Be,w=Te),B=w,j=T)}while(!1);if(Ke=Ke+1|0,Ke>>>0>=7)break;w=B,T=j}if(yt=z(yt|0,ot|0,1,0)|0,ot=Ut()|0,ct=z(ct|0,It|0,1,0)|0,It=Ut()|0,T=cn,w=o[T>>2]|0,T=o[T+4>>2]|0,(It|0)<(T|0)|(It|0)==(T|0)&ct>>>0<w>>>0)w=B,T=j;else break}if((T|0)>0|(T|0)==0&w>>>0>0){w=0,T=0;do It=ti+(w<<3)|0,o[It>>2]=0,o[It+4>>2]=0,w=z(w|0,T|0,1,0)|0,T=Ut()|0,It=cn,ct=o[It+4>>2]|0;while((T|0)<(ct|0)|((T|0)==(ct|0)?w>>>0<(o[It>>2]|0)>>>0:0))}if(It=cn,o[It>>2]=B,o[It+4>>2]=j,(j|0)>0|(j|0)==0&B>>>0>0)Ke=_,yt=Xt,ot=Ei,ct=ri,It=si,_=bt,Xt=l,ri=Qi,bt=Ke,l=yt,Ei=Wi,Wi=ot,Qi=ct,si=ti,ti=It;else break t}C(Qi),C(Wi),C(kn),l=1;break e}else l=B;while(!1);C(kn),C(_),C(l),l=0}while(!1);return kn=l,Bt=yr,kn|0}function N(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ce=0;if(ce=Bt,Bt=Bt+176|0,j=ce,(r|0)<1)return yu(l,0,0),X=0,Bt=ce,X|0;for(B=i,B=Gt(o[B>>2]|0,o[B+4>>2]|0,52)|0,Ut()|0,yu(l,(r|0)>6?r:6,B&15),B=0;d=i+(B<<3)|0,d=Nr(o[d>>2]|0,o[d+4>>2]|0,j)|0,!(d|0);){if(d=o[j>>2]|0,(d|0)>0){T=0;do w=j+8+(T<<4)|0,T=T+1|0,d=j+8+(((T|0)%(d|0)|0)<<4)|0,_=xs(l,d,w)|0,_?Mi(l,_)|0:Bi(l,w,d)|0,d=o[j>>2]|0;while((T|0)<(d|0))}if(B=B+1|0,(B|0)>=(r|0)){d=0,X=13;break}}return(X|0)==13?(Bt=ce,d|0):(vs(l),X=d,Bt=ce,X|0)}function xe(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;if(w=Bt,Bt=Bt+32|0,d=w,_=w+16|0,i=N(i,r,_)|0,i|0)return l=i,Bt=w,l|0;if(o[l>>2]=0,o[l+4>>2]=0,o[l+8>>2]=0,i=Po(_)|0,i|0)do{r=Wu(l)|0;do Ru(r,i)|0,T=i+16|0,o[d>>2]=o[T>>2],o[d+4>>2]=o[T+4>>2],o[d+8>>2]=o[T+8>>2],o[d+12>>2]=o[T+12>>2],Mi(_,i)|0,i=vu(_,d)|0;while(i|0);i=Po(_)|0}while(i|0);return vs(_),i=Ml(l)|0,i?(vo(l),T=i,Bt=w,T|0):(T=0,Bt=w,T|0)}function rt(i){return i=i|0,i>>>0>121?(i=0,i|0):(i=o[7696+(i*28|0)+16>>2]|0,i|0)}function St(i){return i=i|0,(i|0)==4|(i|0)==117|0}function $t(i){return i=i|0,o[11120+((o[i>>2]|0)*216|0)+((o[i+4>>2]|0)*72|0)+((o[i+8>>2]|0)*24|0)+(o[i+12>>2]<<3)>>2]|0}function Ii(i){return i=i|0,o[11120+((o[i>>2]|0)*216|0)+((o[i+4>>2]|0)*72|0)+((o[i+8>>2]|0)*24|0)+(o[i+12>>2]<<3)+4>>2]|0}function Li(i,r){i=i|0,r=r|0,i=7696+(i*28|0)|0,o[r>>2]=o[i>>2],o[r+4>>2]=o[i+4>>2],o[r+8>>2]=o[i+8>>2],o[r+12>>2]=o[i+12>>2]}function An(i,r){i=i|0,r=r|0;var l=0,d=0;if(r>>>0>20)return r=-1,r|0;do if((o[11120+(r*216|0)>>2]|0)!=(i|0))if((o[11120+(r*216|0)+8>>2]|0)!=(i|0))if((o[11120+(r*216|0)+16>>2]|0)!=(i|0))if((o[11120+(r*216|0)+24>>2]|0)!=(i|0))if((o[11120+(r*216|0)+32>>2]|0)!=(i|0))if((o[11120+(r*216|0)+40>>2]|0)!=(i|0))if((o[11120+(r*216|0)+48>>2]|0)!=(i|0))if((o[11120+(r*216|0)+56>>2]|0)!=(i|0))if((o[11120+(r*216|0)+64>>2]|0)!=(i|0))if((o[11120+(r*216|0)+72>>2]|0)!=(i|0))if((o[11120+(r*216|0)+80>>2]|0)!=(i|0))if((o[11120+(r*216|0)+88>>2]|0)!=(i|0))if((o[11120+(r*216|0)+96>>2]|0)!=(i|0))if((o[11120+(r*216|0)+104>>2]|0)!=(i|0))if((o[11120+(r*216|0)+112>>2]|0)!=(i|0))if((o[11120+(r*216|0)+120>>2]|0)!=(i|0))if((o[11120+(r*216|0)+128>>2]|0)!=(i|0))if((o[11120+(r*216|0)+136>>2]|0)==(i|0))i=2,l=1,d=2;else{if((o[11120+(r*216|0)+144>>2]|0)==(i|0)){i=0,l=2,d=0;break}if((o[11120+(r*216|0)+152>>2]|0)==(i|0)){i=0,l=2,d=1;break}if((o[11120+(r*216|0)+160>>2]|0)==(i|0)){i=0,l=2,d=2;break}if((o[11120+(r*216|0)+168>>2]|0)==(i|0)){i=1,l=2,d=0;break}if((o[11120+(r*216|0)+176>>2]|0)==(i|0)){i=1,l=2,d=1;break}if((o[11120+(r*216|0)+184>>2]|0)==(i|0)){i=1,l=2,d=2;break}if((o[11120+(r*216|0)+192>>2]|0)==(i|0)){i=2,l=2,d=0;break}if((o[11120+(r*216|0)+200>>2]|0)==(i|0)){i=2,l=2,d=1;break}if((o[11120+(r*216|0)+208>>2]|0)==(i|0)){i=2,l=2,d=2;break}else i=-1;return i|0}else i=2,l=1,d=1;else i=2,l=1,d=0;else i=1,l=1,d=2;else i=1,l=1,d=1;else i=1,l=1,d=0;else i=0,l=1,d=2;else i=0,l=1,d=1;else i=0,l=1,d=0;else i=2,l=0,d=2;else i=2,l=0,d=1;else i=2,l=0,d=0;else i=1,l=0,d=2;else i=1,l=0,d=1;else i=1,l=0,d=0;else i=0,l=0,d=2;else i=0,l=0,d=1;else i=0,l=0,d=0;while(!1);return r=o[11120+(r*216|0)+(l*72|0)+(i*24|0)+(d<<3)+4>>2]|0,r|0}function pn(i,r){return i=i|0,r=r|0,(o[7696+(i*28|0)+20>>2]|0)==(r|0)?(r=1,r|0):(r=(o[7696+(i*28|0)+24>>2]|0)==(r|0),r|0)}function sr(i,r){return i=i|0,r=r|0,o[848+(i*28|0)+(r<<2)>>2]|0}function Ar(i,r){return i=i|0,r=r|0,(o[848+(i*28|0)>>2]|0)==(r|0)?(r=0,r|0):(o[848+(i*28|0)+4>>2]|0)==(r|0)?(r=1,r|0):(o[848+(i*28|0)+8>>2]|0)==(r|0)?(r=2,r|0):(o[848+(i*28|0)+12>>2]|0)==(r|0)?(r=3,r|0):(o[848+(i*28|0)+16>>2]|0)==(r|0)?(r=4,r|0):(o[848+(i*28|0)+20>>2]|0)==(r|0)?(r=5,r|0):((o[848+(i*28|0)+24>>2]|0)==(r|0)?6:7)|0}function Or(){return 122}function qa(i){i=i|0;var r=0,l=0,d=0;r=0;do Zt(r|0,0,45)|0,d=Ut()|0|134225919,l=i+(r<<3)|0,o[l>>2]=-1,o[l+4>>2]=d,r=r+1|0;while((r|0)!=122);return 0}function Ha(i){return i=i|0,+ke[i+16>>3]<+ke[i+24>>3]|0}function ja(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;return l=+ke[r>>3],!(l>=+ke[i+8>>3])||!(l<=+ke[i>>3])?(r=0,r|0):(d=+ke[i+16>>3],l=+ke[i+24>>3],_=+ke[r+8>>3],r=_>=l,i=_<=d&1,d<l?r&&(i=1):r||(i=0),r=(i|0)!=0,r|0)}function pl(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0,Ke=0,yt=0;Be=Bt,Bt=Bt+288|0,ce=Be+264|0,Se=Be+96|0,X=Be,B=X,j=B+96|0;do o[B>>2]=0,B=B+4|0;while((B|0)<(j|0));return r=Sa(r,X)|0,r|0?(Re=r,Bt=Be,Re|0):(j=X,X=o[j>>2]|0,j=o[j+4>>2]|0,mr(X,j,ce)|0,Nr(X,j,Se)|0,T=+Ui(ce,Se+8|0),ke[ce>>3]=+ke[i>>3],j=ce+8|0,ke[j>>3]=+ke[i+16>>3],ke[Se>>3]=+ke[i+8>>3],X=Se+8|0,ke[X>>3]=+ke[i+24>>3],_=+Ui(ce,Se),yt=+ke[j>>3]-+ke[X>>3],w=+Jt(+yt),Ke=+ke[ce>>3]-+ke[Se>>3],d=+Jt(+Ke),!(yt==0|Ke==0)&&(yt=+Z(+w,+d),yt=+jr(+(_*_/+A(+(yt/+A(+w,+d)),3)/(T*(T*2.59807621135)*.8))),ke[ai>>3]=yt,Te=~~yt>>>0,Re=+Jt(yt)>=1?yt>0?~~+ur(+hi(yt/4294967296),4294967295)>>>0:~~+jr((yt-+(~~yt>>>0))/4294967296)>>>0:0,(o[ai+4>>2]&2146435072|0)!=2146435072)?(Se=(Te|0)==0&(Re|0)==0,r=l,o[r>>2]=Se?1:Te,o[r+4>>2]=Se?0:Re,r=0):r=1,Re=r,Bt=Be,Re|0)}function Gr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0,ce=0;X=Bt,Bt=Bt+288|0,T=X+264|0,B=X+96|0,j=X,_=j,w=_+96|0;do o[_>>2]=0,_=_+4|0;while((_|0)<(w|0));return l=Sa(l,j)|0,l|0?(d=l,Bt=X,d|0):(l=j,_=o[l>>2]|0,l=o[l+4>>2]|0,mr(_,l,T)|0,Nr(_,l,B)|0,ce=+Ui(T,B+8|0),ce=+jr(+(+Ui(i,r)/(ce*2))),ke[ai>>3]=ce,l=~~ce>>>0,_=+Jt(ce)>=1?ce>0?~~+ur(+hi(ce/4294967296),4294967295)>>>0:~~+jr((ce-+(~~ce>>>0))/4294967296)>>>0:0,(o[ai+4>>2]&2146435072|0)==2146435072?(d=1,Bt=X,d|0):(j=(l|0)==0&(_|0)==0,o[d>>2]=j?1:l,o[d+4>>2]=j?0:_,d=0,Bt=X,d|0))}function nr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0,o[i>>2]=r,o[i+4>>2]=l,o[i+8>>2]=d}function Ir(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0;Se=r+8|0,o[Se>>2]=0,j=+ke[i>>3],T=+Jt(+j),X=+ke[i+8>>3],B=+Jt(+X)/.8660254037844386,T=T+B*.5,l=~~T,i=~~B,T=T-+(l|0),B=B-+(i|0);do if(T<.5)if(T<.3333333333333333)if(o[r>>2]=l,B<(T+1)*.5){o[r+4>>2]=i;break}else{i=i+1|0,o[r+4>>2]=i;break}else if(Te=1-T,i=(!(B<Te)&1)+i|0,o[r+4>>2]=i,Te<=B&B<T*2){l=l+1|0,o[r>>2]=l;break}else{o[r>>2]=l;break}else{if(!(T<.6666666666666666))if(l=l+1|0,o[r>>2]=l,B<T*.5){o[r+4>>2]=i;break}else{i=i+1|0,o[r+4>>2]=i;break}if(B<1-T){if(o[r+4>>2]=i,T*2+-1<B){o[r>>2]=l;break}}else i=i+1|0,o[r+4>>2]=i;l=l+1|0,o[r>>2]=l}while(!1);do if(j<0)if(i&1){ce=(i+1|0)/2|0,ce=R(l|0,((l|0)<0)<<31>>31|0,ce|0,((ce|0)<0)<<31>>31|0)|0,l=~~(+(l|0)-((+(ce>>>0)+4294967296*+(Ut()|0))*2+1)),o[r>>2]=l;break}else{ce=(i|0)/2|0,ce=R(l|0,((l|0)<0)<<31>>31|0,ce|0,((ce|0)<0)<<31>>31|0)|0,l=~~(+(l|0)-(+(ce>>>0)+4294967296*+(Ut()|0))*2),o[r>>2]=l;break}while(!1);ce=r+4|0,X<0&&(l=l-((i<<1|1|0)/2|0)|0,o[r>>2]=l,i=0-i|0,o[ce>>2]=i),d=i-l|0,(l|0)<0?(_=0-l|0,o[ce>>2]=d,o[Se>>2]=_,o[r>>2]=0,i=d,l=0):_=0,(i|0)<0&&(l=l-i|0,o[r>>2]=l,_=_-i|0,o[Se>>2]=_,o[ce>>2]=0,i=0),w=l-_|0,d=i-_|0,(_|0)<0&&(o[r>>2]=w,o[ce>>2]=d,o[Se>>2]=0,i=d,l=w,_=0),d=(i|0)<(l|0)?i:l,d=(_|0)<(d|0)?_:d,!((d|0)<=0)&&(o[r>>2]=l-d,o[ce>>2]=i-d,o[Se>>2]=_-d)}function Lr(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0;r=o[i>>2]|0,T=i+4|0,l=o[T>>2]|0,(r|0)<0&&(l=l-r|0,o[T>>2]=l,w=i+8|0,o[w>>2]=(o[w>>2]|0)-r,o[i>>2]=0,r=0),(l|0)<0?(r=r-l|0,o[i>>2]=r,w=i+8|0,_=(o[w>>2]|0)-l|0,o[w>>2]=_,o[T>>2]=0,l=0):(_=i+8|0,w=_,_=o[_>>2]|0),(_|0)<0&&(r=r-_|0,o[i>>2]=r,l=l-_|0,o[T>>2]=l,o[w>>2]=0,_=0),d=(l|0)<(r|0)?l:r,d=(_|0)<(d|0)?_:d,!((d|0)<=0)&&(o[i>>2]=r-d,o[T>>2]=l-d,o[w>>2]=_-d)}function Zs(i,r){i=i|0,r=r|0;var l=0,d=0;d=o[i+8>>2]|0,l=+((o[i+4>>2]|0)-d|0),ke[r>>3]=+((o[i>>2]|0)-d|0)-l*.5,ke[r+8>>3]=l*.8660254037844386}function vr(i,r,l){i=i|0,r=r|0,l=l|0,o[l>>2]=(o[r>>2]|0)+(o[i>>2]|0),o[l+4>>2]=(o[r+4>>2]|0)+(o[i+4>>2]|0),o[l+8>>2]=(o[r+8>>2]|0)+(o[i+8>>2]|0)}function Ks(i,r,l){i=i|0,r=r|0,l=l|0,o[l>>2]=(o[i>>2]|0)-(o[r>>2]|0),o[l+4>>2]=(o[i+4>>2]|0)-(o[r+4>>2]|0),o[l+8>>2]=(o[i+8>>2]|0)-(o[r+8>>2]|0)}function Br(i,r){i=i|0,r=r|0;var l=0,d=0;l=Zi(o[i>>2]|0,r)|0,o[i>>2]=l,l=i+4|0,d=Zi(o[l>>2]|0,r)|0,o[l>>2]=d,i=i+8|0,r=Zi(o[i>>2]|0,r)|0,o[i>>2]=r}function Eo(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=o[i>>2]|0,B=(T|0)<0,d=(o[i+4>>2]|0)-(B?T:0)|0,w=(d|0)<0,_=(w?0-d|0:0)+((o[i+8>>2]|0)-(B?T:0))|0,l=(_|0)<0,i=l?0:_,r=(w?0:d)-(l?_:0)|0,_=(B?0:T)-(w?d:0)-(l?_:0)|0,l=(r|0)<(_|0)?r:_,l=(i|0)<(l|0)?i:l,d=(l|0)>0,i=i-(d?l:0)|0,r=r-(d?l:0)|0;e:do switch(_-(d?l:0)|0){case 0:switch(r|0){case 0:return B=i|0?(i|0)==1?1:7:0,B|0;case 1:return B=i|0?(i|0)==1?3:7:2,B|0;default:break e}case 1:switch(r|0){case 0:return B=i|0?(i|0)==1?5:7:4,B|0;case 1:{if(!i)i=6;else break e;return i|0}default:break e}}while(!1);return B=7,B|0}function Zo(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=i+8|0,_=o[T>>2]|0,w=(o[i>>2]|0)-_|0,B=i+4|0,_=(o[B>>2]|0)-_|0;do if(w>>>0>715827881|_>>>0>715827881){if(l=(w|0)>0,l){if((2147483647-w|0)<(w|0)||(2147483647-(w<<1)|0)<(w|0))return B=1,B|0}else if((-2147483648-w|0)>(w|0)||(-2147483648-(w<<1)|0)>(w|0))return B=1,B|0;if(r=w*3|0,(_|0)>0){if((2147483647-_|0)<(_|0))return B=1,B|0}else if((-2147483648-_|0)>(_|0))return B=1,B|0;if(d=_<<1,(w|0)>-1){if((r|-2147483648|0)>=(_|0))return B=1,B|0}else if((r^-2147483648|0)<(_|0))return B=1,B|0;if(l){if((2147483647-w|0)<(d|0))r=1;else{l=d;break}return r|0}else{if((-2147483648-w|0)>(d|0))r=1;else{l=d;break}return r|0}}else l=_<<1,r=w*3|0;while(!1);d=hl(+(r-_|0)/7)|0,o[i>>2]=d,_=hl(+(l+w|0)/7)|0,o[B>>2]=_,o[T>>2]=0,l=(_|0)<(d|0),r=l?d:_,l=l?_:d;do if((l|0)<0){if((r|0)>0){if((r|-2147483648|0)<(l|0)&((l|0)!=-2147483648&(2147483647-r|0)>=(l|0)))break;Tn(23313,22444,355,22455)}if((l|0)==-2147483648|(-2147483648-r|0)>(l|0)&&Tn(23313,22444,355,22455),(r|0)>-1){if((r|-2147483648|0)<(l|0))break;Tn(23313,22444,355,22455)}else{if((r^-2147483648|0)>=(l|0))break;Tn(23313,22444,355,22455)}}while(!1);return r=_-d|0,(d|0)<0?(l=0-d|0,o[B>>2]=r,o[T>>2]=l,o[i>>2]=0,d=0):(r=_,l=0),(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[T>>2]=l,o[B>>2]=0,r=0),w=d-l|0,_=r-l|0,(l|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,r=_,_=w,l=0):_=d,d=(r|0)<(_|0)?r:_,d=(l|0)<(d|0)?l:d,(d|0)<=0?(B=0,B|0):(o[i>>2]=_-d,o[B>>2]=r-d,o[T>>2]=l-d,B=0,B|0)}function Bs(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=i+8|0,_=o[T>>2]|0,w=(o[i>>2]|0)-_|0,B=i+4|0,_=(o[B>>2]|0)-_|0;do if(w>>>0>715827881|_>>>0>715827881){if(l=(w|0)>0,l){if((2147483647-w|0)<(w|0))return B=1,B|0}else if((-2147483648-w|0)>(w|0))return B=1,B|0;if(r=w<<1,(_|0)>0){if((2147483647-_|0)<(_|0)||(2147483647-(_<<1)|0)<(_|0))return B=1,B|0}else if((-2147483648-_|0)>(_|0)||(-2147483648-(_<<1)|0)>(_|0))return B=1,B|0;if(d=_*3|0,l){if((2147483647-r|0)<(_|0))return B=1,B|0}else if((-2147483648-r|0)>(_|0))return B=1,B|0;if((_|0)>-1){if((d|-2147483648|0)<(w|0)){l=d;break}else r=1;return r|0}else{if((d^-2147483648|0)<(w|0))r=1;else{l=d;break}return r|0}}else l=_*3|0,r=w<<1;while(!1);d=hl(+(r+_|0)/7)|0,o[i>>2]=d,_=hl(+(l-w|0)/7)|0,o[B>>2]=_,o[T>>2]=0,l=(_|0)<(d|0),r=l?d:_,l=l?_:d;do if((l|0)<0){if((r|0)>0){if((r|-2147483648|0)<(l|0)&((l|0)!=-2147483648&(2147483647-r|0)>=(l|0)))break;Tn(23313,22444,404,22469)}if((l|0)==-2147483648|(-2147483648-r|0)>(l|0)&&Tn(23313,22444,404,22469),(r|0)>-1){if((r|-2147483648|0)<(l|0))break;Tn(23313,22444,404,22469)}else{if((r^-2147483648|0)>=(l|0))break;Tn(23313,22444,404,22469)}}while(!1);return r=_-d|0,(d|0)<0?(l=0-d|0,o[B>>2]=r,o[T>>2]=l,o[i>>2]=0,d=0):(r=_,l=0),(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[T>>2]=l,o[B>>2]=0,r=0),w=d-l|0,_=r-l|0,(l|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,r=_,_=w,l=0):_=d,d=(r|0)<(_|0)?r:_,d=(l|0)<(d|0)?l:d,(d|0)<=0?(B=0,B|0):(o[i>>2]=_-d,o[B>>2]=r-d,o[T>>2]=l-d,B=0,B|0)}function Il(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=i+8|0,l=o[T>>2]|0,r=(o[i>>2]|0)-l|0,B=i+4|0,l=(o[B>>2]|0)-l|0,d=hl(+((r*3|0)-l|0)/7)|0,o[i>>2]=d,r=hl(+((l<<1)+r|0)/7)|0,o[B>>2]=r,o[T>>2]=0,l=r-d|0,(d|0)<0?(w=0-d|0,o[B>>2]=l,o[T>>2]=w,o[i>>2]=0,r=l,d=0,l=w):l=0,(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[T>>2]=l,o[B>>2]=0,r=0),w=d-l|0,_=r-l|0,(l|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,r=_,_=w,l=0):_=d,d=(r|0)<(_|0)?r:_,d=(l|0)<(d|0)?l:d,!((d|0)<=0)&&(o[i>>2]=_-d,o[B>>2]=r-d,o[T>>2]=l-d)}function mo(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=i+8|0,l=o[T>>2]|0,r=(o[i>>2]|0)-l|0,B=i+4|0,l=(o[B>>2]|0)-l|0,d=hl(+((r<<1)+l|0)/7)|0,o[i>>2]=d,r=hl(+((l*3|0)-r|0)/7)|0,o[B>>2]=r,o[T>>2]=0,l=r-d|0,(d|0)<0?(w=0-d|0,o[B>>2]=l,o[T>>2]=w,o[i>>2]=0,r=l,d=0,l=w):l=0,(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[T>>2]=l,o[B>>2]=0,r=0),w=d-l|0,_=r-l|0,(l|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,r=_,_=w,l=0):_=d,d=(r|0)<(_|0)?r:_,d=(l|0)<(d|0)?l:d,!((d|0)<=0)&&(o[i>>2]=_-d,o[B>>2]=r-d,o[T>>2]=l-d)}function Qo(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;r=o[i>>2]|0,T=i+4|0,l=o[T>>2]|0,B=i+8|0,d=o[B>>2]|0,_=l+(r*3|0)|0,o[i>>2]=_,l=d+(l*3|0)|0,o[T>>2]=l,r=(d*3|0)+r|0,o[B>>2]=r,d=l-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=d,o[B>>2]=r,o[i>>2]=0,l=d,d=0):d=_,(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=_,o[B>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[T>>2]=_-l,o[B>>2]=r-l)}function ca(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;_=o[i>>2]|0,T=i+4|0,r=o[T>>2]|0,B=i+8|0,l=o[B>>2]|0,d=(r*3|0)+_|0,_=l+(_*3|0)|0,o[i>>2]=_,o[T>>2]=d,r=(l*3|0)+r|0,o[B>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=l,o[B>>2]=r,o[i>>2]=0,_=0):l=d,(l|0)<0&&(_=_-l|0,o[i>>2]=_,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=_-r|0,d=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=d,o[B>>2]=0,_=w,r=0):d=l,l=(d|0)<(_|0)?d:_,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=_-l,o[T>>2]=d-l,o[B>>2]=r-l)}function Ys(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0;(r+-1|0)>>>0>=6||(_=(o[15440+(r*12|0)>>2]|0)+(o[i>>2]|0)|0,o[i>>2]=_,B=i+4|0,d=(o[15440+(r*12|0)+4>>2]|0)+(o[B>>2]|0)|0,o[B>>2]=d,T=i+8|0,r=(o[15440+(r*12|0)+8>>2]|0)+(o[T>>2]|0)|0,o[T>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[B>>2]=l,o[T>>2]=r,o[i>>2]=0,d=0):(l=d,d=_),(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[T>>2]=r,o[B>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[B>>2]=_-l,o[T>>2]=r-l))}function El(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;_=o[i>>2]|0,T=i+4|0,r=o[T>>2]|0,B=i+8|0,l=o[B>>2]|0,d=r+_|0,_=l+_|0,o[i>>2]=_,o[T>>2]=d,r=l+r|0,o[B>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=l,o[B>>2]=r,o[i>>2]=0,d=0):(l=d,d=_),(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=_,o[B>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[T>>2]=_-l,o[B>>2]=r-l)}function Za(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;r=o[i>>2]|0,T=i+4|0,d=o[T>>2]|0,B=i+8|0,l=o[B>>2]|0,_=d+r|0,o[i>>2]=_,d=l+d|0,o[T>>2]=d,r=l+r|0,o[B>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=l,o[B>>2]=r,o[i>>2]=0,d=0):(l=d,d=_),(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=_,o[B>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[T>>2]=_-l,o[B>>2]=r-l)}function Ta(i){switch(i=i|0,i|0){case 1:{i=5;break}case 5:{i=4;break}case 4:{i=6;break}case 6:{i=2;break}case 2:{i=3;break}case 3:{i=1;break}}return i|0}function ml(i){switch(i=i|0,i|0){case 1:{i=3;break}case 3:{i=2;break}case 2:{i=6;break}case 6:{i=4;break}case 4:{i=5;break}case 5:{i=1;break}}return i|0}function Cl(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;r=o[i>>2]|0,T=i+4|0,l=o[T>>2]|0,B=i+8|0,d=o[B>>2]|0,_=l+(r<<1)|0,o[i>>2]=_,l=d+(l<<1)|0,o[T>>2]=l,r=(d<<1)+r|0,o[B>>2]=r,d=l-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=d,o[B>>2]=r,o[i>>2]=0,l=d,d=0):d=_,(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=_,o[B>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[T>>2]=_-l,o[B>>2]=r-l)}function mu(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;_=o[i>>2]|0,T=i+4|0,r=o[T>>2]|0,B=i+8|0,l=o[B>>2]|0,d=(r<<1)+_|0,_=l+(_<<1)|0,o[i>>2]=_,o[T>>2]=d,r=(l<<1)+r|0,o[B>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=l,o[B>>2]=r,o[i>>2]=0,_=0):l=d,(l|0)<0&&(_=_-l|0,o[i>>2]=_,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=_-r|0,d=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=d,o[B>>2]=0,_=w,r=0):d=l,l=(d|0)<(_|0)?d:_,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=_-l,o[T>>2]=d-l,o[B>>2]=r-l)}function As(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0;return T=(o[i>>2]|0)-(o[r>>2]|0)|0,B=(T|0)<0,d=(o[i+4>>2]|0)-(o[r+4>>2]|0)-(B?T:0)|0,w=(d|0)<0,_=(B?0-T|0:0)+(o[i+8>>2]|0)-(o[r+8>>2]|0)+(w?0-d|0:0)|0,i=(_|0)<0,r=i?0:_,l=(w?0:d)-(i?_:0)|0,_=(B?0:T)-(w?d:0)-(i?_:0)|0,i=(l|0)<(_|0)?l:_,i=(r|0)<(i|0)?r:i,d=(i|0)>0,r=r-(d?i:0)|0,l=l-(d?i:0)|0,i=_-(d?i:0)|0,i=(i|0)>-1?i:0-i|0,l=(l|0)>-1?l:0-l|0,r=(r|0)>-1?r:0-r|0,r=(l|0)>(r|0)?l:r,((i|0)>(r|0)?i:r)|0}function ac(i,r){i=i|0,r=r|0;var l=0;l=o[i+8>>2]|0,o[r>>2]=(o[i>>2]|0)-l,o[r+4>>2]=(o[i+4>>2]|0)-l}function ro(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0;d=o[i>>2]|0,o[r>>2]=d,_=o[i+4>>2]|0,T=r+4|0,o[T>>2]=_,B=r+8|0,o[B>>2]=0,l=(_|0)<(d|0),i=l?d:_,l=l?_:d;do if((l|0)<0){if((i|0)>0){if((i|-2147483648|0)<(l|0)&((l|0)!=-2147483648&(2147483647-i|0)>=(l|0)))break;return i=1,i|0}if((l|0)==-2147483648|(-2147483648-i|0)>(l|0))return r=1,r|0;if((i|0)>-1){if((i|-2147483648|0)<(l|0))break;return i=1,i|0}else{if((i^-2147483648|0)<(l|0))i=1;else break;return i|0}}while(!1);return i=_-d|0,(d|0)<0?(l=0-d|0,o[T>>2]=i,o[B>>2]=l,o[r>>2]=0,d=0):(i=_,l=0),(i|0)<0&&(d=d-i|0,o[r>>2]=d,l=l-i|0,o[B>>2]=l,o[T>>2]=0,i=0),w=d-l|0,_=i-l|0,(l|0)<0?(o[r>>2]=w,o[T>>2]=_,o[B>>2]=0,i=_,_=w,l=0):_=d,d=(i|0)<(_|0)?i:_,d=(l|0)<(d|0)?l:d,(d|0)<=0?(r=0,r|0):(o[r>>2]=_-d,o[T>>2]=i-d,o[B>>2]=l-d,r=0,r|0)}function so(i){i=i|0;var r=0,l=0,d=0,_=0;r=i+8|0,_=o[r>>2]|0,l=_-(o[i>>2]|0)|0,o[i>>2]=l,d=i+4|0,i=(o[d>>2]|0)-_|0,o[d>>2]=i,o[r>>2]=0-(i+l)}function Ql(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;l=o[i>>2]|0,r=0-l|0,o[i>>2]=r,T=i+8|0,o[T>>2]=0,B=i+4|0,d=o[B>>2]|0,_=d+l|0,(l|0)>0?(o[B>>2]=_,o[T>>2]=l,o[i>>2]=0,r=0,d=_):l=0,(d|0)<0?(w=r-d|0,o[i>>2]=w,l=l-d|0,o[T>>2]=l,o[B>>2]=0,_=w-l|0,r=0-l|0,(l|0)<0?(o[i>>2]=_,o[B>>2]=r,o[T>>2]=0,d=r,l=0):(d=0,_=w)):_=r,r=(d|0)<(_|0)?d:_,r=(l|0)<(r|0)?l:r,!((r|0)<=0)&&(o[i>>2]=_-r,o[B>>2]=d-r,o[T>>2]=l-r)}function Oo(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ce=0,Se=0;if(Se=Bt,Bt=Bt+64|0,ce=Se,B=Se+56|0,!(!0&(r&2013265920|0)==134217728&(!0&(d&2013265920|0)==134217728)))return _=5,Bt=Se,_|0;if((i|0)==(l|0)&(r|0)==(d|0))return o[_>>2]=0,_=0,Bt=Se,_|0;if(T=Gt(i|0,r|0,52)|0,Ut()|0,T=T&15,X=Gt(l|0,d|0,52)|0,Ut()|0,(T|0)!=(X&15|0))return _=12,Bt=Se,_|0;if(w=T+-1|0,T>>>0>1){Zr(i,r,w,ce)|0,Zr(l,d,w,B)|0,X=ce,j=o[X>>2]|0,X=o[X+4>>2]|0;e:do if((j|0)==(o[B>>2]|0)&&(X|0)==(o[B+4>>2]|0)){T=(T^15)*3|0,w=Gt(i|0,r|0,T|0)|0,Ut()|0,w=w&7,T=Gt(l|0,d|0,T|0)|0,Ut()|0,T=T&7;do if((w|0)==0|(T|0)==0)o[_>>2]=1,w=0;else if((w|0)==7)w=5;else{if((w|0)==1|(T|0)==1&&kr(j,X)|0){w=5;break}if((o[15536+(w<<2)>>2]|0)!=(T|0)&&(o[15568+(w<<2)>>2]|0)!=(T|0))break e;o[_>>2]=1,w=0}while(!1);return _=w,Bt=Se,_|0}while(!1)}w=ce,T=w+56|0;do o[w>>2]=0,w=w+4|0;while((w|0)<(T|0));return Va(i,r,1,ce)|0,r=ce,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0))&&(r=ce+8|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=ce+16|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=ce+24|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=ce+32|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=ce+40|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))?(w=ce+48|0,w=((o[w>>2]|0)==(l|0)?(o[w+4>>2]|0)==(d|0):0)&1):w=1,o[_>>2]=w,_=0,Bt=Se,_|0}function Wo(i,r,l,d,_){return i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,l=Ua(i,r,l,d)|0,(l|0)==7?(_=11,_|0):(d=Zt(l|0,0,56)|0,r=r&-2130706433|(Ut()|0)|268435456,o[_>>2]=i|d,o[_+4>>2]=r,_=0,_|0)}function Co(i,r,l){return i=i|0,r=r|0,l=l|0,!0&(r&2013265920|0)==268435456?(o[l>>2]=i,o[l+4>>2]=r&-2130706433|134217728,l=0,l|0):(l=6,l|0)}function Gs(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;return _=Bt,Bt=Bt+16|0,d=_,o[d>>2]=0,!0&(r&2013265920|0)==268435456?(w=Gt(i|0,r|0,56)|0,Ut()|0,d=hs(i,r&-2130706433|134217728,w&7,d,l)|0,Bt=_,d|0):(d=6,Bt=_,d|0)}function $o(i,r){i=i|0,r=r|0;var l=0;switch(l=Gt(i|0,r|0,56)|0,Ut()|0,l&7){case 0:case 7:return l=0,l|0}return l=r&-2130706433|134217728,!(!0&(r&2013265920|0)==268435456)||!0&(r&117440512|0)==16777216&(kr(i,l)|0)!=0?(l=0,l|0):(l=es(i,l)|0,l|0)}function Xo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;return _=Bt,Bt=Bt+16|0,d=_,!0&(r&2013265920|0)==268435456?(w=r&-2130706433|134217728,T=l,o[T>>2]=i,o[T+4>>2]=w,o[d>>2]=0,r=Gt(i|0,r|0,56)|0,Ut()|0,d=hs(i,w,r&7,d,l+8|0)|0,Bt=_,d|0):(d=6,Bt=_,d|0)}function Yo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;return _=(kr(i,r)|0)==0,r=r&-2130706433,d=l,o[d>>2]=_?i:0,o[d+4>>2]=_?r|285212672:0,d=l+8|0,o[d>>2]=i,o[d+4>>2]=r|301989888,d=l+16|0,o[d>>2]=i,o[d+4>>2]=r|318767104,d=l+24|0,o[d>>2]=i,o[d+4>>2]=r|335544320,d=l+32|0,o[d>>2]=i,o[d+4>>2]=r|352321536,l=l+40|0,o[l>>2]=i,o[l+4>>2]=r|369098752,0}function ba(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;return T=Bt,Bt=Bt+16|0,_=T,w=r&-2130706433|134217728,!0&(r&2013265920|0)==268435456?(d=Gt(i|0,r|0,56)|0,Ut()|0,d=gn(i,w,d&7)|0,(d|0)==-1?(o[l>>2]=0,w=6,Bt=T,w|0):(Yr(i,w,_)|0&&Tn(23313,22484,282,22499),r=Gt(i|0,r|0,52)|0,Ut()|0,r=r&15,kr(i,w)|0?Ko(_,r,d,2,l):fr(_,r,d,2,l),w=0,Bt=T,w|0)):(w=6,Bt=T,w|0)}function Qa(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;d=Bt,Bt=Bt+16|0,_=d,Cs(i,r,l,_),Ir(_,l+4|0),Bt=d}function Cs(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0;if(B=Bt,Bt=Bt+16|0,j=B,gu(i,l,j),w=+bn(+(1-+ke[j>>3]*.5)),w<1e-16){o[d>>2]=0,o[d+4>>2]=0,o[d+8>>2]=0,o[d+12>>2]=0,Bt=B;return}if(j=o[l>>2]|0,_=+ke[15920+(j*24|0)>>3],_=+gl(_-+gl(+Ft(15600+(j<<4)|0,i))),qs(r)|0?T=+gl(_+-.3334731722518321):T=_,_=+Yt(+w)/.381966011250105,(r|0)>0){i=0;do _=_*2.6457513110645907,i=i+1|0;while((i|0)!=(r|0))}w=+xi(+T)*_,ke[d>>3]=w,T=+Si(+T)*_,ke[d+8>>3]=T,Bt=B}function gu(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if(w=Bt,Bt=Bt+32|0,_=w,gs(i,_),o[r>>2]=0,ke[l>>3]=5,d=+_r(16400,_),d<+ke[l>>3]&&(o[r>>2]=0,ke[l>>3]=d),d=+_r(16424,_),d<+ke[l>>3]&&(o[r>>2]=1,ke[l>>3]=d),d=+_r(16448,_),d<+ke[l>>3]&&(o[r>>2]=2,ke[l>>3]=d),d=+_r(16472,_),d<+ke[l>>3]&&(o[r>>2]=3,ke[l>>3]=d),d=+_r(16496,_),d<+ke[l>>3]&&(o[r>>2]=4,ke[l>>3]=d),d=+_r(16520,_),d<+ke[l>>3]&&(o[r>>2]=5,ke[l>>3]=d),d=+_r(16544,_),d<+ke[l>>3]&&(o[r>>2]=6,ke[l>>3]=d),d=+_r(16568,_),d<+ke[l>>3]&&(o[r>>2]=7,ke[l>>3]=d),d=+_r(16592,_),d<+ke[l>>3]&&(o[r>>2]=8,ke[l>>3]=d),d=+_r(16616,_),d<+ke[l>>3]&&(o[r>>2]=9,ke[l>>3]=d),d=+_r(16640,_),d<+ke[l>>3]&&(o[r>>2]=10,ke[l>>3]=d),d=+_r(16664,_),d<+ke[l>>3]&&(o[r>>2]=11,ke[l>>3]=d),d=+_r(16688,_),d<+ke[l>>3]&&(o[r>>2]=12,ke[l>>3]=d),d=+_r(16712,_),d<+ke[l>>3]&&(o[r>>2]=13,ke[l>>3]=d),d=+_r(16736,_),d<+ke[l>>3]&&(o[r>>2]=14,ke[l>>3]=d),d=+_r(16760,_),d<+ke[l>>3]&&(o[r>>2]=15,ke[l>>3]=d),d=+_r(16784,_),d<+ke[l>>3]&&(o[r>>2]=16,ke[l>>3]=d),d=+_r(16808,_),d<+ke[l>>3]&&(o[r>>2]=17,ke[l>>3]=d),d=+_r(16832,_),d<+ke[l>>3]&&(o[r>>2]=18,ke[l>>3]=d),d=+_r(16856,_),!(d<+ke[l>>3])){Bt=w;return}o[r>>2]=19,ke[l>>3]=d,Bt=w}function Er(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0;if(w=+Ou(i),w<1e-16){r=15600+(r<<4)|0,o[_>>2]=o[r>>2],o[_+4>>2]=o[r+4>>2],o[_+8>>2]=o[r+8>>2],o[_+12>>2]=o[r+12>>2];return}if(T=+qn(+ +ke[i+8>>3],+ +ke[i>>3]),(l|0)>0){i=0;do w=w/2.6457513110645907,i=i+1|0;while((i|0)!=(l|0))}d?(w=w/3,l=(qs(l)|0)==0,w=+mn(+((l?w:w/2.6457513110645907)*.381966011250105))):(w=+mn(+(w*.381966011250105)),qs(l)|0&&(T=+gl(T+.3334731722518321))),ii(15600+(r<<4)|0,+gl(+ke[15920+(r*24|0)>>3]-T),w,_)}function $n(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;d=Bt,Bt=Bt+16|0,_=d,Zs(i+4|0,_),Er(_,o[i>>2]|0,r,0,l),Bt=d}function Ko(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0,Ke=0,yt=0,ot=0,ct=0,It=0,bt=0,ri=0,Xt=0,ti=0,si=0,Qi=0,Wi=0,Ei=0,Gi=0,qi=0,cn=0,zn=0,tn=0;if(cn=Bt,Bt=Bt+272|0,w=cn+256|0,ct=cn+240|0,Ei=cn,Gi=cn+224|0,qi=cn+208|0,It=cn+176|0,bt=cn+160|0,ri=cn+192|0,Xt=cn+144|0,ti=cn+128|0,si=cn+112|0,Qi=cn+96|0,Wi=cn+80|0,o[w>>2]=r,o[ct>>2]=o[i>>2],o[ct+4>>2]=o[i+4>>2],o[ct+8>>2]=o[i+8>>2],o[ct+12>>2]=o[i+12>>2],zr(ct,w,Ei),o[_>>2]=0,ct=d+l+((d|0)==5&1)|0,(ct|0)<=(l|0)){Bt=cn;return}j=o[w>>2]|0,X=Gi+4|0,ce=It+4|0,Se=l+5|0,Te=16880+(j<<2)|0,Re=16960+(j<<2)|0,Be=ti+8|0,Ke=si+8|0,yt=Qi+8|0,ot=qi+4|0,B=l;e:for(;;){T=Ei+(((B|0)%5|0)<<4)|0,o[qi>>2]=o[T>>2],o[qi+4>>2]=o[T+4>>2],o[qi+8>>2]=o[T+8>>2],o[qi+12>>2]=o[T+12>>2];do;while((Wa(qi,j,0,1)|0)==2);if((B|0)>(l|0)&(qs(r)|0)!=0){if(o[It>>2]=o[qi>>2],o[It+4>>2]=o[qi+4>>2],o[It+8>>2]=o[qi+8>>2],o[It+12>>2]=o[qi+12>>2],Zs(X,bt),d=o[It>>2]|0,w=o[17040+(d*80|0)+(o[Gi>>2]<<2)>>2]|0,o[It>>2]=o[18640+(d*80|0)+(w*20|0)>>2],T=o[18640+(d*80|0)+(w*20|0)+16>>2]|0,(T|0)>0){i=0;do El(ce),i=i+1|0;while((i|0)<(T|0))}switch(T=18640+(d*80|0)+(w*20|0)+4|0,o[ri>>2]=o[T>>2],o[ri+4>>2]=o[T+4>>2],o[ri+8>>2]=o[T+8>>2],Br(ri,(o[Te>>2]|0)*3|0),vr(ce,ri,ce),Lr(ce),Zs(ce,Xt),zn=+(o[Re>>2]|0),ke[ti>>3]=zn*3,ke[Be>>3]=0,tn=zn*-1.5,ke[si>>3]=tn,ke[Ke>>3]=zn*2.598076211353316,ke[Qi>>3]=tn,ke[yt>>3]=zn*-2.598076211353316,o[17040+((o[It>>2]|0)*80|0)+(o[qi>>2]<<2)>>2]|0){case 1:{i=si,d=ti;break}case 3:{i=Qi,d=si;break}case 2:{i=ti,d=Qi;break}default:{i=12;break e}}cu(bt,Xt,d,i,Wi),Er(Wi,o[It>>2]|0,j,1,_+8+(o[_>>2]<<4)|0),o[_>>2]=(o[_>>2]|0)+1}if((B|0)<(Se|0)&&(Zs(ot,It),Er(It,o[qi>>2]|0,j,1,_+8+(o[_>>2]<<4)|0),o[_>>2]=(o[_>>2]|0)+1),o[Gi>>2]=o[qi>>2],o[Gi+4>>2]=o[qi+4>>2],o[Gi+8>>2]=o[qi+8>>2],o[Gi+12>>2]=o[qi+12>>2],B=B+1|0,(B|0)>=(ct|0)){i=3;break}}if((i|0)==3){Bt=cn;return}else(i|0)==12&&Tn(22522,22569,571,22579)}function zr(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0;j=Bt,Bt=Bt+128|0,d=j+64|0,_=j,w=d,T=20240,B=w+60|0;do o[w>>2]=o[T>>2],w=w+4|0,T=T+4|0;while((w|0)<(B|0));w=_,T=20304,B=w+60|0;do o[w>>2]=o[T>>2],w=w+4|0,T=T+4|0;while((w|0)<(B|0));B=(qs(o[r>>2]|0)|0)==0,d=B?d:_,_=i+4|0,Cl(_),mu(_),qs(o[r>>2]|0)|0&&(ca(_),o[r>>2]=(o[r>>2]|0)+1),o[l>>2]=o[i>>2],r=l+4|0,vr(_,d,r),Lr(r),o[l+16>>2]=o[i>>2],r=l+20|0,vr(_,d+12|0,r),Lr(r),o[l+32>>2]=o[i>>2],r=l+36|0,vr(_,d+24|0,r),Lr(r),o[l+48>>2]=o[i>>2],r=l+52|0,vr(_,d+36|0,r),Lr(r),o[l+64>>2]=o[i>>2],l=l+68|0,vr(_,d+48|0,l),Lr(l),Bt=j}function Wa(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0;if(Be=Bt,Bt=Bt+32|0,Te=Be+12|0,B=Be,Re=i+4|0,Se=o[16960+(r<<2)>>2]|0,ce=(d|0)!=0,Se=ce?Se*3|0:Se,_=o[Re>>2]|0,X=i+8|0,T=o[X>>2]|0,ce){if(w=i+12|0,d=o[w>>2]|0,_=T+_+d|0,(_|0)==(Se|0))return Re=1,Bt=Be,Re|0;j=w}else j=i+12|0,d=o[j>>2]|0,_=T+_+d|0;if((_|0)<=(Se|0))return Re=0,Bt=Be,Re|0;do if((d|0)>0){if(d=o[i>>2]|0,(T|0)>0){w=18640+(d*80|0)+60|0,d=i;break}d=18640+(d*80|0)+40|0,l?(nr(Te,Se,0,0),Ks(Re,Te,B),Za(B),vr(B,Te,Re),w=d,d=i):(w=d,d=i)}else w=18640+((o[i>>2]|0)*80|0)+20|0,d=i;while(!1);if(o[d>>2]=o[w>>2],_=w+16|0,(o[_>>2]|0)>0){d=0;do El(Re),d=d+1|0;while((d|0)<(o[_>>2]|0))}return i=w+4|0,o[Te>>2]=o[i>>2],o[Te+4>>2]=o[i+4>>2],o[Te+8>>2]=o[i+8>>2],r=o[16880+(r<<2)>>2]|0,Br(Te,ce?r*3|0:r),vr(Re,Te,Re),Lr(Re),ce?d=((o[X>>2]|0)+(o[Re>>2]|0)+(o[j>>2]|0)|0)==(Se|0)?1:2:d=2,Re=d,Bt=Be,Re|0}function Jr(i,r){i=i|0,r=r|0;var l=0;do l=Wa(i,r,0,1)|0;while((l|0)==2);return l|0}function fr(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0,Ke=0,yt=0,ot=0,ct=0,It=0,bt=0,ri=0,Xt=0,ti=0,si=0,Qi=0,Wi=0,Ei=0;if(Qi=Bt,Bt=Bt+240|0,w=Qi+224|0,ri=Qi+208|0,Xt=Qi,ti=Qi+192|0,si=Qi+176|0,yt=Qi+160|0,ot=Qi+144|0,ct=Qi+128|0,It=Qi+112|0,bt=Qi+96|0,o[w>>2]=r,o[ri>>2]=o[i>>2],o[ri+4>>2]=o[i+4>>2],o[ri+8>>2]=o[i+8>>2],o[ri+12>>2]=o[i+12>>2],To(ri,w,Xt),o[_>>2]=0,Ke=d+l+((d|0)==6&1)|0,(Ke|0)<=(l|0)){Bt=Qi;return}j=o[w>>2]|0,X=l+6|0,ce=16960+(j<<2)|0,Se=ot+8|0,Te=ct+8|0,Re=It+8|0,Be=ti+4|0,T=0,B=l,d=-1;e:for(;;){if(w=(B|0)%6|0,i=Xt+(w<<4)|0,o[ti>>2]=o[i>>2],o[ti+4>>2]=o[i+4>>2],o[ti+8>>2]=o[i+8>>2],o[ti+12>>2]=o[i+12>>2],i=T,T=Wa(ti,j,0,1)|0,(B|0)>(l|0)&(qs(r)|0)!=0&&(i|0)!=1&&(o[ti>>2]|0)!=(d|0)){switch(Zs(Xt+(((w+5|0)%6|0)<<4)+4|0,si),Zs(Xt+(w<<4)+4|0,yt),Wi=+(o[ce>>2]|0),ke[ot>>3]=Wi*3,ke[Se>>3]=0,Ei=Wi*-1.5,ke[ct>>3]=Ei,ke[Te>>3]=Wi*2.598076211353316,ke[It>>3]=Ei,ke[Re>>3]=Wi*-2.598076211353316,w=o[ri>>2]|0,o[17040+(w*80|0)+(((d|0)==(w|0)?o[ti>>2]|0:d)<<2)>>2]|0){case 1:{i=ct,d=ot;break}case 3:{i=It,d=ct;break}case 2:{i=ot,d=It;break}default:{i=8;break e}}cu(si,yt,d,i,bt),!(Nu(si,bt)|0)&&!(Nu(yt,bt)|0)&&(Er(bt,o[ri>>2]|0,j,1,_+8+(o[_>>2]<<4)|0),o[_>>2]=(o[_>>2]|0)+1)}if((B|0)<(X|0)&&(Zs(Be,si),Er(si,o[ti>>2]|0,j,1,_+8+(o[_>>2]<<4)|0),o[_>>2]=(o[_>>2]|0)+1),B=B+1|0,(B|0)>=(Ke|0)){i=3;break}else d=o[ti>>2]|0}if((i|0)==3){Bt=Qi;return}else(i|0)==8&&Tn(22606,22569,736,22651)}function To(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0;j=Bt,Bt=Bt+160|0,d=j+80|0,_=j,w=d,T=20368,B=w+72|0;do o[w>>2]=o[T>>2],w=w+4|0,T=T+4|0;while((w|0)<(B|0));w=_,T=20448,B=w+72|0;do o[w>>2]=o[T>>2],w=w+4|0,T=T+4|0;while((w|0)<(B|0));B=(qs(o[r>>2]|0)|0)==0,d=B?d:_,_=i+4|0,Cl(_),mu(_),qs(o[r>>2]|0)|0&&(ca(_),o[r>>2]=(o[r>>2]|0)+1),o[l>>2]=o[i>>2],r=l+4|0,vr(_,d,r),Lr(r),o[l+16>>2]=o[i>>2],r=l+20|0,vr(_,d+12|0,r),Lr(r),o[l+32>>2]=o[i>>2],r=l+36|0,vr(_,d+24|0,r),Lr(r),o[l+48>>2]=o[i>>2],r=l+52|0,vr(_,d+36|0,r),Lr(r),o[l+64>>2]=o[i>>2],r=l+68|0,vr(_,d+48|0,r),Lr(r),o[l+80>>2]=o[i>>2],l=l+84|0,vr(_,d+60|0,l),Lr(l),Bt=j}function Gn(i,r){return i=i|0,r=r|0,r=Gt(i|0,r|0,52)|0,Ut()|0,r&15|0}function Ol(i,r){return i=i|0,r=r|0,r=Gt(i|0,r|0,45)|0,Ut()|0,r&127|0}function es(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0;if(!(!0&(r&-16777216|0)==134217728)||(T=Gt(i|0,r|0,45)|0,Ut()|0,T=T&127,T>>>0>121))return r=0,r|0;l=Gt(i|0,r|0,52)|0,Ut()|0,l=l&15;do if(l|0){for(_=1,d=0;;){if(w=Gt(i|0,r|0,(15-_|0)*3|0)|0,Ut()|0,w=w&7,(w|0)!=0&(d^1))if((w|0)==1&(rt(T)|0)!=0){B=0,d=13;break}else d=1;if((w|0)==7){B=0,d=13;break}if(_>>>0<l>>>0)_=_+1|0;else{d=9;break}}if((d|0)==9){if((l|0)==15)B=1;else break;return B|0}else if((d|0)==13)return B|0}while(!1);for(;;){if(B=Gt(i|0,r|0,(14-l|0)*3|0)|0,Ut()|0,!((B&7|0)==7&!0)){B=0,d=13;break}if(l>>>0<14)l=l+1|0;else{B=1,d=13;break}}return(d|0)==13?B|0:0}function Zr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0;if(w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,l>>>0>15)return d=4,d|0;if((w|0)<(l|0))return d=12,d|0;if((w|0)==(l|0))return o[d>>2]=i,o[d+4>>2]=r,d=0,d|0;if(_=Zt(l|0,0,52)|0,_=_|i,i=Ut()|0|r&-15728641,(w|0)>(l|0))do r=Zt(7,0,(14-l|0)*3|0)|0,l=l+1|0,_=r|_,i=Ut()|0|i;while((l|0)<(w|0));return o[d>>2]=_,o[d+4>>2]=i,d=0,d|0}function Ts(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0;if(w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,!((l|0)<16&(w|0)<=(l|0)))return d=4,d|0;_=l-w|0,l=Gt(i|0,r|0,45)|0,Ut()|0;e:do if(!(rt(l&127)|0))l=_l(7,0,_,((_|0)<0)<<31>>31)|0,_=Ut()|0;else{t:do if(w|0){for(l=1;T=Zt(7,0,(15-l|0)*3|0)|0,!!((T&i|0)==0&((Ut()|0)&r|0)==0);)if(l>>>0<w>>>0)l=l+1|0;else break t;l=_l(7,0,_,((_|0)<0)<<31>>31)|0,_=Ut()|0;break e}while(!1);l=_l(7,0,_,((_|0)<0)<<31>>31)|0,l=$e(l|0,Ut()|0,5,0)|0,l=z(l|0,Ut()|0,-5,-1)|0,l=oe(l|0,Ut()|0,6,0)|0,l=z(l|0,Ut()|0,1,0)|0,_=Ut()|0}while(!1);return T=d,o[T>>2]=l,o[T+4>>2]=_,T=0,T|0}function kr(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;if(_=Gt(i|0,r|0,45)|0,Ut()|0,!(rt(_&127)|0))return _=0,_|0;_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15;e:do if(!_)l=0;else for(d=1;;){if(l=Gt(i|0,r|0,(15-d|0)*3|0)|0,Ut()|0,l=l&7,l|0)break e;if(d>>>0<_>>>0)d=d+1|0;else{l=0;break}}while(!1);return _=(l|0)==0&1,_|0}function rr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0;if(T=Bt,Bt=Bt+16|0,w=T,cl(w,i,r,l),r=w,i=o[r>>2]|0,r=o[r+4>>2]|0,(i|0)==0&(r|0)==0)return Bt=T,0;_=0,l=0;do B=d+(_<<3)|0,o[B>>2]=i,o[B+4>>2]=r,_=z(_|0,l|0,1,0)|0,l=Ut()|0,lu(w),B=w,i=o[B>>2]|0,r=o[B+4>>2]|0;while(!((i|0)==0&(r|0)==0));return Bt=T,0}function ll(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,(d|0)<(l|0)?(l=r,d=i,Ki(l|0),d|0):(l=Zt(-1,-1,((d-l|0)*3|0)+3|0)|0,d=Zt(~l|0,~(Ut()|0)|0,(15-d|0)*3|0)|0,l=~(Ut()|0)&r,d=~d&i,Ki(l|0),d|0)}function Xr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0;return _=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15,(l|0)<16&(_|0)<=(l|0)?((_|0)<(l|0)&&(_=Zt(-1,-1,((l+-1-_|0)*3|0)+3|0)|0,_=Zt(~_|0,~(Ut()|0)|0,(15-l|0)*3|0)|0,r=~(Ut()|0)&r,i=~_&i),_=Zt(l|0,0,52)|0,l=r&-15728641|(Ut()|0),o[d>>2]=i|_,o[d+4>>2]=l,d=0,d|0):(d=4,d|0)}function ko(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0,Ke=0,yt=0,ot=0,ct=0,It=0,bt=0,ri=0,Xt=0,ti=0,si=0;if((l|0)==0&(d|0)==0)return ti=0,ti|0;if(_=i,w=o[_>>2]|0,_=o[_+4>>2]|0,!0&(_&15728640|0)==0){if(!((d|0)>0|(d|0)==0&l>>>0>0)||(ti=r,o[ti>>2]=w,o[ti+4>>2]=_,(l|0)==1&(d|0)==0))return ti=0,ti|0;_=1;do ri=i+(_<<3)|0,Xt=o[ri+4>>2]|0,ti=r+(_<<3)|0,o[ti>>2]=o[ri>>2],o[ti+4>>2]=Xt,_=_+1|0;while(0<(d|0)|(d|0)==0&_>>>0<l>>>0);return _=0,_|0}if(bt=l<<3,Xt=Ms(bt)|0,!Xt)return ti=13,ti|0;if(F(Xt|0,i|0,bt|0)|0,ri=D(l,8)|0,!ri)return C(Xt),ti=13,ti|0;e:do if(l|0){t:for(;;){_=Xt,ot=o[_>>2]|0,_=o[_+4>>2]|0,ct=Gt(ot|0,_|0,52)|0,Ut()|0,ct=ct&15,It=ct+-1|0,yt=(l|0)>0;i:do if((ct|0)!=0&yt){if(Re=((l|0)<0)<<31>>31,Be=Zt(It|0,0,52)|0,Ke=Ut()|0,It>>>0>15){if(!((ot|0)==0&(_|0)==0)){ti=17;break t}for(w=0;;){if(w=w+1|0,(w|0)>=(l|0))break i;if(d=Xt+(w<<3)|0,Ke=o[d>>2]|0,d=o[d+4>>2]|0,!((Ke|0)==0&(d|0)==0)){_=d,ti=17;break t}}}for(w=0,i=ot,d=_;;){if(!((i|0)==0&(d|0)==0)){if(!(!0&(d&117440512|0)==0)){ti=22;break t}if(B=Gt(i|0,d|0,52)|0,Ut()|0,B=B&15,(B|0)<(It|0)){_=12,ti=28;break t}if((B|0)!=(It|0)&&(i=i|Be,d=d&-15728641|Ke,B>>>0>=ct>>>0)){T=It;do Te=Zt(7,0,(14-T|0)*3|0)|0,T=T+1|0,i=Te|i,d=Ut()|0|d;while(T>>>0<B>>>0)}if(T=Ct(i|0,d|0,l|0,Re|0)|0,Ut()|0,X=ri+(T<<3)|0,B=X,j=o[B>>2]|0,B=o[B+4>>2]|0,(j|0)==0&(B|0)==0)T=X;else for(Te=0;;){if((Te|0)>(l|0)){ti=32;break t}if((j|0)==(i|0)&(B&-117440513|0)==(d|0)){ce=Gt(j|0,B|0,56)|0,Ut()|0,ce=ce&7,Se=ce+1|0,si=Gt(j|0,B|0,45)|0,Ut()|0;n:do if(!(rt(si&127)|0))B=7;else{if(j=Gt(j|0,B|0,52)|0,Ut()|0,j=j&15,!j){B=6;break}for(B=1;;){if(si=Zt(7,0,(15-B|0)*3|0)|0,!((si&i|0)==0&((Ut()|0)&d|0)==0)){B=7;break n}if(B>>>0<j>>>0)B=B+1|0;else{B=6;break}}}while(!1);if((ce+2|0)>>>0>B>>>0){ti=42;break t}si=Zt(Se|0,0,56)|0,d=Ut()|0|d&-117440513,Se=X,o[Se>>2]=0,o[Se+4>>2]=0,i=si|i}else T=(T+1|0)%(l|0)|0;if(X=ri+(T<<3)|0,B=X,j=o[B>>2]|0,B=o[B+4>>2]|0,(j|0)==0&(B|0)==0){T=X;break}else Te=Te+1|0}si=T,o[si>>2]=i,o[si+4>>2]=d}if(w=w+1|0,(w|0)>=(l|0))break i;d=Xt+(w<<3)|0,i=o[d>>2]|0,d=o[d+4>>2]|0}}while(!1);if((l+5|0)>>>0<11){ti=85;break}if(Ke=D((l|0)/6|0,8)|0,!Ke){ti=49;break}i:do if(yt){Te=0,Se=0;do{if(B=ri+(Te<<3)|0,d=B,w=o[d>>2]|0,d=o[d+4>>2]|0,!((w|0)==0&(d|0)==0)){j=Gt(w|0,d|0,56)|0,Ut()|0,j=j&7,i=j+1|0,X=d&-117440513,si=Gt(w|0,d|0,45)|0,Ut()|0;n:do if(rt(si&127)|0){if(ce=Gt(w|0,d|0,52)|0,Ut()|0,ce=ce&15,ce|0)for(T=1;;){if(si=Zt(7,0,(15-T|0)*3|0)|0,!((w&si|0)==0&(X&(Ut()|0)|0)==0))break n;if(T>>>0<ce>>>0)T=T+1|0;else break}d=Zt(i|0,0,56)|0,w=d|w,d=Ut()|0|X,i=B,o[i>>2]=w,o[i+4>>2]=d,i=j+2|0}while(!1);(i|0)==7&&(si=Ke+(Se<<3)|0,o[si>>2]=w,o[si+4>>2]=d&-117440513,Se=Se+1|0)}Te=Te+1|0}while((Te|0)!=(l|0));if(yt){if(Te=((l|0)<0)<<31>>31,Re=Zt(It|0,0,52)|0,Be=Ut()|0,It>>>0>15){if(!((ot|0)==0&(_|0)==0)){_=4,ti=84;break t}for(_=0;;){if(_=_+1|0,(_|0)>=(l|0)){w=0,_=Se;break i}if(si=Xt+(_<<3)|0,!((o[si>>2]|0)==0&(o[si+4>>2]|0)==0)){_=4,ti=84;break t}}}for(ce=0,w=0,X=ot;;){do if(!((X|0)==0&(_|0)==0)){if(B=Gt(X|0,_|0,52)|0,Ut()|0,B=B&15,(B|0)<(It|0)){_=12,ti=84;break t}do if((B|0)==(It|0))d=X,B=_;else{if(d=X|Re,i=_&-15728641|Be,B>>>0<ct>>>0){B=i;break}T=It;do si=Zt(7,0,(14-T|0)*3|0)|0,T=T+1|0,d=si|d,i=Ut()|0|i;while(T>>>0<B>>>0);B=i}while(!1);for(T=Ct(d|0,B|0,l|0,Te|0)|0,Ut()|0,i=0;;){if((i|0)>(l|0)){ti=77;break t}if(si=ri+(T<<3)|0,j=o[si+4>>2]|0,(j&-117440513|0)==(B|0)&&(o[si>>2]|0)==(d|0)){ti=79;break}if(T=(T+1|0)%(l|0)|0,si=ri+(T<<3)|0,(o[si>>2]|0)==(d|0)&&(o[si+4>>2]|0)==(B|0))break;i=i+1|0}if((ti|0)==79&&(ti=0,!0&(j&117440512|0)==100663296))break;si=r+(w<<3)|0,o[si>>2]=X,o[si+4>>2]=_,w=w+1|0}while(!1);if(_=ce+1|0,(_|0)>=(l|0)){_=Se;break i}si=Xt+(_<<3)|0,ce=_,X=o[si>>2]|0,_=o[si+4>>2]|0}}else w=0,_=Se}else w=0,_=0;while(!1);if(O(ri|0,0,bt|0)|0,F(Xt|0,Ke|0,_<<3|0)|0,C(Ke),_)r=r+(w<<3)|0,l=_;else break e}if((ti|0)==17)!0&(_&117440512|0)==0?(_=4,ti=28):ti=22;else if((ti|0)==32)Tn(23313,22674,362,22684);else{if((ti|0)==42)return C(Xt),C(ri),si=10,si|0;if((ti|0)==49)return C(Xt),C(ri),si=13,si|0;if((ti|0)==77)Tn(23313,22674,462,22684);else{if((ti|0)==84)return C(Ke),C(Xt),C(ri),si=_,si|0;if((ti|0)==85){F(r|0,Xt|0,l<<3|0)|0;break}}}if((ti|0)==22)return C(Xt),C(ri),si=5,si|0;if((ti|0)==28)return C(Xt),C(ri),si=_,si|0}while(!1);return C(Xt),C(ri),si=0,si|0}function ul(i,r,l,d,_,w,T){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0,T=T|0;var B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0,Ke=0;if(Ke=Bt,Bt=Bt+16|0,Be=Ke,!((l|0)>0|(l|0)==0&r>>>0>0))return Be=0,Bt=Ke,Be|0;if((T|0)>=16)return Be=12,Bt=Ke,Be|0;Te=0,Re=0,Se=0,B=0;e:for(;;){if(X=i+(Te<<3)|0,j=o[X>>2]|0,X=o[X+4>>2]|0,ce=Gt(j|0,X|0,52)|0,Ut()|0,(ce&15|0)>(T|0)){B=12,j=11;break}if(cl(Be,j,X,T),ce=Be,X=o[ce>>2]|0,ce=o[ce+4>>2]|0,(X|0)==0&(ce|0)==0)j=Se;else{j=Se;do{if(!((B|0)<(w|0)|(B|0)==(w|0)&j>>>0<_>>>0)){j=10;break e}Se=d+(j<<3)|0,o[Se>>2]=X,o[Se+4>>2]=ce,j=z(j|0,B|0,1,0)|0,B=Ut()|0,lu(Be),Se=Be,X=o[Se>>2]|0,ce=o[Se+4>>2]|0}while(!((X|0)==0&(ce|0)==0))}if(Te=z(Te|0,Re|0,1,0)|0,Re=Ut()|0,(Re|0)<(l|0)|(Re|0)==(l|0)&Te>>>0<r>>>0)Se=j;else{B=0,j=11;break}}return(j|0)==10?(Be=14,Bt=Ke,Be|0):(j|0)==11?(Bt=Ke,B|0):0}function Qr(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0;Te=Bt,Bt=Bt+16|0,Se=Te;e:do if((l|0)>0|(l|0)==0&r>>>0>0){for(X=0,T=0,w=0,ce=0;;){if(j=i+(X<<3)|0,B=o[j>>2]|0,j=o[j+4>>2]|0,!((B|0)==0&(j|0)==0)&&(j=(Ts(B,j,d,Se)|0)==0,B=Se,T=z(o[B>>2]|0,o[B+4>>2]|0,T|0,w|0)|0,w=Ut()|0,!j)){w=12;break}if(X=z(X|0,ce|0,1,0)|0,ce=Ut()|0,!((ce|0)<(l|0)|(ce|0)==(l|0)&X>>>0<r>>>0))break e}return Bt=Te,w|0}else T=0,w=0;while(!1);return o[_>>2]=T,o[_+4>>2]=w,_=0,Bt=Te,_|0}function ds(i,r){return i=i|0,r=r|0,r=Gt(i|0,r|0,52)|0,Ut()|0,r&1|0}function wa(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;if(_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15,!_)return _=0,_|0;for(d=1;;){if(l=Gt(i|0,r|0,(15-d|0)*3|0)|0,Ut()|0,l=l&7,l|0){d=5;break}if(d>>>0<_>>>0)d=d+1|0;else{l=0,d=5;break}}return(d|0)==5?l|0:0}function Tl(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0;if(j=Gt(i|0,r|0,52)|0,Ut()|0,j=j&15,!j)return B=r,j=i,Ki(B|0),j|0;for(B=1,l=0;;){w=(15-B|0)*3|0,d=Zt(7,0,w|0)|0,_=Ut()|0,T=Gt(i|0,r|0,w|0)|0,Ut()|0,w=Zt(Ta(T&7)|0,0,w|0)|0,T=Ut()|0,i=w|i&~d,r=T|r&~_;e:do if(!l)if((w&d|0)==0&(T&_|0)==0)l=0;else if(d=Gt(i|0,r|0,52)|0,Ut()|0,d=d&15,!d)l=1;else{l=1;t:for(;;){switch(T=Gt(i|0,r|0,(15-l|0)*3|0)|0,Ut()|0,T&7){case 1:break t;case 0:break;default:{l=1;break e}}if(l>>>0<d>>>0)l=l+1|0;else{l=1;break e}}for(l=1;;)if(T=(15-l|0)*3|0,_=Gt(i|0,r|0,T|0)|0,Ut()|0,w=Zt(7,0,T|0)|0,r=r&~(Ut()|0),T=Zt(Ta(_&7)|0,0,T|0)|0,i=i&~w|T,r=r|(Ut()|0),l>>>0<d>>>0)l=l+1|0;else{l=1;break}}while(!1);if(B>>>0<j>>>0)B=B+1|0;else break}return Ki(r|0),i|0}function Mo(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0;if(d=Gt(i|0,r|0,52)|0,Ut()|0,d=d&15,!d)return l=r,d=i,Ki(l|0),d|0;for(l=1;w=(15-l|0)*3|0,T=Gt(i|0,r|0,w|0)|0,Ut()|0,_=Zt(7,0,w|0)|0,r=r&~(Ut()|0),w=Zt(Ta(T&7)|0,0,w|0)|0,i=w|i&~_,r=Ut()|0|r,l>>>0<d>>>0;)l=l+1|0;return Ki(r|0),i|0}function kl(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0;if(j=Gt(i|0,r|0,52)|0,Ut()|0,j=j&15,!j)return B=r,j=i,Ki(B|0),j|0;for(B=1,l=0;;){w=(15-B|0)*3|0,d=Zt(7,0,w|0)|0,_=Ut()|0,T=Gt(i|0,r|0,w|0)|0,Ut()|0,w=Zt(ml(T&7)|0,0,w|0)|0,T=Ut()|0,i=w|i&~d,r=T|r&~_;e:do if(!l)if((w&d|0)==0&(T&_|0)==0)l=0;else if(d=Gt(i|0,r|0,52)|0,Ut()|0,d=d&15,!d)l=1;else{l=1;t:for(;;){switch(T=Gt(i|0,r|0,(15-l|0)*3|0)|0,Ut()|0,T&7){case 1:break t;case 0:break;default:{l=1;break e}}if(l>>>0<d>>>0)l=l+1|0;else{l=1;break e}}for(l=1;;)if(_=(15-l|0)*3|0,w=Zt(7,0,_|0)|0,T=r&~(Ut()|0),r=Gt(i|0,r|0,_|0)|0,Ut()|0,r=Zt(ml(r&7)|0,0,_|0)|0,i=i&~w|r,r=T|(Ut()|0),l>>>0<d>>>0)l=l+1|0;else{l=1;break}}while(!1);if(B>>>0<j>>>0)B=B+1|0;else break}return Ki(r|0),i|0}function go(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0;if(d=Gt(i|0,r|0,52)|0,Ut()|0,d=d&15,!d)return l=r,d=i,Ki(l|0),d|0;for(l=1;T=(15-l|0)*3|0,w=Zt(7,0,T|0)|0,_=r&~(Ut()|0),r=Gt(i|0,r|0,T|0)|0,Ut()|0,r=Zt(ml(r&7)|0,0,T|0)|0,i=r|i&~w,r=Ut()|0|_,l>>>0<d>>>0;)l=l+1|0;return Ki(r|0),i|0}function Js(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0,ce=0;if(j=Bt,Bt=Bt+64|0,B=j+40|0,d=j+24|0,_=j+12|0,w=j,Zt(r|0,0,52)|0,l=Ut()|0|134225919,!r)return(o[i+4>>2]|0)>2||(o[i+8>>2]|0)>2||(o[i+12>>2]|0)>2?(T=0,B=0,Ki(T|0),Bt=j,B|0):(Zt($t(i)|0,0,45)|0,T=Ut()|0|l,B=-1,Ki(T|0),Bt=j,B|0);if(o[B>>2]=o[i>>2],o[B+4>>2]=o[i+4>>2],o[B+8>>2]=o[i+8>>2],o[B+12>>2]=o[i+12>>2],T=B+4|0,(r|0)>0)for(i=-1;o[d>>2]=o[T>>2],o[d+4>>2]=o[T+4>>2],o[d+8>>2]=o[T+8>>2],r&1?(Il(T),o[_>>2]=o[T>>2],o[_+4>>2]=o[T+4>>2],o[_+8>>2]=o[T+8>>2],Qo(_)):(mo(T),o[_>>2]=o[T>>2],o[_+4>>2]=o[T+4>>2],o[_+8>>2]=o[T+8>>2],ca(_)),Ks(d,_,w),Lr(w),ce=(15-r|0)*3|0,X=Zt(7,0,ce|0)|0,l=l&~(Ut()|0),ce=Zt(Eo(w)|0,0,ce|0)|0,i=ce|i&~X,l=Ut()|0|l,(r|0)>1;)r=r+-1|0;else i=-1;e:do if((o[T>>2]|0)<=2&&(o[B+8>>2]|0)<=2&&(o[B+12>>2]|0)<=2){if(d=$t(B)|0,r=Zt(d|0,0,45)|0,r=r|i,i=Ut()|0|l&-1040385,w=Ii(B)|0,!(rt(d)|0)){if((w|0)<=0)break;for(_=0;;){if(d=Gt(r|0,i|0,52)|0,Ut()|0,d=d&15,d)for(l=1;ce=(15-l|0)*3|0,B=Gt(r|0,i|0,ce|0)|0,Ut()|0,X=Zt(7,0,ce|0)|0,i=i&~(Ut()|0),ce=Zt(Ta(B&7)|0,0,ce|0)|0,r=r&~X|ce,i=i|(Ut()|0),l>>>0<d>>>0;)l=l+1|0;if(_=_+1|0,(_|0)==(w|0))break e}}_=Gt(r|0,i|0,52)|0,Ut()|0,_=_&15;t:do if(_){l=1;i:for(;;){switch(ce=Gt(r|0,i|0,(15-l|0)*3|0)|0,Ut()|0,ce&7){case 1:break i;case 0:break;default:break t}if(l>>>0<_>>>0)l=l+1|0;else break t}if(pn(d,o[B>>2]|0)|0)for(l=1;B=(15-l|0)*3|0,X=Zt(7,0,B|0)|0,ce=i&~(Ut()|0),i=Gt(r|0,i|0,B|0)|0,Ut()|0,i=Zt(ml(i&7)|0,0,B|0)|0,r=r&~X|i,i=ce|(Ut()|0),l>>>0<_>>>0;)l=l+1|0;else for(l=1;ce=(15-l|0)*3|0,B=Gt(r|0,i|0,ce|0)|0,Ut()|0,X=Zt(7,0,ce|0)|0,i=i&~(Ut()|0),ce=Zt(Ta(B&7)|0,0,ce|0)|0,r=r&~X|ce,i=i|(Ut()|0),l>>>0<_>>>0;)l=l+1|0}while(!1);if((w|0)>0){l=0;do r=Tl(r,i)|0,i=Ut()|0,l=l+1|0;while((l|0)!=(w|0))}}else r=0,i=0;while(!1);return X=i,ce=r,Ki(X|0),Bt=j,ce|0}function qs(i){return i=i|0,(i|0)%2|0|0}function $a(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;return _=Bt,Bt=Bt+16|0,d=_,r>>>0>15?(d=4,Bt=_,d|0):(o[i+4>>2]&2146435072|0)==2146435072||(o[i+8+4>>2]&2146435072|0)==2146435072?(d=3,Bt=_,d|0):(Qa(i,r,d),r=Js(d,r)|0,d=Ut()|0,o[l>>2]=r,o[l+4>>2]=d,(r|0)==0&(d|0)==0&&Tn(23313,22674,786,22697),d=0,Bt=_,d|0)}function Jo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;if(_=l+4|0,w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,T=Gt(i|0,r|0,45)|0,Ut()|0,d=(w|0)==0,rt(T&127)|0){if(d)return T=1,T|0;d=1}else{if(d)return T=0,T|0;!(o[_>>2]|0)&&!(o[l+8>>2]|0)?d=(o[l+12>>2]|0)!=0&1:d=1}for(l=1;l&1?Qo(_):ca(_),T=Gt(i|0,r|0,(15-l|0)*3|0)|0,Ut()|0,Ys(_,T&7),l>>>0<w>>>0;)l=l+1|0;return d|0}function Yr(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ce=0;if(ce=Bt,Bt=Bt+16|0,j=ce,X=Gt(i|0,r|0,45)|0,Ut()|0,X=X&127,X>>>0>121)return o[l>>2]=0,o[l+4>>2]=0,o[l+8>>2]=0,o[l+12>>2]=0,X=5,Bt=ce,X|0;e:do if(rt(X)|0&&(w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,(w|0)!=0)){d=1;t:for(;;){switch(B=Gt(i|0,r|0,(15-d|0)*3|0)|0,Ut()|0,B&7){case 5:break t;case 0:break;default:{d=r;break e}}if(d>>>0<w>>>0)d=d+1|0;else{d=r;break e}}for(_=1,d=r;r=(15-_|0)*3|0,T=Zt(7,0,r|0)|0,B=d&~(Ut()|0),d=Gt(i|0,d|0,r|0)|0,Ut()|0,d=Zt(ml(d&7)|0,0,r|0)|0,i=i&~T|d,d=B|(Ut()|0),_>>>0<w>>>0;)_=_+1|0}else d=r;while(!1);if(B=7696+(X*28|0)|0,o[l>>2]=o[B>>2],o[l+4>>2]=o[B+4>>2],o[l+8>>2]=o[B+8>>2],o[l+12>>2]=o[B+12>>2],!(Jo(i,d,l)|0))return X=0,Bt=ce,X|0;if(T=l+4|0,o[j>>2]=o[T>>2],o[j+4>>2]=o[T+4>>2],o[j+8>>2]=o[T+8>>2],w=Gt(i|0,d|0,52)|0,Ut()|0,B=w&15,w&1?(ca(T),w=B+1|0):w=B,!(rt(X)|0))d=0;else{e:do if(!B)d=0;else for(r=1;;){if(_=Gt(i|0,d|0,(15-r|0)*3|0)|0,Ut()|0,_=_&7,_|0){d=_;break e}if(r>>>0<B>>>0)r=r+1|0;else{d=0;break}}while(!1);d=(d|0)==4&1}if(!(Wa(l,w,d,0)|0))(w|0)!=(B|0)&&(o[T>>2]=o[j>>2],o[T+4>>2]=o[j+4>>2],o[T+8>>2]=o[j+8>>2]);else{if(rt(X)|0)do;while(Wa(l,w,0,0)|0);(w|0)!=(B|0)&&mo(T)}return X=0,Bt=ce,X|0}function mr(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;return w=Bt,Bt=Bt+16|0,d=w,_=Yr(i,r,d)|0,_|0?(Bt=w,_|0):(_=Gt(i|0,r|0,52)|0,Ut()|0,$n(d,_&15,l),_=0,Bt=w,_|0)}function Nr(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0;if(T=Bt,Bt=Bt+16|0,w=T,d=Yr(i,r,w)|0,d|0)return w=d,Bt=T,w|0;d=Gt(i|0,r|0,45)|0,Ut()|0,d=(rt(d&127)|0)==0,_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15;e:do if(!d){if(_|0)for(d=1;;){if(B=Zt(7,0,(15-d|0)*3|0)|0,!((B&i|0)==0&((Ut()|0)&r|0)==0))break e;if(d>>>0<_>>>0)d=d+1|0;else break}return Ko(w,_,0,5,l),B=0,Bt=T,B|0}while(!1);return fr(w,_,0,6,l),B=0,Bt=T,B|0}function ha(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if(_=Gt(i|0,r|0,45)|0,Ut()|0,!(rt(_&127)|0))return _=2,o[l>>2]=_,0;if(_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15,!_)return _=5,o[l>>2]=_,0;for(d=1;;){if(w=Zt(7,0,(15-d|0)*3|0)|0,!((w&i|0)==0&((Ut()|0)&r|0)==0)){d=2,i=6;break}if(d>>>0<_>>>0)d=d+1|0;else{d=5,i=6;break}}return(i|0)==6&&(o[l>>2]=d),0}function _o(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ce=0,Se=0;Se=Bt,Bt=Bt+128|0,X=Se+112|0,w=Se+96|0,ce=Se,_=Gt(i|0,r|0,52)|0,Ut()|0,B=_&15,o[X>>2]=B,T=Gt(i|0,r|0,45)|0,Ut()|0,T=T&127;e:do if(rt(T)|0){if(B|0)for(d=1;;){if(j=Zt(7,0,(15-d|0)*3|0)|0,!((j&i|0)==0&((Ut()|0)&r|0)==0)){_=0;break e}if(d>>>0<B>>>0)d=d+1|0;else break}if(_&1)_=1;else return j=Zt(B+1|0,0,52)|0,ce=Ut()|0|r&-15728641,X=Zt(7,0,(14-B|0)*3|0)|0,ce=_o((j|i)&~X,ce&~(Ut()|0),l)|0,Bt=Se,ce|0}else _=0;while(!1);if(d=Yr(i,r,w)|0,!d){_?(zr(w,X,ce),j=5):(To(w,X,ce),j=6);e:do if(rt(T)|0)if(!B)i=5;else for(d=1;;){if(T=Zt(7,0,(15-d|0)*3|0)|0,!((T&i|0)==0&((Ut()|0)&r|0)==0)){i=2;break e}if(d>>>0<B>>>0)d=d+1|0;else{i=5;break}}else i=2;while(!1);O(l|0,-1,i<<2|0)|0;e:do if(_)for(w=0;;){if(T=ce+(w<<4)|0,Jr(T,o[X>>2]|0)|0,T=o[T>>2]|0,B=o[l>>2]|0,(B|0)==-1|(B|0)==(T|0))d=l;else{_=0;do{if(_=_+1|0,_>>>0>=i>>>0){d=1;break e}d=l+(_<<2)|0,B=o[d>>2]|0}while(!((B|0)==-1|(B|0)==(T|0)))}if(o[d>>2]=T,w=w+1|0,w>>>0>=j>>>0){d=0;break}}else for(w=0;;){if(T=ce+(w<<4)|0,Wa(T,o[X>>2]|0,0,1)|0,T=o[T>>2]|0,B=o[l>>2]|0,(B|0)==-1|(B|0)==(T|0))d=l;else{_=0;do{if(_=_+1|0,_>>>0>=i>>>0){d=1;break e}d=l+(_<<2)|0,B=o[d>>2]|0}while(!((B|0)==-1|(B|0)==(T|0)))}if(o[d>>2]=T,w=w+1|0,w>>>0>=j>>>0){d=0;break}}while(!1)}return ce=d,Bt=Se,ce|0}function ea(){return 12}function Sa(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0;if(i>>>0>15)return B=4,B|0;if(Zt(i|0,0,52)|0,B=Ut()|0|134225919,!i){l=0,d=0;do rt(d)|0&&(Zt(d|0,0,45)|0,T=B|(Ut()|0),i=r+(l<<3)|0,o[i>>2]=-1,o[i+4>>2]=T,l=l+1|0),d=d+1|0;while((d|0)!=122);return l=0,l|0}l=0,T=0;do{if(rt(T)|0){for(Zt(T|0,0,45)|0,d=1,_=-1,w=B|(Ut()|0);j=Zt(7,0,(15-d|0)*3|0)|0,_=_&~j,w=w&~(Ut()|0),(d|0)!=(i|0);)d=d+1|0;j=r+(l<<3)|0,o[j>>2]=_,o[j+4>>2]=w,l=l+1|0}T=T+1|0}while((T|0)!=122);return l=0,l|0}function ka(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0,Ke=0,yt=0,ot=0,ct=0;if(ct=Bt,Bt=Bt+16|0,yt=ct,ot=Gt(i|0,r|0,52)|0,Ut()|0,ot=ot&15,l>>>0>15)return ot=4,Bt=ct,ot|0;if((ot|0)<(l|0))return ot=12,Bt=ct,ot|0;if((ot|0)!=(l|0))if(w=Zt(l|0,0,52)|0,w=w|i,B=Ut()|0|r&-15728641,(ot|0)>(l|0)){j=l;do Ke=Zt(7,0,(14-j|0)*3|0)|0,j=j+1|0,w=Ke|w,B=Ut()|0|B;while((j|0)<(ot|0));Ke=w}else Ke=w;else Ke=i,B=r;Be=Gt(Ke|0,B|0,45)|0,Ut()|0;e:do if(rt(Be&127)|0){if(j=Gt(Ke|0,B|0,52)|0,Ut()|0,j=j&15,j|0)for(w=1;;){if(Be=Zt(7,0,(15-w|0)*3|0)|0,!((Be&Ke|0)==0&((Ut()|0)&B|0)==0)){X=33;break e}if(w>>>0<j>>>0)w=w+1|0;else break}if(Be=d,o[Be>>2]=0,o[Be+4>>2]=0,(ot|0)>(l|0)){for(Be=r&-15728641,Re=ot;;){if(Te=Re,Re=Re+-1|0,Re>>>0>15|(ot|0)<(Re|0)){X=19;break}if((ot|0)!=(Re|0))if(w=Zt(Re|0,0,52)|0,w=w|i,j=Ut()|0|Be,(ot|0)<(Te|0))Se=w;else{X=Re;do Se=Zt(7,0,(14-X|0)*3|0)|0,X=X+1|0,w=Se|w,j=Ut()|0|j;while((X|0)<(ot|0));Se=w}else Se=i,j=r;if(ce=Gt(Se|0,j|0,45)|0,Ut()|0,!(rt(ce&127)|0))w=0;else{ce=Gt(Se|0,j|0,52)|0,Ut()|0,ce=ce&15;t:do if(!ce)w=0;else for(X=1;;){if(w=Gt(Se|0,j|0,(15-X|0)*3|0)|0,Ut()|0,w=w&7,w|0)break t;if(X>>>0<ce>>>0)X=X+1|0;else{w=0;break}}while(!1);w=(w|0)==0&1}if(j=Gt(i|0,r|0,(15-Te|0)*3|0)|0,Ut()|0,j=j&7,(j|0)==7){_=5,X=42;break}if(w=(w|0)!=0,(j|0)==1&w){_=5,X=42;break}if(Se=j+(((j|0)!=0&w)<<31>>31)|0,Se|0&&(X=ot-Te|0,X=_l(7,0,X,((X|0)<0)<<31>>31)|0,ce=Ut()|0,w?(w=$e(X|0,ce|0,5,0)|0,w=z(w|0,Ut()|0,-5,-1)|0,w=oe(w|0,Ut()|0,6,0)|0,w=z(w|0,Ut()|0,1,0)|0,j=Ut()|0):(w=X,j=ce),Te=Se+-1|0,Te=$e(X|0,ce|0,Te|0,((Te|0)<0)<<31>>31|0)|0,Te=z(w|0,j|0,Te|0,Ut()|0)|0,Se=Ut()|0,ce=d,ce=z(Te|0,Se|0,o[ce>>2]|0,o[ce+4>>2]|0)|0,Se=Ut()|0,Te=d,o[Te>>2]=ce,o[Te+4>>2]=Se),(Re|0)<=(l|0)){X=37;break}}if((X|0)==19)Tn(23313,22674,1099,22710);else if((X|0)==37){T=d,_=o[T+4>>2]|0,T=o[T>>2]|0;break}else if((X|0)==42)return Bt=ct,_|0}else _=0,T=0}else X=33;while(!1);e:do if((X|0)==33)if(Be=d,o[Be>>2]=0,o[Be+4>>2]=0,(ot|0)>(l|0)){for(w=ot;;){if(_=Gt(i|0,r|0,(15-w|0)*3|0)|0,Ut()|0,_=_&7,(_|0)==7){_=5;break}if(T=ot-w|0,T=_l(7,0,T,((T|0)<0)<<31>>31)|0,_=$e(T|0,Ut()|0,_|0,0)|0,T=Ut()|0,Be=d,T=z(o[Be>>2]|0,o[Be+4>>2]|0,_|0,T|0)|0,_=Ut()|0,Be=d,o[Be>>2]=T,o[Be+4>>2]=_,w=w+-1|0,(w|0)<=(l|0))break e}return Bt=ct,_|0}else _=0,T=0;while(!1);return Ts(Ke,B,ot,yt)|0&&Tn(23313,22674,1063,22725),ot=yt,yt=o[ot+4>>2]|0,((_|0)>-1|(_|0)==-1&T>>>0>4294967295)&((yt|0)>(_|0)|((yt|0)==(_|0)?(o[ot>>2]|0)>>>0>T>>>0:0))?(ot=0,Bt=ct,ot|0):(Tn(23313,22674,1139,22710),0)}function Xa(i,r,l,d,_,w){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0;var T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0,Ke=0;if(Se=Bt,Bt=Bt+16|0,T=Se,_>>>0>15)return w=4,Bt=Se,w|0;if(B=Gt(l|0,d|0,52)|0,Ut()|0,B=B&15,(B|0)>(_|0))return w=12,Bt=Se,w|0;if(Ts(l,d,_,T)|0&&Tn(23313,22674,1063,22725),ce=T,X=o[ce+4>>2]|0,!(((r|0)>-1|(r|0)==-1&i>>>0>4294967295)&((X|0)>(r|0)|((X|0)==(r|0)?(o[ce>>2]|0)>>>0>i>>>0:0))))return w=2,Bt=Se,w|0;ce=_-B|0,_=Zt(_|0,0,52)|0,j=Ut()|0|d&-15728641,X=w,o[X>>2]=_|l,o[X+4>>2]=j,X=Gt(l|0,d|0,45)|0,Ut()|0;e:do if(rt(X&127)|0){if(B|0)for(T=1;;){if(X=Zt(7,0,(15-T|0)*3|0)|0,!((X&l|0)==0&((Ut()|0)&d|0)==0))break e;if(T>>>0<B>>>0)T=T+1|0;else break}if((ce|0)<1)return w=0,Bt=Se,w|0;for(X=B^15,d=-1,j=1,T=1;;){B=ce-j|0,B=_l(7,0,B,((B|0)<0)<<31>>31)|0,l=Ut()|0;do if(T)if(T=$e(B|0,l|0,5,0)|0,T=z(T|0,Ut()|0,-5,-1)|0,T=oe(T|0,Ut()|0,6,0)|0,_=Ut()|0,(r|0)>(_|0)|(r|0)==(_|0)&i>>>0>T>>>0){r=z(i|0,r|0,-1,-1)|0,r=R(r|0,Ut()|0,T|0,_|0)|0,T=Ut()|0,Te=w,Be=o[Te>>2]|0,Te=o[Te+4>>2]|0,Ke=(X+d|0)*3|0,Re=Zt(7,0,Ke|0)|0,Te=Te&~(Ut()|0),d=oe(r|0,T|0,B|0,l|0)|0,i=Ut()|0,_=z(d|0,i|0,2,0)|0,Ke=Zt(_|0,Ut()|0,Ke|0)|0,Te=Ut()|0|Te,_=w,o[_>>2]=Ke|Be&~Re,o[_+4>>2]=Te,i=$e(d|0,i|0,B|0,l|0)|0,i=R(r|0,T|0,i|0,Ut()|0)|0,T=0,r=Ut()|0;break}else{Ke=w,Re=o[Ke>>2]|0,Ke=o[Ke+4>>2]|0,Be=Zt(7,0,(X+d|0)*3|0)|0,Ke=Ke&~(Ut()|0),T=w,o[T>>2]=Re&~Be,o[T+4>>2]=Ke,T=1;break}else Re=w,_=o[Re>>2]|0,Re=o[Re+4>>2]|0,d=(X+d|0)*3|0,Te=Zt(7,0,d|0)|0,Re=Re&~(Ut()|0),Ke=oe(i|0,r|0,B|0,l|0)|0,T=Ut()|0,d=Zt(Ke|0,T|0,d|0)|0,Re=Ut()|0|Re,Be=w,o[Be>>2]=d|_&~Te,o[Be+4>>2]=Re,T=$e(Ke|0,T|0,B|0,l|0)|0,i=R(i|0,r|0,T|0,Ut()|0)|0,T=0,r=Ut()|0;while(!1);if((ce|0)>(j|0))d=~j,j=j+1|0;else{r=0;break}}return Bt=Se,r|0}while(!1);if((ce|0)<1)return Ke=0,Bt=Se,Ke|0;for(_=B^15,T=1;;)if(Be=ce-T|0,Be=_l(7,0,Be,((Be|0)<0)<<31>>31)|0,Ke=Ut()|0,j=w,l=o[j>>2]|0,j=o[j+4>>2]|0,B=(_-T|0)*3|0,d=Zt(7,0,B|0)|0,j=j&~(Ut()|0),Te=oe(i|0,r|0,Be|0,Ke|0)|0,Re=Ut()|0,B=Zt(Te|0,Re|0,B|0)|0,j=Ut()|0|j,X=w,o[X>>2]=B|l&~d,o[X+4>>2]=j,Ke=$e(Te|0,Re|0,Be|0,Ke|0)|0,i=R(i|0,r|0,Ke|0,Ut()|0)|0,r=Ut()|0,(ce|0)<=(T|0)){r=0;break}else T=T+1|0;return Bt=Se,r|0}function cl(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0;_=Gt(r|0,l|0,52)|0,Ut()|0,_=_&15,(r|0)==0&(l|0)==0|((d|0)>15|(_|0)>(d|0))?(d=-1,_=-1,r=0,l=0):(w=ll(r,l,_+1|0,d)|0,l=(Ut()|0)&-15728641,r=Zt(d|0,0,52)|0,r=w|r,l=l|(Ut()|0),w=(kr(r,l)|0)==0,d=w?-1:d),w=i,o[w>>2]=r,o[w+4>>2]=l,o[i+8>>2]=_,o[i+12>>2]=d}function lu(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0;if(l=i,r=o[l>>2]|0,l=o[l+4>>2]|0,!((r|0)==0&(l|0)==0)&&(d=Gt(r|0,l|0,52)|0,Ut()|0,d=d&15,B=Zt(1,0,(d^15)*3|0)|0,r=z(B|0,Ut()|0,r|0,l|0)|0,l=Ut()|0,B=i,o[B>>2]=r,o[B+4>>2]=l,B=i+8|0,T=o[B>>2]|0,!((d|0)<(T|0)))){for(j=i+12|0,w=d;;){if((w|0)==(T|0)){d=5;break}if(X=(w|0)==(o[j>>2]|0),_=(15-w|0)*3|0,d=Gt(r|0,l|0,_|0)|0,Ut()|0,d=d&7,X&((d|0)==1&!0)){d=7;break}if(!((d|0)==7&!0)){d=10;break}if(X=Zt(1,0,_|0)|0,r=z(r|0,l|0,X|0,Ut()|0)|0,l=Ut()|0,X=i,o[X>>2]=r,o[X+4>>2]=l,(w|0)>(T|0))w=w+-1|0;else{d=10;break}}if((d|0)==5){X=i,o[X>>2]=0,o[X+4>>2]=0,o[B>>2]=-1,o[j>>2]=-1;return}else if((d|0)==7){T=Zt(1,0,_|0)|0,T=z(r|0,l|0,T|0,Ut()|0)|0,B=Ut()|0,X=i,o[X>>2]=T,o[X+4>>2]=B,o[j>>2]=w+-1;return}else if((d|0)==10)return}}function gl(i){i=+i;var r=0;return r=i<0?i+6.283185307179586:i,+(i>=6.283185307179586?r+-6.283185307179586:r)}function ao(i,r){return i=i|0,r=r|0,+Jt(+(+ke[i>>3]-+ke[r>>3]))<17453292519943298e-27?(r=+Jt(+(+ke[i+8>>3]-+ke[r+8>>3]))<17453292519943298e-27,r|0):(r=0,r|0)}function pi(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return _=+ke[r>>3],d=+ke[i>>3],w=+Si(+((_-d)*.5)),l=+Si(+((+ke[r+8>>3]-+ke[i+8>>3])*.5)),l=w*w+l*(+xi(+_)*+xi(+d)*l),+(+qn(+ +oi(+l),+ +oi(+(1-l)))*2)}function Ui(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return _=+ke[r>>3],d=+ke[i>>3],w=+Si(+((_-d)*.5)),l=+Si(+((+ke[r+8>>3]-+ke[i+8>>3])*.5)),l=w*w+l*(+xi(+_)*+xi(+d)*l),+(+qn(+ +oi(+l),+ +oi(+(1-l)))*2*6371.007180918475)}function Di(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return _=+ke[r>>3],d=+ke[i>>3],w=+Si(+((_-d)*.5)),l=+Si(+((+ke[r+8>>3]-+ke[i+8>>3])*.5)),l=w*w+l*(+xi(+_)*+xi(+d)*l),+(+qn(+ +oi(+l),+ +oi(+(1-l)))*2*6371.007180918475*1e3)}function Ft(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0;return w=+ke[r>>3],d=+xi(+w),_=+ke[r+8>>3]-+ke[i+8>>3],T=d*+Si(+_),l=+ke[i>>3],+ +qn(+T,+(+Si(+w)*+xi(+l)-+xi(+_)*(d*+Si(+l))))}function ii(i,r,l,d){i=i|0,r=+r,l=+l,d=d|0;var _=0,w=0,T=0,B=0;if(l<1e-16){o[d>>2]=o[i>>2],o[d+4>>2]=o[i+4>>2],o[d+8>>2]=o[i+8>>2],o[d+12>>2]=o[i+12>>2];return}w=r<0?r+6.283185307179586:r,w=r>=6.283185307179586?w+-6.283185307179586:w;do if(w<1e-16)r=+ke[i>>3]+l,ke[d>>3]=r,_=d;else{if(_=+Jt(+(w+-3.141592653589793))<1e-16,r=+ke[i>>3],_){r=r-l,ke[d>>3]=r,_=d;break}if(T=+xi(+l),l=+Si(+l),r=T*+Si(+r)+ +xi(+w)*(l*+xi(+r)),r=r>1?1:r,r=+or(+(r<-1?-1:r)),ke[d>>3]=r,+Jt(+(r+-1.5707963267948966))<1e-16){ke[d>>3]=1.5707963267948966,ke[d+8>>3]=0;return}if(+Jt(+(r+1.5707963267948966))<1e-16){ke[d>>3]=-1.5707963267948966,ke[d+8>>3]=0;return}if(B=+xi(+r),w=l*+Si(+w)/B,l=+ke[i>>3],r=(T-+Si(+r)*+Si(+l))/+xi(+l)/B,T=w>1?1:w,r=r>1?1:r,r=+ke[i+8>>3]+ +qn(+(T<-1?-1:T),+(r<-1?-1:r)),r>3.141592653589793)do r=r+-6.283185307179586;while(r>3.141592653589793);if(r<-3.141592653589793)do r=r+6.283185307179586;while(r<-3.141592653589793);ke[d+8>>3]=r;return}while(!1);if(+Jt(+(r+-1.5707963267948966))<1e-16){ke[_>>3]=1.5707963267948966,ke[d+8>>3]=0;return}if(+Jt(+(r+1.5707963267948966))<1e-16){ke[_>>3]=-1.5707963267948966,ke[d+8>>3]=0;return}if(r=+ke[i+8>>3],r>3.141592653589793)do r=r+-6.283185307179586;while(r>3.141592653589793);if(r<-3.141592653589793)do r=r+6.283185307179586;while(r<-3.141592653589793);ke[d+8>>3]=r}function bi(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(ke[r>>3]=+ke[20528+(i<<3)>>3],r=0,r|0)}function Fi(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(ke[r>>3]=+ke[20656+(i<<3)>>3],r=0,r|0)}function Bn(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(ke[r>>3]=+ke[20784+(i<<3)>>3],r=0,r|0)}function Hn(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(ke[r>>3]=+ke[20912+(i<<3)>>3],r=0,r|0)}function lr(i,r){i=i|0,r=r|0;var l=0;return i>>>0>15?(r=4,r|0):(l=_l(7,0,i,((i|0)<0)<<31>>31)|0,l=$e(l|0,Ut()|0,120,0)|0,i=Ut()|0,o[r>>2]=l|2,o[r+4>>2]=i,r=0,r|0)}function Xn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0;return Te=+ke[r>>3],ce=+ke[i>>3],j=+Si(+((Te-ce)*.5)),w=+ke[r+8>>3],X=+ke[i+8>>3],T=+Si(+((w-X)*.5)),B=+xi(+ce),Se=+xi(+Te),T=j*j+T*(Se*B*T),T=+qn(+ +oi(+T),+ +oi(+(1-T)))*2,j=+ke[l>>3],Te=+Si(+((j-Te)*.5)),d=+ke[l+8>>3],w=+Si(+((d-w)*.5)),_=+xi(+j),w=Te*Te+w*(Se*_*w),w=+qn(+ +oi(+w),+ +oi(+(1-w)))*2,j=+Si(+((ce-j)*.5)),d=+Si(+((X-d)*.5)),d=j*j+d*(B*_*d),d=+qn(+ +oi(+d),+ +oi(+(1-d)))*2,_=(T+w+d)*.5,+(+mn(+ +oi(+(+Yt(+(_*.5))*+Yt(+((_-T)*.5))*+Yt(+((_-w)*.5))*+Yt(+((_-d)*.5)))))*4)}function Hs(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0;if(B=Bt,Bt=Bt+192|0,w=B+168|0,T=B,_=mr(i,r,w)|0,_|0)return l=_,Bt=B,l|0;if(Nr(i,r,T)|0&&Tn(23313,22742,386,22751),r=o[T>>2]|0,(r|0)>0){if(d=+Xn(T+8|0,T+8+(((r|0)!=1&1)<<4)|0,w)+0,(r|0)!=1){i=1;do _=i,i=i+1|0,d=d+ +Xn(T+8+(_<<4)|0,T+8+(((i|0)%(r|0)|0)<<4)|0,w);while((i|0)<(r|0))}}else d=0;return ke[l>>3]=d,l=0,Bt=B,l|0}function ks(i,r,l){return i=i|0,r=r|0,l=l|0,i=Hs(i,r,l)|0,i|0||(ke[l>>3]=+ke[l>>3]*6371.007180918475*6371.007180918475),i|0}function ps(i,r,l){return i=i|0,r=r|0,l=l|0,i=Hs(i,r,l)|0,i|0||(ke[l>>3]=+ke[l>>3]*6371.007180918475*6371.007180918475*1e3*1e3),i|0}function Ya(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ce=0;if(B=Bt,Bt=Bt+176|0,T=B,i=ba(i,r,T)|0,i|0)return T=i,Bt=B,T|0;if(ke[l>>3]=0,i=o[T>>2]|0,(i|0)<=1)return T=0,Bt=B,T|0;r=i+-1|0,i=0,d=+ke[T+8>>3],_=+ke[T+16>>3],w=0;do i=i+1|0,X=d,d=+ke[T+8+(i<<4)>>3],ce=+Si(+((d-X)*.5)),j=_,_=+ke[T+8+(i<<4)+8>>3],j=+Si(+((_-j)*.5)),j=ce*ce+j*(+xi(+d)*+xi(+X)*j),w=w+ +qn(+ +oi(+j),+ +oi(+(1-j)))*2;while((i|0)<(r|0));return ke[l>>3]=w,T=0,Bt=B,T|0}function yo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ce=0;if(B=Bt,Bt=Bt+176|0,T=B,i=ba(i,r,T)|0,i|0)return T=i,w=+ke[l>>3],w=w*6371.007180918475,ke[l>>3]=w,Bt=B,T|0;if(ke[l>>3]=0,i=o[T>>2]|0,(i|0)<=1)return T=0,w=0,w=w*6371.007180918475,ke[l>>3]=w,Bt=B,T|0;r=i+-1|0,i=0,d=+ke[T+8>>3],_=+ke[T+16>>3],w=0;do i=i+1|0,X=d,d=+ke[T+8+(i<<4)>>3],ce=+Si(+((d-X)*.5)),j=_,_=+ke[T+8+(i<<4)+8>>3],j=+Si(+((_-j)*.5)),j=ce*ce+j*(+xi(+X)*+xi(+d)*j),w=w+ +qn(+ +oi(+j),+ +oi(+(1-j)))*2;while((i|0)!=(r|0));return ke[l>>3]=w,T=0,ce=w,ce=ce*6371.007180918475,ke[l>>3]=ce,Bt=B,T|0}function rs(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ce=0;if(B=Bt,Bt=Bt+176|0,T=B,i=ba(i,r,T)|0,i|0)return T=i,w=+ke[l>>3],w=w*6371.007180918475,w=w*1e3,ke[l>>3]=w,Bt=B,T|0;if(ke[l>>3]=0,i=o[T>>2]|0,(i|0)<=1)return T=0,w=0,w=w*6371.007180918475,w=w*1e3,ke[l>>3]=w,Bt=B,T|0;r=i+-1|0,i=0,d=+ke[T+8>>3],_=+ke[T+16>>3],w=0;do i=i+1|0,X=d,d=+ke[T+8+(i<<4)>>3],ce=+Si(+((d-X)*.5)),j=_,_=+ke[T+8+(i<<4)+8>>3],j=+Si(+((_-j)*.5)),j=ce*ce+j*(+xi(+X)*+xi(+d)*j),w=w+ +qn(+ +oi(+j),+ +oi(+(1-j)))*2;while((i|0)!=(r|0));return ke[l>>3]=w,T=0,ce=w,ce=ce*6371.007180918475,ce=ce*1e3,ke[l>>3]=ce,Bt=B,T|0}function Wu(i){i=i|0;var r=0,l=0,d=0;return r=D(1,12)|0,r||Tn(22832,22787,49,22845),l=i+4|0,d=o[l>>2]|0,d|0?(d=d+8|0,o[d>>2]=r,o[l>>2]=r,r|0):(o[i>>2]|0&&Tn(22862,22787,61,22885),d=i,o[d>>2]=r,o[l>>2]=r,r|0)}function Ru(i,r){i=i|0,r=r|0;var l=0,d=0;return d=Ms(24)|0,d||Tn(22899,22787,78,22913),o[d>>2]=o[r>>2],o[d+4>>2]=o[r+4>>2],o[d+8>>2]=o[r+8>>2],o[d+12>>2]=o[r+12>>2],o[d+16>>2]=0,r=i+4|0,l=o[r>>2]|0,l|0?(o[l+16>>2]=d,o[r>>2]=d,d|0):(o[i>>2]|0&&Tn(22928,22787,82,22913),o[i>>2]=d,o[r>>2]=d,d|0)}function vo(i){i=i|0;var r=0,l=0,d=0,_=0;if(i)for(d=1;;){if(r=o[i>>2]|0,r|0)do{if(l=o[r>>2]|0,l|0)do _=l,l=o[l+16>>2]|0,C(_);while(l|0);_=r,r=o[r+8>>2]|0,C(_)}while(r|0);if(r=i,i=o[i+8>>2]|0,d||C(r),i)d=0;else break}}function Ml(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0,Ke=0,yt=0,ot=0,ct=0,It=0,bt=0,ri=0,Xt=0,ti=0,si=0,Qi=0,Wi=0,Ei=0,Gi=0,qi=0,cn=0,zn=0,tn=0;if(_=i+8|0,o[_>>2]|0)return tn=1,tn|0;if(d=o[i>>2]|0,!d)return tn=0,tn|0;r=d,l=0;do l=l+1|0,r=o[r+8>>2]|0;while(r|0);if(l>>>0<2)return tn=0,tn|0;cn=Ms(l<<2)|0,cn||Tn(22948,22787,317,22967),qi=Ms(l<<5)|0,qi||Tn(22989,22787,321,22967),o[i>>2]=0,Xt=i+4|0,o[Xt>>2]=0,o[_>>2]=0,l=0,Gi=0,ri=0,Se=0;e:for(;;){if(ce=o[d>>2]|0,ce){w=0,T=ce;do{if(j=+ke[T+8>>3],r=T,T=o[T+16>>2]|0,X=(T|0)==0,_=X?ce:T,B=+ke[_+8>>3],+Jt(+(j-B))>3.141592653589793){tn=14;break}w=w+(B-j)*(+ke[r>>3]+ +ke[_>>3])}while(!X);if((tn|0)==14){tn=0,w=0,r=ce;do bt=+ke[r+8>>3],Ei=r+16|0,Wi=o[Ei>>2]|0,Wi=Wi|0?Wi:ce,It=+ke[Wi+8>>3],w=w+(+ke[r>>3]+ +ke[Wi>>3])*((It<0?It+6.283185307179586:It)-(bt<0?bt+6.283185307179586:bt)),r=o[(r|0?Ei:d)>>2]|0;while(r|0)}w>0?(o[cn+(Gi<<2)>>2]=d,Gi=Gi+1|0,_=ri,r=Se):tn=19}else tn=19;if((tn|0)==19){tn=0;do if(l){if(r=l+8|0,o[r>>2]|0){tn=21;break e}if(l=D(1,12)|0,!l){tn=23;break e}o[r>>2]=l,_=l+4|0,T=l,r=Se}else if(Se){_=Xt,T=Se+8|0,r=d,l=i;break}else if(o[i>>2]|0){tn=27;break e}else{_=Xt,T=i,r=d,l=i;break}while(!1);if(o[T>>2]=d,o[_>>2]=d,T=qi+(ri<<5)|0,X=o[d>>2]|0,X){for(ce=qi+(ri<<5)+8|0,ke[ce>>3]=17976931348623157e292,Se=qi+(ri<<5)+24|0,ke[Se>>3]=17976931348623157e292,ke[T>>3]=-17976931348623157e292,Te=qi+(ri<<5)+16|0,ke[Te>>3]=-17976931348623157e292,ot=17976931348623157e292,ct=-17976931348623157e292,_=0,Re=X,j=17976931348623157e292,Ke=17976931348623157e292,yt=-17976931348623157e292,B=-17976931348623157e292;w=+ke[Re>>3],bt=+ke[Re+8>>3],Re=o[Re+16>>2]|0,Be=(Re|0)==0,It=+ke[(Be?X:Re)+8>>3],w<j&&(ke[ce>>3]=w,j=w),bt<Ke&&(ke[Se>>3]=bt,Ke=bt),w>yt?ke[T>>3]=w:w=yt,bt>B&&(ke[Te>>3]=bt,B=bt),ot=bt>0&bt<ot?bt:ot,ct=bt<0&bt>ct?bt:ct,_=_|+Jt(+(bt-It))>3.141592653589793,!Be;)yt=w;_&&(ke[Te>>3]=ct,ke[Se>>3]=ot)}else o[T>>2]=0,o[T+4>>2]=0,o[T+8>>2]=0,o[T+12>>2]=0,o[T+16>>2]=0,o[T+20>>2]=0,o[T+24>>2]=0,o[T+28>>2]=0;_=ri+1|0}if(Ei=d+8|0,d=o[Ei>>2]|0,o[Ei>>2]=0,d)ri=_,Se=r;else{tn=45;break}}if((tn|0)==21)Tn(22765,22787,35,22799);else if((tn|0)==23)Tn(22819,22787,37,22799);else if((tn|0)==27)Tn(22862,22787,61,22885);else if((tn|0)==45){e:do if((Gi|0)>0){for(Ei=(_|0)==0,Qi=_<<2,Wi=(i|0)==0,si=0,r=0;;){if(ti=o[cn+(si<<2)>>2]|0,Ei)tn=73;else{if(ri=Ms(Qi)|0,!ri){tn=50;break}if(Xt=Ms(Qi)|0,!Xt){tn=52;break}t:do if(Wi)l=0;else{for(_=0,l=0,T=i;d=qi+(_<<5)|0,Dn(o[T>>2]|0,d,o[ti>>2]|0)|0?(o[ri+(l<<2)>>2]=T,o[Xt+(l<<2)>>2]=d,Be=l+1|0):Be=l,T=o[T+8>>2]|0,T;)_=_+1|0,l=Be;if((Be|0)>0)if(d=o[ri>>2]|0,(Be|0)==1)l=d;else for(Te=0,Re=-1,l=d,Se=d;;){for(X=o[Se>>2]|0,d=0,T=0;_=o[o[ri+(T<<2)>>2]>>2]|0,(_|0)==(X|0)?ce=d:ce=d+((Dn(_,o[Xt+(T<<2)>>2]|0,o[X>>2]|0)|0)&1)|0,T=T+1|0,(T|0)!=(Be|0);)d=ce;if(_=(ce|0)>(Re|0),l=_?Se:l,d=Te+1|0,(d|0)==(Be|0))break t;Te=d,Re=_?ce:Re,Se=o[ri+(d<<2)>>2]|0}else l=0}while(!1);if(C(ri),C(Xt),l){if(_=l+4|0,d=o[_>>2]|0,d)l=d+8|0;else if(o[l>>2]|0){tn=70;break}o[l>>2]=ti,o[_>>2]=ti}else tn=73}if((tn|0)==73){if(tn=0,r=o[ti>>2]|0,r|0)do Xt=r,r=o[r+16>>2]|0,C(Xt);while(r|0);C(ti),r=1}if(si=si+1|0,(si|0)>=(Gi|0)){zn=r;break e}}(tn|0)==50?Tn(23004,22787,249,23023):(tn|0)==52?Tn(23042,22787,252,23023):(tn|0)==70&&Tn(22862,22787,61,22885)}else zn=0;while(!1);return C(cn),C(qi),tn=zn,tn|0}return 0}function Dn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ce=0;if(!(ja(r,l)|0)||(r=Ha(r)|0,d=+ke[l>>3],_=+ke[l+8>>3],_=r&_<0?_+6.283185307179586:_,i=o[i>>2]|0,!i))return i=0,i|0;if(r){r=0,X=_,l=i;e:for(;;){for(;T=+ke[l>>3],_=+ke[l+8>>3],l=l+16|0,ce=o[l>>2]|0,ce=ce|0?ce:i,w=+ke[ce>>3],B=+ke[ce+8>>3],T>w?(j=T,T=B):(j=w,w=T,T=_,_=B),d=d==w|d==j?d+2220446049250313e-31:d,!!(d<w|d>j);)if(l=o[l>>2]|0,!l){l=22;break e}if(B=T<0?T+6.283185307179586:T,T=_<0?_+6.283185307179586:_,X=B==X|T==X?X+-2220446049250313e-31:X,j=B+(T-B)*((d-w)/(j-w)),(j<0?j+6.283185307179586:j)>X&&(r=r^1),l=o[l>>2]|0,!l){l=22;break}}if((l|0)==22)return r|0}else{r=0,X=_,l=i;e:for(;;){for(;T=+ke[l>>3],_=+ke[l+8>>3],l=l+16|0,ce=o[l>>2]|0,ce=ce|0?ce:i,w=+ke[ce>>3],B=+ke[ce+8>>3],T>w?(j=T,T=B):(j=w,w=T,T=_,_=B),d=d==w|d==j?d+2220446049250313e-31:d,!!(d<w|d>j);)if(l=o[l>>2]|0,!l){l=22;break e}if(X=T==X|_==X?X+-2220446049250313e-31:X,T+(_-T)*((d-w)/(j-w))>X&&(r=r^1),l=o[l>>2]|0,!l){l=22;break}}if((l|0)==22)return r|0}return 0}function Ma(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0,Ke=0,yt=0,ot=0,ct=0;if(ct=Bt,Bt=Bt+32|0,ot=ct+16|0,yt=ct,w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,Re=Gt(l|0,d|0,52)|0,Ut()|0,(w|0)!=(Re&15|0))return ot=12,Bt=ct,ot|0;if(X=Gt(i|0,r|0,45)|0,Ut()|0,X=X&127,ce=Gt(l|0,d|0,45)|0,Ut()|0,ce=ce&127,X>>>0>121|ce>>>0>121)return ot=5,Bt=ct,ot|0;if(Re=(X|0)!=(ce|0),Re){if(B=Ar(X,ce)|0,(B|0)==7)return ot=1,Bt=ct,ot|0;j=Ar(ce,X)|0,(j|0)==7?Tn(23066,23090,161,23100):(Be=B,T=j)}else Be=0,T=0;Se=rt(X)|0,Te=rt(ce)|0,o[ot>>2]=0,o[ot+4>>2]=0,o[ot+8>>2]=0,o[ot+12>>2]=0;do if(Be){if(ce=o[4272+(X*28|0)+(Be<<2)>>2]|0,B=(ce|0)>0,Te)if(B){X=0,j=l,B=d;do j=kl(j,B)|0,B=Ut()|0,T=ml(T)|0,(T|0)==1&&(T=ml(1)|0),X=X+1|0;while((X|0)!=(ce|0));ce=T,X=j,j=B}else ce=T,X=l,j=d;else if(B){X=0,j=l,B=d;do j=go(j,B)|0,B=Ut()|0,T=ml(T)|0,X=X+1|0;while((X|0)!=(ce|0));ce=T,X=j,j=B}else ce=T,X=l,j=d;if(Jo(X,j,ot)|0,Re||Tn(23115,23090,191,23100),B=(Se|0)!=0,T=(Te|0)!=0,B&T&&Tn(23142,23090,192,23100),B){if(T=wa(i,r)|0,(T|0)==7){w=5;break}if(kt[21872+(T*7|0)+Be>>0]|0){w=1;break}j=o[21040+(T*28|0)+(Be<<2)>>2]|0,X=j}else if(T){if(T=wa(X,j)|0,(T|0)==7){w=5;break}if(kt[21872+(T*7|0)+ce>>0]|0){w=1;break}X=0,j=o[21040+(ce*28|0)+(T<<2)>>2]|0}else X=0,j=0;if((X|j|0)<0)w=5;else{if((j|0)>0){B=ot+4|0,T=0;do Za(B),T=T+1|0;while((T|0)!=(j|0))}if(o[yt>>2]=0,o[yt+4>>2]=0,o[yt+8>>2]=0,Ys(yt,Be),w|0)for(;qs(w)|0?Qo(yt):ca(yt),(w|0)>1;)w=w+-1|0;if((X|0)>0){w=0;do Za(yt),w=w+1|0;while((w|0)!=(X|0))}Ke=ot+4|0,vr(Ke,yt,Ke),Lr(Ke),Ke=51}}else if(Jo(l,d,ot)|0,(Se|0)!=0&(Te|0)!=0)if((ce|0)!=(X|0)&&Tn(23173,23090,261,23100),T=wa(i,r)|0,w=wa(l,d)|0,(T|0)==7|(w|0)==7)w=5;else if(kt[21872+(T*7|0)+w>>0]|0)w=1;else if(T=o[21040+(T*28|0)+(w<<2)>>2]|0,(T|0)>0){B=ot+4|0,w=0;do Za(B),w=w+1|0;while((w|0)!=(T|0));Ke=51}else Ke=51;else Ke=51;while(!1);return(Ke|0)==51&&(w=ot+4|0,o[_>>2]=o[w>>2],o[_+4>>2]=o[w+4>>2],o[_+8>>2]=o[w+8>>2],w=0),ot=w,Bt=ct,ot|0}function Sn(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0,Ke=0,yt=0,ot=0,ct=0,It=0;if(Ke=Bt,Bt=Bt+48|0,X=Ke+36|0,T=Ke+24|0,B=Ke+12|0,j=Ke,_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15,Te=Gt(i|0,r|0,45)|0,Ut()|0,Te=Te&127,Te>>>0>121)return d=5,Bt=Ke,d|0;if(ce=rt(Te)|0,Zt(_|0,0,52)|0,yt=Ut()|0|134225919,w=d,o[w>>2]=-1,o[w+4>>2]=yt,!_)return _=Eo(l)|0,(_|0)==7||(_=sr(Te,_)|0,(_|0)==127)?(yt=1,Bt=Ke,yt|0):(Re=Zt(_|0,0,45)|0,Be=Ut()|0,Te=d,Be=o[Te+4>>2]&-1040385|Be,yt=d,o[yt>>2]=o[Te>>2]|Re,o[yt+4>>2]=Be,yt=0,Bt=Ke,yt|0);for(o[X>>2]=o[l>>2],o[X+4>>2]=o[l+4>>2],o[X+8>>2]=o[l+8>>2],l=_;;){if(w=l,l=l+-1|0,o[T>>2]=o[X>>2],o[T+4>>2]=o[X+4>>2],o[T+8>>2]=o[X+8>>2],qs(w)|0){if(_=Zo(X)|0,_|0){l=13;break}o[B>>2]=o[X>>2],o[B+4>>2]=o[X+4>>2],o[B+8>>2]=o[X+8>>2],Qo(B)}else{if(_=Bs(X)|0,_|0){l=13;break}o[B>>2]=o[X>>2],o[B+4>>2]=o[X+4>>2],o[B+8>>2]=o[X+8>>2],ca(B)}if(Ks(T,B,j),Lr(j),_=d,ct=o[_>>2]|0,_=o[_+4>>2]|0,It=(15-w|0)*3|0,ot=Zt(7,0,It|0)|0,_=_&~(Ut()|0),It=Zt(Eo(j)|0,0,It|0)|0,_=Ut()|0|_,yt=d,o[yt>>2]=It|ct&~ot,o[yt+4>>2]=_,(w|0)<=1){l=14;break}}e:do if((l|0)!=13&&(l|0)==14)if((o[X>>2]|0)<=1&&(o[X+4>>2]|0)<=1&&(o[X+8>>2]|0)<=1){l=Eo(X)|0,_=sr(Te,l)|0,(_|0)==127?j=0:j=rt(_)|0;t:do if(l){if(ce){if(_=wa(i,r)|0,(_|0)==7){_=5;break e}if(w=o[21248+(_*28|0)+(l<<2)>>2]|0,(w|0)>0){_=l,l=0;do _=Ta(_)|0,l=l+1|0;while((l|0)!=(w|0))}else _=l;if((_|0)==1){_=9;break e}l=sr(Te,_)|0,(l|0)==127&&Tn(23200,23090,411,23230),rt(l)|0?Tn(23245,23090,412,23230):(Be=l,Re=w,Se=_)}else Be=_,Re=0,Se=l;if(B=o[4272+(Te*28|0)+(Se<<2)>>2]|0,(B|0)<=-1&&Tn(23276,23090,419,23230),!j){if((Re|0)<0){_=5;break e}if(Re|0){w=d,_=0,l=o[w>>2]|0,w=o[w+4>>2]|0;do l=Mo(l,w)|0,w=Ut()|0,It=d,o[It>>2]=l,o[It+4>>2]=w,_=_+1|0;while((_|0)<(Re|0))}if((B|0)<=0){_=Be,l=58;break}for(w=d,_=0,l=o[w>>2]|0,w=o[w+4>>2]|0;;)if(l=Mo(l,w)|0,w=Ut()|0,It=d,o[It>>2]=l,o[It+4>>2]=w,_=_+1|0,(_|0)==(B|0)){_=Be,l=58;break t}}if(T=Ar(Be,Te)|0,(T|0)==7&&Tn(23066,23090,428,23230),_=d,l=o[_>>2]|0,_=o[_+4>>2]|0,(B|0)>0){w=0;do l=Mo(l,_)|0,_=Ut()|0,It=d,o[It>>2]=l,o[It+4>>2]=_,w=w+1|0;while((w|0)!=(B|0))}if(_=wa(l,_)|0,(_|0)==7&&Tn(23313,23090,440,23230),l=St(Be)|0,l=o[(l?21664:21456)+(T*28|0)+(_<<2)>>2]|0,(l|0)<0&&Tn(23313,23090,454,23230),!l)_=Be,l=58;else{T=d,_=0,w=o[T>>2]|0,T=o[T+4>>2]|0;do w=Tl(w,T)|0,T=Ut()|0,It=d,o[It>>2]=w,o[It+4>>2]=T,_=_+1|0;while((_|0)<(l|0));_=Be,l=58}}else if((ce|0)!=0&(j|0)!=0){if(l=wa(i,r)|0,w=d,w=wa(o[w>>2]|0,o[w+4>>2]|0)|0,(l|0)==7|(w|0)==7){_=5;break e}if(w=o[21248+(l*28|0)+(w<<2)>>2]|0,(w|0)<0){_=5;break e}if(!w)l=59;else{B=d,l=0,T=o[B>>2]|0,B=o[B+4>>2]|0;do T=Mo(T,B)|0,B=Ut()|0,It=d,o[It>>2]=T,o[It+4>>2]=B,l=l+1|0;while((l|0)<(w|0));l=58}}else l=58;while(!1);if((l|0)==58&&j&&(l=59),(l|0)==59&&(It=d,(wa(o[It>>2]|0,o[It+4>>2]|0)|0)==1)){_=9;break}It=d,ot=o[It>>2]|0,It=o[It+4>>2]&-1040385,ct=Zt(_|0,0,45)|0,It=It|(Ut()|0),_=d,o[_>>2]=ot|ct,o[_+4>>2]=It,_=0}else _=1;while(!1);return It=_,Bt=Ke,It|0}function No(i,r,l,d,_,w){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0;var T=0,B=0;return B=Bt,Bt=Bt+16|0,T=B,_?i=15:(i=Ma(i,r,l,d,T)|0,i||(ac(T,w),i=0)),Bt=B,i|0}function Nl(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0;return T=Bt,Bt=Bt+16|0,w=T,d?l=15:(l=ro(l,w)|0,l||(l=Sn(i,r,w,_)|0)),Bt=T,l|0}function En(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0;return j=Bt,Bt=Bt+32|0,T=j+12|0,B=j,w=Ma(i,r,i,r,T)|0,w|0?(B=w,Bt=j,B|0):(i=Ma(i,r,l,d,B)|0,i|0?(B=i,Bt=j,B|0):(T=As(T,B)|0,B=_,o[B>>2]=T,o[B+4>>2]=((T|0)<0)<<31>>31,B=0,Bt=j,B|0))}function Wl(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0;return j=Bt,Bt=Bt+32|0,T=j+12|0,B=j,w=Ma(i,r,i,r,T)|0,!w&&(w=Ma(i,r,l,d,B)|0,!w)?(d=As(T,B)|0,d=z(d|0,((d|0)<0)<<31>>31|0,1,0)|0,T=Ut()|0,B=_,o[B>>2]=d,o[B+4>>2]=T,B=0,Bt=j,B|0):(B=w,Bt=j,B|0)}function Cn(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0,Ke=0,yt=0,ot=0,ct=0,It=0,bt=0,ri=0,Xt=0,ti=0,si=0;if(ti=Bt,Bt=Bt+48|0,T=ti+24|0,B=ti+12|0,Xt=ti,w=Ma(i,r,i,r,T)|0,!w&&(w=Ma(i,r,l,d,B)|0,!w)){bt=As(T,B)|0,ri=((bt|0)<0)<<31>>31,o[T>>2]=0,o[T+4>>2]=0,o[T+8>>2]=0,o[B>>2]=0,o[B+4>>2]=0,o[B+8>>2]=0,Ma(i,r,i,r,T)|0&&Tn(23313,23090,691,23299),Ma(i,r,l,d,B)|0&&Tn(23313,23090,696,23299),so(T),so(B),bt?(Se=o[T>>2]|0,Be=+(bt|0),ot=T+4|0,Te=o[ot>>2]|0,ct=T+8|0,Re=o[ct>>2]|0,It=T,d=Se,w=Te,l=Re,Ke=+((o[B>>2]|0)-Se|0)/Be,yt=+((o[B+4>>2]|0)-Te|0)/Be,Be=+((o[B+8>>2]|0)-Re|0)/Be):(w=T+4|0,l=T+8|0,ot=w,ct=l,It=T,d=o[T>>2]|0,w=o[w>>2]|0,l=o[l>>2]|0,Ke=0,yt=0,Be=0),o[Xt>>2]=d,Re=Xt+4|0,o[Re>>2]=w,Te=Xt+8|0,o[Te>>2]=l;e:do if((bt|0)<0)w=0;else for(ce=0,Se=0,w=d;;){X=+(Se>>>0)+4294967296*+(ce|0),si=Ke*X+ +(w|0),j=yt*X+ +(o[ot>>2]|0),X=Be*X+ +(o[ct>>2]|0),l=~~+E(+si),T=~~+E(+j),w=~~+E(+X),si=+Jt(+(+(l|0)-si)),j=+Jt(+(+(T|0)-j)),X=+Jt(+(+(w|0)-X));do if(si>j&si>X)l=0-(T+w)|0,d=T;else if(B=0-l|0,j>X){d=B-w|0;break}else{d=T,w=B-T|0;break}while(!1);if(o[Xt>>2]=l,o[Re>>2]=d,o[Te>>2]=w,Ql(Xt),w=Sn(i,r,Xt,_+(Se<<3)|0)|0,w|0)break e;if(!((ce|0)<(ri|0)|(ce|0)==(ri|0)&Se>>>0<bt>>>0)){w=0;break e}w=z(Se|0,ce|0,1,0)|0,B=Ut()|0,ce=B,Se=w,w=o[It>>2]|0}while(!1);return Xt=w,Bt=ti,Xt|0}return Xt=w,Bt=ti,Xt|0}function _l(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0;if((l|0)==0&(d|0)==0)return _=0,w=1,Ki(_|0),w|0;w=i,_=r,i=1,r=0;do T=(l&1|0)==0&!0,i=$e((T?1:w)|0,(T?0:_)|0,i|0,r|0)|0,r=Ut()|0,l=ni(l|0,d|0,1)|0,d=Ut()|0,w=$e(w|0,_|0,w|0,_|0)|0,_=Ut()|0;while(!((l|0)==0&(d|0)==0));return Ki(r|0),i|0}function uu(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0;if(!(ja(r,l)|0)||(r=Ha(r)|0,d=+ke[l>>3],_=+ke[l+8>>3],_=r&_<0?_+6.283185307179586:_,Te=o[i>>2]|0,(Te|0)<=0))return Te=0,Te|0;if(Se=o[i+4>>2]|0,r){r=0,ce=_,l=-1,i=0;e:for(;;){for(X=i;T=+ke[Se+(X<<4)>>3],_=+ke[Se+(X<<4)+8>>3],i=(l+2|0)%(Te|0)|0,w=+ke[Se+(i<<4)>>3],B=+ke[Se+(i<<4)+8>>3],T>w?(j=T,T=B):(j=w,w=T,T=_,_=B),d=d==w|d==j?d+2220446049250313e-31:d,!!(d<w|d>j);)if(l=X+1|0,(l|0)>=(Te|0)){l=22;break e}else i=X,X=l,l=i;if(B=T<0?T+6.283185307179586:T,T=_<0?_+6.283185307179586:_,ce=B==ce|T==ce?ce+-2220446049250313e-31:ce,j=B+(T-B)*((d-w)/(j-w)),(j<0?j+6.283185307179586:j)>ce&&(r=r^1),i=X+1|0,(i|0)>=(Te|0)){l=22;break}else l=X}if((l|0)==22)return r|0}else{r=0,ce=_,l=-1,i=0;e:for(;;){for(X=i;T=+ke[Se+(X<<4)>>3],_=+ke[Se+(X<<4)+8>>3],i=(l+2|0)%(Te|0)|0,w=+ke[Se+(i<<4)>>3],B=+ke[Se+(i<<4)+8>>3],T>w?(j=T,T=B):(j=w,w=T,T=_,_=B),d=d==w|d==j?d+2220446049250313e-31:d,!!(d<w|d>j);)if(l=X+1|0,(l|0)>=(Te|0)){l=22;break e}else i=X,X=l,l=i;if(ce=T==ce|_==ce?ce+-2220446049250313e-31:ce,T+(_-T)*((d-w)/(j-w))>ce&&(r=r^1),i=X+1|0,(i|0)>=(Te|0)){l=22;break}else l=X}if((l|0)==22)return r|0}return 0}function Fu(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0,Ke=0,yt=0,ot=0,ct=0;if(Be=o[i>>2]|0,!Be){o[r>>2]=0,o[r+4>>2]=0,o[r+8>>2]=0,o[r+12>>2]=0,o[r+16>>2]=0,o[r+20>>2]=0,o[r+24>>2]=0,o[r+28>>2]=0;return}if(Ke=r+8|0,ke[Ke>>3]=17976931348623157e292,yt=r+24|0,ke[yt>>3]=17976931348623157e292,ke[r>>3]=-17976931348623157e292,ot=r+16|0,ke[ot>>3]=-17976931348623157e292,!((Be|0)<=0)){for(Te=o[i+4>>2]|0,X=17976931348623157e292,ce=-17976931348623157e292,Se=0,i=-1,w=17976931348623157e292,T=17976931348623157e292,j=-17976931348623157e292,d=-17976931348623157e292,Re=0;l=+ke[Te+(Re<<4)>>3],B=+ke[Te+(Re<<4)+8>>3],i=i+2|0,_=+ke[Te+(((i|0)==(Be|0)?0:i)<<4)+8>>3],l<w&&(ke[Ke>>3]=l,w=l),B<T&&(ke[yt>>3]=B,T=B),l>j?ke[r>>3]=l:l=j,B>d&&(ke[ot>>3]=B,d=B),X=B>0&B<X?B:X,ce=B<0&B>ce?B:ce,Se=Se|+Jt(+(B-_))>3.141592653589793,i=Re+1|0,(i|0)!=(Be|0);)ct=Re,j=l,Re=i,i=ct;Se&&(ke[ot>>3]=ce,ke[yt>>3]=X)}}function Vl(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0,Ke=0,yt=0,ot=0,ct=0,It=0,bt=0,ri=0,Xt=0,ti=0;if(Be=o[i>>2]|0,Be){if(Ke=r+8|0,ke[Ke>>3]=17976931348623157e292,yt=r+24|0,ke[yt>>3]=17976931348623157e292,ke[r>>3]=-17976931348623157e292,ot=r+16|0,ke[ot>>3]=-17976931348623157e292,(Be|0)>0){for(_=o[i+4>>2]|0,Te=17976931348623157e292,Re=-17976931348623157e292,d=0,l=-1,j=17976931348623157e292,X=17976931348623157e292,Se=-17976931348623157e292,T=-17976931348623157e292,ct=0;w=+ke[_+(ct<<4)>>3],ce=+ke[_+(ct<<4)+8>>3],Xt=l+2|0,B=+ke[_+(((Xt|0)==(Be|0)?0:Xt)<<4)+8>>3],w<j&&(ke[Ke>>3]=w,j=w),ce<X&&(ke[yt>>3]=ce,X=ce),w>Se?ke[r>>3]=w:w=Se,ce>T&&(ke[ot>>3]=ce,T=ce),Te=ce>0&ce<Te?ce:Te,Re=ce<0&ce>Re?ce:Re,d=d|+Jt(+(ce-B))>3.141592653589793,l=ct+1|0,(l|0)!=(Be|0);)Xt=ct,Se=w,ct=l,l=Xt;d&&(ke[ot>>3]=Re,ke[yt>>3]=Te)}}else o[r>>2]=0,o[r+4>>2]=0,o[r+8>>2]=0,o[r+12>>2]=0,o[r+16>>2]=0,o[r+20>>2]=0,o[r+24>>2]=0,o[r+28>>2]=0;if(Xt=i+8|0,l=o[Xt>>2]|0,!((l|0)<=0)){ri=i+12|0,bt=0;do if(_=o[ri>>2]|0,d=bt,bt=bt+1|0,yt=r+(bt<<5)|0,ot=o[_+(d<<3)>>2]|0,ot){if(ct=r+(bt<<5)+8|0,ke[ct>>3]=17976931348623157e292,i=r+(bt<<5)+24|0,ke[i>>3]=17976931348623157e292,ke[yt>>3]=-17976931348623157e292,It=r+(bt<<5)+16|0,ke[It>>3]=-17976931348623157e292,(ot|0)>0){for(Be=o[_+(d<<3)+4>>2]|0,Te=17976931348623157e292,Re=-17976931348623157e292,_=0,d=-1,Ke=0,j=17976931348623157e292,X=17976931348623157e292,ce=-17976931348623157e292,T=-17976931348623157e292;w=+ke[Be+(Ke<<4)>>3],Se=+ke[Be+(Ke<<4)+8>>3],d=d+2|0,B=+ke[Be+(((d|0)==(ot|0)?0:d)<<4)+8>>3],w<j&&(ke[ct>>3]=w,j=w),Se<X&&(ke[i>>3]=Se,X=Se),w>ce?ke[yt>>3]=w:w=ce,Se>T&&(ke[It>>3]=Se,T=Se),Te=Se>0&Se<Te?Se:Te,Re=Se<0&Se>Re?Se:Re,_=_|+Jt(+(Se-B))>3.141592653589793,d=Ke+1|0,(d|0)!=(ot|0);)ti=Ke,Ke=d,ce=w,d=ti;_&&(ke[It>>3]=Re,ke[i>>3]=Te)}}else o[yt>>2]=0,o[yt+4>>2]=0,o[yt+8>>2]=0,o[yt+12>>2]=0,o[yt+16>>2]=0,o[yt+20>>2]=0,o[yt+24>>2]=0,o[yt+28>>2]=0,l=o[Xt>>2]|0;while((bt|0)<(l|0))}}function yl(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if(!(uu(i,r,l)|0))return _=0,_|0;if(_=i+8|0,(o[_>>2]|0)<=0)return _=1,_|0;for(d=i+12|0,i=0;;){if(w=i,i=i+1|0,uu((o[d>>2]|0)+(w<<3)|0,r+(i<<5)|0,l)|0){i=0,d=6;break}if((i|0)>=(o[_>>2]|0)){i=1,d=6;break}}return(d|0)==6?i|0:0}function ta(){return 8}function oc(){return 16}function $u(){return 168}function $l(){return 8}function ms(){return 16}function _a(){return 12}function el(){return 8}function _u(i){return i=i|0,+(+((o[i>>2]|0)>>>0)+4294967296*+(o[i+4>>2]|0))}function Ou(i){i=i|0;var r=0,l=0;return l=+ke[i>>3],r=+ke[i+8>>3],+ +oi(+(l*l+r*r))}function cu(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0;X=+ke[i>>3],j=+ke[r>>3]-X,B=+ke[i+8>>3],T=+ke[r+8>>3]-B,Se=+ke[l>>3],w=+ke[d>>3]-Se,Te=+ke[l+8>>3],ce=+ke[d+8>>3]-Te,w=(w*(B-Te)-(X-Se)*ce)/(j*ce-T*w),ke[_>>3]=X+j*w,ke[_+8>>3]=B+T*w}function Nu(i,r){return i=i|0,r=r|0,+Jt(+(+ke[i>>3]-+ke[r>>3]))<11920928955078125e-23?(r=+Jt(+(+ke[i+8>>3]-+ke[r+8>>3]))<11920928955078125e-23,r|0):(r=0,r|0)}function _r(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;return _=+ke[i>>3]-+ke[r>>3],d=+ke[i+8>>3]-+ke[r+8>>3],l=+ke[i+16>>3]-+ke[r+16>>3],+(_*_+d*d+l*l)}function gs(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;l=+ke[i>>3],d=+xi(+l),l=+Si(+l),ke[r+16>>3]=l,l=+ke[i+8>>3],_=d*+xi(+l),ke[r>>3]=_,l=d*+Si(+l),ke[r+8>>3]=l}function gn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if(w=Bt,Bt=Bt+16|0,_=w,d=kr(i,r)|0,(l+-1|0)>>>0>5||(d=(d|0)!=0,(l|0)==1&d))return _=-1,Bt=w,_|0;do if(jn(i,r,_)|0)d=-1;else if(d){d=((o[21936+(l<<2)>>2]|0)+5-(o[_>>2]|0)|0)%5|0;break}else{d=((o[21968+(l<<2)>>2]|0)+6-(o[_>>2]|0)|0)%6|0;break}while(!1);return _=d,Bt=w,_|0}function jn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,X=0;if(X=Bt,Bt=Bt+32|0,T=X+16|0,B=X,d=Yr(i,r,T)|0,d|0)return l=d,Bt=X,l|0;w=Ol(i,r)|0,j=wa(i,r)|0,Li(w,B),d=An(w,o[T>>2]|0)|0;e:do if(rt(w)|0){do switch(w|0){case 4:{i=0;break}case 14:{i=1;break}case 24:{i=2;break}case 38:{i=3;break}case 49:{i=4;break}case 58:{i=5;break}case 63:{i=6;break}case 72:{i=7;break}case 83:{i=8;break}case 97:{i=9;break}case 107:{i=10;break}case 117:{i=11;break}default:{d=1;break e}}while(!1);if(_=o[22e3+(i*24|0)+8>>2]|0,r=o[22e3+(i*24|0)+16>>2]|0,i=o[T>>2]|0,(i|0)!=(o[B>>2]|0)&&(B=St(w)|0,i=o[T>>2]|0,B|(i|0)==(r|0)&&(d=(d+1|0)%6|0)),(j|0)==3&(i|0)==(r|0)){d=(d+5|0)%6|0,_=22;break}(j|0)==5&(i|0)==(_|0)&&(d=(d+1|0)%6|0),_=22}else _=22;while(!1);return(_|0)==22&&(o[l>>2]=d,d=0),l=d,Bt=X,l|0}function Jn(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0,Ke=0,yt=0,ot=0,ct=0,It=0;if(It=Bt,Bt=Bt+32|0,ct=It+24|0,yt=It+20|0,Be=It+8|0,Re=It+16|0,Te=It,j=(kr(i,r)|0)==0,j=j?6:5,ce=Gt(i|0,r|0,52)|0,Ut()|0,ce=ce&15,j>>>0<=l>>>0)return d=2,Bt=It,d|0;Se=(ce|0)==0,!Se&&(Ke=Zt(7,0,(ce^15)*3|0)|0,(Ke&i|0)==0&((Ut()|0)&r|0)==0)?_=l:w=4;e:do if((w|0)==4){if(_=(kr(i,r)|0)!=0,((_?4:5)|0)<(l|0)||jn(i,r,ct)|0||(w=(o[ct>>2]|0)+l|0,_?_=22288+(((w|0)%5|0)<<2)|0:_=22320+(((w|0)%6|0)<<2)|0,Ke=o[_>>2]|0,(Ke|0)==7))return d=1,Bt=It,d|0;o[yt>>2]=0,_=hs(i,r,Ke,yt,Be)|0;do if(!_){if(B=Be,X=o[B>>2]|0,B=o[B+4>>2]|0,T=B>>>0<r>>>0|(B|0)==(r|0)&X>>>0<i>>>0,w=T?X:i,T=T?B:r,!Se&&(Se=Zt(7,0,(ce^15)*3|0)|0,(X&Se|0)==0&(B&(Ut()|0)|0)==0))_=l;else{if(B=(l+-1+j|0)%(j|0)|0,_=kr(i,r)|0,(B|0)<0&&Tn(23313,23315,245,23324),j=(_|0)!=0,((j?4:5)|0)<(B|0)&&Tn(23313,23315,245,23324),jn(i,r,ct)|0&&Tn(23313,23315,245,23324),_=(o[ct>>2]|0)+B|0,j?_=22288+(((_|0)%5|0)<<2)|0:_=22320+(((_|0)%6|0)<<2)|0,B=o[_>>2]|0,(B|0)==7&&Tn(23313,23315,245,23324),o[Re>>2]=0,_=hs(i,r,B,Re,Te)|0,_|0)break;X=Te,j=o[X>>2]|0,X=o[X+4>>2]|0;do if(X>>>0<T>>>0|(X|0)==(T|0)&j>>>0<w>>>0){if(kr(j,X)|0?w=Ua(j,X,i,r)|0:w=o[22384+((((o[Re>>2]|0)+(o[22352+(B<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,_=kr(j,X)|0,(w+-1|0)>>>0>5){_=-1,w=j,T=X;break}if(_=(_|0)!=0,(w|0)==1&_){_=-1,w=j,T=X;break}do if(jn(j,X,ct)|0)_=-1;else if(_){_=((o[21936+(w<<2)>>2]|0)+5-(o[ct>>2]|0)|0)%5|0;break}else{_=((o[21968+(w<<2)>>2]|0)+6-(o[ct>>2]|0)|0)%6|0;break}while(!1);w=j,T=X}else _=l;while(!1);B=Be,X=o[B>>2]|0,B=o[B+4>>2]|0}if((w|0)==(X|0)&(T|0)==(B|0)){if(j=(kr(X,B)|0)!=0,j?i=Ua(X,B,i,r)|0:i=o[22384+((((o[yt>>2]|0)+(o[22352+(Ke<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,_=kr(X,B)|0,(i+-1|0)>>>0<=5&&(ot=(_|0)!=0,!((i|0)==1&ot)))do if(jn(X,B,ct)|0)_=-1;else if(ot){_=((o[21936+(i<<2)>>2]|0)+5-(o[ct>>2]|0)|0)%5|0;break}else{_=((o[21968+(i<<2)>>2]|0)+6-(o[ct>>2]|0)|0)%6|0;break}while(!1);else _=-1;_=_+1|0,_=(_|0)==6|j&(_|0)==5?0:_}r=T,i=w;break e}while(!1);return d=_,Bt=It,d|0}while(!1);return ot=Zt(_|0,0,56)|0,ct=Ut()|0|r&-2130706433|536870912,o[d>>2]=ot|i,o[d+4>>2]=ct,d=0,Bt=It,d|0}function tl(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;return w=(kr(i,r)|0)==0,d=Jn(i,r,0,l)|0,_=(d|0)==0,w?!_||(d=Jn(i,r,1,l+8|0)|0,d|0)||(d=Jn(i,r,2,l+16|0)|0,d|0)||(d=Jn(i,r,3,l+24|0)|0,d|0)||(d=Jn(i,r,4,l+32|0)|0,d)?(w=d,w|0):Jn(i,r,5,l+40|0)|0:!_||(d=Jn(i,r,1,l+8|0)|0,d|0)||(d=Jn(i,r,2,l+16|0)|0,d|0)||(d=Jn(i,r,3,l+24|0)|0,d|0)||(d=Jn(i,r,4,l+32|0)|0,d|0)?(w=d,w|0):(w=l+40|0,o[w>>2]=0,o[w+4>>2]=0,w=0,w|0)}function Tu(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0;return j=Bt,Bt=Bt+192|0,_=j,w=j+168|0,T=Gt(i|0,r|0,56)|0,Ut()|0,T=T&7,B=r&-2130706433|134217728,d=Yr(i,B,w)|0,d|0?(B=d,Bt=j,B|0):(r=Gt(i|0,r|0,52)|0,Ut()|0,r=r&15,kr(i,B)|0?Ko(w,r,T,1,_):fr(w,r,T,1,_),B=_+8|0,o[l>>2]=o[B>>2],o[l+4>>2]=o[B+4>>2],o[l+8>>2]=o[B+8>>2],o[l+12>>2]=o[B+12>>2],B=0,Bt=j,B|0)}function oa(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return _=Bt,Bt=Bt+16|0,l=_,!(!0&(r&2013265920|0)==536870912)||(d=r&-2130706433|134217728,!(es(i,d)|0))?(d=0,Bt=_,d|0):(w=Gt(i|0,r|0,56)|0,Ut()|0,w=(Jn(i,d,w&7,l)|0)==0,d=l,d=w&((o[d>>2]|0)==(i|0)?(o[d+4>>2]|0)==(r|0):0)&1,Bt=_,d|0)}function yu(i,r,l){i=i|0,r=r|0,l=l|0;var d=0;(r|0)>0?(d=D(r,4)|0,o[i>>2]=d,d||Tn(23337,23360,40,23374)):o[i>>2]=0,o[i+4>>2]=r,o[i+8>>2]=0,o[i+12>>2]=l}function vs(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;_=i+4|0,w=i+12|0,T=i+8|0;e:for(;;){for(l=o[_>>2]|0,r=0;;){if((r|0)>=(l|0))break e;if(d=o[i>>2]|0,B=o[d+(r<<2)>>2]|0,!B)r=r+1|0;else break}r=d+(~~(+Jt(+(+zi(10,+ +(15-(o[w>>2]|0)|0))*(+ke[B>>3]+ +ke[B+8>>3])))%+(l|0))>>>0<<2)|0,l=o[r>>2]|0;t:do if(l|0){if(d=B+32|0,(l|0)==(B|0))o[r>>2]=o[d>>2];else{if(l=l+32|0,r=o[l>>2]|0,!r)break;for(;(r|0)!=(B|0);)if(l=r+32|0,r=o[l>>2]|0,!r)break t;o[l>>2]=o[d>>2]}C(B),o[T>>2]=(o[T>>2]|0)+-1}while(!1)}C(o[i>>2]|0)}function Po(i){i=i|0;var r=0,l=0,d=0;for(d=o[i+4>>2]|0,l=0;;){if((l|0)>=(d|0)){r=0,l=4;break}if(r=o[(o[i>>2]|0)+(l<<2)>>2]|0,!r)l=l+1|0;else{l=4;break}}return(l|0)==4?r|0:0}function Mi(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;if(l=~~(+Jt(+(+zi(10,+ +(15-(o[i+12>>2]|0)|0))*(+ke[r>>3]+ +ke[r+8>>3])))%+(o[i+4>>2]|0))>>>0,l=(o[i>>2]|0)+(l<<2)|0,d=o[l>>2]|0,!d)return w=1,w|0;w=r+32|0;do if((d|0)!=(r|0)){if(l=o[d+32>>2]|0,!l)return w=1,w|0;for(_=l;;){if((_|0)==(r|0)){_=8;break}if(l=o[_+32>>2]|0,l)d=_,_=l;else{l=1,_=10;break}}if((_|0)==8){o[d+32>>2]=o[w>>2];break}else if((_|0)==10)return l|0}else o[l>>2]=o[w>>2];while(!1);return C(r),w=i+8|0,o[w>>2]=(o[w>>2]|0)+-1,w=0,w|0}function Bi(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;w=Ms(40)|0,w||Tn(23390,23360,98,23403),o[w>>2]=o[r>>2],o[w+4>>2]=o[r+4>>2],o[w+8>>2]=o[r+8>>2],o[w+12>>2]=o[r+12>>2],_=w+16|0,o[_>>2]=o[l>>2],o[_+4>>2]=o[l+4>>2],o[_+8>>2]=o[l+8>>2],o[_+12>>2]=o[l+12>>2],o[w+32>>2]=0,_=~~(+Jt(+(+zi(10,+ +(15-(o[i+12>>2]|0)|0))*(+ke[r>>3]+ +ke[r+8>>3])))%+(o[i+4>>2]|0))>>>0,_=(o[i>>2]|0)+(_<<2)|0,d=o[_>>2]|0;do if(!d)o[_>>2]=w;else{for(;!(ao(d,r)|0&&ao(d+16|0,l)|0);)if(_=o[d+32>>2]|0,d=_|0?_:d,!(o[d+32>>2]|0)){T=10;break}if((T|0)==10){o[d+32>>2]=w;break}return C(w),T=d,T|0}while(!1);return T=i+8|0,o[T>>2]=(o[T>>2]|0)+1,T=w,T|0}function xs(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;if(_=~~(+Jt(+(+zi(10,+ +(15-(o[i+12>>2]|0)|0))*(+ke[r>>3]+ +ke[r+8>>3])))%+(o[i+4>>2]|0))>>>0,_=o[(o[i>>2]|0)+(_<<2)>>2]|0,!_)return l=0,l|0;if(!l){for(i=_;;){if(ao(i,r)|0){d=10;break}if(i=o[i+32>>2]|0,!i){i=0,d=10;break}}if((d|0)==10)return i|0}for(i=_;;){if(ao(i,r)|0&&ao(i+16|0,l)|0){d=10;break}if(i=o[i+32>>2]|0,!i){i=0,d=10;break}}return(d|0)==10?i|0:0}function vu(i,r){i=i|0,r=r|0;var l=0;if(l=~~(+Jt(+(+zi(10,+ +(15-(o[i+12>>2]|0)|0))*(+ke[r>>3]+ +ke[r+8>>3])))%+(o[i+4>>2]|0))>>>0,i=o[(o[i>>2]|0)+(l<<2)>>2]|0,!i)return l=0,l|0;for(;;){if(ao(i,r)|0){r=5;break}if(i=o[i+32>>2]|0,!i){i=0,r=5;break}}return(r|0)==5?i|0:0}function Vo(){return 23424}function fs(i){return i=+i,+ +y(+i)}function hl(i){return i=+i,~~+fs(i)|0}function Ms(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0,Ke=0,yt=0,ot=0,ct=0,It=0,bt=0,ri=0;ri=Bt,Bt=Bt+16|0,Te=ri;do if(i>>>0<245){if(X=i>>>0<11?16:i+11&-8,i=X>>>3,Se=o[5857]|0,l=Se>>>i,l&3|0)return r=(l&1^1)+i|0,i=23468+(r<<1<<2)|0,l=i+8|0,d=o[l>>2]|0,_=d+8|0,w=o[_>>2]|0,(w|0)==(i|0)?o[5857]=Se&~(1<<r):(o[w+12>>2]=i,o[l>>2]=w),bt=r<<3,o[d+4>>2]=bt|3,bt=d+bt+4|0,o[bt>>2]=o[bt>>2]|1,bt=_,Bt=ri,bt|0;if(ce=o[5859]|0,X>>>0>ce>>>0){if(l|0)return r=2<<i,r=l<<i&(r|0-r),r=(r&0-r)+-1|0,B=r>>>12&16,r=r>>>B,l=r>>>5&8,r=r>>>l,w=r>>>2&4,r=r>>>w,i=r>>>1&2,r=r>>>i,d=r>>>1&1,d=(l|B|w|i|d)+(r>>>d)|0,r=23468+(d<<1<<2)|0,i=r+8|0,w=o[i>>2]|0,B=w+8|0,l=o[B>>2]|0,(l|0)==(r|0)?(i=Se&~(1<<d),o[5857]=i):(o[l+12>>2]=r,o[i>>2]=l,i=Se),bt=d<<3,T=bt-X|0,o[w+4>>2]=X|3,_=w+X|0,o[_+4>>2]=T|1,o[w+bt>>2]=T,ce|0&&(d=o[5862]|0,r=ce>>>3,l=23468+(r<<1<<2)|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=d,o[r+12>>2]=d,o[d+8>>2]=r,o[d+12>>2]=l),o[5859]=T,o[5862]=_,bt=B,Bt=ri,bt|0;if(w=o[5858]|0,w){for(l=(w&0-w)+-1|0,_=l>>>12&16,l=l>>>_,d=l>>>5&8,l=l>>>d,T=l>>>2&4,l=l>>>T,B=l>>>1&2,l=l>>>B,j=l>>>1&1,j=o[23732+((d|_|T|B|j)+(l>>>j)<<2)>>2]|0,l=j,B=j,j=(o[j+4>>2]&-8)-X|0;i=o[l+16>>2]|0,!(!i&&(i=o[l+20>>2]|0,!i));)T=(o[i+4>>2]&-8)-X|0,_=T>>>0<j>>>0,l=i,B=_?i:B,j=_?T:j;if(T=B+X|0,T>>>0>B>>>0){_=o[B+24>>2]|0,r=o[B+12>>2]|0;do if((r|0)==(B|0)){if(i=B+20|0,r=o[i>>2]|0,!r&&(i=B+16|0,r=o[i>>2]|0,!r)){l=0;break}for(;;)if(d=r+20|0,l=o[d>>2]|0,l)r=l,i=d;else if(d=r+16|0,l=o[d>>2]|0,l)r=l,i=d;else break;o[i>>2]=0,l=r}else l=o[B+8>>2]|0,o[l+12>>2]=r,o[r+8>>2]=l,l=r;while(!1);do if(_|0){if(r=o[B+28>>2]|0,i=23732+(r<<2)|0,(B|0)==(o[i>>2]|0)){if(o[i>>2]=l,!l){o[5858]=w&~(1<<r);break}}else if(bt=_+16|0,o[((o[bt>>2]|0)==(B|0)?bt:_+20|0)>>2]=l,!l)break;o[l+24>>2]=_,r=o[B+16>>2]|0,r|0&&(o[l+16>>2]=r,o[r+24>>2]=l),r=o[B+20>>2]|0,r|0&&(o[l+20>>2]=r,o[r+24>>2]=l)}while(!1);return j>>>0<16?(bt=j+X|0,o[B+4>>2]=bt|3,bt=B+bt+4|0,o[bt>>2]=o[bt>>2]|1):(o[B+4>>2]=X|3,o[T+4>>2]=j|1,o[T+j>>2]=j,ce|0&&(d=o[5862]|0,r=ce>>>3,l=23468+(r<<1<<2)|0,r=1<<r,r&Se?(i=l+8|0,r=o[i>>2]|0):(o[5857]=r|Se,r=l,i=l+8|0),o[i>>2]=d,o[r+12>>2]=d,o[d+8>>2]=r,o[d+12>>2]=l),o[5859]=j,o[5862]=T),bt=B+8|0,Bt=ri,bt|0}else Se=X}else Se=X}else Se=X}else if(i>>>0<=4294967231)if(i=i+11|0,X=i&-8,d=o[5858]|0,d){_=0-X|0,i=i>>>8,i?X>>>0>16777215?j=31:(Se=(i+1048320|0)>>>16&8,Ke=i<<Se,B=(Ke+520192|0)>>>16&4,Ke=Ke<<B,j=(Ke+245760|0)>>>16&2,j=14-(B|Se|j)+(Ke<<j>>>15)|0,j=X>>>(j+7|0)&1|j<<1):j=0,l=o[23732+(j<<2)>>2]|0;e:do if(!l)l=0,i=0,Ke=61;else for(i=0,B=X<<((j|0)==31?0:25-(j>>>1)|0),w=0;;){if(T=(o[l+4>>2]&-8)-X|0,T>>>0<_>>>0)if(T)i=l,_=T;else{i=l,_=0,Ke=65;break e}if(Ke=o[l+20>>2]|0,l=o[l+16+(B>>>31<<2)>>2]|0,w=(Ke|0)==0|(Ke|0)==(l|0)?w:Ke,l)B=B<<1;else{l=w,Ke=61;break}}while(!1);if((Ke|0)==61){if((l|0)==0&(i|0)==0){if(i=2<<j,i=(i|0-i)&d,!i){Se=X;break}Se=(i&0-i)+-1|0,T=Se>>>12&16,Se=Se>>>T,w=Se>>>5&8,Se=Se>>>w,B=Se>>>2&4,Se=Se>>>B,j=Se>>>1&2,Se=Se>>>j,l=Se>>>1&1,i=0,l=o[23732+((w|T|B|j|l)+(Se>>>l)<<2)>>2]|0}l?Ke=65:(B=i,T=_)}if((Ke|0)==65)for(w=l;;)if(Se=(o[w+4>>2]&-8)-X|0,l=Se>>>0<_>>>0,_=l?Se:_,i=l?w:i,l=o[w+16>>2]|0,l||(l=o[w+20>>2]|0),l)w=l;else{B=i,T=_;break}if(B|0&&T>>>0<((o[5859]|0)-X|0)>>>0&&(ce=B+X|0,ce>>>0>B>>>0)){w=o[B+24>>2]|0,r=o[B+12>>2]|0;do if((r|0)==(B|0)){if(i=B+20|0,r=o[i>>2]|0,!r&&(i=B+16|0,r=o[i>>2]|0,!r)){r=0;break}for(;;)if(_=r+20|0,l=o[_>>2]|0,l)r=l,i=_;else if(_=r+16|0,l=o[_>>2]|0,l)r=l,i=_;else break;o[i>>2]=0}else bt=o[B+8>>2]|0,o[bt+12>>2]=r,o[r+8>>2]=bt;while(!1);do if(w){if(i=o[B+28>>2]|0,l=23732+(i<<2)|0,(B|0)==(o[l>>2]|0)){if(o[l>>2]=r,!r){d=d&~(1<<i),o[5858]=d;break}}else if(bt=w+16|0,o[((o[bt>>2]|0)==(B|0)?bt:w+20|0)>>2]=r,!r)break;o[r+24>>2]=w,i=o[B+16>>2]|0,i|0&&(o[r+16>>2]=i,o[i+24>>2]=r),i=o[B+20>>2]|0,i&&(o[r+20>>2]=i,o[i+24>>2]=r)}while(!1);e:do if(T>>>0<16)bt=T+X|0,o[B+4>>2]=bt|3,bt=B+bt+4|0,o[bt>>2]=o[bt>>2]|1;else{if(o[B+4>>2]=X|3,o[ce+4>>2]=T|1,o[ce+T>>2]=T,r=T>>>3,T>>>0<256){l=23468+(r<<1<<2)|0,i=o[5857]|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=ce,o[r+12>>2]=ce,o[ce+8>>2]=r,o[ce+12>>2]=l;break}if(r=T>>>8,r?T>>>0>16777215?l=31:(It=(r+1048320|0)>>>16&8,bt=r<<It,ct=(bt+520192|0)>>>16&4,bt=bt<<ct,l=(bt+245760|0)>>>16&2,l=14-(ct|It|l)+(bt<<l>>>15)|0,l=T>>>(l+7|0)&1|l<<1):l=0,r=23732+(l<<2)|0,o[ce+28>>2]=l,i=ce+16|0,o[i+4>>2]=0,o[i>>2]=0,i=1<<l,!(d&i)){o[5858]=d|i,o[r>>2]=ce,o[ce+24>>2]=r,o[ce+12>>2]=ce,o[ce+8>>2]=ce;break}r=o[r>>2]|0;t:do if((o[r+4>>2]&-8|0)!=(T|0)){for(d=T<<((l|0)==31?0:25-(l>>>1)|0);l=r+16+(d>>>31<<2)|0,i=o[l>>2]|0,!!i;)if((o[i+4>>2]&-8|0)==(T|0)){r=i;break t}else d=d<<1,r=i;o[l>>2]=ce,o[ce+24>>2]=r,o[ce+12>>2]=ce,o[ce+8>>2]=ce;break e}while(!1);It=r+8|0,bt=o[It>>2]|0,o[bt+12>>2]=ce,o[It>>2]=ce,o[ce+8>>2]=bt,o[ce+12>>2]=r,o[ce+24>>2]=0}while(!1);return bt=B+8|0,Bt=ri,bt|0}else Se=X}else Se=X;else Se=-1;while(!1);if(l=o[5859]|0,l>>>0>=Se>>>0)return r=l-Se|0,i=o[5862]|0,r>>>0>15?(bt=i+Se|0,o[5862]=bt,o[5859]=r,o[bt+4>>2]=r|1,o[i+l>>2]=r,o[i+4>>2]=Se|3):(o[5859]=0,o[5862]=0,o[i+4>>2]=l|3,bt=i+l+4|0,o[bt>>2]=o[bt>>2]|1),bt=i+8|0,Bt=ri,bt|0;if(T=o[5860]|0,T>>>0>Se>>>0)return ct=T-Se|0,o[5860]=ct,bt=o[5863]|0,It=bt+Se|0,o[5863]=It,o[It+4>>2]=ct|1,o[bt+4>>2]=Se|3,bt=bt+8|0,Bt=ri,bt|0;if(o[5975]|0?i=o[5977]|0:(o[5977]=4096,o[5976]=4096,o[5978]=-1,o[5979]=-1,o[5980]=0,o[5968]=0,o[5975]=Te&-16^1431655768,i=4096),B=Se+48|0,j=Se+47|0,w=i+j|0,_=0-i|0,X=w&_,X>>>0<=Se>>>0||(i=o[5967]|0,i|0&&(ce=o[5965]|0,Te=ce+X|0,Te>>>0<=ce>>>0|Te>>>0>i>>>0)))return bt=0,Bt=ri,bt|0;e:do if(o[5968]&4)r=0,Ke=143;else{l=o[5863]|0;t:do if(l){for(d=23876;Te=o[d>>2]|0,!(Te>>>0<=l>>>0&&(Te+(o[d+4>>2]|0)|0)>>>0>l>>>0);)if(i=o[d+8>>2]|0,i)d=i;else{Ke=128;break t}if(r=w-T&_,r>>>0<2147483647)if(i=s(r|0)|0,(i|0)==((o[d>>2]|0)+(o[d+4>>2]|0)|0)){if((i|0)!=-1){T=r,w=i,Ke=145;break e}}else d=i,Ke=136;else r=0}else Ke=128;while(!1);do if((Ke|0)==128)if(l=s(0)|0,(l|0)!=-1&&(r=l,Re=o[5976]|0,Be=Re+-1|0,r=(Be&r|0?(Be+r&0-Re)-r|0:0)+X|0,Re=o[5965]|0,Be=r+Re|0,r>>>0>Se>>>0&r>>>0<2147483647)){if(Te=o[5967]|0,Te|0&&Be>>>0<=Re>>>0|Be>>>0>Te>>>0){r=0;break}if(i=s(r|0)|0,(i|0)==(l|0)){T=r,w=l,Ke=145;break e}else d=i,Ke=136}else r=0;while(!1);do if((Ke|0)==136){if(l=0-r|0,!(B>>>0>r>>>0&(r>>>0<2147483647&(d|0)!=-1)))if((d|0)==-1){r=0;break}else{T=r,w=d,Ke=145;break e}if(i=o[5977]|0,i=j-r+i&0-i,i>>>0>=2147483647){T=r,w=d,Ke=145;break e}if((s(i|0)|0)==-1){s(l|0)|0,r=0;break}else{T=i+r|0,w=d,Ke=145;break e}}while(!1);o[5968]=o[5968]|4,Ke=143}while(!1);if((Ke|0)==143&&X>>>0<2147483647&&(ct=s(X|0)|0,Be=s(0)|0,yt=Be-ct|0,ot=yt>>>0>(Se+40|0)>>>0,!((ct|0)==-1|ot^1|ct>>>0<Be>>>0&((ct|0)!=-1&(Be|0)!=-1)^1))&&(T=ot?yt:r,w=ct,Ke=145),(Ke|0)==145){r=(o[5965]|0)+T|0,o[5965]=r,r>>>0>(o[5966]|0)>>>0&&(o[5966]=r),j=o[5863]|0;e:do if(j){for(r=23876;;){if(i=o[r>>2]|0,l=o[r+4>>2]|0,(w|0)==(i+l|0)){Ke=154;break}if(d=o[r+8>>2]|0,d)r=d;else break}if((Ke|0)==154&&(It=r+4|0,(o[r+12>>2]&8|0)==0)&&w>>>0>j>>>0&i>>>0<=j>>>0){o[It>>2]=l+T,bt=(o[5860]|0)+T|0,ct=j+8|0,ct=ct&7|0?0-ct&7:0,It=j+ct|0,ct=bt-ct|0,o[5863]=It,o[5860]=ct,o[It+4>>2]=ct|1,o[j+bt+4>>2]=40,o[5864]=o[5979];break}for(w>>>0<(o[5861]|0)>>>0&&(o[5861]=w),l=w+T|0,r=23876;;){if((o[r>>2]|0)==(l|0)){Ke=162;break}if(i=o[r+8>>2]|0,i)r=i;else break}if((Ke|0)==162&&!(o[r+12>>2]&8|0)){o[r>>2]=w,ce=r+4|0,o[ce>>2]=(o[ce>>2]|0)+T,ce=w+8|0,ce=w+(ce&7|0?0-ce&7:0)|0,r=l+8|0,r=l+(r&7|0?0-r&7:0)|0,X=ce+Se|0,B=r-ce-Se|0,o[ce+4>>2]=Se|3;t:do if((j|0)==(r|0))bt=(o[5860]|0)+B|0,o[5860]=bt,o[5863]=X,o[X+4>>2]=bt|1;else{if((o[5862]|0)==(r|0)){bt=(o[5859]|0)+B|0,o[5859]=bt,o[5862]=X,o[X+4>>2]=bt|1,o[X+bt>>2]=bt;break}if(i=o[r+4>>2]|0,(i&3|0)==1){T=i&-8,d=i>>>3;i:do if(i>>>0<256)if(i=o[r+8>>2]|0,l=o[r+12>>2]|0,(l|0)==(i|0)){o[5857]=o[5857]&~(1<<d);break}else{o[i+12>>2]=l,o[l+8>>2]=i;break}else{w=o[r+24>>2]|0,i=o[r+12>>2]|0;do if((i|0)==(r|0)){if(l=r+16|0,d=l+4|0,i=o[d>>2]|0,i)l=d;else if(i=o[l>>2]|0,!i){i=0;break}for(;;)if(_=i+20|0,d=o[_>>2]|0,d)i=d,l=_;else if(_=i+16|0,d=o[_>>2]|0,d)i=d,l=_;else break;o[l>>2]=0}else bt=o[r+8>>2]|0,o[bt+12>>2]=i,o[i+8>>2]=bt;while(!1);if(!w)break;l=o[r+28>>2]|0,d=23732+(l<<2)|0;do if((o[d>>2]|0)!=(r|0)){if(bt=w+16|0,o[((o[bt>>2]|0)==(r|0)?bt:w+20|0)>>2]=i,!i)break i}else{if(o[d>>2]=i,i|0)break;o[5858]=o[5858]&~(1<<l);break i}while(!1);if(o[i+24>>2]=w,l=r+16|0,d=o[l>>2]|0,d|0&&(o[i+16>>2]=d,o[d+24>>2]=i),l=o[l+4>>2]|0,!l)break;o[i+20>>2]=l,o[l+24>>2]=i}while(!1);r=r+T|0,_=T+B|0}else _=B;if(r=r+4|0,o[r>>2]=o[r>>2]&-2,o[X+4>>2]=_|1,o[X+_>>2]=_,r=_>>>3,_>>>0<256){l=23468+(r<<1<<2)|0,i=o[5857]|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=X,o[r+12>>2]=X,o[X+8>>2]=r,o[X+12>>2]=l;break}r=_>>>8;do if(!r)d=0;else{if(_>>>0>16777215){d=31;break}It=(r+1048320|0)>>>16&8,bt=r<<It,ct=(bt+520192|0)>>>16&4,bt=bt<<ct,d=(bt+245760|0)>>>16&2,d=14-(ct|It|d)+(bt<<d>>>15)|0,d=_>>>(d+7|0)&1|d<<1}while(!1);if(r=23732+(d<<2)|0,o[X+28>>2]=d,i=X+16|0,o[i+4>>2]=0,o[i>>2]=0,i=o[5858]|0,l=1<<d,!(i&l)){o[5858]=i|l,o[r>>2]=X,o[X+24>>2]=r,o[X+12>>2]=X,o[X+8>>2]=X;break}r=o[r>>2]|0;i:do if((o[r+4>>2]&-8|0)!=(_|0)){for(d=_<<((d|0)==31?0:25-(d>>>1)|0);l=r+16+(d>>>31<<2)|0,i=o[l>>2]|0,!!i;)if((o[i+4>>2]&-8|0)==(_|0)){r=i;break i}else d=d<<1,r=i;o[l>>2]=X,o[X+24>>2]=r,o[X+12>>2]=X,o[X+8>>2]=X;break t}while(!1);It=r+8|0,bt=o[It>>2]|0,o[bt+12>>2]=X,o[It>>2]=X,o[X+8>>2]=bt,o[X+12>>2]=r,o[X+24>>2]=0}while(!1);return bt=ce+8|0,Bt=ri,bt|0}for(r=23876;i=o[r>>2]|0,!(i>>>0<=j>>>0&&(bt=i+(o[r+4>>2]|0)|0,bt>>>0>j>>>0));)r=o[r+8>>2]|0;_=bt+-47|0,i=_+8|0,i=_+(i&7|0?0-i&7:0)|0,_=j+16|0,i=i>>>0<_>>>0?j:i,r=i+8|0,l=T+-40|0,ct=w+8|0,ct=ct&7|0?0-ct&7:0,It=w+ct|0,ct=l-ct|0,o[5863]=It,o[5860]=ct,o[It+4>>2]=ct|1,o[w+l+4>>2]=40,o[5864]=o[5979],l=i+4|0,o[l>>2]=27,o[r>>2]=o[5969],o[r+4>>2]=o[5970],o[r+8>>2]=o[5971],o[r+12>>2]=o[5972],o[5969]=w,o[5970]=T,o[5972]=0,o[5971]=r,r=i+24|0;do It=r,r=r+4|0,o[r>>2]=7;while((It+8|0)>>>0<bt>>>0);if((i|0)!=(j|0)){if(w=i-j|0,o[l>>2]=o[l>>2]&-2,o[j+4>>2]=w|1,o[i>>2]=w,r=w>>>3,w>>>0<256){l=23468+(r<<1<<2)|0,i=o[5857]|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=j,o[r+12>>2]=j,o[j+8>>2]=r,o[j+12>>2]=l;break}if(r=w>>>8,r?w>>>0>16777215?d=31:(It=(r+1048320|0)>>>16&8,bt=r<<It,ct=(bt+520192|0)>>>16&4,bt=bt<<ct,d=(bt+245760|0)>>>16&2,d=14-(ct|It|d)+(bt<<d>>>15)|0,d=w>>>(d+7|0)&1|d<<1):d=0,l=23732+(d<<2)|0,o[j+28>>2]=d,o[j+20>>2]=0,o[_>>2]=0,r=o[5858]|0,i=1<<d,!(r&i)){o[5858]=r|i,o[l>>2]=j,o[j+24>>2]=l,o[j+12>>2]=j,o[j+8>>2]=j;break}r=o[l>>2]|0;t:do if((o[r+4>>2]&-8|0)!=(w|0)){for(d=w<<((d|0)==31?0:25-(d>>>1)|0);l=r+16+(d>>>31<<2)|0,i=o[l>>2]|0,!!i;)if((o[i+4>>2]&-8|0)==(w|0)){r=i;break t}else d=d<<1,r=i;o[l>>2]=j,o[j+24>>2]=r,o[j+12>>2]=j,o[j+8>>2]=j;break e}while(!1);It=r+8|0,bt=o[It>>2]|0,o[bt+12>>2]=j,o[It>>2]=j,o[j+8>>2]=bt,o[j+12>>2]=r,o[j+24>>2]=0}}else bt=o[5861]|0,(bt|0)==0|w>>>0<bt>>>0&&(o[5861]=w),o[5969]=w,o[5970]=T,o[5972]=0,o[5866]=o[5975],o[5865]=-1,o[5870]=23468,o[5869]=23468,o[5872]=23476,o[5871]=23476,o[5874]=23484,o[5873]=23484,o[5876]=23492,o[5875]=23492,o[5878]=23500,o[5877]=23500,o[5880]=23508,o[5879]=23508,o[5882]=23516,o[5881]=23516,o[5884]=23524,o[5883]=23524,o[5886]=23532,o[5885]=23532,o[5888]=23540,o[5887]=23540,o[5890]=23548,o[5889]=23548,o[5892]=23556,o[5891]=23556,o[5894]=23564,o[5893]=23564,o[5896]=23572,o[5895]=23572,o[5898]=23580,o[5897]=23580,o[5900]=23588,o[5899]=23588,o[5902]=23596,o[5901]=23596,o[5904]=23604,o[5903]=23604,o[5906]=23612,o[5905]=23612,o[5908]=23620,o[5907]=23620,o[5910]=23628,o[5909]=23628,o[5912]=23636,o[5911]=23636,o[5914]=23644,o[5913]=23644,o[5916]=23652,o[5915]=23652,o[5918]=23660,o[5917]=23660,o[5920]=23668,o[5919]=23668,o[5922]=23676,o[5921]=23676,o[5924]=23684,o[5923]=23684,o[5926]=23692,o[5925]=23692,o[5928]=23700,o[5927]=23700,o[5930]=23708,o[5929]=23708,o[5932]=23716,o[5931]=23716,bt=T+-40|0,ct=w+8|0,ct=ct&7|0?0-ct&7:0,It=w+ct|0,ct=bt-ct|0,o[5863]=It,o[5860]=ct,o[It+4>>2]=ct|1,o[w+bt+4>>2]=40,o[5864]=o[5979];while(!1);if(r=o[5860]|0,r>>>0>Se>>>0)return ct=r-Se|0,o[5860]=ct,bt=o[5863]|0,It=bt+Se|0,o[5863]=It,o[It+4>>2]=ct|1,o[bt+4>>2]=Se|3,bt=bt+8|0,Bt=ri,bt|0}return bt=Vo()|0,o[bt>>2]=12,bt=0,Bt=ri,bt|0}function C(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0;if(i){l=i+-8|0,_=o[5861]|0,i=o[i+-4>>2]|0,r=i&-8,j=l+r|0;do if(i&1)B=l,T=l;else{if(d=o[l>>2]|0,!(i&3)||(T=l+(0-d)|0,w=d+r|0,T>>>0<_>>>0))return;if((o[5862]|0)==(T|0)){if(i=j+4|0,r=o[i>>2]|0,(r&3|0)!=3){B=T,r=w;break}o[5859]=w,o[i>>2]=r&-2,o[T+4>>2]=w|1,o[T+w>>2]=w;return}if(l=d>>>3,d>>>0<256)if(i=o[T+8>>2]|0,r=o[T+12>>2]|0,(r|0)==(i|0)){o[5857]=o[5857]&~(1<<l),B=T,r=w;break}else{o[i+12>>2]=r,o[r+8>>2]=i,B=T,r=w;break}_=o[T+24>>2]|0,i=o[T+12>>2]|0;do if((i|0)==(T|0)){if(r=T+16|0,l=r+4|0,i=o[l>>2]|0,i)r=l;else if(i=o[r>>2]|0,!i){i=0;break}for(;;)if(d=i+20|0,l=o[d>>2]|0,l)i=l,r=d;else if(d=i+16|0,l=o[d>>2]|0,l)i=l,r=d;else break;o[r>>2]=0}else B=o[T+8>>2]|0,o[B+12>>2]=i,o[i+8>>2]=B;while(!1);if(_){if(r=o[T+28>>2]|0,l=23732+(r<<2)|0,(o[l>>2]|0)==(T|0)){if(o[l>>2]=i,!i){o[5858]=o[5858]&~(1<<r),B=T,r=w;break}}else if(B=_+16|0,o[((o[B>>2]|0)==(T|0)?B:_+20|0)>>2]=i,!i){B=T,r=w;break}o[i+24>>2]=_,r=T+16|0,l=o[r>>2]|0,l|0&&(o[i+16>>2]=l,o[l+24>>2]=i),r=o[r+4>>2]|0,r?(o[i+20>>2]=r,o[r+24>>2]=i,B=T,r=w):(B=T,r=w)}else B=T,r=w}while(!1);if(!(T>>>0>=j>>>0)&&(i=j+4|0,d=o[i>>2]|0,!!(d&1))){if(d&2)o[i>>2]=d&-2,o[B+4>>2]=r|1,o[T+r>>2]=r,_=r;else{if((o[5863]|0)==(j|0)){if(j=(o[5860]|0)+r|0,o[5860]=j,o[5863]=B,o[B+4>>2]=j|1,(B|0)!=(o[5862]|0))return;o[5862]=0,o[5859]=0;return}if((o[5862]|0)==(j|0)){j=(o[5859]|0)+r|0,o[5859]=j,o[5862]=T,o[B+4>>2]=j|1,o[T+j>>2]=j;return}_=(d&-8)+r|0,l=d>>>3;do if(d>>>0<256)if(r=o[j+8>>2]|0,i=o[j+12>>2]|0,(i|0)==(r|0)){o[5857]=o[5857]&~(1<<l);break}else{o[r+12>>2]=i,o[i+8>>2]=r;break}else{w=o[j+24>>2]|0,i=o[j+12>>2]|0;do if((i|0)==(j|0)){if(r=j+16|0,l=r+4|0,i=o[l>>2]|0,i)r=l;else if(i=o[r>>2]|0,!i){l=0;break}for(;;)if(d=i+20|0,l=o[d>>2]|0,l)i=l,r=d;else if(d=i+16|0,l=o[d>>2]|0,l)i=l,r=d;else break;o[r>>2]=0,l=i}else l=o[j+8>>2]|0,o[l+12>>2]=i,o[i+8>>2]=l,l=i;while(!1);if(w|0){if(i=o[j+28>>2]|0,r=23732+(i<<2)|0,(o[r>>2]|0)==(j|0)){if(o[r>>2]=l,!l){o[5858]=o[5858]&~(1<<i);break}}else if(d=w+16|0,o[((o[d>>2]|0)==(j|0)?d:w+20|0)>>2]=l,!l)break;o[l+24>>2]=w,i=j+16|0,r=o[i>>2]|0,r|0&&(o[l+16>>2]=r,o[r+24>>2]=l),i=o[i+4>>2]|0,i|0&&(o[l+20>>2]=i,o[i+24>>2]=l)}}while(!1);if(o[B+4>>2]=_|1,o[T+_>>2]=_,(B|0)==(o[5862]|0)){o[5859]=_;return}}if(i=_>>>3,_>>>0<256){l=23468+(i<<1<<2)|0,r=o[5857]|0,i=1<<i,r&i?(r=l+8|0,i=o[r>>2]|0):(o[5857]=r|i,i=l,r=l+8|0),o[r>>2]=B,o[i+12>>2]=B,o[B+8>>2]=i,o[B+12>>2]=l;return}i=_>>>8,i?_>>>0>16777215?d=31:(T=(i+1048320|0)>>>16&8,j=i<<T,w=(j+520192|0)>>>16&4,j=j<<w,d=(j+245760|0)>>>16&2,d=14-(w|T|d)+(j<<d>>>15)|0,d=_>>>(d+7|0)&1|d<<1):d=0,i=23732+(d<<2)|0,o[B+28>>2]=d,o[B+20>>2]=0,o[B+16>>2]=0,r=o[5858]|0,l=1<<d;e:do if(!(r&l))o[5858]=r|l,o[i>>2]=B,o[B+24>>2]=i,o[B+12>>2]=B,o[B+8>>2]=B;else{i=o[i>>2]|0;t:do if((o[i+4>>2]&-8|0)!=(_|0)){for(d=_<<((d|0)==31?0:25-(d>>>1)|0);l=i+16+(d>>>31<<2)|0,r=o[l>>2]|0,!!r;)if((o[r+4>>2]&-8|0)==(_|0)){i=r;break t}else d=d<<1,i=r;o[l>>2]=B,o[B+24>>2]=i,o[B+12>>2]=B,o[B+8>>2]=B;break e}while(!1);T=i+8|0,j=o[T>>2]|0,o[j+12>>2]=B,o[T>>2]=B,o[B+8>>2]=j,o[B+12>>2]=i,o[B+24>>2]=0}while(!1);if(j=(o[5865]|0)+-1|0,o[5865]=j,!(j|0)){for(i=23884;i=o[i>>2]|0,i;)i=i+8|0;o[5865]=-1}}}}function D(i,r){i=i|0,r=r|0;var l=0;return i?(l=Zi(r,i)|0,(r|i)>>>0>65535&&(l=((l>>>0)/(i>>>0)|0|0)==(r|0)?l:-1)):l=0,i=Ms(l)|0,!i||!(o[i+-4>>2]&3)||O(i|0,0,l|0)|0,i|0}function z(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,l=i+l>>>0,Ki(r+d+(l>>>0<i>>>0|0)>>>0|0),l|0|0}function R(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,d=r-d-(l>>>0>i>>>0|0)>>>0,Ki(d|0),i-l>>>0|0|0}function ee(i){return i=i|0,(i?31-(Wt(i^i-1)|0)|0:32)|0}function le(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,X=0,ce=0,Se=0,Te=0,Re=0,Be=0;if(ce=i,j=r,X=j,T=l,Te=d,B=Te,!X)return w=(_|0)!=0,B?w?(o[_>>2]=i|0,o[_+4>>2]=r&0,Te=0,_=0,Ki(Te|0),_|0):(Te=0,_=0,Ki(Te|0),_|0):(w&&(o[_>>2]=(ce>>>0)%(T>>>0),o[_+4>>2]=0),Te=0,_=(ce>>>0)/(T>>>0)>>>0,Ki(Te|0),_|0);w=(B|0)==0;do if(T){if(!w){if(w=(Wt(B|0)|0)-(Wt(X|0)|0)|0,w>>>0<=31){Se=w+1|0,B=31-w|0,r=w-31>>31,T=Se,i=ce>>>(Se>>>0)&r|X<<B,r=X>>>(Se>>>0)&r,w=0,B=ce<<B;break}return _?(o[_>>2]=i|0,o[_+4>>2]=j|r&0,Te=0,_=0,Ki(Te|0),_|0):(Te=0,_=0,Ki(Te|0),_|0)}if(w=T-1|0,w&T|0){B=(Wt(T|0)|0)+33-(Wt(X|0)|0)|0,Be=64-B|0,Se=32-B|0,j=Se>>31,Re=B-32|0,r=Re>>31,T=B,i=Se-1>>31&X>>>(Re>>>0)|(X<<Se|ce>>>(B>>>0))&r,r=r&X>>>(B>>>0),w=ce<<Be&j,B=(X<<Be|ce>>>(Re>>>0))&j|ce<<Se&B-33>>31;break}return _|0&&(o[_>>2]=w&ce,o[_+4>>2]=0),(T|0)==1?(Re=j|r&0,Be=i|0|0,Ki(Re|0),Be|0):(Be=ee(T|0)|0,Re=X>>>(Be>>>0)|0,Be=X<<32-Be|ce>>>(Be>>>0)|0,Ki(Re|0),Be|0)}else{if(w)return _|0&&(o[_>>2]=(X>>>0)%(T>>>0),o[_+4>>2]=0),Re=0,Be=(X>>>0)/(T>>>0)>>>0,Ki(Re|0),Be|0;if(!ce)return _|0&&(o[_>>2]=0,o[_+4>>2]=(X>>>0)%(B>>>0)),Re=0,Be=(X>>>0)/(B>>>0)>>>0,Ki(Re|0),Be|0;if(w=B-1|0,!(w&B))return _|0&&(o[_>>2]=i|0,o[_+4>>2]=w&X|r&0),Re=0,Be=X>>>((ee(B|0)|0)>>>0),Ki(Re|0),Be|0;if(w=(Wt(B|0)|0)-(Wt(X|0)|0)|0,w>>>0<=30){r=w+1|0,B=31-w|0,T=r,i=X<<B|ce>>>(r>>>0),r=X>>>(r>>>0),w=0,B=ce<<B;break}return _?(o[_>>2]=i|0,o[_+4>>2]=j|r&0,Re=0,Be=0,Ki(Re|0),Be|0):(Re=0,Be=0,Ki(Re|0),Be|0)}while(!1);if(!T)X=B,j=0,B=0;else{Se=l|0|0,ce=Te|d&0,X=z(Se|0,ce|0,-1,-1)|0,l=Ut()|0,j=B,B=0;do d=j,j=w>>>31|j<<1,w=B|w<<1,d=i<<1|d>>>31|0,Te=i>>>31|r<<1|0,R(X|0,l|0,d|0,Te|0)|0,Be=Ut()|0,Re=Be>>31|((Be|0)<0?-1:0)<<1,B=Re&1,i=R(d|0,Te|0,Re&Se|0,(((Be|0)<0?-1:0)>>31|((Be|0)<0?-1:0)<<1)&ce|0)|0,r=Ut()|0,T=T-1|0;while(T|0);X=j,j=0}return T=0,_|0&&(o[_>>2]=i,o[_+4>>2]=r),Re=(w|0)>>>31|(X|T)<<1|(T<<1|w>>>31)&0|j,Be=(w<<1|0)&-2|B,Ki(Re|0),Be|0}function oe(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0;return X=r>>31|((r|0)<0?-1:0)<<1,j=((r|0)<0?-1:0)>>31|((r|0)<0?-1:0)<<1,w=d>>31|((d|0)<0?-1:0)<<1,_=((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1,B=R(X^i|0,j^r|0,X|0,j|0)|0,T=Ut()|0,i=w^X,r=_^j,R((le(B,T,R(w^l|0,_^d|0,w|0,_|0)|0,Ut()|0,0)|0)^i|0,(Ut()|0)^r|0,i|0,r|0)|0}function we(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return w=i&65535,_=r&65535,l=Zi(_,w)|0,d=i>>>16,i=(l>>>16)+(Zi(_,d)|0)|0,_=r>>>16,r=Zi(_,w)|0,Ki((i>>>16)+(Zi(_,d)|0)+(((i&65535)+r|0)>>>16)|0),i+r<<16|l&65535|0|0}function $e(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0;return _=i,w=l,l=we(_,w)|0,i=Ut()|0,Ki((Zi(r,w)|0)+(Zi(d,_)|0)+i|i&0|0),l|0|0|0}function _t(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,X=0;return _=Bt,Bt=Bt+16|0,B=_|0,T=r>>31|((r|0)<0?-1:0)<<1,w=((r|0)<0?-1:0)>>31|((r|0)<0?-1:0)<<1,X=d>>31|((d|0)<0?-1:0)<<1,j=((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1,i=R(T^i|0,w^r|0,T|0,w|0)|0,r=Ut()|0,le(i,r,R(X^l|0,j^d|0,X|0,j|0)|0,Ut()|0,B)|0,d=R(o[B>>2]^T|0,o[B+4>>2]^w|0,T|0,w|0)|0,l=Ut()|0,Bt=_,Ki(l|0),d|0}function Ct(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0;return w=Bt,Bt=Bt+16|0,_=w|0,le(i,r,l,d,_)|0,Bt=w,Ki(o[_+4>>2]|0),o[_>>2]|0|0}function ni(i,r,l){return i=i|0,r=r|0,l=l|0,(l|0)<32?(Ki(r>>l|0),i>>>l|(r&(1<<l)-1)<<32-l):(Ki(((r|0)<0?-1:0)|0),r>>l-32|0)}function Gt(i,r,l){return i=i|0,r=r|0,l=l|0,(l|0)<32?(Ki(r>>>l|0),i>>>l|(r&(1<<l)-1)<<32-l):(Ki(0),r>>>l-32|0)}function Zt(i,r,l){return i=i|0,r=r|0,l=l|0,(l|0)<32?(Ki(r<<l|(i&(1<<l)-1<<32-l)>>>32-l|0),i<<l):(Ki(i<<l-32|0),0)}function Z(i,r){return i=+i,r=+r,i!=i?+r:r!=r?+i:+Vn(+i,+r)}function A(i,r){return i=+i,r=+r,i!=i?+r:r!=r?+i:+ur(+i,+r)}function E(i){return i=+i,i>=0?+hi(i+.5):+jr(i-.5)}function F(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if((l|0)>=8192)return Ur(i|0,r|0,l|0)|0,i|0;if(w=i|0,_=i+l|0,(i&3)==(r&3)){for(;i&3;){if(!l)return w|0;kt[i>>0]=kt[r>>0]|0,i=i+1|0,r=r+1|0,l=l-1|0}for(l=_&-4|0,d=l-64|0;(i|0)<=(d|0);)o[i>>2]=o[r>>2],o[i+4>>2]=o[r+4>>2],o[i+8>>2]=o[r+8>>2],o[i+12>>2]=o[r+12>>2],o[i+16>>2]=o[r+16>>2],o[i+20>>2]=o[r+20>>2],o[i+24>>2]=o[r+24>>2],o[i+28>>2]=o[r+28>>2],o[i+32>>2]=o[r+32>>2],o[i+36>>2]=o[r+36>>2],o[i+40>>2]=o[r+40>>2],o[i+44>>2]=o[r+44>>2],o[i+48>>2]=o[r+48>>2],o[i+52>>2]=o[r+52>>2],o[i+56>>2]=o[r+56>>2],o[i+60>>2]=o[r+60>>2],i=i+64|0,r=r+64|0;for(;(i|0)<(l|0);)o[i>>2]=o[r>>2],i=i+4|0,r=r+4|0}else for(l=_-4|0;(i|0)<(l|0);)kt[i>>0]=kt[r>>0]|0,kt[i+1>>0]=kt[r+1>>0]|0,kt[i+2>>0]=kt[r+2>>0]|0,kt[i+3>>0]=kt[r+3>>0]|0,i=i+4|0,r=r+4|0;for(;(i|0)<(_|0);)kt[i>>0]=kt[r>>0]|0,i=i+1|0,r=r+1|0;return w|0}function O(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;if(w=i+l|0,r=r&255,(l|0)>=67){for(;i&3;)kt[i>>0]=r,i=i+1|0;for(d=w&-4|0,T=r|r<<8|r<<16|r<<24,_=d-64|0;(i|0)<=(_|0);)o[i>>2]=T,o[i+4>>2]=T,o[i+8>>2]=T,o[i+12>>2]=T,o[i+16>>2]=T,o[i+20>>2]=T,o[i+24>>2]=T,o[i+28>>2]=T,o[i+32>>2]=T,o[i+36>>2]=T,o[i+40>>2]=T,o[i+44>>2]=T,o[i+48>>2]=T,o[i+52>>2]=T,o[i+56>>2]=T,o[i+60>>2]=T,i=i+64|0;for(;(i|0)<(d|0);)o[i>>2]=T,i=i+4|0}for(;(i|0)<(w|0);)kt[i>>0]=r,i=i+1|0;return w-l|0}function y(i){return i=+i,i>=0?+hi(i+.5):+jr(i-.5)}function s(i){i=i|0;var r=0,l=0,d=0;return d=Vs()|0,l=o[fi>>2]|0,r=l+i|0,(i|0)>0&(r|0)<(l|0)|(r|0)<0?(hr(r|0)|0,cr(12),-1):(r|0)>(d|0)&&!(Vt(r|0)|0)?(cr(12),-1):(o[fi>>2]=r,l|0)}return{___divdi3:oe,___muldi3:$e,___remdi3:_t,___uremdi3:Ct,_areNeighborCells:Oo,_bitshift64Ashr:ni,_bitshift64Lshr:Gt,_bitshift64Shl:Zt,_calloc:D,_cellAreaKm2:ks,_cellAreaM2:ps,_cellAreaRads2:Hs,_cellToBoundary:Nr,_cellToCenterChild:Xr,_cellToChildPos:ka,_cellToChildren:rr,_cellToChildrenSize:Ts,_cellToLatLng:mr,_cellToLocalIj:No,_cellToParent:Zr,_cellToVertex:Jn,_cellToVertexes:tl,_cellsToDirectedEdge:Wo,_cellsToLinkedMultiPolygon:xe,_childPosToCell:Xa,_compactCells:ko,_destroyLinkedMultiPolygon:vo,_directedEdgeToBoundary:ba,_directedEdgeToCells:Xo,_edgeLengthKm:yo,_edgeLengthM:rs,_edgeLengthRads:Ya,_emscripten_replace_memory:Fr,_free:C,_getBaseCellNumber:Ol,_getDirectedEdgeDestination:Gs,_getDirectedEdgeOrigin:Co,_getHexagonAreaAvgKm2:bi,_getHexagonAreaAvgM2:Fi,_getHexagonEdgeLengthAvgKm:Bn,_getHexagonEdgeLengthAvgM:Hn,_getIcosahedronFaces:_o,_getNumCells:lr,_getPentagons:Sa,_getRes0Cells:qa,_getResolution:Gn,_greatCircleDistanceKm:Ui,_greatCircleDistanceM:Di,_greatCircleDistanceRads:pi,_gridDisk:Va,_gridDiskDistances:Xs,_gridDistance:En,_gridPathCells:Cn,_gridPathCellsSize:Wl,_gridRingUnsafe:al,_i64Add:z,_i64Subtract:R,_isPentagon:kr,_isResClassIII:ds,_isValidCell:es,_isValidDirectedEdge:$o,_isValidVertex:oa,_latLngToCell:$a,_llvm_maxnum_f64:Z,_llvm_minnum_f64:A,_llvm_round_f64:E,_localIjToCell:Nl,_malloc:Ms,_maxFaceCount:ha,_maxGridDiskSize:Fo,_maxPolygonToCellsSize:ol,_memcpy:F,_memset:O,_originToDirectedEdges:Yo,_pentagonCount:ea,_polygonToCells:Ga,_readInt64AsDoubleFromPointer:_u,_res0CellCount:Or,_round:y,_sbrk:s,_sizeOfCellBoundary:$u,_sizeOfCoordIJ:el,_sizeOfGeoLoop:$l,_sizeOfGeoPolygon:ms,_sizeOfH3Index:ta,_sizeOfLatLng:oc,_sizeOfLinkedGeoPolygon:_a,_uncompactCells:ul,_uncompactCellsSize:Qr,_vertexToLatLng:Tu,establishStackSpace:Na,stackAlloc:Us,stackRestore:Dr,stackSave:ua}}(st,Me,Et);t.___divdi3=se.___divdi3,t.___muldi3=se.___muldi3,t.___remdi3=se.___remdi3,t.___uremdi3=se.___uremdi3,t._areNeighborCells=se._areNeighborCells,t._bitshift64Ashr=se._bitshift64Ashr,t._bitshift64Lshr=se._bitshift64Lshr,t._bitshift64Shl=se._bitshift64Shl,t._calloc=se._calloc,t._cellAreaKm2=se._cellAreaKm2,t._cellAreaM2=se._cellAreaM2,t._cellAreaRads2=se._cellAreaRads2,t._cellToBoundary=se._cellToBoundary,t._cellToCenterChild=se._cellToCenterChild,t._cellToChildPos=se._cellToChildPos,t._cellToChildren=se._cellToChildren,t._cellToChildrenSize=se._cellToChildrenSize,t._cellToLatLng=se._cellToLatLng,t._cellToLocalIj=se._cellToLocalIj,t._cellToParent=se._cellToParent,t._cellToVertex=se._cellToVertex,t._cellToVertexes=se._cellToVertexes,t._cellsToDirectedEdge=se._cellsToDirectedEdge,t._cellsToLinkedMultiPolygon=se._cellsToLinkedMultiPolygon,t._childPosToCell=se._childPosToCell,t._compactCells=se._compactCells,t._destroyLinkedMultiPolygon=se._destroyLinkedMultiPolygon,t._directedEdgeToBoundary=se._directedEdgeToBoundary,t._directedEdgeToCells=se._directedEdgeToCells,t._edgeLengthKm=se._edgeLengthKm,t._edgeLengthM=se._edgeLengthM,t._edgeLengthRads=se._edgeLengthRads;var ne=t._emscripten_replace_memory=se._emscripten_replace_memory;t._free=se._free,t._getBaseCellNumber=se._getBaseCellNumber,t._getDirectedEdgeDestination=se._getDirectedEdgeDestination,t._getDirectedEdgeOrigin=se._getDirectedEdgeOrigin,t._getHexagonAreaAvgKm2=se._getHexagonAreaAvgKm2,t._getHexagonAreaAvgM2=se._getHexagonAreaAvgM2,t._getHexagonEdgeLengthAvgKm=se._getHexagonEdgeLengthAvgKm,t._getHexagonEdgeLengthAvgM=se._getHexagonEdgeLengthAvgM,t._getIcosahedronFaces=se._getIcosahedronFaces,t._getNumCells=se._getNumCells,t._getPentagons=se._getPentagons,t._getRes0Cells=se._getRes0Cells,t._getResolution=se._getResolution,t._greatCircleDistanceKm=se._greatCircleDistanceKm,t._greatCircleDistanceM=se._greatCircleDistanceM,t._greatCircleDistanceRads=se._greatCircleDistanceRads,t._gridDisk=se._gridDisk,t._gridDiskDistances=se._gridDiskDistances,t._gridDistance=se._gridDistance,t._gridPathCells=se._gridPathCells,t._gridPathCellsSize=se._gridPathCellsSize,t._gridRingUnsafe=se._gridRingUnsafe,t._i64Add=se._i64Add,t._i64Subtract=se._i64Subtract,t._isPentagon=se._isPentagon,t._isResClassIII=se._isResClassIII,t._isValidCell=se._isValidCell,t._isValidDirectedEdge=se._isValidDirectedEdge,t._isValidVertex=se._isValidVertex,t._latLngToCell=se._latLngToCell,t._llvm_maxnum_f64=se._llvm_maxnum_f64,t._llvm_minnum_f64=se._llvm_minnum_f64,t._llvm_round_f64=se._llvm_round_f64,t._localIjToCell=se._localIjToCell,t._malloc=se._malloc,t._maxFaceCount=se._maxFaceCount,t._maxGridDiskSize=se._maxGridDiskSize,t._maxPolygonToCellsSize=se._maxPolygonToCellsSize,t._memcpy=se._memcpy,t._memset=se._memset,t._originToDirectedEdges=se._originToDirectedEdges,t._pentagonCount=se._pentagonCount,t._polygonToCells=se._polygonToCells,t._readInt64AsDoubleFromPointer=se._readInt64AsDoubleFromPointer,t._res0CellCount=se._res0CellCount,t._round=se._round,t._sbrk=se._sbrk,t._sizeOfCellBoundary=se._sizeOfCellBoundary,t._sizeOfCoordIJ=se._sizeOfCoordIJ,t._sizeOfGeoLoop=se._sizeOfGeoLoop,t._sizeOfGeoPolygon=se._sizeOfGeoPolygon,t._sizeOfH3Index=se._sizeOfH3Index,t._sizeOfLatLng=se._sizeOfLatLng,t._sizeOfLinkedGeoPolygon=se._sizeOfLinkedGeoPolygon,t._uncompactCells=se._uncompactCells,t._uncompactCellsSize=se._uncompactCellsSize,t._vertexToLatLng=se._vertexToLatLng,t.establishStackSpace=se.establishStackSpace;var $=t.stackAlloc=se.stackAlloc,ie=t.stackRestore=se.stackRestore,de=t.stackSave=se.stackSave;if(t.asm=se,t.cwrap=xt,t.setValue=be,t.getValue=je,rn){Pn(rn)||(rn=x(rn));{Pr();var ye=function(De){De.byteLength&&(De=new Uint8Array(De)),dt.set(De,ue),t.memoryInitializerRequest&&delete t.memoryInitializerRequest.response,ci()},ge=function(){S(rn,ye,function(){throw"could not load memory initializer "+rn})},Pe=ft(rn);if(Pe)ye(Pe.buffer);else if(t.memoryInitializerRequest){var Fe=function(){var De=t.memoryInitializerRequest,Ge=De.response;if(De.status!==200&&De.status!==0){var ht=ft(t.memoryInitializerRequestURL);if(ht)Ge=ht.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+De.status+", retrying "+rn),ge();return}}ye(Ge)};t.memoryInitializerRequest.response?setTimeout(Fe,0):t.memoryInitializerRequest.addEventListener("load",Fe)}else ge()}}var Ve;_n=function De(){Ve||Xe(),Ve||(_n=De)};function Xe(De){if(ei>0||(nn(),ei>0))return;function Ge(){Ve||(Ve=!0,!nt&&(vn(),Ci(),t.onRuntimeInitialized&&t.onRuntimeInitialized(),mi()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),Ge()},1)):Ge()}t.run=Xe;function Ye(De){throw t.onAbort&&t.onAbort(De),De+="",a(De),G(De),nt=!0,"abort("+De+"). Build with -s ASSERTIONS=1 for more info."}if(t.abort=Ye,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return Xe(),e}(typeof Ca=="object"?Ca:{}),Is="number",Kr=Is,Jm=Is,as=Is,os=Is,ec=Is,dr=Is,hV=[["sizeOfH3Index",Is],["sizeOfLatLng",Is],["sizeOfCellBoundary",Is],["sizeOfGeoLoop",Is],["sizeOfGeoPolygon",Is],["sizeOfLinkedGeoPolygon",Is],["sizeOfCoordIJ",Is],["readInt64AsDoubleFromPointer",Is],["isValidCell",Jm,[as,os]],["latLngToCell",Kr,[Is,Is,ec,dr]],["cellToLatLng",Kr,[as,os,dr]],["cellToBoundary",Kr,[as,os,dr]],["maxGridDiskSize",Kr,[Is,dr]],["gridDisk",Kr,[as,os,Is,dr]],["gridDiskDistances",Kr,[as,os,Is,dr,dr]],["gridRingUnsafe",Kr,[as,os,Is,dr]],["maxPolygonToCellsSize",Kr,[dr,ec,Is,dr]],["polygonToCells",Kr,[dr,ec,Is,dr]],["cellsToLinkedMultiPolygon",Kr,[dr,Is,dr]],["destroyLinkedMultiPolygon",null,[dr]],["compactCells",Kr,[dr,dr,Is,Is]],["uncompactCells",Kr,[dr,Is,Is,dr,Is,ec]],["uncompactCellsSize",Kr,[dr,Is,Is,ec,dr]],["isPentagon",Jm,[as,os]],["isResClassIII",Jm,[as,os]],["getBaseCellNumber",Is,[as,os]],["getResolution",Is,[as,os]],["maxFaceCount",Kr,[as,os,dr]],["getIcosahedronFaces",Kr,[as,os,dr]],["cellToParent",Kr,[as,os,ec,dr]],["cellToChildren",Kr,[as,os,ec,dr]],["cellToCenterChild",Kr,[as,os,ec,dr]],["cellToChildrenSize",Kr,[as,os,ec,dr]],["cellToChildPos",Kr,[as,os,ec,dr]],["childPosToCell",Kr,[Is,Is,as,os,ec,dr]],["areNeighborCells",Kr,[as,os,as,os,dr]],["cellsToDirectedEdge",Kr,[as,os,as,os,dr]],["getDirectedEdgeOrigin",Kr,[as,os,dr]],["getDirectedEdgeDestination",Kr,[as,os,dr]],["isValidDirectedEdge",Jm,[as,os]],["directedEdgeToCells",Kr,[as,os,dr]],["originToDirectedEdges",Kr,[as,os,dr]],["directedEdgeToBoundary",Kr,[as,os,dr]],["gridDistance",Kr,[as,os,as,os,dr]],["gridPathCells",Kr,[as,os,as,os,dr]],["gridPathCellsSize",Kr,[as,os,as,os,dr]],["cellToLocalIj",Kr,[as,os,as,os,Is,dr]],["localIjToCell",Kr,[as,os,dr,Is,dr]],["getHexagonAreaAvgM2",Kr,[ec,dr]],["getHexagonAreaAvgKm2",Kr,[ec,dr]],["getHexagonEdgeLengthAvgM",Kr,[ec,dr]],["getHexagonEdgeLengthAvgKm",Kr,[ec,dr]],["greatCircleDistanceM",Is,[dr,dr]],["greatCircleDistanceKm",Is,[dr,dr]],["greatCircleDistanceRads",Is,[dr,dr]],["cellAreaM2",Kr,[as,os,dr]],["cellAreaKm2",Kr,[as,os,dr]],["cellAreaRads2",Kr,[as,os,dr]],["edgeLengthM",Kr,[as,os,dr]],["edgeLengthKm",Kr,[as,os,dr]],["edgeLengthRads",Kr,[as,os,dr]],["getNumCells",Kr,[ec,dr]],["getRes0Cells",Kr,[dr]],["res0CellCount",Is],["getPentagons",Kr,[Is,dr]],["pentagonCount",Is],["cellToVertex",Kr,[as,os,Is,dr]],["cellToVertexes",Kr,[as,os,dr]],["vertexToLatLng",Kr,[as,os,dr]],["isValidVertex",Jm,[as,os]]],AV=0,fV=1,dV=2,pV=3,k5=4,mV=5,gV=6,_V=7,yV=8,vV=9,xV=10,bV=11,wV=12,SV=13,IV=14,EV=15,Qu={};Qu[AV]="Success";Qu[fV]="The operation failed but a more specific error is not available";Qu[dV]="Argument was outside of acceptable range";Qu[pV]="Latitude or longitude arguments were outside of acceptable range";Qu[k5]="Resolution argument was outside of acceptable range";Qu[mV]="Cell argument was not valid";Qu[gV]="Directed edge argument was not valid";Qu[_V]="Undirected edge argument was not valid";Qu[yV]="Vertex argument was not valid";Qu[vV]="Pentagon distortion was encountered";Qu[xV]="Duplicate input";Qu[bV]="Cell arguments were not neighbors";Qu[wV]="Cell arguments had incompatible resolutions";Qu[SV]="Memory allocation failed";Qu[IV]="Bounds of provided memory were insufficient";Qu[EV]="Mode or flags argument was not valid";var CV=1e3,M5=1001,P5=1002,v1={};v1[CV]="Unknown unit";v1[M5]="Array length out of bounds";v1[P5]="Got unexpected null value for H3 index";var TV="Unknown error";function D5(e,t,n){var c=n&&"value"in n,g=new Error((e[t]||TV)+" (code: "+t+(c?", value: "+n.value:"")+")");return g.code=t,g}function L5(e,t){var n=arguments.length===2?{value:t}:{};return D5(Qu,e,n)}function B5(e,t){var n=arguments.length===2?{value:t}:{};return D5(v1,e,n)}function Q_(e){if(e!==0)throw L5(e)}var gh={};hV.forEach(function(t){gh[t[0]]=Ca.cwrap.apply(Ca,t)});var sm=16,Cg=4,M2=8,kV=8,W_=gh.sizeOfH3Index(),P2=gh.sizeOfLatLng();gh.sizeOfCellBoundary();var MV=gh.sizeOfGeoPolygon(),Ag=gh.sizeOfGeoLoop();gh.sizeOfLinkedGeoPolygon();gh.sizeOfCoordIJ();function PV(e){if(typeof e!="number"||e<0||e>15||Math.floor(e)!==e)throw L5(k5,e);return e}function DV(e){if(!e)throw B5(P5);return e}var LV=Math.pow(2,32)-1;function BV(e){if(e>LV)throw B5(M5,e);return e}var zV=/[^0-9a-fA-F]/;function RV(e){if(Array.isArray(e)&&e.length===2&&Number.isInteger(e[0])&&Number.isInteger(e[1]))return e;if(typeof e!="string"||zV.test(e))return[0,0];var t=parseInt(e.substring(0,e.length-8),sm),n=parseInt(e.substring(e.length-8),sm);return[n,t]}function Mw(e){if(e>=0)return e.toString(sm);e=e&2147483647;var t=z5(8,e.toString(sm)),n=(parseInt(t[0],sm)+8).toString(sm);return t=n+t.substring(1),t}function FV(e,t){return Mw(t)+z5(8,Mw(e))}function z5(e,t){for(var n=e-t.length,c="",g=0;g<n;g++)c+="0";return c=c+t,c}function Pw(e,t,n){for(var c=e.length,g=Ca._calloc(c,P2),x=n?1:0,S=n?0:1,a=0;a<c*2;a+=2)Ca.HEAPF64.set([e[a/2][x],e[a/2][S]].map(F5),g/M2+a);return Ca.HEAPU32.set([c,g],t/Cg),t}function OV(e,t){var n=e.length-1,c=Ca._calloc(MV),g=0,x=g+Ag,S=x+Cg;Pw(e[0],c+g,t);var a;if(n>0){a=Ca._calloc(n,Ag);for(var G=0;G<n;G++)Pw(e[G+1],a+Ag*G,t)}return Ca.setValue(c+x,n,"i32"),Ca.setValue(c+S,a,"i32"),c}function NV(e){var t=0,n=t+Ag,c=n+Cg,g=Cg;Ca._free(Ca.getValue(e+t+g,"i8*"));var x=Ca.getValue(e+n,"i32");if(x>0){for(var S=Ca.getValue(e+c,"i32"),a=0;a<x;a++)Ca._free(Ca.getValue(S+Ag*a+g,"i8*"));Ca._free(S)}Ca._free(e)}function R5(e,t){t===void 0&&(t=0);var n=Ca.getValue(e+W_*t,"i32"),c=Ca.getValue(e+W_*t+Cg,"i32");return c?FV(n,c):null}function VV(e){return gh.readInt64AsDoubleFromPointer(e)}function UV(e,t){for(var n=[],c=0;c<t;c++){var g=R5(e,c);g!==null&&n.push(g)}return n}function Dw(e){return jV(Ca.getValue(e,"double"))}function GV(e){return[Dw(e),Dw(e+M2)]}function qV(e,t,n){var c=Ca._malloc(P2);Ca.HEAPF64.set([e,t].map(F5),c/M2);var g=Ca._malloc(W_);try{return Q_(gh.latLngToCell(c,n,g)),DV(R5(g))}finally{Ca._free(g),Ca._free(c)}}function Lw(e){var t=Ca._malloc(P2),n=RV(e),c=n[0],g=n[1];try{return Q_(gh.cellToLatLng(c,g,t)),GV(t)}finally{Ca._free(t)}}function HV(e,t,n){if(PV(t),n=!!n,e.length===0||e[0].length===0)return[];var c=typeof e[0][0]=="number"?[e]:e,g=OV(c,n),x=Ca._malloc(kV);try{Q_(gh.maxPolygonToCellsSize(g,t,0,x));var S=BV(VV(x)),a=Ca._calloc(S,W_);try{return Q_(gh.polygonToCells(g,t,0,a)),UV(a,S)}finally{Ca._free(a)}}finally{Ca._free(x),NV(g)}}function F5(e){return e*Math.PI/180}function jV(e){return e*180/Math.PI}function ZV(e,t,n){n===void 0&&(n={});var c={type:"Feature"};return(n.id===0||n.id)&&(c.id=n.id),n.bbox&&(c.bbox=n.bbox),c.properties=t||{},c.geometry=e,c}function QV(e,t){t===void 0&&(t={});var n={type:"FeatureCollection"};return t.id&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.features=e,n}function WV(e,t){if(e.type==="Feature")t(e,0);else if(e.type==="FeatureCollection")for(var n=0;n<e.features.length&&t(e.features[n],n)!==!1;n++);}function $V(e){var t={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return WV(e,function(n){var c,g,x,S;switch((S=n.geometry)===null||S===void 0?void 0:S.type){case"Point":t.MultiPoint.coordinates.push(n.geometry.coordinates),t.MultiPoint.properties.push(n.properties);break;case"MultiPoint":(c=t.MultiPoint.coordinates).push.apply(c,n.geometry.coordinates),t.MultiPoint.properties.push(n.properties);break;case"LineString":t.MultiLineString.coordinates.push(n.geometry.coordinates),t.MultiLineString.properties.push(n.properties);break;case"MultiLineString":(g=t.MultiLineString.coordinates).push.apply(g,n.geometry.coordinates),t.MultiLineString.properties.push(n.properties);break;case"Polygon":t.MultiPolygon.coordinates.push(n.geometry.coordinates),t.MultiPolygon.properties.push(n.properties);break;case"MultiPolygon":(x=t.MultiPolygon.coordinates).push.apply(x,n.geometry.coordinates),t.MultiPolygon.properties.push(n.properties);break}}),QV(Object.keys(t).filter(function(n){return t[n].coordinates.length}).sort().map(function(n){var c={type:n,coordinates:t[n].coordinates},g={collectedProperties:t[n].properties};return ZV(c,g)}))}const O5=e=>()=>e,kv=e=>{const t=e?(n,c)=>c.minus(n).abs().isLessThanOrEqualTo(e):O5(!1);return(n,c)=>t(n,c)?0:n.comparedTo(c)};function XV(e){const t=e?(n,c,g,x,S)=>n.exponentiatedBy(2).isLessThanOrEqualTo(x.minus(c).exponentiatedBy(2).plus(S.minus(g).exponentiatedBy(2)).times(e)):O5(!1);return(n,c,g)=>{const x=n.x,S=n.y,a=g.x,G=g.y,W=S.minus(G).times(c.x.minus(a)).minus(x.minus(a).times(c.y.minus(G)));return t(W,x,S,a,G)?0:W.comparedTo(0)}}var YV=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,hy=Math.ceil,Bh=Math.floor,Vc="[BigNumber Error] ",Bw=Vc+"Number primitive has more than 15 significant digits: ",oA=1e14,Ss=14,Ay=9007199254740991,fy=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],R0=1e7,Du=1e9;function N5(e){var t,n,c,g=ut.prototype={constructor:ut,toString:null,valueOf:null},x=new ut(1),S=20,a=4,G=-7,W=21,he=-1e7,ae=1e7,ue=!1,be=1,je=0,nt={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},tt="0123456789abcdefghijklmnopqrstuvwxyz",at=!0;function ut(it,vt){var mt,Et,Pt,dt,Je,pt,lt,Nt,zt=this;if(!(zt instanceof ut))return new ut(it,vt);if(vt==null){if(it&&it._isBigNumber===!0){zt.s=it.s,!it.c||it.e>ae?zt.c=zt.e=null:it.e<he?zt.c=[zt.e=0]:(zt.e=it.e,zt.c=it.c.slice());return}if((pt=typeof it=="number")&&it*0==0){if(zt.s=1/it<0?(it=-it,-1):1,it===~~it){for(dt=0,Je=it;Je>=10;Je/=10,dt++);dt>ae?zt.c=zt.e=null:(zt.e=dt,zt.c=[it]);return}Nt=String(it)}else{if(!YV.test(Nt=String(it)))return c(zt,Nt,pt);zt.s=Nt.charCodeAt(0)==45?(Nt=Nt.slice(1),-1):1}(dt=Nt.indexOf("."))>-1&&(Nt=Nt.replace(".","")),(Je=Nt.search(/e/i))>0?(dt<0&&(dt=Je),dt+=+Nt.slice(Je+1),Nt=Nt.substring(0,Je)):dt<0&&(dt=Nt.length)}else{if(Fl(vt,2,tt.length,"Base"),vt==10&&at)return zt=new ut(it),Oe(zt,S+zt.e+1,a);if(Nt=String(it),pt=typeof it=="number"){if(it*0!=0)return c(zt,Nt,pt,vt);if(zt.s=1/it<0?(Nt=Nt.slice(1),-1):1,ut.DEBUG&&Nt.replace(/^0\.0*|\./,"").length>15)throw Error(Bw+it)}else zt.s=Nt.charCodeAt(0)===45?(Nt=Nt.slice(1),-1):1;for(mt=tt.slice(0,vt),dt=Je=0,lt=Nt.length;Je<lt;Je++)if(mt.indexOf(Et=Nt.charAt(Je))<0){if(Et=="."){if(Je>dt){dt=lt;continue}}else if(!Pt&&(Nt==Nt.toUpperCase()&&(Nt=Nt.toLowerCase())||Nt==Nt.toLowerCase()&&(Nt=Nt.toUpperCase()))){Pt=!0,Je=-1,dt=0;continue}return c(zt,String(it),pt,vt)}pt=!1,Nt=n(Nt,vt,10,zt.s),(dt=Nt.indexOf("."))>-1?Nt=Nt.replace(".",""):dt=Nt.length}for(Je=0;Nt.charCodeAt(Je)===48;Je++);for(lt=Nt.length;Nt.charCodeAt(--lt)===48;);if(Nt=Nt.slice(Je,++lt)){if(lt-=Je,pt&&ut.DEBUG&&lt>15&&(it>Ay||it!==Bh(it)))throw Error(Bw+zt.s*it);if((dt=dt-Je-1)>ae)zt.c=zt.e=null;else if(dt<he)zt.c=[zt.e=0];else{if(zt.e=dt,zt.c=[],Je=(dt+1)%Ss,dt<0&&(Je+=Ss),Je<lt){for(Je&&zt.c.push(+Nt.slice(0,Je)),lt-=Ss;Je<lt;)zt.c.push(+Nt.slice(Je,Je+=Ss));Je=Ss-(Nt=Nt.slice(Je)).length}else Je-=lt;for(;Je--;Nt+="0");zt.c.push(+Nt)}}else zt.c=[zt.e=0]}ut.clone=N5,ut.ROUND_UP=0,ut.ROUND_DOWN=1,ut.ROUND_CEIL=2,ut.ROUND_FLOOR=3,ut.ROUND_HALF_UP=4,ut.ROUND_HALF_DOWN=5,ut.ROUND_HALF_EVEN=6,ut.ROUND_HALF_CEIL=7,ut.ROUND_HALF_FLOOR=8,ut.EUCLID=9,ut.config=ut.set=function(it){var vt,mt;if(it!=null)if(typeof it=="object"){if(it.hasOwnProperty(vt="DECIMAL_PLACES")&&(mt=it[vt],Fl(mt,0,Du,vt),S=mt),it.hasOwnProperty(vt="ROUNDING_MODE")&&(mt=it[vt],Fl(mt,0,8,vt),a=mt),it.hasOwnProperty(vt="EXPONENTIAL_AT")&&(mt=it[vt],mt&&mt.pop?(Fl(mt[0],-Du,0,vt),Fl(mt[1],0,Du,vt),G=mt[0],W=mt[1]):(Fl(mt,-Du,Du,vt),G=-(W=mt<0?-mt:mt))),it.hasOwnProperty(vt="RANGE"))if(mt=it[vt],mt&&mt.pop)Fl(mt[0],-Du,-1,vt),Fl(mt[1],1,Du,vt),he=mt[0],ae=mt[1];else if(Fl(mt,-Du,Du,vt),mt)he=-(ae=mt<0?-mt:mt);else throw Error(Vc+vt+" cannot be zero: "+mt);if(it.hasOwnProperty(vt="CRYPTO"))if(mt=it[vt],mt===!!mt)if(mt)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))ue=mt;else throw ue=!mt,Error(Vc+"crypto unavailable");else ue=mt;else throw Error(Vc+vt+" not true or false: "+mt);if(it.hasOwnProperty(vt="MODULO_MODE")&&(mt=it[vt],Fl(mt,0,9,vt),be=mt),it.hasOwnProperty(vt="POW_PRECISION")&&(mt=it[vt],Fl(mt,0,Du,vt),je=mt),it.hasOwnProperty(vt="FORMAT"))if(mt=it[vt],typeof mt=="object")nt=mt;else throw Error(Vc+vt+" not an object: "+mt);if(it.hasOwnProperty(vt="ALPHABET"))if(mt=it[vt],typeof mt=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(mt))at=mt.slice(0,10)=="0123456789",tt=mt;else throw Error(Vc+vt+" invalid: "+mt)}else throw Error(Vc+"Object expected: "+it);return{DECIMAL_PLACES:S,ROUNDING_MODE:a,EXPONENTIAL_AT:[G,W],RANGE:[he,ae],CRYPTO:ue,MODULO_MODE:be,POW_PRECISION:je,FORMAT:nt,ALPHABET:tt}},ut.isBigNumber=function(it){if(!it||it._isBigNumber!==!0)return!1;if(!ut.DEBUG)return!0;var vt,mt,Et=it.c,Pt=it.e,dt=it.s;e:if({}.toString.call(Et)=="[object Array]"){if((dt===1||dt===-1)&&Pt>=-Du&&Pt<=Du&&Pt===Bh(Pt)){if(Et[0]===0){if(Pt===0&&Et.length===1)return!0;break e}if(vt=(Pt+1)%Ss,vt<1&&(vt+=Ss),String(Et[0]).length==vt){for(vt=0;vt<Et.length;vt++)if(mt=Et[vt],mt<0||mt>=oA||mt!==Bh(mt))break e;if(mt!==0)return!0}}}else if(Et===null&&Pt===null&&(dt===null||dt===1||dt===-1))return!0;throw Error(Vc+"Invalid BigNumber: "+it)},ut.maximum=ut.max=function(){return Tt(arguments,-1)},ut.minimum=ut.min=function(){return Tt(arguments,1)},ut.random=function(){var it=9007199254740992,vt=Math.random()*it&2097151?function(){return Bh(Math.random()*it)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(mt){var Et,Pt,dt,Je,pt,lt=0,Nt=[],zt=new ut(x);if(mt==null?mt=S:Fl(mt,0,Du),Je=hy(mt/Ss),ue)if(crypto.getRandomValues){for(Et=crypto.getRandomValues(new Uint32Array(Je*=2));lt<Je;)pt=Et[lt]*131072+(Et[lt+1]>>>11),pt>=9e15?(Pt=crypto.getRandomValues(new Uint32Array(2)),Et[lt]=Pt[0],Et[lt+1]=Pt[1]):(Nt.push(pt%1e14),lt+=2);lt=Je/2}else if(crypto.randomBytes){for(Et=crypto.randomBytes(Je*=7);lt<Je;)pt=(Et[lt]&31)*281474976710656+Et[lt+1]*1099511627776+Et[lt+2]*4294967296+Et[lt+3]*16777216+(Et[lt+4]<<16)+(Et[lt+5]<<8)+Et[lt+6],pt>=9e15?crypto.randomBytes(7).copy(Et,lt):(Nt.push(pt%1e14),lt+=7);lt=Je/7}else throw ue=!1,Error(Vc+"crypto unavailable");if(!ue)for(;lt<Je;)pt=vt(),pt<9e15&&(Nt[lt++]=pt%1e14);for(Je=Nt[--lt],mt%=Ss,Je&&mt&&(pt=fy[Ss-mt],Nt[lt]=Bh(Je/pt)*pt);Nt[lt]===0;Nt.pop(),lt--);if(lt<0)Nt=[dt=0];else{for(dt=-1;Nt[0]===0;Nt.splice(0,1),dt-=Ss);for(lt=1,pt=Nt[0];pt>=10;pt/=10,lt++);lt<Ss&&(dt-=Ss-lt)}return zt.e=dt,zt.c=Nt,zt}}(),ut.sum=function(){for(var it=1,vt=arguments,mt=new ut(vt[0]);it<vt.length;)mt=mt.plus(vt[it++]);return mt},n=function(){var it="0123456789";function vt(mt,Et,Pt,dt){for(var Je,pt=[0],lt,Nt=0,zt=mt.length;Nt<zt;){for(lt=pt.length;lt--;pt[lt]*=Et);for(pt[0]+=dt.indexOf(mt.charAt(Nt++)),Je=0;Je<pt.length;Je++)pt[Je]>Pt-1&&(pt[Je+1]==null&&(pt[Je+1]=0),pt[Je+1]+=pt[Je]/Pt|0,pt[Je]%=Pt)}return pt.reverse()}return function(mt,Et,Pt,dt,Je){var pt,lt,Nt,zt,Ot,gi,wi,Ti,Ni=mt.indexOf("."),en=S,ji=a;for(Ni>=0&&(zt=je,je=0,mt=mt.replace(".",""),Ti=new ut(Et),gi=Ti.pow(mt.length-Ni),je=zt,Ti.c=vt(Xf(Lh(gi.c),gi.e,"0"),10,Pt,it),Ti.e=Ti.c.length),wi=vt(mt,Et,Pt,Je?(pt=tt,it):(pt=it,tt)),Nt=zt=wi.length;wi[--zt]==0;wi.pop());if(!wi[0])return pt.charAt(0);if(Ni<0?--Nt:(gi.c=wi,gi.e=Nt,gi.s=dt,gi=t(gi,Ti,en,ji,Pt),wi=gi.c,Ot=gi.r,Nt=gi.e),lt=Nt+en+1,Ni=wi[lt],zt=Pt/2,Ot=Ot||lt<0||wi[lt+1]!=null,Ot=ji<4?(Ni!=null||Ot)&&(ji==0||ji==(gi.s<0?3:2)):Ni>zt||Ni==zt&&(ji==4||Ot||ji==6&&wi[lt-1]&1||ji==(gi.s<0?8:7)),lt<1||!wi[0])mt=Ot?Xf(pt.charAt(1),-en,pt.charAt(0)):pt.charAt(0);else{if(wi.length=lt,Ot)for(--Pt;++wi[--lt]>Pt;)wi[lt]=0,lt||(++Nt,wi=[1].concat(wi));for(zt=wi.length;!wi[--zt];);for(Ni=0,mt="";Ni<=zt;mt+=pt.charAt(wi[Ni++]));mt=Xf(mt,Nt,pt.charAt(0))}return mt}}(),t=function(){function it(Et,Pt,dt){var Je,pt,lt,Nt,zt=0,Ot=Et.length,gi=Pt%R0,wi=Pt/R0|0;for(Et=Et.slice();Ot--;)lt=Et[Ot]%R0,Nt=Et[Ot]/R0|0,Je=wi*lt+Nt*gi,pt=gi*lt+Je%R0*R0+zt,zt=(pt/dt|0)+(Je/R0|0)+wi*Nt,Et[Ot]=pt%dt;return zt&&(Et=[zt].concat(Et)),Et}function vt(Et,Pt,dt,Je){var pt,lt;if(dt!=Je)lt=dt>Je?1:-1;else for(pt=lt=0;pt<dt;pt++)if(Et[pt]!=Pt[pt]){lt=Et[pt]>Pt[pt]?1:-1;break}return lt}function mt(Et,Pt,dt,Je){for(var pt=0;dt--;)Et[dt]-=pt,pt=Et[dt]<Pt[dt]?1:0,Et[dt]=pt*Je+Et[dt]-Pt[dt];for(;!Et[0]&&Et.length>1;Et.splice(0,1));}return function(Et,Pt,dt,Je,pt){var lt,Nt,zt,Ot,gi,wi,Ti,Ni,en,ji,Vi,nn,vn,Ci,mi,Ri,Oi,_i=Et.s==Pt.s?1:-1,Ji=Et.c,Ai=Pt.c;if(!Ji||!Ji[0]||!Ai||!Ai[0])return new ut(!Et.s||!Pt.s||(Ji?Ai&&Ji[0]==Ai[0]:!Ai)?NaN:Ji&&Ji[0]==0||!Ai?_i*0:_i/0);for(Ni=new ut(_i),en=Ni.c=[],Nt=Et.e-Pt.e,_i=dt+Nt+1,pt||(pt=oA,Nt=zh(Et.e/Ss)-zh(Pt.e/Ss),_i=_i/Ss|0),zt=0;Ai[zt]==(Ji[zt]||0);zt++);if(Ai[zt]>(Ji[zt]||0)&&Nt--,_i<0)en.push(1),Ot=!0;else{for(Ci=Ji.length,Ri=Ai.length,zt=0,_i+=2,gi=Bh(pt/(Ai[0]+1)),gi>1&&(Ai=it(Ai,gi,pt),Ji=it(Ji,gi,pt),Ri=Ai.length,Ci=Ji.length),vn=Ri,ji=Ji.slice(0,Ri),Vi=ji.length;Vi<Ri;ji[Vi++]=0);Oi=Ai.slice(),Oi=[0].concat(Oi),mi=Ai[0],Ai[1]>=pt/2&&mi++;do{if(gi=0,lt=vt(Ai,ji,Ri,Vi),lt<0){if(nn=ji[0],Ri!=Vi&&(nn=nn*pt+(ji[1]||0)),gi=Bh(nn/mi),gi>1)for(gi>=pt&&(gi=pt-1),wi=it(Ai,gi,pt),Ti=wi.length,Vi=ji.length;vt(wi,ji,Ti,Vi)==1;)gi--,mt(wi,Ri<Ti?Oi:Ai,Ti,pt),Ti=wi.length,lt=1;else gi==0&&(lt=gi=1),wi=Ai.slice(),Ti=wi.length;if(Ti<Vi&&(wi=[0].concat(wi)),mt(ji,wi,Vi,pt),Vi=ji.length,lt==-1)for(;vt(Ai,ji,Ri,Vi)<1;)gi++,mt(ji,Ri<Vi?Oi:Ai,Vi,pt),Vi=ji.length}else lt===0&&(gi++,ji=[0]);en[zt++]=gi,ji[0]?ji[Vi++]=Ji[vn]||0:(ji=[Ji[vn]],Vi=1)}while((vn++<Ci||ji[0]!=null)&&_i--);Ot=ji[0]!=null,en[0]||en.splice(0,1)}if(pt==oA){for(zt=1,_i=en[0];_i>=10;_i/=10,zt++);Oe(Ni,dt+(Ni.e=zt+Nt*Ss-1)+1,Je,Ot)}else Ni.e=Nt,Ni.r=+Ot;return Ni}}();function xt(it,vt,mt,Et){var Pt,dt,Je,pt,lt;if(mt==null?mt=a:Fl(mt,0,8),!it.c)return it.toString();if(Pt=it.c[0],Je=it.e,vt==null)lt=Lh(it.c),lt=Et==1||Et==2&&(Je<=G||Je>=W)?Jg(lt,Je):Xf(lt,Je,"0");else if(it=Oe(new ut(it),vt,mt),dt=it.e,lt=Lh(it.c),pt=lt.length,Et==1||Et==2&&(vt<=dt||dt<=G)){for(;pt<vt;lt+="0",pt++);lt=Jg(lt,dt)}else if(vt-=Je,lt=Xf(lt,dt,"0"),dt+1>pt){if(--vt>0)for(lt+=".";vt--;lt+="0");}else if(vt+=dt-pt,vt>0)for(dt+1==pt&&(lt+=".");vt--;lt+="0");return it.s<0&&Pt?"-"+lt:lt}function Tt(it,vt){for(var mt,Et,Pt=1,dt=new ut(it[0]);Pt<it.length;Pt++)Et=new ut(it[Pt]),(!Et.s||(mt=Hd(dt,Et))===vt||mt===0&&dt.s===vt)&&(dt=Et);return dt}function Mt(it,vt,mt){for(var Et=1,Pt=vt.length;!vt[--Pt];vt.pop());for(Pt=vt[0];Pt>=10;Pt/=10,Et++);return(mt=Et+mt*Ss-1)>ae?it.c=it.e=null:mt<he?it.c=[it.e=0]:(it.e=mt,it.c=vt),it}c=function(){var it=/^(-?)0([xbo])(?=\w[\w.]*$)/i,vt=/^([^.]+)\.$/,mt=/^\.([^.]+)$/,Et=/^-?(Infinity|NaN)$/,Pt=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(dt,Je,pt,lt){var Nt,zt=pt?Je:Je.replace(Pt,"");if(Et.test(zt))dt.s=isNaN(zt)?null:zt<0?-1:1;else{if(!pt&&(zt=zt.replace(it,function(Ot,gi,wi){return Nt=(wi=wi.toLowerCase())=="x"?16:wi=="b"?2:8,!lt||lt==Nt?gi:Ot}),lt&&(Nt=lt,zt=zt.replace(vt,"$1").replace(mt,"0.$1")),Je!=zt))return new ut(zt,Nt);if(ut.DEBUG)throw Error(Vc+"Not a"+(lt?" base "+lt:"")+" number: "+Je);dt.s=null}dt.c=dt.e=null}}();function Oe(it,vt,mt,Et){var Pt,dt,Je,pt,lt,Nt,zt,Ot=it.c,gi=fy;if(Ot){e:{for(Pt=1,pt=Ot[0];pt>=10;pt/=10,Pt++);if(dt=vt-Pt,dt<0)dt+=Ss,Je=vt,lt=Ot[Nt=0],zt=Bh(lt/gi[Pt-Je-1]%10);else if(Nt=hy((dt+1)/Ss),Nt>=Ot.length)if(Et){for(;Ot.length<=Nt;Ot.push(0));lt=zt=0,Pt=1,dt%=Ss,Je=dt-Ss+1}else break e;else{for(lt=pt=Ot[Nt],Pt=1;pt>=10;pt/=10,Pt++);dt%=Ss,Je=dt-Ss+Pt,zt=Je<0?0:Bh(lt/gi[Pt-Je-1]%10)}if(Et=Et||vt<0||Ot[Nt+1]!=null||(Je<0?lt:lt%gi[Pt-Je-1]),Et=mt<4?(zt||Et)&&(mt==0||mt==(it.s<0?3:2)):zt>5||zt==5&&(mt==4||Et||mt==6&&(dt>0?Je>0?lt/gi[Pt-Je]:0:Ot[Nt-1])%10&1||mt==(it.s<0?8:7)),vt<1||!Ot[0])return Ot.length=0,Et?(vt-=it.e+1,Ot[0]=gi[(Ss-vt%Ss)%Ss],it.e=-vt||0):Ot[0]=it.e=0,it;if(dt==0?(Ot.length=Nt,pt=1,Nt--):(Ot.length=Nt+1,pt=gi[Ss-dt],Ot[Nt]=Je>0?Bh(lt/gi[Pt-Je]%gi[Je])*pt:0),Et)for(;;)if(Nt==0){for(dt=1,Je=Ot[0];Je>=10;Je/=10,dt++);for(Je=Ot[0]+=pt,pt=1;Je>=10;Je/=10,pt++);dt!=pt&&(it.e++,Ot[0]==oA&&(Ot[0]=1));break}else{if(Ot[Nt]+=pt,Ot[Nt]!=oA)break;Ot[Nt--]=0,pt=1}for(dt=Ot.length;Ot[--dt]===0;Ot.pop());}it.e>ae?it.c=it.e=null:it.e<he&&(it.c=[it.e=0])}return it}function jt(it){var vt,mt=it.e;return mt===null?it.toString():(vt=Lh(it.c),vt=mt<=G||mt>=W?Jg(vt,mt):Xf(vt,mt,"0"),it.s<0?"-"+vt:vt)}return g.absoluteValue=g.abs=function(){var it=new ut(this);return it.s<0&&(it.s=1),it},g.comparedTo=function(it,vt){return Hd(this,new ut(it,vt))},g.decimalPlaces=g.dp=function(it,vt){var mt,Et,Pt,dt=this;if(it!=null)return Fl(it,0,Du),vt==null?vt=a:Fl(vt,0,8),Oe(new ut(dt),it+dt.e+1,vt);if(!(mt=dt.c))return null;if(Et=((Pt=mt.length-1)-zh(this.e/Ss))*Ss,Pt=mt[Pt])for(;Pt%10==0;Pt/=10,Et--);return Et<0&&(Et=0),Et},g.dividedBy=g.div=function(it,vt){return t(this,new ut(it,vt),S,a)},g.dividedToIntegerBy=g.idiv=function(it,vt){return t(this,new ut(it,vt),0,1)},g.exponentiatedBy=g.pow=function(it,vt){var mt,Et,Pt,dt,Je,pt,lt,Nt,zt,Ot=this;if(it=new ut(it),it.c&&!it.isInteger())throw Error(Vc+"Exponent not an integer: "+jt(it));if(vt!=null&&(vt=new ut(vt)),pt=it.e>14,!Ot.c||!Ot.c[0]||Ot.c[0]==1&&!Ot.e&&Ot.c.length==1||!it.c||!it.c[0])return zt=new ut(Math.pow(+jt(Ot),pt?it.s*(2-Kg(it)):+jt(it))),vt?zt.mod(vt):zt;if(lt=it.s<0,vt){if(vt.c?!vt.c[0]:!vt.s)return new ut(NaN);Et=!lt&&Ot.isInteger()&&vt.isInteger(),Et&&(Ot=Ot.mod(vt))}else{if(it.e>9&&(Ot.e>0||Ot.e<-1||(Ot.e==0?Ot.c[0]>1||pt&&Ot.c[1]>=24e7:Ot.c[0]<8e13||pt&&Ot.c[0]<=9999975e7)))return dt=Ot.s<0&&Kg(it)?-0:0,Ot.e>-1&&(dt=1/dt),new ut(lt?1/dt:dt);je&&(dt=hy(je/Ss+2))}for(pt?(mt=new ut(.5),lt&&(it.s=1),Nt=Kg(it)):(Pt=Math.abs(+jt(it)),Nt=Pt%2),zt=new ut(x);;){if(Nt){if(zt=zt.times(Ot),!zt.c)break;dt?zt.c.length>dt&&(zt.c.length=dt):Et&&(zt=zt.mod(vt))}if(Pt){if(Pt=Bh(Pt/2),Pt===0)break;Nt=Pt%2}else if(it=it.times(mt),Oe(it,it.e+1,1),it.e>14)Nt=Kg(it);else{if(Pt=+jt(it),Pt===0)break;Nt=Pt%2}Ot=Ot.times(Ot),dt?Ot.c&&Ot.c.length>dt&&(Ot.c.length=dt):Et&&(Ot=Ot.mod(vt))}return Et?zt:(lt&&(zt=x.div(zt)),vt?zt.mod(vt):dt?Oe(zt,je,a,Je):zt)},g.integerValue=function(it){var vt=new ut(this);return it==null?it=a:Fl(it,0,8),Oe(vt,vt.e+1,it)},g.isEqualTo=g.eq=function(it,vt){return Hd(this,new ut(it,vt))===0},g.isFinite=function(){return!!this.c},g.isGreaterThan=g.gt=function(it,vt){return Hd(this,new ut(it,vt))>0},g.isGreaterThanOrEqualTo=g.gte=function(it,vt){return(vt=Hd(this,new ut(it,vt)))===1||vt===0},g.isInteger=function(){return!!this.c&&zh(this.e/Ss)>this.c.length-2},g.isLessThan=g.lt=function(it,vt){return Hd(this,new ut(it,vt))<0},g.isLessThanOrEqualTo=g.lte=function(it,vt){return(vt=Hd(this,new ut(it,vt)))===-1||vt===0},g.isNaN=function(){return!this.s},g.isNegative=function(){return this.s<0},g.isPositive=function(){return this.s>0},g.isZero=function(){return!!this.c&&this.c[0]==0},g.minus=function(it,vt){var mt,Et,Pt,dt,Je=this,pt=Je.s;if(it=new ut(it,vt),vt=it.s,!pt||!vt)return new ut(NaN);if(pt!=vt)return it.s=-vt,Je.plus(it);var lt=Je.e/Ss,Nt=it.e/Ss,zt=Je.c,Ot=it.c;if(!lt||!Nt){if(!zt||!Ot)return zt?(it.s=-vt,it):new ut(Ot?Je:NaN);if(!zt[0]||!Ot[0])return Ot[0]?(it.s=-vt,it):new ut(zt[0]?Je:a==3?-0:0)}if(lt=zh(lt),Nt=zh(Nt),zt=zt.slice(),pt=lt-Nt){for((dt=pt<0)?(pt=-pt,Pt=zt):(Nt=lt,Pt=Ot),Pt.reverse(),vt=pt;vt--;Pt.push(0));Pt.reverse()}else for(Et=(dt=(pt=zt.length)<(vt=Ot.length))?pt:vt,pt=vt=0;vt<Et;vt++)if(zt[vt]!=Ot[vt]){dt=zt[vt]<Ot[vt];break}if(dt&&(Pt=zt,zt=Ot,Ot=Pt,it.s=-it.s),vt=(Et=Ot.length)-(mt=zt.length),vt>0)for(;vt--;zt[mt++]=0);for(vt=oA-1;Et>pt;){if(zt[--Et]<Ot[Et]){for(mt=Et;mt&&!zt[--mt];zt[mt]=vt);--zt[mt],zt[Et]+=oA}zt[Et]-=Ot[Et]}for(;zt[0]==0;zt.splice(0,1),--Nt);return zt[0]?Mt(it,zt,Nt):(it.s=a==3?-1:1,it.c=[it.e=0],it)},g.modulo=g.mod=function(it,vt){var mt,Et,Pt=this;return it=new ut(it,vt),!Pt.c||!it.s||it.c&&!it.c[0]?new ut(NaN):!it.c||Pt.c&&!Pt.c[0]?new ut(Pt):(be==9?(Et=it.s,it.s=1,mt=t(Pt,it,0,3),it.s=Et,mt.s*=Et):mt=t(Pt,it,0,be),it=Pt.minus(mt.times(it)),!it.c[0]&&be==1&&(it.s=Pt.s),it)},g.multipliedBy=g.times=function(it,vt){var mt,Et,Pt,dt,Je,pt,lt,Nt,zt,Ot,gi,wi,Ti,Ni,en,ji=this,Vi=ji.c,nn=(it=new ut(it,vt)).c;if(!Vi||!nn||!Vi[0]||!nn[0])return!ji.s||!it.s||Vi&&!Vi[0]&&!nn||nn&&!nn[0]&&!Vi?it.c=it.e=it.s=null:(it.s*=ji.s,!Vi||!nn?it.c=it.e=null:(it.c=[0],it.e=0)),it;for(Et=zh(ji.e/Ss)+zh(it.e/Ss),it.s*=ji.s,lt=Vi.length,Ot=nn.length,lt<Ot&&(Ti=Vi,Vi=nn,nn=Ti,Pt=lt,lt=Ot,Ot=Pt),Pt=lt+Ot,Ti=[];Pt--;Ti.push(0));for(Ni=oA,en=R0,Pt=Ot;--Pt>=0;){for(mt=0,gi=nn[Pt]%en,wi=nn[Pt]/en|0,Je=lt,dt=Pt+Je;dt>Pt;)Nt=Vi[--Je]%en,zt=Vi[Je]/en|0,pt=wi*Nt+zt*gi,Nt=gi*Nt+pt%en*en+Ti[dt]+mt,mt=(Nt/Ni|0)+(pt/en|0)+wi*zt,Ti[dt--]=Nt%Ni;Ti[dt]=mt}return mt?++Et:Ti.splice(0,1),Mt(it,Ti,Et)},g.negated=function(){var it=new ut(this);return it.s=-it.s||null,it},g.plus=function(it,vt){var mt,Et=this,Pt=Et.s;if(it=new ut(it,vt),vt=it.s,!Pt||!vt)return new ut(NaN);if(Pt!=vt)return it.s=-vt,Et.minus(it);var dt=Et.e/Ss,Je=it.e/Ss,pt=Et.c,lt=it.c;if(!dt||!Je){if(!pt||!lt)return new ut(Pt/0);if(!pt[0]||!lt[0])return lt[0]?it:new ut(pt[0]?Et:Pt*0)}if(dt=zh(dt),Je=zh(Je),pt=pt.slice(),Pt=dt-Je){for(Pt>0?(Je=dt,mt=lt):(Pt=-Pt,mt=pt),mt.reverse();Pt--;mt.push(0));mt.reverse()}for(Pt=pt.length,vt=lt.length,Pt-vt<0&&(mt=lt,lt=pt,pt=mt,vt=Pt),Pt=0;vt;)Pt=(pt[--vt]=pt[vt]+lt[vt]+Pt)/oA|0,pt[vt]=oA===pt[vt]?0:pt[vt]%oA;return Pt&&(pt=[Pt].concat(pt),++Je),Mt(it,pt,Je)},g.precision=g.sd=function(it,vt){var mt,Et,Pt,dt=this;if(it!=null&&it!==!!it)return Fl(it,1,Du),vt==null?vt=a:Fl(vt,0,8),Oe(new ut(dt),it,vt);if(!(mt=dt.c))return null;if(Pt=mt.length-1,Et=Pt*Ss+1,Pt=mt[Pt]){for(;Pt%10==0;Pt/=10,Et--);for(Pt=mt[0];Pt>=10;Pt/=10,Et++);}return it&&dt.e+1>Et&&(Et=dt.e+1),Et},g.shiftedBy=function(it){return Fl(it,-Ay,Ay),this.times("1e"+it)},g.squareRoot=g.sqrt=function(){var it,vt,mt,Et,Pt,dt=this,Je=dt.c,pt=dt.s,lt=dt.e,Nt=S+4,zt=new ut("0.5");if(pt!==1||!Je||!Je[0])return new ut(!pt||pt<0&&(!Je||Je[0])?NaN:Je?dt:1/0);if(pt=Math.sqrt(+jt(dt)),pt==0||pt==1/0?(vt=Lh(Je),(vt.length+lt)%2==0&&(vt+="0"),pt=Math.sqrt(+vt),lt=zh((lt+1)/2)-(lt<0||lt%2),pt==1/0?vt="5e"+lt:(vt=pt.toExponential(),vt=vt.slice(0,vt.indexOf("e")+1)+lt),mt=new ut(vt)):mt=new ut(pt+""),mt.c[0]){for(lt=mt.e,pt=lt+Nt,pt<3&&(pt=0);;)if(Pt=mt,mt=zt.times(Pt.plus(t(dt,Pt,Nt,1))),Lh(Pt.c).slice(0,pt)===(vt=Lh(mt.c)).slice(0,pt))if(mt.e<lt&&--pt,vt=vt.slice(pt-3,pt+1),vt=="9999"||!Et&&vt=="4999"){if(!Et&&(Oe(Pt,Pt.e+S+2,0),Pt.times(Pt).eq(dt))){mt=Pt;break}Nt+=4,pt+=4,Et=1}else{(!+vt||!+vt.slice(1)&&vt.charAt(0)=="5")&&(Oe(mt,mt.e+S+2,1),it=!mt.times(mt).eq(dt));break}}return Oe(mt,mt.e+S+1,a,it)},g.toExponential=function(it,vt){return it!=null&&(Fl(it,0,Du),it++),xt(this,it,vt,1)},g.toFixed=function(it,vt){return it!=null&&(Fl(it,0,Du),it=it+this.e+1),xt(this,it,vt)},g.toFormat=function(it,vt,mt){var Et,Pt=this;if(mt==null)it!=null&&vt&&typeof vt=="object"?(mt=vt,vt=null):it&&typeof it=="object"?(mt=it,it=vt=null):mt=nt;else if(typeof mt!="object")throw Error(Vc+"Argument not an object: "+mt);if(Et=Pt.toFixed(it,vt),Pt.c){var dt,Je=Et.split("."),pt=+mt.groupSize,lt=+mt.secondaryGroupSize,Nt=mt.groupSeparator||"",zt=Je[0],Ot=Je[1],gi=Pt.s<0,wi=gi?zt.slice(1):zt,Ti=wi.length;if(lt&&(dt=pt,pt=lt,lt=dt,Ti-=dt),pt>0&&Ti>0){for(dt=Ti%pt||pt,zt=wi.substr(0,dt);dt<Ti;dt+=pt)zt+=Nt+wi.substr(dt,pt);lt>0&&(zt+=Nt+wi.slice(dt)),gi&&(zt="-"+zt)}Et=Ot?zt+(mt.decimalSeparator||"")+((lt=+mt.fractionGroupSize)?Ot.replace(new RegExp("\\d{"+lt+"}\\B","g"),"$&"+(mt.fractionGroupSeparator||"")):Ot):zt}return(mt.prefix||"")+Et+(mt.suffix||"")},g.toFraction=function(it){var vt,mt,Et,Pt,dt,Je,pt,lt,Nt,zt,Ot,gi,wi=this,Ti=wi.c;if(it!=null&&(pt=new ut(it),!pt.isInteger()&&(pt.c||pt.s!==1)||pt.lt(x)))throw Error(Vc+"Argument "+(pt.isInteger()?"out of range: ":"not an integer: ")+jt(pt));if(!Ti)return new ut(wi);for(vt=new ut(x),Nt=mt=new ut(x),Et=lt=new ut(x),gi=Lh(Ti),dt=vt.e=gi.length-wi.e-1,vt.c[0]=fy[(Je=dt%Ss)<0?Ss+Je:Je],it=!it||pt.comparedTo(vt)>0?dt>0?vt:Nt:pt,Je=ae,ae=1/0,pt=new ut(gi),lt.c[0]=0;zt=t(pt,vt,0,1),Pt=mt.plus(zt.times(Et)),Pt.comparedTo(it)!=1;)mt=Et,Et=Pt,Nt=lt.plus(zt.times(Pt=Nt)),lt=Pt,vt=pt.minus(zt.times(Pt=vt)),pt=Pt;return Pt=t(it.minus(mt),Et,0,1),lt=lt.plus(Pt.times(Nt)),mt=mt.plus(Pt.times(Et)),lt.s=Nt.s=wi.s,dt=dt*2,Ot=t(Nt,Et,dt,a).minus(wi).abs().comparedTo(t(lt,mt,dt,a).minus(wi).abs())<1?[Nt,Et]:[lt,mt],ae=Je,Ot},g.toNumber=function(){return+jt(this)},g.toPrecision=function(it,vt){return it!=null&&Fl(it,1,Du),xt(this,it,vt,2)},g.toString=function(it){var vt,mt=this,Et=mt.s,Pt=mt.e;return Pt===null?Et?(vt="Infinity",Et<0&&(vt="-"+vt)):vt="NaN":(it==null?vt=Pt<=G||Pt>=W?Jg(Lh(mt.c),Pt):Xf(Lh(mt.c),Pt,"0"):it===10&&at?(mt=Oe(new ut(mt),S+Pt+1,a),vt=Xf(Lh(mt.c),mt.e,"0")):(Fl(it,2,tt.length,"Base"),vt=n(Xf(Lh(mt.c),Pt,"0"),10,it,Et,!0)),Et<0&&mt.c[0]&&(vt="-"+vt)),vt},g.valueOf=g.toJSON=function(){return jt(this)},g._isBigNumber=!0,g[Symbol.toStringTag]="BigNumber",g[Symbol.for("nodejs.util.inspect.custom")]=g.valueOf,e!=null&&ut.set(e),ut}function zh(e){var t=e|0;return e>0||e===t?t:t-1}function Lh(e){for(var t,n,c=1,g=e.length,x=e[0]+"";c<g;){for(t=e[c++]+"",n=Ss-t.length;n--;t="0"+t);x+=t}for(g=x.length;x.charCodeAt(--g)===48;);return x.slice(0,g+1||1)}function Hd(e,t){var n,c,g=e.c,x=t.c,S=e.s,a=t.s,G=e.e,W=t.e;if(!S||!a)return null;if(n=g&&!g[0],c=x&&!x[0],n||c)return n?c?0:-a:S;if(S!=a)return S;if(n=S<0,c=G==W,!g||!x)return c?0:!g^n?1:-1;if(!c)return G>W^n?1:-1;for(a=(G=g.length)<(W=x.length)?G:W,S=0;S<a;S++)if(g[S]!=x[S])return g[S]>x[S]^n?1:-1;return G==W?0:G>W^n?1:-1}function Fl(e,t,n,c){if(e<t||e>n||e!==Bh(e))throw Error(Vc+(c||"Argument")+(typeof e=="number"?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function Kg(e){var t=e.c.length-1;return zh(e.e/Ss)==t&&e.c[t]%2!=0}function Jg(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function Xf(e,t,n){var c,g;if(t<0){for(g=n+".";++t;g+=n);e=g+e}else if(c=e.length,++t>c){for(g=n,t-=c;--t;g+=n);e+=g}else t<c&&(e=e.slice(0,t)+"."+e.slice(t));return e}var XA=N5();class KV{constructor(t){Tr(this,"key");Tr(this,"left",null);Tr(this,"right",null);this.key=t}}class eg extends KV{constructor(t){super(t)}}class JV{constructor(){Tr(this,"size",0);Tr(this,"modificationCount",0);Tr(this,"splayCount",0)}splay(t){const n=this.root;if(n==null)return this.compare(t,t),-1;let c=null,g=null,x=null,S=null,a=n;const G=this.compare;let W;for(;;)if(W=G(a.key,t),W>0){let he=a.left;if(he==null||(W=G(he.key,t),W>0&&(a.left=he.right,he.right=a,a=he,he=a.left,he==null)))break;c==null?g=a:c.left=a,c=a,a=he}else if(W<0){let he=a.right;if(he==null||(W=G(he.key,t),W<0&&(a.right=he.left,he.left=a,a=he,he=a.right,he==null)))break;x==null?S=a:x.right=a,x=a,a=he}else break;return x!=null&&(x.right=a.left,a.left=S),c!=null&&(c.left=a.right,a.right=g),this.root!==a&&(this.root=a,this.splayCount++),W}splayMin(t){let n=t,c=n.left;for(;c!=null;){const g=c;n.left=g.right,g.right=n,n=g,c=n.left}return n}splayMax(t){let n=t,c=n.right;for(;c!=null;){const g=c;n.right=g.left,g.left=n,n=g,c=n.right}return n}_delete(t){if(this.root==null||this.splay(t)!=0)return null;let c=this.root;const g=c,x=c.left;if(this.size--,x==null)this.root=c.right;else{const S=c.right;c=this.splayMax(x),c.right=S,this.root=c}return this.modificationCount++,g}addNewRoot(t,n){this.size++,this.modificationCount++;const c=this.root;if(c==null){this.root=t;return}n<0?(t.left=c,t.right=c.right,c.right=null):(t.right=c,t.left=c.left,c.left=null),this.root=t}_first(){const t=this.root;return t==null?null:(this.root=this.splayMin(t),this.root)}_last(){const t=this.root;return t==null?null:(this.root=this.splayMax(t),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(t){return this.validKey(t)&&this.splay(t)==0}defaultCompare(){return(t,n)=>t<n?-1:t>n?1:0}wrap(){return{getRoot:()=>this.root,setRoot:t=>{this.root=t},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:t=>{this.splayCount=t},splay:t=>this.splay(t),has:t=>this.has(t)}}}var VU;const am=class am extends JV{constructor(n,c){super();Tr(this,"root",null);Tr(this,"compare");Tr(this,"validKey");Tr(this,VU,"[object Set]");this.compare=n??this.defaultCompare(),this.validKey=c??(g=>g!=null&&g!=null)}delete(n){return this.validKey(n)?this._delete(n)!=null:!1}deleteAll(n){for(const c of n)this.delete(c)}forEach(n){const c=this[Symbol.iterator]();let g;for(;g=c.next(),!g.done;)n(g.value,g.value,this)}add(n){const c=this.splay(n);return c!=0&&this.addNewRoot(new eg(n),c),this}addAndReturn(n){const c=this.splay(n);return c!=0&&this.addNewRoot(new eg(n),c),this.root.key}addAll(n){for(const c of n)this.add(c)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(n){if(n==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(n)<0)return this.root.key;let g=this.root.left;if(g==null)return null;let x=g.right;for(;x!=null;)g=x,x=g.right;return g.key}firstAfter(n){if(n==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(n)>0)return this.root.key;let g=this.root.right;if(g==null)return null;let x=g.left;for(;x!=null;)g=x,x=g.left;return g.key}retainAll(n){const c=new am(this.compare,this.validKey),g=this.modificationCount;for(const x of n){if(g!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(x)&&this.splay(x)==0&&c.add(this.root.key)}c.size!=this.size&&(this.root=c.root,this.size=c.size,this.modificationCount++)}lookup(n){return!this.validKey(n)||this.splay(n)!=0?null:this.root.key}intersection(n){const c=new am(this.compare,this.validKey);for(const g of this)n.has(g)&&c.add(g);return c}difference(n){const c=new am(this.compare,this.validKey);for(const g of this)n.has(g)||c.add(g);return c}union(n){const c=this.clone();return c.addAll(n),c}clone(){const n=new am(this.compare,this.validKey);return n.size=this.size,n.root=this.copyNode(this.root),n}copyNode(n){if(n==null)return null;function c(x,S){let a,G;do{if(a=x.left,G=x.right,a!=null){const W=new eg(a.key);S.left=W,c(a,W)}if(G!=null){const W=new eg(G.key);S.right=W,x=G,S=W}}while(G!=null)}const g=new eg(n.key);return c(n,g),g}toSet(){return this.clone()}entries(){return new tU(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[Symbol.iterator](){return new eU(this.wrap())}};VU=Symbol.toStringTag;let bm=am;class V5{constructor(t){Tr(this,"tree");Tr(this,"path",new Array);Tr(this,"modificationCount",null);Tr(this,"splayCount");this.tree=t,this.splayCount=t.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const t=this.path[this.path.length-1];return this.getValue(t)}rebuildPath(t){this.path.splice(0,this.path.length),this.tree.splay(t),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(t){for(;t!=null;)this.path.push(t),t=t.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let c=this.tree.getRoot();for(;c!=null;)this.path.push(c),c=c.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let t=this.path[this.path.length-1],n=t.right;if(n!=null){for(;n!=null;)this.path.push(n),n=n.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===t;)t=this.path.pop();return this.path.length>0}}class eU extends V5{getValue(t){return t.key}}class tU extends V5{getValue(t){return[t.key,t.key]}}const iU=e=>e,nU=e=>{if(e){const t=new bm(kv(e)),n=new bm(kv(e)),c=(x,S)=>S.addAndReturn(x),g=x=>({x:c(x.x,t),y:c(x.y,n)});return g({x:new XA(0),y:new XA(0)}),g}return iU},Mv=e=>({set:t=>{r0=Mv(t)},reset:()=>Mv(e),compare:kv(e),snap:nU(e),orient:XV(e)});let r0=Mv();const tg=(e,t)=>e.ll.x.isLessThanOrEqualTo(t.x)&&t.x.isLessThanOrEqualTo(e.ur.x)&&e.ll.y.isLessThanOrEqualTo(t.y)&&t.y.isLessThanOrEqualTo(e.ur.y),Pv=(e,t)=>{if(t.ur.x.isLessThan(e.ll.x)||e.ur.x.isLessThan(t.ll.x)||t.ur.y.isLessThan(e.ll.y)||e.ur.y.isLessThan(t.ll.y))return null;const n=e.ll.x.isLessThan(t.ll.x)?t.ll.x:e.ll.x,c=e.ur.x.isLessThan(t.ur.x)?e.ur.x:t.ur.x,g=e.ll.y.isLessThan(t.ll.y)?t.ll.y:e.ll.y,x=e.ur.y.isLessThan(t.ur.y)?e.ur.y:t.ur.y;return{ll:{x:n,y:g},ur:{x:c,y:x}}},d_=(e,t)=>e.x.times(t.y).minus(e.y.times(t.x)),U5=(e,t)=>e.x.times(t.x).plus(e.y.times(t.y)),$_=e=>U5(e,e).sqrt(),rU=(e,t,n)=>{const c={x:t.x.minus(e.x),y:t.y.minus(e.y)},g={x:n.x.minus(e.x),y:n.y.minus(e.y)};return d_(g,c).div($_(g)).div($_(c))},sU=(e,t,n)=>{const c={x:t.x.minus(e.x),y:t.y.minus(e.y)},g={x:n.x.minus(e.x),y:n.y.minus(e.y)};return U5(g,c).div($_(g)).div($_(c))},zw=(e,t,n)=>t.y.isZero()?null:{x:e.x.plus(t.x.div(t.y).times(n.minus(e.y))),y:n},Rw=(e,t,n)=>t.x.isZero()?null:{x:n,y:e.y.plus(t.y.div(t.x).times(n.minus(e.x)))},aU=(e,t,n,c)=>{if(t.x.isZero())return Rw(n,c,e.x);if(c.x.isZero())return Rw(e,t,n.x);if(t.y.isZero())return zw(n,c,e.y);if(c.y.isZero())return zw(e,t,n.y);const g=d_(t,c);if(g.isZero())return null;const x={x:n.x.minus(e.x),y:n.y.minus(e.y)},S=d_(x,t).div(g),a=d_(x,c).div(g),G=e.x.plus(a.times(t.x)),W=n.x.plus(S.times(c.x)),he=e.y.plus(a.times(t.y)),ae=n.y.plus(S.times(c.y)),ue=G.plus(W).div(2),be=he.plus(ae).div(2);return{x:ue,y:be}};class Fh{constructor(t,n){Tr(this,"point");Tr(this,"isLeft");Tr(this,"segment");Tr(this,"otherSE");Tr(this,"consumedBy");t.events===void 0?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=n}static compare(t,n){const c=Fh.comparePoints(t.point,n.point);return c!==0?c:(t.point!==n.point&&t.link(n),t.isLeft!==n.isLeft?t.isLeft?1:-1:F0.compare(t.segment,n.segment))}static comparePoints(t,n){return t.x.isLessThan(n.x)?-1:t.x.isGreaterThan(n.x)?1:t.y.isLessThan(n.y)?-1:t.y.isGreaterThan(n.y)?1:0}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const n=t.point.events;for(let c=0,g=n.length;c<g;c++){const x=n[c];this.point.events.push(x),x.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let n=0;n<t;n++){const c=this.point.events[n];if(c.segment.consumedBy===void 0)for(let g=n+1;g<t;g++){const x=this.point.events[g];x.consumedBy===void 0&&c.otherSE.point.events===x.otherSE.point.events&&c.segment.consume(x.segment)}}}getAvailableLinkedEvents(){const t=[];for(let n=0,c=this.point.events.length;n<c;n++){const g=this.point.events[n];g!==this&&!g.segment.ringOut&&g.segment.isInResult()&&t.push(g)}return t}getLeftmostComparator(t){const n=new Map,c=g=>{const x=g.otherSE;n.set(g,{sine:rU(this.point,t.point,x.point),cosine:sU(this.point,t.point,x.point)})};return(g,x)=>{n.has(g)||c(g),n.has(x)||c(x);const{sine:S,cosine:a}=n.get(g),{sine:G,cosine:W}=n.get(x);return S.isGreaterThanOrEqualTo(0)&&G.isGreaterThanOrEqualTo(0)?a.isLessThan(W)?1:a.isGreaterThan(W)?-1:0:S.isLessThan(0)&&G.isLessThan(0)?a.isLessThan(W)?-1:a.isGreaterThan(W)?1:0:G.isLessThan(S)?-1:G.isGreaterThan(S)?1:0}}}let oU=0;class F0{constructor(t,n,c,g){Tr(this,"id");Tr(this,"leftSE");Tr(this,"rightSE");Tr(this,"rings");Tr(this,"windings");Tr(this,"ringOut");Tr(this,"consumedBy");Tr(this,"prev");Tr(this,"_prevInResult");Tr(this,"_beforeState");Tr(this,"_afterState");Tr(this,"_isInResult");this.id=++oU,this.leftSE=t,t.segment=this,t.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=t,this.rings=c,this.windings=g}static compare(t,n){const c=t.leftSE.point.x,g=n.leftSE.point.x,x=t.rightSE.point.x,S=n.rightSE.point.x;if(S.isLessThan(c))return 1;if(x.isLessThan(g))return-1;const a=t.leftSE.point.y,G=n.leftSE.point.y,W=t.rightSE.point.y,he=n.rightSE.point.y;if(c.isLessThan(g)){if(G.isLessThan(a)&&G.isLessThan(W))return 1;if(G.isGreaterThan(a)&&G.isGreaterThan(W))return-1;const ae=t.comparePoint(n.leftSE.point);if(ae<0)return 1;if(ae>0)return-1;const ue=n.comparePoint(t.rightSE.point);return ue!==0?ue:-1}if(c.isGreaterThan(g)){if(a.isLessThan(G)&&a.isLessThan(he))return-1;if(a.isGreaterThan(G)&&a.isGreaterThan(he))return 1;const ae=n.comparePoint(t.leftSE.point);if(ae!==0)return ae;const ue=t.comparePoint(n.rightSE.point);return ue<0?1:ue>0?-1:1}if(a.isLessThan(G))return-1;if(a.isGreaterThan(G))return 1;if(x.isLessThan(S)){const ae=n.comparePoint(t.rightSE.point);if(ae!==0)return ae}if(x.isGreaterThan(S)){const ae=t.comparePoint(n.rightSE.point);if(ae<0)return 1;if(ae>0)return-1}if(!x.eq(S)){const ae=W.minus(a),ue=x.minus(c),be=he.minus(G),je=S.minus(g);if(ae.isGreaterThan(ue)&&be.isLessThan(je))return 1;if(ae.isLessThan(ue)&&be.isGreaterThan(je))return-1}return x.isGreaterThan(S)?1:x.isLessThan(S)||W.isLessThan(he)?-1:W.isGreaterThan(he)?1:t.id<n.id?-1:t.id>n.id?1:0}static fromRing(t,n,c){let g,x,S;const a=Fh.comparePoints(t,n);if(a<0)g=t,x=n,S=1;else if(a>0)g=n,x=t,S=-1;else throw new Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);const G=new Fh(g,!0),W=new Fh(x,!1);return new F0(G,W,[c],[S])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t.isLessThan(n)?t:n},ur:{x:this.rightSE.point.x,y:t.isGreaterThan(n)?t:n}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(t){return t.x.eq(this.leftSE.point.x)&&t.y.eq(this.leftSE.point.y)||t.x.eq(this.rightSE.point.x)&&t.y.eq(this.rightSE.point.y)}comparePoint(t){return r0.orient(this.leftSE.point,t,this.rightSE.point)}getIntersection(t){const n=this.bbox(),c=t.bbox(),g=Pv(n,c);if(g===null)return null;const x=this.leftSE.point,S=this.rightSE.point,a=t.leftSE.point,G=t.rightSE.point,W=tg(n,a)&&this.comparePoint(a)===0,he=tg(c,x)&&t.comparePoint(x)===0,ae=tg(n,G)&&this.comparePoint(G)===0,ue=tg(c,S)&&t.comparePoint(S)===0;if(he&&W)return ue&&!ae?S:!ue&&ae?G:null;if(he)return ae&&x.x.eq(G.x)&&x.y.eq(G.y)?null:x;if(W)return ue&&S.x.eq(a.x)&&S.y.eq(a.y)?null:a;if(ue&&ae)return null;if(ue)return S;if(ae)return G;const be=aU(x,this.vector(),a,t.vector());return be===null||!tg(g,be)?null:r0.snap(be)}split(t){const n=[],c=t.events!==void 0,g=new Fh(t,!0),x=new Fh(t,!1),S=this.rightSE;this.replaceRightSE(x),n.push(x),n.push(g);const a=new F0(g,S,this.rings.slice(),this.windings.slice());return Fh.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),Fh.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),c&&(g.checkForConsuming(),x.checkForConsuming()),n}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let n=0,c=this.windings.length;n<c;n++)this.windings[n]*=-1}consume(t){let n=this,c=t;for(;n.consumedBy;)n=n.consumedBy;for(;c.consumedBy;)c=c.consumedBy;const g=F0.compare(n,c);if(g!==0){if(g>0){const x=n;n=c,c=x}if(n.prev===c){const x=n;n=c,c=x}for(let x=0,S=c.rings.length;x<S;x++){const a=c.rings[x],G=c.windings[x],W=n.rings.indexOf(a);W===-1?(n.rings.push(a),n.windings.push(G)):n.windings[W]+=G}c.rings=null,c.windings=null,c.consumedBy=n,c.leftSE.consumedBy=n.leftSE,c.rightSE.consumedBy=n.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const n=this._afterState.rings,c=this._afterState.windings,g=this._afterState.multiPolys;for(let a=0,G=this.rings.length;a<G;a++){const W=this.rings[a],he=this.windings[a],ae=n.indexOf(W);ae===-1?(n.push(W),c.push(he)):c[ae]+=he}const x=[],S=[];for(let a=0,G=n.length;a<G;a++){if(c[a]===0)continue;const W=n[a],he=W.poly;if(S.indexOf(he)===-1)if(W.isExterior)x.push(he);else{S.indexOf(he)===-1&&S.push(he);const ae=x.indexOf(W.poly);ae!==-1&&x.splice(ae,1)}}for(let a=0,G=x.length;a<G;a++){const W=x[a].multiPoly;g.indexOf(W)===-1&&g.push(W)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const t=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(Dv.type){case"union":{const c=t.length===0,g=n.length===0;this._isInResult=c!==g;break}case"intersection":{let c,g;t.length<n.length?(c=t.length,g=n.length):(c=n.length,g=t.length),this._isInResult=g===Dv.numMultiPolys&&c<g;break}case"xor":{const c=Math.abs(t.length-n.length);this._isInResult=c%2===1;break}case"difference":{const c=g=>g.length===1&&g[0].isSubject;this._isInResult=c(t)!==c(n);break}}return this._isInResult}}class Fw{constructor(t,n,c){Tr(this,"poly");Tr(this,"isExterior");Tr(this,"segments");Tr(this,"bbox");if(!Array.isArray(t)||t.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=c,this.segments=[],typeof t[0][0]!="number"||typeof t[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const g=r0.snap({x:new XA(t[0][0]),y:new XA(t[0][1])});this.bbox={ll:{x:g.x,y:g.y},ur:{x:g.x,y:g.y}};let x=g;for(let S=1,a=t.length;S<a;S++){if(typeof t[S][0]!="number"||typeof t[S][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const G=r0.snap({x:new XA(t[S][0]),y:new XA(t[S][1])});G.x.eq(x.x)&&G.y.eq(x.y)||(this.segments.push(F0.fromRing(x,G,this)),G.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=G.x),G.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=G.y),G.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=G.x),G.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=G.y),x=G)}(!g.x.eq(x.x)||!g.y.eq(x.y))&&this.segments.push(F0.fromRing(x,g,this))}getSweepEvents(){const t=[];for(let n=0,c=this.segments.length;n<c;n++){const g=this.segments[n];t.push(g.leftSE),t.push(g.rightSE)}return t}}class lU{constructor(t,n){Tr(this,"multiPoly");Tr(this,"exteriorRing");Tr(this,"interiorRings");Tr(this,"bbox");if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Fw(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let c=1,g=t.length;c<g;c++){const x=new Fw(t[c],this,!1);x.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=x.bbox.ll.x),x.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=x.bbox.ll.y),x.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=x.bbox.ur.x),x.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=x.bbox.ur.y),this.interiorRings.push(x)}this.multiPoly=n}getSweepEvents(){const t=this.exteriorRing.getSweepEvents();for(let n=0,c=this.interiorRings.length;n<c;n++){const g=this.interiorRings[n].getSweepEvents();for(let x=0,S=g.length;x<S;x++)t.push(g[x])}return t}}class Ow{constructor(t,n){Tr(this,"isSubject");Tr(this,"polys");Tr(this,"bbox");if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof t[0][0][0]=="number"&&(t=[t])}catch{}this.polys=[],this.bbox={ll:{x:new XA(Number.POSITIVE_INFINITY),y:new XA(Number.POSITIVE_INFINITY)},ur:{x:new XA(Number.NEGATIVE_INFINITY),y:new XA(Number.NEGATIVE_INFINITY)}};for(let c=0,g=t.length;c<g;c++){const x=new lU(t[c],this);x.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=x.bbox.ll.x),x.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=x.bbox.ll.y),x.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=x.bbox.ur.x),x.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=x.bbox.ur.y),this.polys.push(x)}this.isSubject=n}getSweepEvents(){const t=[];for(let n=0,c=this.polys.length;n<c;n++){const g=this.polys[n].getSweepEvents();for(let x=0,S=g.length;x<S;x++)t.push(g[x])}return t}}class X_{constructor(t){Tr(this,"events");Tr(this,"poly");Tr(this,"_isExteriorRing");Tr(this,"_enclosingRing");this.events=t;for(let n=0,c=t.length;n<c;n++)t[n].segment.ringOut=this;this.poly=null}static factory(t){const n=[];for(let c=0,g=t.length;c<g;c++){const x=t[c];if(!x.isInResult()||x.ringOut)continue;let S=null,a=x.leftSE,G=x.rightSE;const W=[a],he=a.point,ae=[];for(;S=a,a=G,W.push(a),a.point!==he;)for(;;){const ue=a.getAvailableLinkedEvents();if(ue.length===0){const nt=W[0].point,tt=W[W.length-1].point;throw new Error(`Unable to complete output ring starting at [${nt.x}, ${nt.y}]. Last matching segment found ends at [${tt.x}, ${tt.y}].`)}if(ue.length===1){G=ue[0].otherSE;break}let be=null;for(let nt=0,tt=ae.length;nt<tt;nt++)if(ae[nt].point===a.point){be=nt;break}if(be!==null){const nt=ae.splice(be)[0],tt=W.splice(nt.index);tt.unshift(tt[0].otherSE),n.push(new X_(tt.reverse()));continue}ae.push({index:W.length,point:a.point});const je=a.getLeftmostComparator(S);G=ue.sort(je)[0].otherSE;break}n.push(new X_(W))}return n}getGeom(){let t=this.events[0].point;const n=[t];for(let W=1,he=this.events.length-1;W<he;W++){const ae=this.events[W].point,ue=this.events[W+1].point;r0.orient(ae,t,ue)!==0&&(n.push(ae),t=ae)}if(n.length===1)return null;const c=n[0],g=n[1];r0.orient(c,t,g)===0&&n.shift(),n.push(n[0]);const x=this.isExteriorRing()?1:-1,S=this.isExteriorRing()?0:n.length-1,a=this.isExteriorRing()?n.length:-1,G=[];for(let W=S;W!=a;W+=x)G.push([n[W].x.toNumber(),n[W].y.toNumber()]);return G}isExteriorRing(){if(this._isExteriorRing===void 0){const t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var g,x;let t=this.events[0];for(let S=1,a=this.events.length;S<a;S++){const G=this.events[S];Fh.compare(t,G)>0&&(t=G)}let n=t.segment.prevInResult(),c=n?n.prevInResult():null;for(;;){if(!n)return null;if(!c)return n.ringOut;if(c.ringOut!==n.ringOut)return((g=c.ringOut)==null?void 0:g.enclosingRing())!==n.ringOut?n.ringOut:(x=n.ringOut)==null?void 0:x.enclosingRing();n=c.prevInResult(),c=n?n.prevInResult():null}}}class Nw{constructor(t){Tr(this,"exteriorRing");Tr(this,"interiorRings");this.exteriorRing=t,t.poly=this,this.interiorRings=[]}addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){const t=[this.exteriorRing.getGeom()];if(t[0]===null)return null;for(let n=0,c=this.interiorRings.length;n<c;n++){const g=this.interiorRings[n].getGeom();g!==null&&t.push(g)}return t}}class uU{constructor(t){Tr(this,"rings");Tr(this,"polys");this.rings=t,this.polys=this._composePolys(t)}getGeom(){const t=[];for(let n=0,c=this.polys.length;n<c;n++){const g=this.polys[n].getGeom();g!==null&&t.push(g)}return t}_composePolys(t){var c;const n=[];for(let g=0,x=t.length;g<x;g++){const S=t[g];if(!S.poly)if(S.isExteriorRing())n.push(new Nw(S));else{const a=S.enclosingRing();a!=null&&a.poly||n.push(new Nw(a)),(c=a==null?void 0:a.poly)==null||c.addInterior(S)}}return n}}class cU{constructor(t,n=F0.compare){Tr(this,"queue");Tr(this,"tree");Tr(this,"segments");this.queue=t,this.tree=new bm(n),this.segments=[]}process(t){const n=t.segment,c=[];if(t.consumedBy)return t.isLeft?this.queue.delete(t.otherSE):this.tree.delete(n),c;t.isLeft&&this.tree.add(n);let g=n,x=n;do g=this.tree.lastBefore(g);while(g!=null&&g.consumedBy!=null);do x=this.tree.firstAfter(x);while(x!=null&&x.consumedBy!=null);if(t.isLeft){let S=null;if(g){const G=g.getIntersection(n);if(G!==null&&(n.isAnEndpoint(G)||(S=G),!g.isAnEndpoint(G))){const W=this._splitSafely(g,G);for(let he=0,ae=W.length;he<ae;he++)c.push(W[he])}}let a=null;if(x){const G=x.getIntersection(n);if(G!==null&&(n.isAnEndpoint(G)||(a=G),!x.isAnEndpoint(G))){const W=this._splitSafely(x,G);for(let he=0,ae=W.length;he<ae;he++)c.push(W[he])}}if(S!==null||a!==null){let G=null;S===null?G=a:a===null?G=S:G=Fh.comparePoints(S,a)<=0?S:a,this.queue.delete(n.rightSE),c.push(n.rightSE);const W=n.split(G);for(let he=0,ae=W.length;he<ae;he++)c.push(W[he])}c.length>0?(this.tree.delete(n),c.push(t)):(this.segments.push(n),n.prev=g)}else{if(g&&x){const S=g.getIntersection(x);if(S!==null){if(!g.isAnEndpoint(S)){const a=this._splitSafely(g,S);for(let G=0,W=a.length;G<W;G++)c.push(a[G])}if(!x.isAnEndpoint(S)){const a=this._splitSafely(x,S);for(let G=0,W=a.length;G<W;G++)c.push(a[G])}}}this.tree.delete(n)}return c}_splitSafely(t,n){this.tree.delete(t);const c=t.rightSE;this.queue.delete(c);const g=t.split(n);return g.push(c),t.consumedBy===void 0&&this.tree.add(t),g}}class hU{constructor(){Tr(this,"type");Tr(this,"numMultiPolys")}run(t,n,c){ug.type=t;const g=[new Ow(n,!0)];for(let he=0,ae=c.length;he<ae;he++)g.push(new Ow(c[he],!1));if(ug.numMultiPolys=g.length,ug.type==="difference"){const he=g[0];let ae=1;for(;ae<g.length;)Pv(g[ae].bbox,he.bbox)!==null?ae++:g.splice(ae,1)}if(ug.type==="intersection")for(let he=0,ae=g.length;he<ae;he++){const ue=g[he];for(let be=he+1,je=g.length;be<je;be++)if(Pv(ue.bbox,g[be].bbox)===null)return[]}const x=new bm(Fh.compare);for(let he=0,ae=g.length;he<ae;he++){const ue=g[he].getSweepEvents();for(let be=0,je=ue.length;be<je;be++)x.add(ue[be])}const S=new cU(x);let a=null;for(x.size!=0&&(a=x.first(),x.delete(a));a;){const he=S.process(a);for(let ae=0,ue=he.length;ae<ue;ae++){const be=he[ae];be.consumedBy===void 0&&x.add(be)}x.size!=0?(a=x.first(),x.delete(a)):a=null}r0.reset();const G=X_.factory(S.segments);return new uU(G).getGeom()}}const ug=new hU,Dv=ug,AU=(e,...t)=>Dv.run("intersection",e,t);r0.set;var fU={exports:{}},dy,Vw;function dU(){return Vw||(Vw=1,dy=function(t){return function n(c){return arguments.length===0||c!=null&&c["@@functional/placeholder"]===!0?n:t.apply(this,arguments)}}),dy}var py,Uw;function pU(){if(Uw)return py;Uw=1;var e=dU();return py=e(function(n){return n===null?"Null":n===void 0?"Undefined":Object.prototype.toString.call(n).slice(8,-1)}),py}var my,Gw;function D2(){if(Gw)return my;Gw=1;function e(t){var n=typeof t;return!!t&&(n=="object"||n=="function")}return my=e,my}var gy,qw;function mU(){if(qw)return gy;qw=1;var e=D2();function t(n){return e(n)?n:Object(n)}return gy=t,gy}var _y,Hw;function gU(){if(Hw)return _y;Hw=1;var e=mU();function t(n){return function(c,g,x){for(var S=e(c),a=x(c),G=a.length,W=n?G:-1;n?W--:++W<G;){var he=a[W];if(g(S[he],he,S)===!1)break}return c}}return _y=t,_y}var yy,jw;function _U(){if(jw)return yy;jw=1;var e=gU(),t=e();return yy=t,yy}var vy,Zw;function yU(){if(Zw)return vy;Zw=1;function e(t){return function(n){return n==null?void 0:n[t]}}return vy=e,vy}var xy,Qw;function vU(){if(Qw)return xy;Qw=1;var e=yU(),t=e("length");return xy=t,xy}var by,Ww;function L2(){if(Ww)return by;Ww=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return by=t,by}var wy,$w;function xU(){if($w)return wy;$w=1;var e=vU(),t=L2();function n(c){return c!=null&&t(e(c))}return wy=n,wy}var Sy,Xw;function x1(){if(Xw)return Sy;Xw=1;function e(t){return!!t&&typeof t=="object"}return Sy=e,Sy}var Iy,Yw;function G5(){if(Yw)return Iy;Yw=1;var e=xU(),t=x1(),n=Object.prototype,c=n.hasOwnProperty,g=n.propertyIsEnumerable;function x(S){return t(S)&&e(S)&&c.call(S,"callee")&&!g.call(S,"callee")}return Iy=x,Iy}var Ey,Kw;function bU(){if(Kw)return Ey;Kw=1;var e=D2(),t="[object Function]",n=Object.prototype,c=n.toString;function g(x){return e(x)&&c.call(x)==t}return Ey=g,Ey}var Cy,Jw;function wU(){if(Jw)return Cy;Jw=1;var e=bU(),t=x1(),n=/^\[object .+?Constructor\]$/,c=Object.prototype,g=Function.prototype.toString,x=c.hasOwnProperty,S=RegExp("^"+g.call(x).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function a(G){return G==null?!1:e(G)?S.test(g.call(G)):t(G)&&n.test(G)}return Cy=a,Cy}var Ty,e3;function SU(){if(e3)return Ty;e3=1;var e=wU();function t(n,c){var g=n==null?void 0:n[c];return e(g)?g:void 0}return Ty=t,Ty}var ky,t3;function IU(){if(t3)return ky;t3=1;var e=SU(),t=L2(),n=x1(),c="[object Array]",g=Object.prototype,x=g.toString,S=e(Array,"isArray"),a=S||function(G){return n(G)&&t(G.length)&&x.call(G)==c};return ky=a,ky}var My,i3;function EU(){if(i3)return My;i3=1;var e=/^\d+$/,t=9007199254740991;function n(c,g){return c=typeof c=="number"||e.test(c)?+c:-1,g=g??t,c>-1&&c%1==0&&c<g}return My=n,My}var Py,n3;function CU(){if(n3)return Py;n3=1;var e=G5(),t=IU(),n=EU(),c=L2(),g=D2(),x=Object.prototype,S=x.hasOwnProperty;function a(G){if(G==null)return[];g(G)||(G=Object(G));var W=G.length;W=W&&c(W)&&(t(G)||e(G))&&W||0;for(var he=G.constructor,ae=-1,ue=typeof he=="function"&&he.prototype===G,be=Array(W),je=W>0;++ae<W;)be[ae]=ae+"";for(var nt in G)!(je&&n(nt,W))&&!(nt=="constructor"&&(ue||!S.call(G,nt)))&&be.push(nt);return be}return Py=a,Py}var Dy,r3;function TU(){if(r3)return Dy;r3=1;var e=_U(),t=CU();function n(c,g){return e(c,g,t)}return Dy=n,Dy}var Ly,s3;function kU(){if(s3)return Ly;s3=1;var e=TU(),t=G5(),n=x1(),c="[object Object]",g=Object.prototype,x=g.hasOwnProperty,S=g.toString;function a(G){var W;if(!(n(G)&&S.call(G)==c&&!t(G))||!x.call(G,"constructor")&&(W=G.constructor,typeof W=="function"&&!(W instanceof W)))return!1;var he;return e(G,function(ae,ue){he=ue}),he===void 0||x.call(G,he)}return Ly=a,Ly}(function(e){e.exports=function(t){var n={};function c(g){if(n[g])return n[g].exports;var x=n[g]={exports:{},id:g,loaded:!1};return t[g].call(x.exports,x,x.exports,c),x.loaded=!0,x.exports}return c.m=t,c.c=n,c.p="/lib/",c(0)}([function(t,n,c){t.exports=c(1)},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.union=c(2).default,n.any=c(12).default,n.nil=c(14).default,n.mapOf=c(16).default,n.arrayOf=c(18).default,n.record=c(20).default,n.optional=c(23).default,n.validate=c(25).default,n.deferred=c(26).default,n.createValidator=c(4).default,n.isValid=c(28).default},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(3),x=S(g);function S(G){return G&&G.__esModule?G:{default:G}}function a(){for(var G=arguments.length,W=Array(G),he=0;he<G;he++)W[he]=arguments[he];return new x.default(W)}},function(t,n,c){var g=function(){function he(ae,ue){for(var be=0;be<ue.length;be++){var je=ue[be];je.enumerable=je.enumerable||!1,je.configurable=!0,"value"in je&&(je.writable=!0),Object.defineProperty(ae,je.key,je)}}return function(ae,ue,be){return ue&&he(ae.prototype,ue),be&&he(ae,be),ae}}();Object.defineProperty(n,"__esModule",{value:!0});var x=c(4),S=a(x);c(5),c(6);function a(he){return he&&he.__esModule?he:{default:he}}function G(he,ae){if(!(he instanceof ae))throw new TypeError("Cannot call a class as a function")}var W=function(){function he(ae){G(this,he),this.validators=[];var ue=!0,be=!1,je=void 0;try{for(var nt=ae[Symbol.iterator](),tt;!(ue=(tt=nt.next()).done);ue=!0){var at=tt.value;this.validators.push((0,S.default)(at))}}catch(ut){be=!0,je=ut}finally{try{!ue&&nt.return&&nt.return()}finally{if(be)throw je}}}return g(he,[{key:"isValid",value:function(ue){var be=!0,je=!1,nt=void 0;try{for(var tt=this.validators[Symbol.iterator](),at;!(be=(at=tt.next()).done);be=!0){var ut=at.value;if(ut.isValid(ue))return!0}}catch(xt){je=!0,nt=xt}finally{try{!be&&tt.return&&tt.return()}finally{if(je)throw nt}}return!1}},{key:"getValidationResult",value:function(ue){if(this.isValid(ue))return{isValid:"true"};var be=this._getValidationDetails(ue);return{isValid:"false",message:`Value doesn't match any of the expected variants.
Value: `+JSON.stringify(ue)+`
Details: 
`+be.message,score:be.score}}},{key:"_getValidationDetails",value:function(ue){var be=[],je=!0,nt=!1,tt=void 0;try{for(var at=this.validators[Symbol.iterator](),ut;!(je=(ut=at.next()).done);je=!0){var xt=ut.value;be.push(xt.getValidationResult(ue))}}catch(Mt){nt=!0,tt=Mt}finally{try{!je&&at.return&&at.return()}finally{if(nt)throw tt}}be.sort(function(Mt,Oe){return Mt.score<Oe.score?1:Mt.score>Oe.score?-1:0}),be.length>3&&(be.length=3);var Tt=be.map(function(Mt){return Mt.message}).join(`
`);return{message:Tt,score:be[0].score}}}]),he}();n.default=W},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=nt,c(5);var g=c(7),x=be(g),S=c(9),a=be(S),G=c(10),W=be(G),he=c(3);be(he);var ae=c(11),ue=be(ae);function be(tt){return tt&&tt.__esModule?tt:{default:tt}}function je(tt){return tt&&typeof Symbol<"u"&&tt.constructor===Symbol?"symbol":typeof tt}function nt(tt){if(tt==null)throw Error("Null cannot be a valid validation descriptor");if(tt===String)return x.default;if(tt===Number)return a.default;if(tt===Boolean)return W.default;if((typeof tt>"u"?"undefined":je(tt))==="object"&&tt&&typeof tt.isValid=="function"&&typeof tt.getValidationResult=="function")return tt;if(typeof tt=="string"||typeof tt=="number"||typeof tt=="boolean")return new ue.default(tt);throw new Error("Can't recognize this descriptor: "+tt)}},function(t,n,c){c(6)},function(t,n){},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),x=S(g);c(6),c(5);function S(G){return G&&G.__esModule?G:{default:G}}var a={isValid:function(W){return typeof W=="string"},getValidationResult:function(W){return a.isValid(W)?{isValid:"true"}:{isValid:"false",message:"String expected, "+(0,x.default)(W)+" given.",score:0}}};n.default=a},function(t,n){t.exports=pU()},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),x=S(g);c(6),c(5);function S(G){return G&&G.__esModule?G:{default:G}}var a={isValid:function(W){return typeof W=="number"},getValidationResult:function(W){return a.isValid(W)?{isValid:"true"}:{isValid:"false",message:"Number expected. '"+(0,x.default)(W)+"' given.",score:0}}};n.default=a},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),x=S(g);c(6),c(5);function S(G){return G&&G.__esModule?G:{default:G}}var a={isValid:function(W){return typeof W=="boolean"},getValidationResult:function(W){return a.isValid(W)?{isValid:"true"}:{isValid:"false",message:"Boolean expected. "+(0,x.default)(W)+" given.",score:0}}};n.default=a},function(t,n,c){var g=function(){function W(he,ae){for(var ue=0;ue<ae.length;ue++){var be=ae[ue];be.enumerable=be.enumerable||!1,be.configurable=!0,"value"in be&&(be.writable=!0),Object.defineProperty(he,be.key,be)}}return function(he,ae,ue){return ae&&W(he.prototype,ae),ue&&W(he,ue),he}}();Object.defineProperty(n,"__esModule",{value:!0});var x=c(4);S(x),c(5),c(6);function S(W){return W&&W.__esModule?W:{default:W}}function a(W,he){if(!(W instanceof he))throw new TypeError("Cannot call a class as a function")}var G=function(){function W(he){a(this,W),this.expectedValue=he}return g(W,[{key:"isValid",value:function(ae){return ae===this.expectedValue}},{key:"getValidationResult",value:function(ae){return this.isValid(ae)?{isValid:"true"}:{isValid:"false",message:"Expected: "+JSON.stringify(this.expectedValue)+". Given: "+ae,score:0}}}]),W}();n.default=G},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(13),x=S(g);function S(a){return a&&a.__esModule?a:{default:a}}n.default=x.default},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8);x(g),c(6),c(5);function x(a){return a&&a.__esModule?a:{default:a}}var S={isValid:function(G){return!0},getValidationResult:function(G){return{isValid:"true"}}};n.default=S},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(15),x=S(g);function S(a){return a&&a.__esModule?a:{default:a}}n.default=x.default},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),x=S(g);c(6),c(5);function S(G){return G&&G.__esModule?G:{default:G}}var a={isValid:function(W){return W==null},getValidationResult:function(W){return a.isValid(W)?{isValid:"true"}:{isValid:"false",message:"Null expected. "+(0,x.default)(W)+" given.",score:0}}};n.default=a},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(17),x=S(g);function S(G){return G&&G.__esModule?G:{default:G}}function a(G){return new x.default(G)}},function(t,n,c){var g=function(){function be(je,nt){for(var tt=0;tt<nt.length;tt++){var at=nt[tt];at.enumerable=at.enumerable||!1,at.configurable=!0,"value"in at&&(at.writable=!0),Object.defineProperty(je,at.key,at)}}return function(je,nt,tt){return nt&&be(je.prototype,nt),tt&&be(je,tt),je}}();Object.defineProperty(n,"__esModule",{value:!0});var x=c(8),S=W(x),a=c(4),G=W(a);c(6),c(5);function W(be){return be&&be.__esModule?be:{default:be}}function he(be,je){if(!(be instanceof je))throw new TypeError("Cannot call a class as a function")}function ae(be){return be&&typeof Symbol<"u"&&be.constructor===Symbol?"symbol":typeof be}var ue=function(){function be(je){he(this,be),this.validator=(0,G.default)(je)}return g(be,[{key:"isValid",value:function(nt){if(!((typeof nt>"u"?"undefined":ae(nt))==="object"&&nt))return!1;var tt=Object.keys(nt),at=!0,ut=!1,xt=void 0;try{for(var Tt=tt[Symbol.iterator](),Mt;!(at=(Mt=Tt.next()).done);at=!0){var Oe=Mt.value,jt=nt[Oe];if(this.validator.isValid(jt)===!1)return!1}}catch(it){ut=!0,xt=it}finally{try{!at&&Tt.return&&Tt.return()}finally{if(ut)throw xt}}return!0}},{key:"getValidationResult",value:function(nt){if(!((typeof nt>"u"?"undefined":ae(nt))==="object"&&nt))return{isValid:"false",message:"Object expected. "+(0,S.default)(nt)+" given.",score:0};var tt=Object.keys(nt),at=!0,ut=!1,xt=void 0;try{for(var Tt=tt[Symbol.iterator](),Mt;!(at=(Mt=Tt.next()).done);at=!0){var Oe=Mt.value,jt=nt[Oe],it=this.validator.getValidationResult(jt);if(it.isValid==="false")return{isValid:"false",message:"Validation failed for key '"+Oe+"': "+it.message,score:1}}}catch(vt){ut=!0,xt=vt}finally{try{!at&&Tt.return&&Tt.return()}finally{if(ut)throw xt}}return{isValid:"true"}}}]),be}();n.default=ue},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(19),x=S(g);function S(G){return G&&G.__esModule?G:{default:G}}function a(G){return new x.default(G)}},function(t,n,c){var g=function(){function ue(be,je){for(var nt=0;nt<je.length;nt++){var tt=je[nt];tt.enumerable=tt.enumerable||!1,tt.configurable=!0,"value"in tt&&(tt.writable=!0),Object.defineProperty(be,tt.key,tt)}}return function(be,je,nt){return je&&ue(be.prototype,je),nt&&ue(be,nt),be}}();Object.defineProperty(n,"__esModule",{value:!0});var x=c(8),S=W(x),a=c(4),G=W(a);c(6),c(5);function W(ue){return ue&&ue.__esModule?ue:{default:ue}}function he(ue,be){if(!(ue instanceof be))throw new TypeError("Cannot call a class as a function")}var ae=function(){function ue(be){he(this,ue),this.validator=(0,G.default)(be)}return g(ue,[{key:"isValid",value:function(je){if(!Array.isArray(je))return!1;var nt=!0,tt=!1,at=void 0;try{for(var ut=je[Symbol.iterator](),xt;!(nt=(xt=ut.next()).done);nt=!0){var Tt=xt.value;if(this.validator.isValid(Tt)===!1)return!1}}catch(Mt){tt=!0,at=Mt}finally{try{!nt&&ut.return&&ut.return()}finally{if(tt)throw at}}return!0}},{key:"getValidationResult",value:function(je){if(!Array.isArray(je))return{isValid:"false",message:"Array expected. "+(0,S.default)(je)+" given.",score:0};for(var nt=0;nt<je.length;nt++){var tt=je[nt],at=this.validator.getValidationResult(tt);if(at.isValid==="false")return{isValid:"false",message:"Validation failed on item #"+nt+": "+at.message,score:1}}return{isValid:"true"}}}]),ue}();n.default=ae},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(21),x=S(g);function S(G){return G&&G.__esModule?G:{default:G}}function a(G){return new x.default(G)}},function(t,n,c){var g=function(){function nt(tt,at){for(var ut=0;ut<at.length;ut++){var xt=at[ut];xt.enumerable=xt.enumerable||!1,xt.configurable=!0,"value"in xt&&(xt.writable=!0),Object.defineProperty(tt,xt.key,xt)}}return function(tt,at,ut){return at&&nt(tt.prototype,at),ut&&nt(tt,ut),tt}}();Object.defineProperty(n,"__esModule",{value:!0});var x=c(8),S=ae(x),a=c(22),G=ae(a),W=c(4),he=ae(W);c(5),c(6);function ae(nt){return nt&&nt.__esModule?nt:{default:nt}}function ue(nt,tt){if(!(nt instanceof tt))throw new TypeError("Cannot call a class as a function")}function be(nt){return nt&&typeof Symbol<"u"&&nt.constructor===Symbol?"symbol":typeof nt}var je=function(){function nt(tt){if(ue(this,nt),!((typeof tt>"u"?"undefined":be(tt))==="object"&&tt&&(0,G.default)(tt)))throw Error("A record must be defined by an object.");this.shape={};var at=!0,ut=!1,xt=void 0;try{for(var Tt=Object.getOwnPropertyNames(tt)[Symbol.iterator](),Mt;!(at=(Mt=Tt.next()).done);at=!0){var Oe=Mt.value;try{this.shape[Oe]=(0,he.default)(tt[Oe])}catch(vt){var jt=Oe,it=vt.stack;throw vt.originalStack?(it=vt.originalStack,jt+="."+vt.propertyName,vt.propertyName=jt):vt.originalStack=vt.stack,vt.stack="Error defining prop '"+jt+"': "+vt.originalStack,vt}}}catch(vt){ut=!0,xt=vt}finally{try{!at&&Tt.return&&Tt.return()}finally{if(ut)throw xt}}}return g(nt,[{key:"isValid",value:function(at){if(!((typeof at>"u"?"undefined":be(at))==="object"&&at))return!1;var ut=!0,xt=!1,Tt=void 0;try{for(var Mt=Object.keys(this.shape)[Symbol.iterator](),Oe;!(ut=(Oe=Mt.next()).done);ut=!0){var jt=Oe.value,it=this.shape[jt];if(it.isValid(at[jt])===!1)return!1}}catch(vt){xt=!0,Tt=vt}finally{try{!ut&&Mt.return&&Mt.return()}finally{if(xt)throw Tt}}return!0}},{key:"getValidationResult",value:function(at){if(!((typeof at>"u"?"undefined":be(at))==="object"&&at))return{isValid:"false",message:"Object expected, "+(0,S.default)(at)+" given.",score:0};var ut=0,xt=!0,Tt=!1,Mt=void 0;try{for(var Oe=Object.keys(this.shape)[Symbol.iterator](),jt;!(xt=(jt=Oe.next()).done);xt=!0){var it=jt.value,vt=this.shape[it],mt=vt.getValidationResult(at[it]);if(mt.isValid==="false")return{isValid:"false",message:"Error validating prop "+it+`:
 `+mt.message,score:1+ut};ut++}}catch(Et){Tt=!0,Mt=Et}finally{try{!xt&&Oe.return&&Oe.return()}finally{if(Tt)throw Mt}}return{isValid:"true"}}}]),nt}();n.default=je},function(t,n){t.exports=kU()},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(24),x=S(g);function S(G){return G&&G.__esModule?G:{default:G}}function a(G){return new x.default(G)}},function(t,n,c){var g=function(){function he(ae,ue){for(var be=0;be<ue.length;be++){var je=ue[be];je.enumerable=je.enumerable||!1,je.configurable=!0,"value"in je&&(je.writable=!0),Object.defineProperty(ae,je.key,je)}}return function(ae,ue,be){return ue&&he(ae.prototype,ue),be&&he(ae,be),ae}}();Object.defineProperty(n,"__esModule",{value:!0});var x=c(4),S=a(x);c(6),c(5);function a(he){return he&&he.__esModule?he:{default:he}}function G(he,ae){if(!(he instanceof ae))throw new TypeError("Cannot call a class as a function")}var W=function(){function he(ae){G(this,he),this.validator=(0,S.default)(ae)}return g(he,[{key:"isValid",value:function(ue){return ue?this.validator.isValid(ue):!0}},{key:"getValidationResult",value:function(ue){return ue?this.validator.getValidationResult(ue):{isValid:"true"}}}]),he}();n.default=W},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(4),x=S(g);function S(G){return G&&G.__esModule?G:{default:G}}function a(G,W){var he=(0,x.default)(G),ae=he.getValidationResult(W);if(ae.isValid==="false")throw Error(ae.message);return W}},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(27),x=S(g);function S(G){return G&&G.__esModule?G:{default:G}}function a(G){return new x.default(G)}},function(t,n,c){var g=function(){function ae(ue,be){for(var je=0;je<be.length;je++){var nt=be[je];nt.enumerable=nt.enumerable||!1,nt.configurable=!0,"value"in nt&&(nt.writable=!0),Object.defineProperty(ue,nt.key,nt)}}return function(ue,be,je){return be&&ae(ue.prototype,be),je&&ae(ue,je),ue}}();Object.defineProperty(n,"__esModule",{value:!0});var x=c(8),S=G(x),a=c(4);G(a),c(6),c(5);function G(ae){return ae&&ae.__esModule?ae:{default:ae}}function W(ae,ue){if(!(ae instanceof ue))throw new TypeError("Cannot call a class as a function")}var he=function(){function ae(ue){if(W(this,ae),typeof ue!="function")throw Error("Deferred validator only accepts a function. "+(0,S.default)(ue)+" given");this.deferredValidator=ue}return g(ae,[{key:"isValid",value:function(be){return this._getValidator().isValid(be)}},{key:"getValidationResult",value:function(be){return this._getValidator().getValidationResult(be)}},{key:"_getValidator",value:function(){return this.validator||(this.validator=this.deferredValidator()),this.validator}}]),ae}();n.default=he},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(4),x=S(g);function S(G){return G&&G.__esModule?G:{default:G}}function a(G,W){var he=(0,x.default)(G);return he.isValid(W)}}])})(fU);async function MU(e,t){var W;let n={pd:Number.MIN_VALUE,mpd:Number.MIN_VALUE,mntd:Number.MIN_VALUE,tree_sizes:Number.MIN_VALUE,rel_pd:1,rel_mpd:Number.MIN_VALUE,rel_mntd:Number.MIN_VALUE},c={pd:Number.MAX_VALUE,mpd:Number.MAX_VALUE,mntd:Number.MAX_VALUE,tree_sizes:Number.MAX_VALUE,rel_pd:0,rel_mpd:Number.MAX_VALUE,rel_mntd:Number.MAX_VALUE},g=await fetch("/phast/data/range_hex_data_statistics.json").then(he=>he.json()),x=await fetch("/phast/data/Plants_trees.json").then(he=>he.json());x=PU(x),console.log(g);let S=e.geometry.coordinates,a=[];for(let he of S){let ae={type:"Feature",properties:{pd:-1,mpd:-1,mntd:-1,tree_sizes:0,rel_pd:-1,rel_mpd:-1,rel_mntd:-1,tree:null},geometry:{type:"Polygon",coordinates:he}},ue=T5.featureToH3Set(ae,t)[0];if(!ue||!g[ue])break;ae.properties.id=ue;for(let be of Object.keys(g[ue])){let je=g[ue][be][0];ae.properties[be]=je,je>n[be]?n[be]=je:je<c[be]&&(c[be]=je)}ae.properties.tree=x[ue][0]??"",ae.properties.pd||(ae.properties.pd=-1),ae.properties.mpd||(ae.properties.mpd=-1),ae.properties.mntd||(ae.properties.mntd=-1),ae.properties.tree_sizes=((W=g[ue].present_species_rds)==null?void 0:W.length)??0,ae.properties.quartile=Number.parseFloat(g[ue].quartile??-1),a.push(ae)}return{type:"FeatureCollection",features:a,properties:{maxes:n,mins:c,rel_pd_exp:0}}}function PU(e){return console.log(e),JSON.parse(e[0])}function DU(e){let t,n,c,g=`<svg class="marker-svg" id="Layer_2" data-name="Layer 2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70.46 62.88"><defs><style>.fill {
                fill: #000;
                stroke: solid 1px red;
            }
            .stroke {
                stroke: #fff;
            }
        </style></defs><g id="Layer_1-2" data-name="Layer 1"><g><path class="fill" d="m35.23,60.88c-1.81,0-3.43-.93-4.33-2.5L2.68,9.5c-.9-1.57-.9-3.44,0-5,.9-1.57,2.52-2.5,4.33-2.5h56.44c1.81,0,3.43.93,4.33,2.5.9,1.56.9,3.43,0,5l-28.22,48.88c-.9,1.57-2.52,2.5-4.33,2.5Z"></path><path d="m63.45,4c1.56,0,2.34,1.05,2.6,1.5.26.45.78,1.65,0,3l-28.22,48.88c-.78,1.35-2.08,1.5-2.6,1.5s-1.82-.15-2.6-1.5L4.41,8.5c-.78-1.35-.26-2.55,0-3,.26-.45,1.03-1.5,2.6-1.5h56.44m0-4H7.01C1.62,0-1.75,5.83.95,10.5l28.22,48.88c1.35,2.33,3.7,3.5,6.06,3.5s4.72-1.17,6.06-3.5l28.22-48.88c2.69-4.67-.67-10.5-6.06-10.5h0Z"></path></g></g></svg>`;return{c(){t=Fn("div"),n=wr(),c=Fn("div"),c.innerHTML=g,this.h()},l(x){t=On(x,"DIV",{id:!0,class:!0}),yn(t).forEach(vi),n=Sr(x),c=On(x,"DIV",{id:!0,class:!0,style:!0,"data-svelte-h":!0}),Zu(c)!=="svelte-1sgleu8"&&(c.innerHTML=g),this.h()},h(){ki(t,"id","map"),ki(t,"class","map"),ki(c,"id","marker-template"),ki(c,"class","hex-marker"),By(c,"display","none")},m(x,S){Un(x,t,S),Un(x,n,S),Un(x,c,S)},p:Ra,i:Ra,o:Ra,d(x){x&&(vi(t),vi(n),vi(c))}}}let a3=6;const LU=500;let BU=!1;function zU(e,t,n){let c,g,x,S,a,G;tc(e,Kp,_i=>n(11,c=_i)),tc(e,cT,_i=>n(24,g=_i)),tc(e,Fy,_i=>n(12,x=_i)),tc(e,cg,_i=>n(13,S=_i)),tc(e,e_,_i=>n(25,a=_i)),tc(e,Y_,_i=>n(14,G=_i));const W=[-119.449444,37.166111];let{metric:he}=t,{colorScheme:ae}=t,{showCounties:ue}=t,{showEcoregions:be}=t,{drawnPath:je}=t,{clade:nt}=t,{clades:tt}=t,{finishBuilding:at}=t;const ut=[-124.40971816218747,32.534154544948464,-114.13120909272375,42.009518182466415];let xt,Tt,Mt,Oe=!1,jt=[-119.449444,37.166111];function it(_i){if(!c.getStyle)return;console.log(c.getStyle().layers);let Ji=c.getStyle().layers.filter(Ai=>{var ei;let sn=(ei=Ai.source)==null?void 0:ei.split("-");return sn&&sn[0]==="hexlayer"&&sn[1]!==_i});for(let Ai of Ji)c.setPaintProperty(Ai.id,"fill-opacity",0)}function vt(_i){Oe=_i!==null,Mt&&(console.log("SHOW?",Oe),Oe?Mt.addTo(c):Mt.remove())}async function mt(_i){if(!zt||!c.getLayer)return;if(_i===null){c.getLayer("drawLayer")&&c.removeLayer("drawnPolygon"),c.getSource("drawnPolygon")&&c.removeSource("drawnPolygon");return}console.log(c.transform),console.log(_i[0]),console.log(c.transform.pointLocation({x:10,y:10})),console.log(c.transform.pointLocation(_i[0]));let Ji=[];for(let ci of _i){let rn=c.transform.pointLocation(ci);Ji.push([rn.lat,rn.lng])}let Ai=HV(Ji,a3),sn=T5.h3SetToMultiPolygonFeature(Ai);console.log(sn),console.log(zt);let ei=$V(zt);console.log(ei),console.log(sn.geometry),console.log(ei.features[0].geometry);let _n=AU(sn.geometry.coordinates,ei.features[0].geometry.coordinates);console.log(_n);let Pr={type:"Feature",properties:{},geometry:{type:"MultiPolygon",coordinates:_n}};c.addSource("drawnPolygon",{type:"geojson",data:Pr}),c.addLayer({id:"drawLayer",type:"fill",source:"drawnPolygon",layout:{},paint:{"fill-color":"#00ffff","fill-opacity":x,"fill-color-transition":{duration:500,delay:0}}},Tt)}function Et(_i,Ji){if(console.log(_i),!c.moveLayer)return;let Ai=`hex-${_i}-${Ji}`;console.log(_i),c.moveLayer(Ai,"place_hamlet"),setTimeout(()=>{Pt([Ai])},LU/4),c.setPaintProperty(Ai,"fill-opacity",x)}function Pt(_i=[]){if(!c.getStyle)return;let Ji=c.getStyle().layers.filter(Ai=>{var sn;return((sn=Ai.source)==null?void 0:sn.includes("hexlayer"))&&!_i.includes(Ai.id)});for(let Ai of Ji)c.setPaintProperty(Ai.id,"fill-opacity",0)}function dt(_i){if(!c.getStyle)return;let Ji=c.getStyle().layers.filter(Ai=>Ai.source===`hexlayer-${nt}`);for(let Ai of Ji){let sn=Ai.id.split("-")[1],ei=Ti(sn,_i,!0);console.log("palette:",ei),c.setPaintProperty(Ai.id,"fill-color",ei)}}function Je(_i){c.setPaintProperty&&(_i?c.setPaintProperty("counties","line-opacity",g):c.setPaintProperty("counties","line-opacity",0))}function pt(_i){c.setPaintProperty&&(console.log("ecoregions",_i),_i?(c.setPaintProperty("ecoregions-line","line-opacity",g),c.setPaintProperty("ecoregions-fill","fill-opacity",x)):(c.setPaintProperty("ecoregions-line","line-opacity",0),c.setPaintProperty("ecoregions-fill","fill-opacity",0)))}function lt(_i){_i?(c.setPaintProperty("california-line","line-opacity",g),c.setPaintProperty("california-fill","fill-opacity",x)):(c.setPaintProperty("california-line","line-opacity",0),c.setPaintProperty("california-fill","fill-opacity",0))}let Nt,zt,Ot,gi,wi=g_(0,5e3,ae);function Ti(_i,Ji,Ai=!0){if(!(!Ot||!gi))if(console.log("generating for ",_i),Ai){wi=g_(gi[_i],Ot[_i],Ji),_i==="quartile"&&(wi=oT(Ji)),console.log(wi),wi.length;let sn=wi.map((_n,Pr)=>[_n[0],_n[1]]);sn=sn.flat(),console.log(sn);let ei=["interpolate",["linear"],["get",_i],...sn];return a||e_.set(ei),ei}else return["step",["get",_i],"#ccc",0,"#fc4e2a",600,"#00E676",1300,"#2a4e9b"]}async function Ni(_i,Ji){var Ai;if(console.log(_i),!(c&&((Ai=c==null?void 0:c.getStyle())!=null&&Ai.sources[`hexlayer-${_i}`])))return fetch(`/phast/${_i}_hex_new.json`).then(sn=>sn.json()).then(sn=>zt=sn).then(()=>{var Pr,ci,rn;Ot=(Pr=zt.properties)==null?void 0:Pr.maxes,gi=(ci=zt.properties)==null?void 0:ci.mins,(rn=zt.properties)!=null&&rn.rel_pd_exp&&zt.properties.rel_pd_exp;let ei=c.getStyle().layers[71].id;c.getSource(`hexlayer-${_i}`)||c.addSource(`hexlayer-${_i}`,{type:"geojson",data:zt});for(let tr of __){let Pn=`hex-${tr}-${_i}`;c.addLayer({id:Pn,type:"fill",source:`hexlayer-${_i}`,layout:{},paint:{"fill-color":Ti(tr,ae,!0),"fill-opacity":x,"fill-color-transition":{duration:500,delay:0}}},ei),console.log("added layer ",Pn)}let _n=`hex-${__[0]}-${_i}`;return c.on("click",_n,tr=>{console.log(tr);let Pn=qV(tr.lngLat.lat,tr.lngLat.lng,Ji);if(Ci(Pn),Pn===(S==null?void 0:S.hex)){cg.set(null);return}console.log(c.getStyle().layers);let Qn=Lw(Pn);jt={lng:Qn[1],lat:Qn[0]},console.log(Pn),cg.set({latlng:tr.lngLat,hex:Pn,properties:tr.features[0].properties})}),c.on("mouseenter",_n,()=>{c.getCanvas().style.cursor="pointer"}),c.on("mouseleave",_n,()=>{c.getCanvas().style.cursor=""}),c.on("dragstart",_n,()=>{c.getCanvas().style.cursor="grabbing"}),c.on("dragend",_n,()=>{c.getCanvas().style.cursor="pointer"}),!0})}async function en(){fetch("/phast/data/ecoregions.geojson").then(_i=>_i.json()).then(_i=>{console.log(_i),c.addSource("ecoregions",{type:"geojson",data:_i,generateId:!0}),c.addLayer({id:"ecoregions-fill",type:"fill",source:"ecoregions",layout:{},paint:{"fill-opacity":0,"fill-color":["case",["boolean",["feature-state","hover"],!1],"#29abe2","#e9f6fb"],"fill-color-transition":{duration:500,delay:0}}}),c.addLayer({id:"ecoregions-line",type:"line",source:"ecoregions",layout:{},paint:{"line-color":"#555555","line-width":.25,"line-opacity":0}}),console.log("added ecoregions")})}async function ji(){Kp&&fetch("/phast/data/california.geojson").then(_i=>_i.json()).then(_i=>{console.log(_i),c.addSource("california",{type:"geojson",data:_i,generateId:!0}),c.addLayer({id:"california-fill",type:"fill",source:"california",layout:{},paint:{"fill-opacity":x,"fill-color":["case",["boolean",["feature-state","hover"],!1],"#29abe2","#e9f6fb"],"fill-color-transition":{duration:500,delay:0}}}),c.addLayer({id:"california-line",type:"line",source:"california",layout:{},paint:{"line-color":"#555555","line-width":.25,"line-opacity":g}})})}async function Vi(){return fetch("/phast/CA_hexbinned@6.json").then(_i=>_i.json()).then(_i=>{console.log(_i),MU(_i,6).then(Ji=>console.log(Ji))})}function nn(_i){if(!_i)return;console.log("started building");let Ji=Date.now();Ni("Birds",a3).then(()=>{at(),Et(he,nt),console.log(`finished building in ${Date.now()-Ji}ms`)}),pt(!1),lt(!1)}xc(()=>{om(Kp,c=new _x.Map({container:"map",style:`https://basemaps.cartocdn.com/gl/${Oi}-gl-style/style.json`,center:W,zoom:4}),c),c.on("load",()=>{en(),ji(),console.log("loaded"),vn()}),Vi(),setTimeout(()=>{console.log("no load on timeout"),om(Kp,c._canvas.style.filter="none",c),vn()},3e3)});async function vn(){let _i=ut;Nt=window.innerWidth/3,c.fitBounds(_i,{padding:{top:50,left:10,bottom:50,right:Nt}}),om(Kp,c._canvas.style.filter="none",c)}function Ci(_i){Mt||mi();let Ji=Lw(_i);console.log(Ji),Nt=2*window.innerWidth/5,Ri([Ji[1],Ji[0]]),c.flyTo({center:[Ji[1],Ji[0]],essential:!0,padding:{right:Nt},duration:750})}function mi(){let _i=document.getElementById("marker-template");_i.style.display="block",Mt=new _x.Marker({element:_i}).setLngLat(jt).addTo(c)}function Ri(_i){Mt.setLngLat(_i)}let Oi="positron";return e.$$set=_i=>{"metric"in _i&&n(0,he=_i.metric),"colorScheme"in _i&&n(1,ae=_i.colorScheme),"showCounties"in _i&&n(2,ue=_i.showCounties),"showEcoregions"in _i&&n(3,be=_i.showEcoregions),"drawnPath"in _i&&n(4,je=_i.drawnPath),"clade"in _i&&n(5,nt=_i.clade),"clades"in _i&&n(6,tt=_i.clades),"finishBuilding"in _i&&n(7,at=_i.finishBuilding)},e.$$.update=()=>{e.$$.dirty[0]&3072&&c&&BU&&(n(10,xt=c.getStyle().layers.filter(_i=>_i["source-layer"]==="place")),console.log(xt)),e.$$.dirty[0]&33&&Et(he,nt),e.$$.dirty[0]&4129&&x&&Et(he,nt),e.$$.dirty[0]&2&&dt(ae),e.$$.dirty[0]&3&&e_.set(Ti(he,ae,!0)),e.$$.dirty[0]&4&&Je(ue),e.$$.dirty[0]&8&&pt(be),e.$$.dirty[0]&16&&mt(je),e.$$.dirty[0]&32&&it(nt),e.$$.dirty[0]&8192&&vt(S),e.$$.dirty[0]&16384&&nn(G)},[he,ae,ue,be,je,nt,tt,at,pt,lt,xt,c,x,S,G]}let RU=class extends fo{constructor(t){super(),po(this,t,zU,DU,Oa,{metric:0,colorScheme:1,showCounties:2,showEcoregions:3,drawnPath:4,clade:5,clades:6,finishBuilding:7,updateShowEcoregions:8,updateShowCalifornia:9},null,[-1,-1])}get updateShowEcoregions(){return this.$$.ctx[8]}get updateShowCalifornia(){return this.$$.ctx[9]}};function o3(e){let t,n,c,g,x;return n=new dT({props:{updateColorScheme:e[10],updateShowCounties:e[11],updateShowEcoregions:e[12],updateDrawing:e[13],drawing:e[5],updateDrawnPath:e[14]}}),g=new ET({props:{colorScheme:e[2],metric:e[1]}}),{c(){t=Fn("div"),ls(n.$$.fragment),c=wr(),ls(g.$$.fragment),this.h()},l(S){t=On(S,"DIV",{class:!0});var a=yn(t);Ds(n.$$.fragment,a),c=Sr(a),Ds(g.$$.fragment,a),a.forEach(vi),this.h()},h(){ki(t,"class","control-container svelte-eoojfj")},m(S,a){Un(S,t,a),us(n,t,null),Hi(t,c),us(g,t,null),x=!0},p(S,a){const G={};a&32&&(G.drawing=S[5]),n.$set(G);const W={};a&4&&(W.colorScheme=S[2]),a&2&&(W.metric=S[1]),g.$set(W)},i(S){x||($i(n.$$.fragment,S),$i(g.$$.fragment,S),x=!0)},o(S){ln(n.$$.fragment,S),ln(g.$$.fragment,S),x=!1},d(S){S&&vi(t),cs(n),cs(g)}}}function l3(e){let t,n;return t=new xT({props:{updatePath:e[14],updateIsDrawing:e[13],isDrawing:e[5]}}),{c(){ls(t.$$.fragment)},l(c){Ds(t.$$.fragment,c)},m(c,g){us(t,c,g),n=!0},p(c,g){const x={};g&32&&(x.isDrawing=c[5]),t.$set(x)},i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){ln(t.$$.fragment,c),n=!1},d(c){cs(t,c)}}}function FU(e){let t,n,c,g,x,S,a,G;n=new RU({props:{finishBuilding:e[17],metric:e[1],colorScheme:e[2],showCounties:e[3],showEcoregions:e[4],drawnPath:e[6],clade:e[7],clades:e[16]}}),g=new CO({props:{isBuilt:OU,isFinishedBuilding:e[8],updateMetricLayer:e[9],showEcoregions:e[12],colorScheme:e[2],metric:e[1],clade:e[7],clades:e[16],updateClade:e[15]}});let W=e[0]&&o3(e),he=e[5]&&l3(e);return{c(){t=Fn("main"),ls(n.$$.fragment),c=wr(),ls(g.$$.fragment),x=wr(),W&&W.c(),S=wr(),he&&he.c(),a=Ls(),this.h()},l(ae){t=On(ae,"MAIN",{class:!0});var ue=yn(t);Ds(n.$$.fragment,ue),c=Sr(ue),Ds(g.$$.fragment,ue),ue.forEach(vi),x=Sr(ae),W&&W.l(ae),S=Sr(ae),he&&he.l(ae),a=Ls(),this.h()},h(){ki(t,"class","svelte-eoojfj")},m(ae,ue){Un(ae,t,ue),us(n,t,null),Hi(t,c),us(g,t,null),Un(ae,x,ue),W&&W.m(ae,ue),Un(ae,S,ue),he&&he.m(ae,ue),Un(ae,a,ue),G=!0},p(ae,[ue]){const be={};ue&2&&(be.metric=ae[1]),ue&4&&(be.colorScheme=ae[2]),ue&8&&(be.showCounties=ae[3]),ue&16&&(be.showEcoregions=ae[4]),ue&64&&(be.drawnPath=ae[6]),ue&128&&(be.clade=ae[7]),n.$set(be);const je={};ue&256&&(je.isFinishedBuilding=ae[8]),ue&4&&(je.colorScheme=ae[2]),ue&2&&(je.metric=ae[1]),ue&128&&(je.clade=ae[7]),g.$set(je),ae[0]?W?(W.p(ae,ue),ue&1&&$i(W,1)):(W=o3(ae),W.c(),$i(W,1),W.m(S.parentNode,S)):W&&(zo(),ln(W,1,1,()=>{W=null}),Ro()),ae[5]?he?(he.p(ae,ue),ue&32&&$i(he,1)):(he=l3(ae),he.c(),$i(he,1),he.m(a.parentNode,a)):he&&(zo(),ln(he,1,1,()=>{he=null}),Ro())},i(ae){G||($i(n.$$.fragment,ae),$i(g.$$.fragment,ae),$i(W),$i(he),G=!0)},o(ae){ln(n.$$.fragment,ae),ln(g.$$.fragment,ae),ln(W),ln(he),G=!1},d(ae){ae&&(vi(t),vi(x),vi(S),vi(a)),cs(n),cs(g),W&&W.d(ae),he&&he.d(ae)}}}let OU=!1;function NU(e,t,n){let c;tc(e,Y_,Mt=>n(0,c=Mt));let g="pd";function x(Mt){n(1,g=Mt)}let S="*ibm";function a(Mt){n(2,S=Mt)}let G=!1;function W(Mt){n(3,G=Mt)}let he=!1;function ae(Mt){n(4,he=Mt)}let ue=!1;function be(Mt){n(5,ue=Mt)}let je=null;function nt(Mt){n(6,je=Mt)}let tt="Birds";function at(Mt){n(7,tt=Mt)}const ut=["Birds","Plants"];let xt=!1;function Tt(){n(8,xt=!0)}return e.$$.update=()=>{e.$$.dirty&1&&console.log(c)},[c,g,S,G,he,ue,je,tt,xt,x,a,W,ae,be,nt,at,ut,Tt]}class QU extends fo{constructor(t){super(),po(this,t,NU,FU,Oa,{})}}export{QU as component};
